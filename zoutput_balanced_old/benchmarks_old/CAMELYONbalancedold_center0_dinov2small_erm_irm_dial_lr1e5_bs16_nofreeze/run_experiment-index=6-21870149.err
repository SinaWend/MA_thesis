Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 20:58:22 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149

 Experiment start at: 2024-07-10 21:05:22.258664
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9826067, 'precision': 0.90238035, 'recall': 0.9126828, 'specificity': 0.9126828, 'f1': 0.90745807, 'auroc': 0.9939889, 'binary_precision': 0.99153864, 'binary_recall': 0.9901646, 'binary_specificity': 0.835201, 'binary_f1_score': 0.9908511}
confusion matrix:
      0      1
0  1267    250
1   291  29296
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.77329195, 'precision': 0.8124899, 'recall': 0.7757437, 'specificity': 0.7757437, 'f1': 0.766979, 'auroc': 0.91870105, 'binary_precision': 0.6982659, 'binary_recall': 0.9511811, 'binary_specificity': 0.6003063, 'binary_f1_score': 0.8053334}
confusion matrix:
     0    1
0  392  261
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7628866, 'precision': 0.8116673, 'recall': 0.7377691, 'specificity': 0.7377691, 'f1': 0.7385396, 'auroc': 0.907528, 'binary_precision': 0.71349865, 'binary_recall': 0.9592593, 'binary_specificity': 0.51627904, 'binary_f1_score': 0.81832546}
confusion matrix:
     0    1
0  111  104
1   11  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 21:31:31.437801,epoch time: 0:26:09.179137,used: 0:26:09.179137,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98945475, 'precision': 0.97128916, 'recall': 0.9119619, 'specificity': 0.9119619, 'f1': 0.93940985, 'auroc': 0.99812514, 'binary_precision': 0.9911368, 'binary_recall': 0.9978368, 'binary_specificity': 0.82608694, 'binary_f1_score': 0.99447554}
confusion matrix:
      0      1
0  1254    264
1    64  29522
---- Validation: 
scalar performance:
{'acc': 0.63975155, 'precision': 0.77669334, 'recall': 0.64460814, 'specificity': 0.64460814, 'f1': 0.5931287, 'auroc': 0.93739307, 'binary_precision': 0.5785124, 'binary_recall': 0.992126, 'binary_specificity': 0.29709035, 'binary_f1_score': 0.7308584}
confusion matrix:
     0    1
0  194  459
1    5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7587629, 'precision': 0.8035363, 'recall': 0.7340654, 'specificity': 0.7340654, 'f1': 0.7347236, 'auroc': 0.92072356, 'binary_precision': 0.7119114, 'binary_recall': 0.95185184, 'binary_specificity': 0.51627904, 'binary_f1_score': 0.81458}
confusion matrix:
     0    1
0  111  104
1   13  257
early stop counter: 1
val acc:0.6397515535354614, best validation acc: 0.7732919454574585, corresponding to test acc:                         0.7628865838050842 / 0.7628865838050842
after epoch: 2,now: 2024-07-10 21:57:56.998828,epoch time: 0:26:25.561027,used: 0:52:34.740164,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9182501, 'recall': 0.9829705, 'specificity': 0.9829705, 'f1': 0.9479804, 'auroc': 0.99880326, 'binary_precision': 0.9987387, 'binary_recall': 0.99029917, 'binary_specificity': 0.97564185, 'binary_f1_score': 0.994501}
confusion matrix:
      0      1
0  1482     37
1   287  29298
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.8867723, 'recall': 0.8834899, 'specificity': 0.8834899, 'f1': 0.88257986, 'auroc': 0.94455874, 'binary_precision': 0.84375, 'binary_recall': 0.9354331, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.88722926}
confusion matrix:
     0    1
0  543  110
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.8823589, 'recall': 0.8873385, 'specificity': 0.8873385, 'f1': 0.8820813, 'auroc': 0.92310077, 'binary_precision': 0.9382716, 'binary_recall': 0.84444445, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  200   15
1   42  228
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-10 22:24:23.203798,epoch time: 0:26:26.204970,used: 1:19:00.945134,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.994213, 'precision': 0.9736146, 'recall': 0.96354574, 'specificity': 0.96354574, 'f1': 0.9685198, 'auroc': 0.9991181, 'binary_precision': 0.9963875, 'binary_recall': 0.99753255, 'binary_specificity': 0.92955893, 'binary_f1_score': 0.9969597}
confusion matrix:
      0      1
0  1412    107
1    73  29512
---- Validation: 
scalar performance:
{'acc': 0.80201864, 'precision': 0.8303801, 'recall': 0.80405277, 'specificity': 0.80405277, 'f1': 0.7983812, 'auroc': 0.92448425, 'binary_precision': 0.7300242, 'binary_recall': 0.9496063, 'binary_specificity': 0.65849924, 'binary_f1_score': 0.825462}
confusion matrix:
     0    1
0  430  223
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.83160853, 'recall': 0.80249786, 'specificity': 0.80249786, 'f1': 0.8076503, 'auroc': 0.935056, 'binary_precision': 0.78369904, 'binary_recall': 0.9259259, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.84889644}
confusion matrix:
     0    1
0  146   69
1   20  250
early stop counter: 1
val acc:0.8020186424255371, best validation acc: 0.8827639818191528, corresponding to test acc:                         0.8824742436408997 / 0.8824742436408997
after epoch: 4,now: 2024-07-10 22:50:40.511633,epoch time: 0:26:17.307835,used: 1:45:18.252969,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99585265, 'precision': 0.9741691, 'recall': 0.9815709, 'specificity': 0.9815709, 'f1': 0.9778379, 'auroc': 0.99956584, 'binary_precision': 0.99824095, 'binary_recall': 0.9973974, 'binary_specificity': 0.9657444, 'binary_f1_score': 0.997819}
confusion matrix:
      0      1
0  1466     52
1    77  29509
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.8921557, 'recall': 0.8867698, 'specificity': 0.8867698, 'f1': 0.8855599, 'auroc': 0.9486778, 'binary_precision': 0.8388889, 'binary_recall': 0.9511811, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.8915129}
confusion matrix:
     0    1
0  537  116
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.89697874, 'recall': 0.9017657, 'specificity': 0.9017657, 'f1': 0.8946662, 'auroc': 0.9579156, 'binary_precision': 0.96595746, 'binary_recall': 0.84074074, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8990099}
confusion matrix:
     0    1
0  207    8
1   43  227
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 23:16:57.782319,epoch time: 0:26:17.270686,used: 2:11:35.523655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9939236, 'precision': 0.9606153, 'recall': 0.97525966, 'specificity': 0.97525966, 'f1': 0.96780914, 'auroc': 0.99909675, 'binary_precision': 0.99766374, 'binary_recall': 0.9959439, 'binary_specificity': 0.95457536, 'binary_f1_score': 0.9968031}
confusion matrix:
      0      1
0  1450     69
1   120  29465
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.8842038, 'recall': 0.8832077, 'specificity': 0.8832077, 'f1': 0.8827198, 'auroc': 0.9347964, 'binary_precision': 0.85693216, 'binary_recall': 0.9149606, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.8849962}
confusion matrix:
     0    1
0  556   97
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.86463654, 'recall': 0.86881995, 'specificity': 0.86881995, 'f1': 0.8616651, 'auroc': 0.93664086, 'binary_precision': 0.93562233, 'binary_recall': 0.8074074, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8667992}
confusion matrix:
     0    1
0  200   15
1   52  218
early stop counter: 1
val acc:0.8827639818191528, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 6,now: 2024-07-10 23:43:19.994864,epoch time: 0:26:22.212545,used: 2:37:57.736200,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98128855, 'precision': 0.97993153, 'recall': 0.8146187, 'specificity': 0.8146187, 'f1': 0.87835324, 'auroc': 0.99766517, 'binary_precision': 0.98137945, 'binary_recall': 0.9992902, 'binary_specificity': 0.62994725, 'binary_f1_score': 0.99025387}
confusion matrix:
     0      1
0  955    561
1   21  29567
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.8094312, 'recall': 0.7613474, 'specificity': 0.7613474, 'f1': 0.7494757, 'auroc': 0.9288348, 'binary_precision': 0.6804009, 'binary_recall': 0.9622047, 'binary_specificity': 0.5604901, 'binary_f1_score': 0.79712987}
confusion matrix:
     0    1
0  366  287
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.785567, 'precision': 0.8134381, 'recall': 0.7661929, 'specificity': 0.7661929, 'f1': 0.7703096, 'auroc': 0.9111111, 'binary_precision': 0.7441176, 'binary_recall': 0.93703705, 'binary_specificity': 0.59534883, 'binary_f1_score': 0.8295082}
confusion matrix:
     0    1
0  128   87
1   17  253
early stop counter: 2
val acc:0.7585403919219971, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 7,now: 2024-07-11 00:09:35.381108,epoch time: 0:26:15.386244,used: 3:04:13.122444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9960134, 'precision': 0.9814391, 'recall': 0.9754214, 'specificity': 0.9754214, 'f1': 0.9784092, 'auroc': 0.99955946, 'binary_precision': 0.99756795, 'binary_recall': 0.9982424, 'binary_specificity': 0.9526004, 'binary_f1_score': 0.9979051}
confusion matrix:
      0      1
0  1447     72
1    52  29533
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.83829397, 'recall': 0.80203784, 'specificity': 0.80203784, 'f1': 0.79463834, 'auroc': 0.9463747, 'binary_precision': 0.72046787, 'binary_recall': 0.97007877, 'binary_specificity': 0.63399696, 'binary_f1_score': 0.8268457}
confusion matrix:
     0    1
0  414  239
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80206186, 'precision': 0.8125116, 'recall': 0.7890612, 'specificity': 0.7890612, 'f1': 0.7934559, 'auroc': 0.9048234, 'binary_precision': 0.77707005, 'binary_recall': 0.9037037, 'binary_specificity': 0.6744186, 'binary_f1_score': 0.8356164}
confusion matrix:
     0    1
0  145   70
1   26  244
early stop counter: 3
val acc:0.7996894121170044, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 8,now: 2024-07-11 00:35:46.768802,epoch time: 0:26:11.387694,used: 3:30:24.510138,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9954025, 'precision': 0.9854541, 'recall': 0.9644833, 'specificity': 0.9644833, 'f1': 0.9747108, 'auroc': 0.9996439, 'binary_precision': 0.99642545, 'binary_recall': 0.9987494, 'binary_specificity': 0.93021727, 'binary_f1_score': 0.997586}
confusion matrix:
      0      1
0  1413    106
1    37  29548
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.8842038, 'recall': 0.8832077, 'specificity': 0.8832077, 'f1': 0.8827198, 'auroc': 0.9371381, 'binary_precision': 0.85693216, 'binary_recall': 0.9149606, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.8849962}
confusion matrix:
     0    1
0  556   97
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82474226, 'precision': 0.8268085, 'recall': 0.8307494, 'specificity': 0.8307494, 'f1': 0.8244437, 'auroc': 0.92086136, 'binary_precision': 0.89361703, 'binary_recall': 0.7777778, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.83168316}
confusion matrix:
     0    1
0  190   25
1   60  210
early stop counter: 4
val acc:0.8827639818191528, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 9,now: 2024-07-11 01:02:04.346514,epoch time: 0:26:17.577712,used: 3:56:42.087850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9959812, 'precision': 0.9684665, 'recall': 0.9897686, 'specificity': 0.9897686, 'f1': 0.9788524, 'auroc': 0.9997271, 'binary_precision': 0.999119, 'binary_recall': 0.99665374, 'binary_specificity': 0.98288345, 'binary_f1_score': 0.9978848}
confusion matrix:
      0      1
0  1493     26
1    99  29486
---- Validation: 
scalar performance:
{'acc': 0.85481364, 'precision': 0.8662274, 'recall': 0.8535807, 'specificity': 0.8535807, 'f1': 0.85334253, 'auroc': 0.93257284, 'binary_precision': 0.92748094, 'binary_recall': 0.76535434, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.838654}
confusion matrix:
     0    1
0  615   38
1  149  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6206186, 'precision': 0.7196311, 'recall': 0.6540482, 'specificity': 0.6540482, 'f1': 0.6012083, 'auroc': 0.86875105, 'binary_precision': 0.8981481, 'binary_recall': 0.35925925, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.51322746}
confusion matrix:
     0   1
0  204  11
1  173  97
early stop counter: 5
val acc:0.8548136353492737, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 10,now: 2024-07-11 01:28:18.331319,epoch time: 0:26:13.984805,used: 4:22:56.072655,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9959491, 'precision': 0.99059236, 'recall': 0.96539515, 'specificity': 0.96539515, 'f1': 0.9776242, 'auroc': 0.99975353, 'binary_precision': 0.9964944, 'binary_recall': 0.9992564, 'binary_specificity': 0.93153393, 'binary_f1_score': 0.9978735}
confusion matrix:
      0      1
0  1415    104
1    22  29563
---- Validation: 
scalar performance:
{'acc': 0.8718944, 'precision': 0.88066125, 'recall': 0.87296546, 'specificity': 0.87296546, 'f1': 0.8713602, 'auroc': 0.9458007, 'binary_precision': 0.8192935, 'binary_recall': 0.9496063, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.8796499}
confusion matrix:
     0    1
0  520  133
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83092785, 'precision': 0.83005226, 'recall': 0.8263566, 'specificity': 0.8263566, 'f1': 0.82783556, 'auroc': 0.88237727, 'binary_precision': 0.8357143, 'binary_recall': 0.8666667, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.8509091}
confusion matrix:
     0    1
0  169   46
1   36  234
early stop counter: 6
val acc:0.8718944191932678, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 11,now: 2024-07-11 01:54:37.398014,epoch time: 0:26:19.066695,used: 4:49:15.139350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98135287, 'precision': 0.9758503, 'recall': 0.81845284, 'specificity': 0.81845284, 'f1': 0.8799708, 'auroc': 0.99699736, 'binary_precision': 0.9817306, 'binary_recall': 0.99898595, 'binary_specificity': 0.63791966, 'binary_f1_score': 0.99028313}
confusion matrix:
     0      1
0  969    550
1   30  29555
---- Validation: 
scalar performance:
{'acc': 0.6226708, 'precision': 0.766829, 'recall': 0.6277411, 'specificity': 0.6277411, 'f1': 0.56859785, 'auroc': 0.89043725, 'binary_precision': 0.56717765, 'binary_recall': 0.9905512, 'binary_specificity': 0.26493108, 'binary_f1_score': 0.7213303}
confusion matrix:
     0    1
0  173  480
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7402062, 'precision': 0.803182, 'recall': 0.7112403, 'specificity': 0.7112403, 'f1': 0.70712554, 'auroc': 0.935745, 'binary_precision': 0.6904762, 'binary_recall': 0.96666664, 'binary_specificity': 0.45581394, 'binary_f1_score': 0.80555546}
confusion matrix:
    0    1
0  98  117
1   9  261
early stop counter: 7
val acc:0.6226708292961121, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8948453664779663 / 0.8948453664779663
after epoch: 12,now: 2024-07-11 02:20:59.525699,epoch time: 0:26:22.127685,used: 5:15:37.267035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9962384, 'precision': 0.9885842, 'recall': 0.9705435, 'specificity': 0.9705435, 'f1': 0.9793749, 'auroc': 0.9996989, 'binary_precision': 0.99703145, 'binary_recall': 0.9990198, 'binary_specificity': 0.94206715, 'binary_f1_score': 0.99802464}
confusion matrix:
      0      1
0  1431     88
1    29  29556
---- Validation: 
scalar performance:
{'acc': 0.89440995, 'precision': 0.8962864, 'recall': 0.8949102, 'specificity': 0.8949102, 'f1': 0.89435256, 'auroc': 0.95039976, 'binary_precision': 0.8653001, 'binary_recall': 0.93070865, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.89681333}
confusion matrix:
     0    1
0  561   92
1   44  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83505154, 'precision': 0.83681333, 'recall': 0.8409561, 'specificity': 0.8409561, 'f1': 0.8347417, 'auroc': 0.868441, 'binary_precision': 0.90254235, 'binary_recall': 0.7888889, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8418972}
confusion matrix:
     0    1
0  192   23
1   57  213
better model found
persisted
after epoch: 13,now: 2024-07-11 02:47:17.767740,epoch time: 0:26:18.242041,used: 5:41:55.509076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99585265, 'precision': 0.9741691, 'recall': 0.9815709, 'specificity': 0.9815709, 'f1': 0.9778379, 'auroc': 0.9996142, 'binary_precision': 0.99824095, 'binary_recall': 0.9973974, 'binary_specificity': 0.9657444, 'binary_f1_score': 0.997819}
confusion matrix:
      0      1
0  1466     52
1    77  29509
---- Validation: 
scalar performance:
{'acc': 0.8734472, 'precision': 0.8734718, 'recall': 0.87336826, 'specificity': 0.87336826, 'f1': 0.8734068, 'auroc': 0.93903124, 'binary_precision': 0.87460315, 'binary_recall': 0.86771655, 'binary_specificity': 0.8790199, 'binary_f1_score': 0.8711462}
confusion matrix:
     0    1
0  574   79
1   84  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.843299, 'precision': 0.85862434, 'recall': 0.85594314, 'specificity': 0.85594314, 'f1': 0.84326625, 'auroc': 0.92925066, 'binary_precision': 0.96634614, 'binary_recall': 0.74444443, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.84100413}
confusion matrix:
     0    1
0  208    7
1   69  201
early stop counter: 1
val acc:0.8734471797943115, best validation acc: 0.8944099545478821, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 14,now: 2024-07-11 03:13:36.784902,epoch time: 0:26:19.017162,used: 6:08:14.526238,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9971386, 'precision': 0.9868211, 'recall': 0.9822582, 'specificity': 0.9822582, 'f1': 0.9845277, 'auroc': 0.99980617, 'binary_precision': 0.9982433, 'binary_recall': 0.9987494, 'binary_specificity': 0.96576697, 'binary_f1_score': 0.9984963}
confusion matrix:
      0      1
0  1467     52
1    37  29548
---- Validation: 
scalar performance:
{'acc': 0.8509317, 'precision': 0.85707396, 'recall': 0.85001266, 'specificity': 0.85001266, 'f1': 0.8500277, 'auroc': 0.9255128, 'binary_precision': 0.9005425, 'binary_recall': 0.784252, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.83838385}
confusion matrix:
     0    1
0  598   55
1  137  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80206186, 'precision': 0.82488, 'recall': 0.81701124, 'specificity': 0.81701124, 'f1': 0.80175763, 'auroc': 0.8930577, 'binary_precision': 0.9438776, 'binary_recall': 0.6851852, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.79399145}
confusion matrix:
     0    1
0  204   11
1   85  185
early stop counter: 2
val acc:0.850931704044342, best validation acc: 0.8944099545478821, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 15,now: 2024-07-11 03:39:56.110412,epoch time: 0:26:19.325510,used: 6:34:33.851748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992509, 'precision': 0.9874877, 'recall': 0.9307538, 'specificity': 0.9307538, 'f1': 0.9571744, 'auroc': 0.9993175, 'binary_precision': 0.99297976, 'binary_recall': 0.9991888, 'binary_specificity': 0.8623188, 'binary_f1_score': 0.9960746}
confusion matrix:
      0      1
0  1309    209
1    24  29562
---- Validation: 
scalar performance:
{'acc': 0.84006214, 'precision': 0.8529823, 'recall': 0.84139824, 'specificity': 0.84139824, 'f1': 0.83892965, 'auroc': 0.9060737, 'binary_precision': 0.78186595, 'binary_recall': 0.93700784, 'binary_specificity': 0.7457887, 'binary_f1_score': 0.8524355}
confusion matrix:
     0    1
0  487  166
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268041, 'precision': 0.82742345, 'recall': 0.8316537, 'specificity': 0.8316537, 'f1': 0.8263427, 'auroc': 0.8966752, 'binary_precision': 0.8875, 'binary_recall': 0.7888889, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8352941}
confusion matrix:
     0    1
0  188   27
1   57  213
early stop counter: 3
val acc:0.840062141418457, best validation acc: 0.8944099545478821, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 16,now: 2024-07-11 04:06:12.717384,epoch time: 0:26:16.606972,used: 7:00:50.458720,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9962063, 'precision': 0.97185606, 'recall': 0.9883256, 'specificity': 0.9883256, 'f1': 0.9799328, 'auroc': 0.99970067, 'binary_precision': 0.9989502, 'binary_recall': 0.99705935, 'binary_specificity': 0.97959185, 'binary_f1_score': 0.99800384}
confusion matrix:
      0      1
0  1488     31
1    87  29498
---- Validation: 
scalar performance:
{'acc': 0.89751554, 'precision': 0.9008943, 'recall': 0.8968878, 'specificity': 0.8968878, 'f1': 0.89717615, 'auroc': 0.94534254, 'binary_precision': 0.9343696, 'binary_recall': 0.8519685, 'binary_specificity': 0.94180703, 'binary_f1_score': 0.8912686}
confusion matrix:
     0    1
0  615   38
1   94  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.86420816, 'recall': 0.8605943, 'specificity': 0.8605943, 'f1': 0.84737015, 'auroc': 0.9474935, 'binary_precision': 0.97572815, 'binary_recall': 0.74444443, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8445378}
confusion matrix:
     0    1
0  210    5
1   69  201
better model found
persisted
after epoch: 17,now: 2024-07-11 04:32:30.993100,epoch time: 0:26:18.275716,used: 7:27:08.734436,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9930556, 'precision': 0.9909978, 'recall': 0.9335846, 'specificity': 0.9335846, 'f1': 0.9603123, 'auroc': 0.9997494, 'binary_precision': 0.99324846, 'binary_recall': 0.999493, 'binary_specificity': 0.8676761, 'binary_f1_score': 0.9963609}
confusion matrix:
      0      1
0  1318    201
1    15  29570
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8491001, 'recall': 0.81061244, 'specificity': 0.81061244, 'f1': 0.80324554, 'auroc': 0.9357635, 'binary_precision': 0.72610724, 'binary_recall': 0.98110235, 'binary_specificity': 0.64012253, 'binary_f1_score': 0.8345613}
confusion matrix:
     0    1
0  418  235
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.814433, 'precision': 0.82486665, 'recall': 0.80206716, 'specificity': 0.80206716, 'f1': 0.80670106, 'auroc': 0.8802067, 'binary_precision': 0.78846157, 'binary_recall': 0.9111111, 'binary_specificity': 0.69302326, 'binary_f1_score': 0.8453609}
confusion matrix:
     0    1
0  149   66
1   24  246
early stop counter: 1
val acc:0.8082298040390015, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 18,now: 2024-07-11 04:58:47.260023,epoch time: 0:26:16.266923,used: 7:53:25.001359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99379504, 'precision': 0.97668195, 'recall': 0.9554622, 'specificity': 0.9554622, 'f1': 0.9658028, 'auroc': 0.998505, 'binary_precision': 0.99554926, 'binary_recall': 0.9979383, 'binary_specificity': 0.91298616, 'binary_f1_score': 0.9967423}
confusion matrix:
      0      1
0  1385    132
1    61  29526
---- Validation: 
scalar performance:
{'acc': 0.875, 'precision': 0.87509763, 'recall': 0.8751384, 'specificity': 0.8751384, 'f1': 0.8749993, 'auroc': 0.92503166, 'binary_precision': 0.8646154, 'binary_recall': 0.8850394, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.8747082}
confusion matrix:
     0    1
0  565   88
1   73  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.85189295, 'recall': 0.8439276, 'specificity': 0.8439276, 'f1': 0.8286299, 'auroc': 0.9498708, 'binary_precision': 0.97461927, 'binary_recall': 0.7111111, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8222698}
confusion matrix:
     0    1
0  210    5
1   78  192
early stop counter: 2
val acc:0.875, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 19,now: 2024-07-11 05:25:04.211401,epoch time: 0:26:16.951378,used: 8:19:41.952737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.995724, 'precision': 0.98693454, 'recall': 0.9664825, 'specificity': 0.9664825, 'f1': 0.9764642, 'auroc': 0.99965745, 'binary_precision': 0.99662775, 'binary_recall': 0.9988846, 'binary_specificity': 0.9340804, 'binary_f1_score': 0.9977549}
confusion matrix:
      0      1
0  1417    100
1    33  29554
---- Validation: 
scalar performance:
{'acc': 0.86102486, 'precision': 0.8758366, 'recall': 0.86241937, 'specificity': 0.86241937, 'f1': 0.85994685, 'auroc': 0.9445949, 'binary_precision': 0.79765016, 'binary_recall': 0.9622047, 'binary_specificity': 0.762634, 'binary_f1_score': 0.87223417}
confusion matrix:
     0    1
0  498  155
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87628865, 'precision': 0.87562406, 'recall': 0.8732558, 'specificity': 0.8732558, 'f1': 0.87430024, 'auroc': 0.9339707, 'binary_precision': 0.8804348, 'binary_recall': 0.9, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.89010984}
confusion matrix:
     0    1
0  182   33
1   27  243
early stop counter: 3
val acc:0.8610248565673828, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 20,now: 2024-07-11 05:51:24.082194,epoch time: 0:26:19.870793,used: 8:46:01.823530,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9979424, 'precision': 0.9845413, 'recall': 0.9936099, 'specificity': 0.9936099, 'f1': 0.9890287, 'auroc': 0.99990284, 'binary_precision': 0.9994248, 'binary_recall': 0.99841136, 'binary_specificity': 0.98880845, 'binary_f1_score': 0.9989178}
confusion matrix:
      0      1
0  1502     17
1    47  29538
---- Validation: 
scalar performance:
{'acc': 0.8967391, 'precision': 0.8985993, 'recall': 0.896274, 'specificity': 0.896274, 'f1': 0.8965219, 'auroc': 0.94514954, 'binary_precision': 0.9225589, 'binary_recall': 0.8629921, 'binary_specificity': 0.9295559, 'binary_f1_score': 0.89178187}
confusion matrix:
     0    1
0  607   46
1   87  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.8408071, 'recall': 0.84013784, 'specificity': 0.84013784, 'f1': 0.8288631, 'auroc': 0.90087855, 'binary_precision': 0.9389671, 'binary_recall': 0.7407407, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.82815737}
confusion matrix:
     0    1
0  202   13
1   70  200
early stop counter: 4
val acc:0.89673912525177, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 21,now: 2024-07-11 06:17:53.983098,epoch time: 0:26:29.900904,used: 9:12:31.724434,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99701005, 'precision': 0.9900617, 'recall': 0.97747755, 'specificity': 0.97747755, 'f1': 0.98367846, 'auroc': 0.99978507, 'binary_precision': 0.9977386, 'binary_recall': 0.99912125, 'binary_specificity': 0.9558339, 'binary_f1_score': 0.9984295}
confusion matrix:
      0      1
0  1450     67
1    26  29561
---- Validation: 
scalar performance:
{'acc': 0.89052796, 'precision': 0.89365876, 'recall': 0.89116853, 'specificity': 0.89116853, 'f1': 0.8904058, 'auroc': 0.9544706, 'binary_precision': 0.85488504, 'binary_recall': 0.93700784, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.89406455}
confusion matrix:
     0    1
0  552  101
1   40  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.8824496, 'recall': 0.8849268, 'specificity': 0.8849268, 'f1': 0.88344145, 'auroc': 0.9338157, 'binary_precision': 0.90839696, 'binary_recall': 0.88148147, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8947368}
confusion matrix:
     0    1
0  191   24
1   32  238
early stop counter: 5
val acc:0.8905279636383057, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 22,now: 2024-07-11 06:44:09.835346,epoch time: 0:26:15.852248,used: 9:38:47.576682,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9979424, 'precision': 0.98892593, 'recall': 0.98892593, 'specificity': 0.98892593, 'f1': 0.98892593, 'auroc': 0.9998952, 'binary_precision': 0.99891835, 'binary_recall': 0.99891835, 'binary_specificity': 0.9789335, 'binary_f1_score': 0.99891835}
confusion matrix:
      0      1
0  1487     32
1    32  29553
---- Validation: 
scalar performance:
{'acc': 0.89363354, 'precision': 0.8936677, 'recall': 0.8935585, 'specificity': 0.8935585, 'f1': 0.8935996, 'auroc': 0.9436616, 'binary_precision': 0.8952381, 'binary_recall': 0.88818896, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.8916997}
confusion matrix:
     0    1
0  587   66
1   71  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.785567, 'precision': 0.814179, 'recall': 0.8021964, 'specificity': 0.8021964, 'f1': 0.7849003, 'auroc': 0.8984324, 'binary_precision': 0.94148934, 'binary_recall': 0.65555555, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.77292573}
confusion matrix:
     0    1
0  204   11
1   93  177
early stop counter: 6
val acc:0.8936335444450378, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 23,now: 2024-07-11 07:10:26.768656,epoch time: 0:26:16.933310,used: 10:05:04.509992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99723506, 'precision': 0.97825897, 'recall': 0.9926013, 'specificity': 0.9926013, 'f1': 0.98531175, 'auroc': 0.99980986, 'binary_precision': 0.9993568, 'binary_recall': 0.99773556, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9985455}
confusion matrix:
      0      1
0  1497     19
1    67  29521
---- Validation: 
scalar performance:
{'acc': 0.8757764, 'precision': 0.8860405, 'recall': 0.87464523, 'specificity': 0.87464523, 'f1': 0.8746886, 'auroc': 0.9548468, 'binary_precision': 0.945591, 'binary_recall': 0.7937008, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.8630137}
confusion matrix:
     0    1
0  624   29
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.672165, 'precision': 0.78743315, 'recall': 0.70555556, 'specificity': 0.70555556, 'f1': 0.6563641, 'auroc': 0.94956076, 'binary_precision': 1.0, 'binary_recall': 0.41111112, 'binary_specificity': 1.0, 'binary_f1_score': 0.5826772}
confusion matrix:
     0    1
0  215    0
1  159  111
early stop counter: 7
val acc:0.8757764101028442, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 24,now: 2024-07-11 07:36:46.153041,epoch time: 0:26:19.384385,used: 10:31:23.894377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99694574, 'precision': 0.9750129, 'recall': 0.99308234, 'specificity': 0.99308234, 'f1': 0.983859, 'auroc': 0.9998394, 'binary_precision': 0.9994242, 'binary_recall': 0.9973636, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.9983929}
confusion matrix:
      0      1
0  1501     17
1    78  29508
---- Validation: 
scalar performance:
{'acc': 0.8796584, 'precision': 0.88034964, 'recall': 0.87936354, 'specificity': 0.87936354, 'f1': 0.8795241, 'auroc': 0.9322039, 'binary_precision': 0.89344263, 'binary_recall': 0.8582677, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.875502}
confusion matrix:
     0    1
0  588   65
1   90  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268041, 'precision': 0.84896004, 'recall': 0.8416021, 'specificity': 0.8416021, 'f1': 0.82659113, 'auroc': 0.9119035, 'binary_precision': 0.969697, 'binary_recall': 0.7111111, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8205129}
confusion matrix:
     0    1
0  209    6
1   78  192
early stop counter: 8
val acc:0.8796584010124207, best validation acc: 0.8975155353546143, corresponding to test acc:                         0.8474226593971252 / 0.8948453664779663
after epoch: 25,now: 2024-07-11 08:03:04.582458,epoch time: 0:26:18.429417,used: 10:57:42.323794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9970422, 'precision': 0.99323124, 'recall': 0.97469664, 'specificity': 0.97469664, 'f1': 0.98376644, 'auroc': 0.99988794, 'binary_precision': 0.9974364, 'binary_recall': 0.9994592, 'binary_specificity': 0.9499341, 'binary_f1_score': 0.9984468}
confusion matrix:
      0      1
0  1442     76
1    16  29570
---- Validation: 
scalar performance:
{'acc': 0.8998447, 'precision': 0.89999324, 'recall': 0.90000963, 'specificity': 0.90000963, 'f1': 0.89984465, 'auroc': 0.94747925, 'binary_precision': 0.8880368, 'binary_recall': 0.911811, 'binary_specificity': 0.88820827, 'binary_f1_score': 0.89976686}
confusion matrix:
     0    1
0  580   73
1   56  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83505154, 'precision': 0.8442944, 'recall': 0.8452196, 'specificity': 0.8452196, 'f1': 0.8350452, 'auroc': 0.91758823, 'binary_precision': 0.9357798, 'binary_recall': 0.75555557, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.83606553}
confusion matrix:
     0    1
0  201   14
1   66  204
better model found
persisted
after epoch: 26,now: 2024-07-11 08:29:24.325484,epoch time: 0:26:19.743026,used: 11:24:02.066820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.996785, 'precision': 0.97486556, 'recall': 0.9914402, 'specificity': 0.9914402, 'f1': 0.98299384, 'auroc': 0.9998318, 'binary_precision': 0.99925494, 'binary_recall': 0.9973635, 'binary_specificity': 0.9855168, 'binary_f1_score': 0.9983083}
confusion matrix:
      0      1
0  1497     22
1    78  29507
---- Validation: 
scalar performance:
{'acc': 0.886646, 'precision': 0.8941932, 'recall': 0.8856905, 'specificity': 0.8856905, 'f1': 0.88590205, 'auroc': 0.9489118, 'binary_precision': 0.9453552, 'binary_recall': 0.81732285, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.8766892}
confusion matrix:
     0    1
0  623   30
1  116  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49278352, 'precision': 0.69732726, 'recall': 0.54349697, 'specificity': 0.54349697, 'f1': 0.40421262, 'auroc': 0.940758, 'binary_precision': 0.9285714, 'binary_recall': 0.096296296, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.17449665}
confusion matrix:
     0   1
0  213   2
1  244  26
early stop counter: 1
val acc:0.8866459727287292, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 27,now: 2024-07-11 08:55:44.269852,epoch time: 0:26:19.944368,used: 11:50:22.011188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9942451, 'precision': 0.9475066, 'recall': 0.99666256, 'specificity': 0.99666256, 'f1': 0.9706446, 'auroc': 0.99986994, 'binary_precision': 0.999966, 'binary_recall': 0.99398345, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.99696577}
confusion matrix:
      0      1
0  1518      1
1   178  29407
---- Validation: 
scalar performance:
{'acc': 0.63586956, 'precision': 0.7672101, 'recall': 0.63090396, 'specificity': 0.63090396, 'f1': 0.5802091, 'auroc': 0.93405783, 'binary_precision': 0.95108694, 'binary_recall': 0.27559054, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.42735043}
confusion matrix:
     0    1
0  644    9
1  460  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.43092784, 'precision': 0.31789473, 'recall': 0.48509905, 'specificity': 0.48509905, 'f1': 0.30714285, 'auroc': 0.8620328, 'binary_precision': 0.2, 'binary_recall': 0.0074074073, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.014285713}
confusion matrix:
     0  1
0  207  8
1  268  2
early stop counter: 2
val acc:0.635869562625885, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 28,now: 2024-07-11 09:22:04.890742,epoch time: 0:26:20.620890,used: 12:16:42.632078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9960134, 'precision': 0.96471024, 'recall': 0.99478173, 'specificity': 0.99478173, 'f1': 0.97921765, 'auroc': 0.9998664, 'binary_precision': 0.9996608, 'binary_recall': 0.9961467, 'binary_specificity': 0.9934167, 'binary_f1_score': 0.99790066}
confusion matrix:
      0      1
0  1509     10
1   114  29471
---- Validation: 
scalar performance:
{'acc': 0.742236, 'precision': 0.8091623, 'recall': 0.7389517, 'specificity': 0.7389517, 'f1': 0.72572684, 'auroc': 0.94983304, 'binary_precision': 0.9495549, 'binary_recall': 0.503937, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.65843624}
confusion matrix:
     0    1
0  636   17
1  315  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4515464, 'precision': 0.5731579, 'recall': 0.5059862, 'specificity': 0.5059862, 'f1': 0.33224636, 'auroc': 0.90882, 'binary_precision': 0.7, 'binary_recall': 0.025925925, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.049999997}
confusion matrix:
     0  1
0  212  3
1  263  7
early stop counter: 3
val acc:0.7422360181808472, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 29,now: 2024-07-11 09:48:23.101184,epoch time: 0:26:18.210442,used: 12:43:00.842520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9939236, 'precision': 0.9950421, 'recall': 0.9393095, 'specificity': 0.9393095, 'f1': 0.96533114, 'auroc': 0.999869, 'binary_precision': 0.9938182, 'binary_recall': 0.999831, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.99681556}
confusion matrix:
      0      1
0  1334    184
1     5  29581
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.83056754, 'recall': 0.76633227, 'specificity': 0.76633227, 'f1': 0.7518883, 'auroc': 0.920707, 'binary_precision': 0.6778017, 'binary_recall': 0.9905512, 'binary_specificity': 0.5421133, 'binary_f1_score': 0.80486244}
confusion matrix:
     0    1
0  354  299
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.85334706, 'recall': 0.84534883, 'specificity': 0.84534883, 'f1': 0.8481052, 'auroc': 0.89217913, 'binary_precision': 0.84375, 'binary_recall': 0.9, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.87096775}
confusion matrix:
     0    1
0  170   45
1   27  243
early stop counter: 4
val acc:0.763198733329773, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8350515365600586 / 0.8948453664779663
after epoch: 30,now: 2024-07-11 10:14:39.763101,epoch time: 0:26:16.661917,used: 13:09:17.504437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_22_seed_0_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:09:17.504437 at 2024-07-11 10:14:39.763101
persisted model performance metric: 

scalar performance:
{'acc': 0.83505154, 'precision': 0.8442944, 'recall': 0.8452196, 'specificity': 0.8452196, 'f1': 0.8350452, 'auroc': 0.91758823, 'binary_precision': 0.9357798, 'binary_recall': 0.75555557, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.83606553}
confusion matrix:
     0    1
0  201   14
1   66  204
oracle model performance metric: 

scalar performance:
{'acc': 0.89484537, 'precision': 0.89697874, 'recall': 0.9017657, 'specificity': 0.9017657, 'f1': 0.8946662, 'auroc': 0.9579156, 'binary_precision': 0.96595746, 'binary_recall': 0.84074074, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8990099}
confusion matrix:
     0    1
0  207    8
1   43  227
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456369 KiB |   6792 MiB |   1835 TiB |   1835 TiB |
|       from large pool | 415765 KiB |   6757 MiB |   1816 TiB |   1816 TiB |
|       from small pool |  40604 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456369 KiB |   6792 MiB |   1835 TiB |   1835 TiB |
|       from large pool | 415765 KiB |   6757 MiB |   1816 TiB |   1816 TiB |
|       from small pool |  40604 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |   6787 MiB |   1834 TiB |   1834 TiB |
|       from large pool | 407075 KiB |   6753 MiB |   1815 TiB |   1815 TiB |
|       from small pool |  40408 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8318 MiB |   8318 MiB |   8318 MiB |      0 B   |
|       from large pool |   8254 MiB |   8254 MiB |   8254 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 336206 KiB |   1138 MiB |   2402 TiB |   2402 TiB |
|       from large pool | 329707 KiB |   1131 MiB |   2383 TiB |   2383 TiB |
|       from small pool |   6499 KiB |     13 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1322    |    4873    |  261158 K  |  261156 K  |
|       from large pool |     187    |     783    |  164231 K  |  164231 K  |
|       from small pool |    1135    |    4685    |   96926 K  |   96925 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1322    |    4873    |  261158 K  |  261156 K  |
|       from large pool |     187    |     783    |  164231 K  |  164231 K  |
|       from small pool |    1135    |    4685    |   96926 K  |   96925 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     336    |     336    |     336    |       0    |
|       from large pool |     304    |     304    |     304    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    1997    |  163750 K  |  163750 K  |
|       from large pool |      34    |     303    |  119717 K  |  119717 K  |
|       from small pool |      40    |    1963    |   44032 K  |   44032 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6792 MiB |   1835 TiB |   1835 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   1816 TiB |   1816 TiB |
|       from small pool |      0 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6792 MiB |   1835 TiB |   1835 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   1816 TiB |   1816 TiB |
|       from small pool |      0 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |   1834 TiB |   1834 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   1815 TiB |   1815 TiB |
|       from small pool |      0 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    774 MiB |   8318 MiB |   8318 MiB |   7544 MiB |
|       from large pool |    728 MiB |   8254 MiB |   8254 MiB |   7526 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1138 MiB |   2402 TiB |   2402 TiB |
|       from large pool |  24320 KiB |   1131 MiB |   2383 TiB |   2383 TiB |
|       from small pool |      0 KiB |     22 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4873    |  261158 K  |  261158 K  |
|       from large pool |       2    |     783    |  164231 K  |  164231 K  |
|       from small pool |       0    |    4685    |   96926 K  |   96926 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4873    |  261158 K  |  261158 K  |
|       from large pool |       2    |     783    |  164231 K  |  164231 K  |
|       from small pool |       0    |    4685    |   96926 K  |   96926 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     336    |     336    |     279    |
|       from large pool |      34    |     304    |     304    |     270    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |  163750 K  |  163750 K  |
|       from large pool |       3    |     303    |  119717 K  |  119717 K  |
|       from small pool |       0    |    1963    |   44032 K  |   44032 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6792 MiB |   1835 TiB |   1835 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   1816 TiB |   1816 TiB |
|       from small pool |      0 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6792 MiB |   1835 TiB |   1835 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   1816 TiB |   1816 TiB |
|       from small pool |      0 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |   1834 TiB |   1834 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   1815 TiB |   1815 TiB |
|       from small pool |      0 KiB |     56 MiB |     18 TiB |     18 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    774 MiB |   8318 MiB |   8318 MiB |   7544 MiB |
|       from large pool |    728 MiB |   8254 MiB |   8254 MiB |   7526 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1138 MiB |   2402 TiB |   2402 TiB |
|       from large pool |  24320 KiB |   1131 MiB |   2383 TiB |   2383 TiB |
|       from small pool |      0 KiB |     22 MiB |     19 TiB |     19 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4873    |  261158 K  |  261158 K  |
|       from large pool |       2    |     783    |  164231 K  |  164231 K  |
|       from small pool |       0    |    4685    |   96926 K  |   96926 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4873    |  261158 K  |  261158 K  |
|       from large pool |       2    |     783    |  164231 K  |  164231 K  |
|       from small pool |       0    |    4685    |   96926 K  |   96926 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     336    |     336    |     279    |
|       from large pool |      34    |     304    |     304    |     270    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1997    |  163750 K  |  163750 K  |
|       from large pool |       3    |     303    |  119717 K  |  119717 K  |
|       from small pool |       0    |    1963    |   44032 K  |   44032 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149

 Experiment start at: 2024-07-11 10:27:50.759187
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9909662, 'precision': 0.9359085, 'recall': 0.9721716, 'specificity': 0.9721716, 'f1': 0.953225, 'auroc': 0.9981867, 'binary_precision': 0.9974967, 'binary_recall': 0.99299544, 'binary_specificity': 0.95134777, 'binary_f1_score': 0.995241}
confusion matrix:
      0      1
0  1447     74
1   208  29487
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.78705615, 'recall': 0.7016385, 'specificity': 0.7016385, 'f1': 0.6743021, 'auroc': 0.9253237, 'binary_precision': 0.62222224, 'binary_recall': 0.9777778, 'binary_specificity': 0.42549923, 'binary_f1_score': 0.7604939}
confusion matrix:
     0    1
0  277  374
1   14  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6359833, 'precision': 0.72342294, 'recall': 0.6160387, 'specificity': 0.6160387, 'f1': 0.5758349, 'auroc': 0.8973386, 'binary_precision': 0.59753084, 'binary_recall': 0.95652175, 'binary_specificity': 0.27555555, 'binary_f1_score': 0.7355623}
confusion matrix:
    0    1
0  62  163
1  11  242
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 10:54:24.168182,epoch time: 0:26:33.408995,used: 0:26:33.408995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9945541, 'precision': 0.9700777, 'recall': 0.9712504, 'specificity': 0.9712504, 'f1': 0.97066325, 'auroc': 0.9991946, 'binary_precision': 0.99720454, 'binary_recall': 0.9970702, 'binary_specificity': 0.94543064, 'binary_f1_score': 0.99713737}
confusion matrix:
      0      1
0  1438     83
1    87  29608
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.843887, 'recall': 0.82183814, 'specificity': 0.82183814, 'f1': 0.8170969, 'auroc': 0.9336771, 'binary_precision': 0.74844337, 'binary_recall': 0.9539682, 'binary_specificity': 0.6897081, 'binary_f1_score': 0.83879966}
confusion matrix:
     0    1
0  449  202
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.8553632, 'recall': 0.8547826, 'specificity': 0.8547826, 'f1': 0.85503876, 'auroc': 0.9235134, 'binary_precision': 0.859375, 'binary_recall': 0.8695652, 'binary_specificity': 0.84, 'binary_f1_score': 0.86444}
confusion matrix:
     0    1
0  189   36
1   33  220
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 11:21:07.197748,epoch time: 0:26:43.029566,used: 0:53:16.438561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9874423, 'precision': 0.9825022, 'recall': 0.87947965, 'specificity': 0.87947965, 'f1': 0.9241797, 'auroc': 0.99795735, 'binary_precision': 0.9878471, 'binary_recall': 0.9990908, 'binary_specificity': 0.75986844, 'binary_f1_score': 0.9934371}
confusion matrix:
      0      1
0  1155    365
1    27  29669
---- Validation: 
scalar performance:
{'acc': 0.5464481, 'precision': 0.74042916, 'recall': 0.5536866, 'specificity': 0.5536866, 'f1': 0.44210207, 'auroc': 0.89925635, 'binary_precision': 0.520332, 'binary_recall': 0.99523807, 'binary_specificity': 0.11213518, 'binary_f1_score': 0.6833788}
confusion matrix:
    0    1
0  73  578
1   3  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5523012, 'precision': 0.77087796, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.39799908, 'auroc': 0.88852, 'binary_precision': 0.5417559, 'binary_recall': 1.0, 'binary_specificity': 0.04888889, 'binary_f1_score': 0.7027778}
confusion matrix:
    0    1
0  11  214
1   0  253
early stop counter: 1
val acc:0.5464481115341187, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8556485176086426 / 0.8556485176086426
after epoch: 3,now: 2024-07-11 11:47:32.877578,epoch time: 0:26:25.679830,used: 1:19:42.118391,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98231673, 'precision': 0.86952275, 'recall': 0.9822844, 'specificity': 0.9822844, 'f1': 0.9173473, 'auroc': 0.99852794, 'binary_precision': 0.99907523, 'binary_recall': 0.98232025, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9906269}
confusion matrix:
      0      1
0  1494     27
1   525  29170
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.8113797, 'recall': 0.76344085, 'specificity': 0.76344085, 'f1': 0.7563983, 'auroc': 0.9157047, 'binary_precision': 0.92544985, 'binary_recall': 0.5714286, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.7065751}
confusion matrix:
     0    1
0  622   29
1  270  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6087866, 'precision': 0.75899863, 'recall': 0.6299429, 'specificity': 0.6299429, 'f1': 0.56281704, 'auroc': 0.8953184, 'binary_precision': 0.9714286, 'binary_recall': 0.26877472, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.42105263}
confusion matrix:
     0   1
0  223   2
1  185  68
early stop counter: 2
val acc:0.7665886282920837, best validation acc: 0.8196721076965332, corresponding to test acc:                         0.8556485176086426 / 0.8556485176086426
after epoch: 4,now: 2024-07-11 12:13:54.276225,epoch time: 0:26:21.398647,used: 1:46:03.517038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9925038, 'precision': 0.9420525, 'recall': 0.9826485, 'specificity': 0.9826485, 'f1': 0.96134794, 'auroc': 0.99909186, 'binary_precision': 0.9985447, 'binary_recall': 0.99356794, 'binary_specificity': 0.9717291, 'binary_f1_score': 0.9960501}
confusion matrix:
      0      1
0  1478     43
1   191  29504
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86504054, 'recall': 0.8639529, 'specificity': 0.8639529, 'f1': 0.8633317, 'auroc': 0.92319506, 'binary_precision': 0.83604133, 'binary_recall': 0.8984127, 'binary_specificity': 0.8294931, 'binary_f1_score': 0.86610556}
confusion matrix:
     0    1
0  540  111
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83054394, 'precision': 0.8307888, 'recall': 0.8288537, 'specificity': 0.8288537, 'f1': 0.8295225, 'auroc': 0.9257796, 'binary_precision': 0.82824427, 'binary_recall': 0.8577075, 'binary_specificity': 0.8, 'binary_f1_score': 0.8427185}
confusion matrix:
     0    1
0  180   45
1   36  217
better model found
persisted
after epoch: 5,now: 2024-07-11 12:40:15.332580,epoch time: 0:26:21.056355,used: 2:12:24.573393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.992632, 'precision': 0.9417962, 'recall': 0.9845793, 'specificity': 0.9845793, 'f1': 0.9620762, 'auroc': 0.9993212, 'binary_precision': 0.99874747, 'binary_recall': 0.9935008, 'binary_specificity': 0.9756579, 'binary_f1_score': 0.9961173}
confusion matrix:
      0      1
0  1483     37
1   193  29503
---- Validation: 
scalar performance:
{'acc': 0.8953942, 'precision': 0.89545083, 'recall': 0.8955453, 'specificity': 0.8955453, 'f1': 0.8953911, 'auroc': 0.9340087, 'binary_precision': 0.88509315, 'binary_recall': 0.9047619, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.8948195}
confusion matrix:
     0    1
0  577   74
1   60  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933054, 'precision': 0.8945017, 'recall': 0.89552045, 'specificity': 0.89552045, 'f1': 0.89328253, 'auroc': 0.9378656, 'binary_precision': 0.9353448, 'binary_recall': 0.8577075, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.89484537}
confusion matrix:
     0    1
0  210   15
1   36  217
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-11 13:06:36.288974,epoch time: 0:26:20.956394,used: 2:38:45.529787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9933688, 'precision': 0.9775242, 'recall': 0.9497306, 'specificity': 0.9497306, 'f1': 0.9631634, 'auroc': 0.99911153, 'binary_precision': 0.9949644, 'binary_recall': 0.9980805, 'binary_specificity': 0.90138066, 'binary_f1_score': 0.99652004}
confusion matrix:
      0      1
0  1371    150
1    57  29638
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8692652, 'recall': 0.8658474, 'specificity': 0.8658474, 'f1': 0.8647263, 'auroc': 0.92671835, 'binary_precision': 0.8250356, 'binary_recall': 0.9206349, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.87021756}
confusion matrix:
     0    1
0  528  123
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8595686, 'recall': 0.85898113, 'specificity': 0.85898113, 'f1': 0.85924065, 'auroc': 0.9096004, 'binary_precision': 0.86328125, 'binary_recall': 0.8735178, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.8683694}
confusion matrix:
     0    1
0  190   35
1   32  221
early stop counter: 1
val acc:0.8649492859840393, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 7,now: 2024-07-11 13:32:57.573165,epoch time: 0:26:21.284191,used: 3:05:06.813978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99589956, 'precision': 0.9718157, 'recall': 0.98474526, 'specificity': 0.98474526, 'f1': 0.9781828, 'auroc': 0.999696, 'binary_precision': 0.9985835, 'binary_recall': 0.99710387, 'binary_specificity': 0.9723866, 'binary_f1_score': 0.99784315}
confusion matrix:
      0      1
0  1479     42
1    86  29609
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.86487424, 'recall': 0.85906297, 'specificity': 0.85906297, 'f1': 0.85748565, 'auroc': 0.9321861, 'binary_precision': 0.8102493, 'binary_recall': 0.9285714, 'binary_specificity': 0.78955454, 'binary_f1_score': 0.8653846}
confusion matrix:
     0    1
0  514  137
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.87507224, 'recall': 0.87625825, 'specificity': 0.87625825, 'f1': 0.87442195, 'auroc': 0.9025384, 'binary_precision': 0.9106383, 'binary_recall': 0.8458498, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.87704915}
confusion matrix:
     0    1
0  204   21
1   39  214
early stop counter: 2
val acc:0.8579235076904297, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 8,now: 2024-07-11 13:59:22.750277,epoch time: 0:26:25.177112,used: 3:31:31.991090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99000514, 'precision': 0.99050945, 'recall': 0.90080166, 'specificity': 0.90080166, 'f1': 0.94065887, 'auroc': 0.9993556, 'binary_precision': 0.989962, 'binary_recall': 0.99962956, 'binary_specificity': 0.8019737, 'binary_f1_score': 0.99477226}
confusion matrix:
      0      1
0  1219    301
1    11  29685
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.8185142, 'recall': 0.7698668, 'specificity': 0.7698668, 'f1': 0.75809747, 'auroc': 0.9372461, 'binary_precision': 0.6857464, 'binary_recall': 0.96984124, 'binary_specificity': 0.56989247, 'binary_f1_score': 0.80341876}
confusion matrix:
     0    1
0  371  280
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.8485327, 'recall': 0.83380765, 'specificity': 0.83380765, 'f1': 0.8358773, 'auroc': 0.9234607, 'binary_precision': 0.80344826, 'binary_recall': 0.9209486, 'binary_specificity': 0.74666667, 'binary_f1_score': 0.8581952}
confusion matrix:
     0    1
0  168   57
1   20  233
early stop counter: 3
val acc:0.7665886282920837, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 9,now: 2024-07-11 14:26:18.940157,epoch time: 0:26:56.189880,used: 3:58:28.180970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99567527, 'precision': 0.9785291, 'recall': 0.9746468, 'specificity': 0.9746468, 'f1': 0.9765791, 'auroc': 0.99954236, 'binary_precision': 0.99750906, 'binary_recall': 0.9979458, 'binary_specificity': 0.95134777, 'binary_f1_score': 0.9977274}
confusion matrix:
      0      1
0  1447     74
1    61  29634
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8687743, 'recall': 0.8657962, 'specificity': 0.8657962, 'f1': 0.8647594, 'auroc': 0.9267281, 'binary_precision': 0.8268956, 'binary_recall': 0.9174603, 'binary_specificity': 0.8141321, 'binary_f1_score': 0.869827}
confusion matrix:
     0    1
0  530  121
1   52  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.81320304, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.81311965, 'auroc': 0.8574791, 'binary_precision': 0.8228347, 'binary_recall': 0.82608694, 'binary_specificity': 0.8, 'binary_f1_score': 0.8244576}
confusion matrix:
     0    1
0  180   45
1   44  209
early stop counter: 4
val acc:0.8649492859840393, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 10,now: 2024-07-11 14:53:40.352752,epoch time: 0:27:21.412595,used: 4:25:49.593565,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9967645, 'precision': 0.9823928, 'recall': 0.9826939, 'specificity': 0.9826939, 'f1': 0.98254335, 'auroc': 0.9996947, 'binary_precision': 0.9983162, 'binary_recall': 0.9982826, 'binary_specificity': 0.96710527, 'binary_f1_score': 0.9982994}
confusion matrix:
      0      1
0  1470     50
1    51  29645
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.8612399, 'recall': 0.85890937, 'specificity': 0.85890937, 'f1': 0.8591441, 'auroc': 0.91494405, 'binary_precision': 0.88265306, 'binary_recall': 0.8238095, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.8522167}
confusion matrix:
     0    1
0  582   69
1  111  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7821648, 'recall': 0.7384014, 'specificity': 0.7384014, 'f1': 0.717839, 'auroc': 0.89203334, 'binary_precision': 0.9236111, 'binary_recall': 0.5256917, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.67002517}
confusion matrix:
     0    1
0  214   11
1  120  133
early stop counter: 5
val acc:0.8594847917556763, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 11,now: 2024-07-11 15:21:15.835153,epoch time: 0:27:35.482401,used: 4:53:25.075966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9953229, 'precision': 0.9677387, 'recall': 0.98288274, 'specificity': 0.98288274, 'f1': 0.9751757, 'auroc': 0.99954796, 'binary_precision': 0.99841446, 'binary_recall': 0.99666613, 'binary_specificity': 0.9690993, 'binary_f1_score': 0.9975395}
confusion matrix:
      0      1
0  1474     47
1    99  29596
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8617803, 'recall': 0.86182797, 'specificity': 0.86182797, 'f1': 0.86179936, 'auroc': 0.9029552, 'binary_precision': 0.8578199, 'binary_recall': 0.86190474, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.85985744}
confusion matrix:
     0    1
0  561   90
1   87  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7740586, 'precision': 0.78305435, 'recall': 0.7789372, 'specificity': 0.7789372, 'f1': 0.7737377, 'auroc': 0.8289855, 'binary_precision': 0.85024154, 'binary_recall': 0.6956522, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.7652174}
confusion matrix:
     0    1
0  194   31
1   77  176
early stop counter: 6
val acc:0.8618267178535461, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 12,now: 2024-07-11 15:48:57.665688,epoch time: 0:27:41.830535,used: 5:21:06.906501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9963801, 'precision': 0.9814751, 'recall': 0.9793708, 'specificity': 0.9793708, 'f1': 0.98042035, 'auroc': 0.99968946, 'binary_precision': 0.99798, 'binary_recall': 0.99821526, 'binary_specificity': 0.9605263, 'binary_f1_score': 0.99809754}
confusion matrix:
      0      1
0  1460     60
1    53  29643
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.87280905, 'recall': 0.8668715, 'specificity': 0.8668715, 'f1': 0.86531615, 'auroc': 0.9305439, 'binary_precision': 0.8171745, 'binary_recall': 0.93650794, 'binary_specificity': 0.797235, 'binary_f1_score': 0.87278104}
confusion matrix:
     0    1
0  519  132
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8179916, 'precision': 0.82178056, 'recall': 0.81429076, 'specificity': 0.81429076, 'f1': 0.81572616, 'auroc': 0.90387356, 'binary_precision': 0.79856116, 'binary_recall': 0.8774704, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.83615816}
confusion matrix:
     0    1
0  169   56
1   31  222
early stop counter: 7
val acc:0.8657299280166626, best validation acc: 0.8953942060470581, corresponding to test acc:                         0.8933054208755493 / 0.8933054208755493
after epoch: 13,now: 2024-07-11 16:16:14.574481,epoch time: 0:27:16.908793,used: 5:48:23.815294,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99743724, 'precision': 0.98766077, 'recall': 0.9846178, 'specificity': 0.9846178, 'f1': 0.98613405, 'auroc': 0.9998561, 'binary_precision': 0.9984851, 'binary_recall': 0.9988214, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.99865323}
confusion matrix:
      0      1
0  1476     45
1    35  29660
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.8987925, 'recall': 0.89877117, 'specificity': 0.89877117, 'f1': 0.8985167, 'auroc': 0.9429205, 'binary_precision': 0.8834356, 'binary_recall': 0.9142857, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.8985959}
confusion matrix:
     0    1
0  575   76
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78451884, 'precision': 0.80754584, 'recall': 0.7922617, 'specificity': 0.7922617, 'f1': 0.78292173, 'auroc': 0.875942, 'binary_precision': 0.9076087, 'binary_recall': 0.66007906, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7643021}
confusion matrix:
     0    1
0  208   17
1   86  167
better model found
persisted
after epoch: 14,now: 2024-07-11 16:43:12.868697,epoch time: 0:26:58.294216,used: 6:15:22.109510,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9967965, 'precision': 0.987777, 'recall': 0.9774194, 'specificity': 0.9774194, 'f1': 0.98253626, 'auroc': 0.99973965, 'binary_precision': 0.9977463, 'binary_recall': 0.99888873, 'binary_specificity': 0.95595, 'binary_f1_score': 0.9983172}
confusion matrix:
      0      1
0  1454     67
1    33  29662
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8683645, 'recall': 0.86292887, 'specificity': 0.86292887, 'f1': 0.86143625, 'auroc': 0.93918264, 'binary_precision': 0.81502086, 'binary_recall': 0.93015873, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.8687917}
confusion matrix:
     0    1
0  518  133
1   44  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.86489236, 'recall': 0.86489236, 'specificity': 0.86489236, 'f1': 0.8619247, 'auroc': 0.9174001, 'binary_precision': 0.91555554, 'binary_recall': 0.81422925, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8619247}
confusion matrix:
     0    1
0  206   19
1   47  206
early stop counter: 1
val acc:0.8618267178535461, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 15,now: 2024-07-11 17:10:12.247620,epoch time: 0:26:59.378923,used: 6:42:21.488433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9966684, 'precision': 0.9901514, 'recall': 0.9736093, 'specificity': 0.9736093, 'f1': 0.9817223, 'auroc': 0.9998002, 'binary_precision': 0.99734443, 'binary_recall': 0.9991581, 'binary_specificity': 0.9480605, 'binary_f1_score': 0.9982505}
confusion matrix:
      0      1
0  1442     79
1    25  29670
---- Validation: 
scalar performance:
{'acc': 0.8790008, 'precision': 0.879123, 'recall': 0.87918586, 'specificity': 0.87918586, 'f1': 0.8789996, 'auroc': 0.930639, 'binary_precision': 0.86707884, 'binary_recall': 0.89047617, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.87862176}
confusion matrix:
     0    1
0  565   86
1   69  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263598, 'precision': 0.8301133, 'recall': 0.829574, 'specificity': 0.829574, 'f1': 0.82635295, 'auroc': 0.8640492, 'binary_precision': 0.8828829, 'binary_recall': 0.77470356, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8252632}
confusion matrix:
     0    1
0  199   26
1   57  196
early stop counter: 2
val acc:0.8790007829666138, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 16,now: 2024-07-11 17:37:12.060913,epoch time: 0:26:59.813293,used: 7:09:21.301726,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9963801, 'precision': 0.9691981, 'recall': 0.99341893, 'specificity': 0.99341893, 'f1': 0.98096734, 'auroc': 0.9997958, 'binary_precision': 0.9994934, 'binary_recall': 0.9966998, 'binary_specificity': 0.99013805, 'binary_f1_score': 0.9980947}
confusion matrix:
      0      1
0  1506     15
1    98  29597
---- Validation: 
scalar performance:
{'acc': 0.882904, 'precision': 0.88800275, 'recall': 0.8819765, 'specificity': 0.8819765, 'f1': 0.88231003, 'auroc': 0.93803185, 'binary_precision': 0.9285714, 'binary_recall': 0.82539684, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8739496}
confusion matrix:
     0    1
0  611   40
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77615064, 'precision': 0.8186631, 'recall': 0.7865701, 'specificity': 0.7865701, 'f1': 0.7721934, 'auroc': 0.88381207, 'binary_precision': 0.9506173, 'binary_recall': 0.6086956, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.74216866}
confusion matrix:
     0    1
0  217    8
1   99  154
early stop counter: 3
val acc:0.8829039931297302, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 17,now: 2024-07-11 18:04:17.426438,epoch time: 0:27:05.365525,used: 7:36:26.667251,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99589956, 'precision': 0.99218035, 'recall': 0.9632246, 'specificity': 0.9632246, 'f1': 0.97721446, 'auroc': 0.9997138, 'binary_precision': 0.9962738, 'binary_recall': 0.9994275, 'binary_specificity': 0.9270217, 'binary_f1_score': 0.99784815}
confusion matrix:
      0      1
0  1410    111
1    17  29678
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.83671176, 'recall': 0.82150537, 'specificity': 0.82150537, 'f1': 0.81791043, 'auroc': 0.91319096, 'binary_precision': 0.7567568, 'binary_recall': 0.93333334, 'binary_specificity': 0.7096774, 'binary_f1_score': 0.8358209}
confusion matrix:
     0    1
0  462  189
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8096234, 'precision': 0.8271204, 'recall': 0.8024506, 'specificity': 0.8024506, 'f1': 0.8039951, 'auroc': 0.8877119, 'binary_precision': 0.7647059, 'binary_recall': 0.9249012, 'binary_specificity': 0.68, 'binary_f1_score': 0.8372093}
confusion matrix:
     0    1
0  153   72
1   19  234
early stop counter: 4
val acc:0.8196721076965332, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 18,now: 2024-07-11 18:31:29.201700,epoch time: 0:27:11.775262,used: 8:03:38.442513,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99785364, 'precision': 0.99037457, 'recall': 0.98639613, 'specificity': 0.98639613, 'f1': 0.9883764, 'auroc': 0.99989706, 'binary_precision': 0.9986536, 'binary_recall': 0.99909073, 'binary_specificity': 0.97370154, 'binary_f1_score': 0.99887216}
confusion matrix:
      0      1
0  1481     40
1    27  29668
---- Validation: 
scalar performance:
{'acc': 0.8953942, 'precision': 0.8953562, 'recall': 0.8954429, 'specificity': 0.8954429, 'f1': 0.8953799, 'auroc': 0.9400288, 'binary_precision': 0.8899371, 'binary_recall': 0.8984127, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.8941548}
confusion matrix:
     0    1
0  581   70
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87238497, 'precision': 0.87637246, 'recall': 0.8757576, 'specificity': 0.8757576, 'f1': 0.8723799, 'auroc': 0.9233202, 'binary_precision': 0.9324324, 'binary_recall': 0.8181818, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.87157893}
confusion matrix:
     0    1
0  210   15
1   46  207
early stop counter: 5
val acc:0.8953942060470581, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 19,now: 2024-07-11 18:58:38.744905,epoch time: 0:27:09.543205,used: 8:30:47.985718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9976294, 'precision': 0.98429525, 'recall': 0.9903329, 'specificity': 0.9903329, 'f1': 0.9872932, 'auroc': 0.9998499, 'binary_precision': 0.99909014, 'binary_recall': 0.99841726, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9987536}
confusion matrix:
      0      1
0  1494     27
1    47  29648
---- Validation: 
scalar performance:
{'acc': 0.8953942, 'precision': 0.8956596, 'recall': 0.8951869, 'specificity': 0.8951869, 'f1': 0.895316, 'auroc': 0.9396143, 'binary_precision': 0.9025974, 'binary_recall': 0.8825397, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.8924558}
confusion matrix:
     0    1
0  591   60
1   74  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8410042, 'precision': 0.85587436, 'recall': 0.84709704, 'specificity': 0.84709704, 'f1': 0.84053236, 'auroc': 0.91295564, 'binary_precision': 0.9447236, 'binary_recall': 0.743083, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8318584}
confusion matrix:
     0    1
0  214   11
1   65  188
early stop counter: 6
val acc:0.8953942060470581, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 20,now: 2024-07-11 19:25:04.109102,epoch time: 0:26:25.364197,used: 8:57:13.349915,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9976935, 'precision': 0.98579603, 'recall': 0.9894309, 'specificity': 0.9894309, 'f1': 0.98760587, 'auroc': 0.9998348, 'binary_precision': 0.99898934, 'binary_recall': 0.99858564, 'binary_specificity': 0.9802761, 'binary_f1_score': 0.9987874}
confusion matrix:
      0      1
0  1491     30
1    42  29653
---- Validation: 
scalar performance:
{'acc': 0.89227164, 'precision': 0.89223194, 'recall': 0.8922683, 'specificity': 0.8922683, 'f1': 0.8922479, 'auroc': 0.9321898, 'binary_precision': 0.8892405, 'binary_recall': 0.8920635, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.89064974}
confusion matrix:
     0    1
0  581   70
1   68  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79288703, 'precision': 0.8120066, 'recall': 0.7999209, 'specificity': 0.7999209, 'f1': 0.7917706, 'auroc': 0.87950814, 'binary_precision': 0.9052632, 'binary_recall': 0.6798419, 'binary_specificity': 0.92, 'binary_f1_score': 0.7765237}
confusion matrix:
     0    1
0  207   18
1   81  172
early stop counter: 7
val acc:0.8922716379165649, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 21,now: 2024-07-11 19:51:34.557827,epoch time: 0:26:30.448725,used: 9:23:43.798640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.997245, 'precision': 0.99148643, 'recall': 0.9785907, 'specificity': 0.9785907, 'f1': 0.98494315, 'auroc': 0.99983484, 'binary_precision': 0.9978478, 'binary_recall': 0.9992591, 'binary_specificity': 0.9579224, 'binary_f1_score': 0.998553}
confusion matrix:
      0      1
0  1457     64
1    22  29673
---- Validation: 
scalar performance:
{'acc': 0.891491, 'precision': 0.89277196, 'recall': 0.89198667, 'specificity': 0.89198667, 'f1': 0.89146453, 'auroc': 0.9431912, 'binary_precision': 0.86587185, 'binary_recall': 0.9222222, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.8931591}
confusion matrix:
     0    1
0  561   90
1   49  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.83920014, 'recall': 0.83821696, 'specificity': 0.83821696, 'f1': 0.83470994, 'auroc': 0.90592885, 'binary_precision': 0.8954545, 'binary_recall': 0.7786561, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.83298093}
confusion matrix:
     0    1
0  202   23
1   56  197
early stop counter: 8
val acc:0.8914909958839417, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 22,now: 2024-07-11 20:17:58.389237,epoch time: 0:26:23.831410,used: 9:50:07.630050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99682856, 'precision': 0.98274916, 'recall': 0.9830503, 'specificity': 0.9830503, 'f1': 0.98289967, 'auroc': 0.9997122, 'binary_precision': 0.99834985, 'binary_recall': 0.9983162, 'binary_specificity': 0.96778435, 'binary_f1_score': 0.99833304}
confusion matrix:
      0      1
0  1472     49
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.8750976, 'precision': 0.87574625, 'recall': 0.8747568, 'specificity': 0.8747568, 'f1': 0.87494326, 'auroc': 0.9198139, 'binary_precision': 0.8877888, 'binary_recall': 0.85396826, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.87055016}
confusion matrix:
     0    1
0  583   68
1   92  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263598, 'precision': 0.8484776, 'recall': 0.8337549, 'specificity': 0.8337549, 'f1': 0.82531315, 'auroc': 0.9159771, 'binary_precision': 0.95212764, 'binary_recall': 0.7075099, 'binary_specificity': 0.96, 'binary_f1_score': 0.8117914}
confusion matrix:
     0    1
0  216    9
1   74  179
early stop counter: 9
val acc:0.8750975728034973, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 23,now: 2024-07-11 20:44:25.286264,epoch time: 0:26:26.897027,used: 10:16:34.527077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99743724, 'precision': 0.9867682, 'recall': 0.9855535, 'specificity': 0.9855535, 'f1': 0.98616004, 'auroc': 0.9998217, 'binary_precision': 0.9985858, 'binary_recall': 0.99872035, 'binary_specificity': 0.9723866, 'binary_f1_score': 0.9986531}
confusion matrix:
      0      1
0  1479     42
1    38  29657
---- Validation: 
scalar performance:
{'acc': 0.88368464, 'precision': 0.88364744, 'recall': 0.88366616, 'specificity': 0.88366616, 'f1': 0.88365626, 'auroc': 0.93317723, 'binary_precision': 0.88114107, 'binary_recall': 0.8825397, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.8818398}
confusion matrix:
     0    1
0  576   75
1   74  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85146445, 'precision': 0.8522313, 'recall': 0.85328937, 'specificity': 0.85328937, 'f1': 0.8514117, 'auroc': 0.8919631, 'binary_precision': 0.8888889, 'binary_recall': 0.8221344, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8542094}
confusion matrix:
     0    1
0  199   26
1   45  208
early stop counter: 10
val acc:0.8836846351623535, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.784518837928772 / 0.8933054208755493
after epoch: 24,now: 2024-07-11 21:11:01.968052,epoch time: 0:26:36.681788,used: 10:43:11.208865,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9976294, 'precision': 0.98429525, 'recall': 0.9903329, 'specificity': 0.9903329, 'f1': 0.9872932, 'auroc': 0.9998773, 'binary_precision': 0.99909014, 'binary_recall': 0.99841726, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9987536}
confusion matrix:
      0      1
0  1494     27
1    47  29648
---- Validation: 
scalar performance:
{'acc': 0.90398127, 'precision': 0.9043748, 'recall': 0.90373784, 'specificity': 0.90373784, 'f1': 0.9038967, 'auroc': 0.94154537, 'binary_precision': 0.91353995, 'binary_recall': 0.8888889, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.90104586}
confusion matrix:
     0    1
0  598   53
1   70  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8012552, 'precision': 0.8320477, 'recall': 0.8100395, 'specificity': 0.8100395, 'f1': 0.79914457, 'auroc': 0.92091346, 'binary_precision': 0.9488636, 'binary_recall': 0.66007906, 'binary_specificity': 0.96, 'binary_f1_score': 0.77855474}
confusion matrix:
     0    1
0  216    9
1   86  167
better model found
persisted
after epoch: 25,now: 2024-07-11 21:37:44.490327,epoch time: 0:26:42.522275,used: 11:09:53.731140,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9979498, 'precision': 0.98746157, 'recall': 0.9905013, 'specificity': 0.9905013, 'f1': 0.9889762, 'auroc': 0.99989057, 'binary_precision': 0.99909043, 'binary_recall': 0.998754, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9989222}
confusion matrix:
      0      1
0  1494     27
1    37  29658
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86696655, 'recall': 0.86420894, 'specificity': 0.86420894, 'f1': 0.86321163, 'auroc': 0.92534685, 'binary_precision': 0.82639885, 'binary_recall': 0.9142857, 'binary_specificity': 0.8141321, 'binary_f1_score': 0.86812365}
confusion matrix:
     0    1
0  530  121
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84518826, 'precision': 0.8516756, 'recall': 0.84932804, 'specificity': 0.84932804, 'f1': 0.8451205, 'auroc': 0.9050505, 'binary_precision': 0.9162791, 'binary_recall': 0.7786561, 'binary_specificity': 0.92, 'binary_f1_score': 0.8418803}
confusion matrix:
     0    1
0  207   18
1   56  197
early stop counter: 1
val acc:0.8633880019187927, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.8012552261352539 / 0.8933054208755493
after epoch: 26,now: 2024-07-11 22:04:25.701228,epoch time: 0:26:41.210901,used: 11:36:34.942041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9967645, 'precision': 0.9787046, 'recall': 0.9867593, 'specificity': 0.9867593, 'f1': 0.9826944, 'auroc': 0.999712, 'binary_precision': 0.9987529, 'binary_recall': 0.99784476, 'binary_specificity': 0.9756739, 'binary_f1_score': 0.9982986}
confusion matrix:
      0      1
0  1484     37
1    64  29631
---- Validation: 
scalar performance:
{'acc': 0.8868072, 'precision': 0.887169, 'recall': 0.8865591, 'specificity': 0.8865591, 'f1': 0.8867074, 'auroc': 0.93042445, 'binary_precision': 0.89559543, 'binary_recall': 0.87142855, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.8833467}
confusion matrix:
     0    1
0  587   64
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8410042, 'precision': 0.8546258, 'recall': 0.8468511, 'specificity': 0.8468511, 'f1': 0.84060234, 'auroc': 0.9240755, 'binary_precision': 0.9402985, 'binary_recall': 0.74703556, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.83259916}
confusion matrix:
     0    1
0  213   12
1   64  189
early stop counter: 2
val acc:0.8868072032928467, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.8012552261352539 / 0.8933054208755493
after epoch: 27,now: 2024-07-11 22:31:04.594073,epoch time: 0:26:38.892845,used: 12:03:13.834886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9969887, 'precision': 0.99193966, 'recall': 0.97533715, 'specificity': 0.97533715, 'f1': 0.98347974, 'auroc': 0.99974227, 'binary_precision': 0.9975125, 'binary_recall': 0.99932647, 'binary_specificity': 0.95134777, 'binary_f1_score': 0.9984186}
confusion matrix:
      0      1
0  1447     74
1    20  29675
---- Validation: 
scalar performance:
{'acc': 0.89773613, 'precision': 0.8987579, 'recall': 0.8981823, 'specificity': 0.8981823, 'f1': 0.8977202, 'auroc': 0.9470973, 'binary_precision': 0.87406296, 'binary_recall': 0.9253968, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.89899766}
confusion matrix:
     0    1
0  567   84
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83054394, 'precision': 0.83042717, 'recall': 0.83155906, 'specificity': 0.83155906, 'f1': 0.83037686, 'auroc': 0.91205966, 'binary_precision': 0.85833335, 'binary_recall': 0.81422925, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8356998}
confusion matrix:
     0    1
0  191   34
1   47  206
early stop counter: 3
val acc:0.897736132144928, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.8012552261352539 / 0.8933054208755493
after epoch: 28,now: 2024-07-11 22:57:44.192584,epoch time: 0:26:39.598511,used: 12:29:53.433397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9976294, 'precision': 0.9834352, 'recall': 0.9912686, 'specificity': 0.9912686, 'f1': 0.9873167, 'auroc': 0.99981153, 'binary_precision': 0.99919105, 'binary_recall': 0.9983162, 'binary_specificity': 0.9842209, 'binary_f1_score': 0.9987534}
confusion matrix:
      0      1
0  1497     24
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.88056207, 'precision': 0.88066536, 'recall': 0.8804147, 'specificity': 0.8804147, 'f1': 0.88049656, 'auroc': 0.93265307, 'binary_precision': 0.884058, 'binary_recall': 0.87142855, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.8776979}
confusion matrix:
     0    1
0  579   72
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79916316, 'precision': 0.8009155, 'recall': 0.80142295, 'specificity': 0.80142295, 'f1': 0.79914916, 'auroc': 0.8675802, 'binary_precision': 0.8427948, 'binary_recall': 0.7628459, 'binary_specificity': 0.84, 'binary_f1_score': 0.8008299}
confusion matrix:
     0    1
0  189   36
1   60  193
early stop counter: 4
val acc:0.8805620670318604, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.8012552261352539 / 0.8933054208755493
after epoch: 29,now: 2024-07-11 23:24:22.802392,epoch time: 0:26:38.609808,used: 12:56:32.043205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9969567, 'precision': 0.98669076, 'recall': 0.9803106, 'specificity': 0.9803106, 'f1': 0.98347723, 'auroc': 0.9997412, 'binary_precision': 0.9980482, 'binary_recall': 0.998754, 'binary_specificity': 0.9618672, 'binary_f1_score': 0.998401}
confusion matrix:
      0      1
0  1463     58
1    37  29658
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8580467, 'recall': 0.8480543, 'specificity': 0.8480543, 'f1': 0.8480471, 'auroc': 0.9218272, 'binary_precision': 0.9099437, 'binary_recall': 0.76984125, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.8340498}
confusion matrix:
     0    1
0  603   48
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.77143204, 'recall': 0.7354414, 'specificity': 0.7354414, 'f1': 0.71706843, 'auroc': 0.8625033, 'binary_precision': 0.90066224, 'binary_recall': 0.53754944, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.6732673}
confusion matrix:
     0    1
0  210   15
1  117  136
early stop counter: 5
val acc:0.8493364453315735, best validation acc: 0.9039812684059143, corresponding to test acc:                         0.8012552261352539 / 0.8933054208755493
after epoch: 30,now: 2024-07-11 23:51:01.110005,epoch time: 0:26:38.307613,used: 13:23:10.350818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_10_27_50_seed_1_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:23:10.350818 at 2024-07-11 23:51:01.110005
persisted model performance metric: 

scalar performance:
{'acc': 0.8012552, 'precision': 0.8320477, 'recall': 0.8100395, 'specificity': 0.8100395, 'f1': 0.79914457, 'auroc': 0.92091346, 'binary_precision': 0.9488636, 'binary_recall': 0.66007906, 'binary_specificity': 0.96, 'binary_f1_score': 0.77855474}
confusion matrix:
     0    1
0  216    9
1   86  167
oracle model performance metric: 

scalar performance:
{'acc': 0.8933054, 'precision': 0.8945017, 'recall': 0.89552045, 'specificity': 0.89552045, 'f1': 0.89328253, 'auroc': 0.9378656, 'binary_precision': 0.9353448, 'binary_recall': 0.8577075, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.89484537}
confusion matrix:
     0    1
0  210   15
1   36  217
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456437 KiB |   6792 MiB |   3677 TiB |   3677 TiB |
|       from large pool | 415836 KiB |   6757 MiB |   3639 TiB |   3639 TiB |
|       from small pool |  40601 KiB |     56 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456437 KiB |   6792 MiB |   3677 TiB |   3677 TiB |
|       from large pool | 415836 KiB |   6757 MiB |   3639 TiB |   3639 TiB |
|       from small pool |  40601 KiB |     56 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |   6787 MiB |   3675 TiB |   3675 TiB |
|       from large pool | 407075 KiB |   6753 MiB |   3637 TiB |   3637 TiB |
|       from small pool |  40408 KiB |     56 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8314 MiB |   8318 MiB |  15858 MiB |   7544 MiB |
|       from large pool |   8250 MiB |   8254 MiB |  15776 MiB |   7526 MiB |
|       from small pool |     64 MiB |     64 MiB |     82 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 370954 KiB |   1156 MiB |   4807 TiB |   4807 TiB |
|       from large pool | 362404 KiB |   1147 MiB |   4769 TiB |   4769 TiB |
|       from small pool |   8550 KiB |     22 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4887    |  523226 K  |  523225 K  |
|       from large pool |     187    |     783    |  329037 K  |  329037 K  |
|       from small pool |    1129    |    4699    |  194188 K  |  194187 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4887    |  523226 K  |  523225 K  |
|       from large pool |     187    |     783    |  329037 K  |  329037 K  |
|       from small pool |    1129    |    4699    |  194188 K  |  194187 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     337    |     337    |     616    |     279    |
|       from large pool |     305    |     305    |     575    |     270    |
|       from small pool |      32    |      32    |      41    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      80    |    2006    |  325921 K  |  325921 K  |
|       from large pool |      37    |     310    |  240030 K  |  240030 K  |
|       from small pool |      43    |    1969    |   85891 K  |   85891 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6792 MiB |   3677 TiB |   3677 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   3639 TiB |   3639 TiB |
|       from small pool |      0 KiB |     56 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6792 MiB |   3677 TiB |   3677 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   3639 TiB |   3639 TiB |
|       from small pool |      0 KiB |     56 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |   3675 TiB |   3675 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   3637 TiB |   3637 TiB |
|       from small pool |      0 KiB |     56 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |   8318 MiB |  15858 MiB |  15050 MiB |
|       from large pool |    760 MiB |   8254 MiB |  15776 MiB |  15016 MiB |
|       from small pool |     48 MiB |     64 MiB |     82 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1156 MiB |   4807 TiB |   4807 TiB |
|       from large pool |  24320 KiB |   1147 MiB |   4769 TiB |   4769 TiB |
|       from small pool |      0 KiB |     28 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4887    |  523226 K  |  523226 K  |
|       from large pool |       2    |     783    |  329037 K  |  329037 K  |
|       from small pool |       0    |    4699    |  194188 K  |  194188 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4887    |  523226 K  |  523226 K  |
|       from large pool |       2    |     783    |  329037 K  |  329037 K  |
|       from small pool |       0    |    4699    |  194188 K  |  194188 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     337    |     616    |     557    |
|       from large pool |      35    |     305    |     575    |     540    |
|       from small pool |      24    |      32    |      41    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2006    |  325922 K  |  325922 K  |
|       from large pool |       3    |     310    |  240030 K  |  240030 K  |
|       from small pool |       0    |    1969    |   85891 K  |   85891 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6792 MiB |   3677 TiB |   3677 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   3639 TiB |   3639 TiB |
|       from small pool |      0 KiB |     56 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6792 MiB |   3677 TiB |   3677 TiB |
|       from large pool |  16640 KiB |   6757 MiB |   3639 TiB |   3639 TiB |
|       from small pool |      0 KiB |     56 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |   3675 TiB |   3675 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   3637 TiB |   3637 TiB |
|       from small pool |      0 KiB |     56 MiB |     37 TiB |     37 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    808 MiB |   8318 MiB |  15858 MiB |  15050 MiB |
|       from large pool |    760 MiB |   8254 MiB |  15776 MiB |  15016 MiB |
|       from small pool |     48 MiB |     64 MiB |     82 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1156 MiB |   4807 TiB |   4807 TiB |
|       from large pool |  24320 KiB |   1147 MiB |   4769 TiB |   4769 TiB |
|       from small pool |      0 KiB |     28 MiB |     38 TiB |     38 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4887    |  523226 K  |  523226 K  |
|       from large pool |       2    |     783    |  329037 K  |  329037 K  |
|       from small pool |       0    |    4699    |  194188 K  |  194188 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4887    |  523226 K  |  523226 K  |
|       from large pool |       2    |     783    |  329037 K  |  329037 K  |
|       from small pool |       0    |    4699    |  194188 K  |  194188 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      59    |     337    |     616    |     557    |
|       from large pool |      35    |     305    |     575    |     540    |
|       from small pool |      24    |      32    |      41    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2006    |  325922 K  |  325922 K  |
|       from large pool |       3    |     310    |  240030 K  |  240030 K  |
|       from small pool |       0    |    1969    |   85891 K  |   85891 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149

 Experiment start at: 2024-07-12 00:04:22.369881
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9916497, 'precision': 0.9596025, 'recall': 0.94865227, 'specificity': 0.94865227, 'f1': 0.95405364, 'auroc': 0.9984759, 'binary_precision': 0.99498296, 'binary_recall': 0.99624914, 'binary_specificity': 0.9010554, 'binary_f1_score': 0.99561566}
confusion matrix:
      0      1
0  1366    150
1   112  29748
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.77594644, 'recall': 0.773106, 'specificity': 0.773106, 'f1': 0.7711677, 'auroc': 0.8562294, 'binary_precision': 0.73371106, 'binary_recall': 0.8327974, 'binary_specificity': 0.7134146, 'binary_f1_score': 0.78012043}
confusion matrix:
     0    1
0  468  188
1  104  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7894737, 'precision': 0.79150105, 'recall': 0.7831224, 'specificity': 0.7831224, 'f1': 0.7852, 'auroc': 0.8725332, 'binary_precision': 0.7809187, 'binary_recall': 0.85328186, 'binary_specificity': 0.712963, 'binary_f1_score': 0.8154981}
confusion matrix:
     0    1
0  154   62
1   38  221
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 00:31:14.869474,epoch time: 0:26:52.499593,used: 0:26:52.499593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9916178, 'precision': 0.9620278, 'recall': 0.94550484, 'specificity': 0.94550484, 'f1': 0.9535985, 'auroc': 0.99788505, 'binary_precision': 0.99465185, 'binary_recall': 0.99655056, 'binary_specificity': 0.8944591, 'binary_f1_score': 0.99560034}
confusion matrix:
      0      1
0  1356    160
1   103  29757
---- Validation: 
scalar performance:
{'acc': 0.6768388, 'precision': 0.7603836, 'recall': 0.68417186, 'specificity': 0.68417186, 'f1': 0.6539022, 'auroc': 0.878713, 'binary_precision': 0.6060914, 'binary_recall': 0.9598071, 'binary_specificity': 0.40853658, 'binary_f1_score': 0.7429994}
confusion matrix:
     0    1
0  268  388
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.7581878, 'recall': 0.69981587, 'specificity': 0.69981587, 'f1': 0.69499683, 'auroc': 0.8331009, 'binary_precision': 0.67897725, 'binary_recall': 0.9227799, 'binary_specificity': 0.47685185, 'binary_f1_score': 0.782324}
confusion matrix:
     0    1
0  103  113
1   20  239
early stop counter: 1
val acc:0.6768388152122498, best validation acc: 0.7715179920196533, corresponding to test acc:                         0.7894737124443054 / 0.7894737124443054
after epoch: 2,now: 2024-07-12 00:58:00.883880,epoch time: 0:26:46.014406,used: 0:53:38.513999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9947093, 'precision': 0.9766433, 'recall': 0.9652872, 'specificity': 0.9652872, 'f1': 0.970889, 'auroc': 0.99909055, 'binary_precision': 0.9965884, 'binary_recall': 0.9978567, 'binary_specificity': 0.9327177, 'binary_f1_score': 0.9972222}
confusion matrix:
      0      1
0  1414    102
1    64  29796
---- Validation: 
scalar performance:
{'acc': 0.74334896, 'precision': 0.80155593, 'recall': 0.7490834, 'specificity': 0.7490834, 'f1': 0.73313713, 'auroc': 0.91040164, 'binary_precision': 0.66225165, 'binary_recall': 0.96463025, 'binary_specificity': 0.5335366, 'binary_f1_score': 0.78534037}
confusion matrix:
     0    1
0  350  306
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.8253783, 'recall': 0.8143858, 'specificity': 0.8143858, 'f1': 0.81708014, 'auroc': 0.9159337, 'binary_precision': 0.8041958, 'binary_recall': 0.8880309, 'binary_specificity': 0.7407407, 'binary_f1_score': 0.84403676}
confusion matrix:
     0    1
0  160   56
1   29  230
new oracle model saved
early stop counter: 2
val acc:0.7433489561080933, best validation acc: 0.7715179920196533, corresponding to test acc:                         0.7894737124443054 / 0.821052610874176
after epoch: 3,now: 2024-07-12 01:24:43.617826,epoch time: 0:26:42.733946,used: 1:20:21.247945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9945818, 'precision': 0.97249484, 'recall': 0.9683509, 'specificity': 0.9683509, 'f1': 0.9704127, 'auroc': 0.9992242, 'binary_precision': 0.9969204, 'binary_recall': 0.9973878, 'binary_specificity': 0.939314, 'binary_f1_score': 0.99715406}
confusion matrix:
      0      1
0  1424     92
1    78  29782
---- Validation: 
scalar performance:
{'acc': 0.85367763, 'precision': 0.8591605, 'recall': 0.85534465, 'specificity': 0.85534465, 'f1': 0.8534443, 'auroc': 0.91490126, 'binary_precision': 0.80763793, 'binary_recall': 0.9180064, 'binary_specificity': 0.79268295, 'binary_f1_score': 0.85929275}
confusion matrix:
     0    1
0  520  136
1   51  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8336842, 'precision': 0.8332447, 'recall': 0.835961, 'specificity': 0.835961, 'f1': 0.8332585, 'auroc': 0.87612617, 'binary_precision': 0.875, 'binary_recall': 0.8108108, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.8416833}
confusion matrix:
     0    1
0  186   30
1   49  210
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 01:51:30.604941,epoch time: 0:26:46.987115,used: 1:47:08.235060,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.991809, 'precision': 0.98729694, 'recall': 0.9224381, 'specificity': 0.9224381, 'f1': 0.95230466, 'auroc': 0.99939287, 'binary_precision': 0.99221843, 'binary_recall': 0.9992297, 'binary_specificity': 0.84564644, 'binary_f1_score': 0.99571174}
confusion matrix:
      0      1
0  1282    234
1    23  29837
---- Validation: 
scalar performance:
{'acc': 0.74100155, 'precision': 0.81348157, 'recall': 0.7472968, 'specificity': 0.7472968, 'f1': 0.7282345, 'auroc': 0.9409287, 'binary_precision': 0.6559486, 'binary_recall': 0.98392284, 'binary_specificity': 0.5106707, 'binary_f1_score': 0.78713834}
confusion matrix:
     0    1
0  335  321
1   10  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.85120773, 'recall': 0.8201952, 'specificity': 0.8201952, 'f1': 0.82456136, 'auroc': 0.9451952, 'binary_precision': 0.78778136, 'binary_recall': 0.9459459, 'binary_specificity': 0.6944444, 'binary_f1_score': 0.8596491}
confusion matrix:
     0    1
0  150   66
1   14  245
early stop counter: 1
val acc:0.741001546382904, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8336842060089111 / 0.8336842060089111
after epoch: 5,now: 2024-07-12 02:18:18.249785,epoch time: 0:26:47.644844,used: 2:13:55.879904,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9892593, 'precision': 0.98692185, 'recall': 0.8948006, 'specificity': 0.8948006, 'f1': 0.9355387, 'auroc': 0.9990647, 'binary_precision': 0.9894559, 'binary_recall': 0.9993637, 'binary_specificity': 0.7902375, 'binary_f1_score': 0.9943851}
confusion matrix:
      0      1
0  1198    318
1    19  29841
---- Validation: 
scalar performance:
{'acc': 0.56964004, 'precision': 0.75204456, 'recall': 0.5806677, 'specificity': 0.5806677, 'f1': 0.48812395, 'auroc': 0.9133377, 'binary_precision': 0.5308748, 'binary_recall': 0.99517685, 'binary_specificity': 0.16615854, 'binary_f1_score': 0.6923937}
confusion matrix:
     0    1
0  109  547
1    3  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5978947, 'precision': 0.7694279, 'recall': 0.55825466, 'specificity': 0.55825466, 'f1': 0.47191808, 'auroc': 0.86293435, 'binary_precision': 0.57589287, 'binary_recall': 0.996139, 'binary_specificity': 0.12037037, 'binary_f1_score': 0.7298444}
confusion matrix:
    0    1
0  26  190
1   1  258
early stop counter: 2
val acc:0.569640040397644, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8336842060089111 / 0.8336842060089111
after epoch: 6,now: 2024-07-12 02:45:05.196594,epoch time: 0:26:46.946809,used: 2:40:42.826713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9963029, 'precision': 0.9840106, 'recall': 0.97551656, 'specificity': 0.97551656, 'f1': 0.97972167, 'auroc': 0.9996819, 'binary_precision': 0.997591, 'binary_recall': 0.99852645, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.99805856}
confusion matrix:
      0      1
0  1444     72
1    44  29816
---- Validation: 
scalar performance:
{'acc': 0.85367763, 'precision': 0.8651037, 'recall': 0.85605294, 'specificity': 0.85605294, 'f1': 0.8530274, 'auroc': 0.94231826, 'binary_precision': 0.79352224, 'binary_recall': 0.9453376, 'binary_specificity': 0.7667683, 'binary_f1_score': 0.86280257}
confusion matrix:
     0    1
0  503  153
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.87527645, 'recall': 0.87608147, 'specificity': 0.87608147, 'f1': 0.86946845, 'auroc': 0.9143966, 'binary_precision': 0.9497717, 'binary_recall': 0.8030888, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.87029284}
confusion matrix:
     0    1
0  205   11
1   51  208
new oracle model saved
early stop counter: 3
val acc:0.8536776304244995, best validation acc: 0.8536776304244995, corresponding to test acc:                         0.8336842060089111 / 0.8694736957550049
after epoch: 7,now: 2024-07-12 03:11:50.301629,epoch time: 0:26:45.105035,used: 3:07:27.931748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.997036, 'precision': 0.981139, 'recall': 0.98685914, 'specificity': 0.98685914, 'f1': 0.9839802, 'auroc': 0.9997586, 'binary_precision': 0.9987601, 'binary_recall': 0.9981246, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.99844223}
confusion matrix:
      0      1
0  1479     37
1    56  29804
---- Validation: 
scalar performance:
{'acc': 0.8810642, 'precision': 0.88481474, 'recall': 0.8824381, 'specificity': 0.8824381, 'f1': 0.8809697, 'auroc': 0.9456489, 'binary_precision': 0.8395954, 'binary_recall': 0.9340836, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.8843227}
confusion matrix:
     0    1
0  545  111
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87157893, 'precision': 0.8797758, 'recall': 0.87916493, 'specificity': 0.87916493, 'f1': 0.87157667, 'auroc': 0.94408697, 'binary_precision': 0.9626168, 'binary_recall': 0.7953668, 'binary_specificity': 0.962963, 'binary_f1_score': 0.87103593}
confusion matrix:
     0    1
0  208    8
1   53  206
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 03:38:35.487599,epoch time: 0:26:45.185970,used: 3:34:13.117718,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9966216, 'precision': 0.977093, 'recall': 0.9866414, 'specificity': 0.9866414, 'f1': 0.9818144, 'auroc': 0.9997306, 'binary_precision': 0.99875957, 'binary_recall': 0.9976892, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9982241}
confusion matrix:
      0      1
0  1479     37
1    69  29791
---- Validation: 
scalar performance:
{'acc': 0.8771518, 'precision': 0.8802969, 'recall': 0.8784188, 'specificity': 0.8784188, 'f1': 0.8770795, 'auroc': 0.9466341, 'binary_precision': 0.83842796, 'binary_recall': 0.926045, 'binary_specificity': 0.83079267, 'binary_f1_score': 0.8800611}
confusion matrix:
     0    1
0  545  111
1   46  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88631576, 'precision': 0.8868351, 'recall': 0.8899882, 'specificity': 0.8899882, 'f1': 0.88613355, 'auroc': 0.94331837, 'binary_precision': 0.9361702, 'binary_recall': 0.84942085, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.89068824}
confusion matrix:
     0    1
0  201   15
1   39  220
new oracle model saved
early stop counter: 1
val acc:0.8771517872810364, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 9,now: 2024-07-12 04:05:21.958719,epoch time: 0:26:46.471120,used: 4:00:59.588838,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9963985, 'precision': 0.9899267, 'recall': 0.97055763, 'specificity': 0.97055763, 'f1': 0.98002493, 'auroc': 0.99977696, 'binary_precision': 0.9970591, 'binary_recall': 0.99916273, 'binary_specificity': 0.9419525, 'binary_f1_score': 0.9981098}
confusion matrix:
      0      1
0  1428     88
1    25  29835
---- Validation: 
scalar performance:
{'acc': 0.74726135, 'precision': 0.80280495, 'recall': 0.75285274, 'specificity': 0.75285274, 'f1': 0.73778117, 'auroc': 0.93173826, 'binary_precision': 0.6662959, 'binary_recall': 0.96302253, 'binary_specificity': 0.54268295, 'binary_f1_score': 0.7876397}
confusion matrix:
     0    1
0  356  300
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8189474, 'precision': 0.82438517, 'recall': 0.8116867, 'specificity': 0.8116867, 'f1': 0.8145677, 'auroc': 0.91262686, 'binary_precision': 0.79930794, 'binary_recall': 0.8918919, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.84306574}
confusion matrix:
     0    1
0  158   58
1   28  231
early stop counter: 2
val acc:0.7472613453865051, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 10,now: 2024-07-12 04:32:07.395866,epoch time: 0:26:45.437147,used: 4:27:45.025985,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9949006, 'precision': 0.95758885, 'recall': 0.9901202, 'specificity': 0.9901202, 'f1': 0.9732288, 'auroc': 0.99959767, 'binary_precision': 0.9992268, 'binary_recall': 0.99541193, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.99731576}
confusion matrix:
      0      1
0  1493     23
1   137  29723
---- Validation: 
scalar performance:
{'acc': 0.84741783, 'precision': 0.8497754, 'recall': 0.84628904, 'specificity': 0.84628904, 'f1': 0.8467716, 'auroc': 0.911355, 'binary_precision': 0.8726004, 'binary_recall': 0.8038585, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8368201}
confusion matrix:
     0    1
0  583   73
1  122  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084211, 'precision': 0.8151008, 'recall': 0.8151008, 'specificity': 0.8151008, 'f1': 0.8084211, 'auroc': 0.88551056, 'binary_precision': 0.8888889, 'binary_recall': 0.74131274, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8084211}
confusion matrix:
     0    1
0  192   24
1   67  192
early stop counter: 3
val acc:0.8474178314208984, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 11,now: 2024-07-12 04:58:51.957138,epoch time: 0:26:44.561272,used: 4:54:29.587257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.988335, 'precision': 0.98053837, 'recall': 0.88993204, 'specificity': 0.88993204, 'f1': 0.93001604, 'auroc': 0.99726725, 'binary_precision': 0.9889913, 'binary_recall': 0.9988614, 'binary_specificity': 0.78100264, 'binary_f1_score': 0.99390185}
confusion matrix:
      0      1
0  1184    332
1    34  29826
---- Validation: 
scalar performance:
{'acc': 0.7738654, 'precision': 0.8295057, 'recall': 0.7792673, 'specificity': 0.7792673, 'f1': 0.7660904, 'auroc': 0.91414404, 'binary_precision': 0.68728906, 'binary_recall': 0.9823151, 'binary_specificity': 0.5762195, 'binary_f1_score': 0.8087359}
confusion matrix:
     0    1
0  378  278
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8336842, 'precision': 0.85119367, 'recall': 0.82289433, 'specificity': 0.82289433, 'f1': 0.82720196, 'auroc': 0.93995786, 'binary_precision': 0.7922078, 'binary_recall': 0.94208497, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.8606702}
confusion matrix:
     0    1
0  152   64
1   15  244
early stop counter: 4
val acc:0.7738654017448425, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 12,now: 2024-07-12 05:25:41.513457,epoch time: 0:26:49.556319,used: 5:21:19.143576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9905342, 'precision': 0.98745847, 'recall': 0.90830624, 'specificity': 0.90830624, 'f1': 0.9440105, 'auroc': 0.9994345, 'binary_precision': 0.9908025, 'binary_recall': 0.9993302, 'binary_specificity': 0.8172823, 'binary_f1_score': 0.99504805}
confusion matrix:
      0      1
0  1239    277
1    20  29840
---- Validation: 
scalar performance:
{'acc': 0.7331768, 'precision': 0.8012637, 'recall': 0.7393832, 'specificity': 0.7393832, 'f1': 0.72041917, 'auroc': 0.92712337, 'binary_precision': 0.6512379, 'binary_recall': 0.9726688, 'binary_specificity': 0.50609756, 'binary_f1_score': 0.7801419}
confusion matrix:
     0    1
0  332  324
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69684213, 'precision': 0.7926674, 'recall': 0.6685883, 'specificity': 0.6685883, 'f1': 0.6479598, 'auroc': 0.83882093, 'binary_precision': 0.64631045, 'binary_recall': 0.980695, 'binary_specificity': 0.3564815, 'binary_f1_score': 0.77914107}
confusion matrix:
    0    1
0  77  139
1   5  254
early stop counter: 5
val acc:0.7331768274307251, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 13,now: 2024-07-12 05:52:29.178651,epoch time: 0:26:47.665194,used: 5:48:06.808770,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9968447, 'precision': 0.9859525, 'recall': 0.979558, 'specificity': 0.979558, 'f1': 0.9827317, 'auroc': 0.9997195, 'binary_precision': 0.99799204, 'binary_recall': 0.9986939, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.9983428}
confusion matrix:
      0      1
0  1456     60
1    39  29821
---- Validation: 
scalar performance:
{'acc': 0.8599374, 'precision': 0.8612138, 'recall': 0.8607756, 'specificity': 0.8607756, 'f1': 0.85992706, 'auroc': 0.9288953, 'binary_precision': 0.83208394, 'binary_recall': 0.89228296, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.8611327}
confusion matrix:
     0    1
0  544  112
1   67  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.86276823, 'recall': 0.85174465, 'specificity': 0.85174465, 'f1': 0.8395556, 'auroc': 0.94287145, 'binary_precision': 0.9790576, 'binary_recall': 0.72200775, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.8311112}
confusion matrix:
     0    1
0  212    4
1   72  187
early stop counter: 6
val acc:0.8599374294281006, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 14,now: 2024-07-12 06:19:17.326659,epoch time: 0:26:48.148008,used: 6:14:54.956778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9938488, 'precision': 0.9441656, 'recall': 0.99582905, 'specificity': 0.99582905, 'f1': 0.96840084, 'auroc': 0.999839, 'binary_precision': 0.9998989, 'binary_recall': 0.99363697, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9967581}
confusion matrix:
      0      1
0  1513      3
1   190  29670
---- Validation: 
scalar performance:
{'acc': 0.7120501, 'precision': 0.7974665, 'recall': 0.70476335, 'specificity': 0.70476335, 'f1': 0.68508005, 'auroc': 0.9182956, 'binary_precision': 0.95035464, 'binary_recall': 0.43086818, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.59292036}
confusion matrix:
     0    1
0  642   14
1  354  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45894736, 'precision': 0.5614783, 'recall': 0.50309235, 'specificity': 0.50309235, 'f1': 0.3275031, 'auroc': 0.90998137, 'binary_precision': 0.6666667, 'binary_recall': 0.015444015, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.030188678}
confusion matrix:
     0  1
0  214  2
1  255  4
early stop counter: 7
val acc:0.7120500802993774, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 15,now: 2024-07-12 06:46:05.152919,epoch time: 0:26:47.826260,used: 6:41:42.783038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9958886, 'precision': 0.9780754, 'recall': 0.97717726, 'specificity': 0.97717726, 'f1': 0.97762585, 'auroc': 0.9995446, 'binary_precision': 0.9977899, 'binary_recall': 0.9978902, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.99784005}
confusion matrix:
      0      1
0  1450     66
1    63  29797
---- Validation: 
scalar performance:
{'acc': 0.86071986, 'precision': 0.86798894, 'recall': 0.86262107, 'specificity': 0.86262107, 'f1': 0.86039126, 'auroc': 0.93385327, 'binary_precision': 0.8091922, 'binary_recall': 0.9340836, 'binary_specificity': 0.79115856, 'binary_f1_score': 0.86716413}
confusion matrix:
     0    1
0  519  137
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673684, 'precision': 0.8660638, 'recall': 0.86684895, 'specificity': 0.86684895, 'f1': 0.8664211, 'auroc': 0.88978267, 'binary_precision': 0.8828125, 'binary_recall': 0.87258685, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.8776699}
confusion matrix:
     0    1
0  186   30
1   33  226
early stop counter: 8
val acc:0.8607198596000671, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 16,now: 2024-07-12 07:12:51.741522,epoch time: 0:26:46.588603,used: 7:08:29.371641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.996271, 'precision': 0.9729122, 'recall': 0.9873965, 'specificity': 0.9873965, 'f1': 0.9800323, 'auroc': 0.9997097, 'binary_precision': 0.99885947, 'binary_recall': 0.99722034, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.99803925}
confusion matrix:
      0      1
0  1482     34
1    83  29777
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.8722968, 'recall': 0.8644984, 'specificity': 0.8644984, 'f1': 0.86518013, 'auroc': 0.93429196, 'binary_precision': 0.9137615, 'binary_recall': 0.8006431, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.85347044}
confusion matrix:
     0    1
0  609   47
1  124  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.85268366, 'recall': 0.8347544, 'specificity': 0.8347544, 'f1': 0.8200188, 'auroc': 0.9151294, 'binary_precision': 0.98333335, 'binary_recall': 0.6833977, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.8063781}
confusion matrix:
     0    1
0  213    3
1   82  177
early stop counter: 9
val acc:0.8661971688270569, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 17,now: 2024-07-12 07:39:37.120628,epoch time: 0:26:45.379106,used: 7:35:14.750747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9962392, 'precision': 0.9676409, 'recall': 0.9933281, 'specificity': 0.9933281, 'f1': 0.9801003, 'auroc': 0.9998346, 'binary_precision': 0.99949616, 'binary_recall': 0.99655056, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9980211}
confusion matrix:
      0      1
0  1501     15
1   103  29757
---- Validation: 
scalar performance:
{'acc': 0.8771518, 'precision': 0.8777995, 'recall': 0.87658566, 'specificity': 0.87658566, 'f1': 0.87690693, 'auroc': 0.93216705, 'binary_precision': 0.88814694, 'binary_recall': 0.8553055, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.87141687}
confusion matrix:
     0    1
0  589   67
1   90  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7936842, 'precision': 0.8324196, 'recall': 0.80888927, 'specificity': 0.80888927, 'f1': 0.79181576, 'auroc': 0.8961462, 'binary_precision': 0.9707602, 'binary_recall': 0.64092666, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.772093}
confusion matrix:
     0    1
0  211    5
1   93  166
early stop counter: 10
val acc:0.8771517872810364, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 18,now: 2024-07-12 08:06:21.884016,epoch time: 0:26:44.763388,used: 8:01:59.514135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9936257, 'precision': 0.94640005, 'recall': 0.9897635, 'specificity': 0.9897635, 'f1': 0.9669535, 'auroc': 0.9996829, 'binary_precision': 0.99925935, 'binary_recall': 0.9940388, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.99664223}
confusion matrix:
      0      1
0  1494     22
1   178  29682
---- Validation: 
scalar performance:
{'acc': 0.85367763, 'precision': 0.86285335, 'recall': 0.8515533, 'specificity': 0.8515533, 'f1': 0.8521239, 'auroc': 0.93251026, 'binary_precision': 0.9142857, 'binary_recall': 0.7717042, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.83696604}
confusion matrix:
     0    1
0  611   45
1  142  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589474, 'precision': 0.8702823, 'recall': 0.86758184, 'specificity': 0.86758184, 'f1': 0.85890734, 'auroc': 0.9273381, 'binary_precision': 0.96153843, 'binary_recall': 0.77220076, 'binary_specificity': 0.962963, 'binary_f1_score': 0.8565311}
confusion matrix:
     0    1
0  208    8
1   59  200
early stop counter: 11
val acc:0.8536776304244995, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 19,now: 2024-07-12 08:33:06.701707,epoch time: 0:26:44.817691,used: 8:28:44.331826,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9971316, 'precision': 0.990134, 'recall': 0.9784565, 'specificity': 0.9784565, 'f1': 0.9842169, 'auroc': 0.9997774, 'binary_precision': 0.99785936, 'binary_recall': 0.9991293, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9984939}
confusion matrix:
      0      1
0  1452     64
1    26  29834
---- Validation: 
scalar performance:
{'acc': 0.87558687, 'precision': 0.8760588, 'recall': 0.8761445, 'specificity': 0.8761445, 'f1': 0.87558615, 'auroc': 0.9309809, 'binary_precision': 0.85451764, 'binary_recall': 0.8971061, 'binary_specificity': 0.85518295, 'binary_f1_score': 0.8752941}
confusion matrix:
     0    1
0  561   95
1   64  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.83766234, 'recall': 0.83554983, 'specificity': 0.83554983, 'f1': 0.82733095, 'auroc': 0.9094094, 'binary_precision': 0.923445, 'binary_recall': 0.74517375, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.82478637}
confusion matrix:
     0    1
0  200   16
1   66  193
early stop counter: 12
val acc:0.8755868673324585, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 20,now: 2024-07-12 08:59:47.593083,epoch time: 0:26:40.891376,used: 8:55:25.223202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9966216, 'precision': 0.985473, 'recall': 0.97756237, 'specificity': 0.97756237, 'f1': 0.9814815, 'auroc': 0.9997324, 'binary_precision': 0.9977916, 'binary_recall': 0.9986604, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.9982258}
confusion matrix:
      0      1
0  1450     66
1    40  29820
---- Validation: 
scalar performance:
{'acc': 0.86150235, 'precision': 0.8657228, 'recall': 0.86296666, 'specificity': 0.86296666, 'f1': 0.86135966, 'auroc': 0.9181485, 'binary_precision': 0.81922525, 'binary_recall': 0.9180064, 'binary_specificity': 0.80792683, 'binary_f1_score': 0.8658074}
confusion matrix:
     0    1
0  530  126
1   51  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463158, 'precision': 0.85155976, 'recall': 0.85254, 'specificity': 0.85254, 'f1': 0.8463049, 'auroc': 0.90031105, 'binary_precision': 0.9227273, 'binary_recall': 0.7837838, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8475992}
confusion matrix:
     0    1
0  199   17
1   56  203
early stop counter: 13
val acc:0.8615023493766785, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 21,now: 2024-07-12 09:26:18.901594,epoch time: 0:26:31.308511,used: 9:21:56.531713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9978965, 'precision': 0.9833181, 'recall': 0.9941988, 'specificity': 0.9941988, 'f1': 0.98869085, 'auroc': 0.9998981, 'binary_precision': 0.99949706, 'binary_recall': 0.998292, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9988941}
confusion matrix:
      0      1
0  1501     15
1    51  29809
---- Validation: 
scalar performance:
{'acc': 0.8810642, 'precision': 0.8850524, 'recall': 0.87973, 'specificity': 0.87973, 'f1': 0.8804172, 'auroc': 0.9426491, 'binary_precision': 0.9181495, 'binary_recall': 0.829582, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.8716216}
confusion matrix:
     0    1
0  610   46
1  106  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.81355846, 'recall': 0.7780012, 'specificity': 0.7780012, 'f1': 0.75597554, 'auroc': 0.9252825, 'binary_precision': 0.9677419, 'binary_recall': 0.57915056, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7246377}
confusion matrix:
     0    1
0  211    5
1  109  150
early stop counter: 14
val acc:0.8810641765594482, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 22,now: 2024-07-12 09:52:51.155881,epoch time: 0:26:32.254287,used: 9:48:28.786000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.997769, 'precision': 0.9878704, 'recall': 0.9878704, 'specificity': 0.9878704, 'f1': 0.9878704, 'auroc': 0.99984765, 'binary_precision': 0.9988279, 'binary_recall': 0.9988279, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9988279}
confusion matrix:
      0      1
0  1481     35
1    35  29825
---- Validation: 
scalar performance:
{'acc': 0.84976524, 'precision': 0.86097646, 'recall': 0.847409, 'specificity': 0.847409, 'f1': 0.84788734, 'auroc': 0.924577, 'binary_precision': 0.91828793, 'binary_recall': 0.75884247, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.8309859}
confusion matrix:
     0    1
0  614   42
1  150  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80421054, 'precision': 0.8449373, 'recall': 0.81969464, 'specificity': 0.81969464, 'f1': 0.80235696, 'auroc': 0.9370084, 'binary_precision': 0.9882353, 'binary_recall': 0.6486486, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.7832167}
confusion matrix:
     0    1
0  214    2
1   91  168
early stop counter: 15
val acc:0.8497652411460876, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 23,now: 2024-07-12 10:19:26.143540,epoch time: 0:26:34.987659,used: 10:15:03.773659,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9976734, 'precision': 0.9789302, 'recall': 0.99658614, 'specificity': 0.99658614, 'f1': 0.9875797, 'auroc': 0.9999212, 'binary_precision': 0.9997651, 'binary_recall': 0.9977897, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.99877644}
confusion matrix:
      0      1
0  1509      7
1    66  29794
---- Validation: 
scalar performance:
{'acc': 0.81924886, 'precision': 0.84032583, 'recall': 0.81589186, 'specificity': 0.81589186, 'f1': 0.8152073, 'auroc': 0.931998, 'binary_precision': 0.9186295, 'binary_recall': 0.6897106, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.7878788}
confusion matrix:
     0    1
0  618   38
1  193  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347369, 'precision': 0.7130089, 'recall': 0.57220614, 'specificity': 0.57220614, 'f1': 0.46452528, 'auroc': 0.9169527, 'binary_precision': 0.9318182, 'binary_recall': 0.15830116, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.27062708}
confusion matrix:
     0   1
0  213   3
1  218  41
early stop counter: 16
val acc:0.8192488551139832, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8715789318084717 / 0.8863157629966736
after epoch: 24,now: 2024-07-12 10:46:05.580429,epoch time: 0:26:39.436889,used: 10:41:43.210548,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9970997, 'precision': 0.9876598, 'recall': 0.98063123, 'specificity': 0.98063123, 'f1': 0.98411703, 'auroc': 0.9998051, 'binary_precision': 0.99809253, 'binary_recall': 0.9988614, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.99847674}
confusion matrix:
      0      1
0  1459     57
1    34  29826
---- Validation: 
scalar performance:
{'acc': 0.8904538, 'precision': 0.8908862, 'recall': 0.8910012, 'specificity': 0.8910012, 'f1': 0.89045274, 'auroc': 0.93447816, 'binary_precision': 0.8696319, 'binary_recall': 0.91157556, 'binary_specificity': 0.87042683, 'binary_f1_score': 0.89010984}
confusion matrix:
     0    1
0  571   85
1   55  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463158, 'precision': 0.8542629, 'recall': 0.853693, 'specificity': 0.853693, 'f1': 0.8463131, 'auroc': 0.9312705, 'binary_precision': 0.93457943, 'binary_recall': 0.77220076, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.845666}
confusion matrix:
     0    1
0  202   14
1   59  200
better model found
persisted
after epoch: 25,now: 2024-07-12 11:12:37.958096,epoch time: 0:26:32.377667,used: 11:08:15.588215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9980558, 'precision': 0.98402286, 'recall': 0.99522173, 'specificity': 0.99522173, 'f1': 0.9895508, 'auroc': 0.9998896, 'binary_precision': 0.9995976, 'binary_recall': 0.998359, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9989779}
confusion matrix:
      0      1
0  1504     12
1    49  29811
---- Validation: 
scalar performance:
{'acc': 0.86150235, 'precision': 0.87172186, 'recall': 0.85930026, 'specificity': 0.85930026, 'f1': 0.8599395, 'auroc': 0.94306326, 'binary_precision': 0.92706335, 'binary_recall': 0.77652735, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.8451444}
confusion matrix:
     0    1
0  618   38
1  139  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78105265, 'precision': 0.82747364, 'recall': 0.7976905, 'specificity': 0.7976905, 'f1': 0.7782924, 'auroc': 0.9367403, 'binary_precision': 0.9754601, 'binary_recall': 0.6138996, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.75355446}
confusion matrix:
     0    1
0  212    4
1  100  159
early stop counter: 1
val acc:0.8615023493766785, best validation acc: 0.8904538154602051, corresponding to test acc:                         0.8463158011436462 / 0.8863157629966736
after epoch: 26,now: 2024-07-12 11:39:33.577598,epoch time: 0:26:55.619502,used: 11:35:11.207717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9977371, 'precision': 0.98318124, 'recall': 0.9925497, 'specificity': 0.9925497, 'f1': 0.98781526, 'auroc': 0.9998853, 'binary_precision': 0.9993295, 'binary_recall': 0.998292, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.99881047}
confusion matrix:
      0      1
0  1496     20
1    51  29809
---- Validation: 
scalar performance:
{'acc': 0.8928012, 'precision': 0.8937522, 'recall': 0.8921629, 'specificity': 0.8921629, 'f1': 0.8925564, 'auroc': 0.9387499, 'binary_precision': 0.90756303, 'binary_recall': 0.8681672, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.8874281}
confusion matrix:
     0    1
0  601   55
1   82  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8469697, 'recall': 0.8479372, 'specificity': 0.8479372, 'f1': 0.84739226, 'auroc': 0.9066745, 'binary_precision': 0.8666667, 'binary_recall': 0.85328186, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8599222}
confusion matrix:
     0    1
0  182   34
1   38  221
better model found
persisted
after epoch: 27,now: 2024-07-12 12:06:32.926822,epoch time: 0:26:59.349224,used: 12:02:10.556941,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9970997, 'precision': 0.980628, 'recall': 0.9881449, 'specificity': 0.9881449, 'f1': 0.9843539, 'auroc': 0.9997657, 'binary_precision': 0.9988939, 'binary_recall': 0.9980576, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.99847555}
confusion matrix:
      0      1
0  1483     33
1    58  29802
---- Validation: 
scalar performance:
{'acc': 0.8802817, 'precision': 0.8809587, 'recall': 0.880926, 'specificity': 0.880926, 'f1': 0.88028157, 'auroc': 0.9429579, 'binary_precision': 0.8569254, 'binary_recall': 0.9051447, 'binary_specificity': 0.85670733, 'binary_f1_score': 0.88037527}
confusion matrix:
     0    1
0  562   94
1   59  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84210527, 'precision': 0.85957956, 'recall': 0.85252213, 'specificity': 0.85252213, 'f1': 0.8418782, 'auroc': 0.9514693, 'binary_precision': 0.96464646, 'binary_recall': 0.73745173, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.83588624}
confusion matrix:
     0    1
0  209    7
1   68  191
early stop counter: 1
val acc:0.8802816867828369, best validation acc: 0.8928012251853943, corresponding to test acc:                         0.848421037197113 / 0.8863157629966736
after epoch: 28,now: 2024-07-12 12:33:12.602673,epoch time: 0:26:39.675851,used: 12:28:50.232792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9976096, 'precision': 0.988649, 'recall': 0.98528206, 'specificity': 0.98528206, 'f1': 0.9869591, 'auroc': 0.999879, 'binary_precision': 0.9985605, 'binary_recall': 0.9989283, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9987444}
confusion matrix:
      0      1
0  1473     43
1    32  29828
---- Validation: 
scalar performance:
{'acc': 0.8904538, 'precision': 0.890898, 'recall': 0.8900013, 'specificity': 0.8900013, 'f1': 0.89027214, 'auroc': 0.94075954, 'binary_precision': 0.8990066, 'binary_recall': 0.87299037, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.8858075}
confusion matrix:
     0    1
0  595   61
1   79  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7473684, 'precision': 0.7574266, 'recall': 0.7552731, 'specificity': 0.7552731, 'f1': 0.74727774, 'auroc': 0.8316888, 'binary_precision': 0.8357488, 'binary_recall': 0.66795367, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.74248934}
confusion matrix:
     0    1
0  182   34
1   86  173
early stop counter: 2
val acc:0.8904538154602051, best validation acc: 0.8928012251853943, corresponding to test acc:                         0.848421037197113 / 0.8863157629966736
after epoch: 29,now: 2024-07-12 12:59:44.330761,epoch time: 0:26:31.728088,used: 12:55:21.960880,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9982471, 'precision': 0.9882345, 'recall': 0.99281764, 'specificity': 0.99281764, 'f1': 0.99051416, 'auroc': 0.99992377, 'binary_precision': 0.99932986, 'binary_recall': 0.9988279, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9990788}
confusion matrix:
      0      1
0  1496     20
1    35  29825
---- Validation: 
scalar performance:
{'acc': 0.8748044, 'precision': 0.8833251, 'recall': 0.8728409, 'specificity': 0.8728409, 'f1': 0.8736146, 'auroc': 0.9478767, 'binary_precision': 0.93421054, 'binary_recall': 0.7990354, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.8613519}
confusion matrix:
     0    1
0  621   35
1  125  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71789473, 'precision': 0.79490393, 'recall': 0.7397755, 'specificity': 0.7397755, 'f1': 0.7090099, 'auroc': 0.94163805, 'binary_precision': 0.9699248, 'binary_recall': 0.4980695, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.65816325}
confusion matrix:
     0    1
0  212    4
1  130  129
early stop counter: 3
val acc:0.8748043775558472, best validation acc: 0.8928012251853943, corresponding to test acc:                         0.848421037197113 / 0.8863157629966736
after epoch: 30,now: 2024-07-12 13:26:15.610320,epoch time: 0:26:31.279559,used: 13:21:53.240439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_00_04_22_seed_2_21870149
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 13:21:53.240439 at 2024-07-12 13:26:15.610320
persisted model performance metric: 

scalar performance:
{'acc': 0.84842104, 'precision': 0.8469697, 'recall': 0.8479372, 'specificity': 0.8479372, 'f1': 0.84739226, 'auroc': 0.9066745, 'binary_precision': 0.8666667, 'binary_recall': 0.85328186, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8599222}
confusion matrix:
     0    1
0  182   34
1   38  221
oracle model performance metric: 

scalar performance:
{'acc': 0.88631576, 'precision': 0.8868351, 'recall': 0.8899882, 'specificity': 0.8899882, 'f1': 0.88613355, 'auroc': 0.94331837, 'binary_precision': 0.9361702, 'binary_recall': 0.84942085, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.89068824}
confusion matrix:
     0    1
0  201   15
1   39  220
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457037 KiB |   6794 MiB |   5530 TiB |   5530 TiB |
|       from large pool | 416436 KiB |   6759 MiB |   5472 TiB |   5472 TiB |
|       from small pool |  40601 KiB |     56 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 457037 KiB |   6794 MiB |   5530 TiB |   5530 TiB |
|       from large pool | 416436 KiB |   6759 MiB |   5472 TiB |   5472 TiB |
|       from small pool |  40601 KiB |     56 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |   6787 MiB |   5525 TiB |   5525 TiB |
|       from large pool | 407075 KiB |   6753 MiB |   5468 TiB |   5468 TiB |
|       from small pool |  40408 KiB |     56 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8314 MiB |   8318 MiB |  23364 MiB |  15050 MiB |
|       from large pool |   8250 MiB |   8254 MiB |  23266 MiB |  15016 MiB |
|       from small pool |     64 MiB |     64 MiB |     98 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349874 KiB |   1157 MiB |   7225 TiB |   7225 TiB |
|       from large pool | 341324 KiB |   1147 MiB |   7167 TiB |   7167 TiB |
|       from small pool |   8550 KiB |     28 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4907    |     786 M  |     786 M  |
|       from large pool |     187    |     783    |     494 M  |     494 M  |
|       from small pool |    1129    |    4719    |     291 M  |     291 M  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4907    |     786 M  |     786 M  |
|       from large pool |     187    |     783    |     494 M  |     494 M  |
|       from small pool |    1129    |    4719    |     291 M  |     291 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     337    |     337    |     894    |     557    |
|       from large pool |     305    |     305    |     845    |     540    |
|       from small pool |      32    |      32    |      49    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |    2011    |  485419 K  |  485419 K  |
|       from large pool |      31    |     310    |  355872 K  |  355872 K  |
|       from small pool |      43    |    1980    |  129547 K  |  129547 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6794 MiB |   5530 TiB |   5530 TiB |
|       from large pool |  16640 KiB |   6759 MiB |   5472 TiB |   5472 TiB |
|       from small pool |      0 KiB |     56 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6794 MiB |   5530 TiB |   5530 TiB |
|       from large pool |  16640 KiB |   6759 MiB |   5472 TiB |   5472 TiB |
|       from small pool |      0 KiB |     56 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6787 MiB |   5525 TiB |   5525 TiB |
|       from large pool |  16640 KiB |   6753 MiB |   5468 TiB |   5468 TiB |
|       from small pool |      0 KiB |     56 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    788 MiB |   8318 MiB |  23364 MiB |  22576 MiB |
|       from large pool |    740 MiB |   8254 MiB |  23266 MiB |  22526 MiB |
|       from small pool |     48 MiB |     64 MiB |     98 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1157 MiB |   7225 TiB |   7225 TiB |
|       from large pool |  24320 KiB |   1147 MiB |   7167 TiB |   7167 TiB |
|       from small pool |      0 KiB |     28 MiB |     57 TiB |     57 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |     786 M  |     786 M  |
|       from large pool |       2    |     783    |     494 M  |     494 M  |
|       from small pool |       0    |    4719    |     291 M  |     291 M  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |     786 M  |     786 M  |
|       from large pool |       2    |     783    |     494 M  |     494 M  |
|       from small pool |       0    |    4719    |     291 M  |     291 M  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     337    |     894    |     836    |
|       from large pool |      34    |     305    |     845    |     811    |
|       from small pool |      24    |      32    |      49    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    2011    |  485420 K  |  485420 K  |
|       from large pool |       3    |     310    |  355872 K  |  355872 K  |
|       from small pool |       0    |    1980    |  129547 K  |  129547 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 13:33:36 2024]
Finished job 0.
1 of 1 steps (100%) done
