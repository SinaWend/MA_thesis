Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jul 11 11:30:49 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151

 Experiment start at: 2024-07-11 11:37:38.695242
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9809671, 'precision': 0.94168067, 'recall': 0.8416698, 'specificity': 0.8416698, 'f1': 0.8845798, 'auroc': 0.9919947, 'binary_precision': 0.9841365, 'binary_recall': 0.9960453, 'binary_specificity': 0.68729424, 'binary_f1_score': 0.99005514}
confusion matrix:
      0      1
0  1044    475
1   117  29468
---- Validation: 
scalar performance:
{'acc': 0.5163044, 'precision': 0.7523848, 'recall': 0.5229709, 'specificity': 0.5229709, 'f1': 0.37937024, 'auroc': 0.9309715, 'binary_precision': 0.5047695, 'binary_recall': 1.0, 'binary_specificity': 0.045941807, 'binary_f1_score': 0.6708928}
confusion matrix:
    0    1
0  30  623
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.585567, 'precision': 0.73138237, 'recall': 0.53350556, 'specificity': 0.53350556, 'f1': 0.43230587, 'auroc': 0.92432386, 'binary_precision': 0.5738758, 'binary_recall': 0.9925926, 'binary_specificity': 0.074418604, 'binary_f1_score': 0.7272727}
confusion matrix:
    0    1
0  16  199
1   2  268
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 11:49:01.438264,epoch time: 0:11:22.743022,used: 0:11:22.743022,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97923094, 'precision': 0.9662119, 'recall': 0.8017242, 'specificity': 0.8017242, 'f1': 0.8645596, 'auroc': 0.9953284, 'binary_precision': 0.9800922, 'binary_recall': 0.99844515, 'binary_specificity': 0.6050033, 'binary_f1_score': 0.9891836}
confusion matrix:
     0      1
0  919    600
1   46  29539
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.7662178, 'recall': 0.614002, 'specificity': 0.614002, 'f1': 0.54619354, 'auroc': 0.9362723, 'binary_precision': 0.55791336, 'binary_recall': 0.9937008, 'binary_specificity': 0.23430322, 'binary_f1_score': 0.7146093}
confusion matrix:
     0    1
0  153  500
1    4  631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.78098106, 'recall': 0.6372524, 'specificity': 0.6372524, 'f1': 0.6083499, 'auroc': 0.9212748, 'binary_precision': 0.6354916, 'binary_recall': 0.9814815, 'binary_specificity': 0.29302326, 'binary_f1_score': 0.7714701}
confusion matrix:
    0    1
0  63  152
1   5  265
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 11:59:51.035341,epoch time: 0:10:49.597077,used: 0:22:12.340099,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98910105, 'precision': 0.94610023, 'recall': 0.935212, 'specificity': 0.935212, 'f1': 0.94058084, 'auroc': 0.99633336, 'binary_precision': 0.9936203, 'binary_recall': 0.99493, 'binary_specificity': 0.87549406, 'binary_f1_score': 0.99427474}
confusion matrix:
      0      1
0  1329    189
1   150  29436
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.7943295, 'recall': 0.6813833, 'specificity': 0.6813833, 'f1': 0.64441705, 'auroc': 0.9332071, 'binary_precision': 0.6049856, 'binary_recall': 0.9937008, 'binary_specificity': 0.36906585, 'binary_f1_score': 0.75208575}
confusion matrix:
     0    1
0  241  412
1    4  631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70927835, 'precision': 0.80563456, 'recall': 0.673988, 'specificity': 0.673988, 'f1': 0.6578714, 'auroc': 0.93336785, 'binary_precision': 0.6600496, 'binary_recall': 0.9851852, 'binary_specificity': 0.3627907, 'binary_f1_score': 0.7904903}
confusion matrix:
    0    1
0  78  137
1   4  266
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 12:10:28.730375,epoch time: 0:10:37.695034,used: 0:32:50.035133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97537297, 'precision': 0.8352645, 'recall': 0.9707948, 'specificity': 0.9707948, 'f1': 0.8898288, 'auroc': 0.99683857, 'binary_precision': 0.99820226, 'binary_recall': 0.9758678, 'binary_specificity': 0.96572185, 'binary_f1_score': 0.9869087}
confusion matrix:
      0      1
0  1465     52
1   714  28873
---- Validation: 
scalar performance:
{'acc': 0.82841617, 'precision': 0.8317362, 'recall': 0.8291097, 'specificity': 0.8291097, 'f1': 0.82816744, 'auroc': 0.9201504, 'binary_precision': 0.7948718, 'binary_recall': 0.87874013, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.8347046}
confusion matrix:
     0    1
0  509  144
1   77  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71546394, 'precision': 0.7611884, 'recall': 0.7368648, 'specificity': 0.7368648, 'f1': 0.7122825, 'auroc': 0.86759686, 'binary_precision': 0.902439, 'binary_recall': 0.54814816, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.68202764}
confusion matrix:
     0    1
0  199   16
1  122  148
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 12:21:26.485033,epoch time: 0:10:57.754658,used: 0:43:47.789791,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9919303, 'precision': 0.9736053, 'recall': 0.93763673, 'specificity': 0.93763673, 'f1': 0.95483017, 'auroc': 0.998518, 'binary_precision': 0.99373883, 'binary_recall': 0.99780303, 'binary_specificity': 0.8774704, 'binary_f1_score': 0.9957668}
confusion matrix:
      0      1
0  1332    186
1    65  29521
---- Validation: 
scalar performance:
{'acc': 0.81055903, 'precision': 0.8399987, 'recall': 0.8126056, 'specificity': 0.8126056, 'f1': 0.8070374, 'auroc': 0.94150317, 'binary_precision': 0.7363966, 'binary_recall': 0.9590551, 'binary_specificity': 0.6661562, 'binary_f1_score': 0.8331053}
confusion matrix:
     0    1
0  435  218
1   26  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8041237, 'precision': 0.8120403, 'recall': 0.7923342, 'specificity': 0.7923342, 'f1': 0.7964786, 'auroc': 0.92101634, 'binary_precision': 0.78317153, 'binary_recall': 0.8962963, 'binary_specificity': 0.6883721, 'binary_f1_score': 0.83592397}
confusion matrix:
     0    1
0  148   67
1   28  242
new oracle model saved
early stop counter: 1
val acc:0.8105590343475342, best validation acc: 0.8284161686897278, corresponding to test acc:                         0.7154639363288879 / 0.8041236996650696
after epoch: 5,now: 2024-07-11 12:32:10.956174,epoch time: 0:10:44.471141,used: 0:54:32.260932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99115866, 'precision': 0.93250024, 'recall': 0.98004097, 'specificity': 0.98004097, 'f1': 0.95487446, 'auroc': 0.99869263, 'binary_precision': 0.9983339, 'binary_recall': 0.99236125, 'binary_specificity': 0.9677207, 'binary_f1_score': 0.9953386}
confusion matrix:
      0      1
0  1469     49
1   226  29360
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.86676013, 'recall': 0.8626207, 'specificity': 0.8626207, 'f1': 0.8615007, 'auroc': 0.93882626, 'binary_precision': 0.82047683, 'binary_recall': 0.9212598, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.86795247}
confusion matrix:
     0    1
0  525  128
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8041237, 'precision': 0.8082355, 'recall': 0.81128335, 'specificity': 0.81128335, 'f1': 0.8039603, 'auroc': 0.9065633, 'binary_precision': 0.88209605, 'binary_recall': 0.74814814, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8096192}
confusion matrix:
     0    1
0  188   27
1   68  202
better model found
persisted
after epoch: 6,now: 2024-07-11 12:42:55.338253,epoch time: 0:10:44.382079,used: 1:05:16.643011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99369854, 'precision': 0.96501213, 'recall': 0.96733475, 'specificity': 0.96733475, 'f1': 0.96617025, 'auroc': 0.9988961, 'binary_precision': 0.9968219, 'binary_recall': 0.9965523, 'binary_specificity': 0.9381172, 'binary_f1_score': 0.9966871}
confusion matrix:
      0      1
0  1425     94
1   102  29483
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.8655319, 'recall': 0.85454535, 'specificity': 0.85454535, 'f1': 0.8523164, 'auroc': 0.9529561, 'binary_precision': 0.79497355, 'binary_recall': 0.9464567, 'binary_specificity': 0.762634, 'binary_f1_score': 0.8641265}
confusion matrix:
     0    1
0  498  155
1   34  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.88039947, 'recall': 0.8826012, 'specificity': 0.8826012, 'f1': 0.8813117, 'auroc': 0.9423256, 'binary_precision': 0.904943, 'binary_recall': 0.88148147, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8930582}
confusion matrix:
     0    1
0  190   25
1   32  238
new oracle model saved
early stop counter: 1
val acc:0.85326087474823, best validation acc: 0.861801266670227, corresponding to test acc:                         0.8041236996650696 / 0.8824742436408997
after epoch: 7,now: 2024-07-11 12:53:43.572637,epoch time: 0:10:48.234384,used: 1:16:04.877395,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9898084, 'precision': 0.91817033, 'recall': 0.9862114, 'specificity': 0.9862114, 'f1': 0.94929355, 'auroc': 0.9991648, 'binary_precision': 0.99907917, 'binary_recall': 0.9901977, 'binary_specificity': 0.9822251, 'binary_f1_score': 0.9946186}
confusion matrix:
      0      1
0  1492     27
1   290  29295
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.88027555, 'recall': 0.8675803, 'specificity': 0.8675803, 'f1': 0.86750066, 'auroc': 0.951579, 'binary_precision': 0.9429658, 'binary_recall': 0.78110236, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.85443586}
confusion matrix:
     0    1
0  623   30
1  139  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69278353, 'precision': 0.7842784, 'recall': 0.7226529, 'specificity': 0.7226529, 'f1': 0.6823251, 'auroc': 0.90530574, 'binary_precision': 0.97637796, 'binary_recall': 0.45925927, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.62468517}
confusion matrix:
     0    1
0  212    3
1  146  124
better model found
persisted
after epoch: 8,now: 2024-07-11 13:04:42.185178,epoch time: 0:10:58.612541,used: 1:27:03.489936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9927983, 'precision': 0.94368184, 'recall': 0.98401093, 'specificity': 0.98401093, 'f1': 0.96286035, 'auroc': 0.9991162, 'binary_precision': 0.99867535, 'binary_recall': 0.9937475, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.99620533}
confusion matrix:
      0      1
0  1477     39
1   185  29403
---- Validation: 
scalar performance:
{'acc': 0.8998447, 'precision': 0.89991796, 'recall': 0.89974916, 'specificity': 0.89974916, 'f1': 0.899807, 'auroc': 0.9543139, 'binary_precision': 0.90286624, 'binary_recall': 0.8929134, 'binary_specificity': 0.906585, 'binary_f1_score': 0.8978622}
confusion matrix:
     0    1
0  592   61
1   68  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82474226, 'precision': 0.8416812, 'recall': 0.8378553, 'specificity': 0.8378553, 'f1': 0.82466775, 'auroc': 0.9226012, 'binary_precision': 0.9512195, 'binary_recall': 0.7222222, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8210527}
confusion matrix:
     0    1
0  205   10
1   75  195
better model found
persisted
after epoch: 9,now: 2024-07-11 13:15:35.158103,epoch time: 0:10:52.972925,used: 1:37:56.462861,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9936021, 'precision': 0.975908, 'recall': 0.95413953, 'specificity': 0.95413953, 'f1': 0.96473974, 'auroc': 0.999144, 'binary_precision': 0.99541456, 'binary_recall': 0.9978706, 'binary_specificity': 0.91040844, 'binary_f1_score': 0.9966411}
confusion matrix:
      0      1
0  1382    136
1    63  29523
---- Validation: 
scalar performance:
{'acc': 0.8330745, 'precision': 0.8533419, 'recall': 0.83474576, 'specificity': 0.83474576, 'f1': 0.8311075, 'auroc': 0.9365473, 'binary_precision': 0.7651515, 'binary_recall': 0.9543307, 'binary_specificity': 0.7151608, 'binary_f1_score': 0.84933424}
confusion matrix:
     0    1
0  467  186
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83092785, 'precision': 0.8305898, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8303212, 'auroc': 0.90742457, 'binary_precision': 0.8852459, 'binary_recall': 0.8, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8404669}
confusion matrix:
     0    1
0  187   28
1   54  216
early stop counter: 1
val acc:0.8330745100975037, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 10,now: 2024-07-11 13:26:27.965147,epoch time: 0:10:52.807044,used: 1:48:49.269905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99299127, 'precision': 0.96386075, 'recall': 0.96038055, 'specificity': 0.96038055, 'f1': 0.9621133, 'auroc': 0.9988022, 'binary_precision': 0.9961146, 'binary_recall': 0.9965186, 'binary_specificity': 0.92424244, 'binary_f1_score': 0.99631655}
confusion matrix:
      0      1
0  1403    115
1   103  29483
---- Validation: 
scalar performance:
{'acc': 0.85636646, 'precision': 0.8714844, 'recall': 0.85778177, 'specificity': 0.85778177, 'f1': 0.8552122, 'auroc': 0.9537784, 'binary_precision': 0.79296875, 'binary_recall': 0.9590551, 'binary_specificity': 0.7565084, 'binary_f1_score': 0.8681397}
confusion matrix:
     0    1
0  494  159
1   26  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.86434865, 'recall': 0.8593023, 'specificity': 0.8593023, 'f1': 0.86127007, 'auroc': 0.94098186, 'binary_precision': 0.86170214, 'binary_recall': 0.9, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8804348}
confusion matrix:
     0    1
0  176   39
1   27  243
early stop counter: 2
val acc:0.8563664555549622, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 11,now: 2024-07-11 13:37:46.454613,epoch time: 0:11:18.489466,used: 2:00:07.759371,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9950167, 'precision': 0.97248554, 'recall': 0.97396064, 'specificity': 0.97396064, 'f1': 0.9732218, 'auroc': 0.9994924, 'binary_precision': 0.9974645, 'binary_recall': 0.9972959, 'binary_specificity': 0.9506254, 'binary_f1_score': 0.9973802}
confusion matrix:
      0      1
0  1444     75
1    80  29505
---- Validation: 
scalar performance:
{'acc': 0.8959627, 'precision': 0.89708257, 'recall': 0.8963548, 'specificity': 0.8963548, 'f1': 0.8959376, 'auroc': 0.9511353, 'binary_precision': 0.87221396, 'binary_recall': 0.92440945, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.8975535}
confusion matrix:
     0    1
0  567   86
1   48  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.88603127, 'recall': 0.8901809, 'specificity': 0.8901809, 'f1': 0.88234615, 'auroc': 0.94254947, 'binary_precision': 0.96103895, 'binary_recall': 0.82222223, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.88622755}
confusion matrix:
     0    1
0  206    9
1   48  222
early stop counter: 3
val acc:0.8959627151489258, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 12,now: 2024-07-11 13:49:13.348219,epoch time: 0:11:26.893606,used: 2:11:34.652977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99321634, 'precision': 0.9547167, 'recall': 0.9742633, 'specificity': 0.9742633, 'f1': 0.96425927, 'auroc': 0.9990658, 'binary_precision': 0.99759454, 'binary_recall': 0.99526787, 'binary_specificity': 0.9532587, 'binary_f1_score': 0.9964298}
confusion matrix:
      0      1
0  1448     71
1   140  29445
---- Validation: 
scalar performance:
{'acc': 0.85559005, 'precision': 0.8677187, 'recall': 0.8568641, 'specificity': 0.8568641, 'f1': 0.8546787, 'auroc': 0.94889784, 'binary_precision': 0.797351, 'binary_recall': 0.9480315, 'binary_specificity': 0.76569676, 'binary_f1_score': 0.86618704}
confusion matrix:
     0    1
0  500  153
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.8695154, 'recall': 0.8667528, 'specificity': 0.8667528, 'f1': 0.8679451, 'auroc': 0.94482344, 'binary_precision': 0.8736462, 'binary_recall': 0.8962963, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.88482636}
confusion matrix:
     0    1
0  180   35
1   28  242
early stop counter: 4
val acc:0.8555900454521179, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 13,now: 2024-07-11 14:00:10.103867,epoch time: 0:10:56.755648,used: 2:22:31.408625,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99524176, 'precision': 0.9792719, 'recall': 0.9690827, 'specificity': 0.9690827, 'f1': 0.9741162, 'auroc': 0.9993689, 'binary_precision': 0.9969276, 'binary_recall': 0.99807334, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.9975001}
confusion matrix:
      0      1
0  1428     91
1    57  29528
---- Validation: 
scalar performance:
{'acc': 0.8579193, 'precision': 0.8682642, 'recall': 0.8590961, 'specificity': 0.8590961, 'f1': 0.85717463, 'auroc': 0.9495195, 'binary_precision': 0.8029491, 'binary_recall': 0.9433071, 'binary_specificity': 0.7748851, 'binary_f1_score': 0.8674874}
confusion matrix:
     0    1
0  506  147
1   36  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85267985, 'recall': 0.85004306, 'specificity': 0.85004306, 'f1': 0.8511762, 'auroc': 0.9376917, 'binary_precision': 0.8592058, 'binary_recall': 0.88148147, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8702011}
confusion matrix:
     0    1
0  176   39
1   32  238
early stop counter: 5
val acc:0.8579192757606506, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 14,now: 2024-07-11 14:11:10.732365,epoch time: 0:11:00.628498,used: 2:33:32.037123,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9948238, 'precision': 0.9859389, 'recall': 0.9576216, 'specificity': 0.9576216, 'f1': 0.9713072, 'auroc': 0.99946105, 'binary_precision': 0.99572074, 'binary_recall': 0.99885076, 'binary_specificity': 0.9163924, 'binary_f1_score': 0.99728334}
confusion matrix:
      0      1
0  1392    127
1    34  29551
---- Validation: 
scalar performance:
{'acc': 0.8486025, 'precision': 0.8653854, 'recall': 0.85010314, 'specificity': 0.85010314, 'f1': 0.8472091, 'auroc': 0.94999754, 'binary_precision': 0.78350514, 'binary_recall': 0.9574803, 'binary_specificity': 0.7427259, 'binary_f1_score': 0.86180013}
confusion matrix:
     0    1
0  485  168
1   27  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85773194, 'precision': 0.8588158, 'recall': 0.85232556, 'specificity': 0.85232556, 'f1': 0.8547053, 'auroc': 0.935969, 'binary_precision': 0.85263157, 'binary_recall': 0.9, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8756756}
confusion matrix:
     0    1
0  173   42
1   27  243
early stop counter: 6
val acc:0.8486024737358093, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 15,now: 2024-07-11 14:22:15.250100,epoch time: 0:11:04.517735,used: 2:44:36.554858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9930234, 'precision': 0.97778237, 'recall': 0.9457108, 'specificity': 0.9457108, 'f1': 0.96112627, 'auroc': 0.998564, 'binary_precision': 0.99454415, 'binary_recall': 0.998141, 'binary_specificity': 0.8932806, 'binary_f1_score': 0.9963393}
confusion matrix:
      0      1
0  1356    162
1    55  29531
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.8469696, 'recall': 0.8135667, 'specificity': 0.8135667, 'f1': 0.80709326, 'auroc': 0.9614547, 'binary_precision': 0.7322275, 'binary_recall': 0.97322834, 'binary_specificity': 0.65390503, 'binary_f1_score': 0.83569986}
confusion matrix:
     0    1
0  427  226
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391753, 'precision': 0.849347, 'recall': 0.8280792, 'specificity': 0.8280792, 'f1': 0.8330362, 'auroc': 0.94628763, 'binary_precision': 0.8116883, 'binary_recall': 0.9259259, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8650519}
confusion matrix:
     0    1
0  157   58
1   20  250
early stop counter: 7
val acc:0.8113353848457336, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 16,now: 2024-07-11 14:33:31.040439,epoch time: 0:11:15.790339,used: 2:55:52.345197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9948881, 'precision': 0.97686195, 'recall': 0.96760666, 'specificity': 0.96760666, 'f1': 0.9721837, 'auroc': 0.9992962, 'binary_precision': 0.9967925, 'binary_recall': 0.9978369, 'binary_specificity': 0.9373764, 'binary_f1_score': 0.9973144}
confusion matrix:
      0      1
0  1422     95
1    64  29523
---- Validation: 
scalar performance:
{'acc': 0.8416149, 'precision': 0.8668872, 'recall': 0.84345055, 'specificity': 0.84345055, 'f1': 0.83931786, 'auroc': 0.9637289, 'binary_precision': 0.7670384, 'binary_recall': 0.97480315, 'binary_specificity': 0.712098, 'binary_f1_score': 0.85852987}
confusion matrix:
     0    1
0  465  188
1   16  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.8407099, 'recall': 0.8080534, 'specificity': 0.8080534, 'f1': 0.81360817, 'auroc': 0.9447545, 'binary_precision': 0.78571427, 'binary_recall': 0.93703705, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.85472965}
confusion matrix:
     0    1
0  146   69
1   17  253
early stop counter: 8
val acc:0.8416149020195007, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 17,now: 2024-07-11 14:44:22.365733,epoch time: 0:10:51.325294,used: 3:06:43.670491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9936021, 'precision': 0.98895967, 'recall': 0.9413662, 'specificity': 0.9413662, 'f1': 0.9638101, 'auroc': 0.99930096, 'binary_precision': 0.9940484, 'binary_recall': 0.9992564, 'binary_specificity': 0.88347596, 'binary_f1_score': 0.9966456}
confusion matrix:
      0      1
0  1342    177
1    22  29563
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8433623, 'recall': 0.79612935, 'specificity': 0.79612935, 'f1': 0.7866758, 'auroc': 0.96257365, 'binary_precision': 0.70894676, 'binary_recall': 0.9858268, 'binary_specificity': 0.60643184, 'binary_f1_score': 0.82476944}
confusion matrix:
     0    1
0  396  257
1    9  626
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371134, 'precision': 0.8465487, 'recall': 0.82622737, 'specificity': 0.82622737, 'f1': 0.83103347, 'auroc': 0.9391215, 'binary_precision': 0.8110749, 'binary_recall': 0.9222222, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.86308485}
confusion matrix:
     0    1
0  157   58
1   21  249
early stop counter: 9
val acc:0.79347825050354, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 18,now: 2024-07-11 14:56:19.482359,epoch time: 0:11:57.116626,used: 3:18:40.787117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9930556, 'precision': 0.9501908, 'recall': 0.9782257, 'specificity': 0.9782257, 'f1': 0.96373296, 'auroc': 0.9989377, 'binary_precision': 0.998033, 'binary_recall': 0.99465966, 'binary_specificity': 0.9617918, 'binary_f1_score': 0.99634343}
confusion matrix:
      0      1
0  1460     58
1   158  29428
---- Validation: 
scalar performance:
{'acc': 0.863354, 'precision': 0.8740396, 'recall': 0.86454284, 'specificity': 0.86454284, 'f1': 0.8626223, 'auroc': 0.951169, 'binary_precision': 0.8072289, 'binary_recall': 0.9496063, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.8726483}
confusion matrix:
     0    1
0  509  144
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8783505, 'precision': 0.8764646, 'recall': 0.87747633, 'specificity': 0.87747633, 'f1': 0.87693584, 'auroc': 0.94391036, 'binary_precision': 0.8951311, 'binary_recall': 0.8851852, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.89013034}
confusion matrix:
     0    1
0  187   28
1   31  239
early stop counter: 10
val acc:0.8633540272712708, best validation acc: 0.8998447060585022, corresponding to test acc:                         0.8247422575950623 / 0.8824742436408997
after epoch: 19,now: 2024-07-11 15:08:25.211283,epoch time: 0:12:05.728924,used: 3:30:46.516041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9956276, 'precision': 0.975327, 'recall': 0.97770286, 'specificity': 0.97770286, 'f1': 0.9765116, 'auroc': 0.9995147, 'binary_precision': 0.99783623, 'binary_recall': 0.9975664, 'binary_specificity': 0.95783925, 'binary_f1_score': 0.9977013}
confusion matrix:
      0      1
0  1454     64
1    72  29514
---- Validation: 
scalar performance:
{'acc': 0.90993786, 'precision': 0.9100623, 'recall': 0.9100939, 'specificity': 0.9100939, 'f1': 0.9099376, 'auroc': 0.96251583, 'binary_precision': 0.8986175, 'binary_recall': 0.9212598, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.9097977}
confusion matrix:
     0    1
0  587   66
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.83460855, 'recall': 0.8299742, 'specificity': 0.8299742, 'f1': 0.8163824, 'auroc': 0.9217571, 'binary_precision': 0.9458128, 'binary_recall': 0.7111111, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.81183934}
confusion matrix:
     0    1
0  204   11
1   78  192
better model found
persisted
after epoch: 20,now: 2024-07-11 15:20:03.076575,epoch time: 0:11:37.865292,used: 3:42:24.381333,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99318415, 'precision': 0.9452493, 'recall': 0.98673695, 'specificity': 0.98673695, 'f1': 0.9649544, 'auroc': 0.9994799, 'binary_precision': 0.99894685, 'binary_recall': 0.99388206, 'binary_specificity': 0.97959185, 'binary_f1_score': 0.99640805}
confusion matrix:
      0      1
0  1488     31
1   181  29404
---- Validation: 
scalar performance:
{'acc': 0.91459626, 'precision': 0.91487586, 'recall': 0.91442764, 'specificity': 0.91442764, 'f1': 0.9145435, 'auroc': 0.9611821, 'binary_precision': 0.9227053, 'binary_recall': 0.9023622, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.9124204}
confusion matrix:
     0    1
0  605   48
1   62  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88659793, 'precision': 0.8958097, 'recall': 0.8972007, 'specificity': 0.8972007, 'f1': 0.88659024, 'auroc': 0.95369506, 'binary_precision': 0.99086756, 'binary_recall': 0.8037037, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.88752556}
confusion matrix:
     0    1
0  213    2
1   53  217
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-11 15:31:04.631001,epoch time: 0:11:01.554426,used: 3:53:25.935759,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9945023, 'precision': 0.9559498, 'recall': 0.98804194, 'specificity': 0.98804194, 'f1': 0.9713836, 'auroc': 0.99956095, 'binary_precision': 0.9990161, 'binary_recall': 0.9952006, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.9971047}
confusion matrix:
      0      1
0  1488     29
1   142  29445
---- Validation: 
scalar performance:
{'acc': 0.9122671, 'precision': 0.9123264, 'recall': 0.912391, 'specificity': 0.912391, 'f1': 0.9122658, 'auroc': 0.96320075, 'binary_precision': 0.9027778, 'binary_recall': 0.9212598, 'binary_specificity': 0.9035222, 'binary_f1_score': 0.91192526}
confusion matrix:
     0    1
0  590   63
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82061857, 'precision': 0.82729435, 'recall': 0.8294143, 'specificity': 0.8294143, 'f1': 0.82056975, 'auroc': 0.9132644, 'binary_precision': 0.9103139, 'binary_recall': 0.75185186, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  195   20
1   67  203
early stop counter: 1
val acc:0.9122670888900757, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.8865979313850403
after epoch: 22,now: 2024-07-11 15:42:02.108496,epoch time: 0:10:57.477495,used: 4:04:23.413254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99549896, 'precision': 0.9700041, 'recall': 0.98232245, 'specificity': 0.98232245, 'f1': 0.9760741, 'auroc': 0.9994722, 'binary_precision': 0.99834144, 'binary_recall': 0.9969242, 'binary_specificity': 0.9677207, 'binary_f1_score': 0.9976323}
confusion matrix:
      0      1
0  1469     49
1    91  29495
---- Validation: 
scalar performance:
{'acc': 0.882764, 'precision': 0.8878257, 'recall': 0.88357675, 'specificity': 0.88357675, 'f1': 0.88251746, 'auroc': 0.9512534, 'binary_precision': 0.8398876, 'binary_recall': 0.9417323, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.88789904}
confusion matrix:
     0    1
0  539  114
1   37  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.87368196, 'recall': 0.8785099, 'specificity': 0.8785099, 'f1': 0.8737438, 'auroc': 0.9279586, 'binary_precision': 0.9265306, 'binary_recall': 0.84074074, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8815534}
confusion matrix:
     0    1
0  197   18
1   43  227
early stop counter: 2
val acc:0.8827639818191528, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.8865979313850403
after epoch: 23,now: 2024-07-11 15:52:52.769639,epoch time: 0:10:50.661143,used: 4:15:14.074397,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99466306, 'precision': 0.9610339, 'recall': 0.98344547, 'specificity': 0.98344547, 'f1': 0.97194165, 'auroc': 0.9994165, 'binary_precision': 0.9985089, 'binary_recall': 0.99587643, 'binary_specificity': 0.9710145, 'binary_f1_score': 0.99719095}
confusion matrix:
      0      1
0  1474     44
1   122  29464
---- Validation: 
scalar performance:
{'acc': 0.8486025, 'precision': 0.86968565, 'recall': 0.8469342, 'specificity': 0.8469342, 'f1': 0.8459503, 'auroc': 0.96005106, 'binary_precision': 0.95454544, 'binary_recall': 0.72755903, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.82573724}
confusion matrix:
     0    1
0  631   22
1  173  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041237, 'precision': 0.746482, 'recall': 0.64302325, 'specificity': 0.64302325, 'f1': 0.5729694, 'auroc': 0.9269078, 'binary_precision': 0.96428573, 'binary_recall': 0.3, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.4576271}
confusion matrix:
     0   1
0  212   3
1  189  81
early stop counter: 3
val acc:0.8486024737358093, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.8865979313850403
after epoch: 24,now: 2024-07-11 16:03:49.600949,epoch time: 0:10:56.831310,used: 4:26:10.905707,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9960134, 'precision': 0.9814391, 'recall': 0.9754214, 'specificity': 0.9754214, 'f1': 0.9784092, 'auroc': 0.9995111, 'binary_precision': 0.99756795, 'binary_recall': 0.9982424, 'binary_specificity': 0.9526004, 'binary_f1_score': 0.9979051}
confusion matrix:
      0      1
0  1447     72
1    52  29533
---- Validation: 
scalar performance:
{'acc': 0.8990683, 'precision': 0.90006447, 'recall': 0.89943933, 'specificity': 0.89943933, 'f1': 0.8990486, 'auroc': 0.951702, 'binary_precision': 0.87630403, 'binary_recall': 0.92598426, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.9004594}
confusion matrix:
     0    1
0  570   83
1   47  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.8703989, 'recall': 0.87304044, 'specificity': 0.87304044, 'f1': 0.8638706, 'auroc': 0.92415154, 'binary_precision': 0.95535713, 'binary_recall': 0.7925926, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8663968}
confusion matrix:
     0    1
0  205   10
1   56  214
early stop counter: 4
val acc:0.899068295955658, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.8865979313850403
after epoch: 25,now: 2024-07-11 16:14:47.948747,epoch time: 0:10:58.347798,used: 4:37:09.253505,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9959491, 'precision': 0.9762072, 'recall': 0.9803717, 'specificity': 0.9803717, 'f1': 0.9782793, 'auroc': 0.9994887, 'binary_precision': 0.9981063, 'binary_recall': 0.997634, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.9978701}
confusion matrix:
      0      1
0  1462     56
1    70  29516
---- Validation: 
scalar performance:
{'acc': 0.91071427, 'precision': 0.91154623, 'recall': 0.91105497, 'specificity': 0.91105497, 'f1': 0.9107022, 'auroc': 0.9639555, 'binary_precision': 0.88922155, 'binary_recall': 0.9354331, 'binary_specificity': 0.88667685, 'binary_f1_score': 0.91174215}
confusion matrix:
     0    1
0  579   74
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9072165, 'precision': 0.9075828, 'recall': 0.91287684, 'specificity': 0.91287684, 'f1': 0.9069491, 'auroc': 0.9556416, 'binary_precision': 0.966805, 'binary_recall': 0.86296296, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.9119374}
confusion matrix:
     0    1
0  207    8
1   37  233
new oracle model saved
early stop counter: 5
val acc:0.9107142686843872, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.907216489315033
after epoch: 26,now: 2024-07-11 16:25:46.805062,epoch time: 0:10:58.856315,used: 4:48:08.109820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.995081, 'precision': 0.98999274, 'recall': 0.9565077, 'specificity': 0.9565077, 'f1': 0.9725914, 'auroc': 0.99964017, 'binary_precision': 0.99558836, 'binary_recall': 0.9992564, 'binary_specificity': 0.91375905, 'binary_f1_score': 0.997419}
confusion matrix:
      0      1
0  1388    131
1    22  29563
---- Validation: 
scalar performance:
{'acc': 0.8338509, 'precision': 0.86117065, 'recall': 0.8357719, 'specificity': 0.8357719, 'f1': 0.8311803, 'auroc': 0.9504142, 'binary_precision': 0.7582822, 'binary_recall': 0.97322834, 'binary_specificity': 0.69831544, 'binary_f1_score': 0.85241383}
confusion matrix:
     0    1
0  456  197
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83092785, 'precision': 0.83142114, 'recall': 0.8249354, 'specificity': 0.8249354, 'f1': 0.8272252, 'auroc': 0.88673556, 'binary_precision': 0.82867134, 'binary_recall': 0.87777776, 'binary_specificity': 0.772093, 'binary_f1_score': 0.852518}
confusion matrix:
     0    1
0  166   49
1   33  237
early stop counter: 6
val acc:0.8338509202003479, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.907216489315033
after epoch: 27,now: 2024-07-11 16:36:50.638106,epoch time: 0:11:03.833044,used: 4:59:11.942864,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9922196, 'precision': 0.98385656, 'recall': 0.9309142, 'specificity': 0.9309142, 'f1': 0.955683, 'auroc': 0.99929166, 'binary_precision': 0.99301076, 'binary_recall': 0.9988508, 'binary_specificity': 0.8629776, 'binary_f1_score': 0.99592227}
confusion matrix:
      0      1
0  1310    208
1    34  29552
---- Validation: 
scalar performance:
{'acc': 0.82763976, 'precision': 0.85320294, 'recall': 0.82951605, 'specificity': 0.82951605, 'f1': 0.8250064, 'auroc': 0.95673275, 'binary_precision': 0.75462395, 'binary_recall': 0.9637795, 'binary_specificity': 0.69525266, 'binary_f1_score': 0.84647304}
confusion matrix:
     0    1
0  454  199
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8594931, 'recall': 0.8359604, 'specificity': 0.8359604, 'f1': 0.8413351, 'auroc': 0.9473213, 'binary_precision': 0.816129, 'binary_recall': 0.93703705, 'binary_specificity': 0.7348837, 'binary_f1_score': 0.8724138}
confusion matrix:
     0    1
0  158   57
1   17  253
early stop counter: 7
val acc:0.8276397585868835, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.907216489315033
after epoch: 28,now: 2024-07-11 16:47:46.712274,epoch time: 0:10:56.074168,used: 5:10:08.017032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9933128, 'precision': 0.9491923, 'recall': 0.98273563, 'specificity': 0.98273563, 'f1': 0.9652857, 'auroc': 0.9992515, 'binary_precision': 0.9985067, 'binary_recall': 0.9944568, 'binary_specificity': 0.9710145, 'binary_f1_score': 0.99647766}
confusion matrix:
      0      1
0  1474     44
1   164  29422
---- Validation: 
scalar performance:
{'acc': 0.89518636, 'precision': 0.8962811, 'recall': 0.89482945, 'specificity': 0.89482945, 'f1': 0.89503443, 'auroc': 0.95042145, 'binary_precision': 0.9139073, 'binary_recall': 0.86929137, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.8910412}
confusion matrix:
     0    1
0  601   52
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8412371, 'precision': 0.8392157, 'recall': 0.8427218, 'specificity': 0.8427218, 'f1': 0.8401499, 'auroc': 0.9151938, 'binary_precision': 0.8784314, 'binary_recall': 0.8296296, 'binary_specificity': 0.855814, 'binary_f1_score': 0.85333335}
confusion matrix:
     0    1
0  184   31
1   46  224
early stop counter: 8
val acc:0.8951863646507263, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.907216489315033
after epoch: 29,now: 2024-07-11 16:58:40.181499,epoch time: 0:10:53.469225,used: 5:21:01.486257,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9965921, 'precision': 0.9845931, 'recall': 0.97853595, 'specificity': 0.97853595, 'f1': 0.9815433, 'auroc': 0.99975634, 'binary_precision': 0.997872, 'binary_recall': 0.99854654, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.9982092}
confusion matrix:
      0      1
0  1456     63
1    43  29542
---- Validation: 
scalar performance:
{'acc': 0.9130435, 'precision': 0.9149886, 'recall': 0.9135474, 'specificity': 0.9135474, 'f1': 0.9129963, 'auroc': 0.967151, 'binary_precision': 0.8828697, 'binary_recall': 0.9496063, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.9150228}
confusion matrix:
     0    1
0  573   80
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90927833, 'precision': 0.9099065, 'recall': 0.9152024, 'specificity': 0.9152024, 'f1': 0.9090367, 'auroc': 0.954677, 'binary_precision': 0.97083336, 'binary_recall': 0.86296296, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.91372555}
confusion matrix:
     0    1
0  208    7
1   37  233
new oracle model saved
early stop counter: 9
val acc:0.9130434989929199, best validation acc: 0.9145962595939636, corresponding to test acc:                         0.8865979313850403 / 0.9092783331871033
after epoch: 30,now: 2024-07-11 17:09:33.361185,epoch time: 0:10:53.179686,used: 5:31:54.665943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_37_38_seed_0_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:31:54.665943 at 2024-07-11 17:09:33.361185
persisted model performance metric: 

scalar performance:
{'acc': 0.88659793, 'precision': 0.8958097, 'recall': 0.8972007, 'specificity': 0.8972007, 'f1': 0.88659024, 'auroc': 0.95369506, 'binary_precision': 0.99086756, 'binary_recall': 0.8037037, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.88752556}
confusion matrix:
     0    1
0  213    2
1   53  217
oracle model performance metric: 

scalar performance:
{'acc': 0.90927833, 'precision': 0.9099065, 'recall': 0.9152024, 'specificity': 0.9152024, 'f1': 0.9090367, 'auroc': 0.954677, 'binary_precision': 0.97083336, 'binary_recall': 0.86296296, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.91372555}
confusion matrix:
     0    1
0  208    7
1   37  233
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455466 KiB |  13219 MiB | 361597 GiB | 361596 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 356767 GiB | 356767 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455466 KiB |  13219 MiB | 361597 GiB | 361596 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 356767 GiB | 356767 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 358206 GiB | 358205 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 353387 GiB | 353386 GiB |
|       from small pool |  40408 KiB |     56 MiB |   4818 GiB |   4818 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14470 MiB |  14470 MiB |      0 B   |
|       from large pool |  14404 MiB |  14404 MiB |  14404 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 474326 KiB |   1229 MiB | 269993 GiB | 269993 GiB |
|       from large pool | 461682 KiB |   1224 MiB | 265151 GiB | 265150 GiB |
|       from small pool |  12643 KiB |     17 MiB |   4842 GiB |   4842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1322    |    4893    |   68263 K  |   68261 K  |
|       from large pool |     187    |    1413    |   32681 K  |   32681 K  |
|       from small pool |    1135    |    4704    |   35581 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1322    |    4893    |   68263 K  |   68261 K  |
|       from large pool |     187    |    1413    |   32681 K  |   32681 K  |
|       from small pool |    1135    |    4704    |   35581 K  |   35580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |    2014    |   45395 K  |   45394 K  |
|       from large pool |      39    |     600    |   27880 K  |   27880 K  |
|       from small pool |      58    |    1974    |   17514 K  |   17514 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 361597 GiB | 361597 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 356767 GiB | 356767 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 361597 GiB | 361597 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 356767 GiB | 356767 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 358206 GiB | 358206 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 353387 GiB | 353387 GiB |
|       from small pool |      0 KiB |     56 MiB |   4818 GiB |   4818 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB | 269994 GiB | 269994 GiB |
|       from large pool |  24320 KiB |   1224 MiB | 265151 GiB | 265151 GiB |
|       from small pool |      0 KiB |     43 MiB |   4842 GiB |   4842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2014    |   45395 K  |   45395 K  |
|       from large pool |       4    |     600    |   27880 K  |   27880 K  |
|       from small pool |       0    |    1974    |   17515 K  |   17515 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 361597 GiB | 361597 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 356767 GiB | 356767 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 361597 GiB | 361597 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 356767 GiB | 356767 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 358206 GiB | 358206 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 353387 GiB | 353387 GiB |
|       from small pool |      0 KiB |     56 MiB |   4818 GiB |   4818 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14470 MiB |  14470 MiB |  13562 MiB |
|       from large pool |    856 MiB |  14404 MiB |  14404 MiB |  13548 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1229 MiB | 269994 GiB | 269994 GiB |
|       from large pool |  24320 KiB |   1224 MiB | 265151 GiB | 265151 GiB |
|       from small pool |      0 KiB |     43 MiB |   4842 GiB |   4842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35581 K  |   35581 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     634    |     634    |     570    |
|       from large pool |      38    |     601    |     601    |     563    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2014    |   45395 K  |   45395 K  |
|       from large pool |       4    |     600    |   27880 K  |   27880 K  |
|       from small pool |       0    |    1974    |   17515 K  |   17515 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151

 Experiment start at: 2024-07-11 17:22:00.367673
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9868337, 'precision': 0.9272834, 'recall': 0.93128204, 'specificity': 0.93128204, 'f1': 0.9292723, 'auroc': 0.9956106, 'binary_precision': 0.99332905, 'binary_recall': 0.9928273, 'binary_specificity': 0.86973685, 'binary_f1_score': 0.9930781}
confusion matrix:
      0      1
0  1322    198
1   213  29483
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.81069237, 'recall': 0.7824117, 'specificity': 0.7824117, 'f1': 0.7752732, 'auroc': 0.89794946, 'binary_precision': 0.70863307, 'binary_recall': 0.9380952, 'binary_specificity': 0.6267281, 'binary_f1_score': 0.80737704}
confusion matrix:
     0    1
0  408  243
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8012552, 'precision': 0.82238567, 'recall': 0.79331577, 'specificity': 0.79331577, 'f1': 0.7944458, 'auroc': 0.9238647, 'binary_precision': 0.7532051, 'binary_recall': 0.92885375, 'binary_specificity': 0.6577778, 'binary_f1_score': 0.8318584}
confusion matrix:
     0    1
0  148   77
1   18  235
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 17:33:07.726417,epoch time: 0:11:07.358744,used: 0:11:07.358744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98670554, 'precision': 0.9807295, 'recall': 0.8729334, 'specificity': 0.8729334, 'f1': 0.9193033, 'auroc': 0.9978237, 'binary_precision': 0.98718804, 'binary_recall': 0.9989897, 'binary_specificity': 0.7468771, 'binary_f1_score': 0.99305385}
confusion matrix:
      0      1
0  1136    385
1    30  29665
---- Validation: 
scalar performance:
{'acc': 0.7392662, 'precision': 0.8020754, 'recall': 0.74295956, 'specificity': 0.74295956, 'f1': 0.72686076, 'auroc': 0.9279107, 'binary_precision': 0.6601732, 'binary_recall': 0.96825397, 'binary_specificity': 0.51766515, 'binary_f1_score': 0.7850708}
confusion matrix:
     0    1
0  337  314
1   20  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7740586, 'precision': 0.8127544, 'recall': 0.7631972, 'specificity': 0.7631972, 'f1': 0.7614242, 'auroc': 0.90469915, 'binary_precision': 0.7164179, 'binary_recall': 0.9486166, 'binary_specificity': 0.5777778, 'binary_f1_score': 0.81632656}
confusion matrix:
     0    1
0  130   95
1   13  240
early stop counter: 1
val acc:0.7392662167549133, best validation acc: 0.7798594832420349, corresponding to test acc:                         0.8012552261352539 / 0.8012552261352539
after epoch: 2,now: 2024-07-11 17:44:04.209899,epoch time: 0:10:56.483482,used: 0:22:03.842226,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9889159, 'precision': 0.98003244, 'recall': 0.89779913, 'specificity': 0.89779913, 'f1': 0.9346455, 'auroc': 0.9980849, 'binary_precision': 0.98968863, 'binary_recall': 0.998754, 'binary_specificity': 0.7968442, 'binary_f1_score': 0.9942007}
confusion matrix:
      0      1
0  1212    309
1    37  29658
---- Validation: 
scalar performance:
{'acc': 0.6674473, 'precision': 0.7686763, 'recall': 0.6724014, 'specificity': 0.6724014, 'f1': 0.63663983, 'auroc': 0.93353385, 'binary_precision': 0.5996094, 'binary_recall': 0.9746032, 'binary_specificity': 0.37019968, 'binary_f1_score': 0.7424426}
confusion matrix:
     0    1
0  241  410
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65690374, 'precision': 0.7488024, 'recall': 0.637769, 'specificity': 0.637769, 'f1': 0.60449636, 'auroc': 0.91999996, 'binary_precision': 0.6115288, 'binary_recall': 0.9644269, 'binary_specificity': 0.31111112, 'binary_f1_score': 0.7484663}
confusion matrix:
    0    1
0  70  155
1   9  244
early stop counter: 2
val acc:0.6674473285675049, best validation acc: 0.7798594832420349, corresponding to test acc:                         0.8012552261352539 / 0.8012552261352539
after epoch: 3,now: 2024-07-11 17:54:59.950521,epoch time: 0:10:55.740622,used: 0:32:59.582848,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9888839, 'precision': 0.9855518, 'recall': 0.892792, 'specificity': 0.892792, 'f1': 0.9337492, 'auroc': 0.9989804, 'binary_precision': 0.98916596, 'binary_recall': 0.9992591, 'binary_specificity': 0.7863248, 'binary_f1_score': 0.994187}
confusion matrix:
      0      1
0  1196    325
1    22  29673
---- Validation: 
scalar performance:
{'acc': 0.5308353, 'precision': 0.75588953, 'recall': 0.53840244, 'specificity': 0.53840244, 'f1': 0.40985435, 'auroc': 0.93310475, 'binary_precision': 0.51177907, 'binary_recall': 1.0, 'binary_specificity': 0.07680491, 'binary_f1_score': 0.67705536}
confusion matrix:
    0    1
0  50  601
1   0  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5460251, 'precision': 0.76914895, 'recall': 0.5177778, 'specificity': 0.5177778, 'f1': 0.3842656, 'auroc': 0.9173825, 'binary_precision': 0.5382979, 'binary_recall': 1.0, 'binary_specificity': 0.035555556, 'binary_f1_score': 0.6998617}
confusion matrix:
   0    1
0  8  217
1  0  253
early stop counter: 3
val acc:0.5308352708816528, best validation acc: 0.7798594832420349, corresponding to test acc:                         0.8012552261352539 / 0.8012552261352539
after epoch: 4,now: 2024-07-11 18:05:53.315050,epoch time: 0:10:53.364529,used: 0:43:52.947377,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9925359, 'precision': 0.9474052, 'recall': 0.9754919, 'specificity': 0.9754919, 'f1': 0.96096855, 'auroc': 0.9981519, 'binary_precision': 0.99776983, 'binary_recall': 0.9943762, 'binary_specificity': 0.9566075, 'binary_f1_score': 0.9960701}
confusion matrix:
      0      1
0  1455     66
1   167  29528
---- Validation: 
scalar performance:
{'acc': 0.78298205, 'precision': 0.81838673, 'recall': 0.78568864, 'specificity': 0.78568864, 'f1': 0.77783394, 'auroc': 0.93132365, 'binary_precision': 0.70803785, 'binary_recall': 0.9507936, 'binary_specificity': 0.6205837, 'binary_f1_score': 0.81165314}
confusion matrix:
     0    1
0  404  247
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74058574, 'precision': 0.7627484, 'recall': 0.73108476, 'specificity': 0.73108476, 'f1': 0.7292032, 'auroc': 0.89147127, 'binary_precision': 0.6996904, 'binary_recall': 0.8932806, 'binary_specificity': 0.5688889, 'binary_f1_score': 0.7847222}
confusion matrix:
     0    1
0  128   97
1   27  226
better model found
persisted
after epoch: 5,now: 2024-07-11 18:16:45.344531,epoch time: 0:10:52.029481,used: 0:54:44.976858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9910302, 'precision': 0.9758628, 'recall': 0.9250608, 'specificity': 0.9250608, 'f1': 0.948869, 'auroc': 0.99812156, 'binary_precision': 0.99246633, 'binary_recall': 0.9981479, 'binary_specificity': 0.8519737, 'binary_f1_score': 0.99529904}
confusion matrix:
      0      1
0  1295    225
1    55  29641
---- Validation: 
scalar performance:
{'acc': 0.7494145, 'precision': 0.80983603, 'recall': 0.7529954, 'specificity': 0.7529954, 'f1': 0.73829937, 'auroc': 0.94522226, 'binary_precision': 0.66885245, 'binary_recall': 0.9714286, 'binary_specificity': 0.53456223, 'binary_f1_score': 0.792233}
confusion matrix:
     0    1
0  348  303
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824268, 'precision': 0.8183201, 'recall': 0.7720861, 'specificity': 0.7720861, 'f1': 0.77117395, 'auroc': 0.9413791, 'binary_precision': 0.72507554, 'binary_recall': 0.9486166, 'binary_specificity': 0.59555554, 'binary_f1_score': 0.8219178}
confusion matrix:
     0    1
0  134   91
1   13  240
early stop counter: 1
val acc:0.7494145035743713, best validation acc: 0.7829820513725281, corresponding to test acc:                         0.7405857443809509 / 0.8012552261352539
after epoch: 6,now: 2024-07-11 18:27:37.209716,epoch time: 0:10:51.865185,used: 1:05:36.842043,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99384934, 'precision': 0.9582685, 'recall': 0.9771043, 'specificity': 0.9771043, 'f1': 0.96747386, 'auroc': 0.99920475, 'binary_precision': 0.9978738, 'binary_recall': 0.99565595, 'binary_specificity': 0.95855266, 'binary_f1_score': 0.9967636}
confusion matrix:
      0      1
0  1457     63
1   129  29567
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.8624139, 'recall': 0.85527396, 'specificity': 0.85527396, 'f1': 0.85344875, 'auroc': 0.93872917, 'binary_precision': 0.80300957, 'binary_recall': 0.931746, 'binary_specificity': 0.77880186, 'binary_f1_score': 0.86260104}
confusion matrix:
     0    1
0  507  144
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83054394, 'precision': 0.830303, 'recall': 0.82934564, 'specificity': 0.82934564, 'f1': 0.8297324, 'auroc': 0.9085639, 'binary_precision': 0.8333333, 'binary_recall': 0.8498024, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8414872}
confusion matrix:
     0    1
0  182   43
1   38  215
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-11 18:38:31.630569,epoch time: 0:10:54.420853,used: 1:16:31.262896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9931125, 'precision': 0.9558205, 'recall': 0.9714284, 'specificity': 0.9714284, 'f1': 0.96347725, 'auroc': 0.99871445, 'binary_precision': 0.9973009, 'binary_recall': 0.9954538, 'binary_specificity': 0.947403, 'binary_f1_score': 0.9963765}
confusion matrix:
      0      1
0  1441     80
1   135  29560
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.8611757, 'recall': 0.85373783, 'specificity': 0.85373783, 'f1': 0.85185194, 'auroc': 0.9432235, 'binary_precision': 0.80081856, 'binary_recall': 0.931746, 'binary_specificity': 0.77572966, 'binary_f1_score': 0.8613353}
confusion matrix:
     0    1
0  505  146
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85146445, 'precision': 0.8531095, 'recall': 0.84910846, 'specificity': 0.84910846, 'f1': 0.8502526, 'auroc': 0.9373034, 'binary_precision': 0.8395522, 'binary_recall': 0.88932806, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8637236}
confusion matrix:
     0    1
0  182   43
1   28  225
new oracle model saved
early stop counter: 1
val acc:0.8524590134620667, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8305439352989197 / 0.8514644503593445
after epoch: 8,now: 2024-07-11 18:49:27.530751,epoch time: 0:10:55.900182,used: 1:27:27.163078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9942337, 'precision': 0.9733682, 'recall': 0.9639085, 'specificity': 0.9639085, 'f1': 0.9685851, 'auroc': 0.9990536, 'binary_precision': 0.9964342, 'binary_recall': 0.997508, 'binary_specificity': 0.930309, 'binary_f1_score': 0.9969708}
confusion matrix:
      0      1
0  1415    106
1    74  29621
---- Validation: 
scalar performance:
{'acc': 0.8774395, 'precision': 0.8798425, 'recall': 0.8781106, 'specificity': 0.8781106, 'f1': 0.8773531, 'auroc': 0.94570506, 'binary_precision': 0.8452555, 'binary_recall': 0.9190476, 'binary_specificity': 0.8371736, 'binary_f1_score': 0.8806084}
confusion matrix:
     0    1
0  545  106
1   51  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.8678912, 'recall': 0.8690997, 'specificity': 0.8690997, 'f1': 0.8680339, 'auroc': 0.9402196, 'binary_precision': 0.892562, 'binary_recall': 0.85375494, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8727272}
confusion matrix:
     0    1
0  199   26
1   37  216
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-11 19:00:13.717804,epoch time: 0:10:46.187053,used: 1:38:13.350131,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9943619, 'precision': 0.9660922, 'recall': 0.97364455, 'specificity': 0.97364455, 'f1': 0.96983445, 'auroc': 0.9992554, 'binary_precision': 0.9974721, 'binary_recall': 0.9965988, 'binary_specificity': 0.9506903, 'binary_f1_score': 0.99703526}
confusion matrix:
      0      1
0  1446     75
1   101  29594
---- Validation: 
scalar performance:
{'acc': 0.76971114, 'precision': 0.8193803, 'recall': 0.77291346, 'specificity': 0.77291346, 'f1': 0.76176155, 'auroc': 0.9420086, 'binary_precision': 0.68926555, 'binary_recall': 0.96825397, 'binary_specificity': 0.57757294, 'binary_f1_score': 0.8052805}
confusion matrix:
     0    1
0  376  275
1   20  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76987445, 'precision': 0.8016156, 'recall': 0.7597365, 'specificity': 0.7597365, 'f1': 0.7584394, 'auroc': 0.9258498, 'binary_precision': 0.7173252, 'binary_recall': 0.9328063, 'binary_specificity': 0.58666664, 'binary_f1_score': 0.8109966}
confusion matrix:
     0    1
0  132   93
1   17  236
early stop counter: 1
val acc:0.7697111368179321, best validation acc: 0.8774394989013672, corresponding to test acc:                         0.8682008385658264 / 0.8682008385658264
after epoch: 10,now: 2024-07-11 19:11:01.865080,epoch time: 0:10:48.147276,used: 1:49:01.497407,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.988948, 'precision': 0.96163845, 'recall': 0.91559386, 'specificity': 0.91559386, 'f1': 0.9372697, 'auroc': 0.9973966, 'binary_precision': 0.9915589, 'binary_recall': 0.99686813, 'binary_specificity': 0.83431953, 'binary_f1_score': 0.9942065}
confusion matrix:
      0      1
0  1269    252
1    93  29602
---- Validation: 
scalar performance:
{'acc': 0.8883685, 'precision': 0.889788, 'recall': 0.8888889, 'specificity': 0.8888889, 'f1': 0.8883356, 'auroc': 0.9482091, 'binary_precision': 0.8618128, 'binary_recall': 0.9206349, 'binary_specificity': 0.85714287, 'binary_f1_score': 0.8902533}
confusion matrix:
     0    1
0  558   93
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.86441886, 'recall': 0.85030305, 'specificity': 0.85030305, 'f1': 0.84225047, 'auroc': 0.9343522, 'binary_precision': 0.96842104, 'binary_recall': 0.72727275, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8306998}
confusion matrix:
     0    1
0  219    6
1   69  184
better model found
persisted
after epoch: 11,now: 2024-07-11 19:21:50.134190,epoch time: 0:10:48.269110,used: 1:59:49.766517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.957483, 'recall': 0.97968036, 'specificity': 0.97968036, 'f1': 0.968287, 'auroc': 0.99930626, 'binary_precision': 0.99814296, 'binary_recall': 0.9955211, 'binary_specificity': 0.9638396, 'binary_f1_score': 0.9968304}
confusion matrix:
      0      1
0  1466     55
1   133  29562
---- Validation: 
scalar performance:
{'acc': 0.89617485, 'precision': 0.897056, 'recall': 0.8958013, 'specificity': 0.8958013, 'f1': 0.8960289, 'auroc': 0.9396893, 'binary_precision': 0.91210616, 'binary_recall': 0.8730159, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.89213306}
confusion matrix:
     0    1
0  598   53
1   80  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.8543651, 'recall': 0.8451208, 'specificity': 0.8451208, 'f1': 0.8383965, 'auroc': 0.92337286, 'binary_precision': 0.9444444, 'binary_recall': 0.73913044, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8292682}
confusion matrix:
     0    1
0  214   11
1   66  187
better model found
persisted
after epoch: 12,now: 2024-07-11 19:32:35.813027,epoch time: 0:10:45.678837,used: 2:10:35.445354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99211943, 'precision': 0.98345697, 'recall': 0.93004847, 'specificity': 0.93004847, 'f1': 0.95501816, 'auroc': 0.9990879, 'binary_precision': 0.9929363, 'binary_recall': 0.9988214, 'binary_specificity': 0.8612755, 'binary_f1_score': 0.9958702}
confusion matrix:
      0      1
0  1310    211
1    35  29660
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.81762075, 'recall': 0.76833075, 'specificity': 0.76833075, 'f1': 0.7563311, 'auroc': 0.92775095, 'binary_precision': 0.68421054, 'binary_recall': 0.96984124, 'binary_specificity': 0.56682026, 'binary_f1_score': 0.80236375}
confusion matrix:
     0    1
0  369  282
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824268, 'precision': 0.81424546, 'recall': 0.77257794, 'specificity': 0.77257794, 'f1': 0.7720469, 'auroc': 0.935336, 'binary_precision': 0.72782874, 'binary_recall': 0.94071144, 'binary_specificity': 0.60444444, 'binary_f1_score': 0.8206896}
confusion matrix:
     0    1
0  136   89
1   15  238
early stop counter: 1
val acc:0.7650273442268372, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8682008385658264
after epoch: 13,now: 2024-07-11 19:43:27.383111,epoch time: 0:10:51.570084,used: 2:21:27.015438,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9934008, 'precision': 0.94780874, 'recall': 0.98561513, 'specificity': 0.98561513, 'f1': 0.9658514, 'auroc': 0.9995135, 'binary_precision': 0.99881595, 'binary_recall': 0.9942415, 'binary_specificity': 0.97698885, 'binary_f1_score': 0.99652344}
confusion matrix:
      0      1
0  1486     35
1   171  29524
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.8797552, 'recall': 0.87985146, 'specificity': 0.87985146, 'f1': 0.879769, 'auroc': 0.9282917, 'binary_precision': 0.87304074, 'binary_recall': 0.88412696, 'binary_specificity': 0.875576, 'binary_f1_score': 0.87854886}
confusion matrix:
     0    1
0  570   81
1   73  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8678359, 'recall': 0.86439174, 'specificity': 0.86439174, 'f1': 0.8597289, 'auroc': 0.9266403, 'binary_precision': 0.9386792, 'binary_recall': 0.78656125, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.85591394}
confusion matrix:
     0    1
0  212   13
1   54  199
early stop counter: 2
val acc:0.8797814249992371, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8682008385658264
after epoch: 14,now: 2024-07-11 19:54:19.981425,epoch time: 0:10:52.598314,used: 2:32:19.613752,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9930484, 'precision': 0.98129505, 'recall': 0.94238865, 'specificity': 0.94238865, 'f1': 0.9609302, 'auroc': 0.99890983, 'binary_precision': 0.9941993, 'binary_recall': 0.9985183, 'binary_specificity': 0.886259, 'binary_f1_score': 0.9963541}
confusion matrix:
      0      1
0  1348    173
1    44  29651
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.8652729, 'recall': 0.85619557, 'specificity': 0.85619557, 'f1': 0.85406446, 'auroc': 0.9386951, 'binary_precision': 0.79919136, 'binary_recall': 0.9412698, 'binary_specificity': 0.7711213, 'binary_f1_score': 0.8644315}
confusion matrix:
     0    1
0  502  149
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87238497, 'precision': 0.8722689, 'recall': 0.8735441, 'specificity': 0.8735441, 'f1': 0.87225914, 'auroc': 0.9369521, 'binary_precision': 0.9, 'binary_recall': 0.85375494, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8762678}
confusion matrix:
     0    1
0  201   24
1   37  216
new oracle model saved
early stop counter: 3
val acc:0.8548009395599365, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 15,now: 2024-07-11 20:05:09.816547,epoch time: 0:10:49.835122,used: 2:43:09.448874,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99477834, 'precision': 0.9642296, 'recall': 0.9807137, 'specificity': 0.9807137, 'f1': 0.97231066, 'auroc': 0.99941015, 'binary_precision': 0.9982118, 'binary_recall': 0.9962958, 'binary_specificity': 0.9651316, 'binary_f1_score': 0.9972529}
confusion matrix:
      0      1
0  1467     53
1   110  29586
---- Validation: 
scalar performance:
{'acc': 0.8868072, 'precision': 0.8867901, 'recall': 0.88689196, 'specificity': 0.88689196, 'f1': 0.88679725, 'auroc': 0.9396703, 'binary_precision': 0.8794992, 'binary_recall': 0.8920635, 'binary_specificity': 0.8817204, 'binary_f1_score': 0.8857368}
confusion matrix:
     0    1
0  574   77
1   68  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.8466449, 'recall': 0.8433992, 'specificity': 0.8433992, 'f1': 0.8387929, 'auroc': 0.91838384, 'binary_precision': 0.9150943, 'binary_recall': 0.76679844, 'binary_specificity': 0.92, 'binary_f1_score': 0.8344086}
confusion matrix:
     0    1
0  207   18
1   59  194
early stop counter: 4
val acc:0.8868072032928467, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 16,now: 2024-07-11 20:16:00.724429,epoch time: 0:10:50.907882,used: 2:54:00.356756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99573934, 'precision': 0.9774313, 'recall': 0.9765371, 'specificity': 0.9765371, 'f1': 0.9769838, 'auroc': 0.99938273, 'binary_precision': 0.99771035, 'binary_recall': 0.99781114, 'binary_specificity': 0.95526314, 'binary_f1_score': 0.9977607}
confusion matrix:
      0      1
0  1452     68
1    65  29631
---- Validation: 
scalar performance:
{'acc': 0.8758782, 'precision': 0.8759544, 'recall': 0.8760369, 'specificity': 0.8760369, 'f1': 0.8758755, 'auroc': 0.92545533, 'binary_precision': 0.8651163, 'binary_recall': 0.8857143, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.8752941}
confusion matrix:
     0    1
0  564   87
1   72  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.8527479, 'recall': 0.84141415, 'specificity': 0.84141415, 'f1': 0.8340299, 'auroc': 0.906245, 'binary_precision': 0.9484536, 'binary_recall': 0.72727275, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8232662}
confusion matrix:
     0    1
0  215   10
1   69  184
early stop counter: 5
val acc:0.8758782148361206, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 17,now: 2024-07-11 20:26:49.765820,epoch time: 0:10:49.041391,used: 3:04:49.398147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99535495, 'precision': 0.9728633, 'recall': 0.97728544, 'specificity': 0.97728544, 'f1': 0.97506285, 'auroc': 0.99946177, 'binary_precision': 0.99780995, 'binary_recall': 0.9973059, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.9975579}
confusion matrix:
      0      1
0  1456     65
1    80  29615
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.85265493, 'recall': 0.82442397, 'specificity': 0.82442397, 'f1': 0.8187849, 'auroc': 0.9480238, 'binary_precision': 0.74452555, 'binary_recall': 0.9714286, 'binary_specificity': 0.67741936, 'binary_f1_score': 0.8429752}
confusion matrix:
     0    1
0  441  210
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85146445, 'precision': 0.8509076, 'recall': 0.8518138, 'specificity': 0.8518138, 'f1': 0.85117716, 'auroc': 0.9169433, 'binary_precision': 0.8699187, 'binary_recall': 0.8458498, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8577154}
confusion matrix:
     0    1
0  193   32
1   39  214
early stop counter: 6
val acc:0.8220140337944031, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 18,now: 2024-07-11 20:37:43.761459,epoch time: 0:10:53.995639,used: 3:15:43.393786,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99737316, 'precision': 0.9915736, 'recall': 0.9799057, 'specificity': 0.9799057, 'f1': 0.9856616, 'auroc': 0.99976474, 'binary_precision': 0.997982, 'binary_recall': 0.9992591, 'binary_specificity': 0.9605523, 'binary_f1_score': 0.99862015}
confusion matrix:
      0      1
0  1461     60
1    22  29673
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.8628807, 'recall': 0.8464926, 'specificity': 0.8464926, 'f1': 0.843135, 'auroc': 0.9479312, 'binary_precision': 0.77734876, 'binary_recall': 0.95873016, 'binary_specificity': 0.734255, 'binary_f1_score': 0.85856426}
confusion matrix:
     0    1
0  478  173
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8556485, 'precision': 0.8568946, 'recall': 0.85355294, 'specificity': 0.85355294, 'f1': 0.8545786, 'auroc': 0.92630655, 'binary_precision': 0.84586465, 'binary_recall': 0.88932806, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.86705196}
confusion matrix:
     0    1
0  184   41
1   28  225
early stop counter: 7
val acc:0.8446525931358337, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 19,now: 2024-07-11 20:48:28.423819,epoch time: 0:10:44.662360,used: 3:26:28.056146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99384934, 'precision': 0.95511085, 'recall': 0.9811617, 'specificity': 0.9811617, 'f1': 0.96772975, 'auroc': 0.99929726, 'binary_precision': 0.99831104, 'binary_recall': 0.9952182, 'binary_specificity': 0.96710527, 'binary_f1_score': 0.99676216}
confusion matrix:
      0      1
0  1470     50
1   142  29554
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.83851755, 'recall': 0.82455194, 'specificity': 0.82455194, 'f1': 0.8212258, 'auroc': 0.91206205, 'binary_precision': 0.7613489, 'binary_recall': 0.931746, 'binary_specificity': 0.71735793, 'binary_f1_score': 0.8379728}
confusion matrix:
     0    1
0  467  184
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.8131228, 'recall': 0.81353533, 'specificity': 0.81353533, 'f1': 0.8132968, 'auroc': 0.86482215, 'binary_precision': 0.828, 'binary_recall': 0.8181818, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8230616}
confusion matrix:
     0    1
0  182   43
1   46  207
early stop counter: 8
val acc:0.8227946758270264, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 20,now: 2024-07-11 20:59:22.194295,epoch time: 0:10:53.770476,used: 3:37:21.826622,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99442595, 'precision': 0.95878375, 'recall': 0.98333746, 'specificity': 0.98333746, 'f1': 0.97070193, 'auroc': 0.999421, 'binary_precision': 0.998514, 'binary_recall': 0.9956223, 'binary_specificity': 0.97105265, 'binary_f1_score': 0.997066}
confusion matrix:
      0      1
0  1476     44
1   130  29566
---- Validation: 
scalar performance:
{'acc': 0.88212335, 'precision': 0.88347626, 'recall': 0.88164365, 'specificity': 0.88164365, 'f1': 0.8818977, 'auroc': 0.9394436, 'binary_precision': 0.902521, 'binary_recall': 0.85238093, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.87673473}
confusion matrix:
     0    1
0  593   58
1   93  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83682007, 'precision': 0.8619131, 'recall': 0.8446201, 'specificity': 0.8446201, 'f1': 0.83566934, 'auroc': 0.94085205, 'binary_precision': 0.972973, 'binary_recall': 0.71146244, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.82191783}
confusion matrix:
     0    1
0  220    5
1   73  180
early stop counter: 9
val acc:0.8821233510971069, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 21,now: 2024-07-11 21:10:11.088271,epoch time: 0:10:48.893976,used: 3:48:10.720598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99593157, 'precision': 0.9819711, 'recall': 0.97384584, 'specificity': 0.97384584, 'f1': 0.97786987, 'auroc': 0.9996309, 'binary_precision': 0.99740934, 'binary_recall': 0.9983162, 'binary_specificity': 0.9493754, 'binary_f1_score': 0.9978625}
confusion matrix:
      0      1
0  1444     77
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.79639614, 'recall': 0.71169996, 'specificity': 0.71169996, 'f1': 0.6861806, 'auroc': 0.9444035, 'binary_precision': 0.629705, 'binary_recall': 0.98253965, 'binary_specificity': 0.4408602, 'binary_f1_score': 0.767514}
confusion matrix:
     0    1
0  287  364
1   11  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6799163, 'precision': 0.74613756, 'recall': 0.66344315, 'specificity': 0.66344315, 'f1': 0.6433793, 'auroc': 0.8828107, 'binary_precision': 0.6322751, 'binary_recall': 0.94466406, 'binary_specificity': 0.38222224, 'binary_f1_score': 0.75752777}
confusion matrix:
    0    1
0  86  139
1  14  239
early stop counter: 10
val acc:0.7072599530220032, best validation acc: 0.8961748480796814, corresponding to test acc:                         0.8389121294021606 / 0.8723849654197693
after epoch: 22,now: 2024-07-11 21:21:00.084801,epoch time: 0:10:48.996530,used: 3:58:59.717128,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99573934, 'precision': 0.96951973, 'recall': 0.9855967, 'specificity': 0.9855967, 'f1': 0.97740686, 'auroc': 0.9995749, 'binary_precision': 0.9986842, 'binary_recall': 0.99683446, 'binary_specificity': 0.974359, 'binary_f1_score': 0.9977585}
confusion matrix:
      0      1
0  1482     39
1    94  29601
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.8987261, 'recall': 0.89874554, 'specificity': 0.89874554, 'f1': 0.8985168, 'auroc': 0.94971347, 'binary_precision': 0.88461536, 'binary_recall': 0.9126984, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.8984375}
confusion matrix:
     0    1
0  576   75
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.8782083, 'recall': 0.87897235, 'specificity': 0.87897235, 'f1': 0.8765555, 'auroc': 0.92319715, 'binary_precision': 0.9217391, 'binary_recall': 0.8379447, 'binary_specificity': 0.92, 'binary_f1_score': 0.8778468}
confusion matrix:
     0    1
0  207   18
1   41  212
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-11 21:31:49.005483,epoch time: 0:10:48.920682,used: 4:09:48.637810,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99599564, 'precision': 0.9698052, 'recall': 0.98822653, 'specificity': 0.98822653, 'f1': 0.9788177, 'auroc': 0.999712, 'binary_precision': 0.9989538, 'binary_recall': 0.99683446, 'binary_specificity': 0.97961867, 'binary_f1_score': 0.99789304}
confusion matrix:
      0      1
0  1490     31
1    94  29601
---- Validation: 
scalar performance:
{'acc': 0.90242, 'precision': 0.90237916, 'recall': 0.90243214, 'specificity': 0.90243214, 'f1': 0.90240073, 'auroc': 0.95020604, 'binary_precision': 0.89889413, 'binary_recall': 0.9031746, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.9010293}
confusion matrix:
     0    1
0  587   64
1   61  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87238497, 'precision': 0.8745263, 'recall': 0.8750198, 'specificity': 0.8750198, 'f1': 0.8723799, 'auroc': 0.92959154, 'binary_precision': 0.92105263, 'binary_recall': 0.8300395, 'binary_specificity': 0.92, 'binary_f1_score': 0.87318087}
confusion matrix:
     0    1
0  207   18
1   43  210
better model found
persisted
after epoch: 24,now: 2024-07-11 21:42:35.527747,epoch time: 0:10:46.522264,used: 4:20:35.160074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99416965, 'precision': 0.9587171, 'recall': 0.9804052, 'specificity': 0.9804052, 'f1': 0.9692804, 'auroc': 0.9993515, 'binary_precision': 0.9982106, 'binary_recall': 0.99565583, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.99693155}
confusion matrix:
      0      1
0  1468     53
1   129  29566
---- Validation: 
scalar performance:
{'acc': 0.88368464, 'precision': 0.8845608, 'recall': 0.8841014, 'specificity': 0.8841014, 'f1': 0.88367075, 'auroc': 0.9371711, 'binary_precision': 0.86165416, 'binary_recall': 0.9095238, 'binary_specificity': 0.85867894, 'binary_f1_score': 0.8849421}
confusion matrix:
     0    1
0  559   92
1   57  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.843518, 'recall': 0.84464645, 'specificity': 0.84464645, 'f1': 0.8430131, 'auroc': 0.8955468, 'binary_precision': 0.87711865, 'binary_recall': 0.8181818, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8466258}
confusion matrix:
     0    1
0  196   29
1   46  207
early stop counter: 1
val acc:0.8836846351623535, best validation acc: 0.9024199843406677, corresponding to test acc:                         0.8723849654197693 / 0.8765690326690674
after epoch: 25,now: 2024-07-11 21:53:22.239961,epoch time: 0:10:46.712214,used: 4:31:21.872288,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9916389, 'precision': 0.9803776, 'recall': 0.9276126, 'specificity': 0.9276126, 'f1': 0.95229113, 'auroc': 0.9991571, 'binary_precision': 0.9927017, 'binary_recall': 0.99855196, 'binary_specificity': 0.85667324, 'binary_f1_score': 0.9956183}
confusion matrix:
      0      1
0  1303    218
1    43  29652
---- Validation: 
scalar performance:
{'acc': 0.78298205, 'precision': 0.8334825, 'recall': 0.7861495, 'specificity': 0.7861495, 'f1': 0.7756878, 'auroc': 0.9393022, 'binary_precision': 0.69954646, 'binary_recall': 0.97936505, 'binary_specificity': 0.59293395, 'binary_f1_score': 0.81613755}
confusion matrix:
     0    1
0  386  265
1   13  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.86119366, 'recall': 0.843935, 'specificity': 0.843935, 'f1': 0.846261, 'auroc': 0.93291175, 'binary_precision': 0.8088737, 'binary_recall': 0.9367589, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.8681318}
confusion matrix:
     0    1
0  169   56
1   16  237
early stop counter: 2
val acc:0.7829820513725281, best validation acc: 0.9024199843406677, corresponding to test acc:                         0.8723849654197693 / 0.8765690326690674
after epoch: 26,now: 2024-07-11 22:04:10.494280,epoch time: 0:10:48.254319,used: 4:42:10.126607,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9951627, 'precision': 0.96858764, 'recall': 0.9799794, 'specificity': 0.9799794, 'f1': 0.9742069, 'auroc': 0.9994507, 'binary_precision': 0.9981117, 'binary_recall': 0.9968009, 'binary_specificity': 0.9631579, 'binary_f1_score': 0.99745584}
confusion matrix:
      0      1
0  1464     56
1    95  29601
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8491969, 'recall': 0.8302611, 'specificity': 0.8302611, 'f1': 0.826213, 'auroc': 0.9429937, 'binary_precision': 0.75949365, 'binary_recall': 0.95238096, 'binary_specificity': 0.7081413, 'binary_f1_score': 0.8450704}
confusion matrix:
     0    1
0  461  190
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8640228, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.85821855, 'auroc': 0.9343698, 'binary_precision': 0.8369565, 'binary_recall': 0.9130435, 'binary_specificity': 0.8, 'binary_f1_score': 0.8733459}
confusion matrix:
     0    1
0  180   45
1   22  231
early stop counter: 3
val acc:0.8282591700553894, best validation acc: 0.9024199843406677, corresponding to test acc:                         0.8723849654197693 / 0.8765690326690674
after epoch: 27,now: 2024-07-11 22:14:58.453398,epoch time: 0:10:47.959118,used: 4:52:58.085725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9951948, 'precision': 0.9593288, 'recall': 0.9918603, 'specificity': 0.9918603, 'f1': 0.97497046, 'auroc': 0.9996797, 'binary_precision': 0.9993915, 'binary_recall': 0.9955548, 'binary_specificity': 0.9881657, 'binary_f1_score': 0.9974695}
confusion matrix:
      0      1
0  1503     18
1   132  29563
---- Validation: 
scalar performance:
{'acc': 0.89227164, 'precision': 0.89224565, 'recall': 0.8923451, 'specificity': 0.8923451, 'f1': 0.89226055, 'auroc': 0.94399095, 'binary_precision': 0.88557994, 'binary_recall': 0.8968254, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.89116716}
confusion matrix:
     0    1
0  578   73
1   65  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88075316, 'precision': 0.8829123, 'recall': 0.8834168, 'specificity': 0.8834168, 'f1': 0.88074845, 'auroc': 0.9379535, 'binary_precision': 0.9298246, 'binary_recall': 0.8379447, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.88149685}
confusion matrix:
     0    1
0  209   16
1   41  212
new oracle model saved
early stop counter: 4
val acc:0.8922716379165649, best validation acc: 0.9024199843406677, corresponding to test acc:                         0.8723849654197693 / 0.8807531595230103
after epoch: 28,now: 2024-07-11 22:25:44.302938,epoch time: 0:10:45.849540,used: 5:03:43.935265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99506664, 'precision': 0.99064505, 'recall': 0.95561326, 'specificity': 0.95561326, 'f1': 0.9724082, 'auroc': 0.99978733, 'binary_precision': 0.99550474, 'binary_recall': 0.99932647, 'binary_specificity': 0.91190004, 'binary_f1_score': 0.99741197}
confusion matrix:
      0      1
0  1387    134
1    20  29675
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.84797424, 'recall': 0.8122376, 'specificity': 0.8122376, 'f1': 0.8050053, 'auroc': 0.9526113, 'binary_precision': 0.72813237, 'binary_recall': 0.9777778, 'binary_specificity': 0.6466974, 'binary_f1_score': 0.8346883}
confusion matrix:
     0    1
0  421  230
1   14  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.8647096, 'recall': 0.8535617, 'specificity': 0.8535617, 'f1': 0.8556148, 'auroc': 0.94612205, 'binary_precision': 0.8268551, 'binary_recall': 0.9249012, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.8731344}
confusion matrix:
     0    1
0  176   49
1   19  234
early stop counter: 5
val acc:0.8095238208770752, best validation acc: 0.9024199843406677, corresponding to test acc:                         0.8723849654197693 / 0.8807531595230103
after epoch: 29,now: 2024-07-11 22:36:28.753711,epoch time: 0:10:44.450773,used: 5:14:28.386038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9927921, 'precision': 0.9901291, 'recall': 0.9313377, 'specificity': 0.9313377, 'f1': 0.95865196, 'auroc': 0.999537, 'binary_precision': 0.9930402, 'binary_recall': 0.9994275, 'binary_specificity': 0.8632479, 'binary_f1_score': 0.9962236}
confusion matrix:
      0      1
0  1313    208
1    17  29678
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.8440225, 'recall': 0.80834615, 'specificity': 0.80834615, 'f1': 0.80096096, 'auroc': 0.95391643, 'binary_precision': 0.72491145, 'binary_recall': 0.9746032, 'binary_specificity': 0.64208907, 'binary_f1_score': 0.83141506}
confusion matrix:
     0    1
0  418  233
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.8532066, 'recall': 0.8328239, 'specificity': 0.8328239, 'f1': 0.8350653, 'auroc': 0.9453666, 'binary_precision': 0.79530203, 'binary_recall': 0.9367589, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.8602541}
confusion matrix:
     0    1
0  164   61
1   16  237
early stop counter: 6
val acc:0.8056206107139587, best validation acc: 0.9024199843406677, corresponding to test acc:                         0.8723849654197693 / 0.8807531595230103
after epoch: 30,now: 2024-07-11 22:47:13.888903,epoch time: 0:10:45.135192,used: 5:25:13.521230,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_22_00_seed_1_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:25:13.521230 at 2024-07-11 22:47:13.888903
persisted model performance metric: 

scalar performance:
{'acc': 0.87238497, 'precision': 0.8745263, 'recall': 0.8750198, 'specificity': 0.8750198, 'f1': 0.8723799, 'auroc': 0.92959154, 'binary_precision': 0.92105263, 'binary_recall': 0.8300395, 'binary_specificity': 0.92, 'binary_f1_score': 0.87318087}
confusion matrix:
     0    1
0  207   18
1   43  210
oracle model performance metric: 

scalar performance:
{'acc': 0.88075316, 'precision': 0.8829123, 'recall': 0.8834168, 'specificity': 0.8834168, 'f1': 0.88074845, 'auroc': 0.9379535, 'binary_precision': 0.9298246, 'binary_recall': 0.8379447, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.88149685}
confusion matrix:
     0    1
0  209   16
1   41  212
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455405 KiB |  13219 MiB | 715254 GiB | 715253 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 705627 GiB | 705626 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455405 KiB |  13219 MiB | 715254 GiB | 715253 GiB |
|       from large pool | 414803 KiB |  13181 MiB | 705627 GiB | 705626 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 711584 GiB | 711583 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 701978 GiB | 701978 GiB |
|       from small pool |  40408 KiB |     56 MiB |   9605 GiB |   9605 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  28040 MiB |  13562 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  27960 MiB |  13548 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445715 KiB |   1238 MiB | 532569 GiB | 532569 GiB |
|       from large pool | 435116 KiB |   1229 MiB | 522912 GiB | 522911 GiB |
|       from small pool |  10598 KiB |     43 MiB |   9657 GiB |   9657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4907    |  135900 K  |  135898 K  |
|       from large pool |     187    |    1413    |   64939 K  |   64939 K  |
|       from small pool |    1129    |    4718    |   70960 K  |   70959 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4907    |  135900 K  |  135898 K  |
|       from large pool |     187    |    1413    |   64939 K  |   64939 K  |
|       from small pool |    1129    |    4718    |   70960 K  |   70959 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |    1205    |     570    |
|       from large pool |     602    |     602    |    1165    |     563    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2018    |   88041 K  |   88041 K  |
|       from large pool |      38    |     605    |   52491 K  |   52491 K  |
|       from small pool |      57    |    1980    |   35549 K  |   35549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 715254 GiB | 715254 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 705627 GiB | 705627 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 715254 GiB | 715254 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 705627 GiB | 705627 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 711584 GiB | 711584 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 701978 GiB | 701978 GiB |
|       from small pool |      0 KiB |     56 MiB |   9605 GiB |   9605 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14478 MiB |  28040 MiB |  27160 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     66 MiB |     80 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB | 532569 GiB | 532569 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 522912 GiB | 522912 GiB |
|       from small pool |      0 KiB |     43 MiB |   9657 GiB |   9657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135900 K  |  135900 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70960 K  |   70960 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135900 K  |  135900 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70960 K  |   70960 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |    1205    |    1143    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      33    |      40    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2018    |   88041 K  |   88041 K  |
|       from large pool |       4    |     605    |   52491 K  |   52491 K  |
|       from small pool |       0    |    1980    |   35550 K  |   35550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 715254 GiB | 715254 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 705627 GiB | 705627 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 715254 GiB | 715254 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 705627 GiB | 705627 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 711584 GiB | 711584 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 701978 GiB | 701978 GiB |
|       from small pool |      0 KiB |     56 MiB |   9605 GiB |   9605 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14478 MiB |  28040 MiB |  27160 MiB |
|       from large pool |    830 MiB |  14412 MiB |  27960 MiB |  27130 MiB |
|       from small pool |     50 MiB |     66 MiB |     80 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB | 532569 GiB | 532569 GiB |
|       from large pool |  24320 KiB |   1229 MiB | 522912 GiB | 522912 GiB |
|       from small pool |      0 KiB |     43 MiB |   9657 GiB |   9657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135900 K  |  135900 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70960 K  |   70960 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135900 K  |  135900 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70960 K  |   70960 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |    1205    |    1143    |
|       from large pool |      37    |     602    |    1165    |    1128    |
|       from small pool |      25    |      33    |      40    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2018    |   88041 K  |   88041 K  |
|       from large pool |       4    |     605    |   52491 K  |   52491 K  |
|       from small pool |       0    |    1980    |   35550 K  |   35550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151

 Experiment start at: 2024-07-11 22:59:14.127879
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9812914, 'precision': 0.97845733, 'recall': 0.8139121, 'specificity': 0.8139121, 'f1': 0.8773997, 'auroc': 0.9932828, 'binary_precision': 0.98147964, 'binary_recall': 0.99919623, 'binary_specificity': 0.62862796, 'binary_f1_score': 0.9902587}
confusion matrix:
     0      1
0  953    563
1   24  29836
---- Validation: 
scalar performance:
{'acc': 0.7370892, 'precision': 0.7939721, 'recall': 0.7428192, 'specificity': 0.7428192, 'f1': 0.7266282, 'auroc': 0.90025043, 'binary_precision': 0.6578366, 'binary_recall': 0.9581994, 'binary_specificity': 0.527439, 'binary_f1_score': 0.7801047}
confusion matrix:
     0    1
0  346  310
1   26  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75789475, 'precision': 0.7973993, 'recall': 0.73956096, 'specificity': 0.73956096, 'f1': 0.7389374, 'auroc': 0.8901937, 'binary_precision': 0.7093023, 'binary_recall': 0.94208497, 'binary_specificity': 0.537037, 'binary_f1_score': 0.8092869}
confusion matrix:
     0    1
0  116  100
1   15  244
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 23:10:08.174737,epoch time: 0:10:54.046858,used: 0:10:54.046858,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9891318, 'precision': 0.94345963, 'recall': 0.9376243, 'specificity': 0.9376243, 'f1': 0.9405203, 'auroc': 0.9974688, 'binary_precision': 0.9939426, 'binary_recall': 0.99464166, 'binary_specificity': 0.8806069, 'binary_f1_score': 0.994292}
confusion matrix:
      0      1
0  1335    181
1   160  29700
---- Validation: 
scalar performance:
{'acc': 0.7777778, 'precision': 0.78746235, 'recall': 0.77520394, 'specificity': 0.77520394, 'f1': 0.7746737, 'auroc': 0.8659296, 'binary_precision': 0.8339921, 'binary_recall': 0.6784566, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.748227}
confusion matrix:
     0    1
0  572   84
1  200  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55789477, 'precision': 0.6762481, 'recall': 0.59036714, 'specificity': 0.59036714, 'f1': 0.51246333, 'auroc': 0.8297226, 'binary_precision': 0.8450704, 'binary_recall': 0.23166023, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.36363637}
confusion matrix:
     0   1
0  205  11
1  199  60
better model found
persisted
after epoch: 2,now: 2024-07-11 23:20:55.393855,epoch time: 0:10:47.219118,used: 0:21:41.265976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9896099, 'precision': 0.97603333, 'recall': 0.90813375, 'specificity': 0.90813375, 'f1': 0.9391911, 'auroc': 0.99818254, 'binary_precision': 0.9908263, 'binary_recall': 0.9983255, 'binary_specificity': 0.81794196, 'binary_f1_score': 0.9945618}
confusion matrix:
      0      1
0  1240    276
1    50  29810
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.8202375, 'recall': 0.79503566, 'specificity': 0.79503566, 'f1': 0.7876251, 'auroc': 0.9165065, 'binary_precision': 0.71672773, 'binary_recall': 0.9437299, 'binary_specificity': 0.64634144, 'binary_f1_score': 0.814712}
confusion matrix:
     0    1
0  424  232
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7621053, 'precision': 0.78645056, 'recall': 0.74688077, 'specificity': 0.74688077, 'f1': 0.7481005, 'auroc': 0.90360004, 'binary_precision': 0.722561, 'binary_recall': 0.9150579, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.8074958}
confusion matrix:
     0    1
0  125   91
1   22  237
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 23:31:46.749296,epoch time: 0:10:51.355441,used: 0:32:32.621417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9928289, 'precision': 0.97537166, 'recall': 0.94520193, 'specificity': 0.94520193, 'f1': 0.9597366, 'auroc': 0.9990067, 'binary_precision': 0.9945596, 'binary_recall': 0.9979237, 'binary_specificity': 0.8924802, 'binary_f1_score': 0.9962388}
confusion matrix:
      0      1
0  1353    163
1    62  29798
---- Validation: 
scalar performance:
{'acc': 0.726917, 'precision': 0.7880538, 'recall': 0.73291063, 'specificity': 0.73291063, 'f1': 0.71484065, 'auroc': 0.8994981, 'binary_precision': 0.648531, 'binary_recall': 0.9581994, 'binary_specificity': 0.50762194, 'binary_f1_score': 0.7735236}
confusion matrix:
     0    1
0  333  323
1   26  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70526314, 'precision': 0.7490766, 'recall': 0.6832279, 'specificity': 0.6832279, 'f1': 0.6749756, 'auroc': 0.78335476, 'binary_precision': 0.66481996, 'binary_recall': 0.9266409, 'binary_specificity': 0.4398148, 'binary_f1_score': 0.7741936}
confusion matrix:
    0    1
0  95  121
1  19  240
early stop counter: 1
val acc:0.726917028427124, best validation acc: 0.7910798192024231, corresponding to test acc:                         0.7621052861213684 / 0.7621052861213684
after epoch: 4,now: 2024-07-11 23:42:38.937985,epoch time: 0:10:52.188689,used: 0:43:24.810106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9921915, 'precision': 0.94507015, 'recall': 0.9736695, 'specificity': 0.9736695, 'f1': 0.9588703, 'auroc': 0.99875987, 'binary_precision': 0.997614, 'binary_recall': 0.9941728, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.99589044}
confusion matrix:
      0      1
0  1445     71
1   174  29686
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.8250495, 'recall': 0.81965876, 'specificity': 0.81965876, 'f1': 0.8171814, 'auroc': 0.91215634, 'binary_precision': 0.769018, 'binary_recall': 0.8938907, 'binary_specificity': 0.74542683, 'binary_f1_score': 0.82676584}
confusion matrix:
     0    1
0  489  167
1   66  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7957895, 'precision': 0.79436374, 'recall': 0.7962159, 'specificity': 0.7962159, 'f1': 0.79485846, 'auroc': 0.87348056, 'binary_precision': 0.8266129, 'binary_recall': 0.7915058, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8086785}
confusion matrix:
     0    1
0  173   43
1   54  205
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-11 23:53:30.980266,epoch time: 0:10:52.042281,used: 0:54:16.852387,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9919684, 'precision': 0.9379782, 'recall': 0.981066, 'specificity': 0.981066, 'f1': 0.9583861, 'auroc': 0.99880373, 'binary_precision': 0.9984176, 'binary_recall': 0.9931346, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9957691}
confusion matrix:
      0      1
0  1469     47
1   205  29655
---- Validation: 
scalar performance:
{'acc': 0.8348983, 'precision': 0.8396376, 'recall': 0.8364687, 'specificity': 0.8364687, 'f1': 0.83467466, 'auroc': 0.92590284, 'binary_precision': 0.79231864, 'binary_recall': 0.8954984, 'binary_specificity': 0.777439, 'binary_f1_score': 0.84075475}
confusion matrix:
     0    1
0  510  146
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84333336, 'recall': 0.84521127, 'specificity': 0.84521127, 'f1': 0.8399425, 'auroc': 0.9146825, 'binary_precision': 0.9066667, 'binary_recall': 0.7876448, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8429752}
confusion matrix:
     0    1
0  195   21
1   55  204
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-12 00:04:25.946183,epoch time: 0:10:54.965917,used: 1:05:11.818304,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.989323, 'precision': 0.9240163, 'recall': 0.96809256, 'specificity': 0.96809256, 'f1': 0.94482726, 'auroc': 0.99785197, 'binary_precision': 0.99717104, 'binary_recall': 0.9915941, 'binary_specificity': 0.94459105, 'binary_f1_score': 0.99437475}
confusion matrix:
      0      1
0  1432     84
1   251  29609
---- Validation: 
scalar performance:
{'acc': 0.8028169, 'precision': 0.821401, 'recall': 0.80596864, 'specificity': 0.80596864, 'f1': 0.8009429, 'auroc': 0.9180138, 'binary_precision': 0.73717946, 'binary_recall': 0.9244373, 'binary_specificity': 0.6875, 'binary_f1_score': 0.8202567}
confusion matrix:
     0    1
0  451  205
1   47  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.83066666, 'recall': 0.8324753, 'specificity': 0.8324753, 'f1': 0.8273064, 'auroc': 0.9041899, 'binary_precision': 0.8933333, 'binary_recall': 0.7760618, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8305785}
confusion matrix:
     0    1
0  192   24
1   58  201
early stop counter: 1
val acc:0.8028169274330139, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 7,now: 2024-07-12 00:15:19.850429,epoch time: 0:10:53.904246,used: 1:16:05.722550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9934982, 'precision': 0.97190416, 'recall': 0.956511, 'specificity': 0.956511, 'f1': 0.9640654, 'auroc': 0.9986943, 'binary_precision': 0.9957208, 'binary_recall': 0.99745476, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.9965871}
confusion matrix:
      0      1
0  1388    128
1    76  29784
---- Validation: 
scalar performance:
{'acc': 0.7214398, 'precision': 0.7974204, 'recall': 0.7280336, 'specificity': 0.7280336, 'f1': 0.7060968, 'auroc': 0.9366643, 'binary_precision': 0.6402954, 'binary_recall': 0.97588426, 'binary_specificity': 0.48018292, 'binary_f1_score': 0.77324843}
confusion matrix:
     0    1
0  315  341
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7852632, 'precision': 0.81857204, 'recall': 0.7692692, 'specificity': 0.7692692, 'f1': 0.7713932, 'auroc': 0.91402113, 'binary_precision': 0.7357357, 'binary_recall': 0.9459459, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.82770264}
confusion matrix:
     0    1
0  128   88
1   14  245
early stop counter: 2
val acc:0.721439778804779, best validation acc: 0.8348982930183411, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 8,now: 2024-07-12 00:26:27.907616,epoch time: 0:11:08.057187,used: 1:27:13.779737,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9914903, 'precision': 0.9332768, 'recall': 0.9820671, 'specificity': 0.9820671, 'f1': 0.9562078, 'auroc': 0.9986279, 'binary_precision': 0.9985512, 'binary_recall': 0.99249834, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9955155}
confusion matrix:
      0      1
0  1473     43
1   224  29636
---- Validation: 
scalar performance:
{'acc': 0.8810642, 'precision': 0.88095117, 'recall': 0.8810632, 'specificity': 0.8810632, 'f1': 0.8809986, 'auroc': 0.92938304, 'binary_precision': 0.87539935, 'binary_recall': 0.88102895, 'binary_specificity': 0.88109756, 'binary_f1_score': 0.8782051}
confusion matrix:
     0    1
0  578   78
1   74  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.8786564, 'recall': 0.8799424, 'specificity': 0.8799424, 'f1': 0.87367016, 'auroc': 0.93849206, 'binary_precision': 0.95022625, 'binary_recall': 0.8108108, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.87499994}
confusion matrix:
     0    1
0  205   11
1   49  210
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 00:37:23.565261,epoch time: 0:10:55.657645,used: 1:38:09.437382,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9879207, 'precision': 0.90334225, 'recall': 0.98645306, 'specificity': 0.98645306, 'f1': 0.94049406, 'auroc': 0.9989862, 'binary_precision': 0.999221, 'binary_recall': 0.9880777, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.99361813}
confusion matrix:
      0      1
0  1493     23
1   356  29504
---- Validation: 
scalar performance:
{'acc': 0.86463225, 'precision': 0.86464703, 'recall': 0.86439055, 'specificity': 0.86439055, 'f1': 0.8644927, 'auroc': 0.9267312, 'binary_precision': 0.86504066, 'binary_recall': 0.8553055, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.86014545}
confusion matrix:
     0    1
0  573   83
1   90  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7242105, 'precision': 0.79797846, 'recall': 0.74556696, 'specificity': 0.74556696, 'f1': 0.7161592, 'auroc': 0.9251931, 'binary_precision': 0.9705882, 'binary_recall': 0.5096525, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.6683544}
confusion matrix:
     0    1
0  212    4
1  127  132
early stop counter: 1
val acc:0.864632248878479, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8736842274665833 / 0.8736842274665833
after epoch: 10,now: 2024-07-12 00:48:19.534260,epoch time: 0:10:55.968999,used: 1:49:05.406381,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9927014, 'precision': 0.96177876, 'recall': 0.95859694, 'specificity': 0.95859694, 'f1': 0.9601817, 'auroc': 0.9986483, 'binary_precision': 0.9959827, 'binary_recall': 0.99634963, 'binary_specificity': 0.9208443, 'binary_f1_score': 0.9961661}
confusion matrix:
      0      1
0  1396    120
1   109  29751
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.8161518, 'recall': 0.8026699, 'specificity': 0.8026699, 'f1': 0.79802305, 'auroc': 0.876884, 'binary_precision': 0.73704666, 'binary_recall': 0.914791, 'binary_specificity': 0.6905488, 'binary_f1_score': 0.8163558}
confusion matrix:
     0    1
0  453  203
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7705263, 'precision': 0.7690511, 'recall': 0.77074397, 'specificity': 0.77074397, 'f1': 0.7694801, 'auroc': 0.8228586, 'binary_precision': 0.80241936, 'binary_recall': 0.76833975, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.7850099}
confusion matrix:
     0    1
0  167   49
1   60  199
early stop counter: 2
val acc:0.7996870279312134, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8736842274665833 / 0.8736842274665833
after epoch: 11,now: 2024-07-12 00:59:21.669984,epoch time: 0:11:02.135724,used: 2:00:07.542105,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9946775, 'precision': 0.988369, 'recall': 0.9530607, 'specificity': 0.9530607, 'f1': 0.96997917, 'auroc': 0.999509, 'binary_precision': 0.99529606, 'binary_recall': 0.9991293, 'binary_specificity': 0.9069921, 'binary_f1_score': 0.997209}
confusion matrix:
      0      1
0  1375    141
1    26  29834
---- Validation: 
scalar performance:
{'acc': 0.8388106, 'precision': 0.8517349, 'recall': 0.84136295, 'specificity': 0.84136295, 'f1': 0.8379339, 'auroc': 0.9379779, 'binary_precision': 0.7773333, 'binary_recall': 0.937299, 'binary_specificity': 0.74542683, 'binary_f1_score': 0.84985423}
confusion matrix:
     0    1
0  489  167
1   39  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88631576, 'precision': 0.8850713, 'recall': 0.8861451, 'specificity': 0.8861451, 'f1': 0.8855442, 'auroc': 0.94716144, 'binary_precision': 0.9019608, 'binary_recall': 0.8880309, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.8949417}
confusion matrix:
     0    1
0  191   25
1   29  230
new oracle model saved
early stop counter: 3
val acc:0.8388106226921082, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8736842274665833 / 0.8863157629966736
after epoch: 12,now: 2024-07-12 01:10:17.506765,epoch time: 0:10:55.836781,used: 2:11:03.378886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889725, 'precision': 0.99063045, 'recall': 0.88870156, 'specificity': 0.88870156, 'f1': 0.9331397, 'auroc': 0.9994192, 'binary_precision': 0.98883665, 'binary_recall': 0.9996986, 'binary_specificity': 0.7777045, 'binary_f1_score': 0.99423796}
confusion matrix:
      0      1
0  1179    337
1     9  29851
---- Validation: 
scalar performance:
{'acc': 0.62754303, 'precision': 0.7703899, 'recall': 0.6369868, 'specificity': 0.6369868, 'f1': 0.57949483, 'auroc': 0.9422815, 'binary_precision': 0.5670956, 'binary_recall': 0.9919614, 'binary_specificity': 0.2820122, 'binary_f1_score': 0.7216374}
confusion matrix:
     0    1
0  185  471
1    5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6294737, 'precision': 0.7860167, 'recall': 0.5929769, 'specificity': 0.5929769, 'f1': 0.5317471, 'auroc': 0.94734025, 'binary_precision': 0.59584296, 'binary_recall': 0.996139, 'binary_specificity': 0.18981482, 'binary_f1_score': 0.7456648}
confusion matrix:
    0    1
0  41  175
1   1  258
early stop counter: 4
val acc:0.627543032169342, best validation acc: 0.8810641765594482, corresponding to test acc:                         0.8736842274665833 / 0.8863157629966736
after epoch: 13,now: 2024-07-12 01:21:14.126229,epoch time: 0:10:56.619464,used: 2:21:59.998350,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.995793, 'precision': 0.9797195, 'recall': 0.97430944, 'specificity': 0.97430944, 'f1': 0.9769974, 'auroc': 0.99946845, 'binary_precision': 0.9974898, 'binary_recall': 0.9980911, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.99779034}
confusion matrix:
      0      1
0  1441     75
1    57  29803
---- Validation: 
scalar performance:
{'acc': 0.8888889, 'precision': 0.89180154, 'recall': 0.8877686, 'specificity': 0.8877686, 'f1': 0.88840675, 'auroc': 0.9452077, 'binary_precision': 0.9195804, 'binary_recall': 0.84565914, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.881072}
confusion matrix:
     0    1
0  610   46
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8425818, 'recall': 0.8158337, 'specificity': 0.8158337, 'f1': 0.79793656, 'auroc': 0.9291971, 'binary_precision': 0.9880952, 'binary_recall': 0.64092666, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.77751756}
confusion matrix:
     0    1
0  214    2
1   93  166
better model found
persisted
after epoch: 14,now: 2024-07-12 01:32:14.081841,epoch time: 0:10:59.955612,used: 2:32:59.953962,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9961435, 'precision': 0.98004186, 'recall': 0.97793734, 'specificity': 0.97793734, 'f1': 0.97898704, 'auroc': 0.9994955, 'binary_precision': 0.99785715, 'binary_recall': 0.9980911, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9979741}
confusion matrix:
      0      1
0  1452     64
1    57  29803
---- Validation: 
scalar performance:
{'acc': 0.87245697, 'precision': 0.8760296, 'recall': 0.873804, 'specificity': 0.873804, 'f1': 0.8723612, 'auroc': 0.9391886, 'binary_precision': 0.83212733, 'binary_recall': 0.9244373, 'binary_specificity': 0.8231707, 'binary_f1_score': 0.8758568}
confusion matrix:
     0    1
0  540  116
1   47  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.87467635, 'recall': 0.87763655, 'specificity': 0.87763655, 'f1': 0.87352216, 'auroc': 0.93977904, 'binary_precision': 0.9270386, 'binary_recall': 0.8339768, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8780487}
confusion matrix:
     0    1
0  199   17
1   43  216
early stop counter: 1
val acc:0.872456967830658, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.800000011920929 / 0.8863157629966736
after epoch: 15,now: 2024-07-12 01:43:09.409953,epoch time: 0:10:55.328112,used: 2:43:55.282074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9950918, 'precision': 0.96000814, 'recall': 0.9892815, 'specificity': 0.9892815, 'f1': 0.9741392, 'auroc': 0.9995235, 'binary_precision': 0.9991263, 'binary_recall': 0.99571335, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9974169}
confusion matrix:
      0      1
0  1490     26
1   128  29732
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.8526468, 'recall': 0.8285036, 'specificity': 0.8285036, 'f1': 0.8281677, 'auroc': 0.92951226, 'binary_precision': 0.93205947, 'binary_recall': 0.7057878, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.80329376}
confusion matrix:
     0    1
0  624   32
1  183  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49894738, 'precision': 0.68216765, 'recall': 0.5393876, 'specificity': 0.5393876, 'f1': 0.40469924, 'auroc': 0.8912082, 'binary_precision': 0.8888889, 'binary_recall': 0.09266409, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.16783218}
confusion matrix:
     0   1
0  213   3
1  235  24
early stop counter: 2
val acc:0.8317683935165405, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.800000011920929 / 0.8863157629966736
after epoch: 16,now: 2024-07-12 01:54:07.357927,epoch time: 0:10:57.947974,used: 2:54:53.230048,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9953468, 'precision': 0.9764038, 'recall': 0.97282267, 'specificity': 0.97282267, 'f1': 0.97460574, 'auroc': 0.9994631, 'binary_precision': 0.9973554, 'binary_recall': 0.9977562, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.9975558}
confusion matrix:
      0      1
0  1437     79
1    67  29793
---- Validation: 
scalar performance:
{'acc': 0.81533647, 'precision': 0.83674765, 'recall': 0.8186637, 'specificity': 0.8186637, 'f1': 0.8133452, 'auroc': 0.93327487, 'binary_precision': 0.74492383, 'binary_recall': 0.9437299, 'binary_specificity': 0.69359756, 'binary_f1_score': 0.8326241}
confusion matrix:
     0    1
0  455  201
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8568882, 'recall': 0.8560078, 'specificity': 0.8560078, 'f1': 0.848415, 'auroc': 0.9177749, 'binary_precision': 0.9389671, 'binary_recall': 0.77220076, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.84745765}
confusion matrix:
     0    1
0  203   13
1   59  200
early stop counter: 3
val acc:0.8153364658355713, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.800000011920929 / 0.8863157629966736
after epoch: 17,now: 2024-07-12 02:05:02.910613,epoch time: 0:10:55.552686,used: 3:05:48.782734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9950918, 'precision': 0.98237693, 'recall': 0.9636097, 'specificity': 0.9636097, 'f1': 0.97278607, 'auroc': 0.9993683, 'binary_precision': 0.99639064, 'binary_recall': 0.99845946, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.99742395}
confusion matrix:
      0      1
0  1408    108
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.8779343, 'precision': 0.8816632, 'recall': 0.879306, 'specificity': 0.879306, 'f1': 0.87783736, 'auroc': 0.94606066, 'binary_precision': 0.8367052, 'binary_recall': 0.93086815, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.8812786}
confusion matrix:
     0    1
0  543  113
1   43  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8568421, 'precision': 0.8602222, 'recall': 0.8621925, 'specificity': 0.8621925, 'f1': 0.85679066, 'auroc': 0.92076004, 'binary_precision': 0.92444444, 'binary_recall': 0.8030888, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8595041}
confusion matrix:
     0    1
0  199   17
1   51  208
early stop counter: 4
val acc:0.8779342770576477, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.800000011920929 / 0.8863157629966736
after epoch: 18,now: 2024-07-12 02:15:59.545398,epoch time: 0:10:56.634785,used: 3:16:45.417519,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9906617, 'precision': 0.92449117, 'recall': 0.9853886, 'specificity': 0.9853886, 'f1': 0.95264006, 'auroc': 0.9992976, 'binary_precision': 0.9989537, 'binary_recall': 0.9912257, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.9950747}
confusion matrix:
      0      1
0  1485     31
1   262  29598
---- Validation: 
scalar performance:
{'acc': 0.8873239, 'precision': 0.88734573, 'recall': 0.88761914, 'specificity': 0.88761914, 'f1': 0.8873063, 'auroc': 0.94511217, 'binary_precision': 0.8734375, 'binary_recall': 0.8987138, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.88589543}
confusion matrix:
     0    1
0  575   81
1   63  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8126316, 'precision': 0.8540983, 'recall': 0.8281853, 'specificity': 0.8281853, 'f1': 0.8108578, 'auroc': 0.95350707, 'binary_precision': 1.0, 'binary_recall': 0.65637064, 'binary_specificity': 1.0, 'binary_f1_score': 0.7925408}
confusion matrix:
     0    1
0  216    0
1   89  170
early stop counter: 5
val acc:0.8873239159584045, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.800000011920929 / 0.8863157629966736
after epoch: 19,now: 2024-07-12 02:26:58.068185,epoch time: 0:10:58.522787,used: 3:27:43.940306,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9969085, 'precision': 0.98392445, 'recall': 0.9824091, 'specificity': 0.9824091, 'f1': 0.98316544, 'auroc': 0.9996842, 'binary_precision': 0.9982923, 'binary_recall': 0.99845946, 'binary_specificity': 0.96635884, 'binary_f1_score': 0.9983759}
confusion matrix:
      0      1
0  1465     51
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.86150235, 'precision': 0.87149835, 'recall': 0.86371654, 'specificity': 0.86371654, 'f1': 0.86099774, 'auroc': 0.94316137, 'binary_precision': 0.8035471, 'binary_recall': 0.9469453, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.8693727}
confusion matrix:
     0    1
0  512  144
1   33  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.84284735, 'recall': 0.82250106, 'specificity': 0.82250106, 'f1': 0.82627463, 'auroc': 0.9238167, 'binary_precision': 0.7993311, 'binary_recall': 0.9227799, 'binary_specificity': 0.7222222, 'binary_f1_score': 0.85663086}
confusion matrix:
     0    1
0  156   60
1   20  239
early stop counter: 6
val acc:0.8615023493766785, best validation acc: 0.8888888955116272, corresponding to test acc:                         0.800000011920929 / 0.8863157629966736
after epoch: 20,now: 2024-07-12 02:37:39.808399,epoch time: 0:10:41.740214,used: 3:38:25.680520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.996526, 'precision': 0.97953284, 'recall': 0.98283434, 'specificity': 0.98283434, 'f1': 0.9811772, 'auroc': 0.9997266, 'binary_precision': 0.9983584, 'binary_recall': 0.9979906, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9981744}
confusion matrix:
      0      1
0  1467     49
1    60  29800
---- Validation: 
scalar performance:
{'acc': 0.9084507, 'precision': 0.9086524, 'recall': 0.90815675, 'specificity': 0.90815675, 'f1': 0.90833706, 'auroc': 0.95257485, 'binary_precision': 0.91325694, 'binary_recall': 0.8971061, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.90510947}
confusion matrix:
     0    1
0  603   53
1   64  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589474, 'precision': 0.87407064, 'recall': 0.86873484, 'specificity': 0.86873484, 'f1': 0.85882473, 'auroc': 0.94460535, 'binary_precision': 0.9752475, 'binary_recall': 0.76061773, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.8546637}
confusion matrix:
     0    1
0  211    5
1   62  197
better model found
persisted
after epoch: 21,now: 2024-07-12 02:48:21.063697,epoch time: 0:10:41.255298,used: 3:49:06.935818,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9941675, 'precision': 0.96029544, 'recall': 0.9778384, 'specificity': 0.9778384, 'f1': 0.96888334, 'auroc': 0.99920094, 'binary_precision': 0.99795294, 'binary_recall': 0.9959143, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.99693257}
confusion matrix:
      0      1
0  1455     61
1   122  29738
---- Validation: 
scalar performance:
{'acc': 0.86463225, 'precision': 0.8677063, 'recall': 0.8658904, 'specificity': 0.8658904, 'f1': 0.86455256, 'auroc': 0.94129384, 'binary_precision': 0.8267831, 'binary_recall': 0.9131833, 'binary_specificity': 0.81859756, 'binary_f1_score': 0.8678381}
confusion matrix:
     0    1
0  537  119
1   54  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87578946, 'precision': 0.87958884, 'recall': 0.8814886, 'specificity': 0.8814886, 'f1': 0.87575424, 'auroc': 0.93527454, 'binary_precision': 0.9464286, 'binary_recall': 0.8185328, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8778468}
confusion matrix:
     0    1
0  204   12
1   47  212
early stop counter: 1
val acc:0.864632248878479, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8589473962783813 / 0.8863157629966736
after epoch: 22,now: 2024-07-12 02:59:06.866283,epoch time: 0:10:45.802586,used: 3:59:52.738404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.992797, 'precision': 0.9819754, 'recall': 0.9382976, 'specificity': 0.9382976, 'f1': 0.958985, 'auroc': 0.999048, 'binary_precision': 0.99383414, 'binary_recall': 0.99862695, 'binary_specificity': 0.8779683, 'binary_f1_score': 0.99622476}
confusion matrix:
      0      1
0  1331    185
1    41  29819
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.8422494, 'recall': 0.82628566, 'specificity': 0.82628566, 'f1': 0.8215349, 'auroc': 0.92523134, 'binary_precision': 0.7544987, 'binary_recall': 0.9437299, 'binary_specificity': 0.70884144, 'binary_f1_score': 0.8385714}
confusion matrix:
     0    1
0  465  191
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85052633, 'precision': 0.85082614, 'recall': 0.8537109, 'specificity': 0.8537109, 'f1': 0.85026085, 'auroc': 0.91557634, 'binary_precision': 0.89830506, 'binary_recall': 0.8185328, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.85656565}
confusion matrix:
     0    1
0  192   24
1   47  212
early stop counter: 2
val acc:0.8231611847877502, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8589473962783813 / 0.8863157629966736
after epoch: 23,now: 2024-07-12 03:09:50.943671,epoch time: 0:10:44.077388,used: 4:10:36.815792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9963985, 'precision': 0.98499095, 'recall': 0.97556674, 'specificity': 0.97556674, 'f1': 0.98022735, 'auroc': 0.99956316, 'binary_precision': 0.99759126, 'binary_recall': 0.99862695, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.9981088}
confusion matrix:
      0      1
0  1444     72
1    41  29819
---- Validation: 
scalar performance:
{'acc': 0.8951487, 'precision': 0.89506876, 'recall': 0.89532435, 'specificity': 0.89532435, 'f1': 0.89511764, 'auroc': 0.94742084, 'binary_precision': 0.8848581, 'binary_recall': 0.90192926, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.89331216}
confusion matrix:
     0    1
0  583   73
1   61  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91157895, 'precision': 0.91439, 'recall': 0.9169974, 'specificity': 0.9169974, 'f1': 0.91153157, 'auroc': 0.9623373, 'binary_precision': 0.9779736, 'binary_recall': 0.85714287, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.9135803}
confusion matrix:
     0    1
0  211    5
1   37  222
new oracle model saved
early stop counter: 3
val acc:0.8951486945152283, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8589473962783813 / 0.9115789532661438
after epoch: 24,now: 2024-07-12 03:20:35.310162,epoch time: 0:10:44.366491,used: 4:21:21.182283,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9942313, 'precision': 0.95085573, 'recall': 0.9910208, 'specificity': 0.9910208, 'f1': 0.969977, 'auroc': 0.9996898, 'binary_precision': 0.9993606, 'binary_recall': 0.99457467, 'binary_specificity': 0.987467, 'binary_f1_score': 0.99696183}
confusion matrix:
      0      1
0  1497     19
1   162  29698
---- Validation: 
scalar performance:
{'acc': 0.8974961, 'precision': 0.89874685, 'recall': 0.89677775, 'specificity': 0.89677775, 'f1': 0.89723027, 'auroc': 0.94561946, 'binary_precision': 0.91539764, 'binary_recall': 0.86977494, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.8920033}
confusion matrix:
     0    1
0  606   50
1   81  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77894735, 'precision': 0.8312103, 'recall': 0.7965287, 'specificity': 0.7965287, 'f1': 0.7756016, 'auroc': 0.94698274, 'binary_precision': 0.98734176, 'binary_recall': 0.6023166, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.74820143}
confusion matrix:
     0    1
0  214    2
1  103  156
early stop counter: 4
val acc:0.8974961042404175, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8589473962783813 / 0.9115789532661438
after epoch: 25,now: 2024-07-12 03:31:16.651600,epoch time: 0:10:41.341438,used: 4:32:02.523721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9950918, 'precision': 0.9761511, 'recall': 0.97018415, 'specificity': 0.97018415, 'f1': 0.9731467, 'auroc': 0.9993501, 'binary_precision': 0.9970884, 'binary_recall': 0.9977562, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.9974222}
confusion matrix:
      0      1
0  1429     87
1    67  29793
---- Validation: 
scalar performance:
{'acc': 0.86541474, 'precision': 0.8753002, 'recall': 0.86761093, 'specificity': 0.86761093, 'f1': 0.86493707, 'auroc': 0.9415095, 'binary_precision': 0.80737704, 'binary_recall': 0.9501608, 'binary_specificity': 0.785061, 'binary_f1_score': 0.872969}
confusion matrix:
     0    1
0  515  141
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8968421, 'precision': 0.8999716, 'recall': 0.9023309, 'specificity': 0.9023309, 'f1': 0.89679635, 'auroc': 0.95710003, 'binary_precision': 0.96460176, 'binary_recall': 0.8416988, 'binary_specificity': 0.962963, 'binary_f1_score': 0.89896905}
confusion matrix:
     0    1
0  208    8
1   41  218
early stop counter: 5
val acc:0.8654147386550903, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8589473962783813 / 0.9115789532661438
after epoch: 26,now: 2024-07-12 03:41:59.030846,epoch time: 0:10:42.379246,used: 4:42:44.902967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9879526, 'precision': 0.9908243, 'recall': 0.8775213, 'specificity': 0.8775213, 'f1': 0.9260148, 'auroc': 0.99950653, 'binary_precision': 0.98772496, 'binary_recall': 0.9997656, 'binary_specificity': 0.75527704, 'binary_f1_score': 0.9937088}
confusion matrix:
      0      1
0  1145    371
1     7  29853
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.7703097, 'recall': 0.6309309, 'specificity': 0.6309309, 'f1': 0.5698286, 'auroc': 0.9397578, 'binary_precision': 0.56284153, 'binary_recall': 0.99356914, 'binary_specificity': 0.2682927, 'binary_f1_score': 0.7186047}
confusion matrix:
     0    1
0  176  480
1    4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75578946, 'precision': 0.8061928, 'recall': 0.73570895, 'specificity': 0.73570895, 'f1': 0.73363113, 'auroc': 0.94542754, 'binary_precision': 0.7025496, 'binary_recall': 0.95752895, 'binary_specificity': 0.5138889, 'binary_f1_score': 0.8104575}
confusion matrix:
     0    1
0  111  105
1   11  248
early stop counter: 6
val acc:0.621283233165741, best validation acc: 0.908450722694397, corresponding to test acc:                         0.8589473962783813 / 0.9115789532661438
after epoch: 27,now: 2024-07-12 03:52:43.656890,epoch time: 0:10:44.626044,used: 4:53:29.529011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9968766, 'precision': 0.98156965, 'recall': 0.98458385, 'specificity': 0.98458385, 'f1': 0.98307157, 'auroc': 0.99970376, 'binary_precision': 0.998526, 'binary_recall': 0.99819154, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9983588}
confusion matrix:
      0      1
0  1472     44
1    54  29806
---- Validation: 
scalar performance:
{'acc': 0.91001564, 'precision': 0.9099134, 'recall': 0.9101394, 'specificity': 0.9101394, 'f1': 0.90998125, 'auroc': 0.95406425, 'binary_precision': 0.9017433, 'binary_recall': 0.914791, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.9082203}
confusion matrix:
     0    1
0  594   62
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88, 'precision': 0.88542783, 'recall': 0.88650256, 'specificity': 0.88650256, 'f1': 0.87999153, 'auroc': 0.938939, 'binary_precision': 0.9590909, 'binary_recall': 0.8146718, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.88100207}
confusion matrix:
     0    1
0  207    9
1   48  211
better model found
persisted
after epoch: 28,now: 2024-07-12 04:03:24.970493,epoch time: 0:10:41.313603,used: 5:04:10.842614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.995028, 'precision': 0.96913457, 'recall': 0.9773513, 'specificity': 0.9773513, 'f1': 0.97320306, 'auroc': 0.99937546, 'binary_precision': 0.99785465, 'binary_recall': 0.996919, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9973866}
confusion matrix:
      0      1
0  1452     64
1    92  29768
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8351531, 'recall': 0.8156566, 'specificity': 0.8156566, 'f1': 0.809991, 'auroc': 0.9225925, 'binary_precision': 0.74055415, 'binary_recall': 0.9453376, 'binary_specificity': 0.6859756, 'binary_f1_score': 0.8305084}
confusion matrix:
     0    1
0  450  206
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8494632, 'recall': 0.84447837, 'specificity': 0.84447837, 'f1': 0.8462064, 'auroc': 0.92027736, 'binary_precision': 0.84249085, 'binary_recall': 0.8880309, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8646617}
confusion matrix:
     0    1
0  173   43
1   29  230
early stop counter: 1
val acc:0.8122065663337708, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.8799999952316284 / 0.9115789532661438
after epoch: 29,now: 2024-07-12 04:14:06.731192,epoch time: 0:10:41.760699,used: 5:14:52.603313,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9952193, 'precision': 0.9803754, 'recall': 0.9671204, 'specificity': 0.9671204, 'f1': 0.97364473, 'auroc': 0.99947417, 'binary_precision': 0.9967563, 'binary_recall': 0.99822503, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.99749017}
confusion matrix:
      0      1
0  1419     97
1    53  29807
---- Validation: 
scalar performance:
{'acc': 0.8450704, 'precision': 0.8568926, 'recall': 0.8475021, 'specificity': 0.8475021, 'f1': 0.84433234, 'auroc': 0.9402529, 'binary_precision': 0.78494626, 'binary_recall': 0.9389067, 'binary_specificity': 0.75609756, 'binary_f1_score': 0.8550513}
confusion matrix:
     0    1
0  496  160
1   38  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.87231433, 'recall': 0.87417775, 'specificity': 0.87417775, 'f1': 0.87299466, 'auroc': 0.9319677, 'binary_precision': 0.89641434, 'binary_recall': 0.8687259, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.88235295}
confusion matrix:
     0    1
0  190   26
1   34  225
early stop counter: 2
val acc:0.8450704216957092, best validation acc: 0.9100156426429749, corresponding to test acc:                         0.8799999952316284 / 0.9115789532661438
after epoch: 30,now: 2024-07-12 04:24:49.361024,epoch time: 0:10:42.629832,used: 5:25:35.233145,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_59_14_seed_2_21870151
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:25:35.233145 at 2024-07-12 04:24:49.361024
persisted model performance metric: 

scalar performance:
{'acc': 0.88, 'precision': 0.88542783, 'recall': 0.88650256, 'specificity': 0.88650256, 'f1': 0.87999153, 'auroc': 0.938939, 'binary_precision': 0.9590909, 'binary_recall': 0.8146718, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.88100207}
confusion matrix:
     0    1
0  207    9
1   48  211
oracle model performance metric: 

scalar performance:
{'acc': 0.91157895, 'precision': 0.91439, 'recall': 0.9169974, 'specificity': 0.9169974, 'f1': 0.91153157, 'auroc': 0.9623373, 'binary_precision': 0.9779736, 'binary_recall': 0.85714287, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.9135803}
confusion matrix:
     0    1
0  211    5
1   37  222
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455405 KiB |  13219 MiB |   1044 TiB |   1044 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   1030 TiB |   1030 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455405 KiB |  13219 MiB |   1044 TiB |   1044 TiB |
|       from large pool | 414803 KiB |  13181 MiB |   1030 TiB |   1030 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB |   1040 TiB |   1040 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1026 TiB |   1026 TiB |
|       from small pool |  40408 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14478 MiB |  41638 MiB |  27160 MiB |
|       from large pool |  14412 MiB |  14412 MiB |  41542 MiB |  27130 MiB |
|       from small pool |     66 MiB |     66 MiB |     96 MiB |     30 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447763 KiB |   1238 MiB |    777 TiB |    777 TiB |
|       from large pool | 435116 KiB |   1229 MiB |    762 TiB |    762 TiB |
|       from small pool |  12646 KiB |     43 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4927    |  203711 K  |  203710 K  |
|       from large pool |     187    |    1413    |   97267 K  |   97267 K  |
|       from small pool |    1129    |    4738    |  106444 K  |  106443 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4927    |  203711 K  |  203710 K  |
|       from large pool |     187    |    1413    |   97267 K  |   97267 K  |
|       from small pool |    1129    |    4738    |  106444 K  |  106443 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |    1778    |    1143    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      33    |      48    |      15    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |    2028    |  130413 K  |  130413 K  |
|       from large pool |      38    |     605    |   77082 K  |   77082 K  |
|       from small pool |      59    |    1990    |   53331 K  |   53331 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1030 TiB |   1030 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1044 TiB |   1044 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1030 TiB |   1030 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1040 TiB |   1040 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1026 TiB |   1026 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14478 MiB |  41638 MiB |  40756 MiB |
|       from large pool |    830 MiB |  14412 MiB |  41542 MiB |  40712 MiB |
|       from small pool |     52 MiB |     66 MiB |     96 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1238 MiB |    777 TiB |    777 TiB |
|       from large pool |  24320 KiB |   1229 MiB |    762 TiB |    762 TiB |
|       from small pool |      0 KiB |     43 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4927    |  203711 K  |  203711 K  |
|       from large pool |       2    |    1413    |   97267 K  |   97267 K  |
|       from small pool |       0    |    4738    |  106444 K  |  106444 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4927    |  203711 K  |  203711 K  |
|       from large pool |       2    |    1413    |   97267 K  |   97267 K  |
|       from small pool |       0    |    4738    |  106444 K  |  106444 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     635    |    1778    |    1715    |
|       from large pool |      37    |     602    |    1730    |    1693    |
|       from small pool |      26    |      33    |      48    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2028    |  130414 K  |  130414 K  |
|       from large pool |       4    |     605    |   77082 K  |   77082 K  |
|       from small pool |       0    |    1990    |   53331 K  |   53331 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 04:32:11 2024]
Finished job 0.
1 of 1 steps (100%) done
