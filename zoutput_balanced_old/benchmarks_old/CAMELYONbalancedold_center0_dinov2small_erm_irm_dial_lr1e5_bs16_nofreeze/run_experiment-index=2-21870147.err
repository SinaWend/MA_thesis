Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 20:58:20 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/var/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147

 Experiment start at: 2024-07-10 21:05:42.247225
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.9219663, 'recall': 0.86941934, 'specificity': 0.86941934, 'f1': 0.8937404, 'auroc': 0.9923724, 'binary_precision': 0.987006, 'binary_recall': 0.99361163, 'binary_specificity': 0.7452271, 'binary_f1_score': 0.99029785}
confusion matrix:
      0      1
0  1132    387
1   189  29396
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.66537267, 'precision': 0.778096, 'recall': 0.6697676, 'specificity': 0.6697676, 'f1': 0.63102037, 'auroc': 0.9233321, 'binary_precision': 0.59751433, 'binary_recall': 0.984252, 'binary_specificity': 0.35528332, 'binary_f1_score': 0.74360496}
confusion matrix:
     0    1
0  232  421
1   10  625
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70515466, 'precision': 0.7691195, 'recall': 0.67312664, 'specificity': 0.67312664, 'f1': 0.6615987, 'auroc': 0.90627044, 'binary_precision': 0.66323906, 'binary_recall': 0.95555556, 'binary_specificity': 0.3906977, 'binary_f1_score': 0.7830045}
confusion matrix:
    0    1
0  84  131
1  12  258
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 21:16:44.971652,epoch time: 0:11:02.724427,used: 0:11:02.724427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9866577, 'precision': 0.92107534, 'recall': 0.93865246, 'specificity': 0.93865246, 'f1': 0.92966145, 'auroc': 0.99642384, 'binary_precision': 0.9941053, 'binary_recall': 0.99185395, 'binary_specificity': 0.88545096, 'binary_f1_score': 0.99297833}
confusion matrix:
      0      1
0  1345    174
1   241  29344
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.7838254, 'recall': 0.6941831, 'specificity': 0.6941831, 'f1': 0.66505885, 'auroc': 0.9247302, 'binary_precision': 0.6172962, 'binary_recall': 0.9779528, 'binary_specificity': 0.41041347, 'binary_f1_score': 0.7568556}
confusion matrix:
     0    1
0  268  385
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69278353, 'precision': 0.79106617, 'recall': 0.655857, 'specificity': 0.655857, 'f1': 0.6342661, 'auroc': 0.90766585, 'binary_precision': 0.64792174, 'binary_recall': 0.9814815, 'binary_specificity': 0.33023256, 'binary_f1_score': 0.78055966}
confusion matrix:
    0    1
0  71  144
1   5  265
better model found
persisted
after epoch: 2,now: 2024-07-10 21:27:36.298989,epoch time: 0:10:51.327337,used: 0:21:54.051764,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98913324, 'precision': 0.9722593, 'recall': 0.90741813, 'specificity': 0.90741813, 'f1': 0.9371828, 'auroc': 0.9983254, 'binary_precision': 0.9906724, 'binary_recall': 0.997972, 'binary_specificity': 0.8168643, 'binary_f1_score': 0.9943088}
confusion matrix:
      0      1
0  1240    278
1    60  29526
---- Validation: 
scalar performance:
{'acc': 0.63819873, 'precision': 0.76706076, 'recall': 0.64299, 'specificity': 0.64299, 'f1': 0.5928154, 'auroc': 0.93465173, 'binary_precision': 0.578024, 'binary_recall': 0.9858268, 'binary_specificity': 0.30015314, 'binary_f1_score': 0.72875434}
confusion matrix:
     0    1
0  196  457
1    9  626
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6742268, 'precision': 0.7796722, 'recall': 0.6349268, 'specificity': 0.6349268, 'f1': 0.60503256, 'auroc': 0.9180017, 'binary_precision': 0.6339713, 'binary_recall': 0.9814815, 'binary_specificity': 0.2883721, 'binary_f1_score': 0.77034885}
confusion matrix:
    0    1
0  62  153
1   5  265
early stop counter: 1
val acc:0.638198733329773, best validation acc: 0.6902173757553101, corresponding to test acc:                         0.692783534526825 / 0.7051546573638916
after epoch: 3,now: 2024-07-10 21:38:27.172520,epoch time: 0:10:50.873531,used: 0:32:44.925295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.986079, 'precision': 0.97552025, 'recall': 0.8705871, 'specificity': 0.8705871, 'f1': 0.9158493, 'auroc': 0.99655855, 'binary_precision': 0.98693794, 'binary_recall': 0.99858034, 'binary_specificity': 0.7425938, 'binary_f1_score': 0.992725}
confusion matrix:
      0      1
0  1128    391
1    42  29543
---- Validation: 
scalar performance:
{'acc': 0.59782606, 'precision': 0.764863, 'recall': 0.60330397, 'specificity': 0.60330397, 'f1': 0.5284612, 'auroc': 0.93388605, 'binary_precision': 0.5510026, 'binary_recall': 0.9952756, 'binary_specificity': 0.2113323, 'binary_f1_score': 0.70931536}
confusion matrix:
     0    1
0  138  515
1    3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6268041, 'precision': 0.7526067, 'recall': 0.5809647, 'specificity': 0.5809647, 'f1': 0.5209315, 'auroc': 0.9199311, 'binary_precision': 0.60045147, 'binary_recall': 0.9851852, 'binary_specificity': 0.1767442, 'binary_f1_score': 0.7461431}
confusion matrix:
    0    1
0  38  177
1   4  266
early stop counter: 2
val acc:0.5978260636329651, best validation acc: 0.6902173757553101, corresponding to test acc:                         0.692783534526825 / 0.7051546573638916
after epoch: 4,now: 2024-07-10 21:49:17.119454,epoch time: 0:10:49.946934,used: 0:43:34.872229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9907729, 'precision': 0.94481504, 'recall': 0.95731336, 'specificity': 0.95731336, 'f1': 0.9509671, 'auroc': 0.99790275, 'binary_precision': 0.99590415, 'binary_recall': 0.9943894, 'binary_specificity': 0.9202373, 'binary_f1_score': 0.9951463}
confusion matrix:
      0      1
0  1396    121
1   166  29421
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.8427943, 'recall': 0.8186878, 'specificity': 0.8186878, 'f1': 0.813825, 'auroc': 0.93765664, 'binary_precision': 0.74478525, 'binary_recall': 0.9559055, 'binary_specificity': 0.68147016, 'binary_f1_score': 0.8372414}
confusion matrix:
     0    1
0  445  208
1   28  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.82069266, 'recall': 0.8072351, 'specificity': 0.8072351, 'f1': 0.8108201, 'auroc': 0.9178122, 'binary_precision': 0.8026756, 'binary_recall': 0.8888889, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.8435852}
confusion matrix:
     0    1
0  156   59
1   30  240
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-10 22:00:17.348681,epoch time: 0:11:00.229227,used: 0:54:35.101456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9914802, 'precision': 0.9550434, 'recall': 0.95305353, 'specificity': 0.95305353, 'f1': 0.954046, 'auroc': 0.99784565, 'binary_precision': 0.9954042, 'binary_recall': 0.9956397, 'binary_specificity': 0.9104674, 'binary_f1_score': 0.99552196}
confusion matrix:
      0      1
0  1383    136
1   129  29456
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.8312957, 'recall': 0.7905524, 'specificity': 0.7905524, 'f1': 0.7818513, 'auroc': 0.9387033, 'binary_precision': 0.70804596, 'binary_recall': 0.97007877, 'binary_specificity': 0.61102605, 'binary_f1_score': 0.81860465}
confusion matrix:
     0    1
0  399  254
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.82152784, 'recall': 0.8067614, 'specificity': 0.8067614, 'f1': 0.8105377, 'auroc': 0.90571916, 'binary_precision': 0.8006644, 'binary_recall': 0.8925926, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.8441331}
confusion matrix:
     0    1
0  155   60
1   29  241
early stop counter: 1
val acc:0.7880434989929199, best validation acc: 0.8167701959609985, corresponding to test acc:                         0.8164948225021362 / 0.8164948225021362
after epoch: 6,now: 2024-07-10 22:11:08.696736,epoch time: 0:10:51.348055,used: 1:05:26.449511,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9936664, 'precision': 0.96156365, 'recall': 0.97106504, 'specificity': 0.97106504, 'f1': 0.9662602, 'auroc': 0.99898386, 'binary_precision': 0.9972252, 'binary_recall': 0.9961129, 'binary_specificity': 0.94601715, 'binary_f1_score': 0.99666876}
confusion matrix:
      0      1
0  1437     82
1   115  29470
---- Validation: 
scalar performance:
{'acc': 0.8501553, 'precision': 0.8645624, 'recall': 0.8515477, 'specificity': 0.8515477, 'f1': 0.84899294, 'auroc': 0.94446945, 'binary_precision': 0.78851175, 'binary_recall': 0.9511811, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.8622412}
confusion matrix:
     0    1
0  491  162
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8412371, 'precision': 0.8426994, 'recall': 0.84698534, 'specificity': 0.84698534, 'f1': 0.8409097, 'auroc': 0.91608953, 'binary_precision': 0.907173, 'binary_recall': 0.7962963, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.84812623}
confusion matrix:
     0    1
0  193   22
1   55  215
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-10 22:22:02.330095,epoch time: 0:10:53.633359,used: 1:16:20.082870,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99112654, 'precision': 0.9353256, 'recall': 0.9753506, 'specificity': 0.9753506, 'f1': 0.9543474, 'auroc': 0.9985401, 'binary_precision': 0.99782586, 'binary_recall': 0.9928342, 'binary_specificity': 0.957867, 'binary_f1_score': 0.9953238}
confusion matrix:
      0      1
0  1455     64
1   212  29373
---- Validation: 
scalar performance:
{'acc': 0.80590063, 'precision': 0.8420944, 'recall': 0.8081634, 'specificity': 0.8081634, 'f1': 0.801395, 'auroc': 0.94908774, 'binary_precision': 0.72727275, 'binary_recall': 0.97007877, 'binary_specificity': 0.6462481, 'binary_f1_score': 0.83130914}
confusion matrix:
     0    1
0  422  231
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7814433, 'precision': 0.8213645, 'recall': 0.75917315, 'specificity': 0.75917315, 'f1': 0.7624921, 'auroc': 0.9300258, 'binary_precision': 0.73295456, 'binary_recall': 0.95555556, 'binary_specificity': 0.5627907, 'binary_f1_score': 0.8295819}
confusion matrix:
     0    1
0  121   94
1   12  258
early stop counter: 1
val acc:0.8059006333351135, best validation acc: 0.8501552939414978, corresponding to test acc:                         0.8412371277809143 / 0.8412371277809143
after epoch: 8,now: 2024-07-10 22:32:54.906627,epoch time: 0:10:52.576532,used: 1:27:12.659402,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9921232, 'precision': 0.97567743, 'recall': 0.93777835, 'specificity': 0.93777835, 'f1': 0.9558524, 'auroc': 0.99868226, 'binary_precision': 0.9937399, 'binary_recall': 0.99800575, 'binary_specificity': 0.877551, 'binary_f1_score': 0.9958682}
confusion matrix:
      0      1
0  1333    186
1    59  29526
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.82022786, 'recall': 0.7593107, 'specificity': 0.7593107, 'f1': 0.74483144, 'auroc': 0.9472447, 'binary_precision': 0.67351353, 'binary_recall': 0.98110235, 'binary_specificity': 0.53751916, 'binary_f1_score': 0.798718}
confusion matrix:
     0    1
0  351  302
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77319586, 'precision': 0.7986815, 'recall': 0.7536606, 'specificity': 0.7536606, 'f1': 0.75705826, 'auroc': 0.88337636, 'binary_precision': 0.7352941, 'binary_recall': 0.9259259, 'binary_specificity': 0.5813953, 'binary_f1_score': 0.8196721}
confusion matrix:
     0    1
0  125   90
1   20  250
early stop counter: 2
val acc:0.7562111616134644, best validation acc: 0.8501552939414978, corresponding to test acc:                         0.8412371277809143 / 0.8412371277809143
after epoch: 9,now: 2024-07-10 22:43:47.017097,epoch time: 0:10:52.110470,used: 1:38:04.769872,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98537165, 'precision': 0.9888459, 'recall': 0.85253453, 'specificity': 0.85253453, 'f1': 0.90851516, 'auroc': 0.9992025, 'binary_precision': 0.9851129, 'binary_recall': 0.99972963, 'binary_specificity': 0.7053395, 'binary_f1_score': 0.9923675}
confusion matrix:
      0      1
0  1070    447
1     8  29579
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.82592356, 'recall': 0.76169467, 'specificity': 0.76169467, 'f1': 0.7468309, 'auroc': 0.95066017, 'binary_precision': 0.67419356, 'binary_recall': 0.98740155, 'binary_specificity': 0.53598773, 'binary_f1_score': 0.801278}
confusion matrix:
     0    1
0  350  303
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.83920455, 'recall': 0.8085271, 'specificity': 0.8085271, 'f1': 0.8139608, 'auroc': 0.94241166, 'binary_precision': 0.7875, 'binary_recall': 0.93333334, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.8542373}
confusion matrix:
     0    1
0  147   68
1   18  252
early stop counter: 3
val acc:0.7585403919219971, best validation acc: 0.8501552939414978, corresponding to test acc:                         0.8412371277809143 / 0.8412371277809143
after epoch: 10,now: 2024-07-10 22:54:40.817292,epoch time: 0:10:53.800195,used: 1:48:58.570067,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9853395, 'precision': 0.8882009, 'recall': 0.9829192, 'specificity': 0.9829192, 'f1': 0.92968726, 'auroc': 0.99815, 'binary_precision': 0.99897224, 'binary_recall': 0.9856013, 'binary_specificity': 0.9802371, 'binary_f1_score': 0.9922417}
confusion matrix:
      0      1
0  1488     30
1   426  29160
---- Validation: 
scalar performance:
{'acc': 0.86490685, 'precision': 0.8696116, 'recall': 0.8641208, 'specificity': 0.8641208, 'f1': 0.8642732, 'auroc': 0.93017805, 'binary_precision': 0.9079646, 'binary_recall': 0.807874, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.85499996}
confusion matrix:
     0    1
0  601   52
1  122  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8329897, 'precision': 0.8461964, 'recall': 0.84478897, 'specificity': 0.84478897, 'f1': 0.83297837, 'auroc': 0.93586564, 'binary_precision': 0.9478673, 'binary_recall': 0.7407407, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.83160084}
confusion matrix:
     0    1
0  204   11
1   70  200
better model found
persisted
after epoch: 11,now: 2024-07-10 23:05:34.852795,epoch time: 0:10:54.035503,used: 1:59:52.605570,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99466306, 'precision': 0.97464997, 'recall': 0.96752954, 'specificity': 0.96752954, 'f1': 0.9710597, 'auroc': 0.9991342, 'binary_precision': 0.99679154, 'binary_recall': 0.99760014, 'binary_specificity': 0.9374589, 'binary_f1_score': 0.99719566}
confusion matrix:
      0      1
0  1424     95
1    71  29514
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.89154494, 'recall': 0.8867263, 'specificity': 0.8867263, 'f1': 0.8855959, 'auroc': 0.94823647, 'binary_precision': 0.8407821, 'binary_recall': 0.9480315, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.8911917}
confusion matrix:
     0    1
0  539  114
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.8742924, 'recall': 0.87355727, 'specificity': 0.87355727, 'f1': 0.8618533, 'auroc': 0.93789834, 'binary_precision': 0.97652584, 'binary_recall': 0.77037036, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8612836}
confusion matrix:
     0    1
0  210    5
1   62  208
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-10 23:16:24.772355,epoch time: 0:10:49.919560,used: 2:10:42.525130,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9941808, 'precision': 0.95412475, 'recall': 0.98662925, 'specificity': 0.98662925, 'f1': 0.9697466, 'auroc': 0.9994658, 'binary_precision': 0.99888027, 'binary_recall': 0.9949976, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.9969352}
confusion matrix:
      0      1
0  1485     33
1   148  29438
---- Validation: 
scalar performance:
{'acc': 0.88897514, 'precision': 0.8919351, 'recall': 0.88837826, 'specificity': 0.88837826, 'f1': 0.88863677, 'auroc': 0.94751537, 'binary_precision': 0.92268044, 'binary_recall': 0.84566927, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.88249797}
confusion matrix:
     0    1
0  608   45
1   98  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8041237, 'precision': 0.82780725, 'recall': 0.8193368, 'specificity': 0.8193368, 'f1': 0.8037901, 'auroc': 0.91652024, 'binary_precision': 0.94871795, 'binary_recall': 0.6851852, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.79569894}
confusion matrix:
     0    1
0  205   10
1   85  185
better model found
persisted
after epoch: 13,now: 2024-07-10 23:27:13.504301,epoch time: 0:10:48.731946,used: 2:21:31.257076,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9930877, 'precision': 0.94785774, 'recall': 0.9816496, 'specificity': 0.9816496, 'f1': 0.9640635, 'auroc': 0.9992868, 'binary_precision': 0.99840504, 'binary_recall': 0.99432224, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.99635947}
confusion matrix:
      0      1
0  1468     47
1   168  29421
---- Validation: 
scalar performance:
{'acc': 0.9130435, 'precision': 0.913085, 'recall': 0.91315675, 'specificity': 0.91315675, 'f1': 0.9130416, 'auroc': 0.9591347, 'binary_precision': 0.90417314, 'binary_recall': 0.9212598, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.91263646}
confusion matrix:
     0    1
0  591   62
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.8730836, 'recall': 0.8730836, 'specificity': 0.8730836, 'f1': 0.8618557, 'auroc': 0.943342, 'binary_precision': 0.97209305, 'binary_recall': 0.7740741, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8618557}
confusion matrix:
     0    1
0  209    6
1   61  209
better model found
persisted
after epoch: 14,now: 2024-07-10 23:38:02.685562,epoch time: 0:10:49.181261,used: 2:32:20.438337,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9941808, 'precision': 0.9695848, 'recall': 0.96752715, 'specificity': 0.96752715, 'f1': 0.96855354, 'auroc': 0.99908084, 'binary_precision': 0.9968238, 'binary_recall': 0.99705964, 'binary_specificity': 0.9379947, 'binary_f1_score': 0.99694175}
confusion matrix:
      0      1
0  1422     94
1    87  29501
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.8842821, 'recall': 0.87900424, 'specificity': 0.87900424, 'f1': 0.87777483, 'auroc': 0.95513797, 'binary_precision': 0.83194447, 'binary_recall': 0.9433071, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.88413286}
confusion matrix:
     0    1
0  532  121
1   36  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.8685684, 'recall': 0.87291133, 'specificity': 0.87291133, 'f1': 0.86938345, 'auroc': 0.9408785, 'binary_precision': 0.9123506, 'binary_recall': 0.84814817, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8790787}
confusion matrix:
     0    1
0  193   22
1   41  229
new oracle model saved
early stop counter: 1
val acc:0.8781055808067322, best validation acc: 0.9130434989929199, corresponding to test acc:                         0.861855685710907 / 0.870103120803833
after epoch: 15,now: 2024-07-10 23:48:50.672040,epoch time: 0:10:47.986478,used: 2:43:08.424815,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9953061, 'precision': 0.970595, 'recall': 0.97940874, 'specificity': 0.97940874, 'f1': 0.97495615, 'auroc': 0.9993628, 'binary_precision': 0.99803764, 'binary_recall': 0.9970256, 'binary_specificity': 0.9617918, 'binary_f1_score': 0.99753135}
confusion matrix:
      0      1
0  1460     58
1    88  29498
---- Validation: 
scalar performance:
{'acc': 0.9169255, 'precision': 0.91692543, 'recall': 0.9170069, 'specificity': 0.9170069, 'f1': 0.9169214, 'auroc': 0.95952296, 'binary_precision': 0.90993786, 'binary_recall': 0.92283463, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.9163408}
confusion matrix:
     0    1
0  595   58
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.86151516, 'recall': 0.85964686, 'specificity': 0.85964686, 'f1': 0.8474065, 'auroc': 0.9300258, 'binary_precision': 0.96666664, 'binary_recall': 0.75185186, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.84583336}
confusion matrix:
     0    1
0  208    7
1   67  203
better model found
persisted
after epoch: 16,now: 2024-07-10 23:59:40.706173,epoch time: 0:10:50.034133,used: 2:53:58.458948,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9938915, 'precision': 0.98983157, 'recall': 0.9436673, 'specificity': 0.9436673, 'f1': 0.96548104, 'auroc': 0.9994637, 'binary_precision': 0.994283, 'binary_recall': 0.999324, 'binary_specificity': 0.88801056, 'binary_f1_score': 0.99679714}
confusion matrix:
      0      1
0  1348    170
1    20  29566
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.86867857, 'recall': 0.84874535, 'specificity': 0.84874535, 'f1': 0.84519446, 'auroc': 0.95931804, 'binary_precision': 0.77581865, 'binary_recall': 0.97007877, 'binary_specificity': 0.7274119, 'binary_f1_score': 0.8621414}
confusion matrix:
     0    1
0  475  178
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.88270783, 'recall': 0.88682175, 'specificity': 0.88682175, 'f1': 0.88378465, 'auroc': 0.9452541, 'binary_precision': 0.9212598, 'binary_recall': 0.8666667, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8931298}
confusion matrix:
     0    1
0  195   20
1   36  234
new oracle model saved
early stop counter: 1
val acc:0.8470497131347656, best validation acc: 0.9169254899024963, corresponding to test acc:                         0.8474226593971252 / 0.88453608751297
after epoch: 17,now: 2024-07-11 00:10:30.406967,epoch time: 0:10:49.700794,used: 3:04:48.159742,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9922518, 'precision': 0.9591888, 'recall': 0.9571795, 'specificity': 0.9571795, 'f1': 0.95818174, 'auroc': 0.9982643, 'binary_precision': 0.9958098, 'binary_recall': 0.9960454, 'binary_specificity': 0.91831356, 'binary_f1_score': 0.99592763}
confusion matrix:
      0      1
0  1394    124
1   117  29469
---- Validation: 
scalar performance:
{'acc': 0.8695652, 'precision': 0.8696058, 'recall': 0.86967, 'specificity': 0.86967, 'f1': 0.8695624, 'auroc': 0.9374661, 'binary_precision': 0.86089647, 'binary_recall': 0.8771654, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.8689548}
confusion matrix:
     0    1
0  563   90
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8103093, 'precision': 0.8402375, 'recall': 0.827261, 'specificity': 0.827261, 'f1': 0.80971956, 'auroc': 0.912317, 'binary_precision': 0.9734042, 'binary_recall': 0.67777777, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7991267}
confusion matrix:
     0    1
0  210    5
1   87  183
early stop counter: 2
val acc:0.8695651888847351, best validation acc: 0.9169254899024963, corresponding to test acc:                         0.8474226593971252 / 0.88453608751297
after epoch: 18,now: 2024-07-11 00:21:18.182915,epoch time: 0:10:47.775948,used: 3:15:35.935690,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9959812, 'precision': 0.9855982, 'recall': 0.9707017, 'specificity': 0.9707017, 'f1': 0.9780206, 'auroc': 0.99957514, 'binary_precision': 0.9970643, 'binary_recall': 0.9987156, 'binary_specificity': 0.94268775, 'binary_f1_score': 0.9978892}
confusion matrix:
      0      1
0  1431     87
1    38  29548
---- Validation: 
scalar performance:
{'acc': 0.9083851, 'precision': 0.91068256, 'recall': 0.9089315, 'specificity': 0.9089315, 'f1': 0.9083212, 'auroc': 0.9592239, 'binary_precision': 0.87627363, 'binary_recall': 0.9480315, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.91074127}
confusion matrix:
     0    1
0  568   85
1   33  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87628865, 'precision': 0.8828424, 'recall': 0.8855728, 'specificity': 0.8855728, 'f1': 0.87624604, 'auroc': 0.93670976, 'binary_precision': 0.96875, 'binary_recall': 0.8037037, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8785425}
confusion matrix:
     0    1
0  208    7
1   53  217
early stop counter: 3
val acc:0.9083850979804993, best validation acc: 0.9169254899024963, corresponding to test acc:                         0.8474226593971252 / 0.88453608751297
after epoch: 19,now: 2024-07-11 00:32:06.373027,epoch time: 0:10:48.190112,used: 3:26:24.125802,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99498457, 'precision': 0.96599865, 'recall': 0.9811146, 'specificity': 0.9811146, 'f1': 0.9734216, 'auroc': 0.9994427, 'binary_precision': 0.99823934, 'binary_recall': 0.9964848, 'binary_specificity': 0.9657444, 'binary_f1_score': 0.9973613}
confusion matrix:
      0      1
0  1466     52
1   104  29482
---- Validation: 
scalar performance:
{'acc': 0.9301242, 'precision': 0.93015844, 'recall': 0.9300672, 'specificity': 0.9300672, 'f1': 0.93010384, 'auroc': 0.9647948, 'binary_precision': 0.9318542, 'binary_recall': 0.92598426, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.92890996}
confusion matrix:
     0    1
0  610   43
1   47  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8453608, 'precision': 0.8488342, 'recall': 0.852584, 'specificity': 0.852584, 'f1': 0.8451923, 'auroc': 0.9211714, 'binary_precision': 0.9220779, 'binary_recall': 0.7888889, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.85029936}
confusion matrix:
     0    1
0  197   18
1   57  213
better model found
persisted
after epoch: 20,now: 2024-07-11 00:42:52.383948,epoch time: 0:10:46.010921,used: 3:37:10.136723,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9962706, 'precision': 0.9762615, 'recall': 0.9839877, 'specificity': 0.9839877, 'f1': 0.9800898, 'auroc': 0.99960804, 'binary_precision': 0.99847764, 'binary_recall': 0.99760014, 'binary_specificity': 0.97037524, 'binary_f1_score': 0.99803865}
confusion matrix:
      0      1
0  1474     45
1    71  29514
---- Validation: 
scalar performance:
{'acc': 0.9130435, 'precision': 0.9130336, 'recall': 0.91311336, 'specificity': 0.91311336, 'f1': 0.91303825, 'auroc': 0.9624531, 'binary_precision': 0.9066874, 'binary_recall': 0.91811025, 'binary_specificity': 0.9081164, 'binary_f1_score': 0.9123631}
confusion matrix:
     0    1
0  593   60
1   52  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680412, 'precision': 0.8755181, 'recall': 0.8776916, 'specificity': 0.8776916, 'f1': 0.86801374, 'auroc': 0.941671, 'binary_precision': 0.963964, 'binary_recall': 0.7925926, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8699187}
confusion matrix:
     0    1
0  207    8
1   56  214
early stop counter: 1
val acc:0.9130434989929199, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.88453608751297
after epoch: 21,now: 2024-07-11 00:53:40.620054,epoch time: 0:10:48.236106,used: 3:47:58.372829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99286264, 'precision': 0.9704407, 'recall': 0.9515944, 'specificity': 0.9515944, 'f1': 0.9608026, 'auroc': 0.998596, 'binary_precision': 0.9951769, 'binary_recall': 0.9973297, 'binary_specificity': 0.9058591, 'binary_f1_score': 0.9962521}
confusion matrix:
      0      1
0  1376    143
1    79  29506
---- Validation: 
scalar performance:
{'acc': 0.89052796, 'precision': 0.8926537, 'recall': 0.89106, 'specificity': 0.89106, 'f1': 0.890456, 'auroc': 0.9536121, 'binary_precision': 0.8600583, 'binary_recall': 0.92913383, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.8932626}
confusion matrix:
     0    1
0  557   96
1   45  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.843299, 'precision': 0.84479874, 'recall': 0.836994, 'specificity': 0.836994, 'f1': 0.83966666, 'auroc': 0.9397416, 'binary_precision': 0.8368056, 'binary_recall': 0.8925926, 'binary_specificity': 0.7813954, 'binary_f1_score': 0.8637993}
confusion matrix:
     0    1
0  168   47
1   29  241
early stop counter: 2
val acc:0.8905279636383057, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.88453608751297
after epoch: 22,now: 2024-07-11 01:04:27.385228,epoch time: 0:10:46.765174,used: 3:58:45.138003,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99369854, 'precision': 0.9502425, 'recall': 0.9860705, 'specificity': 0.9860705, 'f1': 0.96738625, 'auroc': 0.9994259, 'binary_precision': 0.99884576, 'binary_recall': 0.99452424, 'binary_specificity': 0.97761685, 'binary_f1_score': 0.99668026}
confusion matrix:
      0      1
0  1485     34
1   162  29423
---- Validation: 
scalar performance:
{'acc': 0.92391306, 'precision': 0.9249142, 'recall': 0.92359436, 'specificity': 0.92359436, 'f1': 0.92381585, 'auroc': 0.967409, 'binary_precision': 0.94233936, 'binary_recall': 0.9007874, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.921095}
confusion matrix:
     0    1
0  618   35
1   63  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680412, 'precision': 0.8776243, 'recall': 0.8786391, 'specificity': 0.8786391, 'f1': 0.86803615, 'auroc': 0.9420327, 'binary_precision': 0.9724771, 'binary_recall': 0.78518516, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8688524}
confusion matrix:
     0    1
0  209    6
1   58  212
early stop counter: 3
val acc:0.9239130616188049, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.88453608751297
after epoch: 23,now: 2024-07-11 01:15:13.906520,epoch time: 0:10:46.521292,used: 4:09:31.659295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99495244, 'precision': 0.98698497, 'recall': 0.95797414, 'specificity': 0.95797414, 'f1': 0.97198385, 'auroc': 0.9996128, 'binary_precision': 0.99575484, 'binary_recall': 0.9989522, 'binary_specificity': 0.91699606, 'binary_f1_score': 0.99735093}
confusion matrix:
      0      1
0  1392    126
1    31  29555
---- Validation: 
scalar performance:
{'acc': 0.88509315, 'precision': 0.8951094, 'recall': 0.88622105, 'specificity': 0.88622105, 'f1': 0.88455427, 'auroc': 0.96891874, 'binary_precision': 0.82861, 'binary_recall': 0.96692914, 'binary_specificity': 0.805513, 'binary_f1_score': 0.8924419}
confusion matrix:
     0    1
0  526  127
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9030928, 'precision': 0.905614, 'recall': 0.8982774, 'specificity': 0.8982774, 'f1': 0.90103114, 'auroc': 0.96592593, 'binary_precision': 0.8912281, 'binary_recall': 0.94074076, 'binary_specificity': 0.855814, 'binary_f1_score': 0.9153154}
confusion matrix:
     0    1
0  184   31
1   16  254
new oracle model saved
early stop counter: 4
val acc:0.8850931525230408, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9030928015708923
after epoch: 24,now: 2024-07-11 01:26:02.004996,epoch time: 0:10:48.098476,used: 4:20:19.757771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9962384, 'precision': 0.9843018, 'recall': 0.97491515, 'specificity': 0.97491515, 'f1': 0.9795572, 'auroc': 0.9996457, 'binary_precision': 0.9975014, 'binary_recall': 0.99854654, 'binary_specificity': 0.95128375, 'binary_f1_score': 0.9980236}
confusion matrix:
      0      1
0  1445     74
1    43  29542
---- Validation: 
scalar performance:
{'acc': 0.92391306, 'precision': 0.9240241, 'recall': 0.9238114, 'specificity': 0.9238114, 'f1': 0.923882, 'auroc': 0.9657957, 'binary_precision': 0.9282297, 'binary_recall': 0.91653544, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.92234546}
confusion matrix:
     0    1
0  608   45
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88659793, 'precision': 0.8958097, 'recall': 0.8972007, 'specificity': 0.8972007, 'f1': 0.88659024, 'auroc': 0.9505771, 'binary_precision': 0.99086756, 'binary_recall': 0.8037037, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.88752556}
confusion matrix:
     0    1
0  213    2
1   53  217
early stop counter: 5
val acc:0.9239130616188049, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9030928015708923
after epoch: 25,now: 2024-07-11 01:36:47.996071,epoch time: 0:10:45.991075,used: 4:31:05.748846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99549896, 'precision': 0.97980237, 'recall': 0.97140384, 'specificity': 0.97140384, 'f1': 0.97556174, 'auroc': 0.9994739, 'binary_precision': 0.9971634, 'binary_recall': 0.99810714, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.99763507}
confusion matrix:
      0      1
0  1435     84
1    56  29529
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.8930087, 'recall': 0.88243604, 'specificity': 0.88243604, 'f1': 0.88053364, 'auroc': 0.9654074, 'binary_precision': 0.82133335, 'binary_recall': 0.97007877, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.8895307}
confusion matrix:
     0    1
0  519  134
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9257732, 'precision': 0.9238807, 'recall': 0.92764854, 'specificity': 0.92764854, 'f1': 0.9251851, 'auroc': 0.9620844, 'binary_precision': 0.95348835, 'binary_recall': 0.9111111, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.9318182}
confusion matrix:
     0    1
0  203   12
1   24  246
new oracle model saved
early stop counter: 6
val acc:0.8812111616134644, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9257732033729553
after epoch: 26,now: 2024-07-11 01:47:32.412473,epoch time: 0:10:44.416402,used: 4:41:50.165248,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9964956, 'precision': 0.9737626, 'recall': 0.98941445, 'specificity': 0.98941445, 'f1': 0.98144627, 'auroc': 0.99973136, 'binary_precision': 0.99905187, 'binary_recall': 0.9972621, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.9981562}
confusion matrix:
      0      1
0  1491     28
1    81  29504
---- Validation: 
scalar performance:
{'acc': 0.9052795, 'precision': 0.9053582, 'recall': 0.9054129, 'specificity': 0.9054129, 'f1': 0.90527856, 'auroc': 0.9577842, 'binary_precision': 0.89522344, 'binary_recall': 0.9149606, 'binary_specificity': 0.89586526, 'binary_f1_score': 0.9049844}
confusion matrix:
     0    1
0  585   68
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8969072, 'precision': 0.89871347, 'recall': 0.90361756, 'specificity': 0.90361756, 'f1': 0.8967135, 'auroc': 0.9454091, 'binary_precision': 0.9661017, 'binary_recall': 0.84444445, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.90118575}
confusion matrix:
     0    1
0  207    8
1   42  228
early stop counter: 7
val acc:0.9052795171737671, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9257732033729553
after epoch: 27,now: 2024-07-11 01:58:17.245872,epoch time: 0:10:44.833399,used: 4:52:34.998647,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9962384, 'precision': 0.9819191, 'recall': 0.977399, 'specificity': 0.977399, 'f1': 0.97964716, 'auroc': 0.9996276, 'binary_precision': 0.99777037, 'binary_recall': 0.99827623, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.9980232}
confusion matrix:
      0      1
0  1452     66
1    51  29535
---- Validation: 
scalar performance:
{'acc': 0.9208075, 'precision': 0.9213472, 'recall': 0.9205749, 'specificity': 0.9205749, 'f1': 0.92073846, 'auroc': 0.96320796, 'binary_precision': 0.93333334, 'binary_recall': 0.903937, 'binary_specificity': 0.9372129, 'binary_f1_score': 0.91840005}
confusion matrix:
     0    1
0  612   41
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.90010417, 'recall': 0.90366066, 'specificity': 0.90366066, 'f1': 0.89478093, 'auroc': 0.9491128, 'binary_precision': 0.98237884, 'binary_recall': 0.82592595, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8973843}
confusion matrix:
     0    1
0  211    4
1   47  223
early stop counter: 8
val acc:0.9208074808120728, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9257732033729553
after epoch: 28,now: 2024-07-11 02:09:04.438217,epoch time: 0:10:47.192345,used: 5:03:22.190992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99527395, 'precision': 0.99142694, 'recall': 0.95717764, 'specificity': 0.95717764, 'f1': 0.9736148, 'auroc': 0.9997767, 'binary_precision': 0.99565625, 'binary_recall': 0.9993916, 'binary_specificity': 0.9149637, 'binary_f1_score': 0.99752045}
confusion matrix:
      0      1
0  1388    129
1    18  29569
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.90014976, 'recall': 0.8930906, 'specificity': 0.8930906, 'f1': 0.89169365, 'auroc': 0.9614451, 'binary_precision': 0.83972603, 'binary_recall': 0.9653543, 'binary_specificity': 0.82082695, 'binary_f1_score': 0.8981685}
confusion matrix:
     0    1
0  536  117
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.87247866, 'recall': 0.87282515, 'specificity': 0.87282515, 'f1': 0.8726481, 'auroc': 0.92194664, 'binary_precision': 0.88847584, 'binary_recall': 0.8851852, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.88682747}
confusion matrix:
     0    1
0  185   30
1   31  239
early stop counter: 9
val acc:0.8920807242393494, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9257732033729553
after epoch: 29,now: 2024-07-11 02:19:52.620582,epoch time: 0:10:48.182365,used: 5:14:10.373357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99604553, 'precision': 0.9897033, 'recall': 0.9673194, 'specificity': 0.9673194, 'f1': 0.9782199, 'auroc': 0.9996959, 'binary_precision': 0.99669564, 'binary_recall': 0.999155, 'binary_specificity': 0.9354839, 'binary_f1_score': 0.99792385}
confusion matrix:
      0      1
0  1421     98
1    25  29560
---- Validation: 
scalar performance:
{'acc': 0.9130435, 'precision': 0.9153618, 'recall': 0.9135908, 'specificity': 0.9135908, 'f1': 0.9129828, 'auroc': 0.9685377, 'binary_precision': 0.88064045, 'binary_recall': 0.9527559, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.9152798}
confusion matrix:
     0    1
0  571   82
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9030928, 'precision': 0.90345895, 'recall': 0.9086994, 'specificity': 0.9086994, 'f1': 0.9028135, 'auroc': 0.9406202, 'binary_precision': 0.9626556, 'binary_recall': 0.85925925, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.9080235}
confusion matrix:
     0    1
0  206    9
1   38  232
early stop counter: 10
val acc:0.9130434989929199, best validation acc: 0.9301242232322693, corresponding to test acc:                         0.8453608155250549 / 0.9257732033729553
after epoch: 30,now: 2024-07-11 02:30:39.896642,epoch time: 0:10:47.276060,used: 5:24:57.649417,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_05_42_seed_0_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:24:57.649417 at 2024-07-11 02:30:39.896642
persisted model performance metric: 

scalar performance:
{'acc': 0.8453608, 'precision': 0.8488342, 'recall': 0.852584, 'specificity': 0.852584, 'f1': 0.8451923, 'auroc': 0.9211714, 'binary_precision': 0.9220779, 'binary_recall': 0.7888889, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.85029936}
confusion matrix:
     0    1
0  197   18
1   57  213
oracle model performance metric: 

scalar performance:
{'acc': 0.9257732, 'precision': 0.9238807, 'recall': 0.92764854, 'specificity': 0.92764854, 'f1': 0.9251851, 'auroc': 0.9620844, 'binary_precision': 0.95348835, 'binary_recall': 0.9111111, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.9318182}
confusion matrix:
     0    1
0  203   12
1   24  246
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455466 KiB |  13219 MiB | 362997 GiB | 362996 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358166 GiB | 358165 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455466 KiB |  13219 MiB | 362997 GiB | 362996 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358166 GiB | 358165 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 359819 GiB | 359818 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 354999 GiB | 354998 GiB |
|       from small pool |  40408 KiB |     56 MiB |   4820 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447702 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool | 435058 KiB |   1243 MiB | 267869 GiB | 267869 GiB |
|       from small pool |  12643 KiB |     17 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1322    |    4893    |   68263 K  |   68261 K  |
|       from large pool |     187    |    1413    |   32653 K  |   32653 K  |
|       from small pool |    1135    |    4704    |   35609 K  |   35608 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1322    |    4893    |   68263 K  |   68261 K  |
|       from large pool |     187    |    1413    |   32653 K  |   32653 K  |
|       from small pool |    1135    |    4704    |   35609 K  |   35608 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      94    |    2010    |   41860 K  |   41860 K  |
|       from large pool |      37    |     600    |   24237 K  |   24237 K  |
|       from small pool |      57    |    1972    |   17622 K  |   17622 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 362997 GiB | 362997 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358166 GiB | 358166 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 362997 GiB | 362997 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358166 GiB | 358166 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 359819 GiB | 359819 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 354999 GiB | 354999 GiB |
|       from small pool |      0 KiB |     56 MiB |   4820 GiB |   4820 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 267870 GiB | 267870 GiB |
|       from small pool |      0 KiB |     46 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35609 K  |   35609 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35609 K  |   35609 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2010    |   41860 K  |   41860 K  |
|       from large pool |       4    |     600    |   24237 K  |   24237 K  |
|       from small pool |       0    |    1972    |   17623 K  |   17623 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 362997 GiB | 362997 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358166 GiB | 358166 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 362997 GiB | 362997 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358166 GiB | 358166 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 359819 GiB | 359819 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 354999 GiB | 354999 GiB |
|       from small pool |      0 KiB |     56 MiB |   4820 GiB |   4820 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 267870 GiB | 267870 GiB |
|       from small pool |      0 KiB |     46 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35609 K  |   35609 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68263 K  |   68263 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35609 K  |   35609 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2010    |   41860 K  |   41860 K  |
|       from large pool |       4    |     600    |   24237 K  |   24237 K  |
|       from small pool |       0    |    1972    |   17623 K  |   17623 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147

 Experiment start at: 2024-07-11 02:44:18.958668
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9838865, 'precision': 0.8995659, 'recall': 0.9360136, 'specificity': 0.9360136, 'f1': 0.9168899, 'auroc': 0.9941982, 'binary_precision': 0.9939759, 'binary_recall': 0.9890554, 'binary_specificity': 0.8829717, 'binary_f1_score': 0.9915095}
confusion matrix:
      0      1
0  1343    178
1   325  29370
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.82231355, 'recall': 0.8059908, 'specificity': 0.8059908, 'f1': 0.80189157, 'auroc': 0.92149806, 'binary_precision': 0.74140126, 'binary_recall': 0.9238095, 'binary_specificity': 0.68817204, 'binary_f1_score': 0.82261485}
confusion matrix:
     0    1
0  448  203
1   48  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.81389594, 'recall': 0.81205976, 'specificity': 0.81205976, 'f1': 0.8126852, 'auroc': 0.91056657, 'binary_precision': 0.8129771, 'binary_recall': 0.84189725, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.8271845}
confusion matrix:
     0    1
0  176   49
1   40  213
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 02:55:07.585857,epoch time: 0:10:48.627189,used: 0:10:48.627189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98571247, 'precision': 0.9008637, 'recall': 0.9603653, 'specificity': 0.9603653, 'f1': 0.9282836, 'auroc': 0.99675745, 'binary_precision': 0.9965031, 'binary_recall': 0.9884492, 'binary_specificity': 0.9322814, 'binary_f1_score': 0.99245983}
confusion matrix:
      0      1
0  1418    103
1   343  29352
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.8274987, 'recall': 0.7995136, 'specificity': 0.7995136, 'f1': 0.79308313, 'auroc': 0.9342355, 'binary_precision': 0.72343, 'binary_recall': 0.9507936, 'binary_specificity': 0.6482335, 'binary_f1_score': 0.8216735}
confusion matrix:
     0    1
0  422  229
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8012552, 'precision': 0.8058872, 'recall': 0.7970048, 'specificity': 0.7970048, 'f1': 0.7983883, 'auroc': 0.9082301, 'binary_precision': 0.78014183, 'binary_recall': 0.8695652, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.82242984}
confusion matrix:
     0    1
0  163   62
1   33  220
early stop counter: 1
val acc:0.7970335483551025, best validation acc: 0.8040593266487122, corresponding to test acc:                         0.8138075470924377 / 0.8138075470924377
after epoch: 2,now: 2024-07-11 03:05:52.419741,epoch time: 0:10:44.833884,used: 0:21:33.461073,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98856354, 'precision': 0.9194845, 'recall': 0.96654224, 'specificity': 0.96654224, 'f1': 0.941602, 'auroc': 0.99719244, 'binary_precision': 0.99701834, 'binary_recall': 0.9909412, 'binary_specificity': 0.9421433, 'binary_f1_score': 0.99397045}
confusion matrix:
      0      1
0  1433     88
1   269  29426
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8442402, 'recall': 0.8263185, 'specificity': 0.8263185, 'f1': 0.82235366, 'auroc': 0.93392336, 'binary_precision': 0.7573062, 'binary_recall': 0.94603175, 'binary_specificity': 0.7066052, 'binary_f1_score': 0.8412139}
confusion matrix:
     0    1
0  460  191
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.832636, 'precision': 0.8329044, 'recall': 0.83402723, 'specificity': 0.83402723, 'f1': 0.8325304, 'auroc': 0.9004304, 'binary_precision': 0.8649789, 'binary_recall': 0.8102767, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8367347}
confusion matrix:
     0    1
0  193   32
1   48  205
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 03:16:38.596699,epoch time: 0:10:46.176958,used: 0:32:19.638031,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.93991953, 'recall': 0.95908093, 'specificity': 0.95908093, 'f1': 0.9492708, 'auroc': 0.99780047, 'binary_precision': 0.9961181, 'binary_recall': 0.99377, 'binary_specificity': 0.92439187, 'binary_f1_score': 0.99494267}
confusion matrix:
      0      1
0  1406    115
1   185  29510
---- Validation: 
scalar performance:
{'acc': 0.69320846, 'precision': 0.7807994, 'recall': 0.6977214, 'specificity': 0.6977214, 'f1': 0.67025125, 'auroc': 0.9309048, 'binary_precision': 0.619818, 'binary_recall': 0.97301584, 'binary_specificity': 0.42242703, 'binary_f1_score': 0.7572576}
confusion matrix:
     0    1
0  275  376
1   17  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175732, 'precision': 0.7847085, 'recall': 0.7024594, 'specificity': 0.7024594, 'f1': 0.68981177, 'auroc': 0.92045677, 'binary_precision': 0.66032606, 'binary_recall': 0.9604743, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.7826086}
confusion matrix:
     0    1
0  100  125
1   10  243
early stop counter: 1
val acc:0.6932084560394287, best validation acc: 0.824355959892273, corresponding to test acc:                         0.8326359987258911 / 0.8326359987258911
after epoch: 4,now: 2024-07-11 03:27:21.807308,epoch time: 0:10:43.210609,used: 0:43:02.848640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99151075, 'precision': 0.9556242, 'recall': 0.9524967, 'specificity': 0.9524967, 'f1': 0.9540545, 'auroc': 0.9981431, 'binary_precision': 0.9953545, 'binary_recall': 0.9957232, 'binary_specificity': 0.9092702, 'binary_f1_score': 0.9955388}
confusion matrix:
      0      1
0  1383    138
1   127  29568
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.85246086, 'recall': 0.84370196, 'specificity': 0.84370196, 'f1': 0.84151083, 'auroc': 0.9372418, 'binary_precision': 0.7884097, 'binary_recall': 0.9285714, 'binary_specificity': 0.7588326, 'binary_f1_score': 0.8527696}
confusion matrix:
     0    1
0  494  157
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.8163365, 'recall': 0.8164866, 'specificity': 0.8164866, 'f1': 0.8138067, 'auroc': 0.91578394, 'binary_precision': 0.86283183, 'binary_recall': 0.770751, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8141962}
confusion matrix:
     0    1
0  194   31
1   58  195
better model found
persisted
after epoch: 5,now: 2024-07-11 03:38:06.813869,epoch time: 0:10:45.006561,used: 0:53:47.855201,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9928883, 'precision': 0.9808342, 'recall': 0.9410569, 'specificity': 0.9410569, 'f1': 0.95999086, 'auroc': 0.9985199, 'binary_precision': 0.99406576, 'binary_recall': 0.9984846, 'binary_specificity': 0.8836292, 'binary_f1_score': 0.9962703}
confusion matrix:
      0      1
0  1344    177
1    45  29650
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.82190466, 'recall': 0.791065, 'specificity': 0.791065, 'f1': 0.78378963, 'auroc': 0.9310194, 'binary_precision': 0.71394515, 'binary_recall': 0.9507936, 'binary_specificity': 0.6313364, 'binary_f1_score': 0.8155207}
confusion matrix:
     0    1
0  411  240
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284519, 'precision': 0.8288266, 'recall': 0.82663155, 'specificity': 0.82663155, 'f1': 0.8273608, 'auroc': 0.92312694, 'binary_precision': 0.82509506, 'binary_recall': 0.8577075, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.8410853}
confusion matrix:
     0    1
0  179   46
1   36  217
early stop counter: 1
val acc:0.7884465456008911, best validation acc: 0.8423106670379639, corresponding to test acc:                         0.8138075470924377 / 0.8326359987258911
after epoch: 6,now: 2024-07-11 03:48:49.455415,epoch time: 0:10:42.641546,used: 1:04:30.496747,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99384934, 'precision': 0.96308833, 'recall': 0.97117424, 'specificity': 0.97117424, 'f1': 0.96709216, 'auroc': 0.9988984, 'binary_precision': 0.9972361, 'binary_recall': 0.9962958, 'binary_specificity': 0.9460526, 'binary_f1_score': 0.99676573}
confusion matrix:
      0      1
0  1438     82
1   110  29586
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8489542, 'recall': 0.83543265, 'specificity': 0.83543265, 'f1': 0.8323489, 'auroc': 0.9410651, 'binary_precision': 0.7718383, 'binary_recall': 0.93968254, 'binary_specificity': 0.7311828, 'binary_f1_score': 0.84753036}
confusion matrix:
     0    1
0  476  175
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80753136, 'precision': 0.81519926, 'recall': 0.80244184, 'specificity': 0.80244184, 'f1': 0.804018, 'auroc': 0.89501977, 'binary_precision': 0.7785467, 'binary_recall': 0.88932806, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.83025825}
confusion matrix:
     0    1
0  161   64
1   28  225
early stop counter: 2
val acc:0.8337236642837524, best validation acc: 0.8423106670379639, corresponding to test acc:                         0.8138075470924377 / 0.8326359987258911
after epoch: 7,now: 2024-07-11 03:59:35.454509,epoch time: 0:10:45.999094,used: 1:15:16.495841,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99333674, 'precision': 0.95347023, 'recall': 0.97716033, 'specificity': 0.97716033, 'f1': 0.964977, 'auroc': 0.99905896, 'binary_precision': 0.9979062, 'binary_recall': 0.99508333, 'binary_specificity': 0.95923734, 'binary_f1_score': 0.9964928}
confusion matrix:
      0      1
0  1459     62
1   146  29549
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.86178565, 'recall': 0.85737324, 'specificity': 0.85737324, 'f1': 0.85603577, 'auroc': 0.93743694, 'binary_precision': 0.81320226, 'binary_recall': 0.9190476, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.8628912}
confusion matrix:
     0    1
0  518  133
1   51  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83054394, 'precision': 0.82996917, 'recall': 0.8308213, 'specificity': 0.8308213, 'f1': 0.8302162, 'auroc': 0.9013263, 'binary_precision': 0.8495935, 'binary_recall': 0.82608694, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.8376754}
confusion matrix:
     0    1
0  188   37
1   44  209
better model found
persisted
after epoch: 8,now: 2024-07-11 04:10:20.564339,epoch time: 0:10:45.109830,used: 1:26:01.605671,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9925679, 'precision': 0.97338784, 'recall': 0.94494313, 'specificity': 0.94494313, 'f1': 0.95867455, 'auroc': 0.99843544, 'binary_precision': 0.994495, 'binary_recall': 0.99771005, 'binary_specificity': 0.8921762, 'binary_f1_score': 0.9960999}
confusion matrix:
      0      1
0  1357    164
1    68  29627
---- Validation: 
scalar performance:
{'acc': 0.81576896, 'precision': 0.8382369, 'recall': 0.8178699, 'specificity': 0.8178699, 'f1': 0.8133105, 'auroc': 0.9408041, 'binary_precision': 0.7468672, 'binary_recall': 0.94603175, 'binary_specificity': 0.6897081, 'binary_f1_score': 0.8347339}
confusion matrix:
     0    1
0  449  202
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.86035126, 'recall': 0.85824335, 'specificity': 0.85824335, 'f1': 0.8589877, 'auroc': 0.9306983, 'binary_precision': 0.8549618, 'binary_recall': 0.8853755, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.86990285}
confusion matrix:
     0    1
0  187   38
1   29  224
new oracle model saved
early stop counter: 1
val acc:0.8157689571380615, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8305439352989197 / 0.8598326444625854
after epoch: 9,now: 2024-07-11 04:21:05.045816,epoch time: 0:10:44.481477,used: 1:36:46.087148,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9902614, 'precision': 0.9794795, 'recall': 0.9131653, 'specificity': 0.9131653, 'f1': 0.9435876, 'auroc': 0.9987922, 'binary_precision': 0.9912419, 'binary_recall': 0.99858564, 'binary_specificity': 0.8277449, 'binary_f1_score': 0.9949002}
confusion matrix:
      0      1
0  1259    262
1    42  29653
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.8471532, 'recall': 0.832386, 'specificity': 0.832386, 'f1': 0.82905054, 'auroc': 0.94067246, 'binary_precision': 0.767141, 'binary_recall': 0.9412698, 'binary_specificity': 0.7235023, 'binary_f1_score': 0.84533143}
confusion matrix:
     0    1
0  471  180
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80753136, 'precision': 0.81432766, 'recall': 0.80268776, 'specificity': 0.80268776, 'f1': 0.8042379, 'auroc': 0.9063505, 'binary_precision': 0.7804878, 'binary_recall': 0.8853755, 'binary_specificity': 0.72, 'binary_f1_score': 0.82962966}
confusion matrix:
     0    1
0  162   63
1   29  224
early stop counter: 2
val acc:0.8306010961532593, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8305439352989197 / 0.8598326444625854
after epoch: 10,now: 2024-07-11 04:31:49.615031,epoch time: 0:10:44.569215,used: 1:47:30.656363,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99186313, 'precision': 0.96934354, 'recall': 0.94114184, 'specificity': 0.94114184, 'f1': 0.9547557, 'auroc': 0.998415, 'binary_precision': 0.9941257, 'binary_recall': 0.9973396, 'binary_specificity': 0.88494414, 'binary_f1_score': 0.99573004}
confusion matrix:
      0      1
0  1346    175
1    79  29616
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.84589684, 'recall': 0.82862264, 'specificity': 0.82862264, 'f1': 0.82480943, 'auroc': 0.9400928, 'binary_precision': 0.7602041, 'binary_recall': 0.94603175, 'binary_specificity': 0.7112135, 'binary_f1_score': 0.84299856}
confusion matrix:
     0    1
0  463  188
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8179916, 'precision': 0.82760715, 'recall': 0.81256914, 'specificity': 0.81256914, 'f1': 0.81434405, 'auroc': 0.9193852, 'binary_precision': 0.78424656, 'binary_recall': 0.9051383, 'binary_specificity': 0.72, 'binary_f1_score': 0.84036696}
confusion matrix:
     0    1
0  162   63
1   24  229
early stop counter: 3
val acc:0.8266978859901428, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8305439352989197 / 0.8598326444625854
after epoch: 11,now: 2024-07-11 04:42:34.499159,epoch time: 0:10:44.884128,used: 1:58:15.540491,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9925359, 'precision': 0.9471776, 'recall': 0.97580373, 'specificity': 0.97580373, 'f1': 0.960992, 'auroc': 0.99875665, 'binary_precision': 0.99780345, 'binary_recall': 0.9943425, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.9960699}
confusion matrix:
      0      1
0  1456     65
1   168  29527
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.84006464, 'recall': 0.8283154, 'specificity': 0.8283154, 'f1': 0.82543397, 'auroc': 0.9305318, 'binary_precision': 0.76842105, 'binary_recall': 0.92698413, 'binary_specificity': 0.7296467, 'binary_f1_score': 0.84028774}
confusion matrix:
     0    1
0  475  176
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8158996, 'precision': 0.820655, 'recall': 0.8118226, 'specificity': 0.8118226, 'f1': 0.81333756, 'auroc': 0.89667106, 'binary_precision': 0.7935943, 'binary_recall': 0.88142294, 'binary_specificity': 0.74222225, 'binary_f1_score': 0.835206}
confusion matrix:
     0    1
0  167   58
1   30  223
early stop counter: 4
val acc:0.8266978859901428, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8305439352989197 / 0.8598326444625854
after epoch: 12,now: 2024-07-11 04:53:17.106582,epoch time: 0:10:42.607423,used: 2:08:58.147914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99388134, 'precision': 0.9861825, 'recall': 0.94688106, 'specificity': 0.94688106, 'f1': 0.96561134, 'auroc': 0.99924755, 'binary_precision': 0.99463516, 'binary_recall': 0.998956, 'binary_specificity': 0.894806, 'binary_f1_score': 0.9967909}
confusion matrix:
      0      1
0  1361    160
1    31  29664
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.87347925, 'recall': 0.8669227, 'specificity': 0.8669227, 'f1': 0.865268, 'auroc': 0.94810915, 'binary_precision': 0.815427, 'binary_recall': 0.93968254, 'binary_specificity': 0.7941628, 'binary_f1_score': 0.8731563}
confusion matrix:
     0    1
0  517  134
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88075316, 'precision': 0.8804454, 'recall': 0.8816952, 'specificity': 0.8816952, 'f1': 0.8806021, 'auroc': 0.9294203, 'binary_precision': 0.90495867, 'binary_recall': 0.8656126, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.88484854}
confusion matrix:
     0    1
0  202   23
1   34  219
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-11 05:04:00.612907,epoch time: 0:10:43.506325,used: 2:19:41.654239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99506664, 'precision': 0.96409315, 'recall': 0.98430747, 'specificity': 0.98430747, 'f1': 0.9739591, 'auroc': 0.99958026, 'binary_precision': 0.9985823, 'binary_recall': 0.99622834, 'binary_specificity': 0.9723866, 'binary_f1_score': 0.997404}
confusion matrix:
      0      1
0  1479     42
1   112  29583
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.8275858, 'recall': 0.7965182, 'specificity': 0.7965182, 'f1': 0.7894236, 'auroc': 0.93273103, 'binary_precision': 0.7183771, 'binary_recall': 0.95555556, 'binary_specificity': 0.6374808, 'binary_f1_score': 0.8201635}
confusion matrix:
     0    1
0  415  236
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866109, 'precision': 0.80697066, 'recall': 0.77849805, 'specificity': 0.77849805, 'f1': 0.7791248, 'auroc': 0.8750812, 'binary_precision': 0.74121404, 'binary_recall': 0.91699606, 'binary_specificity': 0.64, 'binary_f1_score': 0.81978804}
confusion matrix:
     0    1
0  144   81
1   21  232
early stop counter: 1
val acc:0.7939109802246094, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8807531595230103 / 0.8807531595230103
after epoch: 14,now: 2024-07-11 05:14:44.224788,epoch time: 0:10:43.611881,used: 2:30:25.266120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9933047, 'precision': 0.94788766, 'recall': 0.98431706, 'specificity': 0.98431706, 'f1': 0.96530247, 'auroc': 0.99931693, 'binary_precision': 0.99868083, 'binary_recall': 0.99427515, 'binary_specificity': 0.974359, 'binary_f1_score': 0.9964732}
confusion matrix:
      0      1
0  1482     39
1   170  29525
---- Validation: 
scalar performance:
{'acc': 0.7962529, 'precision': 0.83279544, 'recall': 0.7989503, 'specificity': 0.7989503, 'f1': 0.7914702, 'auroc': 0.9430498, 'binary_precision': 0.7183432, 'binary_recall': 0.96349204, 'binary_specificity': 0.6344086, 'binary_f1_score': 0.82305086}
confusion matrix:
     0    1
0  413  238
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7552301, 'precision': 0.771625, 'recall': 0.7471322, 'specificity': 0.7471322, 'f1': 0.7468439, 'auroc': 0.8625033, 'binary_precision': 0.71794873, 'binary_recall': 0.8853755, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.7929204}
confusion matrix:
     0    1
0  137   88
1   29  224
early stop counter: 2
val acc:0.7962529063224792, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8807531595230103 / 0.8807531595230103
after epoch: 15,now: 2024-07-11 05:25:29.561535,epoch time: 0:10:45.336747,used: 2:41:10.602867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9949705, 'precision': 0.96022296, 'recall': 0.98799324, 'specificity': 0.98799324, 'f1': 0.9736522, 'auroc': 0.9995609, 'binary_precision': 0.9989864, 'binary_recall': 0.9957233, 'binary_specificity': 0.9802632, 'binary_f1_score': 0.9973522}
confusion matrix:
      0      1
0  1490     30
1   127  29569
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.83066165, 'recall': 0.80785966, 'specificity': 0.80785966, 'f1': 0.8026178, 'auroc': 0.93840003, 'binary_precision': 0.7354759, 'binary_recall': 0.9444444, 'binary_specificity': 0.67127496, 'binary_f1_score': 0.8269631}
confusion matrix:
     0    1
0  437  214
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80753136, 'precision': 0.8074404, 'recall': 0.80588496, 'specificity': 0.80588496, 'f1': 0.80643344, 'auroc': 0.8808432, 'binary_precision': 0.8084291, 'binary_recall': 0.8339921, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8210117}
confusion matrix:
     0    1
0  175   50
1   42  211
early stop counter: 3
val acc:0.8056206107139587, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8807531595230103 / 0.8807531595230103
after epoch: 16,now: 2024-07-11 05:36:14.646689,epoch time: 0:10:45.085154,used: 2:51:55.688021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9958355, 'precision': 0.9778223, 'recall': 0.97722614, 'specificity': 0.97722614, 'f1': 0.97752404, 'auroc': 0.999455, 'binary_precision': 0.9977776, 'binary_recall': 0.99784476, 'binary_specificity': 0.9566075, 'binary_f1_score': 0.99781114}
confusion matrix:
      0      1
0  1455     66
1    64  29631
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.87483025, 'recall': 0.86336404, 'specificity': 0.86336404, 'f1': 0.8609451, 'auroc': 0.9492508, 'binary_precision': 0.8007968, 'binary_recall': 0.95714283, 'binary_specificity': 0.76958525, 'binary_f1_score': 0.8720174}
confusion matrix:
     0    1
0  501  150
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.8309978, 'recall': 0.8170136, 'specificity': 0.8170136, 'f1': 0.81882554, 'auroc': 0.92542815, 'binary_precision': 0.78965515, 'binary_recall': 0.9051383, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.8434622}
confusion matrix:
     0    1
0  164   61
1   24  229
early stop counter: 4
val acc:0.8618267178535461, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8807531595230103 / 0.8807531595230103
after epoch: 17,now: 2024-07-11 05:47:00.037834,epoch time: 0:10:45.391145,used: 3:02:41.079166,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9954831, 'precision': 0.9915803, 'recall': 0.95926297, 'specificity': 0.95926297, 'f1': 0.97481096, 'auroc': 0.9996004, 'binary_precision': 0.9958725, 'binary_recall': 0.9993938, 'binary_specificity': 0.9191322, 'binary_f1_score': 0.99763006}
confusion matrix:
      0      1
0  1398    123
1    18  29677
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8430399, 'recall': 0.8188172, 'specificity': 0.8188172, 'f1': 0.81364226, 'auroc': 0.95455647, 'binary_precision': 0.7435265, 'binary_recall': 0.95714283, 'binary_specificity': 0.68049157, 'binary_f1_score': 0.83691883}
confusion matrix:
     0    1
0  443  208
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8033473, 'precision': 0.818331, 'recall': 0.7965218, 'specificity': 0.7965218, 'f1': 0.79796755, 'auroc': 0.9351252, 'binary_precision': 0.76237625, 'binary_recall': 0.9130435, 'binary_specificity': 0.68, 'binary_f1_score': 0.8309352}
confusion matrix:
     0    1
0  153   72
1   22  231
early stop counter: 5
val acc:0.8165495991706848, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8807531595230103 / 0.8807531595230103
after epoch: 18,now: 2024-07-11 05:57:43.260413,epoch time: 0:10:43.222579,used: 3:13:24.301745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99593157, 'precision': 0.97992265, 'recall': 0.97602904, 'specificity': 0.97602904, 'f1': 0.977967, 'auroc': 0.9995318, 'binary_precision': 0.9976437, 'binary_recall': 0.9980805, 'binary_specificity': 0.95397764, 'binary_f1_score': 0.99786204}
confusion matrix:
      0      1
0  1451     70
1    57  29638
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8624469, 'recall': 0.8479519, 'specificity': 0.8479519, 'f1': 0.84489775, 'auroc': 0.95132333, 'binary_precision': 0.78153443, 'binary_recall': 0.9539682, 'binary_specificity': 0.7419355, 'binary_f1_score': 0.8591851}
confusion matrix:
     0    1
0  483  168
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8033473, 'precision': 0.82242775, 'recall': 0.79578394, 'specificity': 0.79578394, 'f1': 0.79708076, 'auroc': 0.9219675, 'binary_precision': 0.75728154, 'binary_recall': 0.9249012, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.8327402}
confusion matrix:
     0    1
0  150   75
1   19  234
early stop counter: 6
val acc:0.8462138772010803, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8807531595230103 / 0.8807531595230103
after epoch: 19,now: 2024-07-11 06:08:27.465893,epoch time: 0:10:44.205480,used: 3:24:08.507225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99625194, 'precision': 0.9784888, 'recall': 0.9811761, 'specificity': 0.9811761, 'f1': 0.9798283, 'auroc': 0.9996315, 'binary_precision': 0.99818105, 'binary_recall': 0.9978785, 'binary_specificity': 0.96447366, 'binary_f1_score': 0.99802977}
confusion matrix:
      0      1
0  1466     54
1    63  29633
---- Validation: 
scalar performance:
{'acc': 0.9032006, 'precision': 0.903411, 'recall': 0.9034306, 'specificity': 0.9034306, 'f1': 0.9032005, 'auroc': 0.95716476, 'binary_precision': 0.8892308, 'binary_recall': 0.9174603, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.903125}
confusion matrix:
     0    1
0  579   72
1   52  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8678359, 'recall': 0.86439174, 'specificity': 0.86439174, 'f1': 0.8597289, 'auroc': 0.9229162, 'binary_precision': 0.9386792, 'binary_recall': 0.78656125, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.85591394}
confusion matrix:
     0    1
0  212   13
1   54  199
better model found
persisted
after epoch: 20,now: 2024-07-11 06:19:10.106752,epoch time: 0:10:42.640859,used: 3:34:51.148084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9960917, 'precision': 0.9854021, 'recall': 0.97205865, 'specificity': 0.97205865, 'f1': 0.9786267, 'auroc': 0.9996383, 'binary_precision': 0.9972091, 'binary_recall': 0.9986867, 'binary_specificity': 0.94543064, 'binary_f1_score': 0.9979473}
confusion matrix:
      0      1
0  1438     83
1    39  29656
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8696351, 'recall': 0.8637481, 'specificity': 0.8637481, 'f1': 0.8621839, 'auroc': 0.9452027, 'binary_precision': 0.8144044, 'binary_recall': 0.93333334, 'binary_specificity': 0.7941628, 'binary_f1_score': 0.8698225}
confusion matrix:
     0    1
0  517  134
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8410042, 'precision': 0.8523005, 'recall': 0.84635925, 'specificity': 0.84635925, 'f1': 0.8407253, 'auroc': 0.90427756, 'binary_precision': 0.9317073, 'binary_recall': 0.7549407, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8340611}
confusion matrix:
     0    1
0  211   14
1   62  191
early stop counter: 1
val acc:0.8626073598861694, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8807531595230103
after epoch: 21,now: 2024-07-11 06:29:54.279012,epoch time: 0:10:44.172260,used: 3:45:35.320344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99573934, 'precision': 0.9729777, 'recall': 0.9815309, 'specificity': 0.9815309, 'f1': 0.9772115, 'auroc': 0.99959433, 'binary_precision': 0.9982472, 'binary_recall': 0.9972724, 'binary_specificity': 0.9657895, 'binary_f1_score': 0.9977595}
confusion matrix:
      0      1
0  1468     52
1    81  29615
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.8785335, 'recall': 0.87378395, 'specificity': 0.87378395, 'f1': 0.8724569, 'auroc': 0.9443786, 'binary_precision': 0.8274895, 'binary_recall': 0.93650794, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.87863}
confusion matrix:
     0    1
0  528  123
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.8742581, 'recall': 0.8755204, 'specificity': 0.8755204, 'f1': 0.8743362, 'auroc': 0.91457176, 'binary_precision': 0.90041494, 'binary_recall': 0.8577075, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.87854254}
confusion matrix:
     0    1
0  201   24
1   36  217
early stop counter: 2
val acc:0.8727556467056274, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8807531595230103
after epoch: 22,now: 2024-07-11 06:40:38.887138,epoch time: 0:10:44.608126,used: 3:56:19.928470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9952909, 'precision': 0.9698143, 'recall': 0.9800588, 'specificity': 0.9800588, 'f1': 0.97487473, 'auroc': 0.9996269, 'binary_precision': 0.99811196, 'binary_recall': 0.9969355, 'binary_specificity': 0.9631821, 'binary_f1_score': 0.99752337}
confusion matrix:
      0      1
0  1465     56
1    91  29604
---- Validation: 
scalar performance:
{'acc': 0.88602656, 'precision': 0.8868481, 'recall': 0.8864311, 'specificity': 0.8864311, 'f1': 0.8860148, 'auroc': 0.9431814, 'binary_precision': 0.86445785, 'binary_recall': 0.9111111, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.88717157}
confusion matrix:
     0    1
0  561   90
1   56  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.8658165, 'recall': 0.85574, 'specificity': 0.85574, 'f1': 0.8488538, 'auroc': 0.91204214, 'binary_precision': 0.9593909, 'binary_recall': 0.74703556, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.84000003}
confusion matrix:
     0    1
0  217    8
1   64  189
early stop counter: 3
val acc:0.8860265612602234, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8807531595230103
after epoch: 23,now: 2024-07-11 06:51:22.884846,epoch time: 0:10:43.997708,used: 4:07:03.926178,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9943298, 'precision': 0.9717543, 'recall': 0.96674514, 'specificity': 0.96674514, 'f1': 0.9692348, 'auroc': 0.99930096, 'binary_precision': 0.99673545, 'binary_recall': 0.99730605, 'binary_specificity': 0.9361842, 'binary_f1_score': 0.9970207}
confusion matrix:
      0      1
0  1423     97
1    80  29616
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.8771466, 'recall': 0.8736559, 'specificity': 0.8736559, 'f1': 0.87254566, 'auroc': 0.9397435, 'binary_precision': 0.83214796, 'binary_recall': 0.9285714, 'binary_specificity': 0.8187404, 'binary_f1_score': 0.87771946}
confusion matrix:
     0    1
0  533  118
1   45  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8849372, 'precision': 0.88972867, 'recall': 0.88859904, 'specificity': 0.88859904, 'f1': 0.88492465, 'auroc': 0.92432153, 'binary_precision': 0.95, 'binary_recall': 0.82608694, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.88372093}
confusion matrix:
     0    1
0  214   11
1   44  209
new oracle model saved
early stop counter: 4
val acc:0.8727556467056274, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 24,now: 2024-07-11 07:02:09.055465,epoch time: 0:10:46.170619,used: 4:17:50.096797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99570733, 'precision': 0.9901114, 'recall': 0.96312356, 'specificity': 0.96312356, 'f1': 0.9761924, 'auroc': 0.9997305, 'binary_precision': 0.99627304, 'binary_recall': 0.99922544, 'binary_specificity': 0.9270217, 'binary_f1_score': 0.99774706}
confusion matrix:
      0      1
0  1410    111
1    23  29672
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.87568307, 'recall': 0.8670763, 'specificity': 0.8670763, 'f1': 0.86510766, 'auroc': 0.9476849, 'binary_precision': 0.8102981, 'binary_recall': 0.94920635, 'binary_specificity': 0.78494626, 'binary_f1_score': 0.87426895}
confusion matrix:
     0    1
0  511  140
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.85305226, 'recall': 0.85305226, 'specificity': 0.85305226, 'f1': 0.85305226, 'auroc': 0.90933686, 'binary_precision': 0.86166006, 'binary_recall': 0.86166006, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.86166006}
confusion matrix:
     0    1
0  190   35
1   35  218
early stop counter: 5
val acc:0.8657299280166626, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 25,now: 2024-07-11 07:12:54.289132,epoch time: 0:10:45.233667,used: 4:28:35.330464,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9948424, 'precision': 0.9564914, 'recall': 0.99136317, 'specificity': 0.99136317, 'f1': 0.97320735, 'auroc': 0.9996267, 'binary_precision': 0.9993575, 'binary_recall': 0.99521804, 'binary_specificity': 0.98750824, 'binary_f1_score': 0.9972835}
confusion matrix:
      0      1
0  1502     19
1   142  29553
---- Validation: 
scalar performance:
{'acc': 0.9008587, 'precision': 0.9015284, 'recall': 0.9005376, 'specificity': 0.9005376, 'f1': 0.9007416, 'auroc': 0.95062053, 'binary_precision': 0.9143328, 'binary_recall': 0.88095236, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.8973322}
confusion matrix:
     0    1
0  599   52
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.8821862, 'recall': 0.8789636, 'specificity': 0.8789636, 'f1': 0.8743979, 'auroc': 0.94573563, 'binary_precision': 0.9530516, 'binary_recall': 0.80237156, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.87124467}
confusion matrix:
     0    1
0  215   10
1   50  203
early stop counter: 6
val acc:0.9008587002754211, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 26,now: 2024-07-11 07:23:37.945518,epoch time: 0:10:43.656386,used: 4:39:18.986850,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99599564, 'precision': 0.9799813, 'recall': 0.97668654, 'specificity': 0.97668654, 'f1': 0.9783276, 'auroc': 0.99965715, 'binary_precision': 0.9977109, 'binary_recall': 0.9980805, 'binary_specificity': 0.9552926, 'binary_f1_score': 0.99789566}
confusion matrix:
      0      1
0  1453     68
1    57  29638
---- Validation: 
scalar performance:
{'acc': 0.891491, 'precision': 0.89226305, 'recall': 0.89188427, 'specificity': 0.89188427, 'f1': 0.8914815, 'auroc': 0.94587564, 'binary_precision': 0.8702866, 'binary_recall': 0.915873, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.89249814}
confusion matrix:
     0    1
0  565   86
1   53  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.8721699, 'recall': 0.8727975, 'specificity': 0.8727975, 'f1': 0.8702837, 'auroc': 0.9270092, 'binary_precision': 0.9170306, 'binary_recall': 0.8300395, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.87136924}
confusion matrix:
     0    1
0  206   19
1   43  210
early stop counter: 7
val acc:0.8914909958839417, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 27,now: 2024-07-11 07:34:22.483146,epoch time: 0:10:44.537628,used: 4:50:03.524478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9949705, 'precision': 0.96602714, 'recall': 0.98082614, 'specificity': 0.98082614, 'f1': 0.9732972, 'auroc': 0.9994298, 'binary_precision': 0.9982121, 'binary_recall': 0.99649775, 'binary_specificity': 0.9651545, 'binary_f1_score': 0.9973542}
confusion matrix:
      0      1
0  1468     53
1   104  29591
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.8393611, 'recall': 0.82311827, 'specificity': 0.82311827, 'f1': 0.8193732, 'auroc': 0.93804157, 'binary_precision': 0.75672215, 'binary_recall': 0.9380952, 'binary_specificity': 0.7081413, 'binary_f1_score': 0.83770376}
confusion matrix:
     0    1
0  461  190
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79288703, 'precision': 0.7965909, 'recall': 0.78885376, 'specificity': 0.78885376, 'f1': 0.7901082, 'auroc': 0.8700746, 'binary_precision': 0.775, 'binary_recall': 0.8577075, 'binary_specificity': 0.72, 'binary_f1_score': 0.8142589}
confusion matrix:
     0    1
0  162   63
1   36  217
early stop counter: 8
val acc:0.8212333917617798, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 28,now: 2024-07-11 07:45:06.465546,epoch time: 0:10:43.982400,used: 5:00:47.506878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9946181, 'precision': 0.95360637, 'recall': 0.9924897, 'specificity': 0.9924897, 'f1': 0.9721506, 'auroc': 0.9996911, 'binary_precision': 0.9994925, 'binary_recall': 0.9948478, 'binary_specificity': 0.99013156, 'binary_f1_score': 0.9971647}
confusion matrix:
      0      1
0  1505     15
1   153  29543
---- Validation: 
scalar performance:
{'acc': 0.8891491, 'precision': 0.8901909, 'recall': 0.8887353, 'specificity': 0.8887353, 'f1': 0.8889731, 'auroc': 0.94014335, 'binary_precision': 0.9066667, 'binary_recall': 0.8634921, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.88455284}
confusion matrix:
     0    1
0  595   56
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.88188964, 'recall': 0.867097, 'specificity': 0.867097, 'f1': 0.8590771, 'auroc': 0.94731665, 'binary_precision': 0.9894737, 'binary_recall': 0.743083, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.84875846}
confusion matrix:
     0    1
0  223    2
1   65  188
early stop counter: 9
val acc:0.8891491293907166, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 29,now: 2024-07-11 07:55:54.363351,epoch time: 0:10:47.897805,used: 5:11:35.404683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9958675, 'precision': 0.9736734, 'recall': 0.9822333, 'specificity': 0.9822333, 'f1': 0.9779105, 'auroc': 0.9996234, 'binary_precision': 0.99831456, 'binary_recall': 0.9973396, 'binary_specificity': 0.9671269, 'binary_f1_score': 0.9978269}
confusion matrix:
      0      1
0  1471     50
1    79  29616
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8656254, 'recall': 0.8626728, 'specificity': 0.8626728, 'f1': 0.86163235, 'auroc': 0.92712307, 'binary_precision': 0.82403433, 'binary_recall': 0.9142857, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.8668171}
confusion matrix:
     0    1
0  528  123
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7656904, 'precision': 0.7855817, 'recall': 0.7729996, 'specificity': 0.7729996, 'f1': 0.76420015, 'auroc': 0.87861216, 'binary_precision': 0.87700534, 'binary_recall': 0.6482214, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.74545455}
confusion matrix:
     0    1
0  202   23
1   89  164
early stop counter: 10
val acc:0.8618267178535461, best validation acc: 0.903200626373291, corresponding to test acc:                         0.8598326444625854 / 0.8849372267723083
after epoch: 30,now: 2024-07-11 08:06:37.747056,epoch time: 0:10:43.383705,used: 5:22:18.788388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_02_44_18_seed_1_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:22:18.788388 at 2024-07-11 08:06:37.747056
persisted model performance metric: 

scalar performance:
{'acc': 0.85983264, 'precision': 0.8678359, 'recall': 0.86439174, 'specificity': 0.86439174, 'f1': 0.8597289, 'auroc': 0.9229162, 'binary_precision': 0.9386792, 'binary_recall': 0.78656125, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.85591394}
confusion matrix:
     0    1
0  212   13
1   54  199
oracle model performance metric: 

scalar performance:
{'acc': 0.8849372, 'precision': 0.88972867, 'recall': 0.88859904, 'specificity': 0.88859904, 'f1': 0.88492465, 'auroc': 0.92432153, 'binary_precision': 0.95, 'binary_recall': 0.82608694, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.88372093}
confusion matrix:
     0    1
0  214   11
1   44  209
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB | 718208 GiB | 718207 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB | 718208 GiB | 718207 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |  40408 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  28072 MiB |  13598 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1253 MiB | 540838 GiB | 540838 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 531179 GiB | 531178 GiB |
|       from small pool |  12646 KiB |     46 MiB |   9659 GiB |   9659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4907    |  135898 K  |  135897 K  |
|       from large pool |     187    |    1413    |   64884 K  |   64883 K  |
|       from small pool |    1129    |    4718    |   71014 K  |   71013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4907    |  135898 K  |  135897 K  |
|       from large pool |     187    |    1413    |   64884 K  |   64883 K  |
|       from small pool |    1129    |    4718    |   71014 K  |   71013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1205    |     571    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |    2023    |   81412 K  |   81412 K  |
|       from large pool |      40    |     604    |   46075 K  |   46075 K  |
|       from small pool |      59    |    1981    |   35337 K  |   35337 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 718208 GiB | 718208 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 718208 GiB | 718208 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |      0 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 540838 GiB | 540838 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531179 GiB | 531179 GiB |
|       from small pool |      0 KiB |     46 MiB |   9659 GiB |   9659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71014 K  |   71014 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71014 K  |   71014 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2023    |   81412 K  |   81412 K  |
|       from large pool |       4    |     604    |   46075 K  |   46075 K  |
|       from small pool |       0    |    1981    |   35337 K  |   35337 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 718208 GiB | 718208 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 718208 GiB | 718208 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |      0 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 540838 GiB | 540838 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531179 GiB | 531179 GiB |
|       from small pool |      0 KiB |     46 MiB |   9659 GiB |   9659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71014 K  |   71014 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71014 K  |   71014 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2023    |   81412 K  |   81412 K  |
|       from large pool |       4    |     604    |   46075 K  |   46075 K  |
|       from small pool |       0    |    1981    |   35337 K  |   35337 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147

 Experiment start at: 2024-07-11 08:20:23.127449
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9850204, 'precision': 0.9804113, 'recall': 0.8534397, 'specificity': 0.8534397, 'f1': 0.9062604, 'auroc': 0.99578863, 'binary_precision': 0.98536795, 'binary_recall': 0.9990958, 'binary_specificity': 0.70778364, 'binary_f1_score': 0.9921844}
confusion matrix:
      0      1
0  1073    443
1    27  29833
---- Validation: 
scalar performance:
{'acc': 0.48982784, 'precision': 0.744113, 'recall': 0.5030488, 'specificity': 0.5030488, 'f1': 0.33411968, 'auroc': 0.8501227, 'binary_precision': 0.48822606, 'binary_recall': 1.0, 'binary_specificity': 0.0060975607, 'binary_f1_score': 0.65611815}
confusion matrix:
   0    1
0  4  652
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5473684, 'precision': 0.7732067, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.35795075, 'auroc': 0.85576653, 'binary_precision': 0.5464135, 'binary_recall': 1.0, 'binary_specificity': 0.0046296297, 'binary_f1_score': 0.7066849}
confusion matrix:
   0    1
0  1  215
1  0  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 08:31:15.311600,epoch time: 0:10:52.184151,used: 0:10:52.184151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9906298, 'precision': 0.96932673, 'recall': 0.9262015, 'specificity': 0.9262015, 'f1': 0.946609, 'auroc': 0.9976436, 'binary_precision': 0.99266815, 'binary_recall': 0.99752176, 'binary_specificity': 0.8548813, 'binary_f1_score': 0.99508905}
confusion matrix:
      0      1
0  1296    220
1    74  29786
---- Validation: 
scalar performance:
{'acc': 0.52895147, 'precision': 0.691646, 'recall': 0.5407836, 'specificity': 0.5407836, 'f1': 0.42187765, 'auroc': 0.7959297, 'binary_precision': 0.5082919, 'binary_recall': 0.98553056, 'binary_specificity': 0.09603658, 'binary_f1_score': 0.6706784}
confusion matrix:
    0    1
0  63  593
1   9  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5557895, 'precision': 0.7042124, 'recall': 0.51195836, 'specificity': 0.51195836, 'f1': 0.38178894, 'auroc': 0.7272093, 'binary_precision': 0.55128205, 'binary_recall': 0.996139, 'binary_specificity': 0.027777778, 'binary_f1_score': 0.7097662}
confusion matrix:
   0    1
0  6  210
1  1  258
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 08:42:04.244813,epoch time: 0:10:48.933213,used: 0:21:41.117364,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9886219, 'precision': 0.9428635, 'recall': 0.93203413, 'specificity': 0.93203413, 'f1': 0.9373738, 'auroc': 0.9970404, 'binary_precision': 0.9933777, 'binary_recall': 0.99467516, 'binary_specificity': 0.8693931, 'binary_f1_score': 0.994026}
confusion matrix:
      0      1
0  1318    198
1   159  29701
---- Validation: 
scalar performance:
{'acc': 0.6737089, 'precision': 0.77291185, 'recall': 0.68153965, 'specificity': 0.68153965, 'f1': 0.6467589, 'auroc': 0.90038776, 'binary_precision': 0.60158575, 'binary_recall': 0.97588426, 'binary_specificity': 0.3871951, 'binary_f1_score': 0.7443286}
confusion matrix:
     0    1
0  254  402
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7768421, 'precision': 0.8106077, 'recall': 0.76039433, 'specificity': 0.76039433, 'f1': 0.76189804, 'auroc': 0.8740705, 'binary_precision': 0.7283582, 'binary_recall': 0.94208497, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.8215489}
confusion matrix:
     0    1
0  125   91
1   15  244
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-11 08:52:51.105582,epoch time: 0:10:46.860769,used: 0:32:27.978133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9917772, 'precision': 0.94602257, 'recall': 0.9671904, 'specificity': 0.9671904, 'f1': 0.9563314, 'auroc': 0.998364, 'binary_precision': 0.99694467, 'binary_recall': 0.99440724, 'binary_specificity': 0.9399736, 'binary_f1_score': 0.9956744}
confusion matrix:
      0      1
0  1425     91
1   167  29693
---- Validation: 
scalar performance:
{'acc': 0.7198748, 'precision': 0.7883491, 'recall': 0.72621757, 'specificity': 0.72621757, 'f1': 0.70575047, 'auroc': 0.9270989, 'binary_precision': 0.64102566, 'binary_recall': 0.96463025, 'binary_specificity': 0.4878049, 'binary_f1_score': 0.7702183}
confusion matrix:
     0    1
0  320  336
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.8279344, 'recall': 0.8132329, 'specificity': 0.8132329, 'f1': 0.8163512, 'auroc': 0.8872801, 'binary_precision': 0.7979452, 'binary_recall': 0.8996139, 'binary_specificity': 0.7268519, 'binary_f1_score': 0.845735}
confusion matrix:
     0    1
0  157   59
1   26  233
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 09:03:38.057375,epoch time: 0:10:46.951793,used: 0:43:14.929926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9914266, 'precision': 0.96489924, 'recall': 0.9400822, 'specificity': 0.9400822, 'f1': 0.9521115, 'auroc': 0.9980856, 'binary_precision': 0.9940892, 'binary_recall': 0.996919, 'binary_specificity': 0.8832454, 'binary_f1_score': 0.9955021}
confusion matrix:
      0      1
0  1339    177
1    92  29768
---- Validation: 
scalar performance:
{'acc': 0.8231612, 'precision': 0.83144355, 'recall': 0.82524407, 'specificity': 0.82524407, 'f1': 0.8225981, 'auroc': 0.91997194, 'binary_precision': 0.771978, 'binary_recall': 0.903537, 'binary_specificity': 0.7469512, 'binary_f1_score': 0.8325926}
confusion matrix:
     0    1
0  490  166
1   60  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.83792806, 'recall': 0.8312956, 'specificity': 0.8312956, 'f1': 0.8207953, 'auroc': 0.9078901, 'binary_precision': 0.93939394, 'binary_recall': 0.71814674, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8140044}
confusion matrix:
     0    1
0  204   12
1   73  186
better model found
persisted
after epoch: 5,now: 2024-07-11 09:14:23.485158,epoch time: 0:10:45.427783,used: 0:54:00.357709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9949962, 'precision': 0.9723774, 'recall': 0.97326463, 'specificity': 0.97326463, 'f1': 0.9728205, 'auroc': 0.99924177, 'binary_precision': 0.997421, 'binary_recall': 0.99732083, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.9973709}
confusion matrix:
      0      1
0  1439     77
1    80  29780
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.8429862, 'recall': 0.8422575, 'specificity': 0.8422575, 'f1': 0.8424721, 'auroc': 0.92171204, 'binary_precision': 0.8479339, 'binary_recall': 0.8247588, 'binary_specificity': 0.8597561, 'binary_f1_score': 0.83618575}
confusion matrix:
     0    1
0  564   92
1  109  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.7770531, 'recall': 0.70502645, 'specificity': 0.70502645, 'f1': 0.664847, 'auroc': 0.9131274, 'binary_precision': 0.9652174, 'binary_recall': 0.42857143, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5935829}
confusion matrix:
     0    1
0  212    4
1  148  111
better model found
persisted
after epoch: 6,now: 2024-07-11 09:25:09.762002,epoch time: 0:10:46.276844,used: 1:04:46.634553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9912672, 'precision': 0.9682332, 'recall': 0.9346763, 'specificity': 0.9346763, 'f1': 0.95076036, 'auroc': 0.99754393, 'binary_precision': 0.9935277, 'binary_recall': 0.99732083, 'binary_specificity': 0.8720317, 'binary_f1_score': 0.99542063}
confusion matrix:
      0      1
0  1322    194
1    80  29780
---- Validation: 
scalar performance:
{'acc': 0.78716743, 'precision': 0.81697404, 'recall': 0.791183, 'specificity': 0.791183, 'f1': 0.783515, 'auroc': 0.92729247, 'binary_precision': 0.7128954, 'binary_recall': 0.94212216, 'binary_specificity': 0.6402439, 'binary_f1_score': 0.8116343}
confusion matrix:
     0    1
0  420  236
1   36  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77894735, 'precision': 0.80615354, 'recall': 0.7638621, 'specificity': 0.7638621, 'f1': 0.7659341, 'auroc': 0.91348493, 'binary_precision': 0.7347561, 'binary_recall': 0.93050194, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.8211244}
confusion matrix:
     0    1
0  129   87
1   18  241
early stop counter: 1
val acc:0.7871674299240112, best validation acc: 0.84272301197052, corresponding to test acc:                         0.6800000071525574 / 0.821052610874176
after epoch: 7,now: 2024-07-11 09:35:56.496236,epoch time: 0:10:46.734234,used: 1:15:33.368787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9933389, 'precision': 0.95046765, 'recall': 0.9805337, 'specificity': 0.9805337, 'f1': 0.96495616, 'auroc': 0.99915034, 'binary_precision': 0.9982859, 'binary_recall': 0.99470866, 'binary_specificity': 0.96635884, 'binary_f1_score': 0.99649405}
confusion matrix:
      0      1
0  1465     51
1   158  29702
---- Validation: 
scalar performance:
{'acc': 0.87089205, 'precision': 0.8751061, 'recall': 0.8694882, 'specificity': 0.8694882, 'f1': 0.87014395, 'auroc': 0.936853, 'binary_precision': 0.9087657, 'binary_recall': 0.81672025, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.8602879}
confusion matrix:
     0    1
0  605   51
1  114  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67368424, 'precision': 0.79110515, 'recall': 0.70077217, 'specificity': 0.70077217, 'f1': 0.65447414, 'auroc': 0.9398148, 'binary_precision': 1.0, 'binary_recall': 0.4015444, 'binary_specificity': 1.0, 'binary_f1_score': 0.57300276}
confusion matrix:
     0    1
0  216    0
1  155  104
better model found
persisted
after epoch: 8,now: 2024-07-11 09:46:44.027031,epoch time: 0:10:47.530795,used: 1:26:20.899582,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9940719, 'precision': 0.9821152, 'recall': 0.9524294, 'specificity': 0.9524294, 'f1': 0.9667479, 'auroc': 0.9992087, 'binary_precision': 0.99526006, 'binary_recall': 0.99852645, 'binary_specificity': 0.90633243, 'binary_f1_score': 0.99689054}
confusion matrix:
      0      1
0  1374    142
1    44  29816
---- Validation: 
scalar performance:
{'acc': 0.8489828, 'precision': 0.85023814, 'recall': 0.8498132, 'specificity': 0.8498132, 'f1': 0.8489716, 'auroc': 0.9229742, 'binary_precision': 0.82158923, 'binary_recall': 0.88102895, 'binary_specificity': 0.81859756, 'binary_f1_score': 0.8502715}
confusion matrix:
     0    1
0  537  119
1   74  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7831579, 'precision': 0.80903554, 'recall': 0.7957779, 'specificity': 0.7957779, 'f1': 0.7821693, 'auroc': 0.9082833, 'binary_precision': 0.92391306, 'binary_recall': 0.65637064, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.7674944}
confusion matrix:
     0    1
0  202   14
1   89  170
early stop counter: 1
val acc:0.8489828109741211, best validation acc: 0.8708920478820801, corresponding to test acc:                         0.6736842393875122 / 0.821052610874176
after epoch: 9,now: 2024-07-11 09:57:32.268214,epoch time: 0:10:48.241183,used: 1:37:09.140765,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9954424, 'precision': 0.9712129, 'recall': 0.97976047, 'specificity': 0.97976047, 'f1': 0.97544384, 'auroc': 0.9991224, 'binary_precision': 0.99808925, 'binary_recall': 0.9971199, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9976043}
confusion matrix:
      0      1
0  1459     57
1    86  29774
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.85851175, 'recall': 0.8545825, 'specificity': 0.8545825, 'f1': 0.85265124, 'auroc': 0.9341816, 'binary_precision': 0.80649716, 'binary_recall': 0.9180064, 'binary_specificity': 0.79115856, 'binary_f1_score': 0.85864663}
confusion matrix:
     0    1
0  519  137
1   51  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.8438597, 'recall': 0.8328328, 'specificity': 0.8328328, 'f1': 0.82051486, 'auroc': 0.9430681, 'binary_precision': 0.95789474, 'binary_recall': 0.7027027, 'binary_specificity': 0.962963, 'binary_f1_score': 0.8106904}
confusion matrix:
     0    1
0  208    8
1   77  182
early stop counter: 2
val acc:0.8528951406478882, best validation acc: 0.8708920478820801, corresponding to test acc:                         0.6736842393875122 / 0.821052610874176
after epoch: 10,now: 2024-07-11 10:08:17.752466,epoch time: 0:10:45.484252,used: 1:47:54.625017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.995283, 'precision': 0.9696896, 'recall': 0.9796767, 'specificity': 0.9796767, 'f1': 0.9746245, 'auroc': 0.99933505, 'binary_precision': 0.9980889, 'binary_recall': 0.9969525, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9975204}
confusion matrix:
      0      1
0  1459     57
1    91  29769
---- Validation: 
scalar performance:
{'acc': 0.8419405, 'precision': 0.85586035, 'recall': 0.8445784, 'specificity': 0.8445784, 'f1': 0.84100556, 'auroc': 0.94530636, 'binary_precision': 0.77851456, 'binary_recall': 0.9437299, 'binary_specificity': 0.74542683, 'binary_f1_score': 0.85319763}
confusion matrix:
     0    1
0  489  167
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.83992773, 'recall': 0.8363185, 'specificity': 0.8363185, 'f1': 0.82727575, 'auroc': 0.93813455, 'binary_precision': 0.9317073, 'binary_recall': 0.73745173, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.82327586}
confusion matrix:
     0    1
0  202   14
1   68  191
new oracle model saved
early stop counter: 3
val acc:0.8419405221939087, best validation acc: 0.8708920478820801, corresponding to test acc:                         0.6736842393875122 / 0.827368438243866
after epoch: 11,now: 2024-07-11 10:19:05.441815,epoch time: 0:10:47.689349,used: 1:58:42.314366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9954105, 'precision': 0.9685044, 'recall': 0.98256135, 'specificity': 0.98256135, 'f1': 0.9754168, 'auroc': 0.9994799, 'binary_precision': 0.9983899, 'binary_recall': 0.996785, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9975868}
confusion matrix:
      0      1
0  1468     48
1    96  29764
---- Validation: 
scalar performance:
{'acc': 0.8826291, 'precision': 0.88401365, 'recall': 0.8818377, 'specificity': 0.8818377, 'f1': 0.88229585, 'auroc': 0.9401003, 'binary_precision': 0.9013606, 'binary_recall': 0.85209006, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.87603307}
confusion matrix:
     0    1
0  598   58
1   92  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7705263, 'precision': 0.8124732, 'recall': 0.7865008, 'specificity': 0.7865008, 'f1': 0.7679552, 'auroc': 0.92276204, 'binary_precision': 0.9518072, 'binary_recall': 0.61003864, 'binary_specificity': 0.962963, 'binary_f1_score': 0.7435295}
confusion matrix:
     0    1
0  208    8
1  101  158
better model found
persisted
after epoch: 12,now: 2024-07-11 10:29:52.913426,epoch time: 0:10:47.471611,used: 2:09:29.785977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9929245, 'precision': 0.9773159, 'recall': 0.94431293, 'specificity': 0.94431293, 'f1': 0.96015704, 'auroc': 0.9988308, 'binary_precision': 0.9944611, 'binary_recall': 0.9981246, 'binary_specificity': 0.8905013, 'binary_f1_score': 0.9962895}
confusion matrix:
      0      1
0  1350    166
1    56  29804
---- Validation: 
scalar performance:
{'acc': 0.58763695, 'precision': 0.752866, 'recall': 0.59811485, 'specificity': 0.59811485, 'f1': 0.5189225, 'auroc': 0.91728103, 'binary_precision': 0.5417032, 'binary_recall': 0.9919614, 'binary_specificity': 0.20426829, 'binary_f1_score': 0.70073813}
confusion matrix:
     0    1
0  134  522
1    5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6063158, 'precision': 0.72718185, 'recall': 0.5690512, 'specificity': 0.5690512, 'f1': 0.49880093, 'auroc': 0.8417882, 'binary_precision': 0.5825688, 'binary_recall': 0.980695, 'binary_specificity': 0.1574074, 'binary_f1_score': 0.7309352}
confusion matrix:
    0    1
0  34  182
1   5  254
early stop counter: 1
val acc:0.5876369476318359, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.827368438243866
after epoch: 13,now: 2024-07-11 10:40:41.122807,epoch time: 0:10:48.209381,used: 2:20:17.995358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.993562, 'precision': 0.96182024, 'recall': 0.9687543, 'specificity': 0.9687543, 'f1': 0.96525836, 'auroc': 0.9990715, 'binary_precision': 0.997017, 'binary_recall': 0.9962157, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.9966162}
confusion matrix:
      0      1
0  1427     89
1   113  29747
---- Validation: 
scalar performance:
{'acc': 0.84741783, 'precision': 0.8481753, 'recall': 0.8480805, 'specificity': 0.8480805, 'f1': 0.847417, 'auroc': 0.9288304, 'binary_precision': 0.82397574, 'binary_recall': 0.87299037, 'binary_specificity': 0.8231707, 'binary_f1_score': 0.84777516}
confusion matrix:
     0    1
0  540  116
1   79  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71789473, 'precision': 0.7981427, 'recall': 0.7401598, 'specificity': 0.7401598, 'f1': 0.70856225, 'auroc': 0.92222583, 'binary_precision': 0.97709924, 'binary_recall': 0.49420848, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.6564102}
confusion matrix:
     0    1
0  213    3
1  131  128
early stop counter: 2
val acc:0.8474178314208984, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.827368438243866
after epoch: 14,now: 2024-07-11 10:51:31.894357,epoch time: 0:10:50.771550,used: 2:31:08.766908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9948687, 'precision': 0.96577466, 'recall': 0.97945905, 'specificity': 0.97945905, 'f1': 0.97250617, 'auroc': 0.9992541, 'binary_precision': 0.99808806, 'binary_recall': 0.99651706, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.997302}
confusion matrix:
      0      1
0  1459     57
1   104  29756
---- Validation: 
scalar performance:
{'acc': 0.8599374, 'precision': 0.86283433, 'recall': 0.85873413, 'specificity': 0.85873413, 'f1': 0.85928524, 'auroc': 0.9299608, 'binary_precision': 0.8892794, 'binary_recall': 0.8135048, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.84970605}
confusion matrix:
     0    1
0  593   63
1  116  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55368423, 'precision': 0.74214333, 'recall': 0.5903493, 'specificity': 0.5903493, 'f1': 0.4907351, 'auroc': 0.8835085, 'binary_precision': 0.97959185, 'binary_recall': 0.18532819, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.31168827}
confusion matrix:
     0   1
0  215   1
1  211  48
early stop counter: 3
val acc:0.8599374294281006, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.827368438243866
after epoch: 15,now: 2024-07-11 11:02:24.637545,epoch time: 0:10:52.743188,used: 2:42:01.510096,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9928289, 'precision': 0.97147095, 'recall': 0.9492718, 'specificity': 0.9492718, 'f1': 0.96007323, 'auroc': 0.99823093, 'binary_precision': 0.99498916, 'binary_recall': 0.99748826, 'binary_specificity': 0.9010554, 'binary_f1_score': 0.99623716}
confusion matrix:
      0      1
0  1366    150
1    75  29785
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.8335403, 'recall': 0.81337, 'specificity': 0.81337, 'f1': 0.8075162, 'auroc': 0.9279805, 'binary_precision': 0.7377666, 'binary_recall': 0.9453376, 'binary_specificity': 0.68140244, 'binary_f1_score': 0.82875264}
confusion matrix:
     0    1
0  447  209
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673684, 'precision': 0.867669, 'recall': 0.87069213, 'specificity': 0.87069213, 'f1': 0.8671328, 'auroc': 0.93940365, 'binary_precision': 0.91525424, 'binary_recall': 0.8339768, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8727272}
confusion matrix:
     0    1
0  196   20
1   43  216
new oracle model saved
early stop counter: 4
val acc:0.8098591566085815, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.8673684000968933
after epoch: 16,now: 2024-07-11 11:13:11.707045,epoch time: 0:10:47.069500,used: 2:52:48.579596,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9965579, 'precision': 0.97899437, 'recall': 0.98379034, 'specificity': 0.98379034, 'f1': 0.98137903, 'auroc': 0.99950206, 'binary_precision': 0.9984586, 'binary_recall': 0.9979237, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9981911}
confusion matrix:
      0      1
0  1470     46
1    62  29798
---- Validation: 
scalar performance:
{'acc': 0.87323946, 'precision': 0.8774292, 'recall': 0.8746912, 'specificity': 0.8746912, 'f1': 0.8731152, 'auroc': 0.94732773, 'binary_precision': 0.8304598, 'binary_recall': 0.92926043, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.8770865}
confusion matrix:
     0    1
0  538  118
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8084211, 'precision': 0.8322893, 'recall': 0.8204812, 'specificity': 0.8204812, 'f1': 0.8077531, 'auroc': 0.9206706, 'binary_precision': 0.9468085, 'binary_recall': 0.68725866, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7964206}
confusion matrix:
     0    1
0  206   10
1   81  178
early stop counter: 5
val acc:0.8732394576072693, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.8673684000968933
after epoch: 17,now: 2024-07-11 11:23:58.065712,epoch time: 0:10:46.358667,used: 3:03:34.938263,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9943587, 'precision': 0.9585604, 'recall': 0.98232186, 'specificity': 0.98232186, 'f1': 0.9701052, 'auroc': 0.9992306, 'binary_precision': 0.9984216, 'binary_recall': 0.99564636, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.99703205}
confusion matrix:
      0      1
0  1469     47
1   130  29730
---- Validation: 
scalar performance:
{'acc': 0.86306727, 'precision': 0.86895204, 'recall': 0.8647827, 'specificity': 0.8647827, 'f1': 0.86283135, 'auroc': 0.93998814, 'binary_precision': 0.8152327, 'binary_recall': 0.92926043, 'binary_specificity': 0.8003049, 'binary_f1_score': 0.86851984}
confusion matrix:
     0    1
0  525  131
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78105265, 'precision': 0.81107503, 'recall': 0.79461604, 'specificity': 0.79461604, 'f1': 0.779716, 'auroc': 0.9162556, 'binary_precision': 0.93296087, 'binary_recall': 0.64478767, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7625571}
confusion matrix:
     0    1
0  204   12
1   92  167
early stop counter: 6
val acc:0.8630672693252563, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.8673684000968933
after epoch: 18,now: 2024-07-11 11:34:49.188544,epoch time: 0:10:51.122832,used: 3:14:26.061095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9926377, 'precision': 0.9757949, 'recall': 0.9425969, 'specificity': 0.9425969, 'f1': 0.9585283, 'auroc': 0.998842, 'binary_precision': 0.99429446, 'binary_recall': 0.9979906, 'binary_specificity': 0.88720316, 'binary_f1_score': 0.9961391}
confusion matrix:
      0      1
0  1345    171
1    60  29800
---- Validation: 
scalar performance:
{'acc': 0.86932707, 'precision': 0.87287885, 'recall': 0.87067187, 'specificity': 0.87067187, 'f1': 0.86922896, 'auroc': 0.94118357, 'binary_precision': 0.829233, 'binary_recall': 0.92122185, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.8728103}
confusion matrix:
     0    1
0  538  118
1   49  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85473686, 'precision': 0.860886, 'recall': 0.861415, 'specificity': 0.861415, 'f1': 0.8547343, 'auroc': 0.9382955, 'binary_precision': 0.9357798, 'binary_recall': 0.7876448, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.8553459}
confusion matrix:
     0    1
0  202   14
1   55  204
early stop counter: 7
val acc:0.8693270683288574, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.8673684000968933
after epoch: 19,now: 2024-07-11 11:45:37.788612,epoch time: 0:10:48.600068,used: 3:25:14.661163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9946456, 'precision': 0.97312695, 'recall': 0.9683844, 'specificity': 0.9683844, 'f1': 0.97074234, 'auroc': 0.9992201, 'binary_precision': 0.9969206, 'binary_recall': 0.99745476, 'binary_specificity': 0.939314, 'binary_f1_score': 0.99718755}
confusion matrix:
      0      1
0  1424     92
1    76  29784
---- Validation: 
scalar performance:
{'acc': 0.86541474, 'precision': 0.8765131, 'recall': 0.86773586, 'specificity': 0.86773586, 'f1': 0.8648584, 'auroc': 0.9483521, 'binary_precision': 0.80487806, 'binary_recall': 0.95498395, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.8735295}
confusion matrix:
     0    1
0  512  144
1   28  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87578946, 'precision': 0.87535465, 'recall': 0.87841415, 'specificity': 0.87841415, 'f1': 0.8754716, 'auroc': 0.9440691, 'binary_precision': 0.9166667, 'binary_recall': 0.84942085, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8817635}
confusion matrix:
     0    1
0  196   20
1   39  220
new oracle model saved
early stop counter: 8
val acc:0.8654147386550903, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.87578946352005
after epoch: 20,now: 2024-07-11 11:56:25.367991,epoch time: 0:10:47.579379,used: 3:36:02.240542,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9950599, 'precision': 0.9880004, 'recall': 0.9576446, 'specificity': 0.9576446, 'f1': 0.9722809, 'auroc': 0.99961025, 'binary_precision': 0.99576086, 'binary_recall': 0.9990623, 'binary_specificity': 0.9162269, 'binary_f1_score': 0.9974088}
confusion matrix:
      0      1
0  1389    127
1    28  29832
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.83334, 'recall': 0.7861271, 'specificity': 0.7861271, 'f1': 0.7739636, 'auroc': 0.94576895, 'binary_precision': 0.6943182, 'binary_recall': 0.9823151, 'binary_specificity': 0.589939, 'binary_f1_score': 0.8135819}
confusion matrix:
     0    1
0  387  269
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87578946, 'precision': 0.8806728, 'recall': 0.87034357, 'specificity': 0.87034357, 'f1': 0.8733442, 'auroc': 0.9548298, 'binary_precision': 0.8546099, 'binary_recall': 0.93050194, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8909427}
confusion matrix:
     0    1
0  175   41
1   18  241
early stop counter: 9
val acc:0.7809076905250549, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.87578946352005
after epoch: 21,now: 2024-07-11 12:07:13.788005,epoch time: 0:10:48.420014,used: 3:46:50.660556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.995028, 'precision': 0.98701334, 'recall': 0.958254, 'specificity': 0.958254, 'f1': 0.9721473, 'auroc': 0.99965644, 'binary_precision': 0.99582696, 'binary_recall': 0.9989618, 'binary_specificity': 0.91754615, 'binary_f1_score': 0.99739194}
confusion matrix:
      0      1
0  1391    125
1    31  29829
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8351531, 'recall': 0.8156566, 'specificity': 0.8156566, 'f1': 0.809991, 'auroc': 0.92741257, 'binary_precision': 0.74055415, 'binary_recall': 0.9453376, 'binary_specificity': 0.6859756, 'binary_f1_score': 0.8305084}
confusion matrix:
     0    1
0  450  206
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8391337, 'recall': 0.84175247, 'specificity': 0.84175247, 'f1': 0.83948135, 'auroc': 0.89419776, 'binary_precision': 0.8765432, 'binary_recall': 0.82239383, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.84860563}
confusion matrix:
     0    1
0  186   30
1   46  213
early stop counter: 10
val acc:0.8122065663337708, best validation acc: 0.8826290965080261, corresponding to test acc:                         0.7705262899398804 / 0.87578946352005
after epoch: 22,now: 2024-07-11 12:18:04.191934,epoch time: 0:10:50.403929,used: 3:57:41.064485,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9947412, 'precision': 0.9605373, 'recall': 0.9844012, 'specificity': 0.9844012, 'f1': 0.9721319, 'auroc': 0.999437, 'binary_precision': 0.9986231, 'binary_recall': 0.9958473, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9972333}
confusion matrix:
      0      1
0  1475     41
1   124  29736
---- Validation: 
scalar performance:
{'acc': 0.8935837, 'precision': 0.89403725, 'recall': 0.8931334, 'specificity': 0.8931334, 'f1': 0.8934073, 'auroc': 0.94721496, 'binary_precision': 0.9023179, 'binary_recall': 0.8762058, 'binary_specificity': 0.910061, 'binary_f1_score': 0.88907015}
confusion matrix:
     0    1
0  597   59
1   77  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8210526, 'precision': 0.85078573, 'recall': 0.8343701, 'specificity': 0.8343701, 'f1': 0.82013106, 'auroc': 0.928929, 'binary_precision': 0.978022, 'binary_recall': 0.68725866, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.8072562}
confusion matrix:
     0    1
0  212    4
1   81  178
better model found
persisted
after epoch: 23,now: 2024-07-11 12:28:53.026996,epoch time: 0:10:48.835062,used: 4:08:29.899547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9940082, 'precision': 0.9836451, 'recall': 0.9502045, 'specificity': 0.9502045, 'f1': 0.9662592, 'auroc': 0.9993893, 'binary_precision': 0.9950284, 'binary_recall': 0.9986939, 'binary_specificity': 0.90171504, 'binary_f1_score': 0.9968578}
confusion matrix:
      0      1
0  1367    149
1    39  29821
---- Validation: 
scalar performance:
{'acc': 0.8810642, 'precision': 0.88412064, 'recall': 0.88231313, 'specificity': 0.88231313, 'f1': 0.8809986, 'auroc': 0.9451342, 'binary_precision': 0.8425656, 'binary_recall': 0.92926043, 'binary_specificity': 0.83536583, 'binary_f1_score': 0.88379204}
confusion matrix:
     0    1
0  548  108
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84210527, 'precision': 0.86414164, 'recall': 0.8536751, 'specificity': 0.8536751, 'f1': 0.84170115, 'auroc': 0.92134994, 'binary_precision': 0.9791667, 'binary_recall': 0.7258687, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.83370286}
confusion matrix:
     0    1
0  212    4
1   71  188
early stop counter: 1
val acc:0.8810641765594482, best validation acc: 0.8935837149620056, corresponding to test acc:                         0.821052610874176 / 0.87578946352005
after epoch: 24,now: 2024-07-11 12:39:40.512311,epoch time: 0:10:47.485315,used: 4:19:17.384862,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9965898, 'precision': 0.9824785, 'recall': 0.98036325, 'specificity': 0.98036325, 'f1': 0.9814183, 'auroc': 0.999616, 'binary_precision': 0.9980915, 'binary_recall': 0.9983255, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9982085}
confusion matrix:
      0      1
0  1459     57
1    50  29810
---- Validation: 
scalar performance:
{'acc': 0.842723, 'precision': 0.8578408, 'recall': 0.84546554, 'specificity': 0.84546554, 'f1': 0.8416948, 'auroc': 0.9432324, 'binary_precision': 0.7773386, 'binary_recall': 0.948553, 'binary_specificity': 0.74237806, 'binary_f1_score': 0.8544533}
confusion matrix:
     0    1
0  487  169
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7978947, 'precision': 0.79655874, 'recall': 0.7985307, 'specificity': 0.7985307, 'f1': 0.7970302, 'auroc': 0.88159585, 'binary_precision': 0.8299595, 'binary_recall': 0.7915058, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.8102766}
confusion matrix:
     0    1
0  174   42
1   54  205
early stop counter: 2
val acc:0.84272301197052, best validation acc: 0.8935837149620056, corresponding to test acc:                         0.821052610874176 / 0.87578946352005
after epoch: 25,now: 2024-07-11 12:50:27.829277,epoch time: 0:10:47.316966,used: 4:30:04.701828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9959204, 'precision': 0.983088, 'recall': 0.9721849, 'specificity': 0.9721849, 'f1': 0.97756714, 'auroc': 0.9995889, 'binary_precision': 0.9972572, 'binary_recall': 0.99845946, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.997858}
confusion matrix:
      0      1
0  1434     82
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.85054773, 'precision': 0.86230993, 'recall': 0.8529625, 'specificity': 0.8529625, 'f1': 0.84985197, 'auroc': 0.9445313, 'binary_precision': 0.7900404, 'binary_recall': 0.9437299, 'binary_specificity': 0.7621951, 'binary_f1_score': 0.86007327}
confusion matrix:
     0    1
0  500  156
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821053, 'precision': 0.8812615, 'recall': 0.88420564, 'specificity': 0.88420564, 'f1': 0.88172317, 'auroc': 0.9320928, 'binary_precision': 0.91769546, 'binary_recall': 0.8610039, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8884462}
confusion matrix:
     0    1
0  196   20
1   36  223
new oracle model saved
early stop counter: 3
val acc:0.850547730922699, best validation acc: 0.8935837149620056, corresponding to test acc:                         0.821052610874176 / 0.88210529088974
after epoch: 26,now: 2024-07-11 13:01:16.228022,epoch time: 0:10:48.398745,used: 4:40:53.100573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9965898, 'precision': 0.98102516, 'recall': 0.98192865, 'specificity': 0.98192865, 'f1': 0.9814764, 'auroc': 0.9996712, 'binary_precision': 0.99825835, 'binary_recall': 0.9981581, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9982082}
confusion matrix:
      0      1
0  1464     52
1    55  29805
---- Validation: 
scalar performance:
{'acc': 0.9029734, 'precision': 0.9040404, 'recall': 0.9023214, 'specificity': 0.9023214, 'f1': 0.90274453, 'auroc': 0.95015836, 'binary_precision': 0.9191919, 'binary_recall': 0.8778135, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.8980263}
confusion matrix:
     0    1
0  608   48
1   76  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81473684, 'precision': 0.8469349, 'recall': 0.8285786, 'specificity': 0.8285786, 'f1': 0.8136059, 'auroc': 0.93876016, 'binary_precision': 0.9776536, 'binary_recall': 0.6756757, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.7990867}
confusion matrix:
     0    1
0  212    4
1   84  175
better model found
persisted
after epoch: 27,now: 2024-07-11 13:12:02.411823,epoch time: 0:10:46.183801,used: 4:51:39.284374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9954105, 'precision': 0.98541856, 'recall': 0.9640902, 'specificity': 0.9640902, 'f1': 0.9744879, 'auroc': 0.9994689, 'binary_precision': 0.996425, 'binary_recall': 0.9987609, 'binary_specificity': 0.9294195, 'binary_f1_score': 0.99759156}
confusion matrix:
      0      1
0  1409    107
1    37  29823
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.82536584, 'recall': 0.79681003, 'specificity': 0.79681003, 'f1': 0.78877413, 'auroc': 0.9209866, 'binary_precision': 0.71531963, 'binary_recall': 0.95337623, 'binary_specificity': 0.6402439, 'binary_f1_score': 0.8173673}
confusion matrix:
     0    1
0  420  236
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8189474, 'precision': 0.83297974, 'recall': 0.80861217, 'specificity': 0.80861217, 'f1': 0.8123599, 'auroc': 0.89543116, 'binary_precision': 0.7836065, 'binary_recall': 0.9227799, 'binary_specificity': 0.6944444, 'binary_f1_score': 0.8475177}
confusion matrix:
     0    1
0  150   66
1   20  239
early stop counter: 1
val acc:0.792644739151001, best validation acc: 0.9029734134674072, corresponding to test acc:                         0.8147368431091309 / 0.88210529088974
after epoch: 28,now: 2024-07-11 13:22:53.080467,epoch time: 0:10:50.668644,used: 5:02:29.953018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9968129, 'precision': 0.98384404, 'recall': 0.9814197, 'specificity': 0.9814197, 'f1': 0.98262846, 'auroc': 0.9997649, 'binary_precision': 0.9981921, 'binary_recall': 0.99845946, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.99832577}
confusion matrix:
      0      1
0  1462     54
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.81924886, 'precision': 0.8480463, 'recall': 0.823058, 'specificity': 0.823058, 'f1': 0.8165504, 'auroc': 0.9438034, 'binary_precision': 0.74106044, 'binary_recall': 0.96623796, 'binary_specificity': 0.67987806, 'binary_f1_score': 0.8387998}
confusion matrix:
     0    1
0  446  210
1   21  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8442105, 'precision': 0.8462604, 'recall': 0.8394644, 'specificity': 0.8394644, 'f1': 0.84159815, 'auroc': 0.93713355, 'binary_precision': 0.833935, 'binary_recall': 0.8918919, 'binary_specificity': 0.787037, 'binary_f1_score': 0.86194026}
confusion matrix:
     0    1
0  170   46
1   28  231
early stop counter: 2
val acc:0.8192488551139832, best validation acc: 0.9029734134674072, corresponding to test acc:                         0.8147368431091309 / 0.88210529088974
after epoch: 29,now: 2024-07-11 13:33:40.588209,epoch time: 0:10:47.507742,used: 5:13:17.460760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9957292, 'precision': 0.96602535, 'recall': 0.9893033, 'specificity': 0.9893033, 'f1': 0.9773471, 'auroc': 0.9997288, 'binary_precision': 0.99909335, 'binary_recall': 0.9964166, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9977532}
confusion matrix:
      0      1
0  1489     27
1   107  29753
---- Validation: 
scalar performance:
{'acc': 0.8912363, 'precision': 0.8945134, 'recall': 0.8900552, 'specificity': 0.8900552, 'f1': 0.8907299, 'auroc': 0.95011914, 'binary_precision': 0.9244288, 'binary_recall': 0.84565914, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.88329136}
confusion matrix:
     0    1
0  613   43
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231579, 'precision': 0.85395765, 'recall': 0.8366849, 'specificity': 0.8366849, 'f1': 0.82219255, 'auroc': 0.93162805, 'binary_precision': 0.98342544, 'binary_recall': 0.68725866, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.8090909}
confusion matrix:
     0    1
0  213    3
1   81  178
early stop counter: 3
val acc:0.8912363052368164, best validation acc: 0.9029734134674072, corresponding to test acc:                         0.8147368431091309 / 0.88210529088974
after epoch: 30,now: 2024-07-11 13:44:26.022103,epoch time: 0:10:45.433894,used: 5:24:02.894654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_08_20_23_seed_2_21870147
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:24:02.894654 at 2024-07-11 13:44:26.022103
persisted model performance metric: 

scalar performance:
{'acc': 0.81473684, 'precision': 0.8469349, 'recall': 0.8285786, 'specificity': 0.8285786, 'f1': 0.8136059, 'auroc': 0.93876016, 'binary_precision': 0.9776536, 'binary_recall': 0.6756757, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.7990867}
confusion matrix:
     0    1
0  212    4
1   84  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8821053, 'precision': 0.8812615, 'recall': 0.88420564, 'specificity': 0.88420564, 'f1': 0.88172317, 'auroc': 0.9320928, 'binary_precision': 0.91769546, 'binary_recall': 0.8610039, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.8884462}
confusion matrix:
     0    1
0  196   20
1   36  223
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB |   1045 TiB |   1045 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1031 TiB |   1031 TiB |
|       from small pool |  40408 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41664 MiB |  27190 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     66 MiB |     94 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1253 MiB |    790 TiB |    790 TiB |
|       from large pool | 435388 KiB |   1244 MiB |    776 TiB |    776 TiB |
|       from small pool |  12646 KiB |     46 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4927    |  203711 K  |  203709 K  |
|       from large pool |     187    |    1413    |   97185 K  |   97185 K  |
|       from small pool |    1129    |    4738    |  106525 K  |  106524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4927    |  203711 K  |  203709 K  |
|       from large pool |     187    |    1413    |   97185 K  |   97185 K  |
|       from small pool |    1129    |    4738    |  106525 K  |  106524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1776    |    1142    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      33    |      47    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |    2034    |  121015 K  |  121015 K  |
|       from large pool |      40    |     604    |   67959 K  |   67959 K  |
|       from small pool |      61    |    1992    |   53056 K  |   53055 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1045 TiB |   1045 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41664 MiB |  40782 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     66 MiB |     94 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB |    790 TiB |    790 TiB |
|       from large pool |  24320 KiB |   1244 MiB |    776 TiB |    776 TiB |
|       from small pool |      0 KiB |     46 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4927    |  203711 K  |  203711 K  |
|       from large pool |       2    |    1413    |   97185 K  |   97185 K  |
|       from small pool |       0    |    4738    |  106525 K  |  106525 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4927    |  203711 K  |  203711 K  |
|       from large pool |       2    |    1413    |   97185 K  |   97185 K  |
|       from small pool |       0    |    4738    |  106525 K  |  106525 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1776    |    1713    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      33    |      47    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2034    |  121015 K  |  121015 K  |
|       from large pool |       4    |     604    |   67959 K  |   67959 K  |
|       from small pool |       0    |    1992    |   53056 K  |   53056 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 13:52:10 2024]
Finished job 0.
1 of 1 steps (100%) done
