Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Wed Jul 10 20:58:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148

 Experiment start at: 2024-07-10 21:04:07.966153
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98402137, 'precision': 0.9289491, 'recall': 0.893101, 'specificity': 0.893101, 'f1': 0.9101498, 'auroc': 0.9944783, 'binary_precision': 0.9894011, 'binary_recall': 0.9938486, 'binary_specificity': 0.79235333, 'binary_f1_score': 0.9916199}
confusion matrix:
      0      1
0  1202    315
1   182  29405
---- Validation: 
scalar performance:
{'acc': 0.6265528, 'precision': 0.7443201, 'recall': 0.63133085, 'specificity': 0.63133085, 'f1': 0.5799534, 'auroc': 0.8641883, 'binary_precision': 0.5711645, 'binary_recall': 0.97322834, 'binary_specificity': 0.2894334, 'binary_f1_score': 0.7198602}
confusion matrix:
     0    1
0  189  464
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69072163, 'precision': 0.76617646, 'recall': 0.6559001, 'specificity': 0.6559001, 'f1': 0.6380596, 'auroc': 0.8619466, 'binary_precision': 0.65, 'binary_recall': 0.962963, 'binary_specificity': 0.3488372, 'binary_f1_score': 0.77611935}
confusion matrix:
    0    1
0  75  140
1  10  260
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-10 21:12:29.411203,epoch time: 0:08:21.445050,used: 0:08:21.445050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97788066, 'precision': 0.84690803, 'recall': 0.97619426, 'specificity': 0.97619426, 'f1': 0.8998274, 'auroc': 0.9974599, 'binary_precision': 0.998654, 'binary_recall': 0.9780632, 'binary_specificity': 0.97432524, 'binary_f1_score': 0.9882513}
confusion matrix:
      0      1
0  1480     39
1   649  28936
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.8546182, 'recall': 0.85369885, 'specificity': 0.85369885, 'f1': 0.85320556, 'auroc': 0.9272021, 'binary_precision': 0.82890856, 'binary_recall': 0.8850394, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.8560548}
confusion matrix:
     0    1
0  537  116
1   73  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84742266, 'precision': 0.8498399, 'recall': 0.85396206, 'specificity': 0.85396206, 'f1': 0.8471881, 'auroc': 0.93135226, 'binary_precision': 0.9188034, 'binary_recall': 0.7962963, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.85317457}
confusion matrix:
     0    1
0  196   19
1   55  215
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-10 21:20:22.961811,epoch time: 0:07:53.550608,used: 0:16:14.995658,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99080503, 'precision': 0.9430747, 'recall': 0.9601929, 'specificity': 0.9601929, 'f1': 0.95145166, 'auroc': 0.99832046, 'binary_precision': 0.99620634, 'binary_recall': 0.99411863, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.99516135}
confusion matrix:
      0      1
0  1407    112
1   174  29411
---- Validation: 
scalar performance:
{'acc': 0.7802795, 'precision': 0.8169241, 'recall': 0.782635, 'specificity': 0.782635, 'f1': 0.7746825, 'auroc': 0.9278358, 'binary_precision': 0.7056075, 'binary_recall': 0.9511811, 'binary_specificity': 0.61408883, 'binary_f1_score': 0.81019455}
confusion matrix:
     0    1
0  401  252
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.8276577, 'recall': 0.8132644, 'specificity': 0.8132644, 'f1': 0.8170614, 'auroc': 0.9272524, 'binary_precision': 0.8066667, 'binary_recall': 0.8962963, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8491228}
confusion matrix:
     0    1
0  157   58
1   28  242
early stop counter: 1
val acc:0.7802795171737671, best validation acc: 0.85326087474823, corresponding to test acc:                         0.8474226593971252 / 0.8474226593971252
after epoch: 3,now: 2024-07-10 21:28:15.168678,epoch time: 0:07:52.206867,used: 0:24:07.202525,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97350824, 'precision': 0.82588387, 'recall': 0.97483253, 'specificity': 0.97483253, 'f1': 0.88424027, 'auroc': 0.9975965, 'binary_precision': 0.9987514, 'binary_recall': 0.9733649, 'binary_specificity': 0.9763002, 'binary_f1_score': 0.9858948}
confusion matrix:
      0      1
0  1483     36
1   788  28797
---- Validation: 
scalar performance:
{'acc': 0.7763975, 'precision': 0.7895004, 'recall': 0.7748779, 'specificity': 0.7748779, 'f1': 0.7731546, 'auroc': 0.88598955, 'binary_precision': 0.8476954, 'binary_recall': 0.66614175, 'binary_specificity': 0.88361406, 'binary_f1_score': 0.74603176}
confusion matrix:
     0    1
0  577   76
1  212  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78350514, 'precision': 0.82442397, 'recall': 0.8031869, 'specificity': 0.8031869, 'f1': 0.7820225, 'auroc': 0.9132128, 'binary_precision': 0.9714286, 'binary_recall': 0.6296296, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.76404494}
confusion matrix:
     0    1
0  210    5
1  100  170
early stop counter: 2
val acc:0.7763975262641907, best validation acc: 0.85326087474823, corresponding to test acc:                         0.8474226593971252 / 0.8474226593971252
after epoch: 4,now: 2024-07-10 21:36:05.952133,epoch time: 0:07:50.783455,used: 0:31:57.985980,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98710775, 'precision': 0.8984154, 'recall': 0.9866611, 'specificity': 0.9866611, 'f1': 0.9375335, 'auroc': 0.99880415, 'binary_precision': 0.99928147, 'binary_recall': 0.9871561, 'binary_specificity': 0.986166, 'binary_f1_score': 0.99318177}
confusion matrix:
      0      1
0  1497     21
1   380  29206
---- Validation: 
scalar performance:
{'acc': 0.863354, 'precision': 0.8680351, 'recall': 0.86256766, 'specificity': 0.86256766, 'f1': 0.8627132, 'auroc': 0.9307642, 'binary_precision': 0.9061947, 'binary_recall': 0.8062992, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.85333335}
confusion matrix:
     0    1
0  600   53
1  123  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.83889234, 'recall': 0.8355297, 'specificity': 0.8355297, 'f1': 0.8226193, 'auroc': 0.91981053, 'binary_precision': 0.9466019, 'binary_recall': 0.7222222, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8193277}
confusion matrix:
     0    1
0  204   11
1   75  195
better model found
persisted
after epoch: 5,now: 2024-07-10 21:43:57.169746,epoch time: 0:07:51.217613,used: 0:39:49.203593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9912873, 'precision': 0.9333246, 'recall': 0.98042107, 'specificity': 0.98042107, 'f1': 0.95550454, 'auroc': 0.9987068, 'binary_precision': 0.99836797, 'binary_recall': 0.99246264, 'binary_specificity': 0.96837944, 'binary_f1_score': 0.9954065}
confusion matrix:
      0      1
0  1470     48
1   223  29363
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.8123406, 'recall': 0.75990283, 'specificity': 0.75990283, 'f1': 0.74707377, 'auroc': 0.92090774, 'binary_precision': 0.6773128, 'binary_recall': 0.96850395, 'binary_specificity': 0.55130166, 'binary_f1_score': 0.7971484}
confusion matrix:
     0    1
0  360  293
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7360825, 'precision': 0.7908658, 'recall': 0.7080103, 'specificity': 0.7080103, 'f1': 0.7043021, 'auroc': 0.93757105, 'binary_precision': 0.6898396, 'binary_recall': 0.95555556, 'binary_specificity': 0.4604651, 'binary_f1_score': 0.80124223}
confusion matrix:
    0    1
0  99  116
1  12  258
early stop counter: 1
val acc:0.7569875717163086, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.8474226593971252
after epoch: 6,now: 2024-07-10 21:51:51.118582,epoch time: 0:07:53.948836,used: 0:47:43.152429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.991866, 'precision': 0.9747639, 'recall': 0.93568635, 'specificity': 0.93568635, 'f1': 0.95429134, 'auroc': 0.9986901, 'binary_precision': 0.9935393, 'binary_recall': 0.9979383, 'binary_specificity': 0.8734344, 'binary_f1_score': 0.9957339}
confusion matrix:
      0      1
0  1325    192
1    61  29526
---- Validation: 
scalar performance:
{'acc': 0.73214287, 'precision': 0.80412644, 'recall': 0.73550904, 'specificity': 0.73550904, 'f1': 0.7171006, 'auroc': 0.934914, 'binary_precision': 0.6526316, 'binary_recall': 0.97637796, 'binary_specificity': 0.4946401, 'binary_f1_score': 0.7823344}
confusion matrix:
     0    1
0  323  330
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77938145, 'precision': 0.82508314, 'recall': 0.7559001, 'specificity': 0.7559001, 'f1': 0.7586964, 'auroc': 0.9239793, 'binary_precision': 0.72829133, 'binary_recall': 0.962963, 'binary_specificity': 0.5488372, 'binary_f1_score': 0.8293461}
confusion matrix:
     0    1
0  118   97
1   10  260
early stop counter: 2
val acc:0.7321428656578064, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.8474226593971252
after epoch: 7,now: 2024-07-10 21:59:44.008563,epoch time: 0:07:52.889981,used: 0:55:36.042410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9936021, 'precision': 0.9798846, 'recall': 0.9501096, 'specificity': 0.9501096, 'f1': 0.96446615, 'auroc': 0.9992367, 'binary_precision': 0.99498045, 'binary_recall': 0.99830997, 'binary_specificity': 0.9019092, 'binary_f1_score': 0.9966424}
confusion matrix:
      0      1
0  1370    149
1    50  29535
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.83843297, 'recall': 0.79827446, 'specificity': 0.79827446, 'f1': 0.7900662, 'auroc': 0.9496641, 'binary_precision': 0.7147806, 'binary_recall': 0.97480315, 'binary_specificity': 0.62174577, 'binary_f1_score': 0.8247835}
confusion matrix:
     0    1
0  406  247
1   16  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.8817316, 'recall': 0.87975883, 'specificity': 0.87975883, 'f1': 0.8806476, 'auroc': 0.9527993, 'binary_precision': 0.8872727, 'binary_recall': 0.9037037, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8954128}
confusion matrix:
     0    1
0  184   31
1   26  244
new oracle model saved
early stop counter: 3
val acc:0.7958074808120728, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.8824742436408997
after epoch: 8,now: 2024-07-10 22:07:40.288894,epoch time: 0:07:56.280331,used: 1:03:32.322741,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98945475, 'precision': 0.94296885, 'recall': 0.94352245, 'specificity': 0.94352245, 'f1': 0.9432454, 'auroc': 0.9978322, 'binary_precision': 0.99449027, 'binary_recall': 0.99442303, 'binary_specificity': 0.8926219, 'binary_f1_score': 0.99445665}
confusion matrix:
      0      1
0  1355    163
1   165  29421
---- Validation: 
scalar performance:
{'acc': 0.80201864, 'precision': 0.827839, 'recall': 0.8039659, 'specificity': 0.8039659, 'f1': 0.7987153, 'auroc': 0.906289, 'binary_precision': 0.7322738, 'binary_recall': 0.9433071, 'binary_specificity': 0.6646248, 'binary_f1_score': 0.824501}
confusion matrix:
     0    1
0  434  219
1   36  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.80016416, 'recall': 0.792894, 'specificity': 0.792894, 'f1': 0.795233, 'auroc': 0.8898363, 'binary_precision': 0.79930794, 'binary_recall': 0.85555553, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8264758}
confusion matrix:
     0    1
0  157   58
1   39  231
early stop counter: 4
val acc:0.8020186424255371, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.8824742436408997
after epoch: 9,now: 2024-07-10 22:15:33.680909,epoch time: 0:07:53.392015,used: 1:11:25.714756,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99260545, 'precision': 0.98152125, 'recall': 0.93732584, 'specificity': 0.93732584, 'f1': 0.95824146, 'auroc': 0.999084, 'binary_precision': 0.9936771, 'binary_recall': 0.99858046, 'binary_specificity': 0.8760712, 'binary_f1_score': 0.9961227}
confusion matrix:
      0      1
0  1329    188
1    42  29545
---- Validation: 
scalar performance:
{'acc': 0.82298136, 'precision': 0.8535123, 'recall': 0.82503045, 'specificity': 0.82503045, 'f1': 0.8196907, 'auroc': 0.94158757, 'binary_precision': 0.74607015, 'binary_recall': 0.9716535, 'binary_specificity': 0.6784074, 'binary_f1_score': 0.8440493}
confusion matrix:
     0    1
0  443  210
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.82690585, 'recall': 0.82592595, 'specificity': 0.82592595, 'f1': 0.82638305, 'auroc': 0.9139018, 'binary_precision': 0.84249085, 'binary_recall': 0.8518519, 'binary_specificity': 0.8, 'binary_f1_score': 0.8471455}
confusion matrix:
     0    1
0  172   43
1   40  230
early stop counter: 5
val acc:0.8229813575744629, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.8824742436408997
after epoch: 10,now: 2024-07-10 22:23:27.052804,epoch time: 0:07:53.371895,used: 1:19:19.086651,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9835069, 'precision': 0.9886272, 'recall': 0.83301246, 'specificity': 0.83301246, 'f1': 0.89459777, 'auroc': 0.99937785, 'binary_precision': 0.98314834, 'binary_recall': 0.99979717, 'binary_specificity': 0.66622776, 'binary_f1_score': 0.99140286}
confusion matrix:
      0      1
0  1012    507
1     6  29579
---- Validation: 
scalar performance:
{'acc': 0.5962733, 'precision': 0.77123123, 'recall': 0.60181594, 'specificity': 0.60181594, 'f1': 0.5246369, 'auroc': 0.95645297, 'binary_precision': 0.5498699, 'binary_recall': 0.9984252, 'binary_specificity': 0.20520674, 'binary_f1_score': 0.7091723}
confusion matrix:
     0    1
0  134  519
1    1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65773195, 'precision': 0.7913173, 'recall': 0.61490095, 'specificity': 0.61490095, 'f1': 0.5720649, 'auroc': 0.94070625, 'binary_precision': 0.6203704, 'binary_recall': 0.9925926, 'binary_specificity': 0.2372093, 'binary_f1_score': 0.76353276}
confusion matrix:
    0    1
0  51  164
1   2  268
early stop counter: 6
val acc:0.5962733030319214, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.8824742436408997
after epoch: 11,now: 2024-07-10 22:31:21.213106,epoch time: 0:07:54.160302,used: 1:27:13.246953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9955954, 'precision': 0.9804778, 'recall': 0.97176677, 'specificity': 0.97176677, 'f1': 0.97607785, 'auroc': 0.9992832, 'binary_precision': 0.9971973, 'binary_recall': 0.9981747, 'binary_specificity': 0.9453588, 'binary_f1_score': 0.99768573}
confusion matrix:
      0      1
0  1436     83
1    54  29531
---- Validation: 
scalar performance:
{'acc': 0.86024845, 'precision': 0.86466867, 'recall': 0.86102426, 'specificity': 0.86102426, 'f1': 0.8599838, 'auroc': 0.9370103, 'binary_precision': 0.82087445, 'binary_recall': 0.91653544, 'binary_specificity': 0.805513, 'binary_f1_score': 0.86607146}
confusion matrix:
     0    1
0  526  127
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8845361, 'precision': 0.8954547, 'recall': 0.8958225, 'specificity': 0.8958225, 'f1': 0.88453555, 'auroc': 0.9546942, 'binary_precision': 0.9953704, 'binary_recall': 0.7962963, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.8847736}
confusion matrix:
     0    1
0  214    1
1   55  215
new oracle model saved
early stop counter: 7
val acc:0.8602484464645386, best validation acc: 0.8633540272712708, corresponding to test acc:                         0.8226804137229919 / 0.88453608751297
after epoch: 12,now: 2024-07-10 22:39:11.986475,epoch time: 0:07:50.773369,used: 1:35:04.020322,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99209106, 'precision': 0.9622187, 'recall': 0.95181334, 'specificity': 0.95181334, 'f1': 0.95694983, 'auroc': 0.99790597, 'binary_precision': 0.99523985, 'binary_recall': 0.9964509, 'binary_specificity': 0.9071758, 'binary_f1_score': 0.99584496}
confusion matrix:
      0      1
0  1378    141
1   105  29480
---- Validation: 
scalar performance:
{'acc': 0.88431674, 'precision': 0.88785714, 'recall': 0.8849996, 'specificity': 0.8849996, 'f1': 0.88416255, 'auroc': 0.95158386, 'binary_precision': 0.8471429, 'binary_recall': 0.9338583, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.8883896}
confusion matrix:
     0    1
0  546  107
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.843299, 'precision': 0.84169924, 'recall': 0.8403101, 'specificity': 0.8403101, 'f1': 0.8409452, 'auroc': 0.9291645, 'binary_precision': 0.8540146, 'binary_recall': 0.8666667, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.86029416}
confusion matrix:
     0    1
0  175   40
1   36  234
better model found
persisted
after epoch: 13,now: 2024-07-10 22:47:04.636310,epoch time: 0:07:52.649835,used: 1:42:56.670157,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99466306, 'precision': 0.9682628, 'recall': 0.97469604, 'specificity': 0.97469604, 'f1': 0.97145486, 'auroc': 0.99909353, 'binary_precision': 0.9975646, 'binary_recall': 0.99682283, 'binary_specificity': 0.9525692, 'binary_f1_score': 0.99719363}
confusion matrix:
      0      1
0  1446     72
1    94  29492
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.88585156, 'recall': 0.88592327, 'specificity': 0.88592327, 'f1': 0.8858612, 'auroc': 0.9447854, 'binary_precision': 0.8800623, 'binary_recall': 0.8897638, 'binary_specificity': 0.8820827, 'binary_f1_score': 0.88488644}
confusion matrix:
     0    1
0  576   77
1   70  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268041, 'precision': 0.85760975, 'recall': 0.8439707, 'specificity': 0.8439707, 'f1': 0.82626563, 'auroc': 0.91564167, 'binary_precision': 0.9946808, 'binary_recall': 0.6925926, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.8165938}
confusion matrix:
     0    1
0  214    1
1   83  187
better model found
persisted
after epoch: 14,now: 2024-07-10 22:55:01.094049,epoch time: 0:07:56.457739,used: 1:50:53.127896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9962706, 'precision': 0.98767626, 'recall': 0.9718094, 'specificity': 0.9718094, 'f1': 0.9795967, 'auroc': 0.9994302, 'binary_precision': 0.9971657, 'binary_recall': 0.99891835, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.9980413}
confusion matrix:
      0      1
0  1435     84
1    32  29553
---- Validation: 
scalar performance:
{'acc': 0.8959627, 'precision': 0.89593875, 'recall': 0.89600754, 'specificity': 0.89600754, 'f1': 0.8959537, 'auroc': 0.9521771, 'binary_precision': 0.89079565, 'binary_recall': 0.8992126, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.8949843}
confusion matrix:
     0    1
0  583   70
1   64  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88247424, 'precision': 0.8833724, 'recall': 0.888286, 'specificity': 0.888286, 'f1': 0.8821857, 'auroc': 0.94706285, 'binary_precision': 0.9456067, 'binary_recall': 0.837037, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8880157}
confusion matrix:
     0    1
0  202   13
1   44  226
better model found
persisted
after epoch: 15,now: 2024-07-10 23:02:53.330139,epoch time: 0:07:52.236090,used: 1:58:45.363986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99556327, 'precision': 0.9730619, 'recall': 0.97955644, 'specificity': 0.97955644, 'f1': 0.97628444, 'auroc': 0.99916613, 'binary_precision': 0.9980381, 'binary_recall': 0.9972959, 'binary_specificity': 0.96181697, 'binary_f1_score': 0.9976669}
confusion matrix:
      0      1
0  1461     58
1    80  29505
---- Validation: 
scalar performance:
{'acc': 0.9122671, 'precision': 0.91228, 'recall': 0.9122174, 'specificity': 0.9122174, 'f1': 0.9122437, 'auroc': 0.95463693, 'binary_precision': 0.91297466, 'binary_recall': 0.9086614, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.9108129}
confusion matrix:
     0    1
0  598   55
1   58  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89896905, 'precision': 0.9042448, 'recall': 0.90783805, 'specificity': 0.90783805, 'f1': 0.8989072, 'auroc': 0.9672179, 'binary_precision': 0.98678416, 'binary_recall': 0.8296296, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.90140843}
confusion matrix:
     0    1
0  212    3
1   46  224
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-10 23:10:46.962273,epoch time: 0:07:53.632134,used: 2:06:38.996120,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99463093, 'precision': 0.98901546, 'recall': 0.95249295, 'specificity': 0.95249295, 'f1': 0.9699664, 'auroc': 0.99953914, 'binary_precision': 0.995186, 'binary_recall': 0.9991888, 'binary_specificity': 0.9057971, 'binary_f1_score': 0.9971834}
confusion matrix:
      0      1
0  1375    143
1    24  29562
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.8697378, 'recall': 0.85474074, 'specificity': 0.85474074, 'f1': 0.8519543, 'auroc': 0.96117496, 'binary_precision': 0.7881137, 'binary_recall': 0.96062994, 'binary_specificity': 0.7488515, 'binary_f1_score': 0.8658623}
confusion matrix:
     0    1
0  489  164
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.8704382, 'recall': 0.8658053, 'specificity': 0.8658053, 'f1': 0.8676522, 'auroc': 0.94111973, 'binary_precision': 0.8683274, 'binary_recall': 0.9037037, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8856624}
confusion matrix:
     0    1
0  178   37
1   26  244
early stop counter: 1
val acc:0.85326087474823, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 17,now: 2024-07-10 23:18:41.234282,epoch time: 0:07:54.272009,used: 2:14:33.268129,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99495244, 'precision': 0.9786948, 'recall': 0.9664111, 'specificity': 0.9664111, 'f1': 0.97246397, 'auroc': 0.9992794, 'binary_precision': 0.99665844, 'binary_recall': 0.9980396, 'binary_specificity': 0.9347826, 'binary_f1_score': 0.99734855}
confusion matrix:
      0      1
0  1419     99
1    58  29528
---- Validation: 
scalar performance:
{'acc': 0.8198758, 'precision': 0.84677774, 'recall': 0.8218157, 'specificity': 0.8218157, 'f1': 0.8169073, 'auroc': 0.94388044, 'binary_precision': 0.746634, 'binary_recall': 0.96062994, 'binary_specificity': 0.6830015, 'binary_f1_score': 0.84022033}
confusion matrix:
     0    1
0  446  207
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.86938727, 'recall': 0.85598624, 'specificity': 0.85598624, 'f1': 0.86001295, 'auroc': 0.9489061, 'binary_precision': 0.8445946, 'binary_recall': 0.9259259, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.8833922}
confusion matrix:
     0    1
0  169   46
1   20  250
early stop counter: 2
val acc:0.8198757767677307, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 18,now: 2024-07-10 23:26:33.471899,epoch time: 0:07:52.237617,used: 2:22:25.505746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.995724, 'precision': 0.97827065, 'recall': 0.9755815, 'specificity': 0.9755815, 'f1': 0.9769218, 'auroc': 0.9995012, 'binary_precision': 0.99760085, 'binary_recall': 0.99790436, 'binary_specificity': 0.9532587, 'binary_f1_score': 0.99775255}
confusion matrix:
      0      1
0  1448     71
1    62  29523
---- Validation: 
scalar performance:
{'acc': 0.8773292, 'precision': 0.88334215, 'recall': 0.87821686, 'specificity': 0.87821686, 'f1': 0.8770063, 'auroc': 0.94914806, 'binary_precision': 0.8317107, 'binary_recall': 0.9417323, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.8833087}
confusion matrix:
     0    1
0  532  121
1   37  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.82714283, 'recall': 0.8254522, 'specificity': 0.8254522, 'f1': 0.82620615, 'auroc': 0.91843235, 'binary_precision': 0.84, 'binary_recall': 0.85555553, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.84770644}
confusion matrix:
     0    1
0  171   44
1   39  231
early stop counter: 3
val acc:0.8773291707038879, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 19,now: 2024-07-10 23:34:24.655521,epoch time: 0:07:51.183622,used: 2:30:16.689368,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99610984, 'precision': 0.9841955, 'recall': 0.9735985, 'specificity': 0.9735985, 'f1': 0.97883165, 'auroc': 0.9995655, 'binary_precision': 0.99736667, 'binary_recall': 0.99854654, 'binary_specificity': 0.9486504, 'binary_f1_score': 0.9979562}
confusion matrix:
      0      1
0  1441     78
1    43  29542
---- Validation: 
scalar performance:
{'acc': 0.8773292, 'precision': 0.88364923, 'recall': 0.87823856, 'specificity': 0.87823856, 'f1': 0.87698627, 'auroc': 0.95018506, 'binary_precision': 0.8307906, 'binary_recall': 0.9433071, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.8834808}
confusion matrix:
     0    1
0  531  122
1   36  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680412, 'precision': 0.8719523, 'recall': 0.8757967, 'specificity': 0.8757967, 'f1': 0.8679149, 'auroc': 0.93850124, 'binary_precision': 0.9478261, 'binary_recall': 0.8074074, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.872}
confusion matrix:
     0    1
0  203   12
1   52  218
early stop counter: 4
val acc:0.8773291707038879, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 20,now: 2024-07-10 23:42:23.080559,epoch time: 0:07:58.425038,used: 2:38:15.114406,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9943094, 'precision': 0.9635871, 'recall': 0.9760435, 'specificity': 0.9760435, 'f1': 0.96972287, 'auroc': 0.99928164, 'binary_precision': 0.9977323, 'binary_recall': 0.9962823, 'binary_specificity': 0.95580477, 'binary_f1_score': 0.9970068}
confusion matrix:
      0      1
0  1449     67
1   110  29478
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.84729147, 'recall': 0.8225814, 'specificity': 0.8225814, 'f1': 0.81773305, 'auroc': 0.9495629, 'binary_precision': 0.747549, 'binary_recall': 0.96062994, 'binary_specificity': 0.68453294, 'binary_f1_score': 0.8407994}
confusion matrix:
     0    1
0  447  206
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.8929674, 'recall': 0.89465976, 'specificity': 0.89465976, 'f1': 0.89371586, 'auroc': 0.9504565, 'binary_precision': 0.91320753, 'binary_recall': 0.8962963, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.904673}
confusion matrix:
     0    1
0  192   23
1   28  242
early stop counter: 5
val acc:0.820652186870575, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 21,now: 2024-07-10 23:50:15.133144,epoch time: 0:07:52.052585,used: 2:46:07.166991,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99260545, 'precision': 0.94587135, 'recall': 0.9786141, 'specificity': 0.9786141, 'f1': 0.961591, 'auroc': 0.9988051, 'binary_precision': 0.9980996, 'binary_recall': 0.99411887, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.9961053}
confusion matrix:
      0      1
0  1462     56
1   174  29412
---- Validation: 
scalar performance:
{'acc': 0.90993786, 'precision': 0.909928, 'recall': 0.9100071, 'specificity': 0.9100071, 'f1': 0.9099325, 'auroc': 0.9544549, 'binary_precision': 0.90357697, 'binary_recall': 0.9149606, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.90923315}
confusion matrix:
     0    1
0  591   62
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8680412, 'precision': 0.8825108, 'recall': 0.88053405, 'specificity': 0.88053405, 'f1': 0.8680272, 'auroc': 0.9476658, 'binary_precision': 0.9904762, 'binary_recall': 0.77037036, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  213    2
1   62  208
early stop counter: 6
val acc:0.909937858581543, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 22,now: 2024-07-10 23:58:08.006901,epoch time: 0:07:52.873757,used: 2:54:00.040748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98971194, 'precision': 0.98358977, 'recall': 0.90372324, 'specificity': 0.90372324, 'f1': 0.9396709, 'auroc': 0.9984975, 'binary_precision': 0.9902503, 'binary_recall': 0.9990198, 'binary_specificity': 0.8084266, 'binary_f1_score': 0.9946157}
confusion matrix:
      0      1
0  1228    291
1    29  29556
---- Validation: 
scalar performance:
{'acc': 0.6956522, 'precision': 0.7988632, 'recall': 0.6997166, 'specificity': 0.6997166, 'f1': 0.6695491, 'auroc': 0.9114782, 'binary_precision': 0.6197044, 'binary_recall': 0.9905512, 'binary_specificity': 0.40888208, 'binary_f1_score': 0.76242423}
confusion matrix:
     0    1
0  267  386
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76082474, 'precision': 0.81615806, 'recall': 0.7344961, 'specificity': 0.7344961, 'f1': 0.7343921, 'auroc': 0.9127821, 'binary_precision': 0.7092391, 'binary_recall': 0.96666664, 'binary_specificity': 0.5023256, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  108  107
1    9  261
early stop counter: 7
val acc:0.695652186870575, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.8989690542221069
after epoch: 23,now: 2024-07-11 00:05:59.551821,epoch time: 0:07:51.544920,used: 3:01:51.585668,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9916731, 'precision': 0.9882982, 'recall': 0.9209918, 'specificity': 0.9209918, 'f1': 0.9518812, 'auroc': 0.99921066, 'binary_precision': 0.99198097, 'binary_recall': 0.99932396, 'binary_specificity': 0.84265965, 'binary_f1_score': 0.99563897}
confusion matrix:
      0      1
0  1280    239
1    20  29565
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.8571602, 'recall': 0.84010565, 'specificity': 0.84010565, 'f1': 0.8367951, 'auroc': 0.9387491, 'binary_precision': 0.7719745, 'binary_recall': 0.9543307, 'binary_specificity': 0.72588056, 'binary_f1_score': 0.85352105}
confusion matrix:
     0    1
0  474  179
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154639, 'precision': 0.91354513, 'recall': 0.91649437, 'specificity': 0.91649437, 'f1': 0.9146966, 'auroc': 0.95226526, 'binary_precision': 0.93869734, 'binary_recall': 0.9074074, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.9227872}
confusion matrix:
     0    1
0  199   16
1   25  245
new oracle model saved
early stop counter: 8
val acc:0.8385093212127686, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.915463924407959
after epoch: 24,now: 2024-07-11 00:13:52.259264,epoch time: 0:07:52.707443,used: 3:09:44.293111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99633485, 'precision': 0.98588806, 'recall': 0.97434133, 'specificity': 0.97434133, 'f1': 0.98003733, 'auroc': 0.9996226, 'binary_precision': 0.99743444, 'binary_recall': 0.9987156, 'binary_specificity': 0.9499671, 'binary_f1_score': 0.9980746}
confusion matrix:
      0      1
0  1443     76
1    38  29547
---- Validation: 
scalar performance:
{'acc': 0.867236, 'precision': 0.87864435, 'recall': 0.86845815, 'specificity': 0.86845815, 'f1': 0.8664788, 'auroc': 0.94829977, 'binary_precision': 0.8093333, 'binary_recall': 0.9559055, 'binary_specificity': 0.78101075, 'binary_f1_score': 0.87653434}
confusion matrix:
     0    1
0  510  143
1   28  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87216496, 'precision': 0.8753237, 'recall': 0.8795004, 'specificity': 0.8795004, 'f1': 0.8720077, 'auroc': 0.94136095, 'binary_precision': 0.94827586, 'binary_recall': 0.8148148, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.87649405}
confusion matrix:
     0    1
0  203   12
1   50  220
early stop counter: 9
val acc:0.8672360181808472, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.915463924407959
after epoch: 25,now: 2024-07-11 00:21:47.144035,epoch time: 0:07:54.884771,used: 3:17:39.177882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99575615, 'precision': 0.97350407, 'recall': 0.9811963, 'specificity': 0.9811963, 'f1': 0.9773155, 'auroc': 0.99956393, 'binary_precision': 0.9982071, 'binary_recall': 0.9973299, 'binary_specificity': 0.9650626, 'binary_f1_score': 0.9977682}
confusion matrix:
      0      1
0  1464     53
1    79  29508
---- Validation: 
scalar performance:
{'acc': 0.9114907, 'precision': 0.9117302, 'recall': 0.9116905, 'specificity': 0.9116905, 'f1': 0.91149044, 'auroc': 0.9556867, 'binary_precision': 0.8977099, 'binary_recall': 0.92598426, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.9116279}
confusion matrix:
     0    1
0  586   67
1   47  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91752577, 'precision': 0.9181548, 'recall': 0.9235573, 'specificity': 0.9235573, 'f1': 0.91730607, 'auroc': 0.9680103, 'binary_precision': 0.9791667, 'binary_recall': 0.8703704, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.92156863}
confusion matrix:
     0    1
0  210    5
1   35  235
new oracle model saved
early stop counter: 10
val acc:0.9114906787872314, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.9175257682800293
after epoch: 26,now: 2024-07-11 00:29:40.309049,epoch time: 0:07:53.165014,used: 3:25:32.342896,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9955954, 'precision': 0.976436, 'recall': 0.9761385, 'specificity': 0.9761385, 'f1': 0.9762871, 'auroc': 0.9995396, 'binary_precision': 0.9976678, 'binary_recall': 0.9977015, 'binary_specificity': 0.95457536, 'binary_f1_score': 0.99768466}
confusion matrix:
      0      1
0  1450     69
1    68  29517
---- Validation: 
scalar performance:
{'acc': 0.9122671, 'precision': 0.91257966, 'recall': 0.91208714, 'specificity': 0.91208714, 'f1': 0.9122094, 'auroc': 0.95360005, 'binary_precision': 0.92096776, 'binary_recall': 0.8992126, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.90996015}
confusion matrix:
     0    1
0  604   49
1   64  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89896905, 'precision': 0.9061548, 'recall': 0.9087855, 'specificity': 0.9087855, 'f1': 0.8989416, 'auroc': 0.9638588, 'binary_precision': 0.9955157, 'binary_recall': 0.82222223, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.90060854}
confusion matrix:
     0    1
0  214    1
1   48  222
early stop counter: 11
val acc:0.9122670888900757, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.9175257682800293
after epoch: 27,now: 2024-07-11 00:37:36.976176,epoch time: 0:07:56.667127,used: 3:33:29.010023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9950167, 'precision': 0.9724684, 'recall': 0.9739444, 'specificity': 0.9739444, 'f1': 0.9732051, 'auroc': 0.9991604, 'binary_precision': 0.9974646, 'binary_recall': 0.99729604, 'binary_specificity': 0.9505929, 'binary_f1_score': 0.9973803}
confusion matrix:
      0      1
0  1443     75
1    80  29506
---- Validation: 
scalar performance:
{'acc': 0.9060559, 'precision': 0.9060381, 'recall': 0.9061135, 'specificity': 0.9061135, 'f1': 0.906049, 'auroc': 0.95156693, 'binary_precision': 0.9003115, 'binary_recall': 0.91023624, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.9052466}
confusion matrix:
     0    1
0  589   64
1   57  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.87282294, 'recall': 0.8717054, 'specificity': 0.8717054, 'f1': 0.8597884, 'auroc': 0.93795, 'binary_precision': 0.9764151, 'binary_recall': 0.76666665, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8589211}
confusion matrix:
     0    1
0  210    5
1   63  207
early stop counter: 12
val acc:0.9060559272766113, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.9175257682800293
after epoch: 28,now: 2024-07-11 00:45:32.196247,epoch time: 0:07:55.220071,used: 3:41:24.230094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941487, 'precision': 0.9853916, 'recall': 0.9506449, 'specificity': 0.9506449, 'f1': 0.96730065, 'auroc': 0.99949485, 'binary_precision': 0.995017, 'binary_recall': 0.9988508, 'binary_specificity': 0.902439, 'binary_f1_score': 0.9969302}
confusion matrix:
      0      1
0  1369    148
1    34  29553
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.86058855, 'recall': 0.84618783, 'specificity': 0.84618783, 'f1': 0.84336084, 'auroc': 0.9387063, 'binary_precision': 0.7813713, 'binary_recall': 0.9511811, 'binary_specificity': 0.7411945, 'binary_f1_score': 0.85795456}
confusion matrix:
     0    1
0  484  169
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9072165, 'precision': 0.90544593, 'recall': 0.9071921, 'specificity': 0.9071921, 'f1': 0.9062198, 'auroc': 0.9544014, 'binary_precision': 0.9245283, 'binary_recall': 0.9074074, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.9158879}
confusion matrix:
     0    1
0  195   20
1   25  245
early stop counter: 13
val acc:0.8447204828262329, best validation acc: 0.9122670888900757, corresponding to test acc:                         0.8989690542221069 / 0.9175257682800293
after epoch: 29,now: 2024-07-11 00:53:23.564651,epoch time: 0:07:51.368404,used: 3:49:15.598498,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9965921, 'precision': 0.9787917, 'recall': 0.98477197, 'specificity': 0.98477197, 'f1': 0.98176104, 'auroc': 0.99970376, 'binary_precision': 0.99854565, 'binary_recall': 0.9978706, 'binary_specificity': 0.97167325, 'binary_f1_score': 0.998208}
confusion matrix:
      0      1
0  1475     43
1    63  29523
---- Validation: 
scalar performance:
{'acc': 0.9208075, 'precision': 0.92104965, 'recall': 0.92100906, 'specificity': 0.92100906, 'f1': 0.92080724, 'auroc': 0.965909, 'binary_precision': 0.90687025, 'binary_recall': 0.9354331, 'binary_specificity': 0.906585, 'binary_f1_score': 0.92093027}
confusion matrix:
     0    1
0  592   61
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8907217, 'precision': 0.8951027, 'recall': 0.89900947, 'specificity': 0.89900947, 'f1': 0.8906305, 'auroc': 0.94270456, 'binary_precision': 0.9737991, 'binary_recall': 0.82592595, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.89378756}
confusion matrix:
     0    1
0  209    6
1   47  223
better model found
persisted
after epoch: 30,now: 2024-07-11 01:01:14.555877,epoch time: 0:07:50.991226,used: 3:57:06.589724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_10_21_04_07_seed_0_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 3:57:06.589724 at 2024-07-11 01:01:14.555877
persisted model performance metric: 

scalar performance:
{'acc': 0.8907217, 'precision': 0.8951027, 'recall': 0.89900947, 'specificity': 0.89900947, 'f1': 0.8906305, 'auroc': 0.94270456, 'binary_precision': 0.9737991, 'binary_recall': 0.82592595, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.89378756}
confusion matrix:
     0    1
0  209    6
1   47  223
oracle model performance metric: 

scalar performance:
{'acc': 0.91752577, 'precision': 0.9181548, 'recall': 0.9235573, 'specificity': 0.9235573, 'f1': 0.91730607, 'auroc': 0.9680103, 'binary_precision': 0.9791667, 'binary_recall': 0.8703704, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.92156863}
confusion matrix:
     0    1
0  210    5
1   35  235
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455466 KiB |  13219 MiB | 363585 GiB | 363585 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358756 GiB | 358755 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455466 KiB |  13219 MiB | 363585 GiB | 363585 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358756 GiB | 358755 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 360408 GiB | 360407 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 355589 GiB | 355588 GiB |
|       from small pool |  40408 KiB |     56 MiB |   4818 GiB |   4818 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447702 KiB |   1252 MiB | 273124 GiB | 273124 GiB |
|       from large pool | 435058 KiB |   1243 MiB | 268282 GiB | 268282 GiB |
|       from small pool |  12643 KiB |     17 MiB |   4842 GiB |   4842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1322    |    4893    |   68262 K  |   68260 K  |
|       from large pool |     187    |    1413    |   32681 K  |   32681 K  |
|       from small pool |    1135    |    4704    |   35580 K  |   35579 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1322    |    4893    |   68262 K  |   68260 K  |
|       from large pool |     187    |    1413    |   32681 K  |   32681 K  |
|       from small pool |    1135    |    4704    |   35580 K  |   35579 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |    2012    |   41848 K  |   41848 K  |
|       from large pool |      37    |     600    |   24247 K  |   24247 K  |
|       from small pool |      61    |    1974    |   17601 K  |   17601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 363585 GiB | 363585 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358756 GiB | 358756 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 363585 GiB | 363585 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358756 GiB | 358756 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 360408 GiB | 360408 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 355589 GiB | 355589 GiB |
|       from small pool |      0 KiB |     56 MiB |   4818 GiB |   4818 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 273125 GiB | 273125 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 268283 GiB | 268282 GiB |
|       from small pool |      0 KiB |     46 MiB |   4842 GiB |   4842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68262 K  |   68262 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68262 K  |   68262 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2012    |   41849 K  |   41849 K  |
|       from large pool |       4    |     600    |   24247 K  |   24247 K  |
|       from small pool |       0    |    1974    |   17601 K  |   17601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 363585 GiB | 363585 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358756 GiB | 358756 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 363585 GiB | 363585 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358756 GiB | 358756 GiB |
|       from small pool |      0 KiB |     56 MiB |   4829 GiB |   4829 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 360408 GiB | 360408 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 355589 GiB | 355589 GiB |
|       from small pool |      0 KiB |     56 MiB |   4818 GiB |   4818 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 273125 GiB | 273125 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 268283 GiB | 268282 GiB |
|       from small pool |      0 KiB |     46 MiB |   4842 GiB |   4842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68262 K  |   68262 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68262 K  |   68262 K  |
|       from large pool |       2    |    1413    |   32681 K  |   32681 K  |
|       from small pool |       0    |    4704    |   35580 K  |   35580 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2012    |   41849 K  |   41849 K  |
|       from large pool |       4    |     600    |   24247 K  |   24247 K  |
|       from small pool |       0    |    1974    |   17601 K  |   17601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148

 Experiment start at: 2024-07-11 01:11:04.198668
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98430294, 'precision': 0.9141085, 'recall': 0.917207, 'specificity': 0.917207, 'f1': 0.9156512, 'auroc': 0.9947984, 'binary_precision': 0.99194825, 'binary_recall': 0.9915474, 'binary_specificity': 0.84286654, 'binary_f1_score': 0.99174774}
confusion matrix:
      0      1
0  1282    239
1   251  29444
---- Validation: 
scalar performance:
{'acc': 0.77205306, 'precision': 0.81065977, 'recall': 0.7749104, 'specificity': 0.7749104, 'f1': 0.76594126, 'auroc': 0.9202009, 'binary_precision': 0.6969697, 'binary_recall': 0.94920635, 'binary_specificity': 0.6006144, 'binary_f1_score': 0.8037634}
confusion matrix:
     0    1
0  391  260
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78451884, 'precision': 0.7915444, 'recall': 0.779227, 'specificity': 0.779227, 'f1': 0.7804592, 'auroc': 0.90376806, 'binary_precision': 0.7586207, 'binary_recall': 0.8695652, 'binary_specificity': 0.6888889, 'binary_f1_score': 0.81031305}
confusion matrix:
     0    1
0  155   70
1   33  220
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 01:18:58.152721,epoch time: 0:07:53.954053,used: 0:07:53.954053,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9903895, 'precision': 0.96674323, 'recall': 0.92695594, 'specificity': 0.92695594, 'f1': 0.94586277, 'auroc': 0.9974191, 'binary_precision': 0.9926922, 'binary_recall': 0.9972386, 'binary_specificity': 0.85667324, 'binary_f1_score': 0.9949602}
confusion matrix:
      0      1
0  1303    218
1    82  29613
---- Validation: 
scalar performance:
{'acc': 0.7064793, 'precision': 0.777961, 'recall': 0.71057343, 'specificity': 0.71057343, 'f1': 0.68883985, 'auroc': 0.9268768, 'binary_precision': 0.63284516, 'binary_recall': 0.96031743, 'binary_specificity': 0.4608295, 'binary_f1_score': 0.76292557}
confusion matrix:
     0    1
0  300  351
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75941426, 'precision': 0.7942656, 'recall': 0.7486254, 'specificity': 0.7486254, 'f1': 0.7462177, 'auroc': 0.9252525, 'binary_precision': 0.70658684, 'binary_recall': 0.9328063, 'binary_specificity': 0.5644444, 'binary_f1_score': 0.8040886}
confusion matrix:
     0    1
0  127   98
1   17  236
early stop counter: 1
val acc:0.7064793109893799, best validation acc: 0.772053062915802, corresponding to test acc:                         0.784518837928772 / 0.784518837928772
after epoch: 2,now: 2024-07-11 01:26:47.398682,epoch time: 0:07:49.245961,used: 0:15:43.200014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9883393, 'precision': 0.98135114, 'recall': 0.8902507, 'specificity': 0.8902507, 'f1': 0.9305277, 'auroc': 0.9980972, 'binary_precision': 0.98893183, 'binary_recall': 0.9989224, 'binary_specificity': 0.78157896, 'binary_f1_score': 0.993902}
confusion matrix:
      0      1
0  1188    332
1    32  29664
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.7810198, 'recall': 0.7076037, 'specificity': 0.7076037, 'f1': 0.6840059, 'auroc': 0.9204862, 'binary_precision': 0.6291322, 'binary_recall': 0.96666664, 'binary_specificity': 0.44854072, 'binary_f1_score': 0.7622027}
confusion matrix:
     0    1
0  292  359
1   21  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7719665, 'precision': 0.80121887, 'recall': 0.76220465, 'specificity': 0.76220465, 'f1': 0.76130986, 'auroc': 0.9212824, 'binary_precision': 0.7208589, 'binary_recall': 0.92885375, 'binary_specificity': 0.59555554, 'binary_f1_score': 0.8117444}
confusion matrix:
     0    1
0  134   91
1   18  235
early stop counter: 2
val acc:0.7033567428588867, best validation acc: 0.772053062915802, corresponding to test acc:                         0.784518837928772 / 0.784518837928772
after epoch: 3,now: 2024-07-11 01:34:37.381206,epoch time: 0:07:49.982524,used: 0:23:33.182538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9820605, 'precision': 0.87138075, 'recall': 0.9721691, 'specificity': 0.9721691, 'f1': 0.91488266, 'auroc': 0.9968965, 'binary_precision': 0.9979831, 'binary_recall': 0.9831285, 'binary_specificity': 0.9612097, 'binary_f1_score': 0.99050015}
confusion matrix:
      0      1
0  1462     59
1   501  29194
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.8446589, 'recall': 0.8315156, 'specificity': 0.8315156, 'f1': 0.8284378, 'auroc': 0.93589103, 'binary_precision': 0.7689295, 'binary_recall': 0.9349206, 'binary_specificity': 0.7281106, 'binary_f1_score': 0.8438396}
confusion matrix:
     0    1
0  474  177
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.8382889, 'recall': 0.83897233, 'specificity': 0.83897233, 'f1': 0.8385383, 'auroc': 0.915696, 'binary_precision': 0.8548387, 'binary_recall': 0.8379447, 'binary_specificity': 0.84, 'binary_f1_score': 0.84630746}
confusion matrix:
     0    1
0  189   36
1   41  212
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 01:42:28.344647,epoch time: 0:07:50.963441,used: 0:31:24.145979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98885185, 'precision': 0.91859925, 'recall': 0.971996, 'specificity': 0.971996, 'f1': 0.9434886, 'auroc': 0.99791145, 'binary_precision': 0.99759233, 'binary_recall': 0.9906718, 'binary_specificity': 0.9533202, 'binary_f1_score': 0.99412006}
confusion matrix:
      0      1
0  1450     71
1   277  29418
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8600272, 'recall': 0.8578853, 'specificity': 0.8578853, 'f1': 0.85700345, 'auroc': 0.9315851, 'binary_precision': 0.8234443, 'binary_recall': 0.9031746, 'binary_specificity': 0.812596, 'binary_f1_score': 0.8614686}
confusion matrix:
     0    1
0  529  122
1   61  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.8407019, 'recall': 0.8387089, 'specificity': 0.8387089, 'f1': 0.8346695, 'auroc': 0.9081774, 'binary_precision': 0.9027778, 'binary_recall': 0.770751, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8315565}
confusion matrix:
     0    1
0  204   21
1   58  195
better model found
persisted
after epoch: 5,now: 2024-07-11 01:50:18.619105,epoch time: 0:07:50.274458,used: 0:39:14.420437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99324065, 'precision': 0.95028836, 'recall': 0.9802288, 'specificity': 0.9802288, 'f1': 0.9647177, 'auroc': 0.99926484, 'binary_precision': 0.99824256, 'binary_recall': 0.99464554, 'binary_specificity': 0.96581197, 'binary_f1_score': 0.9964408}
confusion matrix:
      0      1
0  1469     52
1   159  29536
---- Validation: 
scalar performance:
{'acc': 0.88602656, 'precision': 0.8861254, 'recall': 0.88620067, 'specificity': 0.88620067, 'f1': 0.88602483, 'auroc': 0.9421622, 'binary_precision': 0.874613, 'binary_recall': 0.8968254, 'binary_specificity': 0.875576, 'binary_f1_score': 0.88557994}
confusion matrix:
     0    1
0  570   81
1   65  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.84258044, 'recall': 0.82931054, 'specificity': 0.82931054, 'f1': 0.82121724, 'auroc': 0.9149934, 'binary_precision': 0.94210523, 'binary_recall': 0.7075099, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8081264}
confusion matrix:
     0    1
0  214   11
1   74  179
better model found
persisted
after epoch: 6,now: 2024-07-11 01:58:08.871647,epoch time: 0:07:50.252542,used: 0:47:04.672979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9943298, 'precision': 0.96267784, 'recall': 0.97737044, 'specificity': 0.97737044, 'f1': 0.9698956, 'auroc': 0.99915767, 'binary_precision': 0.9978748, 'binary_recall': 0.996161, 'binary_specificity': 0.9585799, 'binary_f1_score': 0.9970172}
confusion matrix:
      0      1
0  1458     63
1   114  29581
---- Validation: 
scalar performance:
{'acc': 0.81889147, 'precision': 0.8452387, 'recall': 0.82114697, 'specificity': 0.82114697, 'f1': 0.8160577, 'auroc': 0.93959236, 'binary_precision': 0.745679, 'binary_recall': 0.95873016, 'binary_specificity': 0.68356377, 'binary_f1_score': 0.83888894}
confusion matrix:
     0    1
0  445  206
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83682007, 'precision': 0.83621645, 'recall': 0.8369961, 'specificity': 0.8369961, 'f1': 0.8364737, 'auroc': 0.92251205, 'binary_precision': 0.854251, 'binary_recall': 0.8339921, 'binary_specificity': 0.84, 'binary_f1_score': 0.84400004}
confusion matrix:
     0    1
0  189   36
1   42  211
early stop counter: 1
val acc:0.8188914656639099, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8389121294021606
after epoch: 7,now: 2024-07-11 02:06:00.265718,epoch time: 0:07:51.394071,used: 0:54:56.067050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9901333, 'precision': 0.98178947, 'recall': 0.90960807, 'specificity': 0.90960807, 'f1': 0.9424567, 'auroc': 0.9982271, 'binary_precision': 0.99087995, 'binary_recall': 0.9988214, 'binary_specificity': 0.82039475, 'binary_f1_score': 0.99483484}
confusion matrix:
      0      1
0  1247    273
1    35  29661
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.84450126, 'recall': 0.8218638, 'specificity': 0.8218638, 'f1': 0.8170277, 'auroc': 0.94446635, 'binary_precision': 0.7478261, 'binary_recall': 0.95555556, 'binary_specificity': 0.68817204, 'binary_f1_score': 0.83902436}
confusion matrix:
     0    1
0  448  203
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.87089133, 'recall': 0.87106717, 'specificity': 0.87106717, 'f1': 0.8682003, 'auroc': 0.9231621, 'binary_precision': 0.920354, 'binary_recall': 0.8221344, 'binary_specificity': 0.92, 'binary_f1_score': 0.86847603}
confusion matrix:
     0    1
0  207   18
1   45  208
new oracle model saved
early stop counter: 2
val acc:0.8196721076965332, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 8,now: 2024-07-11 02:13:51.050413,epoch time: 0:07:50.784695,used: 1:02:46.851745,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9943619, 'precision': 0.98752517, 'recall': 0.95087636, 'specificity': 0.95087636, 'f1': 0.9684049, 'auroc': 0.9993325, 'binary_precision': 0.99503607, 'binary_recall': 0.99905705, 'binary_specificity': 0.9026956, 'binary_f1_score': 0.9970425}
confusion matrix:
      0      1
0  1373    148
1    28  29667
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.8409687, 'recall': 0.815745, 'specificity': 0.815745, 'f1': 0.810318, 'auroc': 0.9410504, 'binary_precision': 0.7398773, 'binary_recall': 0.95714283, 'binary_specificity': 0.67434716, 'binary_f1_score': 0.83460206}
confusion matrix:
     0    1
0  439  212
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8117155, 'precision': 0.8186877, 'recall': 0.80688626, 'specificity': 0.80688626, 'f1': 0.8084936, 'auroc': 0.91346514, 'binary_precision': 0.78397214, 'binary_recall': 0.88932806, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  163   62
1   28  225
early stop counter: 3
val acc:0.8134270310401917, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 9,now: 2024-07-11 02:21:42.551842,epoch time: 0:07:51.501429,used: 1:10:38.353174,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9948744, 'precision': 0.97347033, 'recall': 0.9711069, 'specificity': 0.9711069, 'f1': 0.9722853, 'auroc': 0.9993612, 'binary_precision': 0.997172, 'binary_recall': 0.99744064, 'binary_specificity': 0.9447732, 'binary_f1_score': 0.9973062}
confusion matrix:
      0      1
0  1437     84
1    76  29619
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.8262008, 'recall': 0.7829237, 'specificity': 0.7829237, 'f1': 0.7729796, 'auroc': 0.94937515, 'binary_precision': 0.69908464, 'binary_recall': 0.96984124, 'binary_specificity': 0.59600616, 'binary_f1_score': 0.81249994}
confusion matrix:
     0    1
0  388  263
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.82914484, 'recall': 0.8175055, 'specificity': 0.8175055, 'f1': 0.8192318, 'auroc': 0.9153447, 'binary_precision': 0.7937063, 'binary_recall': 0.8972332, 'binary_specificity': 0.73777777, 'binary_f1_score': 0.84230053}
confusion matrix:
     0    1
0  166   59
1   26  227
early stop counter: 4
val acc:0.7798594832420349, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 10,now: 2024-07-11 02:29:34.335580,epoch time: 0:07:51.783738,used: 1:18:30.136912,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99474627, 'precision': 0.9803219, 'recall': 0.96230656, 'specificity': 0.96230656, 'f1': 0.9711224, 'auroc': 0.99928594, 'binary_precision': 0.9962359, 'binary_recall': 0.9982489, 'binary_specificity': 0.92636424, 'binary_f1_score': 0.9972414}
confusion matrix:
      0      1
0  1409    112
1    52  29643
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.8401506, 'recall': 0.8082181, 'specificity': 0.8082181, 'f1': 0.80143434, 'auroc': 0.9448955, 'binary_precision': 0.72759855, 'binary_recall': 0.96666664, 'binary_specificity': 0.6497696, 'binary_f1_score': 0.8302659}
confusion matrix:
     0    1
0  423  228
1   21  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.85175675, 'recall': 0.84664035, 'specificity': 0.84664035, 'f1': 0.8479644, 'auroc': 0.9321563, 'binary_precision': 0.8339483, 'binary_recall': 0.8932806, 'binary_specificity': 0.8, 'binary_f1_score': 0.86259544}
confusion matrix:
     0    1
0  180   45
1   27  226
early stop counter: 5
val acc:0.8056206107139587, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 11,now: 2024-07-11 02:37:24.721507,epoch time: 0:07:50.385927,used: 1:26:20.522839,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9946181, 'precision': 0.9593041, 'recall': 0.9850074, 'specificity': 0.9850074, 'f1': 0.97176355, 'auroc': 0.99947083, 'binary_precision': 0.9986827, 'binary_recall': 0.99565583, 'binary_specificity': 0.974359, 'binary_f1_score': 0.99716693}
confusion matrix:
      0      1
0  1482     39
1   129  29566
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8683645, 'recall': 0.86292887, 'specificity': 0.86292887, 'f1': 0.86143625, 'auroc': 0.94697046, 'binary_precision': 0.81502086, 'binary_recall': 0.93015873, 'binary_specificity': 0.79569894, 'binary_f1_score': 0.8687917}
confusion matrix:
     0    1
0  518  133
1   44  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.8613207, 'recall': 0.86093986, 'specificity': 0.86093986, 'f1': 0.85773814, 'auroc': 0.91667986, 'binary_precision': 0.9147982, 'binary_recall': 0.8063241, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  206   19
1   49  204
early stop counter: 6
val acc:0.8618267178535461, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 12,now: 2024-07-11 02:45:14.192899,epoch time: 0:07:49.471392,used: 1:34:09.994231,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9919272, 'precision': 0.9324921, 'recall': 0.9898269, 'specificity': 0.9898269, 'f1': 0.95914924, 'auroc': 0.9993634, 'binary_precision': 0.99935555, 'binary_recall': 0.9921538, 'binary_specificity': 0.9875, 'binary_f1_score': 0.99574167}
confusion matrix:
      0      1
0  1501     19
1   233  29463
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.8765186, 'recall': 0.8749616, 'specificity': 0.8749616, 'f1': 0.8742385, 'auroc': 0.94182575, 'binary_precision': 0.8433382, 'binary_recall': 0.9142857, 'binary_specificity': 0.8356375, 'binary_f1_score': 0.87738}
confusion matrix:
     0    1
0  544  107
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.83832, 'recall': 0.8384805, 'specificity': 0.8384805, 'f1': 0.8383965, 'auroc': 0.9046289, 'binary_precision': 0.8492063, 'binary_recall': 0.8458498, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.8475247}
confusion matrix:
     0    1
0  187   38
1   39  214
early stop counter: 7
val acc:0.874316930770874, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 13,now: 2024-07-11 02:53:04.310355,epoch time: 0:07:50.117456,used: 1:42:00.111687,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9960917, 'precision': 0.9844847, 'recall': 0.97297704, 'specificity': 0.97297704, 'f1': 0.9786538, 'auroc': 0.99962324, 'binary_precision': 0.9973095, 'binary_recall': 0.99858564, 'binary_specificity': 0.94736844, 'binary_f1_score': 0.99794716}
confusion matrix:
      0      1
0  1440     80
1    42  29654
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.8707095, 'recall': 0.85724527, 'specificity': 0.85724527, 'f1': 0.85446906, 'auroc': 0.95507765, 'binary_precision': 0.791612, 'binary_recall': 0.95873016, 'binary_specificity': 0.7557604, 'binary_f1_score': 0.8671931}
confusion matrix:
     0    1
0  492  159
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8592391, 'recall': 0.85996485, 'specificity': 0.85996485, 'f1': 0.8595073, 'auroc': 0.9258673, 'binary_precision': 0.875, 'binary_recall': 0.8577075, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.86626744}
confusion matrix:
     0    1
0  194   31
1   36  217
early stop counter: 8
val acc:0.8555815815925598, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 14,now: 2024-07-11 03:00:55.392971,epoch time: 0:07:51.082616,used: 1:49:51.194303,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9949065, 'precision': 0.96647173, 'recall': 0.9795449, 'specificity': 0.9795449, 'f1': 0.9729072, 'auroc': 0.9993206, 'binary_precision': 0.9980776, 'binary_recall': 0.9965651, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.9973208}
confusion matrix:
      0      1
0  1464     57
1   102  29593
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.8608646, 'recall': 0.8515361, 'specificity': 0.8515361, 'f1': 0.8493229, 'auroc': 0.94871867, 'binary_precision': 0.79435486, 'binary_recall': 0.9380952, 'binary_specificity': 0.764977, 'binary_f1_score': 0.86026204}
confusion matrix:
     0    1
0  498  153
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85146445, 'precision': 0.85225505, 'recall': 0.8496003, 'specificity': 0.8496003, 'f1': 0.850469, 'auroc': 0.92512953, 'binary_precision': 0.844697, 'binary_recall': 0.88142294, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.8626692}
confusion matrix:
     0    1
0  184   41
1   30  223
early stop counter: 9
val acc:0.8501170873641968, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 15,now: 2024-07-11 03:08:45.682687,epoch time: 0:07:50.289716,used: 1:57:41.484019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9933047, 'precision': 0.9546238, 'recall': 0.9752722, 'specificity': 0.9752722, 'f1': 0.9646909, 'auroc': 0.99907815, 'binary_precision': 0.9977044, 'binary_recall': 0.9952517, 'binary_specificity': 0.9552926, 'binary_f1_score': 0.99647653}
confusion matrix:
      0      1
0  1453     68
1   141  29554
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.8766463, 'recall': 0.87360466, 'specificity': 0.87360466, 'f1': 0.8725767, 'auroc': 0.9421153, 'binary_precision': 0.8340486, 'binary_recall': 0.9253968, 'binary_specificity': 0.82181257, 'binary_f1_score': 0.87735134}
confusion matrix:
     0    1
0  535  116
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.8725244, 'recall': 0.86710584, 'specificity': 0.86710584, 'f1': 0.8617286, 'auroc': 0.92022836, 'binary_precision': 0.9516908, 'binary_recall': 0.7786561, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8565217}
confusion matrix:
     0    1
0  215   10
1   56  197
early stop counter: 10
val acc:0.8727556467056274, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 16,now: 2024-07-11 03:16:36.846162,epoch time: 0:07:51.163475,used: 2:05:32.647494,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99474627, 'precision': 0.9840001, 'recall': 0.9585638, 'specificity': 0.9585638, 'f1': 0.9708998, 'auroc': 0.99946797, 'binary_precision': 0.995836, 'binary_recall': 0.998653, 'binary_specificity': 0.9184747, 'binary_f1_score': 0.99724257}
confusion matrix:
      0      1
0  1397    124
1    40  29655
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.85211706, 'recall': 0.8378136, 'specificity': 0.8378136, 'f1': 0.8346386, 'auroc': 0.94557154, 'binary_precision': 0.77272725, 'binary_recall': 0.9444444, 'binary_specificity': 0.7311828, 'binary_f1_score': 0.85}
confusion matrix:
     0    1
0  476  175
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8593026, 'recall': 0.859473, 'specificity': 0.859473, 'f1': 0.85938394, 'auroc': 0.9323847, 'binary_precision': 0.86904764, 'binary_recall': 0.8656126, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.86732674}
confusion matrix:
     0    1
0  192   33
1   34  219
early stop counter: 11
val acc:0.8360655903816223, best validation acc: 0.8860265612602234, corresponding to test acc:                         0.8221757411956787 / 0.8682008385658264
after epoch: 17,now: 2024-07-11 03:24:27.727134,epoch time: 0:07:50.880972,used: 2:13:23.528466,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9939454, 'precision': 0.95991313, 'recall': 0.9762327, 'specificity': 0.9762327, 'f1': 0.9679136, 'auroc': 0.9992696, 'binary_precision': 0.9977731, 'binary_recall': 0.9958579, 'binary_specificity': 0.9566075, 'binary_f1_score': 0.9968146}
confusion matrix:
      0      1
0  1455     66
1   123  29572
---- Validation: 
scalar performance:
{'acc': 0.89617485, 'precision': 0.8974665, 'recall': 0.8966718, 'specificity': 0.8966718, 'f1': 0.8961496, 'auroc': 0.94565135, 'binary_precision': 0.8703428, 'binary_recall': 0.92698413, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.89777094}
confusion matrix:
     0    1
0  564   87
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8786611, 'precision': 0.8800673, 'recall': 0.88094866, 'specificity': 0.88094866, 'f1': 0.87864196, 'auroc': 0.9238999, 'binary_precision': 0.9220779, 'binary_recall': 0.84189725, 'binary_specificity': 0.92, 'binary_f1_score': 0.8801653}
confusion matrix:
     0    1
0  207   18
1   40  213
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-11 03:32:18.463921,epoch time: 0:07:50.736787,used: 2:21:14.265253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9936571, 'precision': 0.9466537, 'recall': 0.9904282, 'specificity': 0.9904282, 'f1': 0.96739113, 'auroc': 0.99957323, 'binary_precision': 0.9993229, 'binary_recall': 0.99400574, 'binary_specificity': 0.98685074, 'binary_f1_score': 0.99665725}
confusion matrix:
      0      1
0  1501     20
1   178  29517
---- Validation: 
scalar performance:
{'acc': 0.91100705, 'precision': 0.912753, 'recall': 0.9104967, 'specificity': 0.9104967, 'f1': 0.91081786, 'auroc': 0.9504523, 'binary_precision': 0.9358108, 'binary_recall': 0.8793651, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.9067103}
confusion matrix:
     0    1
0  613   38
1   76  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84518826, 'precision': 0.8725016, 'recall': 0.853263, 'specificity': 0.853263, 'f1': 0.84398377, 'auroc': 0.9246377, 'binary_precision': 0.989071, 'binary_recall': 0.715415, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.83027524}
confusion matrix:
     0    1
0  223    2
1   72  181
better model found
persisted
after epoch: 19,now: 2024-07-11 03:40:08.431725,epoch time: 0:07:49.967804,used: 2:29:04.233057,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9940415, 'precision': 0.9537531, 'recall': 0.9853281, 'specificity': 0.9853281, 'f1': 0.9689447, 'auroc': 0.99947685, 'binary_precision': 0.99874926, 'binary_recall': 0.9949823, 'binary_specificity': 0.9756739, 'binary_f1_score': 0.99686223}
confusion matrix:
      0      1
0  1484     37
1   149  29546
---- Validation: 
scalar performance:
{'acc': 0.88602656, 'precision': 0.8892019, 'recall': 0.88678956, 'specificity': 0.88678956, 'f1': 0.8859097, 'auroc': 0.9452692, 'binary_precision': 0.849711, 'binary_recall': 0.93333334, 'binary_specificity': 0.8402458, 'binary_f1_score': 0.88956124}
confusion matrix:
     0    1
0  547  104
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.8805778, 'recall': 0.87995607, 'specificity': 0.87995607, 'f1': 0.87656415, 'auroc': 0.92664033, 'binary_precision': 0.9369369, 'binary_recall': 0.8221344, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8757894}
confusion matrix:
     0    1
0  211   14
1   45  208
early stop counter: 1
val acc:0.8860265612602234, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.8786610960960388
after epoch: 20,now: 2024-07-11 03:47:58.626823,epoch time: 0:07:50.195098,used: 2:36:54.428155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99599564, 'precision': 0.9890435, 'recall': 0.96732974, 'specificity': 0.96732974, 'f1': 0.9779122, 'auroc': 0.99949014, 'binary_precision': 0.9967077, 'binary_recall': 0.99909073, 'binary_specificity': 0.9355687, 'binary_f1_score': 0.9978978}
confusion matrix:
      0      1
0  1423     98
1    27  29668
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.8647288, 'recall': 0.85396826, 'specificity': 0.85396826, 'f1': 0.8515544, 'auroc': 0.9491283, 'binary_precision': 0.79360855, 'binary_recall': 0.94603175, 'binary_specificity': 0.7619048, 'binary_f1_score': 0.86314267}
confusion matrix:
     0    1
0  496  155
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.8762127, 'recall': 0.8760211, 'specificity': 0.8760211, 'f1': 0.87611306, 'auroc': 0.93932366, 'binary_precision': 0.88188976, 'binary_recall': 0.8853755, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.88362914}
confusion matrix:
     0    1
0  195   30
1   29  224
early stop counter: 2
val acc:0.8524590134620667, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.8786610960960388
after epoch: 21,now: 2024-07-11 03:55:48.525743,epoch time: 0:07:49.898920,used: 2:44:44.327075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9950346, 'precision': 0.96377885, 'recall': 0.9842816, 'specificity': 0.9842816, 'f1': 0.973782, 'auroc': 0.99957895, 'binary_precision': 0.9985823, 'binary_recall': 0.9961948, 'binary_specificity': 0.9723684, 'binary_f1_score': 0.9973872}
confusion matrix:
      0      1
0  1478     42
1   113  29583
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.84079015, 'recall': 0.8334613, 'specificity': 0.8334613, 'f1': 0.8314375, 'auroc': 0.92916393, 'binary_precision': 0.7823129, 'binary_recall': 0.9126984, 'binary_specificity': 0.75422424, 'binary_f1_score': 0.8424908}
confusion matrix:
     0    1
0  491  160
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284519, 'precision': 0.8313043, 'recall': 0.8313043, 'specificity': 0.8313043, 'f1': 0.82845193, 'auroc': 0.91125166, 'binary_precision': 0.88, 'binary_recall': 0.7826087, 'binary_specificity': 0.88, 'binary_f1_score': 0.82845193}
confusion matrix:
     0    1
0  198   27
1   55  198
early stop counter: 3
val acc:0.8321623802185059, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.8786610960960388
after epoch: 22,now: 2024-07-11 04:03:38.497539,epoch time: 0:07:49.971796,used: 2:52:34.298871,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99628395, 'precision': 0.979957, 'recall': 0.979957, 'specificity': 0.979957, 'f1': 0.979957, 'auroc': 0.99971056, 'binary_precision': 0.9980468, 'binary_recall': 0.9980468, 'binary_specificity': 0.9618672, 'binary_f1_score': 0.9980468}
confusion matrix:
      0      1
0  1463     58
1    58  29637
---- Validation: 
scalar performance:
{'acc': 0.8938329, 'precision': 0.897059, 'recall': 0.894598, 'specificity': 0.894598, 'f1': 0.8937241, 'auroc': 0.9516178, 'binary_precision': 0.8569364, 'binary_recall': 0.9412698, 'binary_specificity': 0.84792626, 'binary_f1_score': 0.89712554}
confusion matrix:
     0    1
0  552   99
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8702929, 'precision': 0.8821942, 'recall': 0.87574875, 'specificity': 0.87574875, 'f1': 0.8700654, 'auroc': 0.9271848, 'binary_precision': 0.96585363, 'binary_recall': 0.7826087, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8646288}
confusion matrix:
     0    1
0  218    7
1   55  198
early stop counter: 4
val acc:0.8938329219818115, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.8786610960960388
after epoch: 23,now: 2024-07-11 04:11:28.832626,epoch time: 0:07:50.335087,used: 3:00:24.633958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9960597, 'precision': 0.97607195, 'recall': 0.9817105, 'specificity': 0.9817105, 'f1': 0.97887266, 'auroc': 0.99964166, 'binary_precision': 0.99824774, 'binary_recall': 0.997609, 'binary_specificity': 0.96581197, 'binary_f1_score': 0.99792826}
confusion matrix:
      0      1
0  1469     52
1    71  29624
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.87089777, 'recall': 0.8609319, 'specificity': 0.8609319, 'f1': 0.85870767, 'auroc': 0.9529028, 'binary_precision': 0.80160856, 'binary_recall': 0.94920635, 'binary_specificity': 0.77265745, 'binary_f1_score': 0.869186}
confusion matrix:
     0    1
0  503  148
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9079498, 'precision': 0.90773326, 'recall': 0.9091085, 'specificity': 0.9091085, 'f1': 0.90784657, 'auroc': 0.94960034, 'binary_precision': 0.93360996, 'binary_recall': 0.88932806, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.9109312}
confusion matrix:
     0    1
0  209   16
1   28  225
new oracle model saved
early stop counter: 5
val acc:0.8594847917556763, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.9079498052597046
after epoch: 24,now: 2024-07-11 04:19:19.635322,epoch time: 0:07:50.802696,used: 3:08:15.436654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9970208, 'precision': 0.98291457, 'recall': 0.98502266, 'specificity': 0.98502266, 'f1': 0.98396605, 'auroc': 0.99974644, 'binary_precision': 0.9985516, 'binary_recall': 0.9983162, 'binary_specificity': 0.9717291, 'binary_f1_score': 0.9984339}
confusion matrix:
      0      1
0  1478     43
1    50  29645
---- Validation: 
scalar performance:
{'acc': 0.852459, 'precision': 0.86652124, 'recall': 0.85407066, 'specificity': 0.85407066, 'f1': 0.85140276, 'auroc': 0.947107, 'binary_precision': 0.7905138, 'binary_recall': 0.95238096, 'binary_specificity': 0.7557604, 'binary_f1_score': 0.8639309}
confusion matrix:
     0    1
0  492  159
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.8756877, 'recall': 0.8562846, 'specificity': 0.8562846, 'f1': 0.85889864, 'auroc': 0.9645499, 'binary_precision': 0.8169491, 'binary_recall': 0.9525692, 'binary_specificity': 0.76, 'binary_f1_score': 0.879562}
confusion matrix:
     0    1
0  171   54
1   12  241
early stop counter: 6
val acc:0.8524590134620667, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.9079498052597046
after epoch: 25,now: 2024-07-11 04:27:09.577568,epoch time: 0:07:49.942246,used: 3:16:05.378900,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9919913, 'precision': 0.9924824, 'recall': 0.92062426, 'specificity': 0.92062426, 'f1': 0.95341945, 'auroc': 0.9997475, 'binary_precision': 0.99194705, 'binary_recall': 0.9996969, 'binary_specificity': 0.8415516, 'binary_f1_score': 0.99580693}
confusion matrix:
      0      1
0  1280    241
1     9  29686
---- Validation: 
scalar performance:
{'acc': 0.72131145, 'precision': 0.80738515, 'recall': 0.7256017, 'specificity': 0.7256017, 'f1': 0.7027632, 'auroc': 0.9568386, 'binary_precision': 0.6405767, 'binary_recall': 0.9873016, 'binary_specificity': 0.4639017, 'binary_f1_score': 0.7770144}
confusion matrix:
     0    1
0  302  349
1    8  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7656904, 'precision': 0.81457996, 'recall': 0.7535705, 'specificity': 0.7535705, 'f1': 0.74992996, 'auroc': 0.9471936, 'binary_precision': 0.70434785, 'binary_recall': 0.9604743, 'binary_specificity': 0.5466667, 'binary_f1_score': 0.8127091}
confusion matrix:
     0    1
0  123  102
1   10  243
early stop counter: 7
val acc:0.7213114500045776, best validation acc: 0.9110070466995239, corresponding to test acc:                         0.8451882600784302 / 0.9079498052597046
after epoch: 26,now: 2024-07-11 04:34:57.051473,epoch time: 0:07:47.473905,used: 3:23:52.852805,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99573934, 'precision': 0.96591204, 'recall': 0.98996323, 'specificity': 0.98996323, 'f1': 0.9775987, 'auroc': 0.9997511, 'binary_precision': 0.99915576, 'binary_recall': 0.99636304, 'binary_specificity': 0.9835634, 'binary_f1_score': 0.9977575}
confusion matrix:
      0      1
0  1496     25
1   108  29587
---- Validation: 
scalar performance:
{'acc': 0.9117877, 'precision': 0.9146041, 'recall': 0.9111367, 'specificity': 0.9111367, 'f1': 0.91152346, 'auroc': 0.9559432, 'binary_precision': 0.94492257, 'binary_recall': 0.87142855, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.90668863}
confusion matrix:
     0    1
0  619   32
1   81  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.87781394, 'recall': 0.8611682, 'specificity': 0.8611682, 'f1': 0.85262513, 'auroc': 0.95209485, 'binary_precision': 0.98930484, 'binary_recall': 0.7312253, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8409091}
confusion matrix:
     0    1
0  223    2
1   68  185
better model found
persisted
after epoch: 27,now: 2024-07-11 04:42:45.903941,epoch time: 0:07:48.852468,used: 3:31:41.705273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99663633, 'precision': 0.9882616, 'recall': 0.9751359, 'specificity': 0.9751359, 'f1': 0.9815992, 'auroc': 0.9996612, 'binary_precision': 0.9975117, 'binary_recall': 0.9989561, 'binary_specificity': 0.95131576, 'binary_f1_score': 0.9982334}
confusion matrix:
      0      1
0  1446     74
1    31  29665
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.849401, 'recall': 0.8235535, 'specificity': 0.8235535, 'f1': 0.81825453, 'auroc': 0.94694364, 'binary_precision': 0.7460123, 'binary_recall': 0.96507937, 'binary_specificity': 0.68202764, 'binary_f1_score': 0.8415225}
confusion matrix:
     0    1
0  444  207
1   22  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619247, 'precision': 0.8639832, 'recall': 0.85948175, 'specificity': 0.85948175, 'f1': 0.8607447, 'auroc': 0.942679, 'binary_precision': 0.84758365, 'binary_recall': 0.90118575, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.87356323}
confusion matrix:
     0    1
0  184   41
1   25  228
early stop counter: 1
val acc:0.8212333917617798, best validation acc: 0.9117876887321472, corresponding to test acc:                         0.8535565137863159 / 0.9079498052597046
after epoch: 28,now: 2024-07-11 04:50:35.410961,epoch time: 0:07:49.507020,used: 3:39:31.212293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99003714, 'precision': 0.9845787, 'recall': 0.90618575, 'specificity': 0.90618575, 'f1': 0.9415582, 'auroc': 0.9990587, 'binary_precision': 0.99051815, 'binary_recall': 0.99909073, 'binary_specificity': 0.81328076, 'binary_f1_score': 0.994786}
confusion matrix:
      0      1
0  1237    284
1    27  29668
---- Validation: 
scalar performance:
{'acc': 0.75800157, 'precision': 0.81769645, 'recall': 0.76152074, 'specificity': 0.76152074, 'f1': 0.7476872, 'auroc': 0.9375174, 'binary_precision': 0.67582417, 'binary_recall': 0.97619045, 'binary_specificity': 0.546851, 'binary_f1_score': 0.7987013}
confusion matrix:
     0    1
0  356  295
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8096234, 'precision': 0.8316149, 'recall': 0.80171275, 'specificity': 0.80171275, 'f1': 0.8031008, 'auroc': 0.93043476, 'binary_precision': 0.75961536, 'binary_recall': 0.9367589, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.8389381}
confusion matrix:
     0    1
0  150   75
1   16  237
early stop counter: 2
val acc:0.7580015659332275, best validation acc: 0.9117876887321472, corresponding to test acc:                         0.8535565137863159 / 0.9079498052597046
after epoch: 29,now: 2024-07-11 04:58:24.694758,epoch time: 0:07:49.283797,used: 3:47:20.496090,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9919913, 'precision': 0.9320631, 'recall': 0.9914241, 'specificity': 0.9914241, 'f1': 0.9595908, 'auroc': 0.9995618, 'binary_precision': 0.999525, 'binary_recall': 0.99205256, 'binary_specificity': 0.99079555, 'binary_f1_score': 0.9957747}
confusion matrix:
      0      1
0  1507     14
1   236  29459
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.87915695, 'recall': 0.8731183, 'specificity': 0.8731183, 'f1': 0.87158054, 'auroc': 0.9429449, 'binary_precision': 0.8227147, 'binary_recall': 0.94285715, 'binary_specificity': 0.8033794, 'binary_f1_score': 0.8786982}
confusion matrix:
     0    1
0  523  128
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.8480246, 'recall': 0.8454019, 'specificity': 0.8454019, 'f1': 0.84625685, 'auroc': 0.91999996, 'binary_precision': 0.84090906, 'binary_recall': 0.8774704, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.8588007}
confusion matrix:
     0    1
0  183   42
1   31  222
early stop counter: 3
val acc:0.8719750046730042, best validation acc: 0.9117876887321472, corresponding to test acc:                         0.8535565137863159 / 0.9079498052597046
after epoch: 30,now: 2024-07-11 05:06:14.014453,epoch time: 0:07:49.319695,used: 3:55:09.815785,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_01_11_04_seed_1_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 3:55:09.815785 at 2024-07-11 05:06:14.014453
persisted model performance metric: 

scalar performance:
{'acc': 0.8535565, 'precision': 0.87781394, 'recall': 0.8611682, 'specificity': 0.8611682, 'f1': 0.85262513, 'auroc': 0.95209485, 'binary_precision': 0.98930484, 'binary_recall': 0.7312253, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8409091}
confusion matrix:
     0    1
0  223    2
1   68  185
oracle model performance metric: 

scalar performance:
{'acc': 0.9079498, 'precision': 0.90773326, 'recall': 0.9091085, 'specificity': 0.9091085, 'f1': 0.90784657, 'auroc': 0.94960034, 'binary_precision': 0.93360996, 'binary_recall': 0.88932806, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.9109312}
confusion matrix:
     0    1
0  209   16
1   28  225
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB | 719370 GiB | 719370 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 709743 GiB | 709743 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB | 719370 GiB | 719370 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 709743 GiB | 709743 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 715930 GiB | 715930 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 706325 GiB | 706325 GiB |
|       from small pool |  40408 KiB |     56 MiB |   9605 GiB |   9605 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  28072 MiB |  13598 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1253 MiB | 541650 GiB | 541649 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 531993 GiB | 531993 GiB |
|       from small pool |  12646 KiB |     46 MiB |   9656 GiB |   9656 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4907    |  135898 K  |  135896 K  |
|       from large pool |     187    |    1413    |   64939 K  |   64938 K  |
|       from small pool |    1129    |    4718    |   70958 K  |   70957 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4907    |  135898 K  |  135896 K  |
|       from large pool |     187    |    1413    |   64939 K  |   64938 K  |
|       from small pool |    1129    |    4718    |   70958 K  |   70957 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1205    |     571    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |    2022    |   81191 K  |   81191 K  |
|       from large pool |      40    |     604    |   46095 K  |   46095 K  |
|       from small pool |      60    |    1980    |   35095 K  |   35095 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 719370 GiB | 719370 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 709743 GiB | 709743 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 719370 GiB | 719370 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 709743 GiB | 709743 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 715930 GiB | 715930 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 706325 GiB | 706325 GiB |
|       from small pool |      0 KiB |     56 MiB |   9605 GiB |   9605 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 541650 GiB | 541650 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531994 GiB | 531994 GiB |
|       from small pool |      0 KiB |     46 MiB |   9656 GiB |   9656 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70958 K  |   70958 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70958 K  |   70958 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2022    |   81191 K  |   81191 K  |
|       from large pool |       4    |     604    |   46095 K  |   46095 K  |
|       from small pool |       0    |    1980    |   35095 K  |   35095 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 719370 GiB | 719370 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 709743 GiB | 709743 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 719370 GiB | 719370 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 709743 GiB | 709743 GiB |
|       from small pool |      0 KiB |     56 MiB |   9626 GiB |   9626 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 715930 GiB | 715930 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 706325 GiB | 706325 GiB |
|       from small pool |      0 KiB |     56 MiB |   9605 GiB |   9605 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 541650 GiB | 541650 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531994 GiB | 531994 GiB |
|       from small pool |      0 KiB |     46 MiB |   9656 GiB |   9656 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70958 K  |   70958 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64939 K  |   64939 K  |
|       from small pool |       0    |    4718    |   70958 K  |   70958 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2022    |   81191 K  |   81191 K  |
|       from large pool |       4    |     604    |   46095 K  |   46095 K  |
|       from small pool |       0    |    1980    |   35095 K  |   35095 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148

 Experiment start at: 2024-07-11 05:16:15.463995
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9825344, 'precision': 0.970438, 'recall': 0.83334935, 'specificity': 0.83334935, 'f1': 0.8889977, 'auroc': 0.99589837, 'binary_precision': 0.98340917, 'binary_recall': 0.99849296, 'binary_specificity': 0.6682058, 'binary_f1_score': 0.99089366}
confusion matrix:
      0      1
0  1013    503
1    45  29815
---- Validation: 
scalar performance:
{'acc': 0.51877934, 'precision': 0.71950674, 'recall': 0.531125, 'specificity': 0.531125, 'f1': 0.39664176, 'auroc': 0.816216, 'binary_precision': 0.5028432, 'binary_recall': 0.99517685, 'binary_specificity': 0.067073174, 'binary_f1_score': 0.6681057}
confusion matrix:
    0    1
0  44  612
1   3  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5726316, 'precision': 0.7217442, 'recall': 0.5308612, 'specificity': 0.5308612, 'f1': 0.42281562, 'auroc': 0.83597887, 'binary_precision': 0.56113535, 'binary_recall': 0.992278, 'binary_specificity': 0.06944445, 'binary_f1_score': 0.71687585}
confusion matrix:
    0    1
0  15  201
1   2  257
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 05:24:10.145170,epoch time: 0:07:54.681175,used: 0:07:54.681175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9848292, 'precision': 0.8976103, 'recall': 0.95195645, 'specificity': 0.95195645, 'f1': 0.92281425, 'auroc': 0.99595207, 'binary_precision': 0.9956815, 'binary_recall': 0.9883456, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.992}
confusion matrix:
      0      1
0  1388    128
1   348  29512
---- Validation: 
scalar performance:
{'acc': 0.78403753, 'precision': 0.8057637, 'recall': 0.7875093, 'specificity': 0.7875093, 'f1': 0.78141445, 'auroc': 0.89142764, 'binary_precision': 0.71733665, 'binary_recall': 0.9180064, 'binary_specificity': 0.6570122, 'binary_f1_score': 0.8053596}
confusion matrix:
     0    1
0  431  225
1   51  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81473684, 'precision': 0.8131314, 'recall': 0.8135904, 'specificity': 0.8135904, 'f1': 0.8133462, 'auroc': 0.89571714, 'binary_precision': 0.8326848, 'binary_recall': 0.82625484, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8294574}
confusion matrix:
     0    1
0  173   43
1   45  214
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 05:32:01.140385,epoch time: 0:07:50.995215,used: 0:15:45.676390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9899286, 'precision': 0.9583931, 'recall': 0.92959, 'specificity': 0.92959, 'f1': 0.9434706, 'auroc': 0.9972086, 'binary_precision': 0.9930574, 'binary_recall': 0.99638313, 'binary_specificity': 0.86279684, 'binary_f1_score': 0.9947175}
confusion matrix:
      0      1
0  1308    208
1   108  29752
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.8025011, 'recall': 0.7914992, 'specificity': 0.7914992, 'f1': 0.7872689, 'auroc': 0.8772229, 'binary_precision': 0.73097116, 'binary_recall': 0.8954984, 'binary_specificity': 0.6875, 'binary_f1_score': 0.8049133}
confusion matrix:
     0    1
0  451  205
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79157895, 'precision': 0.78999996, 'recall': 0.7915863, 'specificity': 0.7915863, 'f1': 0.7905056, 'auroc': 0.8803625, 'binary_precision': 0.82, 'binary_recall': 0.7915058, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.805501}
confusion matrix:
     0    1
0  171   45
1   54  205
better model found
persisted
after epoch: 3,now: 2024-07-11 05:39:52.883231,epoch time: 0:07:51.742846,used: 0:23:37.419236,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9906617, 'precision': 0.9292275, 'recall': 0.97756183, 'specificity': 0.97756183, 'f1': 0.9519434, 'auroc': 0.9987751, 'binary_precision': 0.99811316, 'binary_recall': 0.992063, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9950788}
confusion matrix:
      0      1
0  1460     56
1   237  29623
---- Validation: 
scalar performance:
{'acc': 0.8262911, 'precision': 0.82627004, 'recall': 0.8260014, 'specificity': 0.8260014, 'f1': 0.8261032, 'auroc': 0.9005715, 'binary_precision': 0.8257329, 'binary_recall': 0.81511253, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.8203884}
confusion matrix:
     0    1
0  549  107
1  115  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7389474, 'precision': 0.78077316, 'recall': 0.75523734, 'specificity': 0.75523734, 'f1': 0.7356563, 'auroc': 0.90418994, 'binary_precision': 0.9141104, 'binary_recall': 0.57528955, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.70616114}
confusion matrix:
     0    1
0  202   14
1  110  149
better model found
persisted
after epoch: 4,now: 2024-07-11 05:47:43.582092,epoch time: 0:07:50.698861,used: 0:31:28.118097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9937213, 'precision': 0.96627015, 'recall': 0.9653942, 'specificity': 0.9653942, 'f1': 0.9658317, 'auroc': 0.9988731, 'binary_precision': 0.99665135, 'binary_recall': 0.9967515, 'binary_specificity': 0.9340369, 'binary_f1_score': 0.9967014}
confusion matrix:
      0      1
0  1416    100
1    97  29763
---- Validation: 
scalar performance:
{'acc': 0.84115803, 'precision': 0.84765804, 'recall': 0.8429829, 'specificity': 0.8429829, 'f1': 0.84081876, 'auroc': 0.917678, 'binary_precision': 0.793007, 'binary_recall': 0.91157556, 'binary_specificity': 0.7743902, 'binary_f1_score': 0.84816754}
confusion matrix:
     0    1
0  508  148
1   55  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84205806, 'recall': 0.84444267, 'specificity': 0.84444267, 'f1': 0.8398801, 'auroc': 0.91645217, 'binary_precision': 0.8995633, 'binary_recall': 0.7953668, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.84426236}
confusion matrix:
     0    1
0  193   23
1   53  206
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-11 05:55:36.144072,epoch time: 0:07:52.561980,used: 0:39:20.680077,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9948368, 'precision': 0.972486, 'recall': 0.9713025, 'specificity': 0.9713025, 'f1': 0.9718934, 'auroc': 0.9990641, 'binary_precision': 0.99722075, 'binary_recall': 0.9973543, 'binary_specificity': 0.94525063, 'binary_f1_score': 0.9972876}
confusion matrix:
      0      1
0  1433     83
1    79  29781
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.7978709, 'recall': 0.74446857, 'specificity': 0.74446857, 'f1': 0.7279062, 'auroc': 0.9157572, 'binary_precision': 0.65824175, 'binary_recall': 0.96302253, 'binary_specificity': 0.5259146, 'binary_f1_score': 0.7819844}
confusion matrix:
     0    1
0  345  311
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7978947, 'precision': 0.8253846, 'recall': 0.7835425, 'specificity': 0.7835425, 'f1': 0.78666073, 'auroc': 0.90637064, 'binary_precision': 0.75076926, 'binary_recall': 0.94208497, 'binary_specificity': 0.625, 'binary_f1_score': 0.8356165}
confusion matrix:
     0    1
0  135   81
1   15  244
early stop counter: 1
val acc:0.7386541366577148, best validation acc: 0.8411580324172974, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 6,now: 2024-07-11 06:03:27.511815,epoch time: 0:07:51.367743,used: 0:47:12.047820,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9915222, 'precision': 0.93743694, 'recall': 0.9761355, 'specificity': 0.9761355, 'f1': 0.95586467, 'auroc': 0.99886036, 'binary_precision': 0.9979137, 'binary_recall': 0.9931681, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.99553525}
confusion matrix:
      0      1
0  1454     62
1   204  29656
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8167682, 'recall': 0.81238973, 'specificity': 0.81238973, 'f1': 0.81275856, 'auroc': 0.894496, 'binary_precision': 0.841637, 'binary_recall': 0.7604502, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.7989865}
confusion matrix:
     0    1
0  567   89
1  149  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6568421, 'precision': 0.77533334, 'recall': 0.6845596, 'specificity': 0.6845596, 'f1': 0.63507867, 'auroc': 0.94331837, 'binary_precision': 0.98, 'binary_recall': 0.3783784, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.545961}
confusion matrix:
     0   1
0  214   2
1  161  98
early stop counter: 2
val acc:0.8137715458869934, best validation acc: 0.8411580324172974, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 7,now: 2024-07-11 06:11:19.861199,epoch time: 0:07:52.349384,used: 0:55:04.397204,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9875382, 'precision': 0.8991593, 'recall': 0.9896959, 'specificity': 0.9896959, 'f1': 0.9391892, 'auroc': 0.9993942, 'binary_precision': 0.99959314, 'binary_recall': 0.9873074, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9934123}
confusion matrix:
      0      1
0  1504     12
1   379  29481
---- Validation: 
scalar performance:
{'acc': 0.7206573, 'precision': 0.800619, 'recall': 0.7136475, 'specificity': 0.7136475, 'f1': 0.6964357, 'auroc': 0.92666996, 'binary_precision': 0.9491525, 'binary_recall': 0.45016077, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.610687}
confusion matrix:
     0    1
0  641   15
1  342  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.45894736, 'precision': 0.7283298, 'recall': 0.503861, 'specificity': 0.503861, 'f1': 0.32116067, 'auroc': 0.89982843, 'binary_precision': 1.0, 'binary_recall': 0.0077220076, 'binary_specificity': 1.0, 'binary_f1_score': 0.01532567}
confusion matrix:
     0  1
0  216  0
1  257  2
early stop counter: 3
val acc:0.7206572890281677, best validation acc: 0.8411580324172974, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 8,now: 2024-07-11 06:19:10.052928,epoch time: 0:07:50.191729,used: 1:02:54.588933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9931476, 'precision': 0.9772219, 'recall': 0.9469347, 'specificity': 0.9469347, 'f1': 0.96152604, 'auroc': 0.9991863, 'binary_precision': 0.9947265, 'binary_recall': 0.9980911, 'binary_specificity': 0.89577836, 'binary_f1_score': 0.9964059}
confusion matrix:
      0      1
0  1358    158
1    57  29803
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8390751, 'recall': 0.83524334, 'specificity': 0.83524334, 'f1': 0.8357018, 'auroc': 0.91350925, 'binary_precision': 0.8629174, 'binary_recall': 0.7893891, 'binary_specificity': 0.88109756, 'binary_f1_score': 0.8245172}
confusion matrix:
     0    1
0  578   78
1  131  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80421054, 'precision': 0.8295196, 'recall': 0.81662023, 'specificity': 0.81662023, 'f1': 0.8034264, 'auroc': 0.93062705, 'binary_precision': 0.94623655, 'binary_recall': 0.6795367, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.7910113}
confusion matrix:
     0    1
0  206   10
1   83  176
early stop counter: 4
val acc:0.836463212966919, best validation acc: 0.8411580324172974, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 9,now: 2024-07-11 06:27:02.377471,epoch time: 0:07:52.324543,used: 1:10:46.913476,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9951237, 'precision': 0.98394215, 'recall': 0.96237415, 'specificity': 0.96237415, 'f1': 0.97288465, 'auroc': 0.9994782, 'binary_precision': 0.9962581, 'binary_recall': 0.99862695, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.9974411}
confusion matrix:
      0      1
0  1404    112
1    41  29819
---- Validation: 
scalar performance:
{'acc': 0.8740219, 'precision': 0.8745898, 'recall': 0.87462014, 'specificity': 0.87462014, 'f1': 0.8740219, 'auroc': 0.931797, 'binary_precision': 0.8519084, 'binary_recall': 0.8971061, 'binary_specificity': 0.85213417, 'binary_f1_score': 0.8739233}
confusion matrix:
     0    1
0  559   97
1   64  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.86376476, 'recall': 0.8660536, 'specificity': 0.8660536, 'f1': 0.8609781, 'auroc': 0.92537177, 'binary_precision': 0.92511016, 'binary_recall': 0.8108108, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.86419755}
confusion matrix:
     0    1
0  199   17
1   49  210
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-11 06:34:53.838939,epoch time: 0:07:51.461468,used: 1:18:38.374944,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9951874, 'precision': 0.9651228, 'recall': 0.9840095, 'specificity': 0.9840095, 'f1': 0.974356, 'auroc': 0.9994116, 'binary_precision': 0.9985568, 'binary_recall': 0.99638313, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9974688}
confusion matrix:
      0      1
0  1473     43
1   108  29752
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.86829066, 'recall': 0.8672482, 'specificity': 0.8672482, 'f1': 0.86616105, 'auroc': 0.93400764, 'binary_precision': 0.83308715, 'binary_recall': 0.9067524, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.8683603}
confusion matrix:
     0    1
0  543  113
1   58  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.8621912, 'recall': 0.8606374, 'specificity': 0.8606374, 'f1': 0.85261524, 'auroc': 0.94024384, 'binary_precision': 0.9478673, 'binary_recall': 0.77220076, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.85106385}
confusion matrix:
     0    1
0  205   11
1   59  200
early stop counter: 1
val acc:0.8661971688270569, best validation acc: 0.8740218877792358, corresponding to test acc:                         0.8610526323318481 / 0.8610526323318481
after epoch: 11,now: 2024-07-11 06:42:45.108521,epoch time: 0:07:51.269582,used: 1:26:29.644526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9949006, 'precision': 0.96248573, 'recall': 0.9838588, 'specificity': 0.9838588, 'f1': 0.9729021, 'auroc': 0.9995076, 'binary_precision': 0.9985564, 'binary_recall': 0.9960817, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9973175}
confusion matrix:
      0      1
0  1473     43
1   117  29743
---- Validation: 
scalar performance:
{'acc': 0.75665104, 'precision': 0.81562114, 'recall': 0.7507916, 'specificity': 0.7507916, 'f1': 0.7417486, 'auroc': 0.93126035, 'binary_precision': 0.9455587, 'binary_recall': 0.5305466, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.67971164}
confusion matrix:
     0    1
0  637   19
1  292  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48210526, 'precision': 0.7003623, 'recall': 0.5247122, 'specificity': 0.5247122, 'f1': 0.36914226, 'auroc': 0.91891897, 'binary_precision': 0.93333334, 'binary_recall': 0.054054055, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.10218978}
confusion matrix:
     0   1
0  215   1
1  245  14
early stop counter: 2
val acc:0.7566510438919067, best validation acc: 0.8740218877792358, corresponding to test acc:                         0.8610526323318481 / 0.8610526323318481
after epoch: 12,now: 2024-07-11 06:50:35.442719,epoch time: 0:07:50.334198,used: 1:34:19.978724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9907891, 'precision': 0.98090065, 'recall': 0.9168931, 'specificity': 0.9168931, 'f1': 0.94636595, 'auroc': 0.99873924, 'binary_precision': 0.99168634, 'binary_recall': 0.9986939, 'binary_specificity': 0.83509237, 'binary_f1_score': 0.99517775}
confusion matrix:
      0      1
0  1266    250
1    39  29821
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.7978709, 'recall': 0.74446857, 'specificity': 0.74446857, 'f1': 0.7279062, 'auroc': 0.9334513, 'binary_precision': 0.65824175, 'binary_recall': 0.96302253, 'binary_specificity': 0.5259146, 'binary_f1_score': 0.7819844}
confusion matrix:
     0    1
0  345  311
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747368, 'precision': 0.8237623, 'recall': 0.75577366, 'specificity': 0.75577366, 'f1': 0.75588495, 'auroc': 0.9183469, 'binary_precision': 0.7183908, 'binary_recall': 0.96525097, 'binary_specificity': 0.5462963, 'binary_f1_score': 0.82372326}
confusion matrix:
     0    1
0  118   98
1    9  250
early stop counter: 3
val acc:0.7386541366577148, best validation acc: 0.8740218877792358, corresponding to test acc:                         0.8610526323318481 / 0.8610526323318481
after epoch: 13,now: 2024-07-11 06:58:25.866523,epoch time: 0:07:50.423804,used: 1:42:10.402528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9949324, 'precision': 0.97657144, 'recall': 0.967909, 'specificity': 0.967909, 'f1': 0.97219586, 'auroc': 0.9994515, 'binary_precision': 0.996855, 'binary_recall': 0.9978232, 'binary_specificity': 0.9379947, 'binary_f1_score': 0.99733883}
confusion matrix:
      0      1
0  1422     94
1    65  29795
---- Validation: 
scalar performance:
{'acc': 0.8239437, 'precision': 0.848542, 'recall': 0.8274645, 'specificity': 0.8274645, 'f1': 0.82177424, 'auroc': 0.9364811, 'binary_precision': 0.74905896, 'binary_recall': 0.9598071, 'binary_specificity': 0.69512194, 'binary_f1_score': 0.84143764}
confusion matrix:
     0    1
0  456  200
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88, 'precision': 0.8795656, 'recall': 0.88265944, 'specificity': 0.88265944, 'f1': 0.87969285, 'auroc': 0.92698056, 'binary_precision': 0.92083335, 'binary_recall': 0.85328186, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8857715}
confusion matrix:
     0    1
0  197   19
1   38  221
new oracle model saved
early stop counter: 4
val acc:0.8239436745643616, best validation acc: 0.8740218877792358, corresponding to test acc:                         0.8610526323318481 / 0.8799999952316284
after epoch: 14,now: 2024-07-11 07:06:16.289753,epoch time: 0:07:50.423230,used: 1:50:00.825758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9956655, 'precision': 0.9736375, 'recall': 0.97956467, 'specificity': 0.97956467, 'f1': 0.9765805, 'auroc': 0.99940526, 'binary_precision': 0.9980563, 'binary_recall': 0.9973878, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.99772197}
confusion matrix:
      0      1
0  1458     58
1    78  29782
---- Validation: 
scalar performance:
{'acc': 0.8873239, 'precision': 0.8872134, 'recall': 0.88741076, 'specificity': 0.88741076, 'f1': 0.8872773, 'auroc': 0.9415119, 'binary_precision': 0.8793651, 'binary_recall': 0.89067525, 'binary_specificity': 0.88414633, 'binary_f1_score': 0.884984}
confusion matrix:
     0    1
0  580   76
1   68  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7894737, 'precision': 0.83681375, 'recall': 0.8061812, 'specificity': 0.8061812, 'f1': 0.7868196, 'auroc': 0.9316996, 'binary_precision': 0.9877301, 'binary_recall': 0.6216216, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.7630332}
confusion matrix:
     0    1
0  214    2
1   98  161
better model found
persisted
after epoch: 15,now: 2024-07-11 07:14:05.855557,epoch time: 0:07:49.565804,used: 1:57:50.391562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9899605, 'precision': 0.9848279, 'recall': 0.904248, 'specificity': 0.904248, 'f1': 0.9404945, 'auroc': 0.9976579, 'binary_precision': 0.990406, 'binary_recall': 0.9991293, 'binary_specificity': 0.80936676, 'binary_f1_score': 0.9947485}
confusion matrix:
      0      1
0  1227    289
1    26  29834
---- Validation: 
scalar performance:
{'acc': 0.8435055, 'precision': 0.85486984, 'recall': 0.84589446, 'specificity': 0.84589446, 'f1': 0.8427936, 'auroc': 0.9356276, 'binary_precision': 0.78436655, 'binary_recall': 0.9356913, 'binary_specificity': 0.75609756, 'binary_f1_score': 0.8533724}
confusion matrix:
     0    1
0  496  160
1   40  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85263157, 'precision': 0.85833156, 'recall': 0.8591002, 'specificity': 0.8591002, 'f1': 0.8526257, 'auroc': 0.9371872, 'binary_precision': 0.9315069, 'binary_recall': 0.7876448, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.85355645}
confusion matrix:
     0    1
0  201   15
1   55  204
early stop counter: 1
val acc:0.8435055017471313, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.7894737124443054 / 0.8799999952316284
after epoch: 16,now: 2024-07-11 07:21:55.049128,epoch time: 0:07:49.193571,used: 2:05:39.585133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9676823, 'precision': 0.79962665, 'recall': 0.9827077, 'specificity': 0.9827077, 'f1': 0.86599314, 'auroc': 0.99936306, 'binary_precision': 0.9999653, 'binary_recall': 0.966075, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98272806}
confusion matrix:
      0      1
0  1515      1
1  1013  28847
---- Validation: 
scalar performance:
{'acc': 0.6651017, 'precision': 0.78860855, 'recall': 0.6561985, 'specificity': 0.6561985, 'f1': 0.6177033, 'auroc': 0.9370025, 'binary_precision': 0.9708738, 'binary_recall': 0.3215434, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.48309177}
confusion matrix:
     0    1
0  650    6
1  422  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4568421, 'precision': 0.7278481, 'recall': 0.5019305, 'specificity': 0.5019305, 'f1': 0.31688964, 'auroc': 0.9258187, 'binary_precision': 1.0, 'binary_recall': 0.0038610038, 'binary_specificity': 1.0, 'binary_f1_score': 0.007692308}
confusion matrix:
     0  1
0  216  0
1  258  1
early stop counter: 2
val acc:0.6651017069816589, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.7894737124443054 / 0.8799999952316284
after epoch: 17,now: 2024-07-11 07:29:43.606942,epoch time: 0:07:48.557814,used: 2:13:28.142947,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9928289, 'precision': 0.9901241, 'recall': 0.9311137, 'specificity': 0.9311137, 'f1': 0.95852345, 'auroc': 0.9994037, 'binary_precision': 0.9930784, 'binary_recall': 0.99943066, 'binary_specificity': 0.86279684, 'binary_f1_score': 0.9962444}
confusion matrix:
      0      1
0  1308    208
1    17  29843
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.83138245, 'recall': 0.7875265, 'specificity': 0.7875265, 'f1': 0.7760761, 'auroc': 0.9396347, 'binary_precision': 0.6972477, 'binary_recall': 0.977492, 'binary_specificity': 0.597561, 'binary_f1_score': 0.8139224}
confusion matrix:
     0    1
0  392  264
1   14  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.8686038, 'recall': 0.8680109, 'specificity': 0.8680109, 'f1': 0.8682916, 'auroc': 0.94297874, 'binary_precision': 0.8773946, 'binary_recall': 0.8841699, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.88076925}
confusion matrix:
     0    1
0  184   32
1   30  229
early stop counter: 3
val acc:0.7824726104736328, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.7894737124443054 / 0.8799999952316284
after epoch: 18,now: 2024-07-11 07:37:34.513249,epoch time: 0:07:50.906307,used: 2:21:19.049254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9963029, 'precision': 0.972143, 'recall': 0.98866546, 'specificity': 0.98866546, 'f1': 0.9802455, 'auroc': 0.99969625, 'binary_precision': 0.9989934, 'binary_recall': 0.9971199, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9980558}
confusion matrix:
      0      1
0  1486     30
1    86  29774
---- Validation: 
scalar performance:
{'acc': 0.86150235, 'precision': 0.8756891, 'recall': 0.8589253, 'specificity': 0.8589253, 'f1': 0.8594885, 'auroc': 0.94926137, 'binary_precision': 0.9423459, 'binary_recall': 0.7620579, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.8426666}
confusion matrix:
     0    1
0  627   29
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7263158, 'precision': 0.81213874, 'recall': 0.74903476, 'specificity': 0.74903476, 'f1': 0.7168159, 'auroc': 0.9427284, 'binary_precision': 1.0, 'binary_recall': 0.4980695, 'binary_specificity': 1.0, 'binary_f1_score': 0.66494846}
confusion matrix:
     0    1
0  216    0
1  130  129
early stop counter: 4
val acc:0.8615023493766785, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.7894737124443054 / 0.8799999952316284
after epoch: 19,now: 2024-07-11 07:45:24.040792,epoch time: 0:07:49.527543,used: 2:29:08.576797,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9953468, 'precision': 0.9689611, 'recall': 0.98127556, 'specificity': 0.98127556, 'f1': 0.9750292, 'auroc': 0.9994401, 'binary_precision': 0.9982561, 'binary_recall': 0.996852, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9975535}
confusion matrix:
      0      1
0  1464     52
1    94  29766
---- Validation: 
scalar performance:
{'acc': 0.8834116, 'precision': 0.88730824, 'recall': 0.8820999, 'specificity': 0.8820999, 'f1': 0.8827909, 'auroc': 0.9438255, 'binary_precision': 0.92007107, 'binary_recall': 0.8327974, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.8742616}
confusion matrix:
     0    1
0  611   45
1  104  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8336842, 'precision': 0.8538449, 'recall': 0.8448002, 'specificity': 0.8448002, 'f1': 0.8333267, 'auroc': 0.92975116, 'binary_precision': 0.96391755, 'binary_recall': 0.72200775, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.8256071}
confusion matrix:
     0    1
0  209    7
1   72  187
early stop counter: 5
val acc:0.8834115862846375, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.7894737124443054 / 0.8799999952316284
after epoch: 20,now: 2024-07-11 07:53:11.792664,epoch time: 0:07:47.751872,used: 2:36:56.328669,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9912991, 'precision': 0.9262259, 'recall': 0.9910457, 'specificity': 0.9910457, 'f1': 0.95605093, 'auroc': 0.99958694, 'binary_precision': 0.9995273, 'binary_recall': 0.9913262, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.99540985}
confusion matrix:
      0      1
0  1502     14
1   259  29601
---- Validation: 
scalar performance:
{'acc': 0.84663534, 'precision': 0.867131, 'recall': 0.8434853, 'specificity': 0.8434853, 'f1': 0.8435315, 'auroc': 0.94567335, 'binary_precision': 0.947479, 'binary_recall': 0.7250804, 'binary_specificity': 0.9618902, 'binary_f1_score': 0.8214936}
confusion matrix:
     0    1
0  631   25
1  171  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5263158, 'precision': 0.7185355, 'recall': 0.56486845, 'specificity': 0.56486845, 'f1': 0.44893035, 'auroc': 0.92957246, 'binary_precision': 0.94736844, 'binary_recall': 0.13899614, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.24242425}
confusion matrix:
     0   1
0  214   2
1  223  36
early stop counter: 6
val acc:0.8466353416442871, best validation acc: 0.8873239159584045, corresponding to test acc:                         0.7894737124443054 / 0.8799999952316284
after epoch: 21,now: 2024-07-11 08:01:00.888172,epoch time: 0:07:49.095508,used: 2:44:45.424177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9962073, 'precision': 0.9872843, 'recall': 0.9710833, 'specificity': 0.9710833, 'f1': 0.97903144, 'auroc': 0.9993875, 'binary_precision': 0.99712497, 'binary_recall': 0.9988949, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.99800915}
confusion matrix:
      0      1
0  1430     86
1    33  29827
---- Validation: 
scalar performance:
{'acc': 0.899061, 'precision': 0.89939654, 'recall': 0.8986771, 'specificity': 0.8986771, 'f1': 0.89891243, 'auroc': 0.94384754, 'binary_precision': 0.90609556, 'binary_recall': 0.8842444, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.89503664}
confusion matrix:
     0    1
0  599   57
1   72  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8442105, 'precision': 0.8498591, 'recall': 0.85060954, 'specificity': 0.85060954, 'f1': 0.8442043, 'auroc': 0.93148506, 'binary_precision': 0.9223744, 'binary_recall': 0.7799228, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8451883}
confusion matrix:
     0    1
0  199   17
1   57  202
better model found
persisted
after epoch: 22,now: 2024-07-11 08:08:50.762954,epoch time: 0:07:49.874782,used: 2:52:35.298959,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9949962, 'precision': 0.9810767, 'recall': 0.96387255, 'specificity': 0.96387255, 'f1': 0.9723002, 'auroc': 0.99940693, 'binary_precision': 0.9964234, 'binary_recall': 0.9983255, 'binary_specificity': 0.9294195, 'binary_f1_score': 0.9973735}
confusion matrix:
      0      1
0  1409    107
1    50  29810
---- Validation: 
scalar performance:
{'acc': 0.8967136, 'precision': 0.8966688, 'recall': 0.8965988, 'specificity': 0.8965988, 'f1': 0.8966316, 'auroc': 0.9466733, 'binary_precision': 0.8951613, 'binary_recall': 0.89228296, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.8937198}
confusion matrix:
     0    1
0  591   65
1   67  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.79214287, 'recall': 0.7741581, 'specificity': 0.7741581, 'f1': 0.7581985, 'auroc': 0.90595955, 'binary_precision': 0.9142857, 'binary_recall': 0.6177606, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.73732716}
confusion matrix:
     0    1
0  201   15
1   99  160
early stop counter: 1
val acc:0.8967136144638062, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 23,now: 2024-07-11 08:16:39.225117,epoch time: 0:07:48.462163,used: 3:00:23.761122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9926696, 'precision': 0.9389361, 'recall': 0.988635, 'specificity': 0.988635, 'f1': 0.96228755, 'auroc': 0.99940777, 'binary_precision': 0.99919134, 'binary_recall': 0.9931011, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.99613696}
confusion matrix:
      0      1
0  1492     24
1   206  29654
---- Validation: 
scalar performance:
{'acc': 0.899061, 'precision': 0.89931667, 'recall': 0.8987187, 'specificity': 0.8987187, 'f1': 0.89892435, 'auroc': 0.9461905, 'binary_precision': 0.9047619, 'binary_recall': 0.8858521, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.89520717}
confusion matrix:
     0    1
0  598   58
1   71  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7936842, 'precision': 0.8324196, 'recall': 0.80888927, 'specificity': 0.80888927, 'f1': 0.79181576, 'auroc': 0.9333441, 'binary_precision': 0.9707602, 'binary_recall': 0.64092666, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.772093}
confusion matrix:
     0    1
0  211    5
1   93  166
early stop counter: 2
val acc:0.8990610241889954, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 24,now: 2024-07-11 08:24:27.493811,epoch time: 0:07:48.268694,used: 3:08:12.029816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.992797, 'precision': 0.93691325, 'recall': 0.9933981, 'specificity': 0.9933981, 'f1': 0.9632247, 'auroc': 0.9997442, 'binary_precision': 0.9996965, 'binary_recall': 0.99273276, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.99620247}
confusion matrix:
      0      1
0  1507      9
1   217  29643
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.8397269, 'recall': 0.80003524, 'specificity': 0.80003524, 'f1': 0.79747564, 'auroc': 0.94485605, 'binary_precision': 0.94285715, 'binary_recall': 0.6366559, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.76007676}
confusion matrix:
     0    1
0  632   24
1  226  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5221053, 'precision': 0.7437923, 'recall': 0.56177604, 'specificity': 0.56177604, 'f1': 0.43773502, 'auroc': 0.9115187, 'binary_precision': 1.0, 'binary_recall': 0.12355212, 'binary_specificity': 1.0, 'binary_f1_score': 0.21993127}
confusion matrix:
     0   1
0  216   0
1  227  32
early stop counter: 3
val acc:0.8043818473815918, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 25,now: 2024-07-11 08:32:17.389823,epoch time: 0:07:49.896012,used: 3:16:01.925828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9939444, 'precision': 0.9610204, 'recall': 0.9742774, 'specificity': 0.9742774, 'f1': 0.9675438, 'auroc': 0.99921167, 'binary_precision': 0.997585, 'binary_recall': 0.9960482, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.996816}
confusion matrix:
      0      1
0  1444     72
1   118  29742
---- Validation: 
scalar performance:
{'acc': 0.8748044, 'precision': 0.880381, 'recall': 0.87646556, 'specificity': 0.87646556, 'f1': 0.87461245, 'auroc': 0.94244814, 'binary_precision': 0.82719547, 'binary_recall': 0.9389067, 'binary_specificity': 0.8140244, 'binary_f1_score': 0.87951803}
confusion matrix:
     0    1
0  534  122
1   38  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86315787, 'precision': 0.8634583, 'recall': 0.86644685, 'specificity': 0.86644685, 'f1': 0.8629149, 'auroc': 0.9312885, 'binary_precision': 0.91101694, 'binary_recall': 0.83011585, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.8686869}
confusion matrix:
     0    1
0  195   21
1   44  215
early stop counter: 4
val acc:0.8748043775558472, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 26,now: 2024-07-11 08:40:05.554691,epoch time: 0:07:48.164868,used: 3:23:50.090696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.994295, 'precision': 0.98420054, 'recall': 0.95285976, 'specificity': 0.95285976, 'f1': 0.96794736, 'auroc': 0.99926984, 'binary_precision': 0.9952942, 'binary_recall': 0.9987274, 'binary_specificity': 0.9069921, 'binary_f1_score': 0.9970078}
confusion matrix:
      0      1
0  1375    141
1    38  29822
---- Validation: 
scalar performance:
{'acc': 0.86776215, 'precision': 0.8700448, 'recall': 0.86885583, 'specificity': 0.86885583, 'f1': 0.8677193, 'auroc': 0.91978025, 'binary_precision': 0.83357877, 'binary_recall': 0.90996784, 'binary_specificity': 0.8277439, 'binary_f1_score': 0.8700999}
confusion matrix:
     0    1
0  543  113
1   56  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8063158, 'precision': 0.8196356, 'recall': 0.8154762, 'specificity': 0.8154762, 'f1': 0.80617064, 'auroc': 0.90711695, 'binary_precision': 0.91133004, 'binary_recall': 0.71428573, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.8008658}
confusion matrix:
     0    1
0  198   18
1   74  185
early stop counter: 5
val acc:0.8677621483802795, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 27,now: 2024-07-11 08:47:54.658913,epoch time: 0:07:49.104222,used: 3:31:39.194918,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9928927, 'precision': 0.994093, 'recall': 0.9283296, 'specificity': 0.9283296, 'f1': 0.95861447, 'auroc': 0.9997513, 'binary_precision': 0.9927837, 'binary_recall': 0.9997991, 'binary_specificity': 0.85686016, 'binary_f1_score': 0.996279}
confusion matrix:
      0      1
0  1299    217
1     6  29854
---- Validation: 
scalar performance:
{'acc': 0.7785602, 'precision': 0.82376385, 'recall': 0.7834655, 'specificity': 0.7834655, 'f1': 0.77247524, 'auroc': 0.9341767, 'binary_precision': 0.6959538, 'binary_recall': 0.9678457, 'binary_specificity': 0.5990854, 'binary_f1_score': 0.8096839}
confusion matrix:
     0    1
0  393  263
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8294737, 'precision': 0.8290882, 'recall': 0.8263353, 'specificity': 0.8263353, 'f1': 0.8274052, 'auroc': 0.91419995, 'binary_precision': 0.83208954, 'binary_recall': 0.8610039, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.8462998}
confusion matrix:
     0    1
0  171   45
1   36  223
early stop counter: 6
val acc:0.778560221195221, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 28,now: 2024-07-11 08:55:42.838408,epoch time: 0:07:48.179495,used: 3:39:27.374413,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9949962, 'precision': 0.95795476, 'recall': 0.99079657, 'specificity': 0.99079657, 'f1': 0.9737386, 'auroc': 0.99970984, 'binary_precision': 0.999294, 'binary_recall': 0.99544543, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.997366}
confusion matrix:
      0      1
0  1495     21
1   136  29724
---- Validation: 
scalar performance:
{'acc': 0.8489828, 'precision': 0.86351776, 'recall': 0.8463135, 'specificity': 0.8463135, 'f1': 0.8466687, 'auroc': 0.9370687, 'binary_precision': 0.9298597, 'binary_recall': 0.7459807, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.8278323}
confusion matrix:
     0    1
0  621   35
1  158  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48842105, 'precision': 0.7352941, 'recall': 0.530888, 'specificity': 0.530888, 'f1': 0.37818182, 'auroc': 0.90864074, 'binary_precision': 1.0, 'binary_recall': 0.06177606, 'binary_specificity': 1.0, 'binary_f1_score': 0.11636364}
confusion matrix:
     0   1
0  216   0
1  243  16
early stop counter: 7
val acc:0.8489828109741211, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.8799999952316284
after epoch: 29,now: 2024-07-11 09:03:32.875422,epoch time: 0:07:50.037014,used: 3:47:17.411427,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9934982, 'precision': 0.9819356, 'recall': 0.94617975, 'specificity': 0.94617975, 'f1': 0.963292, 'auroc': 0.99945307, 'binary_precision': 0.9946294, 'binary_recall': 0.99855995, 'binary_specificity': 0.8937995, 'binary_f1_score': 0.9965908}
confusion matrix:
      0      1
0  1355    161
1    43  29817
---- Validation: 
scalar performance:
{'acc': 0.8395931, 'precision': 0.8592198, 'recall': 0.84270847, 'specificity': 0.84270847, 'f1': 0.8381422, 'auroc': 0.9458058, 'binary_precision': 0.76833975, 'binary_recall': 0.9598071, 'binary_specificity': 0.7256098, 'binary_f1_score': 0.85346675}
confusion matrix:
     0    1
0  476  180
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8905263, 'precision': 0.88994396, 'recall': 0.8930806, 'specificity': 0.8930806, 'f1': 0.8902222, 'auroc': 0.94553477, 'binary_precision': 0.9294606, 'binary_recall': 0.8648649, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.89599997}
confusion matrix:
     0    1
0  199   17
1   35  224
new oracle model saved
early stop counter: 8
val acc:0.8395931124687195, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.8442105054855347 / 0.890526294708252
after epoch: 30,now: 2024-07-11 09:11:21.435150,epoch time: 0:07:48.559728,used: 3:55:05.971155,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_05_16_15_seed_2_21870148
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 3:55:05.971155 at 2024-07-11 09:11:21.435150
persisted model performance metric: 

scalar performance:
{'acc': 0.8442105, 'precision': 0.8498591, 'recall': 0.85060954, 'specificity': 0.85060954, 'f1': 0.8442043, 'auroc': 0.93148506, 'binary_precision': 0.9223744, 'binary_recall': 0.7799228, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8451883}
confusion matrix:
     0    1
0  199   17
1   57  202
oracle model performance metric: 

scalar performance:
{'acc': 0.8905263, 'precision': 0.88994396, 'recall': 0.8930806, 'specificity': 0.8930806, 'f1': 0.8902222, 'auroc': 0.94553477, 'binary_precision': 0.9294606, 'binary_recall': 0.8648649, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.89599997}
confusion matrix:
     0    1
0  199   17
1   35  224
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB |   1050 TiB |   1050 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1036 TiB |   1036 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB |   1050 TiB |   1050 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1036 TiB |   1036 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB |   1047 TiB |   1047 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1032 TiB |   1032 TiB |
|       from small pool |  40408 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41664 MiB |  27190 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     66 MiB |     94 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1253 MiB |    791 TiB |    791 TiB |
|       from large pool | 435388 KiB |   1244 MiB |    777 TiB |    777 TiB |
|       from small pool |  12646 KiB |     46 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4927    |  203709 K  |  203707 K  |
|       from large pool |     187    |    1413    |   97267 K  |   97267 K  |
|       from small pool |    1129    |    4738    |  106441 K  |  106440 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4927    |  203709 K  |  203707 K  |
|       from large pool |     187    |    1413    |   97267 K  |   97267 K  |
|       from small pool |    1129    |    4738    |  106441 K  |  106440 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1776    |    1142    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      33    |      47    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |    2034    |  121530 K  |  121529 K  |
|       from large pool |      40    |     604    |   67990 K  |   67990 K  |
|       from small pool |      56    |    1992    |   53539 K  |   53539 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1050 TiB |   1050 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1036 TiB |   1036 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1050 TiB |   1050 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1036 TiB |   1036 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1047 TiB |   1047 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1032 TiB |   1032 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41664 MiB |  40782 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     66 MiB |     94 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB |    791 TiB |    791 TiB |
|       from large pool |  24320 KiB |   1244 MiB |    777 TiB |    777 TiB |
|       from small pool |      0 KiB |     47 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4927    |  203709 K  |  203709 K  |
|       from large pool |       2    |    1413    |   97267 K  |   97267 K  |
|       from small pool |       0    |    4738    |  106441 K  |  106441 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4927    |  203709 K  |  203709 K  |
|       from large pool |       2    |    1413    |   97267 K  |   97267 K  |
|       from small pool |       0    |    4738    |  106441 K  |  106441 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1776    |    1713    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      33    |      47    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2034    |  121530 K  |  121530 K  |
|       from large pool |       4    |     604    |   67990 K  |   67990 K  |
|       from small pool |       0    |    1992    |   53539 K  |   53539 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Thu Jul 11 09:16:54 2024]
Finished job 0.
1 of 1 steps (100%) done
