Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jul 11 11:49:07 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152

 Experiment start at: 2024-07-11 11:55:54.193900
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9747621, 'precision': 0.966385, 'recall': 0.7520604, 'specificity': 0.7520604, 'f1': 0.8241922, 'auroc': 0.9943733, 'binary_precision': 0.975217, 'binary_recall': 0.9988508, 'binary_specificity': 0.50527006, 'binary_f1_score': 0.98689246}
confusion matrix:
     0      1
0  767    751
1   34  29552
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5256211, 'precision': 0.7434595, 'recall': 0.5321376, 'specificity': 0.5321376, 'f1': 0.3991065, 'auroc': 0.9166295, 'binary_precision': 0.5096463, 'binary_recall': 0.9984252, 'binary_specificity': 0.06584992, 'binary_f1_score': 0.6748271}
confusion matrix:
    0    1
0  43  610
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60618556, 'precision': 0.7575023, 'recall': 0.5567614, 'specificity': 0.5567614, 'f1': 0.4756341, 'auroc': 0.9048579, 'binary_precision': 0.58643323, 'binary_recall': 0.9925926, 'binary_specificity': 0.12093023, 'binary_f1_score': 0.73727643}
confusion matrix:
    0    1
0  26  189
1   2  268
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 12:06:41.463219,epoch time: 0:10:47.269319,used: 0:10:47.269319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9855324, 'precision': 0.90177155, 'recall': 0.9561223, 'specificity': 0.9561223, 'f1': 0.9269954, 'auroc': 0.9965774, 'binary_precision': 0.99605024, 'binary_recall': 0.98871124, 'binary_specificity': 0.92353326, 'binary_f1_score': 0.99236715}
confusion matrix:
      0      1
0  1401    116
1   334  29253
---- Validation: 
scalar performance:
{'acc': 0.79736024, 'precision': 0.8068228, 'recall': 0.7985687, 'specificity': 0.7985687, 'f1': 0.79620445, 'auroc': 0.8887509, 'binary_precision': 0.7493333, 'binary_recall': 0.8850394, 'binary_specificity': 0.712098, 'binary_f1_score': 0.8115524}
confusion matrix:
     0    1
0  465  188
1   73  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7917526, 'precision': 0.7891095, 'recall': 0.79117143, 'specificity': 0.79117143, 'f1': 0.7898622, 'auroc': 0.85967267, 'binary_precision': 0.8237548, 'binary_recall': 0.7962963, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.8097928}
confusion matrix:
     0    1
0  169   46
1   55  215
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 12:17:14.790512,epoch time: 0:10:33.327293,used: 0:21:20.596612,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9908372, 'precision': 0.9447499, 'recall': 0.9583363, 'specificity': 0.9583363, 'f1': 0.95142835, 'auroc': 0.9980066, 'binary_precision': 0.9960049, 'binary_recall': 0.99435526, 'binary_specificity': 0.9223173, 'binary_f1_score': 0.99517936}
confusion matrix:
      0      1
0  1401    118
1   167  29418
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.8327788, 'recall': 0.7981225, 'specificity': 0.7981225, 'f1': 0.7908139, 'auroc': 0.94019127, 'binary_precision': 0.7183099, 'binary_recall': 0.9637795, 'binary_specificity': 0.63246554, 'binary_f1_score': 0.8231338}
confusion matrix:
     0    1
0  413  240
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80824745, 'precision': 0.81869936, 'recall': 0.7955642, 'specificity': 0.7955642, 'f1': 0.8000851, 'auroc': 0.9186046, 'binary_precision': 0.7827476, 'binary_recall': 0.9074074, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.84048027}
confusion matrix:
     0    1
0  147   68
1   25  245
new oracle model saved
early stop counter: 1
val acc:0.7958074808120728, best validation acc: 0.7973602414131165, corresponding to test acc:                         0.7917525768280029 / 0.808247447013855
after epoch: 3,now: 2024-07-11 12:27:48.016436,epoch time: 0:10:33.225924,used: 0:31:53.822536,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.973669, 'precision': 0.82515186, 'recall': 0.98365915, 'specificity': 0.98365915, 'f1': 0.88631594, 'auroc': 0.99860483, 'binary_precision': 0.99972206, 'binary_recall': 0.97258836, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.9859686}
confusion matrix:
      0      1
0  1510      8
1   811  28775
---- Validation: 
scalar performance:
{'acc': 0.88586956, 'precision': 0.8881973, 'recall': 0.88533723, 'specificity': 0.88533723, 'f1': 0.8855781, 'auroc': 0.9419156, 'binary_precision': 0.914966, 'binary_recall': 0.8472441, 'binary_specificity': 0.9234303, 'binary_f1_score': 0.8798037}
confusion matrix:
     0    1
0  603   50
1   97  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83505154, 'precision': 0.85294986, 'recall': 0.8485358, 'specificity': 0.8485358, 'f1': 0.83496666, 'auroc': 0.9222739, 'binary_precision': 0.96568626, 'binary_recall': 0.72962964, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.83122367}
confusion matrix:
     0    1
0  208    7
1   73  197
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 12:38:22.756321,epoch time: 0:10:34.739885,used: 0:42:28.562421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98887604, 'precision': 0.91355556, 'recall': 0.98165345, 'specificity': 0.98165345, 'f1': 0.9446707, 'auroc': 0.9986099, 'binary_precision': 0.99863577, 'binary_recall': 0.9896573, 'binary_specificity': 0.97364956, 'binary_f1_score': 0.99412626}
confusion matrix:
      0      1
0  1478     40
1   306  29280
---- Validation: 
scalar performance:
{'acc': 0.8493789, 'precision': 0.8515838, 'recall': 0.8499355, 'specificity': 0.8499355, 'f1': 0.84926116, 'auroc': 0.9188627, 'binary_precision': 0.820029, 'binary_recall': 0.8897638, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.8534743}
confusion matrix:
     0    1
0  529  124
1   70  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8185567, 'precision': 0.818675, 'recall': 0.82282513, 'specificity': 0.82282513, 'f1': 0.8179926, 'auroc': 0.88304913, 'binary_precision': 0.87603307, 'binary_recall': 0.78518516, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.828125}
confusion matrix:
     0    1
0  185   30
1   58  212
early stop counter: 1
val acc:0.8493788838386536, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8350515365600586
after epoch: 5,now: 2024-07-11 12:48:54.604857,epoch time: 0:10:31.848536,used: 0:53:00.410957,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9913194, 'precision': 0.9303899, 'recall': 0.98543084, 'specificity': 0.98543084, 'f1': 0.95604396, 'auroc': 0.99915785, 'binary_precision': 0.99891084, 'binary_recall': 0.99195594, 'binary_specificity': 0.97890574, 'binary_f1_score': 0.99542123}
confusion matrix:
      0      1
0  1485     32
1   238  29349
---- Validation: 
scalar performance:
{'acc': 0.83618015, 'precision': 0.8445405, 'recall': 0.8372659, 'specificity': 0.8372659, 'f1': 0.8354635, 'auroc': 0.91216314, 'binary_precision': 0.78726286, 'binary_recall': 0.9149606, 'binary_specificity': 0.7595712, 'binary_f1_score': 0.8463219}
confusion matrix:
     0    1
0  496  157
1   54  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80618554, 'precision': 0.8058562, 'recall': 0.7998708, 'specificity': 0.7998708, 'f1': 0.8019411, 'auroc': 0.88113695, 'binary_precision': 0.8076923, 'binary_recall': 0.85555553, 'binary_specificity': 0.74418604, 'binary_f1_score': 0.83093524}
confusion matrix:
     0    1
0  160   55
1   39  231
early stop counter: 2
val acc:0.8361801505088806, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8350515365600586
after epoch: 6,now: 2024-07-11 12:59:28.415888,epoch time: 0:10:33.811031,used: 1:03:34.221988,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98739713, 'precision': 0.9025932, 'recall': 0.9821335, 'specificity': 0.9821335, 'f1': 0.9383014, 'auroc': 0.9985137, 'binary_precision': 0.9987699, 'binary_recall': 0.9879669, 'binary_specificity': 0.9763002, 'binary_f1_score': 0.993339}
confusion matrix:
      0      1
0  1483     36
1   356  29229
---- Validation: 
scalar performance:
{'acc': 0.8835404, 'precision': 0.8842801, 'recall': 0.8838649, 'specificity': 0.8838649, 'f1': 0.8835266, 'auroc': 0.9408183, 'binary_precision': 0.8635682, 'binary_recall': 0.9070866, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.8847926}
confusion matrix:
     0    1
0  562   91
1   59  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.857746, 'recall': 0.8612834, 'specificity': 0.8612834, 'f1': 0.8587847, 'auroc': 0.9106805, 'binary_precision': 0.89453125, 'binary_recall': 0.84814817, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.87072253}
confusion matrix:
     0    1
0  188   27
1   41  229
new oracle model saved
early stop counter: 3
val acc:0.8835403919219971, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 7,now: 2024-07-11 13:10:02.753349,epoch time: 0:10:34.337461,used: 1:14:08.559449,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99112654, 'precision': 0.93805957, 'recall': 0.9712912, 'specificity': 0.9712912, 'f1': 0.953992, 'auroc': 0.9986677, 'binary_precision': 0.9973866, 'binary_recall': 0.9932736, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.99532586}
confusion matrix:
      0      1
0  1442     77
1   199  29386
---- Validation: 
scalar performance:
{'acc': 0.83618015, 'precision': 0.8374897, 'recall': 0.8366148, 'specificity': 0.8366148, 'f1': 0.83611846, 'auroc': 0.90398765, 'binary_precision': 0.81268436, 'binary_recall': 0.86771655, 'binary_specificity': 0.805513, 'binary_f1_score': 0.8392994}
confusion matrix:
     0    1
0  526  127
1   84  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.8294185, 'recall': 0.8280792, 'specificity': 0.8280792, 'f1': 0.8164823, 'auroc': 0.89610684, 'binary_precision': 0.92890996, 'binary_recall': 0.7259259, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.81496876}
confusion matrix:
     0    1
0  200   15
1   74  196
early stop counter: 4
val acc:0.8361801505088806, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 8,now: 2024-07-11 13:20:35.502539,epoch time: 0:10:32.749190,used: 1:24:41.308639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99318415, 'precision': 0.9591478, 'recall': 0.9683134, 'specificity': 0.9683134, 'f1': 0.9636799, 'auroc': 0.9987327, 'binary_precision': 0.9969546, 'binary_recall': 0.9958763, 'binary_specificity': 0.9407505, 'binary_f1_score': 0.99641514}
confusion matrix:
      0      1
0  1429     90
1   122  29463
---- Validation: 
scalar performance:
{'acc': 0.8330745, 'precision': 0.84869397, 'recall': 0.8345504, 'specificity': 0.8345504, 'f1': 0.8315882, 'auroc': 0.93267655, 'binary_precision': 0.77131784, 'binary_recall': 0.9401575, 'binary_specificity': 0.72894335, 'binary_f1_score': 0.8474095}
confusion matrix:
     0    1
0  476  177
1   38  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84948456, 'precision': 0.85373735, 'recall': 0.85723513, 'specificity': 0.85723513, 'f1': 0.84935904, 'auroc': 0.91981053, 'binary_precision': 0.930131, 'binary_recall': 0.7888889, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.85370743}
confusion matrix:
     0    1
0  199   16
1   57  213
early stop counter: 5
val acc:0.8330745100975037, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 9,now: 2024-07-11 13:31:07.148039,epoch time: 0:10:31.645500,used: 1:35:12.954139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9947595, 'precision': 0.9764601, 'recall': 0.96662223, 'specificity': 0.96662223, 'f1': 0.97148395, 'auroc': 0.9993063, 'binary_precision': 0.9966913, 'binary_recall': 0.99780303, 'binary_specificity': 0.9354414, 'binary_f1_score': 0.99724686}
confusion matrix:
      0      1
0  1420     98
1    65  29521
---- Validation: 
scalar performance:
{'acc': 0.8757764, 'precision': 0.87849927, 'recall': 0.8763816, 'specificity': 0.8763816, 'f1': 0.8756565, 'auroc': 0.9492662, 'binary_precision': 0.8427128, 'binary_recall': 0.91968507, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.87951803}
confusion matrix:
     0    1
0  544  109
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85773194, 'precision': 0.8561821, 'recall': 0.860379, 'specificity': 0.860379, 'f1': 0.8569437, 'auroc': 0.91822565, 'binary_precision': 0.90039843, 'binary_recall': 0.837037, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.86756235}
confusion matrix:
     0    1
0  190   25
1   44  226
early stop counter: 6
val acc:0.8757764101028442, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 10,now: 2024-07-11 13:41:42.728689,epoch time: 0:10:35.580650,used: 1:45:48.534789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9875257, 'precision': 0.98810697, 'recall': 0.8760996, 'specificity': 0.8760996, 'f1': 0.9240824, 'auroc': 0.9986435, 'binary_precision': 0.98747915, 'binary_recall': 0.99956065, 'binary_specificity': 0.7526385, 'binary_f1_score': 0.9934832}
confusion matrix:
      0      1
0  1141    375
1    13  29575
---- Validation: 
scalar performance:
{'acc': 0.6513975, 'precision': 0.78599256, 'recall': 0.65613705, 'specificity': 0.65613705, 'f1': 0.60880435, 'auroc': 0.94902635, 'binary_precision': 0.58627087, 'binary_recall': 0.9952756, 'binary_specificity': 0.31699848, 'binary_f1_score': 0.7378867}
confusion matrix:
     0    1
0  207  446
1    3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948454, 'precision': 0.79228735, 'recall': 0.6581826, 'specificity': 0.6581826, 'f1': 0.6374308, 'auroc': 0.94142985, 'binary_precision': 0.6495098, 'binary_recall': 0.9814815, 'binary_specificity': 0.33488372, 'binary_f1_score': 0.7817109}
confusion matrix:
    0    1
0  72  143
1   5  265
early stop counter: 7
val acc:0.6513975262641907, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 11,now: 2024-07-11 13:52:28.605805,epoch time: 0:10:45.877116,used: 1:56:34.411905,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9932806, 'precision': 0.9507508, 'recall': 0.9802189, 'specificity': 0.9802189, 'f1': 0.9649612, 'auroc': 0.99922615, 'binary_precision': 0.9982362, 'binary_recall': 0.99469346, 'binary_specificity': 0.9657444, 'binary_f1_score': 0.99646163}
confusion matrix:
      0      1
0  1466     52
1   157  29429
---- Validation: 
scalar performance:
{'acc': 0.875, 'precision': 0.88346577, 'recall': 0.87605, 'specificity': 0.87605, 'f1': 0.8745037, 'auroc': 0.9525901, 'binary_precision': 0.82288826, 'binary_recall': 0.9511811, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.8823959}
confusion matrix:
     0    1
0  523  130
1   31  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.82949257, 'recall': 0.81231695, 'specificity': 0.81231695, 'f1': 0.8165012, 'auroc': 0.9309733, 'binary_precision': 0.80263156, 'binary_recall': 0.9037037, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.8501741}
confusion matrix:
     0    1
0  155   60
1   26  244
early stop counter: 8
val acc:0.875, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 12,now: 2024-07-11 14:03:01.771310,epoch time: 0:10:33.165505,used: 2:07:07.577410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98540384, 'precision': 0.97141826, 'recall': 0.866485, 'specificity': 0.866485, 'f1': 0.91167396, 'auroc': 0.9970777, 'binary_precision': 0.9865384, 'binary_recall': 0.9982762, 'binary_specificity': 0.7346939, 'binary_f1_score': 0.9923725}
confusion matrix:
      0      1
0  1116    403
1    51  29534
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.7959049, 'recall': 0.6806393, 'specificity': 0.6806393, 'f1': 0.64300585, 'auroc': 0.9440143, 'binary_precision': 0.6042065, 'binary_recall': 0.9952756, 'binary_specificity': 0.36600307, 'binary_f1_score': 0.7519334}
confusion matrix:
     0    1
0  239  414
1    3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948454, 'precision': 0.80348116, 'recall': 0.65723515, 'specificity': 0.65723515, 'f1': 0.63455117, 'auroc': 0.9574332, 'binary_precision': 0.64805824, 'binary_recall': 0.98888886, 'binary_specificity': 0.3255814, 'binary_f1_score': 0.7829912}
confusion matrix:
    0    1
0  70  145
1   3  267
early stop counter: 9
val acc:0.6762422323226929, best validation acc: 0.885869562625885, corresponding to test acc:                         0.8350515365600586 / 0.8597938418388367
after epoch: 13,now: 2024-07-11 14:13:37.728058,epoch time: 0:10:35.956748,used: 2:17:43.534158,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9874936, 'precision': 0.89949334, 'recall': 0.9899865, 'specificity': 0.9899865, 'f1': 0.93950355, 'auroc': 0.9994148, 'binary_precision': 0.99962354, 'binary_recall': 0.9872241, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.99338514}
confusion matrix:
      0      1
0  1506     11
1   378  29209
---- Validation: 
scalar performance:
{'acc': 0.9006211, 'precision': 0.90167105, 'recall': 0.9002761, 'specificity': 0.9002761, 'f1': 0.9004829, 'auroc': 0.9495484, 'binary_precision': 0.91900826, 'binary_recall': 0.87559056, 'binary_specificity': 0.9249617, 'binary_f1_score': 0.89677423}
confusion matrix:
     0    1
0  604   49
1   79  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.828866, 'precision': 0.8570093, 'recall': 0.84534883, 'specificity': 0.84534883, 'f1': 0.8284459, 'auroc': 0.94380707, 'binary_precision': 0.9895288, 'binary_recall': 0.7, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8199566}
confusion matrix:
     0    1
0  213    2
1   81  189
better model found
persisted
after epoch: 14,now: 2024-07-11 14:24:40.654221,epoch time: 0:11:02.926163,used: 2:28:46.460321,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9927341, 'precision': 0.9897351, 'recall': 0.9312297, 'specificity': 0.9312297, 'f1': 0.9584193, 'auroc': 0.99909914, 'binary_precision': 0.9930143, 'binary_recall': 0.99939156, 'binary_specificity': 0.8630678, 'binary_f1_score': 0.99619263}
confusion matrix:
      0      1
0  1311    208
1    18  29567
---- Validation: 
scalar performance:
{'acc': 0.69409937, 'precision': 0.80323505, 'recall': 0.69825035, 'specificity': 0.69825035, 'f1': 0.6665852, 'auroc': 0.9632851, 'binary_precision': 0.6177908, 'binary_recall': 0.9952756, 'binary_specificity': 0.40122512, 'binary_f1_score': 0.7623643}
confusion matrix:
     0    1
0  262  391
1    3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79793817, 'precision': 0.84208393, 'recall': 0.77588284, 'specificity': 0.77588284, 'f1': 0.7804172, 'auroc': 0.9617226, 'binary_precision': 0.7443182, 'binary_recall': 0.97037035, 'binary_specificity': 0.5813953, 'binary_f1_score': 0.8424437}
confusion matrix:
     0    1
0  125   90
1    8  262
early stop counter: 1
val acc:0.6940993666648865, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8288660049438477 / 0.8597938418388367
after epoch: 15,now: 2024-07-11 14:35:42.894099,epoch time: 0:11:02.239878,used: 2:39:48.700199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9889725, 'precision': 0.9287678, 'recall': 0.9573306, 'specificity': 0.9573306, 'f1': 0.94253075, 'auroc': 0.9971608, 'binary_precision': 0.99599713, 'binary_recall': 0.99239504, 'binary_specificity': 0.9222661, 'binary_f1_score': 0.9941929}
confusion matrix:
      0      1
0  1400    118
1   225  29361
---- Validation: 
scalar performance:
{'acc': 0.83074534, 'precision': 0.8571762, 'recall': 0.832644, 'specificity': 0.832644, 'f1': 0.8280926, 'auroc': 0.9498644, 'binary_precision': 0.75645757, 'binary_recall': 0.96850395, 'binary_specificity': 0.6967841, 'binary_f1_score': 0.84944755}
confusion matrix:
     0    1
0  455  198
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.89261717, 'recall': 0.88247204, 'specificity': 0.88247204, 'f1': 0.8859321, 'auroc': 0.9622222, 'binary_precision': 0.8724138, 'binary_recall': 0.93703705, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.9035715}
confusion matrix:
     0    1
0  178   37
1   17  253
new oracle model saved
early stop counter: 2
val acc:0.8307453393936157, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8288660049438477 / 0.8886597752571106
after epoch: 16,now: 2024-07-11 14:46:57.593010,epoch time: 0:11:14.698911,used: 2:51:03.399110,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99321634, 'precision': 0.9488224, 'recall': 0.98206, 'specificity': 0.98206, 'f1': 0.9647745, 'auroc': 0.9992408, 'binary_precision': 0.99843895, 'binary_recall': 0.99442303, 'binary_specificity': 0.969697, 'binary_f1_score': 0.99642694}
confusion matrix:
      0      1
0  1472     46
1   165  29421
---- Validation: 
scalar performance:
{'acc': 0.88975155, 'precision': 0.89073133, 'recall': 0.89012074, 'specificity': 0.89012074, 'f1': 0.88973, 'auroc': 0.95306945, 'binary_precision': 0.86736214, 'binary_recall': 0.91653544, 'binary_specificity': 0.863706, 'binary_f1_score': 0.891271}
confusion matrix:
     0    1
0  564   89
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701031, 'precision': 0.87710094, 'recall': 0.8795435, 'specificity': 0.8795435, 'f1': 0.8700677, 'auroc': 0.9375366, 'binary_precision': 0.9641256, 'binary_recall': 0.7962963, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.872211}
confusion matrix:
     0    1
0  207    8
1   55  215
early stop counter: 3
val acc:0.8897515535354614, best validation acc: 0.9006211161613464, corresponding to test acc:                         0.8288660049438477 / 0.8886597752571106
after epoch: 17,now: 2024-07-11 14:58:12.049499,epoch time: 0:11:14.456489,used: 3:02:17.855599,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99086934, 'precision': 0.98241204, 'recall': 0.9174467, 'specificity': 0.9174467, 'f1': 0.94732547, 'auroc': 0.99893993, 'binary_precision': 0.991644, 'binary_recall': 0.99881697, 'binary_specificity': 0.8360764, 'binary_f1_score': 0.99521756}
confusion matrix:
      0      1
0  1270    249
1    35  29550
---- Validation: 
scalar performance:
{'acc': 0.91537267, 'precision': 0.9156896, 'recall': 0.9151934, 'specificity': 0.9151934, 'f1': 0.9153171, 'auroc': 0.9570534, 'binary_precision': 0.92419356, 'binary_recall': 0.9023622, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.91314745}
confusion matrix:
     0    1
0  606   47
1   62  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8618557, 'precision': 0.8678633, 'recall': 0.8707149, 'specificity': 0.8707149, 'f1': 0.861797, 'auroc': 0.9289406, 'binary_precision': 0.95111114, 'binary_recall': 0.7925926, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8646465}
confusion matrix:
     0    1
0  204   11
1   56  214
better model found
persisted
after epoch: 18,now: 2024-07-11 15:08:50.603173,epoch time: 0:10:38.553674,used: 3:12:56.409273,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99427724, 'precision': 0.99110603, 'recall': 0.9466824, 'specificity': 0.9466824, 'f1': 0.96772504, 'auroc': 0.9995363, 'binary_precision': 0.9945846, 'binary_recall': 0.9994254, 'binary_specificity': 0.8939394, 'binary_f1_score': 0.99699914}
confusion matrix:
      0      1
0  1357    161
1    17  29569
---- Validation: 
scalar performance:
{'acc': 0.7127329, 'precision': 0.8065475, 'recall': 0.716562, 'specificity': 0.716562, 'f1': 0.691216, 'auroc': 0.96252126, 'binary_precision': 0.63343406, 'binary_recall': 0.9905512, 'binary_specificity': 0.44257274, 'binary_f1_score': 0.77272725}
confusion matrix:
     0    1
0  289  364
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7360825, 'precision': 0.80056393, 'recall': 0.7065891, 'specificity': 0.7065891, 'f1': 0.70153844, 'auroc': 0.94558144, 'binary_precision': 0.6868421, 'binary_recall': 0.96666664, 'binary_specificity': 0.44651163, 'binary_f1_score': 0.8030769}
confusion matrix:
    0    1
0  96  119
1   9  261
early stop counter: 1
val acc:0.7127329111099243, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.8886597752571106
after epoch: 19,now: 2024-07-11 15:19:25.687219,epoch time: 0:10:35.084046,used: 3:23:31.493319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99260545, 'precision': 0.98653734, 'recall': 0.9327234, 'specificity': 0.9327234, 'f1': 0.9578805, 'auroc': 0.99928224, 'binary_precision': 0.99317896, 'binary_recall': 0.9990874, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.9961244}
confusion matrix:
      0      1
0  1316    203
1    27  29558
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.8815441, 'recall': 0.8700763, 'specificity': 0.8700763, 'f1': 0.86794436, 'auroc': 0.96337914, 'binary_precision': 0.8082011, 'binary_recall': 0.9622047, 'binary_specificity': 0.77794796, 'binary_f1_score': 0.8785047}
confusion matrix:
     0    1
0  508  145
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91752577, 'precision': 0.91645133, 'recall': 0.91645133, 'specificity': 0.91645133, 'f1': 0.91645133, 'auroc': 0.96068907, 'binary_precision': 0.9259259, 'binary_recall': 0.9259259, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.9259259}
confusion matrix:
     0    1
0  195   20
1   20  250
new oracle model saved
early stop counter: 2
val acc:0.8687888383865356, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 20,now: 2024-07-11 15:30:00.498359,epoch time: 0:10:34.811140,used: 3:34:06.304459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99636704, 'precision': 0.9820428, 'recall': 0.97872996, 'specificity': 0.97872996, 'f1': 0.98038006, 'auroc': 0.9996344, 'binary_precision': 0.99790514, 'binary_recall': 0.9982762, 'binary_specificity': 0.9591837, 'binary_f1_score': 0.9980907}
confusion matrix:
      0      1
0  1457     62
1    51  29534
---- Validation: 
scalar performance:
{'acc': 0.8920807, 'precision': 0.8984546, 'recall': 0.8929821, 'specificity': 0.8929821, 'f1': 0.891788, 'auroc': 0.9628221, 'binary_precision': 0.84444445, 'binary_recall': 0.9574803, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.897417}
confusion matrix:
     0    1
0  541  112
1   27  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89484537, 'precision': 0.89361835, 'recall': 0.89323854, 'specificity': 0.89323854, 'f1': 0.8934245, 'auroc': 0.94969857, 'binary_precision': 0.90405905, 'binary_recall': 0.9074074, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.9057301}
confusion matrix:
     0    1
0  189   26
1   25  245
early stop counter: 3
val acc:0.8920807242393494, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 21,now: 2024-07-11 15:40:36.506635,epoch time: 0:10:36.008276,used: 3:44:42.312735,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.994213, 'precision': 0.96325535, 'recall': 0.9753969, 'specificity': 0.9753969, 'f1': 0.96923816, 'auroc': 0.99924874, 'binary_precision': 0.9976645, 'binary_recall': 0.99624825, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.99695593}
confusion matrix:
      0      1
0  1449     69
1   111  29475
---- Validation: 
scalar performance:
{'acc': 0.7740683, 'precision': 0.82781965, 'recall': 0.77687836, 'specificity': 0.77687836, 'f1': 0.7655866, 'auroc': 0.94569945, 'binary_precision': 0.6915367, 'binary_recall': 0.9779528, 'binary_specificity': 0.575804, 'binary_f1_score': 0.81017613}
confusion matrix:
     0    1
0  376  277
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75051546, 'precision': 0.77952766, 'recall': 0.72855294, 'specificity': 0.72855294, 'f1': 0.729897, 'auroc': 0.9026184, 'binary_precision': 0.71346706, 'binary_recall': 0.9222222, 'binary_specificity': 0.53488374, 'binary_f1_score': 0.8045234}
confusion matrix:
     0    1
0  115  100
1   21  249
early stop counter: 4
val acc:0.774068295955658, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 22,now: 2024-07-11 15:51:19.052912,epoch time: 0:10:42.546277,used: 3:55:24.859012,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9938915, 'precision': 0.95636934, 'recall': 0.9802389, 'specificity': 0.9802389, 'f1': 0.967963, 'auroc': 0.9993299, 'binary_precision': 0.99820346, 'binary_recall': 0.99536926, 'binary_specificity': 0.96510863, 'binary_f1_score': 0.9967844}
confusion matrix:
      0      1
0  1466     53
1   137  29448
---- Validation: 
scalar performance:
{'acc': 0.9068323, 'precision': 0.90703726, 'recall': 0.90668386, 'specificity': 0.90668386, 'f1': 0.90678173, 'auroc': 0.95252204, 'binary_precision': 0.9133226, 'binary_recall': 0.89606297, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.9046105}
confusion matrix:
     0    1
0  599   54
1   66  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8742268, 'precision': 0.8856158, 'recall': 0.8856158, 'specificity': 0.8856158, 'f1': 0.87422675, 'auroc': 0.9446167, 'binary_precision': 0.9860465, 'binary_recall': 0.78518516, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87422675}
confusion matrix:
     0    1
0  212    3
1   58  212
early stop counter: 5
val acc:0.9068322777748108, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 23,now: 2024-07-11 16:02:09.489253,epoch time: 0:10:50.436341,used: 4:06:15.295353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99643135, 'precision': 0.98239124, 'recall': 0.979076, 'specificity': 0.979076, 'f1': 0.9807272, 'auroc': 0.99961424, 'binary_precision': 0.99793893, 'binary_recall': 0.99830997, 'binary_specificity': 0.959842, 'binary_f1_score': 0.99812436}
confusion matrix:
      0      1
0  1458     61
1    50  29535
---- Validation: 
scalar performance:
{'acc': 0.8703416, 'precision': 0.875538, 'recall': 0.8711736, 'specificity': 0.8711736, 'f1': 0.87005013, 'auroc': 0.95114255, 'binary_precision': 0.8277311, 'binary_recall': 0.93070865, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.87620455}
confusion matrix:
     0    1
0  530  123
1   44  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90515465, 'precision': 0.90407646, 'recall': 0.9091301, 'specificity': 0.9091301, 'f1': 0.9047135, 'auroc': 0.95142114, 'binary_precision': 0.9516129, 'binary_recall': 0.8740741, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.91119695}
confusion matrix:
     0    1
0  203   12
1   34  236
early stop counter: 6
val acc:0.8703415989875793, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 24,now: 2024-07-11 16:13:06.489514,epoch time: 0:10:57.000261,used: 4:17:12.295614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99112654, 'precision': 0.99010146, 'recall': 0.9135225, 'specificity': 0.9135225, 'f1': 0.9482151, 'auroc': 0.99938226, 'binary_precision': 0.9912178, 'binary_recall': 0.9995268, 'binary_specificity': 0.8275181, 'binary_f1_score': 0.99535495}
confusion matrix:
      0      1
0  1257    262
1    14  29571
---- Validation: 
scalar performance:
{'acc': 0.8493789, 'precision': 0.86803234, 'recall': 0.8509556, 'specificity': 0.8509556, 'f1': 0.8478286, 'auroc': 0.9579506, 'binary_precision': 0.7816092, 'binary_recall': 0.9637795, 'binary_specificity': 0.7381317, 'binary_f1_score': 0.86318755}
confusion matrix:
     0    1
0  482  171
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90515465, 'precision': 0.9067096, 'recall': 0.9010767, 'specificity': 0.9010767, 'f1': 0.90330935, 'auroc': 0.9673557, 'binary_precision': 0.8971631, 'binary_recall': 0.93703705, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.9166666}
confusion matrix:
     0    1
0  186   29
1   17  253
early stop counter: 7
val acc:0.8493788838386536, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 25,now: 2024-07-11 16:23:54.141200,epoch time: 0:10:47.651686,used: 4:27:59.947300,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99463093, 'precision': 0.95662355, 'recall': 0.98874074, 'specificity': 0.98874074, 'f1': 0.9720698, 'auroc': 0.9995827, 'binary_precision': 0.99908394, 'binary_recall': 0.99526805, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.99717236}
confusion matrix:
      0      1
0  1491     27
1   140  29446
---- Validation: 
scalar performance:
{'acc': 0.9122671, 'precision': 0.9122928, 'recall': 0.9123694, 'specificity': 0.9123694, 'f1': 0.91226447, 'auroc': 0.963331, 'binary_precision': 0.9040248, 'binary_recall': 0.91968507, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.9117877}
confusion matrix:
     0    1
0  591   62
1   51  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886598, 'precision': 0.89262575, 'recall': 0.89668393, 'specificity': 0.89668393, 'f1': 0.8885532, 'auroc': 0.95522827, 'binary_precision': 0.9695652, 'binary_recall': 0.82592595, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.89199996}
confusion matrix:
     0    1
0  208    7
1   47  223
early stop counter: 8
val acc:0.9122670888900757, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 26,now: 2024-07-11 16:34:34.348160,epoch time: 0:10:40.206960,used: 4:38:40.154260,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9938915, 'precision': 0.9592922, 'recall': 0.97647774, 'specificity': 0.97647774, 'f1': 0.9677081, 'auroc': 0.9992542, 'binary_precision': 0.99779856, 'binary_recall': 0.99577504, 'binary_specificity': 0.9571805, 'binary_f1_score': 0.99678576}
confusion matrix:
      0      1
0  1453     65
1   125  29461
---- Validation: 
scalar performance:
{'acc': 0.878882, 'precision': 0.883494, 'recall': 0.87966144, 'specificity': 0.87966144, 'f1': 0.8786526, 'auroc': 0.93457997, 'binary_precision': 0.8377997, 'binary_recall': 0.9354331, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.8839286}
confusion matrix:
     0    1
0  538  115
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8659794, 'precision': 0.8668742, 'recall': 0.8715762, 'specificity': 0.8715762, 'f1': 0.8656504, 'auroc': 0.93414724, 'binary_precision': 0.9288703, 'binary_recall': 0.82222223, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.87229866}
confusion matrix:
     0    1
0  198   17
1   48  222
early stop counter: 9
val acc:0.8788819909095764, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 27,now: 2024-07-11 16:45:20.766228,epoch time: 0:10:46.418068,used: 4:49:26.572328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9914802, 'precision': 0.973776, 'recall': 0.93244416, 'specificity': 0.93244416, 'f1': 0.95206046, 'auroc': 0.9977673, 'binary_precision': 0.9932041, 'binary_recall': 0.99787056, 'binary_specificity': 0.86701775, 'binary_f1_score': 0.99553186}
confusion matrix:
      0      1
0  1317    202
1    63  29522
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.8474499, 'recall': 0.8188398, 'specificity': 0.8188398, 'f1': 0.81328374, 'auroc': 0.9360987, 'binary_precision': 0.74065137, 'binary_recall': 0.96692914, 'binary_specificity': 0.6707504, 'binary_f1_score': 0.83879775}
confusion matrix:
     0    1
0  438  215
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87628865, 'precision': 0.8855897, 'recall': 0.8670973, 'specificity': 0.8670973, 'f1': 0.8721756, 'auroc': 0.94537467, 'binary_precision': 0.8476821, 'binary_recall': 0.94814813, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.8951049}
confusion matrix:
     0    1
0  169   46
1   14  256
early stop counter: 10
val acc:0.8167701959609985, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9175257682800293
after epoch: 28,now: 2024-07-11 16:56:05.590919,epoch time: 0:10:44.824691,used: 5:00:11.397019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99665636, 'precision': 0.97940314, 'recall': 0.9847964, 'specificity': 0.9847964, 'f1': 0.98208296, 'auroc': 0.9996469, 'binary_precision': 0.99854577, 'binary_recall': 0.9979383, 'binary_specificity': 0.9716546, 'binary_f1_score': 0.9982419}
confusion matrix:
      0      1
0  1474     43
1    61  29526
---- Validation: 
scalar performance:
{'acc': 0.878882, 'precision': 0.88619757, 'recall': 0.8798567, 'specificity': 0.8798567, 'f1': 0.87848085, 'auroc': 0.9560622, 'binary_precision': 0.82943606, 'binary_recall': 0.9496063, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.8854626}
confusion matrix:
     0    1
0  529  124
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9195876, 'precision': 0.9179245, 'recall': 0.91972435, 'specificity': 0.91972435, 'f1': 0.9187238, 'auroc': 0.94775194, 'binary_precision': 0.9358491, 'binary_recall': 0.91851854, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.9271028}
confusion matrix:
     0    1
0  198   17
1   22  248
new oracle model saved
early stop counter: 11
val acc:0.8788819909095764, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9195876121520996
after epoch: 29,now: 2024-07-11 17:06:40.853244,epoch time: 0:10:35.262325,used: 5:10:46.659344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99675286, 'precision': 0.9886529, 'recall': 0.9761223, 'specificity': 0.9761223, 'f1': 0.98229694, 'auroc': 0.99961483, 'binary_precision': 0.9976035, 'binary_recall': 0.99898595, 'binary_specificity': 0.9532587, 'binary_f1_score': 0.99829423}
confusion matrix:
      0      1
0  1448     71
1    30  29555
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.8865535, 'recall': 0.87252533, 'specificity': 0.87252533, 'f1': 0.8701004, 'auroc': 0.96171033, 'binary_precision': 0.80573666, 'binary_recall': 0.97322834, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.8815977}
confusion matrix:
     0    1
0  504  149
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90927833, 'precision': 0.9074541, 'recall': 0.90951765, 'specificity': 0.90951765, 'f1': 0.9083427, 'auroc': 0.94180876, 'binary_precision': 0.9280303, 'binary_recall': 0.9074074, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.91760296}
confusion matrix:
     0    1
0  196   19
1   25  245
early stop counter: 12
val acc:0.8711180090904236, best validation acc: 0.9153726696968079, corresponding to test acc:                         0.861855685710907 / 0.9195876121520996
after epoch: 30,now: 2024-07-11 17:17:14.162662,epoch time: 0:10:33.309418,used: 5:21:19.968762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_11_55_54_seed_0_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:21:19.968762 at 2024-07-11 17:17:14.162662
persisted model performance metric: 

scalar performance:
{'acc': 0.8618557, 'precision': 0.8678633, 'recall': 0.8707149, 'specificity': 0.8707149, 'f1': 0.861797, 'auroc': 0.9289406, 'binary_precision': 0.95111114, 'binary_recall': 0.7925926, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8646465}
confusion matrix:
     0    1
0  204   11
1   56  214
oracle model performance metric: 

scalar performance:
{'acc': 0.9195876, 'precision': 0.9179245, 'recall': 0.91972435, 'specificity': 0.91972435, 'f1': 0.9187238, 'auroc': 0.94775194, 'binary_precision': 0.9358491, 'binary_recall': 0.91851854, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.9271028}
confusion matrix:
     0    1
0  198   17
1   22  248
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455466 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455466 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 359818 GiB | 359818 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 354998 GiB | 354998 GiB |
|       from small pool |  40408 KiB |     56 MiB |   4819 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447702 KiB |   1252 MiB | 272713 GiB | 272712 GiB |
|       from large pool | 435058 KiB |   1243 MiB | 267869 GiB | 267869 GiB |
|       from small pool |  12643 KiB |     17 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1322    |    4893    |   68261 K  |   68260 K  |
|       from large pool |     187    |    1413    |   32653 K  |   32653 K  |
|       from small pool |    1135    |    4704    |   35608 K  |   35607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1322    |    4893    |   68261 K  |   68260 K  |
|       from large pool |     187    |    1413    |   32653 K  |   32653 K  |
|       from small pool |    1135    |    4704    |   35608 K  |   35607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |    2011    |   41828 K  |   41828 K  |
|       from large pool |      37    |     600    |   24237 K  |   24237 K  |
|       from small pool |      61    |    1973    |   17591 K  |   17591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 359818 GiB | 359818 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 354998 GiB | 354998 GiB |
|       from small pool |      0 KiB |     56 MiB |   4819 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 267869 GiB | 267869 GiB |
|       from small pool |      0 KiB |     45 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68261 K  |   68261 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68261 K  |   68261 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2011    |   41828 K  |   41828 K  |
|       from large pool |       4    |     600    |   24237 K  |   24237 K  |
|       from small pool |       0    |    1973    |   17591 K  |   17591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 359818 GiB | 359818 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 354998 GiB | 354998 GiB |
|       from small pool |      0 KiB |     56 MiB |   4819 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 267869 GiB | 267869 GiB |
|       from small pool |      0 KiB |     45 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68261 K  |   68261 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68261 K  |   68261 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35608 K  |   35608 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2011    |   41828 K  |   41828 K  |
|       from large pool |       4    |     600    |   24237 K  |   24237 K  |
|       from small pool |       0    |    1973    |   17591 K  |   17591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152

 Experiment start at: 2024-07-11 17:31:00.223568
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98782676, 'precision': 0.9227632, 'recall': 0.9511548, 'specificity': 0.9511548, 'f1': 0.9364393, 'auroc': 0.99620926, 'binary_precision': 0.9954035, 'binary_recall': 0.9917834, 'binary_specificity': 0.91052634, 'binary_f1_score': 0.9935902}
confusion matrix:
      0      1
0  1384    136
1   244  29452
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8392063, 'recall': 0.82606244, 'specificity': 0.82606244, 'f1': 0.82290375, 'auroc': 0.9272109, 'binary_precision': 0.7640157, 'binary_recall': 0.93015873, 'binary_specificity': 0.7219662, 'binary_f1_score': 0.8389406}
confusion matrix:
     0    1
0  470  181
1   44  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79916316, 'precision': 0.81382364, 'recall': 0.79232323, 'specificity': 0.79232323, 'f1': 0.793669, 'auroc': 0.9262538, 'binary_precision': 0.7590759, 'binary_recall': 0.90909094, 'binary_specificity': 0.6755555, 'binary_f1_score': 0.8273381}
confusion matrix:
     0    1
0  152   73
1   23  230
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 17:41:37.094088,epoch time: 0:10:36.870520,used: 0:10:36.870520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9905177, 'precision': 0.93199813, 'recall': 0.9722321, 'specificity': 0.9722321, 'f1': 0.9511068, 'auroc': 0.99837184, 'binary_precision': 0.99752927, 'binary_recall': 0.9924906, 'binary_specificity': 0.9519737, 'binary_f1_score': 0.9950036}
confusion matrix:
      0      1
0  1447     73
1   223  29473
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.8169266, 'recall': 0.7773682, 'specificity': 0.7773682, 'f1': 0.76779294, 'auroc': 0.927996, 'binary_precision': 0.69665515, 'binary_recall': 0.95873016, 'binary_specificity': 0.59600616, 'binary_f1_score': 0.8069473}
confusion matrix:
     0    1
0  388  263
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76778245, 'precision': 0.8109335, 'recall': 0.7562846, 'specificity': 0.7562846, 'f1': 0.7535156, 'auroc': 0.91833115, 'binary_precision': 0.7088235, 'binary_recall': 0.9525692, 'binary_specificity': 0.56, 'binary_f1_score': 0.8128162}
confusion matrix:
     0    1
0  126   99
1   12  241
early stop counter: 1
val acc:0.7743949890136719, best validation acc: 0.824355959892273, corresponding to test acc:                         0.7991631627082825 / 0.7991631627082825
after epoch: 2,now: 2024-07-11 17:52:07.853626,epoch time: 0:10:30.759538,used: 0:21:07.630058,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9912865, 'precision': 0.9502592, 'recall': 0.9564334, 'specificity': 0.9564334, 'f1': 0.95332277, 'auroc': 0.99841917, 'binary_precision': 0.99578744, 'binary_recall': 0.99504966, 'binary_specificity': 0.91781723, 'binary_f1_score': 0.9954184}
confusion matrix:
      0      1
0  1396    125
1   147  29548
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.82180935, 'recall': 0.78128517, 'specificity': 0.78128517, 'f1': 0.7717483, 'auroc': 0.9387804, 'binary_precision': 0.69930875, 'binary_recall': 0.96349204, 'binary_specificity': 0.59907836, 'binary_f1_score': 0.8104139}
confusion matrix:
     0    1
0  390  261
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83682007, 'precision': 0.84392333, 'recall': 0.83232325, 'specificity': 0.83232325, 'f1': 0.8342079, 'auroc': 0.9347387, 'binary_precision': 0.80701756, 'binary_recall': 0.90909094, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.85501856}
confusion matrix:
     0    1
0  170   55
1   23  230
new oracle model saved
early stop counter: 2
val acc:0.7782981991767883, best validation acc: 0.824355959892273, corresponding to test acc:                         0.7991631627082825 / 0.8368200659751892
after epoch: 3,now: 2024-07-11 18:02:47.278824,epoch time: 0:10:39.425198,used: 0:31:47.055256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9934649, 'precision': 0.9722695, 'recall': 0.95633084, 'specificity': 0.95633084, 'f1': 0.9641475, 'auroc': 0.99903834, 'binary_precision': 0.9956637, 'binary_recall': 0.9974743, 'binary_specificity': 0.91518736, 'binary_f1_score': 0.99656814}
confusion matrix:
      0      1
0  1392    129
1    75  29620
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.83190227, 'recall': 0.8079109, 'specificity': 0.8079109, 'f1': 0.8024614, 'auroc': 0.9340746, 'binary_precision': 0.73431736, 'binary_recall': 0.947619, 'binary_specificity': 0.66820276, 'binary_f1_score': 0.8274428}
confusion matrix:
     0    1
0  435  216
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824268, 'precision': 0.79823613, 'recall': 0.7750373, 'specificity': 0.7750373, 'f1': 0.77582973, 'auroc': 0.8951955, 'binary_precision': 0.742671, 'binary_recall': 0.90118575, 'binary_specificity': 0.6488889, 'binary_f1_score': 0.8142857}
confusion matrix:
     0    1
0  146   79
1   25  228
early stop counter: 3
val acc:0.8056206107139587, best validation acc: 0.824355959892273, corresponding to test acc:                         0.7991631627082825 / 0.8368200659751892
after epoch: 4,now: 2024-07-11 18:13:26.051018,epoch time: 0:10:38.772194,used: 0:42:25.827450,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9930484, 'precision': 0.9784546, 'recall': 0.9451957, 'specificity': 0.9451957, 'f1': 0.9611584, 'auroc': 0.99865913, 'binary_precision': 0.9944978, 'binary_recall': 0.9982152, 'binary_specificity': 0.8921762, 'binary_f1_score': 0.99635303}
confusion matrix:
      0      1
0  1357    164
1    53  29642
---- Validation: 
scalar performance:
{'acc': 0.77517563, 'precision': 0.81993306, 'recall': 0.778213, 'specificity': 0.778213, 'f1': 0.7682787, 'auroc': 0.9386877, 'binary_precision': 0.6961009, 'binary_recall': 0.96349204, 'binary_specificity': 0.59293395, 'binary_f1_score': 0.8082557}
confusion matrix:
     0    1
0  386  265
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80543935, 'precision': 0.8239877, 'recall': 0.7980062, 'specificity': 0.7980062, 'f1': 0.7993908, 'auroc': 0.9343523, 'binary_precision': 0.75974023, 'binary_recall': 0.9249012, 'binary_specificity': 0.6711111, 'binary_f1_score': 0.8342246}
confusion matrix:
     0    1
0  151   74
1   19  234
early stop counter: 4
val acc:0.7751756310462952, best validation acc: 0.824355959892273, corresponding to test acc:                         0.7991631627082825 / 0.8368200659751892
after epoch: 5,now: 2024-07-11 18:24:03.130551,epoch time: 0:10:37.079533,used: 0:53:02.906983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9931125, 'precision': 0.9775859, 'recall': 0.94678885, 'specificity': 0.94678885, 'f1': 0.961616, 'auroc': 0.998963, 'binary_precision': 0.9946641, 'binary_recall': 0.99811417, 'binary_specificity': 0.8954635, 'binary_f1_score': 0.9963861}
confusion matrix:
      0      1
0  1362    159
1    56  29639
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.82845664, 'recall': 0.78525347, 'specificity': 0.78525347, 'f1': 0.7754576, 'auroc': 0.9441086, 'binary_precision': 0.7010309, 'binary_recall': 0.9714286, 'binary_specificity': 0.59907836, 'binary_f1_score': 0.8143713}
confusion matrix:
     0    1
0  390  261
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7635983, 'precision': 0.79337394, 'recall': 0.75356174, 'specificity': 0.75356174, 'f1': 0.7520872, 'auroc': 0.9188582, 'binary_precision': 0.7134146, 'binary_recall': 0.9249012, 'binary_specificity': 0.5822222, 'binary_f1_score': 0.8055077}
confusion matrix:
     0    1
0  131   94
1   19  234
early stop counter: 5
val acc:0.7822014093399048, best validation acc: 0.824355959892273, corresponding to test acc:                         0.7991631627082825 / 0.8368200659751892
after epoch: 6,now: 2024-07-11 18:34:39.195277,epoch time: 0:10:36.064726,used: 1:03:38.971709,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.9599547, 'recall': 0.9765614, 'specificity': 0.9765614, 'f1': 0.9680931, 'auroc': 0.9991081, 'binary_precision': 0.9978068, 'binary_recall': 0.9958579, 'binary_specificity': 0.95726496, 'binary_f1_score': 0.99683136}
confusion matrix:
      0      1
0  1456     65
1   123  29572
---- Validation: 
scalar performance:
{'acc': 0.871975, 'precision': 0.87484735, 'recall': 0.8727087, 'specificity': 0.8727087, 'f1': 0.8718562, 'auroc': 0.941499, 'binary_precision': 0.8376812, 'binary_recall': 0.9174603, 'binary_specificity': 0.827957, 'binary_f1_score': 0.8757576}
confusion matrix:
     0    1
0  539  112
1   52  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84309626, 'precision': 0.84260756, 'recall': 0.84243304, 'specificity': 0.84243304, 'f1': 0.8425166, 'auroc': 0.9219851, 'binary_precision': 0.8503937, 'binary_recall': 0.85375494, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.85207105}
confusion matrix:
     0    1
0  187   38
1   37  216
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-11 18:45:25.817396,epoch time: 0:10:46.622119,used: 1:14:25.593828,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9934649, 'precision': 0.9506155, 'recall': 0.9825299, 'specificity': 0.9825299, 'f1': 0.9659599, 'auroc': 0.9990361, 'binary_precision': 0.9984788, 'binary_recall': 0.99464554, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.99655855}
confusion matrix:
      0      1
0  1476     45
1   159  29536
---- Validation: 
scalar performance:
{'acc': 0.90007806, 'precision': 0.9000704, 'recall': 0.9000256, 'specificity': 0.9000256, 'f1': 0.9000458, 'auroc': 0.94505405, 'binary_precision': 0.8996815, 'binary_recall': 0.8968254, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.8982512}
confusion matrix:
     0    1
0  588   63
1   65  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8870293, 'precision': 0.8907412, 'recall': 0.89032936, 'specificity': 0.89032936, 'f1': 0.8870273, 'auroc': 0.9378481, 'binary_precision': 0.94618833, 'binary_recall': 0.8339921, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.88655466}
confusion matrix:
     0    1
0  213   12
1   42  211
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-11 18:56:08.742983,epoch time: 0:10:42.925587,used: 1:25:08.519415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9946502, 'precision': 0.9760941, 'recall': 0.96568686, 'specificity': 0.96568686, 'f1': 0.9708263, 'auroc': 0.9992448, 'binary_precision': 0.9966028, 'binary_recall': 0.9977774, 'binary_specificity': 0.9335963, 'binary_f1_score': 0.99718976}
confusion matrix:
      0      1
0  1420    101
1    66  29629
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.85080487, 'recall': 0.8384793, 'specificity': 0.8384793, 'f1': 0.83563423, 'auroc': 0.94601464, 'binary_precision': 0.7766097, 'binary_recall': 0.9380952, 'binary_specificity': 0.7388633, 'binary_f1_score': 0.8497484}
confusion matrix:
     0    1
0  481  170
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.83166134, 'recall': 0.8066491, 'specificity': 0.8066491, 'f1': 0.8083029, 'auroc': 0.9378129, 'binary_precision': 0.76797384, 'binary_recall': 0.92885375, 'binary_specificity': 0.6844444, 'binary_f1_score': 0.8407871}
confusion matrix:
     0    1
0  154   71
1   18  235
early stop counter: 1
val acc:0.8368462324142456, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 9,now: 2024-07-11 19:06:24.293606,epoch time: 0:10:15.550623,used: 1:35:24.070038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98186827, 'precision': 0.86486363, 'recall': 0.9889103, 'specificity': 0.9889103, 'f1': 0.916535, 'auroc': 0.99936116, 'binary_precision': 0.9998284, 'binary_recall': 0.98110795, 'binary_specificity': 0.9967127, 'binary_f1_score': 0.99037975}
confusion matrix:
      0      1
0  1516      5
1   561  29134
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.8732092, 'recall': 0.85709167, 'specificity': 0.85709167, 'f1': 0.8568958, 'auroc': 0.94568306, 'binary_precision': 0.94280076, 'binary_recall': 0.7587302, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.8408091}
confusion matrix:
     0    1
0  622   29
1  152  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8158996, 'precision': 0.84499544, 'recall': 0.8243654, 'specificity': 0.8243654, 'f1': 0.8141787, 'auroc': 0.9263593, 'binary_precision': 0.96089387, 'binary_recall': 0.6798419, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7962963}
confusion matrix:
     0    1
0  218    7
1   81  172
early stop counter: 2
val acc:0.858704149723053, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 10,now: 2024-07-11 19:16:39.825925,epoch time: 0:10:15.532319,used: 1:45:39.602357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9927601, 'precision': 0.9853124, 'recall': 0.93537545, 'specificity': 0.93537545, 'f1': 0.9588392, 'auroc': 0.9994017, 'binary_precision': 0.9934693, 'binary_recall': 0.998956, 'binary_specificity': 0.8717949, 'binary_f1_score': 0.9962051}
confusion matrix:
      0      1
0  1326    195
1    31  29664
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.85480654, 'recall': 0.84016895, 'specificity': 0.84016895, 'f1': 0.8369769, 'auroc': 0.9439726, 'binary_precision': 0.77431905, 'binary_recall': 0.947619, 'binary_specificity': 0.7327189, 'binary_f1_score': 0.8522484}
confusion matrix:
     0    1
0  477  174
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80543935, 'precision': 0.8212341, 'recall': 0.79849803, 'specificity': 0.79849803, 'f1': 0.7999757, 'auroc': 0.925112, 'binary_precision': 0.7631579, 'binary_recall': 0.91699606, 'binary_specificity': 0.68, 'binary_f1_score': 0.8330341}
confusion matrix:
     0    1
0  153   72
1   21  232
early stop counter: 3
val acc:0.8384075164794922, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 11,now: 2024-07-11 19:26:54.055517,epoch time: 0:10:14.229592,used: 1:55:53.831949,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9945541, 'precision': 0.9587337, 'recall': 0.9849737, 'specificity': 0.9849737, 'f1': 0.97144467, 'auroc': 0.9994569, 'binary_precision': 0.99868256, 'binary_recall': 0.9955885, 'binary_specificity': 0.974359, 'binary_f1_score': 0.99713314}
confusion matrix:
      0      1
0  1482     39
1   131  29564
---- Validation: 
scalar performance:
{'acc': 0.8930523, 'precision': 0.893718, 'recall': 0.89342034, 'specificity': 0.89342034, 'f1': 0.8930458, 'auroc': 0.94277424, 'binary_precision': 0.8729198, 'binary_recall': 0.915873, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.89388067}
confusion matrix:
     0    1
0  567   84
1   53  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8870293, 'precision': 0.8880091, 'recall': 0.8890997, 'specificity': 0.8890997, 'f1': 0.88699764, 'auroc': 0.9252174, 'binary_precision': 0.9270386, 'binary_recall': 0.85375494, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  208   17
1   37  216
early stop counter: 4
val acc:0.8930522799491882, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 12,now: 2024-07-11 19:37:10.681282,epoch time: 0:10:16.625765,used: 2:06:10.457714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99573934, 'precision': 0.97575307, 'recall': 0.9784232, 'specificity': 0.9784232, 'f1': 0.97708404, 'auroc': 0.999619, 'binary_precision': 0.99791145, 'binary_recall': 0.997609, 'binary_specificity': 0.95923734, 'binary_f1_score': 0.99776024}
confusion matrix:
      0      1
0  1459     62
1    71  29624
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8587204, 'recall': 0.847747, 'specificity': 0.847747, 'f1': 0.8452326, 'auroc': 0.9467095, 'binary_precision': 0.7875166, 'binary_recall': 0.9412698, 'binary_specificity': 0.75422424, 'binary_f1_score': 0.857556}
confusion matrix:
     0    1
0  491  160
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.853452, 'recall': 0.8431884, 'specificity': 0.8431884, 'f1': 0.84507734, 'auroc': 0.938498, 'binary_precision': 0.81914896, 'binary_recall': 0.9130435, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8635514}
confusion matrix:
     0    1
0  174   51
1   22  231
early stop counter: 5
val acc:0.8462138772010803, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 13,now: 2024-07-11 19:47:36.947638,epoch time: 0:10:26.266356,used: 2:16:36.724070,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9933047, 'precision': 0.9481114, 'recall': 0.9840052, 'specificity': 0.9840052, 'f1': 0.9652817, 'auroc': 0.99930006, 'binary_precision': 0.9986471, 'binary_recall': 0.9943088, 'binary_specificity': 0.97370154, 'binary_f1_score': 0.99647325}
confusion matrix:
      0      1
0  1481     40
1   169  29526
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.85041535, 'recall': 0.8355094, 'specificity': 0.8355094, 'f1': 0.83220166, 'auroc': 0.9393973, 'binary_precision': 0.7697283, 'binary_recall': 0.9444444, 'binary_specificity': 0.7265745, 'binary_f1_score': 0.84818244}
confusion matrix:
     0    1
0  473  178
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200837, 'precision': 0.82426465, 'recall': 0.816267, 'specificity': 0.816267, 'f1': 0.81775784, 'auroc': 0.9116206, 'binary_precision': 0.79928315, 'binary_recall': 0.88142294, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.83834594}
confusion matrix:
     0    1
0  169   56
1   30  223
early stop counter: 6
val acc:0.8337236642837524, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8870292901992798
after epoch: 14,now: 2024-07-11 19:58:05.570147,epoch time: 0:10:28.622509,used: 2:27:05.346579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9949705, 'precision': 0.9670695, 'recall': 0.97957855, 'specificity': 0.97957855, 'f1': 0.97323155, 'auroc': 0.99957454, 'binary_precision': 0.9980777, 'binary_recall': 0.99663246, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.99735457}
confusion matrix:
      0      1
0  1464     57
1   100  29595
---- Validation: 
scalar performance:
{'acc': 0.88602656, 'precision': 0.88629824, 'recall': 0.88627756, 'specificity': 0.88627756, 'f1': 0.88602644, 'auroc': 0.94377637, 'binary_precision': 0.87116563, 'binary_recall': 0.9015873, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.8861154}
confusion matrix:
     0    1
0  567   84
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88912135, 'precision': 0.8975032, 'recall': 0.8937813, 'specificity': 0.8937813, 'f1': 0.8890393, 'auroc': 0.94383836, 'binary_precision': 0.9716981, 'binary_recall': 0.81422925, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.88602155}
confusion matrix:
     0    1
0  219    6
1   47  206
new oracle model saved
early stop counter: 7
val acc:0.8860265612602234, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 15,now: 2024-07-11 20:08:25.359458,epoch time: 0:10:19.789311,used: 2:37:25.135890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9953229, 'precision': 0.9779062, 'recall': 0.9713427, 'specificity': 0.9713427, 'f1': 0.9745991, 'auroc': 0.9993659, 'binary_precision': 0.9971733, 'binary_recall': 0.9979121, 'binary_specificity': 0.9447732, 'binary_f1_score': 0.99754256}
confusion matrix:
      0      1
0  1437     84
1    62  29633
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86964005, 'recall': 0.86446494, 'specificity': 0.86446494, 'f1': 0.8630244, 'auroc': 0.94137466, 'binary_precision': 0.8172943, 'binary_recall': 0.93015873, 'binary_specificity': 0.79877114, 'binary_f1_score': 0.8700817}
confusion matrix:
     0    1
0  520  131
1   44  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.85725075, 'recall': 0.85725075, 'specificity': 0.85725075, 'f1': 0.8572508, 'auroc': 0.9309794, 'binary_precision': 0.8656126, 'binary_recall': 0.8656126, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8656126}
confusion matrix:
     0    1
0  191   34
1   34  219
early stop counter: 8
val acc:0.8633880019187927, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 16,now: 2024-07-11 20:18:40.946212,epoch time: 0:10:15.586754,used: 2:47:40.722644,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9948744, 'precision': 0.9804375, 'recall': 0.9636215, 'specificity': 0.9636215, 'f1': 0.97186255, 'auroc': 0.9994182, 'binary_precision': 0.9963699, 'binary_recall': 0.9982489, 'binary_specificity': 0.92899406, 'binary_f1_score': 0.99730855}
confusion matrix:
      0      1
0  1413    108
1    52  29643
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8362415, 'recall': 0.8065796, 'specificity': 0.8065796, 'f1': 0.80011266, 'auroc': 0.9464048, 'binary_precision': 0.7280385, 'binary_recall': 0.96031743, 'binary_specificity': 0.6528418, 'binary_f1_score': 0.82819986}
confusion matrix:
     0    1
0  425  226
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87238497, 'precision': 0.87434256, 'recall': 0.87010103, 'specificity': 0.87010103, 'f1': 0.8713438, 'auroc': 0.94475186, 'binary_precision': 0.85820895, 'binary_recall': 0.90909094, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.88291746}
confusion matrix:
     0    1
0  187   38
1   23  230
early stop counter: 9
val acc:0.8040593266487122, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 17,now: 2024-07-11 20:28:53.252465,epoch time: 0:10:12.306253,used: 2:57:53.028897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9948744, 'precision': 0.96083486, 'recall': 0.98607004, 'specificity': 0.98607004, 'f1': 0.9730756, 'auroc': 0.9995612, 'binary_precision': 0.9987841, 'binary_recall': 0.99582434, 'binary_specificity': 0.9763158, 'binary_f1_score': 0.99730206}
confusion matrix:
      0      1
0  1484     36
1   124  29572
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.83230776, 'recall': 0.7944188, 'specificity': 0.7944188, 'f1': 0.7860359, 'auroc': 0.9429523, 'binary_precision': 0.7117853, 'binary_recall': 0.96825397, 'binary_specificity': 0.6205837, 'binary_f1_score': 0.82044387}
confusion matrix:
     0    1
0  404  247
1   20  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79707116, 'precision': 0.8262462, 'recall': 0.7878876, 'specificity': 0.7878876, 'f1': 0.7883556, 'auroc': 0.9200176, 'binary_precision': 0.742236, 'binary_recall': 0.94466406, 'binary_specificity': 0.6311111, 'binary_f1_score': 0.8313044}
confusion matrix:
     0    1
0  142   83
1   14  239
early stop counter: 10
val acc:0.7915691137313843, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 18,now: 2024-07-11 20:39:11.390883,epoch time: 0:10:18.138418,used: 3:08:11.167315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99474627, 'precision': 0.9565972, 'recall': 0.99006504, 'specificity': 0.99006504, 'f1': 0.9726672, 'auroc': 0.99956834, 'binary_precision': 0.9992224, 'binary_recall': 0.9952517, 'binary_specificity': 0.98487836, 'binary_f1_score': 0.9972331}
confusion matrix:
      0      1
0  1498     23
1   141  29554
---- Validation: 
scalar performance:
{'acc': 0.8852459, 'precision': 0.8852039, 'recall': 0.88527906, 'specificity': 0.88527906, 'f1': 0.8852279, 'auroc': 0.93945086, 'binary_precision': 0.88031495, 'binary_recall': 0.88730156, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.8837944}
confusion matrix:
     0    1
0  575   76
1   71  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.8629516, 'recall': 0.8584629, 'specificity': 0.8584629, 'f1': 0.8533922, 'auroc': 0.9229688, 'binary_precision': 0.93779904, 'binary_recall': 0.77470356, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8484848}
confusion matrix:
     0    1
0  212   13
1   57  196
early stop counter: 11
val acc:0.8852459192276001, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 19,now: 2024-07-11 20:49:37.346989,epoch time: 0:10:25.956106,used: 3:18:37.123421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99452204, 'precision': 0.97423816, 'recall': 0.96624327, 'specificity': 0.96624327, 'f1': 0.9702028, 'auroc': 0.999313, 'binary_precision': 0.9966691, 'binary_recall': 0.99757534, 'binary_specificity': 0.93491125, 'binary_f1_score': 0.997122}
confusion matrix:
      0      1
0  1422     99
1    72  29623
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.85431314, 'recall': 0.8401434, 'specificity': 0.8401434, 'f1': 0.83702457, 'auroc': 0.930388, 'binary_precision': 0.7750325, 'binary_recall': 0.94603175, 'binary_specificity': 0.734255, 'binary_f1_score': 0.85203713}
confusion matrix:
     0    1
0  478  173
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8535565, 'precision': 0.85660684, 'recall': 0.85059285, 'specificity': 0.85059285, 'f1': 0.8520647, 'auroc': 0.91295564, 'binary_precision': 0.83516484, 'binary_recall': 0.90118575, 'binary_specificity': 0.8, 'binary_f1_score': 0.8669202}
confusion matrix:
     0    1
0  180   45
1   25  228
early stop counter: 12
val acc:0.8384075164794922, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 20,now: 2024-07-11 21:00:01.256783,epoch time: 0:10:23.909794,used: 3:29:01.033215,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9943298, 'precision': 0.9606587, 'recall': 0.97986555, 'specificity': 0.97986555, 'f1': 0.9700424, 'auroc': 0.9993813, 'binary_precision': 0.9981437, 'binary_recall': 0.9958916, 'binary_specificity': 0.9638396, 'binary_f1_score': 0.9970164}
confusion matrix:
      0      1
0  1466     55
1   122  29573
---- Validation: 
scalar performance:
{'acc': 0.89617485, 'precision': 0.8961419, 'recall': 0.89623654, 'specificity': 0.89623654, 'f1': 0.8961625, 'auroc': 0.9479805, 'binary_precision': 0.8901099, 'binary_recall': 0.9, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.89502764}
confusion matrix:
     0    1
0  581   70
1   63  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.882934, 'recall': 0.8806939, 'specificity': 0.8806939, 'f1': 0.8765253, 'auroc': 0.9216689, 'binary_precision': 0.9490741, 'binary_recall': 0.8102767, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.87420046}
confusion matrix:
     0    1
0  214   11
1   48  205
early stop counter: 13
val acc:0.8961748480796814, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8891213536262512
after epoch: 21,now: 2024-07-11 21:10:27.015269,epoch time: 0:10:25.758486,used: 3:39:26.791701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.992632, 'precision': 0.93569016, 'recall': 0.99394405, 'specificity': 0.99394405, 'f1': 0.96275884, 'auroc': 0.9997133, 'binary_precision': 0.99976254, 'binary_recall': 0.9924903, 'binary_specificity': 0.99539775, 'binary_f1_score': 0.9961131}
confusion matrix:
      0      1
0  1514      7
1   223  29472
---- Validation: 
scalar performance:
{'acc': 0.8930523, 'precision': 0.8976109, 'recall': 0.8921915, 'specificity': 0.8921915, 'f1': 0.8925681, 'auroc': 0.94890404, 'binary_precision': 0.9362832, 'binary_recall': 0.8396825, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.88535565}
confusion matrix:
     0    1
0  615   36
1  101  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933054, 'precision': 0.90389955, 'recall': 0.8984717, 'specificity': 0.8984717, 'f1': 0.8931703, 'auroc': 0.9506544, 'binary_precision': 0.9855769, 'binary_recall': 0.8102767, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8893709}
confusion matrix:
     0    1
0  222    3
1   48  205
new oracle model saved
early stop counter: 14
val acc:0.8930522799491882, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8933054208755493
after epoch: 22,now: 2024-07-11 21:20:51.407449,epoch time: 0:10:24.392180,used: 3:49:51.183881,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99442595, 'precision': 0.98125196, 'recall': 0.95777166, 'specificity': 0.95777166, 'f1': 0.96918476, 'auroc': 0.99933183, 'binary_precision': 0.99576795, 'binary_recall': 0.9983836, 'binary_specificity': 0.91715974, 'binary_f1_score': 0.997074}
confusion matrix:
      0      1
0  1395    126
1    48  29647
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8617983, 'recall': 0.84569895, 'specificity': 0.84569895, 'f1': 0.84237105, 'auroc': 0.95048153, 'binary_precision': 0.7770619, 'binary_recall': 0.95714283, 'binary_specificity': 0.734255, 'binary_f1_score': 0.8577525}
confusion matrix:
     0    1
0  478  173
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.84220207, 'recall': 0.830101, 'specificity': 0.830101, 'f1': 0.8319919, 'auroc': 0.9366008, 'binary_precision': 0.8041958, 'binary_recall': 0.90909094, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.8534323}
confusion matrix:
     0    1
0  169   56
1   23  230
early stop counter: 15
val acc:0.8438719511032104, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8933054208755493
after epoch: 23,now: 2024-07-11 21:31:15.977494,epoch time: 0:10:24.570045,used: 4:00:15.753926,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99324065, 'precision': 0.94051003, 'recall': 0.99426395, 'specificity': 0.99426395, 'f1': 0.96564585, 'auroc': 0.999755, 'binary_precision': 0.9997627, 'binary_recall': 0.99313015, 'binary_specificity': 0.99539775, 'binary_f1_score': 0.99643534}
confusion matrix:
      0      1
0  1514      7
1   204  29491
---- Validation: 
scalar performance:
{'acc': 0.84153, 'precision': 0.86025715, 'recall': 0.83965695, 'specificity': 0.83965695, 'f1': 0.83888936, 'auroc': 0.9459391, 'binary_precision': 0.93839836, 'binary_recall': 0.7253968, 'binary_specificity': 0.953917, 'binary_f1_score': 0.8182631}
confusion matrix:
     0    1
0  621   30
1  173  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6338912, 'precision': 0.77515703, 'recall': 0.65390426, 'specificity': 0.65390426, 'f1': 0.5967878, 'auroc': 0.92753625, 'binary_precision': 0.9875, 'binary_recall': 0.31225297, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.4744745}
confusion matrix:
     0   1
0  224   1
1  174  79
early stop counter: 16
val acc:0.8415300250053406, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8933054208755493
after epoch: 24,now: 2024-07-11 21:41:40.033605,epoch time: 0:10:24.056111,used: 4:10:39.810037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99474627, 'precision': 0.96548015, 'recall': 0.9788242, 'specificity': 0.9788242, 'f1': 0.9720466, 'auroc': 0.9994767, 'binary_precision': 0.9980101, 'binary_recall': 0.9964642, 'binary_specificity': 0.9611842, 'binary_f1_score': 0.99723655}
confusion matrix:
      0      1
0  1461     59
1   105  29591
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.8584681, 'recall': 0.8484639, 'specificity': 0.8484639, 'f1': 0.8461122, 'auroc': 0.9197742, 'binary_precision': 0.79010695, 'binary_recall': 0.9380952, 'binary_specificity': 0.7588326, 'binary_f1_score': 0.8577649}
confusion matrix:
     0    1
0  494  157
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88912135, 'precision': 0.8907784, 'recall': 0.8915678, 'specificity': 0.8915678, 'f1': 0.88910925, 'auroc': 0.9544488, 'binary_precision': 0.9347826, 'binary_recall': 0.8498024, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.89026916}
confusion matrix:
     0    1
0  210   15
1   38  215
early stop counter: 17
val acc:0.8469945192337036, best validation acc: 0.9000780582427979, corresponding to test acc:                         0.8870292901992798 / 0.8933054208755493
after epoch: 25,now: 2024-07-11 21:52:03.440182,epoch time: 0:10:23.406577,used: 4:21:03.216614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9970528, 'precision': 0.98352134, 'recall': 0.9847276, 'specificity': 0.9847276, 'f1': 0.98412365, 'auroc': 0.99972093, 'binary_precision': 0.99851805, 'binary_recall': 0.9983836, 'binary_specificity': 0.97107166, 'binary_f1_score': 0.9984508}
confusion matrix:
      0      1
0  1477     44
1    48  29647
---- Validation: 
scalar performance:
{'acc': 0.91569084, 'precision': 0.9157919, 'recall': 0.91587305, 'specificity': 0.91587305, 'f1': 0.9156896, 'auroc': 0.95213896, 'binary_precision': 0.9040248, 'binary_recall': 0.92698413, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.9153605}
confusion matrix:
     0    1
0  589   62
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.91670334, 'recall': 0.91576636, 'specificity': 0.91576636, 'f1': 0.91212773, 'auroc': 0.9579271, 'binary_precision': 0.97737557, 'binary_recall': 0.85375494, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.9113924}
confusion matrix:
     0    1
0  220    5
1   37  216
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-11 22:02:25.956786,epoch time: 0:10:22.516604,used: 4:31:25.733218,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9964441, 'precision': 0.98125374, 'recall': 0.9803531, 'specificity': 0.9803531, 'f1': 0.98080295, 'auroc': 0.9997251, 'binary_precision': 0.9980807, 'binary_recall': 0.9981815, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.9981311}
confusion matrix:
      0      1
0  1464     57
1    54  29641
---- Validation: 
scalar performance:
{'acc': 0.90163934, 'precision': 0.90207314, 'recall': 0.9019457, 'specificity': 0.9019457, 'f1': 0.9016379, 'auroc': 0.9501256, 'binary_precision': 0.88414633, 'binary_recall': 0.9206349, 'binary_specificity': 0.88325655, 'binary_f1_score': 0.9020218}
confusion matrix:
     0    1
0  575   76
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9121339, 'precision': 0.91670334, 'recall': 0.91576636, 'specificity': 0.91576636, 'f1': 0.91212773, 'auroc': 0.9415898, 'binary_precision': 0.97737557, 'binary_recall': 0.85375494, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.9113924}
confusion matrix:
     0    1
0  220    5
1   37  216
early stop counter: 1
val acc:0.9016393423080444, best validation acc: 0.9156908392906189, corresponding to test acc:                         0.9121338725090027 / 0.9121338725090027
after epoch: 27,now: 2024-07-11 22:12:49.168408,epoch time: 0:10:23.211622,used: 4:41:48.944840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9951627, 'precision': 0.98434234, 'recall': 0.96283734, 'specificity': 0.96283734, 'f1': 0.973318, 'auroc': 0.99957347, 'binary_precision': 0.9962709, 'binary_recall': 0.998653, 'binary_specificity': 0.9270217, 'binary_f1_score': 0.99746054}
confusion matrix:
      0      1
0  1410    111
1    40  29655
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.87217057, 'recall': 0.8668203, 'specificity': 0.8668203, 'f1': 0.8653616, 'auroc': 0.9495331, 'binary_precision': 0.81894153, 'binary_recall': 0.93333334, 'binary_specificity': 0.8003072, 'binary_f1_score': 0.87240356}
confusion matrix:
     0    1
0  521  130
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.8584137, 'recall': 0.85602105, 'specificity': 0.85602105, 'f1': 0.85683584, 'auroc': 0.934036, 'binary_precision': 0.85171103, 'binary_recall': 0.8853755, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.8682171}
confusion matrix:
     0    1
0  186   39
1   29  224
early stop counter: 2
val acc:0.8657299280166626, best validation acc: 0.9156908392906189, corresponding to test acc:                         0.9121338725090027 / 0.9121338725090027
after epoch: 28,now: 2024-07-11 22:23:15.082458,epoch time: 0:10:25.914050,used: 4:52:14.858890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99686056, 'precision': 0.9854195, 'recall': 0.980572, 'specificity': 0.980572, 'f1': 0.98298216, 'auroc': 0.9996784, 'binary_precision': 0.9980815, 'binary_recall': 0.9986193, 'binary_specificity': 0.96252465, 'binary_f1_score': 0.9983503}
confusion matrix:
      0      1
0  1464     57
1    41  29654
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.87695193, 'recall': 0.8722222, 'specificity': 0.8722222, 'f1': 0.8708919, 'auroc': 0.9415112, 'binary_precision': 0.82608694, 'binary_recall': 0.9349206, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.8771407}
confusion matrix:
     0    1
0  527  124
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.8505081, 'recall': 0.8441721, 'specificity': 0.8441721, 'f1': 0.8456584, 'auroc': 0.9326482, 'binary_precision': 0.82846713, 'binary_recall': 0.8972332, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.86148006}
confusion matrix:
     0    1
0  178   47
1   26  227
early stop counter: 3
val acc:0.8711943626403809, best validation acc: 0.9156908392906189, corresponding to test acc:                         0.9121338725090027 / 0.9121338725090027
after epoch: 29,now: 2024-07-11 22:33:39.544600,epoch time: 0:10:24.462142,used: 5:02:39.321032,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99452204, 'precision': 0.9548862, 'recall': 0.9896353, 'specificity': 0.9896353, 'f1': 0.97154313, 'auroc': 0.999671, 'binary_precision': 0.9991884, 'binary_recall': 0.99504966, 'binary_specificity': 0.9842209, 'binary_f1_score': 0.9971147}
confusion matrix:
      0      1
0  1497     24
1   147  29548
---- Validation: 
scalar performance:
{'acc': 0.90242, 'precision': 0.90358377, 'recall': 0.90289295, 'specificity': 0.90289295, 'f1': 0.90240073, 'auroc': 0.95497525, 'binary_precision': 0.877429, 'binary_recall': 0.931746, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.9037722}
confusion matrix:
     0    1
0  569   82
1   43  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9016736, 'precision': 0.9065715, 'recall': 0.90539306, 'specificity': 0.90539306, 'f1': 0.9016628, 'auroc': 0.94201136, 'binary_precision': 0.9681818, 'binary_recall': 0.84189725, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.9006342}
confusion matrix:
     0    1
0  218    7
1   40  213
early stop counter: 4
val acc:0.9024199843406677, best validation acc: 0.9156908392906189, corresponding to test acc:                         0.9121338725090027 / 0.9121338725090027
after epoch: 30,now: 2024-07-11 22:44:03.274477,epoch time: 0:10:23.729877,used: 5:13:03.050909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_17_31_00_seed_1_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:13:03.050909 at 2024-07-11 22:44:03.274477
persisted model performance metric: 

scalar performance:
{'acc': 0.9121339, 'precision': 0.91670334, 'recall': 0.91576636, 'specificity': 0.91576636, 'f1': 0.91212773, 'auroc': 0.9579271, 'binary_precision': 0.97737557, 'binary_recall': 0.85375494, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.9113924}
confusion matrix:
     0    1
0  220    5
1   37  216
oracle model performance metric: 

scalar performance:
{'acc': 0.9121339, 'precision': 0.91670334, 'recall': 0.91576636, 'specificity': 0.91576636, 'f1': 0.91212773, 'auroc': 0.9579271, 'binary_precision': 0.97737557, 'binary_recall': 0.85375494, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.9113924}
confusion matrix:
     0    1
0  220    5
1   37  216
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 714768 GiB | 714767 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |  40408 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  28072 MiB |  13598 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1253 MiB | 540837 GiB | 540836 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 531178 GiB | 531178 GiB |
|       from small pool |  12646 KiB |     45 MiB |   9658 GiB |   9658 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4907    |  135896 K  |  135895 K  |
|       from large pool |     187    |    1413    |   64883 K  |   64883 K  |
|       from small pool |    1129    |    4718    |   71013 K  |   71011 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4907    |  135896 K  |  135895 K  |
|       from large pool |     187    |    1413    |   64883 K  |   64883 K  |
|       from small pool |    1129    |    4718    |   71013 K  |   71011 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1205    |     571    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |    2023    |   81389 K  |   81388 K  |
|       from large pool |      40    |     604    |   46075 K  |   46075 K  |
|       from small pool |      64    |    1981    |   35313 K  |   35313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |      0 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 540837 GiB | 540837 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531179 GiB | 531178 GiB |
|       from small pool |      0 KiB |     45 MiB |   9658 GiB |   9658 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135896 K  |  135896 K  |
|       from large pool |       2    |    1413    |   64883 K  |   64883 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135896 K  |  135896 K  |
|       from large pool |       2    |    1413    |   64883 K  |   64883 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2023    |   81389 K  |   81389 K  |
|       from large pool |       4    |     604    |   46075 K  |   46075 K  |
|       from small pool |       0    |    1981    |   35314 K  |   35314 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |      0 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB | 540837 GiB | 540837 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531179 GiB | 531178 GiB |
|       from small pool |      0 KiB |     45 MiB |   9658 GiB |   9658 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135896 K  |  135896 K  |
|       from large pool |       2    |    1413    |   64883 K  |   64883 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135896 K  |  135896 K  |
|       from large pool |       2    |    1413    |   64883 K  |   64883 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2023    |   81389 K  |   81389 K  |
|       from large pool |       4    |     604    |   46075 K  |   46075 K  |
|       from small pool |       0    |    1981    |   35314 K  |   35314 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152

 Experiment start at: 2024-07-11 22:57:39.526723
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.981387, 'precision': 0.97127914, 'recall': 0.81991065, 'specificity': 0.81991065, 'f1': 0.8796451, 'auroc': 0.9953754, 'binary_precision': 0.98208404, 'binary_recall': 0.9986604, 'binary_specificity': 0.64116096, 'binary_f1_score': 0.9903029}
confusion matrix:
     0      1
0  972    544
1   40  29820
---- Validation: 
scalar performance:
{'acc': 0.48669797, 'precision': 0.24334899, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.32736844, 'auroc': 0.9079417, 'binary_precision': 0.48669797, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6547369}
confusion matrix:
   0    1
0  0  656
1  0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5452632, 'precision': 0.2726316, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.35286105, 'auroc': 0.91182256, 'binary_precision': 0.5452632, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7057221}
confusion matrix:
   0    1
0  0  216
1  0  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 23:08:11.143696,epoch time: 0:10:31.616973,used: 0:10:31.616973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9790286, 'precision': 0.85705537, 'recall': 0.9573618, 'specificity': 0.9573618, 'f1': 0.90012515, 'auroc': 0.99549675, 'binary_precision': 0.9965651, 'binary_recall': 0.9813463, 'binary_specificity': 0.9333773, 'binary_f1_score': 0.98889714}
confusion matrix:
      0      1
0  1415    101
1   557  29303
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.82022583, 'recall': 0.8037237, 'specificity': 0.8037237, 'f1': 0.7984156, 'auroc': 0.9167565, 'binary_precision': 0.733758, 'binary_recall': 0.926045, 'binary_specificity': 0.68140244, 'binary_f1_score': 0.8187633}
confusion matrix:
     0    1
0  447  209
1   46  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231579, 'precision': 0.82251155, 'recall': 0.82015944, 'specificity': 0.82015944, 'f1': 0.82109547, 'auroc': 0.91655946, 'binary_precision': 0.82771534, 'binary_recall': 0.85328186, 'binary_specificity': 0.787037, 'binary_f1_score': 0.8403042}
confusion matrix:
     0    1
0  170   46
1   38  221
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 23:18:38.037855,epoch time: 0:10:26.894159,used: 0:20:58.511132,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9900561, 'precision': 0.95578754, 'recall': 0.93403995, 'specificity': 0.93403995, 'f1': 0.9446171, 'auroc': 0.9976357, 'binary_precision': 0.9935195, 'binary_recall': 0.9960482, 'binary_specificity': 0.8720317, 'binary_f1_score': 0.9947822}
confusion matrix:
      0      1
0  1322    194
1   118  29742
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.75734425, 'recall': 0.6615976, 'specificity': 0.6615976, 'f1': 0.62108755, 'auroc': 0.8734713, 'binary_precision': 0.58697766, 'binary_recall': 0.9710611, 'binary_specificity': 0.35213414, 'binary_f1_score': 0.73167783}
confusion matrix:
     0    1
0  231  425
1   18  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76842105, 'precision': 0.7984816, 'recall': 0.752288, 'specificity': 0.752288, 'f1': 0.7534634, 'auroc': 0.879719, 'binary_precision': 0.7237237, 'binary_recall': 0.93050194, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.81418926}
confusion matrix:
     0    1
0  124   92
1   18  241
early stop counter: 1
val acc:0.6533646583557129, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.8231579065322876 / 0.8231579065322876
after epoch: 3,now: 2024-07-11 23:29:04.981144,epoch time: 0:10:26.943289,used: 0:31:25.454421,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9939125, 'precision': 0.98072356, 'recall': 0.9520327, 'specificity': 0.9520327, 'f1': 0.9658872, 'auroc': 0.9990878, 'binary_precision': 0.99522614, 'binary_recall': 0.9983925, 'binary_specificity': 0.90567285, 'binary_f1_score': 0.9968068}
confusion matrix:
      0      1
0  1373    143
1    48  29812
---- Validation: 
scalar performance:
{'acc': 0.7456964, 'precision': 0.79715765, 'recall': 0.75112003, 'specificity': 0.75112003, 'f1': 0.73679686, 'auroc': 0.9226556, 'binary_precision': 0.6666667, 'binary_recall': 0.95498395, 'binary_specificity': 0.5472561, 'binary_f1_score': 0.785195}
confusion matrix:
     0    1
0  359  297
1   28  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7978947, 'precision': 0.8022938, 'recall': 0.7904601, 'specificity': 0.7904601, 'f1': 0.79300576, 'auroc': 0.9030638, 'binary_precision': 0.7820069, 'binary_recall': 0.87258685, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.82481754}
confusion matrix:
     0    1
0  153   63
1   33  226
early stop counter: 2
val acc:0.7456964254379272, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.8231579065322876 / 0.8231579065322876
after epoch: 4,now: 2024-07-11 23:39:33.392156,epoch time: 0:10:28.411012,used: 0:41:53.865433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9896099, 'precision': 0.9763751, 'recall': 0.9078207, 'specificity': 0.9078207, 'f1': 0.93914974, 'auroc': 0.99858093, 'binary_precision': 0.99079365, 'binary_recall': 0.998359, 'binary_specificity': 0.8172823, 'binary_f1_score': 0.9945619}
confusion matrix:
      0      1
0  1239    277
1    49  29811
---- Validation: 
scalar performance:
{'acc': 0.7738654, 'precision': 0.8068112, 'recall': 0.7781424, 'specificity': 0.7781424, 'f1': 0.7693404, 'auroc': 0.91056097, 'binary_precision': 0.6994012, 'binary_recall': 0.9389067, 'binary_specificity': 0.61737806, 'binary_f1_score': 0.8016472}
confusion matrix:
     0    1
0  405  251
1   38  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8473431, 'recall': 0.8467843, 'specificity': 0.8467843, 'f1': 0.84704834, 'auroc': 0.9206349, 'binary_precision': 0.85823756, 'binary_recall': 0.8648649, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.8615385}
confusion matrix:
     0    1
0  179   37
1   35  224
new oracle model saved
early stop counter: 3
val acc:0.7738654017448425, best validation acc: 0.8004694581031799, corresponding to test acc:                         0.8231579065322876 / 0.848421037197113
after epoch: 5,now: 2024-07-11 23:50:01.102801,epoch time: 0:10:27.710645,used: 0:52:21.576078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9929564, 'precision': 0.9690019, 'recall': 0.9534087, 'specificity': 0.9534087, 'f1': 0.9610584, 'auroc': 0.9986328, 'binary_precision': 0.99542004, 'binary_recall': 0.9971869, 'binary_specificity': 0.9096306, 'binary_f1_score': 0.9963027}
confusion matrix:
      0      1
0  1379    137
1    84  29776
---- Validation: 
scalar performance:
{'acc': 0.86776215, 'precision': 0.86935455, 'recall': 0.8686892, 'specificity': 0.8686892, 'f1': 0.86774385, 'auroc': 0.931003, 'binary_precision': 0.8375559, 'binary_recall': 0.903537, 'binary_specificity': 0.83384144, 'binary_f1_score': 0.86929613}
confusion matrix:
     0    1
0  547  109
1   60  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.872898, 'recall': 0.8726047, 'specificity': 0.8726047, 'f1': 0.86526257, 'auroc': 0.9301444, 'binary_precision': 0.95348835, 'binary_recall': 0.7915058, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.86497897}
confusion matrix:
     0    1
0  206   10
1   54  205
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-12 00:00:29.684106,epoch time: 0:10:28.581305,used: 1:02:50.157383,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9928289, 'precision': 0.9708841, 'recall': 0.949898, 'specificity': 0.949898, 'f1': 0.9601245, 'auroc': 0.99769616, 'binary_precision': 0.9950553, 'binary_recall': 0.9974213, 'binary_specificity': 0.9023747, 'binary_f1_score': 0.9962369}
confusion matrix:
      0      1
0  1368    148
1    77  29783
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.8191939, 'recall': 0.77436084, 'specificity': 0.77436084, 'f1': 0.76192176, 'auroc': 0.928959, 'binary_precision': 0.68600684, 'binary_recall': 0.9694534, 'binary_specificity': 0.5792683, 'binary_f1_score': 0.80346435}
confusion matrix:
     0    1
0  380  276
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84210527, 'precision': 0.84734714, 'recall': 0.8356124, 'specificity': 0.8356124, 'f1': 0.8386001, 'auroc': 0.94251394, 'binary_precision': 0.82167834, 'binary_recall': 0.90733594, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.86238533}
confusion matrix:
     0    1
0  165   51
1   24  235
early stop counter: 1
val acc:0.7691705822944641, best validation acc: 0.8677621483802795, corresponding to test acc:                         0.8652631640434265 / 0.8652631640434265
after epoch: 7,now: 2024-07-12 00:10:58.365947,epoch time: 0:10:28.681841,used: 1:13:18.839224,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9910441, 'precision': 0.9295314, 'recall': 0.9821458, 'specificity': 0.9821458, 'f1': 0.95412767, 'auroc': 0.99886394, 'binary_precision': 0.9985841, 'binary_recall': 0.991996, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.99527913}
confusion matrix:
      0      1
0  1474     42
1   239  29621
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.86608803, 'recall': 0.8662899, 'specificity': 0.8662899, 'f1': 0.86614597, 'auroc': 0.9260646, 'binary_precision': 0.85736924, 'binary_recall': 0.86977494, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.86352754}
confusion matrix:
     0    1
0  566   90
1   81  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71157897, 'precision': 0.79519767, 'recall': 0.7343683, 'specificity': 0.7343683, 'f1': 0.7013278, 'auroc': 0.9186686, 'binary_precision': 0.9765625, 'binary_recall': 0.48262548, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.64599484}
confusion matrix:
     0    1
0  213    3
1  134  125
early stop counter: 2
val acc:0.8661971688270569, best validation acc: 0.8677621483802795, corresponding to test acc:                         0.8652631640434265 / 0.8652631640434265
after epoch: 8,now: 2024-07-12 00:21:26.998469,epoch time: 0:10:28.632522,used: 1:23:47.471746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9937213, 'precision': 0.9498842, 'recall': 0.98605686, 'specificity': 0.98605686, 'f1': 0.96718603, 'auroc': 0.999441, 'binary_precision': 0.9988564, 'binary_recall': 0.99454117, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.99669415}
confusion matrix:
      0      1
0  1482     34
1   163  29697
---- Validation: 
scalar performance:
{'acc': 0.8951487, 'precision': 0.897703, 'recall': 0.89411616, 'specificity': 0.89411616, 'f1': 0.8947362, 'auroc': 0.9404508, 'binary_precision': 0.9236111, 'binary_recall': 0.8553055, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.8881469}
confusion matrix:
     0    1
0  612   44
1   90  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7957895, 'precision': 0.84261036, 'recall': 0.812357, 'specificity': 0.812357, 'f1': 0.79331243, 'auroc': 0.9529529, 'binary_precision': 0.99390244, 'binary_recall': 0.6293436, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.77068555}
confusion matrix:
     0    1
0  215    1
1   96  163
better model found
persisted
after epoch: 9,now: 2024-07-12 00:31:53.569742,epoch time: 0:10:26.571273,used: 1:34:14.043019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9934663, 'precision': 0.9769186, 'recall': 0.950859, 'specificity': 0.950859, 'f1': 0.9634814, 'auroc': 0.99883133, 'binary_precision': 0.9951247, 'binary_recall': 0.9980241, 'binary_specificity': 0.9036939, 'binary_f1_score': 0.9965723}
confusion matrix:
      0      1
0  1370    146
1    59  29801
---- Validation: 
scalar performance:
{'acc': 0.87010956, 'precision': 0.8708329, 'recall': 0.8707675, 'specificity': 0.8707675, 'f1': 0.87010926, 'auroc': 0.93774754, 'binary_precision': 0.84650457, 'binary_recall': 0.8954984, 'binary_specificity': 0.8460366, 'binary_f1_score': 0.8703125}
confusion matrix:
     0    1
0  555  101
1   65  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8821053, 'precision': 0.8898927, 'recall': 0.889586, 'specificity': 0.889586, 'f1': 0.88210475, 'auroc': 0.95007503, 'binary_precision': 0.97209305, 'binary_recall': 0.8069498, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.8818565}
confusion matrix:
     0    1
0  210    6
1   50  209
new oracle model saved
early stop counter: 1
val acc:0.8701095581054688, best validation acc: 0.8951486945152283, corresponding to test acc:                         0.7957894802093506 / 0.88210529088974
after epoch: 10,now: 2024-07-12 00:42:20.484222,epoch time: 0:10:26.914480,used: 1:44:40.957499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.984383, 'precision': 0.98730695, 'recall': 0.8415212, 'specificity': 0.8415212, 'f1': 0.9003011, 'auroc': 0.99829865, 'binary_precision': 0.9841741, 'binary_recall': 0.9996651, 'binary_specificity': 0.6833773, 'binary_f1_score': 0.9918591}
confusion matrix:
      0      1
0  1036    480
1    10  29850
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.8465216, 'recall': 0.83942187, 'specificity': 0.83942187, 'f1': 0.836668, 'auroc': 0.9339709, 'binary_precision': 0.7827869, 'binary_recall': 0.92122185, 'binary_specificity': 0.75762194, 'binary_f1_score': 0.84638107}
confusion matrix:
     0    1
0  497  159
1   49  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8968421, 'precision': 0.898669, 'recall': 0.9015623, 'specificity': 0.9015623, 'f1': 0.8967525, 'auroc': 0.9594594, 'binary_precision': 0.95652175, 'binary_recall': 0.84942085, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.89979553}
confusion matrix:
     0    1
0  206   10
1   39  220
new oracle model saved
early stop counter: 2
val acc:0.8372457027435303, best validation acc: 0.8951486945152283, corresponding to test acc:                         0.7957894802093506 / 0.8968421220779419
after epoch: 11,now: 2024-07-12 00:52:48.387111,epoch time: 0:10:27.902889,used: 1:55:08.860388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9943587, 'precision': 0.97659266, 'recall': 0.96134615, 'specificity': 0.96134615, 'f1': 0.9688313, 'auroc': 0.99927497, 'binary_precision': 0.9961887, 'binary_recall': 0.9978902, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.9970387}
confusion matrix:
      0      1
0  1402    114
1    63  29797
---- Validation: 
scalar performance:
{'acc': 0.8208138, 'precision': 0.82363915, 'recall': 0.8220409, 'specificity': 0.8220409, 'f1': 0.8207083, 'auroc': 0.90472555, 'binary_precision': 0.7860262, 'binary_recall': 0.8681672, 'binary_specificity': 0.7759146, 'binary_f1_score': 0.8250573}
confusion matrix:
     0    1
0  509  147
1   82  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82736844, 'precision': 0.8262644, 'recall': 0.82863224, 'specificity': 0.82863224, 'f1': 0.8267225, 'auroc': 0.9176855, 'binary_precision': 0.8612245, 'binary_recall': 0.8146718, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.83730155}
confusion matrix:
     0    1
0  182   34
1   48  211
early stop counter: 3
val acc:0.820813775062561, best validation acc: 0.8951486945152283, corresponding to test acc:                         0.7957894802093506 / 0.8968421220779419
after epoch: 12,now: 2024-07-12 01:03:16.197437,epoch time: 0:10:27.810326,used: 2:05:36.670714,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9948687, 'precision': 0.9652549, 'recall': 0.98008525, 'specificity': 0.98008525, 'f1': 0.97254, 'auroc': 0.99931645, 'binary_precision': 0.99815494, 'binary_recall': 0.9964501, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.9973018}
confusion matrix:
      0      1
0  1461     55
1   106  29754
---- Validation: 
scalar performance:
{'acc': 0.8482003, 'precision': 0.8534812, 'recall': 0.84984267, 'specificity': 0.84984267, 'f1': 0.8479676, 'auroc': 0.9282336, 'binary_precision': 0.80311614, 'binary_recall': 0.91157556, 'binary_specificity': 0.7881098, 'binary_f1_score': 0.8539157}
confusion matrix:
     0    1
0  517  139
1   55  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.8330672, 'recall': 0.8355677, 'specificity': 0.8355677, 'f1': 0.83141077, 'auroc': 0.9175426, 'binary_precision': 0.88744587, 'binary_recall': 0.7915058, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.83673465}
confusion matrix:
     0    1
0  190   26
1   54  205
early stop counter: 4
val acc:0.8482003211975098, best validation acc: 0.8951486945152283, corresponding to test acc:                         0.7957894802093506 / 0.8968421220779419
after epoch: 13,now: 2024-07-12 01:13:43.102666,epoch time: 0:10:26.905229,used: 2:16:03.575943,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99455, 'precision': 0.97886056, 'recall': 0.96113354, 'specificity': 0.96113354, 'f1': 0.96981096, 'auroc': 0.99873775, 'binary_precision': 0.9961563, 'binary_recall': 0.9981246, 'binary_specificity': 0.9241425, 'binary_f1_score': 0.9971395}
confusion matrix:
      0      1
0  1401    115
1    56  29804
---- Validation: 
scalar performance:
{'acc': 0.87245697, 'precision': 0.87233996, 'recall': 0.87251246, 'specificity': 0.87251246, 'f1': 0.8724, 'auroc': 0.93352485, 'binary_precision': 0.8648649, 'binary_recall': 0.8745981, 'binary_specificity': 0.87042683, 'binary_f1_score': 0.86970425}
confusion matrix:
     0    1
0  571   85
1   78  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8694737, 'precision': 0.8841549, 'recall': 0.87915593, 'specificity': 0.87915593, 'f1': 0.8693758, 'auroc': 0.9461247, 'binary_precision': 0.9852217, 'binary_recall': 0.77220076, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.86580086}
confusion matrix:
     0    1
0  213    3
1   59  200
early stop counter: 5
val acc:0.872456967830658, best validation acc: 0.8951486945152283, corresponding to test acc:                         0.7957894802093506 / 0.8968421220779419
after epoch: 14,now: 2024-07-12 01:24:12.849537,epoch time: 0:10:29.746871,used: 2:26:33.322814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99455, 'precision': 0.95711863, 'recall': 0.9864923, 'specificity': 0.9864923, 'f1': 0.9712931, 'auroc': 0.99950576, 'binary_precision': 0.99885744, 'binary_recall': 0.99541193, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9971317}
confusion matrix:
      0      1
0  1482     34
1   137  29723
---- Validation: 
scalar performance:
{'acc': 0.899061, 'precision': 0.8999144, 'recall': 0.89846873, 'specificity': 0.89846873, 'f1': 0.89884543, 'auroc': 0.94513416, 'binary_precision': 0.9128978, 'binary_recall': 0.8762058, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.8941755}
confusion matrix:
     0    1
0  604   52
1   77  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7136842, 'precision': 0.80314285, 'recall': 0.73706746, 'specificity': 0.73706746, 'f1': 0.7027753, 'auroc': 0.9385278, 'binary_precision': 0.992, 'binary_recall': 0.47876447, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6458333}
confusion matrix:
     0    1
0  215    1
1  135  124
better model found
persisted
after epoch: 15,now: 2024-07-12 01:34:43.816133,epoch time: 0:10:30.966596,used: 2:37:04.289410,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9897055, 'precision': 0.9203031, 'recall': 0.9795641, 'specificity': 0.9795641, 'f1': 0.9477303, 'auroc': 0.9989567, 'binary_precision': 0.9983802, 'binary_recall': 0.99079037, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9945708}
confusion matrix:
      0      1
0  1468     48
1   275  29585
---- Validation: 
scalar performance:
{'acc': 0.85524255, 'precision': 0.8616329, 'recall': 0.85703576, 'specificity': 0.85703576, 'f1': 0.854954, 'auroc': 0.93704414, 'binary_precision': 0.8064516, 'binary_recall': 0.9244373, 'binary_specificity': 0.78963417, 'binary_f1_score': 0.8614232}
confusion matrix:
     0    1
0  518  138
1   47  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82526314, 'precision': 0.85523945, 'recall': 0.8386154, 'specificity': 0.8386154, 'f1': 0.82436323, 'auroc': 0.9425676, 'binary_precision': 0.98351645, 'binary_recall': 0.6911197, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.81179136}
confusion matrix:
     0    1
0  213    3
1   80  179
early stop counter: 1
val acc:0.8552425503730774, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 16,now: 2024-07-12 01:45:11.484960,epoch time: 0:10:27.668827,used: 2:47:31.958237,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9944544, 'precision': 0.96091604, 'recall': 0.98049366, 'specificity': 0.98049366, 'f1': 0.970477, 'auroc': 0.99924684, 'binary_precision': 0.998221, 'binary_recall': 0.9959478, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.99708307}
confusion matrix:
      0      1
0  1463     53
1   121  29739
---- Validation: 
scalar performance:
{'acc': 0.8849765, 'precision': 0.8866122, 'recall': 0.8859158, 'specificity': 0.8859158, 'f1': 0.88496065, 'auroc': 0.94309944, 'binary_precision': 0.8539493, 'binary_recall': 0.92122185, 'binary_specificity': 0.8506098, 'binary_f1_score': 0.8863109}
confusion matrix:
     0    1
0  558   98
1   49  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8736842, 'precision': 0.8846548, 'recall': 0.88224834, 'specificity': 0.88224834, 'f1': 0.87365675, 'auroc': 0.96035326, 'binary_precision': 0.97607654, 'binary_recall': 0.7876448, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.8717949}
confusion matrix:
     0    1
0  211    5
1   55  204
early stop counter: 2
val acc:0.8849765062332153, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 17,now: 2024-07-12 01:55:39.325471,epoch time: 0:10:27.840511,used: 2:57:59.798748,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9952193, 'precision': 0.97977996, 'recall': 0.9677466, 'specificity': 0.9677466, 'f1': 0.9736781, 'auroc': 0.9994155, 'binary_precision': 0.9968227, 'binary_recall': 0.9981581, 'binary_specificity': 0.9373351, 'binary_f1_score': 0.9974899}
confusion matrix:
      0      1
0  1421     95
1    55  29805
---- Validation: 
scalar performance:
{'acc': 0.8348983, 'precision': 0.85068524, 'recall': 0.8377186, 'specificity': 0.8377186, 'f1': 0.8337328, 'auroc': 0.939615, 'binary_precision': 0.7693316, 'binary_recall': 0.9437299, 'binary_specificity': 0.73170733, 'binary_f1_score': 0.8476534}
confusion matrix:
     0    1
0  480  176
1   35  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85052633, 'precision': 0.8518811, 'recall': 0.8464089, 'specificity': 0.8464089, 'f1': 0.848264, 'auroc': 0.93161017, 'binary_precision': 0.8430657, 'binary_recall': 0.8918919, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.8667917}
confusion matrix:
     0    1
0  173   43
1   28  231
early stop counter: 3
val acc:0.8348982930183411, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 18,now: 2024-07-12 02:06:07.165376,epoch time: 0:10:27.839905,used: 3:08:27.638653,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9952511, 'precision': 0.9644345, 'recall': 0.98560834, 'specificity': 0.98560834, 'f1': 0.97475743, 'auroc': 0.9994641, 'binary_precision': 0.9987243, 'binary_recall': 0.99628264, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.99750197}
confusion matrix:
      0      1
0  1478     38
1   111  29749
---- Validation: 
scalar performance:
{'acc': 0.86150235, 'precision': 0.8673681, 'recall': 0.86321664, 'specificity': 0.86321664, 'f1': 0.86126375, 'auroc': 0.9343385, 'binary_precision': 0.81382227, 'binary_recall': 0.9276527, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.86701727}
confusion matrix:
     0    1
0  524  132
1   45  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.8755524, 'recall': 0.8706653, 'specificity': 0.8706653, 'f1': 0.8609485, 'auroc': 0.9542042, 'binary_precision': 0.97536945, 'binary_recall': 0.76447874, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  211    5
1   61  198
early stop counter: 4
val acc:0.8615023493766785, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 19,now: 2024-07-12 02:16:32.821282,epoch time: 0:10:25.655906,used: 3:18:53.294559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9931476, 'precision': 0.94263935, 'recall': 0.9891992, 'specificity': 0.9891992, 'f1': 0.96461165, 'auroc': 0.9994505, 'binary_precision': 0.9992254, 'binary_recall': 0.99356997, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9963897}
confusion matrix:
      0      1
0  1493     23
1   192  29668
---- Validation: 
scalar performance:
{'acc': 0.87871677, 'precision': 0.88541734, 'recall': 0.87698513, 'specificity': 0.87698513, 'f1': 0.8777611, 'auroc': 0.9427912, 'binary_precision': 0.9300184, 'binary_recall': 0.8118971, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.86695284}
confusion matrix:
     0    1
0  618   38
1  117  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757895, 'precision': 0.79189193, 'recall': 0.7027027, 'specificity': 0.7027027, 'f1': 0.6570622, 'auroc': 0.94122696, 'binary_precision': 1.0, 'binary_recall': 0.4054054, 'binary_specificity': 1.0, 'binary_f1_score': 0.5769231}
confusion matrix:
     0    1
0  216    0
1  154  105
early stop counter: 5
val acc:0.878716766834259, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 20,now: 2024-07-12 02:26:57.909453,epoch time: 0:10:25.088171,used: 3:29:18.382730,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9949643, 'precision': 0.9819608, 'recall': 0.96260345, 'specificity': 0.96260345, 'f1': 0.97206134, 'auroc': 0.99944675, 'binary_precision': 0.9962906, 'binary_recall': 0.99842596, 'binary_specificity': 0.926781, 'binary_f1_score': 0.99735713}
confusion matrix:
      0      1
0  1405    111
1    47  29813
---- Validation: 
scalar performance:
{'acc': 0.7707355, 'precision': 0.8047532, 'recall': 0.7750936, 'specificity': 0.7750936, 'f1': 0.76593626, 'auroc': 0.89423686, 'binary_precision': 0.69606674, 'binary_recall': 0.9389067, 'binary_specificity': 0.6112805, 'binary_f1_score': 0.79945236}
confusion matrix:
     0    1
0  401  255
1   38  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8105263, 'precision': 0.8163847, 'recall': 0.80281174, 'specificity': 0.80281174, 'f1': 0.8056818, 'auroc': 0.90136564, 'binary_precision': 0.79037803, 'binary_recall': 0.8880309, 'binary_specificity': 0.7175926, 'binary_f1_score': 0.8363637}
confusion matrix:
     0    1
0  155   61
1   29  230
early stop counter: 6
val acc:0.770735502243042, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 21,now: 2024-07-12 02:37:26.270791,epoch time: 0:10:28.361338,used: 3:39:46.744068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9959523, 'precision': 0.9787097, 'recall': 0.97721076, 'specificity': 0.97721076, 'f1': 0.9779589, 'auroc': 0.99962497, 'binary_precision': 0.99779004, 'binary_recall': 0.9979571, 'binary_specificity': 0.95646435, 'binary_f1_score': 0.9978736}
confusion matrix:
      0      1
0  1450     66
1    61  29799
---- Validation: 
scalar performance:
{'acc': 0.8458529, 'precision': 0.8492106, 'recall': 0.8445146, 'specificity': 0.8445146, 'f1': 0.8450323, 'auroc': 0.9209866, 'binary_precision': 0.8774423, 'binary_recall': 0.7942122, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.8337553}
confusion matrix:
     0    1
0  587   69
1  128  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.81355846, 'recall': 0.7780012, 'specificity': 0.7780012, 'f1': 0.75597554, 'auroc': 0.90145504, 'binary_precision': 0.9677419, 'binary_recall': 0.57915056, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7246377}
confusion matrix:
     0    1
0  211    5
1  109  150
early stop counter: 7
val acc:0.8458529114723206, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 22,now: 2024-07-12 02:47:54.295139,epoch time: 0:10:28.024348,used: 3:50:14.768416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9953149, 'precision': 0.963754, 'recall': 0.9872072, 'specificity': 0.9872072, 'f1': 0.9751569, 'auroc': 0.9996643, 'binary_precision': 0.99889183, 'binary_recall': 0.9961822, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.99753517}
confusion matrix:
      0      1
0  1483     33
1   114  29746
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8424785, 'recall': 0.83466005, 'specificity': 0.83466005, 'f1': 0.8351282, 'auroc': 0.91695994, 'binary_precision': 0.8817006, 'binary_recall': 0.76688105, 'binary_specificity': 0.902439, 'binary_f1_score': 0.82029235}
confusion matrix:
     0    1
0  592   64
1  145  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7536842, 'precision': 0.81555295, 'recall': 0.7729783, 'specificity': 0.7729783, 'f1': 0.7485305, 'auroc': 0.93777704, 'binary_precision': 0.9797297, 'binary_recall': 0.55984557, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7125307}
confusion matrix:
     0    1
0  213    3
1  114  145
early stop counter: 8
val acc:0.836463212966919, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 23,now: 2024-07-12 02:58:25.078798,epoch time: 0:10:30.783659,used: 4:00:45.552075,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.996271, 'precision': 0.9848869, 'recall': 0.9742475, 'specificity': 0.9742475, 'f1': 0.9795015, 'auroc': 0.9995807, 'binary_precision': 0.99745774, 'binary_recall': 0.99862695, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.99804205}
confusion matrix:
      0      1
0  1440     76
1    41  29819
---- Validation: 
scalar performance:
{'acc': 0.8873239, 'precision': 0.88745177, 'recall': 0.88770247, 'specificity': 0.88770247, 'f1': 0.887314, 'auroc': 0.93815684, 'binary_precision': 0.871118, 'binary_recall': 0.90192926, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.8862559}
confusion matrix:
     0    1
0  573   83
1   61  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83157897, 'precision': 0.8509158, 'recall': 0.84248537, 'specificity': 0.84248537, 'f1': 0.8312491, 'auroc': 0.93214643, 'binary_precision': 0.95897436, 'binary_recall': 0.72200775, 'binary_specificity': 0.962963, 'binary_f1_score': 0.8237886}
confusion matrix:
     0    1
0  208    8
1   72  187
early stop counter: 9
val acc:0.8873239159584045, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 24,now: 2024-07-12 03:08:53.589032,epoch time: 0:10:28.510234,used: 4:11:14.062309,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9945818, 'precision': 0.9926461, 'recall': 0.9480013, 'specificity': 0.9480013, 'f1': 0.9691479, 'auroc': 0.9996005, 'binary_precision': 0.99476737, 'binary_recall': 0.99956465, 'binary_specificity': 0.896438, 'binary_f1_score': 0.9971602}
confusion matrix:
      0      1
0  1359    157
1    13  29847
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.84603345, 'recall': 0.82000923, 'specificity': 0.82000923, 'f1': 0.81322795, 'auroc': 0.9480188, 'binary_precision': 0.7374233, 'binary_recall': 0.96623796, 'binary_specificity': 0.6737805, 'binary_f1_score': 0.8364649}
confusion matrix:
     0    1
0  442  214
1   21  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.85531306, 'recall': 0.8414039, 'specificity': 0.8414039, 'f1': 0.84475434, 'auroc': 0.9422995, 'binary_precision': 0.8235294, 'binary_recall': 0.9189189, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.8686132}
confusion matrix:
     0    1
0  165   51
1   21  238
early stop counter: 10
val acc:0.8161189556121826, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 25,now: 2024-07-12 03:19:21.133282,epoch time: 0:10:27.544250,used: 4:21:41.606559,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9965898, 'precision': 0.9721849, 'recall': 0.99194694, 'specificity': 0.99194694, 'f1': 0.9818395, 'auroc': 0.999774, 'binary_precision': 0.9993287, 'binary_recall': 0.9970864, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.99820626}
confusion matrix:
      0      1
0  1496     20
1    87  29773
---- Validation: 
scalar performance:
{'acc': 0.8826291, 'precision': 0.8846804, 'recall': 0.8816711, 'specificity': 0.8816711, 'f1': 0.8822126, 'auroc': 0.9410267, 'binary_precision': 0.90689653, 'binary_recall': 0.84565914, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.87520796}
confusion matrix:
     0    1
0  602   54
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74526316, 'precision': 0.8142791, 'recall': 0.7656406, 'specificity': 0.7656406, 'f1': 0.7389268, 'auroc': 0.9370799, 'binary_precision': 0.9859155, 'binary_recall': 0.5405405, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.69825435}
confusion matrix:
     0    1
0  214    2
1  119  140
early stop counter: 11
val acc:0.8826290965080261, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 26,now: 2024-07-12 03:29:49.990427,epoch time: 0:10:28.857145,used: 4:32:10.463704,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9958248, 'precision': 0.97189754, 'recall': 0.98340523, 'specificity': 0.98340523, 'f1': 0.97757393, 'auroc': 0.99960375, 'binary_precision': 0.9984575, 'binary_recall': 0.9971534, 'binary_specificity': 0.969657, 'binary_f1_score': 0.997805}
confusion matrix:
      0      1
0  1470     46
1    85  29775
---- Validation: 
scalar performance:
{'acc': 0.8928012, 'precision': 0.8936032, 'recall': 0.8934961, 'specificity': 0.8934961, 'f1': 0.8928006, 'auroc': 0.9459301, 'binary_precision': 0.8679818, 'binary_recall': 0.91961414, 'binary_specificity': 0.86737806, 'binary_f1_score': 0.8930522}
confusion matrix:
     0    1
0  569   87
1   50  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85052633, 'precision': 0.8617293, 'recall': 0.8590912, 'specificity': 0.8590912, 'f1': 0.8504839, 'auroc': 0.92628336, 'binary_precision': 0.9519231, 'binary_recall': 0.76447874, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8479657}
confusion matrix:
     0    1
0  206   10
1   61  198
early stop counter: 12
val acc:0.8928012251853943, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 27,now: 2024-07-12 03:40:16.513218,epoch time: 0:10:26.522791,used: 4:42:36.986495,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9964304, 'precision': 0.991538, 'recall': 0.9693221, 'specificity': 0.9693221, 'f1': 0.9801445, 'auroc': 0.99976015, 'binary_precision': 0.99692637, 'binary_recall': 0.9993302, 'binary_specificity': 0.939314, 'binary_f1_score': 0.99812686}
confusion matrix:
      0      1
0  1424     92
1    20  29840
---- Validation: 
scalar performance:
{'acc': 0.76212835, 'precision': 0.8232366, 'recall': 0.7678344, 'specificity': 0.7678344, 'f1': 0.7528204, 'auroc': 0.9404974, 'binary_precision': 0.67588496, 'binary_recall': 0.9823151, 'binary_specificity': 0.55335367, 'binary_f1_score': 0.80078644}
confusion matrix:
     0    1
0  363  293
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7978947, 'precision': 0.8200506, 'recall': 0.7846954, 'specificity': 0.7846954, 'f1': 0.78792274, 'auroc': 0.92583656, 'binary_precision': 0.7554859, 'binary_recall': 0.93050194, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.83391005}
confusion matrix:
     0    1
0  138   78
1   18  241
early stop counter: 13
val acc:0.7621283531188965, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 28,now: 2024-07-12 03:50:43.958117,epoch time: 0:10:27.444899,used: 4:53:04.431394,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9956336, 'precision': 0.97088265, 'recall': 0.9823655, 'specificity': 0.9823655, 'f1': 0.9765468, 'auroc': 0.99961746, 'binary_precision': 0.9983569, 'binary_recall': 0.9970529, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9977045}
confusion matrix:
      0      1
0  1467     49
1    88  29772
---- Validation: 
scalar performance:
{'acc': 0.8356807, 'precision': 0.85174286, 'recall': 0.83852243, 'specificity': 0.83852243, 'f1': 0.8344988, 'auroc': 0.93207884, 'binary_precision': 0.76963353, 'binary_recall': 0.9453376, 'binary_specificity': 0.73170733, 'binary_f1_score': 0.8484849}
confusion matrix:
     0    1
0  480  176
1   34  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8442105, 'precision': 0.84570825, 'recall': 0.8483037, 'specificity': 0.8483037, 'f1': 0.844055, 'auroc': 0.91500425, 'binary_precision': 0.9004329, 'binary_recall': 0.8030888, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.84897953}
confusion matrix:
     0    1
0  193   23
1   51  208
early stop counter: 14
val acc:0.8356807231903076, best validation acc: 0.8990610241889954, corresponding to test acc:                         0.7136842012405396 / 0.8968421220779419
after epoch: 29,now: 2024-07-12 04:01:11.816456,epoch time: 0:10:27.858339,used: 5:03:32.289733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9904704, 'precision': 0.92142403, 'recall': 0.9881058, 'specificity': 0.9881058, 'f1': 0.9520037, 'auroc': 0.99948156, 'binary_precision': 0.9992569, 'binary_recall': 0.9907234, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9949719}
confusion matrix:
      0      1
0  1494     22
1   277  29583
---- Validation: 
scalar performance:
{'acc': 0.90140843, 'precision': 0.90260816, 'recall': 0.9007137, 'specificity': 0.9007137, 'f1': 0.9011606, 'auroc': 0.94996226, 'binary_precision': 0.9189189, 'binary_recall': 0.8745981, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.89621085}
confusion matrix:
     0    1
0  608   48
1   78  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7368421, 'precision': 0.8134327, 'recall': 0.7583029, 'specificity': 0.7583029, 'f1': 0.72915953, 'auroc': 0.9579222, 'binary_precision': 0.99264705, 'binary_recall': 0.5212355, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6835443}
confusion matrix:
     0    1
0  215    1
1  124  135
better model found
persisted
after epoch: 30,now: 2024-07-12 04:11:40.054190,epoch time: 0:10:28.237734,used: 5:14:00.527467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_22_57_39_seed_2_21870152
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:14:00.527467 at 2024-07-12 04:11:40.054190
persisted model performance metric: 

scalar performance:
{'acc': 0.7368421, 'precision': 0.8134327, 'recall': 0.7583029, 'specificity': 0.7583029, 'f1': 0.72915953, 'auroc': 0.9579222, 'binary_precision': 0.99264705, 'binary_recall': 0.5212355, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6835443}
confusion matrix:
     0    1
0  215    1
1  124  135
oracle model performance metric: 

scalar performance:
{'acc': 0.8968421, 'precision': 0.898669, 'recall': 0.9015623, 'specificity': 0.9015623, 'f1': 0.8967525, 'auroc': 0.9594594, 'binary_precision': 0.95652175, 'binary_recall': 0.84942085, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.89979553}
confusion matrix:
     0    1
0  206   10
1   39  220
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB |   1045 TiB |   1045 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1031 TiB |   1031 TiB |
|       from small pool |  40408 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41664 MiB |  27190 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     66 MiB |     94 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1253 MiB |    790 TiB |    790 TiB |
|       from large pool | 435388 KiB |   1244 MiB |    776 TiB |    776 TiB |
|       from small pool |  12646 KiB |     45 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4927    |  203707 K  |  203706 K  |
|       from large pool |     187    |    1413    |   97185 K  |   97184 K  |
|       from small pool |    1129    |    4738    |  106522 K  |  106521 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4927    |  203707 K  |  203706 K  |
|       from large pool |     187    |    1413    |   97185 K  |   97184 K  |
|       from small pool |    1129    |    4738    |  106522 K  |  106521 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1776    |    1142    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      33    |      47    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |    2034    |  121177 K  |  121177 K  |
|       from large pool |      40    |     604    |   67959 K  |   67959 K  |
|       from small pool |      59    |    1992    |   53218 K  |   53218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1045 TiB |   1045 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41664 MiB |  40782 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     66 MiB |     94 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1253 MiB |    790 TiB |    790 TiB |
|       from large pool |  24320 KiB |   1244 MiB |    776 TiB |    776 TiB |
|       from small pool |      0 KiB |     45 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4927    |  203707 K  |  203707 K  |
|       from large pool |       2    |    1413    |   97185 K  |   97185 K  |
|       from small pool |       0    |    4738    |  106522 K  |  106522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4927    |  203707 K  |  203707 K  |
|       from large pool |       2    |    1413    |   97185 K  |   97185 K  |
|       from small pool |       0    |    4738    |  106522 K  |  106522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1776    |    1713    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      33    |      47    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2034    |  121177 K  |  121177 K  |
|       from large pool |       4    |     604    |   67959 K  |   67959 K  |
|       from small pool |       0    |    1992    |   53218 K  |   53218 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 04:19:07 2024]
Finished job 0.
1 of 1 steps (100%) done
