Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Thu Jul 11 13:53:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153

 Experiment start at: 2024-07-11 14:03:02.780327
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9810957, 'precision': 0.88439745, 'recall': 0.92448723, 'specificity': 0.92448723, 'f1': 0.90331405, 'auroc': 0.9929987, 'binary_precision': 0.9928613, 'binary_recall': 0.98722327, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.9900342}
confusion matrix:
      0      1
0  1309    210
1   378  29207
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6630435, 'precision': 0.7733948, 'recall': 0.6674271, 'specificity': 0.6674271, 'f1': 0.6286459, 'auroc': 0.9328984, 'binary_precision': 0.5961723, 'binary_recall': 0.98110235, 'binary_specificity': 0.35375193, 'binary_f1_score': 0.74166673}
confusion matrix:
     0    1
0  231  422
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7195876, 'precision': 0.7937922, 'recall': 0.6875107, 'specificity': 0.6875107, 'f1': 0.6776149, 'auroc': 0.9175366, 'binary_precision': 0.6717949, 'binary_recall': 0.97037035, 'binary_specificity': 0.40465117, 'binary_f1_score': 0.7939395}
confusion matrix:
    0    1
0  87  128
1   8  262
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 14:14:33.106768,epoch time: 0:11:30.326441,used: 0:11:30.326441,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9830247, 'precision': 0.96872264, 'recall': 0.8421269, 'specificity': 0.8421269, 'f1': 0.8944982, 'auroc': 0.99532974, 'binary_precision': 0.9841058, 'binary_recall': 0.9982762, 'binary_specificity': 0.68597764, 'binary_f1_score': 0.99114037}
confusion matrix:
      0      1
0  1042    477
1    51  29534
---- Validation: 
scalar performance:
{'acc': 0.53493786, 'precision': 0.75729334, 'recall': 0.5413476, 'specificity': 0.5413476, 'f1': 0.41613293, 'auroc': 0.91976225, 'binary_precision': 0.5145867, 'binary_recall': 1.0, 'binary_specificity': 0.08269525, 'binary_f1_score': 0.67950773}
confusion matrix:
    0    1
0  54  599
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041237, 'precision': 0.7723913, 'recall': 0.5539621, 'specificity': 0.5539621, 'f1': 0.46849313, 'auroc': 0.92814815, 'binary_precision': 0.5847826, 'binary_recall': 0.9962963, 'binary_specificity': 0.11162791, 'binary_f1_score': 0.7369863}
confusion matrix:
    0    1
0  24  191
1   1  269
early stop counter: 1
val acc:0.534937858581543, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.7195876240730286 / 0.7195876240730286
after epoch: 2,now: 2024-07-11 14:25:25.025964,epoch time: 0:10:51.919196,used: 0:22:22.245637,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9892297, 'precision': 0.96048045, 'recall': 0.9202806, 'specificity': 0.9202806, 'f1': 0.93935746, 'auroc': 0.9970119, 'binary_precision': 0.9920269, 'binary_recall': 0.99668765, 'binary_specificity': 0.8438735, 'binary_f1_score': 0.9943518}
confusion matrix:
      0      1
0  1281    237
1    98  29488
---- Validation: 
scalar performance:
{'acc': 0.6537267, 'precision': 0.776429, 'recall': 0.65832555, 'specificity': 0.65832555, 'f1': 0.61425734, 'auroc': 0.8965429, 'binary_precision': 0.5887324, 'binary_recall': 0.98740155, 'binary_specificity': 0.32924962, 'binary_f1_score': 0.73764706}
confusion matrix:
     0    1
0  215  438
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68247426, 'precision': 0.7644665, 'recall': 0.646124, 'specificity': 0.646124, 'f1': 0.62418985, 'auroc': 0.9146598, 'binary_precision': 0.64285713, 'binary_recall': 0.96666664, 'binary_specificity': 0.3255814, 'binary_f1_score': 0.7721893}
confusion matrix:
    0    1
0  70  145
1   9  261
early stop counter: 2
val acc:0.6537266969680786, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.7195876240730286 / 0.7195876240730286
after epoch: 3,now: 2024-07-11 14:36:13.109981,epoch time: 0:10:48.084017,used: 0:33:10.329654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9805813, 'precision': 0.86854064, 'recall': 0.9548186, 'specificity': 0.9548186, 'f1': 0.90650725, 'auroc': 0.9959729, 'binary_precision': 0.99616504, 'binary_recall': 0.98336995, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.9897261}
confusion matrix:
      0      1
0  1407    112
1   492  29093
---- Validation: 
scalar performance:
{'acc': 0.76009315, 'precision': 0.7883665, 'recall': 0.76224935, 'specificity': 0.76224935, 'f1': 0.7550395, 'auroc': 0.89562404, 'binary_precision': 0.69451076, 'binary_recall': 0.91653544, 'binary_specificity': 0.60796326, 'binary_f1_score': 0.7902241}
confusion matrix:
     0    1
0  397  256
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7463918, 'precision': 0.78262866, 'recall': 0.72248065, 'specificity': 0.72248065, 'f1': 0.7226136, 'auroc': 0.90191215, 'binary_precision': 0.7058824, 'binary_recall': 0.93333334, 'binary_specificity': 0.5116279, 'binary_f1_score': 0.80382776}
confusion matrix:
     0    1
0  110  105
1   18  252
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 14:46:58.257348,epoch time: 0:10:45.147367,used: 0:43:55.477021,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99115866, 'precision': 0.95053977, 'recall': 0.95475817, 'specificity': 0.95475817, 'f1': 0.9526379, 'auroc': 0.99795735, 'binary_precision': 0.9956037, 'binary_recall': 0.9950989, 'binary_specificity': 0.9144174, 'binary_f1_score': 0.99535114}
confusion matrix:
      0      1
0  1389    130
1   145  29440
---- Validation: 
scalar performance:
{'acc': 0.8423913, 'precision': 0.8539102, 'recall': 0.84365195, 'specificity': 0.84365195, 'f1': 0.8414161, 'auroc': 0.9363326, 'binary_precision': 0.78647214, 'binary_recall': 0.9338583, 'binary_specificity': 0.7534456, 'binary_f1_score': 0.8538516}
confusion matrix:
     0    1
0  492  161
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.8617094, 'recall': 0.86451334, 'specificity': 0.86451334, 'f1': 0.86273587, 'auroc': 0.93407404, 'binary_precision': 0.8923077, 'binary_recall': 0.85925925, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8754717}
confusion matrix:
     0    1
0  187   28
1   38  232
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-11 14:57:44.598790,epoch time: 0:10:46.341442,used: 0:54:41.818463,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98286396, 'precision': 0.8720033, 'recall': 0.9850552, 'specificity': 0.9850552, 'f1': 0.91998374, 'auroc': 0.9986911, 'binary_precision': 0.99934685, 'binary_recall': 0.9826269, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9909163}
confusion matrix:
      0      1
0  1499     19
1   514  29072
---- Validation: 
scalar performance:
{'acc': 0.8695652, 'precision': 0.87812, 'recall': 0.86851966, 'specificity': 0.86851966, 'f1': 0.86857146, 'auroc': 0.93598294, 'binary_precision': 0.93160814, 'binary_recall': 0.7937008, 'binary_specificity': 0.94333845, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  616   37
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8226804, 'precision': 0.8551713, 'recall': 0.840267, 'specificity': 0.840267, 'f1': 0.82204413, 'auroc': 0.9308871, 'binary_precision': 0.99462366, 'binary_recall': 0.6851852, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.8114035}
confusion matrix:
     0    1
0  214    1
1   85  185
better model found
persisted
after epoch: 6,now: 2024-07-11 15:08:32.143707,epoch time: 0:10:47.544917,used: 1:05:29.363380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98804015, 'precision': 0.92420566, 'recall': 0.952182, 'specificity': 0.952182, 'f1': 0.9376906, 'auroc': 0.997424, 'binary_precision': 0.9954883, 'binary_recall': 0.9919216, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.99370176}
confusion matrix:
      0      1
0  1386    133
1   239  29346
---- Validation: 
scalar performance:
{'acc': 0.82220495, 'precision': 0.84525204, 'recall': 0.8240043, 'specificity': 0.8240043, 'f1': 0.81972724, 'auroc': 0.9315913, 'binary_precision': 0.75248754, 'binary_recall': 0.9527559, 'binary_specificity': 0.69525266, 'binary_f1_score': 0.8408617}
confusion matrix:
     0    1
0  454  199
1   30  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83505154, 'precision': 0.83268106, 'recall': 0.83385015, 'specificity': 0.83385015, 'f1': 0.83320725, 'auroc': 0.9117829, 'binary_precision': 0.85714287, 'binary_recall': 0.84444445, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8507463}
confusion matrix:
     0    1
0  177   38
1   42  228
early stop counter: 1
val acc:0.8222049474716187, best validation acc: 0.8695651888847351, corresponding to test acc:                         0.8226804137229919 / 0.8639175295829773
after epoch: 7,now: 2024-07-11 15:19:25.637879,epoch time: 0:10:53.494172,used: 1:16:22.857552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9934092, 'precision': 0.96601367, 'recall': 0.962811, 'specificity': 0.962811, 'f1': 0.96440613, 'auroc': 0.999033, 'binary_precision': 0.9963509, 'binary_recall': 0.9967213, 'binary_specificity': 0.9289006, 'binary_f1_score': 0.9965361}
confusion matrix:
      0      1
0  1411    108
1    97  29488
---- Validation: 
scalar performance:
{'acc': 0.7996894, 'precision': 0.8367246, 'recall': 0.80199444, 'specificity': 0.80199444, 'f1': 0.7948412, 'auroc': 0.9367498, 'binary_precision': 0.7215041, 'binary_recall': 0.96692914, 'binary_specificity': 0.63705975, 'binary_f1_score': 0.8263796}
confusion matrix:
     0    1
0  416  237
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85993636, 'recall': 0.84483206, 'specificity': 0.84483206, 'f1': 0.84908116, 'auroc': 0.94170547, 'binary_precision': 0.8327759, 'binary_recall': 0.9222222, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.87521964}
confusion matrix:
     0    1
0  165   50
1   21  249
early stop counter: 2
val acc:0.7996894121170044, best validation acc: 0.8695651888847351, corresponding to test acc:                         0.8226804137229919 / 0.8639175295829773
after epoch: 8,now: 2024-07-11 15:30:11.181416,epoch time: 0:10:45.543537,used: 1:27:08.401089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9904514, 'precision': 0.98240095, 'recall': 0.9127983, 'specificity': 0.9127983, 'f1': 0.9445966, 'auroc': 0.998441, 'binary_precision': 0.99117893, 'binary_recall': 0.9988508, 'binary_specificity': 0.8267457, 'binary_f1_score': 0.99500006}
confusion matrix:
      0      1
0  1255    263
1    34  29552
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.82079613, 'recall': 0.7623518, 'specificity': 0.7623518, 'f1': 0.748594, 'auroc': 0.9365165, 'binary_precision': 0.67682266, 'binary_recall': 0.97952753, 'binary_specificity': 0.5451761, 'binary_f1_score': 0.8005148}
confusion matrix:
     0    1
0  356  297
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7917526, 'precision': 0.8238821, 'recall': 0.7717485, 'specificity': 0.7717485, 'f1': 0.7761617, 'auroc': 0.9334539, 'binary_precision': 0.7463557, 'binary_recall': 0.94814813, 'binary_specificity': 0.59534883, 'binary_f1_score': 0.8352366}
confusion matrix:
     0    1
0  128   87
1   14  256
early stop counter: 3
val acc:0.7593167424201965, best validation acc: 0.8695651888847351, corresponding to test acc:                         0.8226804137229919 / 0.8639175295829773
after epoch: 9,now: 2024-07-11 15:40:57.919743,epoch time: 0:10:46.738327,used: 1:37:55.139416,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9929591, 'precision': 0.98479366, 'recall': 0.93821776, 'specificity': 0.93821776, 'f1': 0.96019924, 'auroc': 0.99925923, 'binary_precision': 0.9937454, 'binary_recall': 0.99888456, 'binary_specificity': 0.877551, 'binary_f1_score': 0.9963083}
confusion matrix:
      0      1
0  1333    186
1    33  29552
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.8194097, 'recall': 0.75777936, 'specificity': 0.75777936, 'f1': 0.7430291, 'auroc': 0.94876766, 'binary_precision': 0.67206043, 'binary_recall': 0.98110235, 'binary_specificity': 0.5344564, 'binary_f1_score': 0.7976953}
confusion matrix:
     0    1
0  349  304
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80618554, 'precision': 0.8268215, 'recall': 0.7899225, 'specificity': 0.7899225, 'f1': 0.7950606, 'auroc': 0.9302498, 'binary_precision': 0.76829267, 'binary_recall': 0.93333334, 'binary_specificity': 0.6465116, 'binary_f1_score': 0.8428093}
confusion matrix:
     0    1
0  139   76
1   18  252
early stop counter: 4
val acc:0.7546584010124207, best validation acc: 0.8695651888847351, corresponding to test acc:                         0.8226804137229919 / 0.8639175295829773
after epoch: 10,now: 2024-07-11 15:51:45.086497,epoch time: 0:10:47.166754,used: 1:48:42.306170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847608, 'precision': 0.8858805, 'recall': 0.9794986, 'specificity': 0.9794986, 'f1': 0.92691183, 'auroc': 0.9982983, 'binary_precision': 0.9986297, 'binary_recall': 0.9853304, 'binary_specificity': 0.9736669, 'binary_f1_score': 0.99193543}
confusion matrix:
      0      1
0  1479     40
1   434  29151
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.8618773, 'recall': 0.8619262, 'specificity': 0.8619262, 'f1': 0.86179996, 'auroc': 0.9342345, 'binary_precision': 0.8520801, 'binary_recall': 0.8708661, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.8613707}
confusion matrix:
     0    1
0  557   96
1   82  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8185567, 'precision': 0.82161474, 'recall': 0.82519376, 'specificity': 0.82519376, 'f1': 0.8183335, 'auroc': 0.91078377, 'binary_precision': 0.89224136, 'binary_recall': 0.76666665, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8247012}
confusion matrix:
     0    1
0  190   25
1   63  207
early stop counter: 5
val acc:0.861801266670227, best validation acc: 0.8695651888847351, corresponding to test acc:                         0.8226804137229919 / 0.8639175295829773
after epoch: 11,now: 2024-07-11 16:02:32.601217,epoch time: 0:10:47.514720,used: 1:59:29.820890,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9916409, 'precision': 0.93212086, 'recall': 0.9868506, 'specificity': 0.9868506, 'f1': 0.95764726, 'auroc': 0.9990971, 'binary_precision': 0.99904704, 'binary_recall': 0.9921587, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.995591}
confusion matrix:
      0      1
0  1489     28
1   232  29355
---- Validation: 
scalar performance:
{'acc': 0.89518636, 'precision': 0.89560413, 'recall': 0.8954371, 'specificity': 0.8954371, 'f1': 0.8951832, 'auroc': 0.95020676, 'binary_precision': 0.8787879, 'binary_recall': 0.9133858, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.8957529}
confusion matrix:
     0    1
0  573   80
1   55  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85979384, 'precision': 0.8590503, 'recall': 0.863652, 'specificity': 0.863652, 'f1': 0.85921866, 'auroc': 0.9316796, 'binary_precision': 0.91056913, 'binary_recall': 0.8296296, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.86821705}
confusion matrix:
     0    1
0  193   22
1   46  224
better model found
persisted
after epoch: 12,now: 2024-07-11 16:13:24.233222,epoch time: 0:10:51.632005,used: 2:10:21.452895,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99463093, 'precision': 0.9615153, 'recall': 0.98250127, 'specificity': 0.98250127, 'f1': 0.9717468, 'auroc': 0.9991175, 'binary_precision': 0.9984074, 'binary_recall': 0.9959439, 'binary_specificity': 0.9690586, 'binary_f1_score': 0.9971741}
confusion matrix:
      0      1
0  1472     47
1   120  29465
---- Validation: 
scalar performance:
{'acc': 0.8664596, 'precision': 0.87805706, 'recall': 0.8676924, 'specificity': 0.8676924, 'f1': 0.865682, 'auroc': 0.9551283, 'binary_precision': 0.8082557, 'binary_recall': 0.9559055, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.8759019}
confusion matrix:
     0    1
0  509  144
1   28  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85360825, 'precision': 0.85993636, 'recall': 0.84483206, 'specificity': 0.84483206, 'f1': 0.84908116, 'auroc': 0.94747627, 'binary_precision': 0.8327759, 'binary_recall': 0.9222222, 'binary_specificity': 0.76744187, 'binary_f1_score': 0.87521964}
confusion matrix:
     0    1
0  165   50
1   21  249
early stop counter: 1
val acc:0.8664596080780029, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 13,now: 2024-07-11 16:24:17.523449,epoch time: 0:10:53.290227,used: 2:21:14.743122,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9939236, 'precision': 0.95167845, 'recall': 0.9868065, 'specificity': 0.9868065, 'f1': 0.96850395, 'auroc': 0.99940753, 'binary_precision': 0.9989138, 'binary_recall': 0.99469346, 'binary_specificity': 0.9789196, 'binary_f1_score': 0.9967992}
confusion matrix:
      0      1
0  1486     32
1   157  29429
---- Validation: 
scalar performance:
{'acc': 0.886646, 'precision': 0.88852924, 'recall': 0.886168, 'specificity': 0.886168, 'f1': 0.8863994, 'auroc': 0.9440547, 'binary_precision': 0.9123103, 'binary_recall': 0.8519685, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.88110745}
confusion matrix:
     0    1
0  601   52
1   94  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8329897, 'precision': 0.8357262, 'recall': 0.839578, 'specificity': 0.839578, 'f1': 0.8327593, 'auroc': 0.9112145, 'binary_precision': 0.9055794, 'binary_recall': 0.7814815, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8389662}
confusion matrix:
     0    1
0  193   22
1   59  211
early stop counter: 2
val acc:0.8866459727287292, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 14,now: 2024-07-11 16:35:16.193592,epoch time: 0:10:58.670143,used: 2:32:13.413265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.98276484, 'recall': 0.96036386, 'specificity': 0.96036386, 'f1': 0.97126806, 'auroc': 0.9993095, 'binary_precision': 0.9960217, 'binary_recall': 0.99851286, 'binary_specificity': 0.9222149, 'binary_f1_score': 0.99726576}
confusion matrix:
      0      1
0  1399    118
1    44  29543
---- Validation: 
scalar performance:
{'acc': 0.8462733, 'precision': 0.8687466, 'recall': 0.84800136, 'specificity': 0.84800136, 'f1': 0.84432745, 'auroc': 0.95890796, 'binary_precision': 0.77415305, 'binary_recall': 0.9716535, 'binary_specificity': 0.72434914, 'binary_f1_score': 0.8617318}
confusion matrix:
     0    1
0  473  180
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.8639631, 'recall': 0.84013784, 'specificity': 0.84013784, 'f1': 0.8456233, 'auroc': 0.9449096, 'binary_precision': 0.81935483, 'binary_recall': 0.94074076, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.87586206}
confusion matrix:
     0    1
0  159   56
1   16  254
early stop counter: 3
val acc:0.8462733030319214, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 15,now: 2024-07-11 16:46:10.477445,epoch time: 0:10:54.283853,used: 2:43:07.697118,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9955954, 'precision': 0.98224884, 'recall': 0.9698739, 'specificity': 0.9698739, 'f1': 0.9759717, 'auroc': 0.99957204, 'binary_precision': 0.996996, 'binary_recall': 0.9983776, 'binary_specificity': 0.94137025, 'binary_f1_score': 0.9976863}
confusion matrix:
      0      1
0  1429     89
1    48  29538
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.85252726, 'recall': 0.8234991, 'specificity': 0.8234991, 'f1': 0.81803083, 'auroc': 0.9544803, 'binary_precision': 0.7442702, 'binary_recall': 0.9716535, 'binary_specificity': 0.6753446, 'binary_f1_score': 0.84289616}
confusion matrix:
     0    1
0  441  212
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515464, 'precision': 0.8582432, 'recall': 0.8425064, 'specificity': 0.8425064, 'f1': 0.84684205, 'auroc': 0.94770026, 'binary_precision': 0.83, 'binary_recall': 0.9222222, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.87368417}
confusion matrix:
     0    1
0  164   51
1   21  249
early stop counter: 4
val acc:0.8214285969734192, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 16,now: 2024-07-11 16:57:00.430098,epoch time: 0:10:49.952653,used: 2:53:57.649771,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9918017, 'precision': 0.9756717, 'recall': 0.9341745, 'specificity': 0.9341745, 'f1': 0.9538696, 'auroc': 0.998557, 'binary_precision': 0.9933724, 'binary_recall': 0.99803954, 'binary_specificity': 0.8703094, 'binary_f1_score': 0.9957005}
confusion matrix:
      0      1
0  1322    197
1    58  29527
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.821655, 'recall': 0.75782275, 'specificity': 0.75782275, 'f1': 0.7426704, 'auroc': 0.9608777, 'binary_precision': 0.67132115, 'binary_recall': 0.984252, 'binary_specificity': 0.5313936, 'binary_f1_score': 0.79821205}
confusion matrix:
     0    1
0  347  306
1   10  625
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8164948, 'precision': 0.85144794, 'recall': 0.7972868, 'specificity': 0.7972868, 'f1': 0.8032131, 'auroc': 0.9612231, 'binary_precision': 0.7653959, 'binary_recall': 0.96666664, 'binary_specificity': 0.627907, 'binary_f1_score': 0.8543371}
confusion matrix:
     0    1
0  135   80
1    9  261
early stop counter: 5
val acc:0.7546584010124207, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 17,now: 2024-07-11 17:07:51.409742,epoch time: 0:10:50.979644,used: 3:04:48.629415,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9872042, 'precision': 0.98547506, 'recall': 0.87492573, 'specificity': 0.87492573, 'f1': 0.92234796, 'auroc': 0.9987875, 'binary_precision': 0.9873435, 'binary_recall': 0.99935776, 'binary_specificity': 0.75049376, 'binary_f1_score': 0.99331427}
confusion matrix:
      0      1
0  1140    379
1    19  29566
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.7760615, 'recall': 0.6239995, 'specificity': 0.6239995, 'f1': 0.5605174, 'auroc': 0.95219636, 'binary_precision': 0.56417114, 'binary_recall': 0.9968504, 'binary_specificity': 0.25114855, 'binary_f1_score': 0.72054636}
confusion matrix:
     0    1
0  164  489
1    2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7195876, 'precision': 0.80205834, 'recall': 0.6865633, 'specificity': 0.6865633, 'f1': 0.6753681, 'auroc': 0.9541774, 'binary_precision': 0.67005074, 'binary_recall': 0.9777778, 'binary_specificity': 0.39534885, 'binary_f1_score': 0.7951807}
confusion matrix:
    0    1
0  85  130
1   6  264
early stop counter: 6
val acc:0.6187888383865356, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 18,now: 2024-07-11 17:18:40.932874,epoch time: 0:10:49.523132,used: 3:15:38.152547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9927341, 'precision': 0.97940826, 'recall': 0.94090986, 'specificity': 0.94090986, 'f1': 0.9592628, 'auroc': 0.99899924, 'binary_precision': 0.994043, 'binary_recall': 0.99834377, 'binary_specificity': 0.88347596, 'binary_f1_score': 0.99618876}
confusion matrix:
      0      1
0  1342    177
1    49  29536
---- Validation: 
scalar performance:
{'acc': 0.7950311, 'precision': 0.83883214, 'recall': 0.7975305, 'specificity': 0.7975305, 'f1': 0.7890997, 'auroc': 0.950706, 'binary_precision': 0.7134637, 'binary_recall': 0.97637796, 'binary_specificity': 0.618683, 'binary_f1_score': 0.8244681}
confusion matrix:
     0    1
0  404  249
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8185567, 'precision': 0.8346118, 'recall': 0.80434966, 'specificity': 0.80434966, 'f1': 0.80963427, 'auroc': 0.93950045, 'binary_precision': 0.784375, 'binary_recall': 0.9296296, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8508475}
confusion matrix:
     0    1
0  146   69
1   19  251
early stop counter: 7
val acc:0.7950310707092285, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 19,now: 2024-07-11 17:29:39.886105,epoch time: 0:10:58.953231,used: 3:26:37.105778,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9896155, 'precision': 0.9147081, 'recall': 0.9898541, 'specificity': 0.9898541, 'f1': 0.94874406, 'auroc': 0.9992203, 'binary_precision': 0.99948794, 'binary_recall': 0.9895897, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.99451417}
confusion matrix:
      0      1
0  1503     15
1   308  29278
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.8759177, 'recall': 0.8703332, 'specificity': 0.8703332, 'f1': 0.87051356, 'auroc': 0.9389106, 'binary_precision': 0.91504425, 'binary_recall': 0.8141732, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.8616666}
confusion matrix:
     0    1
0  605   48
1  118  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7237113, 'precision': 0.79847455, 'recall': 0.75043064, 'specificity': 0.75043064, 'f1': 0.717307, 'auroc': 0.929888, 'binary_precision': 0.97887325, 'binary_recall': 0.5148148, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.67475724}
confusion matrix:
     0    1
0  212    3
1  131  139
early stop counter: 8
val acc:0.8711180090904236, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 20,now: 2024-07-11 17:40:30.621183,epoch time: 0:10:50.735078,used: 3:37:27.840856,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99437374, 'precision': 0.98430276, 'recall': 0.95423263, 'specificity': 0.95423263, 'f1': 0.9687314, 'auroc': 0.9994157, 'binary_precision': 0.9953849, 'binary_recall': 0.9987156, 'binary_specificity': 0.9097497, 'binary_f1_score': 0.9970474}
confusion matrix:
      0      1
0  1381    137
1    38  29548
---- Validation: 
scalar performance:
{'acc': 0.8338509, 'precision': 0.8605114, 'recall': 0.8357502, 'specificity': 0.8357502, 'f1': 0.83124685, 'auroc': 0.95897555, 'binary_precision': 0.75891757, 'binary_recall': 0.9716535, 'binary_specificity': 0.69984686, 'binary_f1_score': 0.85221}
confusion matrix:
     0    1
0  457  196
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8391753, 'precision': 0.85456145, 'recall': 0.82618433, 'specificity': 0.82618433, 'f1': 0.8318846, 'auroc': 0.94928515, 'binary_precision': 0.8037975, 'binary_recall': 0.94074076, 'binary_specificity': 0.7116279, 'binary_f1_score': 0.86689425}
confusion matrix:
     0    1
0  153   62
1   16  254
early stop counter: 9
val acc:0.8338509202003479, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 21,now: 2024-07-11 17:51:24.918833,epoch time: 0:10:54.297650,used: 3:48:22.138506,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99427724, 'precision': 0.9602916, 'recall': 0.97980535, 'specificity': 0.97980535, 'f1': 0.9698215, 'auroc': 0.99923193, 'binary_precision': 0.99813676, 'binary_recall': 0.99584264, 'binary_specificity': 0.9637681, 'binary_f1_score': 0.99698836}
confusion matrix:
      0      1
0  1463     55
1   123  29463
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8666642, 'recall': 0.85973155, 'specificity': 0.85973155, 'f1': 0.8581484, 'auroc': 0.9421953, 'binary_precision': 0.80900407, 'binary_recall': 0.9338583, 'binary_specificity': 0.7856049, 'binary_f1_score': 0.86695904}
confusion matrix:
     0    1
0  513  140
1   42  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8639175, 'precision': 0.86173385, 'recall': 0.8635659, 'specificity': 0.8635659, 'f1': 0.86251414, 'auroc': 0.93143845, 'binary_precision': 0.8863636, 'binary_recall': 0.8666667, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.87640446}
confusion matrix:
     0    1
0  185   30
1   36  234
early stop counter: 10
val acc:0.8586956262588501, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.8639175295829773
after epoch: 22,now: 2024-07-11 18:02:14.125866,epoch time: 0:10:49.207033,used: 3:59:11.345539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99520963, 'precision': 0.9694155, 'recall': 0.9796705, 'specificity': 0.9796705, 'f1': 0.97448105, 'auroc': 0.999437, 'binary_precision': 0.99807113, 'binary_recall': 0.9968904, 'binary_specificity': 0.96245056, 'binary_f1_score': 0.9974805}
confusion matrix:
      0      1
0  1461     57
1    92  29494
---- Validation: 
scalar performance:
{'acc': 0.82608694, 'precision': 0.8561869, 'recall': 0.8281149, 'specificity': 0.8281149, 'f1': 0.82292926, 'auroc': 0.95763946, 'binary_precision': 0.7490909, 'binary_recall': 0.97322834, 'binary_specificity': 0.6830015, 'binary_f1_score': 0.8465754}
confusion matrix:
     0    1
0  446  207
1   17  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8927835, 'precision': 0.8920331, 'recall': 0.8904393, 'specificity': 0.8904393, 'f1': 0.891173, 'auroc': 0.9529888, 'binary_precision': 0.8978102, 'binary_recall': 0.9111111, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.90441173}
confusion matrix:
     0    1
0  187   28
1   24  246
new oracle model saved
early stop counter: 11
val acc:0.8260869383811951, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.892783522605896
after epoch: 23,now: 2024-07-11 18:13:03.616135,epoch time: 0:10:49.490269,used: 4:10:00.835808,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99369854, 'precision': 0.97934115, 'recall': 0.9516904, 'specificity': 0.9516904, 'f1': 0.9650584, 'auroc': 0.9993798, 'binary_precision': 0.99514794, 'binary_recall': 0.99824244, 'binary_specificity': 0.9051383, 'binary_f1_score': 0.99669284}
confusion matrix:
      0      1
0  1374    144
1    52  29534
---- Validation: 
scalar performance:
{'acc': 0.8423913, 'precision': 0.8556106, 'recall': 0.8437388, 'specificity': 0.8437388, 'f1': 0.84125435, 'auroc': 0.93027216, 'binary_precision': 0.78346455, 'binary_recall': 0.9401575, 'binary_specificity': 0.74732006, 'binary_f1_score': 0.8546886}
confusion matrix:
     0    1
0  488  165
1   38  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371134, 'precision': 0.8365955, 'recall': 0.8323859, 'specificity': 0.8323859, 'f1': 0.83404005, 'auroc': 0.8929716, 'binary_precision': 0.83985764, 'binary_recall': 0.8740741, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.8566243}
confusion matrix:
     0    1
0  170   45
1   34  236
early stop counter: 12
val acc:0.842391312122345, best validation acc: 0.8951863646507263, corresponding to test acc:                         0.8597938418388367 / 0.892783522605896
after epoch: 24,now: 2024-07-11 18:23:52.862879,epoch time: 0:10:49.246744,used: 4:20:50.082552,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9955954, 'precision': 0.9837584, 'recall': 0.96831155, 'specificity': 0.96831155, 'f1': 0.9758953, 'auroc': 0.9994463, 'binary_precision': 0.9968283, 'binary_recall': 0.9985466, 'binary_specificity': 0.93807644, 'binary_f1_score': 0.9976867}
confusion matrix:
      0      1
0  1424     94
1    43  29543
---- Validation: 
scalar performance:
{'acc': 0.89829195, 'precision': 0.9021834, 'recall': 0.89899915, 'specificity': 0.89899915, 'f1': 0.8981445, 'auroc': 0.9605552, 'binary_precision': 0.85897434, 'binary_recall': 0.9496063, 'binary_specificity': 0.848392, 'binary_f1_score': 0.9020194}
confusion matrix:
     0    1
0  554   99
1   32  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9154639, 'precision': 0.9145256, 'recall': 0.91412574, 'specificity': 0.91412574, 'f1': 0.91432166, 'auroc': 0.9567442, 'binary_precision': 0.92250925, 'binary_recall': 0.9259259, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.9242144}
confusion matrix:
     0    1
0  194   21
1   20  250
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-11 18:34:40.687090,epoch time: 0:10:47.824211,used: 4:31:37.906763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99578834, 'precision': 0.97550374, 'recall': 0.9793625, 'specificity': 0.9793625, 'f1': 0.97742444, 'auroc': 0.9994368, 'binary_precision': 0.99800485, 'binary_recall': 0.99756634, 'binary_specificity': 0.96115863, 'binary_f1_score': 0.99778557}
confusion matrix:
      0      1
0  1460     59
1    72  29513
---- Validation: 
scalar performance:
{'acc': 0.89285713, 'precision': 0.89847076, 'recall': 0.8937044, 'specificity': 0.8937044, 'f1': 0.8926083, 'auroc': 0.95346016, 'binary_precision': 0.8475524, 'binary_recall': 0.9543307, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.89777774}
confusion matrix:
     0    1
0  544  109
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89896905, 'precision': 0.89751995, 'recall': 0.89788973, 'specificity': 0.89788973, 'f1': 0.8977009, 'auroc': 0.9483204, 'binary_precision': 0.91078067, 'binary_recall': 0.9074074, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.9090909}
confusion matrix:
     0    1
0  191   24
1   25  245
early stop counter: 1
val acc:0.8928571343421936, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.915463924407959 / 0.915463924407959
after epoch: 26,now: 2024-07-11 18:45:27.150010,epoch time: 0:10:46.462920,used: 4:42:24.369683,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99463093, 'precision': 0.9547473, 'recall': 0.99124056, 'specificity': 0.99124056, 'f1': 0.9722035, 'auroc': 0.99970996, 'binary_precision': 0.999355, 'binary_recall': 0.9949976, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9971716}
confusion matrix:
      0      1
0  1499     19
1   148  29438
---- Validation: 
scalar performance:
{'acc': 0.8773292, 'precision': 0.88093185, 'recall': 0.8780215, 'specificity': 0.8780215, 'f1': 0.87715864, 'auroc': 0.9425022, 'binary_precision': 0.84022826, 'binary_recall': 0.9275591, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.8817366}
confusion matrix:
     0    1
0  541  112
1   46  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85773194, 'precision': 0.8577472, 'recall': 0.85327303, 'specificity': 0.85327303, 'f1': 0.85504764, 'auroc': 0.90652883, 'binary_precision': 0.85765123, 'binary_recall': 0.8925926, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.8747731}
confusion matrix:
     0    1
0  175   40
1   29  241
early stop counter: 2
val acc:0.8773291707038879, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.915463924407959 / 0.915463924407959
after epoch: 27,now: 2024-07-11 18:56:13.755684,epoch time: 0:10:46.605674,used: 4:53:10.975357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99427724, 'precision': 0.9643935, 'recall': 0.974821, 'specificity': 0.974821, 'f1': 0.96954244, 'auroc': 0.9991493, 'binary_precision': 0.9975972, 'binary_recall': 0.9963833, 'binary_specificity': 0.9532587, 'binary_f1_score': 0.9969899}
confusion matrix:
      0      1
0  1448     71
1   107  29478
---- Validation: 
scalar performance:
{'acc': 0.8913044, 'precision': 0.89300305, 'recall': 0.89178234, 'specificity': 0.89178234, 'f1': 0.891253, 'auroc': 0.95127034, 'binary_precision': 0.8634361, 'binary_recall': 0.92598426, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.89361703}
confusion matrix:
     0    1
0  560   93
1   47  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8969072, 'precision': 0.9001124, 'recall': 0.90456504, 'specificity': 0.90456504, 'f1': 0.8967804, 'auroc': 0.937037, 'binary_precision': 0.9741379, 'binary_recall': 0.837037, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.90039843}
confusion matrix:
     0    1
0  209    6
1   44  226
early stop counter: 3
val acc:0.8913043737411499, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.915463924407959 / 0.915463924407959
after epoch: 28,now: 2024-07-11 19:07:01.164203,epoch time: 0:10:47.408519,used: 5:03:58.383876,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9948238, 'precision': 0.9878523, 'recall': 0.9557191, 'specificity': 0.9557191, 'f1': 0.9711769, 'auroc': 0.9995401, 'binary_precision': 0.99552053, 'binary_recall': 0.9990536, 'binary_specificity': 0.9123847, 'binary_f1_score': 0.99728394}
confusion matrix:
      0      1
0  1385    133
1    28  29558
---- Validation: 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8669461, 'recall': 0.84942424, 'specificity': 0.84942424, 'f1': 0.84621084, 'auroc': 0.9556451, 'binary_precision': 0.77961785, 'binary_recall': 0.9637795, 'binary_specificity': 0.7350689, 'binary_f1_score': 0.86197186}
confusion matrix:
     0    1
0  480  173
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90515465, 'precision': 0.90407646, 'recall': 0.9091301, 'specificity': 0.9091301, 'f1': 0.9047135, 'auroc': 0.95291984, 'binary_precision': 0.9516129, 'binary_recall': 0.8740741, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.91119695}
confusion matrix:
     0    1
0  203   12
1   34  236
early stop counter: 4
val acc:0.8478260636329651, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.915463924407959 / 0.915463924407959
after epoch: 29,now: 2024-07-11 19:17:46.485395,epoch time: 0:10:45.321192,used: 5:14:43.705068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9959491, 'precision': 0.98315096, 'recall': 0.97287214, 'specificity': 0.97287214, 'f1': 0.9779499, 'auroc': 0.99952537, 'binary_precision': 0.99729913, 'binary_recall': 0.9984452, 'binary_specificity': 0.94729906, 'binary_f1_score': 0.9978718}
confusion matrix:
      0      1
0  1438     80
1    46  29540
---- Validation: 
scalar performance:
{'acc': 0.878882, 'precision': 0.8829799, 'recall': 0.879618, 'specificity': 0.879618, 'f1': 0.8786843, 'auroc': 0.93750703, 'binary_precision': 0.8397163, 'binary_recall': 0.93228346, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.88358206}
confusion matrix:
     0    1
0  540  113
1   43  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8927835, 'precision': 0.8975954, 'recall': 0.90133506, 'specificity': 0.90133506, 'f1': 0.8927064, 'auroc': 0.9439448, 'binary_precision': 0.9780702, 'binary_recall': 0.82592595, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.8955823}
confusion matrix:
     0    1
0  210    5
1   47  223
early stop counter: 5
val acc:0.8788819909095764, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.915463924407959 / 0.915463924407959
after epoch: 30,now: 2024-07-11 19:28:37.788342,epoch time: 0:10:51.302947,used: 5:25:35.008015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_14_03_02_seed_0_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:25:35.008015 at 2024-07-11 19:28:37.788342
persisted model performance metric: 

scalar performance:
{'acc': 0.9154639, 'precision': 0.9145256, 'recall': 0.91412574, 'specificity': 0.91412574, 'f1': 0.91432166, 'auroc': 0.9567442, 'binary_precision': 0.92250925, 'binary_recall': 0.9259259, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.9242144}
confusion matrix:
     0    1
0  194   21
1   20  250
oracle model performance metric: 

scalar performance:
{'acc': 0.9154639, 'precision': 0.9145256, 'recall': 0.91412574, 'specificity': 0.91412574, 'f1': 0.91432166, 'auroc': 0.9567442, 'binary_precision': 0.92250925, 'binary_recall': 0.9259259, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.9242144}
confusion matrix:
     0    1
0  194   21
1   20  250
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455466 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455466 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool | 414861 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |  40604 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 359818 GiB | 359818 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 354998 GiB | 354998 GiB |
|       from small pool |  40408 KiB |     56 MiB |   4819 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 447702 KiB |   1252 MiB | 272712 GiB | 272712 GiB |
|       from large pool | 435058 KiB |   1243 MiB | 267869 GiB | 267868 GiB |
|       from small pool |  12643 KiB |     17 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1322    |    4893    |   68260 K  |   68259 K  |
|       from large pool |     187    |    1413    |   32653 K  |   32653 K  |
|       from small pool |    1135    |    4704    |   35607 K  |   35606 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1322    |    4893    |   68260 K  |   68259 K  |
|       from large pool |     187    |    1413    |   32653 K  |   32653 K  |
|       from small pool |    1135    |    4704    |   35607 K  |   35606 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |    2011    |   41882 K  |   41882 K  |
|       from large pool |      37    |     600    |   24237 K  |   24237 K  |
|       from small pool |      58    |    1973    |   17644 K  |   17644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 359818 GiB | 359818 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 354998 GiB | 354998 GiB |
|       from small pool |      0 KiB |     56 MiB |   4819 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 267869 GiB | 267869 GiB |
|       from small pool |      0 KiB |     46 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68260 K  |   68260 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35607 K  |   35607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68260 K  |   68260 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35607 K  |   35607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2011    |   41882 K  |   41882 K  |
|       from large pool |       4    |     600    |   24237 K  |   24237 K  |
|       from small pool |       0    |    1973    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 362996 GiB | 362996 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 358165 GiB | 358165 GiB |
|       from small pool |      0 KiB |     56 MiB |   4830 GiB |   4830 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 359818 GiB | 359818 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 354998 GiB | 354998 GiB |
|       from small pool |      0 KiB |     56 MiB |   4819 GiB |   4819 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  14480 MiB |  13598 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 272713 GiB | 272713 GiB |
|       from large pool |  24320 KiB |   1243 MiB | 267869 GiB | 267869 GiB |
|       from small pool |      0 KiB |     46 MiB |   4843 GiB |   4843 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4893    |   68260 K  |   68260 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35607 K  |   35607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4893    |   68260 K  |   68260 K  |
|       from large pool |       2    |    1413    |   32653 K  |   32653 K  |
|       from small pool |       0    |    4704    |   35607 K  |   35607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |     634    |     571    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2011    |   41882 K  |   41882 K  |
|       from large pool |       4    |     600    |   24237 K  |   24237 K  |
|       from small pool |       0    |    1973    |   17645 K  |   17645 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153

 Experiment start at: 2024-07-11 19:42:22.569465
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.98523194, 'precision': 0.95429194, 'recall': 0.8796443, 'specificity': 0.8796443, 'f1': 0.913252, 'auroc': 0.99539065, 'binary_precision': 0.987949, 'binary_recall': 0.99663246, 'binary_specificity': 0.76265615, 'binary_f1_score': 0.9922717}
confusion matrix:
      0      1
0  1160    361
1   100  29595
---- Validation: 
scalar performance:
{'acc': 0.6900859, 'precision': 0.78803265, 'recall': 0.6948029, 'specificity': 0.6948029, 'f1': 0.66446173, 'auroc': 0.9072782, 'binary_precision': 0.6159204, 'binary_recall': 0.98253965, 'binary_specificity': 0.40706605, 'binary_f1_score': 0.7571866}
confusion matrix:
     0    1
0  265  386
1   11  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.785609, 'recall': 0.6565393, 'specificity': 0.6565393, 'f1': 0.62554145, 'auroc': 0.89979804, 'binary_precision': 0.6225, 'binary_recall': 0.98418975, 'binary_specificity': 0.3288889, 'binary_f1_score': 0.76263404}
confusion matrix:
    0    1
0  74  151
1   4  249
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-11 19:53:11.931897,epoch time: 0:10:49.362432,used: 0:10:49.362432,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98753846, 'precision': 0.9198924, 'recall': 0.9519683, 'specificity': 0.9519683, 'f1': 0.9352648, 'auroc': 0.9962064, 'binary_precision': 0.99550253, 'binary_recall': 0.991379, 'binary_specificity': 0.91255754, 'binary_f1_score': 0.9934365}
confusion matrix:
      0      1
0  1388    133
1   256  29439
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.83834755, 'recall': 0.81638503, 'specificity': 0.81638503, 'f1': 0.8115189, 'auroc': 0.92596495, 'binary_precision': 0.7437811, 'binary_recall': 0.94920635, 'binary_specificity': 0.68356377, 'binary_f1_score': 0.8340307}
confusion matrix:
     0    1
0  445  206
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79288703, 'precision': 0.80646074, 'recall': 0.7861484, 'specificity': 0.7861484, 'f1': 0.78736943, 'auroc': 0.91815543, 'binary_precision': 0.7549669, 'binary_recall': 0.90118575, 'binary_specificity': 0.6711111, 'binary_f1_score': 0.8216216}
confusion matrix:
     0    1
0  151   74
1   25  228
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-11 20:03:55.716488,epoch time: 0:10:43.784591,used: 0:21:33.147023,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9876986, 'precision': 0.9587595, 'recall': 0.9040209, 'specificity': 0.9040209, 'f1': 0.92945623, 'auroc': 0.9973271, 'binary_precision': 0.9903965, 'binary_recall': 0.9967334, 'binary_specificity': 0.8113083, 'binary_f1_score': 0.99355483}
confusion matrix:
      0      1
0  1234    287
1    97  29598
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.7649548, 'recall': 0.6250384, 'specificity': 0.6250384, 'f1': 0.56404746, 'auroc': 0.92616487, 'binary_precision': 0.5641953, 'binary_recall': 0.9904762, 'binary_specificity': 0.2596006, 'binary_f1_score': 0.71889395}
confusion matrix:
     0    1
0  169  482
1    6  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62552303, 'precision': 0.7645811, 'recall': 0.60296005, 'specificity': 0.60296005, 'f1': 0.5450839, 'auroc': 0.90176547, 'binary_precision': 0.58685446, 'binary_recall': 0.9881423, 'binary_specificity': 0.21777777, 'binary_f1_score': 0.73637706}
confusion matrix:
    0    1
0  49  176
1   3  250
early stop counter: 1
val acc:0.6190476417541504, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.7928870320320129 / 0.7928870320320129
after epoch: 3,now: 2024-07-11 20:14:38.569682,epoch time: 0:10:42.853194,used: 0:32:16.000217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9868016, 'precision': 0.90160024, 'recall': 0.97497296, 'specificity': 0.97497296, 'f1': 0.93480045, 'auroc': 0.9983667, 'binary_precision': 0.99802715, 'binary_recall': 0.9880788, 'binary_specificity': 0.9618672, 'binary_f1_score': 0.99302804}
confusion matrix:
      0      1
0  1463     58
1   354  29341
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.8235337, 'recall': 0.82191503, 'specificity': 0.82191503, 'f1': 0.8210921, 'auroc': 0.91041374, 'binary_precision': 0.7918486, 'binary_recall': 0.8634921, 'binary_specificity': 0.7803379, 'binary_f1_score': 0.82611996}
confusion matrix:
     0    1
0  508  143
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200837, 'precision': 0.8229073, 'recall': 0.8229073, 'specificity': 0.8229073, 'f1': 0.8200837, 'auroc': 0.8959333, 'binary_precision': 0.8711111, 'binary_recall': 0.77470356, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8200837}
confusion matrix:
     0    1
0  196   29
1   57  196
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-11 20:25:21.556576,epoch time: 0:10:42.986894,used: 0:42:58.987111,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9901012, 'precision': 0.93190885, 'recall': 0.96703863, 'specificity': 0.96703863, 'f1': 0.94870067, 'auroc': 0.9980315, 'binary_precision': 0.9969896, 'binary_recall': 0.9925913, 'binary_specificity': 0.9414859, 'binary_f1_score': 0.9947856}
confusion matrix:
      0      1
0  1432     89
1   220  29475
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.8631345, 'recall': 0.8553251, 'specificity': 0.8553251, 'f1': 0.85338986, 'auroc': 0.9342209, 'binary_precision': 0.80136055, 'binary_recall': 0.9349206, 'binary_specificity': 0.77572966, 'binary_f1_score': 0.8630037}
confusion matrix:
     0    1
0  505  146
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87447697, 'precision': 0.8758785, 'recall': 0.8767501, 'specificity': 0.8767501, 'f1': 0.8744572, 'auroc': 0.9430303, 'binary_precision': 0.9177489, 'binary_recall': 0.8379447, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.876033}
confusion matrix:
     0    1
0  206   19
1   41  212
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-11 20:36:05.662777,epoch time: 0:10:44.106201,used: 0:53:43.093312,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9877306, 'precision': 0.9063319, 'recall': 0.9788822, 'specificity': 0.9788822, 'f1': 0.9392351, 'auroc': 0.9985237, 'binary_precision': 0.99840176, 'binary_recall': 0.98868537, 'binary_specificity': 0.96907896, 'binary_f1_score': 0.9935198}
confusion matrix:
      0      1
0  1473     47
1   336  29360
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.8656855, 'recall': 0.86571944, 'specificity': 0.86571944, 'f1': 0.86570036, 'auroc': 0.9239217, 'binary_precision': 0.86234176, 'binary_recall': 0.86507934, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.8637084}
confusion matrix:
     0    1
0  564   87
1   85  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8284519, 'precision': 0.8313043, 'recall': 0.8313043, 'specificity': 0.8313043, 'f1': 0.82845193, 'auroc': 0.8959333, 'binary_precision': 0.88, 'binary_recall': 0.7826087, 'binary_specificity': 0.88, 'binary_f1_score': 0.82845193}
confusion matrix:
     0    1
0  198   27
1   55  198
better model found
persisted
after epoch: 6,now: 2024-07-11 20:46:48.586151,epoch time: 0:10:42.923374,used: 1:04:26.016686,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9927601, 'precision': 0.9617436, 'recall': 0.96001506, 'specificity': 0.96001506, 'f1': 0.9608775, 'auroc': 0.99870914, 'binary_precision': 0.9960944, 'binary_recall': 0.9962957, 'binary_specificity': 0.92373437, 'binary_f1_score': 0.996195}
confusion matrix:
      0      1
0  1405    116
1   110  29585
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.82548636, 'recall': 0.8120583, 'specificity': 0.8120583, 'f1': 0.80862504, 'auroc': 0.9024114, 'binary_precision': 0.75097275, 'binary_recall': 0.9190476, 'binary_specificity': 0.7050691, 'binary_f1_score': 0.82655245}
confusion matrix:
     0    1
0  459  192
1   51  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200837, 'precision': 0.82553804, 'recall': 0.82389104, 'specificity': 0.82389104, 'f1': 0.8200333, 'auroc': 0.8968643, 'binary_precision': 0.8847926, 'binary_recall': 0.75889325, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.81702125}
confusion matrix:
     0    1
0  200   25
1   61  192
early stop counter: 1
val acc:0.8103044629096985, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8284518718719482 / 0.874476969242096
after epoch: 7,now: 2024-07-11 20:57:35.585454,epoch time: 0:10:46.999303,used: 1:15:13.015989,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99122244, 'precision': 0.9840963, 'recall': 0.9195963, 'specificity': 0.9195963, 'f1': 0.94929147, 'auroc': 0.998371, 'binary_precision': 0.9918748, 'binary_recall': 0.998956, 'binary_specificity': 0.84023666, 'binary_f1_score': 0.99540275}
confusion matrix:
      0      1
0  1278    243
1    31  29664
---- Validation: 
scalar performance:
{'acc': 0.76346606, 'precision': 0.8206903, 'recall': 0.7668971, 'specificity': 0.7668971, 'f1': 0.75394386, 'auroc': 0.94531, 'binary_precision': 0.6810631, 'binary_recall': 0.97619045, 'binary_specificity': 0.55760366, 'binary_f1_score': 0.8023484}
confusion matrix:
     0    1
0  363  288
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75313807, 'precision': 0.7858341, 'recall': 0.7424506, 'specificity': 0.7424506, 'f1': 0.7398579, 'auroc': 0.9226701, 'binary_precision': 0.7027027, 'binary_recall': 0.9249012, 'binary_specificity': 0.56, 'binary_f1_score': 0.79863477}
confusion matrix:
     0    1
0  126   99
1   19  234
early stop counter: 2
val acc:0.7634660601615906, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8284518718719482 / 0.874476969242096
after epoch: 8,now: 2024-07-11 21:08:20.973114,epoch time: 0:10:45.387660,used: 1:25:58.403649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9933047, 'precision': 0.95831907, 'recall': 0.97059375, 'specificity': 0.97059375, 'f1': 0.9643656, 'auroc': 0.9987267, 'binary_precision': 0.99720085, 'binary_recall': 0.99575686, 'binary_specificity': 0.94543064, 'binary_f1_score': 0.9964783}
confusion matrix:
      0      1
0  1438     83
1   126  29569
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.85377324, 'recall': 0.84741426, 'specificity': 0.84741426, 'f1': 0.8456707, 'auroc': 0.92848366, 'binary_precision': 0.79779917, 'binary_recall': 0.9206349, 'binary_specificity': 0.7741935, 'binary_f1_score': 0.8548268}
confusion matrix:
     0    1
0  504  147
1   50  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577406, 'precision': 0.85735047, 'recall': 0.85848045, 'specificity': 0.85848045, 'f1': 0.8575385, 'auroc': 0.9306631, 'binary_precision': 0.88065845, 'binary_recall': 0.8458498, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8629032}
confusion matrix:
     0    1
0  196   29
1   39  214
early stop counter: 3
val acc:0.8462138772010803, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8284518718719482 / 0.874476969242096
after epoch: 9,now: 2024-07-11 21:19:06.597659,epoch time: 0:10:45.624545,used: 1:36:44.028194,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9948424, 'precision': 0.9731566, 'recall': 0.9710901, 'specificity': 0.9710901, 'f1': 0.9721208, 'auroc': 0.99920404, 'binary_precision': 0.9971719, 'binary_recall': 0.99740696, 'binary_specificity': 0.9447732, 'binary_f1_score': 0.9972894}
confusion matrix:
      0      1
0  1437     84
1    77  29618
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.8739593, 'recall': 0.871915, 'specificity': 0.871915, 'f1': 0.8710809, 'auroc': 0.9398849, 'binary_precision': 0.83744556, 'binary_recall': 0.915873, 'binary_specificity': 0.827957, 'binary_f1_score': 0.8749052}
confusion matrix:
     0    1
0  539  112
1   53  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.8533715, 'recall': 0.85130435, 'specificity': 0.85130435, 'f1': 0.84722614, 'auroc': 0.9296092, 'binary_precision': 0.9166667, 'binary_recall': 0.7826087, 'binary_specificity': 0.92, 'binary_f1_score': 0.8443497}
confusion matrix:
     0    1
0  207   18
1   55  198
better model found
persisted
after epoch: 10,now: 2024-07-11 21:29:51.534677,epoch time: 0:10:44.937018,used: 1:47:28.965212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9948424, 'precision': 0.9661356, 'recall': 0.9791993, 'specificity': 0.9791993, 'f1': 0.9725665, 'auroc': 0.9993632, 'binary_precision': 0.99804384, 'binary_recall': 0.9965314, 'binary_specificity': 0.9618672, 'binary_f1_score': 0.9972871}
confusion matrix:
      0      1
0  1463     58
1   103  29592
---- Validation: 
scalar performance:
{'acc': 0.8852459, 'precision': 0.8861244, 'recall': 0.8856631, 'specificity': 0.8856631, 'f1': 0.8852322, 'auroc': 0.94312537, 'binary_precision': 0.86315787, 'binary_recall': 0.9111111, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.8864865}
confusion matrix:
     0    1
0  560   91
1   56  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8389121, 'precision': 0.845759, 'recall': 0.84315324, 'specificity': 0.84315324, 'f1': 0.8388268, 'auroc': 0.9135529, 'binary_precision': 0.91121495, 'binary_recall': 0.770751, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8351178}
confusion matrix:
     0    1
0  206   19
1   58  195
better model found
persisted
after epoch: 11,now: 2024-07-11 21:40:36.149289,epoch time: 0:10:44.614612,used: 1:58:13.579824,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99525887, 'precision': 0.98755145, 'recall': 0.96070457, 'specificity': 0.96070457, 'f1': 0.97370505, 'auroc': 0.9994248, 'binary_precision': 0.996038, 'binary_recall': 0.9989897, 'binary_specificity': 0.9224195, 'binary_f1_score': 0.9975116}
confusion matrix:
      0      1
0  1403    118
1    30  29665
---- Validation: 
scalar performance:
{'acc': 0.82045275, 'precision': 0.8482249, 'recall': 0.82275987, 'specificity': 0.82275987, 'f1': 0.81749785, 'auroc': 0.94920635, 'binary_precision': 0.74570024, 'binary_recall': 0.96349204, 'binary_specificity': 0.68202764, 'binary_f1_score': 0.8407202}
confusion matrix:
     0    1
0  444  207
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80543935, 'precision': 0.8164538, 'recall': 0.79948175, 'specificity': 0.79948175, 'f1': 0.8010499, 'auroc': 0.91747034, 'binary_precision': 0.7702703, 'binary_recall': 0.90118575, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.83060104}
confusion matrix:
     0    1
0  157   68
1   25  228
early stop counter: 1
val acc:0.8204527497291565, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 12,now: 2024-07-11 21:51:19.613257,epoch time: 0:10:43.463968,used: 2:08:57.043792,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9948424, 'precision': 0.98755944, 'recall': 0.9561192, 'specificity': 0.9561192, 'f1': 0.9712566, 'auroc': 0.9996047, 'binary_precision': 0.9955702, 'binary_recall': 0.9990234, 'binary_specificity': 0.913215, 'binary_f1_score': 0.9972938}
confusion matrix:
      0      1
0  1389    132
1    29  29666
---- Validation: 
scalar performance:
{'acc': 0.7525371, 'precision': 0.8136612, 'recall': 0.7561188, 'specificity': 0.7561188, 'f1': 0.74156046, 'auroc': 0.9493923, 'binary_precision': 0.67103827, 'binary_recall': 0.9746032, 'binary_specificity': 0.53763443, 'binary_f1_score': 0.79482204}
confusion matrix:
     0    1
0  350  301
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76987445, 'precision': 0.7997246, 'recall': 0.75998247, 'specificity': 0.75998247, 'f1': 0.7588959, 'auroc': 0.91530955, 'binary_precision': 0.71865445, 'binary_recall': 0.92885375, 'binary_specificity': 0.5911111, 'binary_f1_score': 0.8103449}
confusion matrix:
     0    1
0  133   92
1   18  235
early stop counter: 2
val acc:0.7525370717048645, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 13,now: 2024-07-11 22:02:04.050055,epoch time: 0:10:44.436798,used: 2:19:41.480590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99211943, 'precision': 0.9401534, 'recall': 0.9805751, 'specificity': 0.9805751, 'f1': 0.9593658, 'auroc': 0.9991328, 'binary_precision': 0.9983416, 'binary_recall': 0.9933659, 'binary_specificity': 0.96778435, 'binary_f1_score': 0.9958475}
confusion matrix:
      0      1
0  1472     49
1   197  29498
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.8582194, 'recall': 0.8447772, 'specificity': 0.8447772, 'f1': 0.8418387, 'auroc': 0.94642186, 'binary_precision': 0.78039217, 'binary_recall': 0.947619, 'binary_specificity': 0.7419355, 'binary_f1_score': 0.855914}
confusion matrix:
     0    1
0  483  168
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85983264, 'precision': 0.8624983, 'recall': 0.8626702, 'specificity': 0.8626702, 'f1': 0.85983205, 'auroc': 0.9011155, 'binary_precision': 0.91150445, 'binary_recall': 0.81422925, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8601253}
confusion matrix:
     0    1
0  205   20
1   47  206
early stop counter: 3
val acc:0.8430913090705872, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 14,now: 2024-07-11 22:12:49.574850,epoch time: 0:10:45.524795,used: 2:30:27.005385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9918311, 'precision': 0.9481907, 'recall': 0.9657646, 'specificity': 0.9657646, 'f1': 0.95678806, 'auroc': 0.9977348, 'binary_precision': 0.99676025, 'binary_recall': 0.99464554, 'binary_specificity': 0.9368836, 'binary_f1_score': 0.9957018}
confusion matrix:
      0      1
0  1425     96
1   159  29536
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.8394861, 'recall': 0.8246032, 'specificity': 0.8246032, 'f1': 0.82111853, 'auroc': 0.922132, 'binary_precision': 0.76, 'binary_recall': 0.9349206, 'binary_specificity': 0.71428573, 'binary_f1_score': 0.83843416}
confusion matrix:
     0    1
0  465  186
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8200837, 'precision': 0.8195551, 'recall': 0.8192183, 'specificity': 0.8192183, 'f1': 0.8193722, 'auroc': 0.89501977, 'binary_precision': 0.827451, 'binary_recall': 0.8339921, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.8307087}
confusion matrix:
     0    1
0  181   44
1   42  211
early stop counter: 4
val acc:0.8227946758270264, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 15,now: 2024-07-11 22:23:35.361800,epoch time: 0:10:45.786950,used: 2:41:12.792335,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9939774, 'precision': 0.9525026, 'recall': 0.98623013, 'specificity': 0.98623013, 'f1': 0.968686, 'auroc': 0.9994506, 'binary_precision': 0.9988504, 'binary_recall': 0.9948139, 'binary_specificity': 0.9776463, 'binary_f1_score': 0.9968281}
confusion matrix:
      0      1
0  1487     34
1   154  29541
---- Validation: 
scalar performance:
{'acc': 0.86885244, 'precision': 0.8698863, 'recall': 0.8693036, 'specificity': 0.8693036, 'f1': 0.86882937, 'auroc': 0.9238534, 'binary_precision': 0.8458084, 'binary_recall': 0.8968254, 'binary_specificity': 0.84178185, 'binary_f1_score': 0.87057006}
confusion matrix:
     0    1
0  548  103
1   65  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82217574, 'precision': 0.8347324, 'recall': 0.82783484, 'specificity': 0.82783484, 'f1': 0.82176304, 'auroc': 0.8900659, 'binary_precision': 0.9158416, 'binary_recall': 0.7312253, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8131869}
confusion matrix:
     0    1
0  208   17
1   68  185
early stop counter: 5
val acc:0.868852436542511, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 16,now: 2024-07-11 22:34:21.795554,epoch time: 0:10:46.433754,used: 2:51:59.226089,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9946822, 'precision': 0.9729885, 'recall': 0.9694464, 'specificity': 0.9694464, 'f1': 0.97121, 'auroc': 0.99899125, 'binary_precision': 0.9970041, 'binary_recall': 0.99740696, 'binary_specificity': 0.9414859, 'binary_f1_score': 0.9972055}
confusion matrix:
      0      1
0  1432     89
1    77  29618
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.85187167, 'recall': 0.8465438, 'specificity': 0.8465438, 'f1': 0.84498346, 'auroc': 0.91766274, 'binary_precision': 0.8, 'binary_recall': 0.9142857, 'binary_specificity': 0.77880186, 'binary_f1_score': 0.8533333}
confusion matrix:
     0    1
0  507  144
1   54  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83472806, 'precision': 0.8415286, 'recall': 0.8389548, 'specificity': 0.8389548, 'f1': 0.83464044, 'auroc': 0.9088274, 'binary_precision': 0.90654206, 'binary_recall': 0.76679844, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8308351}
confusion matrix:
     0    1
0  205   20
1   59  194
early stop counter: 6
val acc:0.845433235168457, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 17,now: 2024-07-11 22:45:07.253182,epoch time: 0:10:45.457628,used: 3:02:44.683717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9941056, 'precision': 0.97380877, 'recall': 0.9619698, 'specificity': 0.9619698, 'f1': 0.9678057, 'auroc': 0.9991812, 'binary_precision': 0.9962334, 'binary_recall': 0.99757534, 'binary_specificity': 0.92636424, 'binary_f1_score': 0.9969039}
confusion matrix:
      0      1
0  1409    112
1    72  29623
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.8454198, 'recall': 0.8248848, 'specificity': 0.8248848, 'f1': 0.8204626, 'auroc': 0.94071877, 'binary_precision': 0.7528231, 'binary_recall': 0.95238096, 'binary_specificity': 0.69738865, 'binary_f1_score': 0.84092504}
confusion matrix:
     0    1
0  454  197
1   30  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77615064, 'precision': 0.7976051, 'recall': 0.76763284, 'specificity': 0.76763284, 'f1': 0.7677325, 'auroc': 0.8899078, 'binary_precision': 0.73101264, 'binary_recall': 0.9130435, 'binary_specificity': 0.62222224, 'binary_f1_score': 0.8119508}
confusion matrix:
     0    1
0  140   85
1   22  231
early stop counter: 7
val acc:0.8227946758270264, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 18,now: 2024-07-11 22:55:52.381568,epoch time: 0:10:45.128386,used: 3:13:29.812103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99657226, 'precision': 0.9863899, 'recall': 0.9763658, 'specificity': 0.9763658, 'f1': 0.98131967, 'auroc': 0.9996954, 'binary_precision': 0.9976453, 'binary_recall': 0.998754, 'binary_specificity': 0.95397764, 'binary_f1_score': 0.99819934}
confusion matrix:
      0      1
0  1451     70
1    37  29658
---- Validation: 
scalar performance:
{'acc': 0.7509758, 'precision': 0.81607974, 'recall': 0.7546595, 'specificity': 0.7546595, 'f1': 0.73921824, 'auroc': 0.9497647, 'binary_precision': 0.66847235, 'binary_recall': 0.97936505, 'binary_specificity': 0.5299539, 'binary_f1_score': 0.79459107}
confusion matrix:
     0    1
0  345  306
1   13  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7447699, 'precision': 0.78853655, 'recall': 0.7325779, 'specificity': 0.7325779, 'f1': 0.72760224, 'auroc': 0.92771184, 'binary_precision': 0.6898551, 'binary_recall': 0.94071144, 'binary_specificity': 0.52444446, 'binary_f1_score': 0.7959866}
confusion matrix:
     0    1
0  118  107
1   15  238
early stop counter: 8
val acc:0.7509757876396179, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.874476969242096
after epoch: 19,now: 2024-07-11 23:06:37.979785,epoch time: 0:10:45.598217,used: 3:24:15.410320,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9964441, 'precision': 0.98357296, 'recall': 0.9778298, 'specificity': 0.9778298, 'f1': 0.98068225, 'auroc': 0.9995568, 'binary_precision': 0.9978126, 'binary_recall': 0.998451, 'binary_specificity': 0.9572087, 'binary_f1_score': 0.9981317}
confusion matrix:
      0      1
0  1454     65
1    46  29651
---- Validation: 
scalar performance:
{'acc': 0.8665105, 'precision': 0.876287, 'recall': 0.86784434, 'specificity': 0.86784434, 'f1': 0.8659062, 'auroc': 0.95136905, 'binary_precision': 0.81139755, 'binary_recall': 0.94920635, 'binary_specificity': 0.78648233, 'binary_f1_score': 0.8749085}
confusion matrix:
     0    1
0  512  139
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88075316, 'precision': 0.8802215, 'recall': 0.88120335, 'specificity': 0.88120335, 'f1': 0.8805225, 'auroc': 0.933105, 'binary_precision': 0.89837396, 'binary_recall': 0.8735178, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8857715}
confusion matrix:
     0    1
0  200   25
1   32  221
new oracle model saved
early stop counter: 9
val acc:0.8665105104446411, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8389121294021606 / 0.8807531595230103
after epoch: 20,now: 2024-07-11 23:17:22.994968,epoch time: 0:10:45.015183,used: 3:35:00.425503,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9953229, 'precision': 0.960674, 'recall': 0.99161166, 'specificity': 0.99161166, 'f1': 0.97557926, 'auroc': 0.9997177, 'binary_precision': 0.9993578, 'binary_recall': 0.9957233, 'binary_specificity': 0.9875, 'binary_f1_score': 0.9975372}
confusion matrix:
      0      1
0  1501     19
1   127  29569
---- Validation: 
scalar performance:
{'acc': 0.8899298, 'precision': 0.89081514, 'recall': 0.8903482, 'specificity': 0.8903482, 'f1': 0.8899166, 'auroc': 0.9464536, 'binary_precision': 0.86766917, 'binary_recall': 0.915873, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.89111966}
confusion matrix:
     0    1
0  563   88
1   53  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86820084, 'precision': 0.86897504, 'recall': 0.87008345, 'specificity': 0.87008345, 'f1': 0.8681541, 'auroc': 0.9110584, 'binary_precision': 0.9059829, 'binary_recall': 0.8379447, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8706366}
confusion matrix:
     0    1
0  203   22
1   41  212
better model found
persisted
after epoch: 21,now: 2024-07-11 23:28:08.619226,epoch time: 0:10:45.624258,used: 3:45:46.049761,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9966684, 'precision': 0.98002374, 'recall': 0.9842137, 'specificity': 0.9842137, 'f1': 0.9821086, 'auroc': 0.9996985, 'binary_precision': 0.9984839, 'binary_recall': 0.99801314, 'binary_specificity': 0.9704142, 'binary_f1_score': 0.9982485}
confusion matrix:
      0      1
0  1476     45
1    59  29636
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.8658327, 'recall': 0.8605735, 'specificity': 0.8605735, 'f1': 0.8590994, 'auroc': 0.93729544, 'binary_precision': 0.81337047, 'binary_recall': 0.92698413, 'binary_specificity': 0.7941628, 'binary_f1_score': 0.8664689}
confusion matrix:
     0    1
0  517  134
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472803, 'precision': 0.8468082, 'recall': 0.8466315, 'specificity': 0.8466315, 'f1': 0.84671617, 'auroc': 0.9035573, 'binary_precision': 0.8543307, 'binary_recall': 0.8577075, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.85601574}
confusion matrix:
     0    1
0  188   37
1   36  217
early stop counter: 1
val acc:0.8594847917556763, best validation acc: 0.8899297714233398, corresponding to test acc:                         0.8682008385658264 / 0.8807531595230103
after epoch: 22,now: 2024-07-11 23:38:55.710780,epoch time: 0:10:47.091554,used: 3:56:33.141315,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9966684, 'precision': 0.97476804, 'recall': 0.9901396, 'specificity': 0.9901396, 'f1': 0.982317, 'auroc': 0.9996455, 'binary_precision': 0.9991229, 'binary_recall': 0.9973733, 'binary_specificity': 0.982906, 'binary_f1_score': 0.9982473}
confusion matrix:
      0      1
0  1495     26
1    78  29617
---- Validation: 
scalar performance:
{'acc': 0.9008587, 'precision': 0.902157, 'recall': 0.90040964, 'specificity': 0.90040964, 'f1': 0.9006823, 'auroc': 0.9466047, 'binary_precision': 0.92127305, 'binary_recall': 0.8730159, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8964956}
confusion matrix:
     0    1
0  604   47
1   80  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87656903, 'precision': 0.8820925, 'recall': 0.880448, 'specificity': 0.880448, 'f1': 0.87654257, 'auroc': 0.9245323, 'binary_precision': 0.94495416, 'binary_recall': 0.81422925, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8747346}
confusion matrix:
     0    1
0  213   12
1   47  206
better model found
persisted
after epoch: 23,now: 2024-07-11 23:49:40.719690,epoch time: 0:10:45.008910,used: 4:07:18.150225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99567527, 'precision': 0.9888115, 'recall': 0.9640424, 'specificity': 0.9640424, 'f1': 0.9760687, 'auroc': 0.99970496, 'binary_precision': 0.99637294, 'binary_recall': 0.99909073, 'binary_specificity': 0.92899406, 'binary_f1_score': 0.99773}
confusion matrix:
      0      1
0  1413    108
1    27  29668
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.8677874, 'recall': 0.8511777, 'specificity': 0.8511777, 'f1': 0.8478645, 'auroc': 0.9529661, 'binary_precision': 0.78120977, 'binary_recall': 0.96349204, 'binary_specificity': 0.7388633, 'binary_f1_score': 0.8628286}
confusion matrix:
     0    1
0  481  170
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.85519445, 'recall': 0.84541065, 'specificity': 0.84541065, 'f1': 0.8472762, 'auroc': 0.9423803, 'binary_precision': 0.82206404, 'binary_recall': 0.9130435, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8651686}
confusion matrix:
     0    1
0  175   50
1   22  231
early stop counter: 1
val acc:0.8493364453315735, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.8765690326690674 / 0.8807531595230103
after epoch: 24,now: 2024-07-12 00:00:26.278879,epoch time: 0:10:45.559189,used: 4:18:03.709414,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9969887, 'precision': 0.9825982, 'recall': 0.98500586, 'specificity': 0.98500586, 'f1': 0.98379874, 'auroc': 0.9997772, 'binary_precision': 0.99855155, 'binary_recall': 0.99828255, 'binary_specificity': 0.9717291, 'binary_f1_score': 0.9984171}
confusion matrix:
      0      1
0  1478     43
1    51  29644
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.8781987, 'recall': 0.8723246, 'specificity': 0.8723246, 'f1': 0.8708086, 'auroc': 0.94888693, 'binary_precision': 0.8224688, 'binary_recall': 0.9412698, 'binary_specificity': 0.8033794, 'binary_f1_score': 0.8778683}
confusion matrix:
     0    1
0  523  128
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8640167, 'precision': 0.86457455, 'recall': 0.8624418, 'specificity': 0.8624418, 'f1': 0.8631971, 'auroc': 0.9367062, 'binary_precision': 0.85877866, 'binary_recall': 0.88932806, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.8737864}
confusion matrix:
     0    1
0  188   37
1   28  225
early stop counter: 2
val acc:0.8711943626403809, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.8765690326690674 / 0.8807531595230103
after epoch: 25,now: 2024-07-12 00:11:10.602055,epoch time: 0:10:44.323176,used: 4:28:48.032590,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9966684, 'precision': 0.9772235, 'recall': 0.9873326, 'specificity': 0.9873326, 'f1': 0.98221886, 'auroc': 0.9997573, 'binary_precision': 0.99882, 'binary_recall': 0.9976764, 'binary_specificity': 0.97698885, 'binary_f1_score': 0.99824786}
confusion matrix:
      0      1
0  1486     35
1    69  29626
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.88610566, 'recall': 0.885023, 'specificity': 0.885023, 'f1': 0.8844212, 'auroc': 0.9449833, 'binary_precision': 0.85650885, 'binary_recall': 0.9190476, 'binary_specificity': 0.85099846, 'binary_f1_score': 0.88667685}
confusion matrix:
     0    1
0  554   97
1   51  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8933054, 'precision': 0.8931898, 'recall': 0.8945367, 'specificity': 0.8945367, 'f1': 0.8932003, 'auroc': 0.9336144, 'binary_precision': 0.92083335, 'binary_recall': 0.8735178, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8965518}
confusion matrix:
     0    1
0  206   19
1   32  221
new oracle model saved
early stop counter: 3
val acc:0.8844652771949768, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.8765690326690674 / 0.8933054208755493
after epoch: 26,now: 2024-07-12 00:21:55.068824,epoch time: 0:10:44.466769,used: 4:39:32.499359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99593157, 'precision': 0.9831599, 'recall': 0.97259825, 'specificity': 0.97259825, 'f1': 0.9778141, 'auroc': 0.9994807, 'binary_precision': 0.9972755, 'binary_recall': 0.99845093, 'binary_specificity': 0.9467456, 'binary_f1_score': 0.9978629}
confusion matrix:
      0      1
0  1440     81
1    46  29649
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.8695774, 'recall': 0.8557092, 'specificity': 0.8557092, 'f1': 0.85285497, 'auroc': 0.9538933, 'binary_precision': 0.7895425, 'binary_recall': 0.95873016, 'binary_specificity': 0.75268817, 'binary_f1_score': 0.8659498}
confusion matrix:
     0    1
0  490  161
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81380755, 'precision': 0.82647276, 'recall': 0.80763286, 'specificity': 0.80763286, 'f1': 0.8093612, 'auroc': 0.93259555, 'binary_precision': 0.77516776, 'binary_recall': 0.9130435, 'binary_specificity': 0.7022222, 'binary_f1_score': 0.8384755}
confusion matrix:
     0    1
0  158   67
1   22  231
early stop counter: 4
val acc:0.8540202975273132, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.8765690326690674 / 0.8933054208755493
after epoch: 27,now: 2024-07-12 00:32:40.410205,epoch time: 0:10:45.341381,used: 4:50:17.840740,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99269605, 'precision': 0.99112177, 'recall': 0.9294158, 'specificity': 0.9294158, 'f1': 0.9579744, 'auroc': 0.99967754, 'binary_precision': 0.9928416, 'binary_recall': 0.9995285, 'binary_specificity': 0.8593031, 'binary_f1_score': 0.99617386}
confusion matrix:
      0      1
0  1307    214
1    14  29681
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.83500946, 'recall': 0.7975166, 'specificity': 0.7975166, 'f1': 0.7893494, 'auroc': 0.9473655, 'binary_precision': 0.7146199, 'binary_recall': 0.96984124, 'binary_specificity': 0.625192, 'binary_f1_score': 0.82289565}
confusion matrix:
     0    1
0  407  244
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263598, 'precision': 0.83863604, 'recall': 0.8204743, 'specificity': 0.8204743, 'f1': 0.8224424, 'auroc': 0.9414844, 'binary_precision': 0.7871622, 'binary_recall': 0.9209486, 'binary_specificity': 0.72, 'binary_f1_score': 0.84881604}
confusion matrix:
     0    1
0  162   63
1   20  233
early stop counter: 5
val acc:0.7946916222572327, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.8765690326690674 / 0.8933054208755493
after epoch: 28,now: 2024-07-12 00:43:25.435824,epoch time: 0:10:45.025619,used: 5:01:02.866359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9906458, 'precision': 0.99243, 'recall': 0.90619373, 'specificity': 0.90619373, 'f1': 0.9447311, 'auroc': 0.999297, 'binary_precision': 0.99049145, 'binary_recall': 0.99976426, 'binary_specificity': 0.81262326, 'binary_f1_score': 0.9951063}
confusion matrix:
      0      1
0  1236    285
1     7  29688
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.8480809, 'recall': 0.8235023, 'specificity': 0.8235023, 'f1': 0.8184003, 'auroc': 0.9402214, 'binary_precision': 0.74722564, 'binary_recall': 0.96190476, 'binary_specificity': 0.68509984, 'binary_f1_score': 0.8410826}
confusion matrix:
     0    1
0  446  205
1   24  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8493724, 'precision': 0.8499602, 'recall': 0.84762406, 'specificity': 0.84762406, 'f1': 0.84841436, 'auroc': 0.91715413, 'binary_precision': 0.84410644, 'binary_recall': 0.8774704, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.8604651}
confusion matrix:
     0    1
0  184   41
1   31  222
early stop counter: 6
val acc:0.8212333917617798, best validation acc: 0.9008587002754211, corresponding to test acc:                         0.8765690326690674 / 0.8933054208755493
after epoch: 29,now: 2024-07-12 00:54:09.600712,epoch time: 0:10:44.164888,used: 5:11:47.031247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9942017, 'precision': 0.9494393, 'recall': 0.9932096, 'specificity': 0.9932096, 'f1': 0.97018206, 'auroc': 0.9997077, 'binary_precision': 0.99959373, 'binary_recall': 0.9943088, 'binary_specificity': 0.99211043, 'binary_f1_score': 0.9969443}
confusion matrix:
      0      1
0  1509     12
1   169  29526
---- Validation: 
scalar performance:
{'acc': 0.913349, 'precision': 0.9141669, 'recall': 0.91300565, 'specificity': 0.91300565, 'f1': 0.9132371, 'auroc': 0.9547729, 'binary_precision': 0.92892563, 'binary_recall': 0.8920635, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.9101215}
confusion matrix:
     0    1
0  608   43
1   68  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88912135, 'precision': 0.8975032, 'recall': 0.8937813, 'specificity': 0.8937813, 'f1': 0.8890393, 'auroc': 0.9325604, 'binary_precision': 0.9716981, 'binary_recall': 0.81422925, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.88602155}
confusion matrix:
     0    1
0  219    6
1   47  206
better model found
persisted
after epoch: 30,now: 2024-07-12 01:04:53.286248,epoch time: 0:10:43.685536,used: 5:22:30.716783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_11_19_42_22_seed_1_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:22:30.716783 at 2024-07-12 01:04:53.286248
persisted model performance metric: 

scalar performance:
{'acc': 0.88912135, 'precision': 0.8975032, 'recall': 0.8937813, 'specificity': 0.8937813, 'f1': 0.8890393, 'auroc': 0.9325604, 'binary_precision': 0.9716981, 'binary_recall': 0.81422925, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.88602155}
confusion matrix:
     0    1
0  219    6
1   47  206
oracle model performance metric: 

scalar performance:
{'acc': 0.8933054, 'precision': 0.8931898, 'recall': 0.8945367, 'specificity': 0.8945367, 'f1': 0.8932003, 'auroc': 0.9336144, 'binary_precision': 0.92083335, 'binary_recall': 0.8735178, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8965518}
confusion matrix:
     0    1
0  206   19
1   32  221
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |  40601 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB | 714768 GiB | 714767 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |  40408 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  28072 MiB |  13598 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     66 MiB |     66 MiB |     80 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1252 MiB | 540838 GiB | 540837 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 531178 GiB | 531178 GiB |
|       from small pool |  12646 KiB |     46 MiB |   9659 GiB |   9659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4907    |  135898 K  |  135896 K  |
|       from large pool |     187    |    1413    |   64884 K  |   64883 K  |
|       from small pool |    1129    |    4718    |   71013 K  |   71012 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4907    |  135898 K  |  135896 K  |
|       from large pool |     187    |    1413    |   64884 K  |   64883 K  |
|       from small pool |    1129    |    4718    |   71013 K  |   71012 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1205    |     571    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      33    |      33    |      40    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |    2023    |   81409 K  |   81409 K  |
|       from large pool |      40    |     604    |   46075 K  |   46075 K  |
|       from small pool |      62    |    1981    |   35333 K  |   35333 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |      0 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 540838 GiB | 540838 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531179 GiB | 531179 GiB |
|       from small pool |      0 KiB |     46 MiB |   9659 GiB |   9659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2023    |   81409 K  |   81409 K  |
|       from large pool |       4    |     604    |   46075 K  |   46075 K  |
|       from small pool |       0    |    1981    |   35334 K  |   35334 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 718207 GiB | 718207 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 708578 GiB | 708578 GiB |
|       from small pool |      0 KiB |     56 MiB |   9629 GiB |   9629 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 714768 GiB | 714768 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 705160 GiB | 705160 GiB |
|       from small pool |      0 KiB |     56 MiB |   9607 GiB |   9607 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  28072 MiB |  27190 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     52 MiB |     66 MiB |     80 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 540838 GiB | 540838 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 531179 GiB | 531179 GiB |
|       from small pool |      0 KiB |     46 MiB |   9659 GiB |   9659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4907    |  135898 K  |  135898 K  |
|       from large pool |       2    |    1413    |   64884 K  |   64884 K  |
|       from small pool |       0    |    4718    |   71013 K  |   71013 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1205    |    1142    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      26    |      33    |      40    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2023    |   81409 K  |   81409 K  |
|       from large pool |       4    |     604    |   46075 K  |   46075 K  |
|       from small pool |       0    |    1981    |   35334 K  |   35334 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153

 Experiment start at: 2024-07-12 01:18:37.675929
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9851479, 'precision': 0.90072995, 'recall': 0.95055854, 'specificity': 0.95055854, 'f1': 0.92399377, 'auroc': 0.9955735, 'binary_precision': 0.9955158, 'binary_recall': 0.988848, 'binary_specificity': 0.9122691, 'binary_f1_score': 0.9921707}
confusion matrix:
      0      1
0  1383    133
1   333  29527
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.78759074, 'recall': 0.77172375, 'specificity': 0.77172375, 'f1': 0.76581347, 'auroc': 0.8469875, 'binary_precision': 0.7063291, 'binary_recall': 0.8971061, 'binary_specificity': 0.64634144, 'binary_f1_score': 0.79036826}
confusion matrix:
     0    1
0  424  232
1   64  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74526316, 'precision': 0.7539084, 'recall': 0.75257397, 'specificity': 0.75257397, 'f1': 0.7452225, 'auroc': 0.82575434, 'binary_precision': 0.82857144, 'binary_recall': 0.6718147, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.7420043}
confusion matrix:
     0    1
0  180   36
1   85  174
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 01:29:26.567839,epoch time: 0:10:48.891910,used: 0:10:48.891910,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9778812, 'precision': 0.97952557, 'recall': 0.7761173, 'specificity': 0.7761173, 'f1': 0.8478398, 'auroc': 0.9949161, 'binary_precision': 0.97778654, 'binary_recall': 0.99946415, 'binary_specificity': 0.55277044, 'binary_f1_score': 0.98850656}
confusion matrix:
     0      1
0  838    678
1   16  29844
---- Validation: 
scalar performance:
{'acc': 0.514867, 'precision': 0.75040257, 'recall': 0.527439, 'specificity': 0.527439, 'f1': 0.38571408, 'auroc': 0.9052378, 'binary_precision': 0.50080514, 'binary_recall': 1.0, 'binary_specificity': 0.05487805, 'binary_f1_score': 0.66738194}
confusion matrix:
    0    1
0  36  620
1   0  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55157894, 'precision': 0.6744681, 'recall': 0.50732875, 'specificity': 0.50732875, 'f1': 0.37200904, 'auroc': 0.8758223, 'binary_precision': 0.5489362, 'binary_recall': 0.996139, 'binary_specificity': 0.018518519, 'binary_f1_score': 0.707819}
confusion matrix:
   0    1
0  4  212
1  1  258
early stop counter: 1
val acc:0.5148670077323914, best validation acc: 0.7683880925178528, corresponding to test acc:                         0.7452631592750549 / 0.7452631592750549
after epoch: 2,now: 2024-07-12 01:40:10.127411,epoch time: 0:10:43.559572,used: 0:21:32.451482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9898649, 'precision': 0.92936015, 'recall': 0.9668119, 'specificity': 0.9668119, 'f1': 0.9472052, 'auroc': 0.99833417, 'binary_precision': 0.9970054, 'binary_recall': 0.99233085, 'binary_specificity': 0.9412929, 'binary_f1_score': 0.99466264}
confusion matrix:
      0      1
0  1427     89
1   229  29631
---- Validation: 
scalar performance:
{'acc': 0.7175274, 'precision': 0.7859128, 'recall': 0.72388935, 'specificity': 0.72388935, 'f1': 0.7031776, 'auroc': 0.91066146, 'binary_precision': 0.6392743, 'binary_recall': 0.96302253, 'binary_specificity': 0.4847561, 'binary_f1_score': 0.7684414}
confusion matrix:
     0    1
0  318  338
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6463158, 'precision': 0.7010413, 'recall': 0.61802876, 'specificity': 0.61802876, 'f1': 0.59076923, 'auroc': 0.84189546, 'binary_precision': 0.6163683, 'binary_recall': 0.93050194, 'binary_specificity': 0.30555555, 'binary_f1_score': 0.74153847}
confusion matrix:
    0    1
0  66  150
1  18  241
early stop counter: 2
val acc:0.7175273895263672, best validation acc: 0.7683880925178528, corresponding to test acc:                         0.7452631592750549 / 0.7452631592750549
after epoch: 3,now: 2024-07-12 01:50:55.093527,epoch time: 0:10:44.966116,used: 0:32:17.417598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9911716, 'precision': 0.9733577, 'recall': 0.92836463, 'specificity': 0.92836463, 'f1': 0.9496131, 'auroc': 0.99814296, 'binary_precision': 0.99286926, 'binary_recall': 0.9978902, 'binary_specificity': 0.85883904, 'binary_f1_score': 0.99537337}
confusion matrix:
      0      1
0  1302    214
1    63  29797
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8166535, 'recall': 0.8150145, 'specificity': 0.8150145, 'f1': 0.81365466, 'auroc': 0.89160407, 'binary_precision': 0.7790698, 'binary_recall': 0.86173636, 'binary_specificity': 0.76829267, 'binary_f1_score': 0.8183206}
confusion matrix:
     0    1
0  504  152
1   86  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7768421, 'precision': 0.78843725, 'recall': 0.78537464, 'specificity': 0.78537464, 'f1': 0.7767224, 'auroc': 0.86731374, 'binary_precision': 0.87317073, 'binary_recall': 0.6911197, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.7715517}
confusion matrix:
     0    1
0  190   26
1   80  179
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 02:01:41.907081,epoch time: 0:10:46.813554,used: 0:43:04.231152,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9894824, 'precision': 0.98670244, 'recall': 0.8974224, 'specificity': 0.8974224, 'f1': 0.9370755, 'auroc': 0.9990299, 'binary_precision': 0.9897181, 'binary_recall': 0.9993302, 'binary_specificity': 0.7955145, 'binary_f1_score': 0.994501}
confusion matrix:
      0      1
0  1206    310
1    20  29840
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.81066805, 'recall': 0.7776302, 'specificity': 0.7776302, 'f1': 0.767843, 'auroc': 0.9218707, 'binary_precision': 0.6957547, 'binary_recall': 0.948553, 'binary_specificity': 0.60670733, 'binary_f1_score': 0.802721}
confusion matrix:
     0    1
0  398  258
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78105265, 'precision': 0.7896571, 'recall': 0.77117294, 'specificity': 0.77117294, 'f1': 0.77380943, 'auroc': 0.8954669, 'binary_precision': 0.7574751, 'binary_recall': 0.88030887, 'binary_specificity': 0.662037, 'binary_f1_score': 0.81428564}
confusion matrix:
     0    1
0  143   73
1   31  228
new oracle model saved
early stop counter: 1
val acc:0.773082971572876, best validation acc: 0.8137715458869934, corresponding to test acc:                         0.7768421173095703 / 0.7810526490211487
after epoch: 5,now: 2024-07-12 02:12:28.958366,epoch time: 0:10:47.051285,used: 0:53:51.282437,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9941675, 'precision': 0.97581303, 'recall': 0.95999336, 'specificity': 0.95999336, 'f1': 0.96775424, 'auroc': 0.9990257, 'binary_precision': 0.99605525, 'binary_recall': 0.9978232, 'binary_specificity': 0.9221636, 'binary_f1_score': 0.99693847}
confusion matrix:
      0      1
0  1398    118
1    65  29795
---- Validation: 
scalar performance:
{'acc': 0.7543036, 'precision': 0.80782545, 'recall': 0.7597542, 'specificity': 0.7597542, 'f1': 0.74562943, 'auroc': 0.9243516, 'binary_precision': 0.67264575, 'binary_recall': 0.96463025, 'binary_specificity': 0.55487806, 'binary_f1_score': 0.7926024}
confusion matrix:
     0    1
0  364  292
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81473684, 'precision': 0.8311206, 'recall': 0.8035983, 'specificity': 0.8035983, 'f1': 0.80735195, 'auroc': 0.9338803, 'binary_precision': 0.776699, 'binary_recall': 0.9266409, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.8450704}
confusion matrix:
     0    1
0  147   69
1   19  240
new oracle model saved
early stop counter: 2
val acc:0.7543035745620728, best validation acc: 0.8137715458869934, corresponding to test acc:                         0.7768421173095703 / 0.8147368431091309
after epoch: 6,now: 2024-07-12 02:23:14.355940,epoch time: 0:10:45.397574,used: 1:04:36.680011,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9875382, 'precision': 0.9630573, 'recall': 0.896714, 'specificity': 0.896714, 'f1': 0.9270418, 'auroc': 0.9975656, 'binary_precision': 0.98972976, 'binary_recall': 0.99725384, 'binary_specificity': 0.79617417, 'binary_f1_score': 0.9934776}
confusion matrix:
      0      1
0  1207    309
1    82  29778
---- Validation: 
scalar performance:
{'acc': 0.7308294, 'precision': 0.79448074, 'recall': 0.7368883, 'specificity': 0.7368883, 'f1': 0.71864057, 'auroc': 0.9015126, 'binary_precision': 0.6507592, 'binary_recall': 0.96463025, 'binary_specificity': 0.50914633, 'binary_f1_score': 0.7772021}
confusion matrix:
     0    1
0  334  322
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8384877, 'recall': 0.8398309, 'specificity': 0.8398309, 'f1': 0.83902323, 'auroc': 0.91823965, 'binary_precision': 0.86166006, 'binary_recall': 0.8416988, 'binary_specificity': 0.837963, 'binary_f1_score': 0.8515625}
confusion matrix:
     0    1
0  181   35
1   41  218
new oracle model saved
early stop counter: 3
val acc:0.7308294177055359, best validation acc: 0.8137715458869934, corresponding to test acc:                         0.7768421173095703 / 0.8399999737739563
after epoch: 7,now: 2024-07-12 02:34:02.787894,epoch time: 0:10:48.431954,used: 1:15:25.111965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9912035, 'precision': 0.9277222, 'recall': 0.9872386, 'specificity': 0.9872386, 'f1': 0.9552972, 'auroc': 0.99920404, 'binary_precision': 0.9991227, 'binary_recall': 0.9916276, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.995361}
confusion matrix:
      0      1
0  1490     26
1   250  29610
---- Validation: 
scalar performance:
{'acc': 0.8716745, 'precision': 0.87258554, 'recall': 0.8710003, 'specificity': 0.8710003, 'f1': 0.87137175, 'auroc': 0.9284688, 'binary_precision': 0.8855219, 'binary_recall': 0.84565914, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.86513156}
confusion matrix:
     0    1
0  588   68
1   96  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81473684, 'precision': 0.8450314, 'recall': 0.82819426, 'specificity': 0.82819426, 'f1': 0.8137255, 'auroc': 0.91893685, 'binary_precision': 0.9723757, 'binary_recall': 0.6795367, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  211    5
1   83  176
better model found
persisted
after epoch: 8,now: 2024-07-12 02:44:50.598226,epoch time: 0:10:47.810332,used: 1:26:12.922297,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9909166, 'precision': 0.9249679, 'recall': 0.9880271, 'specificity': 0.9880271, 'f1': 0.9540396, 'auroc': 0.99929667, 'binary_precision': 0.99922353, 'binary_recall': 0.9912257, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.99520856}
confusion matrix:
      0      1
0  1493     23
1   262  29598
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.8550347, 'recall': 0.8518327, 'specificity': 0.8518327, 'f1': 0.8523165, 'auroc': 0.9230447, 'binary_precision': 0.8767361, 'binary_recall': 0.8118971, 'binary_specificity': 0.8917683, 'binary_f1_score': 0.8430718}
confusion matrix:
     0    1
0  585   71
1  117  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8189474, 'precision': 0.8350903, 'recall': 0.8289808, 'specificity': 0.8289808, 'f1': 0.81871516, 'auroc': 0.91024953, 'binary_precision': 0.93467337, 'binary_recall': 0.71814674, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.8122271}
confusion matrix:
     0    1
0  203   13
1   73  186
early stop counter: 1
val acc:0.8528951406478882, best validation acc: 0.8716744780540466, corresponding to test acc:                         0.8147368431091309 / 0.8399999737739563
after epoch: 9,now: 2024-07-12 02:55:36.118948,epoch time: 0:10:45.520722,used: 1:36:58.443019,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.994295, 'precision': 0.96071136, 'recall': 0.97884464, 'specificity': 0.97884464, 'f1': 0.9695822, 'auroc': 0.99918246, 'binary_precision': 0.9980535, 'binary_recall': 0.9959478, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9969995}
confusion matrix:
      0      1
0  1458     58
1   121  29739
---- Validation: 
scalar performance:
{'acc': 0.84663534, 'precision': 0.85368055, 'recall': 0.84473526, 'specificity': 0.84473526, 'f1': 0.8452712, 'auroc': 0.921391, 'binary_precision': 0.89738804, 'binary_recall': 0.7733119, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.83074266}
confusion matrix:
     0    1
0  601   55
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747368, 'precision': 0.83436537, 'recall': 0.7934363, 'specificity': 0.7934363, 'f1': 0.7705718, 'auroc': 0.946071, 'binary_precision': 1.0, 'binary_recall': 0.5868726, 'binary_specificity': 1.0, 'binary_f1_score': 0.73965937}
confusion matrix:
     0    1
0  216    0
1  107  152
early stop counter: 2
val acc:0.8466353416442871, best validation acc: 0.8716744780540466, corresponding to test acc:                         0.8147368431091309 / 0.8399999737739563
after epoch: 10,now: 2024-07-12 03:06:22.423263,epoch time: 0:10:46.304315,used: 1:47:44.747334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9858172, 'precision': 0.98867, 'recall': 0.8560498, 'specificity': 0.8560498, 'f1': 0.9108881, 'auroc': 0.9992715, 'binary_precision': 0.9856044, 'binary_recall': 0.9996986, 'binary_specificity': 0.71240103, 'binary_f1_score': 0.9926015}
confusion matrix:
      0      1
0  1080    436
1     9  29851
---- Validation: 
scalar performance:
{'acc': 0.7707355, 'precision': 0.8191861, 'recall': 0.77584356, 'specificity': 0.77584356, 'f1': 0.7637996, 'auroc': 0.93446594, 'binary_precision': 0.688, 'binary_recall': 0.9678457, 'binary_specificity': 0.58384144, 'binary_f1_score': 0.80427533}
confusion matrix:
     0    1
0  383  273
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84842104, 'precision': 0.8535088, 'recall': 0.8421725, 'specificity': 0.8421725, 'f1': 0.8451535, 'auroc': 0.9377949, 'binary_precision': 0.82807016, 'binary_recall': 0.9111969, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.867647}
confusion matrix:
     0    1
0  167   49
1   23  236
new oracle model saved
early stop counter: 3
val acc:0.770735502243042, best validation acc: 0.8716744780540466, corresponding to test acc:                         0.8147368431091309 / 0.848421037197113
after epoch: 11,now: 2024-07-12 03:17:10.122716,epoch time: 0:10:47.699453,used: 1:58:32.446787,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9966854, 'precision': 0.981111, 'recall': 0.98291814, 'specificity': 0.98291814, 'f1': 0.9820127, 'auroc': 0.99951553, 'binary_precision': 0.99835867, 'binary_recall': 0.9981581, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9982584}
confusion matrix:
      0      1
0  1467     49
1    55  29805
---- Validation: 
scalar performance:
{'acc': 0.81924886, 'precision': 0.84293526, 'recall': 0.8227247, 'specificity': 0.8227247, 'f1': 0.817085, 'auroc': 0.9370687, 'binary_precision': 0.74591196, 'binary_recall': 0.95337623, 'binary_specificity': 0.69207317, 'binary_f1_score': 0.83697957}
confusion matrix:
     0    1
0  454  202
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8842105, 'precision': 0.8852303, 'recall': 0.88114005, 'specificity': 0.88114005, 'f1': 0.8826944, 'auroc': 0.94841266, 'binary_precision': 0.87777776, 'binary_recall': 0.9150579, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8960302}
confusion matrix:
     0    1
0  183   33
1   22  237
new oracle model saved
early stop counter: 4
val acc:0.8192488551139832, best validation acc: 0.8716744780540466, corresponding to test acc:                         0.8147368431091309 / 0.8842105269432068
after epoch: 12,now: 2024-07-12 03:27:58.041210,epoch time: 0:10:47.918494,used: 2:09:20.365281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9937851, 'precision': 0.9763249, 'recall': 0.95509636, 'specificity': 0.95509636, 'f1': 0.9654412, 'auroc': 0.9991565, 'binary_precision': 0.9955565, 'binary_recall': 0.9979237, 'binary_specificity': 0.9122691, 'binary_f1_score': 0.9967387}
confusion matrix:
      0      1
0  1383    133
1    62  29798
---- Validation: 
scalar performance:
{'acc': 0.7738654, 'precision': 0.81041443, 'recall': 0.7783507, 'specificity': 0.7783507, 'f1': 0.7688091, 'auroc': 0.9188348, 'binary_precision': 0.6970414, 'binary_recall': 0.9469453, 'binary_specificity': 0.6097561, 'binary_f1_score': 0.80299926}
confusion matrix:
     0    1
0  400  256
1   33  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463158, 'precision': 0.8448356, 'recall': 0.84600675, 'specificity': 0.84600675, 'f1': 0.84532595, 'auroc': 0.92410266, 'binary_precision': 0.86614174, 'binary_recall': 0.84942085, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8576998}
confusion matrix:
     0    1
0  182   34
1   39  220
early stop counter: 5
val acc:0.7738654017448425, best validation acc: 0.8716744780540466, corresponding to test acc:                         0.8147368431091309 / 0.8842105269432068
after epoch: 13,now: 2024-07-12 03:38:45.699276,epoch time: 0:10:47.658066,used: 2:20:08.023347,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9938488, 'precision': 0.9656124, 'recall': 0.9676527, 'specificity': 0.9676527, 'f1': 0.9666301, 'auroc': 0.99889266, 'binary_precision': 0.99688476, 'binary_recall': 0.99665105, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.99676794}
confusion matrix:
      0      1
0  1423     93
1   100  29760
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.7946248, 'recall': 0.7796521, 'specificity': 0.7796521, 'f1': 0.7789203, 'auroc': 0.88525164, 'binary_precision': 0.84817815, 'binary_recall': 0.67363346, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.7508961}
confusion matrix:
     0    1
0  581   75
1  203  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6631579, 'precision': 0.75770056, 'recall': 0.6884295, 'specificity': 0.6884295, 'f1': 0.6465379, 'auroc': 0.88815606, 'binary_precision': 0.9380531, 'binary_recall': 0.4092664, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.56989247}
confusion matrix:
     0    1
0  209    7
1  153  106
early stop counter: 6
val acc:0.7824726104736328, best validation acc: 0.8716744780540466, corresponding to test acc:                         0.8147368431091309 / 0.8842105269432068
after epoch: 14,now: 2024-07-12 03:49:34.487199,epoch time: 0:10:48.787923,used: 2:30:56.811270,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9944225, 'precision': 0.98179567, 'recall': 0.9566835, 'specificity': 0.9566835, 'f1': 0.96886575, 'auroc': 0.9993603, 'binary_precision': 0.99569184, 'binary_recall': 0.99845946, 'binary_specificity': 0.91490763, 'binary_f1_score': 0.99707365}
confusion matrix:
      0      1
0  1387    129
1    46  29814
---- Validation: 
scalar performance:
{'acc': 0.8771518, 'precision': 0.8779384, 'recall': 0.8778356, 'specificity': 0.8778356, 'f1': 0.87715113, 'auroc': 0.9326303, 'binary_precision': 0.8528073, 'binary_recall': 0.903537, 'binary_specificity': 0.85213417, 'binary_f1_score': 0.8774395}
confusion matrix:
     0    1
0  559   97
1   60  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8589474, 'precision': 0.85752845, 'recall': 0.8587427, 'specificity': 0.8587427, 'f1': 0.8580388, 'auroc': 0.9295545, 'binary_precision': 0.87795275, 'binary_recall': 0.8610039, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.8693957}
confusion matrix:
     0    1
0  185   31
1   36  223
better model found
persisted
after epoch: 15,now: 2024-07-12 04:00:21.985252,epoch time: 0:10:47.498053,used: 2:41:44.309323,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9956655, 'precision': 0.9709175, 'recall': 0.98269534, 'specificity': 0.98269534, 'f1': 0.97672516, 'auroc': 0.9995289, 'binary_precision': 0.9983903, 'binary_recall': 0.9970529, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9977212}
confusion matrix:
      0      1
0  1468     48
1    88  29772
---- Validation: 
scalar performance:
{'acc': 0.8849765, 'precision': 0.8884089, 'recall': 0.8837493, 'specificity': 0.8837493, 'f1': 0.884416, 'auroc': 0.94581795, 'binary_precision': 0.9188712, 'binary_recall': 0.83762056, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.8763667}
confusion matrix:
     0    1
0  610   46
1  101  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79157895, 'precision': 0.8428571, 'recall': 0.8088803, 'specificity': 0.8088803, 'f1': 0.7886412, 'auroc': 0.9550265, 'binary_precision': 1.0, 'binary_recall': 0.6177606, 'binary_specificity': 1.0, 'binary_f1_score': 0.76372313}
confusion matrix:
     0    1
0  216    0
1   99  160
better model found
persisted
after epoch: 16,now: 2024-07-12 04:11:07.434912,epoch time: 0:10:45.449660,used: 2:52:29.758983,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9964941, 'precision': 0.9792185, 'recall': 0.98281765, 'specificity': 0.98281765, 'f1': 0.9810105, 'auroc': 0.99964, 'binary_precision': 0.99835837, 'binary_recall': 0.9979571, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9981577}
confusion matrix:
      0      1
0  1467     49
1    61  29799
---- Validation: 
scalar performance:
{'acc': 0.85602504, 'precision': 0.8632213, 'recall': 0.8579229, 'specificity': 0.8579229, 'f1': 0.85568535, 'auroc': 0.9342748, 'binary_precision': 0.80501395, 'binary_recall': 0.92926043, 'binary_specificity': 0.7865854, 'binary_f1_score': 0.8626866}
confusion matrix:
     0    1
0  516  140
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86526316, 'precision': 0.8694035, 'recall': 0.8710675, 'specificity': 0.8710675, 'f1': 0.8652339, 'auroc': 0.93985057, 'binary_precision': 0.93721974, 'binary_recall': 0.8069498, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.86722}
confusion matrix:
     0    1
0  202   14
1   50  209
early stop counter: 1
val acc:0.8560250401496887, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 17,now: 2024-07-12 04:21:53.741313,epoch time: 0:10:46.306401,used: 3:03:16.065384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9953149, 'precision': 0.97216606, 'recall': 0.97718894, 'specificity': 0.97718894, 'f1': 0.97466266, 'auroc': 0.9992885, 'binary_precision': 0.9978219, 'binary_recall': 0.99725384, 'binary_specificity': 0.957124, 'binary_f1_score': 0.9975378}
confusion matrix:
      0      1
0  1451     65
1    82  29778
---- Validation: 
scalar performance:
{'acc': 0.8771518, 'precision': 0.8796277, 'recall': 0.8760857, 'specificity': 0.8760857, 'f1': 0.8766563, 'auroc': 0.9355345, 'binary_precision': 0.90434784, 'binary_recall': 0.83601284, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.8688387}
confusion matrix:
     0    1
0  601   55
1  102  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7515789, 'precision': 0.809061, 'recall': 0.7702792, 'specificity': 0.7702792, 'f1': 0.74683833, 'auroc': 0.9184005, 'binary_precision': 0.9668874, 'binary_recall': 0.5637066, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7121951}
confusion matrix:
     0    1
0  211    5
1  113  146
early stop counter: 2
val acc:0.8771517872810364, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 18,now: 2024-07-12 04:32:38.575614,epoch time: 0:10:44.834301,used: 3:14:00.899685,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9941038, 'precision': 0.9577309, 'recall': 0.9803095, 'specificity': 0.9803095, 'f1': 0.96871585, 'auroc': 0.9992721, 'binary_precision': 0.9982203, 'binary_recall': 0.99557936, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.9968981}
confusion matrix:
      0      1
0  1463     53
1   132  29728
---- Validation: 
scalar performance:
{'acc': 0.81064165, 'precision': 0.84152436, 'recall': 0.80659115, 'specificity': 0.80659115, 'f1': 0.80475, 'auroc': 0.9326916, 'binary_precision': 0.937788, 'binary_recall': 0.65434086, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.7708334}
confusion matrix:
     0    1
0  629   27
1  215  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6231579, 'precision': 0.75633705, 'recall': 0.65328723, 'specificity': 0.65328723, 'f1': 0.5926458, 'auroc': 0.91664875, 'binary_precision': 0.96511626, 'binary_recall': 0.32046333, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.48115942}
confusion matrix:
     0   1
0  213   3
1  176  83
early stop counter: 3
val acc:0.8106416463851929, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 19,now: 2024-07-12 04:43:23.641013,epoch time: 0:10:45.065399,used: 3:24:45.965084,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9949643, 'precision': 0.9586316, 'recall': 0.9895276, 'specificity': 0.9895276, 'f1': 0.9735155, 'auroc': 0.9996785, 'binary_precision': 0.9991597, 'binary_recall': 0.99554586, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9973495}
confusion matrix:
      0      1
0  1491     25
1   133  29727
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.8388946, 'recall': 0.80591226, 'specificity': 0.80591226, 'f1': 0.8042145, 'auroc': 0.9272851, 'binary_precision': 0.93166286, 'binary_recall': 0.6575563, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.7709708}
confusion matrix:
     0    1
0  626   30
1  213  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55789477, 'precision': 0.7346866, 'recall': 0.59382594, 'specificity': 0.59382594, 'f1': 0.4988847, 'auroc': 0.90744317, 'binary_precision': 0.9622642, 'binary_recall': 0.1969112, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.32692307}
confusion matrix:
     0   1
0  214   2
1  208  51
early stop counter: 4
val acc:0.8098591566085815, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 20,now: 2024-07-12 04:54:09.136330,epoch time: 0:10:45.495317,used: 3:35:31.460401,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9932751, 'precision': 0.96519125, 'recall': 0.96140295, 'specificity': 0.96140295, 'f1': 0.9632884, 'auroc': 0.998176, 'binary_precision': 0.9962508, 'binary_recall': 0.99668455, 'binary_specificity': 0.92612135, 'binary_f1_score': 0.99646765}
confusion matrix:
      0      1
0  1404    112
1    99  29761
---- Validation: 
scalar performance:
{'acc': 0.82472616, 'precision': 0.84785354, 'recall': 0.82814336, 'specificity': 0.82814336, 'f1': 0.8227185, 'auroc': 0.93067706, 'binary_precision': 0.7512626, 'binary_recall': 0.95659167, 'binary_specificity': 0.6996951, 'binary_f1_score': 0.84158415}
confusion matrix:
     0    1
0  459  197
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7263158, 'precision': 0.7652675, 'recall': 0.706376, 'specificity': 0.706376, 'f1': 0.70226616, 'auroc': 0.8511011, 'binary_precision': 0.6837607, 'binary_recall': 0.9266409, 'binary_specificity': 0.4861111, 'binary_f1_score': 0.78688526}
confusion matrix:
     0    1
0  105  111
1   19  240
early stop counter: 5
val acc:0.8247261643409729, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 21,now: 2024-07-12 05:04:55.116895,epoch time: 0:10:45.980565,used: 3:46:17.440966,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.996526, 'precision': 0.975072, 'recall': 0.9878435, 'specificity': 0.9878435, 'f1': 0.9813632, 'auroc': 0.9997353, 'binary_precision': 0.99889326, 'binary_recall': 0.99745476, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9981735}
confusion matrix:
      0      1
0  1483     33
1    76  29784
---- Validation: 
scalar performance:
{'acc': 0.87089205, 'precision': 0.876572, 'recall': 0.87257123, 'specificity': 0.87257123, 'f1': 0.87068605, 'auroc': 0.94074726, 'binary_precision': 0.8231966, 'binary_recall': 0.9356913, 'binary_specificity': 0.8094512, 'binary_f1_score': 0.8758465}
confusion matrix:
     0    1
0  531  125
1   40  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83789474, 'precision': 0.8365514, 'recall': 0.83866906, 'specificity': 0.83866906, 'f1': 0.8371557, 'auroc': 0.9004004, 'binary_precision': 0.8669355, 'binary_recall': 0.83011585, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8481263}
confusion matrix:
     0    1
0  183   33
1   44  215
early stop counter: 6
val acc:0.8708920478820801, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 22,now: 2024-07-12 05:15:42.375881,epoch time: 0:10:47.258986,used: 3:57:04.699952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9907891, 'precision': 0.9798739, 'recall': 0.9178324, 'specificity': 0.9178324, 'f1': 0.94647443, 'auroc': 0.9985157, 'binary_precision': 0.99178445, 'binary_recall': 0.99859345, 'binary_specificity': 0.83707124, 'binary_f1_score': 0.9951773}
confusion matrix:
      0      1
0  1269    247
1    42  29818
---- Validation: 
scalar performance:
{'acc': 0.86228484, 'precision': 0.8650319, 'recall': 0.86347884, 'specificity': 0.86347884, 'f1': 0.8622186, 'auroc': 0.9240893, 'binary_precision': 0.8260234, 'binary_recall': 0.9083601, 'binary_specificity': 0.81859756, 'binary_f1_score': 0.8652373}
confusion matrix:
     0    1
0  537  119
1   57  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62526315, 'precision': 0.73815787, 'recall': 0.65368044, 'specificity': 0.65368044, 'f1': 0.5992587, 'auroc': 0.9026527, 'binary_precision': 0.9263158, 'binary_recall': 0.33976835, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.49717513}
confusion matrix:
     0   1
0  209   7
1  171  88
early stop counter: 7
val acc:0.8622848391532898, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 23,now: 2024-07-12 05:26:28.348143,epoch time: 0:10:45.972262,used: 4:07:50.672214,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9955061, 'precision': 0.966788, 'recall': 0.98574233, 'specificity': 0.98574233, 'f1': 0.9760542, 'auroc': 0.9995196, 'binary_precision': 0.99872464, 'binary_recall': 0.99655056, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9976364}
confusion matrix:
      0      1
0  1478     38
1   103  29757
---- Validation: 
scalar performance:
{'acc': 0.85054773, 'precision': 0.8507036, 'recall': 0.85092103, 'specificity': 0.85092103, 'f1': 0.85053664, 'auroc': 0.9127716, 'binary_precision': 0.83410853, 'binary_recall': 0.8649518, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.8492502}
confusion matrix:
     0    1
0  549  107
1   84  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80210525, 'precision': 0.8004011, 'recall': 0.8012388, 'specificity': 0.8012388, 'f1': 0.8007621, 'auroc': 0.8877985, 'binary_precision': 0.8235294, 'binary_recall': 0.8108108, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.8171206}
confusion matrix:
     0    1
0  171   45
1   49  210
early stop counter: 8
val acc:0.850547730922699, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 24,now: 2024-07-12 05:37:13.053248,epoch time: 0:10:44.705105,used: 4:18:35.377319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9958567, 'precision': 0.9711266, 'recall': 0.9846742, 'specificity': 0.9846742, 'f1': 0.97779316, 'auroc': 0.99966764, 'binary_precision': 0.99859124, 'binary_recall': 0.9970529, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9978215}
confusion matrix:
      0      1
0  1474     42
1    88  29772
---- Validation: 
scalar performance:
{'acc': 0.86619717, 'precision': 0.8680218, 'recall': 0.8652483, 'specificity': 0.8652483, 'f1': 0.86573476, 'auroc': 0.92783654, 'binary_precision': 0.8881239, 'binary_recall': 0.829582, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.8578553}
confusion matrix:
     0    1
0  591   65
1  106  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8105263, 'precision': 0.83061403, 'recall': 0.82164305, 'specificity': 0.82164305, 'f1': 0.810081, 'auroc': 0.91157234, 'binary_precision': 0.93782383, 'binary_recall': 0.6988417, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8008849}
confusion matrix:
     0    1
0  204   12
1   78  181
early stop counter: 9
val acc:0.8661971688270569, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 25,now: 2024-07-12 05:47:58.640710,epoch time: 0:10:45.587462,used: 4:29:20.964781,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9965898, 'precision': 0.9821862, 'recall': 0.98067635, 'specificity': 0.98067635, 'f1': 0.98142993, 'auroc': 0.9996742, 'binary_precision': 0.9981249, 'binary_recall': 0.998292, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.99820846}
confusion matrix:
      0      1
0  1460     56
1    51  29809
---- Validation: 
scalar performance:
{'acc': 0.8380282, 'precision': 0.857032, 'recall': 0.8411007, 'specificity': 0.8411007, 'f1': 0.8366116, 'auroc': 0.94755316, 'binary_precision': 0.7677419, 'binary_recall': 0.95659167, 'binary_specificity': 0.7256098, 'binary_f1_score': 0.85182536}
confusion matrix:
     0    1
0  476  180
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86105263, 'precision': 0.8658072, 'recall': 0.8552928, 'specificity': 0.8552928, 'f1': 0.858232, 'auroc': 0.94651794, 'binary_precision': 0.8409894, 'binary_recall': 0.9189189, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.8782287}
confusion matrix:
     0    1
0  171   45
1   21  238
early stop counter: 10
val acc:0.8380281925201416, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 26,now: 2024-07-12 05:58:43.869222,epoch time: 0:10:45.228512,used: 4:40:06.193293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.990821, 'precision': 0.99328554, 'recall': 0.90657854, 'specificity': 0.90657854, 'f1': 0.9453123, 'auroc': 0.99970484, 'binary_precision': 0.9906099, 'binary_recall': 0.9998326, 'binary_specificity': 0.8133245, 'binary_f1_score': 0.9951998}
confusion matrix:
      0      1
0  1233    283
1     5  29855
---- Validation: 
scalar performance:
{'acc': 0.7316119, 'precision': 0.8087945, 'recall': 0.7381505, 'specificity': 0.7381505, 'f1': 0.7171477, 'auroc': 0.94430095, 'binary_precision': 0.64761907, 'binary_recall': 0.98392284, 'binary_specificity': 0.49237806, 'binary_f1_score': 0.7811104}
confusion matrix:
     0    1
0  323  333
1   10  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81473684, 'precision': 0.8409698, 'recall': 0.80129236, 'specificity': 0.80129236, 'f1': 0.805219, 'auroc': 0.93951094, 'binary_precision': 0.76635516, 'binary_recall': 0.9498069, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.84827584}
confusion matrix:
     0    1
0  141   75
1   13  246
early stop counter: 11
val acc:0.7316119074821472, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 27,now: 2024-07-12 06:09:31.843650,epoch time: 0:10:47.974428,used: 4:50:54.167721,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9960479, 'precision': 0.9716016, 'recall': 0.98634005, 'specificity': 0.98634005, 'f1': 0.97884417, 'auroc': 0.99962556, 'binary_precision': 0.9987588, 'binary_recall': 0.9970864, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.99792194}
confusion matrix:
      0      1
0  1479     37
1    87  29773
---- Validation: 
scalar performance:
{'acc': 0.85837245, 'precision': 0.86680675, 'recall': 0.86041784, 'specificity': 0.86041784, 'f1': 0.85795844, 'auroc': 0.940142, 'binary_precision': 0.80413795, 'binary_recall': 0.937299, 'binary_specificity': 0.7835366, 'binary_f1_score': 0.86562735}
confusion matrix:
     0    1
0  514  142
1   39  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8568421, 'precision': 0.85892177, 'recall': 0.8614239, 'specificity': 0.8614239, 'f1': 0.8567348, 'auroc': 0.9230659, 'binary_precision': 0.9170306, 'binary_recall': 0.8108108, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8606558}
confusion matrix:
     0    1
0  197   19
1   49  210
early stop counter: 12
val acc:0.8583724498748779, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 28,now: 2024-07-12 06:20:15.672187,epoch time: 0:10:43.828537,used: 5:01:37.996258,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9943906, 'precision': 0.9508617, 'recall': 0.992983, 'specificity': 0.992983, 'f1': 0.97086716, 'auroc': 0.99972785, 'binary_precision': 0.99956244, 'binary_recall': 0.99454117, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.99704546}
confusion matrix:
      0      1
0  1503     13
1   163  29697
---- Validation: 
scalar performance:
{'acc': 0.87558687, 'precision': 0.87845707, 'recall': 0.8744363, 'specificity': 0.8744363, 'f1': 0.8750341, 'auroc': 0.9353213, 'binary_precision': 0.90542907, 'binary_recall': 0.8311897, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.8667226}
confusion matrix:
     0    1
0  602   54
1  105  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757895, 'precision': 0.76412755, 'recall': 0.7000125, 'specificity': 0.7000125, 'f1': 0.66168094, 'auroc': 0.907318, 'binary_precision': 0.9411765, 'binary_recall': 0.43243244, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.5925926}
confusion matrix:
     0    1
0  209    7
1  147  112
early stop counter: 13
val acc:0.8755868673324585, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 29,now: 2024-07-12 06:31:02.578543,epoch time: 0:10:46.906356,used: 5:12:24.902614,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9959842, 'precision': 0.9718003, 'recall': 0.9853673, 'specificity': 0.9853673, 'f1': 0.9784764, 'auroc': 0.99972725, 'binary_precision': 0.99865836, 'binary_recall': 0.9971199, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9978885}
confusion matrix:
      0      1
0  1476     40
1    86  29774
---- Validation: 
scalar performance:
{'acc': 0.74804384, 'precision': 0.8125407, 'recall': 0.7539899, 'specificity': 0.7539899, 'f1': 0.73716533, 'auroc': 0.94278395, 'binary_precision': 0.6637555, 'binary_recall': 0.977492, 'binary_specificity': 0.5304878, 'binary_f1_score': 0.79063714}
confusion matrix:
     0    1
0  348  308
1   14  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87578946, 'precision': 0.8815537, 'recall': 0.86995924, 'specificity': 0.86995924, 'f1': 0.87319064, 'auroc': 0.9412985, 'binary_precision': 0.85211265, 'binary_recall': 0.93436295, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.89134437}
confusion matrix:
     0    1
0  174   42
1   17  242
early stop counter: 14
val acc:0.7480438351631165, best validation acc: 0.8849765062332153, corresponding to test acc:                         0.7915789484977722 / 0.8842105269432068
after epoch: 30,now: 2024-07-12 06:41:48.203261,epoch time: 0:10:45.624718,used: 5:23:10.527332,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_01_18_37_seed_2_21870153
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 5:23:10.527332 at 2024-07-12 06:41:48.203261
persisted model performance metric: 

scalar performance:
{'acc': 0.79157895, 'precision': 0.8428571, 'recall': 0.8088803, 'specificity': 0.8088803, 'f1': 0.7886412, 'auroc': 0.9550265, 'binary_precision': 1.0, 'binary_recall': 0.6177606, 'binary_specificity': 1.0, 'binary_f1_score': 0.76372313}
confusion matrix:
     0    1
0  216    0
1   99  160
oracle model performance metric: 

scalar performance:
{'acc': 0.8842105, 'precision': 0.8852303, 'recall': 0.88114005, 'specificity': 0.88114005, 'f1': 0.8826944, 'auroc': 0.94841266, 'binary_precision': 0.87777776, 'binary_recall': 0.9150579, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8960302}
confusion matrix:
     0    1
0  183   33
1   22  237
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_nofreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455133 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455133 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool | 414531 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |  40601 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447483 KiB |  13213 MiB |   1045 TiB |   1045 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1031 TiB |   1031 TiB |
|       from small pool |  40408 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41664 MiB |  27190 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     66 MiB |     94 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448035 KiB |   1252 MiB |    790 TiB |    790 TiB |
|       from large pool | 435388 KiB |   1244 MiB |    776 TiB |    776 TiB |
|       from small pool |  12646 KiB |     46 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1316    |    4927    |  203708 K  |  203707 K  |
|       from large pool |     187    |    1413    |   97185 K  |   97184 K  |
|       from small pool |    1129    |    4738    |  106523 K  |  106522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1316    |    4927    |  203708 K  |  203707 K  |
|       from large pool |     187    |    1413    |   97185 K  |   97184 K  |
|       from small pool |    1129    |    4738    |  106523 K  |  106522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |    1776    |    1142    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      33    |      47    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |    2034    |  121010 K  |  121010 K  |
|       from large pool |      40    |     604    |   67959 K  |   67959 K  |
|       from small pool |      61    |    1992    |   53051 K  |   53051 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |   1048 TiB |   1048 TiB |
|       from large pool |  16640 KiB |  13181 MiB |   1034 TiB |   1034 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1045 TiB |   1045 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1031 TiB |   1031 TiB |
|       from small pool |      0 KiB |     56 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41664 MiB |  40782 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     66 MiB |     94 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |    790 TiB |    790 TiB |
|       from large pool |  24320 KiB |   1244 MiB |    776 TiB |    776 TiB |
|       from small pool |      0 KiB |     46 MiB |     14 TiB |     14 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4927    |  203708 K  |  203708 K  |
|       from large pool |       2    |    1413    |   97185 K  |   97185 K  |
|       from small pool |       0    |    4738    |  106523 K  |  106523 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4927    |  203708 K  |  203708 K  |
|       from large pool |       2    |    1413    |   97185 K  |   97185 K  |
|       from small pool |       0    |    4738    |  106523 K  |  106523 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     634    |    1776    |    1713    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      33    |      47    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    2034    |  121010 K  |  121010 K  |
|       from large pool |       4    |     604    |   67959 K  |   67959 K  |
|       from small pool |       0    |    1992    |   53051 K  |   53051 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 06:49:29 2024]
Finished job 0.
1 of 1 steps (100%) done
