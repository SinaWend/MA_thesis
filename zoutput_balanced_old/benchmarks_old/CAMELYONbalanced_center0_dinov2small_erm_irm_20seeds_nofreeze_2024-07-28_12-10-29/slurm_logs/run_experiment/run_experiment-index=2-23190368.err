Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 23:59:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368

 Experiment start at: 2024-07-29 00:02:43.701680
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.95409954, 'recall': 0.9536997, 'specificity': 0.9536997, 'f1': 0.9534458, 'auroc': 0.9900029, 'binary_precision': 0.97444516, 'binary_recall': 0.9324324, 'binary_specificity': 0.97496706, 'binary_f1_score': 0.952976}
confusion matrix:
      0     1
0  1480    38
1   105  1449
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.86568326, 'precision': 0.8736065, 'recall': 0.86466944, 'specificity': 0.86466944, 'f1': 0.8647143, 'auroc': 0.91997445, 'binary_precision': 0.9246324, 'binary_recall': 0.792126, 'binary_specificity': 0.9372129, 'binary_f1_score': 0.85326546}
confusion matrix:
     0    1
0  612   41
1  132  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8421509, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8313762, 'auroc': 0.91926444, 'binary_precision': 0.89944136, 'binary_recall': 0.74883723, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8172589}
confusion matrix:
     0    1
0  197   18
1   54  161
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 00:04:17.831576,epoch time: 0:01:34.129896,used: 0:01:34.129896,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.967082, 'recall': 0.9667769, 'specificity': 0.9667769, 'f1': 0.96646947, 'auroc': 0.9955554, 'binary_precision': 0.98792756, 'binary_recall': 0.94544286, 'binary_specificity': 0.98811096, 'binary_f1_score': 0.9662184}
confusion matrix:
      0     1
0  1496    18
1    85  1473
---- Validation: 
scalar performance:
{'acc': 0.74378884, 'precision': 0.77425367, 'recall': 0.74141634, 'specificity': 0.74141634, 'f1': 0.7351974, 'auroc': 0.88264036, 'binary_precision': 0.8622328, 'binary_recall': 0.57165354, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.68750006}
confusion matrix:
     0    1
0  595   58
1  272  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.84851164, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.83061975, 'auroc': 0.9166901, 'binary_precision': 0.9230769, 'binary_recall': 0.7255814, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8125}
confusion matrix:
     0    1
0  202   13
1   59  156
early stop counter: 1
val acc:0.7437888383865356, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8325581550598145
after epoch: 2,now: 2024-07-29 00:05:42.732724,epoch time: 0:01:24.901148,used: 0:02:59.031044,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97246593, 'recall': 0.9714149, 'specificity': 0.9714149, 'f1': 0.9716502, 'auroc': 0.9970964, 'binary_precision': 0.9565757, 'binary_recall': 0.98909557, 'binary_specificity': 0.9537343, 'binary_f1_score': 0.9725638}
confusion matrix:
      0     1
0  1443    70
1    17  1542
---- Validation: 
scalar performance:
{'acc': 0.8214286, 'precision': 0.83340657, 'recall': 0.82009137, 'specificity': 0.82009137, 'f1': 0.81935483, 'auroc': 0.8993887, 'binary_precision': 0.89320385, 'binary_recall': 0.72440946, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  598   55
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.85164964, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.8511113, 'auroc': 0.91647375, 'binary_precision': 0.8647343, 'binary_recall': 0.83255816, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.8483413}
confusion matrix:
     0    1
0  187   28
1   36  179
new oracle model saved
early stop counter: 2
val acc:0.8214285969734192, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8511627912521362
after epoch: 3,now: 2024-07-29 00:07:15.874451,epoch time: 0:01:33.141727,used: 0:04:32.172771,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.9647119, 'recall': 0.9633337, 'specificity': 0.9633337, 'f1': 0.96287346, 'auroc': 0.9961834, 'binary_precision': 0.9972414, 'binary_recall': 0.9293059, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9620758}
confusion matrix:
      0     1
0  1512     4
1   110  1446
---- Validation: 
scalar performance:
{'acc': 0.7507764, 'precision': 0.8054862, 'recall': 0.7477867, 'specificity': 0.7477867, 'f1': 0.73756385, 'auroc': 0.8908731, 'binary_precision': 0.9313187, 'binary_recall': 0.53385824, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.6786787}
confusion matrix:
     0    1
0  628   25
1  296  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8554485, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.81647456, 'auroc': 0.8969172, 'binary_precision': 0.9662162, 'binary_recall': 0.66511625, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.78787875}
confusion matrix:
     0    1
0  210    5
1   72  143
early stop counter: 3
val acc:0.7507764101028442, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8511627912521362
after epoch: 4,now: 2024-07-29 00:08:42.088878,epoch time: 0:01:26.214427,used: 0:05:58.387198,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93098956, 'precision': 0.93915915, 'recall': 0.929999, 'specificity': 0.929999, 'f1': 0.93054414, 'auroc': 0.9975478, 'binary_precision': 0.882888, 'binary_recall': 0.9961514, 'binary_specificity': 0.86384666, 'binary_f1_score': 0.9361061}
confusion matrix:
      0     1
0  1307   206
1     6  1553
---- Validation: 
scalar performance:
{'acc': 0.7779503, 'precision': 0.80833584, 'recall': 0.78012085, 'specificity': 0.78012085, 'f1': 0.773221, 'auroc': 0.91708046, 'binary_precision': 0.7079857, 'binary_recall': 0.9354331, 'binary_specificity': 0.62480855, 'binary_f1_score': 0.80597013}
confusion matrix:
     0    1
0  408  245
1   41  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.8874631, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859423, 'auroc': 0.95580316, 'binary_precision': 0.86403507, 'binary_recall': 0.9162791, 'binary_specificity': 0.855814, 'binary_f1_score': 0.88939047}
confusion matrix:
     0    1
0  184   31
1   18  197
new oracle model saved
early stop counter: 4
val acc:0.7779502868652344, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 5,now: 2024-07-29 00:10:14.361562,epoch time: 0:01:32.272684,used: 0:07:30.659882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9827871, 'recall': 0.9828589, 'specificity': 0.9828589, 'f1': 0.9827471, 'auroc': 0.99897873, 'binary_precision': 0.9914977, 'binary_recall': 0.97429305, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9828201}
confusion matrix:
      0     1
0  1503    13
1    40  1516
---- Validation: 
scalar performance:
{'acc': 0.80279505, 'precision': 0.8373921, 'recall': 0.8005426, 'specificity': 0.8005426, 'f1': 0.7967571, 'auroc': 0.9243082, 'binary_precision': 0.9419954, 'binary_recall': 0.6393701, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.7617261}
confusion matrix:
     0    1
0  628   25
1  229  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8695224, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8282634, 'auroc': 0.93512166, 'binary_precision': 0.9863946, 'binary_recall': 0.6744186, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.801105}
confusion matrix:
     0    1
0  213    2
1   70  145
early stop counter: 5
val acc:0.8027950525283813, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 6,now: 2024-07-29 00:11:40.674743,epoch time: 0:01:26.313181,used: 0:08:56.973063,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851186, 'recall': 0.9851746, 'specificity': 0.9851746, 'f1': 0.98502594, 'auroc': 0.99940395, 'binary_precision': 0.99606043, 'binary_recall': 0.97430956, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9850649}
confusion matrix:
      0     1
0  1509     6
1    40  1517
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.8025216, 'recall': 0.7694807, 'specificity': 0.7694807, 'f1': 0.76475036, 'auroc': 0.8944882, 'binary_precision': 0.8955917, 'binary_recall': 0.60787404, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.7242027}
confusion matrix:
     0    1
0  608   45
1  249  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8900042, 'recall': 0.87906975, 'specificity': 0.87906975, 'f1': 0.87821615, 'auroc': 0.92588425, 'binary_precision': 0.95530725, 'binary_recall': 0.7953488, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8680203}
confusion matrix:
     0    1
0  207    8
1   44  171
early stop counter: 6
val acc:0.77173912525177, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 7,now: 2024-07-29 00:13:15.128774,epoch time: 0:01:34.454031,used: 0:10:31.427094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853882, 'recall': 0.98548967, 'specificity': 0.98548967, 'f1': 0.98535115, 'auroc': 0.99912035, 'binary_precision': 0.99477124, 'binary_recall': 0.97626686, 'binary_specificity': 0.9947125, 'binary_f1_score': 0.9854322}
confusion matrix:
      0     1
0  1505     8
1    37  1522
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.8325101, 'recall': 0.7886665, 'specificity': 0.7886665, 'f1': 0.78344077, 'auroc': 0.9254247, 'binary_precision': 0.94634145, 'binary_recall': 0.6110236, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.7425837}
confusion matrix:
     0    1
0  631   22
1  247  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8577552, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.79987556, 'auroc': 0.93836665, 'binary_precision': 0.9925373, 'binary_recall': 0.61860466, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7621777}
confusion matrix:
     0    1
0  214    1
1   82  133
early stop counter: 7
val acc:0.7911490797996521, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 8,now: 2024-07-29 00:14:46.196962,epoch time: 0:01:31.068188,used: 0:12:02.495282,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895617, 'recall': 0.98962396, 'specificity': 0.98962396, 'f1': 0.9895823, 'auroc': 0.999365, 'binary_precision': 0.9928849, 'binary_recall': 0.98650384, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98968405}
confusion matrix:
      0     1
0  1505    11
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.79618555, 'recall': 0.75441146, 'specificity': 0.75441146, 'f1': 0.74739444, 'auroc': 0.8975558, 'binary_precision': 0.9004975, 'binary_recall': 0.57007873, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.69816774}
confusion matrix:
     0    1
0  613   40
1  273  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.8186759, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.78877246, 'auroc': 0.91061115, 'binary_precision': 0.90909094, 'binary_recall': 0.6511628, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.7588076}
confusion matrix:
     0    1
0  201   14
1   75  140
early stop counter: 8
val acc:0.7569875717163086, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 9,now: 2024-07-29 00:17:06.017448,epoch time: 0:02:19.820486,used: 0:14:22.315768,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9897185, 'recall': 0.9895092, 'specificity': 0.9895092, 'f1': 0.98957986, 'auroc': 0.99974734, 'binary_precision': 0.9841068, 'binary_recall': 0.9954984, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.9897698}
confusion matrix:
      0     1
0  1492    25
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.82220495, 'precision': 0.8227356, 'recall': 0.82189894, 'specificity': 0.82189894, 'f1': 0.8220066, 'auroc': 0.8824661, 'binary_precision': 0.83278686, 'binary_recall': 0.8, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.81606424}
confusion matrix:
     0    1
0  551  102
1  127  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8320445, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.8273692, 'auroc': 0.90492153, 'binary_precision': 0.7949791, 'binary_recall': 0.88372093, 'binary_specificity': 0.772093, 'binary_f1_score': 0.8370045}
confusion matrix:
     0    1
0  166   49
1   25  190
early stop counter: 9
val acc:0.8222049474716187, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 10,now: 2024-07-29 00:19:35.161919,epoch time: 0:02:29.144471,used: 0:16:51.460239,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876832, 'recall': 0.9877411, 'specificity': 0.9877411, 'f1': 0.98763007, 'auroc': 0.99907243, 'binary_precision': 0.9967256, 'binary_recall': 0.9787781, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98767036}
confusion matrix:
      0     1
0  1512     5
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.80703354, 'recall': 0.7350147, 'specificity': 0.7350147, 'f1': 0.7210263, 'auroc': 0.92723584, 'binary_precision': 0.9487952, 'binary_recall': 0.496063, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.65149945}
confusion matrix:
     0    1
0  636   17
1  320  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.8226014, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.72763497, 'auroc': 0.92049754, 'binary_precision': 0.98165137, 'binary_recall': 0.4976744, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.6604938}
confusion matrix:
     0    1
0  213    2
1  108  107
early stop counter: 10
val acc:0.7383540272712708, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 11,now: 2024-07-29 00:21:51.957637,epoch time: 0:02:16.795718,used: 0:19:08.255957,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99021053, 'recall': 0.99027705, 'specificity': 0.99027705, 'f1': 0.9902333, 'auroc': 0.9990419, 'binary_precision': 0.9935359, 'binary_recall': 0.9871548, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.990335}
confusion matrix:
      0     1
0  1505    10
1    20  1537
---- Validation: 
scalar performance:
{'acc': 0.68944097, 'precision': 0.7287571, 'recall': 0.6864719, 'specificity': 0.6864719, 'f1': 0.6733344, 'auroc': 0.8544525, 'binary_precision': 0.8201635, 'binary_recall': 0.47401574, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.6007984}
confusion matrix:
     0    1
0  587   66
1  334  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8502262, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8330554, 'auroc': 0.9290427, 'binary_precision': 0.9235294, 'binary_recall': 0.73023254, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.8155844}
confusion matrix:
     0    1
0  202   13
1   58  157
early stop counter: 11
val acc:0.6894409656524658, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 12,now: 2024-07-29 00:24:30.954924,epoch time: 0:02:38.997287,used: 0:21:47.253244,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98797905, 'recall': 0.9879325, 'specificity': 0.9879325, 'f1': 0.9879532, 'auroc': 0.99943364, 'binary_precision': 0.9865471, 'binary_recall': 0.98971725, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9881297}
confusion matrix:
      0     1
0  1495    21
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.7826087, 'precision': 0.79406625, 'recall': 0.78119886, 'specificity': 0.78119886, 'f1': 0.77985704, 'auroc': 0.8814605, 'binary_precision': 0.848723, 'binary_recall': 0.68031496, 'binary_specificity': 0.8820827, 'binary_f1_score': 0.7552448}
confusion matrix:
     0    1
0  576   77
1  203  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.8641219, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8626652, 'auroc': 0.93391025, 'binary_precision': 0.8861386, 'binary_recall': 0.83255816, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8585132}
confusion matrix:
     0    1
0  192   23
1   36  179
early stop counter: 12
val acc:0.782608687877655, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 13,now: 2024-07-29 00:27:00.503013,epoch time: 0:02:29.548089,used: 0:24:16.801333,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9887022, 'recall': 0.98853785, 'specificity': 0.98853785, 'f1': 0.9886023, 'auroc': 0.9994353, 'binary_precision': 0.9847425, 'binary_recall': 0.9929487, 'binary_specificity': 0.984127, 'binary_f1_score': 0.9888286}
confusion matrix:
      0     1
0  1488    24
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.83462733, 'precision': 0.8531507, 'recall': 0.8330214, 'specificity': 0.8330214, 'f1': 0.8319357, 'auroc': 0.93032527, 'binary_precision': 0.93061227, 'binary_recall': 0.71811026, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.8106667}
confusion matrix:
     0    1
0  619   34
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.8436111, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.776694, 'auroc': 0.92713904, 'binary_precision': 0.984252, 'binary_recall': 0.5813953, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7309941}
confusion matrix:
     0    1
0  213    2
1   90  125
early stop counter: 13
val acc:0.8346273303031921, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 14,now: 2024-07-29 00:29:19.577739,epoch time: 0:02:19.074726,used: 0:26:35.876059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.96747434, 'recall': 0.96436536, 'specificity': 0.96436536, 'f1': 0.964762, 'auroc': 0.99971634, 'binary_precision': 0.93565845, 'binary_recall': 0.99935776, 'binary_specificity': 0.92937297, 'binary_f1_score': 0.96645963}
confusion matrix:
      0     1
0  1408   107
1     1  1556
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.8638901, 'recall': 0.86233854, 'specificity': 0.86233854, 'f1': 0.8617048, 'auroc': 0.92943287, 'binary_precision': 0.83260554, 'binary_recall': 0.9007874, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.86535555}
confusion matrix:
     0    1
0  538  115
1   63  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.8774055, 'recall': 0.8767442, 'specificity': 0.8767442, 'f1': 0.87669015, 'auroc': 0.94624126, 'binary_precision': 0.86160713, 'binary_recall': 0.89767444, 'binary_specificity': 0.855814, 'binary_f1_score': 0.87927103}
confusion matrix:
     0    1
0  184   31
1   22  193
early stop counter: 14
val acc:0.861801266670227, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 15,now: 2024-07-29 00:31:52.884954,epoch time: 0:02:33.307215,used: 0:29:09.183274,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886091, 'recall': 0.9885998, 'specificity': 0.9885998, 'f1': 0.9886043, 'auroc': 0.9994853, 'binary_precision': 0.98845416, 'binary_recall': 0.9890886, 'binary_specificity': 0.98811096, 'binary_f1_score': 0.9887713}
confusion matrix:
      0     1
0  1496    18
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.85594666, 'recall': 0.8369584, 'specificity': 0.8369584, 'f1': 0.83604205, 'auroc': 0.9319651, 'binary_precision': 0.93131316, 'binary_recall': 0.7259843, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.8159293}
confusion matrix:
     0    1
0  619   34
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.86345243, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.82626265, 'auroc': 0.9370687, 'binary_precision': 0.97333336, 'binary_recall': 0.67906976, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  211    4
1   69  146
early stop counter: 15
val acc:0.8385093212127686, best validation acc: 0.8656832575798035, corresponding to test acc:                         0.8325581550598145 / 0.8860465288162231
after epoch: 16,now: 2024-07-29 00:33:28.795270,epoch time: 0:01:35.910316,used: 0:30:45.093590,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98409986, 'recall': 0.98356956, 'specificity': 0.98356956, 'f1': 0.983714, 'auroc': 0.9995451, 'binary_precision': 0.9736015, 'binary_recall': 0.9948619, 'binary_specificity': 0.9722772, 'binary_f1_score': 0.9841169}
confusion matrix:
      0     1
0  1473    42
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.88141763, 'recall': 0.8810469, 'specificity': 0.8810469, 'f1': 0.8811423, 'auroc': 0.9243009, 'binary_precision': 0.8874598, 'binary_recall': 0.86929137, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.8782816}
confusion matrix:
     0    1
0  583   70
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.8858339, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.87601393, 'auroc': 0.9245646, 'binary_precision': 0.94505495, 'binary_recall': 0.8, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.86649877}
confusion matrix:
     0    1
0  205   10
1   43  172
better model found
persisted
after epoch: 17,now: 2024-07-29 00:36:02.375847,epoch time: 0:02:33.580577,used: 0:33:18.674167,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905454, 'recall': 0.99063385, 'specificity': 0.99063385, 'f1': 0.99055934, 'auroc': 0.9996655, 'binary_precision': 0.9961039, 'binary_recall': 0.985228, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.99063617}
confusion matrix:
      0     1
0  1509     6
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.6296584, 'precision': 0.7615498, 'recall': 0.6246265, 'specificity': 0.6246265, 'f1': 0.5713613, 'auroc': 0.87809145, 'binary_precision': 0.94382024, 'binary_recall': 0.26456693, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.41328412}
confusion matrix:
     0    1
0  643   10
1  467  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.7891525, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6109644, 'auroc': 0.90905356, 'binary_precision': 0.98550725, 'binary_recall': 0.31627908, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.47887328}
confusion matrix:
     0   1
0  214   1
1  147  68
early stop counter: 1
val acc:0.6296584010124207, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8767442107200623 / 0.8860465288162231
after epoch: 18,now: 2024-07-29 00:38:28.643062,epoch time: 0:02:26.267215,used: 0:35:44.941382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98926675, 'recall': 0.9893407, 'specificity': 0.9893407, 'f1': 0.98925745, 'auroc': 0.9997003, 'binary_precision': 0.9960887, 'binary_recall': 0.98263663, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9893169}
confusion matrix:
      0     1
0  1511     6
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.6560559, 'precision': 0.781531, 'recall': 0.65133303, 'specificity': 0.65133303, 'f1': 0.6089573, 'auroc': 0.92996526, 'binary_precision': 0.9660194, 'binary_recall': 0.3133858, 'binary_specificity': 0.9892802, 'binary_f1_score': 0.4732461}
confusion matrix:
     0    1
0  646    7
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.793805, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6273762, 'auroc': 0.9401839, 'binary_precision': 0.9864865, 'binary_recall': 0.33953488, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5051903}
confusion matrix:
     0   1
0  214   1
1  142  73
early stop counter: 2
val acc:0.6560559272766113, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8767442107200623 / 0.8860465288162231
after epoch: 19,now: 2024-07-29 00:40:13.433322,epoch time: 0:01:44.790260,used: 0:37:29.731642,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99314076, 'recall': 0.99320287, 'specificity': 0.99320287, 'f1': 0.9931633, 'auroc': 0.9995388, 'binary_precision': 0.996124, 'binary_recall': 0.9903661, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9932367}
confusion matrix:
      0     1
0  1509     6
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.6785714, 'precision': 0.7881305, 'recall': 0.6742111, 'specificity': 0.6742111, 'f1': 0.64153624, 'auroc': 0.9129095, 'binary_precision': 0.9623431, 'binary_recall': 0.36220473, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.5263158}
confusion matrix:
     0    1
0  644    9
1  405  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.8095105, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.6931733, 'auroc': 0.9222715, 'binary_precision': 0.97938144, 'binary_recall': 0.44186047, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.60897434}
confusion matrix:
     0   1
0  213   2
1  120  95
early stop counter: 3
val acc:0.6785714030265808, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8767442107200623 / 0.8860465288162231
after epoch: 20,now: 2024-07-29 00:42:53.409152,epoch time: 0:02:39.975830,used: 0:40:09.707472,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.992509, 'recall': 0.9925923, 'specificity': 0.9925923, 'f1': 0.9925127, 'auroc': 0.99949884, 'binary_precision': 0.9986988, 'binary_recall': 0.98650384, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9925639}
confusion matrix:
      0     1
0  1514     2
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.87046075, 'recall': 0.85745263, 'specificity': 0.85745263, 'f1': 0.8572414, 'auroc': 0.93924344, 'binary_precision': 0.9330784, 'binary_recall': 0.76850396, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.84283245}
confusion matrix:
     0    1
0  618   35
1  147  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.8393308, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.79678524, 'auroc': 0.9250676, 'binary_precision': 0.9513889, 'binary_recall': 0.6372093, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.76323116}
confusion matrix:
     0    1
0  208    7
1   78  137
early stop counter: 4
val acc:0.8586956262588501, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8767442107200623 / 0.8860465288162231
after epoch: 21,now: 2024-07-29 00:45:01.665026,epoch time: 0:02:08.255874,used: 0:42:17.963346,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98242813, 'recall': 0.9815643, 'specificity': 0.9815643, 'f1': 0.98175585, 'auroc': 0.9995693, 'binary_precision': 0.96758103, 'binary_recall': 0.9974293, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9822784}
confusion matrix:
      0     1
0  1464    52
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.8781056, 'precision': 0.88056314, 'recall': 0.87755, 'specificity': 0.87755, 'f1': 0.87777483, 'auroc': 0.9359033, 'binary_precision': 0.90784985, 'binary_recall': 0.83779526, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.87141687}
confusion matrix:
     0    1
0  599   54
1  103  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.88170993, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8533263, 'auroc': 0.9416982, 'binary_precision': 0.9811321, 'binary_recall': 0.7255814, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8342246}
confusion matrix:
     0    1
0  212    3
1   59  156
early stop counter: 5
val acc:0.8781055808067322, best validation acc: 0.8812111616134644, corresponding to test acc:                         0.8767442107200623 / 0.8860465288162231
after epoch: 22,now: 2024-07-29 00:47:44.178025,epoch time: 0:02:42.512999,used: 0:45:00.476345,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9768224, 'recall': 0.9752742, 'specificity': 0.9752742, 'f1': 0.975554, 'auroc': 0.9996346, 'binary_precision': 0.95571953, 'binary_recall': 0.9980732, 'binary_specificity': 0.95247525, 'binary_f1_score': 0.9764373}
confusion matrix:
      0     1
0  1443    72
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.89829195, 'precision': 0.8998327, 'recall': 0.89787054, 'specificity': 0.89787054, 'f1': 0.8981061, 'auroc': 0.94474196, 'binary_precision': 0.92140466, 'binary_recall': 0.86771655, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.8937551}
confusion matrix:
     0    1
0  606   47
1   84  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.90049446, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8824905, 'auroc': 0.94249856, 'binary_precision': 0.98245615, 'binary_recall': 0.7813954, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8704663}
confusion matrix:
     0    1
0  212    3
1   47  168
better model found
persisted
after epoch: 23,now: 2024-07-29 00:49:52.003456,epoch time: 0:02:07.825431,used: 0:47:08.301776,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883486, 'recall': 0.98842806, 'specificity': 0.98842806, 'f1': 0.9882811, 'auroc': 0.99956036, 'binary_precision': 0.9986894, 'binary_recall': 0.97817713, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9883269}
confusion matrix:
      0     1
0  1512     2
1    34  1524
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.86982024, 'recall': 0.845316, 'specificity': 0.845316, 'f1': 0.8441731, 'auroc': 0.938684, 'binary_precision': 0.95815897, 'binary_recall': 0.72125983, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.8230009}
confusion matrix:
     0    1
0  633   20
1  177  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.85884845, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81337225, 'auroc': 0.94684696, 'binary_precision': 0.97902095, 'binary_recall': 0.6511628, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7821229}
confusion matrix:
     0    1
0  212    3
1   75  140
early stop counter: 1
val acc:0.8470497131347656, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 24,now: 2024-07-29 00:52:34.177707,epoch time: 0:02:42.174251,used: 0:49:50.476027,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892578, 'recall': 0.9893493, 'specificity': 0.9893493, 'f1': 0.98925734, 'auroc': 0.999365, 'binary_precision': 0.99609375, 'binary_recall': 0.982659, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9893307}
confusion matrix:
      0     1
0  1509     6
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.8330745, 'precision': 0.85150373, 'recall': 0.83146834, 'specificity': 0.83146834, 'f1': 0.8303577, 'auroc': 0.93379307, 'binary_precision': 0.9285714, 'binary_recall': 0.71653545, 'binary_specificity': 0.94640124, 'binary_f1_score': 0.8088889}
confusion matrix:
     0    1
0  618   35
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.85485053, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8325279, 'auroc': 0.92542994, 'binary_precision': 0.9390244, 'binary_recall': 0.7162791, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.8126649}
confusion matrix:
     0    1
0  205   10
1   61  154
early stop counter: 2
val acc:0.8330745100975037, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 25,now: 2024-07-29 00:55:16.786984,epoch time: 0:02:42.609277,used: 0:52:33.085304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912198, 'recall': 0.99129415, 'specificity': 0.99129415, 'f1': 0.99121064, 'auroc': 0.9998627, 'binary_precision': 0.9980443, 'binary_recall': 0.9845659, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9912593}
confusion matrix:
      0     1
0  1514     3
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.632764, 'precision': 0.7541415, 'recall': 0.62786293, 'specificity': 0.62786293, 'f1': 0.57826763, 'auroc': 0.8824812, 'binary_precision': 0.9263158, 'binary_recall': 0.27716535, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.42666668}
confusion matrix:
     0    1
0  639   14
1  459  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59302324, 'precision': 0.76386845, 'recall': 0.59302324, 'specificity': 0.59302324, 'f1': 0.5144253, 'auroc': 0.9108058, 'binary_precision': 0.97619045, 'binary_recall': 0.19069767, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.31906614}
confusion matrix:
     0   1
0  214   1
1  174  41
early stop counter: 3
val acc:0.6327639818191528, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 26,now: 2024-07-29 00:58:01.409323,epoch time: 0:02:44.622339,used: 0:55:17.707643,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98595357, 'recall': 0.98554975, 'specificity': 0.98554975, 'f1': 0.9856696, 'auroc': 0.99964726, 'binary_precision': 0.97728705, 'binary_recall': 0.9948619, 'binary_specificity': 0.9762376, 'binary_f1_score': 0.9859962}
confusion matrix:
      0     1
0  1479    36
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.8819876, 'precision': 0.8826342, 'recall': 0.8817041, 'specificity': 0.8817041, 'f1': 0.8818619, 'auroc': 0.93289113, 'binary_precision': 0.89525366, 'binary_recall': 0.8614173, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8780096}
confusion matrix:
     0    1
0  589   64
1   88  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.821574, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.80746543, 'auroc': 0.89520824, 'binary_precision': 0.88439304, 'binary_recall': 0.7116279, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.7886598}
confusion matrix:
     0    1
0  195   20
1   62  153
early stop counter: 4
val acc:0.8819875717163086, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 27,now: 2024-07-29 01:00:42.510387,epoch time: 0:02:41.101064,used: 0:57:58.808707,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99457765, 'recall': 0.99439836, 'specificity': 0.99439836, 'f1': 0.9944643, 'auroc': 0.9999478, 'binary_precision': 0.9898219, 'binary_recall': 0.99935776, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.99456704}
confusion matrix:
      0     1
0  1499    16
1     1  1556
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.7977734, 'recall': 0.75917935, 'specificity': 0.75917935, 'f1': 0.75299823, 'auroc': 0.90145123, 'binary_precision': 0.89805824, 'binary_recall': 0.5826772, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.7067813}
confusion matrix:
     0    1
0  611   42
1  265  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.8564894, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8349781, 'auroc': 0.93466735, 'binary_precision': 0.93939394, 'binary_recall': 0.7209302, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.81578946}
confusion matrix:
     0    1
0  205   10
1   60  155
early stop counter: 5
val acc:0.7616459727287292, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 28,now: 2024-07-29 01:03:23.490726,epoch time: 0:02:40.980339,used: 1:00:39.789046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873718, 'recall': 0.98725593, 'specificity': 0.98725593, 'f1': 0.9873012, 'auroc': 0.9993387, 'binary_precision': 0.9840459, 'binary_recall': 0.99100256, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.98751193}
confusion matrix:
      0     1
0  1491    25
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.8662862, 'recall': 0.8389951, 'specificity': 0.8389951, 'f1': 0.8374858, 'auroc': 0.9391452, 'binary_precision': 0.9594017, 'binary_recall': 0.7070866, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.81414324}
confusion matrix:
     0    1
0  634   19
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.86564624, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8098613, 'auroc': 0.92030287, 'binary_precision': 1.0, 'binary_recall': 0.63255817, 'binary_specificity': 1.0, 'binary_f1_score': 0.7749288}
confusion matrix:
     0    1
0  215    0
1   79  136
early stop counter: 6
val acc:0.8408384919166565, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 29,now: 2024-07-29 01:05:57.336724,epoch time: 0:02:33.845998,used: 1:03:13.635044,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957633, 'recall': 0.9957719, 'specificity': 0.9957719, 'f1': 0.9957675, 'auroc': 0.999838, 'binary_precision': 0.99614394, 'binary_recall': 0.9955042, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9958239}
confusion matrix:
      0     1
0  1509     6
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.81444097, 'precision': 0.8516573, 'recall': 0.81215835, 'specificity': 0.81215835, 'f1': 0.8086002, 'auroc': 0.94407403, 'binary_precision': 0.9626168, 'binary_recall': 0.6488189, 'binary_specificity': 0.9754977, 'binary_f1_score': 0.77516466}
confusion matrix:
     0    1
0  637   16
1  223  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8516058, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7868217, 'auroc': 0.9494592, 'binary_precision': 0.99224806, 'binary_recall': 0.59534883, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.74418604}
confusion matrix:
     0    1
0  214    1
1   87  128
early stop counter: 7
val acc:0.8144409656524658, best validation acc: 0.8982919454574585, corresponding to test acc:                         0.8837209343910217 / 0.8860465288162231
after epoch: 30,now: 2024-07-29 01:07:54.266455,epoch time: 0:01:56.929731,used: 1:05:10.564775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_02_43_seed_0_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:05:10.564775 at 2024-07-29 01:07:54.266455
persisted model performance metric: 

scalar performance:
{'acc': 0.88372093, 'precision': 0.90049446, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8824905, 'auroc': 0.94249856, 'binary_precision': 0.98245615, 'binary_recall': 0.7813954, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8704663}
confusion matrix:
     0    1
0  212    3
1   47  168
oracle model performance metric: 

scalar performance:
{'acc': 0.8860465, 'precision': 0.8874631, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.8859423, 'auroc': 0.95580316, 'binary_precision': 0.86403507, 'binary_recall': 0.9162791, 'binary_specificity': 0.855814, 'binary_f1_score': 0.88939047}
confusion matrix:
     0    1
0  184   31
1   18  197
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457386 KiB |  13219 MiB |  73409 GiB |  73408 GiB |
|       from large pool | 416794 KiB |  13181 MiB |  72542 GiB |  72541 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457386 KiB |  13219 MiB |  73409 GiB |  73408 GiB |
|       from large pool | 416794 KiB |  13181 MiB |  72542 GiB |  72541 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73339 GiB |  73338 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72473 GiB |  72473 GiB |
|       from small pool |  40405 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14488 MiB |  14488 MiB |  14488 MiB |      0 B   |
|       from large pool |  14422 MiB |  14422 MiB |  14422 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 417109 KiB |   1260 MiB |  54377 GiB |  54376 GiB |
|       from large pool | 406502 KiB |   1252 MiB |  53505 GiB |  53505 GiB |
|       from small pool |  10607 KiB |     17 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12909 K  |   12908 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6347 K  |    6346 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12909 K  |   12908 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6347 K  |    6346 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |     635    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      86    |     653    |    8596 K  |    8596 K  |
|       from large pool |      30    |     604    |    4792 K  |    4792 K  |
|       from small pool |      56    |     233    |    3803 K  |    3803 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72473 GiB |  72473 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14488 MiB |  14488 MiB |  13634 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool |  24320 KiB |   1252 MiB |  53506 GiB |  53505 GiB |
|       from small pool |      0 KiB |     41 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     635    |     635    |     574    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |    8596 K  |    8596 K  |
|       from large pool |       3    |     604    |    4792 K  |    4792 K  |
|       from small pool |       0    |     233    |    3803 K  |    3803 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72473 GiB |  72473 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14488 MiB |  14488 MiB |  13634 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool |  24320 KiB |   1252 MiB |  53506 GiB |  53505 GiB |
|       from small pool |      0 KiB |     41 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     635    |     635    |     574    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |    8596 K  |    8596 K  |
|       from large pool |       3    |     604    |    4792 K  |    4792 K  |
|       from small pool |       0    |     233    |    3803 K  |    3803 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368

 Experiment start at: 2024-07-29 01:08:58.048419
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.9661294, 'recall': 0.9661705, 'specificity': 0.9661705, 'f1': 0.9661434, 'auroc': 0.9942934, 'binary_precision': 0.96893203, 'binary_recall': 0.96394074, 'binary_specificity': 0.96840024, 'binary_f1_score': 0.96642995}
confusion matrix:
      0     1
0  1471    48
1    56  1497
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.82486373, 'recall': 0.82468, 'specificity': 0.82468, 'f1': 0.82434916, 'auroc': 0.9000511, 'binary_precision': 0.80728376, 'binary_recall': 0.84444445, 'binary_specificity': 0.8049155, 'binary_f1_score': 0.8254461}
confusion matrix:
     0    1
0  524  127
1   98  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8115587, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.8033216, 'auroc': 0.915437, 'binary_precision': 0.76447874, 'binary_recall': 0.88, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.81818175}
confusion matrix:
     0    1
0  164   61
1   27  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 01:11:22.133451,epoch time: 0:02:24.085032,used: 0:02:24.085032,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.96068156, 'recall': 0.95939267, 'specificity': 0.95939267, 'f1': 0.9595926, 'auroc': 0.995738, 'binary_precision': 0.9413218, 'binary_recall': 0.98132646, 'binary_specificity': 0.9374589, 'binary_f1_score': 0.96090794}
confusion matrix:
      0     1
0  1424    95
1    29  1524
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.81027687, 'recall': 0.80865335, 'specificity': 0.80865335, 'f1': 0.8078022, 'auroc': 0.8740618, 'binary_precision': 0.7790698, 'binary_recall': 0.85079366, 'binary_specificity': 0.76651305, 'binary_f1_score': 0.81335354}
confusion matrix:
     0    1
0  499  152
1   94  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8233806, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.814433, 'auroc': 0.9195062, 'binary_precision': 0.77307695, 'binary_recall': 0.8933333, 'binary_specificity': 0.73777777, 'binary_f1_score': 0.82886606}
confusion matrix:
     0    1
0  166   59
1   24  201
new oracle model saved
early stop counter: 1
val acc:0.8079625368118286, best validation acc: 0.824355959892273, corresponding to test acc:                         0.804444432258606 / 0.8155555725097656
after epoch: 2,now: 2024-07-29 01:14:11.996485,epoch time: 0:02:49.863034,used: 0:05:13.948066,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9789504, 'recall': 0.9789859, 'specificity': 0.9789859, 'f1': 0.97884107, 'auroc': 0.99766076, 'binary_precision': 0.99013805, 'binary_recall': 0.9678663, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9788755}
confusion matrix:
      0     1
0  1501    15
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.83752334, 'recall': 0.8364568, 'specificity': 0.8364568, 'f1': 0.8366168, 'auroc': 0.9071245, 'binary_precision': 0.8490879, 'binary_recall': 0.8126984, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.8304947}
confusion matrix:
     0    1
0  560   91
1  118  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85403264, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8532609, 'auroc': 0.9158124, 'binary_precision': 0.8697674, 'binary_recall': 0.83111113, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.84999996}
confusion matrix:
     0    1
0  197   28
1   38  187
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 01:15:45.249432,epoch time: 0:01:33.252947,used: 0:06:47.201013,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9716514, 'recall': 0.9715714, 'specificity': 0.9715714, 'f1': 0.971354, 'auroc': 0.9981593, 'binary_precision': 0.9873922, 'binary_recall': 0.955684, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.97127944}
confusion matrix:
      0     1
0  1496    19
1    69  1488
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.83928484, 'recall': 0.8054532, 'specificity': 0.8054532, 'f1': 0.80250216, 'auroc': 0.9192646, 'binary_precision': 0.93835616, 'binary_recall': 0.65238094, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.7696629}
confusion matrix:
     0    1
0  624   27
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8768722, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8410247, 'auroc': 0.9400296, 'binary_precision': 0.9874214, 'binary_recall': 0.69777775, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8177083}
confusion matrix:
     0    1
0  223    2
1   68  157
early stop counter: 1
val acc:0.8079625368118286, best validation acc: 0.8368462324142456, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 4,now: 2024-07-29 01:18:10.789998,epoch time: 0:02:25.540566,used: 0:09:12.741579,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97620416, 'recall': 0.9757802, 'specificity': 0.9757802, 'f1': 0.975899, 'auroc': 0.99824154, 'binary_precision': 0.9672131, 'binary_recall': 0.9858612, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9764481}
confusion matrix:
      0     1
0  1464    52
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.87822014, 'precision': 0.8781874, 'recall': 0.8781874, 'specificity': 0.8781874, 'f1': 0.8781874, 'auroc': 0.92548704, 'binary_precision': 0.8761905, 'binary_recall': 0.8761905, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.87619054}
confusion matrix:
     0    1
0  573   78
1   78  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85403264, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8532609, 'auroc': 0.92847407, 'binary_precision': 0.83829784, 'binary_recall': 0.8755556, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.8565218}
confusion matrix:
     0    1
0  187   38
1   28  197
better model found
persisted
after epoch: 5,now: 2024-07-29 01:20:41.339304,epoch time: 0:02:30.549306,used: 0:11:43.290885,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97759956, 'recall': 0.97765243, 'specificity': 0.97765243, 'f1': 0.9775389, 'auroc': 0.9971801, 'binary_precision': 0.98689383, 'binary_recall': 0.96848875, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9776047}
confusion matrix:
      0     1
0  1497    20
1    49  1506
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.8395003, 'recall': 0.80463386, 'specificity': 0.80463386, 'f1': 0.8015392, 'auroc': 0.9234657, 'binary_precision': 0.9402299, 'binary_recall': 0.64920634, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.76807505}
confusion matrix:
     0    1
0  625   26
1  221  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8671465, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8319404, 'auroc': 0.93617773, 'binary_precision': 0.9748428, 'binary_recall': 0.6888889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8072917}
confusion matrix:
     0    1
0  221    4
1   70  155
early stop counter: 1
val acc:0.8071818947792053, best validation acc: 0.8782201409339905, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 6,now: 2024-07-29 01:22:32.724762,epoch time: 0:01:51.385458,used: 0:13:34.676343,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9823301, 'recall': 0.98228407, 'specificity': 0.98228407, 'f1': 0.9820963, 'auroc': 0.99913263, 'binary_precision': 0.9966909, 'binary_recall': 0.9678663, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98206717}
confusion matrix:
      0     1
0  1511     5
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.6299766, 'precision': 0.7458223, 'recall': 0.62424475, 'specificity': 0.62424475, 'f1': 0.57492507, 'auroc': 0.89399034, 'binary_precision': 0.91052634, 'binary_recall': 0.2746032, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.42195123}
confusion matrix:
     0    1
0  634   17
1  457  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83732057, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.80995476, 'auroc': 0.9084444, 'binary_precision': 0.92727274, 'binary_recall': 0.68, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.78461546}
confusion matrix:
     0    1
0  213   12
1   72  153
early stop counter: 2
val acc:0.6299765706062317, best validation acc: 0.8782201409339905, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 7,now: 2024-07-29 01:24:26.800525,epoch time: 0:01:54.075763,used: 0:15:28.752106,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9819491, 'recall': 0.98167944, 'specificity': 0.98167944, 'f1': 0.98176384, 'auroc': 0.9990233, 'binary_precision': 0.9752695, 'binary_recall': 0.9890675, 'binary_specificity': 0.9742914, 'binary_f1_score': 0.98212004}
confusion matrix:
      0     1
0  1478    39
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.87431693, 'precision': 0.87473434, 'recall': 0.87403995, 'specificity': 0.87403995, 'f1': 0.87419426, 'auroc': 0.921064, 'binary_precision': 0.88379705, 'binary_recall': 0.85714287, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.87026596}
confusion matrix:
     0    1
0  580   71
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88, 'precision': 0.88003004, 'recall': 0.88, 'specificity': 0.88, 'f1': 0.8799976, 'auroc': 0.93187165, 'binary_precision': 0.88340807, 'binary_recall': 0.8755556, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8794643}
confusion matrix:
     0    1
0  199   26
1   28  197
new oracle model saved
early stop counter: 3
val acc:0.874316930770874, best validation acc: 0.8782201409339905, corresponding to test acc:                         0.8533333539962769 / 0.8799999952316284
after epoch: 8,now: 2024-07-29 01:26:54.472519,epoch time: 0:02:27.671994,used: 0:17:56.424100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97845644, 'recall': 0.9781189, 'specificity': 0.9781189, 'f1': 0.97786295, 'auroc': 0.9991361, 'binary_precision': 0.9986586, 'binary_recall': 0.95755625, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97767556}
confusion matrix:
      0     1
0  1515     2
1    66  1489
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.7689331, 'recall': 0.64234513, 'specificity': 0.64234513, 'f1': 0.59836864, 'auroc': 0.90835774, 'binary_precision': 0.94527364, 'binary_recall': 0.3015873, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.4572804}
confusion matrix:
     0    1
0  640   11
1  440  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7822945, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.62863934, 'auroc': 0.8971654, 'binary_precision': 0.962963, 'binary_recall': 0.34666666, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.5098039}
confusion matrix:
     0   1
0  222   3
1  147  78
early stop counter: 4
val acc:0.6479312777519226, best validation acc: 0.8782201409339905, corresponding to test acc:                         0.8533333539962769 / 0.8799999952316284
after epoch: 9,now: 2024-07-29 01:29:29.870940,epoch time: 0:02:35.398421,used: 0:20:31.822521,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.985996, 'recall': 0.9860045, 'specificity': 0.9860045, 'f1': 0.98600006, 'auroc': 0.9989469, 'binary_precision': 0.98650384, 'binary_recall': 0.98587024, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.9861869}
confusion matrix:
      0     1
0  1494    21
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.8790008, 'precision': 0.8819423, 'recall': 0.8782898, 'specificity': 0.8782898, 'f1': 0.8785956, 'auroc': 0.9287982, 'binary_precision': 0.9116118, 'binary_recall': 0.83492064, 'binary_specificity': 0.921659, 'binary_f1_score': 0.8715824}
confusion matrix:
     0    1
0  600   51
1  104  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8427078, 'recall': 0.84, 'specificity': 0.84, 'f1': 0.83968335, 'auroc': 0.9030864, 'binary_precision': 0.87317073, 'binary_recall': 0.79555553, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8325582}
confusion matrix:
     0    1
0  199   26
1   46  179
better model found
persisted
after epoch: 10,now: 2024-07-29 01:31:19.642980,epoch time: 0:01:49.772040,used: 0:22:21.594561,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98957485, 'recall': 0.9895898, 'specificity': 0.9895898, 'f1': 0.98958194, 'auroc': 0.99964476, 'binary_precision': 0.99034125, 'binary_recall': 0.9890675, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.989704}
confusion matrix:
      0     1
0  1502    15
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.8758782, 'precision': 0.8770608, 'recall': 0.8754224, 'specificity': 0.8754224, 'f1': 0.87565726, 'auroc': 0.9238138, 'binary_precision': 0.89447236, 'binary_recall': 0.84761906, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.8704156}
confusion matrix:
     0    1
0  588   63
1   96  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8359803, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8355036, 'auroc': 0.9101629, 'binary_precision': 0.84792626, 'binary_recall': 0.81777775, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.83257914}
confusion matrix:
     0    1
0  192   33
1   41  184
early stop counter: 1
val acc:0.8758782148361206, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8399999737739563 / 0.8799999952316284
after epoch: 11,now: 2024-07-29 01:32:50.040264,epoch time: 0:01:30.397284,used: 0:23:51.991845,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98073745, 'recall': 0.9806788, 'specificity': 0.9806788, 'f1': 0.98046875, 'auroc': 0.9989609, 'binary_precision': 0.99602383, 'binary_recall': 0.9653179, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.98043054}
confusion matrix:
      0     1
0  1509     6
1    54  1503
---- Validation: 
scalar performance:
{'acc': 0.87822014, 'precision': 0.88170946, 'recall': 0.877445, 'specificity': 0.877445, 'f1': 0.87775517, 'auroc': 0.93163145, 'binary_precision': 0.91433567, 'binary_recall': 0.8301587, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.87021625}
confusion matrix:
     0    1
0  602   49
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8507085, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.841262, 'auroc': 0.9081876, 'binary_precision': 0.9052632, 'binary_recall': 0.7644445, 'binary_specificity': 0.92, 'binary_f1_score': 0.8289157}
confusion matrix:
     0    1
0  207   18
1   53  172
early stop counter: 2
val acc:0.8782201409339905, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8399999737739563 / 0.8799999952316284
after epoch: 12,now: 2024-07-29 01:35:23.990049,epoch time: 0:02:33.949785,used: 0:26:25.941630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9862091, 'recall': 0.9861825, 'specificity': 0.9861825, 'f1': 0.98600256, 'auroc': 0.999454, 'binary_precision': 1.0, 'binary_recall': 0.972365, 'binary_specificity': 1.0, 'binary_f1_score': 0.9859889}
confusion matrix:
      0     1
0  1516     0
1    43  1513
---- Validation: 
scalar performance:
{'acc': 0.73770493, 'precision': 0.81684625, 'recall': 0.7335638, 'specificity': 0.7335638, 'f1': 0.7179524, 'auroc': 0.9253621, 'binary_precision': 0.97115386, 'binary_recall': 0.48095238, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.6433121}
confusion matrix:
     0    1
0  642    9
1  327  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8472804, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.7769333, 'auroc': 0.93471605, 'binary_precision': 0.99236643, 'binary_recall': 0.5777778, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.73033714}
confusion matrix:
     0    1
0  224    1
1   95  130
early stop counter: 3
val acc:0.7377049326896667, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8399999737739563 / 0.8799999952316284
after epoch: 13,now: 2024-07-29 01:37:35.743226,epoch time: 0:02:11.753177,used: 0:28:37.694807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98200333, 'recall': 0.98166335, 'specificity': 0.98166335, 'f1': 0.9817629, 'auroc': 0.99904275, 'binary_precision': 0.97406703, 'binary_recall': 0.9903537, 'binary_specificity': 0.972973, 'binary_f1_score': 0.9821428}
confusion matrix:
      0     1
0  1476    41
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.85097265, 'recall': 0.85104966, 'specificity': 0.85104966, 'f1': 0.85089445, 'auroc': 0.89657664, 'binary_precision': 0.8403101, 'binary_recall': 0.86031747, 'binary_specificity': 0.84178185, 'binary_f1_score': 0.8501961}
confusion matrix:
     0    1
0  548  103
1   88  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8261266, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8166041, 'auroc': 0.9029333, 'binary_precision': 0.77394634, 'binary_recall': 0.8977778, 'binary_specificity': 0.73777777, 'binary_f1_score': 0.83127576}
confusion matrix:
     0    1
0  166   59
1   23  202
early stop counter: 4
val acc:0.8508977293968201, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8399999737739563 / 0.8799999952316284
after epoch: 14,now: 2024-07-29 01:39:58.040453,epoch time: 0:02:22.297227,used: 0:30:59.992034,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905424, 'recall': 0.99059296, 'specificity': 0.99059296, 'f1': 0.99055916, 'auroc': 0.99950147, 'binary_precision': 0.99352753, 'binary_recall': 0.9877735, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.99064213}
confusion matrix:
      0     1
0  1508    10
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.8757785, 'recall': 0.86190474, 'specificity': 0.86190474, 'f1': 0.8618766, 'auroc': 0.932981, 'binary_precision': 0.9400387, 'binary_recall': 0.7714286, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.8474281}
confusion matrix:
     0    1
0  620   31
1  144  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8624835, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8449756, 'auroc': 0.91537786, 'binary_precision': 0.93820226, 'binary_recall': 0.74222225, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.82878417}
confusion matrix:
     0    1
0  214   11
1   58  167
early stop counter: 5
val acc:0.8633880019187927, best validation acc: 0.8790007829666138, corresponding to test acc:                         0.8399999737739563 / 0.8799999952316284
after epoch: 15,now: 2024-07-29 01:41:58.616821,epoch time: 0:02:00.576368,used: 0:33:00.568402,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934706, 'recall': 0.9935208, 'specificity': 0.9935208, 'f1': 0.99348897, 'auroc': 0.99972785, 'binary_precision': 0.9961215, 'binary_recall': 0.9909968, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.99355257}
confusion matrix:
      0     1
0  1511     6
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.8866621, 'recall': 0.8786994, 'specificity': 0.8786994, 'f1': 0.8789992, 'auroc': 0.9291835, 'binary_precision': 0.93430656, 'binary_recall': 0.8126984, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.86926997}
confusion matrix:
     0    1
0  615   36
1  118  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.86869746, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84434134, 'auroc': 0.9290864, 'binary_precision': 0.9588235, 'binary_recall': 0.72444445, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8253164}
confusion matrix:
     0    1
0  218    7
1   62  163
better model found
persisted
after epoch: 16,now: 2024-07-29 01:44:35.071096,epoch time: 0:02:36.454275,used: 0:35:37.022677,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99156713, 'recall': 0.99150956, 'specificity': 0.99150956, 'f1': 0.9915346, 'auroc': 0.99956214, 'binary_precision': 0.9897567, 'binary_recall': 0.99357325, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99166125}
confusion matrix:
      0     1
0  1500    16
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.88055015, 'recall': 0.8794163, 'specificity': 0.8794163, 'f1': 0.8796194, 'auroc': 0.9292859, 'binary_precision': 0.89403975, 'binary_recall': 0.85714287, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.87520266}
confusion matrix:
     0    1
0  587   64
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8753821, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.8707434, 'auroc': 0.92383206, 'binary_precision': 0.91542286, 'binary_recall': 0.81777775, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  208   17
1   41  184
early stop counter: 1
val acc:0.8797814249992371, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.846666693687439 / 0.8799999952316284
after epoch: 17,now: 2024-07-29 01:46:06.376737,epoch time: 0:01:31.305641,used: 0:37:08.328318,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98901296, 'recall': 0.98906606, 'specificity': 0.98906606, 'f1': 0.98893213, 'auroc': 0.99987113, 'binary_precision': 0.9993438, 'binary_recall': 0.9787918, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.988961}
confusion matrix:
      0     1
0  1515     1
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.7689305, 'precision': 0.8293941, 'recall': 0.7653866, 'specificity': 0.7653866, 'f1': 0.7561745, 'auroc': 0.9247879, 'binary_precision': 0.96648043, 'binary_recall': 0.5492064, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.70040494}
confusion matrix:
     0    1
0  639   12
1  284  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8586772, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8072412, 'auroc': 0.9315951, 'binary_precision': 0.9862069, 'binary_recall': 0.63555557, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.77297294}
confusion matrix:
     0    1
0  223    2
1   82  143
early stop counter: 2
val acc:0.7689304947853088, best validation acc: 0.8797814249992371, corresponding to test acc:                         0.846666693687439 / 0.8799999952316284
after epoch: 18,now: 2024-07-29 01:47:42.200274,epoch time: 0:01:35.823537,used: 0:38:44.151855,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892823, 'recall': 0.98923355, 'specificity': 0.98923355, 'f1': 0.9892553, 'auroc': 0.9991572, 'binary_precision': 0.9878361, 'binary_recall': 0.99100834, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.9894197}
confusion matrix:
      0     1
0  1496    19
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.8844653, 'precision': 0.88930845, 'recall': 0.88356376, 'specificity': 0.88356376, 'f1': 0.8839048, 'auroc': 0.91549015, 'binary_precision': 0.9288256, 'binary_recall': 0.82857144, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.87583894}
confusion matrix:
     0    1
0  611   40
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8677126, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8665718, 'auroc': 0.9325235, 'binary_precision': 0.84810126, 'binary_recall': 0.8933333, 'binary_specificity': 0.84, 'binary_f1_score': 0.8701298}
confusion matrix:
     0    1
0  189   36
1   24  201
better model found
persisted
after epoch: 19,now: 2024-07-29 01:49:19.557692,epoch time: 0:01:37.357418,used: 0:40:21.509273,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9904896, 'recall': 0.9901111, 'specificity': 0.9901111, 'f1': 0.99022925, 'auroc': 0.99973464, 'binary_precision': 0.9823232, 'binary_recall': 0.9987163, 'binary_specificity': 0.98150593, 'binary_f1_score': 0.99045193}
confusion matrix:
      0     1
0  1486    28
1     2  1556
---- Validation: 
scalar performance:
{'acc': 0.8868072, 'precision': 0.8890178, 'recall': 0.88620067, 'specificity': 0.88620067, 'f1': 0.88650596, 'auroc': 0.93413067, 'binary_precision': 0.9145299, 'binary_recall': 0.8492063, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.88065845}
confusion matrix:
     0    1
0  601   50
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9066667, 'precision': 0.9121704, 'recall': 0.90666664, 'specificity': 0.90666664, 'f1': 0.90635407, 'auroc': 0.9435456, 'binary_precision': 0.959799, 'binary_recall': 0.8488889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.9009434}
confusion matrix:
     0    1
0  217    8
1   34  191
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-29 01:51:01.103698,epoch time: 0:01:41.546006,used: 0:42:03.055279,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.98084056, 'recall': 0.97955143, 'specificity': 0.97955143, 'f1': 0.97979546, 'auroc': 0.99992794, 'binary_precision': 0.96168107, 'binary_recall': 1.0, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.98046625}
confusion matrix:
      0     1
0  1454    62
1     0  1556
---- Validation: 
scalar performance:
{'acc': 0.89071035, 'precision': 0.8916327, 'recall': 0.89032257, 'specificity': 0.89032257, 'f1': 0.89055014, 'auroc': 0.9271255, 'binary_precision': 0.90697676, 'binary_recall': 0.8666667, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.88636357}
confusion matrix:
     0    1
0  595   56
1   84  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8740667, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.87085605, 'auroc': 0.9286716, 'binary_precision': 0.9073171, 'binary_recall': 0.82666665, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8651163}
confusion matrix:
     0    1
0  206   19
1   39  186
better model found
persisted
after epoch: 21,now: 2024-07-29 01:52:42.446392,epoch time: 0:01:41.342694,used: 0:43:44.397973,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9958203, 'recall': 0.99573135, 'specificity': 0.99573135, 'f1': 0.99576724, 'auroc': 0.99992704, 'binary_precision': 0.9929668, 'binary_recall': 0.99871385, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.995832}
confusion matrix:
      0     1
0  1506    11
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.8797814, 'precision': 0.88601863, 'recall': 0.8787507, 'specificity': 0.8787507, 'f1': 0.8790591, 'auroc': 0.9290688, 'binary_precision': 0.93115944, 'binary_recall': 0.815873, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.8697124}
confusion matrix:
     0    1
0  613   38
1  116  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.87699854, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86818, 'auroc': 0.94010866, 'binary_precision': 0.9322917, 'binary_recall': 0.79555553, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8585132}
confusion matrix:
     0    1
0  212   13
1   46  179
early stop counter: 1
val acc:0.8797814249992371, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 22,now: 2024-07-29 01:54:24.226092,epoch time: 0:01:41.779700,used: 0:45:26.177673,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9855584, 'recall': 0.9855677, 'specificity': 0.9855677, 'f1': 0.98535156, 'auroc': 0.99983084, 'binary_precision': 1.0, 'binary_recall': 0.9711353, 'binary_specificity': 1.0, 'binary_f1_score': 0.9853563}
confusion matrix:
      0     1
0  1513     0
1    45  1514
---- Validation: 
scalar performance:
{'acc': 0.6167057, 'precision': 0.7655307, 'recall': 0.61047107, 'specificity': 0.61047107, 'f1': 0.5478155, 'auroc': 0.92745656, 'binary_precision': 0.9602649, 'binary_recall': 0.23015873, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.37131885}
confusion matrix:
     0    1
0  645    6
1  485  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6488889, 'precision': 0.7867169, 'recall': 0.6488889, 'specificity': 0.6488889, 'f1': 0.6009295, 'auroc': 0.90924937, 'binary_precision': 0.98550725, 'binary_recall': 0.30222222, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.46258503}
confusion matrix:
     0   1
0  224   1
1  157  68
early stop counter: 2
val acc:0.6167057156562805, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 23,now: 2024-07-29 01:55:59.481465,epoch time: 0:01:35.255373,used: 0:47:01.433046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9973958, 'precision': 0.997382, 'recall': 0.9974123, 'specificity': 0.9974123, 'f1': 0.99739546, 'auroc': 0.99994695, 'binary_precision': 0.99871135, 'binary_recall': 0.99614394, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.997426}
confusion matrix:
      0     1
0  1514     2
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.86885244, 'precision': 0.8807882, 'recall': 0.8674091, 'specificity': 0.8674091, 'f1': 0.86746645, 'auroc': 0.9352492, 'binary_precision': 0.9442308, 'binary_recall': 0.77936506, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.85391307}
confusion matrix:
     0    1
0  622   29
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8706433, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8341001, 'auroc': 0.91960496, 'binary_precision': 0.98101264, 'binary_recall': 0.6888889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8093995}
confusion matrix:
     0    1
0  222    3
1   70  155
early stop counter: 3
val acc:0.868852436542511, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 24,now: 2024-07-29 01:57:38.377988,epoch time: 0:01:38.896523,used: 0:48:40.329569,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99315774, 'recall': 0.99321723, 'specificity': 0.99321723, 'f1': 0.9931638, 'auroc': 0.99984145, 'binary_precision': 0.99804944, 'binary_recall': 0.9884095, 'binary_specificity': 0.998025, 'binary_f1_score': 0.993206}
confusion matrix:
      0     1
0  1516     3
1    18  1535
---- Validation: 
scalar performance:
{'acc': 0.668228, 'precision': 0.7832233, 'recall': 0.6629288, 'specificity': 0.6629288, 'f1': 0.62653756, 'auroc': 0.9335442, 'binary_precision': 0.9596413, 'binary_recall': 0.33968255, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.5017585}
confusion matrix:
     0    1
0  642    9
1  416  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8428122, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7667137, 'auroc': 0.93695307, 'binary_precision': 0.992126, 'binary_recall': 0.56, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7159091}
confusion matrix:
     0    1
0  224    1
1   99  126
early stop counter: 4
val acc:0.6682279706001282, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 25,now: 2024-07-29 01:59:18.377597,epoch time: 0:01:39.999609,used: 0:50:20.329178,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.993152, 'recall': 0.9931803, 'specificity': 0.9931803, 'f1': 0.9931636, 'auroc': 0.999827, 'binary_precision': 0.9948287, 'binary_recall': 0.9916237, 'binary_specificity': 0.99473685, 'binary_f1_score': 0.99322367}
confusion matrix:
      0     1
0  1512     8
1    13  1539
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.8512036, 'recall': 0.8237071, 'specificity': 0.8237071, 'f1': 0.82200134, 'auroc': 0.9240247, 'binary_precision': 0.94143164, 'binary_recall': 0.6888889, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.79560035}
confusion matrix:
     0    1
0  624   27
1  196  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8428122, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7667137, 'auroc': 0.9074173, 'binary_precision': 0.992126, 'binary_recall': 0.56, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7159091}
confusion matrix:
     0    1
0  224    1
1   99  126
early stop counter: 5
val acc:0.8259172439575195, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 26,now: 2024-07-29 02:00:57.937772,epoch time: 0:01:39.560175,used: 0:51:59.889353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925348, 'recall': 0.9924941, 'specificity': 0.9924941, 'f1': 0.9925118, 'auroc': 0.9997999, 'binary_precision': 0.9910141, 'binary_recall': 0.99420476, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.9926069}
confusion matrix:
      0     1
0  1505    14
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.785324, 'precision': 0.82988644, 'recall': 0.78228366, 'specificity': 0.78228366, 'f1': 0.7765384, 'auroc': 0.93080366, 'binary_precision': 0.94710326, 'binary_recall': 0.5968254, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.7322298}
confusion matrix:
     0    1
0  630   21
1  254  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8751316, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.83363634, 'auroc': 0.9418271, 'binary_precision': 0.9935065, 'binary_recall': 0.68, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.8073879}
confusion matrix:
     0    1
0  224    1
1   72  153
early stop counter: 6
val acc:0.785323977470398, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 27,now: 2024-07-29 02:02:34.803136,epoch time: 0:01:36.865364,used: 0:53:36.754717,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934717, 'recall': 0.9935478, 'specificity': 0.9935478, 'f1': 0.99348915, 'auroc': 0.9997872, 'binary_precision': 0.9980545, 'binary_recall': 0.9890745, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9935443}
confusion matrix:
      0     1
0  1513     3
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.7681499, 'precision': 0.8196821, 'recall': 0.7648233, 'specificity': 0.7648233, 'f1': 0.75686306, 'auroc': 0.9236724, 'binary_precision': 0.944, 'binary_recall': 0.5619048, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.7044776}
confusion matrix:
     0    1
0  630   21
1  276  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8403361, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8172703, 'auroc': 0.90797037, 'binary_precision': 0.9235294, 'binary_recall': 0.69777775, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.79493666}
confusion matrix:
     0    1
0  212   13
1   68  157
early stop counter: 7
val acc:0.7681499123573303, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 28,now: 2024-07-29 02:04:08.334434,epoch time: 0:01:33.531298,used: 0:55:10.286015,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957447, 'recall': 0.9958164, 'specificity': 0.9958164, 'f1': 0.9957678, 'auroc': 0.9998965, 'binary_precision': 0.9993532, 'binary_recall': 0.9922929, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9958105}
confusion matrix:
      0     1
0  1514     1
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8335366, 'recall': 0.78540707, 'specificity': 0.78540707, 'f1': 0.77978873, 'auroc': 0.91733474, 'binary_precision': 0.95214105, 'binary_recall': 0.6, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.73612463}
confusion matrix:
     0    1
0  632   19
1  252  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.86094224, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8351326, 'auroc': 0.90593576, 'binary_precision': 0.95238096, 'binary_recall': 0.7111111, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8142494}
confusion matrix:
     0    1
0  217    8
1   65  160
early stop counter: 8
val acc:0.7884465456008911, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 29,now: 2024-07-29 02:05:50.827433,epoch time: 0:01:42.492999,used: 0:56:52.779014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99541914, 'recall': 0.9954864, 'specificity': 0.9954864, 'f1': 0.99544215, 'auroc': 0.9998792, 'binary_precision': 0.9987072, 'binary_recall': 0.9922929, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.99548966}
confusion matrix:
      0     1
0  1513     2
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.8222858, 'recall': 0.75832057, 'specificity': 0.75832057, 'f1': 0.7484751, 'auroc': 0.92057395, 'binary_precision': 0.9577465, 'binary_recall': 0.53968257, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6903553}
confusion matrix:
     0    1
0  636   15
1  290  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.86088955, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8250097, 'auroc': 0.90652835, 'binary_precision': 0.9683544, 'binary_recall': 0.68, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  220    5
1   72  153
early stop counter: 9
val acc:0.761904776096344, best validation acc: 0.8907103538513184, corresponding to test acc:                         0.8711110949516296 / 0.9066666960716248
after epoch: 30,now: 2024-07-29 02:07:17.543867,epoch time: 0:01:26.716434,used: 0:58:19.495448,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_08_57_seed_1_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:58:19.495448 at 2024-07-29 02:07:17.543867
persisted model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8740667, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.87085605, 'auroc': 0.9286716, 'binary_precision': 0.9073171, 'binary_recall': 0.82666665, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8651163}
confusion matrix:
     0    1
0  206   19
1   39  186
oracle model performance metric: 

scalar performance:
{'acc': 0.9066667, 'precision': 0.9121704, 'recall': 0.90666664, 'specificity': 0.90666664, 'f1': 0.90635407, 'auroc': 0.9435456, 'binary_precision': 0.959799, 'binary_recall': 0.8488889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.9009434}
confusion matrix:
     0    1
0  217    8
1   34  191
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455482 KiB |  13219 MiB | 148643 GiB | 148642 GiB |
|       from large pool | 414883 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455482 KiB |  13219 MiB | 148643 GiB | 148642 GiB |
|       from large pool | 414883 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 146769 GiB | 146768 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14488 MiB |  28106 MiB |  13634 MiB |
|       from large pool |  14402 MiB |  14422 MiB |  28020 MiB |  13618 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 486598 KiB |   1260 MiB | 110441 GiB | 110440 GiB |
|       from large pool | 475996 KiB |   1252 MiB | 108672 GiB | 108671 GiB |
|       from small pool |  10601 KiB |     41 MiB |   1769 GiB |   1769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26107 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12825 K  |   12823 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26107 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12825 K  |   12823 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1210    |     574    |
|       from large pool |     601    |     602    |    1167    |     566    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     653    |   17857 K  |   17857 K  |
|       from large pool |      41    |     604    |   10094 K  |   10094 K  |
|       from small pool |      59    |     233    |    7762 K  |    7762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146769 GiB | 146769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14488 MiB |  28106 MiB |  27186 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 110441 GiB | 110441 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 108672 GiB | 108672 GiB |
|       from small pool |      0 KiB |     41 MiB |   1769 GiB |   1769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1210    |    1146    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   17857 K  |   17857 K  |
|       from large pool |       3    |     604    |   10094 K  |   10094 K  |
|       from small pool |       0    |     233    |    7762 K  |    7762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146769 GiB | 146769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14488 MiB |  28106 MiB |  27186 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 110441 GiB | 110441 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 108672 GiB | 108672 GiB |
|       from small pool |      0 KiB |     41 MiB |   1769 GiB |   1769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26107 K  |   26107 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1210    |    1146    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   17857 K  |   17857 K  |
|       from large pool |       3    |     604    |   10094 K  |   10094 K  |
|       from small pool |       0    |     233    |    7762 K  |    7762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368

 Experiment start at: 2024-07-29 02:07:55.344017
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9545157, 'precision': 0.9545152, 'recall': 0.95451033, 'specificity': 0.95451033, 'f1': 0.9545126, 'auroc': 0.9905741, 'binary_precision': 0.95457494, 'binary_recall': 0.95519483, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.95488477}
confusion matrix:
      0     1
0  1446    70
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.7881725, 'recall': 0.772486, 'specificity': 0.772486, 'f1': 0.7666433, 'auroc': 0.87733805, 'binary_precision': 0.7072243, 'binary_recall': 0.8971061, 'binary_specificity': 0.64786583, 'binary_f1_score': 0.7909284}
confusion matrix:
     0    1
0  425  231
1   64  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.76517856, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.68547505, 'auroc': 0.892254, 'binary_precision': 0.6375, 'binary_recall': 0.9444444, 'binary_specificity': 0.46296296, 'binary_f1_score': 0.761194}
confusion matrix:
     0    1
0  100  116
1   12  204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:09:39.218506,epoch time: 0:01:43.874489,used: 0:01:43.874489,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9744694, 'recall': 0.9744954, 'specificity': 0.9744954, 'f1': 0.97447574, 'auroc': 0.9964521, 'binary_precision': 0.9771541, 'binary_recall': 0.9720779, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.9746094}
confusion matrix:
      0     1
0  1481    35
1    43  1497
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.7884337, 'recall': 0.77862763, 'specificity': 0.77862763, 'f1': 0.77839816, 'auroc': 0.85602844, 'binary_precision': 0.82884616, 'binary_recall': 0.69292605, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.7548161}
confusion matrix:
     0    1
0  567   89
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.7500858, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7499786, 'auroc': 0.8578961, 'binary_precision': 0.754717, 'binary_recall': 0.7407407, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.74766356}
confusion matrix:
     0    1
0  164   52
1   56  160
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 02:11:09.682177,epoch time: 0:01:30.463671,used: 0:03:14.338160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.976795, 'recall': 0.9768144, 'specificity': 0.9768144, 'f1': 0.97676694, 'auroc': 0.9980066, 'binary_precision': 0.982906, 'binary_recall': 0.97077924, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9768049}
confusion matrix:
      0     1
0  1490    26
1    45  1495
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.7791516, 'recall': 0.6498927, 'specificity': 0.6498927, 'f1': 0.61006594, 'auroc': 0.8299961, 'binary_precision': 0.9558824, 'binary_recall': 0.31350482, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.47215495}
confusion matrix:
     0    1
0  647    9
1  427  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6736111, 'precision': 0.7359109, 'recall': 0.6736111, 'specificity': 0.6736111, 'f1': 0.65053964, 'auroc': 0.83095956, 'binary_precision': 0.85714287, 'binary_recall': 0.41666666, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.5607477}
confusion matrix:
     0   1
0  201  15
1  126  90
early stop counter: 1
val acc:0.6588419675827026, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.75
after epoch: 3,now: 2024-07-29 02:12:48.653130,epoch time: 0:01:38.970953,used: 0:04:53.309113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98266506, 'recall': 0.9826483, 'specificity': 0.9826483, 'f1': 0.98265576, 'auroc': 0.9988173, 'binary_precision': 0.98185354, 'binary_recall': 0.98376626, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98280895}
confusion matrix:
      0     1
0  1488    28
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.76212835, 'precision': 0.76955533, 'recall': 0.7597517, 'specificity': 0.7597517, 'f1': 0.7592391, 'auroc': 0.8286458, 'binary_precision': 0.80813956, 'binary_recall': 0.670418, 'binary_specificity': 0.8490854, 'binary_f1_score': 0.7328647}
confusion matrix:
     0    1
0  557   99
1  205  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.7816407, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.73984385, 'auroc': 0.86546206, 'binary_precision': 0.6838488, 'binary_recall': 0.9212963, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.78500986}
confusion matrix:
     0    1
0  124   92
1   17  199
early stop counter: 2
val acc:0.7621283531188965, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.75
after epoch: 4,now: 2024-07-29 02:14:24.401139,epoch time: 0:01:35.748009,used: 0:06:29.057122,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.9807924, 'recall': 0.9806489, 'specificity': 0.9806489, 'f1': 0.9806903, 'auroc': 0.99774265, 'binary_precision': 0.9755941, 'binary_recall': 0.98636365, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9809494}
confusion matrix:
      0     1
0  1478    38
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.7785602, 'precision': 0.78187567, 'recall': 0.776966, 'specificity': 0.776966, 'f1': 0.7771125, 'auroc': 0.8534012, 'binary_precision': 0.80651, 'binary_recall': 0.7170418, 'binary_specificity': 0.8368902, 'binary_f1_score': 0.759149}
confusion matrix:
     0    1
0  549  107
1  176  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8271853, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81304765, 'auroc': 0.88230884, 'binary_precision': 0.8908046, 'binary_recall': 0.7175926, 'binary_specificity': 0.912037, 'binary_f1_score': 0.79487175}
confusion matrix:
     0    1
0  197   19
1   61  155
new oracle model saved
early stop counter: 3
val acc:0.778560221195221, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8148148059844971
after epoch: 5,now: 2024-07-29 02:16:01.315397,epoch time: 0:01:36.914258,used: 0:08:05.971380,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98307455, 'recall': 0.9829421, 'specificity': 0.9829421, 'f1': 0.9829814, 'auroc': 0.9982652, 'binary_precision': 0.9781491, 'binary_recall': 0.9883117, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9832042}
confusion matrix:
      0     1
0  1482    34
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.7723005, 'precision': 0.77590007, 'recall': 0.77061844, 'specificity': 0.77061844, 'f1': 0.770693, 'auroc': 0.86700064, 'binary_precision': 0.80145717, 'binary_recall': 0.7073955, 'binary_specificity': 0.83384144, 'binary_f1_score': 0.75149435}
confusion matrix:
     0    1
0  547  109
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7770946, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.7667135, 'auroc': 0.85142314, 'binary_precision': 0.72834647, 'binary_recall': 0.8564815, 'binary_specificity': 0.6805556, 'binary_f1_score': 0.7872341}
confusion matrix:
     0    1
0  147   69
1   31  185
early stop counter: 4
val acc:0.7723004817962646, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8148148059844971
after epoch: 6,now: 2024-07-29 02:17:36.754286,epoch time: 0:01:35.438889,used: 0:09:41.410269,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.97677475, 'recall': 0.976273, 'specificity': 0.976273, 'f1': 0.9761087, 'auroc': 0.998942, 'binary_precision': 0.99661475, 'binary_recall': 0.95584416, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9758038}
confusion matrix:
      0     1
0  1511     5
1    68  1472
---- Validation: 
scalar performance:
{'acc': 0.6744914, 'precision': 0.77407885, 'recall': 0.6662615, 'specificity': 0.6662615, 'f1': 0.63549805, 'auroc': 0.8553864, 'binary_precision': 0.9327731, 'binary_recall': 0.35691318, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.5162791}
confusion matrix:
     0    1
0  640   16
1  400  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6875, 'precision': 0.786566, 'recall': 0.6875, 'specificity': 0.6875, 'f1': 0.65793717, 'auroc': 0.85198045, 'binary_precision': 0.9550562, 'binary_recall': 0.3935185, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.55737704}
confusion matrix:
     0   1
0  212   4
1  131  85
early stop counter: 5
val acc:0.6744914054870605, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8148148059844971
after epoch: 7,now: 2024-07-29 02:19:07.885041,epoch time: 0:01:31.130755,used: 0:11:12.541024,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.98396575, 'recall': 0.98375595, 'specificity': 0.98375595, 'f1': 0.9836379, 'auroc': 0.9996526, 'binary_precision': 0.99866134, 'binary_recall': 0.9688312, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9835201}
confusion matrix:
      0     1
0  1514     2
1    48  1492
---- Validation: 
scalar performance:
{'acc': 0.6885759, 'precision': 0.7659389, 'recall': 0.6811892, 'specificity': 0.6811892, 'f1': 0.6587198, 'auroc': 0.8566779, 'binary_precision': 0.9028777, 'binary_recall': 0.40353698, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.5577778}
confusion matrix:
     0    1
0  629   27
1  371  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8217478, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73524004, 'auroc': 0.90125597, 'binary_precision': 0.9736842, 'binary_recall': 0.5138889, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.6727272}
confusion matrix:
     0    1
0  213    3
1  105  111
early stop counter: 6
val acc:0.6885759234428406, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8148148059844971
after epoch: 8,now: 2024-07-29 02:20:38.326945,epoch time: 0:01:30.441904,used: 0:12:42.982928,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9870458, 'recall': 0.9869924, 'specificity': 0.9869924, 'f1': 0.9869109, 'auroc': 0.9994042, 'binary_precision': 0.9973475, 'binary_recall': 0.97662336, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9868766}
confusion matrix:
      0     1
0  1512     4
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.7046106, 'recall': 0.6372147, 'specificity': 0.6372147, 'f1': 0.60950255, 'auroc': 0.7747456, 'binary_precision': 0.8088235, 'binary_recall': 0.35369775, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.49217}
confusion matrix:
     0    1
0  604   52
1  402  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.78904426, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.78666663, 'auroc': 0.8521091, 'binary_precision': 0.81313133, 'binary_recall': 0.7453704, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.77777773}
confusion matrix:
     0    1
0  179   37
1   55  161
early stop counter: 7
val acc:0.6447574496269226, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8148148059844971
after epoch: 9,now: 2024-07-29 02:22:09.100112,epoch time: 0:01:30.773167,used: 0:14:13.756095,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9863031, 'recall': 0.98631227, 'specificity': 0.98631227, 'f1': 0.9862566, 'auroc': 0.99893165, 'binary_precision': 0.9934124, 'binary_recall': 0.9792208, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9862656}
confusion matrix:
      0     1
0  1506    10
1    32  1508
---- Validation: 
scalar performance:
{'acc': 0.6517997, 'precision': 0.7435174, 'recall': 0.6433662, 'specificity': 0.6433662, 'f1': 0.6080443, 'auroc': 0.8243569, 'binary_precision': 0.88646287, 'binary_recall': 0.32636657, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.4770858}
confusion matrix:
     0    1
0  630   26
1  419  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8311037, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8017309, 'auroc': 0.89677644, 'binary_precision': 0.9230769, 'binary_recall': 0.6666667, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7741936}
confusion matrix:
     0    1
0  204   12
1   72  144
early stop counter: 8
val acc:0.6517996788024902, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8148148059844971
after epoch: 10,now: 2024-07-29 02:23:45.286687,epoch time: 0:01:36.186575,used: 0:15:49.942670,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.98168314, 'recall': 0.9812571, 'specificity': 0.9812571, 'f1': 0.98134124, 'auroc': 0.9992727, 'binary_precision': 0.97079366, 'binary_recall': 0.99285716, 'binary_specificity': 0.969657, 'binary_f1_score': 0.98170143}
confusion matrix:
      0     1
0  1470    46
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.74882627, 'precision': 0.7838752, 'recall': 0.74400294, 'specificity': 0.74400294, 'f1': 0.73824096, 'auroc': 0.85445505, 'binary_precision': 0.877193, 'binary_recall': 0.562701, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.68560237}
confusion matrix:
     0    1
0  607   49
1  272  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.8603896, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.840625, 'auroc': 0.90016294, 'binary_precision': 0.9404762, 'binary_recall': 0.7314815, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8229166}
confusion matrix:
     0    1
0  206   10
1   58  158
new oracle model saved
early stop counter: 9
val acc:0.748826265335083, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8425925970077515
after epoch: 11,now: 2024-07-29 02:25:15.095639,epoch time: 0:01:29.808952,used: 0:17:19.751622,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9815333, 'recall': 0.9811637, 'specificity': 0.9811637, 'f1': 0.9810188, 'auroc': 0.99900484, 'binary_precision': 0.99932617, 'binary_recall': 0.962987, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98082006}
confusion matrix:
      0     1
0  1515     1
1    57  1483
---- Validation: 
scalar performance:
{'acc': 0.7222222, 'precision': 0.8028226, 'recall': 0.71521354, 'specificity': 0.71521354, 'f1': 0.6981363, 'auroc': 0.8850237, 'binary_precision': 0.95254236, 'binary_recall': 0.4517685, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6128681}
confusion matrix:
     0    1
0  642   14
1  341  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.71990657, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.5680393, 'auroc': 0.81007266, 'binary_precision': 0.8695652, 'binary_recall': 0.2777778, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.42105266}
confusion matrix:
     0   1
0  207   9
1  156  60
early stop counter: 10
val acc:0.7222222089767456, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8425925970077515
after epoch: 12,now: 2024-07-29 02:26:54.880958,epoch time: 0:01:39.785319,used: 0:18:59.536941,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905044, 'recall': 0.9905176, 'specificity': 0.9905176, 'f1': 0.99051, 'auroc': 0.9996817, 'binary_precision': 0.991542, 'binary_recall': 0.9896104, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.99057525}
confusion matrix:
      0     1
0  1503    13
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.74413145, 'precision': 0.80088186, 'recall': 0.7382215, 'specificity': 0.7382215, 'f1': 0.7282448, 'auroc': 0.8779826, 'binary_precision': 0.9250721, 'binary_recall': 0.51607716, 'binary_specificity': 0.96036583, 'binary_f1_score': 0.6625387}
confusion matrix:
     0    1
0  630   26
1  301  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.7618182, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.71130717, 'auroc': 0.84486455, 'binary_precision': 0.8636364, 'binary_recall': 0.5277778, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.6551724}
confusion matrix:
     0    1
0  198   18
1  102  114
early stop counter: 11
val acc:0.7441314458847046, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.75 / 0.8425925970077515
after epoch: 13,now: 2024-07-29 02:28:33.374139,epoch time: 0:01:38.493181,used: 0:20:38.030122,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9871146, 'recall': 0.98684335, 'specificity': 0.98684335, 'f1': 0.9869075, 'auroc': 0.99962306, 'binary_precision': 0.9789272, 'binary_recall': 0.99545455, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9871217}
confusion matrix:
      0     1
0  1483    33
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.8380282, 'precision': 0.83993775, 'recall': 0.83697605, 'specificity': 0.83697605, 'f1': 0.8374069, 'auroc': 0.90617895, 'binary_precision': 0.8596187, 'binary_recall': 0.79742765, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.82735616}
confusion matrix:
     0    1
0  575   81
1  126  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.81444776, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8122091, 'auroc': 0.8923397, 'binary_precision': 0.78969955, 'binary_recall': 0.8518519, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.81959903}
confusion matrix:
     0    1
0  167   49
1   32  184
better model found
persisted
after epoch: 14,now: 2024-07-29 02:30:14.238680,epoch time: 0:01:40.864541,used: 0:22:18.894663,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98985016, 'recall': 0.98987854, 'specificity': 0.98987854, 'f1': 0.98985577, 'auroc': 0.9996153, 'binary_precision': 0.99281514, 'binary_recall': 0.987013, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98990554}
confusion matrix:
      0     1
0  1505    11
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.80829424, 'precision': 0.8371597, 'recall': 0.8043462, 'specificity': 0.8043462, 'f1': 0.8026031, 'auroc': 0.90233123, 'binary_precision': 0.92938495, 'binary_recall': 0.6559486, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.76908576}
confusion matrix:
     0    1
0  625   31
1  214  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.84375, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.8000001, 'auroc': 0.9033351, 'binary_precision': 0.9583333, 'binary_recall': 0.6388889, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.76666665}
confusion matrix:
     0    1
0  210    6
1   78  138
early stop counter: 1
val acc:0.8082942366600037, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8125 / 0.8425925970077515
after epoch: 15,now: 2024-07-29 02:31:48.152241,epoch time: 0:01:33.913561,used: 0:23:52.808224,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98318297, 'recall': 0.98254037, 'specificity': 0.98254037, 'f1': 0.98264825, 'auroc': 0.9995451, 'binary_precision': 0.96908516, 'binary_recall': 0.9974026, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.98304}
confusion matrix:
      0     1
0  1467    49
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.8460602, 'recall': 0.83508897, 'specificity': 0.83508897, 'f1': 0.8354907, 'auroc': 0.9076249, 'binary_precision': 0.8950382, 'binary_recall': 0.7540193, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.81849915}
confusion matrix:
     0    1
0  601   55
1  153  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.7894077, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.7893417, 'auroc': 0.85991085, 'binary_precision': 0.7934272, 'binary_recall': 0.7824074, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.78787875}
confusion matrix:
     0    1
0  172   44
1   47  169
early stop counter: 2
val acc:0.8372457027435303, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8125 / 0.8425925970077515
after epoch: 16,now: 2024-07-29 02:33:27.207461,epoch time: 0:01:39.055220,used: 0:25:31.863444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98848104, 'recall': 0.9881421, 'specificity': 0.9881421, 'f1': 0.98821616, 'auroc': 0.9997957, 'binary_precision': 0.9789809, 'binary_recall': 0.99805194, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9884244}
confusion matrix:
      0     1
0  1483    33
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.8794992, 'precision': 0.88346434, 'recall': 0.87816393, 'specificity': 0.87816393, 'f1': 0.8788438, 'auroc': 0.9283169, 'binary_precision': 0.9163701, 'binary_recall': 0.82797426, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.8699324}
confusion matrix:
     0    1
0  609   47
1  107  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8150579, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81477904, 'auroc': 0.8855238, 'binary_precision': 0.8238095, 'binary_recall': 0.8009259, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.81220657}
confusion matrix:
     0    1
0  179   37
1   43  173
better model found
persisted
after epoch: 17,now: 2024-07-29 02:35:04.515632,epoch time: 0:01:37.308171,used: 0:27:09.171615,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9922223, 'recall': 0.99211013, 'specificity': 0.99211013, 'f1': 0.9921454, 'auroc': 0.99973744, 'binary_precision': 0.9877735, 'binary_recall': 0.9967533, 'binary_specificity': 0.987467, 'binary_f1_score': 0.99224305}
confusion matrix:
      0     1
0  1497    19
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8314618, 'recall': 0.81063986, 'specificity': 0.81063986, 'f1': 0.8100874, 'auroc': 0.890769, 'binary_precision': 0.9016736, 'binary_recall': 0.69292605, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.7836363}
confusion matrix:
     0    1
0  609   47
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.7895192, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.7865796, 'auroc': 0.84988, 'binary_precision': 0.81632656, 'binary_recall': 0.7407407, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.776699}
confusion matrix:
     0    1
0  180   36
1   56  160
early stop counter: 1
val acc:0.8137715458869934, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 18,now: 2024-07-29 02:36:39.570903,epoch time: 0:01:35.055271,used: 0:28:44.226886,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895755, 'recall': 0.9895847, 'specificity': 0.9895847, 'f1': 0.9895288, 'auroc': 0.9996371, 'binary_precision': 0.9967062, 'binary_recall': 0.98246753, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9895357}
confusion matrix:
      0     1
0  1511     5
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.700313, 'precision': 0.80628633, 'recall': 0.6923305, 'specificity': 0.6923305, 'f1': 0.66648793, 'auroc': 0.9095273, 'binary_precision': 0.9799197, 'binary_recall': 0.39228296, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.56027555}
confusion matrix:
     0    1
0  651    5
1  378  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.75174826, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.34858236, 'auroc': 0.8274605, 'binary_precision': 1.0, 'binary_recall': 0.013888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.027397262}
confusion matrix:
     0  1
0  216  0
1  213  3
early stop counter: 2
val acc:0.7003129720687866, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 19,now: 2024-07-29 02:38:19.562720,epoch time: 0:01:39.991817,used: 0:30:24.218703,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98735917, 'recall': 0.9871886, 'specificity': 0.9871886, 'f1': 0.9872358, 'auroc': 0.9995982, 'binary_precision': 0.98139834, 'binary_recall': 0.9935065, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9874154}
confusion matrix:
      0     1
0  1487    29
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.7660407, 'precision': 0.8071418, 'recall': 0.76106286, 'specificity': 0.76106286, 'f1': 0.7555294, 'auroc': 0.8785347, 'binary_precision': 0.9130435, 'binary_recall': 0.573955, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7048371}
confusion matrix:
     0    1
0  622   34
1  265  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.75263155, 'recall': 0.6666666, 'specificity': 0.6666666, 'f1': 0.63567364, 'auroc': 0.8678198, 'binary_precision': 0.9, 'binary_recall': 0.375, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.52941173}
confusion matrix:
     0   1
0  207   9
1  135  81
early stop counter: 3
val acc:0.7660406827926636, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 20,now: 2024-07-29 02:39:51.654470,epoch time: 0:01:32.091750,used: 0:31:56.310453,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99213874, 'recall': 0.9921615, 'specificity': 0.9921615, 'f1': 0.9921464, 'auroc': 0.99941874, 'binary_precision': 0.994133, 'binary_recall': 0.99025977, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9921926}
confusion matrix:
      0     1
0  1507     9
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.74491394, 'precision': 0.81611073, 'recall': 0.7384838, 'specificity': 0.7384838, 'f1': 0.72621393, 'auroc': 0.90219086, 'binary_precision': 0.95962733, 'binary_recall': 0.49678457, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.65466106}
confusion matrix:
     0    1
0  643   13
1  313  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.7410971, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.43605018, 'auroc': 0.85521686, 'binary_precision': 0.95652175, 'binary_recall': 0.10185185, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.18410042}
confusion matrix:
     0   1
0  215   1
1  194  22
early stop counter: 4
val acc:0.7449139356613159, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 21,now: 2024-07-29 02:41:30.786584,epoch time: 0:01:39.132114,used: 0:33:35.442567,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934692, 'recall': 0.9934962, 'specificity': 0.9934962, 'f1': 0.99345547, 'auroc': 0.9998771, 'binary_precision': 0.9986877, 'binary_recall': 0.9883117, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9934726}
confusion matrix:
      0     1
0  1514     2
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.7723005, 'precision': 0.83419085, 'recall': 0.7664938, 'specificity': 0.7664938, 'f1': 0.7585484, 'auroc': 0.9101639, 'binary_precision': 0.97151, 'binary_recall': 0.5482315, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.70092493}
confusion matrix:
     0    1
0  646   10
1  281  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6944444, 'precision': 0.76951873, 'recall': 0.6944444, 'specificity': 0.6944444, 'f1': 0.6715737, 'auroc': 0.86014664, 'binary_precision': 0.9117647, 'binary_recall': 0.43055555, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.5849057}
confusion matrix:
     0   1
0  207   9
1  123  93
early stop counter: 5
val acc:0.7723004817962646, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 22,now: 2024-07-29 02:43:09.958046,epoch time: 0:01:39.171462,used: 0:35:14.614029,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99345505, 'recall': 0.99345505, 'specificity': 0.99345505, 'f1': 0.99345505, 'auroc': 0.9998128, 'binary_precision': 0.9935065, 'binary_recall': 0.9935065, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9935065}
confusion matrix:
      0     1
0  1506    10
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.8028169, 'precision': 0.8356807, 'recall': 0.79859424, 'specificity': 0.79859424, 'f1': 0.7962166, 'auroc': 0.9103594, 'binary_precision': 0.9342723, 'binary_recall': 0.63987136, 'binary_specificity': 0.95731705, 'binary_f1_score': 0.759542}
confusion matrix:
     0    1
0  628   28
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.8016043, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.69645447, 'auroc': 0.908672, 'binary_precision': 0.9607843, 'binary_recall': 0.4537037, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.61635214}
confusion matrix:
     0   1
0  212   4
1  118  98
early stop counter: 6
val acc:0.8028169274330139, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 23,now: 2024-07-29 02:44:39.701572,epoch time: 0:01:29.743526,used: 0:36:44.357555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9928351, 'recall': 0.992852, 'specificity': 0.992852, 'f1': 0.9928011, 'auroc': 0.9999109, 'binary_precision': 0.9993421, 'binary_recall': 0.98636365, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9928105}
confusion matrix:
      0     1
0  1515     1
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.6056338, 'precision': 0.76351225, 'recall': 0.5950636, 'specificity': 0.5950636, 'f1': 0.52446514, 'auroc': 0.903567, 'binary_precision': 0.9609375, 'binary_recall': 0.1977492, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.328}
confusion matrix:
     0    1
0  651    5
1  499  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5717593, 'precision': 0.74095, 'recall': 0.5717592, 'specificity': 0.5717592, 'f1': 0.48057687, 'auroc': 0.8599323, 'binary_precision': 0.94285715, 'binary_recall': 0.15277778, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.26294822}
confusion matrix:
     0   1
0  214   2
1  183  33
early stop counter: 7
val acc:0.6056337952613831, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 24,now: 2024-07-29 02:46:13.999664,epoch time: 0:01:34.298092,used: 0:38:18.655647,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99223995, 'recall': 0.992105, 'specificity': 0.992105, 'f1': 0.99214524, 'auroc': 0.99986804, 'binary_precision': 0.98714656, 'binary_recall': 0.9974026, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.99224806}
confusion matrix:
      0     1
0  1496    20
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.837046, 'recall': 0.8102232, 'specificity': 0.8102232, 'f1': 0.8091915, 'auroc': 0.90733874, 'binary_precision': 0.91921395, 'binary_recall': 0.6768489, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.77962965}
confusion matrix:
     0    1
0  619   37
1  201  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.8134755, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7768792, 'auroc': 0.8915252, 'binary_precision': 0.9121622, 'binary_recall': 0.625, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.7417583}
confusion matrix:
     0    1
0  203   13
1   81  135
early stop counter: 8
val acc:0.8137715458869934, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 25,now: 2024-07-29 02:47:51.642683,epoch time: 0:01:37.643019,used: 0:39:56.298666,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99214196, 'recall': 0.99215126, 'specificity': 0.99215126, 'f1': 0.99214625, 'auroc': 0.99980724, 'binary_precision': 0.99284786, 'binary_recall': 0.99155843, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99220276}
confusion matrix:
      0     1
0  1505    11
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.8255086, 'precision': 0.8562436, 'recall': 0.82157284, 'specificity': 0.82157284, 'f1': 0.82032853, 'auroc': 0.9256253, 'binary_precision': 0.9544419, 'binary_recall': 0.67363346, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.7898209}
confusion matrix:
     0    1
0  636   20
1  203  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.81458926, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.7275687, 'auroc': 0.9070162, 'binary_precision': 0.96460176, 'binary_recall': 0.5046296, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.662614}
confusion matrix:
     0    1
0  212    4
1  107  109
early stop counter: 9
val acc:0.8255085945129395, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 26,now: 2024-07-29 02:49:29.289133,epoch time: 0:01:37.646450,used: 0:41:33.945116,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918477, 'recall': 0.99186766, 'specificity': 0.99186766, 'f1': 0.9918194, 'auroc': 0.9998574, 'binary_precision': 0.9980276, 'binary_recall': 0.98571426, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.99183273}
confusion matrix:
      0     1
0  1513     3
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.7832812, 'recall': 0.64414066, 'specificity': 0.64414066, 'f1': 0.60047257, 'auroc': 0.8883605, 'binary_precision': 0.9685864, 'binary_recall': 0.29742765, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.45510456}
confusion matrix:
     0    1
0  650    6
1  437  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041667, 'precision': 0.75011575, 'recall': 0.6041667, 'specificity': 0.6041667, 'f1': 0.53655916, 'auroc': 0.8658693, 'binary_precision': 0.9411765, 'binary_recall': 0.22222222, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.35955054}
confusion matrix:
     0   1
0  213   3
1  168  48
early stop counter: 10
val acc:0.6533646583557129, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 27,now: 2024-07-29 02:51:06.162211,epoch time: 0:01:36.873078,used: 0:43:10.818194,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9915533, 'recall': 0.9915533, 'specificity': 0.9915533, 'f1': 0.99149215, 'auroc': 0.9998201, 'binary_precision': 0.99934036, 'binary_recall': 0.98376626, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.99149215}
confusion matrix:
      0     1
0  1515     1
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.63693273, 'precision': 0.7439394, 'recall': 0.6278429, 'specificity': 0.6278429, 'f1': 0.5834326, 'auroc': 0.8365563, 'binary_precision': 0.8989899, 'binary_recall': 0.28617364, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.43414634}
confusion matrix:
     0    1
0  636   20
1  444  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5902778, 'precision': 0.7096878, 'recall': 0.5902778, 'specificity': 0.5902778, 'f1': 0.52226424, 'auroc': 0.80441964, 'binary_precision': 0.8679245, 'binary_recall': 0.21296297, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.34200746}
confusion matrix:
     0   1
0  209   7
1  170  46
early stop counter: 11
val acc:0.6369327306747437, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 28,now: 2024-07-29 02:52:43.021982,epoch time: 0:01:36.859771,used: 0:44:47.677965,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931259, 'recall': 0.9931561, 'specificity': 0.9931561, 'f1': 0.9931282, 'auroc': 0.99959475, 'binary_precision': 0.9967299, 'binary_recall': 0.9896104, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9931574}
confusion matrix:
      0     1
0  1511     5
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.6165884, 'precision': 0.7272458, 'recall': 0.60698426, 'specificity': 0.60698426, 'f1': 0.55300653, 'auroc': 0.825083, 'binary_precision': 0.87931037, 'binary_recall': 0.24598071, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.38442212}
confusion matrix:
     0    1
0  635   21
1  469  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6180556, 'precision': 0.72523, 'recall': 0.6180556, 'specificity': 0.6180556, 'f1': 0.56648403, 'auroc': 0.83048266, 'binary_precision': 0.880597, 'binary_recall': 0.27314815, 'binary_specificity': 0.962963, 'binary_f1_score': 0.41696113}
confusion matrix:
     0   1
0  208   8
1  157  59
early stop counter: 12
val acc:0.6165884137153625, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 29,now: 2024-07-29 02:54:20.089214,epoch time: 0:01:37.067232,used: 0:46:24.745197,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99279416, 'recall': 0.9928212, 'specificity': 0.9928212, 'f1': 0.99280083, 'auroc': 0.99980295, 'binary_precision': 0.9954308, 'binary_recall': 0.99025977, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.99283856}
confusion matrix:
      0     1
0  1509     7
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.8309859, 'precision': 0.8590926, 'recall': 0.8272415, 'specificity': 0.8272415, 'f1': 0.8263871, 'auroc': 0.9189476, 'binary_precision': 0.953125, 'binary_recall': 0.6864952, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.7981308}
confusion matrix:
     0    1
0  635   21
1  195  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.7796235, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.74026865, 'auroc': 0.8559028, 'binary_precision': 0.8741259, 'binary_recall': 0.5787037, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.6963789}
confusion matrix:
     0    1
0  198   18
1   91  125
early stop counter: 13
val acc:0.8309859037399292, best validation acc: 0.8794991970062256, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 30,now: 2024-07-29 02:55:52.726420,epoch time: 0:01:32.637206,used: 0:47:57.382403,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_07_55_seed_2_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:57.382403 at 2024-07-29 02:55:52.726420
persisted model performance metric: 

scalar performance:
{'acc': 0.8148148, 'precision': 0.8150579, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.81477904, 'auroc': 0.8855238, 'binary_precision': 0.8238095, 'binary_recall': 0.8009259, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.81220657}
confusion matrix:
     0    1
0  179   37
1   43  173
oracle model performance metric: 

scalar performance:
{'acc': 0.8425926, 'precision': 0.8603896, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.840625, 'auroc': 0.90016294, 'binary_precision': 0.9404762, 'binary_recall': 0.7314815, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.8229166}
confusion matrix:
     0    1
0  206   10
1   58  158
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454144 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 219512 GiB | 219511 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454144 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 219512 GiB | 219511 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  41662 MiB |  27186 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  41560 MiB |  27150 MiB |
|       from small pool |     66 MiB |     70 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 463359 KiB |   1260 MiB | 161217 GiB | 161216 GiB |
|       from large pool | 450704 KiB |   1252 MiB | 158580 GiB | 158579 GiB |
|       from small pool |  12655 KiB |     41 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38980 K  |   38978 K  |
|       from large pool |     187    |    1413    |   19831 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19149 K  |   19148 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38980 K  |   38978 K  |
|       from large pool |     187    |    1413    |   19831 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19149 K  |   19148 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     636    |    1781    |    1146    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     653    |   26222 K  |   26222 K  |
|       from large pool |      38    |     604    |   14861 K  |   14861 K  |
|       from small pool |      63    |     235    |   11360 K  |   11360 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14488 MiB |  41662 MiB |  40766 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     52 MiB |     70 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 161217 GiB | 161217 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |      0 KiB |     47 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38980 K  |   38980 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19149 K  |   19149 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38980 K  |   38980 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19149 K  |   19149 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1781    |    1717    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      26    |      35    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   26222 K  |   26222 K  |
|       from large pool |       3    |     604    |   14861 K  |   14861 K  |
|       from small pool |       0    |     235    |   11361 K  |   11361 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14488 MiB |  41662 MiB |  40766 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     52 MiB |     70 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 161217 GiB | 161217 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |      0 KiB |     47 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38980 K  |   38980 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19149 K  |   19149 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38980 K  |   38980 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19149 K  |   19149 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1781    |    1717    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      26    |      35    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   26222 K  |   26222 K  |
|       from large pool |       3    |     604    |   14861 K  |   14861 K  |
|       from small pool |       0    |     235    |   11361 K  |   11361 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368

 Experiment start at: 2024-07-29 02:56:38.351151
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9238281, 'precision': 0.93150365, 'recall': 0.9228985, 'specificity': 0.9228985, 'f1': 0.92336035, 'auroc': 0.9931177, 'binary_precision': 0.87742305, 'binary_recall': 0.9878049, 'binary_specificity': 0.85799205, 'binary_f1_score': 0.9293478}
confusion matrix:
      0     1
0  1299   215
1    19  1539
---- Validation: 
scalar performance:
{'acc': 0.7825409, 'precision': 0.79811144, 'recall': 0.7847221, 'specificity': 0.7847221, 'f1': 0.7804905, 'auroc': 0.88752353, 'binary_precision': 0.7249357, 'binary_recall': 0.89666134, 'binary_specificity': 0.6727829, 'binary_f1_score': 0.8017058}
confusion matrix:
     0    1
0  440  214
1   65  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.784689, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.760181, 'auroc': 0.89481485, 'binary_precision': 0.70877194, 'binary_recall': 0.8977778, 'binary_specificity': 0.6311111, 'binary_f1_score': 0.7921569}
confusion matrix:
     0    1
0  142   83
1   23  202
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:58:20.087270,epoch time: 0:01:41.736119,used: 0:01:41.736119,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9750351, 'recall': 0.97511697, 'specificity': 0.97511697, 'f1': 0.9749346, 'auroc': 0.99610806, 'binary_precision': 0.986868, 'binary_recall': 0.9634615, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9750243}
confusion matrix:
      0     1
0  1492    20
1    57  1503
---- Validation: 
scalar performance:
{'acc': 0.79345286, 'precision': 0.7981242, 'recall': 0.7946354, 'specificity': 0.7946354, 'f1': 0.7930299, 'auroc': 0.87193406, 'binary_precision': 0.755618, 'binary_recall': 0.85532594, 'binary_specificity': 0.73394495, 'binary_f1_score': 0.8023863}
confusion matrix:
     0    1
0  480  174
1   91  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.75973046, 'recall': 0.72, 'specificity': 0.72, 'f1': 0.7088665, 'auroc': 0.87865674, 'binary_precision': 0.658147, 'binary_recall': 0.91555554, 'binary_specificity': 0.52444446, 'binary_f1_score': 0.7657992}
confusion matrix:
     0    1
0  118  107
1   19  206
better model found
persisted
after epoch: 2,now: 2024-07-29 02:59:58.073001,epoch time: 0:01:37.985731,used: 0:03:19.721850,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.95511067, 'recall': 0.9512975, 'specificity': 0.9512975, 'f1': 0.9516885, 'auroc': 0.9977977, 'binary_precision': 0.9195471, 'binary_recall': 0.9916452, 'binary_specificity': 0.9109499, 'binary_f1_score': 0.9542362}
confusion matrix:
      0     1
0  1381   135
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.78332037, 'precision': 0.7882202, 'recall': 0.78454465, 'specificity': 0.78454465, 'f1': 0.7828294, 'auroc': 0.8708595, 'binary_precision': 0.74545455, 'binary_recall': 0.84737676, 'binary_specificity': 0.7217125, 'binary_f1_score': 0.7931547}
confusion matrix:
     0    1
0  472  182
1   96  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.75930643, 'recall': 0.7511111, 'specificity': 0.7511111, 'f1': 0.74912894, 'auroc': 0.8645136, 'binary_precision': 0.71320754, 'binary_recall': 0.84, 'binary_specificity': 0.6622222, 'binary_f1_score': 0.7714286}
confusion matrix:
     0    1
0  149   76
1   36  189
early stop counter: 1
val acc:0.7833203673362732, best validation acc: 0.7934528589248657, corresponding to test acc:                         0.7200000286102295 / 0.7644444704055786
after epoch: 3,now: 2024-07-29 03:01:38.268147,epoch time: 0:01:40.195146,used: 0:04:59.916996,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98377097, 'recall': 0.98383987, 'specificity': 0.98383987, 'f1': 0.98372376, 'auroc': 0.99888885, 'binary_precision': 0.9928011, 'binary_recall': 0.9749357, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9837873}
confusion matrix:
      0     1
0  1505    11
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.79735, 'precision': 0.80849874, 'recall': 0.79544985, 'specificity': 0.79544985, 'f1': 0.7947281, 'auroc': 0.85752106, 'binary_precision': 0.86247545, 'binary_recall': 0.69793326, 'binary_specificity': 0.8929664, 'binary_f1_score': 0.771529}
confusion matrix:
     0    1
0  584   70
1  190  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.804719, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7992226, 'auroc': 0.8625382, 'binary_precision': 0.84263957, 'binary_recall': 0.73777777, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.7867298}
confusion matrix:
     0    1
0  194   31
1   59  166
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 03:03:16.797216,epoch time: 0:01:38.529069,used: 0:06:38.446065,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.97980803, 'recall': 0.97982264, 'specificity': 0.97982264, 'f1': 0.9798149, 'auroc': 0.9966841, 'binary_precision': 0.98068255, 'binary_recall': 0.9794212, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.98005146}
confusion matrix:
      0     1
0  1487    30
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.8215121, 'precision': 0.8390738, 'recall': 0.8192717, 'specificity': 0.8192717, 'f1': 0.81839836, 'auroc': 0.87832487, 'binary_precision': 0.9115226, 'binary_recall': 0.70429254, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.7946188}
confusion matrix:
     0    1
0  611   43
1  186  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.819758, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8098254, 'auroc': 0.8933531, 'binary_precision': 0.87234044, 'binary_recall': 0.72888887, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.79418886}
confusion matrix:
     0    1
0  201   24
1   61  164
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 03:05:00.448004,epoch time: 0:01:43.650788,used: 0:08:22.096853,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876092, 'recall': 0.9876902, 'specificity': 0.9876902, 'f1': 0.9876292, 'auroc': 0.9990449, 'binary_precision': 0.99222296, 'binary_recall': 0.9833012, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.98774195}
confusion matrix:
      0     1
0  1503    12
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.74980515, 'precision': 0.789076, 'recall': 0.7461397, 'specificity': 0.7461397, 'f1': 0.7390903, 'auroc': 0.8565316, 'binary_precision': 0.89086294, 'binary_recall': 0.55802864, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.686217}
confusion matrix:
     0    1
0  611   43
1  278  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.8023106, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.77854323, 'auroc': 0.87261236, 'binary_precision': 0.88023955, 'binary_recall': 0.6533333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.74999994}
confusion matrix:
     0    1
0  205   20
1   78  147
early stop counter: 1
val acc:0.7498051524162292, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 6,now: 2024-07-29 03:06:33.546614,epoch time: 0:01:33.098610,used: 0:09:55.195463,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9885908, 'recall': 0.98866844, 'specificity': 0.98866844, 'f1': 0.988606, 'auroc': 0.9990288, 'binary_precision': 0.9935107, 'binary_recall': 0.98393315, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9886987}
confusion matrix:
      0     1
0  1506    10
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.7217459, 'precision': 0.778738, 'recall': 0.7172494, 'specificity': 0.7172494, 'f1': 0.7040174, 'auroc': 0.8673444, 'binary_precision': 0.9, 'binary_recall': 0.4864865, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.6315789}
confusion matrix:
     0    1
0  620   34
1  323  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.81662464, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.74597466, 'auroc': 0.89353085, 'binary_precision': 0.953125, 'binary_recall': 0.5422222, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.6912181}
confusion matrix:
     0    1
0  219    6
1  103  122
early stop counter: 2
val acc:0.7217459082603455, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 7,now: 2024-07-29 03:08:09.969691,epoch time: 0:01:36.423077,used: 0:11:31.618540,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9816971, 'recall': 0.9813277, 'specificity': 0.9813277, 'f1': 0.9814365, 'auroc': 0.9986671, 'binary_precision': 0.9734681, 'binary_recall': 0.9903599, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9818413}
confusion matrix:
      0     1
0  1474    42
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.76929075, 'precision': 0.7944709, 'recall': 0.76637715, 'specificity': 0.76637715, 'f1': 0.76287746, 'auroc': 0.8578887, 'binary_precision': 0.8758465, 'binary_recall': 0.61685216, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.72388065}
confusion matrix:
     0    1
0  599   55
1  241  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.78231144, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.782205, 'auroc': 0.8706766, 'binary_precision': 0.7873303, 'binary_recall': 0.7733333, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.780269}
confusion matrix:
     0    1
0  178   47
1   51  174
early stop counter: 3
val acc:0.7692907452583313, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 8,now: 2024-07-29 03:09:47.511288,epoch time: 0:01:37.541597,used: 0:13:09.160137,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98535323, 'recall': 0.98534435, 'specificity': 0.98534435, 'f1': 0.9853487, 'auroc': 0.99836576, 'binary_precision': 0.9852375, 'binary_recall': 0.98587024, 'binary_specificity': 0.98481846, 'binary_f1_score': 0.9855538}
confusion matrix:
      0     1
0  1492    23
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.7272019, 'precision': 0.80506754, 'recall': 0.722206, 'specificity': 0.722206, 'f1': 0.70567226, 'auroc': 0.85784185, 'binary_precision': 0.9543974, 'binary_recall': 0.46581876, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.6260684}
confusion matrix:
     0    1
0  640   14
1  336  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8472222, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.79559964, 'auroc': 0.8966321, 'binary_precision': 0.9722222, 'binary_recall': 0.62222224, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.75880754}
confusion matrix:
     0    1
0  221    4
1   85  140
early stop counter: 4
val acc:0.7272018790245056, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 9,now: 2024-07-29 03:11:25.818531,epoch time: 0:01:38.307243,used: 0:14:47.467380,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98467666, 'recall': 0.9842452, 'specificity': 0.9842452, 'f1': 0.9843669, 'auroc': 0.9992246, 'binary_precision': 0.97540987, 'binary_recall': 0.99421597, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9847231}
confusion matrix:
      0     1
0  1477    39
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.812159, 'precision': 0.82298124, 'recall': 0.8103404, 'specificity': 0.8103404, 'f1': 0.8098954, 'auroc': 0.87823737, 'binary_precision': 0.8774319, 'binary_recall': 0.71701115, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.7891514}
confusion matrix:
     0    1
0  591   63
1  178  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.826192, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81914175, 'auroc': 0.89066666, 'binary_precision': 0.87113404, 'binary_recall': 0.7511111, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.80668265}
confusion matrix:
     0    1
0  200   25
1   56  169
new oracle model saved
early stop counter: 5
val acc:0.81215900182724, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8199999928474426
after epoch: 10,now: 2024-07-29 03:13:03.710075,epoch time: 0:01:37.891544,used: 0:16:25.358924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9833641, 'recall': 0.9833026, 'specificity': 0.9833026, 'f1': 0.9830729, 'auroc': 0.9985086, 'binary_precision': 0.9993369, 'binary_recall': 0.9672657, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9830398}
confusion matrix:
      0     1
0  1513     1
1    51  1507
---- Validation: 
scalar performance:
{'acc': 0.54793453, 'precision': 0.7096084, 'recall': 0.5391634, 'specificity': 0.5391634, 'f1': 0.42617565, 'auroc': 0.8381709, 'binary_precision': 0.8888889, 'binary_recall': 0.089030206, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.1618497}
confusion matrix:
     0   1
0  647   7
1  573  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66, 'precision': 0.7849704, 'recall': 0.65999997, 'specificity': 0.65999997, 'f1': 0.6181343, 'auroc': 0.86898273, 'binary_precision': 0.9736842, 'binary_recall': 0.3288889, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.49169436}
confusion matrix:
     0   1
0  223   2
1  151  74
early stop counter: 6
val acc:0.5479345321655273, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8199999928474426
after epoch: 11,now: 2024-07-29 03:14:43.578383,epoch time: 0:01:39.868308,used: 0:18:05.227232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921777, 'recall': 0.99219525, 'specificity': 0.99219525, 'f1': 0.99218607, 'auroc': 0.9993429, 'binary_precision': 0.9929306, 'binary_recall': 0.99165595, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.9922929}
confusion matrix:
      0     1
0  1503    11
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.75681996, 'precision': 0.8002045, 'recall': 0.7530508, 'specificity': 0.7530508, 'f1': 0.7458115, 'auroc': 0.8791472, 'binary_precision': 0.90956074, 'binary_recall': 0.5596184, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.69291335}
confusion matrix:
     0    1
0  619   35
1  277  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.81719923, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.72315556, 'auroc': 0.9141333, 'binary_precision': 0.9736842, 'binary_recall': 0.49333334, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6548673}
confusion matrix:
     0    1
0  222    3
1  114  111
early stop counter: 7
val acc:0.7568199634552002, best validation acc: 0.8215121030807495, corresponding to test acc:                         0.8111110925674438 / 0.8199999928474426
after epoch: 12,now: 2024-07-29 03:16:22.407336,epoch time: 0:01:38.828953,used: 0:19:44.056185,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9861039, 'recall': 0.98594004, 'specificity': 0.98594004, 'f1': 0.9859984, 'auroc': 0.9993489, 'binary_precision': 0.98152864, 'binary_recall': 0.9909968, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.98624}
confusion matrix:
      0     1
0  1488    29
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.83008575, 'precision': 0.8398838, 'recall': 0.82841074, 'specificity': 0.82841074, 'f1': 0.82829565, 'auroc': 0.886697, 'binary_precision': 0.89292544, 'binary_recall': 0.74244833, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.81076384}
confusion matrix:
     0    1
0  598   56
1  162  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8222983, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81967854, 'auroc': 0.9081284, 'binary_precision': 0.84951454, 'binary_recall': 0.7777778, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8120649}
confusion matrix:
     0    1
0  194   31
1   50  175
better model found
persisted
after epoch: 13,now: 2024-07-29 03:18:00.393476,epoch time: 0:01:37.986140,used: 0:21:22.042325,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99123204, 'recall': 0.9913206, 'specificity': 0.9913206, 'f1': 0.9912107, 'auroc': 0.9991441, 'binary_precision': 0.99934727, 'binary_recall': 0.9833012, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.99125934}
confusion matrix:
      0     1
0  1514     1
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.69680434, 'precision': 0.78174776, 'recall': 0.69135636, 'specificity': 0.69135636, 'f1': 0.6683175, 'auroc': 0.8789879, 'binary_precision': 0.9316547, 'binary_recall': 0.4117647, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.5711136}
confusion matrix:
     0    1
0  635   19
1  370  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.78008866, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.6518064, 'auroc': 0.9052296, 'binary_precision': 0.9456522, 'binary_recall': 0.38666666, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.5488959}
confusion matrix:
     0   1
0  220   5
1  138  87
early stop counter: 1
val acc:0.6968043446540833, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 14,now: 2024-07-29 03:19:39.428917,epoch time: 0:01:39.035441,used: 0:23:01.077766,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899137, 'recall': 0.990014, 'specificity': 0.990014, 'f1': 0.98990846, 'auroc': 0.9994968, 'binary_precision': 0.99739414, 'binary_recall': 0.98267007, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.9899774}
confusion matrix:
      0     1
0  1510     4
1    27  1531
---- Validation: 
scalar performance:
{'acc': 0.745908, 'precision': 0.8027613, 'recall': 0.74161816, 'specificity': 0.74161816, 'f1': 0.7311082, 'auroc': 0.86618423, 'binary_precision': 0.9291785, 'binary_recall': 0.5214626, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.6680244}
confusion matrix:
     0    1
0  629   25
1  301  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.8095238, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.75, 'auroc': 0.9037235, 'binary_precision': 0.93333334, 'binary_recall': 0.56, 'binary_specificity': 0.96, 'binary_f1_score': 0.70000005}
confusion matrix:
     0    1
0  216    9
1   99  126
early stop counter: 2
val acc:0.7459080219268799, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 15,now: 2024-07-29 03:21:16.329656,epoch time: 0:01:36.900739,used: 0:24:37.978505,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98995435, 'recall': 0.99001604, 'specificity': 0.99001604, 'f1': 0.98990875, 'auroc': 0.99955106, 'binary_precision': 0.9986911, 'binary_recall': 0.9813505, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98994493}
confusion matrix:
      0     1
0  1515     2
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.7544817, 'precision': 0.80405116, 'recall': 0.75048375, 'specificity': 0.75048375, 'f1': 0.74201834, 'auroc': 0.8673444, 'binary_precision': 0.922043, 'binary_recall': 0.54531, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.68531466}
confusion matrix:
     0    1
0  625   29
1  286  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.84412754, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80386794, 'auroc': 0.9200592, 'binary_precision': 0.95424837, 'binary_recall': 0.6488889, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7724868}
confusion matrix:
     0    1
0  218    7
1   79  146
early stop counter: 3
val acc:0.7544816732406616, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 16,now: 2024-07-29 03:22:56.673060,epoch time: 0:01:40.343404,used: 0:26:18.321909,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99478483, 'recall': 0.994852, 'specificity': 0.994852, 'f1': 0.99479145, 'auroc': 0.9998605, 'binary_precision': 1.0, 'binary_recall': 0.989704, 'binary_specificity': 1.0, 'binary_f1_score': 0.99482536}
confusion matrix:
      0     1
0  1518     0
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.7731878, 'precision': 0.80493855, 'recall': 0.7699871, 'specificity': 0.7699871, 'f1': 0.7656568, 'auroc': 0.8534456, 'binary_precision': 0.8985849, 'binary_recall': 0.6057234, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.72364676}
confusion matrix:
     0    1
0  611   43
1  248  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.819765, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7942408, 'auroc': 0.8922074, 'binary_precision': 0.90361446, 'binary_recall': 0.6666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7672635}
confusion matrix:
     0    1
0  209   16
1   75  150
early stop counter: 4
val acc:0.7731878161430359, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 17,now: 2024-07-29 03:24:36.173534,epoch time: 0:01:39.500474,used: 0:27:57.822383,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98642635, 'recall': 0.9865006, 'specificity': 0.9865006, 'f1': 0.986328, 'auroc': 0.9993683, 'binary_precision': 0.9980302, 'binary_recall': 0.974984, 'binary_specificity': 0.9980172, 'binary_f1_score': 0.98637253}
confusion matrix:
      0     1
0  1510     3
1    39  1520
---- Validation: 
scalar performance:
{'acc': 0.6679657, 'precision': 0.7720969, 'recall': 0.66182303, 'specificity': 0.66182303, 'f1': 0.62790024, 'auroc': 0.8632039, 'binary_precision': 0.93562233, 'binary_recall': 0.34658188, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.5058005}
confusion matrix:
     0    1
0  639   15
1  411  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5288889, 'precision': 0.7241379, 'recall': 0.5288889, 'specificity': 0.5288889, 'f1': 0.39772728, 'auroc': 0.8797827, 'binary_precision': 0.93333334, 'binary_recall': 0.062222224, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.11666667}
confusion matrix:
     0   1
0  224   1
1  211  14
early stop counter: 5
val acc:0.6679657101631165, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 18,now: 2024-07-29 03:26:15.368921,epoch time: 0:01:39.195387,used: 0:29:37.017770,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98154044, 'recall': 0.98139834, 'specificity': 0.98139834, 'f1': 0.9811195, 'auroc': 0.998924, 'binary_precision': 1.0, 'binary_recall': 0.9627967, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810458}
confusion matrix:
      0     1
0  1513     0
1    58  1501
---- Validation: 
scalar performance:
{'acc': 0.72252536, 'precision': 0.7924218, 'recall': 0.7176796, 'specificity': 0.7176796, 'f1': 0.7019627, 'auroc': 0.8560157, 'binary_precision': 0.9305994, 'binary_recall': 0.4689984, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.6236786}
confusion matrix:
     0    1
0  632   22
1  334  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.83732724, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.762048, 'auroc': 0.88574815, 'binary_precision': 0.984252, 'binary_recall': 0.5555556, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7102273}
confusion matrix:
     0    1
0  223    2
1  100  125
early stop counter: 6
val acc:0.7225253582000732, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 19,now: 2024-07-29 03:27:45.368785,epoch time: 0:01:29.999864,used: 0:31:07.017634,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99225, 'recall': 0.99214154, 'specificity': 0.99214154, 'f1': 0.99218524, 'auroc': 0.99980295, 'binary_precision': 0.98915124, 'binary_recall': 0.9955042, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.99231756}
confusion matrix:
      0     1
0  1498    17
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.80124706, 'precision': 0.82627285, 'recall': 0.7985128, 'specificity': 0.7985128, 'f1': 0.7962971, 'auroc': 0.88987726, 'binary_precision': 0.91189426, 'binary_recall': 0.6581876, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.7645429}
confusion matrix:
     0    1
0  614   40
1  215  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.84972066, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8135196, 'auroc': 0.9317926, 'binary_precision': 0.955414, 'binary_recall': 0.6666667, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7853403}
confusion matrix:
     0    1
0  218    7
1   75  150
early stop counter: 7
val acc:0.8012470602989197, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8199999928474426
after epoch: 20,now: 2024-07-29 03:29:24.706130,epoch time: 0:01:39.337345,used: 0:32:46.354979,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98354876, 'recall': 0.9829092, 'specificity': 0.9829092, 'f1': 0.983062, 'auroc': 0.9992119, 'binary_precision': 0.9711599, 'binary_recall': 0.9961415, 'binary_specificity': 0.969677, 'binary_f1_score': 0.9834921}
confusion matrix:
      0     1
0  1471    46
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.8254092, 'precision': 0.82774293, 'recall': 0.82455283, 'specificity': 0.82455283, 'f1': 0.8247781, 'auroc': 0.88026655, 'binary_precision': 0.8509532, 'binary_recall': 0.7806041, 'binary_specificity': 0.86850154, 'binary_f1_score': 0.81426203}
confusion matrix:
     0    1
0  568   86
1  138  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8224515, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82219064, 'auroc': 0.923121, 'binary_precision': 0.8310502, 'binary_recall': 0.8088889, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.81981987}
confusion matrix:
     0    1
0  188   37
1   43  182
new oracle model saved
early stop counter: 8
val acc:0.8254091739654541, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8222222328186035
after epoch: 21,now: 2024-07-29 03:31:03.497632,epoch time: 0:01:38.791502,used: 0:34:25.146481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9871302, 'recall': 0.9871302, 'specificity': 0.9871302, 'f1': 0.9869792, 'auroc': 0.99943614, 'binary_precision': 0.99934083, 'binary_recall': 0.9749196, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9869792}
confusion matrix:
      0     1
0  1516     1
1    39  1516
---- Validation: 
scalar performance:
{'acc': 0.7856586, 'precision': 0.8268523, 'recall': 0.78215873, 'specificity': 0.78215873, 'f1': 0.77719915, 'auroc': 0.8670399, 'binary_precision': 0.9381188, 'binary_recall': 0.6025437, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.7337851}
confusion matrix:
     0    1
0  629   25
1  250  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.86439425, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8271645, 'auroc': 0.9252889, 'binary_precision': 0.9745223, 'binary_recall': 0.68, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8010471}
confusion matrix:
     0    1
0  221    4
1   72  153
new oracle model saved
early stop counter: 9
val acc:0.785658597946167, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8311111330986023
after epoch: 22,now: 2024-07-29 03:32:41.448312,epoch time: 0:01:37.950680,used: 0:36:03.097161,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98909444, 'recall': 0.9888456, 'specificity': 0.9888456, 'f1': 0.9889281, 'auroc': 0.9997384, 'binary_precision': 0.982868, 'binary_recall': 0.9955013, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9891443}
confusion matrix:
      0     1
0  1489    27
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.83008575, 'precision': 0.833669, 'recall': 0.8290489, 'specificity': 0.8290489, 'f1': 0.82926416, 'auroc': 0.8818376, 'binary_precision': 0.86371684, 'binary_recall': 0.7758347, 'binary_specificity': 0.882263, 'binary_f1_score': 0.8174204}
confusion matrix:
     0    1
0  577   77
1  141  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8294159, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8288204, 'auroc': 0.9171951, 'binary_precision': 0.8425926, 'binary_recall': 0.8088889, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  191   34
1   43  182
early stop counter: 10
val acc:0.8300857543945312, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8311111330986023
after epoch: 23,now: 2024-07-29 03:34:21.650426,epoch time: 0:01:40.202114,used: 0:37:43.299275,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896053, 'recall': 0.98970246, 'specificity': 0.98970246, 'f1': 0.989583, 'auroc': 0.99972403, 'binary_precision': 0.99804175, 'binary_recall': 0.98138636, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.98964405}
confusion matrix:
      0     1
0  1511     3
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.7607171, 'precision': 0.81554997, 'recall': 0.75659996, 'specificity': 0.75659996, 'f1': 0.7478337, 'auroc': 0.8800727, 'binary_precision': 0.9423077, 'binary_recall': 0.54531, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.6908359}
confusion matrix:
     0    1
0  633   21
1  286  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.87127066, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.8264171, 'auroc': 0.9169382, 'binary_precision': 0.9933775, 'binary_recall': 0.6666667, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.79787236}
confusion matrix:
     0    1
0  224    1
1   75  150
early stop counter: 11
val acc:0.7607170939445496, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8311111330986023
after epoch: 24,now: 2024-07-29 03:35:58.044558,epoch time: 0:01:36.394132,used: 0:39:19.693407,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99516904, 'recall': 0.9950802, 'specificity': 0.9950802, 'f1': 0.995116, 'auroc': 0.9998262, 'binary_precision': 0.9923274, 'binary_recall': 0.9980707, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.99519074}
confusion matrix:
      0     1
0  1505    12
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.8144973, 'precision': 0.81785566, 'recall': 0.81345445, 'specificity': 0.81345445, 'f1': 0.8136003, 'auroc': 0.8690631, 'binary_precision': 0.8460177, 'binary_recall': 0.7599364, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.80066997}
confusion matrix:
     0    1
0  567   87
1  151  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8543769, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84830153, 'auroc': 0.9257679, 'binary_precision': 0.89847714, 'binary_recall': 0.7866667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.83886254}
confusion matrix:
     0    1
0  205   20
1   48  177
new oracle model saved
early stop counter: 12
val acc:0.8144972920417786, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 25,now: 2024-07-29 03:37:38.001462,epoch time: 0:01:39.956904,used: 0:40:59.650311,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921638, 'recall': 0.99223053, 'specificity': 0.99223053, 'f1': 0.99218667, 'auroc': 0.9997194, 'binary_precision': 0.9954751, 'binary_recall': 0.98908156, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.992268}
confusion matrix:
      0     1
0  1508     7
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.7147311, 'precision': 0.76368, 'recall': 0.7104294, 'specificity': 0.7104294, 'f1': 0.6981153, 'auroc': 0.8413851, 'binary_precision': 0.8725212, 'binary_recall': 0.48966613, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.6272912}
confusion matrix:
     0    1
0  609   45
1  321  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8126037, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7953514, 'auroc': 0.88841474, 'binary_precision': 0.8806818, 'binary_recall': 0.6888889, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.77306736}
confusion matrix:
     0    1
0  204   21
1   70  155
early stop counter: 13
val acc:0.7147310972213745, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 26,now: 2024-07-29 03:39:14.629295,epoch time: 0:01:36.627833,used: 0:42:36.278144,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98679113, 'recall': 0.9861481, 'specificity': 0.9861481, 'f1': 0.9863184, 'auroc': 0.9998105, 'binary_precision': 0.9749373, 'binary_recall': 0.9987163, 'binary_specificity': 0.97357994, 'binary_f1_score': 0.9866836}
confusion matrix:
      0     1
0  1474    40
1     2  1556
---- Validation: 
scalar performance:
{'acc': 0.80436474, 'precision': 0.8290627, 'recall': 0.801662, 'specificity': 0.801662, 'f1': 0.7995918, 'auroc': 0.86779964, 'binary_precision': 0.9144737, 'binary_recall': 0.6629571, 'binary_specificity': 0.940367, 'binary_f1_score': 0.76866364}
confusion matrix:
     0    1
0  615   39
1  212  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.81786567, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7485565, 'auroc': 0.89645433, 'binary_precision': 0.95348835, 'binary_recall': 0.5466667, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.69491524}
confusion matrix:
     0    1
0  219    6
1  102  123
early stop counter: 14
val acc:0.8043647408485413, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 27,now: 2024-07-29 03:40:52.345754,epoch time: 0:01:37.716459,used: 0:44:13.994603,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9836738, 'recall': 0.9836235, 'specificity': 0.9836235, 'f1': 0.9833984, 'auroc': 0.9998164, 'binary_precision': 0.9993373, 'binary_recall': 0.96790755, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9833714}
confusion matrix:
      0     1
0  1513     1
1    50  1508
---- Validation: 
scalar performance:
{'acc': 0.6780982, 'precision': 0.78454626, 'recall': 0.67203534, 'specificity': 0.67203534, 'f1': 0.6402803, 'auroc': 0.8858316, 'binary_precision': 0.9537815, 'binary_recall': 0.3608903, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.52364475}
confusion matrix:
     0    1
0  643   11
1  402  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5088889, 'precision': 0.75224215, 'recall': 0.5088889, 'specificity': 0.5088889, 'f1': 0.35278767, 'auroc': 0.8786963, 'binary_precision': 1.0, 'binary_recall': 0.017777778, 'binary_specificity': 1.0, 'binary_f1_score': 0.0349345}
confusion matrix:
     0  1
0  225  0
1  221  4
early stop counter: 15
val acc:0.678098201751709, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 28,now: 2024-07-29 03:42:29.662844,epoch time: 0:01:37.317090,used: 0:45:51.311693,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99348813, 'recall': 0.99348813, 'specificity': 0.99348813, 'f1': 0.99348813, 'auroc': 0.9998292, 'binary_precision': 0.99358565, 'binary_recall': 0.99358565, 'binary_specificity': 0.9933906, 'binary_f1_score': 0.99358565}
confusion matrix:
      0     1
0  1503    10
1    10  1549
---- Validation: 
scalar performance:
{'acc': 0.8028059, 'precision': 0.81361973, 'recall': 0.8009534, 'specificity': 0.8009534, 'f1': 0.80036044, 'auroc': 0.8501699, 'binary_precision': 0.8671875, 'binary_recall': 0.7058824, 'binary_specificity': 0.89602447, 'binary_f1_score': 0.7782647}
confusion matrix:
     0    1
0  586   68
1  185  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.81306934, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80824876, 'auroc': 0.8868543, 'binary_precision': 0.8492462, 'binary_recall': 0.7511111, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.7971698}
confusion matrix:
     0    1
0  195   30
1   56  169
early stop counter: 16
val acc:0.8028059005737305, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 29,now: 2024-07-29 03:44:08.034693,epoch time: 0:01:38.371849,used: 0:47:29.683542,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.9948732, 'recall': 0.99473727, 'specificity': 0.99473727, 'f1': 0.9947901, 'auroc': 0.9998733, 'binary_precision': 0.9910771, 'binary_recall': 0.99871546, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.99488163}
confusion matrix:
      0     1
0  1501    14
1     2  1555
---- Validation: 
scalar performance:
{'acc': 0.8191738, 'precision': 0.8293221, 'recall': 0.81743383, 'specificity': 0.81743383, 'f1': 0.8171493, 'auroc': 0.8681369, 'binary_precision': 0.88246626, 'binary_recall': 0.7281399, 'binary_specificity': 0.90672785, 'binary_f1_score': 0.7979094}
confusion matrix:
     0    1
0  593   61
1  171  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8023715, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.8021978, 'auroc': 0.8841481, 'binary_precision': 0.79565215, 'binary_recall': 0.81333333, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.8043956}
confusion matrix:
     0    1
0  178   47
1   42  183
early stop counter: 17
val acc:0.8191738128662109, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8199999928474426 / 0.8488888740539551
after epoch: 30,now: 2024-07-29 03:45:47.622382,epoch time: 0:01:39.587689,used: 0:49:09.271231,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_56_38_seed_3_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:09.271231 at 2024-07-29 03:45:47.622382
persisted model performance metric: 

scalar performance:
{'acc': 0.82, 'precision': 0.8222983, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81967854, 'auroc': 0.9081284, 'binary_precision': 0.84951454, 'binary_recall': 0.7777778, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8120649}
confusion matrix:
     0    1
0  194   31
1   50  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.8543769, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84830153, 'auroc': 0.9257679, 'binary_precision': 0.89847714, 'binary_recall': 0.7866667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.83886254}
confusion matrix:
     0    1
0  205   20
1   48  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454150 KiB |  13219 MiB | 295814 GiB | 295813 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454150 KiB |  13219 MiB | 295814 GiB | 295813 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 291683 GiB | 291682 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14488 MiB |  55246 MiB |  40766 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  55126 MiB |  40716 MiB |
|       from small pool |     70 MiB |     70 MiB |    120 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461305 KiB |   1260 MiB | 212167 GiB | 212167 GiB |
|       from large pool | 450704 KiB |   1252 MiB | 208650 GiB | 208649 GiB |
|       from small pool |  10601 KiB |     47 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51932 K  |   51931 K  |
|       from large pool |     187    |    1413    |   26403 K  |   26403 K  |
|       from small pool |    1123    |    1419    |   25529 K  |   25528 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51932 K  |   51931 K  |
|       from large pool |     187    |    1413    |   26403 K  |   26403 K  |
|       from small pool |    1123    |    1419    |   25529 K  |   25528 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    2354    |    1717    |
|       from large pool |     602    |     602    |    2294    |    1692    |
|       from small pool |      35    |      35    |      60    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     653    |   34656 K  |   34656 K  |
|       from large pool |      38    |     604    |   19645 K  |   19645 K  |
|       from small pool |      60    |     235    |   15011 K  |   15011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295814 GiB | 295814 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295814 GiB | 295814 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291683 GiB | 291683 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14488 MiB |  55246 MiB |  54352 MiB |
|       from large pool |    844 MiB |  14422 MiB |  55126 MiB |  54282 MiB |
|       from small pool |     50 MiB |     70 MiB |    120 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 212168 GiB | 212168 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 208650 GiB | 208650 GiB |
|       from small pool |      0 KiB |     47 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51932 K  |   51932 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25529 K  |   25529 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51932 K  |   51932 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25529 K  |   25529 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    2354    |    2291    |
|       from large pool |      38    |     602    |    2294    |    2256    |
|       from small pool |      25    |      35    |      60    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   34657 K  |   34657 K  |
|       from large pool |       3    |     604    |   19645 K  |   19645 K  |
|       from small pool |       0    |     235    |   15011 K  |   15011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295814 GiB | 295814 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295814 GiB | 295814 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291683 GiB | 291683 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14488 MiB |  55246 MiB |  54352 MiB |
|       from large pool |    844 MiB |  14422 MiB |  55126 MiB |  54282 MiB |
|       from small pool |     50 MiB |     70 MiB |    120 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 212168 GiB | 212168 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 208650 GiB | 208650 GiB |
|       from small pool |      0 KiB |     47 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51932 K  |   51932 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25529 K  |   25529 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51932 K  |   51932 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25529 K  |   25529 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    2354    |    2291    |
|       from large pool |      38    |     602    |    2294    |    2256    |
|       from small pool |      25    |      35    |      60    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   34657 K  |   34657 K  |
|       from large pool |       3    |     604    |   19645 K  |   19645 K  |
|       from small pool |       0    |     235    |   15011 K  |   15011 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368

 Experiment start at: 2024-07-29 03:46:33.743037
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91353625, 'precision': 0.9224684, 'recall': 0.91494775, 'specificity': 0.91494775, 'f1': 0.9132448, 'auroc': 0.9800525, 'binary_precision': 0.98877245, 'binary_recall': 0.83979654, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9082159}
confusion matrix:
      0     1
0  1500    15
1   252  1321
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8050672, 'recall': 0.80274665, 'specificity': 0.80274665, 'f1': 0.80277085, 'auroc': 0.873369, 'binary_precision': 0.8253425, 'binary_recall': 0.76265824, 'binary_specificity': 0.8428351, 'binary_f1_score': 0.7927632}
confusion matrix:
     0    1
0  547  102
1  150  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79620856, 'precision': 0.8072505, 'recall': 0.7962085, 'specificity': 0.7962085, 'f1': 0.79436094, 'auroc': 0.87143147, 'binary_precision': 0.86549705, 'binary_recall': 0.7014218, 'binary_specificity': 0.89099526, 'binary_f1_score': 0.7748691}
confusion matrix:
     0    1
0  188   23
1   63  148
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 03:48:12.105303,epoch time: 0:01:38.362266,used: 0:01:38.362266,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93134713, 'precision': 0.931358, 'recall': 0.9312949, 'specificity': 0.9312949, 'f1': 0.93132293, 'auroc': 0.98194575, 'binary_precision': 0.9308376, 'binary_recall': 0.9343949, 'binary_specificity': 0.928195, 'binary_f1_score': 0.93261284}
confusion matrix:
      0     1
0  1409   109
1   103  1467
---- Validation: 
scalar performance:
{'acc': 0.7642467, 'precision': 0.7727393, 'recall': 0.7653864, 'specificity': 0.7653864, 'f1': 0.7628871, 'auroc': 0.8429546, 'binary_precision': 0.7211796, 'binary_recall': 0.85126585, 'binary_specificity': 0.67950696, 'binary_f1_score': 0.7808418}
confusion matrix:
     0    1
0  441  208
1   94  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82227486, 'precision': 0.82234, 'recall': 0.8222749, 'specificity': 0.8222749, 'f1': 0.8222659, 'auroc': 0.8806406, 'binary_precision': 0.817757, 'binary_recall': 0.8293839, 'binary_specificity': 0.8151659, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  172   39
1   36  175
new oracle model saved
early stop counter: 1
val acc:0.7642467021942139, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8222748637199402
after epoch: 2,now: 2024-07-29 03:49:46.876246,epoch time: 0:01:34.770943,used: 0:03:13.133209,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95790154, 'precision': 0.95811903, 'recall': 0.95774066, 'specificity': 0.95774066, 'f1': 0.95787185, 'auroc': 0.9932512, 'binary_precision': 0.9517846, 'binary_recall': 0.96630645, 'binary_specificity': 0.94917494, 'binary_f1_score': 0.9589905}
confusion matrix:
      0     1
0  1438    77
1    53  1520
---- Validation: 
scalar performance:
{'acc': 0.77361435, 'precision': 0.78553057, 'recall': 0.77222747, 'specificity': 0.77222747, 'f1': 0.77059346, 'auroc': 0.85968673, 'binary_precision': 0.84063745, 'binary_recall': 0.6677215, 'binary_specificity': 0.8767334, 'binary_f1_score': 0.7442681}
confusion matrix:
     0    1
0  569   80
1  210  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.84232664, 'recall': 0.81990516, 'specificity': 0.81990516, 'f1': 0.8169072, 'auroc': 0.917814, 'binary_precision': 0.9299363, 'binary_recall': 0.6919431, 'binary_specificity': 0.9478673, 'binary_f1_score': 0.7934783}
confusion matrix:
     0    1
0  200   11
1   65  146
early stop counter: 2
val acc:0.7736143469810486, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8222748637199402
after epoch: 3,now: 2024-07-29 03:51:25.381476,epoch time: 0:01:38.505230,used: 0:04:51.638439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9352332, 'precision': 0.9402584, 'recall': 0.934341, 'specificity': 0.934341, 'f1': 0.93493795, 'auroc': 0.99566305, 'binary_precision': 0.8973913, 'binary_recall': 0.98535967, 'binary_specificity': 0.88332236, 'binary_f1_score': 0.9393204}
confusion matrix:
      0     1
0  1340   177
1    23  1548
---- Validation: 
scalar performance:
{'acc': 0.74160814, 'precision': 0.78104997, 'recall': 0.7440598, 'specificity': 0.7440598, 'f1': 0.73345804, 'auroc': 0.87961763, 'binary_precision': 0.67239404, 'binary_recall': 0.9287975, 'binary_specificity': 0.55932206, 'binary_f1_score': 0.7800665}
confusion matrix:
     0    1
0  363  286
1   45  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7867299, 'precision': 0.81195474, 'recall': 0.7867299, 'specificity': 0.7867299, 'f1': 0.7823296, 'auroc': 0.9167584, 'binary_precision': 0.72324723, 'binary_recall': 0.92890996, 'binary_specificity': 0.6445498, 'binary_f1_score': 0.813278}
confusion matrix:
     0    1
0  136   75
1   15  196
early stop counter: 3
val acc:0.7416081428527832, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8222748637199402
after epoch: 4,now: 2024-07-29 03:53:03.003920,epoch time: 0:01:37.622444,used: 0:06:29.260883,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9650259, 'precision': 0.96609145, 'recall': 0.9646363, 'specificity': 0.9646363, 'f1': 0.964973, 'auroc': 0.99638873, 'binary_precision': 0.94801223, 'binary_recall': 0.98537827, 'binary_specificity': 0.9438944, 'binary_f1_score': 0.96633416}
confusion matrix:
      0     1
0  1430    85
1    23  1550
---- Validation: 
scalar performance:
{'acc': 0.73067915, 'precision': 0.75469166, 'recall': 0.7326729, 'specificity': 0.7326729, 'f1': 0.7252544, 'auroc': 0.83014274, 'binary_precision': 0.6731001, 'binary_recall': 0.8829114, 'binary_specificity': 0.58243454, 'binary_f1_score': 0.7638604}
confusion matrix:
     0    1
0  378  271
1   74  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7914692, 'precision': 0.8135556, 'recall': 0.7914692, 'specificity': 0.7914692, 'f1': 0.7877312, 'auroc': 0.90770644, 'binary_precision': 0.7303371, 'binary_recall': 0.9241706, 'binary_specificity': 0.65876776, 'binary_f1_score': 0.8158996}
confusion matrix:
     0    1
0  139   72
1   16  195
early stop counter: 4
val acc:0.7306791543960571, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8222748637199402
after epoch: 5,now: 2024-07-29 03:54:41.108255,epoch time: 0:01:38.104335,used: 0:08:07.365218,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97700775, 'precision': 0.9769652, 'recall': 0.97717035, 'specificity': 0.97717035, 'f1': 0.97700375, 'auroc': 0.9981111, 'binary_precision': 0.98518044, 'binary_recall': 0.9695625, 'binary_specificity': 0.9847783, 'binary_f1_score': 0.9773091}
confusion matrix:
      0     1
0  1488    23
1    48  1529
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.7975486, 'recall': 0.7603848, 'specificity': 0.7603848, 'f1': 0.75442064, 'auroc': 0.8578192, 'binary_precision': 0.8961353, 'binary_recall': 0.58702534, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.70936906}
confusion matrix:
     0    1
0  606   43
1  261  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.8265056, 'recall': 0.8199052, 'specificity': 0.8199052, 'f1': 0.81899047, 'auroc': 0.9026302, 'binary_precision': 0.8729282, 'binary_recall': 0.7488152, 'binary_specificity': 0.89099526, 'binary_f1_score': 0.8061225}
confusion matrix:
     0    1
0  188   23
1   53  158
early stop counter: 5
val acc:0.7626854181289673, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8222748637199402
after epoch: 6,now: 2024-07-29 03:56:19.902674,epoch time: 0:01:38.794419,used: 0:09:46.159637,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.9831221, 'recall': 0.9832608, 'specificity': 0.9832608, 'f1': 0.9831581, 'auroc': 0.9985914, 'binary_precision': 0.98906046, 'binary_recall': 0.97773534, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9833653}
confusion matrix:
      0     1
0  1499    17
1    35  1537
---- Validation: 
scalar performance:
{'acc': 0.7494145, 'precision': 0.7820376, 'recall': 0.74712193, 'specificity': 0.74712193, 'f1': 0.74076426, 'auroc': 0.8572682, 'binary_precision': 0.8746988, 'binary_recall': 0.5743671, 'binary_specificity': 0.91987675, 'binary_f1_score': 0.6934098}
confusion matrix:
     0    1
0  597   52
1  269  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.84582007, 'recall': 0.8293839, 'specificity': 0.8293839, 'f1': 0.82733226, 'auroc': 0.91276026, 'binary_precision': 0.92121214, 'binary_recall': 0.7203792, 'binary_specificity': 0.93838865, 'binary_f1_score': 0.80851066}
confusion matrix:
     0    1
0  198   13
1   59  152
new oracle model saved
early stop counter: 6
val acc:0.7494145035743713, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.829383909702301
after epoch: 7,now: 2024-07-29 03:57:58.968076,epoch time: 0:01:39.065402,used: 0:11:25.225039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97603625, 'precision': 0.9762819, 'recall': 0.9763442, 'specificity': 0.9763442, 'f1': 0.9760362, 'auroc': 0.9979496, 'binary_precision': 0.99276793, 'binary_recall': 0.95994914, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9760828}
confusion matrix:
      0     1
0  1504    11
1    63  1510
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8057107, 'recall': 0.8026638, 'specificity': 0.8026638, 'f1': 0.8026378, 'auroc': 0.8809024, 'binary_precision': 0.8298611, 'binary_recall': 0.7563291, 'binary_specificity': 0.8489985, 'binary_f1_score': 0.7913907}
confusion matrix:
     0    1
0  551   98
1  154  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81042653, 'precision': 0.8245392, 'recall': 0.81042653, 'specificity': 0.81042653, 'f1': 0.808343, 'auroc': 0.9079087, 'binary_precision': 0.89221555, 'binary_recall': 0.70616114, 'binary_specificity': 0.9146919, 'binary_f1_score': 0.78835976}
confusion matrix:
     0    1
0  193   18
1   62  149
early stop counter: 7
val acc:0.8032786846160889, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.829383909702301
after epoch: 8,now: 2024-07-29 03:59:34.868634,epoch time: 0:01:35.900558,used: 0:13:01.125597,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9812176, 'precision': 0.9812176, 'recall': 0.98137593, 'specificity': 0.98137593, 'f1': 0.9812161, 'auroc': 0.9980018, 'binary_precision': 0.990285, 'binary_recall': 0.9726463, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.98138636}
confusion matrix:
      0     1
0  1501    15
1    43  1529
---- Validation: 
scalar performance:
{'acc': 0.69633096, 'precision': 0.76936865, 'recall': 0.6928271, 'specificity': 0.6928271, 'f1': 0.67183286, 'auroc': 0.855191, 'binary_precision': 0.9063545, 'binary_recall': 0.42879745, 'binary_specificity': 0.9568567, 'binary_f1_score': 0.5821697}
confusion matrix:
     0    1
0  621   28
1  361  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7890995, 'precision': 0.82840884, 'recall': 0.7890995, 'specificity': 0.7890995, 'f1': 0.78259385, 'auroc': 0.89378047, 'binary_precision': 0.942029, 'binary_recall': 0.6161137, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.7449857}
confusion matrix:
     0    1
0  203    8
1   81  130
early stop counter: 8
val acc:0.6963309645652771, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.829383909702301
after epoch: 9,now: 2024-07-29 04:01:12.713581,epoch time: 0:01:37.844947,used: 0:14:38.970544,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9608161, 'precision': 0.9628465, 'recall': 0.9602016, 'specificity': 0.9602016, 'f1': 0.9607196, 'auroc': 0.9974011, 'binary_precision': 0.9369369, 'binary_recall': 0.9898477, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.9626658}
confusion matrix:
      0     1
0  1407   105
1    16  1560
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.7925943, 'recall': 0.7877906, 'specificity': 0.7877906, 'f1': 0.7861717, 'auroc': 0.89059055, 'binary_precision': 0.7482711, 'binary_recall': 0.85601264, 'binary_specificity': 0.71956855, 'binary_f1_score': 0.79852396}
confusion matrix:
     0    1
0  467  182
1   91  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82227486, 'precision': 0.82938474, 'recall': 0.8222749, 'specificity': 0.8222749, 'f1': 0.82131064, 'auroc': 0.91496146, 'binary_precision': 0.78099173, 'binary_recall': 0.8957346, 'binary_specificity': 0.7488152, 'binary_f1_score': 0.8344371}
confusion matrix:
     0    1
0  158   53
1   22  189
early stop counter: 9
val acc:0.7868852615356445, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.829383909702301
after epoch: 10,now: 2024-07-29 04:02:48.285212,epoch time: 0:01:35.571631,used: 0:16:14.542175,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97700775, 'precision': 0.9775122, 'recall': 0.97736895, 'specificity': 0.97736895, 'f1': 0.9770075, 'auroc': 0.99821705, 'binary_precision': 0.99800795, 'binary_recall': 0.95671546, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9769256}
confusion matrix:
      0     1
0  1514     3
1    68  1503
---- Validation: 
scalar performance:
{'acc': 0.67837626, 'precision': 0.72896945, 'recall': 0.6751904, 'specificity': 0.6751904, 'f1': 0.6571128, 'auroc': 0.82795763, 'binary_precision': 0.8333333, 'binary_recall': 0.43512657, 'binary_specificity': 0.91525424, 'binary_f1_score': 0.57172555}
confusion matrix:
     0    1
0  594   55
1  357  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.84902257, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.83768135, 'auroc': 0.9019339, 'binary_precision': 0.9085714, 'binary_recall': 0.7535545, 'binary_specificity': 0.9241706, 'binary_f1_score': 0.82383424}
confusion matrix:
     0    1
0  195   16
1   52  159
new oracle model saved
early stop counter: 10
val acc:0.6783762574195862, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8388625383377075
after epoch: 11,now: 2024-07-29 04:04:26.456869,epoch time: 0:01:38.171657,used: 0:17:52.713832,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97409326, 'precision': 0.97485423, 'recall': 0.97457445, 'specificity': 0.97457445, 'f1': 0.97409236, 'auroc': 0.9986278, 'binary_precision': 0.99933153, 'binary_recall': 0.94980943, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9739413}
confusion matrix:
      0     1
0  1513     1
1    79  1495
---- Validation: 
scalar performance:
{'acc': 0.6580796, 'precision': 0.7559869, 'recall': 0.65391624, 'specificity': 0.65391624, 'f1': 0.6184161, 'auroc': 0.885759, 'binary_precision': 0.91101694, 'binary_recall': 0.34018987, 'binary_specificity': 0.96764255, 'binary_f1_score': 0.49539167}
confusion matrix:
     0    1
0  628   21
1  417  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53317535, 'precision': 0.7585784, 'recall': 0.53317535, 'specificity': 0.53317535, 'f1': 0.4030946, 'auroc': 0.9150963, 'binary_precision': 1.0, 'binary_recall': 0.06635071, 'binary_specificity': 1.0, 'binary_f1_score': 0.12444445}
confusion matrix:
     0   1
0  211   0
1  197  14
early stop counter: 11
val acc:0.6580796241760254, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8388625383377075
after epoch: 12,now: 2024-07-29 04:06:03.011243,epoch time: 0:01:36.554374,used: 0:19:29.268206,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9812176, 'precision': 0.9812887, 'recall': 0.9814422, 'specificity': 0.9814422, 'f1': 0.9812168, 'auroc': 0.9987403, 'binary_precision': 0.99348533, 'binary_recall': 0.96948504, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.98133844}
confusion matrix:
      0     1
0  1505    10
1    48  1525
---- Validation: 
scalar performance:
{'acc': 0.68384075, 'precision': 0.7443265, 'recall': 0.6804797, 'specificity': 0.6804797, 'f1': 0.6604824, 'auroc': 0.8069205, 'binary_precision': 0.8626198, 'binary_recall': 0.4272152, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.5714286}
confusion matrix:
     0    1
0  606   43
1  362  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77488154, 'precision': 0.81463385, 'recall': 0.7748815, 'specificity': 0.7748815, 'f1': 0.7675389, 'auroc': 0.9050336, 'binary_precision': 0.9264706, 'binary_recall': 0.5971564, 'binary_specificity': 0.9526066, 'binary_f1_score': 0.7262248}
confusion matrix:
     0    1
0  201   10
1   85  126
early stop counter: 12
val acc:0.6838407516479492, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8388625383377075
after epoch: 13,now: 2024-07-29 04:07:39.390300,epoch time: 0:01:36.379057,used: 0:21:05.647263,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9812176, 'precision': 0.98166275, 'recall': 0.98100793, 'specificity': 0.98100793, 'f1': 0.98120165, 'auroc': 0.99850917, 'binary_precision': 0.97075295, 'binary_recall': 0.99299806, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.9817495}
confusion matrix:
      0     1
0  1470    47
1    11  1560
---- Validation: 
scalar performance:
{'acc': 0.76346606, 'precision': 0.772633, 'recall': 0.76221204, 'specificity': 0.76221204, 'f1': 0.7608491, 'auroc': 0.8536453, 'binary_precision': 0.8194175, 'binary_recall': 0.6677215, 'binary_specificity': 0.8567026, 'binary_f1_score': 0.73583263}
confusion matrix:
     0    1
0  556   93
1  210  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8554502, 'precision': 0.85609806, 'recall': 0.8554502, 'specificity': 0.8554502, 'f1': 0.85538447, 'auroc': 0.92098117, 'binary_precision': 0.84090906, 'binary_recall': 0.87677723, 'binary_specificity': 0.8341232, 'binary_f1_score': 0.85846865}
confusion matrix:
     0    1
0  176   35
1   26  185
new oracle model saved
early stop counter: 13
val acc:0.7634660601615906, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8554502129554749
after epoch: 14,now: 2024-07-29 04:09:09.584941,epoch time: 0:01:30.194641,used: 0:22:35.841904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9912565, 'precision': 0.9912213, 'recall': 0.99130476, 'specificity': 0.99130476, 'f1': 0.9912546, 'auroc': 0.9993954, 'binary_precision': 0.99423814, 'binary_recall': 0.9885423, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.99138206}
confusion matrix:
      0     1
0  1508     9
1    18  1553
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.751367, 'recall': 0.7004032, 'specificity': 0.7004032, 'f1': 0.68650496, 'auroc': 0.8458266, 'binary_precision': 0.85795456, 'binary_recall': 0.4778481, 'binary_specificity': 0.9229584, 'binary_f1_score': 0.61382115}
confusion matrix:
     0    1
0  599   50
1  330  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.87247133, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.84849817, 'auroc': 0.9370634, 'binary_precision': 0.9625, 'binary_recall': 0.7298578, 'binary_specificity': 0.971564, 'binary_f1_score': 0.8301887}
confusion matrix:
     0    1
0  205    6
1   57  154
early stop counter: 14
val acc:0.7033567428588867, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8554502129554749
after epoch: 15,now: 2024-07-29 04:10:36.571294,epoch time: 0:01:26.986353,used: 0:24:02.828257,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9896373, 'precision': 0.9895953, 'recall': 0.9897162, 'specificity': 0.9897162, 'f1': 0.98963535, 'auroc': 0.9995011, 'binary_precision': 0.99422336, 'binary_recall': 0.98536897, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9897764}
confusion matrix:
      0     1
0  1507     9
1    23  1549
---- Validation: 
scalar performance:
{'acc': 0.7673693, 'precision': 0.80144095, 'recall': 0.76511085, 'specificity': 0.76511085, 'f1': 0.75955033, 'auroc': 0.8826097, 'binary_precision': 0.8995215, 'binary_recall': 0.5949367, 'binary_specificity': 0.93528503, 'binary_f1_score': 0.7161905}
confusion matrix:
     0    1
0  607   42
1  256  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8436019, 'precision': 0.86963874, 'recall': 0.84360194, 'specificity': 0.84360194, 'f1': 0.8407984, 'auroc': 0.92864037, 'binary_precision': 0.9677419, 'binary_recall': 0.7109005, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.8196721}
confusion matrix:
     0    1
0  206    5
1   61  150
early stop counter: 15
val acc:0.767369270324707, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8554502129554749
after epoch: 16,now: 2024-07-29 04:12:13.388813,epoch time: 0:01:36.817519,used: 0:25:39.645776,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.98872423, 'recall': 0.9888606, 'specificity': 0.9888606, 'f1': 0.9886654, 'auroc': 0.9997797, 'binary_precision': 1.0, 'binary_recall': 0.9777212, 'binary_specificity': 1.0, 'binary_f1_score': 0.98873514}
confusion matrix:
      0     1
0  1517     0
1    35  1536
---- Validation: 
scalar performance:
{'acc': 0.58860266, 'precision': 0.7103678, 'recall': 0.5834634, 'specificity': 0.5834634, 'f1': 0.5125462, 'auroc': 0.81553173, 'binary_precision': 0.86713284, 'binary_recall': 0.19620253, 'binary_specificity': 0.97072417, 'binary_f1_score': 0.32}
confusion matrix:
     0    1
0  630   19
1  508  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6042654, 'precision': 0.7137201, 'recall': 0.6042654, 'specificity': 0.6042654, 'f1': 0.54615766, 'auroc': 0.8764852, 'binary_precision': 0.8666667, 'binary_recall': 0.24644549, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.38376382}
confusion matrix:
     0   1
0  203   8
1  159  52
early stop counter: 16
val acc:0.5886026620864868, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8554502129554749
after epoch: 17,now: 2024-07-29 04:13:46.368564,epoch time: 0:01:32.979751,used: 0:27:12.625527,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9734456, 'precision': 0.97434294, 'recall': 0.97391856, 'specificity': 0.97391856, 'f1': 0.97344375, 'auroc': 0.99952126, 'binary_precision': 1.0, 'binary_recall': 0.9478372, 'binary_specificity': 1.0, 'binary_f1_score': 0.97322017}
confusion matrix:
      0     1
0  1516     0
1    82  1490
---- Validation: 
scalar performance:
{'acc': 0.6198283, 'precision': 0.7484748, 'recall': 0.61498463, 'specificity': 0.61498463, 'f1': 0.5583312, 'auroc': 0.8017105, 'binary_precision': 0.9239766, 'binary_recall': 0.25, 'binary_specificity': 0.9799692, 'binary_f1_score': 0.39352426}
confusion matrix:
     0    1
0  636   13
1  474  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59952605, 'precision': 0.75618637, 'recall': 0.59952605, 'specificity': 0.59952605, 'f1': 0.52725387, 'auroc': 0.9095259, 'binary_precision': 0.95652175, 'binary_recall': 0.2085308, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.34241244}
confusion matrix:
     0   1
0  209   2
1  167  44
early stop counter: 17
val acc:0.6198282837867737, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8554502129554749
after epoch: 18,now: 2024-07-29 04:15:21.891734,epoch time: 0:01:35.523170,used: 0:28:48.148697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97927463, 'precision': 0.9796202, 'recall': 0.9796202, 'specificity': 0.9796202, 'f1': 0.97927463, 'auroc': 0.99901474, 'binary_precision': 0.9980198, 'binary_recall': 0.9612206, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.97927463}
confusion matrix:
      0     1
0  1512     3
1    61  1512
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.8134145, 'recall': 0.76319706, 'specificity': 0.76319706, 'f1': 0.75533766, 'auroc': 0.9109664, 'binary_precision': 0.9322917, 'binary_recall': 0.5664557, 'binary_specificity': 0.95993835, 'binary_f1_score': 0.7047245}
confusion matrix:
     0    1
0  623   26
1  274  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7796208, 'precision': 0.84351546, 'recall': 0.7796209, 'specificity': 0.7796209, 'f1': 0.76887333, 'auroc': 0.93394125, 'binary_precision': 0.9916667, 'binary_recall': 0.56398106, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.71903324}
confusion matrix:
     0    1
0  210    1
1   92  119
early stop counter: 18
val acc:0.7658079862594604, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.7962085604667664 / 0.8554502129554749
after epoch: 19,now: 2024-07-29 04:16:54.118098,epoch time: 0:01:32.226364,used: 0:30:20.375061,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9912565, 'precision': 0.9912304, 'recall': 0.991283, 'specificity': 0.991283, 'f1': 0.9912541, 'auroc': 0.99970627, 'binary_precision': 0.99298024, 'binary_recall': 0.9898219, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9913986}
confusion matrix:
      0     1
0  1505    11
1    16  1556
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.83371353, 'recall': 0.82739997, 'specificity': 0.82739997, 'f1': 0.8272688, 'auroc': 0.9045074, 'binary_precision': 0.8731884, 'binary_recall': 0.76265824, 'binary_specificity': 0.89214176, 'binary_f1_score': 0.8141892}
confusion matrix:
     0    1
0  579   70
1  150  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7014218, 'precision': 0.7844568, 'recall': 0.7014218, 'specificity': 0.7014218, 'f1': 0.6779172, 'auroc': 0.8909503, 'binary_precision': 0.9381443, 'binary_recall': 0.43127963, 'binary_specificity': 0.971564, 'binary_f1_score': 0.59090906}
confusion matrix:
     0   1
0  205   6
1  120  91
better model found
persisted
after epoch: 20,now: 2024-07-29 04:18:28.422096,epoch time: 0:01:34.303998,used: 0:31:54.679059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98996115, 'precision': 0.9899466, 'recall': 0.99008375, 'specificity': 0.99008375, 'f1': 0.9899603, 'auroc': 0.9992351, 'binary_precision': 0.99741435, 'binary_recall': 0.98280257, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.99005455}
confusion matrix:
      0     1
0  1514     4
1    27  1543
---- Validation: 
scalar performance:
{'acc': 0.754879, 'precision': 0.7701818, 'recall': 0.75326085, 'specificity': 0.75326085, 'f1': 0.75053704, 'auroc': 0.8521435, 'binary_precision': 0.83125, 'binary_recall': 0.6313291, 'binary_specificity': 0.8751926, 'binary_f1_score': 0.71762586}
confusion matrix:
     0    1
0  568   81
1  233  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.8535779, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.85040766, 'auroc': 0.92235124, 'binary_precision': 0.8854167, 'binary_recall': 0.8056872, 'binary_specificity': 0.8957346, 'binary_f1_score': 0.84367245}
confusion matrix:
     0    1
0  189   22
1   41  170
early stop counter: 1
val acc:0.7548789978027344, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7014217972755432 / 0.8554502129554749
after epoch: 21,now: 2024-07-29 04:19:51.842558,epoch time: 0:01:23.420462,used: 0:33:18.099521,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9906088, 'precision': 0.9905691, 'recall': 0.9907056, 'specificity': 0.9907056, 'f1': 0.9906073, 'auroc': 0.999611, 'binary_precision': 0.9961415, 'binary_recall': 0.98536897, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.990726}
confusion matrix:
      0     1
0  1510     6
1    23  1549
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.8148955, 'recall': 0.777624, 'specificity': 0.777624, 'f1': 0.7725921, 'auroc': 0.89408064, 'binary_precision': 0.9166667, 'binary_recall': 0.60917723, 'binary_specificity': 0.94607085, 'binary_f1_score': 0.73193926}
confusion matrix:
     0    1
0  614   35
1  247  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.8627125, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.84682393, 'auroc': 0.93322253, 'binary_precision': 0.93491125, 'binary_recall': 0.7488152, 'binary_specificity': 0.9478673, 'binary_f1_score': 0.83157897}
confusion matrix:
     0    1
0  200   11
1   53  158
early stop counter: 2
val acc:0.7798594832420349, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7014217972755432 / 0.8554502129554749
after epoch: 22,now: 2024-07-29 04:21:27.406134,epoch time: 0:01:35.563576,used: 0:34:53.663097,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.990285, 'precision': 0.9902618, 'recall': 0.99040663, 'specificity': 0.99040663, 'f1': 0.99028397, 'auroc': 0.9994839, 'binary_precision': 0.9974177, 'binary_recall': 0.98345006, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.99038464}
confusion matrix:
      0     1
0  1513     4
1    26  1545
---- Validation: 
scalar performance:
{'acc': 0.587822, 'precision': 0.7358226, 'recall': 0.5824857, 'specificity': 0.5824857, 'f1': 0.50461423, 'auroc': 0.8683491, 'binary_precision': 0.91935486, 'binary_recall': 0.18037975, 'binary_specificity': 0.98459166, 'binary_f1_score': 0.3015873}
confusion matrix:
     0    1
0  639   10
1  518  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51421803, 'precision': 0.61081934, 'recall': 0.51421803, 'specificity': 0.51421803, 'f1': 0.37885478, 'auroc': 0.9037982, 'binary_precision': 0.71428573, 'binary_recall': 0.047393367, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.08888889}
confusion matrix:
     0   1
0  207   4
1  201  10
early stop counter: 3
val acc:0.5878220200538635, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7014217972755432 / 0.8554502129554749
after epoch: 23,now: 2024-07-29 04:23:03.978607,epoch time: 0:01:36.572473,used: 0:36:30.235570,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9915803, 'precision': 0.9915326, 'recall': 0.9916779, 'specificity': 0.9916779, 'f1': 0.9915786, 'auroc': 0.99934924, 'binary_precision': 0.99679077, 'binary_recall': 0.9866582, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.99169856}
confusion matrix:
      0     1
0  1509     5
1    21  1553
---- Validation: 
scalar performance:
{'acc': 0.7728337, 'precision': 0.79628164, 'recall': 0.770939, 'specificity': 0.770939, 'f1': 0.7673881, 'auroc': 0.8859827, 'binary_precision': 0.87637967, 'binary_recall': 0.6281645, 'binary_specificity': 0.9137134, 'binary_f1_score': 0.7317972}
confusion matrix:
     0    1
0  593   56
1  235  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7843602, 'precision': 0.8280473, 'recall': 0.7843602, 'specificity': 0.7843602, 'f1': 0.77693355, 'auroc': 0.9139956, 'binary_precision': 0.9477612, 'binary_recall': 0.60189575, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.7362319}
confusion matrix:
     0    1
0  204    7
1   84  127
early stop counter: 4
val acc:0.7728337049484253, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7014217972755432 / 0.8554502129554749
after epoch: 24,now: 2024-07-29 04:24:34.131265,epoch time: 0:01:30.152658,used: 0:38:00.388228,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9893135, 'precision': 0.9892966, 'recall': 0.98932683, 'specificity': 0.98932683, 'f1': 0.98931074, 'auroc': 0.9995774, 'binary_precision': 0.99042755, 'binary_recall': 0.98853505, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9894804}
confusion matrix:
      0     1
0  1503    15
1    18  1552
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8253057, 'recall': 0.7853904, 'specificity': 0.7853904, 'f1': 0.78040075, 'auroc': 0.9189893, 'binary_precision': 0.9326923, 'binary_recall': 0.613924, 'binary_specificity': 0.9568567, 'binary_f1_score': 0.740458}
confusion matrix:
     0    1
0  621   28
1  244  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.86227036, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.81997, 'auroc': 0.93625474, 'binary_precision': 0.97902095, 'binary_recall': 0.6635071, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.79096043}
confusion matrix:
     0    1
0  208    3
1   71  140
early stop counter: 5
val acc:0.7876659035682678, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7014217972755432 / 0.8554502129554749
after epoch: 25,now: 2024-07-29 04:26:06.744803,epoch time: 0:01:32.613538,used: 0:39:33.001766,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9893135, 'precision': 0.989287, 'recall': 0.98933935, 'specificity': 0.98933935, 'f1': 0.98931056, 'auroc': 0.99957746, 'binary_precision': 0.99106574, 'binary_recall': 0.9879135, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9894871}
confusion matrix:
      0     1
0  1502    14
1    19  1553
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8010932, 'recall': 0.78624004, 'specificity': 0.78624004, 'f1': 0.7846739, 'auroc': 0.88594913, 'binary_precision': 0.8614458, 'binary_recall': 0.6787975, 'binary_specificity': 0.8936826, 'binary_f1_score': 0.75929207}
confusion matrix:
     0    1
0  580   69
1  203  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.84684, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.8379306, 'auroc': 0.91496146, 'binary_precision': 0.89944136, 'binary_recall': 0.76303315, 'binary_specificity': 0.9146919, 'binary_f1_score': 0.825641}
confusion matrix:
     0    1
0  193   18
1   50  161
early stop counter: 6
val acc:0.7876659035682678, best validation acc: 0.8282591700553894, corresponding to test acc:                         0.7014217972755432 / 0.8554502129554749
after epoch: 26,now: 2024-07-29 04:27:42.588295,epoch time: 0:01:35.843492,used: 0:41:08.845258,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98996115, 'precision': 0.99004674, 'recall': 0.9898907, 'specificity': 0.9898907, 'f1': 0.98995614, 'auroc': 0.9996123, 'binary_precision': 0.98674244, 'binary_recall': 0.99364275, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.99018055}
confusion matrix:
      0     1
0  1494    21
1    10  1563
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.84494084, 'recall': 0.83416796, 'specificity': 0.83416796, 'f1': 0.8337772, 'auroc': 0.9098394, 'binary_precision': 0.89943075, 'binary_recall': 0.75, 'binary_specificity': 0.9183359, 'binary_f1_score': 0.8179465}
confusion matrix:
     0    1
0  596   53
1  158  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8649289, 'precision': 0.87195516, 'recall': 0.86492896, 'specificity': 0.86492896, 'f1': 0.86428803, 'auroc': 0.9207115, 'binary_precision': 0.9230769, 'binary_recall': 0.79620856, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8549619}
confusion matrix:
     0    1
0  197   14
1   43  168
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-29 04:29:19.231371,epoch time: 0:01:36.643076,used: 0:42:45.488334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.9888744, 'recall': 0.98853403, 'specificity': 0.98853403, 'f1': 0.98865837, 'auroc': 0.99965465, 'binary_precision': 0.98243415, 'binary_recall': 0.9955499, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.9889485}
confusion matrix:
      0     1
0  1487    28
1     7  1566
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.8672208, 'recall': 0.85769486, 'specificity': 0.85769486, 'f1': 0.8576157, 'auroc': 0.92792463, 'binary_precision': 0.9199255, 'binary_recall': 0.7816456, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.8451668}
confusion matrix:
     0    1
0  606   43
1  138  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86018956, 'precision': 0.87038064, 'recall': 0.86018956, 'specificity': 0.86018956, 'f1': 0.8592212, 'auroc': 0.9293367, 'binary_precision': 0.9318182, 'binary_recall': 0.7772512, 'binary_specificity': 0.943128, 'binary_f1_score': 0.84754527}
confusion matrix:
     0    1
0  199   12
1   47  164
better model found
persisted
after epoch: 28,now: 2024-07-29 04:30:55.680539,epoch time: 0:01:36.449168,used: 0:44:21.937502,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9896373, 'precision': 0.98964596, 'recall': 0.9896221, 'specificity': 0.9896221, 'f1': 0.9896337, 'auroc': 0.9995687, 'binary_precision': 0.9891995, 'binary_recall': 0.990458, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.98982835}
confusion matrix:
      0     1
0  1499    17
1    15  1557
---- Validation: 
scalar performance:
{'acc': 0.6612022, 'precision': 0.7416791, 'recall': 0.6573087, 'specificity': 0.6573087, 'f1': 0.6271748, 'auroc': 0.82709277, 'binary_precision': 0.8778626, 'binary_recall': 0.36392406, 'binary_specificity': 0.95069337, 'binary_f1_score': 0.51454145}
confusion matrix:
     0    1
0  617   32
1  402  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.83257985, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.80167806, 'auroc': 0.8932414, 'binary_precision': 0.92715234, 'binary_recall': 0.6635071, 'binary_specificity': 0.9478673, 'binary_f1_score': 0.77348065}
confusion matrix:
     0    1
0  200   11
1   71  140
early stop counter: 1
val acc:0.6612021923065186, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8601895570755005 / 0.8649289011955261
after epoch: 29,now: 2024-07-29 04:32:31.923308,epoch time: 0:01:36.242769,used: 0:45:58.180271,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.9886417, 'recall': 0.9886899, 'specificity': 0.9886899, 'f1': 0.98866314, 'auroc': 0.99950486, 'binary_precision': 0.99041533, 'binary_recall': 0.9872612, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9888357}
confusion matrix:
      0     1
0  1503    15
1    20  1550
---- Validation: 
scalar performance:
{'acc': 0.7712724, 'precision': 0.8141548, 'recall': 0.76879716, 'specificity': 0.76879716, 'f1': 0.7620645, 'auroc': 0.89374113, 'binary_precision': 0.9269521, 'binary_recall': 0.5822785, 'binary_specificity': 0.9553159, 'binary_f1_score': 0.7152575}
confusion matrix:
     0    1
0  620   29
1  264  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.82711214, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.80245256, 'auroc': 0.89458907, 'binary_precision': 0.91082805, 'binary_recall': 0.67772514, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.777174}
confusion matrix:
     0    1
0  197   14
1   68  143
early stop counter: 2
val acc:0.7712724208831787, best validation acc: 0.858704149723053, corresponding to test acc:                         0.8601895570755005 / 0.8649289011955261
after epoch: 30,now: 2024-07-29 04:34:09.013007,epoch time: 0:01:37.089699,used: 0:47:35.269970,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_46_33_seed_4_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:35.269970 at 2024-07-29 04:34:09.013007
persisted model performance metric: 

scalar performance:
{'acc': 0.86018956, 'precision': 0.87038064, 'recall': 0.86018956, 'specificity': 0.86018956, 'f1': 0.8592212, 'auroc': 0.9293367, 'binary_precision': 0.9318182, 'binary_recall': 0.7772512, 'binary_specificity': 0.943128, 'binary_f1_score': 0.84754527}
confusion matrix:
     0    1
0  199   12
1   47  164
oracle model performance metric: 

scalar performance:
{'acc': 0.8649289, 'precision': 0.87195516, 'recall': 0.86492896, 'specificity': 0.86492896, 'f1': 0.86428803, 'auroc': 0.9207115, 'binary_precision': 0.9230769, 'binary_recall': 0.79620856, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8549619}
confusion matrix:
     0    1
0  197   14
1   43  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454144 KiB |  13219 MiB | 367635 GiB | 367634 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 363283 GiB | 363282 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454144 KiB |  13219 MiB | 367635 GiB | 367634 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 363283 GiB | 363282 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 362396 GiB | 362395 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  68828 MiB |  54352 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  68692 MiB |  54282 MiB |
|       from small pool |     66 MiB |     70 MiB |    136 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 434687 KiB |   1260 MiB | 261988 GiB | 261987 GiB |
|       from large pool | 424080 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |  10607 KiB |     47 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64615 K  |   64614 K  |
|       from large pool |     187    |    1413    |   32814 K  |   32814 K  |
|       from small pool |    1111    |    1419    |   31801 K  |   31800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64615 K  |   64614 K  |
|       from large pool |     187    |    1413    |   32814 K  |   32814 K  |
|       from small pool |    1111    |    1419    |   31801 K  |   31800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    2926    |    2291    |
|       from large pool |     602    |     602    |    2858    |    2256    |
|       from small pool |      33    |      35    |      68    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |     653    |   42986 K  |   42986 K  |
|       from large pool |      36    |     604    |   24165 K  |   24165 K  |
|       from small pool |      59    |     235    |   18821 K  |   18821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367635 GiB | 367635 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367635 GiB | 367635 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362396 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    868 MiB |  14488 MiB |  68828 MiB |  67960 MiB |
|       from large pool |    818 MiB |  14422 MiB |  68692 MiB |  67874 MiB |
|       from small pool |     50 MiB |     70 MiB |    136 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 261988 GiB | 261988 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |      0 KiB |     47 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64615 K  |   64615 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31801 K  |   31801 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64615 K  |   64615 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31801 K  |   31801 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2926    |    2864    |
|       from large pool |      37    |     602    |    2858    |    2821    |
|       from small pool |      25    |      35    |      68    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   42987 K  |   42987 K  |
|       from large pool |       3    |     604    |   24165 K  |   24165 K  |
|       from small pool |       0    |     235    |   18821 K  |   18821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367635 GiB | 367635 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367635 GiB | 367635 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362396 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    868 MiB |  14488 MiB |  68828 MiB |  67960 MiB |
|       from large pool |    818 MiB |  14422 MiB |  68692 MiB |  67874 MiB |
|       from small pool |     50 MiB |     70 MiB |    136 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 261988 GiB | 261988 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |      0 KiB |     47 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64615 K  |   64615 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31801 K  |   31801 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64615 K  |   64615 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31801 K  |   31801 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2926    |    2864    |
|       from large pool |      37    |     602    |    2858    |    2821    |
|       from small pool |      25    |      35    |      68    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   42987 K  |   42987 K  |
|       from large pool |       3    |     604    |   24165 K  |   24165 K  |
|       from small pool |       0    |     235    |   18821 K  |   18821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368

 Experiment start at: 2024-07-29 04:34:46.468077
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94895285, 'precision': 0.94907004, 'recall': 0.9491285, 'specificity': 0.9491285, 'f1': 0.94895256, 'auroc': 0.98777896, 'binary_precision': 0.9610046, 'binary_recall': 0.9374597, 'binary_specificity': 0.96079737, 'binary_f1_score': 0.9490861}
confusion matrix:
      0     1
0  1446    59
1    97  1454
---- Validation: 
scalar performance:
{'acc': 0.7760498, 'precision': 0.80019987, 'recall': 0.7799262, 'specificity': 0.7799262, 'f1': 0.77296084, 'auroc': 0.89152676, 'binary_precision': 0.7077682, 'binary_recall': 0.9184, 'binary_specificity': 0.6414524, 'binary_f1_score': 0.7994428}
confusion matrix:
     0    1
0  424  237
1   51  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.8173568, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.8058301, 'auroc': 0.9261821, 'binary_precision': 0.7610294, 'binary_recall': 0.8961039, 'binary_specificity': 0.7186147, 'binary_f1_score': 0.8230617}
confusion matrix:
     0    1
0  166   65
1   24  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:36:18.241772,epoch time: 0:01:31.773695,used: 0:01:31.773695,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9617147, 'precision': 0.9621495, 'recall': 0.9614975, 'specificity': 0.9614975, 'f1': 0.96168214, 'auroc': 0.99417293, 'binary_precision': 0.95160276, 'binary_recall': 0.97426, 'binary_specificity': 0.948735, 'binary_f1_score': 0.96279806}
confusion matrix:
      0     1
0  1425    77
1    40  1514
---- Validation: 
scalar performance:
{'acc': 0.7643857, 'precision': 0.79786783, 'recall': 0.76897186, 'specificity': 0.76897186, 'f1': 0.75951594, 'auroc': 0.9135395, 'binary_precision': 0.6907583, 'binary_recall': 0.9328, 'binary_specificity': 0.6051437, 'binary_f1_score': 0.79373723}
confusion matrix:
     0    1
0  400  261
1   42  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77056277, 'precision': 0.807436, 'recall': 0.77056277, 'specificity': 0.77056277, 'f1': 0.76347053, 'auroc': 0.92743766, 'binary_precision': 0.7009646, 'binary_recall': 0.94372296, 'binary_specificity': 0.5974026, 'binary_f1_score': 0.80442804}
confusion matrix:
     0    1
0  138   93
1   13  218
early stop counter: 1
val acc:0.7643857002258301, best validation acc: 0.776049792766571, corresponding to test acc:                         0.8073592782020569 / 0.8073592782020569
after epoch: 2,now: 2024-07-29 04:37:54.671492,epoch time: 0:01:36.429720,used: 0:03:08.203415,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96138746, 'precision': 0.96274525, 'recall': 0.9609753, 'specificity': 0.9609753, 'f1': 0.96132374, 'auroc': 0.99523246, 'binary_precision': 0.9415744, 'binary_recall': 0.9851995, 'binary_specificity': 0.936751, 'binary_f1_score': 0.9628931}
confusion matrix:
      0     1
0  1407    95
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.81959563, 'precision': 0.8342855, 'recall': 0.82250404, 'specificity': 0.82250404, 'f1': 0.818408, 'auroc': 0.92058575, 'binary_precision': 0.75686276, 'binary_recall': 0.9264, 'binary_specificity': 0.71860814, 'binary_f1_score': 0.8330935}
confusion matrix:
     0    1
0  475  186
1   46  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82251084, 'precision': 0.83053875, 'recall': 0.82251084, 'specificity': 0.82251084, 'f1': 0.8214265, 'auroc': 0.926332, 'binary_precision': 0.7790262, 'binary_recall': 0.9004329, 'binary_specificity': 0.74458873, 'binary_f1_score': 0.8353414}
confusion matrix:
     0    1
0  172   59
1   23  208
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 04:39:31.846876,epoch time: 0:01:37.175384,used: 0:04:45.378799,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97388417, 'recall': 0.9728706, 'specificity': 0.9728706, 'f1': 0.9731364, 'auroc': 0.99679136, 'binary_precision': 0.9594763, 'binary_recall': 0.9890745, 'binary_specificity': 0.95666665, 'binary_f1_score': 0.97405064}
confusion matrix:
      0     1
0  1435    65
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.7651633, 'precision': 0.8019407, 'recall': 0.76994616, 'specificity': 0.76994616, 'f1': 0.7598094, 'auroc': 0.9152242, 'binary_precision': 0.68933177, 'binary_recall': 0.9408, 'binary_specificity': 0.5990923, 'binary_f1_score': 0.79566985}
confusion matrix:
     0    1
0  396  265
1   37  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7683983, 'precision': 0.8081856, 'recall': 0.7683983, 'specificity': 0.7683983, 'f1': 0.7606739, 'auroc': 0.93489623, 'binary_precision': 0.69745225, 'binary_recall': 0.9480519, 'binary_specificity': 0.5887446, 'binary_f1_score': 0.80366975}
confusion matrix:
     0    1
0  136   95
1   12  219
early stop counter: 1
val acc:0.7651633024215698, best validation acc: 0.8195956349372864, corresponding to test acc:                         0.822510838508606 / 0.822510838508606
after epoch: 4,now: 2024-07-29 04:41:01.172278,epoch time: 0:01:29.325402,used: 0:06:14.704201,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9818171, 'recall': 0.9815868, 'specificity': 0.9815868, 'f1': 0.9816679, 'auroc': 0.9984102, 'binary_precision': 0.97640306, 'binary_recall': 0.98774195, 'binary_specificity': 0.9754316, 'binary_f1_score': 0.9820398}
confusion matrix:
      0     1
0  1469    37
1    19  1531
---- Validation: 
scalar performance:
{'acc': 0.8297045, 'precision': 0.8310653, 'recall': 0.82872134, 'specificity': 0.82872134, 'f1': 0.8291233, 'auroc': 0.88911587, 'binary_precision': 0.84641635, 'binary_recall': 0.7936, 'binary_specificity': 0.86384267, 'binary_f1_score': 0.8191577}
confusion matrix:
     0    1
0  571   90
1  129  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8484849, 'precision': 0.8489033, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.84843934, 'auroc': 0.9143944, 'binary_precision': 0.86098653, 'binary_recall': 0.83116883, 'binary_specificity': 0.86580086, 'binary_f1_score': 0.84581494}
confusion matrix:
     0    1
0  200   31
1   39  192
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 04:42:36.533704,epoch time: 0:01:35.361426,used: 0:07:50.065627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97849154, 'recall': 0.9786162, 'specificity': 0.9786162, 'f1': 0.97840255, 'auroc': 0.9984983, 'binary_precision': 0.99077123, 'binary_recall': 0.96655947, 'binary_specificity': 0.9906729, 'binary_f1_score': 0.9785156}
confusion matrix:
      0     1
0  1487    14
1    52  1503
---- Validation: 
scalar performance:
{'acc': 0.8094868, 'precision': 0.82957864, 'recall': 0.80596066, 'specificity': 0.80596066, 'f1': 0.80518943, 'auroc': 0.89582574, 'binary_precision': 0.90425533, 'binary_recall': 0.68, 'binary_specificity': 0.9319213, 'binary_f1_score': 0.77625567}
confusion matrix:
     0    1
0  616   45
1  200  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84632033, 'precision': 0.85875136, 'recall': 0.84632033, 'specificity': 0.84632033, 'f1': 0.8449774, 'auroc': 0.9317666, 'binary_precision': 0.9255319, 'binary_recall': 0.7532467, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.8305489}
confusion matrix:
     0    1
0  217   14
1   57  174
early stop counter: 1
val acc:0.8094868063926697, best validation acc: 0.8297045230865479, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 6,now: 2024-07-29 04:44:14.965516,epoch time: 0:01:38.431812,used: 0:09:28.497439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9797312, 'recall': 0.97987926, 'specificity': 0.97987926, 'f1': 0.9797108, 'auroc': 0.99862814, 'binary_precision': 0.9895082, 'binary_recall': 0.97041804, 'binary_specificity': 0.9893404, 'binary_f1_score': 0.97987014}
confusion matrix:
      0     1
0  1485    16
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.8125972, 'precision': 0.8287809, 'recall': 0.8094221, 'specificity': 0.8094221, 'f1': 0.8090614, 'auroc': 0.8924756, 'binary_precision': 0.89506173, 'binary_recall': 0.696, 'binary_specificity': 0.9228442, 'binary_f1_score': 0.7830783}
confusion matrix:
     0    1
0  610   51
1  190  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.8612269, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.83497095, 'auroc': 0.92704415, 'binary_precision': 0.95348835, 'binary_recall': 0.7099567, 'binary_specificity': 0.965368, 'binary_f1_score': 0.81389576}
confusion matrix:
     0    1
0  223    8
1   67  164
early stop counter: 2
val acc:0.8125972151756287, best validation acc: 0.8297045230865479, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 7,now: 2024-07-29 04:45:53.936664,epoch time: 0:01:38.971148,used: 0:11:07.468587,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9790895, 'recall': 0.97921264, 'specificity': 0.97921264, 'f1': 0.9790567, 'auroc': 0.9985789, 'binary_precision': 0.98883784, 'binary_recall': 0.969736, 'binary_specificity': 0.9886893, 'binary_f1_score': 0.9791938}
confusion matrix:
      0     1
0  1486    17
1    47  1506
---- Validation: 
scalar performance:
{'acc': 0.8304821, 'precision': 0.8455682, 'recall': 0.8275171, 'specificity': 0.8275171, 'f1': 0.82760966, 'auroc': 0.9023734, 'binary_precision': 0.9111111, 'binary_recall': 0.7216, 'binary_specificity': 0.9334342, 'binary_f1_score': 0.8053571}
confusion matrix:
     0    1
0  617   44
1  174  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8484849, 'precision': 0.8603989, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.8472222, 'auroc': 0.91148967, 'binary_precision': 0.9259259, 'binary_recall': 0.75757575, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.83333325}
confusion matrix:
     0    1
0  217   14
1   56  175
better model found
persisted
after epoch: 8,now: 2024-07-29 04:47:22.791388,epoch time: 0:01:28.854724,used: 0:12:36.323311,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898398, 'recall': 0.98986936, 'specificity': 0.98986936, 'f1': 0.9898536, 'auroc': 0.99917185, 'binary_precision': 0.99096775, 'binary_recall': 0.9890534, 'binary_specificity': 0.9906853, 'binary_f1_score': 0.99000967}
confusion matrix:
      0     1
0  1489    14
1    17  1536
---- Validation: 
scalar performance:
{'acc': 0.81493, 'precision': 0.8148551, 'recall': 0.8150899, 'specificity': 0.8150899, 'f1': 0.81487584, 'auroc': 0.88832915, 'binary_precision': 0.8028169, 'binary_recall': 0.8208, 'binary_specificity': 0.80937976, 'binary_f1_score': 0.81170887}
confusion matrix:
     0    1
0  535  126
1  112  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8484849, 'precision': 0.84913915, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.8484138, 'auroc': 0.9273251, 'binary_precision': 0.8340249, 'binary_recall': 0.8701299, 'binary_specificity': 0.8268398, 'binary_f1_score': 0.85169494}
confusion matrix:
     0    1
0  191   40
1   30  201
early stop counter: 1
val acc:0.8149300217628479, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 9,now: 2024-07-29 04:48:55.483286,epoch time: 0:01:32.691898,used: 0:14:09.015209,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99048615, 'recall': 0.99053556, 'specificity': 0.99053556, 'f1': 0.9905082, 'auroc': 0.99963117, 'binary_precision': 0.99225307, 'binary_recall': 0.98906046, 'binary_specificity': 0.99201065, 'binary_f1_score': 0.99065423}
confusion matrix:
      0     1
0  1490    12
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.7192846, 'precision': 0.7850265, 'recall': 0.7123764, 'specificity': 0.7123764, 'f1': 0.69778544, 'auroc': 0.89777184, 'binary_precision': 0.9150943, 'binary_recall': 0.4656, 'binary_specificity': 0.9591528, 'binary_f1_score': 0.61717916}
confusion matrix:
     0    1
0  634   27
1  334  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6926407, 'precision': 0.7546637, 'recall': 0.69264066, 'specificity': 0.69264066, 'f1': 0.67271316, 'auroc': 0.8783568, 'binary_precision': 0.8803419, 'binary_recall': 0.44588745, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.591954}
confusion matrix:
     0    1
0  217   14
1  128  103
early stop counter: 2
val acc:0.7192845940589905, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 10,now: 2024-07-29 04:50:31.272114,epoch time: 0:01:35.788828,used: 0:15:44.804037,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9093586, 'precision': 0.9241414, 'recall': 0.9078008, 'specificity': 0.9078008, 'f1': 0.90830874, 'auroc': 0.99879354, 'binary_precision': 0.84909785, 'binary_recall': 0.9993565, 'binary_specificity': 0.816245, 'binary_f1_score': 0.91811997}
confusion matrix:
      0     1
0  1226   276
1     1  1553
---- Validation: 
scalar performance:
{'acc': 0.59720063, 'precision': 0.72388506, 'recall': 0.60738516, 'specificity': 0.60738516, 'f1': 0.54212856, 'auroc': 0.8445071, 'binary_precision': 0.5483288, 'binary_recall': 0.9712, 'binary_specificity': 0.24357034, 'binary_f1_score': 0.70092374}
confusion matrix:
     0    1
0  161  500
1   18  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6168831, 'precision': 0.76617444, 'recall': 0.61688316, 'specificity': 0.61688316, 'f1': 0.5544016, 'auroc': 0.8776072, 'binary_precision': 0.5668317, 'binary_recall': 0.991342, 'binary_specificity': 0.24242425, 'binary_f1_score': 0.7212599}
confusion matrix:
    0    1
0  56  175
1   2  229
early stop counter: 3
val acc:0.5972006320953369, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 11,now: 2024-07-29 04:52:10.066798,epoch time: 0:01:38.794684,used: 0:17:23.598721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.986187, 'recall': 0.985786, 'specificity': 0.985786, 'f1': 0.98592037, 'auroc': 0.9993454, 'binary_precision': 0.9784674, 'binary_recall': 0.9942085, 'binary_specificity': 0.9773635, 'binary_f1_score': 0.98627514}
confusion matrix:
      0     1
0  1468    34
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8157076, 'precision': 0.82039666, 'recall': 0.81737125, 'specificity': 0.81737125, 'f1': 0.81546116, 'auroc': 0.90066445, 'binary_precision': 0.7740113, 'binary_recall': 0.8768, 'binary_specificity': 0.7579425, 'binary_f1_score': 0.82220554}
confusion matrix:
     0    1
0  501  160
1   77  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.83909214, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.83749104, 'auroc': 0.9203726, 'binary_precision': 0.81707317, 'binary_recall': 0.8701299, 'binary_specificity': 0.8051948, 'binary_f1_score': 0.8427673}
confusion matrix:
     0    1
0  186   45
1   30  201
early stop counter: 4
val acc:0.8157076239585876, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 12,now: 2024-07-29 04:53:49.055542,epoch time: 0:01:38.988744,used: 0:19:02.587465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98112607, 'recall': 0.98099226, 'specificity': 0.98099226, 'f1': 0.98069346, 'auroc': 0.99852276, 'binary_precision': 1.0, 'binary_recall': 0.9619845, 'binary_specificity': 1.0, 'binary_f1_score': 0.98062396}
confusion matrix:
      0     1
0  1504     0
1    59  1493
---- Validation: 
scalar performance:
{'acc': 0.61586314, 'precision': 0.7405273, 'recall': 0.60545355, 'specificity': 0.60545355, 'f1': 0.54745275, 'auroc': 0.88105536, 'binary_precision': 0.9068323, 'binary_recall': 0.2336, 'binary_specificity': 0.9773071, 'binary_f1_score': 0.3715013}
confusion matrix:
     0    1
0  646   15
1  479  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.504329, 'precision': 0.5261313, 'recall': 0.504329, 'specificity': 0.504329, 'f1': 0.373691, 'auroc': 0.86239016, 'binary_precision': 0.55, 'binary_recall': 0.04761905, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.087649405}
confusion matrix:
     0   1
0  222   9
1  220  11
early stop counter: 5
val acc:0.6158631443977356, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 13,now: 2024-07-29 04:55:25.987903,epoch time: 0:01:36.932361,used: 0:20:39.519826,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98986936, 'recall': 0.9898398, 'specificity': 0.9898398, 'f1': 0.9898536, 'auroc': 0.9994178, 'binary_precision': 0.9890534, 'binary_recall': 0.99096775, 'binary_specificity': 0.98871183, 'binary_f1_score': 0.99000967}
confusion matrix:
      0     1
0  1489    17
1    14  1536
---- Validation: 
scalar performance:
{'acc': 0.86547434, 'precision': 0.8671185, 'recall': 0.86451924, 'specificity': 0.86451924, 'f1': 0.86501527, 'auroc': 0.9205519, 'binary_precision': 0.88566554, 'binary_recall': 0.8304, 'binary_specificity': 0.8986384, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  594   67
1  106  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8160173, 'precision': 0.8284829, 'recall': 0.81601727, 'specificity': 0.81601727, 'f1': 0.8142551, 'auroc': 0.89213085, 'binary_precision': 0.8924731, 'binary_recall': 0.7186147, 'binary_specificity': 0.9134199, 'binary_f1_score': 0.7961631}
confusion matrix:
     0    1
0  211   20
1   65  166
better model found
persisted
after epoch: 14,now: 2024-07-29 04:56:59.228384,epoch time: 0:01:33.240481,used: 0:22:12.760307,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9830363, 'recall': 0.98248315, 'specificity': 0.98248315, 'f1': 0.98264486, 'auroc': 0.99944776, 'binary_precision': 0.97287065, 'binary_recall': 0.9935567, 'binary_specificity': 0.97140956, 'binary_f1_score': 0.9831049}
confusion matrix:
      0     1
0  1461    43
1    10  1542
---- Validation: 
scalar performance:
{'acc': 0.81804043, 'precision': 0.81819874, 'recall': 0.8184206, 'specificity': 0.8184206, 'f1': 0.81802464, 'auroc': 0.8867631, 'binary_precision': 0.80123264, 'binary_recall': 0.832, 'binary_specificity': 0.80484116, 'binary_f1_score': 0.81632656}
confusion matrix:
     0    1
0  532  129
1  105  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.8034844, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.79790497, 'auroc': 0.8938363, 'binary_precision': 0.7653846, 'binary_recall': 0.86147183, 'binary_specificity': 0.73593074, 'binary_f1_score': 0.8105906}
confusion matrix:
     0    1
0  170   61
1   32  199
early stop counter: 1
val acc:0.8180404305458069, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 15,now: 2024-07-29 04:58:36.428704,epoch time: 0:01:37.200320,used: 0:23:49.960627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885275, 'recall': 0.9885683, 'specificity': 0.9885683, 'f1': 0.9885453, 'auroc': 0.9993857, 'binary_precision': 0.99029124, 'binary_recall': 0.9870968, 'binary_specificity': 0.9900398, 'binary_f1_score': 0.98869145}
confusion matrix:
      0     1
0  1491    15
1    20  1530
---- Validation: 
scalar performance:
{'acc': 0.7301711, 'precision': 0.7894768, 'recall': 0.72366357, 'specificity': 0.72366357, 'f1': 0.71176183, 'auroc': 0.87247205, 'binary_precision': 0.91369045, 'binary_recall': 0.4912, 'binary_specificity': 0.9561271, 'binary_f1_score': 0.6389178}
confusion matrix:
     0    1
0  632   29
1  318  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7380952, 'precision': 0.8062922, 'recall': 0.7380952, 'specificity': 0.7380952, 'f1': 0.72265744, 'auroc': 0.90318775, 'binary_precision': 0.9508197, 'binary_recall': 0.5021645, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.6572238}
confusion matrix:
     0    1
0  225    6
1  115  116
early stop counter: 2
val acc:0.7301710844039917, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 16,now: 2024-07-29 05:00:14.590102,epoch time: 0:01:38.161398,used: 0:25:28.122025,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9854566, 'recall': 0.9854834, 'specificity': 0.9854834, 'f1': 0.98527485, 'auroc': 0.9997382, 'binary_precision': 0.9993369, 'binary_recall': 0.9716312, 'binary_specificity': 0.9993355, 'binary_f1_score': 0.98528934}
confusion matrix:
      0     1
0  1504     1
1    44  1507
---- Validation: 
scalar performance:
{'acc': 0.60108864, 'precision': 0.7441836, 'recall': 0.5900357, 'specificity': 0.5900357, 'f1': 0.5198401, 'auroc': 0.8738009, 'binary_precision': 0.92424244, 'binary_recall': 0.1952, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.32232493}
confusion matrix:
     0    1
0  651   10
1  503  122
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53896105, 'precision': 0.671083, 'recall': 0.53896105, 'specificity': 0.53896105, 'f1': 0.42865273, 'auroc': 0.87872696, 'binary_precision': 0.8214286, 'binary_recall': 0.0995671, 'binary_specificity': 0.978355, 'binary_f1_score': 0.17760618}
confusion matrix:
     0   1
0  226   5
1  208  23
early stop counter: 3
val acc:0.6010886430740356, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 17,now: 2024-07-29 05:01:52.674473,epoch time: 0:01:38.084371,used: 0:27:06.206396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.989169, 'recall': 0.98927903, 'specificity': 0.98927903, 'f1': 0.9892002, 'auroc': 0.99960756, 'binary_precision': 0.99414825, 'binary_recall': 0.98454607, 'binary_specificity': 0.994012, 'binary_f1_score': 0.98932385}
confusion matrix:
      0     1
0  1494     9
1    24  1529
---- Validation: 
scalar performance:
{'acc': 0.8118196, 'precision': 0.82631236, 'recall': 0.8087964, 'specificity': 0.8087964, 'f1': 0.80855227, 'auroc': 0.8907038, 'binary_precision': 0.8884381, 'binary_recall': 0.7008, 'binary_specificity': 0.91679275, 'binary_f1_score': 0.783542}
confusion matrix:
     0    1
0  606   55
1  187  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7922078, 'precision': 0.82562387, 'recall': 0.79220784, 'specificity': 0.79220784, 'f1': 0.78673637, 'auroc': 0.8922809, 'binary_precision': 0.9299363, 'binary_recall': 0.63203466, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.75257736}
confusion matrix:
     0    1
0  220   11
1   85  146
early stop counter: 4
val acc:0.8118196129798889, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 18,now: 2024-07-29 05:03:30.773314,epoch time: 0:01:38.098841,used: 0:28:44.305237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.97383356, 'recall': 0.97327757, 'specificity': 0.97327757, 'f1': 0.9728371, 'auroc': 0.9997866, 'binary_precision': 1.0, 'binary_recall': 0.9465551, 'binary_specificity': 1.0, 'binary_f1_score': 0.97254384}
confusion matrix:
      0     1
0  1503     0
1    83  1470
---- Validation: 
scalar performance:
{'acc': 0.57387245, 'precision': 0.72221303, 'recall': 0.5620357, 'specificity': 0.5620357, 'f1': 0.4723905, 'auroc': 0.86480546, 'binary_precision': 0.8969072, 'binary_recall': 0.1392, 'binary_specificity': 0.9848714, 'binary_f1_score': 0.24099724}
confusion matrix:
     0   1
0  651  10
1  538  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5021645, 'precision': 0.53626376, 'recall': 0.5021645, 'specificity': 0.5021645, 'f1': 0.34916824, 'auroc': 0.8693053, 'binary_precision': 0.5714286, 'binary_recall': 0.017316017, 'binary_specificity': 0.987013, 'binary_f1_score': 0.033613443}
confusion matrix:
     0  1
0  228  3
1  227  4
early stop counter: 5
val acc:0.573872447013855, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 19,now: 2024-07-29 05:05:06.654629,epoch time: 0:01:35.881315,used: 0:30:20.186552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98915875, 'recall': 0.98927593, 'specificity': 0.98927593, 'f1': 0.98919946, 'auroc': 0.9996834, 'binary_precision': 0.9935191, 'binary_recall': 0.9852185, 'binary_specificity': 0.99333334, 'binary_f1_score': 0.98935145}
confusion matrix:
      0     1
0  1490    10
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.7986003, 'precision': 0.81254995, 'recall': 0.7955449, 'specificity': 0.7955449, 'f1': 0.795061, 'auroc': 0.8798505, 'binary_precision': 0.8719512, 'binary_recall': 0.6864, 'binary_specificity': 0.90468985, 'binary_f1_score': 0.76812893}
confusion matrix:
     0    1
0  598   63
1  196  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268398, 'precision': 0.8349755, 'recall': 0.8268398, 'specificity': 0.8268398, 'f1': 0.82578206, 'auroc': 0.8857968, 'binary_precision': 0.8871795, 'binary_recall': 0.74891776, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.8122066}
confusion matrix:
     0    1
0  209   22
1   58  173
early stop counter: 6
val acc:0.7986003160476685, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 20,now: 2024-07-29 05:06:33.981220,epoch time: 0:01:27.326591,used: 0:31:47.513143,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99113107, 'recall': 0.9912125, 'specificity': 0.9912125, 'f1': 0.9911632, 'auroc': 0.9997588, 'binary_precision': 0.9941748, 'binary_recall': 0.98841697, 'binary_specificity': 0.994008, 'binary_f1_score': 0.9912875}
confusion matrix:
      0     1
0  1493     9
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.7177294, 'precision': 0.7774613, 'recall': 0.7110378, 'specificity': 0.7110378, 'f1': 0.69744253, 'auroc': 0.8935795, 'binary_precision': 0.8993902, 'binary_recall': 0.472, 'binary_specificity': 0.9500756, 'binary_f1_score': 0.6190976}
confusion matrix:
     0    1
0  628   33
1  330  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7164502, 'precision': 0.79829544, 'recall': 0.7164502, 'specificity': 0.7164502, 'f1': 0.69556797, 'auroc': 0.91212684, 'binary_precision': 0.95454544, 'binary_recall': 0.45454547, 'binary_specificity': 0.978355, 'binary_f1_score': 0.6158358}
confusion matrix:
     0    1
0  226    5
1  126  105
early stop counter: 7
val acc:0.717729389667511, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 21,now: 2024-07-29 05:08:09.328566,epoch time: 0:01:35.347346,used: 0:33:22.860489,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.98598486, 'recall': 0.9858818, 'specificity': 0.9858818, 'f1': 0.9859248, 'auroc': 0.99921346, 'binary_precision': 0.98333335, 'binary_recall': 0.9890393, 'binary_specificity': 0.98272425, 'binary_f1_score': 0.9861781}
confusion matrix:
      0     1
0  1479    26
1    17  1534
---- Validation: 
scalar performance:
{'acc': 0.83437014, 'precision': 0.84506696, 'recall': 0.83186567, 'specificity': 0.83186567, 'f1': 0.83223736, 'auroc': 0.90509164, 'binary_precision': 0.8992248, 'binary_recall': 0.7424, 'binary_specificity': 0.9213313, 'binary_f1_score': 0.81332165}
confusion matrix:
     0    1
0  609   52
1  161  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8639507, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.82975286, 'auroc': 0.9248514, 'binary_precision': 0.9695122, 'binary_recall': 0.6883117, 'binary_specificity': 0.978355, 'binary_f1_score': 0.80506337}
confusion matrix:
     0    1
0  226    5
1   72  159
early stop counter: 8
val acc:0.8343701362609863, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 22,now: 2024-07-29 05:09:48.576053,epoch time: 0:01:39.247487,used: 0:35:02.107976,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98825395, 'recall': 0.9881861, 'specificity': 0.9881861, 'f1': 0.9882163, 'auroc': 0.99955404, 'binary_precision': 0.9865212, 'binary_recall': 0.99033505, 'binary_specificity': 0.98603725, 'binary_f1_score': 0.9884245}
confusion matrix:
      0     1
0  1483    21
1    15  1537
---- Validation: 
scalar performance:
{'acc': 0.81959563, 'precision': 0.83749175, 'recall': 0.8163171, 'specificity': 0.8163171, 'f1': 0.8159906, 'auroc': 0.9012672, 'binary_precision': 0.9085239, 'binary_recall': 0.6992, 'binary_specificity': 0.9334342, 'binary_f1_score': 0.79023504}
confusion matrix:
     0    1
0  617   44
1  188  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72727275, 'precision': 0.8004459, 'recall': 0.72727275, 'specificity': 0.72727275, 'f1': 0.70959055, 'auroc': 0.9022882, 'binary_precision': 0.94871795, 'binary_recall': 0.48051947, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.63793105}
confusion matrix:
     0    1
0  225    6
1  120  111
early stop counter: 9
val acc:0.8195956349372864, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 23,now: 2024-07-29 05:11:26.413701,epoch time: 0:01:37.837648,used: 0:36:39.945624,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.9732368, 'recall': 0.9726336, 'specificity': 0.9726336, 'f1': 0.9721822, 'auroc': 0.9997314, 'binary_precision': 1.0, 'binary_recall': 0.9452672, 'binary_specificity': 1.0, 'binary_f1_score': 0.9718636}
confusion matrix:
      0     1
0  1503     0
1    85  1468
---- Validation: 
scalar performance:
{'acc': 0.58475894, 'precision': 0.7612392, 'recall': 0.5729307, 'specificity': 0.5729307, 'f1': 0.4858696, 'auroc': 0.9175092, 'binary_precision': 0.96907216, 'binary_recall': 0.1504, 'binary_specificity': 0.9954614, 'binary_f1_score': 0.2603878}
confusion matrix:
     0   1
0  658   3
1  531  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53896105, 'precision': 0.735181, 'recall': 0.53896105, 'specificity': 0.53896105, 'f1': 0.4174506, 'auroc': 0.913256, 'binary_precision': 0.95, 'binary_recall': 0.08225108, 'binary_specificity': 0.995671, 'binary_f1_score': 0.15139441}
confusion matrix:
     0   1
0  230   1
1  212  19
early stop counter: 10
val acc:0.5847589373588562, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 24,now: 2024-07-29 05:13:03.975332,epoch time: 0:01:37.561631,used: 0:38:17.507255,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.994734, 'recall': 0.9948145, 'specificity': 0.9948145, 'f1': 0.9947636, 'auroc': 0.99984145, 'binary_precision': 0.9980545, 'binary_recall': 0.9916237, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.9948287}
confusion matrix:
      0     1
0  1501     3
1    13  1539
---- Validation: 
scalar performance:
{'acc': 0.7713841, 'precision': 0.8284136, 'recall': 0.7654536, 'specificity': 0.7654536, 'f1': 0.7582269, 'auroc': 0.9252533, 'binary_precision': 0.95844877, 'binary_recall': 0.5536, 'binary_specificity': 0.9773071, 'binary_f1_score': 0.7018256}
confusion matrix:
     0    1
0  646   15
1  279  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5497835, 'precision': 0.74315786, 'recall': 0.5497835, 'specificity': 0.5497835, 'f1': 0.4380614, 'auroc': 0.9127828, 'binary_precision': 0.96, 'binary_recall': 0.103896104, 'binary_specificity': 0.995671, 'binary_f1_score': 0.1875}
confusion matrix:
     0   1
0  230   1
1  207  24
early stop counter: 11
val acc:0.7713841199874878, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 25,now: 2024-07-29 05:14:41.534582,epoch time: 0:01:37.559250,used: 0:39:55.066505,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.99149024, 'recall': 0.99149024, 'specificity': 0.99149024, 'f1': 0.99149024, 'auroc': 0.99968296, 'binary_precision': 0.99161834, 'binary_recall': 0.99161834, 'binary_specificity': 0.99136215, 'binary_f1_score': 0.99161834}
confusion matrix:
      0     1
0  1492    13
1    13  1538
---- Validation: 
scalar performance:
{'acc': 0.83359253, 'precision': 0.8444562, 'recall': 0.83106565, 'specificity': 0.83106565, 'f1': 0.8314197, 'auroc': 0.9019232, 'binary_precision': 0.89902914, 'binary_recall': 0.7408, 'binary_specificity': 0.9213313, 'binary_f1_score': 0.8122807}
confusion matrix:
     0    1
0  609   52
1  162  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6753247, 'precision': 0.7431452, 'recall': 0.6753247, 'specificity': 0.6753247, 'f1': 0.65098715, 'auroc': 0.8754334, 'binary_precision': 0.8715596, 'binary_recall': 0.41125542, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.5588235}
confusion matrix:
     0   1
0  217  14
1  136  95
early stop counter: 12
val acc:0.8335925340652466, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 26,now: 2024-07-29 05:16:21.633426,epoch time: 0:01:40.098844,used: 0:41:35.165349,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9872794, 'recall': 0.98719907, 'specificity': 0.98719907, 'f1': 0.9872341, 'auroc': 0.9992275, 'binary_precision': 0.98524696, 'binary_recall': 0.9896907, 'binary_specificity': 0.9847075, 'binary_f1_score': 0.98746383}
confusion matrix:
      0     1
0  1481    23
1    16  1536
---- Validation: 
scalar performance:
{'acc': 0.7161742, 'precision': 0.7930196, 'recall': 0.70882785, 'specificity': 0.70882785, 'f1': 0.69160205, 'auroc': 0.86512494, 'binary_precision': 0.9362416, 'binary_recall': 0.4464, 'binary_specificity': 0.97125566, 'binary_f1_score': 0.6045504}
confusion matrix:
     0    1
0  642   19
1  346  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54112554, 'precision': 0.7369615, 'recall': 0.54112554, 'specificity': 0.54112554, 'f1': 0.42162699, 'auroc': 0.8338112, 'binary_precision': 0.95238096, 'binary_recall': 0.08658009, 'binary_specificity': 0.995671, 'binary_f1_score': 0.15873016}
confusion matrix:
     0   1
0  230   1
1  211  20
early stop counter: 13
val acc:0.7161741852760315, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 27,now: 2024-07-29 05:17:48.243097,epoch time: 0:01:26.609671,used: 0:43:01.775020,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99054146, 'recall': 0.9906572, 'specificity': 0.9906572, 'f1': 0.9905101, 'auroc': 0.99983764, 'binary_precision': 1.0, 'binary_recall': 0.9813144, 'binary_specificity': 1.0, 'binary_f1_score': 0.9905691}
confusion matrix:
      0     1
0  1504     0
1    29  1523
---- Validation: 
scalar performance:
{'acc': 0.58864695, 'precision': 0.7502358, 'recall': 0.5770614, 'specificity': 0.5770614, 'f1': 0.49532598, 'auroc': 0.8837622, 'binary_precision': 0.9444444, 'binary_recall': 0.1632, 'binary_specificity': 0.99092287, 'binary_f1_score': 0.27830833}
confusion matrix:
     0    1
0  655    6
1  523  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53246754, 'precision': 0.70583344, 'recall': 0.53246754, 'specificity': 0.53246754, 'f1': 0.4077626, 'auroc': 0.89822155, 'binary_precision': 0.8947368, 'binary_recall': 0.07359307, 'binary_specificity': 0.991342, 'binary_f1_score': 0.136}
confusion matrix:
     0   1
0  229   2
1  214  17
early stop counter: 14
val acc:0.5886469483375549, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 28,now: 2024-07-29 05:19:21.714762,epoch time: 0:01:33.471665,used: 0:44:35.246685,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98857486, 'recall': 0.9885173, 'specificity': 0.9885173, 'f1': 0.9885434, 'auroc': 0.9994718, 'binary_precision': 0.987163, 'binary_recall': 0.99034125, 'binary_specificity': 0.98669326, 'binary_f1_score': 0.98874956}
confusion matrix:
      0     1
0  1483    20
1    15  1538
---- Validation: 
scalar performance:
{'acc': 0.6702955, 'precision': 0.7604673, 'recall': 0.6618021, 'specificity': 0.6618021, 'f1': 0.63217485, 'auroc': 0.89705294, 'binary_precision': 0.9068826, 'binary_recall': 0.3584, 'binary_specificity': 0.96520424, 'binary_f1_score': 0.51376146}
confusion matrix:
     0    1
0  638   23
1  401  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7550839, 'recall': 0.6666666, 'specificity': 0.6666666, 'f1': 0.6350411, 'auroc': 0.8887764, 'binary_precision': 0.9052632, 'binary_recall': 0.37229437, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.5276073}
confusion matrix:
     0   1
0  222   9
1  145  86
early stop counter: 15
val acc:0.6702954769134521, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 29,now: 2024-07-29 05:20:59.548734,epoch time: 0:01:37.833972,used: 0:46:13.080657,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.99179375, 'recall': 0.99190474, 'specificity': 0.99190474, 'f1': 0.99181855, 'auroc': 0.9997095, 'binary_precision': 0.99739414, 'binary_recall': 0.9864691, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9919016}
confusion matrix:
      0     1
0  1500     4
1    21  1531
---- Validation: 
scalar performance:
{'acc': 0.7060653, 'precision': 0.7833048, 'recall': 0.69855857, 'specificity': 0.69855857, 'f1': 0.6795377, 'auroc': 0.8940418, 'binary_precision': 0.9243986, 'binary_recall': 0.4304, 'binary_specificity': 0.9667171, 'binary_f1_score': 0.5873363}
confusion matrix:
     0    1
0  639   22
1  356  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6731602, 'precision': 0.7671138, 'recall': 0.6731602, 'specificity': 0.6731602, 'f1': 0.6416489, 'auroc': 0.9057926, 'binary_precision': 0.9255319, 'binary_recall': 0.37662336, 'binary_specificity': 0.969697, 'binary_f1_score': 0.5353846}
confusion matrix:
     0   1
0  224   7
1  144  87
early stop counter: 16
val acc:0.70606529712677, best validation acc: 0.8654743432998657, corresponding to test acc:                         0.8160173296928406 / 0.8484848737716675
after epoch: 30,now: 2024-07-29 05:22:37.560646,epoch time: 0:01:38.011912,used: 0:47:51.092569,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_34_46_seed_5_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:51.092569 at 2024-07-29 05:22:37.560646
persisted model performance metric: 

scalar performance:
{'acc': 0.8160173, 'precision': 0.8284829, 'recall': 0.81601727, 'specificity': 0.81601727, 'f1': 0.8142551, 'auroc': 0.89213085, 'binary_precision': 0.8924731, 'binary_recall': 0.7186147, 'binary_specificity': 0.9134199, 'binary_f1_score': 0.7961631}
confusion matrix:
     0    1
0  211   20
1   65  166
oracle model performance metric: 

scalar performance:
{'acc': 0.8484849, 'precision': 0.8489033, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.84843934, 'auroc': 0.9143944, 'binary_precision': 0.86098653, 'binary_recall': 0.83116883, 'binary_specificity': 0.86580086, 'binary_f1_score': 0.84581494}
confusion matrix:
     0    1
0  200   31
1   39  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458085 KiB |  13221 MiB | 441348 GiB | 441347 GiB |
|       from large pool | 417487 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458085 KiB |  13221 MiB | 441348 GiB | 441347 GiB |
|       from large pool | 417487 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 440156 GiB | 440155 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 434946 GiB | 434945 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14488 MiB |  82430 MiB |  67960 MiB |
|       from large pool |  14404 MiB |  14422 MiB |  82278 MiB |  67874 MiB |
|       from small pool |     66 MiB |     70 MiB |    152 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 494234 KiB |   1260 MiB | 317447 GiB | 317446 GiB |
|       from large pool | 481585 KiB |   1252 MiB | 312193 GiB | 312193 GiB |
|       from small pool |  12649 KiB |     47 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77548 K  |   77546 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38163 K  |   38162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77548 K  |   77546 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38163 K  |   38162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    3499    |    2864    |
|       from large pool |     602    |     602    |    3423    |    2821    |
|       from small pool |      33    |      35    |      76    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     653    |   51944 K  |   51944 K  |
|       from large pool |      40    |     604    |   29480 K  |   29480 K  |
|       from small pool |      63    |     235    |   22464 K  |   22464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440156 GiB | 440156 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434946 GiB | 434946 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14488 MiB |  82430 MiB |  81500 MiB |
|       from large pool |    878 MiB |  14422 MiB |  82278 MiB |  81400 MiB |
|       from small pool |     52 MiB |     70 MiB |    152 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 317447 GiB | 317447 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 312194 GiB | 312194 GiB |
|       from small pool |      0 KiB |     47 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77548 K  |   77548 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38163 K  |   38163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77548 K  |   77548 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38163 K  |   38163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    3499    |    3433    |
|       from large pool |      40    |     602    |    3423    |    3383    |
|       from small pool |      26    |      35    |      76    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   51944 K  |   51944 K  |
|       from large pool |       3    |     604    |   29480 K  |   29480 K  |
|       from small pool |       0    |     235    |   22464 K  |   22464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440156 GiB | 440156 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434946 GiB | 434946 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14488 MiB |  82430 MiB |  81500 MiB |
|       from large pool |    878 MiB |  14422 MiB |  82278 MiB |  81400 MiB |
|       from small pool |     52 MiB |     70 MiB |    152 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 317447 GiB | 317447 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 312194 GiB | 312194 GiB |
|       from small pool |      0 KiB |     47 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77548 K  |   77548 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38163 K  |   38163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77548 K  |   77548 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38163 K  |   38163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    3499    |    3433    |
|       from large pool |      40    |     602    |    3423    |    3383    |
|       from small pool |      26    |      35    |      76    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   51944 K  |   51944 K  |
|       from large pool |       3    |     604    |   29480 K  |   29480 K  |
|       from small pool |       0    |     235    |   22464 K  |   22464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368

 Experiment start at: 2024-07-29 05:23:21.151733
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.9210158, 'recall': 0.9132842, 'specificity': 0.9132842, 'f1': 0.9135865, 'auroc': 0.988533, 'binary_precision': 0.86991405, 'binary_recall': 0.97620577, 'binary_specificity': 0.85036254, 'binary_f1_score': 0.91999996}
confusion matrix:
      0     1
0  1290   227
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.75097275, 'precision': 0.8124932, 'recall': 0.7525195, 'specificity': 0.7525195, 'f1': 0.73883706, 'auroc': 0.91974044, 'binary_precision': 0.6720779, 'binary_recall': 0.9733542, 'binary_specificity': 0.5316847, 'binary_f1_score': 0.7951344}
confusion matrix:
     0    1
0  344  303
1   17  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7792793, 'precision': 0.8234023, 'recall': 0.7792793, 'specificity': 0.7792793, 'f1': 0.771485, 'auroc': 0.9333252, 'binary_precision': 0.70394737, 'binary_recall': 0.963964, 'binary_specificity': 0.5945946, 'binary_f1_score': 0.8136883}
confusion matrix:
     0    1
0  132   90
1    8  214
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 05:25:01.962793,epoch time: 0:01:40.811060,used: 0:01:40.811060,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.9671683, 'recall': 0.96665496, 'specificity': 0.96665496, 'f1': 0.96677864, 'auroc': 0.9967469, 'binary_precision': 0.95660377, 'binary_recall': 0.9787645, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.9675572}
confusion matrix:
      0     1
0  1449    69
1    33  1521
---- Validation: 
scalar performance:
{'acc': 0.82178986, 'precision': 0.82215786, 'recall': 0.8219065, 'specificity': 0.8219065, 'f1': 0.82176876, 'auroc': 0.898967, 'binary_precision': 0.80937976, 'binary_recall': 0.838558, 'binary_specificity': 0.805255, 'binary_f1_score': 0.82371056}
confusion matrix:
     0    1
0  521  126
1  103  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.84162426, 'recall': 0.83108103, 'specificity': 0.83108103, 'f1': 0.8297676, 'auroc': 0.9296323, 'binary_precision': 0.7816092, 'binary_recall': 0.9189189, 'binary_specificity': 0.7432432, 'binary_f1_score': 0.8447204}
confusion matrix:
     0    1
0  165   57
1   18  204
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 05:26:40.088522,epoch time: 0:01:38.125729,used: 0:03:18.936789,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97498, 'recall': 0.9750398, 'specificity': 0.9750398, 'f1': 0.9749346, 'auroc': 0.9975798, 'binary_precision': 0.98363876, 'binary_recall': 0.96655947, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.97502434}
confusion matrix:
      0     1
0  1492    25
1    52  1503
---- Validation: 
scalar performance:
{'acc': 0.8249027, 'precision': 0.8366687, 'recall': 0.8242455, 'specificity': 0.8242455, 'f1': 0.823148, 'auroc': 0.9030466, 'binary_precision': 0.89788055, 'binary_recall': 0.73040754, 'binary_specificity': 0.9180835, 'binary_f1_score': 0.80553156}
confusion matrix:
     0    1
0  594   53
1  172  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8400901, 'precision': 0.8533467, 'recall': 0.84009004, 'specificity': 0.84009004, 'f1': 0.8385761, 'auroc': 0.91151285, 'binary_precision': 0.92178774, 'binary_recall': 0.7432432, 'binary_specificity': 0.9369369, 'binary_f1_score': 0.8229426}
confusion matrix:
     0    1
0  208   14
1   57  165
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 05:28:14.532936,epoch time: 0:01:34.444414,used: 0:04:53.381203,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.9672146, 'recall': 0.96578866, 'specificity': 0.96578866, 'f1': 0.96547586, 'auroc': 0.99596375, 'binary_precision': 0.99793106, 'binary_recall': 0.9335484, 'binary_specificity': 0.99802893, 'binary_f1_score': 0.9646667}
confusion matrix:
      0     1
0  1519     3
1   103  1447
---- Validation: 
scalar performance:
{'acc': 0.7867704, 'precision': 0.81389886, 'recall': 0.78573525, 'specificity': 0.78573525, 'f1': 0.7816382, 'auroc': 0.8787701, 'binary_precision': 0.90444446, 'binary_recall': 0.63793105, 'binary_specificity': 0.9335394, 'binary_f1_score': 0.74816173}
confusion matrix:
     0    1
0  604   43
1  231  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175676, 'precision': 0.82388306, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.8166739, 'auroc': 0.8903498, 'binary_precision': 0.8691099, 'binary_recall': 0.7477477, 'binary_specificity': 0.8873874, 'binary_f1_score': 0.8038741}
confusion matrix:
     0    1
0  197   25
1   56  166
early stop counter: 1
val acc:0.7867704033851624, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8400900959968567
after epoch: 4,now: 2024-07-29 05:29:48.214533,epoch time: 0:01:33.681597,used: 0:06:27.062800,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9841529, 'recall': 0.98414654, 'specificity': 0.98414654, 'f1': 0.98404956, 'auroc': 0.9970386, 'binary_precision': 0.99407893, 'binary_recall': 0.9742102, 'binary_specificity': 0.99408287, 'binary_f1_score': 0.9840443}
confusion matrix:
      0     1
0  1512     9
1    40  1511
---- Validation: 
scalar performance:
{'acc': 0.82023346, 'precision': 0.828516, 'recall': 0.81967413, 'specificity': 0.81967413, 'f1': 0.8189064, 'auroc': 0.9011183, 'binary_precision': 0.87895715, 'binary_recall': 0.7398119, 'binary_specificity': 0.8995363, 'binary_f1_score': 0.8034042}
confusion matrix:
     0    1
0  582   65
1  166  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8648649, 'precision': 0.87471867, 'recall': 0.8648648, 'specificity': 0.8648648, 'f1': 0.8639706, 'auroc': 0.9162406, 'binary_precision': 0.9354839, 'binary_recall': 0.7837838, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.8529412}
confusion matrix:
     0    1
0  210   12
1   48  174
new oracle model saved
early stop counter: 2
val acc:0.8202334642410278, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 5,now: 2024-07-29 05:31:17.932540,epoch time: 0:01:29.718007,used: 0:07:56.780807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97756094, 'recall': 0.9771405, 'specificity': 0.9771405, 'f1': 0.9768857, 'auroc': 0.99774605, 'binary_precision': 0.998655, 'binary_recall': 0.9555985, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.97665244}
confusion matrix:
      0     1
0  1516     2
1    69  1485
---- Validation: 
scalar performance:
{'acc': 0.6451362, 'precision': 0.7651277, 'recall': 0.6427641, 'specificity': 0.6427641, 'f1': 0.5977605, 'auroc': 0.8147733, 'binary_precision': 0.94174755, 'binary_recall': 0.30407524, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.45971563}
confusion matrix:
     0    1
0  635   12
1  444  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7882883, 'precision': 0.84498835, 'recall': 0.7882883, 'specificity': 0.7882883, 'f1': 0.77921665, 'auroc': 0.91039693, 'binary_precision': 0.9848485, 'binary_recall': 0.5855856, 'binary_specificity': 0.990991, 'binary_f1_score': 0.7344633}
confusion matrix:
     0    1
0  220    2
1   92  130
early stop counter: 3
val acc:0.6451361775398254, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 6,now: 2024-07-29 05:32:53.983220,epoch time: 0:01:36.050680,used: 0:09:32.831487,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9881176, 'recall': 0.98787856, 'specificity': 0.98787856, 'f1': 0.9879519, 'auroc': 0.9992302, 'binary_precision': 0.9815756, 'binary_recall': 0.99484867, 'binary_specificity': 0.9809085, 'binary_f1_score': 0.9881676}
confusion matrix:
      0     1
0  1490    29
1     8  1545
---- Validation: 
scalar performance:
{'acc': 0.8070039, 'precision': 0.82117325, 'recall': 0.80626404, 'specificity': 0.80626404, 'f1': 0.8045838, 'auroc': 0.8952799, 'binary_precision': 0.8869048, 'binary_recall': 0.70062697, 'binary_specificity': 0.91190106, 'binary_f1_score': 0.7828371}
confusion matrix:
     0    1
0  590   57
1  191  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8243243, 'precision': 0.83120596, 'recall': 0.82432437, 'specificity': 0.82432437, 'f1': 0.82340705, 'auroc': 0.9004545, 'binary_precision': 0.8789474, 'binary_recall': 0.7522523, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.8106796}
confusion matrix:
     0    1
0  199   23
1   55  167
early stop counter: 4
val acc:0.807003915309906, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 7,now: 2024-07-29 05:34:22.677763,epoch time: 0:01:28.694543,used: 0:11:01.526030,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97979355, 'recall': 0.9793711, 'specificity': 0.9793711, 'f1': 0.9794824, 'auroc': 0.9986422, 'binary_precision': 0.970347, 'binary_recall': 0.989704, 'binary_specificity': 0.9690382, 'binary_f1_score': 0.97992986}
confusion matrix:
      0     1
0  1471    47
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.75875485, 'precision': 0.76088285, 'recall': 0.7584269, 'specificity': 0.7584269, 'f1': 0.75809723, 'auroc': 0.8328098, 'binary_precision': 0.7827586, 'binary_recall': 0.71159875, 'binary_specificity': 0.805255, 'binary_f1_score': 0.7454844}
confusion matrix:
     0    1
0  521  126
1  184  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7635135, 'precision': 0.78354037, 'recall': 0.7635135, 'specificity': 0.7635135, 'f1': 0.7592626, 'auroc': 0.89075565, 'binary_precision': 0.7081851, 'binary_recall': 0.8963964, 'binary_specificity': 0.6306306, 'binary_f1_score': 0.7912525}
confusion matrix:
     0    1
0  140   82
1   23  199
early stop counter: 5
val acc:0.7587548494338989, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 8,now: 2024-07-29 05:35:57.548614,epoch time: 0:01:34.870851,used: 0:12:36.396881,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848407, 'recall': 0.98462594, 'specificity': 0.98462594, 'f1': 0.9846956, 'auroc': 0.9985875, 'binary_precision': 0.97902095, 'binary_recall': 0.990991, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.9849696}
confusion matrix:
      0     1
0  1485    33
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.7914397, 'precision': 0.8159355, 'recall': 0.7904592, 'specificity': 0.7904592, 'f1': 0.78692734, 'auroc': 0.8767085, 'binary_precision': 0.90217394, 'binary_recall': 0.6504702, 'binary_specificity': 0.93044823, 'binary_f1_score': 0.7559198}
confusion matrix:
     0    1
0  602   45
1  223  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8513514, 'precision': 0.86439395, 'recall': 0.8513514, 'specificity': 0.8513514, 'f1': 0.8500092, 'auroc': 0.93034256, 'binary_precision': 0.93333334, 'binary_recall': 0.7567568, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.8358209}
confusion matrix:
     0    1
0  210   12
1   54  168
early stop counter: 6
val acc:0.7914397120475769, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 9,now: 2024-07-29 05:37:35.179458,epoch time: 0:01:37.630844,used: 0:14:14.027725,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9794243, 'recall': 0.9790786, 'specificity': 0.9790786, 'f1': 0.9788395, 'auroc': 0.99925053, 'binary_precision': 0.9993293, 'binary_recall': 0.95881593, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9786535}
confusion matrix:
      0     1
0  1517     1
1    64  1490
---- Validation: 
scalar performance:
{'acc': 0.75019455, 'precision': 0.81415, 'recall': 0.74860704, 'specificity': 0.74860704, 'f1': 0.73599625, 'auroc': 0.8990567, 'binary_precision': 0.95415473, 'binary_recall': 0.52194357, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.674772}
confusion matrix:
     0    1
0  631   16
1  305  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7725225, 'precision': 0.8336148, 'recall': 0.77252257, 'specificity': 0.77252257, 'f1': 0.7616089, 'auroc': 0.91124916, 'binary_precision': 0.97637796, 'binary_recall': 0.5585586, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.7106018}
confusion matrix:
     0    1
0  219    3
1   98  124
early stop counter: 7
val acc:0.7501945495605469, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 10,now: 2024-07-29 05:39:15.871280,epoch time: 0:01:40.691822,used: 0:15:54.719547,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9852643, 'recall': 0.9851918, 'specificity': 0.9851918, 'f1': 0.98502594, 'auroc': 0.99973035, 'binary_precision': 0.99933773, 'binary_recall': 0.97104245, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.98498696}
confusion matrix:
      0     1
0  1517     1
1    45  1509
---- Validation: 
scalar performance:
{'acc': 0.6754864, 'precision': 0.7861428, 'recall': 0.6732956, 'specificity': 0.6732956, 'f1': 0.63910353, 'auroc': 0.87815964, 'binary_precision': 0.9623431, 'binary_recall': 0.36050156, 'binary_specificity': 0.98608965, 'binary_f1_score': 0.5245154}
confusion matrix:
     0    1
0  638    9
1  408  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6824324, 'precision': 0.8057851, 'recall': 0.6824324, 'specificity': 0.6824324, 'f1': 0.6468139, 'auroc': 0.9176406, 'binary_precision': 1.0, 'binary_recall': 0.36486486, 'binary_specificity': 1.0, 'binary_f1_score': 0.5346535}
confusion matrix:
     0   1
0  222   0
1  141  81
early stop counter: 8
val acc:0.6754863858222961, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 11,now: 2024-07-29 05:40:52.311883,epoch time: 0:01:36.440603,used: 0:17:31.160150,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925157, 'recall': 0.99250877, 'specificity': 0.99250877, 'f1': 0.9925121, 'auroc': 0.9995053, 'binary_precision': 0.99227303, 'binary_recall': 0.99291235, 'binary_specificity': 0.99210525, 'binary_f1_score': 0.9925926}
confusion matrix:
      0     1
0  1508    12
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.8023346, 'precision': 0.816714, 'recall': 0.80158365, 'specificity': 0.80158365, 'f1': 0.79978526, 'auroc': 0.8801607, 'binary_precision': 0.88247013, 'binary_recall': 0.6943574, 'binary_specificity': 0.9088099, 'binary_f1_score': 0.77719295}
confusion matrix:
     0    1
0  588   59
1  195  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.84227425, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.8271312, 'auroc': 0.89803994, 'binary_precision': 0.9101124, 'binary_recall': 0.7297297, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.81000006}
confusion matrix:
     0    1
0  206   16
1   60  162
early stop counter: 9
val acc:0.8023346066474915, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 12,now: 2024-07-29 05:42:25.560019,epoch time: 0:01:33.248136,used: 0:19:04.408286,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.991223, 'recall': 0.9912744, 'specificity': 0.9912744, 'f1': 0.9912108, 'auroc': 0.9997448, 'binary_precision': 0.99739075, 'binary_recall': 0.98518044, 'binary_specificity': 0.9973684, 'binary_f1_score': 0.991248}
confusion matrix:
      0     1
0  1516     4
1    23  1529
---- Validation: 
scalar performance:
{'acc': 0.6241245, 'precision': 0.7634125, 'recall': 0.6215606, 'specificity': 0.6215606, 'f1': 0.56434536, 'auroc': 0.8531467, 'binary_precision': 0.9532164, 'binary_recall': 0.2554859, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.40296662}
confusion matrix:
     0    1
0  639    8
1  475  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103604, 'precision': 0.78101265, 'recall': 0.6103604, 'specificity': 0.6103604, 'f1': 0.5406173, 'auroc': 0.8760247, 'binary_precision': 1.0, 'binary_recall': 0.22072072, 'binary_specificity': 1.0, 'binary_f1_score': 0.36162362}
confusion matrix:
     0   1
0  222   0
1  173  49
early stop counter: 10
val acc:0.6241245269775391, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 13,now: 2024-07-29 05:44:04.955165,epoch time: 0:01:39.395146,used: 0:20:43.803432,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.96849906, 'recall': 0.96720254, 'specificity': 0.96720254, 'f1': 0.96678245, 'auroc': 0.9996948, 'binary_precision': 1.0, 'binary_recall': 0.93440515, 'binary_specificity': 1.0, 'binary_f1_score': 0.96609044}
confusion matrix:
      0     1
0  1517     0
1   102  1453
---- Validation: 
scalar performance:
{'acc': 0.69416344, 'precision': 0.7855985, 'recall': 0.6921698, 'specificity': 0.6921698, 'f1': 0.66618764, 'auroc': 0.8867452, 'binary_precision': 0.94545454, 'binary_recall': 0.4075235, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.56955093}
confusion matrix:
     0    1
0  632   15
1  378  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6734234, 'precision': 0.7964106, 'recall': 0.6734234, 'specificity': 0.6734234, 'f1': 0.6356268, 'auroc': 0.9255894, 'binary_precision': 0.98734176, 'binary_recall': 0.35135135, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5182724}
confusion matrix:
     0   1
0  221   1
1  144  78
early stop counter: 11
val acc:0.69416344165802, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 14,now: 2024-07-29 05:45:39.741373,epoch time: 0:01:34.786208,used: 0:22:18.589640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98504704, 'recall': 0.98456526, 'specificity': 0.98456526, 'f1': 0.98469234, 'auroc': 0.9996766, 'binary_precision': 0.9748111, 'binary_recall': 0.9954984, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.98504615}
confusion matrix:
      0     1
0  1477    40
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.8023346, 'precision': 0.8069458, 'recall': 0.8018998, 'specificity': 0.8018998, 'f1': 0.8014244, 'auroc': 0.88344324, 'binary_precision': 0.8428571, 'binary_recall': 0.7398119, 'binary_specificity': 0.8639876, 'binary_f1_score': 0.78797996}
confusion matrix:
     0    1
0  559   88
1  166  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.8290692, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.8287975, 'auroc': 0.901185, 'binary_precision': 0.837963, 'binary_recall': 0.8153153, 'binary_specificity': 0.8423423, 'binary_f1_score': 0.826484}
confusion matrix:
     0    1
0  187   35
1   41  181
early stop counter: 12
val acc:0.8023346066474915, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 15,now: 2024-07-29 05:47:13.361377,epoch time: 0:01:33.620004,used: 0:23:52.209644,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99089235, 'recall': 0.99087656, 'specificity': 0.99087656, 'f1': 0.99088407, 'auroc': 0.99907124, 'binary_precision': 0.9903599, 'binary_recall': 0.9916345, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9909968}
confusion matrix:
      0     1
0  1503    15
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.81089497, 'precision': 0.834928, 'recall': 0.8099536, 'specificity': 0.8099536, 'f1': 0.80711013, 'auroc': 0.9047642, 'binary_precision': 0.9229122, 'binary_recall': 0.6755486, 'binary_specificity': 0.9443586, 'binary_f1_score': 0.7800905}
confusion matrix:
     0    1
0  611   36
1  207  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7882883, 'precision': 0.81441975, 'recall': 0.78828824, 'specificity': 0.78828824, 'f1': 0.7837961, 'auroc': 0.8959094, 'binary_precision': 0.9050633, 'binary_recall': 0.6441441, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.75263155}
confusion matrix:
     0    1
0  207   15
1   79  143
early stop counter: 13
val acc:0.8108949661254883, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 16,now: 2024-07-29 05:48:43.244411,epoch time: 0:01:29.883034,used: 0:25:22.092678,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9801136, 'recall': 0.97969055, 'specificity': 0.97969055, 'f1': 0.9794898, 'auroc': 0.99979734, 'binary_precision': 1.0, 'binary_recall': 0.95938104, 'binary_specificity': 1.0, 'binary_f1_score': 0.97926944}
confusion matrix:
      0     1
0  1521     0
1    63  1488
---- Validation: 
scalar performance:
{'acc': 0.6404669, 'precision': 0.77381635, 'recall': 0.63800734, 'specificity': 0.63800734, 'f1': 0.58840823, 'auroc': 0.8921336, 'binary_precision': 0.9631579, 'binary_recall': 0.28683385, 'binary_specificity': 0.98918086, 'binary_f1_score': 0.44202894}
confusion matrix:
     0    1
0  640    7
1  455  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.536036, 'precision': 0.75934577, 'recall': 0.536036, 'specificity': 0.536036, 'f1': 0.40876538, 'auroc': 0.90877366, 'binary_precision': 1.0, 'binary_recall': 0.072072074, 'binary_specificity': 1.0, 'binary_f1_score': 0.13445379}
confusion matrix:
     0   1
0  222   0
1  206  16
early stop counter: 14
val acc:0.6404669284820557, best validation acc: 0.8249027132987976, corresponding to test acc:                         0.8400900959968567 / 0.8648648858070374
after epoch: 17,now: 2024-07-29 05:50:21.587198,epoch time: 0:01:38.342787,used: 0:27:00.435465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9858353, 'recall': 0.9852021, 'specificity': 0.9852021, 'f1': 0.98534286, 'auroc': 0.99968505, 'binary_precision': 0.97302383, 'binary_recall': 0.9987122, 'binary_specificity': 0.9716919, 'binary_f1_score': 0.9857007}
confusion matrix:
      0     1
0  1476    43
1     2  1551
---- Validation: 
scalar performance:
{'acc': 0.82801557, 'precision': 0.839901, 'recall': 0.8273585, 'specificity': 0.8273585, 'f1': 0.82629204, 'auroc': 0.90786755, 'binary_precision': 0.9017341, 'binary_recall': 0.7335423, 'binary_specificity': 0.92117465, 'binary_f1_score': 0.8089888}
confusion matrix:
     0    1
0  596   51
1  170  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8693694, 'precision': 0.8817632, 'recall': 0.8693694, 'specificity': 0.8693694, 'f1': 0.86830044, 'auroc': 0.92815113, 'binary_precision': 0.9505494, 'binary_recall': 0.7792793, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.8564356}
confusion matrix:
     0    1
0  213    9
1   49  173
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-29 05:51:51.165568,epoch time: 0:01:29.578370,used: 0:28:30.013835,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928236, 'recall': 0.9928938, 'specificity': 0.9928938, 'f1': 0.9928381, 'auroc': 0.99983513, 'binary_precision': 0.9974043, 'binary_recall': 0.9884244, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.99289405}
confusion matrix:
      0     1
0  1513     4
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.7634241, 'precision': 0.8126199, 'recall': 0.762028, 'specificity': 0.762028, 'f1': 0.75308084, 'auroc': 0.899047, 'binary_precision': 0.9348958, 'binary_recall': 0.5626959, 'binary_specificity': 0.9613601, 'binary_f1_score': 0.70254403}
confusion matrix:
     0    1
0  622   25
1  279  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108108, 'precision': 0.84512436, 'recall': 0.8108108, 'specificity': 0.8108108, 'f1': 0.8059885, 'auroc': 0.9137043, 'binary_precision': 0.95394737, 'binary_recall': 0.6531532, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.7754011}
confusion matrix:
     0    1
0  215    7
1   77  145
early stop counter: 1
val acc:0.7634240984916687, best validation acc: 0.8280155658721924, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 19,now: 2024-07-29 05:53:30.193048,epoch time: 0:01:39.027480,used: 0:30:09.041315,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99347806, 'recall': 0.9935032, 'specificity': 0.9935032, 'f1': 0.99348897, 'auroc': 0.9998554, 'binary_precision': 0.9948354, 'binary_recall': 0.99227303, 'binary_specificity': 0.9947334, 'binary_f1_score': 0.99355257}
confusion matrix:
      0     1
0  1511     8
1    12  1541
---- Validation: 
scalar performance:
{'acc': 0.78210115, 'precision': 0.829216, 'recall': 0.7807714, 'specificity': 0.7807714, 'f1': 0.7734577, 'auroc': 0.9199803, 'binary_precision': 0.9520202, 'binary_recall': 0.59090906, 'binary_specificity': 0.9706337, 'binary_f1_score': 0.729207}
confusion matrix:
     0    1
0  628   19
1  261  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7657658, 'precision': 0.8368827, 'recall': 0.7657658, 'specificity': 0.7657658, 'f1': 0.7527151, 'auroc': 0.9182087, 'binary_precision': 0.9916667, 'binary_recall': 0.536036, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.69590646}
confusion matrix:
     0    1
0  221    1
1  103  119
early stop counter: 2
val acc:0.7821011543273926, best validation acc: 0.8280155658721924, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 20,now: 2024-07-29 05:55:01.813491,epoch time: 0:01:31.620443,used: 0:31:40.661758,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.97273016, 'recall': 0.9707372, 'specificity': 0.9707372, 'f1': 0.97098655, 'auroc': 0.9995011, 'binary_precision': 0.946854, 'binary_recall': 0.99871135, 'binary_specificity': 0.94276315, 'binary_f1_score': 0.97209156}
confusion matrix:
      0     1
0  1433    87
1     2  1550
---- Validation: 
scalar performance:
{'acc': 0.81867707, 'precision': 0.829389, 'recall': 0.8193059, 'specificity': 0.8193059, 'f1': 0.8173871, 'auroc': 0.9035069, 'binary_precision': 0.7682119, 'binary_recall': 0.90909094, 'binary_specificity': 0.72952086, 'binary_f1_score': 0.83273506}
confusion matrix:
     0    1
0  472  175
1   58  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747748, 'precision': 0.7894579, 'recall': 0.7747748, 'specificity': 0.7747748, 'f1': 0.7718819, 'auroc': 0.9028691, 'binary_precision': 0.7242647, 'binary_recall': 0.8873874, 'binary_specificity': 0.6621622, 'binary_f1_score': 0.7975708}
confusion matrix:
     0    1
0  147   75
1   25  197
early stop counter: 3
val acc:0.8186770677566528, best validation acc: 0.8280155658721924, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 21,now: 2024-07-29 05:56:40.285406,epoch time: 0:01:38.471915,used: 0:33:19.133673,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98484427, 'recall': 0.98462164, 'specificity': 0.98462164, 'f1': 0.9846953, 'auroc': 0.99934673, 'binary_precision': 0.9790343, 'binary_recall': 0.9909968, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9849793}
confusion matrix:
      0     1
0  1484    33
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8544747, 'precision': 0.8626293, 'recall': 0.8539498, 'specificity': 0.8539498, 'f1': 0.85351527, 'auroc': 0.9248848, 'binary_precision': 0.91528547, 'binary_recall': 0.7789969, 'binary_specificity': 0.9289026, 'binary_f1_score': 0.84165967}
confusion matrix:
     0    1
0  601   46
1  141  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.877609, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.846196, 'auroc': 0.9215567, 'binary_precision': 0.98136646, 'binary_recall': 0.7117117, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.82506526}
confusion matrix:
     0    1
0  219    3
1   64  158
better model found
persisted
after epoch: 22,now: 2024-07-29 05:58:21.608312,epoch time: 0:01:41.322906,used: 0:35:00.456579,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99480855, 'recall': 0.9947766, 'specificity': 0.9947766, 'f1': 0.99479085, 'auroc': 0.9998665, 'binary_precision': 0.9935774, 'binary_recall': 0.9961365, 'binary_specificity': 0.9934167, 'binary_f1_score': 0.9948553}
confusion matrix:
      0     1
0  1509    10
1     6  1547
---- Validation: 
scalar performance:
{'acc': 0.8731518, 'precision': 0.8743514, 'recall': 0.8729547, 'specificity': 0.8729547, 'f1': 0.8730029, 'auroc': 0.9250411, 'binary_precision': 0.89386404, 'binary_recall': 0.8448276, 'binary_specificity': 0.9010819, 'binary_f1_score': 0.8686543}
confusion matrix:
     0    1
0  583   64
1   99  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378378, 'precision': 0.8480351, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.83664125, 'auroc': 0.92098856, 'binary_precision': 0.9076087, 'binary_recall': 0.7522523, 'binary_specificity': 0.9234234, 'binary_f1_score': 0.8226601}
confusion matrix:
     0    1
0  205   17
1   55  167
better model found
persisted
after epoch: 23,now: 2024-07-29 05:59:56.789455,epoch time: 0:01:35.181143,used: 0:36:35.637722,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97976243, 'recall': 0.9786584, 'specificity': 0.9786584, 'f1': 0.9788234, 'auroc': 0.99974394, 'binary_precision': 0.96089387, 'binary_recall': 0.9987097, 'binary_specificity': 0.9586071, 'binary_f1_score': 0.97943693}
confusion matrix:
      0     1
0  1459    63
1     2  1548
---- Validation: 
scalar performance:
{'acc': 0.8233463, 'precision': 0.84478235, 'recall': 0.82247096, 'specificity': 0.82247096, 'f1': 0.82027435, 'auroc': 0.8869196, 'binary_precision': 0.9290188, 'binary_recall': 0.6974922, 'binary_specificity': 0.94744974, 'binary_f1_score': 0.7967771}
confusion matrix:
     0    1
0  613   34
1  193  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7522523, 'precision': 0.8045566, 'recall': 0.7522522, 'specificity': 0.7522522, 'f1': 0.74113804, 'auroc': 0.86504745, 'binary_precision': 0.9307692, 'binary_recall': 0.545045, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.68749994}
confusion matrix:
     0    1
0  213    9
1  101  121
early stop counter: 1
val acc:0.8233463168144226, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 24,now: 2024-07-29 06:01:26.042623,epoch time: 0:01:29.253168,used: 0:38:04.890890,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99185085, 'recall': 0.99190784, 'specificity': 0.99190784, 'f1': 0.9918616, 'auroc': 0.99985796, 'binary_precision': 0.9961039, 'binary_recall': 0.9877656, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.9919172}
confusion matrix:
      0     1
0  1513     6
1    19  1534
---- Validation: 
scalar performance:
{'acc': 0.7058366, 'precision': 0.80699694, 'recall': 0.7038163, 'specificity': 0.7038163, 'f1': 0.6781318, 'auroc': 0.9064648, 'binary_precision': 0.9814815, 'binary_recall': 0.4153605, 'binary_specificity': 0.992272, 'binary_f1_score': 0.5837004}
confusion matrix:
     0    1
0  642    5
1  373  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5337838, 'precision': 0.75874126, 'recall': 0.5337838, 'specificity': 0.5337838, 'f1': 0.40430495, 'auroc': 0.8689281, 'binary_precision': 1.0, 'binary_recall': 0.067567565, 'binary_specificity': 1.0, 'binary_f1_score': 0.12658226}
confusion matrix:
     0   1
0  222   0
1  207  15
early stop counter: 2
val acc:0.7058365941047668, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 25,now: 2024-07-29 06:02:52.717599,epoch time: 0:01:26.674976,used: 0:39:31.565866,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908752, 'recall': 0.99092513, 'specificity': 0.99092513, 'f1': 0.990885, 'auroc': 0.99949265, 'binary_precision': 0.9948052, 'binary_recall': 0.9871134, 'binary_specificity': 0.99473685, 'binary_f1_score': 0.9909444}
confusion matrix:
      0     1
0  1512     8
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.82023346, 'precision': 0.8431951, 'recall': 0.81932527, 'specificity': 0.81932527, 'f1': 0.8168758, 'auroc': 0.9120488, 'binary_precision': 0.9302326, 'binary_recall': 0.6896552, 'binary_specificity': 0.94899535, 'binary_f1_score': 0.7920792}
confusion matrix:
     0    1
0  614   33
1  198  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8536036, 'precision': 0.864864, 'recall': 0.8536036, 'specificity': 0.8536036, 'f1': 0.8524653, 'auroc': 0.9182899, 'binary_precision': 0.92896175, 'binary_recall': 0.7657658, 'binary_specificity': 0.9414414, 'binary_f1_score': 0.8395062}
confusion matrix:
     0    1
0  209   13
1   52  170
early stop counter: 3
val acc:0.8202334642410278, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 26,now: 2024-07-29 06:04:22.018143,epoch time: 0:01:29.300544,used: 0:41:00.866410,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931487, 'recall': 0.99318314, 'specificity': 0.99318314, 'f1': 0.9931632, 'auroc': 0.9997876, 'binary_precision': 0.9948387, 'binary_recall': 0.99163985, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9932367}
confusion matrix:
      0     1
0  1509     8
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.8311284, 'precision': 0.85369444, 'recall': 0.8302425, 'specificity': 0.8302425, 'f1': 0.8281201, 'auroc': 0.9239582, 'binary_precision': 0.9412998, 'binary_recall': 0.70376176, 'binary_specificity': 0.95672333, 'binary_f1_score': 0.8053812}
confusion matrix:
     0    1
0  619   28
1  189  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8152522, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7363575, 'auroc': 0.89509785, 'binary_precision': 0.9586777, 'binary_recall': 0.5225225, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.6763848}
confusion matrix:
     0    1
0  217    5
1  106  116
early stop counter: 4
val acc:0.8311284184455872, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 27,now: 2024-07-29 06:05:53.056400,epoch time: 0:01:31.038257,used: 0:42:31.904667,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99445075, 'recall': 0.9944979, 'specificity': 0.9944979, 'f1': 0.9944658, 'auroc': 0.99984825, 'binary_precision': 0.99740934, 'binary_recall': 0.9916291, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.9945108}
confusion matrix:
      0     1
0  1515     4
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.75719845, 'precision': 0.80794585, 'recall': 0.7557694, 'specificity': 0.7557694, 'f1': 0.74607056, 'auroc': 0.88324094, 'binary_precision': 0.93121696, 'binary_recall': 0.55172414, 'binary_specificity': 0.95981455, 'binary_f1_score': 0.69291335}
confusion matrix:
     0    1
0  621   26
1  286  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7252252, 'precision': 0.7825578, 'recall': 0.7252252, 'specificity': 0.7252252, 'f1': 0.7105421, 'auroc': 0.86251116, 'binary_precision': 0.90983605, 'binary_recall': 0.5, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.64534885}
confusion matrix:
     0    1
0  211   11
1  111  111
early stop counter: 5
val acc:0.7571984529495239, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 28,now: 2024-07-29 06:07:24.194930,epoch time: 0:01:31.138530,used: 0:44:03.043197,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.979022, 'recall': 0.978754, 'specificity': 0.978754, 'f1': 0.9785145, 'auroc': 0.99930704, 'binary_precision': 0.9979933, 'binary_recall': 0.95948553, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.97836065}
confusion matrix:
      0     1
0  1514     3
1    63  1492
---- Validation: 
scalar performance:
{'acc': 0.79688716, 'precision': 0.8301961, 'recall': 0.79577065, 'specificity': 0.79577065, 'f1': 0.791204, 'auroc': 0.91805863, 'binary_precision': 0.93333334, 'binary_recall': 0.6363636, 'binary_specificity': 0.9551777, 'binary_f1_score': 0.7567567}
confusion matrix:
     0    1
0  618   29
1  232  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.795045, 'precision': 0.8403553, 'recall': 0.795045, 'specificity': 0.795045, 'f1': 0.787989, 'auroc': 0.89396155, 'binary_precision': 0.964539, 'binary_recall': 0.6126126, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.7493113}
confusion matrix:
     0    1
0  217    5
1   86  136
early stop counter: 6
val acc:0.7968871593475342, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 29,now: 2024-07-29 06:08:58.388559,epoch time: 0:01:34.193629,used: 0:45:37.236826,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928651, 'recall': 0.9928174, 'specificity': 0.9928174, 'f1': 0.9928374, 'auroc': 0.9997202, 'binary_precision': 0.9910141, 'binary_recall': 0.9948454, 'binary_specificity': 0.9907895, 'binary_f1_score': 0.99292606}
confusion matrix:
      0     1
0  1506    14
1     8  1544
---- Validation: 
scalar performance:
{'acc': 0.8, 'precision': 0.8301164, 'recall': 0.79893816, 'specificity': 0.79893816, 'f1': 0.7949325, 'auroc': 0.90766644, 'binary_precision': 0.9280899, 'binary_recall': 0.6473354, 'binary_specificity': 0.95054096, 'binary_f1_score': 0.7626962}
confusion matrix:
     0    1
0  615   32
1  225  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8603604, 'precision': 0.8867596, 'recall': 0.8603604, 'specificity': 0.8603604, 'f1': 0.85793614, 'auroc': 0.91573334, 'binary_precision': 0.9878049, 'binary_recall': 0.7297297, 'binary_specificity': 0.990991, 'binary_f1_score': 0.83937824}
confusion matrix:
     0    1
0  220    2
1   60  162
early stop counter: 7
val acc:0.800000011920929, best validation acc: 0.8731517791748047, corresponding to test acc:                         0.837837815284729 / 0.869369387626648
after epoch: 30,now: 2024-07-29 06:10:33.782543,epoch time: 0:01:35.393984,used: 0:47:12.630810,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_20_seed_6_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:12.630810 at 2024-07-29 06:10:33.782543
persisted model performance metric: 

scalar performance:
{'acc': 0.8378378, 'precision': 0.8480351, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.83664125, 'auroc': 0.92098856, 'binary_precision': 0.9076087, 'binary_recall': 0.7522523, 'binary_specificity': 0.9234234, 'binary_f1_score': 0.8226601}
confusion matrix:
     0    1
0  205   17
1   55  167
oracle model performance metric: 

scalar performance:
{'acc': 0.8693694, 'precision': 0.8817632, 'recall': 0.8693694, 'specificity': 0.8693694, 'f1': 0.86830044, 'auroc': 0.92815113, 'binary_precision': 0.9505494, 'binary_recall': 0.7792793, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.8564356}
confusion matrix:
     0    1
0  213    9
1   49  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456803 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool | 416208 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456803 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool | 416208 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 513552 GiB | 513551 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 507475 GiB | 507475 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14488 MiB |  95978 MiB |  81500 MiB |
|       from large pool |  14412 MiB |  14422 MiB |  95812 MiB |  81400 MiB |
|       from small pool |     66 MiB |     70 MiB |    166 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 472988 KiB |   1260 MiB | 368219 GiB | 368218 GiB |
|       from large pool | 462384 KiB |   1252 MiB | 362092 GiB | 362091 GiB |
|       from small pool |  10604 KiB |     47 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90480 K  |   90478 K  |
|       from large pool |     187    |    1413    |   45955 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44524 K  |   44523 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90480 K  |   90478 K  |
|       from large pool |     187    |    1413    |   45955 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44524 K  |   44523 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    4069    |    3433    |
|       from large pool |     603    |     603    |    3986    |    3383    |
|       from small pool |      33    |      35    |      83    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     653    |   60127 K  |   60127 K  |
|       from large pool |      39    |     605    |   34097 K  |   34097 K  |
|       from small pool |      58    |     236    |   26030 K  |   26030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513552 GiB | 513552 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507475 GiB | 507475 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB |  95978 MiB |  95070 MiB |
|       from large pool |    858 MiB |  14422 MiB |  95812 MiB |  94954 MiB |
|       from small pool |     50 MiB |     70 MiB |    166 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 368219 GiB | 368219 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 362092 GiB | 362092 GiB |
|       from small pool |      0 KiB |     47 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90480 K  |   90480 K  |
|       from large pool |       2    |    1413    |   45955 K  |   45955 K  |
|       from small pool |       0    |    1419    |   44524 K  |   44524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90480 K  |   90480 K  |
|       from large pool |       2    |    1413    |   45955 K  |   45955 K  |
|       from small pool |       0    |    1419    |   44524 K  |   44524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    4069    |    4005    |
|       from large pool |      39    |     603    |    3986    |    3947    |
|       from small pool |      25    |      35    |      83    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   60128 K  |   60128 K  |
|       from large pool |       3    |     605    |   34097 K  |   34097 K  |
|       from small pool |       0    |     236    |   26030 K  |   26030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513552 GiB | 513552 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507475 GiB | 507475 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB |  95978 MiB |  95070 MiB |
|       from large pool |    858 MiB |  14422 MiB |  95812 MiB |  94954 MiB |
|       from small pool |     50 MiB |     70 MiB |    166 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 368219 GiB | 368219 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 362092 GiB | 362092 GiB |
|       from small pool |      0 KiB |     47 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90480 K  |   90480 K  |
|       from large pool |       2    |    1413    |   45955 K  |   45955 K  |
|       from small pool |       0    |    1419    |   44524 K  |   44524 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90480 K  |   90480 K  |
|       from large pool |       2    |    1413    |   45955 K  |   45955 K  |
|       from small pool |       0    |    1419    |   44524 K  |   44524 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    4069    |    4005    |
|       from large pool |      39    |     603    |    3986    |    3947    |
|       from small pool |      25    |      35    |      83    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   60128 K  |   60128 K  |
|       from large pool |       3    |     605    |   34097 K  |   34097 K  |
|       from small pool |       0    |     236    |   26030 K  |   26030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368

 Experiment start at: 2024-07-29 06:11:16.596345
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9322917, 'precision': 0.93433225, 'recall': 0.9317868, 'specificity': 0.9317868, 'f1': 0.93214256, 'auroc': 0.9877069, 'binary_precision': 0.90821254, 'binary_recall': 0.96410257, 'binary_specificity': 0.8994709, 'binary_f1_score': 0.93532336}
confusion matrix:
      0     1
0  1360   152
1    56  1504
---- Validation: 
scalar performance:
{'acc': 0.67230767, 'precision': 0.76278, 'recall': 0.67675185, 'specificity': 0.67675185, 'f1': 0.6447623, 'auroc': 0.8504735, 'binary_precision': 0.6046967, 'binary_recall': 0.965625, 'binary_specificity': 0.38787878, 'binary_f1_score': 0.7436823}
confusion matrix:
     0    1
0  256  404
1   22  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55676854, 'precision': 0.7318536, 'recall': 0.55676854, 'specificity': 0.55676854, 'f1': 0.45361796, 'auroc': 0.7450087, 'binary_precision': 0.5303738, 'binary_recall': 0.99126637, 'binary_specificity': 0.12227074, 'binary_f1_score': 0.6910197}
confusion matrix:
    0    1
0  28  201
1   2  227
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:12:53.377321,epoch time: 0:01:36.780976,used: 0:01:36.780976,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9580078, 'precision': 0.96016777, 'recall': 0.9585928, 'specificity': 0.9585928, 'f1': 0.9579866, 'auroc': 0.9937114, 'binary_precision': 0.995842, 'binary_recall': 0.92115384, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.95704293}
confusion matrix:
      0     1
0  1506     6
1   123  1437
---- Validation: 
scalar performance:
{'acc': 0.65923077, 'precision': 0.76221687, 'recall': 0.6543324, 'specificity': 0.6543324, 'f1': 0.6180201, 'auroc': 0.87263966, 'binary_precision': 0.9227468, 'binary_recall': 0.3359375, 'binary_specificity': 0.9727273, 'binary_f1_score': 0.49255443}
confusion matrix:
     0    1
0  642   18
1  425  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.87861085, 'recall': 0.84716153, 'specificity': 0.84716153, 'f1': 0.84392035, 'auroc': 0.9371865, 'binary_precision': 0.9877301, 'binary_recall': 0.70305675, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.82142854}
confusion matrix:
     0    1
0  227    2
1   68  161
new oracle model saved
early stop counter: 1
val acc:0.6592307686805725, best validation acc: 0.6723076701164246, corresponding to test acc:                         0.556768536567688 / 0.847161591053009
after epoch: 2,now: 2024-07-29 06:14:26.101047,epoch time: 0:01:32.723726,used: 0:03:09.504702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.9675784, 'recall': 0.96690583, 'specificity': 0.96690583, 'f1': 0.96646595, 'auroc': 0.9966503, 'binary_precision': 0.9945689, 'binary_recall': 0.9391026, 'binary_specificity': 0.994709, 'binary_f1_score': 0.96604025}
confusion matrix:
      0     1
0  1504     8
1    95  1465
---- Validation: 
scalar performance:
{'acc': 0.82076925, 'precision': 0.83117235, 'recall': 0.8193892, 'specificity': 0.8193892, 'f1': 0.8188734, 'auroc': 0.8735062, 'binary_precision': 0.88614804, 'binary_recall': 0.7296875, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.8003428}
confusion matrix:
     0    1
0  600   60
1  173  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8842795, 'precision': 0.8843454, 'recall': 0.8842795, 'specificity': 0.8842795, 'f1': 0.8842745, 'auroc': 0.9552258, 'binary_precision': 0.87931037, 'binary_recall': 0.8908297, 'binary_specificity': 0.87772924, 'binary_f1_score': 0.88503253}
confusion matrix:
     0    1
0  201   28
1   25  204
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 06:16:01.342937,epoch time: 0:01:35.241890,used: 0:04:44.746592,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9778439, 'recall': 0.9778795, 'specificity': 0.9778795, 'f1': 0.97786003, 'auroc': 0.9974579, 'binary_precision': 0.97943443, 'binary_recall': 0.97692305, 'binary_specificity': 0.978836, 'binary_f1_score': 0.97817713}
confusion matrix:
      0     1
0  1480    32
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.8038462, 'precision': 0.8098626, 'recall': 0.8027462, 'specificity': 0.8027462, 'f1': 0.80245745, 'auroc': 0.8771993, 'binary_precision': 0.8493648, 'binary_recall': 0.73125, 'binary_specificity': 0.8742424, 'binary_f1_score': 0.7858943}
confusion matrix:
     0    1
0  577   83
1  172  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8659967, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8645022, 'auroc': 0.94447094, 'binary_precision': 0.8436214, 'binary_recall': 0.8951965, 'binary_specificity': 0.83406115, 'binary_f1_score': 0.868644}
confusion matrix:
     0    1
0  191   38
1   24  205
early stop counter: 1
val acc:0.8038461804389954, best validation acc: 0.8207692503929138, corresponding to test acc:                         0.8842794895172119 / 0.8842794895172119
after epoch: 4,now: 2024-07-29 06:17:32.460163,epoch time: 0:01:31.117226,used: 0:06:15.863818,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9814909, 'recall': 0.9815985, 'specificity': 0.9815985, 'f1': 0.9814447, 'auroc': 0.99852467, 'binary_precision': 0.9914977, 'binary_recall': 0.97179484, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.98154736}
confusion matrix:
      0     1
0  1499    13
1    44  1516
---- Validation: 
scalar performance:
{'acc': 0.7876923, 'precision': 0.7913588, 'recall': 0.7867898, 'specificity': 0.7867898, 'f1': 0.7866236, 'auroc': 0.84567237, 'binary_precision': 0.82042253, 'binary_recall': 0.728125, 'binary_specificity': 0.8454546, 'binary_f1_score': 0.7715232}
confusion matrix:
     0    1
0  558  102
1  174  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.8496217, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.84202355, 'auroc': 0.9362712, 'binary_precision': 0.8007663, 'binary_recall': 0.91266376, 'binary_specificity': 0.77292573, 'binary_f1_score': 0.85306126}
confusion matrix:
     0    1
0  177   52
1   20  209
early stop counter: 2
val acc:0.7876923084259033, best validation acc: 0.8207692503929138, corresponding to test acc:                         0.8842794895172119 / 0.8842794895172119
after epoch: 5,now: 2024-07-29 06:18:56.463123,epoch time: 0:01:24.002960,used: 0:07:39.866778,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9843435, 'recall': 0.9844322, 'specificity': 0.9844322, 'f1': 0.98437285, 'auroc': 0.9985051, 'binary_precision': 0.9883721, 'binary_recall': 0.9807692, 'binary_specificity': 0.9880952, 'binary_f1_score': 0.984556}
confusion matrix:
      0     1
0  1494    18
1    30  1530
---- Validation: 
scalar performance:
{'acc': 0.8130769, 'precision': 0.8231943, 'recall': 0.8116951, 'specificity': 0.8116951, 'f1': 0.8110997, 'auroc': 0.88086647, 'binary_precision': 0.87666035, 'binary_recall': 0.721875, 'binary_specificity': 0.9015151, 'binary_f1_score': 0.7917738}
confusion matrix:
     0    1
0  595   65
1  178  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8580786, 'precision': 0.86239773, 'recall': 0.8580786, 'specificity': 0.8580786, 'f1': 0.85765445, 'auroc': 0.9299593, 'binary_precision': 0.9019608, 'binary_recall': 0.80349344, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.8498845}
confusion matrix:
     0    1
0  209   20
1   45  184
early stop counter: 3
val acc:0.813076913356781, best validation acc: 0.8207692503929138, corresponding to test acc:                         0.8842794895172119 / 0.8842794895172119
after epoch: 6,now: 2024-07-29 06:20:31.159167,epoch time: 0:01:34.696044,used: 0:09:14.562822,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98760563, 'recall': 0.98765767, 'specificity': 0.98765767, 'f1': 0.98762786, 'auroc': 0.99931693, 'binary_precision': 0.989704, 'binary_recall': 0.9858974, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.987797}
confusion matrix:
      0     1
0  1496    16
1    22  1538
---- Validation: 
scalar performance:
{'acc': 0.78307694, 'precision': 0.8076476, 'recall': 0.7808712, 'specificity': 0.7808712, 'f1': 0.7777099, 'auroc': 0.8663926, 'binary_precision': 0.8908297, 'binary_recall': 0.6375, 'binary_specificity': 0.92424244, 'binary_f1_score': 0.7431694}
confusion matrix:
     0    1
0  610   50
1  232  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.85052156, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8419236, 'auroc': 0.9195286, 'binary_precision': 0.9025641, 'binary_recall': 0.768559, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8301887}
confusion matrix:
     0    1
0  210   19
1   53  176
early stop counter: 4
val acc:0.7830769419670105, best validation acc: 0.8207692503929138, corresponding to test acc:                         0.8842794895172119 / 0.8842794895172119
after epoch: 7,now: 2024-07-29 06:22:01.205496,epoch time: 0:01:30.046329,used: 0:10:44.609151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97372663, 'recall': 0.97195256, 'specificity': 0.97195256, 'f1': 0.9722878, 'auroc': 0.999197, 'binary_precision': 0.9516228, 'binary_recall': 0.99615383, 'binary_specificity': 0.94775134, 'binary_f1_score': 0.9733793}
confusion matrix:
      0     1
0  1433    79
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.8069231, 'precision': 0.80749255, 'recall': 0.8072443, 'specificity': 0.8072443, 'f1': 0.80690926, 'auroc': 0.8751184, 'binary_precision': 0.78986585, 'binary_recall': 0.828125, 'binary_specificity': 0.78636366, 'binary_f1_score': 0.808543}
confusion matrix:
     0    1
0  519  141
1  110  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8318777, 'precision': 0.83469236, 'recall': 0.8318777, 'specificity': 0.8318777, 'f1': 0.83152354, 'auroc': 0.9125494, 'binary_precision': 0.804, 'binary_recall': 0.87772924, 'binary_specificity': 0.7860262, 'binary_f1_score': 0.8392484}
confusion matrix:
     0    1
0  180   49
1   28  201
early stop counter: 5
val acc:0.8069230914115906, best validation acc: 0.8207692503929138, corresponding to test acc:                         0.8842794895172119 / 0.8842794895172119
after epoch: 8,now: 2024-07-29 06:23:34.295428,epoch time: 0:01:33.089932,used: 0:12:17.699083,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9814148, 'recall': 0.98056066, 'specificity': 0.98056066, 'f1': 0.98077667, 'auroc': 0.99919236, 'binary_precision': 0.96760124, 'binary_recall': 0.99551284, 'binary_specificity': 0.9656085, 'binary_f1_score': 0.98135865}
confusion matrix:
      0     1
0  1460    52
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.8138462, 'precision': 0.8217592, 'recall': 0.8126184, 'specificity': 0.8126184, 'f1': 0.8122464, 'auroc': 0.8785511, 'binary_precision': 0.86851853, 'binary_recall': 0.7328125, 'binary_specificity': 0.8924242, 'binary_f1_score': 0.7949153}
confusion matrix:
     0    1
0  589   71
1  171  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.84718806, 'recall': 0.8471616, 'specificity': 0.8471616, 'f1': 0.8471587, 'auroc': 0.9180794, 'binary_precision': 0.84415585, 'binary_recall': 0.8515284, 'binary_specificity': 0.8427948, 'binary_f1_score': 0.8478261}
confusion matrix:
     0    1
0  193   36
1   34  195
early stop counter: 6
val acc:0.8138461709022522, best validation acc: 0.8207692503929138, corresponding to test acc:                         0.8842794895172119 / 0.8842794895172119
after epoch: 9,now: 2024-07-29 06:25:05.346445,epoch time: 0:01:31.051017,used: 0:13:48.750100,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9868704, 'recall': 0.9865334, 'specificity': 0.9865334, 'f1': 0.98664653, 'auroc': 0.99946964, 'binary_precision': 0.9797852, 'binary_recall': 0.99423075, 'binary_specificity': 0.978836, 'binary_f1_score': 0.98695517}
confusion matrix:
      0     1
0  1480    32
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.8223077, 'precision': 0.83880496, 'recall': 0.8205966, 'specificity': 0.8205966, 'f1': 0.8195398, 'auroc': 0.88815576, 'binary_precision': 0.90981966, 'binary_recall': 0.709375, 'binary_specificity': 0.9318182, 'binary_f1_score': 0.7971905}
confusion matrix:
     0    1
0  615   45
1  186  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8799127, 'precision': 0.8889995, 'recall': 0.8799126, 'specificity': 0.8799126, 'f1': 0.87920725, 'auroc': 0.95347154, 'binary_precision': 0.9484536, 'binary_recall': 0.80349344, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.86997634}
confusion matrix:
     0    1
0  219   10
1   45  184
better model found
persisted
after epoch: 10,now: 2024-07-29 06:26:40.687609,epoch time: 0:01:35.341164,used: 0:15:24.091264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.983569, 'recall': 0.98361313, 'specificity': 0.98361313, 'f1': 0.9833984, 'auroc': 0.9993535, 'binary_precision': 0.9973632, 'binary_recall': 0.9698718, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9834254}
confusion matrix:
      0     1
0  1508     4
1    47  1513
---- Validation: 
scalar performance:
{'acc': 0.7430769, 'precision': 0.80436087, 'recall': 0.7395833, 'specificity': 0.7395833, 'f1': 0.7275864, 'auroc': 0.9070141, 'binary_precision': 0.93714285, 'binary_recall': 0.5125, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.6626262}
confusion matrix:
     0    1
0  638   22
1  312  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77292573, 'precision': 0.8438438, 'recall': 0.77292573, 'specificity': 0.77292573, 'f1': 0.76058066, 'auroc': 0.94054747, 'binary_precision': 1.0, 'binary_recall': 0.5458515, 'binary_specificity': 1.0, 'binary_f1_score': 0.7062147}
confusion matrix:
     0    1
0  229    0
1  104  125
early stop counter: 1
val acc:0.7430769205093384, best validation acc: 0.8223077058792114, corresponding to test acc:                         0.8799126744270325 / 0.8842794895172119
after epoch: 11,now: 2024-07-29 06:28:19.445161,epoch time: 0:01:38.757552,used: 0:17:02.848816,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840548, 'recall': 0.98417276, 'specificity': 0.98417276, 'f1': 0.9840486, 'auroc': 0.99888664, 'binary_precision': 0.99218243, 'binary_recall': 0.97628206, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.98416805}
confusion matrix:
      0     1
0  1500    12
1    37  1523
---- Validation: 
scalar performance:
{'acc': 0.76, 'precision': 0.80586076, 'recall': 0.7569839, 'specificity': 0.7569839, 'f1': 0.7491806, 'auroc': 0.8753172, 'binary_precision': 0.9205128, 'binary_recall': 0.5609375, 'binary_specificity': 0.9530303, 'binary_f1_score': 0.69708735}
confusion matrix:
     0    1
0  629   31
1  281  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8100437, 'precision': 0.85693276, 'recall': 0.8100437, 'specificity': 0.8100437, 'f1': 0.80359334, 'auroc': 0.9381782, 'binary_precision': 0.98630136, 'binary_recall': 0.62882096, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.768}
confusion matrix:
     0    1
0  227    2
1   85  144
early stop counter: 2
val acc:0.7599999904632568, best validation acc: 0.8223077058792114, corresponding to test acc:                         0.8799126744270325 / 0.8842794895172119
after epoch: 12,now: 2024-07-29 06:29:48.542388,epoch time: 0:01:29.097227,used: 0:18:31.946043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9694201, 'recall': 0.9666209, 'specificity': 0.9666209, 'f1': 0.967049, 'auroc': 0.9993988, 'binary_precision': 0.9402535, 'binary_recall': 0.99871796, 'binary_specificity': 0.9345238, 'binary_f1_score': 0.96860427}
confusion matrix:
      0     1
0  1413    99
1     2  1558
---- Validation: 
scalar performance:
{'acc': 0.84384614, 'precision': 0.8438802, 'recall': 0.84372634, 'specificity': 0.84372634, 'f1': 0.8437787, 'auroc': 0.8992685, 'binary_precision': 0.8451817, 'binary_recall': 0.8359375, 'binary_specificity': 0.8515152, 'binary_f1_score': 0.84053415}
confusion matrix:
     0    1
0  562   98
1  105  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8951965, 'precision': 0.8956794, 'recall': 0.8951965, 'specificity': 0.8951965, 'f1': 0.89516455, 'auroc': 0.9502107, 'binary_precision': 0.90950227, 'binary_recall': 0.87772924, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.8933334}
confusion matrix:
     0    1
0  209   20
1   28  201
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-29 06:31:25.461332,epoch time: 0:01:36.918944,used: 0:20:08.864987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98800147, 'recall': 0.98811054, 'specificity': 0.98811054, 'f1': 0.9879554, 'auroc': 0.99966633, 'binary_precision': 0.99803793, 'binary_recall': 0.97820514, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.988022}
confusion matrix:
      0     1
0  1509     3
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.7076923, 'precision': 0.79204714, 'recall': 0.7035038, 'specificity': 0.7035038, 'f1': 0.6822285, 'auroc': 0.9131978, 'binary_precision': 0.94520545, 'binary_recall': 0.43125, 'binary_specificity': 0.9757576, 'binary_f1_score': 0.5922747}
confusion matrix:
     0    1
0  644   16
1  364  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77074236, 'precision': 0.83940524, 'recall': 0.77074236, 'specificity': 0.77074236, 'f1': 0.7585298, 'auroc': 0.9402948, 'binary_precision': 0.99206346, 'binary_recall': 0.5458515, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.7042253}
confusion matrix:
     0    1
0  228    1
1  104  125
early stop counter: 1
val acc:0.7076923251152039, best validation acc: 0.8438461422920227, corresponding to test acc:                         0.8951964974403381 / 0.8951964974403381
after epoch: 14,now: 2024-07-29 06:33:01.195167,epoch time: 0:01:35.733835,used: 0:21:44.598822,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853382, 'recall': 0.9854548, 'specificity': 0.9854548, 'f1': 0.9853504, 'auroc': 0.9991716, 'binary_precision': 0.99220276, 'binary_recall': 0.97884613, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9854792}
confusion matrix:
      0     1
0  1500    12
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.75384617, 'precision': 0.80859303, 'recall': 0.75056815, 'specificity': 0.75056815, 'f1': 0.74076736, 'auroc': 0.90585285, 'binary_precision': 0.9347826, 'binary_recall': 0.5375, 'binary_specificity': 0.96363634, 'binary_f1_score': 0.6825397}
confusion matrix:
     0    1
0  636   24
1  296  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.8826746, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.85089046, 'auroc': 0.9423733, 'binary_precision': 0.9879518, 'binary_recall': 0.7161572, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.8303798}
confusion matrix:
     0    1
0  227    2
1   65  164
early stop counter: 2
val acc:0.7538461685180664, best validation acc: 0.8438461422920227, corresponding to test acc:                         0.8951964974403381 / 0.8951964974403381
after epoch: 15,now: 2024-07-29 06:34:30.906770,epoch time: 0:01:29.711603,used: 0:23:14.310425,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98501366, 'recall': 0.98503256, 'specificity': 0.98503256, 'f1': 0.9850227, 'auroc': 0.99925935, 'binary_precision': 0.98587936, 'binary_recall': 0.9846154, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.985247}
confusion matrix:
      0     1
0  1490    22
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.8030769, 'precision': 0.84091276, 'recall': 0.8004972, 'specificity': 0.8004972, 'f1': 0.7964829, 'auroc': 0.91476977, 'binary_precision': 0.9507042, 'binary_recall': 0.6328125, 'binary_specificity': 0.9681818, 'binary_f1_score': 0.7598499}
confusion matrix:
     0    1
0  639   21
1  235  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275109, 'precision': 0.8645568, 'recall': 0.82751095, 'specificity': 0.82751095, 'f1': 0.8230146, 'auroc': 0.9353559, 'binary_precision': 0.9807692, 'binary_recall': 0.6681223, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7948052}
confusion matrix:
     0    1
0  226    3
1   76  153
early stop counter: 3
val acc:0.8030769228935242, best validation acc: 0.8438461422920227, corresponding to test acc:                         0.8951964974403381 / 0.8951964974403381
after epoch: 16,now: 2024-07-29 06:36:09.597010,epoch time: 0:01:38.690240,used: 0:24:53.000665,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9792253, 'recall': 0.9778744, 'specificity': 0.9778744, 'f1': 0.97816265, 'auroc': 0.999426, 'binary_precision': 0.9605182, 'binary_recall': 0.9980769, 'binary_specificity': 0.95767194, 'binary_f1_score': 0.97893745}
confusion matrix:
      0     1
0  1448    64
1     3  1557
---- Validation: 
scalar performance:
{'acc': 0.8769231, 'precision': 0.87699914, 'recall': 0.8767992, 'specificity': 0.8767992, 'f1': 0.876866, 'auroc': 0.9195904, 'binary_precision': 0.87974685, 'binary_recall': 0.86875, 'binary_specificity': 0.8848485, 'binary_f1_score': 0.8742139}
confusion matrix:
     0    1
0  584   76
1   84  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9104803, 'precision': 0.9171705, 'recall': 0.9104804, 'specificity': 0.9104804, 'f1': 0.91012, 'auroc': 0.95703745, 'binary_precision': 0.97, 'binary_recall': 0.8471616, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.90442896}
confusion matrix:
     0    1
0  223    6
1   35  194
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-29 06:37:40.312628,epoch time: 0:01:30.715618,used: 0:26:23.716283,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.990855, 'recall': 0.9909341, 'specificity': 0.9909341, 'f1': 0.99088407, 'auroc': 0.99962354, 'binary_precision': 0.99419355, 'binary_recall': 0.9878205, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.9909968}
confusion matrix:
      0     1
0  1503     9
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.76076925, 'precision': 0.8146302, 'recall': 0.757552, 'specificity': 0.757552, 'f1': 0.7485119, 'auroc': 0.8935766, 'binary_precision': 0.94101876, 'binary_recall': 0.5484375, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.69299114}
confusion matrix:
     0    1
0  638   22
1  289  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8742783, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.83197594, 'auroc': 0.94134355, 'binary_precision': 0.99358976, 'binary_recall': 0.6768559, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.80519485}
confusion matrix:
     0    1
0  228    1
1   74  155
early stop counter: 1
val acc:0.760769248008728, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 18,now: 2024-07-29 06:39:16.786269,epoch time: 0:01:36.473641,used: 0:28:00.189924,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938006, 'recall': 0.9938289, 'specificity': 0.9938289, 'f1': 0.9938138, 'auroc': 0.99971724, 'binary_precision': 0.9948619, 'binary_recall': 0.9929487, 'binary_specificity': 0.994709, 'binary_f1_score': 0.9939044}
confusion matrix:
      0     1
0  1504     8
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.8123077, 'precision': 0.8383907, 'recall': 0.8101562, 'specificity': 0.8101562, 'f1': 0.80785036, 'auroc': 0.92363405, 'binary_precision': 0.9285714, 'binary_recall': 0.6703125, 'binary_specificity': 0.95, 'binary_f1_score': 0.7785845}
confusion matrix:
     0    1
0  627   33
1  211  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7882096, 'precision': 0.8451315, 'recall': 0.7882096, 'specificity': 0.7882096, 'f1': 0.7791015, 'auroc': 0.94443274, 'binary_precision': 0.9852941, 'binary_recall': 0.58515286, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7342466}
confusion matrix:
     0    1
0  227    2
1   95  134
early stop counter: 2
val acc:0.8123077154159546, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 19,now: 2024-07-29 06:40:53.284731,epoch time: 0:01:36.498462,used: 0:29:36.688386,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941107, 'recall': 0.9942104, 'specificity': 0.9942104, 'f1': 0.9941399, 'auroc': 0.9998715, 'binary_precision': 0.99870634, 'binary_recall': 0.9897436, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.9942048}
confusion matrix:
      0     1
0  1510     2
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.60384613, 'precision': 0.7625974, 'recall': 0.5977746, 'specificity': 0.5977746, 'f1': 0.526646, 'auroc': 0.9054972, 'binary_precision': 0.962963, 'binary_recall': 0.203125, 'binary_specificity': 0.99242425, 'binary_f1_score': 0.33548385}
confusion matrix:
     0    1
0  655    5
1  510  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5633188, 'precision': 0.75084984, 'recall': 0.5633188, 'specificity': 0.5633188, 'f1': 0.46294558, 'auroc': 0.95646536, 'binary_precision': 0.9677419, 'binary_recall': 0.13100436, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.23076922}
confusion matrix:
     0   1
0  228   1
1  199  30
early stop counter: 3
val acc:0.6038461327552795, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 20,now: 2024-07-29 06:42:29.939994,epoch time: 0:01:36.655263,used: 0:31:13.343649,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99193937, 'recall': 0.991804, 'specificity': 0.991804, 'f1': 0.99185896, 'auroc': 0.99981517, 'binary_precision': 0.9885423, 'binary_recall': 0.99551284, 'binary_specificity': 0.9880952, 'binary_f1_score': 0.99201536}
confusion matrix:
      0     1
0  1494    18
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.84692305, 'precision': 0.8613545, 'recall': 0.8453835, 'specificity': 0.8453835, 'f1': 0.8449404, 'auroc': 0.91801846, 'binary_precision': 0.9298246, 'binary_recall': 0.7453125, 'binary_specificity': 0.94545454, 'binary_f1_score': 0.8274068}
confusion matrix:
     0    1
0  624   36
1  163  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8829586, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8605784, 'auroc': 0.9548254, 'binary_precision': 0.97159094, 'binary_recall': 0.7467249, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  224    5
1   58  171
early stop counter: 4
val acc:0.8469230532646179, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 21,now: 2024-07-29 06:44:07.559584,epoch time: 0:01:37.619590,used: 0:32:50.963239,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98925054, 'recall': 0.98926026, 'specificity': 0.98926026, 'f1': 0.98925525, 'auroc': 0.9995697, 'binary_precision': 0.98973703, 'binary_recall': 0.98910254, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.98941964}
confusion matrix:
      0     1
0  1496    16
1    17  1543
---- Validation: 
scalar performance:
{'acc': 0.7430769, 'precision': 0.80543685, 'recall': 0.73955965, 'specificity': 0.73955965, 'f1': 0.72737366, 'auroc': 0.9106078, 'binary_precision': 0.9396552, 'binary_recall': 0.5109375, 'binary_specificity': 0.9681818, 'binary_f1_score': 0.6619433}
confusion matrix:
     0    1
0  639   21
1  313  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75545853, 'precision': 0.8320815, 'recall': 0.7554585, 'specificity': 0.7554585, 'f1': 0.7404889, 'auroc': 0.940066, 'binary_precision': 0.99159664, 'binary_recall': 0.5152838, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.6781609}
confusion matrix:
     0    1
0  228    1
1  111  118
early stop counter: 5
val acc:0.7430769205093384, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 22,now: 2024-07-29 06:45:39.429995,epoch time: 0:01:31.870411,used: 0:34:22.833650,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883192, 'recall': 0.988431, 'specificity': 0.988431, 'f1': 0.98828083, 'auroc': 0.9995527, 'binary_precision': 0.9980392, 'binary_recall': 0.97884613, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9883495}
confusion matrix:
      0     1
0  1509     3
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.7846154, 'precision': 0.82879907, 'recall': 0.7817708, 'specificity': 0.7817708, 'f1': 0.77592605, 'auroc': 0.90499234, 'binary_precision': 0.94554454, 'binary_recall': 0.596875, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.73180073}
confusion matrix:
     0    1
0  638   22
1  258  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81877726, 'precision': 0.86436355, 'recall': 0.8187773, 'specificity': 0.8187773, 'f1': 0.81292605, 'auroc': 0.9338685, 'binary_precision': 0.9932432, 'binary_recall': 0.6419214, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.7798409}
confusion matrix:
     0    1
0  228    1
1   82  147
early stop counter: 6
val acc:0.7846153974533081, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 23,now: 2024-07-29 06:47:09.099814,epoch time: 0:01:29.669819,used: 0:35:52.503469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98673457, 'recall': 0.98682845, 'specificity': 0.98682845, 'f1': 0.98665345, 'auroc': 0.99954975, 'binary_precision': 0.9980328, 'binary_recall': 0.975641, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9867099}
confusion matrix:
      0     1
0  1509     3
1    38  1522
---- Validation: 
scalar performance:
{'acc': 0.78615385, 'precision': 0.8247838, 'recall': 0.7834754, 'specificity': 0.7834754, 'f1': 0.7784773, 'auroc': 0.9105587, 'binary_precision': 0.93301433, 'binary_recall': 0.609375, 'binary_specificity': 0.95757574, 'binary_f1_score': 0.73724}
confusion matrix:
     0    1
0  632   28
1  250  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.8788603, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.8512432, 'auroc': 0.94626343, 'binary_precision': 0.9764706, 'binary_recall': 0.7248908, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.83208025}
confusion matrix:
     0    1
0  225    4
1   63  166
early stop counter: 7
val acc:0.7861538529396057, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 24,now: 2024-07-29 06:48:45.632338,epoch time: 0:01:36.532524,used: 0:37:29.035993,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99164414, 'recall': 0.9914632, 'specificity': 0.9914632, 'f1': 0.99153304, 'auroc': 0.9997787, 'binary_precision': 0.98729354, 'binary_recall': 0.99615383, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9917039}
confusion matrix:
      0     1
0  1492    20
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.83692306, 'precision': 0.854, 'recall': 0.83522725, 'specificity': 0.83522725, 'f1': 0.83441484, 'auroc': 0.9089134, 'binary_precision': 0.928, 'binary_recall': 0.725, 'binary_specificity': 0.94545454, 'binary_f1_score': 0.8140351}
confusion matrix:
     0    1
0  624   36
1  176  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.86757624, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.8474535, 'auroc': 0.9356419, 'binary_precision': 0.9494382, 'binary_recall': 0.7379913, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.83046687}
confusion matrix:
     0    1
0  220    9
1   60  169
early stop counter: 8
val acc:0.8369230628013611, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 25,now: 2024-07-29 06:50:21.807463,epoch time: 0:01:36.175125,used: 0:39:05.211118,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98888636, 'recall': 0.9884666, 'specificity': 0.9884666, 'f1': 0.9886, 'auroc': 0.9997592, 'binary_precision': 0.9804663, 'binary_recall': 0.99743587, 'binary_specificity': 0.9794974, 'binary_f1_score': 0.98887825}
confusion matrix:
      0     1
0  1481    31
1     4  1556
---- Validation: 
scalar performance:
{'acc': 0.84, 'precision': 0.8521408, 'recall': 0.83856535, 'specificity': 0.83856535, 'f1': 0.8381765, 'auroc': 0.915235, 'binary_precision': 0.9137931, 'binary_recall': 0.7453125, 'binary_specificity': 0.9318182, 'binary_f1_score': 0.8209983}
confusion matrix:
     0    1
0  615   45
1  163  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515284, 'precision': 0.8722261, 'recall': 0.8515284, 'specificity': 0.8515284, 'f1': 0.8494353, 'auroc': 0.93230486, 'binary_precision': 0.96, 'binary_recall': 0.73362446, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.83168316}
confusion matrix:
     0    1
0  222    7
1   61  168
early stop counter: 9
val acc:0.8399999737739563, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 26,now: 2024-07-29 06:51:58.395376,epoch time: 0:01:36.587913,used: 0:40:41.799031,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896331, 'recall': 0.9895401, 'specificity': 0.9895401, 'f1': 0.9895799, 'auroc': 0.9992174, 'binary_precision': 0.9872449, 'binary_recall': 0.99230766, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9897698}
confusion matrix:
      0     1
0  1492    20
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.79615384, 'precision': 0.8350277, 'recall': 0.79351324, 'specificity': 0.79351324, 'f1': 0.7890229, 'auroc': 0.9179616, 'binary_precision': 0.9453682, 'binary_recall': 0.621875, 'binary_specificity': 0.9651515, 'binary_f1_score': 0.7502356}
confusion matrix:
     0    1
0  637   23
1  242  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80786026, 'precision': 0.85572326, 'recall': 0.80786026, 'specificity': 0.80786026, 'f1': 0.80117214, 'auroc': 0.9454243, 'binary_precision': 0.9862069, 'binary_recall': 0.62445414, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7647059}
confusion matrix:
     0    1
0  227    2
1   86  143
early stop counter: 10
val acc:0.7961538434028625, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 27,now: 2024-07-29 06:53:35.917094,epoch time: 0:01:37.521718,used: 0:42:19.320749,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.990855, 'recall': 0.9909341, 'specificity': 0.9909341, 'f1': 0.99088407, 'auroc': 0.9997121, 'binary_precision': 0.99419355, 'binary_recall': 0.9878205, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.9909968}
confusion matrix:
      0     1
0  1503     9
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.8515385, 'precision': 0.8614929, 'recall': 0.8502604, 'specificity': 0.8502604, 'f1': 0.8501531, 'auroc': 0.9258144, 'binary_precision': 0.91775703, 'binary_recall': 0.7671875, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8357447}
confusion matrix:
     0    1
0  616   44
1  149  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.89205265, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.871835, 'auroc': 0.9463206, 'binary_precision': 0.9776536, 'binary_recall': 0.76419216, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.85784316}
confusion matrix:
     0    1
0  225    4
1   54  175
early stop counter: 11
val acc:0.8515384793281555, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 28,now: 2024-07-29 06:55:14.029172,epoch time: 0:01:38.112078,used: 0:43:57.432827,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98957396, 'recall': 0.9896927, 'specificity': 0.9896927, 'f1': 0.98958254, 'auroc': 0.999607, 'binary_precision': 0.99674904, 'binary_recall': 0.9826923, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.98967075}
confusion matrix:
      0     1
0  1507     5
1    27  1533
---- Validation: 
scalar performance:
{'acc': 0.80538464, 'precision': 0.84156656, 'recall': 0.80286455, 'specificity': 0.80286455, 'f1': 0.79915226, 'auroc': 0.90612924, 'binary_precision': 0.9489559, 'binary_recall': 0.6390625, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.7637722}
confusion matrix:
     0    1
0  638   22
1  231  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79257643, 'precision': 0.8368238, 'recall': 0.79257643, 'specificity': 0.79257643, 'f1': 0.78553295, 'auroc': 0.93128943, 'binary_precision': 0.9589041, 'binary_recall': 0.6113537, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.74666667}
confusion matrix:
     0    1
0  223    6
1   89  140
early stop counter: 12
val acc:0.805384635925293, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 29,now: 2024-07-29 06:56:44.813111,epoch time: 0:01:30.783939,used: 0:45:28.216766,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9806103, 'recall': 0.9804487, 'specificity': 0.9804487, 'f1': 0.9801429, 'auroc': 0.9998542, 'binary_precision': 1.0, 'binary_recall': 0.96089745, 'binary_specificity': 1.0, 'binary_f1_score': 0.98005885}
confusion matrix:
      0     1
0  1512     0
1    61  1499
---- Validation: 
scalar performance:
{'acc': 0.6653846, 'precision': 0.7801033, 'recall': 0.660393, 'specificity': 0.660393, 'f1': 0.6231947, 'auroc': 0.89581263, 'binary_precision': 0.95555556, 'binary_recall': 0.3359375, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.49710983}
confusion matrix:
     0    1
0  650   10
1  425  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55458516, 'precision': 0.7644342, 'recall': 0.55458516, 'specificity': 0.55458516, 'f1': 0.44434667, 'auroc': 0.9343643, 'binary_precision': 1.0, 'binary_recall': 0.1091703, 'binary_specificity': 1.0, 'binary_f1_score': 0.19685039}
confusion matrix:
     0   1
0  229   0
1  204  25
early stop counter: 13
val acc:0.6653845906257629, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.9104803204536438 / 0.9104803204536438
after epoch: 30,now: 2024-07-29 06:58:13.514133,epoch time: 0:01:28.701022,used: 0:46:56.917788,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_11_16_seed_7_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:46:56.917788 at 2024-07-29 06:58:13.514133
persisted model performance metric: 

scalar performance:
{'acc': 0.9104803, 'precision': 0.9171705, 'recall': 0.9104804, 'specificity': 0.9104804, 'f1': 0.91012, 'auroc': 0.95703745, 'binary_precision': 0.97, 'binary_recall': 0.8471616, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.90442896}
confusion matrix:
     0    1
0  223    6
1   35  194
oracle model performance metric: 

scalar performance:
{'acc': 0.9104803, 'precision': 0.9171705, 'recall': 0.9104804, 'specificity': 0.9104804, 'f1': 0.91012, 'auroc': 0.95703745, 'binary_precision': 0.97, 'binary_recall': 0.8471616, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.90442896}
confusion matrix:
     0    1
0  223    6
1   35  194
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455470 KiB |  13221 MiB | 588952 GiB | 588951 GiB |
|       from large pool | 414872 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455470 KiB |  13221 MiB | 588952 GiB | 588951 GiB |
|       from large pool | 414872 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 587086 GiB | 587085 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 580139 GiB | 580139 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14488 MiB | 109540 MiB |  95070 MiB |
|       from large pool |  14404 MiB |  14422 MiB | 109358 MiB |  94954 MiB |
|       from small pool |     66 MiB |     70 MiB |    182 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 496849 KiB |   1260 MiB | 419646 GiB | 419645 GiB |
|       from large pool | 484200 KiB |   1252 MiB | 412641 GiB | 412641 GiB |
|       from small pool |  12649 KiB |     47 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103451 K  |  103449 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50911 K  |   50910 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103451 K  |  103449 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50911 K  |   50910 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4640    |    4005    |
|       from large pool |     602    |     603    |    4549    |    3947    |
|       from small pool |      33    |      35    |      91    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      95    |     653    |   69302 K  |   69301 K  |
|       from large pool |      39    |     605    |   39618 K  |   39618 K  |
|       from small pool |      56    |     236    |   29683 K  |   29683 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 588952 GiB | 588952 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 588952 GiB | 588952 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587086 GiB | 587086 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580139 GiB | 580139 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14488 MiB | 109540 MiB | 108610 MiB |
|       from large pool |    878 MiB |  14422 MiB | 109358 MiB | 108480 MiB |
|       from small pool |     52 MiB |     70 MiB |    182 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 419646 GiB | 419646 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 412641 GiB | 412641 GiB |
|       from small pool |      0 KiB |     47 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103451 K  |  103451 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50911 K  |   50911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103451 K  |  103451 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50911 K  |   50911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    4640    |    4574    |
|       from large pool |      40    |     603    |    4549    |    4509    |
|       from small pool |      26    |      35    |      91    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   69302 K  |   69302 K  |
|       from large pool |       3    |     605    |   39618 K  |   39618 K  |
|       from small pool |       0    |     236    |   29683 K  |   29683 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 588952 GiB | 588952 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 588952 GiB | 588952 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587086 GiB | 587086 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580139 GiB | 580139 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14488 MiB | 109540 MiB | 108610 MiB |
|       from large pool |    878 MiB |  14422 MiB | 109358 MiB | 108480 MiB |
|       from small pool |     52 MiB |     70 MiB |    182 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 419646 GiB | 419646 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 412641 GiB | 412641 GiB |
|       from small pool |      0 KiB |     47 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103451 K  |  103451 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50911 K  |   50911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103451 K  |  103451 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50911 K  |   50911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    4640    |    4574    |
|       from large pool |      40    |     603    |    4549    |    4509    |
|       from small pool |      26    |      35    |      91    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   69302 K  |   69302 K  |
|       from large pool |       3    |     605    |   39618 K  |   39618 K  |
|       from small pool |       0    |     236    |   29683 K  |   29683 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368

 Experiment start at: 2024-07-29 06:58:55.944227
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92532897, 'precision': 0.9324558, 'recall': 0.9261093, 'specificity': 0.9261093, 'f1': 0.9251029, 'auroc': 0.99220586, 'binary_precision': 0.99101126, 'binary_recall': 0.86020803, 'binary_specificity': 0.99201065, 'binary_f1_score': 0.9209885}
confusion matrix:
      0     1
0  1490    12
1   215  1323
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.79350346, 'precision': 0.8183721, 'recall': 0.78895056, 'specificity': 0.78895056, 'f1': 0.7874619, 'auroc': 0.9003262, 'binary_precision': 0.8997773, 'binary_recall': 0.6453674, 'binary_specificity': 0.93253374, 'binary_f1_score': 0.7516279}
confusion matrix:
     0    1
0  622   45
1  222  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8233945, 'precision': 0.8471259, 'recall': 0.82339454, 'specificity': 0.82339454, 'f1': 0.8203236, 'auroc': 0.9064052, 'binary_precision': 0.9378882, 'binary_recall': 0.69266057, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.7968338}
confusion matrix:
     0    1
0  208   10
1   67  151
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:00:38.344802,epoch time: 0:01:42.400575,used: 0:01:42.400575,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95625, 'precision': 0.95843184, 'recall': 0.9566603, 'specificity': 0.9566603, 'f1': 0.95622045, 'auroc': 0.99618244, 'binary_precision': 0.9929775, 'binary_recall': 0.91997397, 'binary_specificity': 0.99334663, 'binary_f1_score': 0.9550828}
confusion matrix:
      0     1
0  1493    10
1   123  1414
---- Validation: 
scalar performance:
{'acc': 0.8112916, 'precision': 0.83059764, 'recall': 0.8073703, 'specificity': 0.8073703, 'f1': 0.80699134, 'auroc': 0.9034517, 'binary_precision': 0.90295357, 'binary_recall': 0.68370605, 'binary_specificity': 0.9310345, 'binary_f1_score': 0.7781818}
confusion matrix:
     0    1
0  621   46
1  198  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486239, 'precision': 0.85101694, 'recall': 0.8486239, 'specificity': 0.8486239, 'f1': 0.84836537, 'auroc': 0.9107188, 'binary_precision': 0.88, 'binary_recall': 0.80733943, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  194   24
1   42  176
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 07:02:13.859716,epoch time: 0:01:35.514914,used: 0:03:17.915489,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9611842, 'precision': 0.9627248, 'recall': 0.9615326, 'specificity': 0.9615326, 'f1': 0.96116805, 'auroc': 0.9948405, 'binary_precision': 0.99236643, 'binary_recall': 0.93038386, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.96037614}
confusion matrix:
      0     1
0  1492    11
1   107  1430
---- Validation: 
scalar performance:
{'acc': 0.7215777, 'precision': 0.7901797, 'recall': 0.71363837, 'specificity': 0.71363837, 'f1': 0.6991546, 'auroc': 0.8935269, 'binary_precision': 0.9235669, 'binary_recall': 0.46325877, 'binary_specificity': 0.964018, 'binary_f1_score': 0.61702126}
confusion matrix:
     0    1
0  643   24
1  336  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85779816, 'precision': 0.8614796, 'recall': 0.85779816, 'specificity': 0.85779816, 'f1': 0.85743517, 'auroc': 0.9190935, 'binary_precision': 0.8979592, 'binary_recall': 0.80733943, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.8502415}
confusion matrix:
     0    1
0  198   20
1   42  176
new oracle model saved
early stop counter: 1
val acc:0.7215777039527893, best validation acc: 0.8112915754318237, corresponding to test acc:                         0.8486238718032837 / 0.857798159122467
after epoch: 3,now: 2024-07-29 07:03:45.053192,epoch time: 0:01:31.193476,used: 0:04:49.108965,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.97722363, 'recall': 0.9771327, 'specificity': 0.9771327, 'f1': 0.9769735, 'auroc': 0.9977677, 'binary_precision': 0.9912927, 'binary_recall': 0.96291476, 'binary_specificity': 0.99135065, 'binary_f1_score': 0.9768978}
confusion matrix:
      0     1
0  1490    13
1    57  1480
---- Validation: 
scalar performance:
{'acc': 0.74555296, 'precision': 0.7851276, 'recall': 0.73942983, 'specificity': 0.73942983, 'f1': 0.73303384, 'auroc': 0.8840835, 'binary_precision': 0.88372093, 'binary_recall': 0.54632586, 'binary_specificity': 0.93253374, 'binary_f1_score': 0.6752221}
confusion matrix:
     0    1
0  622   45
1  284  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85779816, 'precision': 0.8580694, 'recall': 0.85779816, 'specificity': 0.85779816, 'f1': 0.8577712, 'auroc': 0.926332, 'binary_precision': 0.8679245, 'binary_recall': 0.8440367, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.8558139}
confusion matrix:
     0    1
0  190   28
1   34  184
early stop counter: 2
val acc:0.7455529570579529, best validation acc: 0.8112915754318237, corresponding to test acc:                         0.8486238718032837 / 0.857798159122467
after epoch: 4,now: 2024-07-29 07:05:20.468318,epoch time: 0:01:35.415126,used: 0:06:24.524091,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.9849454, 'recall': 0.9849832, 'specificity': 0.9849832, 'f1': 0.98486835, 'auroc': 0.9990797, 'binary_precision': 0.99469495, 'binary_recall': 0.97529256, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.9848982}
confusion matrix:
      0     1
0  1494     8
1    38  1500
---- Validation: 
scalar performance:
{'acc': 0.8089714, 'precision': 0.8248315, 'recall': 0.8053669, 'specificity': 0.8053669, 'f1': 0.80519617, 'auroc': 0.90399766, 'binary_precision': 0.88911706, 'binary_recall': 0.6916933, 'binary_specificity': 0.9190405, 'binary_f1_score': 0.7780773}
confusion matrix:
     0    1
0  613   54
1  193  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.8377099, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.8267338, 'auroc': 0.897315, 'binary_precision': 0.89502764, 'binary_recall': 0.74311924, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.8120301}
confusion matrix:
     0    1
0  199   19
1   56  162
early stop counter: 3
val acc:0.8089714050292969, best validation acc: 0.8112915754318237, corresponding to test acc:                         0.8486238718032837 / 0.857798159122467
after epoch: 5,now: 2024-07-29 07:06:47.773032,epoch time: 0:01:27.304714,used: 0:07:51.828805,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.98624015, 'recall': 0.98614335, 'specificity': 0.98614335, 'f1': 0.986181, 'auroc': 0.9988866, 'binary_precision': 0.9832041, 'binary_recall': 0.9895969, 'binary_specificity': 0.98268974, 'binary_f1_score': 0.9863902}
confusion matrix:
      0     1
0  1476    26
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.8491879, 'precision': 0.8493708, 'recall': 0.8486679, 'specificity': 0.8486679, 'f1': 0.8489045, 'auroc': 0.90901995, 'binary_precision': 0.8527005, 'binary_recall': 0.83226836, 'binary_specificity': 0.8650675, 'binary_f1_score': 0.8423605}
confusion matrix:
     0    1
0  577   90
1  105  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165138, 'precision': 0.81977046, 'recall': 0.8165138, 'specificity': 0.8165138, 'f1': 0.8160454, 'auroc': 0.8900976, 'binary_precision': 0.7875, 'binary_recall': 0.8669725, 'binary_specificity': 0.76605505, 'binary_f1_score': 0.8253275}
confusion matrix:
     0    1
0  167   51
1   29  189
better model found
persisted
after epoch: 6,now: 2024-07-29 07:08:19.485815,epoch time: 0:01:31.712783,used: 0:09:23.541588,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98157895, 'precision': 0.9816289, 'recall': 0.9816723, 'specificity': 0.9816723, 'f1': 0.9815788, 'auroc': 0.9987031, 'binary_precision': 0.9900728, 'binary_recall': 0.97332466, 'binary_specificity': 0.99002, 'binary_f1_score': 0.9816273}
confusion matrix:
      0     1
0  1488    15
1    41  1496
---- Validation: 
scalar performance:
{'acc': 0.82985306, 'precision': 0.83975893, 'recall': 0.82707965, 'specificity': 0.82707965, 'f1': 0.82762504, 'auroc': 0.9135057, 'binary_precision': 0.8903846, 'binary_recall': 0.73961663, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.8080279}
confusion matrix:
     0    1
0  610   57
1  163  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8233945, 'precision': 0.84211874, 'recall': 0.82339454, 'specificity': 0.82339454, 'f1': 0.82094455, 'auroc': 0.91648424, 'binary_precision': 0.9221557, 'binary_recall': 0.70642203, 'binary_specificity': 0.940367, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  205   13
1   64  154
early stop counter: 1
val acc:0.8298530578613281, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 7,now: 2024-07-29 07:09:54.442456,epoch time: 0:01:34.956641,used: 0:10:58.498229,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.9868343, 'recall': 0.9868478, 'specificity': 0.9868478, 'f1': 0.9868406, 'auroc': 0.9994472, 'binary_precision': 0.98762214, 'binary_recall': 0.986337, 'binary_specificity': 0.9873586, 'binary_f1_score': 0.9869791}
confusion matrix:
      0     1
0  1484    19
1    21  1516
---- Validation: 
scalar performance:
{'acc': 0.81515855, 'precision': 0.84639585, 'recall': 0.8103329, 'specificity': 0.8103329, 'f1': 0.80911875, 'auroc': 0.9213133, 'binary_precision': 0.94279176, 'binary_recall': 0.658147, 'binary_specificity': 0.96251875, 'binary_f1_score': 0.7751646}
confusion matrix:
     0    1
0  642   25
1  214  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.87146544, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.83591396, 'auroc': 0.92622674, 'binary_precision': 0.9805195, 'binary_recall': 0.69266057, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.8118279}
confusion matrix:
     0    1
0  215    3
1   67  151
early stop counter: 2
val acc:0.8151585459709167, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 8,now: 2024-07-29 07:11:28.354999,epoch time: 0:01:33.912543,used: 0:12:32.410772,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.98436904, 'recall': 0.98412585, 'specificity': 0.98412585, 'f1': 0.98420477, 'auroc': 0.99925244, 'binary_precision': 0.97819114, 'binary_recall': 0.9909032, 'binary_specificity': 0.97734845, 'binary_f1_score': 0.98450613}
confusion matrix:
      0     1
0  1467    34
1    14  1525
---- Validation: 
scalar performance:
{'acc': 0.84609437, 'precision': 0.85142064, 'recall': 0.8440983, 'specificity': 0.8440983, 'f1': 0.84484553, 'auroc': 0.9072596, 'binary_precision': 0.88747734, 'binary_recall': 0.78115016, 'binary_specificity': 0.9070465, 'binary_f1_score': 0.83092606}
confusion matrix:
     0    1
0  605   62
1  137  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486239, 'precision': 0.86342895, 'recall': 0.8486239, 'specificity': 0.8486239, 'f1': 0.8470663, 'auroc': 0.9179362, 'binary_precision': 0.9367816, 'binary_recall': 0.7477064, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.8316326}
confusion matrix:
     0    1
0  207   11
1   55  163
early stop counter: 3
val acc:0.8460943698883057, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 9,now: 2024-07-29 07:13:00.431281,epoch time: 0:01:32.076282,used: 0:14:04.487054,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97763157, 'precision': 0.9782357, 'recall': 0.97789127, 'specificity': 0.97789127, 'f1': 0.9776299, 'auroc': 0.9993355, 'binary_precision': 0.99864405, 'binary_recall': 0.957115, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.9774386}
confusion matrix:
      0     1
0  1499     2
1    66  1473
---- Validation: 
scalar performance:
{'acc': 0.5939675, 'precision': 0.749701, 'recall': 0.5810146, 'specificity': 0.5810146, 'f1': 0.50347257, 'auroc': 0.90682375, 'binary_precision': 0.9391304, 'binary_recall': 0.17252396, 'binary_specificity': 0.98950523, 'binary_f1_score': 0.29149798}
confusion matrix:
     0    1
0  660    7
1  518  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6995413, 'precision': 0.81232095, 'recall': 0.6995413, 'specificity': 0.6995413, 'f1': 0.6697256, 'auroc': 0.91726816, 'binary_precision': 1.0, 'binary_recall': 0.39908257, 'binary_specificity': 1.0, 'binary_f1_score': 0.5704918}
confusion matrix:
     0   1
0  218   0
1  131  87
early stop counter: 4
val acc:0.5939674973487854, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 10,now: 2024-07-29 07:14:39.204953,epoch time: 0:01:38.773672,used: 0:15:43.260726,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.9869533, 'recall': 0.9867779, 'specificity': 0.9867779, 'f1': 0.9868383, 'auroc': 0.99951816, 'binary_precision': 0.981982, 'binary_recall': 0.99219763, 'binary_specificity': 0.9813582, 'binary_f1_score': 0.9870634}
confusion matrix:
      0     1
0  1474    28
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.8306264, 'precision': 0.8411384, 'recall': 0.8277802, 'specificity': 0.8277802, 'f1': 0.82831585, 'auroc': 0.89554346, 'binary_precision': 0.89361703, 'binary_recall': 0.73801917, 'binary_specificity': 0.9175412, 'binary_f1_score': 0.80839896}
confusion matrix:
     0    1
0  612   55
1  164  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8502648, 'recall': 0.8325688, 'specificity': 0.8325688, 'f1': 0.83042705, 'auroc': 0.91719973, 'binary_precision': 0.92899406, 'binary_recall': 0.7201835, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.8113695}
confusion matrix:
     0    1
0  206   12
1   61  157
early stop counter: 5
val acc:0.8306264281272888, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 11,now: 2024-07-29 07:16:19.965253,epoch time: 0:01:40.760300,used: 0:17:24.021026,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.9800817, 'recall': 0.97984064, 'specificity': 0.97984064, 'f1': 0.97960436, 'auroc': 0.9992416, 'binary_precision': 0.99864954, 'binary_recall': 0.9610137, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.9794702}
confusion matrix:
      0     1
0  1499     2
1    60  1479
---- Validation: 
scalar performance:
{'acc': 0.79969066, 'precision': 0.83192503, 'recall': 0.79465294, 'specificity': 0.79465294, 'f1': 0.79266596, 'auroc': 0.9102659, 'binary_precision': 0.9277389, 'binary_recall': 0.6357827, 'binary_specificity': 0.9535232, 'binary_f1_score': 0.75450236}
confusion matrix:
     0    1
0  636   31
1  228  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.8244048, 'recall': 0.79816514, 'specificity': 0.79816514, 'f1': 0.79399955, 'auroc': 0.8869834, 'binary_precision': 0.9166667, 'binary_recall': 0.6559633, 'binary_specificity': 0.940367, 'binary_f1_score': 0.7647059}
confusion matrix:
     0    1
0  205   13
1   75  143
early stop counter: 6
val acc:0.7996906638145447, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 12,now: 2024-07-29 07:18:04.791180,epoch time: 0:01:44.825927,used: 0:19:08.846953,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.98633766, 'recall': 0.9863074, 'specificity': 0.9863074, 'f1': 0.9861842, 'auroc': 0.99973893, 'binary_precision': 0.998, 'binary_recall': 0.9746094, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.986166}
confusion matrix:
      0     1
0  1501     3
1    39  1497
---- Validation: 
scalar performance:
{'acc': 0.83139986, 'precision': 0.83991385, 'recall': 0.8288244, 'specificity': 0.8288244, 'f1': 0.8294286, 'auroc': 0.9072572, 'binary_precision': 0.8863636, 'binary_recall': 0.74760383, 'binary_specificity': 0.91004497, 'binary_f1_score': 0.8110919}
confusion matrix:
     0    1
0  607   60
1  158  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79587156, 'precision': 0.7986428, 'recall': 0.79587156, 'specificity': 0.79587156, 'f1': 0.79539686, 'auroc': 0.8702761, 'binary_precision': 0.8274112, 'binary_recall': 0.7477064, 'binary_specificity': 0.8440367, 'binary_f1_score': 0.78554213}
confusion matrix:
     0    1
0  184   34
1   55  163
early stop counter: 7
val acc:0.8313998579978943, best validation acc: 0.8491879105567932, corresponding to test acc:                         0.8165137767791748 / 0.857798159122467
after epoch: 13,now: 2024-07-29 07:19:43.641894,epoch time: 0:01:38.850714,used: 0:20:47.697667,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891259, 'recall': 0.98917186, 'specificity': 0.98917186, 'f1': 0.9891436, 'auroc': 0.99956447, 'binary_precision': 0.9915144, 'binary_recall': 0.9870046, 'binary_specificity': 0.9913391, 'binary_f1_score': 0.98925436}
confusion matrix:
      0     1
0  1488    13
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.85305494, 'precision': 0.8548385, 'recall': 0.851876, 'specificity': 0.851876, 'f1': 0.8524469, 'auroc': 0.908687, 'binary_precision': 0.8732877, 'binary_recall': 0.8146965, 'binary_specificity': 0.8890555, 'binary_f1_score': 0.8429752}
confusion matrix:
     0    1
0  593   74
1  116  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809633, 'precision': 0.8104234, 'recall': 0.809633, 'specificity': 0.809633, 'f1': 0.8095118, 'auroc': 0.9000505, 'binary_precision': 0.82608694, 'binary_recall': 0.7844037, 'binary_specificity': 0.8348624, 'binary_f1_score': 0.8047059}
confusion matrix:
     0    1
0  182   36
1   47  171
better model found
persisted
after epoch: 14,now: 2024-07-29 07:21:22.062982,epoch time: 0:01:38.421088,used: 0:22:26.118755,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.97959304, 'recall': 0.97965693, 'specificity': 0.97965693, 'f1': 0.97960424, 'auroc': 0.9980105, 'binary_precision': 0.984252, 'binary_recall': 0.97529256, 'binary_specificity': 0.9840213, 'binary_f1_score': 0.97975177}
confusion matrix:
      0     1
0  1478    24
1    38  1500
---- Validation: 
scalar performance:
{'acc': 0.8491879, 'precision': 0.84980476, 'recall': 0.8484224, 'specificity': 0.8484224, 'f1': 0.848794, 'auroc': 0.9104138, 'binary_precision': 0.858569, 'binary_recall': 0.82428116, 'binary_specificity': 0.8725637, 'binary_f1_score': 0.84107584}
confusion matrix:
     0    1
0  582   85
1  110  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8296839, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.8251583, 'auroc': 0.89819884, 'binary_precision': 0.8659794, 'binary_recall': 0.7706422, 'binary_specificity': 0.88073397, 'binary_f1_score': 0.81553394}
confusion matrix:
     0    1
0  192   26
1   50  168
early stop counter: 1
val acc:0.8491879105567932, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 15,now: 2024-07-29 07:22:59.637878,epoch time: 0:01:37.574896,used: 0:24:03.693651,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.99277025, 'recall': 0.9927549, 'specificity': 0.9927549, 'f1': 0.9927621, 'auroc': 0.9997455, 'binary_precision': 0.99220276, 'binary_recall': 0.9934938, 'binary_specificity': 0.99201596, 'binary_f1_score': 0.99284786}
confusion matrix:
      0     1
0  1491    12
1    10  1527
---- Validation: 
scalar performance:
{'acc': 0.8383604, 'precision': 0.83977926, 'recall': 0.83724034, 'specificity': 0.83724034, 'f1': 0.8377393, 'auroc': 0.90279067, 'binary_precision': 0.85519594, 'binary_recall': 0.80191696, 'binary_specificity': 0.8725637, 'binary_f1_score': 0.8277}
confusion matrix:
     0    1
0  582   85
1  124  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.81716335, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.8137882, 'auroc': 0.8921387, 'binary_precision': 0.84771574, 'binary_recall': 0.76605505, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.8048193}
confusion matrix:
     0    1
0  188   30
1   51  167
early stop counter: 2
val acc:0.8383604288101196, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 16,now: 2024-07-29 07:24:38.343503,epoch time: 0:01:38.705625,used: 0:25:42.399276,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9920922, 'recall': 0.9921484, 'specificity': 0.9921484, 'f1': 0.9921048, 'auroc': 0.99979866, 'binary_precision': 0.99606556, 'binary_recall': 0.9882889, 'binary_specificity': 0.996008, 'binary_f1_score': 0.9921619}
confusion matrix:
      0     1
0  1497     6
1    18  1519
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.8598777, 'recall': 0.8455616, 'specificity': 0.8455616, 'f1': 0.8463186, 'auroc': 0.91084015, 'binary_precision': 0.9166667, 'binary_recall': 0.75559103, 'binary_specificity': 0.9355322, 'binary_f1_score': 0.8283713}
confusion matrix:
     0    1
0  624   43
1  153  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8233945, 'precision': 0.8508664, 'recall': 0.8233945, 'specificity': 0.8233945, 'f1': 0.8198685, 'auroc': 0.9182308, 'binary_precision': 0.9490446, 'binary_recall': 0.6834862, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.79466665}
confusion matrix:
     0    1
0  210    8
1   69  149
early stop counter: 3
val acc:0.8484145402908325, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 17,now: 2024-07-29 07:26:16.809939,epoch time: 0:01:38.466436,used: 0:27:20.865712,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.9874283, 'recall': 0.98705804, 'specificity': 0.98705804, 'f1': 0.9871652, 'auroc': 0.9996519, 'binary_precision': 0.9789272, 'binary_recall': 0.9961014, 'binary_specificity': 0.97801465, 'binary_f1_score': 0.98743963}
confusion matrix:
      0     1
0  1468    33
1     6  1533
---- Validation: 
scalar performance:
{'acc': 0.78499615, 'precision': 0.81639373, 'recall': 0.77987003, 'specificity': 0.77987003, 'f1': 0.7772579, 'auroc': 0.88337755, 'binary_precision': 0.9084507, 'binary_recall': 0.61821085, 'binary_specificity': 0.9415292, 'binary_f1_score': 0.73574144}
confusion matrix:
     0    1
0  628   39
1  239  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809633, 'precision': 0.8441059, 'recall': 0.809633, 'specificity': 0.809633, 'f1': 0.8047427, 'auroc': 0.920861, 'binary_precision': 0.95302016, 'binary_recall': 0.6513761, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.7738419}
confusion matrix:
     0    1
0  211    7
1   76  142
early stop counter: 4
val acc:0.7849961519241333, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 18,now: 2024-07-29 07:27:55.541295,epoch time: 0:01:38.731356,used: 0:28:59.597068,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9950658, 'precision': 0.995069, 'recall': 0.9950615, 'specificity': 0.9950615, 'f1': 0.9950651, 'auroc': 0.9998615, 'binary_precision': 0.9947984, 'binary_recall': 0.99544567, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.9951219}
confusion matrix:
      0     1
0  1495     8
1     7  1530
---- Validation: 
scalar performance:
{'acc': 0.7679814, 'precision': 0.8196744, 'recall': 0.7614635, 'specificity': 0.7614635, 'f1': 0.755058, 'auroc': 0.90957975, 'binary_precision': 0.94054055, 'binary_recall': 0.5559105, 'binary_specificity': 0.9670165, 'binary_f1_score': 0.6987952}
confusion matrix:
     0    1
0  645   22
1  278  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76376146, 'precision': 0.81942004, 'recall': 0.76376146, 'specificity': 0.76376146, 'f1': 0.7530017, 'auroc': 0.91762054, 'binary_precision': 0.9527559, 'binary_recall': 0.55504584, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.7014492}
confusion matrix:
     0    1
0  212    6
1   97  121
early stop counter: 5
val acc:0.7679814100265503, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 19,now: 2024-07-29 07:29:34.317970,epoch time: 0:01:38.776675,used: 0:30:38.373743,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.9854067, 'recall': 0.9853464, 'specificity': 0.9853464, 'f1': 0.9851973, 'auroc': 0.99972, 'binary_precision': 0.9986631, 'binary_recall': 0.9720234, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.9851632}
confusion matrix:
      0     1
0  1501     2
1    43  1494
---- Validation: 
scalar performance:
{'acc': 0.6481052, 'precision': 0.76968443, 'recall': 0.63712156, 'specificity': 0.63712156, 'f1': 0.59347296, 'auroc': 0.91169333, 'binary_precision': 0.9430052, 'binary_recall': 0.29073483, 'binary_specificity': 0.9835082, 'binary_f1_score': 0.44444445}
confusion matrix:
     0    1
0  656   11
1  444  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5344037, 'precision': 0.6721234, 'recall': 0.5344037, 'specificity': 0.5344037, 'f1': 0.41798237, 'auroc': 0.8957368, 'binary_precision': 0.82608694, 'binary_recall': 0.08715596, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.15767635}
confusion matrix:
     0   1
0  214   4
1  199  19
early stop counter: 6
val acc:0.6481052041053772, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 20,now: 2024-07-29 07:31:12.769625,epoch time: 0:01:38.451655,used: 0:32:16.825398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.9851421, 'recall': 0.98504555, 'specificity': 0.98504555, 'f1': 0.9848682, 'auroc': 0.9996499, 'binary_precision': 1.0, 'binary_recall': 0.97009104, 'binary_specificity': 1.0, 'binary_f1_score': 0.98481846}
confusion matrix:
      0     1
0  1502     0
1    46  1492
---- Validation: 
scalar performance:
{'acc': 0.5351895, 'precision': 0.70248914, 'recall': 0.52016443, 'specificity': 0.52016443, 'f1': 0.38806418, 'auroc': 0.8673421, 'binary_precision': 0.8787879, 'binary_recall': 0.046325877, 'binary_specificity': 0.994003, 'binary_f1_score': 0.088012144}
confusion matrix:
     0   1
0  663   4
1  597  29
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977064, 'precision': 0.24942529, 'recall': 0.4977064, 'specificity': 0.4977064, 'f1': 0.3323124, 'auroc': 0.8647683, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  217  1
1  218  0
early stop counter: 7
val acc:0.5351895093917847, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 21,now: 2024-07-29 07:32:49.050607,epoch time: 0:01:36.280982,used: 0:33:53.106380,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.99341416, 'recall': 0.9934825, 'specificity': 0.9934825, 'f1': 0.9934208, 'auroc': 0.99973285, 'binary_precision': 0.99868596, 'binary_recall': 0.9882965, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.99346405}
confusion matrix:
      0     1
0  1500     2
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.837587, 'precision': 0.8550402, 'recall': 0.8340359, 'specificity': 0.8340359, 'f1': 0.8344135, 'auroc': 0.9210906, 'binary_precision': 0.92622954, 'binary_recall': 0.7220447, 'binary_specificity': 0.946027, 'binary_f1_score': 0.8114902}
confusion matrix:
     0    1
0  631   36
1  174  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79587156, 'precision': 0.8380455, 'recall': 0.79587156, 'specificity': 0.79587156, 'f1': 0.78929996, 'auroc': 0.909814, 'binary_precision': 0.9574468, 'binary_recall': 0.61926603, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.75208914}
confusion matrix:
     0    1
0  212    6
1   83  135
early stop counter: 8
val acc:0.8375869989395142, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 22,now: 2024-07-29 07:34:18.773275,epoch time: 0:01:29.722668,used: 0:35:22.829048,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.9930719, 'recall': 0.9931212, 'specificity': 0.9931212, 'f1': 0.9930912, 'auroc': 0.9997892, 'binary_precision': 0.9954338, 'binary_recall': 0.9909091, 'binary_specificity': 0.9953333, 'binary_f1_score': 0.99316627}
confusion matrix:
      0     1
0  1493     7
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.6682135, 'precision': 0.76750547, 'recall': 0.658232, 'specificity': 0.658232, 'f1': 0.62608725, 'auroc': 0.90977794, 'binary_precision': 0.9227468, 'binary_recall': 0.3434505, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.5005821}
confusion matrix:
     0    1
0  649   18
1  411  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.8590095, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.8082392, 'auroc': 0.9389151, 'binary_precision': 0.9858156, 'binary_recall': 0.63761467, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.7743733}
confusion matrix:
     0    1
0  216    2
1   79  139
early stop counter: 9
val acc:0.6682134866714478, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8096330165863037 / 0.857798159122467
after epoch: 23,now: 2024-07-29 07:35:43.593433,epoch time: 0:01:24.820158,used: 0:36:47.649206,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9948078, 'recall': 0.9946947, 'specificity': 0.9946947, 'f1': 0.9947357, 'auroc': 0.9998853, 'binary_precision': 0.99095607, 'binary_recall': 0.99869794, 'binary_specificity': 0.9906915, 'binary_f1_score': 0.99481195}
confusion matrix:
      0     1
0  1490    14
1     2  1534
---- Validation: 
scalar performance:
{'acc': 0.86465585, 'precision': 0.86504984, 'recall': 0.86405325, 'specificity': 0.86405325, 'f1': 0.8643638, 'auroc': 0.9329265, 'binary_precision': 0.8714992, 'binary_recall': 0.84504795, 'binary_specificity': 0.8830585, 'binary_f1_score': 0.8580698}
confusion matrix:
     0    1
0  589   78
1   97  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.847771, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8333157, 'auroc': 0.92212355, 'binary_precision': 0.91477275, 'binary_recall': 0.7385321, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.81725895}
confusion matrix:
     0    1
0  203   15
1   57  161
better model found
persisted
after epoch: 24,now: 2024-07-29 07:37:12.387610,epoch time: 0:01:28.794177,used: 0:38:16.443383,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9927821, 'recall': 0.99284786, 'specificity': 0.99284786, 'f1': 0.99276304, 'auroc': 0.9999238, 'binary_precision': 1.0, 'binary_recall': 0.9856957, 'binary_specificity': 1.0, 'binary_f1_score': 0.99279636}
confusion matrix:
      0     1
0  1502     0
1    22  1516
---- Validation: 
scalar performance:
{'acc': 0.7795824, 'precision': 0.81345475, 'recall': 0.7742299, 'specificity': 0.7742299, 'f1': 0.7710223, 'auroc': 0.90385157, 'binary_precision': 0.9088729, 'binary_recall': 0.6054313, 'binary_specificity': 0.9430285, 'binary_f1_score': 0.7267498}
confusion matrix:
     0    1
0  629   38
1  247  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6788991, 'precision': 0.75303566, 'recall': 0.67889905, 'specificity': 0.67889905, 'f1': 0.6535204, 'auroc': 0.86897147, 'binary_precision': 0.89, 'binary_recall': 0.4082569, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.5597485}
confusion matrix:
     0   1
0  207  11
1  129  89
early stop counter: 1
val acc:0.7795823812484741, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8348624110221863 / 0.857798159122467
after epoch: 25,now: 2024-07-29 07:38:45.677720,epoch time: 0:01:33.290110,used: 0:39:49.733493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9947216, 'recall': 0.99477303, 'specificity': 0.99477303, 'f1': 0.99473655, 'auroc': 0.9998558, 'binary_precision': 0.9980354, 'binary_recall': 0.991542, 'binary_specificity': 0.998004, 'binary_f1_score': 0.9947781}
confusion matrix:
      0     1
0  1500     3
1    13  1524
---- Validation: 
scalar performance:
{'acc': 0.8066512, 'precision': 0.8272183, 'recall': 0.802578, 'specificity': 0.802578, 'f1': 0.80196023, 'auroc': 0.90784883, 'binary_precision': 0.9017094, 'binary_recall': 0.6741214, 'binary_specificity': 0.9310345, 'binary_f1_score': 0.7714808}
confusion matrix:
     0    1
0  621   46
1  204  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.8346717, 'recall': 0.7981651, 'specificity': 0.7981651, 'f1': 0.7925067, 'auroc': 0.9177468, 'binary_precision': 0.94520545, 'binary_recall': 0.6330275, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.7582417}
confusion matrix:
     0    1
0  210    8
1   80  138
early stop counter: 2
val acc:0.8066511750221252, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8348624110221863 / 0.857798159122467
after epoch: 26,now: 2024-07-29 07:40:25.133956,epoch time: 0:01:39.456236,used: 0:41:29.189729,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.99020374, 'recall': 0.99022746, 'specificity': 0.99022746, 'f1': 0.9901316, 'auroc': 0.9997476, 'binary_precision': 0.9993369, 'binary_recall': 0.9811198, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.99014455}
confusion matrix:
      0     1
0  1503     1
1    29  1507
---- Validation: 
scalar performance:
{'acc': 0.8352668, 'precision': 0.8538916, 'recall': 0.8315906, 'specificity': 0.8315906, 'f1': 0.831862, 'auroc': 0.92836165, 'binary_precision': 0.92753625, 'binary_recall': 0.71565497, 'binary_specificity': 0.9475262, 'binary_f1_score': 0.8079351}
confusion matrix:
     0    1
0  632   35
1  178  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7477064, 'precision': 0.7780349, 'recall': 0.7477064, 'specificity': 0.7477064, 'f1': 0.74063337, 'auroc': 0.8775145, 'binary_precision': 0.86986303, 'binary_recall': 0.5825688, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.69780225}
confusion matrix:
     0    1
0  199   19
1   91  127
early stop counter: 3
val acc:0.8352668285369873, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8348624110221863 / 0.857798159122467
after epoch: 27,now: 2024-07-29 07:42:00.592568,epoch time: 0:01:35.458612,used: 0:43:04.648341,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934084, 'recall': 0.99343574, 'specificity': 0.99343574, 'f1': 0.99342036, 'auroc': 0.9998095, 'binary_precision': 0.9947849, 'binary_recall': 0.99219763, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.99348956}
confusion matrix:
      0     1
0  1494     8
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.8228925, 'precision': 0.8573086, 'recall': 0.8179273, 'specificity': 0.8179273, 'f1': 0.81678903, 'auroc': 0.94190705, 'binary_precision': 0.96055686, 'binary_recall': 0.66134185, 'binary_specificity': 0.97451276, 'binary_f1_score': 0.78334916}
confusion matrix:
     0    1
0  650   17
1  212  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6972477, 'precision': 0.8060998, 'recall': 0.6972477, 'specificity': 0.6972477, 'f1': 0.66770595, 'auroc': 0.9290885, 'binary_precision': 0.9886364, 'binary_recall': 0.39908257, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.5686275}
confusion matrix:
     0   1
0  217   1
1  131  87
early stop counter: 4
val acc:0.8228924870491028, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8348624110221863 / 0.857798159122467
after epoch: 28,now: 2024-07-29 07:43:38.072725,epoch time: 0:01:37.480157,used: 0:44:42.128498,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.9895573, 'recall': 0.9895828, 'specificity': 0.9895828, 'f1': 0.9894737, 'auroc': 0.9999207, 'binary_precision': 0.9993364, 'binary_recall': 0.97983086, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9894876}
confusion matrix:
      0     1
0  1502     1
1    31  1506
---- Validation: 
scalar performance:
{'acc': 0.68754834, 'precision': 0.79926634, 'recall': 0.6776109, 'specificity': 0.6776109, 'f1': 0.6480826, 'auroc': 0.92819345, 'binary_precision': 0.974359, 'binary_recall': 0.36421725, 'binary_specificity': 0.9910045, 'binary_f1_score': 0.53023255}
confusion matrix:
     0    1
0  661    6
1  398  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61238533, 'precision': 0.78165376, 'recall': 0.61238533, 'specificity': 0.61238533, 'f1': 0.54385114, 'auroc': 0.93606913, 'binary_precision': 1.0, 'binary_recall': 0.22477064, 'binary_specificity': 1.0, 'binary_f1_score': 0.36704117}
confusion matrix:
     0   1
0  218   0
1  169  49
early stop counter: 5
val acc:0.6875483393669128, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8348624110221863 / 0.857798159122467
after epoch: 29,now: 2024-07-29 07:45:16.967607,epoch time: 0:01:38.894882,used: 0:46:21.023380,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99307907, 'recall': 0.99315274, 'specificity': 0.99315274, 'f1': 0.9930917, 'auroc': 0.9998468, 'binary_precision': 0.9980315, 'binary_recall': 0.9883041, 'binary_specificity': 0.99800134, 'binary_f1_score': 0.993144}
confusion matrix:
      0     1
0  1498     3
1    18  1521
---- Validation: 
scalar performance:
{'acc': 0.7107502, 'precision': 0.78130156, 'recall': 0.70255446, 'specificity': 0.70255446, 'f1': 0.686002, 'auroc': 0.90266126, 'binary_precision': 0.9144737, 'binary_recall': 0.44408944, 'binary_specificity': 0.9610195, 'binary_f1_score': 0.5978494}
confusion matrix:
     0    1
0  641   26
1  348  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5940367, 'precision': 0.69536614, 'recall': 0.5940367, 'specificity': 0.5940367, 'f1': 0.53355455, 'auroc': 0.88776195, 'binary_precision': 0.8360656, 'binary_recall': 0.23394495, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.3655914}
confusion matrix:
     0   1
0  208  10
1  167  51
early stop counter: 6
val acc:0.7107502222061157, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8348624110221863 / 0.857798159122467
after epoch: 30,now: 2024-07-29 07:46:46.721932,epoch time: 0:01:29.754325,used: 0:47:50.777705,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_58_55_seed_8_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:50.777705 at 2024-07-29 07:46:46.721932
persisted model performance metric: 

scalar performance:
{'acc': 0.8348624, 'precision': 0.847771, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8333157, 'auroc': 0.92212355, 'binary_precision': 0.91477275, 'binary_recall': 0.7385321, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.81725895}
confusion matrix:
     0    1
0  203   15
1   57  161
oracle model performance metric: 

scalar performance:
{'acc': 0.85779816, 'precision': 0.8614796, 'recall': 0.85779816, 'specificity': 0.85779816, 'f1': 0.85743517, 'auroc': 0.9190935, 'binary_precision': 0.8979592, 'binary_recall': 0.80733943, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.8502415}
confusion matrix:
     0    1
0  198   20
1   42  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457959 KiB |  13221 MiB | 662462 GiB | 662461 GiB |
|       from large pool | 417363 KiB |  13182 MiB | 654635 GiB | 654635 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457959 KiB |  13221 MiB | 662462 GiB | 662461 GiB |
|       from large pool | 417363 KiB |  13182 MiB | 654635 GiB | 654635 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 660333 GiB | 660333 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 652523 GiB | 652522 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14488 MiB | 123088 MiB | 108610 MiB |
|       from large pool |  14412 MiB |  14422 MiB | 122892 MiB | 108480 MiB |
|       from small pool |     66 MiB |     70 MiB |    196 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 465689 KiB |   1260 MiB | 470470 GiB | 470469 GiB |
|       from large pool | 455084 KiB |   1252 MiB | 462594 GiB | 462594 GiB |
|       from small pool |  10604 KiB |     47 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116344 K  |  116342 K  |
|       from large pool |     187    |    1413    |   59096 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57248 K  |   57246 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116344 K  |  116342 K  |
|       from large pool |     187    |    1413    |   59096 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57248 K  |   57246 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    5210    |    4574    |
|       from large pool |     603    |     603    |    5112    |    4509    |
|       from small pool |      33    |      35    |      98    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     653    |   78167 K  |   78167 K  |
|       from large pool |      39    |     605    |   44948 K  |   44948 K  |
|       from small pool |      58    |     236    |   33219 K  |   33219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 662462 GiB | 662462 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654635 GiB | 654635 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 662462 GiB | 662462 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654635 GiB | 654635 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660333 GiB | 660333 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652523 GiB | 652523 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14488 MiB | 123088 MiB | 122186 MiB |
|       from large pool |    852 MiB |  14422 MiB | 122892 MiB | 122040 MiB |
|       from small pool |     50 MiB |     70 MiB |    196 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 470470 GiB | 470470 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 462595 GiB | 462595 GiB |
|       from small pool |      0 KiB |     47 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116344 K  |  116344 K  |
|       from large pool |       2    |    1413    |   59096 K  |   59096 K  |
|       from small pool |       0    |    1419    |   57248 K  |   57248 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116344 K  |  116344 K  |
|       from large pool |       2    |    1413    |   59096 K  |   59096 K  |
|       from small pool |       0    |    1419    |   57248 K  |   57248 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    5210    |    5146    |
|       from large pool |      39    |     603    |    5112    |    5073    |
|       from small pool |      25    |      35    |      98    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   78168 K  |   78168 K  |
|       from large pool |       3    |     605    |   44948 K  |   44948 K  |
|       from small pool |       0    |     236    |   33219 K  |   33219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 662462 GiB | 662462 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654635 GiB | 654635 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 662462 GiB | 662462 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654635 GiB | 654635 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660333 GiB | 660333 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652523 GiB | 652523 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    902 MiB |  14488 MiB | 123088 MiB | 122186 MiB |
|       from large pool |    852 MiB |  14422 MiB | 122892 MiB | 122040 MiB |
|       from small pool |     50 MiB |     70 MiB |    196 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 470470 GiB | 470470 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 462595 GiB | 462595 GiB |
|       from small pool |      0 KiB |     47 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116344 K  |  116344 K  |
|       from large pool |       2    |    1413    |   59096 K  |   59096 K  |
|       from small pool |       0    |    1419    |   57248 K  |   57248 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116344 K  |  116344 K  |
|       from large pool |       2    |    1413    |   59096 K  |   59096 K  |
|       from small pool |       0    |    1419    |   57248 K  |   57248 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    5210    |    5146    |
|       from large pool |      39    |     603    |    5112    |    5073    |
|       from small pool |      25    |      35    |      98    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   78168 K  |   78168 K  |
|       from large pool |       3    |     605    |   44948 K  |   44948 K  |
|       from small pool |       0    |     236    |   33219 K  |   33219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368

 Experiment start at: 2024-07-29 07:47:27.916557
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9437173, 'precision': 0.94669193, 'recall': 0.9434316, 'specificity': 0.9434316, 'f1': 0.94359547, 'auroc': 0.9934162, 'binary_precision': 0.9119952, 'binary_recall': 0.9831059, 'binary_specificity': 0.9037574, 'binary_f1_score': 0.9462164}
confusion matrix:
      0     1
0  1371   146
1    26  1513
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8416988, 'precision': 0.84476185, 'recall': 0.8421713, 'specificity': 0.8421713, 'f1': 0.8414625, 'auroc': 0.9232111, 'binary_precision': 0.80965906, 'binary_recall': 0.88923556, 'binary_specificity': 0.795107, 'binary_f1_score': 0.8475836}
confusion matrix:
     0    1
0  520  134
1   71  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84130436, 'precision': 0.8414657, 'recall': 0.84130436, 'specificity': 0.84130436, 'f1': 0.8412856, 'auroc': 0.9126276, 'binary_precision': 0.83404255, 'binary_recall': 0.8521739, 'binary_specificity': 0.8304348, 'binary_f1_score': 0.8430108}
confusion matrix:
     0    1
0  191   39
1   34  196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:49:09.032776,epoch time: 0:01:41.116219,used: 0:01:41.116219,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9715314, 'precision': 0.9715252, 'recall': 0.9715464, 'specificity': 0.9715464, 'f1': 0.9715308, 'auroc': 0.99650955, 'binary_precision': 0.97389036, 'binary_recall': 0.96946067, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.9716705}
confusion matrix:
      0     1
0  1477    40
1    47  1492
---- Validation: 
scalar performance:
{'acc': 0.8247104, 'precision': 0.8285928, 'recall': 0.82415783, 'specificity': 0.82415783, 'f1': 0.82400477, 'auroc': 0.89121544, 'binary_precision': 0.8618881, 'binary_recall': 0.76911074, 'binary_specificity': 0.87920487, 'binary_f1_score': 0.81286067}
confusion matrix:
     0    1
0  575   79
1  148  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84782606, 'precision': 0.848063, 'recall': 0.8478261, 'specificity': 0.8478261, 'f1': 0.84780014, 'auroc': 0.9165217, 'binary_precision': 0.85714287, 'binary_recall': 0.8347826, 'binary_specificity': 0.8608696, 'binary_f1_score': 0.84581494}
confusion matrix:
     0    1
0  198   32
1   38  192
new oracle model saved
early stop counter: 1
val acc:0.8247104287147522, best validation acc: 0.8416988253593445, corresponding to test acc:                         0.841304361820221 / 0.8478260636329651
after epoch: 2,now: 2024-07-29 07:50:51.023093,epoch time: 0:01:41.990317,used: 0:03:23.106536,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9761176, 'recall': 0.9758924, 'specificity': 0.9758924, 'f1': 0.9757838, 'auroc': 0.9974514, 'binary_precision': 0.9906229, 'binary_recall': 0.9610137, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9755936}
confusion matrix:
      0     1
0  1503    14
1    60  1479
---- Validation: 
scalar performance:
{'acc': 0.84555984, 'precision': 0.8565844, 'recall': 0.844676, 'specificity': 0.844676, 'f1': 0.84410733, 'auroc': 0.9201434, 'binary_precision': 0.9168242, 'binary_recall': 0.75663024, 'binary_specificity': 0.93272173, 'binary_f1_score': 0.8290598}
confusion matrix:
     0    1
0  610   44
1  156  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8484849, 'recall': 0.84782606, 'specificity': 0.84782606, 'f1': 0.8477541, 'auroc': 0.9136673, 'binary_precision': 0.8636364, 'binary_recall': 0.82608694, 'binary_specificity': 0.8695652, 'binary_f1_score': 0.8444445}
confusion matrix:
     0    1
0  200   30
1   40  190
better model found
persisted
after epoch: 3,now: 2024-07-29 07:52:24.015757,epoch time: 0:01:32.992664,used: 0:04:56.099200,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96040577, 'precision': 0.96304214, 'recall': 0.9607143, 'specificity': 0.9607143, 'f1': 0.96036583, 'auroc': 0.9984636, 'binary_precision': 1.0, 'binary_recall': 0.92142856, 'binary_specificity': 1.0, 'binary_f1_score': 0.9591078}
confusion matrix:
      0     1
0  1516     0
1   121  1419
---- Validation: 
scalar performance:
{'acc': 0.7297297, 'precision': 0.8034215, 'recall': 0.72723716, 'specificity': 0.72723716, 'f1': 0.7108387, 'auroc': 0.9260855, 'binary_precision': 0.95046437, 'binary_recall': 0.47893915, 'binary_specificity': 0.97553515, 'binary_f1_score': 0.63692945}
confusion matrix:
     0    1
0  638   16
1  334  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7782609, 'precision': 0.84312356, 'recall': 0.7782609, 'specificity': 0.7782609, 'f1': 0.76726186, 'auroc': 0.91200376, 'binary_precision': 0.99230766, 'binary_recall': 0.5608696, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.71666664}
confusion matrix:
     0    1
0  229    1
1  101  129
early stop counter: 1
val acc:0.7297297120094299, best validation acc: 0.84555983543396, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 4,now: 2024-07-29 07:54:06.236511,epoch time: 0:01:42.220754,used: 0:06:38.319954,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98339665, 'recall': 0.98337984, 'specificity': 0.98337984, 'f1': 0.98331153, 'auroc': 0.99875265, 'binary_precision': 0.9920687, 'binary_recall': 0.9746753, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98329514}
confusion matrix:
      0     1
0  1504    12
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.827027, 'precision': 0.84550035, 'recall': 0.82586217, 'specificity': 0.82586217, 'f1': 0.8243115, 'auroc': 0.9212574, 'binary_precision': 0.9229209, 'binary_recall': 0.7098284, 'binary_specificity': 0.941896, 'binary_f1_score': 0.8024691}
confusion matrix:
     0    1
0  616   38
1  186  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8565217, 'precision': 0.8665267, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.85553586, 'auroc': 0.93224955, 'binary_precision': 0.9270833, 'binary_recall': 0.773913, 'binary_specificity': 0.9391304, 'binary_f1_score': 0.8436018}
confusion matrix:
     0    1
0  216   14
1   52  178
new oracle model saved
early stop counter: 2
val acc:0.8270270228385925, best validation acc: 0.84555983543396, corresponding to test acc:                         0.8478260636329651 / 0.856521725654602
after epoch: 5,now: 2024-07-29 07:55:46.003627,epoch time: 0:01:39.767116,used: 0:08:18.087070,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9749944, 'recall': 0.97460705, 'specificity': 0.97460705, 'f1': 0.97447336, 'auroc': 0.9983959, 'binary_precision': 0.9925826, 'binary_recall': 0.95646524, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.97418934}
confusion matrix:
      0     1
0  1506    11
1    67  1472
---- Validation: 
scalar performance:
{'acc': 0.8146718, 'precision': 0.8456143, 'recall': 0.8131646, 'specificity': 0.8131646, 'f1': 0.8099083, 'auroc': 0.9234425, 'binary_precision': 0.94654787, 'binary_recall': 0.6630265, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.7798165}
confusion matrix:
     0    1
0  630   24
1  216  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.84529746, 'recall': 0.78260875, 'specificity': 0.78260875, 'f1': 0.7722727, 'auroc': 0.90964085, 'binary_precision': 0.99242425, 'binary_recall': 0.56956524, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.72375685}
confusion matrix:
     0    1
0  229    1
1   99  131
early stop counter: 3
val acc:0.8146718144416809, best validation acc: 0.84555983543396, corresponding to test acc:                         0.8478260636329651 / 0.856521725654602
after epoch: 6,now: 2024-07-29 07:57:17.031490,epoch time: 0:01:31.027863,used: 0:09:49.114933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905286, 'recall': 0.99055356, 'specificity': 0.99055356, 'f1': 0.9905104, 'auroc': 0.99940246, 'binary_precision': 0.99606043, 'binary_recall': 0.9850649, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99053216}
confusion matrix:
      0     1
0  1510     6
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.788417, 'precision': 0.83070207, 'recall': 0.7866126, 'specificity': 0.7866126, 'f1': 0.78069514, 'auroc': 0.9187814, 'binary_precision': 0.94647205, 'binary_recall': 0.6068643, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.73954374}
confusion matrix:
     0    1
0  632   22
1  252  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130435, 'precision': 0.85612905, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.8072125, 'auroc': 0.91017014, 'binary_precision': 0.98, 'binary_recall': 0.6391304, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.77368426}
confusion matrix:
     0    1
0  227    3
1   83  147
early stop counter: 4
val acc:0.7884169816970825, best validation acc: 0.84555983543396, corresponding to test acc:                         0.8478260636329651 / 0.856521725654602
after epoch: 7,now: 2024-07-29 07:58:59.674907,epoch time: 0:01:42.643417,used: 0:11:31.758350,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98792744, 'recall': 0.9878729, 'specificity': 0.9878729, 'f1': 0.98789155, 'auroc': 0.99927783, 'binary_precision': 0.9851325, 'binary_recall': 0.9908973, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.9880065}
confusion matrix:
      0     1
0  1495    23
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.86409265, 'precision': 0.8664448, 'recall': 0.86369133, 'specificity': 0.86369133, 'f1': 0.86377025, 'auroc': 0.93311054, 'binary_precision': 0.893401, 'binary_recall': 0.82371294, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  591   63
1  113  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8695652, 'precision': 0.8702651, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.86950356, 'auroc': 0.9187335, 'binary_precision': 0.8863636, 'binary_recall': 0.84782606, 'binary_specificity': 0.8913044, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  205   25
1   35  195
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-29 08:00:36.193753,epoch time: 0:01:36.518846,used: 0:13:08.277196,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.984878, 'recall': 0.98471624, 'specificity': 0.98471624, 'f1': 0.98461986, 'auroc': 0.99924314, 'binary_precision': 0.99799734, 'binary_recall': 0.97141004, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98452425}
confusion matrix:
      0     1
0  1514     3
1    44  1495
---- Validation: 
scalar performance:
{'acc': 0.6826255, 'precision': 0.7990706, 'recall': 0.6794692, 'specificity': 0.6794692, 'f1': 0.64610636, 'auroc': 0.92838264, 'binary_precision': 0.9831933, 'binary_recall': 0.3650546, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.5324232}
confusion matrix:
     0    1
0  650    4
1  407  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62826085, 'precision': 0.7787707, 'recall': 0.62826085, 'specificity': 0.62826085, 'f1': 0.5702555, 'auroc': 0.9159546, 'binary_precision': 0.9836066, 'binary_recall': 0.26086956, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.41237116}
confusion matrix:
     0   1
0  229   1
1  170  60
early stop counter: 1
val acc:0.6826254725456238, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 9,now: 2024-07-29 08:02:14.165988,epoch time: 0:01:37.972235,used: 0:14:46.249431,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98703104, 'recall': 0.98698103, 'specificity': 0.98698103, 'f1': 0.98691094, 'auroc': 0.99963504, 'binary_precision': 0.9966865, 'binary_recall': 0.97725797, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98687667}
confusion matrix:
      0     1
0  1512     5
1    35  1504
---- Validation: 
scalar performance:
{'acc': 0.7776062, 'precision': 0.82329845, 'recall': 0.7757076, 'specificity': 0.7757076, 'f1': 0.7686353, 'auroc': 0.9075973, 'binary_precision': 0.9423559, 'binary_recall': 0.58658344, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.7230769}
confusion matrix:
     0    1
0  631   23
1  265  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.776087, 'precision': 0.838871, 'recall': 0.7760869, 'specificity': 0.7760869, 'f1': 0.76521194, 'auroc': 0.92894137, 'binary_precision': 0.9847328, 'binary_recall': 0.5608696, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.71468145}
confusion matrix:
     0    1
0  228    2
1  101  129
early stop counter: 2
val acc:0.777606189250946, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 10,now: 2024-07-29 08:03:52.127997,epoch time: 0:01:37.962009,used: 0:16:24.211440,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9843233, 'recall': 0.98427355, 'specificity': 0.98427355, 'f1': 0.9842917, 'auroc': 0.99892366, 'binary_precision': 0.98190045, 'binary_recall': 0.9870046, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.9844459}
confusion matrix:
      0     1
0  1489    28
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.86332047, 'precision': 0.8682556, 'recall': 0.86274076, 'specificity': 0.86274076, 'f1': 0.862715, 'auroc': 0.93884265, 'binary_precision': 0.9084507, 'binary_recall': 0.8049922, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.85359806}
confusion matrix:
     0    1
0  602   52
1  125  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8369565, 'precision': 0.86620444, 'recall': 0.8369565, 'specificity': 0.8369565, 'f1': 0.83363473, 'auroc': 0.9277883, 'binary_precision': 0.969697, 'binary_recall': 0.6956522, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.81012654}
confusion matrix:
     0    1
0  225    5
1   70  160
early stop counter: 3
val acc:0.8633204698562622, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 11,now: 2024-07-29 08:05:38.194690,epoch time: 0:01:46.066693,used: 0:18:10.278133,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.98401946, 'recall': 0.9837408, 'specificity': 0.9837408, 'f1': 0.9836374, 'auroc': 0.999686, 'binary_precision': 0.99932885, 'binary_recall': 0.9681404, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9834875}
confusion matrix:
      0     1
0  1517     1
1    49  1489
---- Validation: 
scalar performance:
{'acc': 0.6015444, 'precision': 0.7646526, 'recall': 0.5975659, 'specificity': 0.5975659, 'f1': 0.52459615, 'auroc': 0.90145427, 'binary_precision': 0.9699248, 'binary_recall': 0.20124805, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.33333334}
confusion matrix:
     0    1
0  650    4
1  512  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347826, 'precision': 0.759009, 'recall': 0.5347826, 'specificity': 0.5347826, 'f1': 0.40628693, 'auroc': 0.93079394, 'binary_precision': 1.0, 'binary_recall': 0.069565214, 'binary_specificity': 1.0, 'binary_f1_score': 0.1300813}
confusion matrix:
     0   1
0  230   0
1  214  16
early stop counter: 4
val acc:0.6015443801879883, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 12,now: 2024-07-29 08:07:06.348807,epoch time: 0:01:28.154117,used: 0:19:38.432250,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98921657, 'recall': 0.9891904, 'specificity': 0.9891904, 'f1': 0.9892009, 'auroc': 0.99966633, 'binary_precision': 0.98768634, 'binary_recall': 0.9908973, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9892893}
confusion matrix:
      0     1
0  1499    19
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.84247106, 'precision': 0.8629933, 'recall': 0.84127676, 'specificity': 0.84127676, 'f1': 0.8398715, 'auroc': 0.9398082, 'binary_precision': 0.9468303, 'binary_recall': 0.7223089, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.81946903}
confusion matrix:
     0    1
0  628   26
1  178  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.85119104, 'recall': 0.8043479, 'specificity': 0.8043479, 'f1': 0.79759854, 'auroc': 0.93028355, 'binary_precision': 0.9794521, 'binary_recall': 0.62173915, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.7606383}
confusion matrix:
     0    1
0  227    3
1   87  143
early stop counter: 5
val acc:0.8424710631370544, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 13,now: 2024-07-29 08:08:44.371946,epoch time: 0:01:38.023139,used: 0:21:16.455389,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9845756, 'recall': 0.984217, 'specificity': 0.984217, 'f1': 0.9842883, 'auroc': 0.99946284, 'binary_precision': 0.9745385, 'binary_recall': 0.9948018, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.9845659}
confusion matrix:
      0     1
0  1477    40
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.85791504, 'precision': 0.8588887, 'recall': 0.8581798, 'specificity': 0.8581798, 'f1': 0.8578702, 'auroc': 0.92434645, 'binary_precision': 0.83751845, 'binary_recall': 0.8845554, 'binary_specificity': 0.8318043, 'binary_f1_score': 0.8603946}
confusion matrix:
     0    1
0  544  110
1   74  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8608696, 'precision': 0.8615531, 'recall': 0.8608696, 'specificity': 0.8608696, 'f1': 0.8608038, 'auroc': 0.9248015, 'binary_precision': 0.8772727, 'binary_recall': 0.83913046, 'binary_specificity': 0.8826087, 'binary_f1_score': 0.8577778}
confusion matrix:
     0    1
0  203   27
1   37  193
early stop counter: 6
val acc:0.8579150438308716, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 14,now: 2024-07-29 08:10:23.682542,epoch time: 0:01:39.310596,used: 0:22:55.765985,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98110735, 'recall': 0.98082364, 'specificity': 0.98082364, 'f1': 0.9806922, 'auroc': 0.9991596, 'binary_precision': 0.9973136, 'binary_recall': 0.96428573, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9805216}
confusion matrix:
      0     1
0  1512     4
1    55  1485
---- Validation: 
scalar performance:
{'acc': 0.56679535, 'precision': 0.72350514, 'recall': 0.562542, 'specificity': 0.562542, 'f1': 0.46889332, 'auroc': 0.88648695, 'binary_precision': 0.90816325, 'binary_recall': 0.13884555, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.24086605}
confusion matrix:
     0   1
0  645   9
1  552  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5195652, 'precision': 0.7549889, 'recall': 0.5195652, 'specificity': 0.5195652, 'f1': 0.3753955, 'auroc': 0.91839325, 'binary_precision': 1.0, 'binary_recall': 0.039130434, 'binary_specificity': 1.0, 'binary_f1_score': 0.07531381}
confusion matrix:
     0  1
0  230  0
1  221  9
early stop counter: 7
val acc:0.5667953491210938, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 15,now: 2024-07-29 08:12:00.331266,epoch time: 0:01:36.648724,used: 0:24:32.414709,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937751, 'recall': 0.9938003, 'specificity': 0.9938003, 'f1': 0.9937825, 'auroc': 0.9998462, 'binary_precision': 0.9960861, 'binary_recall': 0.99155843, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9938171}
confusion matrix:
      0     1
0  1510     6
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.74362934, 'precision': 0.8075381, 'recall': 0.74132425, 'specificity': 0.74132425, 'f1': 0.72836334, 'auroc': 0.9080708, 'binary_precision': 0.94524497, 'binary_recall': 0.51170045, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.6639676}
confusion matrix:
     0    1
0  635   19
1  313  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7695652, 'precision': 0.8388461, 'recall': 0.7695652, 'specificity': 0.7695652, 'f1': 0.75715196, 'auroc': 0.93385637, 'binary_precision': 0.99206346, 'binary_recall': 0.54347825, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.70224714}
confusion matrix:
     0    1
0  229    1
1  105  125
early stop counter: 8
val acc:0.7436293363571167, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 16,now: 2024-07-29 08:13:37.855321,epoch time: 0:01:37.524055,used: 0:26:09.938764,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9871146, 'recall': 0.98684335, 'specificity': 0.98684335, 'f1': 0.9869075, 'auroc': 0.9995502, 'binary_precision': 0.9789272, 'binary_recall': 0.99545455, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9871217}
confusion matrix:
      0     1
0  1483    33
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.8586873, 'precision': 0.86466837, 'recall': 0.85804504, 'specificity': 0.85804504, 'f1': 0.85793877, 'auroc': 0.9267653, 'binary_precision': 0.9089286, 'binary_recall': 0.79407173, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.847627}
confusion matrix:
     0    1
0  603   51
1  132  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83913046, 'precision': 0.8497076, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.8379047, 'auroc': 0.91249526, 'binary_precision': 0.91052634, 'binary_recall': 0.7521739, 'binary_specificity': 0.92608696, 'binary_f1_score': 0.8238095}
confusion matrix:
     0    1
0  213   17
1   57  173
early stop counter: 9
val acc:0.8586872816085815, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 17,now: 2024-07-29 08:15:18.754955,epoch time: 0:01:40.899634,used: 0:27:50.838398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898483, 'recall': 0.9898683, 'specificity': 0.9898683, 'f1': 0.98985565, 'auroc': 0.9995352, 'binary_precision': 0.99153095, 'binary_recall': 0.9883117, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9899187}
confusion matrix:
      0     1
0  1503    13
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.84324324, 'precision': 0.86030906, 'recall': 0.84214985, 'specificity': 0.84214985, 'f1': 0.8410535, 'auroc': 0.93016994, 'binary_precision': 0.936255, 'binary_recall': 0.73322934, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.82239723}
confusion matrix:
     0    1
0  622   32
1  171  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673913, 'precision': 0.8896742, 'recall': 0.86739135, 'specificity': 0.86739135, 'f1': 0.865468, 'auroc': 0.9332845, 'binary_precision': 0.98285717, 'binary_recall': 0.7478261, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.8493827}
confusion matrix:
     0    1
0  227    3
1   58  172
early stop counter: 10
val acc:0.8432432413101196, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 18,now: 2024-07-29 08:17:01.299208,epoch time: 0:01:42.544253,used: 0:29:33.382651,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99443454, 'recall': 0.99443936, 'specificity': 0.99443936, 'f1': 0.99443686, 'auroc': 0.9996736, 'binary_precision': 0.9948018, 'binary_recall': 0.9941558, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.99447876}
confusion matrix:
      0     1
0  1508     8
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.7876448, 'precision': 0.8180921, 'recall': 0.7860806, 'specificity': 0.7860806, 'f1': 0.78179693, 'auroc': 0.9054445, 'binary_precision': 0.91402715, 'binary_recall': 0.63026524, 'binary_specificity': 0.941896, 'binary_f1_score': 0.7460757}
confusion matrix:
     0    1
0  616   38
1  237  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75869566, 'precision': 0.8336259, 'recall': 0.75869566, 'specificity': 0.75869566, 'f1': 0.7443408, 'auroc': 0.93249524, 'binary_precision': 0.9917355, 'binary_recall': 0.5217391, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.68376064}
confusion matrix:
     0    1
0  229    1
1  110  120
early stop counter: 11
val acc:0.7876448035240173, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 19,now: 2024-07-29 08:18:43.127069,epoch time: 0:01:41.827861,used: 0:31:15.210512,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9950916, 'precision': 0.9950937, 'recall': 0.9950893, 'specificity': 0.9950893, 'f1': 0.9950914, 'auroc': 0.99988604, 'binary_precision': 0.9948018, 'binary_recall': 0.99544865, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.9951251}
confusion matrix:
      0     1
0  1510     8
1     7  1531
---- Validation: 
scalar performance:
{'acc': 0.7907336, 'precision': 0.83211327, 'recall': 0.7889527, 'specificity': 0.7889527, 'f1': 0.7832904, 'auroc': 0.92934096, 'binary_precision': 0.9468599, 'binary_recall': 0.6115445, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.74312794}
confusion matrix:
     0    1
0  632   22
1  249  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8333334, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73333335, 'auroc': 0.93975425, 'binary_precision': 1.0, 'binary_recall': 0.5, 'binary_specificity': 1.0, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  230    0
1  115  115
early stop counter: 12
val acc:0.7907335758209229, best validation acc: 0.8640926480293274, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 20,now: 2024-07-29 08:20:22.306184,epoch time: 0:01:39.179115,used: 0:32:54.389627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.98525584, 'recall': 0.9848742, 'specificity': 0.9848742, 'f1': 0.9849429, 'auroc': 0.99965394, 'binary_precision': 0.9745547, 'binary_recall': 0.9960988, 'binary_specificity': 0.97364956, 'binary_f1_score': 0.985209}
confusion matrix:
      0     1
0  1478    40
1     6  1532
---- Validation: 
scalar performance:
{'acc': 0.8671815, 'precision': 0.86903477, 'recall': 0.866827, 'specificity': 0.866827, 'f1': 0.86692363, 'auroc': 0.93483996, 'binary_precision': 0.8927973, 'binary_recall': 0.8315133, 'binary_specificity': 0.9021407, 'binary_f1_score': 0.8610662}
confusion matrix:
     0    1
0  590   64
1  108  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82608694, 'precision': 0.859375, 'recall': 0.826087, 'specificity': 0.826087, 'f1': 0.82196414, 'auroc': 0.9316635, 'binary_precision': 0.96875, 'binary_recall': 0.67391306, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7948718}
confusion matrix:
     0    1
0  225    5
1   75  155
better model found
persisted
after epoch: 21,now: 2024-07-29 08:22:04.249975,epoch time: 0:01:41.943791,used: 0:34:36.333418,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99117315, 'recall': 0.9911574, 'specificity': 0.9911574, 'f1': 0.9911643, 'auroc': 0.99983335, 'binary_precision': 0.9902724, 'binary_recall': 0.99220276, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9912367}
confusion matrix:
      0     1
0  1502    15
1    12  1527
---- Validation: 
scalar performance:
{'acc': 0.83861005, 'precision': 0.85542953, 'recall': 0.8375162, 'specificity': 0.8375162, 'f1': 0.83635557, 'auroc': 0.9296493, 'binary_precision': 0.9302789, 'binary_recall': 0.7285491, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.81714785}
confusion matrix:
     0    1
0  619   35
1  174  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7326087, 'precision': 0.8176385, 'recall': 0.7326087, 'specificity': 0.7326087, 'f1': 0.7134304, 'auroc': 0.9172212, 'binary_precision': 0.981982, 'binary_recall': 0.47391304, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.6392962}
confusion matrix:
     0    1
0  228    2
1  121  109
early stop counter: 1
val acc:0.838610053062439, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 22,now: 2024-07-29 08:23:48.101971,epoch time: 0:01:43.851996,used: 0:36:20.185414,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878888, 'recall': 0.98791325, 'specificity': 0.98791325, 'f1': 0.9878924, 'auroc': 0.99940073, 'binary_precision': 0.9908497, 'binary_recall': 0.9850552, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9879439}
confusion matrix:
      0     1
0  1503    14
1    23  1516
---- Validation: 
scalar performance:
{'acc': 0.5814672, 'precision': 0.7466216, 'recall': 0.57731616, 'specificity': 0.57731616, 'f1': 0.49218482, 'auroc': 0.88233095, 'binary_precision': 0.9459459, 'binary_recall': 0.16380656, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.27925533}
confusion matrix:
     0    1
0  648    6
1  536  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6304348, 'precision': 0.7875, 'recall': 0.63043475, 'specificity': 0.63043475, 'f1': 0.5719759, 'auroc': 0.9088516, 'binary_precision': 1.0, 'binary_recall': 0.26086956, 'binary_specificity': 1.0, 'binary_f1_score': 0.41379312}
confusion matrix:
     0   1
0  230   0
1  170  60
early stop counter: 2
val acc:0.5814672112464905, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 23,now: 2024-07-29 08:25:29.607866,epoch time: 0:01:41.505895,used: 0:38:01.691309,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99247384, 'recall': 0.99249935, 'specificity': 0.99249935, 'f1': 0.9924737, 'auroc': 0.99983895, 'binary_precision': 0.9960733, 'binary_recall': 0.9889539, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.99250084}
confusion matrix:
      0     1
0  1511     6
1    17  1522
---- Validation: 
scalar performance:
{'acc': 0.7567568, 'precision': 0.82140684, 'recall': 0.75449175, 'specificity': 0.75449175, 'f1': 0.74276733, 'auroc': 0.9196037, 'binary_precision': 0.9630682, 'binary_recall': 0.52886117, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.6827795}
confusion matrix:
     0    1
0  641   13
1  302  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6478261, 'precision': 0.7933674, 'recall': 0.6478261, 'specificity': 0.6478261, 'f1': 0.59796286, 'auroc': 0.9218573, 'binary_precision': 1.0, 'binary_recall': 0.29565218, 'binary_specificity': 1.0, 'binary_f1_score': 0.45637587}
confusion matrix:
     0   1
0  230   0
1  162  68
early stop counter: 3
val acc:0.7567567825317383, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 24,now: 2024-07-29 08:27:16.664413,epoch time: 0:01:47.056547,used: 0:39:48.747856,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99475926, 'recall': 0.994783, 'specificity': 0.994783, 'f1': 0.9947643, 'auroc': 0.9998475, 'binary_precision': 0.99738735, 'binary_recall': 0.99220276, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9947883}
confusion matrix:
      0     1
0  1513     4
1    12  1527
---- Validation: 
scalar performance:
{'acc': 0.6656371, 'precision': 0.7779649, 'recall': 0.66241705, 'specificity': 0.66241705, 'f1': 0.6254899, 'auroc': 0.9130157, 'binary_precision': 0.9521739, 'binary_recall': 0.34165367, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.5028703}
confusion matrix:
     0    1
0  643   11
1  422  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6086956, 'precision': 0.7804878, 'recall': 0.6086956, 'specificity': 0.6086956, 'f1': 0.53794646, 'auroc': 0.93539226, 'binary_precision': 1.0, 'binary_recall': 0.2173913, 'binary_specificity': 1.0, 'binary_f1_score': 0.35714287}
confusion matrix:
     0   1
0  230   0
1  180  50
early stop counter: 4
val acc:0.6656370759010315, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 25,now: 2024-07-29 08:28:59.823171,epoch time: 0:01:43.158758,used: 0:41:31.906614,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927989, 'recall': 0.9928242, 'specificity': 0.9928242, 'f1': 0.99280095, 'auroc': 0.9994856, 'binary_precision': 0.99607587, 'binary_recall': 0.98960364, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9928292}
confusion matrix:
      0     1
0  1511     6
1    16  1523
---- Validation: 
scalar performance:
{'acc': 0.6795367, 'precision': 0.795828, 'recall': 0.6763646, 'specificity': 0.6763646, 'f1': 0.64226544, 'auroc': 0.9180138, 'binary_precision': 0.9788136, 'binary_recall': 0.36037442, 'binary_specificity': 0.99235475, 'binary_f1_score': 0.5267959}
confusion matrix:
     0    1
0  649    5
1  410  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62826085, 'precision': 0.78678304, 'recall': 0.62826085, 'specificity': 0.62826085, 'f1': 0.56865305, 'auroc': 0.9220227, 'binary_precision': 1.0, 'binary_recall': 0.25652173, 'binary_specificity': 1.0, 'binary_f1_score': 0.4083045}
confusion matrix:
     0   1
0  230   0
1  171  59
early stop counter: 5
val acc:0.6795367002487183, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 26,now: 2024-07-29 08:30:41.212153,epoch time: 0:01:41.388982,used: 0:43:13.295596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934726, 'recall': 0.99349284, 'specificity': 0.99349284, 'f1': 0.99345547, 'auroc': 0.9998381, 'binary_precision': 0.9986868, 'binary_recall': 0.9883041, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9934683}
confusion matrix:
      0     1
0  1515     2
1    18  1521
---- Validation: 
scalar performance:
{'acc': 0.53281856, 'precision': 0.7465875, 'recall': 0.5280966, 'specificity': 0.5280966, 'f1': 0.39619786, 'auroc': 0.9255482, 'binary_precision': 0.9736842, 'binary_recall': 0.057722308, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.10898379}
confusion matrix:
     0   1
0  653   1
1  604  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9321125, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  230  0
1  230  0
early stop counter: 6
val acc:0.5328185558319092, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 27,now: 2024-07-29 08:32:23.146691,epoch time: 0:01:41.934538,used: 0:44:55.230134,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98754543, 'recall': 0.9871526, 'specificity': 0.9871526, 'f1': 0.98723376, 'auroc': 0.99983335, 'binary_precision': 0.9771138, 'binary_recall': 0.99805194, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.9874719}
confusion matrix:
      0     1
0  1480    36
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.86332047, 'precision': 0.8706429, 'recall': 0.8626167, 'specificity': 0.8626167, 'f1': 0.8624673, 'auroc': 0.93590146, 'binary_precision': 0.9202899, 'binary_recall': 0.7925117, 'binary_specificity': 0.93272173, 'binary_f1_score': 0.85163456}
confusion matrix:
     0    1
0  610   44
1  133  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8790376, 'recall': 0.8478261, 'specificity': 0.8478261, 'f1': 0.8446276, 'auroc': 0.9189981, 'binary_precision': 0.9878049, 'binary_recall': 0.70434785, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.822335}
confusion matrix:
     0    1
0  228    2
1   68  162
early stop counter: 7
val acc:0.8633204698562622, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 28,now: 2024-07-29 08:34:03.887636,epoch time: 0:01:40.740945,used: 0:46:35.971079,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9915583, 'recall': 0.9915483, 'specificity': 0.9915483, 'f1': 0.99149215, 'auroc': 0.99984235, 'binary_precision': 0.99933994, 'binary_recall': 0.9837557, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9914866}
confusion matrix:
      0     1
0  1516     1
1    25  1514
---- Validation: 
scalar performance:
{'acc': 0.66640925, 'precision': 0.7922677, 'recall': 0.66308856, 'specificity': 0.66308856, 'f1': 0.62354046, 'auroc': 0.9365014, 'binary_precision': 0.98156685, 'binary_recall': 0.3322933, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.4965035}
confusion matrix:
     0    1
0  650    4
1  428  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5217391, 'precision': 0.75555557, 'recall': 0.5217391, 'specificity': 0.5217391, 'f1': 0.37990198, 'auroc': 0.91380435, 'binary_precision': 1.0, 'binary_recall': 0.04347826, 'binary_specificity': 1.0, 'binary_f1_score': 0.083333336}
confusion matrix:
     0   1
0  230   0
1  220  10
early stop counter: 8
val acc:0.6664092540740967, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 29,now: 2024-07-29 08:35:44.777485,epoch time: 0:01:40.889849,used: 0:48:16.860928,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99379873, 'recall': 0.9938146, 'specificity': 0.9938146, 'f1': 0.9937827, 'auroc': 0.9999032, 'binary_precision': 0.9986868, 'binary_recall': 0.9889467, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9937929}
confusion matrix:
      0     1
0  1516     2
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.8069498, 'precision': 0.8370913, 'recall': 0.80544186, 'specificity': 0.80544186, 'f1': 0.80198777, 'auroc': 0.92465127, 'binary_precision': 0.93541205, 'binary_recall': 0.65522623, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7706422}
confusion matrix:
     0    1
0  625   29
1  221  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8304348, 'precision': 0.86858976, 'recall': 0.8304348, 'specificity': 0.8304348, 'f1': 0.82593, 'auroc': 0.9291494, 'binary_precision': 0.98717946, 'binary_recall': 0.6695652, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7979274}
confusion matrix:
     0    1
0  228    2
1   76  154
early stop counter: 9
val acc:0.80694979429245, best validation acc: 0.8671814799308777, corresponding to test acc:                         0.8260869383811951 / 0.8695651888847351
after epoch: 30,now: 2024-07-29 08:37:26.463271,epoch time: 0:01:41.685786,used: 0:49:58.546714,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_27_seed_9_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:58.546714 at 2024-07-29 08:37:26.463271
persisted model performance metric: 

scalar performance:
{'acc': 0.82608694, 'precision': 0.859375, 'recall': 0.826087, 'specificity': 0.826087, 'f1': 0.82196414, 'auroc': 0.9316635, 'binary_precision': 0.96875, 'binary_recall': 0.67391306, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7948718}
confusion matrix:
     0    1
0  225    5
1   75  155
oracle model performance metric: 

scalar performance:
{'acc': 0.8695652, 'precision': 0.8702651, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.86950356, 'auroc': 0.9187335, 'binary_precision': 0.8863636, 'binary_recall': 0.84782606, 'binary_specificity': 0.8913044, 'binary_f1_score': 0.8666666}
confusion matrix:
     0    1
0  205   25
1   35  195
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455693 KiB |  13221 MiB | 739522 GiB | 739522 GiB |
|       from large pool | 415095 KiB |  13182 MiB | 730798 GiB | 730797 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455693 KiB |  13221 MiB | 739522 GiB | 739522 GiB |
|       from large pool | 415095 KiB |  13182 MiB | 730798 GiB | 730797 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 737330 GiB | 737329 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 728624 GiB | 728623 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14488 MiB |  14488 MiB | 136674 MiB | 122186 MiB |
|       from large pool |  14424 MiB |  14424 MiB | 136464 MiB | 122040 MiB |
|       from small pool |     64 MiB |     70 MiB |    210 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 441330 KiB |   1260 MiB | 524738 GiB | 524738 GiB |
|       from large pool | 430729 KiB |   1256 MiB | 515960 GiB | 515959 GiB |
|       from small pool |  10601 KiB |     47 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129768 K  |  129767 K  |
|       from large pool |     187    |    1413    |   65973 K  |   65973 K  |
|       from small pool |    1123    |    1419    |   63795 K  |   63794 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129768 K  |  129767 K  |
|       from large pool |     187    |    1413    |   65973 K  |   65973 K  |
|       from small pool |    1123    |    1419    |   63795 K  |   63794 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    5781    |    5146    |
|       from large pool |     603    |     603    |    5676    |    5073    |
|       from small pool |      32    |      35    |     105    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      92    |     654    |   87126 K  |   87126 K  |
|       from large pool |      36    |     608    |   49959 K  |   49959 K  |
|       from small pool |      56    |     236    |   37167 K  |   37167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 739522 GiB | 739522 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730798 GiB | 730798 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 739522 GiB | 739522 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730798 GiB | 730798 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737330 GiB | 737330 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728624 GiB | 728624 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    876 MiB |  14488 MiB | 136674 MiB | 135798 MiB |
|       from large pool |    826 MiB |  14424 MiB | 136464 MiB | 135638 MiB |
|       from small pool |     50 MiB |     70 MiB |    210 MiB |    160 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 524738 GiB | 524738 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 515960 GiB | 515960 GiB |
|       from small pool |      0 KiB |     47 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129768 K  |  129768 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63795 K  |   63795 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129768 K  |  129768 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63795 K  |   63795 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    5781    |    5718    |
|       from large pool |      38    |     603    |    5676    |    5638    |
|       from small pool |      25    |      35    |     105    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |   87127 K  |   87127 K  |
|       from large pool |       3    |     608    |   49959 K  |   49959 K  |
|       from small pool |       0    |     236    |   37168 K  |   37168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 739522 GiB | 739522 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730798 GiB | 730798 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 739522 GiB | 739522 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730798 GiB | 730798 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737330 GiB | 737330 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728624 GiB | 728624 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    876 MiB |  14488 MiB | 136674 MiB | 135798 MiB |
|       from large pool |    826 MiB |  14424 MiB | 136464 MiB | 135638 MiB |
|       from small pool |     50 MiB |     70 MiB |    210 MiB |    160 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 524738 GiB | 524738 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 515960 GiB | 515960 GiB |
|       from small pool |      0 KiB |     47 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129768 K  |  129768 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63795 K  |   63795 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129768 K  |  129768 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63795 K  |   63795 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    5781    |    5718    |
|       from large pool |      38    |     603    |    5676    |    5638    |
|       from small pool |      25    |      35    |     105    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |   87127 K  |   87127 K  |
|       from large pool |       3    |     608    |   49959 K  |   49959 K  |
|       from small pool |       0    |     236    |   37168 K  |   37168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368

 Experiment start at: 2024-07-29 08:38:10.024846
before training, model accuracy: 0.5113122463226318
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9513889, 'precision': 0.95152444, 'recall': 0.9513473, 'specificity': 0.9513473, 'f1': 0.9513808, 'auroc': 0.99101347, 'binary_precision': 0.9449125, 'binary_recall': 0.9592105, 'binary_specificity': 0.94348407, 'binary_f1_score': 0.9520078}
confusion matrix:
      0     1
0  1419    85
1    62  1458
---- Validation: 
scalar performance:
{'acc': 0.86427456, 'precision': 0.8642426, 'recall': 0.86488914, 'specificity': 0.86488914, 'f1': 0.8642098, 'auroc': 0.9238063, 'binary_precision': 0.84375, 'binary_recall': 0.8794788, 'binary_specificity': 0.8502994, 'binary_f1_score': 0.861244}
confusion matrix:
     0    1
0  568  100
1   74  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8665158, 'precision': 0.8667035, 'recall': 0.8665159, 'specificity': 0.8665159, 'f1': 0.86649877, 'auroc': 0.93919045, 'binary_precision': 0.8584071, 'binary_recall': 0.87782806, 'binary_specificity': 0.8552036, 'binary_f1_score': 0.868009}
confusion matrix:
     0    1
0  189   32
1   27  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:39:44.244775,epoch time: 0:01:34.219929,used: 0:01:34.219929,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96858466, 'precision': 0.9696835, 'recall': 0.9687185, 'specificity': 0.9687185, 'f1': 0.9685718, 'auroc': 0.99745727, 'binary_precision': 0.99376297, 'binary_recall': 0.94342107, 'binary_specificity': 0.99401593, 'binary_f1_score': 0.9679378}
confusion matrix:
      0     1
0  1495     9
1    86  1434
---- Validation: 
scalar performance:
{'acc': 0.82839316, 'precision': 0.8318667, 'recall': 0.8260474, 'specificity': 0.8260474, 'f1': 0.82697654, 'auroc': 0.89797926, 'binary_precision': 0.85688406, 'binary_recall': 0.7703583, 'binary_specificity': 0.8817365, 'binary_f1_score': 0.81132084}
confusion matrix:
     0    1
0  589   79
1  141  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348416, 'precision': 0.83490336, 'recall': 0.8348416, 'specificity': 0.8348416, 'f1': 0.834834, 'auroc': 0.9132081, 'binary_precision': 0.83035713, 'binary_recall': 0.84162897, 'binary_specificity': 0.8280543, 'binary_f1_score': 0.835955}
confusion matrix:
     0    1
0  183   38
1   35  186
early stop counter: 1
val acc:0.8283931612968445, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 2,now: 2024-07-29 08:41:23.622184,epoch time: 0:01:39.377409,used: 0:03:13.597338,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96660054, 'precision': 0.9673016, 'recall': 0.9665034, 'specificity': 0.9665034, 'f1': 0.96658206, 'auroc': 0.9963864, 'binary_precision': 0.95047617, 'binary_recall': 0.9848684, 'binary_specificity': 0.9481383, 'binary_f1_score': 0.9673667}
confusion matrix:
      0     1
0  1426    78
1    23  1497
---- Validation: 
scalar performance:
{'acc': 0.8221529, 'precision': 0.8291228, 'recall': 0.82519406, 'specificity': 0.82519406, 'f1': 0.8219032, 'auroc': 0.90760255, 'binary_precision': 0.76955307, 'binary_recall': 0.8973941, 'binary_specificity': 0.752994, 'binary_f1_score': 0.82857144}
confusion matrix:
     0    1
0  503  165
1   63  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8303167, 'precision': 0.84739447, 'recall': 0.8303168, 'specificity': 0.8303168, 'f1': 0.8282054, 'auroc': 0.94639754, 'binary_precision': 0.77037036, 'binary_recall': 0.9411765, 'binary_specificity': 0.71945703, 'binary_f1_score': 0.84725046}
confusion matrix:
     0    1
0  159   62
1   13  208
early stop counter: 2
val acc:0.8221529126167297, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 3,now: 2024-07-29 08:43:04.001605,epoch time: 0:01:40.379421,used: 0:04:53.976759,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9695767, 'precision': 0.97064763, 'recall': 0.9697088, 'specificity': 0.9697088, 'f1': 0.96956474, 'auroc': 0.99673283, 'binary_precision': 0.9944598, 'binary_recall': 0.94473684, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.9689609}
confusion matrix:
      0     1
0  1496     8
1    84  1436
---- Validation: 
scalar performance:
{'acc': 0.7979719, 'precision': 0.80663836, 'recall': 0.7941568, 'specificity': 0.7941568, 'f1': 0.7948158, 'auroc': 0.8568238, 'binary_precision': 0.848723, 'binary_recall': 0.70358306, 'binary_specificity': 0.8847305, 'binary_f1_score': 0.76936775}
confusion matrix:
     0    1
0  591   77
1  182  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81674206, 'precision': 0.8215414, 'recall': 0.81674206, 'specificity': 0.81674206, 'f1': 0.8160557, 'auroc': 0.9004525, 'binary_precision': 0.7822581, 'binary_recall': 0.87782806, 'binary_specificity': 0.7556561, 'binary_f1_score': 0.82729214}
confusion matrix:
     0    1
0  167   54
1   27  194
early stop counter: 3
val acc:0.7979719042778015, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 4,now: 2024-07-29 08:44:43.583199,epoch time: 0:01:39.581594,used: 0:06:33.558353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9785053, 'precision': 0.9787911, 'recall': 0.9785764, 'specificity': 0.9785764, 'f1': 0.9785038, 'auroc': 0.9983307, 'binary_precision': 0.99188644, 'binary_recall': 0.9651316, 'binary_specificity': 0.99202126, 'binary_f1_score': 0.9783261}
confusion matrix:
      0     1
0  1492    12
1    53  1467
---- Validation: 
scalar performance:
{'acc': 0.7168487, 'precision': 0.7994834, 'recall': 0.70538485, 'specificity': 0.70538485, 'f1': 0.6884589, 'auroc': 0.8896872, 'binary_precision': 0.9466192, 'binary_recall': 0.43322477, 'binary_specificity': 0.9775449, 'binary_f1_score': 0.5944134}
confusion matrix:
     0    1
0  653   15
1  348  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7941176, 'precision': 0.827968, 'recall': 0.7941177, 'specificity': 0.7941177, 'f1': 0.7886645, 'auroc': 0.9137405, 'binary_precision': 0.93333334, 'binary_recall': 0.6334842, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.754717}
confusion matrix:
     0    1
0  211   10
1   81  140
early stop counter: 4
val acc:0.7168486714363098, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 5,now: 2024-07-29 08:46:24.436588,epoch time: 0:01:40.853389,used: 0:08:14.411742,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9785053, 'precision': 0.9788568, 'recall': 0.97858346, 'specificity': 0.97858346, 'f1': 0.97850335, 'auroc': 0.9975276, 'binary_precision': 0.9932203, 'binary_recall': 0.9638158, 'binary_specificity': 0.99335104, 'binary_f1_score': 0.9782972}
confusion matrix:
      0     1
0  1494    10
1    55  1465
---- Validation: 
scalar performance:
{'acc': 0.6326053, 'precision': 0.7803005, 'recall': 0.6167128, 'specificity': 0.6167128, 'f1': 0.5612508, 'auroc': 0.8664178, 'binary_precision': 0.9735099, 'binary_recall': 0.23941368, 'binary_specificity': 0.994012, 'binary_f1_score': 0.38431376}
confusion matrix:
     0    1
0  664    4
1  467  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49773756, 'precision': 0.4494279, 'recall': 0.49773756, 'specificity': 0.49773756, 'f1': 0.34015653, 'auroc': 0.89826167, 'binary_precision': 0.4, 'binary_recall': 0.009049774, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.017699117}
confusion matrix:
     0  1
0  218  3
1  219  2
early stop counter: 5
val acc:0.6326053142547607, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 6,now: 2024-07-29 08:48:03.790245,epoch time: 0:01:39.353657,used: 0:09:53.765399,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95701057, 'precision': 0.96022034, 'recall': 0.9572369, 'specificity': 0.9572369, 'f1': 0.95694935, 'auroc': 0.99809325, 'binary_precision': 1.0, 'binary_recall': 0.9144737, 'binary_specificity': 1.0, 'binary_f1_score': 0.95532644}
confusion matrix:
      0     1
0  1504     0
1   130  1390
---- Validation: 
scalar performance:
{'acc': 0.700468, 'precision': 0.8005202, 'recall': 0.68788886, 'specificity': 0.68788886, 'f1': 0.66445374, 'auroc': 0.9001602, 'binary_precision': 0.96370965, 'binary_recall': 0.38925081, 'binary_specificity': 0.98652697, 'binary_f1_score': 0.55452436}
confusion matrix:
     0    1
0  659    9
1  375  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6674208, 'precision': 0.80027175, 'recall': 0.6674208, 'specificity': 0.6674208, 'f1': 0.62605965, 'auroc': 0.9237526, 'binary_precision': 1.0, 'binary_recall': 0.33484164, 'binary_specificity': 1.0, 'binary_f1_score': 0.5016949}
confusion matrix:
     0   1
0  221   0
1  147  74
early stop counter: 6
val acc:0.7004680037498474, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 7,now: 2024-07-29 08:49:43.776776,epoch time: 0:01:39.986531,used: 0:11:33.751930,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9844577, 'precision': 0.9844543, 'recall': 0.9844625, 'specificity': 0.9844625, 'f1': 0.9844574, 'auroc': 0.99891734, 'binary_precision': 0.9854977, 'binary_recall': 0.98355263, 'binary_specificity': 0.98537236, 'binary_f1_score': 0.9845242}
confusion matrix:
      0     1
0  1482    22
1    25  1495
---- Validation: 
scalar performance:
{'acc': 0.8221529, 'precision': 0.84794664, 'recall': 0.8163071, 'specificity': 0.8163071, 'f1': 0.81665504, 'auroc': 0.91887885, 'binary_precision': 0.93273544, 'binary_recall': 0.67752445, 'binary_specificity': 0.9550898, 'binary_f1_score': 0.78490573}
confusion matrix:
     0    1
0  638   30
1  198  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81674206, 'precision': 0.8531963, 'recall': 0.81674206, 'specificity': 0.81674206, 'f1': 0.8118882, 'auroc': 0.92911696, 'binary_precision': 0.96666664, 'binary_recall': 0.6561086, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.7816711}
confusion matrix:
     0    1
0  216    5
1   76  145
early stop counter: 7
val acc:0.8221529126167297, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 8,now: 2024-07-29 08:51:24.558919,epoch time: 0:01:40.782143,used: 0:13:14.534073,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98776454, 'precision': 0.98776305, 'recall': 0.98777646, 'specificity': 0.98777646, 'f1': 0.9877644, 'auroc': 0.9994283, 'binary_precision': 0.9900859, 'binary_recall': 0.9855263, 'binary_specificity': 0.9900266, 'binary_f1_score': 0.98780084}
confusion matrix:
      0     1
0  1489    15
1    22  1498
---- Validation: 
scalar performance:
{'acc': 0.8315133, 'precision': 0.84527373, 'recall': 0.8271982, 'specificity': 0.8271982, 'f1': 0.82827675, 'auroc': 0.91082823, 'binary_precision': 0.9044715, 'binary_recall': 0.7247557, 'binary_specificity': 0.9296407, 'binary_f1_score': 0.8047017}
confusion matrix:
     0    1
0  621   47
1  169  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7963801, 'precision': 0.8167159, 'recall': 0.7963801, 'specificity': 0.7963801, 'f1': 0.7930583, 'auroc': 0.894392, 'binary_precision': 0.8969697, 'binary_recall': 0.6696833, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.7668394}
confusion matrix:
     0    1
0  204   17
1   73  148
early stop counter: 8
val acc:0.8315132856369019, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 9,now: 2024-07-29 08:53:03.971170,epoch time: 0:01:39.412251,used: 0:14:53.946324,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9867725, 'precision': 0.98682415, 'recall': 0.9868071, 'specificity': 0.9868071, 'f1': 0.9867725, 'auroc': 0.9985084, 'binary_precision': 0.99333334, 'binary_recall': 0.9802632, 'binary_specificity': 0.99335104, 'binary_f1_score': 0.98675495}
confusion matrix:
      0     1
0  1494    10
1    30  1490
---- Validation: 
scalar performance:
{'acc': 0.74414974, 'precision': 0.80940557, 'recall': 0.7341498, 'specificity': 0.7341498, 'f1': 0.7242989, 'auroc': 0.9119351, 'binary_precision': 0.94135803, 'binary_recall': 0.49674267, 'binary_specificity': 0.9715569, 'binary_f1_score': 0.6503198}
confusion matrix:
     0    1
0  649   19
1  309  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60633487, 'precision': 0.7519038, 'recall': 0.60633487, 'specificity': 0.60633487, 'f1': 0.5398588, 'auroc': 0.9040561, 'binary_precision': 0.9433962, 'binary_recall': 0.22624435, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.36496353}
confusion matrix:
     0   1
0  218   3
1  171  50
early stop counter: 9
val acc:0.7441497445106506, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 10,now: 2024-07-29 08:54:43.619413,epoch time: 0:01:39.648243,used: 0:16:33.594567,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96164024, 'precision': 0.9641975, 'recall': 0.9618421, 'specificity': 0.9618421, 'f1': 0.9615982, 'auroc': 0.9992529, 'binary_precision': 1.0, 'binary_recall': 0.92368424, 'binary_specificity': 1.0, 'binary_f1_score': 0.96032834}
confusion matrix:
      0     1
0  1504     0
1   116  1404
---- Validation: 
scalar performance:
{'acc': 0.5514821, 'precision': 0.7565398, 'recall': 0.53182477, 'specificity': 0.53182477, 'f1': 0.4104663, 'auroc': 0.9115243, 'binary_precision': 0.9756098, 'binary_recall': 0.06514658, 'binary_specificity': 0.99850297, 'binary_f1_score': 0.122137405}
confusion matrix:
     0   1
0  667   1
1  574  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.92605084, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  221  0
1  221  0
early stop counter: 10
val acc:0.551482081413269, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 11,now: 2024-07-29 08:56:27.357178,epoch time: 0:01:43.737765,used: 0:18:17.332332,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.9820081, 'recall': 0.9815755, 'specificity': 0.9815755, 'f1': 0.9814786, 'auroc': 0.99924326, 'binary_precision': 0.9993179, 'binary_recall': 0.9638158, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.9812458}
confusion matrix:
      0     1
0  1503     1
1    55  1465
---- Validation: 
scalar performance:
{'acc': 0.6794072, 'precision': 0.7921773, 'recall': 0.6658361, 'specificity': 0.6658361, 'f1': 0.63458383, 'auroc': 0.9211628, 'binary_precision': 0.96347034, 'binary_recall': 0.3436482, 'binary_specificity': 0.98802394, 'binary_f1_score': 0.5066026}
confusion matrix:
     0    1
0  660    8
1  403  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67873305, 'precision': 0.8044077, 'recall': 0.67873305, 'specificity': 0.67873305, 'f1': 0.64175797, 'auroc': 0.93642634, 'binary_precision': 1.0, 'binary_recall': 0.35746607, 'binary_specificity': 1.0, 'binary_f1_score': 0.52666664}
confusion matrix:
     0   1
0  221   0
1  142  79
early stop counter: 11
val acc:0.6794071793556213, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 12,now: 2024-07-29 08:58:07.623053,epoch time: 0:01:40.265875,used: 0:19:57.598207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.98619163, 'recall': 0.98608273, 'specificity': 0.98608273, 'f1': 0.98610955, 'auroc': 0.99945056, 'binary_precision': 0.9811198, 'binary_recall': 0.9914474, 'binary_specificity': 0.9807181, 'binary_f1_score': 0.98625654}
confusion matrix:
      0     1
0  1475    29
1    13  1507
---- Validation: 
scalar performance:
{'acc': 0.8385335, 'precision': 0.84012705, 'recall': 0.836897, 'specificity': 0.836897, 'f1': 0.83764195, 'auroc': 0.9075465, 'binary_precision': 0.8551483, 'binary_recall': 0.7980456, 'binary_specificity': 0.8757485, 'binary_f1_score': 0.8256107}
confusion matrix:
     0    1
0  585   83
1  124  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81447965, 'precision': 0.8145054, 'recall': 0.81447965, 'specificity': 0.81447965, 'f1': 0.8144759, 'auroc': 0.8801622, 'binary_precision': 0.8116592, 'binary_recall': 0.81900454, 'binary_specificity': 0.80995476, 'binary_f1_score': 0.81531537}
confusion matrix:
     0    1
0  179   42
1   40  181
early stop counter: 12
val acc:0.8385335206985474, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 13,now: 2024-07-29 08:59:48.274694,epoch time: 0:01:40.651641,used: 0:21:38.249848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9880952, 'precision': 0.9882851, 'recall': 0.9881544, 'specificity': 0.9881544, 'f1': 0.98809487, 'auroc': 0.99956954, 'binary_precision': 0.99932706, 'binary_recall': 0.9769737, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.988024}
confusion matrix:
      0     1
0  1503     1
1    35  1485
---- Validation: 
scalar performance:
{'acc': 0.8120125, 'precision': 0.8244459, 'recall': 0.8076956, 'specificity': 0.8076956, 'f1': 0.80844307, 'auroc': 0.8909794, 'binary_precision': 0.87829614, 'binary_recall': 0.7052117, 'binary_specificity': 0.9101796, 'binary_f1_score': 0.7822945}
confusion matrix:
     0    1
0  608   60
1  181  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78054297, 'precision': 0.7990658, 'recall': 0.78054297, 'specificity': 0.78054297, 'f1': 0.7770915, 'auroc': 0.87641525, 'binary_precision': 0.87349397, 'binary_recall': 0.6561086, 'binary_specificity': 0.9049774, 'binary_f1_score': 0.74935406}
confusion matrix:
     0    1
0  200   21
1   76  145
early stop counter: 13
val acc:0.8120124936103821, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 14,now: 2024-07-29 09:01:26.831803,epoch time: 0:01:38.557109,used: 0:23:16.806957,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.984127, 'precision': 0.9843124, 'recall': 0.98408103, 'specificity': 0.98408103, 'f1': 0.98412395, 'auroc': 0.99933684, 'binary_precision': 0.97606725, 'binary_recall': 0.99276316, 'binary_specificity': 0.97539896, 'binary_f1_score': 0.9843445}
confusion matrix:
      0     1
0  1467    37
1    11  1509
---- Validation: 
scalar performance:
{'acc': 0.8525741, 'precision': 0.86778575, 'recall': 0.84826356, 'specificity': 0.84826356, 'f1': 0.8497092, 'auroc': 0.93074024, 'binary_precision': 0.9327902, 'binary_recall': 0.74592835, 'binary_specificity': 0.9505988, 'binary_f1_score': 0.8289592}
confusion matrix:
     0    1
0  635   33
1  156  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8438914, 'precision': 0.87225175, 'recall': 0.8438914, 'specificity': 0.8438914, 'f1': 0.84086037, 'auroc': 0.92911696, 'binary_precision': 0.975, 'binary_recall': 0.7058824, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.81889766}
confusion matrix:
     0    1
0  217    4
1   65  156
early stop counter: 14
val acc:0.8525741100311279, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 15,now: 2024-07-29 09:03:06.547254,epoch time: 0:01:39.715451,used: 0:24:56.522408,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9864418, 'precision': 0.9865519, 'recall': 0.9864887, 'specificity': 0.9864887, 'f1': 0.9864416, 'auroc': 0.99946904, 'binary_precision': 0.99531144, 'binary_recall': 0.97763157, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.98639226}
confusion matrix:
      0     1
0  1497     7
1    34  1486
---- Validation: 
scalar performance:
{'acc': 0.7878315, 'precision': 0.8386299, 'recall': 0.77948904, 'specificity': 0.77948904, 'f1': 0.7758839, 'auroc': 0.93398, 'binary_precision': 0.9596774, 'binary_recall': 0.58143324, 'binary_specificity': 0.9775449, 'binary_f1_score': 0.72413796}
confusion matrix:
     0    1
0  653   15
1  257  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7692308, 'precision': 0.8286964, 'recall': 0.7692308, 'specificity': 0.7692308, 'f1': 0.758299, 'auroc': 0.9116316, 'binary_precision': 0.96850395, 'binary_recall': 0.5565611, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.70689654}
confusion matrix:
     0    1
0  217    4
1   98  123
early stop counter: 15
val acc:0.7878314852714539, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 16,now: 2024-07-29 09:04:45.475679,epoch time: 0:01:38.928425,used: 0:26:35.450833,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9890873, 'precision': 0.9891324, 'recall': 0.98912024, 'specificity': 0.98912024, 'f1': 0.9890872, 'auroc': 0.99894667, 'binary_precision': 0.9953364, 'binary_recall': 0.9828947, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.9890764}
confusion matrix:
      0     1
0  1497     7
1    26  1494
---- Validation: 
scalar performance:
{'acc': 0.80889237, 'precision': 0.8458647, 'recall': 0.80187106, 'specificity': 0.80187106, 'f1': 0.8008907, 'auroc': 0.92938715, 'binary_precision': 0.9489051, 'binary_recall': 0.63517916, 'binary_specificity': 0.9685629, 'binary_f1_score': 0.7609756}
confusion matrix:
     0    1
0  647   21
1  224  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.739819, 'precision': 0.8132489, 'recall': 0.739819, 'specificity': 0.739819, 'f1': 0.7236224, 'auroc': 0.92104995, 'binary_precision': 0.9649123, 'binary_recall': 0.49773756, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.65671647}
confusion matrix:
     0    1
0  217    4
1  111  110
early stop counter: 16
val acc:0.8088923692703247, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 17,now: 2024-07-29 09:06:27.229213,epoch time: 0:01:41.753534,used: 0:28:17.204367,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98015875, 'precision': 0.9806428, 'recall': 0.98024917, 'specificity': 0.98024917, 'f1': 0.98015594, 'auroc': 0.9984908, 'binary_precision': 0.99727523, 'binary_recall': 0.9631579, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9799197}
confusion matrix:
      0     1
0  1500     4
1    56  1464
---- Validation: 
scalar performance:
{'acc': 0.65834635, 'precision': 0.78660196, 'recall': 0.6437174, 'specificity': 0.6437174, 'f1': 0.60264206, 'auroc': 0.9285795, 'binary_precision': 0.9680851, 'binary_recall': 0.29641694, 'binary_specificity': 0.99101794, 'binary_f1_score': 0.45386532}
confusion matrix:
     0    1
0  662    6
1  432  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5248869, 'precision': 0.7563805, 'recall': 0.5248869, 'specificity': 0.5248869, 'f1': 0.38637084, 'auroc': 0.9253701, 'binary_precision': 1.0, 'binary_recall': 0.049773756, 'binary_specificity': 1.0, 'binary_f1_score': 0.094827585}
confusion matrix:
     0   1
0  221   0
1  210  11
early stop counter: 17
val acc:0.6583463549613953, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 18,now: 2024-07-29 09:08:06.250809,epoch time: 0:01:39.021596,used: 0:29:56.225963,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9867725, 'precision': 0.98691404, 'recall': 0.98682463, 'specificity': 0.98682463, 'f1': 0.98677224, 'auroc': 0.9993675, 'binary_precision': 0.9966443, 'binary_recall': 0.9769737, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.98671097}
confusion matrix:
      0     1
0  1499     5
1    35  1485
---- Validation: 
scalar performance:
{'acc': 0.82371294, 'precision': 0.85756147, 'recall': 0.8171458, 'specificity': 0.8171458, 'f1': 0.817087, 'auroc': 0.9372598, 'binary_precision': 0.9575472, 'binary_recall': 0.6612378, 'binary_specificity': 0.9730539, 'binary_f1_score': 0.78227365}
confusion matrix:
     0    1
0  650   18
1  208  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7692308, 'precision': 0.8385469, 'recall': 0.7692308, 'specificity': 0.7692308, 'f1': 0.7567812, 'auroc': 0.9389857, 'binary_precision': 0.9917355, 'binary_recall': 0.54298645, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.7017544}
confusion matrix:
     0    1
0  220    1
1  101  120
early stop counter: 18
val acc:0.823712944984436, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 19,now: 2024-07-29 09:09:44.476447,epoch time: 0:01:38.225638,used: 0:31:34.451601,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98710316, 'precision': 0.98712486, 'recall': 0.9870906, 'specificity': 0.9870906, 'f1': 0.98710245, 'auroc': 0.9992931, 'binary_precision': 0.9849378, 'binary_recall': 0.9894737, 'binary_specificity': 0.9847075, 'binary_f1_score': 0.98720056}
confusion matrix:
      0     1
0  1481    23
1    16  1504
---- Validation: 
scalar performance:
{'acc': 0.85881436, 'precision': 0.85959214, 'recall': 0.8576747, 'specificity': 0.8576747, 'f1': 0.8582485, 'auroc': 0.9239818, 'binary_precision': 0.86882454, 'binary_recall': 0.8306189, 'binary_specificity': 0.8847305, 'binary_f1_score': 0.8492923}
confusion matrix:
     0    1
0  591   77
1  104  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85294116, 'precision': 0.8532956, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.8529043, 'auroc': 0.9084171, 'binary_precision': 0.864486, 'binary_recall': 0.8371041, 'binary_specificity': 0.8687783, 'binary_f1_score': 0.85057473}
confusion matrix:
     0    1
0  192   29
1   36  185
early stop counter: 19
val acc:0.8588143587112427, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 20,now: 2024-07-29 09:11:17.969543,epoch time: 0:01:33.493096,used: 0:33:07.944697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98743385, 'precision': 0.98751646, 'recall': 0.9874755, 'specificity': 0.9874755, 'f1': 0.9874338, 'auroc': 0.9993942, 'binary_precision': 0.99532086, 'binary_recall': 0.97960526, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.98740053}
confusion matrix:
      0     1
0  1497     7
1    31  1489
---- Validation: 
scalar performance:
{'acc': 0.67472696, 'precision': 0.78587866, 'recall': 0.66108173, 'specificity': 0.66108173, 'f1': 0.62878585, 'auroc': 0.9086802, 'binary_precision': 0.953917, 'binary_recall': 0.33713356, 'binary_specificity': 0.98502994, 'binary_f1_score': 0.49819493}
confusion matrix:
     0    1
0  658   10
1  407  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72624433, 'precision': 0.80633175, 'recall': 0.72624433, 'specificity': 0.72624433, 'f1': 0.7071004, 'auroc': 0.92230916, 'binary_precision': 0.962963, 'binary_recall': 0.47058824, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.6322189}
confusion matrix:
     0    1
0  217    4
1  117  104
early stop counter: 20
val acc:0.6747269630432129, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 21,now: 2024-07-29 09:12:49.190595,epoch time: 0:01:31.221052,used: 0:34:39.165749,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.9865174, 'recall': 0.9860407, 'specificity': 0.9860407, 'f1': 0.9861063, 'auroc': 0.9998145, 'binary_precision': 0.9737179, 'binary_recall': 0.9993421, 'binary_specificity': 0.97273934, 'binary_f1_score': 0.9863636}
confusion matrix:
      0     1
0  1463    41
1     1  1519
---- Validation: 
scalar performance:
{'acc': 0.8369735, 'precision': 0.84621084, 'recall': 0.83342516, 'specificity': 0.83342516, 'f1': 0.8346179, 'auroc': 0.9114816, 'binary_precision': 0.89320385, 'binary_recall': 0.7491857, 'binary_specificity': 0.91766465, 'binary_f1_score': 0.81488043}
confusion matrix:
     0    1
0  613   55
1  154  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80995476, 'precision': 0.82274806, 'recall': 0.80995476, 'specificity': 0.80995476, 'f1': 0.80805266, 'auroc': 0.90172195, 'binary_precision': 0.8870056, 'binary_recall': 0.71040726, 'binary_specificity': 0.90950227, 'binary_f1_score': 0.7889448}
confusion matrix:
     0    1
0  201   20
1   64  157
early stop counter: 21
val acc:0.8369734883308411, best validation acc: 0.8642745614051819, corresponding to test acc:                         0.8665158152580261 / 0.8665158152580261
after epoch: 22,now: 2024-07-29 09:14:28.567724,epoch time: 0:01:39.377129,used: 0:36:18.542878,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9887566, 'precision': 0.98887527, 'recall': 0.9887213, 'specificity': 0.9887213, 'f1': 0.988755, 'auroc': 0.9996855, 'binary_precision': 0.98246753, 'binary_recall': 0.99539477, 'binary_specificity': 0.98204786, 'binary_f1_score': 0.9888889}
confusion matrix:
      0     1
0  1477    27
1     7  1513
---- Validation: 
scalar performance:
{'acc': 0.8829953, 'precision': 0.8884053, 'recall': 0.8805492, 'specificity': 0.8805492, 'f1': 0.88192606, 'auroc': 0.93765235, 'binary_precision': 0.9249084, 'binary_recall': 0.82247555, 'binary_specificity': 0.9386228, 'binary_f1_score': 0.87068963}
confusion matrix:
     0    1
0  627   41
1  109  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87782806, 'precision': 0.89342284, 'recall': 0.87782806, 'specificity': 0.87782806, 'f1': 0.8766053, 'auroc': 0.9416679, 'binary_precision': 0.9717514, 'binary_recall': 0.77828056, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.8643216}
confusion matrix:
     0    1
0  216    5
1   49  172
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-29 09:16:07.242856,epoch time: 0:01:38.675132,used: 0:37:57.218010,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98214287, 'precision': 0.9824416, 'recall': 0.98208284, 'specificity': 0.98208284, 'f1': 0.982138, 'auroc': 0.99945843, 'binary_precision': 0.97168595, 'binary_recall': 0.9934211, 'binary_specificity': 0.97074467, 'binary_f1_score': 0.9824333}
confusion matrix:
      0     1
0  1460    44
1    10  1510
---- Validation: 
scalar performance:
{'acc': 0.81591266, 'precision': 0.82221335, 'recall': 0.8127548, 'specificity': 0.8127548, 'f1': 0.81369084, 'auroc': 0.89603615, 'binary_precision': 0.85795456, 'binary_recall': 0.73778504, 'binary_specificity': 0.8877246, 'binary_f1_score': 0.7933451}
confusion matrix:
     0    1
0  593   75
1  161  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8687783, 'precision': 0.86905026, 'recall': 0.8687783, 'specificity': 0.8687783, 'f1': 0.868754, 'auroc': 0.9333142, 'binary_precision': 0.87906975, 'binary_recall': 0.8552036, 'binary_specificity': 0.88235295, 'binary_f1_score': 0.8669724}
confusion matrix:
     0    1
0  195   26
1   32  189
early stop counter: 1
val acc:0.815912663936615, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 24,now: 2024-07-29 09:17:54.282594,epoch time: 0:01:47.039738,used: 0:39:44.257748,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9864418, 'precision': 0.9867314, 'recall': 0.98651314, 'specificity': 0.98651314, 'f1': 0.9864409, 'auroc': 0.9996181, 'binary_precision': 1.0, 'binary_recall': 0.97302634, 'binary_specificity': 1.0, 'binary_f1_score': 0.98632884}
confusion matrix:
      0     1
0  1504     0
1    41  1479
---- Validation: 
scalar performance:
{'acc': 0.624025, 'precision': 0.76397824, 'recall': 0.60801846, 'specificity': 0.60801846, 'f1': 0.5499868, 'auroc': 0.91664124, 'binary_precision': 0.9459459, 'binary_recall': 0.22801302, 'binary_specificity': 0.98802394, 'binary_f1_score': 0.36745408}
confusion matrix:
     0    1
0  660    8
1  474  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51357466, 'precision': 0.7534404, 'recall': 0.51357466, 'specificity': 0.51357466, 'f1': 0.36280918, 'auroc': 0.94328535, 'binary_precision': 1.0, 'binary_recall': 0.027149322, 'binary_specificity': 1.0, 'binary_f1_score': 0.052863438}
confusion matrix:
     0  1
0  221  0
1  215  6
early stop counter: 2
val acc:0.6240249872207642, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 25,now: 2024-07-29 09:19:32.786820,epoch time: 0:01:38.504226,used: 0:41:22.761974,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9880952, 'precision': 0.9882851, 'recall': 0.9881544, 'specificity': 0.9881544, 'f1': 0.98809487, 'auroc': 0.9998522, 'binary_precision': 0.99932706, 'binary_recall': 0.9769737, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.988024}
confusion matrix:
      0     1
0  1503     1
1    35  1485
---- Validation: 
scalar performance:
{'acc': 0.5405616, 'precision': 0.73127943, 'recall': 0.52049, 'specificity': 0.52049, 'f1': 0.3886851, 'auroc': 0.86337745, 'binary_precision': 0.9310345, 'binary_recall': 0.04397394, 'binary_specificity': 0.997006, 'binary_f1_score': 0.08398134}
confusion matrix:
     0   1
0  666   2
1  587  27
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49773756, 'precision': 0.2494331, 'recall': 0.49773756, 'specificity': 0.49773756, 'f1': 0.33232626, 'auroc': 0.8809197, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  220  1
1  221  0
early stop counter: 3
val acc:0.5405616164207458, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 26,now: 2024-07-29 09:21:13.654669,epoch time: 0:01:40.867849,used: 0:43:03.629823,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9861111, 'precision': 0.98619163, 'recall': 0.98608273, 'specificity': 0.98608273, 'f1': 0.98610955, 'auroc': 0.9992336, 'binary_precision': 0.9811198, 'binary_recall': 0.9914474, 'binary_specificity': 0.9807181, 'binary_f1_score': 0.98625654}
confusion matrix:
      0     1
0  1475    29
1    13  1507
---- Validation: 
scalar performance:
{'acc': 0.8455538, 'precision': 0.8515365, 'recall': 0.8427119, 'specificity': 0.8427119, 'f1': 0.8438989, 'auroc': 0.9206124, 'binary_precision': 0.8880597, 'binary_recall': 0.7752443, 'binary_specificity': 0.9101796, 'binary_f1_score': 0.8278261}
confusion matrix:
     0    1
0  608   60
1  138  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87782806, 'precision': 0.8793504, 'recall': 0.87782806, 'specificity': 0.87782806, 'f1': 0.87770534, 'auroc': 0.93362135, 'binary_precision': 0.90338165, 'binary_recall': 0.84615386, 'binary_specificity': 0.90950227, 'binary_f1_score': 0.8738318}
confusion matrix:
     0    1
0  201   20
1   34  187
early stop counter: 4
val acc:0.8455538153648376, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 27,now: 2024-07-29 09:22:52.320360,epoch time: 0:01:38.665691,used: 0:44:42.295514,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9943783, 'precision': 0.99441105, 'recall': 0.99436235, 'specificity': 0.99436235, 'f1': 0.99437785, 'auroc': 0.99983466, 'binary_precision': 0.9914977, 'binary_recall': 0.9973684, 'binary_specificity': 0.9913564, 'binary_f1_score': 0.99442434}
confusion matrix:
      0     1
0  1491    13
1     4  1516
---- Validation: 
scalar performance:
{'acc': 0.8619345, 'precision': 0.86362094, 'recall': 0.86040545, 'specificity': 0.86040545, 'f1': 0.8612041, 'auroc': 0.9255471, 'binary_precision': 0.88, 'binary_recall': 0.82410425, 'binary_specificity': 0.8967066, 'binary_f1_score': 0.85113543}
confusion matrix:
     0    1
0  599   69
1  108  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81900454, 'precision': 0.8234818, 'recall': 0.81900454, 'specificity': 0.81900454, 'f1': 0.81837606, 'auroc': 0.9022542, 'binary_precision': 0.86153847, 'binary_recall': 0.760181, 'binary_specificity': 0.87782806, 'binary_f1_score': 0.8076923}
confusion matrix:
     0    1
0  194   27
1   53  168
early stop counter: 5
val acc:0.8619344830513, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 28,now: 2024-07-29 09:24:28.942579,epoch time: 0:01:36.622219,used: 0:46:18.917733,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9917328, 'precision': 0.991766, 'recall': 0.99176234, 'specificity': 0.99176234, 'f1': 0.99173284, 'auroc': 0.99958664, 'binary_precision': 0.99733865, 'binary_recall': 0.98618424, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9917301}
confusion matrix:
      0     1
0  1500     4
1    21  1499
---- Validation: 
scalar performance:
{'acc': 0.8439938, 'precision': 0.8599479, 'recall': 0.8395034, 'specificity': 0.8395034, 'f1': 0.8407849, 'auroc': 0.9321166, 'binary_precision': 0.9259259, 'binary_recall': 0.732899, 'binary_specificity': 0.9461078, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  632   36
1  164  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81447965, 'precision': 0.82626337, 'recall': 0.81447965, 'specificity': 0.81447965, 'f1': 0.81278926, 'auroc': 0.89159214, 'binary_precision': 0.8882682, 'binary_recall': 0.71945703, 'binary_specificity': 0.90950227, 'binary_f1_score': 0.7950001}
confusion matrix:
     0    1
0  201   20
1   62  159
early stop counter: 6
val acc:0.8439937829971313, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 29,now: 2024-07-29 09:26:03.643568,epoch time: 0:01:34.700989,used: 0:47:53.618722,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9917328, 'precision': 0.9918064, 'recall': 0.9917064, 'specificity': 0.9917064, 'f1': 0.99173194, 'auroc': 0.99972004, 'binary_precision': 0.98697066, 'binary_recall': 0.99671054, 'binary_specificity': 0.98670214, 'binary_f1_score': 0.9918167}
confusion matrix:
      0     1
0  1484    20
1     5  1515
---- Validation: 
scalar performance:
{'acc': 0.84321374, 'precision': 0.85348153, 'recall': 0.8395449, 'specificity': 0.8395449, 'f1': 0.8408265, 'auroc': 0.9180255, 'binary_precision': 0.9041096, 'binary_recall': 0.752443, 'binary_specificity': 0.9266467, 'binary_f1_score': 0.82133335}
confusion matrix:
     0    1
0  619   49
1  152  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.800905, 'precision': 0.83445984, 'recall': 0.800905, 'specificity': 0.800905, 'f1': 0.7957829, 'auroc': 0.92745847, 'binary_precision': 0.9403973, 'binary_recall': 0.64253396, 'binary_specificity': 0.959276, 'binary_f1_score': 0.76344085}
confusion matrix:
     0    1
0  212    9
1   79  142
early stop counter: 7
val acc:0.8432137370109558, best validation acc: 0.8829953074455261, corresponding to test acc:                         0.877828061580658 / 0.877828061580658
after epoch: 30,now: 2024-07-29 09:27:40.363948,epoch time: 0:01:36.720380,used: 0:49:30.339102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_38_09_seed_10_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:30.339102 at 2024-07-29 09:27:40.363948
persisted model performance metric: 

scalar performance:
{'acc': 0.87782806, 'precision': 0.89342284, 'recall': 0.87782806, 'specificity': 0.87782806, 'f1': 0.8766053, 'auroc': 0.9416679, 'binary_precision': 0.9717514, 'binary_recall': 0.77828056, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.8643216}
confusion matrix:
     0    1
0  216    5
1   49  172
oracle model performance metric: 

scalar performance:
{'acc': 0.87782806, 'precision': 0.89342284, 'recall': 0.87782806, 'specificity': 0.87782806, 'f1': 0.8766053, 'auroc': 0.9416679, 'binary_precision': 0.9717514, 'binary_recall': 0.77828056, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.8643216}
confusion matrix:
     0    1
0  216    5
1   49  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454147 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool | 413552 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |  40595 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454147 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool | 413552 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |  40595 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |  40406 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14488 MiB | 150276 MiB | 135798 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 150050 MiB | 135638 MiB |
|       from small pool |     66 MiB |     70 MiB |    226 MiB |    160 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 438780 KiB |   1260 MiB | 576489 GiB | 576489 GiB |
|       from large pool | 426128 KiB |   1256 MiB | 566822 GiB | 566822 GiB |
|       from small pool |  12652 KiB |     47 MiB |   9666 GiB |   9666 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  142887 K  |  142886 K  |
|       from large pool |     187    |    1413    |   72670 K  |   72670 K  |
|       from small pool |    1117    |    1419    |   70216 K  |   70215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  142887 K  |  142886 K  |
|       from large pool |     187    |    1413    |   72670 K  |   72670 K  |
|       from small pool |    1117    |    1419    |   70216 K  |   70215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    6354    |    5718    |
|       from large pool |     603    |     603    |    6241    |    5638    |
|       from small pool |      33    |      35    |     113    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     654    |   95839 K  |   95839 K  |
|       from large pool |      37    |     608    |   54700 K  |   54700 K  |
|       from small pool |      61    |     236    |   41138 K  |   41138 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |  14488 MiB | 150276 MiB | 149404 MiB |
|       from large pool |    820 MiB |  14424 MiB | 150050 MiB | 149230 MiB |
|       from small pool |     52 MiB |     70 MiB |    226 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 576489 GiB | 576489 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 566823 GiB | 566823 GiB |
|       from small pool |      0 KiB |     47 MiB |   9666 GiB |   9666 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  142887 K  |  142887 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70216 K  |   70216 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  142887 K  |  142887 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70216 K  |   70216 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    6354    |    6290    |
|       from large pool |      38    |     603    |    6241    |    6203    |
|       from small pool |      26    |      35    |     113    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |   95839 K  |   95839 K  |
|       from large pool |       3    |     608    |   54700 K  |   54700 K  |
|       from small pool |       0    |     236    |   41138 K  |   41138 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    872 MiB |  14488 MiB | 150276 MiB | 149404 MiB |
|       from large pool |    820 MiB |  14424 MiB | 150050 MiB | 149230 MiB |
|       from small pool |     52 MiB |     70 MiB |    226 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 576489 GiB | 576489 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 566823 GiB | 566823 GiB |
|       from small pool |      0 KiB |     47 MiB |   9666 GiB |   9666 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  142887 K  |  142887 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70216 K  |   70216 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  142887 K  |  142887 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70216 K  |   70216 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    6354    |    6290    |
|       from large pool |      38    |     603    |    6241    |    6203    |
|       from small pool |      26    |      35    |     113    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |   95839 K  |   95839 K  |
|       from large pool |       3    |     608    |   54700 K  |   54700 K  |
|       from small pool |       0    |     236    |   41138 K  |   41138 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368

 Experiment start at: 2024-07-29 09:28:24.969365
before training, model accuracy: 0.5371178984642029
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554974, 'precision': 0.95677364, 'recall': 0.95609725, 'specificity': 0.95609725, 'f1': 0.9554912, 'auroc': 0.99370533, 'binary_precision': 0.98632014, 'binary_recall': 0.9255456, 'binary_specificity': 0.98664886, 'binary_f1_score': 0.9549669}
confusion matrix:
      0     1
0  1478    20
1   116  1442
---- Validation: 
scalar performance:
{'acc': 0.82411677, 'precision': 0.83021295, 'recall': 0.82205975, 'specificity': 0.82205975, 'f1': 0.8225329, 'auroc': 0.8865223, 'binary_precision': 0.8683729, 'binary_recall': 0.75158226, 'binary_specificity': 0.8925373, 'binary_f1_score': 0.8057676}
confusion matrix:
     0    1
0  598   72
1  157  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.86129665, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.85535455, 'auroc': 0.9177361, 'binary_precision': 0.90547264, 'binary_recall': 0.7947598, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8465116}
confusion matrix:
     0    1
0  210   19
1   47  182
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 09:30:14.974559,epoch time: 0:01:50.005194,used: 0:01:50.005194,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9620419, 'precision': 0.96353364, 'recall': 0.96268284, 'specificity': 0.96268284, 'f1': 0.9620347, 'auroc': 0.9962209, 'binary_precision': 0.9951923, 'binary_recall': 0.9300385, 'binary_specificity': 0.9953271, 'binary_f1_score': 0.961513}
confusion matrix:
      0     1
0  1491     7
1   109  1449
---- Validation: 
scalar performance:
{'acc': 0.77265745, 'precision': 0.7999984, 'recall': 0.76811117, 'specificity': 0.76811117, 'f1': 0.76520246, 'auroc': 0.861076, 'binary_precision': 0.8835617, 'binary_recall': 0.61234176, 'binary_specificity': 0.9238806, 'binary_f1_score': 0.7233645}
confusion matrix:
     0    1
0  619   51
1  245  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.86867833, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8642561, 'auroc': 0.9221792, 'binary_precision': 0.9073171, 'binary_recall': 0.8122271, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  210   19
1   43  186
new oracle model saved
early stop counter: 1
val acc:0.7726574540138245, best validation acc: 0.8241167664527893, corresponding to test acc:                         0.8558952212333679 / 0.864628791809082
after epoch: 2,now: 2024-07-29 09:31:55.720879,epoch time: 0:01:40.746320,used: 0:03:30.751514,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98686755, 'recall': 0.9870345, 'specificity': 0.9870345, 'f1': 0.98690873, 'auroc': 0.9977925, 'binary_precision': 0.993498, 'binary_recall': 0.98074454, 'binary_specificity': 0.99332446, 'binary_f1_score': 0.98708004}
confusion matrix:
      0     1
0  1488    10
1    30  1528
---- Validation: 
scalar performance:
{'acc': 0.8294931, 'precision': 0.84660494, 'recall': 0.8262068, 'specificity': 0.8262068, 'f1': 0.82624555, 'auroc': 0.9020877, 'binary_precision': 0.9166667, 'binary_recall': 0.7136076, 'binary_specificity': 0.938806, 'binary_f1_score': 0.80249107}
confusion matrix:
     0    1
0  629   41
1  181  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8580786, 'precision': 0.867677, 'recall': 0.8580786, 'specificity': 0.8580786, 'f1': 0.85714626, 'auroc': 0.9278809, 'binary_precision': 0.9270833, 'binary_recall': 0.77729255, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.8456057}
confusion matrix:
     0    1
0  215   14
1   51  178
better model found
persisted
after epoch: 3,now: 2024-07-29 09:33:34.652895,epoch time: 0:01:38.932016,used: 0:05:09.683530,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97855157, 'recall': 0.9786598, 'specificity': 0.9786598, 'f1': 0.9784028, 'auroc': 0.9981799, 'binary_precision': 0.9927249, 'binary_recall': 0.96465296, 'binary_specificity': 0.99266666, 'binary_f1_score': 0.97848755}
confusion matrix:
      0     1
0  1489    11
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.8110599, 'precision': 0.8401995, 'recall': 0.80672586, 'specificity': 0.80672586, 'f1': 0.8052969, 'auroc': 0.90464056, 'binary_precision': 0.93273544, 'binary_recall': 0.65822786, 'binary_specificity': 0.95522386, 'binary_f1_score': 0.7717996}
confusion matrix:
     0    1
0  640   30
1  216  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275109, 'precision': 0.8581707, 'recall': 0.82751095, 'specificity': 0.82751095, 'f1': 0.8237389, 'auroc': 0.91283536, 'binary_precision': 0.962963, 'binary_recall': 0.68122274, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.79795396}
confusion matrix:
     0    1
0  223    6
1   73  156
early stop counter: 1
val acc:0.8110598921775818, best validation acc: 0.8294931054115295, corresponding to test acc:                         0.8580785989761353 / 0.864628791809082
after epoch: 4,now: 2024-07-29 09:35:11.640488,epoch time: 0:01:36.987593,used: 0:06:46.671123,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9846206, 'recall': 0.98460746, 'specificity': 0.98460746, 'f1': 0.9846139, 'auroc': 0.99904275, 'binary_precision': 0.9846154, 'binary_recall': 0.98524696, 'binary_specificity': 0.98396796, 'binary_f1_score': 0.98493105}
confusion matrix:
      0     1
0  1473    24
1    23  1536
---- Validation: 
scalar performance:
{'acc': 0.8463902, 'precision': 0.8526136, 'recall': 0.8444195, 'specificity': 0.8444195, 'f1': 0.8450742, 'auroc': 0.8923838, 'binary_precision': 0.89272726, 'binary_recall': 0.77689874, 'binary_specificity': 0.9119403, 'binary_f1_score': 0.8307953}
confusion matrix:
     0    1
0  611   59
1  141  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.8670955, 'recall': 0.8558952, 'specificity': 0.8558952, 'f1': 0.8547876, 'auroc': 0.9332202, 'binary_precision': 0.93121696, 'binary_recall': 0.768559, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  216   13
1   53  176
better model found
persisted
after epoch: 5,now: 2024-07-29 09:36:46.416751,epoch time: 0:01:34.776263,used: 0:08:21.447386,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.97760403, 'recall': 0.977496, 'specificity': 0.977496, 'f1': 0.97709405, 'auroc': 0.99753594, 'binary_precision': 0.9986586, 'binary_recall': 0.95632625, 'binary_specificity': 0.99866575, 'binary_f1_score': 0.9770341}
confusion matrix:
      0     1
0  1497     2
1    68  1489
---- Validation: 
scalar performance:
{'acc': 0.5430108, 'precision': 0.7300091, 'recall': 0.5294068, 'specificity': 0.5294068, 'f1': 0.40503427, 'auroc': 0.81407344, 'binary_precision': 0.9302326, 'binary_recall': 0.06329114, 'binary_specificity': 0.9955224, 'binary_f1_score': 0.11851852}
confusion matrix:
     0   1
0  667   3
1  592  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57641923, 'precision': 0.75727034, 'recall': 0.57641923, 'specificity': 0.57641923, 'f1': 0.48610753, 'auroc': 0.85766864, 'binary_precision': 0.972973, 'binary_recall': 0.15720524, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.2706767}
confusion matrix:
     0   1
0  228   1
1  193  36
early stop counter: 1
val acc:0.5430107712745667, best validation acc: 0.8463901877403259, corresponding to test acc:                         0.8558952212333679 / 0.864628791809082
after epoch: 6,now: 2024-07-29 09:38:27.944079,epoch time: 0:01:41.527328,used: 0:10:02.974714,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9875735, 'recall': 0.9875493, 'specificity': 0.9875493, 'f1': 0.987561, 'auroc': 0.99917436, 'binary_precision': 0.987163, 'binary_recall': 0.9884319, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.987797}
confusion matrix:
      0     1
0  1480    20
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.82411677, 'precision': 0.82401913, 'recall': 0.82385457, 'specificity': 0.82385457, 'f1': 0.82392466, 'auroc': 0.8814188, 'binary_precision': 0.8213716, 'binary_recall': 0.8148734, 'binary_specificity': 0.8328358, 'binary_f1_score': 0.81810963}
confusion matrix:
     0    1
0  558  112
1  117  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8738684, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8637872, 'auroc': 0.9250396, 'binary_precision': 0.93264246, 'binary_recall': 0.7860262, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.8530805}
confusion matrix:
     0    1
0  216   13
1   49  180
early stop counter: 2
val acc:0.8241167664527893, best validation acc: 0.8463901877403259, corresponding to test acc:                         0.8558952212333679 / 0.864628791809082
after epoch: 7,now: 2024-07-29 09:40:10.221506,epoch time: 0:01:42.277427,used: 0:11:45.252141,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97916555, 'recall': 0.97897005, 'specificity': 0.97897005, 'f1': 0.97904724, 'auroc': 0.9977113, 'binary_precision': 0.97514343, 'binary_recall': 0.98392284, 'binary_specificity': 0.9740173, 'binary_f1_score': 0.97951347}
confusion matrix:
      0     1
0  1462    39
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.73348695, 'precision': 0.7614974, 'recall': 0.728481, 'specificity': 0.728481, 'f1': 0.72319984, 'auroc': 0.8222841, 'binary_precision': 0.84009546, 'binary_recall': 0.556962, 'binary_specificity': 0.9, 'binary_f1_score': 0.6698382}
confusion matrix:
     0    1
0  603   67
1  280  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.82872987, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.8148854, 'auroc': 0.883183, 'binary_precision': 0.8918919, 'binary_recall': 0.720524, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.79710144}
confusion matrix:
     0    1
0  209   20
1   64  165
early stop counter: 3
val acc:0.7334869503974915, best validation acc: 0.8463901877403259, corresponding to test acc:                         0.8558952212333679 / 0.864628791809082
after epoch: 8,now: 2024-07-29 09:41:46.567610,epoch time: 0:01:36.346104,used: 0:13:21.598245,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.9788759, 'recall': 0.97862124, 'specificity': 0.97862124, 'f1': 0.9787182, 'auroc': 0.99780774, 'binary_precision': 0.9739351, 'binary_recall': 0.9845758, 'binary_specificity': 0.9726667, 'binary_f1_score': 0.9792266}
confusion matrix:
      0     1
0  1459    41
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.8486943, 'precision': 0.84947246, 'recall': 0.84944034, 'specificity': 0.84944034, 'f1': 0.8486942, 'auroc': 0.9131731, 'binary_precision': 0.82414305, 'binary_recall': 0.875, 'binary_specificity': 0.8238806, 'binary_f1_score': 0.84881043}
confusion matrix:
     0    1
0  552  118
1   79  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.84433746, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.8377317, 'auroc': 0.9271753, 'binary_precision': 0.7992278, 'binary_recall': 0.9039301, 'binary_specificity': 0.77292573, 'binary_f1_score': 0.84836066}
confusion matrix:
     0    1
0  177   52
1   22  207
better model found
persisted
after epoch: 9,now: 2024-07-29 09:43:31.429093,epoch time: 0:01:44.861483,used: 0:15:06.459728,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98203063, 'recall': 0.9819635, 'specificity': 0.9819635, 'f1': 0.9819945, 'auroc': 0.99878144, 'binary_precision': 0.9808061, 'binary_recall': 0.9839538, 'binary_specificity': 0.9799733, 'binary_f1_score': 0.9823774}
confusion matrix:
      0     1
0  1468    30
1    25  1533
---- Validation: 
scalar performance:
{'acc': 0.75960064, 'precision': 0.8071177, 'recall': 0.75371957, 'specificity': 0.75371957, 'f1': 0.7469605, 'auroc': 0.866673, 'binary_precision': 0.9208443, 'binary_recall': 0.5522152, 'binary_specificity': 0.95522386, 'binary_f1_score': 0.6904056}
confusion matrix:
     0    1
0  640   30
1  283  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79257643, 'precision': 0.85036075, 'recall': 0.79257643, 'specificity': 0.79257643, 'f1': 0.7836561, 'auroc': 0.9361187, 'binary_precision': 0.99264705, 'binary_recall': 0.5895197, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.7397261}
confusion matrix:
     0    1
0  228    1
1   94  135
early stop counter: 1
val acc:0.7596006393432617, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.864628791809082
after epoch: 10,now: 2024-07-29 09:45:06.251703,epoch time: 0:01:34.822610,used: 0:16:41.282338,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.988829, 'recall': 0.98896974, 'specificity': 0.98896974, 'f1': 0.9888722, 'auroc': 0.99922323, 'binary_precision': 0.99415964, 'binary_recall': 0.98394346, 'binary_specificity': 0.993996, 'binary_f1_score': 0.9890251}
confusion matrix:
      0     1
0  1490     9
1    25  1532
---- Validation: 
scalar performance:
{'acc': 0.8033794, 'precision': 0.8380472, 'recall': 0.798635, 'specificity': 0.798635, 'f1': 0.7963437, 'auroc': 0.90065885, 'binary_precision': 0.9392523, 'binary_recall': 0.636076, 'binary_specificity': 0.96119404, 'binary_f1_score': 0.75849056}
confusion matrix:
     0    1
0  644   26
1  230  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122271, 'precision': 0.8556287, 'recall': 0.8122271, 'specificity': 0.8122271, 'f1': 0.80631775, 'auroc': 0.92797625, 'binary_precision': 0.9798658, 'binary_recall': 0.6375546, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7724868}
confusion matrix:
     0    1
0  226    3
1   83  146
early stop counter: 2
val acc:0.8033794164657593, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.864628791809082
after epoch: 11,now: 2024-07-29 09:46:47.903621,epoch time: 0:01:41.651918,used: 0:18:22.934256,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.9781637, 'recall': 0.9767132, 'specificity': 0.9767132, 'f1': 0.97706, 'auroc': 0.9993582, 'binary_precision': 0.9598021, 'binary_recall': 0.9967887, 'binary_specificity': 0.95663774, 'binary_f1_score': 0.9779458}
confusion matrix:
      0     1
0  1434    65
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.8371736, 'precision': 0.83759964, 'recall': 0.8377527, 'specificity': 0.8377527, 'f1': 0.8371701, 'auroc': 0.899053, 'binary_precision': 0.81626505, 'binary_recall': 0.8575949, 'binary_specificity': 0.81791043, 'binary_f1_score': 0.8364197}
confusion matrix:
     0    1
0  548  122
1   90  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8664175, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.86446345, 'auroc': 0.9413817, 'binary_precision': 0.8920188, 'binary_recall': 0.82969433, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.8597286}
confusion matrix:
     0    1
0  206   23
1   39  190
early stop counter: 3
val acc:0.837173581123352, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.864628791809082
after epoch: 12,now: 2024-07-29 09:48:24.682742,epoch time: 0:01:36.779121,used: 0:19:59.713377,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9865503, 'recall': 0.98608416, 'specificity': 0.98608416, 'f1': 0.98624563, 'auroc': 0.999482, 'binary_precision': 0.97853535, 'binary_recall': 0.99486524, 'binary_specificity': 0.9773031, 'binary_f1_score': 0.9866327}
confusion matrix:
      0     1
0  1464    34
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.8456221, 'precision': 0.8458537, 'recall': 0.8460963, 'specificity': 0.8460963, 'f1': 0.8456111, 'auroc': 0.91330767, 'binary_precision': 0.82701063, 'binary_recall': 0.86234176, 'binary_specificity': 0.82985073, 'binary_f1_score': 0.84430677}
confusion matrix:
     0    1
0  556  114
1   87  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8908297, 'precision': 0.89963925, 'recall': 0.8908297, 'specificity': 0.8908297, 'f1': 0.8902247, 'auroc': 0.9496386, 'binary_precision': 0.95897436, 'binary_recall': 0.8165939, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8820755}
confusion matrix:
     0    1
0  221    8
1   42  187
new oracle model saved
early stop counter: 4
val acc:0.8456221222877502, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 13,now: 2024-07-29 09:50:06.862714,epoch time: 0:01:42.179972,used: 0:21:41.893349,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885363, 'recall': 0.98854905, 'specificity': 0.98854905, 'f1': 0.98854256, 'auroc': 0.99933374, 'binary_precision': 0.9890886, 'binary_recall': 0.98845416, 'binary_specificity': 0.98864394, 'binary_f1_score': 0.9887713}
confusion matrix:
      0     1
0  1480    17
1    18  1541
---- Validation: 
scalar performance:
{'acc': 0.765745, 'precision': 0.79775596, 'recall': 0.76081145, 'specificity': 0.76081145, 'f1': 0.75685203, 'auroc': 0.8612838, 'binary_precision': 0.88836104, 'binary_recall': 0.59177214, 'binary_specificity': 0.92985076, 'binary_f1_score': 0.71035135}
confusion matrix:
     0    1
0  623   47
1  258  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87117904, 'precision': 0.89569443, 'recall': 0.87117904, 'specificity': 0.87117904, 'f1': 0.86915237, 'auroc': 0.94448996, 'binary_precision': 0.99418604, 'binary_recall': 0.7467249, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.8528678}
confusion matrix:
     0    1
0  228    1
1   58  171
early stop counter: 5
val acc:0.7657449841499329, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 14,now: 2024-07-29 09:51:46.193561,epoch time: 0:01:39.330847,used: 0:23:21.224196,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.99215686, 'recall': 0.9921307, 'specificity': 0.9921307, 'f1': 0.9921434, 'auroc': 0.9997635, 'binary_precision': 0.9916667, 'binary_recall': 0.99293965, 'binary_specificity': 0.99132174, 'binary_f1_score': 0.9923028}
confusion matrix:
      0     1
0  1485    13
1    11  1547
---- Validation: 
scalar performance:
{'acc': 0.78187406, 'precision': 0.820379, 'recall': 0.7767074, 'specificity': 0.7767074, 'f1': 0.7728145, 'auroc': 0.8952036, 'binary_precision': 0.92439026, 'binary_recall': 0.5996835, 'binary_specificity': 0.95373136, 'binary_f1_score': 0.7274472}
confusion matrix:
     0    1
0  639   31
1  253  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76637554, 'precision': 0.8246189, 'recall': 0.76637554, 'specificity': 0.76637554, 'f1': 0.7554042, 'auroc': 0.9183272, 'binary_precision': 0.9621212, 'binary_recall': 0.55458516, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.7036011}
confusion matrix:
     0    1
0  224    5
1  102  127
early stop counter: 6
val acc:0.7818740606307983, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 15,now: 2024-07-29 09:53:23.670501,epoch time: 0:01:37.476940,used: 0:24:58.701136,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98792577, 'recall': 0.9880618, 'specificity': 0.9880618, 'f1': 0.9878921, 'auroc': 0.9992943, 'binary_precision': 0.9980302, 'binary_recall': 0.978121, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.98797524}
confusion matrix:
      0     1
0  1499     3
1    34  1520
---- Validation: 
scalar performance:
{'acc': 0.7058372, 'precision': 0.79472923, 'recall': 0.6976218, 'specificity': 0.6976218, 'f1': 0.6763496, 'auroc': 0.8992673, 'binary_precision': 0.9494585, 'binary_recall': 0.41613925, 'binary_specificity': 0.97910446, 'binary_f1_score': 0.57865787}
confusion matrix:
     0    1
0  656   14
1  369  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7379913, 'precision': 0.82808024, 'recall': 0.7379913, 'specificity': 0.7379913, 'f1': 0.71867895, 'auroc': 0.9424448, 'binary_precision': 1.0, 'binary_recall': 0.47598255, 'binary_specificity': 1.0, 'binary_f1_score': 0.6449704}
confusion matrix:
     0    1
0  229    0
1  120  109
early stop counter: 7
val acc:0.7058371901512146, best validation acc: 0.8486943244934082, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 16,now: 2024-07-29 09:55:07.534607,epoch time: 0:01:43.864106,used: 0:26:42.565242,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98944104, 'recall': 0.98906, 'specificity': 0.98906, 'f1': 0.9891943, 'auroc': 0.99987495, 'binary_precision': 0.98226726, 'binary_recall': 0.99678665, 'binary_specificity': 0.9813333, 'binary_f1_score': 0.98947364}
confusion matrix:
      0     1
0  1472    28
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.8686636, 'precision': 0.87081283, 'recall': 0.867542, 'specificity': 0.867542, 'f1': 0.8681277, 'auroc': 0.91021395, 'binary_precision': 0.8926746, 'binary_recall': 0.8291139, 'binary_specificity': 0.90597016, 'binary_f1_score': 0.85972106}
confusion matrix:
     0    1
0  607   63
1  108  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.87407184, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.8589603, 'auroc': 0.9297496, 'binary_precision': 0.9459459, 'binary_recall': 0.76419216, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.84541065}
confusion matrix:
     0    1
0  219   10
1   54  175
better model found
persisted
after epoch: 17,now: 2024-07-29 09:56:49.365990,epoch time: 0:01:41.831383,used: 0:28:24.396625,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9554974, 'precision': 0.9584352, 'recall': 0.95629823, 'specificity': 0.95629823, 'f1': 0.95546687, 'auroc': 0.999488, 'binary_precision': 1.0, 'binary_recall': 0.9125964, 'binary_specificity': 1.0, 'binary_f1_score': 0.95430106}
confusion matrix:
      0     1
0  1500     0
1   136  1420
---- Validation: 
scalar performance:
{'acc': 0.5875576, 'precision': 0.7675382, 'recall': 0.575248, 'specificity': 0.575248, 'f1': 0.48934203, 'auroc': 0.89055943, 'binary_precision': 0.97979796, 'binary_recall': 0.153481, 'binary_specificity': 0.99701494, 'binary_f1_score': 0.26538986}
confusion matrix:
     0   1
0  668   2
1  535  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.510917, 'precision': 0.75275934, 'recall': 0.510917, 'specificity': 0.510917, 'f1': 0.35714465, 'auroc': 0.92438173, 'binary_precision': 1.0, 'binary_recall': 0.02183406, 'binary_specificity': 1.0, 'binary_f1_score': 0.042735044}
confusion matrix:
     0  1
0  229  0
1  224  5
early stop counter: 1
val acc:0.5875576138496399, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 18,now: 2024-07-29 09:58:31.808129,epoch time: 0:01:42.442139,used: 0:30:06.838764,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.977882, 'recall': 0.9777918, 'specificity': 0.9777918, 'f1': 0.97742134, 'auroc': 0.99898124, 'binary_precision': 0.9979906, 'binary_recall': 0.95758355, 'binary_specificity': 0.998, 'binary_f1_score': 0.9773696}
confusion matrix:
      0     1
0  1497     3
1    66  1490
---- Validation: 
scalar performance:
{'acc': 0.812596, 'precision': 0.8477144, 'recall': 0.8079043, 'specificity': 0.8079043, 'f1': 0.8060043, 'auroc': 0.9186331, 'binary_precision': 0.9511628, 'binary_recall': 0.6471519, 'binary_specificity': 0.9686567, 'binary_f1_score': 0.7702448}
confusion matrix:
     0    1
0  649   21
1  223  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.88813555, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.85283923, 'auroc': 0.94267845, 'binary_precision': 1.0, 'binary_recall': 0.7117904, 'binary_specificity': 1.0, 'binary_f1_score': 0.8316327}
confusion matrix:
     0    1
0  229    0
1   66  163
early stop counter: 2
val acc:0.8125960230827332, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 19,now: 2024-07-29 10:00:11.488995,epoch time: 0:01:39.680866,used: 0:31:46.519630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9891577, 'recall': 0.98926604, 'specificity': 0.98926604, 'f1': 0.98919904, 'auroc': 0.99905914, 'binary_precision': 0.9928849, 'binary_recall': 0.98587024, 'binary_specificity': 0.9926618, 'binary_f1_score': 0.98936516}
confusion matrix:
      0     1
0  1488    11
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.843318, 'precision': 0.86464417, 'recall': 0.83977425, 'specificity': 0.83977425, 'f1': 0.83990884, 'auroc': 0.9002013, 'binary_precision': 0.9458333, 'binary_recall': 0.7183544, 'binary_specificity': 0.96119404, 'binary_f1_score': 0.8165468}
confusion matrix:
     0    1
0  644   26
1  178  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.87594366, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8392512, 'auroc': 0.9169352, 'binary_precision': 0.9875776, 'binary_recall': 0.6943231, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.81538457}
confusion matrix:
     0    1
0  227    2
1   70  159
early stop counter: 3
val acc:0.843317985534668, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 20,now: 2024-07-29 10:01:51.335786,epoch time: 0:01:39.846791,used: 0:33:26.366421,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98230374, 'recall': 0.98233783, 'specificity': 0.98233783, 'f1': 0.9820026, 'auroc': 0.99970007, 'binary_precision': 1.0, 'binary_recall': 0.96467566, 'binary_specificity': 1.0, 'binary_f1_score': 0.98202026}
confusion matrix:
      0     1
0  1499     0
1    55  1502
---- Validation: 
scalar performance:
{'acc': 0.67127496, 'precision': 0.7818905, 'recall': 0.661886, 'specificity': 0.661886, 'f1': 0.62801695, 'auroc': 0.88477707, 'binary_precision': 0.95132744, 'binary_recall': 0.34018987, 'binary_specificity': 0.9835821, 'binary_f1_score': 0.50116557}
confusion matrix:
     0    1
0  659   11
1  417  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60262007, 'precision': 0.7785888, 'recall': 0.60262007, 'specificity': 0.60262007, 'f1': 0.52810234, 'auroc': 0.90892625, 'binary_precision': 1.0, 'binary_recall': 0.20524018, 'binary_specificity': 1.0, 'binary_f1_score': 0.34057972}
confusion matrix:
     0   1
0  229   0
1  182  47
early stop counter: 4
val acc:0.6712749600410461, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 21,now: 2024-07-29 10:03:31.267278,epoch time: 0:01:39.931492,used: 0:35:06.297913,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99447083, 'recall': 0.9944041, 'specificity': 0.9944041, 'f1': 0.9944348, 'auroc': 0.9999014, 'binary_precision': 0.9929578, 'binary_recall': 0.99614644, 'binary_specificity': 0.9926618, 'binary_f1_score': 0.9945495}
confusion matrix:
      0     1
0  1488    11
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.8517665, 'precision': 0.86743987, 'recall': 0.84874594, 'specificity': 0.84874594, 'f1': 0.8492869, 'auroc': 0.9036014, 'binary_precision': 0.9363817, 'binary_recall': 0.74525315, 'binary_specificity': 0.9522388, 'binary_f1_score': 0.8299559}
confusion matrix:
     0    1
0  638   32
1  161  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87117904, 'precision': 0.8921865, 'recall': 0.87117904, 'specificity': 0.87117904, 'f1': 0.86943054, 'auroc': 0.9267558, 'binary_precision': 0.98295456, 'binary_recall': 0.75545853, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.854321}
confusion matrix:
     0    1
0  226    3
1   56  173
early stop counter: 5
val acc:0.8517665266990662, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 22,now: 2024-07-29 10:05:10.476870,epoch time: 0:01:39.209592,used: 0:36:45.507505,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99383324, 'recall': 0.993737, 'specificity': 0.993737, 'f1': 0.9937799, 'auroc': 0.9998059, 'binary_precision': 0.99168795, 'binary_recall': 0.99614644, 'binary_specificity': 0.9913275, 'binary_f1_score': 0.99391216}
confusion matrix:
      0     1
0  1486    13
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.7933948, 'precision': 0.81841123, 'recall': 0.7892027, 'specificity': 0.7892027, 'f1': 0.7874918, 'auroc': 0.88066614, 'binary_precision': 0.90066224, 'binary_recall': 0.6455696, 'binary_specificity': 0.9328358, 'binary_f1_score': 0.75207376}
confusion matrix:
     0    1
0  625   45
1  224  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7423581, 'precision': 0.79403126, 'recall': 0.7423581, 'specificity': 0.7423581, 'f1': 0.73051834, 'auroc': 0.8895521, 'binary_precision': 0.91729325, 'binary_recall': 0.5327511, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.6740331}
confusion matrix:
     0    1
0  218   11
1  107  122
early stop counter: 6
val acc:0.7933948040008545, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 23,now: 2024-07-29 10:06:49.980193,epoch time: 0:01:39.503323,used: 0:38:25.010828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.988852, 'recall': 0.98903716, 'specificity': 0.98903716, 'f1': 0.988873, 'auroc': 0.9997052, 'binary_precision': 0.997389, 'binary_recall': 0.98074454, 'binary_specificity': 0.9973298, 'binary_f1_score': 0.98899674}
confusion matrix:
      0     1
0  1494     4
1    30  1528
---- Validation: 
scalar performance:
{'acc': 0.5652842, 'precision': 0.72253096, 'recall': 0.55257416, 'specificity': 0.55257416, 'f1': 0.453906, 'auroc': 0.84022295, 'binary_precision': 0.902439, 'binary_recall': 0.11708861, 'binary_specificity': 0.9880597, 'binary_f1_score': 0.20728293}
confusion matrix:
     0   1
0  662   8
1  558  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.510917, 'precision': 0.75275934, 'recall': 0.510917, 'specificity': 0.510917, 'f1': 0.35714465, 'auroc': 0.90886897, 'binary_precision': 1.0, 'binary_recall': 0.02183406, 'binary_specificity': 1.0, 'binary_f1_score': 0.042735044}
confusion matrix:
     0  1
0  229  0
1  224  5
early stop counter: 7
val acc:0.5652841925621033, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 24,now: 2024-07-29 10:08:21.975647,epoch time: 0:01:31.995454,used: 0:39:57.006282,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.98499584, 'recall': 0.98400176, 'specificity': 0.98400176, 'f1': 0.984275, 'auroc': 0.9998535, 'binary_precision': 0.97068, 'binary_recall': 0.99935776, 'binary_specificity': 0.96864575, 'binary_f1_score': 0.9848102}
confusion matrix:
      0     1
0  1452    47
1     1  1556
---- Validation: 
scalar performance:
{'acc': 0.82258064, 'precision': 0.8227607, 'recall': 0.822048, 'specificity': 0.822048, 'f1': 0.8222635, 'auroc': 0.88538873, 'binary_precision': 0.82601625, 'binary_recall': 0.8037975, 'binary_specificity': 0.84029853, 'binary_f1_score': 0.81475544}
confusion matrix:
     0    1
0  563  107
1  124  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.8665528, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.85965985, 'auroc': 0.9194714, 'binary_precision': 0.91457283, 'binary_recall': 0.7947598, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8504672}
confusion matrix:
     0    1
0  212   17
1   47  182
early stop counter: 8
val acc:0.8225806355476379, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 25,now: 2024-07-29 10:10:02.544436,epoch time: 0:01:40.568789,used: 0:41:37.575071,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.99415183, 'recall': 0.99407053, 'specificity': 0.99407053, 'f1': 0.99410737, 'auroc': 0.9998393, 'binary_precision': 0.99232244, 'binary_recall': 0.99614644, 'binary_specificity': 0.9919947, 'binary_f1_score': 0.99423075}
confusion matrix:
      0     1
0  1487    12
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.8010753, 'precision': 0.8365725, 'recall': 0.79626155, 'specificity': 0.79626155, 'f1': 0.79377306, 'auroc': 0.8927617, 'binary_precision': 0.9388235, 'binary_recall': 0.6313291, 'binary_specificity': 0.96119404, 'binary_f1_score': 0.75496686}
confusion matrix:
     0    1
0  644   26
1  233  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.89428854, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8668605, 'auroc': 0.9394748, 'binary_precision': 0.99415207, 'binary_recall': 0.7423581, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.85}
confusion matrix:
     0    1
0  228    1
1   59  170
early stop counter: 9
val acc:0.801075279712677, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 26,now: 2024-07-29 10:11:41.410453,epoch time: 0:01:38.866017,used: 0:43:16.441088,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.99576473, 'recall': 0.99572587, 'specificity': 0.99572587, 'f1': 0.99574435, 'auroc': 0.9999023, 'binary_precision': 0.9948718, 'binary_recall': 0.9967887, 'binary_specificity': 0.9946631, 'binary_f1_score': 0.9958293}
confusion matrix:
      0     1
0  1491     8
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.75422424, 'precision': 0.81056774, 'recall': 0.74786747, 'specificity': 0.74786747, 'f1': 0.73925126, 'auroc': 0.8920963, 'binary_precision': 0.9357542, 'binary_recall': 0.5300633, 'binary_specificity': 0.96567166, 'binary_f1_score': 0.67676765}
confusion matrix:
     0    1
0  647   23
1  297  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231441, 'precision': 0.86935484, 'recall': 0.8231441, 'specificity': 0.8231441, 'f1': 0.81743383, 'auroc': 0.94513834, 'binary_precision': 1.0, 'binary_recall': 0.6462882, 'binary_specificity': 1.0, 'binary_f1_score': 0.78514594}
confusion matrix:
     0    1
0  229    0
1   81  148
early stop counter: 10
val acc:0.7542242407798767, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 27,now: 2024-07-29 10:13:17.977412,epoch time: 0:01:36.566959,used: 0:44:53.008047,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99475175, 'recall': 0.99477464, 'specificity': 0.99477464, 'f1': 0.9947628, 'auroc': 0.9998479, 'binary_precision': 0.9954955, 'binary_recall': 0.99421597, 'binary_specificity': 0.9953333, 'binary_f1_score': 0.9948553}
confusion matrix:
      0     1
0  1493     7
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.82181257, 'precision': 0.83995247, 'recall': 0.8183851, 'specificity': 0.8183851, 'f1': 0.8181814, 'auroc': 0.8782637, 'binary_precision': 0.9115226, 'binary_recall': 0.7009494, 'binary_specificity': 0.9358209, 'binary_f1_score': 0.79248655}
confusion matrix:
     0    1
0  627   43
1  189  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8732718, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8614407, 'auroc': 0.9232851, 'binary_precision': 0.9368421, 'binary_recall': 0.77729255, 'binary_specificity': 0.9475983, 'binary_f1_score': 0.849642}
confusion matrix:
     0    1
0  217   12
1   51  178
early stop counter: 11
val acc:0.8218125700950623, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 28,now: 2024-07-29 10:14:59.609308,epoch time: 0:01:41.631896,used: 0:46:34.639943,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9950916, 'precision': 0.9950837, 'recall': 0.9950962, 'specificity': 0.9950962, 'f1': 0.99508977, 'auroc': 0.9998526, 'binary_precision': 0.9955042, 'binary_recall': 0.99486524, 'binary_specificity': 0.9953271, 'binary_f1_score': 0.9951846}
confusion matrix:
      0     1
0  1491     7
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.82181257, 'precision': 0.8461855, 'recall': 0.81789154, 'specificity': 0.81789154, 'f1': 0.8172375, 'auroc': 0.90614486, 'binary_precision': 0.9310345, 'binary_recall': 0.6835443, 'binary_specificity': 0.9522388, 'binary_f1_score': 0.7883212}
confusion matrix:
     0    1
0  638   32
1  200  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80786026, 'precision': 0.85572326, 'recall': 0.80786026, 'specificity': 0.80786026, 'f1': 0.80117214, 'auroc': 0.9141892, 'binary_precision': 0.9862069, 'binary_recall': 0.62445414, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7647059}
confusion matrix:
     0    1
0  227    2
1   86  143
early stop counter: 12
val acc:0.8218125700950623, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 29,now: 2024-07-29 10:16:38.390964,epoch time: 0:01:38.781656,used: 0:48:13.421599,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99081707, 'recall': 0.9909786, 'specificity': 0.9909786, 'f1': 0.99083674, 'auroc': 0.9997395, 'binary_precision': 0.99869454, 'binary_recall': 0.9832905, 'binary_specificity': 0.99866664, 'binary_f1_score': 0.99093264}
confusion matrix:
      0     1
0  1498     2
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.7450077, 'precision': 0.8106884, 'recall': 0.7381494, 'specificity': 0.7381494, 'f1': 0.7270454, 'auroc': 0.8720716, 'binary_precision': 0.9464286, 'binary_recall': 0.5031645, 'binary_specificity': 0.97313434, 'binary_f1_score': 0.6570248}
confusion matrix:
     0    1
0  652   18
1  314  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75545853, 'precision': 0.8251183, 'recall': 0.7554585, 'specificity': 0.7554585, 'f1': 0.7416183, 'auroc': 0.906657, 'binary_precision': 0.9756098, 'binary_recall': 0.52401745, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.6818182}
confusion matrix:
     0    1
0  226    3
1  109  120
early stop counter: 13
val acc:0.7450076937675476, best validation acc: 0.8686636090278625, corresponding to test acc:                         0.8602620363235474 / 0.8908296823501587
after epoch: 30,now: 2024-07-29 10:18:15.554685,epoch time: 0:01:37.163721,used: 0:49:50.585320,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_24_seed_11_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:50.585320 at 2024-07-29 10:18:15.554685
persisted model performance metric: 

scalar performance:
{'acc': 0.86026204, 'precision': 0.87407184, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.8589603, 'auroc': 0.9297496, 'binary_precision': 0.9459459, 'binary_recall': 0.76419216, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.84541065}
confusion matrix:
     0    1
0  219   10
1   54  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8908297, 'precision': 0.89963925, 'recall': 0.8908297, 'specificity': 0.8908297, 'f1': 0.8902247, 'auroc': 0.9496386, 'binary_precision': 0.95897436, 'binary_recall': 0.8165939, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8820755}
confusion matrix:
     0    1
0  221    8
1   42  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455269 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool | 414671 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |  40598 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455269 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool | 414671 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |  40598 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |  40407 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14488 MiB | 163876 MiB | 149404 MiB |
|       from large pool |  14406 MiB |  14424 MiB | 163636 MiB | 149230 MiB |
|       from small pool |     66 MiB |     70 MiB |    240 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 503194 KiB |   1260 MiB | 633484 GiB | 633484 GiB |
|       from large pool | 492593 KiB |   1256 MiB | 622913 GiB | 622912 GiB |
|       from small pool |  10601 KiB |     47 MiB |  10571 GiB |  10571 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  156330 K  |  156329 K  |
|       from large pool |     187    |    1413    |   79554 K  |   79554 K  |
|       from small pool |    1123    |    1419    |   76776 K  |   76775 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  156330 K  |  156329 K  |
|       from large pool |     187    |    1413    |   79554 K  |   79554 K  |
|       from small pool |    1123    |    1419    |   76776 K  |   76775 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    6926    |    6290    |
|       from large pool |     603    |     603    |    6806    |    6203    |
|       from small pool |      33    |      35    |     120    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     654    |  104529 K  |  104529 K  |
|       from large pool |      43    |     608    |   59288 K  |   59288 K  |
|       from small pool |      57    |     236    |   45240 K  |   45240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14488 MiB | 163876 MiB | 162940 MiB |
|       from large pool |    886 MiB |  14424 MiB | 163636 MiB | 162750 MiB |
|       from small pool |     50 MiB |     70 MiB |    240 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 633485 GiB | 633485 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 622913 GiB | 622913 GiB |
|       from small pool |      0 KiB |     47 MiB |  10571 GiB |  10571 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  156330 K  |  156330 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76776 K  |   76776 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  156330 K  |  156330 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76776 K  |   76776 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    6926    |    6860    |
|       from large pool |      41    |     603    |    6806    |    6765    |
|       from small pool |      25    |      35    |     120    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |  104529 K  |  104529 K  |
|       from large pool |       3    |     608    |   59288 K  |   59288 K  |
|       from small pool |       0    |     236    |   45240 K  |   45240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14488 MiB | 163876 MiB | 162940 MiB |
|       from large pool |    886 MiB |  14424 MiB | 163636 MiB | 162750 MiB |
|       from small pool |     50 MiB |     70 MiB |    240 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 633485 GiB | 633485 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 622913 GiB | 622913 GiB |
|       from small pool |      0 KiB |     47 MiB |  10571 GiB |  10571 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  156330 K  |  156330 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76776 K  |   76776 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  156330 K  |  156330 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76776 K  |   76776 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    6926    |    6860    |
|       from large pool |      41    |     603    |    6806    |    6765    |
|       from small pool |      25    |      35    |     120    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |  104529 K  |  104529 K  |
|       from large pool |       3    |     608    |   59288 K  |   59288 K  |
|       from small pool |       0    |     236    |   45240 K  |   45240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368

 Experiment start at: 2024-07-29 10:19:03.869564
before training, model accuracy: 0.6380090713500977
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9548969, 'precision': 0.9548593, 'recall': 0.95495987, 'specificity': 0.95495987, 'f1': 0.95489013, 'auroc': 0.991464, 'binary_precision': 0.95971864, 'binary_recall': 0.95120406, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.95544237}
confusion matrix:
      0     1
0  1463    63
1    77  1501
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8039216, 'precision': 0.819717, 'recall': 0.8024224, 'specificity': 0.8024224, 'f1': 0.8009027, 'auroc': 0.8799658, 'binary_precision': 0.88752556, 'binary_recall': 0.6899841, 'binary_specificity': 0.91486067, 'binary_f1_score': 0.77638644}
confusion matrix:
     0    1
0  591   55
1  195  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280543, 'precision': 0.82872736, 'recall': 0.8280543, 'specificity': 0.8280543, 'f1': 0.8279662, 'auroc': 0.91486657, 'binary_precision': 0.8436019, 'binary_recall': 0.8054299, 'binary_specificity': 0.85067874, 'binary_f1_score': 0.82407403}
confusion matrix:
     0    1
0  188   33
1   43  178
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 10:20:47.683648,epoch time: 0:01:43.814084,used: 0:01:43.814084,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96005154, 'precision': 0.9614152, 'recall': 0.9605889, 'specificity': 0.9605889, 'f1': 0.96004355, 'auroc': 0.9943625, 'binary_precision': 0.99122214, 'binary_recall': 0.92970234, 'binary_specificity': 0.9914754, 'binary_f1_score': 0.9594772}
confusion matrix:
      0     1
0  1512    13
1   111  1468
---- Validation: 
scalar performance:
{'acc': 0.73882353, 'precision': 0.8058714, 'recall': 0.7356706, 'specificity': 0.7356706, 'f1': 0.72196007, 'auroc': 0.8854397, 'binary_precision': 0.94578314, 'binary_recall': 0.49920508, 'binary_specificity': 0.9721362, 'binary_f1_score': 0.65348595}
confusion matrix:
     0    1
0  628   18
1  315  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8031674, 'precision': 0.8502129, 'recall': 0.80316746, 'specificity': 0.80316746, 'f1': 0.7963274, 'auroc': 0.917426, 'binary_precision': 0.9785714, 'binary_recall': 0.6199095, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.7590028}
confusion matrix:
     0    1
0  218    3
1   84  137
early stop counter: 1
val acc:0.7388235330581665, best validation acc: 0.8039215803146362, corresponding to test acc:                         0.8280543088912964 / 0.8280543088912964
after epoch: 2,now: 2024-07-29 10:22:27.359302,epoch time: 0:01:39.675654,used: 0:03:23.489738,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97261596, 'precision': 0.9726037, 'recall': 0.9726137, 'specificity': 0.9726137, 'f1': 0.97260857, 'auroc': 0.9970113, 'binary_precision': 0.97336715, 'binary_recall': 0.9727503, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.9730587}
confusion matrix:
      0     1
0  1484    42
1    43  1535
---- Validation: 
scalar performance:
{'acc': 0.86196077, 'precision': 0.865464, 'recall': 0.8613087, 'specificity': 0.8613087, 'f1': 0.8614555, 'auroc': 0.9170805, 'binary_precision': 0.89806676, 'binary_recall': 0.81240064, 'binary_specificity': 0.9102167, 'binary_f1_score': 0.8530885}
confusion matrix:
     0    1
0  588   58
1  118  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8054299, 'precision': 0.8056551, 'recall': 0.8054299, 'specificity': 0.8054299, 'f1': 0.805394, 'auroc': 0.9146824, 'binary_precision': 0.79735684, 'binary_recall': 0.81900454, 'binary_specificity': 0.7918552, 'binary_f1_score': 0.80803573}
confusion matrix:
     0    1
0  175   46
1   40  181
better model found
persisted
after epoch: 3,now: 2024-07-29 10:24:05.198261,epoch time: 0:01:37.838959,used: 0:05:01.328697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97744846, 'precision': 0.9774974, 'recall': 0.9776323, 'specificity': 0.9776323, 'f1': 0.9774475, 'auroc': 0.99786127, 'binary_precision': 0.9883495, 'binary_recall': 0.9670678, 'binary_specificity': 0.98819673, 'binary_f1_score': 0.9775928}
confusion matrix:
      0     1
0  1507    18
1    52  1527
---- Validation: 
scalar performance:
{'acc': 0.8564706, 'precision': 0.85878813, 'recall': 0.8559326, 'specificity': 0.8559326, 'f1': 0.85608494, 'auroc': 0.91605425, 'binary_precision': 0.88448274, 'binary_recall': 0.8155803, 'binary_specificity': 0.8962848, 'binary_f1_score': 0.84863526}
confusion matrix:
     0    1
0  579   67
1  116  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755656, 'precision': 0.8831036, 'recall': 0.87556565, 'specificity': 0.87556565, 'f1': 0.8749505, 'auroc': 0.9215208, 'binary_precision': 0.9368421, 'binary_recall': 0.8054299, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.86618006}
confusion matrix:
     0    1
0  209   12
1   43  178
new oracle model saved
early stop counter: 1
val acc:0.8564705848693848, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 4,now: 2024-07-29 10:25:54.104610,epoch time: 0:01:48.906349,used: 0:06:50.235046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95908505, 'precision': 0.961585, 'recall': 0.9597592, 'specificity': 0.9597592, 'f1': 0.95906115, 'auroc': 0.997561, 'binary_precision': 1.0, 'binary_recall': 0.91951835, 'binary_specificity': 1.0, 'binary_f1_score': 0.95807195}
confusion matrix:
      0     1
0  1526     0
1   127  1451
---- Validation: 
scalar performance:
{'acc': 0.62666667, 'precision': 0.77010643, 'recall': 0.62174714, 'specificity': 0.62174714, 'f1': 0.5647166, 'auroc': 0.89067924, 'binary_precision': 0.96363634, 'binary_recall': 0.2527822, 'binary_specificity': 0.99071205, 'binary_f1_score': 0.4005038}
confusion matrix:
     0    1
0  640    6
1  470  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65837103, 'precision': 0.7724359, 'recall': 0.65837103, 'specificity': 0.65837103, 'f1': 0.6184318, 'auroc': 0.89021516, 'binary_precision': 0.94871795, 'binary_recall': 0.33484164, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.49498332}
confusion matrix:
     0   1
0  217   4
1  147  74
early stop counter: 2
val acc:0.6266666650772095, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 5,now: 2024-07-29 10:27:34.223819,epoch time: 0:01:40.119209,used: 0:08:30.354255,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9855026, 'precision': 0.9856779, 'recall': 0.98574144, 'specificity': 0.98574144, 'f1': 0.9855025, 'auroc': 0.99956477, 'binary_precision': 1.0, 'binary_recall': 0.9714829, 'binary_specificity': 1.0, 'binary_f1_score': 0.9855352}
confusion matrix:
      0     1
0  1526     0
1    45  1533
---- Validation: 
scalar performance:
{'acc': 0.6839216, 'precision': 0.7959774, 'recall': 0.6797757, 'specificity': 0.6797757, 'f1': 0.6478627, 'auroc': 0.88923585, 'binary_precision': 0.9747899, 'binary_recall': 0.3688394, 'binary_specificity': 0.99071205, 'binary_f1_score': 0.5351787}
confusion matrix:
     0    1
0  640    6
1  397  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78506786, 'precision': 0.83187926, 'recall': 0.7850679, 'specificity': 0.7850679, 'f1': 0.7772119, 'auroc': 0.8847894, 'binary_precision': 0.95652175, 'binary_recall': 0.5972851, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.7353761}
confusion matrix:
     0    1
0  215    6
1   89  132
early stop counter: 3
val acc:0.6839215755462646, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 6,now: 2024-07-29 10:29:12.759100,epoch time: 0:01:38.535281,used: 0:10:08.889536,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9890464, 'precision': 0.9890171, 'recall': 0.9891552, 'specificity': 0.9891552, 'f1': 0.9890451, 'auroc': 0.9993218, 'binary_precision': 0.9955099, 'binary_recall': 0.98290056, 'binary_specificity': 0.99540985, 'binary_f1_score': 0.98916507}
confusion matrix:
      0     1
0  1518     7
1    27  1552
---- Validation: 
scalar performance:
{'acc': 0.77254903, 'precision': 0.83105874, 'recall': 0.7697264, 'specificity': 0.7697264, 'f1': 0.76076263, 'auroc': 0.92395914, 'binary_precision': 0.96694213, 'binary_recall': 0.55802864, 'binary_specificity': 0.98142415, 'binary_f1_score': 0.70766133}
confusion matrix:
     0    1
0  634   12
1  278  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81447965, 'precision': 0.8592278, 'recall': 0.81447965, 'specificity': 0.81447965, 'f1': 0.8085165, 'auroc': 0.92084515, 'binary_precision': 0.986014, 'binary_recall': 0.6380091, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.7747253}
confusion matrix:
     0    1
0  219    2
1   80  141
early stop counter: 4
val acc:0.772549033164978, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 7,now: 2024-07-29 10:30:49.281695,epoch time: 0:01:36.522595,used: 0:11:45.412131,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98936856, 'precision': 0.98932993, 'recall': 0.9894382, 'specificity': 0.9894382, 'f1': 0.9893667, 'auroc': 0.9992986, 'binary_precision': 0.9936143, 'binary_recall': 0.9854338, 'binary_specificity': 0.9934426, 'binary_f1_score': 0.9895072}
confusion matrix:
      0     1
0  1515    10
1    23  1556
---- Validation: 
scalar performance:
{'acc': 0.78431374, 'precision': 0.8385425, 'recall': 0.78162915, 'specificity': 0.78162915, 'f1': 0.7741873, 'auroc': 0.91432667, 'binary_precision': 0.97074467, 'binary_recall': 0.58028615, 'binary_specificity': 0.98297215, 'binary_f1_score': 0.72636807}
confusion matrix:
     0    1
0  635   11
1  264  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.8673587, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.82852054, 'auroc': 0.9176716, 'binary_precision': 0.98039216, 'binary_recall': 0.67873305, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.8021391}
confusion matrix:
     0    1
0  218    3
1   71  150
early stop counter: 5
val acc:0.7843137383460999, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 8,now: 2024-07-29 10:32:31.765966,epoch time: 0:01:42.484271,used: 0:13:27.896402,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98292524, 'precision': 0.98308206, 'recall': 0.98318136, 'specificity': 0.98318136, 'f1': 0.98292506, 'auroc': 0.9991416, 'binary_precision': 0.99739414, 'binary_recall': 0.96898735, 'binary_specificity': 0.9973753, 'binary_f1_score': 0.98298556}
confusion matrix:
      0     1
0  1520     4
1    49  1531
---- Validation: 
scalar performance:
{'acc': 0.71686274, 'precision': 0.80193424, 'recall': 0.7132876, 'specificity': 0.7132876, 'f1': 0.6932132, 'auroc': 0.89504206, 'binary_precision': 0.9589041, 'binary_recall': 0.44515103, 'binary_specificity': 0.98142415, 'binary_f1_score': 0.60803473}
confusion matrix:
     0    1
0  634   12
1  349  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7443439, 'precision': 0.82677984, 'recall': 0.7443439, 'specificity': 0.7443439, 'f1': 0.7271352, 'auroc': 0.8912594, 'binary_precision': 0.9909091, 'binary_recall': 0.49321267, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.6586102}
confusion matrix:
     0    1
0  220    1
1  112  109
early stop counter: 6
val acc:0.7168627381324768, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 9,now: 2024-07-29 10:34:22.920548,epoch time: 0:01:51.154582,used: 0:15:19.050984,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9755155, 'precision': 0.97603464, 'recall': 0.9758781, 'specificity': 0.9758781, 'f1': 0.9755151, 'auroc': 0.9986507, 'binary_precision': 0.9966953, 'binary_recall': 0.95503485, 'binary_specificity': 0.9967213, 'binary_f1_score': 0.9754204}
confusion matrix:
      0     1
0  1520     5
1    71  1508
---- Validation: 
scalar performance:
{'acc': 0.6384314, 'precision': 0.7730839, 'recall': 0.6336918, 'specificity': 0.6336918, 'f1': 0.58323556, 'auroc': 0.88305986, 'binary_precision': 0.96153843, 'binary_recall': 0.2782194, 'binary_specificity': 0.9891641, 'binary_f1_score': 0.43156597}
confusion matrix:
     0    1
0  639    7
1  454  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81900454, 'precision': 0.86710966, 'recall': 0.81900454, 'specificity': 0.81900454, 'f1': 0.8128744, 'auroc': 0.9147438, 'binary_precision': 1.0, 'binary_recall': 0.6380091, 'binary_specificity': 1.0, 'binary_f1_score': 0.7790055}
confusion matrix:
     0    1
0  221    0
1   80  141
early stop counter: 7
val acc:0.6384313702583313, best validation acc: 0.861960768699646, corresponding to test acc:                         0.8054298758506775 / 0.8755655884742737
after epoch: 10,now: 2024-07-29 10:36:12.773615,epoch time: 0:01:49.853067,used: 0:17:08.904051,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98679125, 'precision': 0.9868033, 'recall': 0.9869498, 'specificity': 0.9869498, 'f1': 0.9867904, 'auroc': 0.9991416, 'binary_precision': 0.99612904, 'binary_recall': 0.97783405, 'binary_specificity': 0.99606556, 'binary_f1_score': 0.9868968}
confusion matrix:
      0     1
0  1519     6
1    35  1544
---- Validation: 
scalar performance:
{'acc': 0.8752941, 'precision': 0.88156736, 'recall': 0.8744457, 'specificity': 0.8744457, 'f1': 0.8745831, 'auroc': 0.93520105, 'binary_precision': 0.92727274, 'binary_recall': 0.8108108, 'binary_specificity': 0.9380805, 'binary_f1_score': 0.8651399}
confusion matrix:
     0    1
0  606   40
1  119  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733032, 'precision': 0.8887112, 'recall': 0.8733032, 'specificity': 0.8733032, 'f1': 0.872035, 'auroc': 0.93243384, 'binary_precision': 0.9661017, 'binary_recall': 0.77375567, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.85929644}
confusion matrix:
     0    1
0  215    6
1   50  171
better model found
persisted
after epoch: 11,now: 2024-07-29 10:37:57.632678,epoch time: 0:01:44.859063,used: 0:18:53.763114,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9761598, 'precision': 0.9771249, 'recall': 0.9758148, 'specificity': 0.9758148, 'f1': 0.9761276, 'auroc': 0.9991715, 'binary_precision': 0.95970696, 'binary_recall': 0.9949367, 'binary_specificity': 0.95669293, 'binary_f1_score': 0.97700435}
confusion matrix:
      0     1
0  1458    66
1     8  1572
---- Validation: 
scalar performance:
{'acc': 0.83137256, 'precision': 0.84053224, 'recall': 0.8324617, 'specificity': 0.8324617, 'f1': 0.83052814, 'auroc': 0.925261, 'binary_precision': 0.78125, 'binary_recall': 0.91414946, 'binary_specificity': 0.75077397, 'binary_f1_score': 0.84249085}
confusion matrix:
     0    1
0  485  161
1   54  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7669683, 'precision': 0.8038544, 'recall': 0.76696837, 'specificity': 0.76696837, 'f1': 0.75967485, 'auroc': 0.9304887, 'binary_precision': 0.6979866, 'binary_recall': 0.9411765, 'binary_specificity': 0.5927602, 'binary_f1_score': 0.8015415}
confusion matrix:
     0    1
0  131   90
1   13  208
early stop counter: 1
val acc:0.8313725590705872, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 12,now: 2024-07-29 10:39:32.460747,epoch time: 0:01:34.828069,used: 0:20:28.591183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98840207, 'precision': 0.9883913, 'recall': 0.9885495, 'specificity': 0.9885495, 'f1': 0.988401, 'auroc': 0.9988774, 'binary_precision': 0.9967825, 'binary_recall': 0.98037976, 'binary_specificity': 0.9967192, 'binary_f1_score': 0.98851305}
confusion matrix:
      0     1
0  1519     5
1    31  1549
---- Validation: 
scalar performance:
{'acc': 0.8478431, 'precision': 0.8598492, 'recall': 0.8466237, 'specificity': 0.8466237, 'f1': 0.8462197, 'auroc': 0.9140584, 'binary_precision': 0.9223301, 'binary_recall': 0.75516695, 'binary_specificity': 0.9380805, 'binary_f1_score': 0.83041954}
confusion matrix:
     0    1
0  606   40
1  154  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78506786, 'precision': 0.81998074, 'recall': 0.7850679, 'specificity': 0.7850679, 'f1': 0.77904075, 'auroc': 0.8972175, 'binary_precision': 0.9256757, 'binary_recall': 0.6199095, 'binary_specificity': 0.95022625, 'binary_f1_score': 0.7425475}
confusion matrix:
     0    1
0  210   11
1   84  137
early stop counter: 2
val acc:0.8478431105613708, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 13,now: 2024-07-29 10:41:18.953029,epoch time: 0:01:46.492282,used: 0:22:15.083465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9838917, 'precision': 0.9844265, 'recall': 0.98365396, 'specificity': 0.98365396, 'f1': 0.98387635, 'auroc': 0.9997778, 'binary_precision': 0.9722222, 'binary_recall': 0.9968355, 'binary_specificity': 0.97047246, 'binary_f1_score': 0.984375}
confusion matrix:
      0     1
0  1479    45
1     5  1575
---- Validation: 
scalar performance:
{'acc': 0.84, 'precision': 0.83997905, 'recall': 0.8400343, 'specificity': 0.8400343, 'f1': 0.83998805, 'auroc': 0.91379994, 'binary_precision': 0.8346457, 'binary_recall': 0.8426073, 'binary_specificity': 0.8374613, 'binary_f1_score': 0.83860755}
confusion matrix:
     0    1
0  541  105
1   99  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8687783, 'precision': 0.8687783, 'recall': 0.8687783, 'specificity': 0.8687783, 'f1': 0.8687783, 'auroc': 0.93550503, 'binary_precision': 0.8687783, 'binary_recall': 0.8687783, 'binary_specificity': 0.8687783, 'binary_f1_score': 0.8687783}
confusion matrix:
     0    1
0  192   29
1   29  192
early stop counter: 3
val acc:0.8399999737739563, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 14,now: 2024-07-29 10:42:56.502750,epoch time: 0:01:37.549721,used: 0:23:52.633186,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9896907, 'precision': 0.9897094, 'recall': 0.98985577, 'specificity': 0.98985577, 'f1': 0.98969007, 'auroc': 0.9996885, 'binary_precision': 0.9993544, 'binary_recall': 0.9803673, 'binary_specificity': 0.9993443, 'binary_f1_score': 0.9897698}
confusion matrix:
      0     1
0  1524     1
1    31  1548
---- Validation: 
scalar performance:
{'acc': 0.71137255, 'precision': 0.78943646, 'recall': 0.70786965, 'specificity': 0.70786965, 'f1': 0.6882839, 'auroc': 0.86937106, 'binary_precision': 0.93645483, 'binary_recall': 0.44515103, 'binary_specificity': 0.9705882, 'binary_f1_score': 0.6034483}
confusion matrix:
     0    1
0  627   19
1  349  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75113124, 'precision': 0.78481364, 'recall': 0.75113124, 'specificity': 0.75113124, 'f1': 0.7435492, 'auroc': 0.8667308, 'binary_precision': 0.8827586, 'binary_recall': 0.57918555, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.6994536}
confusion matrix:
     0    1
0  204   17
1   93  128
early stop counter: 4
val acc:0.7113725543022156, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 15,now: 2024-07-29 10:44:38.926411,epoch time: 0:01:42.423661,used: 0:25:35.056847,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9780928, 'precision': 0.9786432, 'recall': 0.97848105, 'specificity': 0.97848105, 'f1': 0.97809243, 'auroc': 0.99906266, 'binary_precision': 1.0, 'binary_recall': 0.95696205, 'binary_specificity': 1.0, 'binary_f1_score': 0.97800773}
confusion matrix:
      0     1
0  1524     0
1    68  1512
---- Validation: 
scalar performance:
{'acc': 0.54509807, 'precision': 0.7284591, 'recall': 0.53903437, 'specificity': 0.53903437, 'f1': 0.42168003, 'auroc': 0.8135733, 'binary_precision': 0.9298246, 'binary_recall': 0.08426073, 'binary_specificity': 0.99380803, 'binary_f1_score': 0.15451895}
confusion matrix:
     0   1
0  642   4
1  576  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50678736, 'precision': 0.5850655, 'recall': 0.50678736, 'specificity': 0.50678736, 'f1': 0.35942027, 'auroc': 0.7889069, 'binary_precision': 0.6666667, 'binary_recall': 0.027149322, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.052173913}
confusion matrix:
     0  1
0  218  3
1  215  6
early stop counter: 5
val acc:0.545098066329956, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 16,now: 2024-07-29 10:46:15.082395,epoch time: 0:01:36.155984,used: 0:27:11.212831,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9787371, 'precision': 0.9790227, 'recall': 0.9790442, 'specificity': 0.9790442, 'f1': 0.9787371, 'auroc': 0.99828815, 'binary_precision': 0.9960682, 'binary_recall': 0.96202534, 'binary_specificity': 0.996063, 'binary_f1_score': 0.9787508}
confusion matrix:
      0     1
0  1518     6
1    60  1520
---- Validation: 
scalar performance:
{'acc': 0.7717647, 'precision': 0.81783986, 'recall': 0.7692034, 'specificity': 0.7692034, 'f1': 0.76202023, 'auroc': 0.89763784, 'binary_precision': 0.935567, 'binary_recall': 0.57710654, 'binary_specificity': 0.9613003, 'binary_f1_score': 0.71386427}
confusion matrix:
     0    1
0  621   25
1  266  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65837103, 'precision': 0.797043, 'recall': 0.65837103, 'specificity': 0.65837103, 'f1': 0.6132311, 'auroc': 0.90802807, 'binary_precision': 1.0, 'binary_recall': 0.3167421, 'binary_specificity': 1.0, 'binary_f1_score': 0.48109967}
confusion matrix:
     0   1
0  221   0
1  151  70
early stop counter: 6
val acc:0.7717646956443787, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 17,now: 2024-07-29 10:47:52.966874,epoch time: 0:01:37.884479,used: 0:28:49.097310,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.994201, 'precision': 0.9941993, 'recall': 0.9941993, 'specificity': 0.9941993, 'f1': 0.9941993, 'auroc': 0.99980813, 'binary_precision': 0.9943002, 'binary_recall': 0.9943002, 'binary_specificity': 0.99409837, 'binary_f1_score': 0.9943002}
confusion matrix:
      0     1
0  1516     9
1     9  1570
---- Validation: 
scalar performance:
{'acc': 0.82823527, 'precision': 0.8432107, 'recall': 0.82683456, 'specificity': 0.82683456, 'f1': 0.8258893, 'auroc': 0.89317656, 'binary_precision': 0.9116466, 'binary_recall': 0.7217806, 'binary_specificity': 0.9318885, 'binary_f1_score': 0.8056788}
confusion matrix:
     0    1
0  602   44
1  175  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.84894496, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.84079444, 'auroc': 0.8893143, 'binary_precision': 0.8994709, 'binary_recall': 0.7692308, 'binary_specificity': 0.91402715, 'binary_f1_score': 0.82926834}
confusion matrix:
     0    1
0  202   19
1   51  170
early stop counter: 7
val acc:0.8282352685928345, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 18,now: 2024-07-29 10:49:26.333250,epoch time: 0:01:33.366376,used: 0:30:22.463686,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9890464, 'precision': 0.9890795, 'recall': 0.9892225, 'specificity': 0.9892225, 'f1': 0.98904586, 'auroc': 0.99946177, 'binary_precision': 0.9993536, 'binary_recall': 0.9791007, 'binary_specificity': 0.9993443, 'binary_f1_score': 0.98912346}
confusion matrix:
      0     1
0  1524     1
1    33  1546
---- Validation: 
scalar performance:
{'acc': 0.8462745, 'precision': 0.8604603, 'recall': 0.8449502, 'specificity': 0.8449502, 'f1': 0.8443712, 'auroc': 0.92250466, 'binary_precision': 0.92871284, 'binary_recall': 0.745628, 'binary_specificity': 0.94427246, 'binary_f1_score': 0.8271605}
confusion matrix:
     0    1
0  610   36
1  160  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8687783, 'precision': 0.8886731, 'recall': 0.8687783, 'specificity': 0.8687783, 'f1': 0.86707735, 'auroc': 0.9211318, 'binary_precision': 0.9766082, 'binary_recall': 0.7556561, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.8520409}
confusion matrix:
     0    1
0  217    4
1   54  167
early stop counter: 8
val acc:0.8462744951248169, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 19,now: 2024-07-29 10:51:05.478107,epoch time: 0:01:39.144857,used: 0:32:01.608543,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9842139, 'precision': 0.9841743, 'recall': 0.98430765, 'specificity': 0.98430765, 'f1': 0.98421144, 'auroc': 0.99801826, 'binary_precision': 0.98976326, 'binary_recall': 0.97911394, 'binary_specificity': 0.9895013, 'binary_f1_score': 0.9844098}
confusion matrix:
      0     1
0  1508    16
1    33  1547
---- Validation: 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8340301, 'recall': 0.7841394, 'specificity': 0.7841394, 'f1': 0.7777778, 'auroc': 0.9188075, 'binary_precision': 0.95652175, 'binary_recall': 0.5945946, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.73333335}
confusion matrix:
     0    1
0  629   17
1  255  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7918552, 'precision': 0.84393775, 'recall': 0.7918552, 'specificity': 0.7918552, 'f1': 0.7836653, 'auroc': 0.90725005, 'binary_precision': 0.9777778, 'binary_recall': 0.5972851, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.74157304}
confusion matrix:
     0    1
0  218    3
1   89  132
early stop counter: 9
val acc:0.7866666913032532, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 20,now: 2024-07-29 10:52:40.331925,epoch time: 0:01:34.853818,used: 0:33:36.462361,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9832474, 'precision': 0.98343563, 'recall': 0.98349106, 'specificity': 0.98349106, 'f1': 0.9832473, 'auroc': 0.9993098, 'binary_precision': 0.99804175, 'binary_recall': 0.968948, 'binary_specificity': 0.99803406, 'binary_f1_score': 0.9832797}
confusion matrix:
      0     1
0  1523     3
1    49  1529
---- Validation: 
scalar performance:
{'acc': 0.8101961, 'precision': 0.8310359, 'recall': 0.8085097, 'specificity': 0.8085097, 'f1': 0.8065517, 'auroc': 0.90150714, 'binary_precision': 0.91082805, 'binary_recall': 0.68203497, 'binary_specificity': 0.9349845, 'binary_f1_score': 0.78}
confusion matrix:
     0    1
0  604   42
1  200  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84841627, 'precision': 0.8510107, 'recall': 0.8484163, 'specificity': 0.8484163, 'f1': 0.8481357, 'auroc': 0.9228722, 'binary_precision': 0.8811881, 'binary_recall': 0.8054299, 'binary_specificity': 0.8914027, 'binary_f1_score': 0.8416076}
confusion matrix:
     0    1
0  197   24
1   43  178
early stop counter: 10
val acc:0.8101961016654968, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 21,now: 2024-07-29 10:54:20.170419,epoch time: 0:01:39.838494,used: 0:35:16.300855,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99291235, 'precision': 0.9928762, 'recall': 0.9929663, 'specificity': 0.9929663, 'f1': 0.9929109, 'auroc': 0.9997599, 'binary_precision': 0.9961759, 'binary_recall': 0.98986703, 'binary_specificity': 0.99606556, 'binary_f1_score': 0.9930114}
confusion matrix:
      0     1
0  1519     6
1    16  1563
---- Validation: 
scalar performance:
{'acc': 0.8172549, 'precision': 0.8501274, 'recall': 0.8152038, 'specificity': 0.8152038, 'f1': 0.8121592, 'auroc': 0.9180305, 'binary_precision': 0.95412844, 'binary_recall': 0.66136724, 'binary_specificity': 0.9690403, 'binary_f1_score': 0.7812207}
confusion matrix:
     0    1
0  626   20
1  213  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81900454, 'precision': 0.8462564, 'recall': 0.81900454, 'specificity': 0.81900454, 'f1': 0.81537175, 'auroc': 0.90092343, 'binary_precision': 0.9433962, 'binary_recall': 0.67873305, 'binary_specificity': 0.959276, 'binary_f1_score': 0.7894737}
confusion matrix:
     0    1
0  212    9
1   71  150
early stop counter: 11
val acc:0.817254900932312, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8755655884742737
after epoch: 22,now: 2024-07-29 10:55:55.449181,epoch time: 0:01:35.278762,used: 0:36:51.579617,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9916237, 'precision': 0.9915854, 'recall': 0.9916997, 'specificity': 0.9916997, 'f1': 0.9916223, 'auroc': 0.9996586, 'binary_precision': 0.9961661, 'binary_recall': 0.9873338, 'binary_specificity': 0.99606556, 'binary_f1_score': 0.9917303}
confusion matrix:
      0     1
0  1519     6
1    20  1559
---- Validation: 
scalar performance:
{'acc': 0.86509806, 'precision': 0.87868595, 'recall': 0.86383986, 'specificity': 0.86383986, 'f1': 0.86356854, 'auroc': 0.9295358, 'binary_precision': 0.94716245, 'binary_recall': 0.76947534, 'binary_specificity': 0.9582043, 'binary_f1_score': 0.8491228}
confusion matrix:
     0    1
0  619   27
1  145  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87782806, 'precision': 0.8982111, 'recall': 0.87782806, 'specificity': 0.87782806, 'f1': 0.8762444, 'auroc': 0.92653716, 'binary_precision': 0.9883041, 'binary_recall': 0.7647059, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.8622449}
confusion matrix:
     0    1
0  219    2
1   52  169
new oracle model saved
early stop counter: 12
val acc:0.8650980591773987, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.877828061580658
after epoch: 23,now: 2024-07-29 10:57:34.970658,epoch time: 0:01:39.521477,used: 0:38:31.101094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9925902, 'precision': 0.9926535, 'recall': 0.9925375, 'specificity': 0.9925375, 'f1': 0.9925871, 'auroc': 0.99943066, 'binary_precision': 0.98992443, 'binary_recall': 0.9955668, 'binary_specificity': 0.9895082, 'binary_f1_score': 0.99273753}
confusion matrix:
      0     1
0  1509    16
1     7  1572
---- Validation: 
scalar performance:
{'acc': 0.82509804, 'precision': 0.8530508, 'recall': 0.8232156, 'specificity': 0.8232156, 'f1': 0.8209528, 'auroc': 0.9146515, 'binary_precision': 0.94911504, 'binary_recall': 0.68203497, 'binary_specificity': 0.9643963, 'binary_f1_score': 0.7937095}
confusion matrix:
     0    1
0  623   23
1  200  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.800905, 'precision': 0.8517171, 'recall': 0.800905, 'specificity': 0.800905, 'f1': 0.79344475, 'auroc': 0.9161155, 'binary_precision': 0.98540145, 'binary_recall': 0.61085975, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.7541899}
confusion matrix:
     0    1
0  219    2
1   86  135
early stop counter: 13
val acc:0.8250980377197266, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.877828061580658
after epoch: 24,now: 2024-07-29 10:59:09.560135,epoch time: 0:01:34.589477,used: 0:40:05.690571,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9932345, 'precision': 0.99322724, 'recall': 0.9932381, 'specificity': 0.9932381, 'f1': 0.9932326, 'auroc': 0.99953526, 'binary_precision': 0.9936629, 'binary_recall': 0.9930336, 'binary_specificity': 0.9934426, 'binary_f1_score': 0.9933482}
confusion matrix:
      0     1
0  1515    10
1    11  1568
---- Validation: 
scalar performance:
{'acc': 0.8690196, 'precision': 0.8722645, 'recall': 0.8684001, 'specificity': 0.8684001, 'f1': 0.8685769, 'auroc': 0.92652106, 'binary_precision': 0.90384614, 'binary_recall': 0.8219396, 'binary_specificity': 0.91486067, 'binary_f1_score': 0.8609492}
confusion matrix:
     0    1
0  591   55
1  112  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.86414564, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.8617865, 'auroc': 0.90082103, 'binary_precision': 0.89215684, 'binary_recall': 0.8235294, 'binary_specificity': 0.9004525, 'binary_f1_score': 0.8564706}
confusion matrix:
     0    1
0  199   22
1   39  182
early stop counter: 14
val acc:0.869019627571106, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.877828061580658
after epoch: 25,now: 2024-07-29 11:00:44.512304,epoch time: 0:01:34.952169,used: 0:41:40.642740,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99194586, 'precision': 0.9919267, 'recall': 0.9920724, 'specificity': 0.9920724, 'f1': 0.9919451, 'auroc': 0.9995768, 'binary_precision': 0.99935734, 'binary_recall': 0.9848005, 'binary_specificity': 0.9993443, 'binary_f1_score': 0.99202555}
confusion matrix:
      0     1
0  1524     1
1    24  1555
---- Validation: 
scalar performance:
{'acc': 0.7380392, 'precision': 0.8194185, 'recall': 0.73464566, 'specificity': 0.73464566, 'f1': 0.71836364, 'auroc': 0.88859475, 'binary_precision': 0.9773463, 'binary_recall': 0.4801272, 'binary_specificity': 0.9891641, 'binary_f1_score': 0.6439232}
confusion matrix:
     0    1
0  639    7
1  327  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77828056, 'precision': 0.846395, 'recall': 0.77828056, 'specificity': 0.77828056, 'f1': 0.76681745, 'auroc': 0.8895805, 'binary_precision': 1.0, 'binary_recall': 0.5565611, 'binary_specificity': 1.0, 'binary_f1_score': 0.7151163}
confusion matrix:
     0    1
0  221    0
1   98  123
early stop counter: 15
val acc:0.7380391955375671, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.877828061580658
after epoch: 26,now: 2024-07-29 11:02:27.692073,epoch time: 0:01:43.179769,used: 0:43:23.822509,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9890464, 'precision': 0.98900855, 'recall': 0.9891475, 'specificity': 0.9891475, 'f1': 0.9890447, 'auroc': 0.99942315, 'binary_precision': 0.99487835, 'binary_recall': 0.9835443, 'binary_specificity': 0.9947507, 'binary_f1_score': 0.98917884}
confusion matrix:
      0     1
0  1516     8
1    26  1554
---- Validation: 
scalar performance:
{'acc': 0.84156865, 'precision': 0.86660695, 'recall': 0.8398251, 'specificity': 0.8398251, 'f1': 0.8383101, 'auroc': 0.9354977, 'binary_precision': 0.95913976, 'binary_recall': 0.709062, 'binary_specificity': 0.9705882, 'binary_f1_score': 0.8153565}
confusion matrix:
     0    1
0  627   19
1  183  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85294116, 'precision': 0.8841594, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.84989154, 'auroc': 0.9258001, 'binary_precision': 0.9936709, 'binary_recall': 0.71040726, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.828496}
confusion matrix:
     0    1
0  220    1
1   64  157
early stop counter: 16
val acc:0.841568648815155, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.877828061580658
after epoch: 27,now: 2024-07-29 11:04:07.817097,epoch time: 0:01:40.125024,used: 0:45:03.947533,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99387884, 'precision': 0.9938537, 'recall': 0.9939059, 'specificity': 0.9939059, 'f1': 0.9938772, 'auroc': 0.99983555, 'binary_precision': 0.9955556, 'binary_recall': 0.99240506, 'binary_specificity': 0.9954068, 'binary_f1_score': 0.99397784}
confusion matrix:
      0     1
0  1517     7
1    12  1568
---- Validation: 
scalar performance:
{'acc': 0.8015686, 'precision': 0.8428521, 'recall': 0.79924273, 'specificity': 0.79924273, 'f1': 0.79452896, 'auroc': 0.9244107, 'binary_precision': 0.95853657, 'binary_recall': 0.6248013, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.75649667}
confusion matrix:
     0    1
0  629   17
1  236  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8393665, 'precision': 0.87842464, 'recall': 0.83936656, 'specificity': 0.83936656, 'f1': 0.83511186, 'auroc': 0.9418777, 'binary_precision': 1.0, 'binary_recall': 0.67873305, 'binary_specificity': 1.0, 'binary_f1_score': 0.80862534}
confusion matrix:
     0    1
0  221    0
1   71  150
early stop counter: 17
val acc:0.8015686273574829, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.877828061580658
after epoch: 28,now: 2024-07-29 11:06:04.688191,epoch time: 0:01:56.871094,used: 0:47:00.818627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99774486, 'precision': 0.9977771, 'recall': 0.9977161, 'specificity': 0.9977161, 'f1': 0.997744, 'auroc': 0.9999884, 'binary_precision': 0.9962121, 'binary_recall': 0.9993667, 'binary_specificity': 0.99606556, 'binary_f1_score': 0.99778694}
confusion matrix:
      0     1
0  1519     6
1     1  1578
---- Validation: 
scalar performance:
{'acc': 0.8611765, 'precision': 0.86688167, 'recall': 0.86034644, 'specificity': 0.86034644, 'f1': 0.8604177, 'auroc': 0.921188, 'binary_precision': 0.9094203, 'binary_recall': 0.7980922, 'binary_specificity': 0.9226006, 'binary_f1_score': 0.850127}
confusion matrix:
     0    1
0  596   50
1  127  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8959276, 'precision': 0.90552586, 'recall': 0.8959276, 'specificity': 0.8959276, 'f1': 0.89530814, 'auroc': 0.936324, 'binary_precision': 0.96791446, 'binary_recall': 0.81900454, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.8872549}
confusion matrix:
     0    1
0  215    6
1   40  181
new oracle model saved
early stop counter: 18
val acc:0.8611764907836914, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8959276080131531
after epoch: 29,now: 2024-07-29 11:07:50.533742,epoch time: 0:01:45.845551,used: 0:48:46.664178,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9932345, 'precision': 0.99320436, 'recall': 0.9932717, 'specificity': 0.9932717, 'f1': 0.99323297, 'auroc': 0.99956936, 'binary_precision': 0.99554706, 'binary_recall': 0.99113363, 'binary_specificity': 0.99540985, 'binary_f1_score': 0.99333537}
confusion matrix:
      0     1
0  1518     7
1    14  1565
---- Validation: 
scalar performance:
{'acc': 0.7945098, 'precision': 0.8423041, 'recall': 0.7920048, 'specificity': 0.7920048, 'f1': 0.786087, 'auroc': 0.933591, 'binary_precision': 0.9669211, 'binary_recall': 0.60413355, 'binary_specificity': 0.97987616, 'binary_f1_score': 0.7436399}
confusion matrix:
     0    1
0  633   13
1  249  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7307692, 'precision': 0.81645894, 'recall': 0.7307692, 'specificity': 0.7307692, 'f1': 0.7112205, 'auroc': 0.9031602, 'binary_precision': 0.9811321, 'binary_recall': 0.47058824, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.6360856}
confusion matrix:
     0    1
0  219    2
1  117  104
early stop counter: 19
val acc:0.7945098280906677, best validation acc: 0.8752940893173218, corresponding to test acc:                         0.8733031749725342 / 0.8959276080131531
after epoch: 30,now: 2024-07-29 11:09:34.521171,epoch time: 0:01:43.987429,used: 0:50:30.651607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_12_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:50:30.651607 at 2024-07-29 11:09:34.521171
persisted model performance metric: 

scalar performance:
{'acc': 0.8733032, 'precision': 0.8887112, 'recall': 0.8733032, 'specificity': 0.8733032, 'f1': 0.872035, 'auroc': 0.93243384, 'binary_precision': 0.9661017, 'binary_recall': 0.77375567, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.85929644}
confusion matrix:
     0    1
0  215    6
1   50  171
oracle model performance metric: 

scalar performance:
{'acc': 0.8959276, 'precision': 0.90552586, 'recall': 0.8959276, 'specificity': 0.8959276, 'f1': 0.89530814, 'auroc': 0.936324, 'binary_precision': 0.96791446, 'binary_recall': 0.81900454, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.8872549}
confusion matrix:
     0    1
0  215    6
1   40  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456211 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool | 415616 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |  40595 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456211 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool | 415616 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |  40595 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB |    943 TiB |    943 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    932 TiB |    932 TiB |
|       from small pool |  40406 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB | 177416 MiB | 162940 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 177162 MiB | 162750 MiB |
|       from small pool |     64 MiB |     70 MiB |    254 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475628 KiB |   1260 MiB | 688135 GiB | 688135 GiB |
|       from large pool | 465024 KiB |   1256 MiB | 676658 GiB | 676658 GiB |
|       from small pool |  10604 KiB |     47 MiB |  11477 GiB |  11477 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  169772 K  |  169771 K  |
|       from large pool |     187    |    1413    |   86438 K  |   86438 K  |
|       from small pool |    1117    |    1419    |   83334 K  |   83333 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  169772 K  |  169771 K  |
|       from large pool |     187    |    1413    |   86438 K  |   86438 K  |
|       from small pool |    1117    |    1419    |   83334 K  |   83333 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    7495    |    6860    |
|       from large pool |     603    |     603    |    7368    |    6765    |
|       from small pool |      32    |      35    |     127    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     654    |  113883 K  |  113883 K  |
|       from large pool |      39    |     608    |   64583 K  |   64583 K  |
|       from small pool |      60    |     236    |   49300 K  |   49300 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    943 TiB |    943 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 177416 MiB | 176506 MiB |
|       from large pool |    860 MiB |  14424 MiB | 177162 MiB | 176302 MiB |
|       from small pool |     50 MiB |     70 MiB |    254 MiB |    204 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 688136 GiB | 688136 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 676658 GiB | 676658 GiB |
|       from small pool |      0 KiB |     47 MiB |  11477 GiB |  11477 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  169772 K  |  169772 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83334 K  |   83334 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  169772 K  |  169772 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83334 K  |   83334 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    7495    |    7430    |
|       from large pool |      40    |     603    |    7368    |    7328    |
|       from small pool |      25    |      35    |     127    |     102    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |  113884 K  |  113884 K  |
|       from large pool |       3    |     608    |   64583 K  |   64583 K  |
|       from small pool |       0    |     236    |   49300 K  |   49300 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    943 TiB |    943 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 177416 MiB | 176506 MiB |
|       from large pool |    860 MiB |  14424 MiB | 177162 MiB | 176302 MiB |
|       from small pool |     50 MiB |     70 MiB |    254 MiB |    204 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 688136 GiB | 688136 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 676658 GiB | 676658 GiB |
|       from small pool |      0 KiB |     47 MiB |  11477 GiB |  11477 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  169772 K  |  169772 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83334 K  |   83334 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  169772 K  |  169772 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83334 K  |   83334 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    7495    |    7430    |
|       from large pool |      40    |     603    |    7368    |    7328    |
|       from small pool |      25    |      35    |     127    |     102    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |  113884 K  |  113884 K  |
|       from large pool |       3    |     608    |   64583 K  |   64583 K  |
|       from small pool |       0    |     236    |   49300 K  |   49300 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368

 Experiment start at: 2024-07-29 11:10:22.513304
before training, model accuracy: 0.38596493005752563
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9631579, 'precision': 0.96332693, 'recall': 0.96350753, 'specificity': 0.96350753, 'f1': 0.9631566, 'auroc': 0.99325013, 'binary_precision': 0.9793883, 'binary_recall': 0.94787645, 'binary_specificity': 0.9791386, 'binary_f1_score': 0.9633748}
confusion matrix:
      0     1
0  1455    31
1    81  1473
---- Validation: 
scalar performance:
{'acc': 0.82253087, 'precision': 0.82926273, 'recall': 0.81846833, 'specificity': 0.81846833, 'f1': 0.81992173, 'auroc': 0.8944807, 'binary_precision': 0.865019, 'binary_recall': 0.7410423, 'binary_specificity': 0.8958944, 'binary_f1_score': 0.7982456}
confusion matrix:
     0    1
0  611   71
1  159  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84429824, 'precision': 0.8569961, 'recall': 0.84429824, 'specificity': 0.84429824, 'f1': 0.84290135, 'auroc': 0.9185326, 'binary_precision': 0.92432433, 'binary_recall': 0.75, 'binary_specificity': 0.9385965, 'binary_f1_score': 0.8280872}
confusion matrix:
     0    1
0  214   14
1   57  171
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 11:12:08.609628,epoch time: 0:01:46.096324,used: 0:01:46.096324,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9707237, 'precision': 0.97127354, 'recall': 0.9704219, 'specificity': 0.9704219, 'f1': 0.9706874, 'auroc': 0.9966612, 'binary_precision': 0.9598242, 'binary_recall': 0.98391247, 'binary_specificity': 0.95693135, 'binary_f1_score': 0.9717191}
confusion matrix:
      0     1
0  1422    64
1    25  1529
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83381766, 'recall': 0.8346595, 'specificity': 0.8346595, 'f1': 0.83327615, 'auroc': 0.8992688, 'binary_precision': 0.8024316, 'binary_recall': 0.85993487, 'binary_specificity': 0.80938417, 'binary_f1_score': 0.83018875}
confusion matrix:
     0    1
0  552  130
1   86  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86403507, 'precision': 0.8641472, 'recall': 0.8640351, 'specificity': 0.8640351, 'f1': 0.86402464, 'auroc': 0.9393852, 'binary_precision': 0.87053573, 'binary_recall': 0.8552632, 'binary_specificity': 0.872807, 'binary_f1_score': 0.86283195}
confusion matrix:
     0    1
0  199   29
1   33  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 11:13:47.511511,epoch time: 0:01:38.901883,used: 0:03:24.998207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.9831624, 'recall': 0.9832982, 'specificity': 0.9832982, 'f1': 0.98321736, 'auroc': 0.9988416, 'binary_precision': 0.98704666, 'binary_recall': 0.98006433, 'binary_specificity': 0.986532, 'binary_f1_score': 0.9835431}
confusion matrix:
      0     1
0  1465    20
1    31  1524
---- Validation: 
scalar performance:
{'acc': 0.7839506, 'precision': 0.7895325, 'recall': 0.77970046, 'specificity': 0.77970046, 'f1': 0.780691, 'auroc': 0.84716344, 'binary_precision': 0.8187023, 'binary_recall': 0.6986971, 'binary_specificity': 0.8607038, 'binary_f1_score': 0.7539543}
confusion matrix:
     0    1
0  587   95
1  185  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.877193, 'precision': 0.88216263, 'recall': 0.877193, 'specificity': 0.877193, 'f1': 0.87679243, 'auroc': 0.92834336, 'binary_precision': 0.92574257, 'binary_recall': 0.8201754, 'binary_specificity': 0.93421054, 'binary_f1_score': 0.86976737}
confusion matrix:
     0    1
0  213   15
1   41  187
new oracle model saved
early stop counter: 1
val acc:0.7839506268501282, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.8640350699424744 / 0.8771929740905762
after epoch: 3,now: 2024-07-29 11:15:29.813876,epoch time: 0:01:42.302365,used: 0:05:07.300572,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97039473, 'precision': 0.9720853, 'recall': 0.9697857, 'specificity': 0.9697857, 'f1': 0.9703244, 'auroc': 0.9988116, 'binary_precision': 0.94914216, 'binary_recall': 0.9955013, 'binary_specificity': 0.9440701, 'binary_f1_score': 0.97176915}
confusion matrix:
      0     1
0  1401    83
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.7685185, 'precision': 0.77751553, 'recall': 0.7729136, 'specificity': 0.7729136, 'f1': 0.76808554, 'auroc': 0.86449605, 'binary_precision': 0.71273714, 'binary_recall': 0.85667753, 'binary_specificity': 0.68914956, 'binary_f1_score': 0.7781065}
confusion matrix:
     0    1
0  470  212
1   88  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486842, 'precision': 0.85709924, 'recall': 0.8486842, 'specificity': 0.8486842, 'f1': 0.84778744, 'auroc': 0.95040786, 'binary_precision': 0.8022814, 'binary_recall': 0.9254386, 'binary_specificity': 0.7719298, 'binary_f1_score': 0.8594704}
confusion matrix:
     0    1
0  176   52
1   17  211
early stop counter: 2
val acc:0.7685185074806213, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.8640350699424744 / 0.8771929740905762
after epoch: 4,now: 2024-07-29 11:17:08.178785,epoch time: 0:01:38.364909,used: 0:06:45.665481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9802632, 'precision': 0.9808192, 'recall': 0.97996473, 'specificity': 0.97996473, 'f1': 0.9802382, 'auroc': 0.9987333, 'binary_precision': 0.9692404, 'binary_recall': 0.99292606, 'binary_specificity': 0.96700335, 'binary_f1_score': 0.9809403}
confusion matrix:
      0     1
0  1436    49
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8513164, 'recall': 0.84119093, 'specificity': 0.84119093, 'f1': 0.84282994, 'auroc': 0.9026073, 'binary_precision': 0.88742965, 'binary_recall': 0.7703583, 'binary_specificity': 0.9120235, 'binary_f1_score': 0.8247602}
confusion matrix:
     0    1
0  622   60
1  141  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88377196, 'precision': 0.89533913, 'recall': 0.8837719, 'specificity': 0.8837719, 'f1': 0.8829155, 'auroc': 0.93617266, 'binary_precision': 0.962963, 'binary_recall': 0.7982456, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.87290174}
confusion matrix:
     0    1
0  221    7
1   46  182
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 11:18:43.462739,epoch time: 0:01:35.283954,used: 0:08:20.949435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.98875225, 'recall': 0.98894274, 'specificity': 0.98894274, 'f1': 0.9888127, 'auroc': 0.99931574, 'binary_precision': 0.9947917, 'binary_recall': 0.983269, 'binary_specificity': 0.99461645, 'binary_f1_score': 0.98899674}
confusion matrix:
      0     1
0  1478     8
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.8140432, 'precision': 0.83487946, 'recall': 0.80723727, 'specificity': 0.80723727, 'f1': 0.8083695, 'auroc': 0.89552665, 'binary_precision': 0.90631807, 'binary_recall': 0.67752445, 'binary_specificity': 0.93695015, 'binary_f1_score': 0.7753961}
confusion matrix:
     0    1
0  639   43
1  198  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86403507, 'precision': 0.8840097, 'recall': 0.8640351, 'specificity': 0.8640351, 'f1': 0.86224365, 'auroc': 0.9257897, 'binary_precision': 0.97159094, 'binary_recall': 0.75, 'binary_specificity': 0.9780702, 'binary_f1_score': 0.8465346}
confusion matrix:
     0    1
0  223    5
1   57  171
early stop counter: 1
val acc:0.8140432238578796, best validation acc: 0.8449074029922485, corresponding to test acc:                         0.8837719559669495 / 0.8837719559669495
after epoch: 6,now: 2024-07-29 11:20:24.724614,epoch time: 0:01:41.261875,used: 0:10:02.211310,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95493424, 'precision': 0.9577682, 'recall': 0.9559486, 'specificity': 0.9559486, 'f1': 0.9549123, 'auroc': 0.9983548, 'binary_precision': 1.0, 'binary_recall': 0.9118971, 'binary_specificity': 1.0, 'binary_f1_score': 0.9539186}
confusion matrix:
      0     1
0  1485     0
1   137  1418
---- Validation: 
scalar performance:
{'acc': 0.6427469, 'precision': 0.7694269, 'recall': 0.62377614, 'specificity': 0.62377614, 'f1': 0.5769826, 'auroc': 0.87382686, 'binary_precision': 0.94152045, 'binary_recall': 0.262215, 'binary_specificity': 0.98533726, 'binary_f1_score': 0.41019106}
confusion matrix:
     0    1
0  672   10
1  453  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79385966, 'precision': 0.8540373, 'recall': 0.79385966, 'specificity': 0.79385966, 'f1': 0.78471124, 'auroc': 0.9146468, 'binary_precision': 1.0, 'binary_recall': 0.5877193, 'binary_specificity': 1.0, 'binary_f1_score': 0.74033153}
confusion matrix:
     0    1
0  228    0
1   94  134
early stop counter: 2
val acc:0.6427469253540039, best validation acc: 0.8449074029922485, corresponding to test acc:                         0.8837719559669495 / 0.8837719559669495
after epoch: 7,now: 2024-07-29 11:21:58.596772,epoch time: 0:01:33.872158,used: 0:11:36.083468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.9848044, 'recall': 0.98499334, 'specificity': 0.98499334, 'f1': 0.9848643, 'auroc': 0.9986575, 'binary_precision': 0.99088544, 'binary_recall': 0.97940797, 'binary_specificity': 0.9905787, 'binary_f1_score': 0.98511326}
confusion matrix:
      0     1
0  1472    14
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.78858024, 'precision': 0.8279798, 'recall': 0.77914643, 'specificity': 0.77914643, 'f1': 0.77775717, 'auroc': 0.86506927, 'binary_precision': 0.9292929, 'binary_recall': 0.59934855, 'binary_specificity': 0.95894426, 'binary_f1_score': 0.72871286}
confusion matrix:
     0    1
0  654   28
1  246  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8596491, 'precision': 0.8793831, 'recall': 0.8596491, 'specificity': 0.8596491, 'f1': 0.85779995, 'auroc': 0.9121268, 'binary_precision': 0.96590906, 'binary_recall': 0.74561405, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.84158415}
confusion matrix:
     0    1
0  222    6
1   58  170
early stop counter: 3
val acc:0.7885802388191223, best validation acc: 0.8449074029922485, corresponding to test acc:                         0.8837719559669495 / 0.8837719559669495
after epoch: 8,now: 2024-07-29 11:23:40.501879,epoch time: 0:01:41.905107,used: 0:13:17.988575,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.98785293, 'recall': 0.9880952, 'specificity': 0.9880952, 'f1': 0.98782766, 'auroc': 0.9997047, 'binary_precision': 1.0, 'binary_recall': 0.97619045, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879518}
confusion matrix:
      0     1
0  1486     0
1    37  1517
---- Validation: 
scalar performance:
{'acc': 0.8078704, 'precision': 0.84275126, 'recall': 0.7992611, 'specificity': 0.7992611, 'f1': 0.79935426, 'auroc': 0.9139769, 'binary_precision': 0.939759, 'binary_recall': 0.63517916, 'binary_specificity': 0.9633431, 'binary_f1_score': 0.75801754}
confusion matrix:
     0    1
0  657   25
1  224  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82894737, 'precision': 0.8700658, 'recall': 0.82894737, 'specificity': 0.82894737, 'f1': 0.82406014, 'auroc': 0.918321, 'binary_precision': 0.9934211, 'binary_recall': 0.6622807, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.7947368}
confusion matrix:
     0    1
0  227    1
1   77  151
early stop counter: 4
val acc:0.8078703880310059, best validation acc: 0.8449074029922485, corresponding to test acc:                         0.8837719559669495 / 0.8837719559669495
after epoch: 9,now: 2024-07-29 11:25:14.483916,epoch time: 0:01:33.982037,used: 0:14:51.970612,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.98517716, 'recall': 0.9854182, 'specificity': 0.9854182, 'f1': 0.98519516, 'auroc': 0.99903905, 'binary_precision': 0.9954038, 'binary_recall': 0.97554696, 'binary_specificity': 0.9952894, 'binary_f1_score': 0.98537534}
confusion matrix:
      0     1
0  1479     7
1    38  1516
---- Validation: 
scalar performance:
{'acc': 0.80478394, 'precision': 0.8282267, 'recall': 0.7974653, 'specificity': 0.7974653, 'f1': 0.79814714, 'auroc': 0.88756, 'binary_precision': 0.9038031, 'binary_recall': 0.65798044, 'binary_specificity': 0.93695015, 'binary_f1_score': 0.7615457}
confusion matrix:
     0    1
0  639   43
1  210  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8464912, 'precision': 0.87415874, 'recall': 0.8464912, 'specificity': 0.8464912, 'f1': 0.8435999, 'auroc': 0.9386734, 'binary_precision': 0.97590363, 'binary_recall': 0.7105263, 'binary_specificity': 0.98245615, 'binary_f1_score': 0.822335}
confusion matrix:
     0    1
0  224    4
1   66  162
early stop counter: 5
val acc:0.8047839403152466, best validation acc: 0.8449074029922485, corresponding to test acc:                         0.8837719559669495 / 0.8837719559669495
after epoch: 10,now: 2024-07-29 11:26:49.912748,epoch time: 0:01:35.428832,used: 0:16:27.399444,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9920892, 'recall': 0.9921156, 'specificity': 0.9921156, 'f1': 0.992102, 'auroc': 0.9993777, 'binary_precision': 0.99290323, 'binary_recall': 0.9916237, 'binary_specificity': 0.99260753, 'binary_f1_score': 0.9922631}
confusion matrix:
      0     1
0  1477    11
1    13  1539
---- Validation: 
scalar performance:
{'acc': 0.7839506, 'precision': 0.82676077, 'recall': 0.77409804, 'specificity': 0.77409804, 'f1': 0.7720603, 'auroc': 0.88774216, 'binary_precision': 0.93264246, 'binary_recall': 0.5863192, 'binary_specificity': 0.9618768, 'binary_f1_score': 0.71999997}
confusion matrix:
     0    1
0  656   26
1  254  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84429824, 'precision': 0.8727585, 'recall': 0.84429824, 'specificity': 0.84429824, 'f1': 0.8412685, 'auroc': 0.9148007, 'binary_precision': 0.9757576, 'binary_recall': 0.70614034, 'binary_specificity': 0.98245615, 'binary_f1_score': 0.8193385}
confusion matrix:
     0    1
0  224    4
1   67  161
early stop counter: 6
val acc:0.7839506268501282, best validation acc: 0.8449074029922485, corresponding to test acc:                         0.8837719559669495 / 0.8837719559669495
after epoch: 11,now: 2024-07-29 11:28:18.160986,epoch time: 0:01:28.248238,used: 0:17:55.647682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97763157, 'precision': 0.9785882, 'recall': 0.97722286, 'specificity': 0.97722286, 'f1': 0.9775955, 'auroc': 0.99916327, 'binary_precision': 0.9620647, 'binary_recall': 0.9954955, 'binary_specificity': 0.9589502, 'binary_f1_score': 0.97849464}
confusion matrix:
      0     1
0  1425    61
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.85493827, 'precision': 0.85918593, 'recall': 0.8519396, 'specificity': 0.8519396, 'f1': 0.85341775, 'auroc': 0.8998115, 'binary_precision': 0.8872727, 'binary_recall': 0.7947883, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.83848804}
confusion matrix:
     0    1
0  620   62
1  126  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8552632, 'precision': 0.85994387, 'recall': 0.8552631, 'specificity': 0.8552631, 'f1': 0.85479116, 'auroc': 0.9088181, 'binary_precision': 0.9009901, 'binary_recall': 0.7982456, 'binary_specificity': 0.9122807, 'binary_f1_score': 0.84651166}
confusion matrix:
     0    1
0  208   20
1   46  182
better model found
persisted
after epoch: 12,now: 2024-07-29 11:29:56.411299,epoch time: 0:01:38.250313,used: 0:19:33.897995,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.98845994, 'recall': 0.98871565, 'specificity': 0.98871565, 'f1': 0.988485, 'auroc': 0.9997038, 'binary_precision': 0.9986877, 'binary_recall': 0.9787781, 'binary_specificity': 0.9986532, 'binary_f1_score': 0.9886326}
confusion matrix:
      0     1
0  1483     2
1    33  1522
---- Validation: 
scalar performance:
{'acc': 0.6944444, 'precision': 0.7701919, 'recall': 0.67971665, 'specificity': 0.67971665, 'f1': 0.66046274, 'auroc': 0.8282523, 'binary_precision': 0.9007353, 'binary_recall': 0.3990228, 'binary_specificity': 0.96041054, 'binary_f1_score': 0.5530474}
confusion matrix:
     0    1
0  655   27
1  369  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7872807, 'precision': 0.8221381, 'recall': 0.7872807, 'specificity': 0.7872807, 'f1': 0.7813663, 'auroc': 0.8920052, 'binary_precision': 0.9281046, 'binary_recall': 0.622807, 'binary_specificity': 0.9517544, 'binary_f1_score': 0.7454068}
confusion matrix:
     0    1
0  217   11
1   86  142
early stop counter: 1
val acc:0.6944444179534912, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 13,now: 2024-07-29 11:31:42.491015,epoch time: 0:01:46.079716,used: 0:21:19.977711,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.98242414, 'recall': 0.98164356, 'specificity': 0.98164356, 'f1': 0.9818879, 'auroc': 0.9990746, 'binary_precision': 0.971051, 'binary_recall': 0.994201, 'binary_specificity': 0.96908605, 'binary_f1_score': 0.98248965}
confusion matrix:
      0     1
0  1442    46
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.7970679, 'precision': 0.83586705, 'recall': 0.78786045, 'specificity': 0.78786045, 'f1': 0.78705716, 'auroc': 0.89013445, 'binary_precision': 0.93765587, 'binary_recall': 0.6123778, 'binary_specificity': 0.9633431, 'binary_f1_score': 0.7408867}
confusion matrix:
     0    1
0  657   25
1  238  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8245614, 'precision': 0.8627763, 'recall': 0.82456136, 'specificity': 0.82456136, 'f1': 0.81981623, 'auroc': 0.9088373, 'binary_precision': 0.9805195, 'binary_recall': 0.6622807, 'binary_specificity': 0.9868421, 'binary_f1_score': 0.7905759}
confusion matrix:
     0    1
0  225    3
1   77  151
early stop counter: 2
val acc:0.7970678806304932, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 14,now: 2024-07-29 11:33:22.791203,epoch time: 0:01:40.300188,used: 0:23:00.277899,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934716, 'recall': 0.9933691, 'specificity': 0.9933691, 'f1': 0.9934165, 'auroc': 0.9997449, 'binary_precision': 0.99168265, 'binary_recall': 0.9955042, 'binary_specificity': 0.991234, 'binary_f1_score': 0.9935897}
confusion matrix:
      0     1
0  1470    13
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.8464506, 'precision': 0.86229736, 'recall': 0.84087086, 'specificity': 0.84087086, 'f1': 0.8428939, 'auroc': 0.91532373, 'binary_precision': 0.926078, 'binary_recall': 0.7345277, 'binary_specificity': 0.94721407, 'binary_f1_score': 0.81925523}
confusion matrix:
     0    1
0  646   36
1  163  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872807, 'precision': 0.888626, 'recall': 0.872807, 'specificity': 0.872807, 'f1': 0.87149936, 'auroc': 0.937096, 'binary_precision': 0.96703297, 'binary_recall': 0.7719298, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.85853654}
confusion matrix:
     0    1
0  222    6
1   52  176
early stop counter: 3
val acc:0.8464506268501282, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 15,now: 2024-07-29 11:35:04.547630,epoch time: 0:01:41.756427,used: 0:24:42.034326,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9802632, 'precision': 0.9805951, 'recall': 0.980695, 'specificity': 0.980695, 'f1': 0.980263, 'auroc': 0.99976444, 'binary_precision': 1.0, 'binary_recall': 0.96138996, 'binary_specificity': 1.0, 'binary_f1_score': 0.9803149}
confusion matrix:
      0     1
0  1486     0
1    60  1494
---- Validation: 
scalar performance:
{'acc': 0.60262346, 'precision': 0.7664219, 'recall': 0.5809437, 'specificity': 0.5809437, 'f1': 0.5052302, 'auroc': 0.8894055, 'binary_precision': 0.9626168, 'binary_recall': 0.16775244, 'binary_specificity': 0.9941349, 'binary_f1_score': 0.2857143}
confusion matrix:
     0    1
0  678    4
1  511  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5899123, 'precision': 0.7746988, 'recall': 0.5899123, 'specificity': 0.5899123, 'f1': 0.50700426, 'auroc': 0.9157096, 'binary_precision': 1.0, 'binary_recall': 0.17982456, 'binary_specificity': 1.0, 'binary_f1_score': 0.3048327}
confusion matrix:
     0   1
0  228   0
1  187  41
early stop counter: 4
val acc:0.602623462677002, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 16,now: 2024-07-29 11:36:48.829296,epoch time: 0:01:44.281666,used: 0:26:26.315992,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.9921958, 'recall': 0.9920253, 'specificity': 0.9920253, 'f1': 0.99209976, 'auroc': 0.9997674, 'binary_precision': 0.98913735, 'binary_recall': 0.9954984, 'binary_specificity': 0.9885522, 'binary_f1_score': 0.99230766}
confusion matrix:
      0     1
0  1468    17
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.80169755, 'precision': 0.83128333, 'recall': 0.7935584, 'specificity': 0.7935584, 'f1': 0.79371125, 'auroc': 0.8918872, 'binary_precision': 0.91803277, 'binary_recall': 0.6384365, 'binary_specificity': 0.94868034, 'binary_f1_score': 0.75312203}
confusion matrix:
     0    1
0  647   35
1  222  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83114034, 'precision': 0.8737705, 'recall': 0.83114034, 'specificity': 0.83114034, 'f1': 0.8261843, 'auroc': 0.9308056, 'binary_precision': 1.0, 'binary_recall': 0.6622807, 'binary_specificity': 1.0, 'binary_f1_score': 0.79683375}
confusion matrix:
     0    1
0  228    0
1   77  151
early stop counter: 5
val acc:0.8016975522041321, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 17,now: 2024-07-29 11:38:30.905617,epoch time: 0:01:42.076321,used: 0:28:08.392313,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.9930317, 'recall': 0.9931843, 'specificity': 0.9931843, 'f1': 0.9930898, 'auroc': 0.99982035, 'binary_precision': 0.9974043, 'binary_recall': 0.98906046, 'binary_specificity': 0.9973082, 'binary_f1_score': 0.99321485}
confusion matrix:
      0     1
0  1482     4
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.6743827, 'precision': 0.7863782, 'recall': 0.65716374, 'specificity': 0.65716374, 'f1': 0.625073, 'auroc': 0.87477016, 'binary_precision': 0.9528302, 'binary_recall': 0.32899022, 'binary_specificity': 0.98533726, 'binary_f1_score': 0.48910412}
confusion matrix:
     0    1
0  672   10
1  412  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64254385, 'precision': 0.7915601, 'recall': 0.64254385, 'specificity': 0.64254385, 'f1': 0.590179, 'auroc': 0.9077023, 'binary_precision': 1.0, 'binary_recall': 0.2850877, 'binary_specificity': 1.0, 'binary_f1_score': 0.44368598}
confusion matrix:
     0   1
0  228   0
1  163  65
early stop counter: 6
val acc:0.6743826866149902, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 18,now: 2024-07-29 11:40:15.452730,epoch time: 0:01:44.547113,used: 0:29:52.939426,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99539477, 'precision': 0.99534166, 'recall': 0.99546605, 'specificity': 0.99546605, 'f1': 0.99539304, 'auroc': 0.9999403, 'binary_precision': 0.9987047, 'binary_recall': 0.992278, 'binary_specificity': 0.9986541, 'binary_f1_score': 0.99548095}
confusion matrix:
      0     1
0  1484     2
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.7623457, 'precision': 0.81336737, 'recall': 0.7512967, 'specificity': 0.7512967, 'f1': 0.74650204, 'auroc': 0.88393974, 'binary_precision': 0.9273743, 'binary_recall': 0.5407166, 'binary_specificity': 0.9618768, 'binary_f1_score': 0.6831275}
confusion matrix:
     0    1
0  656   26
1  282  332
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81798244, 'precision': 0.8639126, 'recall': 0.81798244, 'specificity': 0.81798244, 'f1': 0.81205213, 'auroc': 0.9196147, 'binary_precision': 0.99319726, 'binary_recall': 0.6403509, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.7786667}
confusion matrix:
     0    1
0  227    1
1   82  146
early stop counter: 7
val acc:0.7623456716537476, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 19,now: 2024-07-29 11:41:55.571380,epoch time: 0:01:40.118650,used: 0:31:33.058076,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9946859, 'recall': 0.9948058, 'specificity': 0.9948058, 'f1': 0.9947351, 'auroc': 0.9997562, 'binary_precision': 0.99805576, 'binary_recall': 0.9916291, 'binary_specificity': 0.9979825, 'binary_f1_score': 0.9948321}
confusion matrix:
      0     1
0  1484     3
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.60339504, 'precision': 0.7756195, 'recall': 0.5815956, 'specificity': 0.5815956, 'f1': 0.50492144, 'auroc': 0.86353666, 'binary_precision': 0.9807692, 'binary_recall': 0.16612378, 'binary_specificity': 0.99706745, 'binary_f1_score': 0.28412256}
confusion matrix:
     0    1
0  680    2
1  512  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6052632, 'precision': 0.7794118, 'recall': 0.6052632, 'specificity': 0.6052632, 'f1': 0.5324036, 'auroc': 0.9135888, 'binary_precision': 1.0, 'binary_recall': 0.21052632, 'binary_specificity': 1.0, 'binary_f1_score': 0.3478261}
confusion matrix:
     0   1
0  228   0
1  180  48
early stop counter: 8
val acc:0.6033950448036194, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 20,now: 2024-07-29 11:43:41.862864,epoch time: 0:01:46.291484,used: 0:33:19.349560,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9950658, 'precision': 0.9951492, 'recall': 0.99499285, 'specificity': 0.99499285, 'f1': 0.9950623, 'auroc': 0.9999559, 'binary_precision': 0.9923323, 'binary_recall': 0.99807197, 'binary_specificity': 0.99191374, 'binary_f1_score': 0.99519384}
confusion matrix:
      0     1
0  1472    12
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.81867284, 'precision': 0.8469124, 'recall': 0.8109865, 'specificity': 0.8109865, 'f1': 0.8119525, 'auroc': 0.8988676, 'binary_precision': 0.93363845, 'binary_recall': 0.6644951, 'binary_specificity': 0.957478, 'binary_f1_score': 0.77640337}
confusion matrix:
     0    1
0  653   29
1  206  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486842, 'precision': 0.8816402, 'recall': 0.8486842, 'specificity': 0.8486842, 'f1': 0.8453455, 'auroc': 0.9357302, 'binary_precision': 0.99378884, 'binary_recall': 0.7017544, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.82262206}
confusion matrix:
     0    1
0  227    1
1   68  160
early stop counter: 9
val acc:0.8186728358268738, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 21,now: 2024-07-29 11:45:24.622037,epoch time: 0:01:42.759173,used: 0:35:02.108733,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.9853229, 'recall': 0.9855026, 'specificity': 0.9855026, 'f1': 0.98519677, 'auroc': 0.99940634, 'binary_precision': 1.0, 'binary_recall': 0.97100514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9852893}
confusion matrix:
      0     1
0  1488     0
1    45  1507
---- Validation: 
scalar performance:
{'acc': 0.66589504, 'precision': 0.79089296, 'recall': 0.6478813, 'specificity': 0.6478813, 'f1': 0.6104339, 'auroc': 0.8888878, 'binary_precision': 0.96891195, 'binary_recall': 0.30456027, 'binary_specificity': 0.99120235, 'binary_f1_score': 0.46344486}
confusion matrix:
     0    1
0  676    6
1  427  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5767544, 'precision': 0.77078384, 'recall': 0.5767544, 'specificity': 0.5767544, 'f1': 0.48438954, 'auroc': 0.912199, 'binary_precision': 1.0, 'binary_recall': 0.15350877, 'binary_specificity': 1.0, 'binary_f1_score': 0.26615968}
confusion matrix:
     0   1
0  228   0
1  193  35
early stop counter: 10
val acc:0.6658950448036194, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 22,now: 2024-07-29 11:46:57.372405,epoch time: 0:01:32.750368,used: 0:36:34.859101,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9947495, 'recall': 0.9947195, 'specificity': 0.9947195, 'f1': 0.99473405, 'auroc': 0.9998636, 'binary_precision': 0.99421597, 'binary_recall': 0.9954955, 'binary_specificity': 0.99394345, 'binary_f1_score': 0.9948553}
confusion matrix:
      0     1
0  1477     9
1     7  1547
---- Validation: 
scalar performance:
{'acc': 0.8433642, 'precision': 0.8621745, 'recall': 0.83728874, 'specificity': 0.83728874, 'f1': 0.83926356, 'auroc': 0.90592194, 'binary_precision': 0.93263155, 'binary_recall': 0.72149837, 'binary_specificity': 0.95307916, 'binary_f1_score': 0.8135904}
confusion matrix:
     0    1
0  650   32
1  171  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83114034, 'precision': 0.8689637, 'recall': 0.83114034, 'specificity': 0.83114034, 'f1': 0.826699, 'auroc': 0.92161536, 'binary_precision': 0.9870968, 'binary_recall': 0.67105263, 'binary_specificity': 0.99122804, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  226    2
1   75  153
early stop counter: 11
val acc:0.8433641791343689, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 23,now: 2024-07-29 11:48:30.113460,epoch time: 0:01:32.741055,used: 0:38:07.600156,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.9914755, 'recall': 0.9914125, 'specificity': 0.9914125, 'f1': 0.9914423, 'auroc': 0.9998021, 'binary_precision': 0.99037844, 'binary_recall': 0.99292606, 'binary_specificity': 0.989899, 'binary_f1_score': 0.99165064}
confusion matrix:
      0     1
0  1470    15
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.8109568, 'precision': 0.8396418, 'recall': 0.8030868, 'specificity': 0.8030868, 'f1': 0.80371106, 'auroc': 0.8788562, 'binary_precision': 0.926097, 'binary_recall': 0.6530945, 'binary_specificity': 0.95307916, 'binary_f1_score': 0.7659981}
confusion matrix:
     0    1
0  650   32
1  213  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8464912, 'precision': 0.8803209, 'recall': 0.8464912, 'specificity': 0.8464912, 'f1': 0.8429999, 'auroc': 0.914844, 'binary_precision': 0.99375, 'binary_recall': 0.69736844, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.8195876}
confusion matrix:
     0    1
0  227    1
1   69  159
early stop counter: 12
val acc:0.8109567761421204, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 24,now: 2024-07-29 11:50:28.939536,epoch time: 0:01:58.826076,used: 0:40:06.426232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9944079, 'precision': 0.9944291, 'recall': 0.9943822, 'specificity': 0.9943822, 'f1': 0.9944047, 'auroc': 0.99977744, 'binary_precision': 0.99358153, 'binary_recall': 0.9954984, 'binary_specificity': 0.993266, 'binary_f1_score': 0.9945391}
confusion matrix:
      0     1
0  1475    10
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.7893519, 'precision': 0.838354, 'recall': 0.77906764, 'specificity': 0.77906764, 'f1': 0.7768289, 'auroc': 0.9075458, 'binary_precision': 0.9546667, 'binary_recall': 0.5830619, 'binary_specificity': 0.97507334, 'binary_f1_score': 0.72396356}
confusion matrix:
     0    1
0  665   17
1  256  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81798244, 'precision': 0.8665595, 'recall': 0.81798244, 'specificity': 0.81798244, 'f1': 0.8117455, 'auroc': 0.92515004, 'binary_precision': 1.0, 'binary_recall': 0.63596493, 'binary_specificity': 1.0, 'binary_f1_score': 0.77747995}
confusion matrix:
     0    1
0  228    0
1   83  145
early stop counter: 13
val acc:0.7893518805503845, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 25,now: 2024-07-29 11:52:04.700947,epoch time: 0:01:35.761411,used: 0:41:42.187643,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99407893, 'precision': 0.9941712, 'recall': 0.994, 'specificity': 0.994, 'f1': 0.9940748, 'auroc': 0.999874, 'binary_precision': 0.9910543, 'binary_recall': 0.99742764, 'binary_specificity': 0.9905724, 'binary_f1_score': 0.99423075}
confusion matrix:
      0     1
0  1471    14
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.84799385, 'precision': 0.8671594, 'recall': 0.84193116, 'specificity': 0.84193116, 'f1': 0.8440144, 'auroc': 0.9036169, 'binary_precision': 0.9389474, 'binary_recall': 0.72638434, 'binary_specificity': 0.957478, 'binary_f1_score': 0.8191001}
confusion matrix:
     0    1
0  653   29
1  168  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872807, 'precision': 0.8986014, 'recall': 0.872807, 'specificity': 0.872807, 'f1': 0.87071544, 'auroc': 0.9380579, 'binary_precision': 1.0, 'binary_recall': 0.74561405, 'binary_specificity': 1.0, 'binary_f1_score': 0.85427135}
confusion matrix:
     0    1
0  228    0
1   58  170
early stop counter: 14
val acc:0.8479938507080078, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 26,now: 2024-07-29 11:53:40.086247,epoch time: 0:01:35.385300,used: 0:43:17.572943,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.9883206, 'recall': 0.98757315, 'specificity': 0.98757315, 'f1': 0.9878155, 'auroc': 0.9999294, 'binary_precision': 0.97732997, 'binary_recall': 0.9993561, 'binary_specificity': 0.9757902, 'binary_f1_score': 0.98822033}
confusion matrix:
      0     1
0  1451    36
1     1  1552
---- Validation: 
scalar performance:
{'acc': 0.837963, 'precision': 0.84559786, 'recall': 0.83386195, 'specificity': 0.83386195, 'f1': 0.83551836, 'auroc': 0.8950108, 'binary_precision': 0.8854962, 'binary_recall': 0.75570035, 'binary_specificity': 0.9120235, 'binary_f1_score': 0.81546575}
confusion matrix:
     0    1
0  622   60
1  150  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.877193, 'precision': 0.8868371, 'recall': 0.877193, 'specificity': 0.877193, 'f1': 0.87642276, 'auroc': 0.9361534, 'binary_precision': 0.9479167, 'binary_recall': 0.7982456, 'binary_specificity': 0.95614034, 'binary_f1_score': 0.8666667}
confusion matrix:
     0    1
0  218   10
1   46  182
early stop counter: 15
val acc:0.8379629850387573, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 27,now: 2024-07-29 11:55:30.674307,epoch time: 0:01:50.588060,used: 0:45:08.161003,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.99077225, 'recall': 0.9907994, 'specificity': 0.9907994, 'f1': 0.99078536, 'auroc': 0.99963415, 'binary_precision': 0.99161834, 'binary_recall': 0.99034125, 'binary_specificity': 0.99125755, 'binary_f1_score': 0.9909794}
confusion matrix:
      0     1
0  1474    13
1    15  1538
---- Validation: 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8427234, 'recall': 0.80186653, 'specificity': 0.80186653, 'f1': 0.80222523, 'auroc': 0.89281917, 'binary_precision': 0.93601894, 'binary_recall': 0.64332247, 'binary_specificity': 0.96041054, 'binary_f1_score': 0.7625482}
confusion matrix:
     0    1
0  655   27
1  219  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8201754, 'precision': 0.8651281, 'recall': 0.8201754, 'specificity': 0.8201754, 'f1': 0.8144649, 'auroc': 0.9096645, 'binary_precision': 0.9932432, 'binary_recall': 0.6447368, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.78191495}
confusion matrix:
     0    1
0  227    1
1   81  147
early stop counter: 16
val acc:0.8101851940155029, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 28,now: 2024-07-29 11:56:58.781812,epoch time: 0:01:28.107505,used: 0:46:36.268508,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9888688, 'recall': 0.988261, 'specificity': 0.988261, 'f1': 0.9884746, 'auroc': 0.9998411, 'binary_precision': 0.97979796, 'binary_recall': 0.9980707, 'binary_specificity': 0.9784512, 'binary_f1_score': 0.98884994}
confusion matrix:
      0     1
0  1453    32
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.7993827, 'precision': 0.84070706, 'recall': 0.78997874, 'specificity': 0.78997874, 'f1': 0.7891127, 'auroc': 0.9001936, 'binary_precision': 0.9469697, 'binary_recall': 0.6107492, 'binary_specificity': 0.96920824, 'binary_f1_score': 0.7425743}
confusion matrix:
     0    1
0  661   21
1  239  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84429824, 'precision': 0.87683964, 'recall': 0.84429824, 'specificity': 0.84429824, 'f1': 0.84086275, 'auroc': 0.9291802, 'binary_precision': 0.9875776, 'binary_recall': 0.69736844, 'binary_specificity': 0.99122804, 'binary_f1_score': 0.8174807}
confusion matrix:
     0    1
0  226    2
1   69  159
early stop counter: 17
val acc:0.7993826866149902, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 29,now: 2024-07-29 11:58:45.922486,epoch time: 0:01:47.140674,used: 0:48:23.409182,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99671054, 'precision': 0.9966744, 'recall': 0.99675184, 'specificity': 0.99675184, 'f1': 0.9967093, 'auroc': 0.999987, 'binary_precision': 0.9987072, 'binary_recall': 0.99484867, 'binary_specificity': 0.998655, 'binary_f1_score': 0.99677426}
confusion matrix:
      0     1
0  1485     2
1     8  1545
---- Validation: 
scalar performance:
{'acc': 0.787037, 'precision': 0.83699906, 'recall': 0.7766246, 'specificity': 0.7766246, 'f1': 0.7741128, 'auroc': 0.9033123, 'binary_precision': 0.95430106, 'binary_recall': 0.5781759, 'binary_specificity': 0.97507334, 'binary_f1_score': 0.72008115}
confusion matrix:
     0    1
0  665   17
1  259  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377193, 'precision': 0.8774835, 'recall': 0.8377193, 'specificity': 0.8377193, 'f1': 0.83333004, 'auroc': 0.9308057, 'binary_precision': 1.0, 'binary_recall': 0.6754386, 'binary_specificity': 1.0, 'binary_f1_score': 0.8062827}
confusion matrix:
     0    1
0  228    0
1   74  154
early stop counter: 18
val acc:0.7870370149612427, best validation acc: 0.854938268661499, corresponding to test acc:                         0.8552631735801697 / 0.8837719559669495
after epoch: 30,now: 2024-07-29 12:00:25.440014,epoch time: 0:01:39.517528,used: 0:50:02.926710,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_10_22_seed_13_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:50:02.926710 at 2024-07-29 12:00:25.440014
persisted model performance metric: 

scalar performance:
{'acc': 0.8552632, 'precision': 0.85994387, 'recall': 0.8552631, 'specificity': 0.8552631, 'f1': 0.85479116, 'auroc': 0.9088181, 'binary_precision': 0.9009901, 'binary_recall': 0.7982456, 'binary_specificity': 0.9122807, 'binary_f1_score': 0.84651166}
confusion matrix:
     0    1
0  208   20
1   46  182
oracle model performance metric: 

scalar performance:
{'acc': 0.88377196, 'precision': 0.89533913, 'recall': 0.8837719, 'specificity': 0.8837719, 'f1': 0.8829155, 'auroc': 0.93617266, 'binary_precision': 0.962963, 'binary_recall': 0.7982456, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.87290174}
confusion matrix:
     0    1
0  221    7
1   46  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456214 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool | 415616 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |  40598 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456214 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool | 415616 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |  40598 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB |   1013 TiB |   1013 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1001 TiB |   1001 TiB |
|       from small pool |  40407 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14488 MiB | 190984 MiB | 176506 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 190714 MiB | 176302 MiB |
|       from small pool |     66 MiB |     70 MiB |    270 MiB |    204 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475625 KiB |   1260 MiB | 739370 GiB | 739369 GiB |
|       from large pool | 465024 KiB |   1256 MiB | 727034 GiB | 727033 GiB |
|       from small pool |  10601 KiB |     47 MiB |  12336 GiB |  12336 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  182439 K  |  182438 K  |
|       from large pool |     187    |    1413    |   92848 K  |   92848 K  |
|       from small pool |    1123    |    1419    |   89591 K  |   89589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  182439 K  |  182438 K  |
|       from large pool |     187    |    1413    |   92848 K  |   92848 K  |
|       from small pool |    1123    |    1419    |   89591 K  |   89589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    8066    |    7430    |
|       from large pool |     603    |     603    |    7931    |    7328    |
|       from small pool |      33    |      35    |     135    |     102    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     654    |  122564 K  |  122564 K  |
|       from large pool |      39    |     608    |   69531 K  |   69531 K  |
|       from small pool |      60    |     236    |   53033 K  |   53033 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1013 TiB |   1013 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1001 TiB |   1001 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 190984 MiB | 190074 MiB |
|       from large pool |    860 MiB |  14424 MiB | 190714 MiB | 189854 MiB |
|       from small pool |     50 MiB |     70 MiB |    270 MiB |    220 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 739370 GiB | 739370 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 727034 GiB | 727034 GiB |
|       from small pool |      0 KiB |     47 MiB |  12336 GiB |  12336 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  182439 K  |  182439 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89591 K  |   89591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  182439 K  |  182439 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89591 K  |   89591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    8066    |    8001    |
|       from large pool |      40    |     603    |    7931    |    7891    |
|       from small pool |      25    |      35    |     135    |     110    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |  122565 K  |  122565 K  |
|       from large pool |       3    |     608    |   69531 K  |   69531 K  |
|       from small pool |       0    |     236    |   53033 K  |   53033 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1013 TiB |   1013 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1001 TiB |   1001 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 190984 MiB | 190074 MiB |
|       from large pool |    860 MiB |  14424 MiB | 190714 MiB | 189854 MiB |
|       from small pool |     50 MiB |     70 MiB |    270 MiB |    220 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 739370 GiB | 739370 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 727034 GiB | 727034 GiB |
|       from small pool |      0 KiB |     47 MiB |  12336 GiB |  12336 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  182439 K  |  182439 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89591 K  |   89591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  182439 K  |  182439 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89591 K  |   89591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    8066    |    8001    |
|       from large pool |      40    |     603    |    7931    |    7891    |
|       from small pool |      25    |      35    |     135    |     110    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     654    |  122565 K  |  122565 K  |
|       from large pool |       3    |     608    |   69531 K  |   69531 K  |
|       from small pool |       0    |     236    |   53033 K  |   53033 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368

 Experiment start at: 2024-07-29 12:01:07.573995
before training, model accuracy: 0.5177778005599976
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9051047, 'precision': 0.91942227, 'recall': 0.90565264, 'specificity': 0.90565264, 'f1': 0.90436924, 'auroc': 0.9842961, 'binary_precision': 0.9984013, 'binary_recall': 0.812622, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.89598286}
confusion matrix:
      0     1
0  1517     2
1   288  1249
---- Validation: 
scalar performance:
{'acc': 0.68046874, 'precision': 0.719901, 'recall': 0.67635596, 'specificity': 0.67635596, 'f1': 0.66228676, 'auroc': 0.8106756, 'binary_precision': 0.8084507, 'binary_recall': 0.45700637, 'binary_specificity': 0.8957055, 'binary_f1_score': 0.58392674}
confusion matrix:
     0    1
0  584   68
1  341  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.77995396, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.7303803, 'auroc': 0.8613728, 'binary_precision': 0.8857143, 'binary_recall': 0.5511111, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.67945206}
confusion matrix:
     0    1
0  209   16
1  101  124
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 12:03:02.095437,epoch time: 0:01:54.521442,used: 0:01:54.521442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9568063, 'precision': 0.9578322, 'recall': 0.95665884, 'specificity': 0.95665884, 'f1': 0.9567704, 'auroc': 0.9937495, 'binary_precision': 0.9377335, 'binary_recall': 0.97919375, 'binary_specificity': 0.9341239, 'binary_f1_score': 0.9580152}
confusion matrix:
      0     1
0  1418   100
1    32  1506
---- Validation: 
scalar performance:
{'acc': 0.8046875, 'precision': 0.8216645, 'recall': 0.8068168, 'specificity': 0.8068168, 'f1': 0.80277646, 'auroc': 0.9091331, 'binary_precision': 0.7429306, 'binary_recall': 0.92038214, 'binary_specificity': 0.69325155, 'binary_f1_score': 0.82219064}
confusion matrix:
     0    1
0  452  200
1   50  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8223073, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7859312, 'auroc': 0.9350321, 'binary_precision': 0.7220339, 'binary_recall': 0.94666666, 'binary_specificity': 0.63555557, 'binary_f1_score': 0.8192308}
confusion matrix:
     0    1
0  143   82
1   12  213
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 12:04:45.651145,epoch time: 0:01:43.555708,used: 0:03:38.077150,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9597513, 'precision': 0.9619449, 'recall': 0.9600341, 'specificity': 0.9600341, 'f1': 0.95971864, 'auroc': 0.9942107, 'binary_precision': 0.99580127, 'binary_recall': 0.92402595, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9585719}
confusion matrix:
      0     1
0  1510     6
1   117  1423
---- Validation: 
scalar performance:
{'acc': 0.815625, 'precision': 0.8155787, 'recall': 0.8156774, 'specificity': 0.8156774, 'f1': 0.8155962, 'auroc': 0.89347327, 'binary_precision': 0.8081761, 'binary_recall': 0.8184713, 'binary_specificity': 0.81288344, 'binary_f1_score': 0.81329113}
confusion matrix:
     0    1
0  530  122
1  114  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8344498, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83319414, 'auroc': 0.91585183, 'binary_precision': 0.8537736, 'binary_recall': 0.80444443, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8283753}
confusion matrix:
     0    1
0  194   31
1   44  181
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 12:06:35.823324,epoch time: 0:01:50.172179,used: 0:05:28.249329,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.9733176, 'recall': 0.9729415, 'specificity': 0.9729415, 'f1': 0.9728368, 'auroc': 0.99637985, 'binary_precision': 0.9898922, 'binary_recall': 0.955758, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.9725257}
confusion matrix:
      0     1
0  1504    15
1    68  1469
---- Validation: 
scalar performance:
{'acc': 0.825, 'precision': 0.8249407, 'recall': 0.8250264, 'specificity': 0.8250264, 'f1': 0.82496536, 'auroc': 0.8946432, 'binary_precision': 0.818612, 'binary_recall': 0.8264331, 'binary_specificity': 0.8236196, 'binary_f1_score': 0.822504}
confusion matrix:
     0    1
0  537  115
1  109  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8503274, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8462651, 'auroc': 0.927763, 'binary_precision': 0.8861386, 'binary_recall': 0.79555553, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8384075}
confusion matrix:
     0    1
0  202   23
1   46  179
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 12:08:06.617734,epoch time: 0:01:30.794410,used: 0:06:59.043739,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9525524, 'precision': 0.95599896, 'recall': 0.95281476, 'specificity': 0.95281476, 'f1': 0.9524803, 'auroc': 0.9957155, 'binary_precision': 0.99714285, 'binary_recall': 0.90826285, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.95062983}
confusion matrix:
      0     1
0  1515     4
1   141  1396
---- Validation: 
scalar performance:
{'acc': 0.75078124, 'precision': 0.79622316, 'recall': 0.74704486, 'specificity': 0.74704486, 'f1': 0.73890424, 'auroc': 0.89419377, 'binary_precision': 0.9076517, 'binary_recall': 0.5477707, 'binary_specificity': 0.94631904, 'binary_f1_score': 0.68321747}
confusion matrix:
     0    1
0  617   35
1  284  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8631282, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8323735, 'auroc': 0.9320099, 'binary_precision': 0.9631902, 'binary_recall': 0.69777775, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8092783}
confusion matrix:
     0    1
0  219    6
1   68  157
early stop counter: 1
val acc:0.750781238079071, best validation acc: 0.824999988079071, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 5,now: 2024-07-29 12:09:57.811152,epoch time: 0:01:51.193418,used: 0:08:50.237157,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9698953, 'precision': 0.97021794, 'recall': 0.96996987, 'specificity': 0.96996987, 'f1': 0.96989286, 'auroc': 0.99637556, 'binary_precision': 0.9839142, 'binary_recall': 0.9557292, 'binary_specificity': 0.98421055, 'binary_f1_score': 0.96961695}
confusion matrix:
      0     1
0  1496    24
1    68  1468
---- Validation: 
scalar performance:
{'acc': 0.7679688, 'precision': 0.78963715, 'recall': 0.7704808, 'specificity': 0.7704808, 'f1': 0.7646055, 'auroc': 0.8876754, 'binary_precision': 0.70559007, 'binary_recall': 0.9044586, 'binary_specificity': 0.63650304, 'binary_f1_score': 0.7927425}
confusion matrix:
     0    1
0  415  237
1   60  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69777775, 'precision': 0.7728127, 'recall': 0.69777775, 'specificity': 0.69777775, 'f1': 0.67546237, 'auroc': 0.92525434, 'binary_precision': 0.6297376, 'binary_recall': 0.96, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.7605634}
confusion matrix:
    0    1
0  98  127
1   9  216
early stop counter: 2
val acc:0.7679687738418579, best validation acc: 0.824999988079071, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 6,now: 2024-07-29 12:11:33.800957,epoch time: 0:01:35.989805,used: 0:10:26.226962,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98089015, 'recall': 0.9807532, 'specificity': 0.9807532, 'f1': 0.980693, 'auroc': 0.9981111, 'binary_precision': 0.99200535, 'binary_recall': 0.96940106, 'binary_specificity': 0.99210525, 'binary_f1_score': 0.98057294}
confusion matrix:
      0     1
0  1508    12
1    47  1489
---- Validation: 
scalar performance:
{'acc': 0.7890625, 'precision': 0.798108, 'recall': 0.7873764, 'specificity': 0.7873764, 'f1': 0.7867251, 'auroc': 0.8720571, 'binary_precision': 0.84555984, 'binary_recall': 0.69745225, 'binary_specificity': 0.8773006, 'binary_f1_score': 0.76439786}
confusion matrix:
     0    1
0  572   80
1  190  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.84522957, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8418778, 'auroc': 0.9145679, 'binary_precision': 0.877451, 'binary_recall': 0.79555553, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8344988}
confusion matrix:
     0    1
0  200   25
1   46  179
early stop counter: 3
val acc:0.7890625, best validation acc: 0.824999988079071, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 7,now: 2024-07-29 12:13:27.698334,epoch time: 0:01:53.897377,used: 0:12:20.124339,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9617147, 'precision': 0.9641983, 'recall': 0.96198833, 'specificity': 0.96198833, 'f1': 0.9616776, 'auroc': 0.9979929, 'binary_precision': 1.0, 'binary_recall': 0.9239766, 'binary_specificity': 1.0, 'binary_f1_score': 0.9604863}
confusion matrix:
      0     1
0  1517     0
1   117  1422
---- Validation: 
scalar performance:
{'acc': 0.5210937, 'precision': 0.6466702, 'recall': 0.5121185, 'specificity': 0.5121185, 'f1': 0.37116867, 'auroc': 0.8438386, 'binary_precision': 0.7777778, 'binary_recall': 0.03343949, 'binary_specificity': 0.9907975, 'binary_f1_score': 0.06412214}
confusion matrix:
     0   1
0  646   6
1  607  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.7487919, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.45698544, 'auroc': 0.89892346, 'binary_precision': 0.9655172, 'binary_recall': 0.12444445, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.22047244}
confusion matrix:
     0   1
0  224   1
1  197  28
early stop counter: 4
val acc:0.5210937261581421, best validation acc: 0.824999988079071, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 8,now: 2024-07-29 12:15:02.622136,epoch time: 0:01:34.923802,used: 0:13:55.048141,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_12_01_07_seed_14_23190368
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
slurmstepd: error: *** JOB 23190368 ON supergpu02 CANCELLED AT 2024-07-29T12:16:35 ***
