Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 29 01:18:47 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369

 Experiment start at: 2024-07-29 01:22:14.587746
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9527995, 'precision': 0.9535373, 'recall': 0.95313025, 'specificity': 0.95313025, 'f1': 0.9527953, 'auroc': 0.9895685, 'binary_precision': 0.9757576, 'binary_recall': 0.9300385, 'binary_specificity': 0.9762219, 'binary_f1_score': 0.9523497}
confusion matrix:
      0     1
0  1478    36
1   109  1449
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8113354, 'precision': 0.8112973, 'recall': 0.8113311, 'specificity': 0.8113311, 'f1': 0.8113098, 'auroc': 0.8856616, 'binary_precision': 0.80721, 'binary_recall': 0.8110236, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.80911225}
confusion matrix:
     0    1
0  530  123
1  120  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8475945, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84639204, 'auroc': 0.928437, 'binary_precision': 0.82819384, 'binary_recall': 0.8744186, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.85067874}
confusion matrix:
     0    1
0  176   39
1   27  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 01:24:11.134124,epoch time: 0:01:56.546378,used: 0:01:56.546378,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97361994, 'recall': 0.9736892, 'specificity': 0.9736892, 'f1': 0.9736313, 'auroc': 0.9955205, 'binary_precision': 0.9785714, 'binary_recall': 0.9691318, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.97382873}
confusion matrix:
      0     1
0  1484    33
1    48  1507
---- Validation: 
scalar performance:
{'acc': 0.79037267, 'precision': 0.791905, 'recall': 0.78983253, 'specificity': 0.78983253, 'f1': 0.7898538, 'auroc': 0.8688669, 'binary_precision': 0.8098472, 'binary_recall': 0.7511811, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.7794118}
confusion matrix:
     0    1
0  541  112
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8302969, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8302243, 'auroc': 0.9168415, 'binary_precision': 0.82568806, 'binary_recall': 0.8372093, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.83140874}
confusion matrix:
     0    1
0  177   38
1   35  180
early stop counter: 1
val acc:0.7903726696968079, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 2,now: 2024-07-29 01:26:45.537497,epoch time: 0:02:34.403373,used: 0:04:30.949751,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.9608098, 'recall': 0.95950174, 'specificity': 0.95950174, 'f1': 0.9589677, 'auroc': 0.9950181, 'binary_precision': 0.99379736, 'binary_recall': 0.9249519, 'binary_specificity': 0.9940516, 'binary_f1_score': 0.95813954}
confusion matrix:
      0     1
0  1504     9
1   117  1442
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.8134436, 'recall': 0.7699642, 'specificity': 0.7699642, 'f1': 0.76368344, 'auroc': 0.9015688, 'binary_precision': 0.9232673, 'binary_recall': 0.58740157, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.717998}
confusion matrix:
     0    1
0  622   31
1  262  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.85411763, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8404801, 'auroc': 0.9128826, 'binary_precision': 0.92, 'binary_recall': 0.74883723, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.82564104}
confusion matrix:
     0    1
0  201   14
1   54  161
early stop counter: 2
val acc:0.7725155353546143, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 3,now: 2024-07-29 01:29:18.663403,epoch time: 0:02:33.125906,used: 0:07:04.075657,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9756614, 'recall': 0.97524625, 'specificity': 0.97524625, 'f1': 0.9749327, 'auroc': 0.99794054, 'binary_precision': 0.99798113, 'binary_recall': 0.9524727, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.97469604}
confusion matrix:
      0     1
0  1512     3
1    74  1483
---- Validation: 
scalar performance:
{'acc': 0.66537267, 'precision': 0.7303804, 'recall': 0.6615849, 'specificity': 0.6615849, 'f1': 0.63684434, 'auroc': 0.79152787, 'binary_precision': 0.84931505, 'binary_recall': 0.39055118, 'binary_specificity': 0.9326187, 'binary_f1_score': 0.5350593}
confusion matrix:
     0    1
0  609   44
1  387  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.85355556, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84314686, 'auroc': 0.920411, 'binary_precision': 0.9111111, 'binary_recall': 0.7627907, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.8303797}
confusion matrix:
     0    1
0  199   16
1   51  164
early stop counter: 3
val acc:0.6653726696968079, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 4,now: 2024-07-29 01:31:12.086339,epoch time: 0:01:53.422936,used: 0:08:57.498593,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.96960294, 'recall': 0.96854943, 'specificity': 0.96854943, 'f1': 0.9680891, 'auroc': 0.99845684, 'binary_precision': 1.0, 'binary_recall': 0.93709886, 'binary_specificity': 1.0, 'binary_f1_score': 0.96752816}
confusion matrix:
      0     1
0  1514     0
1    98  1460
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.7510421, 'recall': 0.60572886, 'specificity': 0.60572886, 'f1': 0.54233044, 'auroc': 0.8594301, 'binary_precision': 0.9350649, 'binary_recall': 0.22677165, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.365019}
confusion matrix:
     0    1
0  643   10
1  491  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.8282534, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.74155545, 'auroc': 0.90451056, 'binary_precision': 0.98245615, 'binary_recall': 0.52093023, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.68085104}
confusion matrix:
     0    1
0  213    2
1  103  112
early stop counter: 4
val acc:0.6110248565673828, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 5,now: 2024-07-29 01:32:41.854600,epoch time: 0:01:29.768261,used: 0:10:27.266854,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839528, 'recall': 0.98389864, 'specificity': 0.98389864, 'f1': 0.98372394, 'auroc': 0.99859726, 'binary_precision': 0.99801457, 'binary_recall': 0.9697749, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98369217}
confusion matrix:
      0     1
0  1514     3
1    47  1508
---- Validation: 
scalar performance:
{'acc': 0.6863354, 'precision': 0.7757733, 'recall': 0.6823021, 'specificity': 0.6823021, 'f1': 0.65573525, 'auroc': 0.8236407, 'binary_precision': 0.929368, 'binary_recall': 0.39370078, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.5530973}
confusion matrix:
     0    1
0  634   19
1  385  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8745644, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.851398, 'auroc': 0.9260789, 'binary_precision': 0.9634146, 'binary_recall': 0.7348837, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.83377314}
confusion matrix:
     0    1
0  209    6
1   57  158
new oracle model saved
early stop counter: 5
val acc:0.6863353848457336, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 6,now: 2024-07-29 01:35:10.832673,epoch time: 0:02:28.978073,used: 0:12:56.244927,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9813203, 'recall': 0.98128605, 'specificity': 0.98128605, 'f1': 0.98111975, 'auroc': 0.99824667, 'binary_precision': 0.9947125, 'binary_recall': 0.9678457, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.98109514}
confusion matrix:
      0     1
0  1509     8
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.768868, 'recall': 0.75547504, 'specificity': 0.75547504, 'f1': 0.7535094, 'auroc': 0.86137867, 'binary_precision': 0.822, 'binary_recall': 0.6472441, 'binary_specificity': 0.863706, 'binary_f1_score': 0.72422904}
confusion matrix:
     0    1
0  564   89
1  224  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8256448, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.82557285, 'auroc': 0.9054841, 'binary_precision': 0.8211009, 'binary_recall': 0.83255816, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8267898}
confusion matrix:
     0    1
0  176   39
1   36  179
early stop counter: 6
val acc:0.7569875717163086, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 7,now: 2024-07-29 01:37:16.842246,epoch time: 0:02:06.009573,used: 0:15:02.254500,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9808742, 'recall': 0.9807144, 'specificity': 0.9807144, 'f1': 0.98046833, 'auroc': 0.99775547, 'binary_precision': 0.99866754, 'binary_recall': 0.9627489, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98037934}
confusion matrix:
      0     1
0  1513     2
1    58  1499
---- Validation: 
scalar performance:
{'acc': 0.70574534, 'precision': 0.7826653, 'recall': 0.70205235, 'specificity': 0.70205235, 'f1': 0.6818479, 'auroc': 0.89592254, 'binary_precision': 0.9266667, 'binary_recall': 0.43779528, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.5946525}
confusion matrix:
     0    1
0  631   22
1  357  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.83703935, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.79710114, 'auroc': 0.89838827, 'binary_precision': 0.94520545, 'binary_recall': 0.6418605, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.76454294}
confusion matrix:
     0    1
0  207    8
1   77  138
early stop counter: 7
val acc:0.7057453393936157, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 8,now: 2024-07-29 01:39:46.271409,epoch time: 0:02:29.429163,used: 0:17:31.683663,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.9669957, 'recall': 0.9656611, 'specificity': 0.9656611, 'f1': 0.96515465, 'auroc': 0.9990169, 'binary_precision': 1.0, 'binary_recall': 0.9313222, 'binary_specificity': 1.0, 'binary_f1_score': 0.96444005}
confusion matrix:
      0     1
0  1514     0
1   107  1451
---- Validation: 
scalar performance:
{'acc': 0.70108694, 'precision': 0.79889524, 'recall': 0.69704574, 'specificity': 0.69704574, 'f1': 0.671759, 'auroc': 0.91554487, 'binary_precision': 0.9664179, 'binary_recall': 0.40787402, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.57364345}
confusion matrix:
     0    1
0  644    9
1  376  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7116279, 'precision': 0.8171091, 'recall': 0.7116279, 'specificity': 0.7116279, 'f1': 0.68547225, 'auroc': 0.91805303, 'binary_precision': 1.0, 'binary_recall': 0.4232558, 'binary_specificity': 1.0, 'binary_f1_score': 0.5947712}
confusion matrix:
     0   1
0  215   0
1  124  91
early stop counter: 8
val acc:0.7010869383811951, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 9,now: 2024-07-29 01:41:37.623003,epoch time: 0:01:51.351594,used: 0:19:23.035257,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98422897, 'recall': 0.9842206, 'specificity': 0.9842206, 'f1': 0.98404944, 'auroc': 0.99941325, 'binary_precision': 0.99735975, 'binary_recall': 0.9710797, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9840443}
confusion matrix:
      0     1
0  1512     4
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.7088509, 'precision': 0.7937772, 'recall': 0.70505, 'specificity': 0.70505, 'f1': 0.68372977, 'auroc': 0.88908374, 'binary_precision': 0.94827586, 'binary_recall': 0.43307087, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.5945946}
confusion matrix:
     0    1
0  638   15
1  360  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8657514, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8260084, 'auroc': 0.9311628, 'binary_precision': 0.9797297, 'binary_recall': 0.6744186, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.79889804}
confusion matrix:
     0    1
0  212    3
1   70  145
early stop counter: 9
val acc:0.7088509202003479, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 10,now: 2024-07-29 01:44:17.401787,epoch time: 0:02:39.778784,used: 0:22:02.814041,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98435974, 'recall': 0.9843893, 'specificity': 0.9843893, 'f1': 0.98437285, 'auroc': 0.99906695, 'binary_precision': 0.98582476, 'binary_recall': 0.9832905, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.984556}
confusion matrix:
      0     1
0  1494    22
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.8074534, 'precision': 0.8457754, 'recall': 0.8051151, 'specificity': 0.8051151, 'f1': 0.80111134, 'auroc': 0.9159874, 'binary_precision': 0.9574468, 'binary_recall': 0.63779527, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.7655955}
confusion matrix:
     0    1
0  635   18
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8822758, 'recall': 0.8534884, 'specificity': 0.8534884, 'f1': 0.85067713, 'auroc': 0.9357058, 'binary_precision': 0.98717946, 'binary_recall': 0.7162791, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.83018863}
confusion matrix:
     0    1
0  213    2
1   61  154
early stop counter: 10
val acc:0.8074533939361572, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 11,now: 2024-07-29 01:45:51.115971,epoch time: 0:01:33.714184,used: 0:23:36.528225,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98781264, 'recall': 0.9875397, 'specificity': 0.9875397, 'f1': 0.9876255, 'auroc': 0.9993967, 'binary_precision': 0.9809765, 'binary_recall': 0.9948553, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9878672}
confusion matrix:
      0     1
0  1487    30
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8300169, 'recall': 0.77993995, 'specificity': 0.77993995, 'f1': 0.77337396, 'auroc': 0.9316565, 'binary_precision': 0.95165396, 'binary_recall': 0.5889764, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.72762644}
confusion matrix:
     0    1
0  634   19
1  261  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.84789646, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.77042437, 'auroc': 0.92354786, 'binary_precision': 1.0, 'binary_recall': 0.5627907, 'binary_specificity': 1.0, 'binary_f1_score': 0.7202381}
confusion matrix:
     0    1
0  215    0
1   94  121
early stop counter: 11
val acc:0.782608687877655, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 12,now: 2024-07-29 01:47:27.187603,epoch time: 0:01:36.071632,used: 0:25:12.599857,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98366237, 'recall': 0.9835949, 'specificity': 0.9835949, 'f1': 0.9833984, 'auroc': 0.9996431, 'binary_precision': 0.99867463, 'binary_recall': 0.968509, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9833605}
confusion matrix:
      0     1
0  1514     2
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.5885093, 'precision': 0.7544757, 'recall': 0.58278567, 'specificity': 0.58278567, 'f1': 0.5015407, 'auroc': 0.8982649, 'binary_precision': 0.95652175, 'binary_recall': 0.17322835, 'binary_specificity': 0.992343, 'binary_f1_score': 0.29333332}
confusion matrix:
     0    1
0  648    5
1  525  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7, 'precision': 0.8125, 'recall': 0.7, 'specificity': 0.7, 'f1': 0.6703297, 'auroc': 0.9091401, 'binary_precision': 1.0, 'binary_recall': 0.4, 'binary_specificity': 1.0, 'binary_f1_score': 0.5714286}
confusion matrix:
     0   1
0  215   0
1  129  86
early stop counter: 12
val acc:0.5885093212127686, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 13,now: 2024-07-29 01:49:04.917558,epoch time: 0:01:37.729955,used: 0:26:50.329812,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.98055553, 'recall': 0.97920793, 'specificity': 0.97920793, 'f1': 0.9794682, 'auroc': 0.99980927, 'binary_precision': 0.9611111, 'binary_recall': 1.0, 'binary_specificity': 0.95841587, 'binary_f1_score': 0.98017}
confusion matrix:
      0     1
0  1452    63
1     0  1557
---- Validation: 
scalar performance:
{'acc': 0.8004658, 'precision': 0.810637, 'recall': 0.79917884, 'specificity': 0.79917884, 'f1': 0.7983153, 'auroc': 0.8847331, 'binary_precision': 0.86346155, 'binary_recall': 0.7070866, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.7774892}
confusion matrix:
     0    1
0  582   71
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8400563, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8156981, 'auroc': 0.90615463, 'binary_precision': 0.9254658, 'binary_recall': 0.69302326, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.79255325}
confusion matrix:
     0    1
0  203   12
1   66  149
early stop counter: 13
val acc:0.8004658222198486, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8465116024017334 / 0.8534883856773376
after epoch: 14,now: 2024-07-29 01:50:44.857060,epoch time: 0:01:39.939502,used: 0:28:30.269314,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886597, 'recall': 0.98856455, 'specificity': 0.98856455, 'f1': 0.9886036, 'auroc': 0.99956167, 'binary_precision': 0.9859515, 'binary_recall': 0.9916506, 'binary_specificity': 0.9854785, 'binary_f1_score': 0.98879284}
confusion matrix:
      0     1
0  1493    22
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.8167702, 'precision': 0.8354957, 'recall': 0.8151065, 'specificity': 0.8151065, 'f1': 0.8135989, 'auroc': 0.9112009, 'binary_precision': 0.9113402, 'binary_recall': 0.696063, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.7892857}
confusion matrix:
     0    1
0  610   43
1  193  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.85519826, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.82719606, 'auroc': 0.9121039, 'binary_precision': 0.9493671, 'binary_recall': 0.6976744, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.80428946}
confusion matrix:
     0    1
0  207    8
1   65  150
better model found
persisted
after epoch: 15,now: 2024-07-29 01:52:28.765261,epoch time: 0:01:43.908201,used: 0:30:14.177515,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870229, 'recall': 0.9870766, 'specificity': 0.9870766, 'f1': 0.986979, 'auroc': 0.999627, 'binary_precision': 0.99541885, 'binary_recall': 0.9787645, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9870214}
confusion matrix:
      0     1
0  1511     7
1    33  1521
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.7954204, 'recall': 0.6860004, 'specificity': 0.6860004, 'f1': 0.6569673, 'auroc': 0.91228855, 'binary_precision': 0.96825397, 'binary_recall': 0.38425198, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.5501691}
confusion matrix:
     0    1
0  645    8
1  391  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.81524926, 'recall': 0.7069768, 'specificity': 0.7069768, 'f1': 0.6794538, 'auroc': 0.92408866, 'binary_precision': 1.0, 'binary_recall': 0.41395348, 'binary_specificity': 1.0, 'binary_f1_score': 0.5855263}
confusion matrix:
     0   1
0  215   0
1  126  89
early stop counter: 1
val acc:0.6902173757553101, best validation acc: 0.8167701959609985, corresponding to test acc:                         0.830232560634613 / 0.8534883856773376
after epoch: 16,now: 2024-07-29 01:54:12.582188,epoch time: 0:01:43.816927,used: 0:31:57.994442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98062265, 'recall': 0.9804362, 'specificity': 0.9804362, 'f1': 0.9801427, 'auroc': 0.9995888, 'binary_precision': 1.0, 'binary_recall': 0.96087235, 'binary_specificity': 1.0, 'binary_f1_score': 0.9800458}
confusion matrix:
      0     1
0  1513     0
1    61  1498
---- Validation: 
scalar performance:
{'acc': 0.64518636, 'precision': 0.7697016, 'recall': 0.64037454, 'specificity': 0.64037454, 'f1': 0.5945945, 'auroc': 0.8528367, 'binary_precision': 0.94949496, 'binary_recall': 0.296063, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.45138052}
confusion matrix:
     0    1
0  643   10
1  447  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.84902596, 'recall': 0.78372097, 'specificity': 0.78372097, 'f1': 0.77310765, 'auroc': 0.9242834, 'binary_precision': 1.0, 'binary_recall': 0.5674419, 'binary_specificity': 1.0, 'binary_f1_score': 0.7240356}
confusion matrix:
     0    1
0  215    0
1   93  122
early stop counter: 2
val acc:0.6451863646507263, best validation acc: 0.8167701959609985, corresponding to test acc:                         0.830232560634613 / 0.8534883856773376
after epoch: 17,now: 2024-07-29 01:55:46.365466,epoch time: 0:01:33.783278,used: 0:33:31.777720,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928852, 'recall': 0.9928016, 'specificity': 0.9928016, 'f1': 0.9928367, 'auroc': 0.9998058, 'binary_precision': 0.99041533, 'binary_recall': 0.9955042, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9929533}
confusion matrix:
      0     1
0  1500    15
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.86180127, 'precision': 0.87368, 'recall': 0.86055875, 'specificity': 0.86055875, 'f1': 0.86037886, 'auroc': 0.9274143, 'binary_precision': 0.93690246, 'binary_recall': 0.77165353, 'binary_specificity': 0.949464, 'binary_f1_score': 0.8462867}
confusion matrix:
     0    1
0  620   33
1  145  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.890767, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87054646, 'auroc': 0.9310546, 'binary_precision': 0.97619045, 'binary_recall': 0.7627907, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.85639685}
confusion matrix:
     0    1
0  211    4
1   51  164
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-29 01:57:23.637288,epoch time: 0:01:37.271822,used: 0:35:09.049542,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99515575, 'recall': 0.99508667, 'specificity': 0.99508667, 'f1': 0.9951161, 'auroc': 0.9999136, 'binary_precision': 0.99296224, 'binary_recall': 0.9974293, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9951908}
confusion matrix:
      0     1
0  1505    11
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.86878884, 'precision': 0.87678885, 'recall': 0.8677756, 'specificity': 0.8677756, 'f1': 0.8678423, 'auroc': 0.92793405, 'binary_precision': 0.92830884, 'binary_recall': 0.79527557, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.85665816}
confusion matrix:
     0    1
0  614   39
1  130  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.9021318, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.88489544, 'auroc': 0.9398161, 'binary_precision': 0.98255813, 'binary_recall': 0.7860465, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87338495}
confusion matrix:
     0    1
0  212    3
1   46  169
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-29 01:59:01.450442,epoch time: 0:01:37.813154,used: 0:36:46.862696,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9725686, 'recall': 0.97172236, 'specificity': 0.97172236, 'f1': 0.97134715, 'auroc': 0.99934626, 'binary_precision': 1.0, 'binary_recall': 0.9434447, 'binary_specificity': 1.0, 'binary_f1_score': 0.97089946}
confusion matrix:
      0     1
0  1516     0
1    88  1468
---- Validation: 
scalar performance:
{'acc': 0.52717394, 'precision': 0.6893415, 'recall': 0.52058095, 'specificity': 0.52058095, 'f1': 0.38635716, 'auroc': 0.8189224, 'binary_precision': 0.8611111, 'binary_recall': 0.048818897, 'binary_specificity': 0.992343, 'binary_f1_score': 0.0923994}
confusion matrix:
     0   1
0  648   5
1  604  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53023255, 'precision': 0.7577938, 'recall': 0.53023255, 'specificity': 0.53023255, 'f1': 0.39720738, 'auroc': 0.8579557, 'binary_precision': 1.0, 'binary_recall': 0.060465116, 'binary_specificity': 1.0, 'binary_f1_score': 0.11403509}
confusion matrix:
     0   1
0  215   0
1  202  13
early stop counter: 1
val acc:0.5271739363670349, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 20,now: 2024-07-29 02:00:39.281382,epoch time: 0:01:37.830940,used: 0:38:24.693636,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99281704, 'recall': 0.99287975, 'specificity': 0.99287975, 'f1': 0.99283785, 'auroc': 0.9995799, 'binary_precision': 0.996119, 'binary_recall': 0.98971725, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9929078}
confusion matrix:
      0     1
0  1510     6
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.8090062, 'precision': 0.8413731, 'recall': 0.80684185, 'specificity': 0.80684185, 'f1': 0.8035841, 'auroc': 0.9275253, 'binary_precision': 0.9430524, 'binary_recall': 0.6519685, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.7709497}
confusion matrix:
     0    1
0  628   25
1  221  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.85918605, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.81872237, 'auroc': 0.943775, 'binary_precision': 0.9727891, 'binary_recall': 0.66511625, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.7900552}
confusion matrix:
     0    1
0  211    4
1   72  143
early stop counter: 2
val acc:0.8090062141418457, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 21,now: 2024-07-29 02:02:15.817506,epoch time: 0:01:36.536124,used: 0:40:01.229760,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9935507, 'recall': 0.9934461, 'specificity': 0.9934461, 'f1': 0.99348783, 'auroc': 0.99989784, 'binary_precision': 0.9904215, 'binary_recall': 0.99678665, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9935939}
confusion matrix:
      0     1
0  1501    15
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.8147898, 'recall': 0.7835671, 'specificity': 0.7835671, 'f1': 0.7797472, 'auroc': 0.87811553, 'binary_precision': 0.90702945, 'binary_recall': 0.62992126, 'binary_specificity': 0.9372129, 'binary_f1_score': 0.7434944}
confusion matrix:
     0    1
0  612   41
1  235  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8651163, 'precision': 0.8782073, 'recall': 0.86511624, 'specificity': 0.86511624, 'f1': 0.8639389, 'auroc': 0.93574905, 'binary_precision': 0.94857144, 'binary_recall': 0.772093, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.85128206}
confusion matrix:
     0    1
0  206    9
1   49  166
early stop counter: 3
val acc:0.7857142686843872, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 22,now: 2024-07-29 02:03:49.076576,epoch time: 0:01:33.259070,used: 0:41:34.488830,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915618, 'recall': 0.99163187, 'specificity': 0.99163187, 'f1': 0.99153626, 'auroc': 0.99989104, 'binary_precision': 0.99934685, 'binary_recall': 0.98392284, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9915749}
confusion matrix:
      0     1
0  1516     1
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.6490683, 'precision': 0.77168286, 'recall': 0.64431155, 'specificity': 0.64431155, 'f1': 0.60027575, 'auroc': 0.9182043, 'binary_precision': 0.9507389, 'binary_recall': 0.30393702, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.46062055}
confusion matrix:
     0    1
0  643   10
1  442  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.8328173, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.73192644, 'auroc': 0.94056785, 'binary_precision': 1.0, 'binary_recall': 0.4976744, 'binary_specificity': 1.0, 'binary_f1_score': 0.66459626}
confusion matrix:
     0    1
0  215    0
1  108  107
early stop counter: 4
val acc:0.649068295955658, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 23,now: 2024-07-29 02:05:26.685752,epoch time: 0:01:37.609176,used: 0:43:12.098006,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941393, 'recall': 0.9941393, 'specificity': 0.9941393, 'f1': 0.9941393, 'auroc': 0.99970114, 'binary_precision': 0.99422705, 'binary_recall': 0.99422705, 'binary_specificity': 0.9940516, 'binary_f1_score': 0.99422705}
confusion matrix:
      0     1
0  1504     9
1     9  1550
---- Validation: 
scalar performance:
{'acc': 0.8377329, 'precision': 0.8426511, 'recall': 0.8368873, 'specificity': 0.8368873, 'f1': 0.8368825, 'auroc': 0.9043542, 'binary_precision': 0.88035715, 'binary_recall': 0.776378, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.8251046}
confusion matrix:
     0    1
0  586   67
1  142  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.8903413, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8832258, 'auroc': 0.93129253, 'binary_precision': 0.9411765, 'binary_recall': 0.81860465, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.87562186}
confusion matrix:
     0    1
0  204   11
1   39  176
early stop counter: 5
val acc:0.8377329111099243, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 24,now: 2024-07-29 02:06:56.244227,epoch time: 0:01:29.558475,used: 0:44:41.656481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99509203, 'recall': 0.9951582, 'specificity': 0.9951582, 'f1': 0.9951166, 'auroc': 0.9998919, 'binary_precision': 0.99806327, 'binary_recall': 0.9922978, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9951722}
confusion matrix:
      0     1
0  1511     3
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.61024845, 'precision': 0.7282404, 'recall': 0.6051368, 'specificity': 0.6051368, 'f1': 0.5467777, 'auroc': 0.8732989, 'binary_precision': 0.8888889, 'binary_recall': 0.23937008, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.37717122}
confusion matrix:
     0    1
0  634   19
1  483  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.7764286, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6310785, 'auroc': 0.89555436, 'binary_precision': 0.95, 'binary_recall': 0.3534884, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.51525426}
confusion matrix:
     0   1
0  211   4
1  139  76
early stop counter: 6
val acc:0.6102484464645386, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 25,now: 2024-07-29 02:08:34.458180,epoch time: 0:01:38.213953,used: 0:46:19.870434,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97194517, 'recall': 0.9711168, 'specificity': 0.9711168, 'f1': 0.97069657, 'auroc': 0.9996366, 'binary_precision': 1.0, 'binary_recall': 0.9422336, 'binary_specificity': 1.0, 'binary_f1_score': 0.9702578}
confusion matrix:
      0     1
0  1514     0
1    90  1468
---- Validation: 
scalar performance:
{'acc': 0.5217391, 'precision': 0.713834, 'recall': 0.51500404, 'specificity': 0.51500404, 'f1': 0.37133095, 'auroc': 0.8838546, 'binary_precision': 0.9130435, 'binary_recall': 0.033070866, 'binary_specificity': 0.9969372, 'binary_f1_score': 0.06382979}
confusion matrix:
     0   1
0  651   2
1  614  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51627904, 'precision': 0.75413716, 'recall': 0.51627904, 'specificity': 0.51627904, 'f1': 0.36852214, 'auroc': 0.8881774, 'binary_precision': 1.0, 'binary_recall': 0.03255814, 'binary_specificity': 1.0, 'binary_f1_score': 0.06306306}
confusion matrix:
     0  1
0  215  0
1  208  7
early stop counter: 7
val acc:0.52173912525177, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 26,now: 2024-07-29 02:10:09.318118,epoch time: 0:01:34.859938,used: 0:47:54.730372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99320334, 'recall': 0.99313164, 'specificity': 0.99313164, 'f1': 0.9931624, 'auroc': 0.99982667, 'binary_precision': 0.9910486, 'binary_recall': 0.9955042, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.9932714}
confusion matrix:
      0     1
0  1501    14
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.76863354, 'precision': 0.8208952, 'recall': 0.76578844, 'specificity': 0.76578844, 'f1': 0.75749826, 'auroc': 0.93842894, 'binary_precision': 0.9469496, 'binary_recall': 0.5622047, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.70553356}
confusion matrix:
     0    1
0  633   20
1  278  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.808165, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.67436576, 'auroc': 0.8981828, 'binary_precision': 0.98876405, 'binary_recall': 0.40930232, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5789473}
confusion matrix:
     0   1
0  214   1
1  127  88
early stop counter: 8
val acc:0.7686335444450378, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 27,now: 2024-07-29 02:11:44.477876,epoch time: 0:01:35.159758,used: 0:49:29.890130,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99672997, 'recall': 0.99676204, 'specificity': 0.99676204, 'f1': 0.99674433, 'auroc': 0.9999343, 'binary_precision': 0.9980683, 'binary_recall': 0.9955042, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9967846}
confusion matrix:
      0     1
0  1512     3
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.7453416, 'precision': 0.8108705, 'recall': 0.74210125, 'specificity': 0.74210125, 'f1': 0.7294672, 'auroc': 0.9250504, 'binary_precision': 0.9501466, 'binary_recall': 0.5102362, 'binary_specificity': 0.9739663, 'binary_f1_score': 0.6639344}
confusion matrix:
     0    1
0  636   17
1  311  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.81616664, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.69820327, 'auroc': 0.9071336, 'binary_precision': 0.9896907, 'binary_recall': 0.44651163, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.61538464}
confusion matrix:
     0   1
0  214   1
1  119  96
early stop counter: 9
val acc:0.7453415989875793, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 28,now: 2024-07-29 02:13:23.501076,epoch time: 0:01:39.023200,used: 0:51:08.913330,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9911206, 'recall': 0.990785, 'specificity': 0.990785, 'f1': 0.9908817, 'auroc': 0.99987495, 'binary_precision': 0.9829114, 'binary_recall': 0.9993565, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.99106574}
confusion matrix:
      0     1
0  1491    27
1     1  1553
---- Validation: 
scalar performance:
{'acc': 0.8245342, 'precision': 0.8244965, 'recall': 0.8245216, 'specificity': 0.8245216, 'f1': 0.8245071, 'auroc': 0.8946787, 'binary_precision': 0.8210361, 'binary_recall': 0.82362205, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.8223271}
confusion matrix:
     0    1
0  539  114
1  112  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.86699057, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8623971, 'auroc': 0.9296268, 'binary_precision': 0.90625, 'binary_recall': 0.80930233, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8550369}
confusion matrix:
     0    1
0  197   18
1   41  174
early stop counter: 10
val acc:0.8245341777801514, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 29,now: 2024-07-29 02:15:01.018610,epoch time: 0:01:37.517534,used: 0:52:46.430864,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918753, 'recall': 0.991941, 'specificity': 0.991941, 'f1': 0.9918618, 'auroc': 0.99986136, 'binary_precision': 0.9986954, 'binary_recall': 0.9851995, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9919016}
confusion matrix:
      0     1
0  1516     2
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.72282606, 'precision': 0.80115956, 'recall': 0.7192232, 'specificity': 0.7192232, 'f1': 0.7014025, 'auroc': 0.93017626, 'binary_precision': 0.9512987, 'binary_recall': 0.46141732, 'binary_specificity': 0.9770291, 'binary_f1_score': 0.621421}
confusion matrix:
     0    1
0  638   15
1  342  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.8380503, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7458848, 'auroc': 0.9404435, 'binary_precision': 1.0, 'binary_recall': 0.52093023, 'binary_specificity': 1.0, 'binary_f1_score': 0.68501526}
confusion matrix:
     0    1
0  215    0
1  103  112
early stop counter: 11
val acc:0.7228260636329651, best validation acc: 0.8687888383865356, corresponding to test acc:                         0.8860465288162231 / 0.8860465288162231
after epoch: 30,now: 2024-07-29 02:16:40.366855,epoch time: 0:01:39.348245,used: 0:54:25.779109,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_22_14_seed_0_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:54:25.779109 at 2024-07-29 02:16:40.366855
persisted model performance metric: 

scalar performance:
{'acc': 0.8860465, 'precision': 0.9021318, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.88489544, 'auroc': 0.9398161, 'binary_precision': 0.98255813, 'binary_recall': 0.7860465, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87338495}
confusion matrix:
     0    1
0  212    3
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.8860465, 'precision': 0.9021318, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.88489544, 'auroc': 0.9398161, 'binary_precision': 0.98255813, 'binary_recall': 0.7860465, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87338495}
confusion matrix:
     0    1
0  212    3
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457386 KiB |  13219 MiB |  73409 GiB |  73408 GiB |
|       from large pool | 416794 KiB |  13181 MiB |  72542 GiB |  72541 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457386 KiB |  13219 MiB |  73409 GiB |  73408 GiB |
|       from large pool | 416794 KiB |  13181 MiB |  72542 GiB |  72541 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73339 GiB |  73338 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72474 GiB |  72473 GiB |
|       from small pool |  40405 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14488 MiB |  14488 MiB |  14488 MiB |      0 B   |
|       from large pool |  14422 MiB |  14422 MiB |  14422 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 417109 KiB |   1260 MiB |  54377 GiB |  54376 GiB |
|       from large pool | 406502 KiB |   1252 MiB |  53505 GiB |  53505 GiB |
|       from small pool |  10607 KiB |     17 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12910 K  |   12908 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6347 K  |    6346 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12910 K  |   12908 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6347 K  |    6346 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |     635    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      84    |     653    |    8539 K  |    8539 K  |
|       from large pool |      30    |     604    |    4792 K  |    4792 K  |
|       from small pool |      54    |     233    |    3747 K  |    3747 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72474 GiB |  72474 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14488 MiB |  14488 MiB |  13634 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool |  24320 KiB |   1252 MiB |  53506 GiB |  53506 GiB |
|       from small pool |      0 KiB |     43 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12910 K  |   12910 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12910 K  |   12910 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     635    |     635    |     574    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |    8539 K  |    8539 K  |
|       from large pool |       3    |     604    |    4792 K  |    4792 K  |
|       from small pool |       0    |     233    |    3747 K  |    3747 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72474 GiB |  72474 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    854 MiB |  14488 MiB |  14488 MiB |  13634 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool |  24320 KiB |   1252 MiB |  53506 GiB |  53506 GiB |
|       from small pool |      0 KiB |     43 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12910 K  |   12910 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12910 K  |   12910 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6347 K  |    6347 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      61    |     635    |     635    |     574    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |    8539 K  |    8539 K  |
|       from large pool |       3    |     604    |    4792 K  |    4792 K  |
|       from small pool |       0    |     233    |    3747 K  |    3747 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369

 Experiment start at: 2024-07-29 02:17:30.359197
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.95649076, 'recall': 0.9565039, 'specificity': 0.9565039, 'f1': 0.9563802, 'auroc': 0.99202025, 'binary_precision': 0.96710527, 'binary_recall': 0.9459459, 'binary_specificity': 0.96706194, 'binary_f1_score': 0.95640856}
confusion matrix:
      0     1
0  1468    50
1    84  1470
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.81409097, 'recall': 0.8090886, 'specificity': 0.8090886, 'f1': 0.8073708, 'auroc': 0.8958988, 'binary_precision': 0.765928, 'binary_recall': 0.87777776, 'binary_specificity': 0.74039936, 'binary_f1_score': 0.8180473}
confusion matrix:
     0    1
0  482  169
1   77  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8041879, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.7835498, 'auroc': 0.9045136, 'binary_precision': 0.7311828, 'binary_recall': 0.9066667, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.8095238}
confusion matrix:
     0    1
0  150   75
1   21  204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:19:10.119880,epoch time: 0:01:39.760683,used: 0:01:39.760683,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.9614601, 'recall': 0.9607543, 'specificity': 0.9607543, 'f1': 0.9609096, 'auroc': 0.9941181, 'binary_precision': 0.94871795, 'binary_recall': 0.9755627, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.96195304}
confusion matrix:
      0     1
0  1435    82
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.8730915, 'recall': 0.8725039, 'specificity': 0.8725039, 'f1': 0.8726436, 'auroc': 0.919328, 'binary_precision': 0.88091356, 'binary_recall': 0.85714287, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.86886567}
confusion matrix:
     0    1
0  578   73
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85470665, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85319126, 'auroc': 0.93121976, 'binary_precision': 0.832636, 'binary_recall': 0.8844444, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.85775864}
confusion matrix:
     0    1
0  185   40
1   26  199
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 02:20:42.706643,epoch time: 0:01:32.586763,used: 0:03:12.347446,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.96985316, 'recall': 0.9690835, 'specificity': 0.9690835, 'f1': 0.96874297, 'auroc': 0.9971932, 'binary_precision': 0.99592113, 'binary_recall': 0.94212216, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.96827495}
confusion matrix:
      0     1
0  1511     6
1    90  1465
---- Validation: 
scalar performance:
{'acc': 0.66588604, 'precision': 0.7384436, 'recall': 0.6612647, 'specificity': 0.6612647, 'f1': 0.6345699, 'auroc': 0.8752225, 'binary_precision': 0.865942, 'binary_recall': 0.3793651, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.52759385}
confusion matrix:
     0    1
0  614   37
1  391  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8229665, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7963801, 'auroc': 0.8902123, 'binary_precision': 0.90909094, 'binary_recall': 0.6666667, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  210   15
1   75  150
early stop counter: 1
val acc:0.6658860445022583, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 3,now: 2024-07-29 02:22:16.047924,epoch time: 0:01:33.341281,used: 0:04:45.688727,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98146755, 'recall': 0.98141956, 'specificity': 0.98141956, 'f1': 0.981441, 'auroc': 0.9987532, 'binary_precision': 0.9801536, 'binary_recall': 0.9833012, 'binary_specificity': 0.97953796, 'binary_f1_score': 0.9817249}
confusion matrix:
      0     1
0  1484    31
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8301048, 'recall': 0.8276242, 'specificity': 0.8276242, 'f1': 0.8277881, 'auroc': 0.8894204, 'binary_precision': 0.85102737, 'binary_recall': 0.7888889, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.8187809}
confusion matrix:
     0    1
0  564   87
1  133  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.7863662, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.7707247, 'auroc': 0.9008987, 'binary_precision': 0.72527474, 'binary_recall': 0.88, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.79518074}
confusion matrix:
     0    1
0  150   75
1   27  198
early stop counter: 2
val acc:0.8282591700553894, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 4,now: 2024-07-29 02:23:52.925498,epoch time: 0:01:36.877574,used: 0:06:22.566301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98019785, 'recall': 0.9802628, 'specificity': 0.9802628, 'f1': 0.98014295, 'auroc': 0.9980624, 'binary_precision': 0.9895219, 'binary_recall': 0.9710797, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.9802141}
confusion matrix:
      0     1
0  1500    16
1    45  1511
---- Validation: 
scalar performance:
{'acc': 0.7259953, 'precision': 0.7843327, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7089505, 'auroc': 0.8587326, 'binary_precision': 0.90909094, 'binary_recall': 0.4920635, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.638517}
confusion matrix:
     0    1
0  620   31
1  320  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8674911, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83946264, 'auroc': 0.9239111, 'binary_precision': 0.96385545, 'binary_recall': 0.7111111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8184144}
confusion matrix:
     0    1
0  219    6
1   65  160
early stop counter: 3
val acc:0.7259953022003174, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 5,now: 2024-07-29 02:25:26.196795,epoch time: 0:01:33.271297,used: 0:07:55.837598,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97927606, 'recall': 0.9790792, 'specificity': 0.9790792, 'f1': 0.9788405, 'auroc': 0.9990729, 'binary_precision': 0.99733156, 'binary_recall': 0.9607969, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9787234}
confusion matrix:
      0     1
0  1512     4
1    61  1495
---- Validation: 
scalar performance:
{'acc': 0.75565964, 'precision': 0.8199879, 'recall': 0.75194573, 'specificity': 0.75194573, 'f1': 0.74087346, 'auroc': 0.92032284, 'binary_precision': 0.95942026, 'binary_recall': 0.5253968, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.6789744}
confusion matrix:
     0    1
0  637   14
1  299  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.83300173, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7599578, 'auroc': 0.91464686, 'binary_precision': 0.9765625, 'binary_recall': 0.5555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.70821536}
confusion matrix:
     0    1
0  222    3
1  100  125
early stop counter: 4
val acc:0.7556596398353577, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 6,now: 2024-07-29 02:27:07.586574,epoch time: 0:01:41.389779,used: 0:09:37.227377,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98240554, 'recall': 0.9824424, 'specificity': 0.9824424, 'f1': 0.9824202, 'auroc': 0.99881554, 'binary_precision': 0.9844961, 'binary_recall': 0.980695, 'binary_specificity': 0.98418975, 'binary_f1_score': 0.98259187}
confusion matrix:
      0     1
0  1494    24
1    30  1524
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.8686391, 'recall': 0.8667947, 'specificity': 0.8667947, 'f1': 0.8670279, 'auroc': 0.9205301, 'binary_precision': 0.88720536, 'binary_recall': 0.8365079, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.8611111}
confusion matrix:
     0    1
0  584   67
1  103  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.82286, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8221344, 'auroc': 0.90042466, 'binary_precision': 0.8372093, 'binary_recall': 0.8, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  190   35
1   45  180
early stop counter: 5
val acc:0.8672911524772644, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 7,now: 2024-07-29 02:28:49.040434,epoch time: 0:01:41.453860,used: 0:11:18.681237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9772482, 'recall': 0.9771088, 'specificity': 0.9771088, 'f1': 0.97688764, 'auroc': 0.9972186, 'binary_precision': 0.994012, 'binary_recall': 0.96015424, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.97678983}
confusion matrix:
      0     1
0  1507     9
1    62  1494
---- Validation: 
scalar performance:
{'acc': 0.68227947, 'precision': 0.7718986, 'recall': 0.6774962, 'specificity': 0.6774962, 'f1': 0.65018713, 'auroc': 0.87495434, 'binary_precision': 0.92395437, 'binary_recall': 0.3857143, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.5442329}
confusion matrix:
     0    1
0  631   20
1  387  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.85607195, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.835667, 'auroc': 0.92525434, 'binary_precision': 0.9367816, 'binary_recall': 0.72444445, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8170426}
confusion matrix:
     0    1
0  214   11
1   62  163
early stop counter: 6
val acc:0.6822794675827026, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 8,now: 2024-07-29 02:30:32.567461,epoch time: 0:01:43.527027,used: 0:13:02.208264,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9822662, 'recall': 0.9820043, 'specificity': 0.9820043, 'f1': 0.9820893, 'auroc': 0.9986764, 'binary_precision': 0.97590363, 'binary_recall': 0.9890745, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.98244494}
confusion matrix:
      0     1
0  1478    38
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.86244, 'recall': 0.85529953, 'specificity': 0.85529953, 'f1': 0.85546374, 'auroc': 0.91518545, 'binary_precision': 0.9054545, 'binary_recall': 0.7904762, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.8440678}
confusion matrix:
     0    1
0  599   52
1  132  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.83621967, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83547425, 'auroc': 0.91188145, 'binary_precision': 0.8511628, 'binary_recall': 0.81333333, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8318181}
confusion matrix:
     0    1
0  193   32
1   42  183
early stop counter: 7
val acc:0.8563622236251831, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 9,now: 2024-07-29 02:32:09.834407,epoch time: 0:01:37.266946,used: 0:14:39.475210,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.988271, 'recall': 0.9883439, 'specificity': 0.9883439, 'f1': 0.98828065, 'auroc': 0.9983598, 'binary_precision': 0.99350226, 'binary_recall': 0.98327976, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9883646}
confusion matrix:
      0     1
0  1507    10
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.8001561, 'precision': 0.82535464, 'recall': 0.7978495, 'specificity': 0.7978495, 'f1': 0.7953153, 'auroc': 0.9022944, 'binary_precision': 0.91189426, 'binary_recall': 0.6571429, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.76383764}
confusion matrix:
     0    1
0  611   40
1  216  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.83758616, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82017624, 'auroc': 0.9211457, 'binary_precision': 0.90960455, 'binary_recall': 0.71555555, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.80099505}
confusion matrix:
     0    1
0  209   16
1   64  161
early stop counter: 8
val acc:0.8001561164855957, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 10,now: 2024-07-29 02:33:50.994233,epoch time: 0:01:41.159826,used: 0:16:20.635036,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892383, 'recall': 0.9893111, 'specificity': 0.9893111, 'f1': 0.98925704, 'auroc': 0.99941754, 'binary_precision': 0.9935191, 'binary_recall': 0.9852185, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.98935145}
confusion matrix:
      0     1
0  1506    10
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.81450075, 'recall': 0.7893241, 'specificity': 0.7893241, 'f1': 0.7867791, 'auroc': 0.8938434, 'binary_precision': 0.89542484, 'binary_recall': 0.65238094, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.75482094}
confusion matrix:
     0    1
0  603   48
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8064054, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.80413103, 'auroc': 0.8871901, 'binary_precision': 0.8309179, 'binary_recall': 0.7644445, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.7962963}
confusion matrix:
     0    1
0  190   35
1   53  172
early stop counter: 9
val acc:0.7915691137313843, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 11,now: 2024-07-29 02:35:33.155119,epoch time: 0:01:42.160886,used: 0:18:02.795922,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9815102, 'recall': 0.98157984, 'specificity': 0.98157984, 'f1': 0.9814451, 'auroc': 0.99864006, 'binary_precision': 0.991481, 'binary_recall': 0.97174054, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.98151153}
confusion matrix:
      0     1
0  1502    13
1    44  1513
---- Validation: 
scalar performance:
{'acc': 0.7455113, 'precision': 0.8087504, 'recall': 0.74175626, 'specificity': 0.74175626, 'f1': 0.7297888, 'auroc': 0.89551604, 'binary_precision': 0.9444444, 'binary_recall': 0.5126984, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.664609}
confusion matrix:
     0    1
0  632   19
1  307  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.84615386, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7662338, 'auroc': 0.914884, 'binary_precision': 1.0, 'binary_recall': 0.5555556, 'binary_specificity': 1.0, 'binary_f1_score': 0.71428573}
confusion matrix:
     0    1
0  225    0
1  100  125
early stop counter: 10
val acc:0.7455112934112549, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 12,now: 2024-07-29 02:37:13.200101,epoch time: 0:01:40.044982,used: 0:19:42.840904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98915654, 'recall': 0.9888181, 'specificity': 0.9888181, 'f1': 0.9889269, 'auroc': 0.99959004, 'binary_precision': 0.9816688, 'binary_recall': 0.99679077, 'binary_specificity': 0.98084545, 'binary_f1_score': 0.9891719}
confusion matrix:
      0     1
0  1485    29
1     5  1553
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.8801583, 'recall': 0.8699437, 'specificity': 0.8699437, 'f1': 0.8701294, 'auroc': 0.9315698, 'binary_precision': 0.93457943, 'binary_recall': 0.7936508, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8583691}
confusion matrix:
     0    1
0  616   35
1  130  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8574047, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8455062, 'auroc': 0.9314766, 'binary_precision': 0.91935486, 'binary_recall': 0.76, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8321167}
confusion matrix:
     0    1
0  210   15
1   54  171
early stop counter: 11
val acc:0.8711943626403809, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 13,now: 2024-07-29 02:38:56.600524,epoch time: 0:01:43.400423,used: 0:21:26.241327,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98491555, 'recall': 0.9848714, 'specificity': 0.9848714, 'f1': 0.98470044, 'auroc': 0.9992535, 'binary_precision': 0.99867725, 'binary_recall': 0.9710611, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9846756}
confusion matrix:
      0     1
0  1515     2
1    45  1510
---- Validation: 
scalar performance:
{'acc': 0.7681499, 'precision': 0.8257441, 'recall': 0.7646698, 'specificity': 0.7646698, 'f1': 0.7558069, 'auroc': 0.92696095, 'binary_precision': 0.9586777, 'binary_recall': 0.552381, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.70090634}
confusion matrix:
     0    1
0  636   15
1  282  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7133333, 'precision': 0.80425966, 'recall': 0.71333337, 'specificity': 0.71333337, 'f1': 0.69018686, 'auroc': 0.9226074, 'binary_precision': 0.9705882, 'binary_recall': 0.44, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6055046}
confusion matrix:
     0   1
0  222   3
1  126  99
early stop counter: 12
val acc:0.7681499123573303, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 14,now: 2024-07-29 02:40:33.929630,epoch time: 0:01:37.329106,used: 0:23:03.570433,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.987689, 'recall': 0.98773533, 'specificity': 0.98773533, 'f1': 0.9876301, 'auroc': 0.99958706, 'binary_precision': 0.9967235, 'binary_recall': 0.9787645, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9876623}
confusion matrix:
      0     1
0  1513     5
1    33  1521
---- Validation: 
scalar performance:
{'acc': 0.84074944, 'precision': 0.8631594, 'recall': 0.8387097, 'specificity': 0.8387097, 'f1': 0.8376498, 'auroc': 0.9301466, 'binary_precision': 0.9493671, 'binary_recall': 0.71428573, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.8152174}
confusion matrix:
     0    1
0  627   24
1  180  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.86167306, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8223684, 'auroc': 0.935763, 'binary_precision': 0.9741936, 'binary_recall': 0.6711111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.79473686}
confusion matrix:
     0    1
0  221    4
1   74  151
early stop counter: 13
val acc:0.8407494425773621, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 15,now: 2024-07-29 02:42:15.820336,epoch time: 0:01:41.890706,used: 0:24:45.461139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9820322, 'recall': 0.9808707, 'specificity': 0.9808707, 'f1': 0.98110056, 'auroc': 0.9998965, 'binary_precision': 0.9640644, 'binary_recall': 1.0, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9817035}
confusion matrix:
      0     1
0  1458    58
1     0  1556
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.85683006, 'recall': 0.8554275, 'specificity': 0.8554275, 'f1': 0.8547158, 'auroc': 0.9149611, 'binary_precision': 0.8255132, 'binary_recall': 0.89365077, 'binary_specificity': 0.8172043, 'binary_f1_score': 0.8582317}
confusion matrix:
     0    1
0  532  119
1   67  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8259306, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8217151, 'auroc': 0.9080099, 'binary_precision': 0.79116464, 'binary_recall': 0.8755556, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.83122367}
confusion matrix:
     0    1
0  173   52
1   28  197
early stop counter: 14
val acc:0.8548009395599365, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 16,now: 2024-07-29 02:43:57.086153,epoch time: 0:01:41.265817,used: 0:26:26.726956,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.9770424, 'recall': 0.97562754, 'specificity': 0.97562754, 'f1': 0.9758827, 'auroc': 0.9994192, 'binary_precision': 0.9568434, 'binary_recall': 0.9974293, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.97671485}
confusion matrix:
      0     1
0  1446    70
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.8584562, 'recall': 0.8563236, 'specificity': 0.8563236, 'f1': 0.8554406, 'auroc': 0.92233926, 'binary_precision': 0.8219971, 'binary_recall': 0.9015873, 'binary_specificity': 0.8110599, 'binary_f1_score': 0.8599546}
confusion matrix:
     0    1
0  528  123
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8413564, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8273121, 'auroc': 0.9369482, 'binary_precision': 0.7761194, 'binary_recall': 0.92444444, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.84381336}
confusion matrix:
     0    1
0  165   60
1   17  208
early stop counter: 15
val acc:0.8555815815925598, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 17,now: 2024-07-29 02:45:28.970184,epoch time: 0:01:31.884031,used: 0:27:58.610987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99514043, 'recall': 0.9950974, 'specificity': 0.9950974, 'f1': 0.9951163, 'auroc': 0.9998182, 'binary_precision': 0.99358565, 'binary_recall': 0.9967825, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9951815}
confusion matrix:
      0     1
0  1508    10
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.8266979, 'precision': 0.85643005, 'recall': 0.82432157, 'specificity': 0.82432157, 'f1': 0.8222337, 'auroc': 0.9288713, 'binary_precision': 0.95535713, 'binary_recall': 0.6793651, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.7940631}
confusion matrix:
     0    1
0  631   20
1  202  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.85762084, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8354958, 'auroc': 0.92128396, 'binary_precision': 0.94186044, 'binary_recall': 0.72, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8161209}
confusion matrix:
     0    1
0  215   10
1   63  162
early stop counter: 16
val acc:0.8266978859901428, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 18,now: 2024-07-29 02:47:11.316605,epoch time: 0:01:42.346421,used: 0:29:40.957408,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9827806, 'recall': 0.98267007, 'specificity': 0.98267007, 'f1': 0.98242176, 'auroc': 0.9998037, 'binary_precision': 1.0, 'binary_recall': 0.9653402, 'binary_specificity': 1.0, 'binary_f1_score': 0.98236454}
confusion matrix:
      0     1
0  1514     0
1    54  1504
---- Validation: 
scalar performance:
{'acc': 0.55581576, 'precision': 0.7588943, 'recall': 0.5484383, 'specificity': 0.5484383, 'f1': 0.43724564, 'auroc': 0.9313407, 'binary_precision': 0.984127, 'binary_recall': 0.0984127, 'binary_specificity': 0.9984639, 'binary_f1_score': 0.17893219}
confusion matrix:
     0   1
0  650   1
1  568  62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52444446, 'precision': 0.7562642, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.38546562, 'auroc': 0.93947655, 'binary_precision': 1.0, 'binary_recall': 0.04888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.09322034}
confusion matrix:
     0   1
0  225   0
1  214  11
early stop counter: 17
val acc:0.5558157563209534, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 19,now: 2024-07-29 02:48:52.543679,epoch time: 0:01:41.227074,used: 0:31:22.184482,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99315387, 'recall': 0.99317455, 'specificity': 0.99317455, 'f1': 0.99316335, 'auroc': 0.99954605, 'binary_precision': 0.9941973, 'binary_recall': 0.992278, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9932368}
confusion matrix:
      0     1
0  1509     9
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.83909535, 'recall': 0.82677937, 'specificity': 0.82677937, 'f1': 0.8263877, 'auroc': 0.9100846, 'binary_precision': 0.8957529, 'binary_recall': 0.73650795, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.80836236}
confusion matrix:
     0    1
0  597   54
1  166  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.81384504, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.81069887, 'auroc': 0.8888494, 'binary_precision': 0.84313726, 'binary_recall': 0.7644445, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8018648}
confusion matrix:
     0    1
0  193   32
1   53  172
early stop counter: 18
val acc:0.8282591700553894, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 20,now: 2024-07-29 02:50:33.275284,epoch time: 0:01:40.731605,used: 0:33:02.916087,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.986318, 'recall': 0.98633444, 'specificity': 0.98633444, 'f1': 0.9863258, 'auroc': 0.99929416, 'binary_precision': 0.9871383, 'binary_recall': 0.98587024, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.98650384}
confusion matrix:
      0     1
0  1495    20
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.8675178, 'recall': 0.85327697, 'specificity': 0.85327697, 'f1': 0.853121, 'auroc': 0.9184575, 'binary_precision': 0.93190664, 'binary_recall': 0.76031744, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.8374126}
confusion matrix:
     0    1
0  616   35
1  151  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.87523496, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8659011, 'auroc': 0.9349729, 'binary_precision': 0.93193716, 'binary_recall': 0.7911111, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8557692}
confusion matrix:
     0    1
0  212   13
1   47  178
new oracle model saved
early stop counter: 19
val acc:0.8548009395599365, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 21,now: 2024-07-29 02:52:13.230766,epoch time: 0:01:39.955482,used: 0:34:42.871569,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98230183, 'recall': 0.9815805, 'specificity': 0.9815805, 'f1': 0.9817572, 'auroc': 0.9993255, 'binary_precision': 0.9693558, 'binary_recall': 0.9955042, 'binary_specificity': 0.9676568, 'binary_f1_score': 0.98225605}
confusion matrix:
      0     1
0  1466    49
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.83800304, 'recall': 0.8373272, 'specificity': 0.8373272, 'f1': 0.83746034, 'auroc': 0.9102187, 'binary_precision': 0.84590167, 'binary_recall': 0.81904763, 'binary_specificity': 0.85560673, 'binary_f1_score': 0.8322581}
confusion matrix:
     0    1
0  557   94
1  114  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8561473, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8530431, 'auroc': 0.9338666, 'binary_precision': 0.8244898, 'binary_recall': 0.8977778, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.85957444}
confusion matrix:
     0    1
0  182   43
1   23  202
early stop counter: 20
val acc:0.8376268744468689, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 22,now: 2024-07-29 02:53:55.034854,epoch time: 0:01:41.804088,used: 0:36:24.675657,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98878527, 'recall': 0.9885112, 'specificity': 0.9885112, 'f1': 0.9886019, 'auroc': 0.9995723, 'binary_precision': 0.982256, 'binary_recall': 0.9955042, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.9888357}
confusion matrix:
      0     1
0  1487    28
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8735379, 'recall': 0.85133123, 'specificity': 0.85133123, 'f1': 0.8507023, 'auroc': 0.93049526, 'binary_precision': 0.9566116, 'binary_recall': 0.7349206, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.8312388}
confusion matrix:
     0    1
0  630   21
1  167  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8607571, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8401693, 'auroc': 0.93163455, 'binary_precision': 0.9425287, 'binary_recall': 0.72888887, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.82205516}
confusion matrix:
     0    1
0  215   10
1   61  164
early stop counter: 21
val acc:0.8532396554946899, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 23,now: 2024-07-29 02:55:30.012467,epoch time: 0:01:34.977613,used: 0:37:59.653270,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938278, 'recall': 0.9938021, 'specificity': 0.9938021, 'f1': 0.993814, 'auroc': 0.99985373, 'binary_precision': 0.99293965, 'binary_recall': 0.9948553, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.99389654}
confusion matrix:
      0     1
0  1506    11
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.87042594, 'recall': 0.85394263, 'specificity': 0.85394263, 'f1': 0.8536809, 'auroc': 0.92882985, 'binary_precision': 0.9405941, 'binary_recall': 0.75396824, 'binary_specificity': 0.953917, 'binary_f1_score': 0.83700436}
confusion matrix:
     0    1
0  621   30
1  155  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.86457443, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8347411, 'auroc': 0.9177481, 'binary_precision': 0.9634146, 'binary_recall': 0.7022222, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8123393}
confusion matrix:
     0    1
0  219    6
1   67  158
early stop counter: 22
val acc:0.8555815815925598, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 24,now: 2024-07-29 02:57:10.806835,epoch time: 0:01:40.794368,used: 0:39:40.447638,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99445343, 'recall': 0.99452573, 'specificity': 0.99452573, 'f1': 0.9944658, 'auroc': 0.9998211, 'binary_precision': 0.99935067, 'binary_recall': 0.9897106, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.99450725}
confusion matrix:
      0     1
0  1516     1
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8530445, 'recall': 0.81390166, 'specificity': 0.81390166, 'f1': 0.81076324, 'auroc': 0.940539, 'binary_precision': 0.9625293, 'binary_recall': 0.65238094, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.77767265}
confusion matrix:
     0    1
0  635   16
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.8306878, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.75479895, 'auroc': 0.91375804, 'binary_precision': 0.97619045, 'binary_recall': 0.5466667, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7008547}
confusion matrix:
     0    1
0  222    3
1  102  123
early stop counter: 23
val acc:0.8165495991706848, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 25,now: 2024-07-29 02:58:51.057930,epoch time: 0:01:40.251095,used: 0:41:20.698733,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98934793, 'recall': 0.98939586, 'specificity': 0.98939586, 'f1': 0.9892578, 'auroc': 0.99979734, 'binary_precision': 1.0, 'binary_recall': 0.9787918, 'binary_specificity': 1.0, 'binary_f1_score': 0.98928225}
confusion matrix:
      0     1
0  1516     0
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.7314598, 'precision': 0.8045416, 'recall': 0.72739375, 'specificity': 0.72739375, 'f1': 0.71199787, 'auroc': 0.93659633, 'binary_precision': 0.9496855, 'binary_recall': 0.47936508, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.6371308}
confusion matrix:
     0    1
0  635   16
1  328  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.77661926, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.64294255, 'auroc': 0.91008395, 'binary_precision': 0.94382024, 'binary_recall': 0.37333333, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.53503186}
confusion matrix:
     0   1
0  220   5
1  141  84
early stop counter: 24
val acc:0.7314597964286804, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 26,now: 2024-07-29 03:00:33.252883,epoch time: 0:01:42.194953,used: 0:43:02.893686,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9954287, 'recall': 0.9954589, 'specificity': 0.9954589, 'f1': 0.9954421, 'auroc': 0.99982405, 'binary_precision': 0.99677837, 'binary_recall': 0.99421597, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99549556}
confusion matrix:
      0     1
0  1511     5
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.74004686, 'precision': 0.7930501, 'recall': 0.73650795, 'specificity': 0.73650795, 'f1': 0.72579944, 'auroc': 0.8972021, 'binary_precision': 0.913649, 'binary_recall': 0.52063495, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.6632963}
confusion matrix:
     0    1
0  620   31
1  302  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8270349, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81902677, 'auroc': 0.89412344, 'binary_precision': 0.875, 'binary_recall': 0.74666667, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8057554}
confusion matrix:
     0    1
0  201   24
1   57  168
early stop counter: 25
val acc:0.7400468587875366, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8533333539962769 / 0.8666666746139526
after epoch: 27,now: 2024-07-29 03:02:13.563415,epoch time: 0:01:40.310532,used: 0:44:43.204218,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99481225, 'recall': 0.99477196, 'specificity': 0.99477196, 'f1': 0.9947904, 'auroc': 0.9998932, 'binary_precision': 0.9935979, 'binary_recall': 0.9961489, 'binary_specificity': 0.993395, 'binary_f1_score': 0.9948718}
confusion matrix:
      0     1
0  1504    10
1     6  1552
---- Validation: 
scalar performance:
{'acc': 0.8852459, 'precision': 0.8899635, 'recall': 0.8843574, 'specificity': 0.8843574, 'f1': 0.88470185, 'auroc': 0.92865676, 'binary_precision': 0.92895204, 'binary_recall': 0.8301587, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8767813}
confusion matrix:
     0    1
0  611   40
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.865107, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8619495, 'auroc': 0.91604936, 'binary_precision': 0.89756095, 'binary_recall': 0.81777775, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8558139}
confusion matrix:
     0    1
0  204   21
1   41  184
better model found
persisted
after epoch: 28,now: 2024-07-29 03:03:53.961081,epoch time: 0:01:40.397666,used: 0:46:23.601884,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957489, 'recall': 0.9958226, 'specificity': 0.9958226, 'f1': 0.9957679, 'auroc': 0.99992025, 'binary_precision': 1.0, 'binary_recall': 0.9916452, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958051}
confusion matrix:
      0     1
0  1516     0
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.81889147, 'precision': 0.8521755, 'recall': 0.8163594, 'specificity': 0.8163594, 'f1': 0.8136419, 'auroc': 0.9305818, 'binary_precision': 0.95642203, 'binary_recall': 0.66190475, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.78236395}
confusion matrix:
     0    1
0  632   19
1  213  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8335428, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7680843, 'auroc': 0.9146074, 'binary_precision': 0.9699248, 'binary_recall': 0.5733333, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7206704}
confusion matrix:
     0    1
0  221    4
1   96  129
early stop counter: 1
val acc:0.8188914656639099, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 29,now: 2024-07-29 03:05:38.879039,epoch time: 0:01:44.917958,used: 0:48:08.519842,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957819, 'recall': 0.99575484, 'specificity': 0.99575484, 'f1': 0.9957675, 'auroc': 0.99990714, 'binary_precision': 0.9948685, 'binary_recall': 0.99678665, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9958267}
confusion matrix:
      0     1
0  1508     8
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8579811, 'recall': 0.8299539, 'specificity': 0.8299539, 'f1': 0.828387, 'auroc': 0.91985714, 'binary_precision': 0.95010847, 'binary_recall': 0.6952381, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.80293304}
confusion matrix:
     0    1
0  628   23
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8654423, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8446716, 'auroc': 0.93570375, 'binary_precision': 0.94827586, 'binary_recall': 0.73333335, 'binary_specificity': 0.96, 'binary_f1_score': 0.82706773}
confusion matrix:
     0    1
0  216    9
1   60  165
early stop counter: 2
val acc:0.8321623802185059, best validation acc: 0.8852459192276001, corresponding to test acc:                         0.8622221946716309 / 0.8666666746139526
after epoch: 30,now: 2024-07-29 03:07:13.293074,epoch time: 0:01:34.414035,used: 0:49:42.933877,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_17_30_seed_1_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:42.933877 at 2024-07-29 03:07:13.293074
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.865107, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8619495, 'auroc': 0.91604936, 'binary_precision': 0.89756095, 'binary_recall': 0.81777775, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8558139}
confusion matrix:
     0    1
0  204   21
1   41  184
oracle model performance metric: 

scalar performance:
{'acc': 0.8666667, 'precision': 0.87523496, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8659011, 'auroc': 0.9349729, 'binary_precision': 0.93193716, 'binary_recall': 0.7911111, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8557692}
confusion matrix:
     0    1
0  212   13
1   47  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455482 KiB |  13219 MiB | 148642 GiB | 148642 GiB |
|       from large pool | 414883 KiB |  13181 MiB | 146885 GiB | 146884 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455482 KiB |  13219 MiB | 148642 GiB | 148642 GiB |
|       from large pool | 414883 KiB |  13181 MiB | 146885 GiB | 146884 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 148522 GiB | 148521 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 146768 GiB | 146768 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14488 MiB |  28106 MiB |  13634 MiB |
|       from large pool |  14402 MiB |  14422 MiB |  28020 MiB |  13618 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 488646 KiB |   1260 MiB | 110439 GiB | 110439 GiB |
|       from large pool | 475996 KiB |   1252 MiB | 108671 GiB | 108671 GiB |
|       from small pool |  12649 KiB |     43 MiB |   1768 GiB |   1768 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26105 K  |   26104 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12823 K  |   12822 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26105 K  |   26104 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12823 K  |   12822 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1210    |     574    |
|       from large pool |     601    |     602    |    1167    |     566    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     653    |   17785 K  |   17785 K  |
|       from large pool |      41    |     604    |   10094 K  |   10094 K  |
|       from small pool |      57    |     235    |    7690 K  |    7690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148642 GiB | 148642 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148642 GiB | 148642 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146768 GiB | 146768 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    922 MiB |  14488 MiB |  28106 MiB |  27184 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 110440 GiB | 110440 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 108672 GiB | 108671 GiB |
|       from small pool |      0 KiB |     45 MiB |   1768 GiB |   1768 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26105 K  |   26105 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12823 K  |   12823 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26105 K  |   26105 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12823 K  |   12823 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     636    |    1210    |    1145    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   17785 K  |   17785 K  |
|       from large pool |       3    |     604    |   10094 K  |   10094 K  |
|       from small pool |       0    |     235    |    7690 K  |    7690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148642 GiB | 148642 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148642 GiB | 148642 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146768 GiB | 146768 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    922 MiB |  14488 MiB |  28106 MiB |  27184 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     52 MiB |     70 MiB |     86 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 110440 GiB | 110440 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 108672 GiB | 108671 GiB |
|       from small pool |      0 KiB |     45 MiB |   1768 GiB |   1768 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26105 K  |   26105 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12823 K  |   12823 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26105 K  |   26105 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12823 K  |   12823 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     636    |    1210    |    1145    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      26    |      35    |      43    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     653    |   17785 K  |   17785 K  |
|       from large pool |       3    |     604    |   10094 K  |   10094 K  |
|       from small pool |       0    |     235    |    7690 K  |    7690 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369

 Experiment start at: 2024-07-29 03:08:05.742549
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94208115, 'precision': 0.9461302, 'recall': 0.94246566, 'specificity': 0.94246566, 'f1': 0.94198096, 'auroc': 0.98860425, 'binary_precision': 0.99064076, 'binary_recall': 0.89350647, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.93956983}
confusion matrix:
      0     1
0  1503    13
1   164  1376
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.7807896, 'recall': 0.7663198, 'specificity': 0.7663198, 'f1': 0.76535356, 'auroc': 0.8662336, 'binary_precision': 0.831643, 'binary_recall': 0.659164, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.73542595}
confusion matrix:
     0    1
0  573   83
1  212  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.8291552, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.828645, 'auroc': 0.90974367, 'binary_precision': 0.84134614, 'binary_recall': 0.8101852, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.8254717}
confusion matrix:
     0    1
0  183   33
1   41  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 03:09:49.859633,epoch time: 0:01:44.117084,used: 0:01:44.117084,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.9728931, 'recall': 0.97289777, 'specificity': 0.97289777, 'f1': 0.9728403, 'auroc': 0.99657166, 'binary_precision': 0.98022413, 'binary_recall': 0.9655844, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.9728492}
confusion matrix:
      0     1
0  1486    30
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.7793427, 'precision': 0.7794113, 'recall': 0.77960306, 'specificity': 0.77960306, 'f1': 0.77931625, 'auroc': 0.84894323, 'binary_precision': 0.7647975, 'binary_recall': 0.7893891, 'binary_specificity': 0.76981705, 'binary_f1_score': 0.77689874}
confusion matrix:
     0    1
0  505  151
1  131  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.82667875, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.81044316, 'auroc': 0.89876974, 'binary_precision': 0.7586207, 'binary_recall': 0.9166667, 'binary_specificity': 0.7083333, 'binary_f1_score': 0.8301887}
confusion matrix:
     0    1
0  153   63
1   18  198
better model found
persisted
after epoch: 2,now: 2024-07-29 03:11:28.679104,epoch time: 0:01:38.819471,used: 0:03:22.936555,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9765951, 'recall': 0.97652566, 'specificity': 0.97652566, 'f1': 0.97643954, 'auroc': 0.9963716, 'binary_precision': 0.9873838, 'binary_recall': 0.9655844, 'binary_specificity': 0.987467, 'binary_f1_score': 0.97636247}
confusion matrix:
      0     1
0  1497    19
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.8192496, 'recall': 0.816659, 'specificity': 0.816659, 'f1': 0.8170197, 'auroc': 0.8817837, 'binary_precision': 0.835924, 'binary_recall': 0.77813506, 'binary_specificity': 0.85518295, 'binary_f1_score': 0.80599505}
confusion matrix:
     0    1
0  561   95
1  138  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.79946333, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.7848047, 'auroc': 0.8550025, 'binary_precision': 0.73846155, 'binary_recall': 0.8888889, 'binary_specificity': 0.6851852, 'binary_f1_score': 0.8067227}
confusion matrix:
     0    1
0  148   68
1   24  192
better model found
persisted
after epoch: 3,now: 2024-07-29 03:13:06.789189,epoch time: 0:01:38.110085,used: 0:05:01.046640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97821796, 'recall': 0.9778861, 'specificity': 0.9778861, 'f1': 0.97774655, 'auroc': 0.99825853, 'binary_precision': 0.9952894, 'binary_recall': 0.9603896, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9775281}
confusion matrix:
      0     1
0  1509     7
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.70422536, 'precision': 0.77084845, 'recall': 0.69743305, 'specificity': 0.69743305, 'f1': 0.6802429, 'auroc': 0.86475813, 'binary_precision': 0.8986928, 'binary_recall': 0.4421222, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.5926724}
confusion matrix:
     0    1
0  625   31
1  347  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6412037, 'precision': 0.7123038, 'recall': 0.6412037, 'specificity': 0.6412037, 'f1': 0.60841876, 'auroc': 0.8504586, 'binary_precision': 0.83516484, 'binary_recall': 0.35185185, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.495114}
confusion matrix:
     0   1
0  201  15
1  140  76
early stop counter: 1
val acc:0.7042253613471985, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.7870370149612427 / 0.8287037014961243
after epoch: 4,now: 2024-07-29 03:14:44.209469,epoch time: 0:01:37.420280,used: 0:06:38.466920,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9749308, 'recall': 0.9743669, 'specificity': 0.9743669, 'f1': 0.97446454, 'auroc': 0.99831533, 'binary_precision': 0.9620733, 'binary_recall': 0.9883117, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.975016}
confusion matrix:
      0     1
0  1456    60
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.7934272, 'precision': 0.7934071, 'recall': 0.79361427, 'specificity': 0.79361427, 'f1': 0.7933863, 'auroc': 0.868155, 'binary_precision': 0.78056425, 'binary_recall': 0.8006431, 'binary_specificity': 0.7865854, 'binary_f1_score': 0.79047626}
confusion matrix:
     0    1
0  516  140
1  124  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.7859335, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.7389555, 'auroc': 0.91638803, 'binary_precision': 0.68135595, 'binary_recall': 0.9305556, 'binary_specificity': 0.5648148, 'binary_f1_score': 0.7866928}
confusion matrix:
     0    1
0  122   94
1   15  201
early stop counter: 2
val acc:0.7934272289276123, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.7870370149612427 / 0.8287037014961243
after epoch: 5,now: 2024-07-29 03:16:22.466940,epoch time: 0:01:38.257471,used: 0:08:16.724391,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.97755194, 'recall': 0.97698486, 'specificity': 0.97698486, 'f1': 0.97708356, 'auroc': 0.99912834, 'binary_precision': 0.96460176, 'binary_recall': 0.9909091, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.97757846}
confusion matrix:
      0     1
0  1460    56
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.7800529, 'recall': 0.7802403, 'specificity': 0.7802403, 'f1': 0.78006583, 'auroc': 0.85067105, 'binary_precision': 0.76850396, 'binary_recall': 0.7845659, 'binary_specificity': 0.7759146, 'binary_f1_score': 0.77645195}
confusion matrix:
     0    1
0  509  147
1  134  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7454159, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.7306076, 'auroc': 0.8641547, 'binary_precision': 0.69201523, 'binary_recall': 0.8425926, 'binary_specificity': 0.625, 'binary_f1_score': 0.7599165}
confusion matrix:
     0    1
0  135   81
1   34  182
early stop counter: 3
val acc:0.7801252007484436, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.7870370149612427 / 0.8287037014961243
after epoch: 6,now: 2024-07-29 03:17:59.872563,epoch time: 0:01:37.405623,used: 0:09:54.130014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.98502433, 'recall': 0.9850135, 'specificity': 0.9850135, 'f1': 0.9849476, 'auroc': 0.9984559, 'binary_precision': 0.993395, 'binary_recall': 0.97662336, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9849377}
confusion matrix:
      0     1
0  1506    10
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.726917, 'precision': 0.7639526, 'recall': 0.7217449, 'specificity': 0.7217449, 'f1': 0.7138601, 'auroc': 0.8401449, 'binary_precision': 0.85639685, 'binary_recall': 0.5273312, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.6527363}
confusion matrix:
     0    1
0  601   55
1  294  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.7572988, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.7539916, 'auroc': 0.8641118, 'binary_precision': 0.73109245, 'binary_recall': 0.8055556, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.76651984}
confusion matrix:
     0    1
0  152   64
1   42  174
early stop counter: 4
val acc:0.726917028427124, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.7870370149612427 / 0.8287037014961243
after epoch: 7,now: 2024-07-29 03:19:38.376167,epoch time: 0:01:38.503604,used: 0:11:32.633618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.96666735, 'recall': 0.96492994, 'specificity': 0.96492994, 'f1': 0.9646342, 'auroc': 0.99759704, 'binary_precision': 0.9993026, 'binary_recall': 0.93051946, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9636853}
confusion matrix:
      0     1
0  1515     1
1   107  1433
---- Validation: 
scalar performance:
{'acc': 0.5571205, 'precision': 0.75982195, 'recall': 0.5450577, 'specificity': 0.5450577, 'f1': 0.43297067, 'auroc': 0.8876393, 'binary_precision': 0.98275864, 'binary_recall': 0.09163987, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.16764706}
confusion matrix:
     0   1
0  655   1
1  565  57
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.7553191, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.37802818, 'auroc': 0.8560957, 'binary_precision': 1.0, 'binary_recall': 0.041666668, 'binary_specificity': 1.0, 'binary_f1_score': 0.080000006}
confusion matrix:
     0  1
0  216  0
1  207  9
early stop counter: 5
val acc:0.5571205019950867, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.7870370149612427 / 0.8287037014961243
after epoch: 8,now: 2024-07-29 03:21:15.547189,epoch time: 0:01:37.171022,used: 0:13:09.804640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98738074, 'recall': 0.98718345, 'specificity': 0.98718345, 'f1': 0.9872354, 'auroc': 0.9992915, 'binary_precision': 0.98078156, 'binary_recall': 0.9941558, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98742336}
confusion matrix:
      0     1
0  1486    30
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83348763, 'recall': 0.8336944, 'specificity': 0.8336944, 'f1': 0.8333209, 'auroc': 0.9043678, 'binary_precision': 0.8170543, 'binary_recall': 0.84726685, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.8318863}
confusion matrix:
     0    1
0  538  118
1   95  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.8117417, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.7659029, 'auroc': 0.908329, 'binary_precision': 0.7020548, 'binary_recall': 0.9490741, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.80708665}
confusion matrix:
     0    1
0  129   87
1   11  205
better model found
persisted
after epoch: 9,now: 2024-07-29 03:22:55.591737,epoch time: 0:01:40.044548,used: 0:14:49.849188,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.9667137, 'recall': 0.9644108, 'specificity': 0.9644108, 'f1': 0.9646051, 'auroc': 0.9991403, 'binary_precision': 0.9376528, 'binary_recall': 0.9961039, 'binary_specificity': 0.9327177, 'binary_f1_score': 0.96599495}
confusion matrix:
      0     1
0  1414   102
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.7754304, 'precision': 0.80515754, 'recall': 0.7795001, 'specificity': 0.7795001, 'f1': 0.7714334, 'auroc': 0.882489, 'binary_precision': 0.7030303, 'binary_recall': 0.93247586, 'binary_specificity': 0.6265244, 'binary_f1_score': 0.8016586}
confusion matrix:
     0    1
0  411  245
1   42  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.587963, 'precision': 0.69490886, 'recall': 0.587963, 'specificity': 0.587963, 'f1': 0.5224563, 'auroc': 0.72481567, 'binary_precision': 0.5505319, 'binary_recall': 0.9583333, 'binary_specificity': 0.2175926, 'binary_f1_score': 0.6993243}
confusion matrix:
    0    1
0  47  169
1   9  207
early stop counter: 1
val acc:0.7754303812980652, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7731481194496155 / 0.8287037014961243
after epoch: 10,now: 2024-07-29 03:24:34.974255,epoch time: 0:01:39.382518,used: 0:16:29.231706,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.97732997, 'recall': 0.9766234, 'specificity': 0.9766234, 'f1': 0.976434, 'auroc': 0.99946845, 'binary_precision': 1.0, 'binary_recall': 0.9532468, 'binary_specificity': 1.0, 'binary_f1_score': 0.9760638}
confusion matrix:
      0     1
0  1516     0
1    72  1468
---- Validation: 
scalar performance:
{'acc': 0.6729264, 'precision': 0.7649721, 'recall': 0.66486204, 'specificity': 0.66486204, 'f1': 0.6354014, 'auroc': 0.84821534, 'binary_precision': 0.91463417, 'binary_recall': 0.36173633, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.51843315}
confusion matrix:
     0    1
0  635   21
1  397  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6458333, 'precision': 0.72668666, 'recall': 0.6458333, 'specificity': 0.6458333, 'f1': 0.6111611, 'auroc': 0.78975904, 'binary_precision': 0.86206895, 'binary_recall': 0.3472222, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.49504948}
confusion matrix:
     0   1
0  204  12
1  141  75
early stop counter: 2
val acc:0.6729264259338379, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7731481194496155 / 0.8287037014961243
after epoch: 11,now: 2024-07-29 03:26:16.248960,epoch time: 0:01:41.274705,used: 0:18:10.506411,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99020624, 'recall': 0.9902289, 'specificity': 0.9902289, 'f1': 0.99018323, 'auroc': 0.9994645, 'binary_precision': 0.9960578, 'binary_recall': 0.9844156, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9902025}
confusion matrix:
      0     1
0  1510     6
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.81889266, 'recall': 0.76382, 'specificity': 0.76382, 'f1': 0.7572681, 'auroc': 0.88120294, 'binary_precision': 0.9383378, 'binary_recall': 0.562701, 'binary_specificity': 0.964939, 'binary_f1_score': 0.7035176}
confusion matrix:
     0    1
0  633   23
1  272  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.826284, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.7134931, 'auroc': 0.8678894, 'binary_precision': 1.0, 'binary_recall': 0.4675926, 'binary_specificity': 1.0, 'binary_f1_score': 0.63722396}
confusion matrix:
     0    1
0  216    0
1  115  101
early stop counter: 3
val acc:0.7691705822944641, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7731481194496155 / 0.8287037014961243
after epoch: 12,now: 2024-07-29 03:27:46.974915,epoch time: 0:01:30.725955,used: 0:19:41.232366,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901959, 'recall': 0.9901724, 'specificity': 0.9901724, 'f1': 0.9901824, 'auroc': 0.99950564, 'binary_precision': 0.98898965, 'binary_recall': 0.99155843, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.99027234}
confusion matrix:
      0     1
0  1499    17
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7699531, 'precision': 0.8007159, 'recall': 0.7655821, 'specificity': 0.7655821, 'f1': 0.7618313, 'auroc': 0.8594743, 'binary_precision': 0.89047617, 'binary_recall': 0.6012862, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.71785027}
confusion matrix:
     0    1
0  610   46
1  248  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8564815, 'precision': 0.85844827, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.8562844, 'auroc': 0.92448986, 'binary_precision': 0.885, 'binary_recall': 0.8194444, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8509615}
confusion matrix:
     0    1
0  193   23
1   39  177
new oracle model saved
early stop counter: 4
val acc:0.7699530720710754, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.7731481194496155 / 0.8564814925193787
after epoch: 13,now: 2024-07-29 03:29:26.986540,epoch time: 0:01:40.011625,used: 0:21:21.243991,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9862493, 'recall': 0.98626596, 'specificity': 0.98626596, 'f1': 0.986256, 'auroc': 0.9991939, 'binary_precision': 0.9876302, 'binary_recall': 0.9850649, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9863459}
confusion matrix:
      0     1
0  1497    19
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.85602504, 'precision': 0.8575288, 'recall': 0.85513145, 'specificity': 0.85513145, 'f1': 0.8555666, 'auroc': 0.90975225, 'binary_precision': 0.875, 'binary_recall': 0.8215434, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.8474295}
confusion matrix:
     0    1
0  583   73
1  111  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83709484, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8302536, 'auroc': 0.92851937, 'binary_precision': 0.79183674, 'binary_recall': 0.8981481, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.84164864}
confusion matrix:
     0    1
0  165   51
1   22  194
better model found
persisted
after epoch: 14,now: 2024-07-29 03:31:06.689377,epoch time: 0:01:39.702837,used: 0:23:00.946828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98994184, 'recall': 0.9899248, 'specificity': 0.9899248, 'f1': 0.989856, 'auroc': 0.9995978, 'binary_precision': 0.99867815, 'binary_recall': 0.9811688, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98984605}
confusion matrix:
      0     1
0  1514     2
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.7915747, 'recall': 0.72789633, 'specificity': 0.72789633, 'f1': 0.71663487, 'auroc': 0.8868177, 'binary_precision': 0.9147059, 'binary_recall': 0.5, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.64656967}
confusion matrix:
     0    1
0  627   29
1  311  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.6254356, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.49975187, 'auroc': 0.6877358, 'binary_precision': 0.71428573, 'binary_recall': 0.20833333, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.32258064}
confusion matrix:
     0   1
0  198  18
1  171  45
early stop counter: 1
val acc:0.7339593172073364, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 15,now: 2024-07-29 03:32:44.529983,epoch time: 0:01:37.840606,used: 0:24:38.787434,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931207, 'recall': 0.9931458, 'specificity': 0.9931458, 'f1': 0.99312806, 'auroc': 0.9998021, 'binary_precision': 0.9954338, 'binary_recall': 0.9909091, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.99316627}
confusion matrix:
      0     1
0  1509     7
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.8183893, 'recall': 0.77625287, 'specificity': 0.77625287, 'f1': 0.7721902, 'auroc': 0.89093006, 'binary_precision': 0.9211823, 'binary_recall': 0.6012862, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.72762644}
confusion matrix:
     0    1
0  624   32
1  248  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6967593, 'precision': 0.80584705, 'recall': 0.6967593, 'specificity': 0.6967593, 'f1': 0.6670726, 'auroc': 0.87836504, 'binary_precision': 0.9885057, 'binary_recall': 0.39814815, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.56765676}
confusion matrix:
     0   1
0  215   1
1  130  86
early stop counter: 2
val acc:0.7809076905250549, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 16,now: 2024-07-29 03:34:23.277109,epoch time: 0:01:38.747126,used: 0:26:17.534560,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9854958, 'recall': 0.9853742, 'specificity': 0.9853742, 'f1': 0.98527455, 'auroc': 0.9996878, 'binary_precision': 0.99800134, 'binary_recall': 0.9727273, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98520225}
confusion matrix:
      0     1
0  1513     3
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.73787165, 'precision': 0.8038038, 'recall': 0.7315407, 'specificity': 0.7315407, 'f1': 0.7192669, 'auroc': 0.8983793, 'binary_precision': 0.93883795, 'binary_recall': 0.49356914, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.64699686}
confusion matrix:
     0    1
0  636   20
1  315  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6273148, 'precision': 0.70506096, 'recall': 0.6273148, 'specificity': 0.6273148, 'f1': 0.58829135, 'auroc': 0.8543596, 'binary_precision': 0.8313253, 'binary_recall': 0.31944445, 'binary_specificity': 0.9351852, 'binary_f1_score': 0.46153846}
confusion matrix:
     0   1
0  202  14
1  147  69
early stop counter: 3
val acc:0.7378716468811035, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 17,now: 2024-07-29 03:35:59.090407,epoch time: 0:01:35.813298,used: 0:27:53.347858,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98272604, 'recall': 0.9824573, 'specificity': 0.9824573, 'f1': 0.98232853, 'auroc': 0.99952424, 'binary_precision': 0.9986577, 'binary_recall': 0.9662338, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9821782}
confusion matrix:
      0     1
0  1514     2
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.79577464, 'precision': 0.8342965, 'recall': 0.7911928, 'specificity': 0.7911928, 'f1': 0.7878501, 'auroc': 0.89503765, 'binary_precision': 0.9413203, 'binary_recall': 0.61897105, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.74684775}
confusion matrix:
     0    1
0  632   24
1  237  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.7735436, 'recall': 0.7291667, 'specificity': 0.7291667, 'f1': 0.717718, 'auroc': 0.830338, 'binary_precision': 0.88372093, 'binary_recall': 0.5277778, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.66086954}
confusion matrix:
     0    1
0  201   15
1  102  114
early stop counter: 4
val acc:0.7957746386528015, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 18,now: 2024-07-29 03:37:38.705045,epoch time: 0:01:39.614638,used: 0:29:32.962496,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937751, 'recall': 0.9938003, 'specificity': 0.9938003, 'f1': 0.9937825, 'auroc': 0.99928296, 'binary_precision': 0.9960861, 'binary_recall': 0.99155843, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9938171}
confusion matrix:
      0     1
0  1510     6
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7754304, 'precision': 0.83153594, 'recall': 0.7698759, 'specificity': 0.7698759, 'f1': 0.76297164, 'auroc': 0.90259224, 'binary_precision': 0.9614325, 'binary_recall': 0.5610933, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.7086295}
confusion matrix:
     0    1
0  642   14
1  273  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6412037, 'precision': 0.7693927, 'recall': 0.6412037, 'specificity': 0.6412037, 'f1': 0.5927577, 'auroc': 0.90331364, 'binary_precision': 0.95522386, 'binary_recall': 0.2962963, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.45229682}
confusion matrix:
     0   1
0  213   3
1  152  64
early stop counter: 5
val acc:0.7754303812980652, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 19,now: 2024-07-29 03:39:15.812700,epoch time: 0:01:37.107655,used: 0:31:10.070151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9880388, 'recall': 0.98797673, 'specificity': 0.98797673, 'f1': 0.98789257, 'auroc': 0.99946296, 'binary_precision': 0.99867284, 'binary_recall': 0.97727275, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9878569}
confusion matrix:
      0     1
0  1514     2
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.8154192, 'recall': 0.7319696, 'specificity': 0.7319696, 'f1': 0.7179829, 'auroc': 0.8900111, 'binary_precision': 0.9645161, 'binary_recall': 0.4807074, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.6416309}
confusion matrix:
     0    1
0  645   11
1  323  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7013889, 'precision': 0.7934874, 'recall': 0.7013889, 'specificity': 0.7013889, 'f1': 0.675968, 'auroc': 0.888203, 'binary_precision': 0.95789474, 'binary_recall': 0.4212963, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.585209}
confusion matrix:
     0   1
0  212   4
1  125  91
early stop counter: 6
val acc:0.7386541366577148, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 20,now: 2024-07-29 03:40:53.201359,epoch time: 0:01:37.388659,used: 0:32:47.458810,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99382204, 'recall': 0.9937592, 'specificity': 0.9937592, 'f1': 0.993782, 'auroc': 0.9997096, 'binary_precision': 0.9909619, 'binary_recall': 0.9967533, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9938491}
confusion matrix:
      0     1
0  1502    14
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.83990407, 'recall': 0.8125515, 'specificity': 0.8125515, 'f1': 0.8115498, 'auroc': 0.8897978, 'binary_precision': 0.9234136, 'binary_recall': 0.6784566, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.78220576}
confusion matrix:
     0    1
0  621   35
1  200  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.79665154, 'recall': 0.7916667, 'specificity': 0.7916667, 'f1': 0.7907878, 'auroc': 0.8802084, 'binary_precision': 0.8351064, 'binary_recall': 0.7268519, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.7772277}
confusion matrix:
     0    1
0  185   31
1   59  157
early stop counter: 7
val acc:0.8161189556121826, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 21,now: 2024-07-29 03:42:30.451752,epoch time: 0:01:37.250393,used: 0:34:24.709203,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99094987, 'recall': 0.99079084, 'specificity': 0.99079084, 'f1': 0.990836, 'auroc': 0.99978113, 'binary_precision': 0.9852375, 'binary_recall': 0.9967533, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9909619}
confusion matrix:
      0     1
0  1493    23
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.8678715, 'recall': 0.8502078, 'specificity': 0.8502078, 'f1': 0.8506118, 'auroc': 0.9216826, 'binary_precision': 0.935743, 'binary_recall': 0.7491961, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.83214283}
confusion matrix:
     0    1
0  624   32
1  156  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.86204916, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.84304965, 'auroc': 0.9308127, 'binary_precision': 0.9408284, 'binary_recall': 0.7361111, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.82597405}
confusion matrix:
     0    1
0  206   10
1   57  159
early stop counter: 8
val acc:0.8528951406478882, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 22,now: 2024-07-29 03:44:08.480906,epoch time: 0:01:38.029154,used: 0:36:02.738357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98887, 'recall': 0.98889935, 'specificity': 0.98889935, 'f1': 0.9888741, 'auroc': 0.9991698, 'binary_precision': 0.99215686, 'binary_recall': 0.98571426, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98892504}
confusion matrix:
      0     1
0  1504    12
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.8262911, 'precision': 0.84704816, 'recall': 0.8230016, 'specificity': 0.8230016, 'f1': 0.82253194, 'auroc': 0.90926695, 'binary_precision': 0.9255319, 'binary_recall': 0.6993569, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.7967033}
confusion matrix:
     0    1
0  621   35
1  187  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6990741, 'precision': 0.80175436, 'recall': 0.69907403, 'specificity': 0.69907403, 'f1': 0.6710942, 'auroc': 0.87965107, 'binary_precision': 0.9777778, 'binary_recall': 0.4074074, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.57516336}
confusion matrix:
     0   1
0  214   2
1  128  88
early stop counter: 9
val acc:0.8262910842895508, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 23,now: 2024-07-29 03:45:51.178847,epoch time: 0:01:42.697941,used: 0:37:45.436298,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911932, 'recall': 0.9912132, 'specificity': 0.9912132, 'f1': 0.9911649, 'auroc': 0.9996779, 'binary_precision': 0.9973701, 'binary_recall': 0.9850649, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99117935}
confusion matrix:
      0     1
0  1512     4
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.7120501, 'precision': 0.7960261, 'recall': 0.704805, 'specificity': 0.704805, 'f1': 0.6853944, 'auroc': 0.89210653, 'binary_precision': 0.9471831, 'binary_recall': 0.4324759, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.593819}
confusion matrix:
     0    1
0  641   15
1  353  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.7517302, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.6113789, 'auroc': 0.8289609, 'binary_precision': 0.9113924, 'binary_recall': 0.33333334, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.48813564}
confusion matrix:
     0   1
0  209   7
1  144  72
early stop counter: 10
val acc:0.7120500802993774, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 24,now: 2024-07-29 03:47:29.193358,epoch time: 0:01:38.014511,used: 0:39:23.450809,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937769, 'recall': 0.99380547, 'specificity': 0.99380547, 'f1': 0.9937826, 'auroc': 0.99982786, 'binary_precision': 0.99673414, 'binary_recall': 0.9909091, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9938131}
confusion matrix:
      0     1
0  1511     5
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.786385, 'precision': 0.8197007, 'recall': 0.78200483, 'specificity': 0.78200483, 'f1': 0.7787771, 'auroc': 0.8815044, 'binary_precision': 0.9164678, 'binary_recall': 0.61736333, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.7377522}
confusion matrix:
     0    1
0  621   35
1  238  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7816058, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.72199684, 'auroc': 0.8588606, 'binary_precision': 0.8976378, 'binary_recall': 0.5277778, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.66472304}
confusion matrix:
     0    1
0  203   13
1  102  114
early stop counter: 11
val acc:0.7863849997520447, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 25,now: 2024-07-29 03:49:01.056991,epoch time: 0:01:31.863633,used: 0:40:55.314442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9891939, 'recall': 0.9892189, 'specificity': 0.9892189, 'f1': 0.98920125, 'auroc': 0.9990945, 'binary_precision': 0.99151987, 'binary_recall': 0.987013, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9892613}
confusion matrix:
      0     1
0  1503    13
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.75352114, 'precision': 0.7805296, 'recall': 0.7492427, 'specificity': 0.7492427, 'f1': 0.74519646, 'auroc': 0.8517395, 'binary_precision': 0.8611765, 'binary_recall': 0.58842444, 'binary_specificity': 0.910061, 'binary_f1_score': 0.6991404}
confusion matrix:
     0    1
0  597   59
1  256  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7690953, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.7683945, 'auroc': 0.8577032, 'binary_precision': 0.75663716, 'binary_recall': 0.7916667, 'binary_specificity': 0.7453704, 'binary_f1_score': 0.77375567}
confusion matrix:
     0    1
0  161   55
1   45  171
early stop counter: 12
val acc:0.7535211443901062, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 26,now: 2024-07-29 03:50:38.898140,epoch time: 0:01:37.841149,used: 0:42:33.155591,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9928351, 'recall': 0.992852, 'specificity': 0.992852, 'f1': 0.9928011, 'auroc': 0.9998411, 'binary_precision': 0.9993421, 'binary_recall': 0.98636365, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9928105}
confusion matrix:
      0     1
0  1515     1
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.74544716, 'recall': 0.6172261, 'specificity': 0.6172261, 'f1': 0.56575906, 'auroc': 0.8551382, 'binary_precision': 0.90960455, 'binary_recall': 0.25884244, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.40300375}
confusion matrix:
     0    1
0  640   16
1  461  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6643519, 'precision': 0.71520585, 'recall': 0.6643518, 'specificity': 0.6643518, 'f1': 0.6432781, 'auroc': 0.8472651, 'binary_precision': 0.8198198, 'binary_recall': 0.4212963, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.55657494}
confusion matrix:
     0   1
0  196  20
1  125  91
early stop counter: 13
val acc:0.6267605423927307, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 27,now: 2024-07-29 03:52:17.515032,epoch time: 0:01:38.616892,used: 0:44:11.772483,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9891068, 'recall': 0.9888017, 'specificity': 0.9888017, 'f1': 0.98887116, 'auroc': 0.99981713, 'binary_precision': 0.9802296, 'binary_recall': 0.99805194, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.9890605}
confusion matrix:
      0     1
0  1485    31
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.7934272, 'precision': 0.83200645, 'recall': 0.7888229, 'specificity': 0.7888229, 'f1': 0.785344, 'auroc': 0.8966478, 'binary_precision': 0.9387255, 'binary_recall': 0.6157556, 'binary_specificity': 0.9618902, 'binary_f1_score': 0.7436893}
confusion matrix:
     0    1
0  631   25
1  239  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8346206, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8173738, 'auroc': 0.8957262, 'binary_precision': 0.90588236, 'binary_recall': 0.712963, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.7979275}
confusion matrix:
     0    1
0  200   16
1   62  154
early stop counter: 14
val acc:0.7934272289276123, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 28,now: 2024-07-29 03:53:57.177955,epoch time: 0:01:39.662923,used: 0:45:51.435406,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9890095, 'recall': 0.98895586, 'specificity': 0.98895586, 'f1': 0.9888742, 'auroc': 0.9985965, 'binary_precision': 0.9993369, 'binary_recall': 0.9785714, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9888451}
confusion matrix:
      0     1
0  1515     1
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.802776, 'recall': 0.7274797, 'specificity': 0.7274797, 'f1': 0.71420455, 'auroc': 0.90570104, 'binary_precision': 0.940625, 'binary_recall': 0.48392284, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.6390658}
confusion matrix:
     0    1
0  637   19
1  321  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6527778, 'precision': 0.75814867, 'recall': 0.6527778, 'specificity': 0.6527778, 'f1': 0.61331904, 'auroc': 0.8404492, 'binary_precision': 0.9230769, 'binary_recall': 0.33333334, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.48979595}
confusion matrix:
     0   1
0  210   6
1  144  72
early stop counter: 15
val acc:0.7339593172073364, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 29,now: 2024-07-29 03:55:37.432132,epoch time: 0:01:40.254177,used: 0:47:31.689583,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9950916, 'precision': 0.99511933, 'recall': 0.9950733, 'specificity': 0.9950733, 'f1': 0.99509114, 'auroc': 0.9999156, 'binary_precision': 0.99288946, 'binary_recall': 0.9974026, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9951409}
confusion matrix:
      0     1
0  1505    11
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.83810437, 'recall': 0.8126764, 'specificity': 0.8126764, 'f1': 0.8118274, 'auroc': 0.9146458, 'binary_precision': 0.91792655, 'binary_recall': 0.68327975, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.78341013}
confusion matrix:
     0    1
0  618   38
1  197  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.65824175, 'recall': 0.5555555, 'specificity': 0.5555555, 'f1': 0.46949112, 'auroc': 0.7376329, 'binary_precision': 0.78571427, 'binary_recall': 0.15277778, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.25581396}
confusion matrix:
     0   1
0  207   9
1  183  33
early stop counter: 16
val acc:0.8161189556121826, best validation acc: 0.8560250401496887, corresponding to test acc:                         0.8310185074806213 / 0.8564814925193787
after epoch: 30,now: 2024-07-29 03:57:16.230805,epoch time: 0:01:38.798673,used: 0:49:10.488256,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_08_05_seed_2_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:10.488256 at 2024-07-29 03:57:16.230805
persisted model performance metric: 

scalar performance:
{'acc': 0.8310185, 'precision': 0.83709484, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8302536, 'auroc': 0.92851937, 'binary_precision': 0.79183674, 'binary_recall': 0.8981481, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.84164864}
confusion matrix:
     0    1
0  165   51
1   22  194
oracle model performance metric: 

scalar performance:
{'acc': 0.8564815, 'precision': 0.85844827, 'recall': 0.85648143, 'specificity': 0.85648143, 'f1': 0.8562844, 'auroc': 0.92448986, 'binary_precision': 0.885, 'binary_recall': 0.8194444, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.8509615}
confusion matrix:
     0    1
0  193   23
1   39  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454144 KiB |  13219 MiB | 222133 GiB | 222132 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 219511 GiB | 219511 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454144 KiB |  13219 MiB | 222133 GiB | 222132 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 219511 GiB | 219511 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 221753 GiB | 221752 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 219137 GiB | 219136 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  41660 MiB |  27184 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  41560 MiB |  27150 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461311 KiB |   1260 MiB | 161216 GiB | 161216 GiB |
|       from large pool | 450704 KiB |   1252 MiB | 158579 GiB | 158579 GiB |
|       from small pool |  10607 KiB |     45 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38978 K  |   38976 K  |
|       from large pool |     187    |    1413    |   19830 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19147 K  |   19146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38978 K  |   38976 K  |
|       from large pool |     187    |    1413    |   19830 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19147 K  |   19146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     636    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     655    |   26189 K  |   26189 K  |
|       from large pool |      38    |     604    |   14861 K  |   14861 K  |
|       from small pool |      59    |     235    |   11328 K  |   11328 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219511 GiB | 219511 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219511 GiB | 219511 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14488 MiB |  41660 MiB |  40766 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     50 MiB |     70 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 161217 GiB | 161217 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |      0 KiB |     45 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19830 K  |   19830 K  |
|       from small pool |       0    |    1419    |   19147 K  |   19147 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19830 K  |   19830 K  |
|       from small pool |       0    |    1419    |   19147 K  |   19147 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1780    |    1717    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      25    |      35    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   26190 K  |   26190 K  |
|       from large pool |       3    |     604    |   14861 K  |   14861 K  |
|       from small pool |       0    |     235    |   11328 K  |   11328 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219511 GiB | 219511 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222133 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219511 GiB | 219511 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14488 MiB |  41660 MiB |  40766 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     50 MiB |     70 MiB |    100 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 161217 GiB | 161217 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |      0 KiB |     45 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19830 K  |   19830 K  |
|       from small pool |       0    |    1419    |   19147 K  |   19147 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38978 K  |   38978 K  |
|       from large pool |       2    |    1413    |   19830 K  |   19830 K  |
|       from small pool |       0    |    1419    |   19147 K  |   19147 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1780    |    1717    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      25    |      35    |      50    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   26190 K  |   26190 K  |
|       from large pool |       3    |     604    |   14861 K  |   14861 K  |
|       from small pool |       0    |     235    |   11328 K  |   11328 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369

 Experiment start at: 2024-07-29 03:58:10.010039
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9358724, 'precision': 0.9396254, 'recall': 0.9365016, 'specificity': 0.9365016, 'f1': 0.9357885, 'auroc': 0.98695326, 'binary_precision': 0.9836299, 'binary_recall': 0.88817483, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9334684}
confusion matrix:
      0     1
0  1493    23
1   174  1382
---- Validation: 
scalar performance:
{'acc': 0.73577553, 'precision': 0.7566421, 'recall': 0.7328948, 'specificity': 0.7328948, 'f1': 0.72864354, 'auroc': 0.83207417, 'binary_precision': 0.8251121, 'binary_recall': 0.58505565, 'binary_specificity': 0.88073397, 'binary_f1_score': 0.6846512}
confusion matrix:
     0    1
0  576   78
1  261  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8182621, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8126078, 'auroc': 0.8820543, 'binary_precision': 0.857868, 'binary_recall': 0.7511111, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.80094784}
confusion matrix:
     0    1
0  197   28
1   56  169
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 03:59:57.310512,epoch time: 0:01:47.300473,used: 0:01:47.300473,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97362834, 'recall': 0.9737253, 'specificity': 0.9737253, 'f1': 0.97363126, 'auroc': 0.9973936, 'binary_precision': 0.98048145, 'binary_recall': 0.9672657, 'binary_specificity': 0.9801849, 'binary_f1_score': 0.9738287}
confusion matrix:
      0     1
0  1484    30
1    51  1507
---- Validation: 
scalar performance:
{'acc': 0.78332037, 'precision': 0.81191206, 'recall': 0.78032094, 'specificity': 0.78032094, 'f1': 0.7769394, 'auroc': 0.87120473, 'binary_precision': 0.90160185, 'binary_recall': 0.6263911, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.73921204}
confusion matrix:
     0    1
0  611   43
1  235  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8216231, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.80179787, 'auroc': 0.89921975, 'binary_precision': 0.8959538, 'binary_recall': 0.6888889, 'binary_specificity': 0.92, 'binary_f1_score': 0.7788945}
confusion matrix:
     0    1
0  207   18
1   70  155
better model found
persisted
after epoch: 2,now: 2024-07-29 04:01:37.334434,epoch time: 0:01:40.023922,used: 0:03:27.324395,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9810945, 'recall': 0.98115325, 'specificity': 0.98115325, 'f1': 0.98111725, 'auroc': 0.99729013, 'binary_precision': 0.983871, 'binary_recall': 0.978819, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.9813385}
confusion matrix:
      0     1
0  1489    25
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.79657054, 'precision': 0.7985313, 'recall': 0.79571843, 'specificity': 0.79571843, 'f1': 0.7958542, 'auroc': 0.859213, 'binary_precision': 0.8183391, 'binary_recall': 0.7519873, 'binary_specificity': 0.8394495, 'binary_f1_score': 0.7837614}
confusion matrix:
     0    1
0  549  105
1  156  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.80599177, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.80419695, 'auroc': 0.88071114, 'binary_precision': 0.7842324, 'binary_recall': 0.84, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.81115884}
confusion matrix:
     0    1
0  173   52
1   36  189
better model found
persisted
after epoch: 3,now: 2024-07-29 04:03:15.556534,epoch time: 0:01:38.222100,used: 0:05:05.546495,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98313576, 'recall': 0.9831972, 'specificity': 0.9831972, 'f1': 0.98307276, 'auroc': 0.9987299, 'binary_precision': 0.9927916, 'binary_recall': 0.9736504, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.98312783}
confusion matrix:
      0     1
0  1505    11
1    41  1515
---- Validation: 
scalar performance:
{'acc': 0.77007014, 'precision': 0.8154855, 'recall': 0.76632124, 'specificity': 0.76632124, 'f1': 0.75974286, 'auroc': 0.86861885, 'binary_precision': 0.93041235, 'binary_recall': 0.57392687, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.7099312}
confusion matrix:
     0    1
0  627   27
1  268  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.86088955, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8250097, 'auroc': 0.9073185, 'binary_precision': 0.9683544, 'binary_recall': 0.68, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  220    5
1   72  153
new oracle model saved
early stop counter: 1
val acc:0.7700701355934143, best validation acc: 0.7965705394744873, corresponding to test acc:                         0.804444432258606 / 0.8288888931274414
after epoch: 4,now: 2024-07-29 04:04:53.978480,epoch time: 0:01:38.421946,used: 0:06:43.968441,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.9517282, 'recall': 0.94794345, 'specificity': 0.94794345, 'f1': 0.94718236, 'auroc': 0.99818146, 'binary_precision': 1.0, 'binary_recall': 0.8958869, 'binary_specificity': 1.0, 'binary_f1_score': 0.94508475}
confusion matrix:
      0     1
0  1516     0
1   162  1394
---- Validation: 
scalar performance:
{'acc': 0.6539361, 'precision': 0.77431107, 'recall': 0.6473627, 'specificity': 0.6473627, 'f1': 0.60563743, 'auroc': 0.85461366, 'binary_precision': 0.9512195, 'binary_recall': 0.3100159, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.4676259}
confusion matrix:
     0    1
0  644   10
1  434  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6844444, 'precision': 0.80653954, 'recall': 0.6844444, 'specificity': 0.6844444, 'f1': 0.64954805, 'auroc': 0.8841877, 'binary_precision': 1.0, 'binary_recall': 0.36888888, 'binary_specificity': 1.0, 'binary_f1_score': 0.53896105}
confusion matrix:
     0   1
0  225   0
1  142  83
early stop counter: 2
val acc:0.6539360880851746, best validation acc: 0.7965705394744873, corresponding to test acc:                         0.804444432258606 / 0.8288888931274414
after epoch: 5,now: 2024-07-29 04:06:30.975136,epoch time: 0:01:36.996656,used: 0:08:20.965097,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97337794, 'recall': 0.972695, 'specificity': 0.972695, 'f1': 0.9723258, 'auroc': 0.9981067, 'binary_precision': 0.9993216, 'binary_recall': 0.9460501, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9719565}
confusion matrix:
      0     1
0  1514     1
1    84  1473
---- Validation: 
scalar performance:
{'acc': 0.7630553, 'precision': 0.81026125, 'recall': 0.75919735, 'specificity': 0.75919735, 'f1': 0.75181854, 'auroc': 0.88956547, 'binary_precision': 0.9265092, 'binary_recall': 0.56120825, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.69900995}
confusion matrix:
     0    1
0  626   28
1  276  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.82611954, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.74438614, 'auroc': 0.888079, 'binary_precision': 0.97540987, 'binary_recall': 0.5288889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.685879}
confusion matrix:
     0    1
0  222    3
1  106  119
early stop counter: 3
val acc:0.7630553245544434, best validation acc: 0.7965705394744873, corresponding to test acc:                         0.804444432258606 / 0.8288888931274414
after epoch: 6,now: 2024-07-29 04:08:09.265930,epoch time: 0:01:38.290794,used: 0:09:59.255891,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.95037913, 'recall': 0.9453753, 'specificity': 0.9453753, 'f1': 0.94577324, 'auroc': 0.9976604, 'binary_precision': 0.90876985, 'binary_recall': 0.99292606, 'binary_specificity': 0.89782465, 'binary_f1_score': 0.9489858}
confusion matrix:
      0     1
0  1362   155
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.7272019, 'precision': 0.753737, 'recall': 0.73025846, 'specificity': 0.73025846, 'f1': 0.72153664, 'auroc': 0.8636105, 'binary_precision': 0.6666667, 'binary_recall': 0.8871224, 'binary_specificity': 0.5733945, 'binary_f1_score': 0.7612551}
confusion matrix:
     0    1
0  375  279
1   71  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.7487837, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.5296823, 'auroc': 0.8866173, 'binary_precision': 0.556391, 'binary_recall': 0.9866667, 'binary_specificity': 0.21333334, 'binary_f1_score': 0.7115385}
confusion matrix:
    0    1
0  48  177
1   3  222
early stop counter: 4
val acc:0.7272018790245056, best validation acc: 0.7965705394744873, corresponding to test acc:                         0.804444432258606 / 0.8288888931274414
after epoch: 7,now: 2024-07-29 04:09:37.383756,epoch time: 0:01:28.117826,used: 0:11:27.373717,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98314667, 'recall': 0.9832122, 'specificity': 0.9832122, 'f1': 0.98307276, 'auroc': 0.99878585, 'binary_precision': 0.9934426, 'binary_recall': 0.973025, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.98312783}
confusion matrix:
      0     1
0  1505    10
1    42  1515
---- Validation: 
scalar performance:
{'acc': 0.8394388, 'precision': 0.8449292, 'recall': 0.83819276, 'specificity': 0.83819276, 'f1': 0.83839726, 'auroc': 0.88736796, 'binary_precision': 0.88384753, 'binary_recall': 0.77424484, 'binary_specificity': 0.9021407, 'binary_f1_score': 0.8254237}
confusion matrix:
     0    1
0  590   64
1  142  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8401075, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399874, 'auroc': 0.9152198, 'binary_precision': 0.84615386, 'binary_recall': 0.83111113, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8385651}
confusion matrix:
     0    1
0  191   34
1   38  187
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-29 04:11:09.141336,epoch time: 0:01:31.757580,used: 0:12:59.131297,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.984586, 'recall': 0.98456794, 'specificity': 0.98456794, 'f1': 0.984375, 'auroc': 0.99922764, 'binary_precision': 0.99867815, 'binary_recall': 0.970456, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98436487}
confusion matrix:
      0     1
0  1513     2
1    46  1511
---- Validation: 
scalar performance:
{'acc': 0.7802026, 'precision': 0.82435, 'recall': 0.7765639, 'specificity': 0.7765639, 'f1': 0.77086496, 'auroc': 0.8954022, 'binary_precision': 0.9392405, 'binary_recall': 0.5898251, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.7246094}
confusion matrix:
     0    1
0  630   24
1  258  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.8196649, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.7454579, 'auroc': 0.8891852, 'binary_precision': 0.96031743, 'binary_recall': 0.5377778, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.6894586}
confusion matrix:
     0    1
0  220    5
1  104  121
early stop counter: 1
val acc:0.7802026271820068, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 9,now: 2024-07-29 04:12:44.629731,epoch time: 0:01:35.488395,used: 0:14:34.619692,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9887178, 'recall': 0.98853445, 'specificity': 0.98853445, 'f1': 0.9886025, 'auroc': 0.9995353, 'binary_precision': 0.9841068, 'binary_recall': 0.99358153, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.98882145}
confusion matrix:
      0     1
0  1489    25
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.79345286, 'precision': 0.82858986, 'recall': 0.7902294, 'specificity': 0.7902294, 'f1': 0.78647083, 'auroc': 0.88111556, 'binary_precision': 0.9312796, 'binary_recall': 0.6248013, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7478592}
confusion matrix:
     0    1
0  625   29
1  236  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.82083625, 'recall': 0.7888889, 'specificity': 0.7888889, 'f1': 0.78349936, 'auroc': 0.8800987, 'binary_precision': 0.9220779, 'binary_recall': 0.6311111, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.7493403}
confusion matrix:
     0    1
0  213   12
1   83  142
early stop counter: 2
val acc:0.7934528589248657, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 10,now: 2024-07-29 04:14:23.438814,epoch time: 0:01:38.809083,used: 0:16:13.428775,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856484, 'recall': 0.9857324, 'specificity': 0.9857324, 'f1': 0.98567533, 'auroc': 0.9985701, 'binary_precision': 0.9896574, 'binary_recall': 0.98203975, 'binary_specificity': 0.989425, 'binary_f1_score': 0.9858339}
confusion matrix:
      0     1
0  1497    16
1    28  1531
---- Validation: 
scalar performance:
{'acc': 0.81293845, 'precision': 0.83508235, 'recall': 0.8104061, 'specificity': 0.8104061, 'f1': 0.8088783, 'auroc': 0.892468, 'binary_precision': 0.91648823, 'binary_recall': 0.68044513, 'binary_specificity': 0.940367, 'binary_f1_score': 0.7810219}
confusion matrix:
     0    1
0  615   39
1  201  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8194444, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.80471385, 'auroc': 0.8960197, 'binary_precision': 0.8833333, 'binary_recall': 0.70666665, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.7851852}
confusion matrix:
     0    1
0  204   21
1   66  159
early stop counter: 3
val acc:0.8129384517669678, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 11,now: 2024-07-29 04:15:56.929899,epoch time: 0:01:33.491085,used: 0:17:46.919860,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.988362, 'recall': 0.9882229, 'specificity': 0.9882229, 'f1': 0.9882774, 'auroc': 0.9995383, 'binary_precision': 0.9847134, 'binary_recall': 0.9922978, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.98849106}
confusion matrix:
      0     1
0  1490    24
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.81060016, 'precision': 0.81919324, 'recall': 0.8089633, 'specificity': 0.8089633, 'f1': 0.80869603, 'auroc': 0.85655355, 'binary_precision': 0.8669202, 'binary_recall': 0.72496027, 'binary_specificity': 0.8929664, 'binary_f1_score': 0.78961045}
confusion matrix:
     0    1
0  584   70
1  173  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83896434, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83263826, 'auroc': 0.902084, 'binary_precision': 0.88265306, 'binary_recall': 0.7688889, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.82185274}
confusion matrix:
     0    1
0  202   23
1   52  173
early stop counter: 4
val acc:0.8106001615524292, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 12,now: 2024-07-29 04:17:34.534478,epoch time: 0:01:37.604579,used: 0:19:24.524439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9776448, 'recall': 0.9771704, 'specificity': 0.9771704, 'f1': 0.9768854, 'auroc': 0.9993917, 'binary_precision': 1.0, 'binary_recall': 0.9543408, 'binary_specificity': 1.0, 'binary_f1_score': 0.97663707}
confusion matrix:
      0     1
0  1517     0
1    71  1484
---- Validation: 
scalar performance:
{'acc': 0.583788, 'precision': 0.77014047, 'recall': 0.5755471, 'specificity': 0.5755471, 'f1': 0.4871227, 'auroc': 0.8689294, 'binary_precision': 0.9896907, 'binary_recall': 0.1526232, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.2644628}
confusion matrix:
     0   1
0  653   1
1  533  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.779721, 'recall': 0.63111115, 'specificity': 0.63111115, 'f1': 0.57461107, 'auroc': 0.8801185, 'binary_precision': 0.9836066, 'binary_recall': 0.26666668, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.41958043}
confusion matrix:
     0   1
0  224   1
1  165  60
early stop counter: 5
val acc:0.5837879776954651, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 13,now: 2024-07-29 04:19:03.597271,epoch time: 0:01:29.062793,used: 0:20:53.587232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9846146, 'recall': 0.9845768, 'specificity': 0.9845768, 'f1': 0.98437494, 'auroc': 0.9986068, 'binary_precision': 0.9993382, 'binary_recall': 0.96981376, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9843546}
confusion matrix:
      0     1
0  1514     1
1    47  1510
---- Validation: 
scalar performance:
{'acc': 0.68199533, 'precision': 0.7882742, 'recall': 0.67597955, 'specificity': 0.67597955, 'f1': 0.6452342, 'auroc': 0.88046837, 'binary_precision': 0.9585062, 'binary_recall': 0.3672496, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.53103447}
confusion matrix:
     0    1
0  644   10
1  398  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75333333, 'precision': 0.8273688, 'recall': 0.75333333, 'specificity': 0.75333333, 'f1': 0.7385515, 'auroc': 0.91583204, 'binary_precision': 0.9830508, 'binary_recall': 0.51555556, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.67638487}
confusion matrix:
     0    1
0  223    2
1  109  116
early stop counter: 6
val acc:0.6819953322410583, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 14,now: 2024-07-29 04:20:34.639394,epoch time: 0:01:31.042123,used: 0:22:24.629355,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98959076, 'recall': 0.9895725, 'specificity': 0.9895725, 'f1': 0.98958117, 'auroc': 0.99928904, 'binary_precision': 0.98909557, 'binary_recall': 0.9903661, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.9897304}
confusion matrix:
      0     1
0  1498    17
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.8441154, 'precision': 0.8512089, 'recall': 0.84271914, 'specificity': 0.84271914, 'f1': 0.84289664, 'auroc': 0.90474665, 'binary_precision': 0.896488, 'binary_recall': 0.7710652, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.82905984}
confusion matrix:
     0    1
0  598   56
1  144  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.82478845, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8218703, 'auroc': 0.90443456, 'binary_precision': 0.85365856, 'binary_recall': 0.7777778, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.81395346}
confusion matrix:
     0    1
0  195   30
1   50  175
better model found
persisted
after epoch: 15,now: 2024-07-29 04:22:12.025582,epoch time: 0:01:37.386188,used: 0:24:02.015543,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99282515, 'recall': 0.9928535, 'specificity': 0.9928535, 'f1': 0.99283767, 'auroc': 0.99944437, 'binary_precision': 0.9941973, 'binary_recall': 0.99163985, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9929169}
confusion matrix:
      0     1
0  1508     9
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.83086514, 'precision': 0.84797204, 'recall': 0.8286891, 'specificity': 0.8286891, 'f1': 0.82805574, 'auroc': 0.8973858, 'binary_precision': 0.9204082, 'binary_recall': 0.71701115, 'binary_specificity': 0.940367, 'binary_f1_score': 0.8060769}
confusion matrix:
     0    1
0  615   39
1  178  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83101356, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.810807, 'auroc': 0.8845481, 'binary_precision': 0.90751445, 'binary_recall': 0.69777775, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7889447}
confusion matrix:
     0    1
0  209   16
1   68  157
early stop counter: 1
val acc:0.8308651447296143, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 16,now: 2024-07-29 04:23:50.595842,epoch time: 0:01:38.570260,used: 0:25:40.585803,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928707, 'recall': 0.9928105, 'specificity': 0.9928105, 'f1': 0.9928368, 'auroc': 0.99983513, 'binary_precision': 0.99104285, 'binary_recall': 0.9948619, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.9929487}
confusion matrix:
      0     1
0  1501    14
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.80436474, 'precision': 0.8255427, 'recall': 0.80184436, 'specificity': 0.80184436, 'f1': 0.8001648, 'auroc': 0.8785753, 'binary_precision': 0.90384614, 'binary_recall': 0.672496, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.77119416}
confusion matrix:
     0    1
0  609   45
1  206  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8333333, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8181818, 'auroc': 0.9005037, 'binary_precision': 0.9, 'binary_recall': 0.72, 'binary_specificity': 0.92, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  207   18
1   63  162
early stop counter: 2
val acc:0.8043647408485413, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 17,now: 2024-07-29 04:25:18.800841,epoch time: 0:01:28.204999,used: 0:27:08.790802,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9924936, 'recall': 0.9925481, 'specificity': 0.9925481, 'f1': 0.9925124, 'auroc': 0.9995791, 'binary_precision': 0.9954722, 'binary_recall': 0.9897106, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9925831}
confusion matrix:
      0     1
0  1510     7
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.80046767, 'precision': 0.8189418, 'recall': 0.7980825, 'specificity': 0.7980825, 'f1': 0.7965964, 'auroc': 0.8792341, 'binary_precision': 0.8909853, 'binary_recall': 0.6756757, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.76853526}
confusion matrix:
     0    1
0  602   52
1  204  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82889396, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8187748, 'auroc': 0.9032296, 'binary_precision': 0.88297874, 'binary_recall': 0.73777777, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.80387414}
confusion matrix:
     0    1
0  203   22
1   59  166
early stop counter: 3
val acc:0.8004676699638367, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 18,now: 2024-07-29 04:26:57.248109,epoch time: 0:01:38.447268,used: 0:28:47.238070,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98742926, 'recall': 0.9874365, 'specificity': 0.9874365, 'f1': 0.9873047, 'auroc': 0.99907166, 'binary_precision': 0.99868333, 'binary_recall': 0.97619045, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1516     2
1    37  1517
---- Validation: 
scalar performance:
{'acc': 0.7731878, 'precision': 0.8209976, 'recall': 0.7693794, 'specificity': 0.7693794, 'f1': 0.76267767, 'auroc': 0.887766, 'binary_precision': 0.9401042, 'binary_recall': 0.57392687, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.7127345}
confusion matrix:
     0    1
0  631   23
1  268  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8122326, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.7927886, 'auroc': 0.867279, 'binary_precision': 0.88439304, 'binary_recall': 0.68, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.7688442}
confusion matrix:
     0    1
0  205   20
1   72  153
early stop counter: 4
val acc:0.7731878161430359, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 19,now: 2024-07-29 04:28:35.158107,epoch time: 0:01:37.909998,used: 0:30:25.148068,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9806595, 'recall': 0.9803984, 'specificity': 0.9803984, 'f1': 0.98014235, 'auroc': 0.99943566, 'binary_precision': 1.0, 'binary_recall': 0.9607969, 'binary_specificity': 1.0, 'binary_f1_score': 0.9800066}
confusion matrix:
      0     1
0  1516     0
1    61  1495
---- Validation: 
scalar performance:
{'acc': 0.7287607, 'precision': 0.8020448, 'recall': 0.72388697, 'specificity': 0.72388697, 'f1': 0.708403, 'auroc': 0.89570606, 'binary_precision': 0.94603175, 'binary_recall': 0.47376788, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.63135594}
confusion matrix:
     0    1
0  637   17
1  331  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.8169371, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.69979346, 'auroc': 0.91100246, 'binary_precision': 0.99019605, 'binary_recall': 0.4488889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.617737}
confusion matrix:
     0    1
0  224    1
1  124  101
early stop counter: 5
val acc:0.7287607192993164, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 20,now: 2024-07-29 04:30:12.586199,epoch time: 0:01:37.428092,used: 0:32:02.576160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908837, 'recall': 0.9908837, 'specificity': 0.9908837, 'f1': 0.9908837, 'auroc': 0.99856925, 'binary_precision': 0.99100834, 'binary_recall': 0.99100834, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.99100834}
confusion matrix:
      0     1
0  1501    14
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.81839436, 'precision': 0.84009707, 'recall': 0.8159096, 'specificity': 0.8159096, 'f1': 0.81458074, 'auroc': 0.9060763, 'binary_precision': 0.92127657, 'binary_recall': 0.68839425, 'binary_specificity': 0.94342506, 'binary_f1_score': 0.787989}
confusion matrix:
     0    1
0  617   37
1  196  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.85950303, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82261616, 'auroc': 0.92815804, 'binary_precision': 0.9681529, 'binary_recall': 0.6755555, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7958115}
confusion matrix:
     0    1
0  220    5
1   73  152
early stop counter: 6
val acc:0.8183943629264832, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 21,now: 2024-07-29 04:31:50.553787,epoch time: 0:01:37.967588,used: 0:33:40.543748,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9920176, 'recall': 0.9917759, 'specificity': 0.9917759, 'f1': 0.9918588, 'auroc': 0.9996791, 'binary_precision': 0.9860406, 'binary_recall': 0.9980732, 'binary_specificity': 0.9854785, 'binary_f1_score': 0.9920204}
confusion matrix:
      0     1
0  1493    22
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.8417771, 'precision': 0.8514147, 'recall': 0.8401521, 'specificity': 0.8401521, 'f1': 0.84018636, 'auroc': 0.8940117, 'binary_precision': 0.904943, 'binary_recall': 0.7567568, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.8242424}
confusion matrix:
     0    1
0  604   50
1  153  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.83732057, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.80995476, 'auroc': 0.91085434, 'binary_precision': 0.92727274, 'binary_recall': 0.68, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.78461546}
confusion matrix:
     0    1
0  213   12
1   72  153
early stop counter: 7
val acc:0.8417770862579346, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 22,now: 2024-07-29 04:33:29.872591,epoch time: 0:01:39.318804,used: 0:35:19.862552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151385, 'recall': 0.9915705, 'specificity': 0.9915705, 'f1': 0.99153537, 'auroc': 0.9994311, 'binary_precision': 0.9941898, 'binary_recall': 0.98908156, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.99162906}
confusion matrix:
      0     1
0  1506     9
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.82307094, 'precision': 0.8457252, 'recall': 0.8205576, 'specificity': 0.8205576, 'f1': 0.8192726, 'auroc': 0.9157125, 'binary_precision': 0.92948717, 'binary_recall': 0.6915739, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.79307204}
confusion matrix:
     0    1
0  621   33
1  194  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.8323328, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.76554155, 'auroc': 0.9248395, 'binary_precision': 0.969697, 'binary_recall': 0.5688889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.71708685}
confusion matrix:
     0    1
0  221    4
1   97  128
early stop counter: 8
val acc:0.8230709433555603, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 23,now: 2024-07-29 04:35:02.148510,epoch time: 0:01:32.275919,used: 0:36:52.138471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.995096, 'recall': 0.99516296, 'specificity': 0.99516296, 'f1': 0.9951167, 'auroc': 0.99971807, 'binary_precision': 0.9987055, 'binary_recall': 0.9916452, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9951628}
confusion matrix:
      0     1
0  1514     2
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.7264224, 'precision': 0.79951096, 'recall': 0.72153264, 'specificity': 0.72153264, 'f1': 0.7057588, 'auroc': 0.8873017, 'binary_precision': 0.9426752, 'binary_recall': 0.47058824, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.62778366}
confusion matrix:
     0    1
0  636   18
1  333  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.7710843, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.48617786, 'auroc': 0.90899754, 'binary_precision': 1.0, 'binary_recall': 0.15555556, 'binary_specificity': 1.0, 'binary_f1_score': 0.26923075}
confusion matrix:
     0   1
0  225   0
1  190  35
early stop counter: 9
val acc:0.7264224290847778, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 24,now: 2024-07-29 04:36:33.597072,epoch time: 0:01:31.448562,used: 0:38:23.587033,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99284786, 'recall': 0.9929306, 'specificity': 0.9929306, 'f1': 0.9928383, 'auroc': 0.99981225, 'binary_precision': 1.0, 'binary_recall': 0.9858612, 'binary_specificity': 1.0, 'binary_f1_score': 0.9928803}
confusion matrix:
      0     1
0  1516     0
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.7147311, 'precision': 0.80138326, 'recall': 0.70942664, 'specificity': 0.70942664, 'f1': 0.6893093, 'auroc': 0.8851825, 'binary_precision': 0.9581882, 'binary_recall': 0.43720192, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.60043675}
confusion matrix:
     0    1
0  642   12
1  354  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.83522725, 'recall': 0.76222223, 'specificity': 0.76222223, 'f1': 0.74853116, 'auroc': 0.92080986, 'binary_precision': 0.9916667, 'binary_recall': 0.5288889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.6898551}
confusion matrix:
     0    1
0  224    1
1  106  119
early stop counter: 10
val acc:0.7147310972213745, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8399999737739563
after epoch: 25,now: 2024-07-29 04:38:11.121266,epoch time: 0:01:37.524194,used: 0:40:01.111227,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9952059, 'recall': 0.9950613, 'specificity': 0.9950613, 'f1': 0.99511576, 'auroc': 0.9999368, 'binary_precision': 0.9910771, 'binary_recall': 0.99935734, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.99520004}
confusion matrix:
      0     1
0  1502    14
1     1  1555
---- Validation: 
scalar performance:
{'acc': 0.8152767, 'precision': 0.827021, 'recall': 0.81339854, 'specificity': 0.81339854, 'f1': 0.81292003, 'auroc': 0.86702836, 'binary_precision': 0.8843137, 'binary_recall': 0.71701115, 'binary_specificity': 0.9097859, 'binary_f1_score': 0.79192275}
confusion matrix:
     0    1
0  595   59
1  178  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.9390025, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
new oracle model saved
early stop counter: 11
val acc:0.8152766823768616, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8488888740539551
after epoch: 26,now: 2024-07-29 04:39:46.714376,epoch time: 0:01:35.593110,used: 0:41:36.704337,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9903359, 'recall': 0.99016714, 'specificity': 0.99016714, 'f1': 0.9902309, 'auroc': 0.99966466, 'binary_precision': 0.98600507, 'binary_recall': 0.99486524, 'binary_specificity': 0.985469, 'binary_f1_score': 0.9904154}
confusion matrix:
      0     1
0  1492    22
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.81137955, 'precision': 0.8322613, 'recall': 0.8089074, 'specificity': 0.8089074, 'f1': 0.80746245, 'auroc': 0.8821919, 'binary_precision': 0.91082805, 'binary_recall': 0.68203497, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.78}
confusion matrix:
     0    1
0  612   42
1  200  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8372005, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8151154, 'auroc': 0.90269625, 'binary_precision': 0.91812867, 'binary_recall': 0.69777775, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.79292923}
confusion matrix:
     0    1
0  211   14
1   68  157
early stop counter: 12
val acc:0.8113795518875122, best validation acc: 0.8441153764724731, corresponding to test acc:                         0.8222222328186035 / 0.8488888740539551
after epoch: 27,now: 2024-07-29 04:41:18.442773,epoch time: 0:01:31.728397,used: 0:43:08.432734,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9885988, 'recall': 0.9881389, 'specificity': 0.9881389, 'f1': 0.98827446, 'auroc': 0.9999063, 'binary_precision': 0.97921914, 'binary_recall': 0.9980745, 'binary_specificity': 0.9782034, 'binary_f1_score': 0.98855686}
confusion matrix:
      0     1
0  1481    33
1     3  1555
---- Validation: 
scalar performance:
{'acc': 0.84801245, 'precision': 0.85472596, 'recall': 0.8466633, 'specificity': 0.8466633, 'f1': 0.846887, 'auroc': 0.90187323, 'binary_precision': 0.89889705, 'binary_recall': 0.77742445, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.83375955}
confusion matrix:
     0    1
0  599   55
1  140  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85814047, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84294283, 'auroc': 0.93301725, 'binary_precision': 0.9281768, 'binary_recall': 0.74666667, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8275862}
confusion matrix:
     0    1
0  212   13
1   57  168
better model found
persisted
after epoch: 28,now: 2024-07-29 04:42:54.978366,epoch time: 0:01:36.535593,used: 0:44:44.968327,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938071, 'recall': 0.9938985, 'specificity': 0.9938985, 'f1': 0.99381477, 'auroc': 0.99984694, 'binary_precision': 1.0, 'binary_recall': 0.987797, 'binary_specificity': 1.0, 'binary_f1_score': 0.9938611}
confusion matrix:
      0     1
0  1515     0
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.8152767, 'precision': 0.83849627, 'recall': 0.8126997, 'specificity': 0.8126997, 'f1': 0.8111347, 'auroc': 0.89620435, 'binary_precision': 0.92241377, 'binary_recall': 0.68044513, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.7831655}
confusion matrix:
     0    1
0  618   36
1  201  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.82087225, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7480507, 'auroc': 0.91500247, 'binary_precision': 0.96062994, 'binary_recall': 0.5422222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.69318175}
confusion matrix:
     0    1
0  220    5
1  103  122
early stop counter: 1
val acc:0.8152766823768616, best validation acc: 0.8480124473571777, corresponding to test acc:                         0.8444444537162781 / 0.8488888740539551
after epoch: 29,now: 2024-07-29 04:44:37.358133,epoch time: 0:01:42.379767,used: 0:46:27.348094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874598, 'recall': 0.9874679, 'specificity': 0.9874679, 'f1': 0.9873047, 'auroc': 0.99994314, 'binary_precision': 1.0, 'binary_recall': 0.9749357, 'binary_specificity': 1.0, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1516     0
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.7381138, 'precision': 0.7939899, 'recall': 0.7337906, 'specificity': 0.7337906, 'f1': 0.72264457, 'auroc': 0.84115607, 'binary_precision': 0.9173789, 'binary_recall': 0.5119237, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.6571428}
confusion matrix:
     0    1
0  625   29
1  307  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.72994375, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.48158848, 'auroc': 0.7902222, 'binary_precision': 0.92105263, 'binary_recall': 0.15555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.2661597}
confusion matrix:
     0   1
0  222   3
1  190  35
early stop counter: 2
val acc:0.7381138205528259, best validation acc: 0.8480124473571777, corresponding to test acc:                         0.8444444537162781 / 0.8488888740539551
after epoch: 30,now: 2024-07-29 04:46:15.714620,epoch time: 0:01:38.356487,used: 0:48:05.704581,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_58_09_seed_3_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:05.704581 at 2024-07-29 04:46:15.714620
persisted model performance metric: 

scalar performance:
{'acc': 0.84444445, 'precision': 0.85814047, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84294283, 'auroc': 0.93301725, 'binary_precision': 0.9281768, 'binary_recall': 0.74666667, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8275862}
confusion matrix:
     0    1
0  212   13
1   57  168
oracle model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.9390025, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454150 KiB |  13219 MiB | 295813 GiB | 295812 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 292317 GiB | 292316 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3495 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454150 KiB |  13219 MiB | 295813 GiB | 295812 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 292317 GiB | 292316 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3495 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 295171 GiB | 295170 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14488 MiB |  55246 MiB |  40766 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  55126 MiB |  40716 MiB |
|       from small pool |     70 MiB |     70 MiB |    120 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 463353 KiB |   1260 MiB | 212166 GiB | 212166 GiB |
|       from large pool | 450704 KiB |   1252 MiB | 208649 GiB | 208649 GiB |
|       from small pool |  12649 KiB |     45 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51930 K  |   51928 K  |
|       from large pool |     187    |    1413    |   26402 K  |   26402 K  |
|       from small pool |    1123    |    1419    |   25527 K  |   25526 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51930 K  |   51928 K  |
|       from large pool |     187    |    1413    |   26402 K  |   26402 K  |
|       from small pool |    1123    |    1419    |   25527 K  |   25526 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    2354    |    1717    |
|       from large pool |     602    |     602    |    2294    |    1692    |
|       from small pool |      35    |      35    |      60    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     655    |   34654 K  |   34654 K  |
|       from large pool |      38    |     604    |   19645 K  |   19645 K  |
|       from small pool |      61    |     237    |   15009 K  |   15009 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14488 MiB |  55246 MiB |  54350 MiB |
|       from large pool |    844 MiB |  14422 MiB |  55126 MiB |  54282 MiB |
|       from small pool |     52 MiB |     70 MiB |    120 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 212166 GiB | 212166 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 208649 GiB | 208649 GiB |
|       from small pool |      0 KiB |     45 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26402 K  |   26402 K  |
|       from small pool |       0    |    1419    |   25527 K  |   25527 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26402 K  |   26402 K  |
|       from small pool |       0    |    1419    |   25527 K  |   25527 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    2354    |    2290    |
|       from large pool |      38    |     602    |    2294    |    2256    |
|       from small pool |      26    |      35    |      60    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   34655 K  |   34655 K  |
|       from large pool |       3    |     604    |   19645 K  |   19645 K  |
|       from small pool |       0    |     237    |   15009 K  |   15009 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14488 MiB |  55246 MiB |  54350 MiB |
|       from large pool |    844 MiB |  14422 MiB |  55126 MiB |  54282 MiB |
|       from small pool |     52 MiB |     70 MiB |    120 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 212166 GiB | 212166 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 208649 GiB | 208649 GiB |
|       from small pool |      0 KiB |     45 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26402 K  |   26402 K  |
|       from small pool |       0    |    1419    |   25527 K  |   25527 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51930 K  |   51930 K  |
|       from large pool |       2    |    1413    |   26402 K  |   26402 K  |
|       from small pool |       0    |    1419    |   25527 K  |   25527 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    2354    |    2290    |
|       from large pool |      38    |     602    |    2294    |    2256    |
|       from small pool |      26    |      35    |      60    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   34655 K  |   34655 K  |
|       from large pool |       3    |     604    |   19645 K  |   19645 K  |
|       from small pool |       0    |     237    |   15009 K  |   15009 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369

 Experiment start at: 2024-07-29 04:46:55.603025
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9404145, 'precision': 0.9404046, 'recall': 0.9403832, 'specificity': 0.9403832, 'f1': 0.94039345, 'auroc': 0.9857919, 'binary_precision': 0.94091487, 'binary_recall': 0.94211197, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.941513}
confusion matrix:
      0     1
0  1423    93
1    91  1481
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.7993785, 'recall': 0.7680048, 'specificity': 0.7680048, 'f1': 0.76001644, 'auroc': 0.904683, 'binary_precision': 0.6957547, 'binary_recall': 0.9335443, 'binary_specificity': 0.60246533, 'binary_f1_score': 0.7972973}
confusion matrix:
     0    1
0  391  258
1   42  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76303315, 'precision': 0.8022455, 'recall': 0.76303315, 'specificity': 0.76303315, 'f1': 0.75508976, 'auroc': 0.9160621, 'binary_precision': 0.6933798, 'binary_recall': 0.943128, 'binary_specificity': 0.5829384, 'binary_f1_score': 0.79919684}
confusion matrix:
     0    1
0  123   88
1   12  199
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:48:31.281414,epoch time: 0:01:35.678389,used: 0:01:35.678389,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9630829, 'precision': 0.964054, 'recall': 0.96353066, 'specificity': 0.96353066, 'f1': 0.963079, 'auroc': 0.9940611, 'binary_precision': 0.9899058, 'binary_recall': 0.9369427, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9626964}
confusion matrix:
      0     1
0  1503    15
1    99  1471
---- Validation: 
scalar performance:
{'acc': 0.76502734, 'precision': 0.7924398, 'recall': 0.76296544, 'specificity': 0.76296544, 'f1': 0.75841045, 'auroc': 0.85845554, 'binary_precision': 0.87871855, 'binary_recall': 0.6075949, 'binary_specificity': 0.9183359, 'binary_f1_score': 0.71842843}
confusion matrix:
     0    1
0  596   53
1  248  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8540603, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.83443916, 'auroc': 0.90168685, 'binary_precision': 0.93292683, 'binary_recall': 0.72511846, 'binary_specificity': 0.9478673, 'binary_f1_score': 0.8159999}
confusion matrix:
     0    1
0  200   11
1   58  153
new oracle model saved
early stop counter: 1
val acc:0.7650273442268372, best validation acc: 0.7658079862594604, corresponding to test acc:                         0.7630331516265869 / 0.8364928960800171
after epoch: 2,now: 2024-07-29 04:50:07.148700,epoch time: 0:01:35.867286,used: 0:03:11.545675,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9702073, 'precision': 0.9702014, 'recall': 0.9703671, 'specificity': 0.9703671, 'f1': 0.9702045, 'auroc': 0.9955394, 'binary_precision': 0.97928804, 'binary_recall': 0.9618563, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.9704939}
confusion matrix:
      0     1
0  1483    32
1    60  1513
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.82276905, 'recall': 0.8203139, 'specificity': 0.8203139, 'f1': 0.8194186, 'auroc': 0.9058776, 'binary_precision': 0.78766143, 'binary_recall': 0.8686709, 'binary_specificity': 0.77195686, 'binary_f1_score': 0.8261851}
confusion matrix:
     0    1
0  501  148
1   83  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83175355, 'precision': 0.8390726, 'recall': 0.8317536, 'specificity': 0.8317536, 'f1': 0.8308408, 'auroc': 0.92039716, 'binary_precision': 0.7892562, 'binary_recall': 0.9052133, 'binary_specificity': 0.75829387, 'binary_f1_score': 0.8432672}
confusion matrix:
     0    1
0  160   51
1   20  191
better model found
persisted
after epoch: 3,now: 2024-07-29 04:51:42.147376,epoch time: 0:01:34.998676,used: 0:04:46.544351,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9692358, 'precision': 0.969231, 'recall': 0.96921974, 'specificity': 0.96921974, 'f1': 0.9692253, 'auroc': 0.99587524, 'binary_precision': 0.96948504, 'binary_recall': 0.9701018, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9697933}
confusion matrix:
      0     1
0  1468    48
1    47  1525
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.83527124, 'recall': 0.83532846, 'specificity': 0.83532846, 'f1': 0.8352749, 'auroc': 0.9090885, 'binary_precision': 0.829421, 'binary_recall': 0.8386076, 'binary_specificity': 0.8320493, 'binary_f1_score': 0.83398896}
confusion matrix:
     0    1
0  540  109
1  102  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86018956, 'precision': 0.86712456, 'recall': 0.86018956, 'specificity': 0.86018956, 'f1': 0.85952616, 'auroc': 0.9376025, 'binary_precision': 0.9175824, 'binary_recall': 0.7914692, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.84987277}
confusion matrix:
     0    1
0  196   15
1   44  167
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 04:53:20.383218,epoch time: 0:01:38.235842,used: 0:06:24.780193,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9575777, 'precision': 0.9603795, 'recall': 0.9569473, 'specificity': 0.9569473, 'f1': 0.9574592, 'auroc': 0.99788857, 'binary_precision': 0.9285714, 'binary_recall': 0.99299806, 'binary_specificity': 0.92089653, 'binary_f1_score': 0.9597047}
confusion matrix:
      0     1
0  1397   120
1    11  1560
---- Validation: 
scalar performance:
{'acc': 0.7314598, 'precision': 0.7915075, 'recall': 0.73443806, 'specificity': 0.73443806, 'f1': 0.7184861, 'auroc': 0.9136573, 'binary_precision': 0.65584415, 'binary_recall': 0.95886075, 'binary_specificity': 0.5100154, 'binary_f1_score': 0.77892035}
confusion matrix:
     0    1
0  331  318
1   26  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7203792, 'precision': 0.7779068, 'recall': 0.7203791, 'specificity': 0.7203791, 'f1': 0.7051188, 'auroc': 0.90986276, 'binary_precision': 0.6514658, 'binary_recall': 0.9478673, 'binary_specificity': 0.49289098, 'binary_f1_score': 0.77220076}
confusion matrix:
     0    1
0  104  107
1   11  200
early stop counter: 1
val acc:0.7314597964286804, best validation acc: 0.835284948348999, corresponding to test acc:                         0.8601895570755005 / 0.8601895570755005
after epoch: 5,now: 2024-07-29 04:54:56.930232,epoch time: 0:01:36.547014,used: 0:08:01.327207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9695596, 'precision': 0.9706193, 'recall': 0.96919906, 'specificity': 0.96919906, 'f1': 0.9695166, 'auroc': 0.9978718, 'binary_precision': 0.95223516, 'binary_recall': 0.9898154, 'binary_specificity': 0.9485827, 'binary_f1_score': 0.9706617}
confusion matrix:
      0     1
0  1439    78
1    16  1555
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.8361119, 'recall': 0.836161, 'specificity': 0.836161, 'f1': 0.8360631, 'auroc': 0.9074209, 'binary_precision': 0.82763976, 'binary_recall': 0.8433544, 'binary_specificity': 0.82896763, 'binary_f1_score': 0.8354232}
confusion matrix:
     0    1
0  538  111
1   99  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84123224, 'precision': 0.8413012, 'recall': 0.8412322, 'specificity': 0.8412322, 'f1': 0.8412242, 'auroc': 0.9015521, 'binary_precision': 0.8364486, 'binary_recall': 0.8483412, 'binary_specificity': 0.8341232, 'binary_f1_score': 0.8423529}
confusion matrix:
     0    1
0  176   35
1   32  179
better model found
persisted
after epoch: 6,now: 2024-07-29 04:56:31.410991,epoch time: 0:01:34.480759,used: 0:09:35.807966,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98542744, 'precision': 0.98538727, 'recall': 0.9854771, 'specificity': 0.9854771, 'f1': 0.9854238, 'auroc': 0.99876714, 'binary_precision': 0.98849106, 'binary_recall': 0.98283535, 'binary_specificity': 0.9881188, 'binary_f1_score': 0.9856551}
confusion matrix:
      0     1
0  1497    18
1    27  1546
---- Validation: 
scalar performance:
{'acc': 0.81186575, 'precision': 0.8128581, 'recall': 0.8114699, 'specificity': 0.8114699, 'f1': 0.81155515, 'auroc': 0.8900597, 'binary_precision': 0.82747066, 'binary_recall': 0.7816456, 'binary_specificity': 0.8412943, 'binary_f1_score': 0.80390555}
confusion matrix:
     0    1
0  546  103
1  138  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.83913684, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.83883, 'auroc': 0.91716266, 'binary_precision': 0.8487805, 'binary_recall': 0.82464457, 'binary_specificity': 0.8530806, 'binary_f1_score': 0.8365385}
confusion matrix:
     0    1
0  180   31
1   37  174
early stop counter: 1
val acc:0.8118657469749451, best validation acc: 0.8360655903816223, corresponding to test acc:                         0.8412322402000427 / 0.8601895570755005
after epoch: 7,now: 2024-07-29 04:58:06.787638,epoch time: 0:01:35.376647,used: 0:11:11.184613,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97409326, 'precision': 0.97424126, 'recall': 0.9739834, 'specificity': 0.9739834, 'f1': 0.9740792, 'auroc': 0.9968722, 'binary_precision': 0.969163, 'binary_recall': 0.98026735, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.9746836}
confusion matrix:
      0     1
0  1468    49
1    31  1540
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8033457, 'recall': 0.8015131, 'specificity': 0.8015131, 'f1': 0.8007226, 'auroc': 0.886327, 'binary_precision': 0.77279305, 'binary_recall': 0.8449367, 'binary_specificity': 0.75808936, 'binary_f1_score': 0.8072563}
confusion matrix:
     0    1
0  492  157
1   98  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76540285, 'precision': 0.7879143, 'recall': 0.76540285, 'specificity': 0.76540285, 'f1': 0.76072574, 'auroc': 0.8891759, 'binary_precision': 0.7074074, 'binary_recall': 0.9052133, 'binary_specificity': 0.6255924, 'binary_f1_score': 0.7941788}
confusion matrix:
     0    1
0  132   79
1   20  191
early stop counter: 2
val acc:0.800936758518219, best validation acc: 0.8360655903816223, corresponding to test acc:                         0.8412322402000427 / 0.8601895570755005
after epoch: 8,now: 2024-07-29 04:59:43.933314,epoch time: 0:01:37.145676,used: 0:12:48.330289,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9893135, 'precision': 0.9892664, 'recall': 0.9894165, 'specificity': 0.9894165, 'f1': 0.98931134, 'auroc': 0.99797523, 'binary_precision': 0.9948619, 'binary_recall': 0.9841169, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9894602}
confusion matrix:
      0     1
0  1506     8
1    25  1549
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.8620887, 'recall': 0.85892123, 'specificity': 0.85892123, 'f1': 0.8590759, 'auroc': 0.9208251, 'binary_precision': 0.8896552, 'binary_recall': 0.8164557, 'binary_specificity': 0.90138674, 'binary_f1_score': 0.85148513}
confusion matrix:
     0    1
0  585   64
1  116  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.86001813, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.84710145, 'auroc': 0.92271066, 'binary_precision': 0.9248555, 'binary_recall': 0.75829387, 'binary_specificity': 0.93838865, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  198   13
1   51  160
better model found
persisted
after epoch: 9,now: 2024-07-29 05:01:21.298109,epoch time: 0:01:37.364795,used: 0:14:25.695084,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9766839, 'precision': 0.9773443, 'recall': 0.97708464, 'specificity': 0.97708464, 'f1': 0.97668314, 'auroc': 0.9990228, 'binary_precision': 1.0, 'binary_recall': 0.95416933, 'binary_specificity': 1.0, 'binary_f1_score': 0.97654724}
confusion matrix:
      0     1
0  1517     0
1    72  1499
---- Validation: 
scalar performance:
{'acc': 0.6705699, 'precision': 0.7803923, 'recall': 0.6663672, 'specificity': 0.6663672, 'f1': 0.63152325, 'auroc': 0.9105952, 'binary_precision': 0.95258623, 'binary_recall': 0.34968355, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.5115741}
confusion matrix:
     0    1
0  638   11
1  411  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5165877, 'precision': 0.6986817, 'recall': 0.5165877, 'specificity': 0.5165877, 'f1': 0.3729021, 'auroc': 0.91064894, 'binary_precision': 0.8888889, 'binary_recall': 0.037914693, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.07272727}
confusion matrix:
     0  1
0  210  1
1  203  8
early stop counter: 1
val acc:0.670569896697998, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 10,now: 2024-07-29 05:02:58.664257,epoch time: 0:01:37.366148,used: 0:16:03.061232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9682642, 'precision': 0.9696782, 'recall': 0.9687898, 'specificity': 0.9687898, 'f1': 0.9682572, 'auroc': 0.9986527, 'binary_precision': 1.0, 'binary_recall': 0.93757963, 'binary_specificity': 1.0, 'binary_f1_score': 0.96778435}
confusion matrix:
      0     1
0  1518     0
1    98  1472
---- Validation: 
scalar performance:
{'acc': 0.6057767, 'precision': 0.76322037, 'recall': 0.6005783, 'specificity': 0.6005783, 'f1': 0.53082603, 'auroc': 0.9093591, 'binary_precision': 0.96350366, 'binary_recall': 0.20886075, 'binary_specificity': 0.99229586, 'binary_f1_score': 0.34330297}
confusion matrix:
     0    1
0  644    5
1  500  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.578199, 'precision': 0.7712082, 'recall': 0.578199, 'specificity': 0.578199, 'f1': 0.48691255, 'auroc': 0.90370834, 'binary_precision': 1.0, 'binary_recall': 0.1563981, 'binary_specificity': 1.0, 'binary_f1_score': 0.2704918}
confusion matrix:
     0   1
0  211   0
1  178  33
early stop counter: 2
val acc:0.6057767271995544, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 11,now: 2024-07-29 05:04:37.522229,epoch time: 0:01:38.857972,used: 0:17:41.919204,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9702073, 'precision': 0.97128, 'recall': 0.96983325, 'specificity': 0.96983325, 'f1': 0.9701637, 'auroc': 0.997059, 'binary_precision': 0.9528764, 'binary_recall': 0.990458, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.9713038}
confusion matrix:
      0     1
0  1439    77
1    15  1557
---- Validation: 
scalar performance:
{'acc': 0.75409836, 'precision': 0.7727585, 'recall': 0.75232464, 'specificity': 0.75232464, 'f1': 0.74891806, 'auroc': 0.8566929, 'binary_precision': 0.8408602, 'binary_recall': 0.6186709, 'binary_specificity': 0.8859784, 'binary_f1_score': 0.7128532}
confusion matrix:
     0    1
0  575   74
1  241  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7985782, 'precision': 0.80805063, 'recall': 0.7985782, 'specificity': 0.7985782, 'f1': 0.7970178, 'auroc': 0.8700613, 'binary_precision': 0.86206895, 'binary_recall': 0.7109005, 'binary_specificity': 0.8862559, 'binary_f1_score': 0.77922076}
confusion matrix:
     0    1
0  187   24
1   61  150
early stop counter: 3
val acc:0.7540983557701111, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 12,now: 2024-07-29 05:06:07.939695,epoch time: 0:01:30.417466,used: 0:19:12.336670,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98996115, 'precision': 0.9899515, 'recall': 0.98996365, 'specificity': 0.98996365, 'f1': 0.98995745, 'auroc': 0.9996886, 'binary_precision': 0.9904641, 'binary_recall': 0.98983485, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.9901493}
confusion matrix:
      0     1
0  1499    15
1    16  1558
---- Validation: 
scalar performance:
{'acc': 0.7064793, 'precision': 0.78818715, 'recall': 0.70290464, 'specificity': 0.70290464, 'f1': 0.6817627, 'auroc': 0.88953066, 'binary_precision': 0.93835616, 'binary_recall': 0.4335443, 'binary_specificity': 0.972265, 'binary_f1_score': 0.5930736}
confusion matrix:
     0    1
0  631   18
1  358  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7393365, 'precision': 0.82012916, 'recall': 0.7393365, 'specificity': 0.7393365, 'f1': 0.7217827, 'auroc': 0.90694284, 'binary_precision': 0.9809524, 'binary_recall': 0.48815167, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.65189874}
confusion matrix:
     0    1
0  209    2
1  108  103
early stop counter: 4
val acc:0.7064793109893799, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 13,now: 2024-07-29 05:07:39.344937,epoch time: 0:01:31.405242,used: 0:20:43.741912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97279793, 'precision': 0.97344285, 'recall': 0.97252905, 'specificity': 0.97252905, 'f1': 0.9727694, 'auroc': 0.99834764, 'binary_precision': 0.9598021, 'binary_recall': 0.9879058, 'binary_specificity': 0.95715225, 'binary_f1_score': 0.9736512}
confusion matrix:
      0     1
0  1452    65
1    19  1552
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.83082783, 'recall': 0.8301842, 'specificity': 0.8301842, 'f1': 0.82977474, 'auroc': 0.89909565, 'binary_precision': 0.80895525, 'binary_recall': 0.8575949, 'binary_specificity': 0.8027735, 'binary_f1_score': 0.8325653}
confusion matrix:
     0    1
0  521  128
1   90  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8151659, 'precision': 0.8281685, 'recall': 0.8151659, 'specificity': 0.8151659, 'f1': 0.8133167, 'auroc': 0.92385614, 'binary_precision': 0.7628459, 'binary_recall': 0.9146919, 'binary_specificity': 0.7156398, 'binary_f1_score': 0.8318966}
confusion matrix:
     0    1
0  151   60
1   18  193
early stop counter: 5
val acc:0.829820454120636, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 14,now: 2024-07-29 05:09:15.887635,epoch time: 0:01:36.542698,used: 0:22:20.284610,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.9834454, 'recall': 0.98362744, 'specificity': 0.98362744, 'f1': 0.9834818, 'auroc': 0.99920356, 'binary_precision': 0.9909794, 'binary_recall': 0.97650796, 'binary_specificity': 0.99074686, 'binary_f1_score': 0.98369044}
confusion matrix:
      0     1
0  1499    14
1    37  1538
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.8278376, 'recall': 0.7748983, 'specificity': 0.7748983, 'f1': 0.7674921, 'auroc': 0.9329982, 'binary_precision': 0.95300263, 'binary_recall': 0.57753164, 'binary_specificity': 0.972265, 'binary_f1_score': 0.7192118}
confusion matrix:
     0    1
0  631   18
1  267  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7867299, 'precision': 0.8504983, 'recall': 0.7867299, 'specificity': 0.7867299, 'f1': 0.7765672, 'auroc': 0.92933667, 'binary_precision': 1.0, 'binary_recall': 0.57345974, 'binary_specificity': 1.0, 'binary_f1_score': 0.7289157}
confusion matrix:
     0    1
0  211    0
1   90  121
early stop counter: 6
val acc:0.777517557144165, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 15,now: 2024-07-29 05:10:52.288462,epoch time: 0:01:36.400827,used: 0:23:56.685437,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98996115, 'precision': 0.98996377, 'recall': 0.9899524, 'specificity': 0.9899524, 'f1': 0.9899579, 'auroc': 0.9995146, 'binary_precision': 0.9898219, 'binary_recall': 0.99045193, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9901368}
confusion matrix:
      0     1
0  1501    16
1    15  1556
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.82733315, 'recall': 0.77731323, 'specificity': 0.77731323, 'f1': 0.77047676, 'auroc': 0.9159954, 'binary_precision': 0.94871795, 'binary_recall': 0.585443, 'binary_specificity': 0.9691834, 'binary_f1_score': 0.7240704}
confusion matrix:
     0    1
0  629   20
1  262  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.84597194, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.7998612, 'auroc': 0.9162193, 'binary_precision': 0.9640288, 'binary_recall': 0.6350711, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.7657142}
confusion matrix:
     0    1
0  206    5
1   77  134
early stop counter: 7
val acc:0.7798594832420349, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 16,now: 2024-07-29 05:12:28.926973,epoch time: 0:01:36.638511,used: 0:25:33.323948,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.98338795, 'recall': 0.9834488, 'specificity': 0.9834488, 'f1': 0.98316056, 'auroc': 0.9994029, 'binary_precision': 0.999343, 'binary_recall': 0.96755725, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9831933}
confusion matrix:
      0     1
0  1515     1
1    51  1521
---- Validation: 
scalar performance:
{'acc': 0.7205308, 'precision': 0.80527675, 'recall': 0.7170001, 'specificity': 0.7170001, 'f1': 0.69756496, 'auroc': 0.9176557, 'binary_precision': 0.9628378, 'binary_recall': 0.45094937, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.61422414}
confusion matrix:
     0    1
0  638   11
1  347  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62085307, 'precision': 0.7843666, 'recall': 0.62085307, 'specificity': 0.62085307, 'f1': 0.5571995, 'auroc': 0.9130972, 'binary_precision': 1.0, 'binary_recall': 0.24170616, 'binary_specificity': 1.0, 'binary_f1_score': 0.38931298}
confusion matrix:
     0   1
0  211   0
1  160  51
early stop counter: 8
val acc:0.7205308079719543, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 17,now: 2024-07-29 05:14:05.709075,epoch time: 0:01:36.782102,used: 0:27:10.106050,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9857513, 'precision': 0.98572063, 'recall': 0.9858315, 'specificity': 0.9858315, 'f1': 0.9857496, 'auroc': 0.9992455, 'binary_precision': 0.9909852, 'binary_recall': 0.98087955, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.98590654}
confusion matrix:
      0     1
0  1505    14
1    30  1539
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8317294, 'recall': 0.8021287, 'specificity': 0.8021287, 'f1': 0.7991637, 'auroc': 0.91310084, 'binary_precision': 0.9242762, 'binary_recall': 0.6566456, 'binary_specificity': 0.9476117, 'binary_f1_score': 0.76780754}
confusion matrix:
     0    1
0  615   34
1  217  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73696685, 'precision': 0.823223, 'recall': 0.73696685, 'specificity': 0.73696685, 'f1': 0.71816397, 'auroc': 0.933784, 'binary_precision': 0.99019605, 'binary_recall': 0.47867298, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.64536744}
confusion matrix:
     0    1
0  210    1
1  110  101
early stop counter: 9
val acc:0.8040593266487122, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 18,now: 2024-07-29 05:15:42.831753,epoch time: 0:01:37.122678,used: 0:28:47.228728,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9867228, 'precision': 0.9867228, 'recall': 0.98691905, 'specificity': 0.98691905, 'f1': 0.98672146, 'auroc': 0.999658, 'binary_precision': 0.9967617, 'binary_recall': 0.9771429, 'binary_specificity': 0.9966953, 'binary_f1_score': 0.98685473}
confusion matrix:
      0     1
0  1508     5
1    36  1539
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8551738, 'recall': 0.83208835, 'specificity': 0.83208835, 'f1': 0.83067083, 'auroc': 0.92554027, 'binary_precision': 0.9392034, 'binary_recall': 0.70886075, 'binary_specificity': 0.9553159, 'binary_f1_score': 0.80793506}
confusion matrix:
     0    1
0  620   29
1  184  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.8545998, 'recall': 0.8199052, 'specificity': 0.8199052, 'f1': 0.81538963, 'auroc': 0.9326385, 'binary_precision': 0.9655172, 'binary_recall': 0.6635071, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.7865169}
confusion matrix:
     0    1
0  206    5
1   71  140
early stop counter: 10
val acc:0.8337236642837524, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 19,now: 2024-07-29 05:17:13.559743,epoch time: 0:01:30.727990,used: 0:30:17.956718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9627591, 'precision': 0.964589, 'recall': 0.9633989, 'specificity': 0.9633989, 'f1': 0.9627472, 'auroc': 0.99860644, 'binary_precision': 0.99863106, 'binary_recall': 0.92811704, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.96208376}
confusion matrix:
      0     1
0  1514     2
1   113  1459
---- Validation: 
scalar performance:
{'acc': 0.63856363, 'precision': 0.7512635, 'recall': 0.63405484, 'specificity': 0.63405484, 'f1': 0.588707, 'auroc': 0.8716965, 'binary_precision': 0.9162561, 'binary_recall': 0.2943038, 'binary_specificity': 0.97380584, 'binary_f1_score': 0.445509}
confusion matrix:
     0    1
0  632   17
1  446  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52606636, 'precision': 0.756691, 'recall': 0.52606636, 'specificity': 0.52606636, 'f1': 0.38877788, 'auroc': 0.89086044, 'binary_precision': 1.0, 'binary_recall': 0.0521327, 'binary_specificity': 1.0, 'binary_f1_score': 0.09909909}
confusion matrix:
     0   1
0  211   0
1  200  11
early stop counter: 11
val acc:0.6385636329650879, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 20,now: 2024-07-29 05:18:42.279269,epoch time: 0:01:28.719526,used: 0:31:46.676244,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96146375, 'precision': 0.9648345, 'recall': 0.9607261, 'specificity': 0.9607261, 'f1': 0.96133673, 'auroc': 0.99958163, 'binary_precision': 0.929669, 'binary_recall': 1.0, 'binary_specificity': 0.92145216, 'binary_f1_score': 0.96355283}
confusion matrix:
      0     1
0  1396   119
1     0  1573
---- Validation: 
scalar performance:
{'acc': 0.7907885, 'precision': 0.8063304, 'recall': 0.79226434, 'specificity': 0.79226434, 'f1': 0.788645, 'auroc': 0.8875942, 'binary_precision': 0.73393315, 'binary_recall': 0.903481, 'binary_specificity': 0.68104774, 'binary_f1_score': 0.809929}
confusion matrix:
     0    1
0  442  207
1   61  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.8528428, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.8372505, 'auroc': 0.9425889, 'binary_precision': 0.7826087, 'binary_recall': 0.93838865, 'binary_specificity': 0.7393365, 'binary_f1_score': 0.8534483}
confusion matrix:
     0    1
0  156   55
1   13  198
early stop counter: 12
val acc:0.790788471698761, best validation acc: 0.8594847917556763, corresponding to test acc:                         0.8483412265777588 / 0.8601895570755005
after epoch: 21,now: 2024-07-29 05:20:19.086570,epoch time: 0:01:36.807301,used: 0:33:23.483545,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98639894, 'precision': 0.98637575, 'recall': 0.98651946, 'specificity': 0.98651946, 'f1': 0.9863975, 'auroc': 0.9993148, 'binary_precision': 0.9935442, 'binary_recall': 0.9796308, 'binary_specificity': 0.993408, 'binary_f1_score': 0.98653847}
confusion matrix:
      0     1
0  1507    10
1    32  1539
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8687154, 'recall': 0.8609216, 'specificity': 0.8609216, 'f1': 0.86094505, 'auroc': 0.9317889, 'binary_precision': 0.91590494, 'binary_recall': 0.7927215, 'binary_specificity': 0.92912173, 'binary_f1_score': 0.8498727}
confusion matrix:
     0    1
0  603   46
1  131  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8649289, 'precision': 0.8875716, 'recall': 0.8649289, 'specificity': 0.8649289, 'f1': 0.86292696, 'auroc': 0.941331, 'binary_precision': 0.98125, 'binary_recall': 0.74407583, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.8463612}
confusion matrix:
     0    1
0  208    3
1   54  157
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-29 05:21:56.127494,epoch time: 0:01:37.040924,used: 0:35:00.524469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99287564, 'precision': 0.9928315, 'recall': 0.99297047, 'specificity': 0.99297047, 'f1': 0.9928743, 'auroc': 0.99972975, 'binary_precision': 0.9980732, 'binary_recall': 0.9879212, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.99297124}
confusion matrix:
      0     1
0  1512     3
1    19  1554
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.81729484, 'recall': 0.75990814, 'specificity': 0.75990814, 'f1': 0.7506889, 'auroc': 0.9231285, 'binary_precision': 0.9456522, 'binary_recall': 0.5506329, 'binary_specificity': 0.9691834, 'binary_f1_score': 0.696}
confusion matrix:
     0    1
0  629   20
1  284  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60189575, 'precision': 0.7783641, 'recall': 0.60189575, 'specificity': 0.60189575, 'f1': 0.5269185, 'auroc': 0.9232048, 'binary_precision': 1.0, 'binary_recall': 0.20379147, 'binary_specificity': 1.0, 'binary_f1_score': 0.33858266}
confusion matrix:
     0   1
0  211   0
1  168  43
early stop counter: 1
val acc:0.7626854181289673, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 23,now: 2024-07-29 05:23:33.089698,epoch time: 0:01:36.962204,used: 0:36:37.486673,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9867228, 'precision': 0.98667896, 'recall': 0.98687154, 'specificity': 0.98687154, 'f1': 0.98672044, 'auroc': 0.9989886, 'binary_precision': 0.99420476, 'binary_recall': 0.97969544, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.98689675}
confusion matrix:
      0     1
0  1503     9
1    32  1544
---- Validation: 
scalar performance:
{'acc': 0.7603435, 'precision': 0.7842853, 'recall': 0.75838435, 'specificity': 0.75838435, 'f1': 0.7542323, 'auroc': 0.8781938, 'binary_precision': 0.8635347, 'binary_recall': 0.6107595, 'binary_specificity': 0.90600926, 'binary_f1_score': 0.7154773}
confusion matrix:
     0    1
0  588   61
1  246  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7014218, 'precision': 0.79308426, 'recall': 0.7014218, 'specificity': 0.7014218, 'f1': 0.67609644, 'auroc': 0.9121313, 'binary_precision': 0.9569892, 'binary_recall': 0.42180094, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.5855263}
confusion matrix:
     0   1
0  207   4
1  122  89
early stop counter: 2
val acc:0.7603434920310974, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 24,now: 2024-07-29 05:25:09.658724,epoch time: 0:01:36.569026,used: 0:38:14.055699,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9828368, 'precision': 0.9829705, 'recall': 0.9830837, 'specificity': 0.9830837, 'f1': 0.9828365, 'auroc': 0.99907815, 'binary_precision': 0.9967299, 'binary_recall': 0.9694657, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9829087}
confusion matrix:
      0     1
0  1511     5
1    48  1524
---- Validation: 
scalar performance:
{'acc': 0.81030446, 'precision': 0.84428924, 'recall': 0.80820906, 'specificity': 0.80820906, 'f1': 0.8047532, 'auroc': 0.9366504, 'binary_precision': 0.9491917, 'binary_recall': 0.6503165, 'binary_specificity': 0.9661017, 'binary_f1_score': 0.77183104}
confusion matrix:
     0    1
0  627   22
1  221  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5663507, 'precision': 0.7511904, 'recall': 0.5663507, 'specificity': 0.5663507, 'f1': 0.46859068, 'auroc': 0.92143035, 'binary_precision': 0.96666664, 'binary_recall': 0.13744076, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.2406639}
confusion matrix:
     0   1
0  210   1
1  182  29
early stop counter: 3
val acc:0.8103044629096985, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 25,now: 2024-07-29 05:26:45.353816,epoch time: 0:01:35.695092,used: 0:39:49.750791,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99190414, 'precision': 0.9918499, 'recall': 0.9920148, 'specificity': 0.9920148, 'f1': 0.9919023, 'auroc': 0.9997499, 'binary_precision': 0.99743426, 'binary_recall': 0.98667514, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.99202555}
confusion matrix:
      0     1
0  1508     4
1    21  1555
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.82213116, 'recall': 0.7630105, 'specificity': 0.7630105, 'f1': 0.75379145, 'auroc': 0.92498684, 'binary_precision': 0.9535519, 'binary_recall': 0.5522152, 'binary_specificity': 0.97380584, 'binary_f1_score': 0.6993988}
confusion matrix:
     0    1
0  632   17
1  283  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6706161, 'precision': 0.80142856, 'recall': 0.67061615, 'specificity': 0.67061615, 'f1': 0.6305311, 'auroc': 0.9429483, 'binary_precision': 1.0, 'binary_recall': 0.34123224, 'binary_specificity': 1.0, 'binary_f1_score': 0.5088339}
confusion matrix:
     0   1
0  211   0
1  139  72
early stop counter: 4
val acc:0.7658079862594604, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 26,now: 2024-07-29 05:28:18.762005,epoch time: 0:01:33.408189,used: 0:41:23.158980,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9935233, 'precision': 0.9935106, 'recall': 0.9935329, 'specificity': 0.9935329, 'f1': 0.99352133, 'auroc': 0.9994638, 'binary_precision': 0.9942675, 'binary_recall': 0.99300253, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9936346}
confusion matrix:
      0     1
0  1507     9
1    11  1561
---- Validation: 
scalar performance:
{'acc': 0.84153, 'precision': 0.85751295, 'recall': 0.840124, 'specificity': 0.840124, 'f1': 0.839327, 'auroc': 0.9152323, 'binary_precision': 0.9298597, 'binary_recall': 0.73417723, 'binary_specificity': 0.94607085, 'binary_f1_score': 0.8205128}
confusion matrix:
     0    1
0  614   35
1  168  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.84414643, 'recall': 0.81990516, 'specificity': 0.81990516, 'f1': 0.816677, 'auroc': 0.9112835, 'binary_precision': 0.9354839, 'binary_recall': 0.68720376, 'binary_specificity': 0.9526066, 'binary_f1_score': 0.79234976}
confusion matrix:
     0    1
0  201   10
1   66  145
early stop counter: 5
val acc:0.8415300250053406, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 27,now: 2024-07-29 05:29:50.817397,epoch time: 0:01:32.055392,used: 0:42:55.214372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9893135, 'precision': 0.98927796, 'recall': 0.98943746, 'specificity': 0.98943746, 'f1': 0.98931193, 'auroc': 0.9996693, 'binary_precision': 0.99613404, 'binary_recall': 0.98283535, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.98944}
confusion matrix:
      0     1
0  1509     6
1    27  1546
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.8475151, 'recall': 0.81214404, 'specificity': 0.81214404, 'f1': 0.8089249, 'auroc': 0.92555976, 'binary_precision': 0.95183486, 'binary_recall': 0.6566456, 'binary_specificity': 0.96764255, 'binary_f1_score': 0.7771536}
confusion matrix:
     0    1
0  628   21
1  217  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7156398, 'precision': 0.80023146, 'recall': 0.7156398, 'specificity': 0.7156398, 'f1': 0.69409204, 'auroc': 0.9052807, 'binary_precision': 0.959596, 'binary_recall': 0.45023698, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.61290324}
confusion matrix:
     0   1
0  207   4
1  116  95
early stop counter: 6
val acc:0.8142076730728149, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 28,now: 2024-07-29 05:31:19.502344,epoch time: 0:01:28.684947,used: 0:44:23.899319,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.988342, 'precision': 0.98831046, 'recall': 0.98837435, 'specificity': 0.98837435, 'f1': 0.9883386, 'auroc': 0.9995624, 'binary_precision': 0.99042755, 'binary_recall': 0.9866497, 'binary_specificity': 0.990099, 'binary_f1_score': 0.988535}
confusion matrix:
      0     1
0  1500    15
1    21  1552
---- Validation: 
scalar performance:
{'acc': 0.74160814, 'precision': 0.7958356, 'recall': 0.7387339, 'specificity': 0.7387339, 'f1': 0.72765005, 'auroc': 0.91376156, 'binary_precision': 0.91922003, 'binary_recall': 0.5221519, 'binary_specificity': 0.9553159, 'binary_f1_score': 0.6659939}
confusion matrix:
     0    1
0  620   29
1  302  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5687204, 'precision': 0.73833454, 'recall': 0.56872034, 'specificity': 0.56872034, 'f1': 0.4753825, 'auroc': 0.91794884, 'binary_precision': 0.93939394, 'binary_recall': 0.14691943, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.25409836}
confusion matrix:
     0   1
0  209   2
1  180  31
early stop counter: 7
val acc:0.7416081428527832, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 29,now: 2024-07-29 05:32:55.137496,epoch time: 0:01:35.635152,used: 0:45:59.534471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98996115, 'precision': 0.9899217, 'recall': 0.99001235, 'specificity': 0.99001235, 'f1': 0.98995864, 'auroc': 0.9996933, 'binary_precision': 0.9929668, 'binary_recall': 0.98728544, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9901179}
confusion matrix:
      0     1
0  1504    11
1    20  1553
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.8420618, 'recall': 0.82446706, 'specificity': 0.82446706, 'f1': 0.82336444, 'auroc': 0.91773367, 'binary_precision': 0.9131313, 'binary_recall': 0.7151899, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.80212957}
confusion matrix:
     0    1
0  606   43
1  180  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7203792, 'precision': 0.7947724, 'recall': 0.7203792, 'specificity': 0.7203792, 'f1': 0.7015487, 'auroc': 0.90197885, 'binary_precision': 0.94285715, 'binary_recall': 0.46919432, 'binary_specificity': 0.971564, 'binary_f1_score': 0.6265823}
confusion matrix:
     0   1
0  205   6
1  112  99
early stop counter: 8
val acc:0.8259172439575195, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.8649289011955261 / 0.8649289011955261
after epoch: 30,now: 2024-07-29 05:34:22.239359,epoch time: 0:01:27.101863,used: 0:47:26.636334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_55_seed_4_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:26.636334 at 2024-07-29 05:34:22.239359
persisted model performance metric: 

scalar performance:
{'acc': 0.8649289, 'precision': 0.8875716, 'recall': 0.8649289, 'specificity': 0.8649289, 'f1': 0.86292696, 'auroc': 0.941331, 'binary_precision': 0.98125, 'binary_recall': 0.74407583, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.8463612}
confusion matrix:
     0    1
0  208    3
1   54  157
oracle model performance metric: 

scalar performance:
{'acc': 0.8649289, 'precision': 0.8875716, 'recall': 0.8649289, 'specificity': 0.8649289, 'f1': 0.86292696, 'auroc': 0.941331, 'binary_precision': 0.98125, 'binary_recall': 0.74407583, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.8463612}
confusion matrix:
     0    1
0  208    3
1   54  157
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454144 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 363282 GiB | 363282 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454144 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 363282 GiB | 363282 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 366738 GiB | 366737 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  68826 MiB |  54350 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  68692 MiB |  54282 MiB |
|       from small pool |     66 MiB |     70 MiB |    134 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 434687 KiB |   1260 MiB | 261987 GiB | 261986 GiB |
|       from large pool | 424080 KiB |   1252 MiB | 257608 GiB | 257607 GiB |
|       from small pool |  10607 KiB |     45 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64612 K  |   64611 K  |
|       from large pool |     187    |    1413    |   32813 K  |   32813 K  |
|       from small pool |    1111    |    1419    |   31798 K  |   31797 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64612 K  |   64611 K  |
|       from large pool |     187    |    1413    |   32813 K  |   32813 K  |
|       from small pool |    1111    |    1419    |   31798 K  |   31797 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    2925    |    2290    |
|       from large pool |     602    |     602    |    2858    |    2256    |
|       from small pool |      33    |      35    |      67    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      89    |     655    |   43026 K  |   43026 K  |
|       from large pool |      36    |     604    |   24165 K  |   24165 K  |
|       from small pool |      53    |     237    |   18861 K  |   18861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363282 GiB | 363282 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363282 GiB | 363282 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    868 MiB |  14488 MiB |  68826 MiB |  67958 MiB |
|       from large pool |    818 MiB |  14422 MiB |  68692 MiB |  67874 MiB |
|       from small pool |     50 MiB |     70 MiB |    134 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 261987 GiB | 261987 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |      0 KiB |     45 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32813 K  |   32813 K  |
|       from small pool |       0    |    1419    |   31798 K  |   31798 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32813 K  |   32813 K  |
|       from small pool |       0    |    1419    |   31798 K  |   31798 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2925    |    2863    |
|       from large pool |      37    |     602    |    2858    |    2821    |
|       from small pool |      25    |      35    |      67    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   43027 K  |   43027 K  |
|       from large pool |       3    |     604    |   24165 K  |   24165 K  |
|       from small pool |       0    |     237    |   18861 K  |   18861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363282 GiB | 363282 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363282 GiB | 363282 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    868 MiB |  14488 MiB |  68826 MiB |  67958 MiB |
|       from large pool |    818 MiB |  14422 MiB |  68692 MiB |  67874 MiB |
|       from small pool |     50 MiB |     70 MiB |    134 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 261987 GiB | 261987 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |      0 KiB |     45 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32813 K  |   32813 K  |
|       from small pool |       0    |    1419    |   31798 K  |   31798 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64612 K  |   64612 K  |
|       from large pool |       2    |    1413    |   32813 K  |   32813 K  |
|       from small pool |       0    |    1419    |   31798 K  |   31798 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2925    |    2863    |
|       from large pool |      37    |     602    |    2858    |    2821    |
|       from small pool |      25    |      35    |      67    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   43027 K  |   43027 K  |
|       from large pool |       3    |     604    |   24165 K  |   24165 K  |
|       from small pool |       0    |     237    |   18861 K  |   18861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369

 Experiment start at: 2024-07-29 05:35:06.350194
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9355366, 'precision': 0.93757904, 'recall': 0.93503237, 'specificity': 0.93503237, 'f1': 0.9353952, 'auroc': 0.988391, 'binary_precision': 0.911354, 'binary_recall': 0.9671392, 'binary_specificity': 0.90292555, 'binary_f1_score': 0.93841827}
confusion matrix:
      0     1
0  1358   146
1    51  1501
---- Validation: 
scalar performance:
{'acc': 0.6874028, 'precision': 0.76297057, 'recall': 0.69469535, 'specificity': 0.69469535, 'f1': 0.6681175, 'auroc': 0.8964478, 'binary_precision': 0.6148301, 'binary_recall': 0.9552, 'binary_specificity': 0.43419063, 'binary_f1_score': 0.7481203}
confusion matrix:
     0    1
0  287  374
1   28  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72943723, 'precision': 0.79515433, 'recall': 0.72943723, 'specificity': 0.72943723, 'f1': 0.71348906, 'auroc': 0.92846835, 'binary_precision': 0.65588236, 'binary_recall': 0.965368, 'binary_specificity': 0.4935065, 'binary_f1_score': 0.7810858}
confusion matrix:
     0    1
0  114  117
1    8  223
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 05:36:53.858117,epoch time: 0:01:47.507923,used: 0:01:47.507923,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.967612, 'recall': 0.9675826, 'specificity': 0.9675826, 'f1': 0.9675964, 'auroc': 0.9939574, 'binary_precision': 0.96718144, 'binary_recall': 0.9690522, 'binary_specificity': 0.966113, 'binary_f1_score': 0.9681159}
confusion matrix:
      0     1
0  1454    51
1    48  1503
---- Validation: 
scalar performance:
{'acc': 0.8141524, 'precision': 0.8176739, 'recall': 0.81559694, 'specificity': 0.81559694, 'f1': 0.81399846, 'auroc': 0.89380944, 'binary_precision': 0.7765043, 'binary_recall': 0.8672, 'binary_specificity': 0.7639939, 'binary_f1_score': 0.81935}
confusion matrix:
     0    1
0  505  156
1   83  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.83782065, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.8376434, 'auroc': 0.8996084, 'binary_precision': 0.8305085, 'binary_recall': 0.8484849, 'binary_specificity': 0.8268398, 'binary_f1_score': 0.8394005}
confusion matrix:
     0    1
0  191   40
1   35  196
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 05:38:35.792088,epoch time: 0:01:41.933971,used: 0:03:29.441894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97054976, 'precision': 0.9710542, 'recall': 0.9703276, 'specificity': 0.9703276, 'f1': 0.9705242, 'auroc': 0.9969818, 'binary_precision': 0.9591965, 'binary_recall': 0.9839021, 'binary_specificity': 0.95675313, 'binary_f1_score': 0.9713923}
confusion matrix:
      0     1
0  1438    65
1    25  1528
---- Validation: 
scalar performance:
{'acc': 0.722395, 'precision': 0.7955272, 'recall': 0.72921395, 'specificity': 0.72921395, 'f1': 0.7078439, 'auroc': 0.92121935, 'binary_precision': 0.6413502, 'binary_recall': 0.9728, 'binary_specificity': 0.48562783, 'binary_f1_score': 0.7730451}
confusion matrix:
     0    1
0  321  340
1   17  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6212121, 'precision': 0.76080644, 'recall': 0.6212121, 'specificity': 0.6212121, 'f1': 0.5626964, 'auroc': 0.88393676, 'binary_precision': 0.57, 'binary_recall': 0.987013, 'binary_specificity': 0.25541127, 'binary_f1_score': 0.7226624}
confusion matrix:
    0    1
0  59  172
1   3  228
early stop counter: 1
val acc:0.7223950028419495, best validation acc: 0.8141524195671082, corresponding to test acc:                         0.8376623392105103 / 0.8376623392105103
after epoch: 3,now: 2024-07-29 05:40:13.477417,epoch time: 0:01:37.685329,used: 0:05:07.127223,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.9770025, 'recall': 0.97707546, 'specificity': 0.97707546, 'f1': 0.9767669, 'auroc': 0.9973632, 'binary_precision': 0.9933599, 'binary_recall': 0.9608221, 'binary_specificity': 0.99332887, 'binary_f1_score': 0.9768201}
confusion matrix:
      0     1
0  1489    10
1    61  1496
---- Validation: 
scalar performance:
{'acc': 0.8017107, 'precision': 0.82283276, 'recall': 0.7980478, 'specificity': 0.7980478, 'f1': 0.79694575, 'auroc': 0.9002142, 'binary_precision': 0.8987069, 'binary_recall': 0.6672, 'binary_specificity': 0.9288956, 'binary_f1_score': 0.76584023}
confusion matrix:
     0    1
0  614   47
1  208  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.8531153, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.84073704, 'auroc': 0.8949045, 'binary_precision': 0.9157895, 'binary_recall': 0.7532467, 'binary_specificity': 0.93073595, 'binary_f1_score': 0.8266033}
confusion matrix:
     0    1
0  215   16
1   57  174
new oracle model saved
early stop counter: 2
val acc:0.8017107248306274, best validation acc: 0.8141524195671082, corresponding to test acc:                         0.8376623392105103 / 0.8419913649559021
after epoch: 4,now: 2024-07-29 05:41:50.949722,epoch time: 0:01:37.472305,used: 0:06:44.599528,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.96810126, 'recall': 0.9671186, 'specificity': 0.9671186, 'f1': 0.9666141, 'auroc': 0.9982461, 'binary_precision': 0.9986245, 'binary_recall': 0.935567, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.9660679}
confusion matrix:
      0     1
0  1502     2
1   100  1452
---- Validation: 
scalar performance:
{'acc': 0.8024883, 'precision': 0.8294139, 'recall': 0.7984121, 'specificity': 0.7984121, 'f1': 0.7967545, 'auroc': 0.8995631, 'binary_precision': 0.9168539, 'binary_recall': 0.6528, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.7626168}
confusion matrix:
     0    1
0  624   37
1  217  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.847306, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.8438017, 'auroc': 0.913345, 'binary_precision': 0.8803828, 'binary_recall': 0.7965368, 'binary_specificity': 0.8917749, 'binary_f1_score': 0.8363637}
confusion matrix:
     0    1
0  206   25
1   47  184
new oracle model saved
early stop counter: 3
val acc:0.8024883270263672, best validation acc: 0.8141524195671082, corresponding to test acc:                         0.8376623392105103 / 0.8441558480262756
after epoch: 5,now: 2024-07-29 05:43:27.785679,epoch time: 0:01:36.835957,used: 0:08:21.435485,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.9819732, 'recall': 0.9820353, 'specificity': 0.9820353, 'f1': 0.98199904, 'auroc': 0.9971909, 'binary_precision': 0.9844761, 'binary_recall': 0.98003864, 'binary_specificity': 0.9840319, 'binary_f1_score': 0.98225236}
confusion matrix:
      0     1
0  1479    24
1    31  1522
---- Validation: 
scalar performance:
{'acc': 0.85225505, 'precision': 0.8543726, 'recall': 0.85113704, 'specificity': 0.85113704, 'f1': 0.8516519, 'auroc': 0.91197574, 'binary_precision': 0.87564766, 'binary_recall': 0.8112, 'binary_specificity': 0.8910741, 'binary_f1_score': 0.8421927}
confusion matrix:
     0    1
0  589   72
1  118  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85064936, 'precision': 0.8535714, 'recall': 0.85064936, 'specificity': 0.85064936, 'f1': 0.8503401, 'auroc': 0.91327, 'binary_precision': 0.8857143, 'binary_recall': 0.8051948, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.8435374}
confusion matrix:
     0    1
0  207   24
1   45  186
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-29 05:45:07.414566,epoch time: 0:01:39.628887,used: 0:10:01.064372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.978703, 'recall': 0.9788452, 'specificity': 0.9788452, 'f1': 0.9787278, 'auroc': 0.9982785, 'binary_precision': 0.9856584, 'binary_recall': 0.97234726, 'binary_specificity': 0.9853431, 'binary_f1_score': 0.9789576}
confusion matrix:
      0     1
0  1479    22
1    43  1512
---- Validation: 
scalar performance:
{'acc': 0.7597201, 'precision': 0.7859149, 'recall': 0.7553271, 'specificity': 0.7553271, 'f1': 0.75185144, 'auroc': 0.8628914, 'binary_precision': 0.8657407, 'binary_recall': 0.5984, 'binary_specificity': 0.91225415, 'binary_f1_score': 0.70766324}
confusion matrix:
     0    1
0  603   58
1  251  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7251082, 'precision': 0.7457849, 'recall': 0.72510827, 'specificity': 0.72510827, 'f1': 0.7192027, 'auroc': 0.8217237, 'binary_precision': 0.81707317, 'binary_recall': 0.5800866, 'binary_specificity': 0.8701299, 'binary_f1_score': 0.678481}
confusion matrix:
     0    1
0  201   30
1   97  134
early stop counter: 1
val acc:0.7597200870513916, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.850649356842041 / 0.850649356842041
after epoch: 7,now: 2024-07-29 05:46:43.049696,epoch time: 0:01:35.635130,used: 0:11:36.699502,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97349477, 'precision': 0.97449625, 'recall': 0.97385406, 'specificity': 0.97385406, 'f1': 0.9734905, 'auroc': 0.99919295, 'binary_precision': 1.0, 'binary_recall': 0.9477082, 'binary_specificity': 1.0, 'binary_f1_score': 0.97315216}
confusion matrix:
      0     1
0  1507     0
1    81  1468
---- Validation: 
scalar performance:
{'acc': 0.744168, 'precision': 0.8134522, 'recall': 0.7374535, 'specificity': 0.7374535, 'f1': 0.7255436, 'auroc': 0.90835524, 'binary_precision': 0.9539877, 'binary_recall': 0.4976, 'binary_specificity': 0.9773071, 'binary_f1_score': 0.6540484}
confusion matrix:
     0    1
0  646   15
1  314  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55411255, 'precision': 0.7458493, 'recall': 0.55411255, 'specificity': 0.55411255, 'f1': 0.4461205, 'auroc': 0.8808118, 'binary_precision': 0.962963, 'binary_recall': 0.11255411, 'binary_specificity': 0.995671, 'binary_f1_score': 0.2015504}
confusion matrix:
     0   1
0  230   1
1  205  26
early stop counter: 2
val acc:0.7441679835319519, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.850649356842041 / 0.850649356842041
after epoch: 8,now: 2024-07-29 05:48:12.960816,epoch time: 0:01:29.911120,used: 0:13:06.610622,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98886144, 'recall': 0.98897034, 'specificity': 0.98897034, 'f1': 0.98887354, 'auroc': 0.9988861, 'binary_precision': 0.99542785, 'binary_recall': 0.98259187, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.9889682}
confusion matrix:
      0     1
0  1498     7
1    27  1524
---- Validation: 
scalar performance:
{'acc': 0.82348365, 'precision': 0.8522608, 'recall': 0.81944567, 'specificity': 0.81944567, 'f1': 0.818408, 'auroc': 0.9296799, 'binary_precision': 0.94618833, 'binary_recall': 0.6752, 'binary_specificity': 0.96369135, 'binary_f1_score': 0.78804857}
confusion matrix:
     0    1
0  637   24
1  203  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67099565, 'precision': 0.77967817, 'recall': 0.67099565, 'specificity': 0.67099565, 'f1': 0.6355938, 'auroc': 0.9050617, 'binary_precision': 0.954023, 'binary_recall': 0.35930735, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.52201253}
confusion matrix:
     0   1
0  227   4
1  148  83
early stop counter: 3
val acc:0.8234836459159851, best validation acc: 0.8522550463676453, corresponding to test acc:                         0.850649356842041 / 0.850649356842041
after epoch: 9,now: 2024-07-29 05:49:49.892642,epoch time: 0:01:36.931826,used: 0:14:43.542448,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9871988, 'recall': 0.987321, 'specificity': 0.987321, 'f1': 0.98723614, 'auroc': 0.9994807, 'binary_precision': 0.99220777, 'binary_recall': 0.98263663, 'binary_specificity': 0.99200535, 'binary_f1_score': 0.987399}
confusion matrix:
      0     1
0  1489    12
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.85692066, 'precision': 0.8582721, 'recall': 0.8560242, 'specificity': 0.8560242, 'f1': 0.8564708, 'auroc': 0.9172914, 'binary_precision': 0.8743633, 'binary_recall': 0.824, 'binary_specificity': 0.8880484, 'binary_f1_score': 0.8484349}
confusion matrix:
     0    1
0  587   74
1  110  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7835498, 'precision': 0.82003933, 'recall': 0.7835498, 'specificity': 0.7835498, 'f1': 0.77719903, 'auroc': 0.88103676, 'binary_precision': 0.9281046, 'binary_recall': 0.6147186, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7395833}
confusion matrix:
     0    1
0  220   11
1   89  142
better model found
persisted
after epoch: 10,now: 2024-07-29 05:51:23.324042,epoch time: 0:01:33.431400,used: 0:16:16.973848,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9855686, 'recall': 0.9856518, 'specificity': 0.9856518, 'f1': 0.98559964, 'auroc': 0.99929786, 'binary_precision': 0.9889825, 'binary_recall': 0.9826143, 'binary_specificity': 0.9886893, 'binary_f1_score': 0.98578817}
confusion matrix:
      0     1
0  1486    17
1    27  1526
---- Validation: 
scalar performance:
{'acc': 0.777605, 'precision': 0.79448915, 'recall': 0.77411926, 'specificity': 0.77411926, 'f1': 0.77274823, 'auroc': 0.8609791, 'binary_precision': 0.85835093, 'binary_recall': 0.6496, 'binary_specificity': 0.8986384, 'binary_f1_score': 0.73952633}
confusion matrix:
     0    1
0  594   67
1  219  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65584415, 'precision': 0.69451725, 'recall': 0.65584415, 'specificity': 0.65584415, 'f1': 0.63784355, 'auroc': 0.7913082, 'binary_precision': 0.78125, 'binary_recall': 0.43290043, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.55710304}
confusion matrix:
     0    1
0  203   28
1  131  100
early stop counter: 1
val acc:0.7776049971580505, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 11,now: 2024-07-29 05:53:04.029566,epoch time: 0:01:40.705524,used: 0:17:57.679372,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9872055, 'recall': 0.9873151, 'specificity': 0.9873151, 'f1': 0.98723656, 'auroc': 0.99859524, 'binary_precision': 0.99219763, 'binary_recall': 0.9826143, 'binary_specificity': 0.99201596, 'binary_f1_score': 0.9873827}
confusion matrix:
      0     1
0  1491    12
1    27  1526
---- Validation: 
scalar performance:
{'acc': 0.66718507, 'precision': 0.73552823, 'recall': 0.6593428, 'specificity': 0.6593428, 'f1': 0.63460577, 'auroc': 0.85026085, 'binary_precision': 0.85559565, 'binary_recall': 0.3792, 'binary_specificity': 0.9394856, 'binary_f1_score': 0.52549887}
confusion matrix:
     0    1
0  621   40
1  388  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62770563, 'precision': 0.7640767, 'recall': 0.62770563, 'specificity': 0.62770563, 'f1': 0.5725168, 'auroc': 0.8779446, 'binary_precision': 0.95384616, 'binary_recall': 0.26839826, 'binary_specificity': 0.987013, 'binary_f1_score': 0.41891894}
confusion matrix:
     0   1
0  228   3
1  169  62
early stop counter: 2
val acc:0.6671850681304932, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 12,now: 2024-07-29 05:54:37.542723,epoch time: 0:01:33.513157,used: 0:19:31.192529,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.9829749, 'recall': 0.9820992, 'specificity': 0.9820992, 'f1': 0.9823139, 'auroc': 0.9995532, 'binary_precision': 0.9686913, 'binary_recall': 0.997421, 'binary_specificity': 0.9667774, 'binary_f1_score': 0.98284626}
confusion matrix:
      0     1
0  1455    50
1     4  1547
---- Validation: 
scalar performance:
{'acc': 0.83359253, 'precision': 0.8334459, 'recall': 0.83354914, 'specificity': 0.83354914, 'f1': 0.8334894, 'auroc': 0.888564, 'binary_precision': 0.8267091, 'binary_recall': 0.832, 'binary_specificity': 0.8350983, 'binary_f1_score': 0.8293462}
confusion matrix:
     0    1
0  552  109
1  105  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7770563, 'precision': 0.7789434, 'recall': 0.7770563, 'specificity': 0.7770563, 'f1': 0.77667856, 'auroc': 0.8526077, 'binary_precision': 0.756, 'binary_recall': 0.8181818, 'binary_specificity': 0.73593074, 'binary_f1_score': 0.78586274}
confusion matrix:
     0    1
0  170   61
1   42  189
early stop counter: 3
val acc:0.8335925340652466, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 13,now: 2024-07-29 05:56:16.781282,epoch time: 0:01:39.238559,used: 0:21:10.431088,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9848225, 'recall': 0.98407483, 'specificity': 0.98407483, 'f1': 0.9842796, 'auroc': 0.99970317, 'binary_precision': 0.97237915, 'binary_recall': 0.99742436, 'binary_specificity': 0.97072524, 'binary_f1_score': 0.9847425}
confusion matrix:
      0     1
0  1459    44
1     4  1549
---- Validation: 
scalar performance:
{'acc': 0.7869362, 'precision': 0.8079531, 'recall': 0.79051614, 'specificity': 0.79051614, 'f1': 0.78452635, 'auroc': 0.9080157, 'binary_precision': 0.7202008, 'binary_recall': 0.9184, 'binary_specificity': 0.66263235, 'binary_f1_score': 0.8073136}
confusion matrix:
     0    1
0  438  223
1   51  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75757575, 'precision': 0.78529173, 'recall': 0.75757575, 'specificity': 0.75757575, 'f1': 0.7515413, 'auroc': 0.87734485, 'binary_precision': 0.69636965, 'binary_recall': 0.9134199, 'binary_specificity': 0.6017316, 'binary_f1_score': 0.7902621}
confusion matrix:
     0    1
0  139   92
1   20  211
early stop counter: 4
val acc:0.7869362235069275, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 14,now: 2024-07-29 05:57:59.234636,epoch time: 0:01:42.453354,used: 0:22:52.884442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97847676, 'recall': 0.97708875, 'specificity': 0.97708875, 'f1': 0.9773916, 'auroc': 0.9992833, 'binary_precision': 0.9597274, 'binary_recall': 0.99742436, 'binary_specificity': 0.95675313, 'binary_f1_score': 0.97821283}
confusion matrix:
      0     1
0  1438    65
1     4  1549
---- Validation: 
scalar performance:
{'acc': 0.85303265, 'precision': 0.8529093, 'recall': 0.8529392, 'specificity': 0.8529392, 'f1': 0.85292375, 'auroc': 0.90973675, 'binary_precision': 0.8482428, 'binary_recall': 0.8496, 'binary_specificity': 0.85627836, 'binary_f1_score': 0.8489209}
confusion matrix:
     0    1
0  566   95
1   94  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76406926, 'precision': 0.7646694, 'recall': 0.7640693, 'specificity': 0.7640693, 'f1': 0.76393545, 'auroc': 0.84080136, 'binary_precision': 0.7772727, 'binary_recall': 0.74025977, 'binary_specificity': 0.7878788, 'binary_f1_score': 0.75831485}
confusion matrix:
     0    1
0  182   49
1   60  171
early stop counter: 5
val acc:0.853032648563385, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 15,now: 2024-07-29 05:59:33.850057,epoch time: 0:01:34.615421,used: 0:24:27.499863,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99047655, 'recall': 0.99055785, 'specificity': 0.99055785, 'f1': 0.9905086, 'auroc': 0.999563, 'binary_precision': 0.99352753, 'binary_recall': 0.9877735, 'binary_specificity': 0.9933422, 'binary_f1_score': 0.99064213}
confusion matrix:
      0     1
0  1492    10
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.7706065, 'precision': 0.81996435, 'recall': 0.76500213, 'specificity': 0.76500213, 'f1': 0.7587581, 'auroc': 0.9009912, 'binary_precision': 0.9388298, 'binary_recall': 0.5648, 'binary_specificity': 0.96520424, 'binary_f1_score': 0.7052947}
confusion matrix:
     0    1
0  638   23
1  272  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6926407, 'precision': 0.7575993, 'recall': 0.6926407, 'specificity': 0.6926407, 'f1': 0.67196035, 'auroc': 0.8646952, 'binary_precision': 0.8869565, 'binary_recall': 0.44155845, 'binary_specificity': 0.94372296, 'binary_f1_score': 0.5895954}
confusion matrix:
     0    1
0  218   13
1  129  102
early stop counter: 6
val acc:0.770606517791748, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 16,now: 2024-07-29 06:01:06.274498,epoch time: 0:01:32.424441,used: 0:25:59.924304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9924897, 'recall': 0.99245495, 'specificity': 0.99245495, 'f1': 0.99247134, 'auroc': 0.999707, 'binary_precision': 0.9916506, 'binary_recall': 0.993565, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.9926068}
confusion matrix:
      0     1
0  1489    13
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.8141524, 'precision': 0.84064066, 'recall': 0.81019425, 'specificity': 0.81019425, 'f1': 0.80901086, 'auroc': 0.9146384, 'binary_precision': 0.9288889, 'binary_recall': 0.6688, 'binary_specificity': 0.9515885, 'binary_f1_score': 0.77767444}
confusion matrix:
     0    1
0  629   32
1  207  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72727275, 'precision': 0.7747197, 'recall': 0.72727275, 'specificity': 0.72727275, 'f1': 0.7149656, 'auroc': 0.8723787, 'binary_precision': 0.8888889, 'binary_recall': 0.5194805, 'binary_specificity': 0.9350649, 'binary_f1_score': 0.6557377}
confusion matrix:
     0    1
0  216   15
1  111  120
early stop counter: 7
val acc:0.8141524195671082, best validation acc: 0.8569206595420837, corresponding to test acc:                         0.7835497856140137 / 0.850649356842041
after epoch: 17,now: 2024-07-29 06:02:32.331310,epoch time: 0:01:26.056812,used: 0:27:25.981116,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.9805945, 'recall': 0.97984207, 'specificity': 0.97984207, 'f1': 0.9800238, 'auroc': 0.99952483, 'binary_precision': 0.96733665, 'binary_recall': 0.9941898, 'binary_specificity': 0.96549433, 'binary_f1_score': 0.98057944}
confusion matrix:
      0     1
0  1455    52
1     9  1540
---- Validation: 
scalar performance:
{'acc': 0.8592535, 'precision': 0.85921246, 'recall': 0.8590342, 'specificity': 0.8590342, 'f1': 0.8591103, 'auroc': 0.9089065, 'binary_precision': 0.85806453, 'binary_recall': 0.8512, 'binary_specificity': 0.8668684, 'binary_f1_score': 0.8546185}
confusion matrix:
     0    1
0  573   88
1   93  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.7988413, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.7986777, 'auroc': 0.85301995, 'binary_precision': 0.8053097, 'binary_recall': 0.7878788, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.7964989}
confusion matrix:
     0    1
0  187   44
1   49  182
better model found
persisted
after epoch: 18,now: 2024-07-29 06:04:01.117261,epoch time: 0:01:28.785951,used: 0:28:54.767067,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98983896, 'recall': 0.9898757, 'specificity': 0.9898757, 'f1': 0.9898547, 'auroc': 0.9991985, 'binary_precision': 0.9915749, 'binary_recall': 0.9883721, 'binary_specificity': 0.9913793, 'binary_f1_score': 0.9899709}
confusion matrix:
      0     1
0  1495    13
1    18  1530
---- Validation: 
scalar performance:
{'acc': 0.6975117, 'precision': 0.78544766, 'recall': 0.6895407, 'specificity': 0.6895407, 'f1': 0.66670066, 'auroc': 0.8953924, 'binary_precision': 0.93703705, 'binary_recall': 0.4048, 'binary_specificity': 0.9742814, 'binary_f1_score': 0.56536317}
confusion matrix:
     0    1
0  644   17
1  372  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.508658, 'precision': 0.6688596, 'recall': 0.508658, 'specificity': 0.508658, 'f1': 0.35588595, 'auroc': 0.8496608, 'binary_precision': 0.8333333, 'binary_recall': 0.021645023, 'binary_specificity': 0.995671, 'binary_f1_score': 0.042194095}
confusion matrix:
     0  1
0  230  1
1  226  5
early stop counter: 1
val acc:0.6975116729736328, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 19,now: 2024-07-29 06:05:33.130312,epoch time: 0:01:32.013051,used: 0:30:26.780118,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9928233, 'recall': 0.9927777, 'specificity': 0.9927777, 'f1': 0.9927988, 'auroc': 0.9997237, 'binary_precision': 0.9916506, 'binary_recall': 0.99420476, 'binary_specificity': 0.99135065, 'binary_f1_score': 0.99292606}
confusion matrix:
      0     1
0  1490    13
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.64385694, 'precision': 0.74157166, 'recall': 0.6346457, 'specificity': 0.6346457, 'f1': 0.5951638, 'auroc': 0.87716305, 'binary_precision': 0.88837206, 'binary_recall': 0.3056, 'binary_specificity': 0.96369135, 'binary_f1_score': 0.45476186}
confusion matrix:
     0    1
0  637   24
1  434  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52597404, 'precision': 0.6734234, 'recall': 0.52597404, 'specificity': 0.52597404, 'f1': 0.39801875, 'auroc': 0.88946986, 'binary_precision': 0.8333333, 'binary_recall': 0.064935066, 'binary_specificity': 0.987013, 'binary_f1_score': 0.12048192}
confusion matrix:
     0   1
0  228   3
1  216  15
early stop counter: 2
val acc:0.643856942653656, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 20,now: 2024-07-29 06:06:59.746466,epoch time: 0:01:26.616154,used: 0:31:53.396272,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.9738241, 'recall': 0.9717554, 'specificity': 0.9717554, 'f1': 0.97213614, 'auroc': 0.9994414, 'binary_precision': 0.9497549, 'binary_recall': 0.9980683, 'binary_specificity': 0.94544244, 'binary_f1_score': 0.9733124}
confusion matrix:
      0     1
0  1421    82
1     3  1550
---- Validation: 
scalar performance:
{'acc': 0.8250389, 'precision': 0.824909, 'recall': 0.8248799, 'specificity': 0.8248799, 'f1': 0.82489395, 'auroc': 0.88062453, 'binary_precision': 0.82051283, 'binary_recall': 0.8192, 'binary_specificity': 0.83055973, 'binary_f1_score': 0.81985587}
confusion matrix:
     0    1
0  549  112
1  113  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5952381, 'precision': 0.6517921, 'recall': 0.5952381, 'specificity': 0.5952381, 'f1': 0.5536647, 'auroc': 0.8020839, 'binary_precision': 0.74444443, 'binary_recall': 0.2900433, 'binary_specificity': 0.9004329, 'binary_f1_score': 0.41744548}
confusion matrix:
     0   1
0  208  23
1  164  67
early stop counter: 3
val acc:0.8250389099121094, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 21,now: 2024-07-29 06:08:36.151503,epoch time: 0:01:36.405037,used: 0:33:29.801309,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9796745, 'recall': 0.9788065, 'specificity': 0.9788065, 'f1': 0.97903687, 'auroc': 0.9987537, 'binary_precision': 0.96620774, 'binary_recall': 0.993565, 'binary_specificity': 0.9640479, 'binary_f1_score': 0.9796954}
confusion matrix:
      0     1
0  1448    54
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.80559874, 'precision': 0.81843483, 'recall': 0.80270135, 'specificity': 0.80270135, 'f1': 0.80246407, 'auroc': 0.88664687, 'binary_precision': 0.8757515, 'binary_recall': 0.6992, 'binary_specificity': 0.90620273, 'binary_f1_score': 0.7775801}
confusion matrix:
     0    1
0  599   62
1  188  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7532467, 'precision': 0.7729063, 'recall': 0.7532468, 'specificity': 0.7532468, 'f1': 0.74872136, 'auroc': 0.86578214, 'binary_precision': 0.84615386, 'binary_recall': 0.61904764, 'binary_specificity': 0.88744587, 'binary_f1_score': 0.71500003}
confusion matrix:
     0    1
0  205   26
1   88  143
early stop counter: 4
val acc:0.8055987358093262, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 22,now: 2024-07-29 06:10:09.451061,epoch time: 0:01:33.299558,used: 0:35:03.100867,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927771, 'recall': 0.9928447, 'specificity': 0.9928447, 'f1': 0.99280024, 'auroc': 0.9998094, 'binary_precision': 0.9961014, 'binary_recall': 0.98967075, 'binary_specificity': 0.9960186, 'binary_f1_score': 0.9928757}
confusion matrix:
      0     1
0  1501     6
1    16  1533
---- Validation: 
scalar performance:
{'acc': 0.5793157, 'precision': 0.74857205, 'recall': 0.56741786, 'specificity': 0.56741786, 'f1': 0.47780353, 'auroc': 0.9100393, 'binary_precision': 0.9468085, 'binary_recall': 0.1424, 'binary_specificity': 0.9924357, 'binary_f1_score': 0.24756606}
confusion matrix:
     0   1
0  656   5
1  536  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4935065, 'precision': 0.24836601, 'recall': 0.4935065, 'specificity': 0.4935065, 'f1': 0.3304348, 'auroc': 0.83984554, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.987013, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  228  3
1  231  0
early stop counter: 5
val acc:0.579315721988678, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 23,now: 2024-07-29 06:11:45.478169,epoch time: 0:01:36.027108,used: 0:36:39.127975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918292, 'recall': 0.9919213, 'specificity': 0.9919213, 'f1': 0.991819, 'auroc': 0.9998779, 'binary_precision': 0.9993447, 'binary_recall': 0.98450613, 'binary_specificity': 0.9993364, 'binary_f1_score': 0.9918699}
confusion matrix:
      0     1
0  1506     1
1    24  1525
---- Validation: 
scalar performance:
{'acc': 0.55598754, 'precision': 0.7361243, 'recall': 0.5433743, 'specificity': 0.5433743, 'f1': 0.4329661, 'auroc': 0.9074075, 'binary_precision': 0.9354839, 'binary_recall': 0.0928, 'binary_specificity': 0.9939486, 'binary_f1_score': 0.16885008}
confusion matrix:
     0   1
0  657   4
1  567  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5064935, 'precision': 0.5698448, 'recall': 0.5064935, 'specificity': 0.5064935, 'f1': 0.3617702, 'auroc': 0.8781694, 'binary_precision': 0.6363636, 'binary_recall': 0.030303031, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.057851244}
confusion matrix:
     0  1
0  227  4
1  224  7
early stop counter: 6
val acc:0.555987536907196, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 24,now: 2024-07-29 06:13:19.933583,epoch time: 0:01:34.455414,used: 0:38:13.583389,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.99149215, 'recall': 0.9916134, 'specificity': 0.9916134, 'f1': 0.9914917, 'auroc': 0.9998282, 'binary_precision': 0.99934554, 'binary_recall': 0.9838917, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.99155843}
confusion matrix:
      0     1
0  1503     1
1    25  1527
---- Validation: 
scalar performance:
{'acc': 0.57076204, 'precision': 0.72782147, 'recall': 0.55874854, 'specificity': 0.55874854, 'f1': 0.46489853, 'auroc': 0.9094463, 'binary_precision': 0.9101124, 'binary_recall': 0.1296, 'binary_specificity': 0.9878971, 'binary_f1_score': 0.22689074}
confusion matrix:
     0   1
0  653   8
1  544  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.521645, 'precision': 0.66185534, 'recall': 0.521645, 'specificity': 0.521645, 'f1': 0.38941145, 'auroc': 0.8993834, 'binary_precision': 0.8125, 'binary_recall': 0.056277055, 'binary_specificity': 0.987013, 'binary_f1_score': 0.10526316}
confusion matrix:
     0   1
0  228   3
1  218  13
early stop counter: 7
val acc:0.570762038230896, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 25,now: 2024-07-29 06:14:50.711762,epoch time: 0:01:30.778179,used: 0:39:44.361568,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9892784, 'recall': 0.98914236, 'specificity': 0.98914236, 'f1': 0.9891975, 'auroc': 0.9996282, 'binary_precision': 0.9859245, 'binary_recall': 0.99291235, 'binary_specificity': 0.98537236, 'binary_f1_score': 0.9894061}
confusion matrix:
      0     1
0  1482    22
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.6399689, 'precision': 0.73886085, 'recall': 0.6306457, 'specificity': 0.6306457, 'f1': 0.58947873, 'auroc': 0.86813855, 'binary_precision': 0.8857143, 'binary_recall': 0.2976, 'binary_specificity': 0.96369135, 'binary_f1_score': 0.445509}
confusion matrix:
     0    1
0  637   24
1  439  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6038961, 'precision': 0.751634, 'recall': 0.6038961, 'specificity': 0.6038961, 'f1': 0.5357549, 'auroc': 0.89080036, 'binary_precision': 0.9444444, 'binary_recall': 0.22077923, 'binary_specificity': 0.987013, 'binary_f1_score': 0.35789475}
confusion matrix:
     0   1
0  228   3
1  180  51
early stop counter: 8
val acc:0.6399688720703125, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 26,now: 2024-07-29 06:16:27.943465,epoch time: 0:01:37.231703,used: 0:41:21.593271,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9914495, 'recall': 0.9915733, 'specificity': 0.9915733, 'f1': 0.99149054, 'auroc': 0.9990874, 'binary_precision': 0.99610895, 'binary_recall': 0.98714656, 'binary_specificity': 0.996, 'binary_f1_score': 0.9916075}
confusion matrix:
      0     1
0  1494     6
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.63685846, 'precision': 0.76812553, 'recall': 0.62679213, 'specificity': 0.62679213, 'f1': 0.57664293, 'auroc': 0.9010687, 'binary_precision': 0.9488636, 'binary_recall': 0.2672, 'binary_specificity': 0.9863843, 'binary_f1_score': 0.41697875}
confusion matrix:
     0    1
0  652    9
1  458  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5281385, 'precision': 0.7239374, 'recall': 0.5281385, 'specificity': 0.5281385, 'f1': 0.3961436, 'auroc': 0.90142614, 'binary_precision': 0.93333334, 'binary_recall': 0.060606062, 'binary_specificity': 0.995671, 'binary_f1_score': 0.11382114}
confusion matrix:
     0   1
0  230   1
1  217  14
early stop counter: 9
val acc:0.6368584632873535, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 27,now: 2024-07-29 06:17:57.549948,epoch time: 0:01:29.606483,used: 0:42:51.199754,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99244463, 'recall': 0.99254906, 'specificity': 0.99254906, 'f1': 0.99247295, 'auroc': 0.99986637, 'binary_precision': 0.99739754, 'binary_recall': 0.98775774, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.99255425}
confusion matrix:
      0     1
0  1500     4
1    19  1533
---- Validation: 
scalar performance:
{'acc': 0.84681183, 'precision': 0.8625612, 'recall': 0.84388137, 'specificity': 0.84388137, 'f1': 0.84424776, 'auroc': 0.92620635, 'binary_precision': 0.9314516, 'binary_recall': 0.7392, 'binary_specificity': 0.9485628, 'binary_f1_score': 0.824264}
confusion matrix:
     0    1
0  627   34
1  163  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7770563, 'precision': 0.8306495, 'recall': 0.7770563, 'specificity': 0.7770563, 'f1': 0.7676408, 'auroc': 0.9152752, 'binary_precision': 0.9637681, 'binary_recall': 0.57575756, 'binary_specificity': 0.978355, 'binary_f1_score': 0.72086716}
confusion matrix:
     0    1
0  226    5
1   98  133
early stop counter: 10
val acc:0.846811830997467, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 28,now: 2024-07-29 06:19:21.319956,epoch time: 0:01:23.770008,used: 0:44:14.969762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927989, 'recall': 0.9927989, 'specificity': 0.9927989, 'f1': 0.9927989, 'auroc': 0.99976945, 'binary_precision': 0.9929215, 'binary_recall': 0.9929215, 'binary_specificity': 0.99267644, 'binary_f1_score': 0.9929215}
confusion matrix:
      0     1
0  1491    11
1    11  1543
---- Validation: 
scalar performance:
{'acc': 0.66562986, 'precision': 0.7692903, 'recall': 0.65669715, 'specificity': 0.65669715, 'f1': 0.6226526, 'auroc': 0.924679, 'binary_precision': 0.9295154, 'binary_recall': 0.3376, 'binary_specificity': 0.97579426, 'binary_f1_score': 0.49530515}
confusion matrix:
     0    1
0  645   16
1  414  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5974026, 'precision': 0.76647013, 'recall': 0.5974026, 'specificity': 0.5974026, 'f1': 0.52150476, 'auroc': 0.94141793, 'binary_precision': 0.9787234, 'binary_recall': 0.1991342, 'binary_specificity': 0.995671, 'binary_f1_score': 0.33093527}
confusion matrix:
     0   1
0  230   1
1  185  46
early stop counter: 11
val acc:0.6656298637390137, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 29,now: 2024-07-29 06:20:58.085239,epoch time: 0:01:36.765283,used: 0:45:51.735045,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.97717184, 'recall': 0.9767892, 'specificity': 0.9767892, 'f1': 0.9764381, 'auroc': 0.9998269, 'binary_precision': 1.0, 'binary_recall': 0.95357835, 'binary_specificity': 1.0, 'binary_f1_score': 0.97623765}
confusion matrix:
      0     1
0  1505     0
1    72  1479
---- Validation: 
scalar performance:
{'acc': 0.5427683, 'precision': 0.7518146, 'recall': 0.52964354, 'specificity': 0.52964354, 'f1': 0.40314084, 'auroc': 0.8788581, 'binary_precision': 0.974359, 'binary_recall': 0.0608, 'binary_specificity': 0.9984871, 'binary_f1_score': 0.11445783}
confusion matrix:
     0   1
0  660   1
1  587  38
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33714277, 'auroc': 0.90257406, 'binary_precision': 0.5, 'binary_recall': 0.0043290043, 'binary_specificity': 0.995671, 'binary_f1_score': 0.008583691}
confusion matrix:
     0  1
0  230  1
1  230  1
early stop counter: 12
val acc:0.5427682995796204, best validation acc: 0.8592535257339478, corresponding to test acc:                         0.798701286315918 / 0.850649356842041
after epoch: 30,now: 2024-07-29 06:22:24.814145,epoch time: 0:01:26.728906,used: 0:47:18.463951,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_35_06_seed_5_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:18.463951 at 2024-07-29 06:22:24.814145
persisted model performance metric: 

scalar performance:
{'acc': 0.7987013, 'precision': 0.7988413, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.7986777, 'auroc': 0.85301995, 'binary_precision': 0.8053097, 'binary_recall': 0.7878788, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.7964989}
confusion matrix:
     0    1
0  187   44
1   49  182
oracle model performance metric: 

scalar performance:
{'acc': 0.85064936, 'precision': 0.8535714, 'recall': 0.85064936, 'specificity': 0.85064936, 'f1': 0.8503401, 'auroc': 0.91327, 'binary_precision': 0.8857143, 'binary_recall': 0.8051948, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.8435374}
confusion matrix:
     0    1
0  207   24
1   45  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455269 KiB |  13219 MiB | 441125 GiB | 441124 GiB |
|       from large pool | 414671 KiB |  13181 MiB | 435904 GiB | 435904 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455269 KiB |  13219 MiB | 441125 GiB | 441124 GiB |
|       from large pool | 414671 KiB |  13181 MiB | 435904 GiB | 435904 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 434945 GiB | 434945 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14488 MiB |  82428 MiB |  67958 MiB |
|       from large pool |  14404 MiB |  14422 MiB |  82278 MiB |  67874 MiB |
|       from small pool |     66 MiB |     70 MiB |    150 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 503194 KiB |   1260 MiB | 316673 GiB | 316672 GiB |
|       from large pool | 490545 KiB |   1252 MiB | 311419 GiB | 311419 GiB |
|       from small pool |  12649 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77546 K  |   77544 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38161 K  |   38160 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77546 K  |   77544 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38161 K  |   38160 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    3498    |    2863    |
|       from large pool |     602    |     602    |    3423    |    2821    |
|       from small pool |      33    |      35    |      75    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     655    |   51014 K  |   51014 K  |
|       from large pool |      42    |     604    |   28515 K  |   28515 K  |
|       from small pool |      60    |     237    |   22499 K  |   22499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 441125 GiB | 441125 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435904 GiB | 435904 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 441125 GiB | 441125 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435904 GiB | 435904 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434945 GiB | 434945 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14488 MiB |  82428 MiB |  81492 MiB |
|       from large pool |    884 MiB |  14422 MiB |  82278 MiB |  81394 MiB |
|       from small pool |     52 MiB |     70 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 316673 GiB | 316673 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 311420 GiB | 311420 GiB |
|       from small pool |      0 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    3498    |    3432    |
|       from large pool |      40    |     602    |    3423    |    3383    |
|       from small pool |      26    |      35    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   51014 K  |   51014 K  |
|       from large pool |       3    |     604    |   28515 K  |   28515 K  |
|       from small pool |       0    |     237    |   22499 K  |   22499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 441125 GiB | 441125 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435904 GiB | 435904 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 441125 GiB | 441125 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435904 GiB | 435904 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434945 GiB | 434945 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14488 MiB |  82428 MiB |  81492 MiB |
|       from large pool |    884 MiB |  14422 MiB |  82278 MiB |  81394 MiB |
|       from small pool |     52 MiB |     70 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 316673 GiB | 316673 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 311420 GiB | 311420 GiB |
|       from small pool |      0 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    3498    |    3432    |
|       from large pool |      40    |     602    |    3423    |    3383    |
|       from small pool |      26    |      35    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   51014 K  |   51014 K  |
|       from large pool |       3    |     604    |   28515 K  |   28515 K  |
|       from small pool |       0    |     237    |   22499 K  |   22499 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369

 Experiment start at: 2024-07-29 06:23:12.311257
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.929362, 'precision': 0.9333572, 'recall': 0.92991185, 'specificity': 0.92991185, 'f1': 0.92925227, 'auroc': 0.9835528, 'binary_precision': 0.97782546, 'binary_recall': 0.8802318, 'binary_specificity': 0.97959185, 'binary_f1_score': 0.9264656}
confusion matrix:
      0     1
0  1488    31
1   186  1367
---- Validation: 
scalar performance:
{'acc': 0.8171206, 'precision': 0.8171871, 'recall': 0.8170626, 'specificity': 0.8170626, 'f1': 0.8170848, 'auroc': 0.89964044, 'binary_precision': 0.82034975, 'binary_recall': 0.80877745, 'binary_specificity': 0.8253478, 'binary_f1_score': 0.8145225}
confusion matrix:
     0    1
0  534  113
1  122  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8325995, 'recall': 0.8310811, 'specificity': 0.8310811, 'f1': 0.83088803, 'auroc': 0.9135825, 'binary_precision': 0.85507244, 'binary_recall': 0.7972973, 'binary_specificity': 0.8648649, 'binary_f1_score': 0.8251748}
confusion matrix:
     0    1
0  192   30
1   45  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:24:50.483009,epoch time: 0:01:38.171752,used: 0:01:38.171752,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9514974, 'precision': 0.95363545, 'recall': 0.9518753, 'specificity': 0.9518753, 'f1': 0.9514637, 'auroc': 0.9916868, 'binary_precision': 0.9874913, 'binary_recall': 0.9155928, 'binary_specificity': 0.98815787, 'binary_f1_score': 0.9501839}
confusion matrix:
      0     1
0  1502    18
1   131  1421
---- Validation: 
scalar performance:
{'acc': 0.82178986, 'precision': 0.8218584, 'recall': 0.82173204, 'specificity': 0.82173204, 'f1': 0.8217549, 'auroc': 0.8940275, 'binary_precision': 0.82511926, 'binary_recall': 0.8134796, 'binary_specificity': 0.82998455, 'binary_f1_score': 0.81925803}
confusion matrix:
     0    1
0  537  110
1  119  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8220721, 'precision': 0.82397187, 'recall': 0.8220721, 'specificity': 0.8220721, 'f1': 0.82181084, 'auroc': 0.9138057, 'binary_precision': 0.79916316, 'binary_recall': 0.8603604, 'binary_specificity': 0.7837838, 'binary_f1_score': 0.8286334}
confusion matrix:
     0    1
0  174   48
1   31  191
better model found
persisted
after epoch: 2,now: 2024-07-29 06:26:25.255647,epoch time: 0:01:34.772638,used: 0:03:12.944390,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.976593, 'recall': 0.97641784, 'specificity': 0.97641784, 'f1': 0.9762362, 'auroc': 0.9977177, 'binary_precision': 0.99267644, 'binary_recall': 0.9600773, 'binary_specificity': 0.9927584, 'binary_f1_score': 0.97610474}
confusion matrix:
      0     1
0  1508    11
1    62  1491
---- Validation: 
scalar performance:
{'acc': 0.82879376, 'precision': 0.83819485, 'recall': 0.8282076, 'specificity': 0.8282076, 'f1': 0.8274115, 'auroc': 0.9078263, 'binary_precision': 0.89285713, 'binary_recall': 0.7445141, 'binary_specificity': 0.91190106, 'binary_f1_score': 0.81196576}
confusion matrix:
     0    1
0  590   57
1  163  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8648649, 'precision': 0.87165177, 'recall': 0.8648648, 'specificity': 0.8648648, 'f1': 0.8642451, 'auroc': 0.9277859, 'binary_precision': 0.921875, 'binary_recall': 0.7972973, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.85507244}
confusion matrix:
     0    1
0  207   15
1   45  177
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 06:28:02.132794,epoch time: 0:01:36.877147,used: 0:04:49.821537,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9830787, 'recall': 0.98306155, 'specificity': 0.98306155, 'f1': 0.9830697, 'auroc': 0.9981034, 'binary_precision': 0.98267007, 'binary_recall': 0.98393315, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.98330116}
confusion matrix:
      0     1
0  1489    27
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.7463035, 'precision': 0.7966461, 'recall': 0.74485207, 'specificity': 0.74485207, 'f1': 0.73431146, 'auroc': 0.8833027, 'binary_precision': 0.9171123, 'binary_recall': 0.53761756, 'binary_specificity': 0.95208657, 'binary_f1_score': 0.6778656}
confusion matrix:
     0    1
0  616   31
1  295  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8626126, 'precision': 0.8672702, 'recall': 0.8626126, 'specificity': 0.8626126, 'f1': 0.8621756, 'auroc': 0.9297135, 'binary_precision': 0.9086294, 'binary_recall': 0.8063063, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.85441524}
confusion matrix:
     0    1
0  204   18
1   43  179
early stop counter: 1
val acc:0.7463034987449646, best validation acc: 0.8287937641143799, corresponding to test acc:                         0.8648648858070374 / 0.8648648858070374
after epoch: 4,now: 2024-07-29 06:29:33.840074,epoch time: 0:01:31.707280,used: 0:06:21.528817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9737283, 'recall': 0.97242945, 'specificity': 0.97242945, 'f1': 0.9726284, 'auroc': 0.9987067, 'binary_precision': 0.9536465, 'binary_recall': 0.994201, 'binary_specificity': 0.9506579, 'binary_f1_score': 0.97350156}
confusion matrix:
      0     1
0  1445    75
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.8552529, 'precision': 0.8572928, 'recall': 0.85551834, 'specificity': 0.85551834, 'f1': 0.8551054, 'auroc': 0.9176401, 'binary_precision': 0.82848835, 'binary_recall': 0.89341694, 'binary_specificity': 0.8176198, 'binary_f1_score': 0.8597285}
confusion matrix:
     0    1
0  529  118
1   68  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8085586, 'precision': 0.81553066, 'recall': 0.8085586, 'specificity': 0.8085586, 'f1': 0.8074951, 'auroc': 0.92748153, 'binary_precision': 0.76862746, 'binary_recall': 0.8828829, 'binary_specificity': 0.7342342, 'binary_f1_score': 0.821803}
confusion matrix:
     0    1
0  163   59
1   26  196
better model found
persisted
after epoch: 5,now: 2024-07-29 06:31:11.233272,epoch time: 0:01:37.393198,used: 0:07:58.922015,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853355, 'recall': 0.98536944, 'specificity': 0.98536944, 'f1': 0.9853499, 'auroc': 0.99912846, 'binary_precision': 0.9870968, 'binary_recall': 0.98392284, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.98550725}
confusion matrix:
      0     1
0  1497    20
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.80389106, 'precision': 0.816635, 'recall': 0.80318373, 'specificity': 0.80318373, 'f1': 0.8016363, 'auroc': 0.88703346, 'binary_precision': 0.8784314, 'binary_recall': 0.70219433, 'binary_specificity': 0.90417314, 'binary_f1_score': 0.7804877}
confusion matrix:
     0    1
0  585   62
1  190  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8738739, 'precision': 0.87693316, 'recall': 0.87387383, 'specificity': 0.87387383, 'f1': 0.8736174, 'auroc': 0.9339339, 'binary_precision': 0.9108911, 'binary_recall': 0.8288288, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.8679246}
confusion matrix:
     0    1
0  204   18
1   38  184
new oracle model saved
early stop counter: 1
val acc:0.8038910627365112, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 6,now: 2024-07-29 06:32:49.109308,epoch time: 0:01:37.876036,used: 0:09:36.798051,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9485677, 'precision': 0.9517054, 'recall': 0.9482014, 'specificity': 0.9482014, 'f1': 0.94844484, 'auroc': 0.9968272, 'binary_precision': 0.91626793, 'binary_recall': 0.9883871, 'binary_specificity': 0.9080158, 'binary_f1_score': 0.9509622}
confusion matrix:
      0     1
0  1382   140
1    18  1532
---- Validation: 
scalar performance:
{'acc': 0.7447471, 'precision': 0.7448492, 'recall': 0.74465823, 'specificity': 0.74465823, 'f1': 0.74466527, 'auroc': 0.82304394, 'binary_precision': 0.7483974, 'binary_recall': 0.7319749, 'binary_specificity': 0.75734156, 'binary_f1_score': 0.7400951}
confusion matrix:
     0    1
0  490  157
1  171  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7927928, 'precision': 0.7982391, 'recall': 0.7927928, 'specificity': 0.7927928, 'f1': 0.7918425, 'auroc': 0.887428, 'binary_precision': 0.75793654, 'binary_recall': 0.8603604, 'binary_specificity': 0.7252252, 'binary_f1_score': 0.80590725}
confusion matrix:
     0    1
0  161   61
1   31  191
early stop counter: 2
val acc:0.7447471022605896, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 7,now: 2024-07-29 06:34:19.320541,epoch time: 0:01:30.211233,used: 0:11:07.009284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9783746, 'recall': 0.9777322, 'specificity': 0.9777322, 'f1': 0.97785234, 'auroc': 0.9987165, 'binary_precision': 0.96486825, 'binary_recall': 0.9922581, 'binary_specificity': 0.9632063, 'binary_f1_score': 0.97837144}
confusion matrix:
      0     1
0  1466    56
1    12  1538
---- Validation: 
scalar performance:
{'acc': 0.8505837, 'precision': 0.85572916, 'recall': 0.8501621, 'specificity': 0.8501621, 'f1': 0.849927, 'auroc': 0.9060748, 'binary_precision': 0.8967972, 'binary_recall': 0.78996867, 'binary_specificity': 0.9103555, 'binary_f1_score': 0.84}
confusion matrix:
     0    1
0  589   58
1  134  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8738739, 'precision': 0.8739042, 'recall': 0.8738739, 'specificity': 0.8738739, 'f1': 0.8738713, 'auroc': 0.94243574, 'binary_precision': 0.8772727, 'binary_recall': 0.8693694, 'binary_specificity': 0.8783784, 'binary_f1_score': 0.8733032}
confusion matrix:
     0    1
0  195   27
1   29  193
early stop counter: 3
val acc:0.8505836725234985, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 8,now: 2024-07-29 06:35:58.458063,epoch time: 0:01:39.137522,used: 0:12:46.146806,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9818225, 'recall': 0.9817326, 'specificity': 0.9817326, 'f1': 0.98176706, 'auroc': 0.99925697, 'binary_precision': 0.9788868, 'binary_recall': 0.98519, 'binary_specificity': 0.9782752, 'binary_f1_score': 0.98202825}
confusion matrix:
      0     1
0  1486    33
1    23  1530
---- Validation: 
scalar performance:
{'acc': 0.77976656, 'precision': 0.8058976, 'recall': 0.7787364, 'specificity': 0.7787364, 'f1': 0.77452075, 'auroc': 0.86115086, 'binary_precision': 0.8935698, 'binary_recall': 0.6316614, 'binary_specificity': 0.9258114, 'binary_f1_score': 0.7401285}
confusion matrix:
     0    1
0  599   48
1  235  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8622155, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.84014976, 'auroc': 0.9173769, 'binary_precision': 0.9470588, 'binary_recall': 0.7252252, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.8214286}
confusion matrix:
     0    1
0  213    9
1   61  161
early stop counter: 4
val acc:0.7797665596008301, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 9,now: 2024-07-29 06:37:28.582551,epoch time: 0:01:30.124488,used: 0:14:16.271294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9847976, 'recall': 0.98480403, 'specificity': 0.98480403, 'f1': 0.9847005, 'auroc': 0.99913144, 'binary_precision': 0.9947403, 'binary_recall': 0.97487116, 'binary_specificity': 0.99473685, 'binary_f1_score': 0.9847055}
confusion matrix:
      0     1
0  1512     8
1    39  1513
---- Validation: 
scalar performance:
{'acc': 0.69494164, 'precision': 0.7735126, 'recall': 0.6930516, 'specificity': 0.6930516, 'f1': 0.67004144, 'auroc': 0.87408006, 'binary_precision': 0.9183673, 'binary_recall': 0.42319748, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.57939917}
confusion matrix:
     0    1
0  623   24
1  368  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108108, 'precision': 0.8473469, 'recall': 0.8108108, 'specificity': 0.8108108, 'f1': 0.80570143, 'auroc': 0.90637934, 'binary_precision': 0.96, 'binary_recall': 0.6486486, 'binary_specificity': 0.972973, 'binary_f1_score': 0.7741935}
confusion matrix:
     0    1
0  216    6
1   78  144
early stop counter: 5
val acc:0.6949416399002075, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 10,now: 2024-07-29 06:39:04.487317,epoch time: 0:01:35.904766,used: 0:15:52.176060,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98776585, 'recall': 0.98776585, 'specificity': 0.98776585, 'f1': 0.9876302, 'auroc': 0.9992925, 'binary_precision': 0.99934125, 'binary_recall': 0.97619045, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9876302}
confusion matrix:
      0     1
0  1517     1
1    37  1517
---- Validation: 
scalar performance:
{'acc': 0.66536963, 'precision': 0.7756574, 'recall': 0.66314024, 'specificity': 0.66314024, 'f1': 0.626403, 'auroc': 0.9030006, 'binary_precision': 0.94827586, 'binary_recall': 0.3448276, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.50574714}
confusion matrix:
     0    1
0  635   12
1  418  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5405405, 'precision': 0.7605634, 'recall': 0.5405405, 'specificity': 0.5405405, 'f1': 0.41759259, 'auroc': 0.8825582, 'binary_precision': 1.0, 'binary_recall': 0.08108108, 'binary_specificity': 1.0, 'binary_f1_score': 0.15}
confusion matrix:
     0   1
0  222   0
1  204  18
early stop counter: 6
val acc:0.6653696298599243, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 11,now: 2024-07-29 06:40:42.435385,epoch time: 0:01:37.948068,used: 0:17:30.124128,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869598, 'recall': 0.9870094, 'specificity': 0.9870094, 'f1': 0.98697793, 'auroc': 0.9991945, 'binary_precision': 0.9896574, 'binary_recall': 0.9845659, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9871051}
confusion matrix:
      0     1
0  1501    16
1    24  1531
---- Validation: 
scalar performance:
{'acc': 0.8513619, 'precision': 0.85177696, 'recall': 0.85124016, 'specificity': 0.85124016, 'f1': 0.8512808, 'auroc': 0.91307604, 'binary_precision': 0.8622366, 'binary_recall': 0.8338558, 'binary_specificity': 0.86862445, 'binary_f1_score': 0.84780884}
confusion matrix:
     0    1
0  562   85
1  106  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558559, 'precision': 0.85771394, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.8556684, 'auroc': 0.9285772, 'binary_precision': 0.88349515, 'binary_recall': 0.8198198, 'binary_specificity': 0.8918919, 'binary_f1_score': 0.85046726}
confusion matrix:
     0    1
0  198   24
1   40  182
early stop counter: 7
val acc:0.851361870765686, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 12,now: 2024-07-29 06:42:18.687190,epoch time: 0:01:36.251805,used: 0:19:06.375933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889285, 'recall': 0.98900306, 'specificity': 0.98900306, 'f1': 0.9889319, 'auroc': 0.999251, 'binary_precision': 0.9947951, 'binary_recall': 0.98327976, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.98900396}
confusion matrix:
      0     1
0  1509     8
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.82957196, 'precision': 0.8317449, 'recall': 0.8292856, 'specificity': 0.8292856, 'f1': 0.82919955, 'auroc': 0.9076295, 'binary_precision': 0.8568995, 'binary_recall': 0.78840125, 'binary_specificity': 0.87017, 'binary_f1_score': 0.82122445}
confusion matrix:
     0    1
0  563   84
1  135  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.83494544, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.8280438, 'auroc': 0.9031937, 'binary_precision': 0.8802083, 'binary_recall': 0.7612613, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.8164251}
confusion matrix:
     0    1
0  199   23
1   53  169
early stop counter: 8
val acc:0.8295719623565674, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 13,now: 2024-07-29 06:43:55.915582,epoch time: 0:01:37.228392,used: 0:20:43.604325,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99379975, 'recall': 0.9938343, 'specificity': 0.9938343, 'f1': 0.99381435, 'auroc': 0.9997198, 'binary_precision': 0.9954839, 'binary_recall': 0.992283, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.99388087}
confusion matrix:
      0     1
0  1510     7
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.7836576, 'precision': 0.8025968, 'recall': 0.78277487, 'specificity': 0.78277487, 'f1': 0.7798497, 'auroc': 0.890098, 'binary_precision': 0.87656903, 'binary_recall': 0.65673983, 'binary_specificity': 0.9088099, 'binary_f1_score': 0.7508961}
confusion matrix:
     0    1
0  588   59
1  219  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175676, 'precision': 0.8367617, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.81493056, 'auroc': 0.9080634, 'binary_precision': 0.91715974, 'binary_recall': 0.6981982, 'binary_specificity': 0.9369369, 'binary_f1_score': 0.79283893}
confusion matrix:
     0    1
0  208   14
1   67  155
early stop counter: 9
val acc:0.7836576104164124, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 14,now: 2024-07-29 06:45:29.246558,epoch time: 0:01:33.330976,used: 0:22:16.935301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98797655, 'recall': 0.98793626, 'specificity': 0.98793626, 'f1': 0.9879538, 'auroc': 0.99934506, 'binary_precision': 0.9865212, 'binary_recall': 0.98969734, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.9881067}
confusion matrix:
      0     1
0  1498    21
1    16  1537
---- Validation: 
scalar performance:
{'acc': 0.8490272, 'precision': 0.8499577, 'recall': 0.8488454, 'specificity': 0.8488454, 'f1': 0.8488734, 'auroc': 0.9052851, 'binary_precision': 0.86633664, 'binary_recall': 0.822884, 'binary_specificity': 0.8748068, 'binary_f1_score': 0.8440514}
confusion matrix:
     0    1
0  566   81
1  113  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7995495, 'precision': 0.79960424, 'recall': 0.7995496, 'specificity': 0.7995496, 'f1': 0.7995404, 'auroc': 0.8800828, 'binary_precision': 0.80365294, 'binary_recall': 0.7927928, 'binary_specificity': 0.8063063, 'binary_f1_score': 0.7981859}
confusion matrix:
     0    1
0  179   43
1   46  176
early stop counter: 10
val acc:0.8490272164344788, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 15,now: 2024-07-29 06:46:56.921481,epoch time: 0:01:27.674923,used: 0:23:44.610224,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902471, 'recall': 0.9903052, 'specificity': 0.9903052, 'f1': 0.99023414, 'auroc': 0.9996824, 'binary_precision': 0.99673843, 'binary_recall': 0.9839021, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.99027866}
confusion matrix:
      0     1
0  1514     5
1    25  1528
---- Validation: 
scalar performance:
{'acc': 0.7680934, 'precision': 0.80625343, 'recall': 0.7668501, 'specificity': 0.7668501, 'f1': 0.7600689, 'auroc': 0.88519233, 'binary_precision': 0.9126214, 'binary_recall': 0.5893417, 'binary_specificity': 0.9443586, 'binary_f1_score': 0.71619046}
confusion matrix:
     0    1
0  611   36
1  262  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.777027, 'precision': 0.8220427, 'recall': 0.777027, 'specificity': 0.777027, 'f1': 0.76895297, 'auroc': 0.8856424, 'binary_precision': 0.94244605, 'binary_recall': 0.5900901, 'binary_specificity': 0.963964, 'binary_f1_score': 0.7257618}
confusion matrix:
     0    1
0  214    8
1   91  131
early stop counter: 11
val acc:0.7680934071540833, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 16,now: 2024-07-29 06:48:34.092506,epoch time: 0:01:37.171025,used: 0:25:21.781249,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886384, 'recall': 0.98870575, 'specificity': 0.98870575, 'f1': 0.9886066, 'auroc': 0.99943876, 'binary_precision': 0.996732, 'binary_recall': 0.9807074, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9886548}
confusion matrix:
      0     1
0  1512     5
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.80389106, 'precision': 0.8288623, 'recall': 0.8029221, 'specificity': 0.8029221, 'f1': 0.79974025, 'auroc': 0.90529954, 'binary_precision': 0.9177489, 'binary_recall': 0.6645768, 'binary_specificity': 0.9412674, 'binary_f1_score': 0.77090913}
confusion matrix:
     0    1
0  609   38
1  214  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378378, 'precision': 0.8664173, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.8346129, 'auroc': 0.92740035, 'binary_precision': 0.96875, 'binary_recall': 0.6981982, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.8115183}
confusion matrix:
     0    1
0  217    5
1   67  155
early stop counter: 12
val acc:0.8038910627365112, best validation acc: 0.8552529215812683, corresponding to test acc:                         0.8085585832595825 / 0.8738738894462585
after epoch: 17,now: 2024-07-29 06:50:09.593776,epoch time: 0:01:35.501270,used: 0:26:57.282519,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98415387, 'recall': 0.9835768, 'specificity': 0.9835768, 'f1': 0.98371446, 'auroc': 0.99949086, 'binary_precision': 0.9723618, 'binary_recall': 0.996139, 'binary_specificity': 0.9710145, 'binary_f1_score': 0.9841067}
confusion matrix:
      0     1
0  1474    44
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.8575876, 'precision': 0.86243856, 'recall': 0.8571826, 'specificity': 0.8571826, 'f1': 0.85700524, 'auroc': 0.91149163, 'binary_precision': 0.9026549, 'binary_recall': 0.79937303, 'binary_specificity': 0.9149923, 'binary_f1_score': 0.8478803}
confusion matrix:
     0    1
0  592   55
1  128  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8648649, 'precision': 0.8707629, 'recall': 0.8648648, 'specificity': 0.8648648, 'f1': 0.8643253, 'auroc': 0.94052833, 'binary_precision': 0.91752577, 'binary_recall': 0.8018018, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.8557692}
confusion matrix:
     0    1
0  206   16
1   44  178
better model found
persisted
after epoch: 18,now: 2024-07-29 06:51:46.194650,epoch time: 0:01:36.600874,used: 0:28:33.883393,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99283177, 'recall': 0.9928986, 'specificity': 0.9928986, 'f1': 0.99283826, 'auroc': 0.99980545, 'binary_precision': 0.99804944, 'binary_recall': 0.9877735, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1515     3
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.76575875, 'precision': 0.8149423, 'recall': 0.7643682, 'specificity': 0.7643682, 'f1': 0.75559855, 'auroc': 0.90012014, 'binary_precision': 0.93766236, 'binary_recall': 0.5658307, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.70576733}
confusion matrix:
     0    1
0  623   24
1  277  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5675676, 'precision': 0.73888093, 'recall': 0.5675676, 'specificity': 0.5675676, 'f1': 0.47310126, 'auroc': 0.8640735, 'binary_precision': 0.9411765, 'binary_recall': 0.14414415, 'binary_specificity': 0.990991, 'binary_f1_score': 0.25}
confusion matrix:
     0   1
0  220   2
1  190  32
early stop counter: 1
val acc:0.765758752822876, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 19,now: 2024-07-29 06:53:24.279054,epoch time: 0:01:38.084404,used: 0:30:11.967797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99124783, 'recall': 0.9913051, 'specificity': 0.9913051, 'f1': 0.9912108, 'auroc': 0.9998622, 'binary_precision': 0.99934596, 'binary_recall': 0.983269, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9912423}
confusion matrix:
      0     1
0  1517     1
1    26  1528
---- Validation: 
scalar performance:
{'acc': 0.5867704, 'precision': 0.74966127, 'recall': 0.5839212, 'specificity': 0.5839212, 'f1': 0.50283104, 'auroc': 0.8794242, 'binary_precision': 0.94957983, 'binary_recall': 0.17711599, 'binary_specificity': 0.9907264, 'binary_f1_score': 0.29854688}
confusion matrix:
     0    1
0  641    6
1  525  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5540541, 'precision': 0.72870874, 'recall': 0.5540541, 'specificity': 0.5540541, 'f1': 0.4488276, 'auroc': 0.8803618, 'binary_precision': 0.9285714, 'binary_recall': 0.117117114, 'binary_specificity': 0.990991, 'binary_f1_score': 0.20799999}
confusion matrix:
     0   1
0  220   2
1  196  26
early stop counter: 2
val acc:0.5867704153060913, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 20,now: 2024-07-29 06:55:01.566698,epoch time: 0:01:37.287644,used: 0:31:49.255441,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99250436, 'recall': 0.9925263, 'specificity': 0.9925263, 'f1': 0.99251264, 'auroc': 0.99968207, 'binary_precision': 0.99417096, 'binary_recall': 0.9909619, 'binary_specificity': 0.9940906, 'binary_f1_score': 0.99256384}
confusion matrix:
      0     1
0  1514     9
1    14  1535
---- Validation: 
scalar performance:
{'acc': 0.80389106, 'precision': 0.80594903, 'recall': 0.803598, 'specificity': 0.803598, 'f1': 0.8034482, 'auroc': 0.88283515, 'binary_precision': 0.82935154, 'binary_recall': 0.76175547, 'binary_specificity': 0.8454405, 'binary_f1_score': 0.7941177}
confusion matrix:
     0    1
0  547  100
1  152  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.8288288, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.8288288, 'auroc': 0.9018749, 'binary_precision': 0.8288288, 'binary_recall': 0.8288288, 'binary_specificity': 0.8288288, 'binary_f1_score': 0.8288288}
confusion matrix:
     0    1
0  184   38
1   38  184
early stop counter: 3
val acc:0.8038910627365112, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 21,now: 2024-07-29 06:56:34.553688,epoch time: 0:01:32.986990,used: 0:33:22.242431,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9805315, 'recall': 0.9792353, 'specificity': 0.9792353, 'f1': 0.97947, 'auroc': 0.9997609, 'binary_precision': 0.961063, 'binary_recall': 1.0, 'binary_specificity': 0.95847064, 'binary_f1_score': 0.980145}
confusion matrix:
      0     1
0  1454    63
1     0  1555
---- Validation: 
scalar performance:
{'acc': 0.85214007, 'precision': 0.8532831, 'recall': 0.85234, 'specificity': 0.85234, 'f1': 0.8520647, 'auroc': 0.9217391, 'binary_precision': 0.83136094, 'binary_recall': 0.88087773, 'binary_specificity': 0.8238022, 'binary_f1_score': 0.85540336}
confusion matrix:
     0    1
0  533  114
1   76  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175676, 'precision': 0.8210132, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.81707674, 'auroc': 0.90274733, 'binary_precision': 0.78775513, 'binary_recall': 0.8693694, 'binary_specificity': 0.7657658, 'binary_f1_score': 0.8265525}
confusion matrix:
     0    1
0  170   52
1   29  193
early stop counter: 4
val acc:0.8521400690078735, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 22,now: 2024-07-29 06:58:01.021766,epoch time: 0:01:26.468078,used: 0:34:48.710509,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.991215, 'recall': 0.9912822, 'specificity': 0.9912822, 'f1': 0.9912107, 'auroc': 0.9997338, 'binary_precision': 0.99739414, 'binary_recall': 0.9851995, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.99125934}
confusion matrix:
      0     1
0  1514     4
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.8171206, 'precision': 0.8298135, 'recall': 0.81643033, 'specificity': 0.81643033, 'f1': 0.8151101, 'auroc': 0.9047618, 'binary_precision': 0.8927875, 'binary_recall': 0.7178683, 'binary_specificity': 0.9149923, 'binary_f1_score': 0.7958298}
confusion matrix:
     0    1
0  592   55
1  180  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130631, 'precision': 0.8386301, 'recall': 0.8130631, 'specificity': 0.8130631, 'f1': 0.8094667, 'auroc': 0.9198117, 'binary_precision': 0.93167704, 'binary_recall': 0.6756757, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.78328985}
confusion matrix:
     0    1
0  211   11
1   72  150
early stop counter: 5
val acc:0.8171206116676331, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 23,now: 2024-07-29 06:59:39.146118,epoch time: 0:01:38.124352,used: 0:36:26.834861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902712, 'recall': 0.990208, 'specificity': 0.990208, 'f1': 0.9902329, 'auroc': 0.99979734, 'binary_precision': 0.9878127, 'binary_recall': 0.9929078, 'binary_specificity': 0.98750824, 'binary_f1_score': 0.9903537}
confusion matrix:
      0     1
0  1502    19
1    11  1540
---- Validation: 
scalar performance:
{'acc': 0.79610896, 'precision': 0.8241583, 'recall': 0.7950742, 'specificity': 0.7950742, 'f1': 0.79120153, 'auroc': 0.89869326, 'binary_precision': 0.9177778, 'binary_recall': 0.6473354, 'binary_specificity': 0.942813, 'binary_f1_score': 0.7591912}
confusion matrix:
     0    1
0  610   37
1  225  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8243243, 'precision': 0.8447205, 'recall': 0.8243243, 'specificity': 0.8243243, 'f1': 0.82168674, 'auroc': 0.8930484, 'binary_precision': 0.9285714, 'binary_recall': 0.7027027, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  210   12
1   66  156
early stop counter: 6
val acc:0.7961089611053467, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 24,now: 2024-07-29 07:01:18.773108,epoch time: 0:01:39.626990,used: 0:38:06.461851,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938079, 'recall': 0.99388266, 'specificity': 0.99388266, 'f1': 0.9938148, 'auroc': 0.99991477, 'binary_precision': 0.99934983, 'binary_recall': 0.9884244, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9938571}
confusion matrix:
      0     1
0  1516     1
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.77509725, 'precision': 0.8232576, 'recall': 0.77373993, 'specificity': 0.77373993, 'f1': 0.7658021, 'auroc': 0.9113742, 'binary_precision': 0.94629157, 'binary_recall': 0.5799373, 'binary_specificity': 0.9675425, 'binary_f1_score': 0.71914476}
confusion matrix:
     0    1
0  626   21
1  268  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.82204187, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7351903, 'auroc': 0.9050199, 'binary_precision': 0.974359, 'binary_recall': 0.5135135, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.67256635}
confusion matrix:
     0    1
0  219    3
1  108  114
early stop counter: 7
val acc:0.7750972509384155, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 25,now: 2024-07-29 07:02:52.120190,epoch time: 0:01:33.347082,used: 0:39:39.808933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9840739, 'recall': 0.9835994, 'specificity': 0.9835994, 'f1': 0.983716, 'auroc': 0.99935436, 'binary_precision': 0.973535, 'binary_recall': 0.99484867, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.98407644}
confusion matrix:
      0     1
0  1477    42
1     8  1545
---- Validation: 
scalar performance:
{'acc': 0.83579767, 'precision': 0.84675443, 'recall': 0.8351737, 'specificity': 0.8351737, 'f1': 0.8343041, 'auroc': 0.8970532, 'binary_precision': 0.9066667, 'binary_recall': 0.74608153, 'binary_specificity': 0.92426586, 'binary_f1_score': 0.8185727}
confusion matrix:
     0    1
0  598   49
1  162  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8063063, 'precision': 0.82712144, 'recall': 0.8063063, 'specificity': 0.8063063, 'f1': 0.8031753, 'auroc': 0.88953817, 'binary_precision': 0.9096386, 'binary_recall': 0.6801802, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.7783506}
confusion matrix:
     0    1
0  207   15
1   71  151
early stop counter: 8
val acc:0.8357976675033569, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 26,now: 2024-07-29 07:04:30.727872,epoch time: 0:01:38.607682,used: 0:41:18.416615,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.995752, 'recall': 0.9957887, 'specificity': 0.9957887, 'f1': 0.9957677, 'auroc': 0.9997474, 'binary_precision': 0.997421, 'binary_recall': 0.99421597, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9958159}
confusion matrix:
      0     1
0  1512     4
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.83735406, 'precision': 0.85090375, 'recall': 0.8366648, 'specificity': 0.8366648, 'f1': 0.8355659, 'auroc': 0.9159807, 'binary_precision': 0.91812867, 'binary_recall': 0.73824453, 'binary_specificity': 0.935085, 'binary_f1_score': 0.81841874}
confusion matrix:
     0    1
0  605   42
1  167  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.713964, 'precision': 0.78528523, 'recall': 0.713964, 'specificity': 0.713964, 'f1': 0.6948949, 'auroc': 0.8624097, 'binary_precision': 0.9279279, 'binary_recall': 0.46396396, 'binary_specificity': 0.963964, 'binary_f1_score': 0.6186186}
confusion matrix:
     0    1
0  214    8
1  119  103
early stop counter: 9
val acc:0.8373540639877319, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 27,now: 2024-07-29 07:06:00.267074,epoch time: 0:01:29.539202,used: 0:42:47.955817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896774, 'recall': 0.989704, 'specificity': 0.989704, 'f1': 0.9895833, 'auroc': 0.9998393, 'binary_precision': 1.0, 'binary_recall': 0.97940797, 'binary_specificity': 1.0, 'binary_f1_score': 0.98959684}
confusion matrix:
      0     1
0  1518     0
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.78988326, 'precision': 0.82345533, 'recall': 0.7887501, 'specificity': 0.7887501, 'f1': 0.78383183, 'auroc': 0.91405237, 'binary_precision': 0.9259259, 'binary_recall': 0.62695926, 'binary_specificity': 0.95054096, 'binary_f1_score': 0.74766356}
confusion matrix:
     0    1
0  615   32
1  238  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8153153, 'precision': 0.8571757, 'recall': 0.8153153, 'specificity': 0.8153153, 'f1': 0.8097408, 'auroc': 0.92313933, 'binary_precision': 0.9794521, 'binary_recall': 0.6441441, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.77717394}
confusion matrix:
     0    1
0  219    3
1   79  143
early stop counter: 10
val acc:0.7898832559585571, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 28,now: 2024-07-29 07:07:30.811389,epoch time: 0:01:30.544315,used: 0:44:18.500132,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99413383, 'recall': 0.9942008, 'specificity': 0.9942008, 'f1': 0.9941404, 'auroc': 0.999841, 'binary_precision': 0.99934983, 'binary_recall': 0.98906046, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.99417853}
confusion matrix:
      0     1
0  1517     1
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.76731515, 'precision': 0.8081229, 'recall': 0.76603377, 'specificity': 0.76603377, 'f1': 0.75875914, 'auroc': 0.9128253, 'binary_precision': 0.91851854, 'binary_recall': 0.5830721, 'binary_specificity': 0.94899535, 'binary_f1_score': 0.71332693}
confusion matrix:
     0    1
0  614   33
1  266  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6689189, 'precision': 0.79459643, 'recall': 0.6689189, 'specificity': 0.6689189, 'f1': 0.6293928, 'auroc': 0.9033358, 'binary_precision': 0.987013, 'binary_recall': 0.34234235, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5083612}
confusion matrix:
     0   1
0  221   1
1  146  76
early stop counter: 11
val acc:0.767315149307251, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 29,now: 2024-07-29 07:09:05.317545,epoch time: 0:01:34.506156,used: 0:45:53.006288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957495, 'recall': 0.99581194, 'specificity': 0.99581194, 'f1': 0.99576795, 'auroc': 0.99985206, 'binary_precision': 0.99935234, 'binary_recall': 0.992283, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.99580514}
confusion matrix:
      0     1
0  1516     1
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.8007782, 'precision': 0.83566034, 'recall': 0.79964554, 'specificity': 0.79964554, 'f1': 0.7950405, 'auroc': 0.91717803, 'binary_precision': 0.9421296, 'binary_recall': 0.63793105, 'binary_specificity': 0.9613601, 'binary_f1_score': 0.7607476}
confusion matrix:
     0    1
0  622   25
1  231  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7815315, 'precision': 0.8446435, 'recall': 0.7815316, 'specificity': 0.7815316, 'f1': 0.7710501, 'auroc': 0.9197508, 'binary_precision': 0.992126, 'binary_recall': 0.5675676, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.72206306}
confusion matrix:
     0    1
0  221    1
1   96  126
early stop counter: 12
val acc:0.8007782101631165, best validation acc: 0.8575875759124756, corresponding to test acc:                         0.8648648858070374 / 0.8738738894462585
after epoch: 30,now: 2024-07-29 07:10:44.887345,epoch time: 0:01:39.569800,used: 0:47:32.576088,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_23_12_seed_6_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:32.576088 at 2024-07-29 07:10:44.887345
persisted model performance metric: 

scalar performance:
{'acc': 0.8648649, 'precision': 0.8707629, 'recall': 0.8648648, 'specificity': 0.8648648, 'f1': 0.8643253, 'auroc': 0.94052833, 'binary_precision': 0.91752577, 'binary_recall': 0.8018018, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.8557692}
confusion matrix:
     0    1
0  206   16
1   44  178
oracle model performance metric: 

scalar performance:
{'acc': 0.8738739, 'precision': 0.87693316, 'recall': 0.87387383, 'specificity': 0.87387383, 'f1': 0.8736174, 'auroc': 0.9339339, 'binary_precision': 0.9108911, 'binary_recall': 0.8288288, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.8679246}
confusion matrix:
     0    1
0  204   18
1   38  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456211 KiB |  13219 MiB | 514766 GiB | 514766 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 508677 GiB | 508676 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456211 KiB |  13219 MiB | 514766 GiB | 514766 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 508677 GiB | 508676 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 507474 GiB | 507474 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  95968 MiB |  81492 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  95804 MiB |  81394 MiB |
|       from small pool |     66 MiB |     70 MiB |    164 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475628 KiB |   1260 MiB | 369020 GiB | 369020 GiB |
|       from large pool | 462976 KiB |   1252 MiB | 362893 GiB | 362892 GiB |
|       from small pool |  12652 KiB |     45 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90476 K  |   90475 K  |
|       from large pool |     187    |    1413    |   45954 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44522 K  |   44520 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90476 K  |   90475 K  |
|       from large pool |     187    |    1413    |   45954 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44522 K  |   44520 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4067    |    3432    |
|       from large pool |     602    |     602    |    3985    |    3383    |
|       from small pool |      33    |      35    |      82    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     655    |   59728 K  |   59728 K  |
|       from large pool |      38    |     604    |   33579 K  |   33579 K  |
|       from small pool |      62    |     237    |   26148 K  |   26148 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 514766 GiB | 514766 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508677 GiB | 508677 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 514766 GiB | 514766 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508677 GiB | 508677 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507474 GiB | 507474 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB |  95968 MiB |  95058 MiB |
|       from large pool |    858 MiB |  14422 MiB |  95804 MiB |  94946 MiB |
|       from small pool |     52 MiB |     70 MiB |    164 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 369020 GiB | 369020 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 362893 GiB | 362893 GiB |
|       from small pool |      0 KiB |     45 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    4067    |    4002    |
|       from large pool |      39    |     602    |    3985    |    3946    |
|       from small pool |      26    |      35    |      82    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   59728 K  |   59728 K  |
|       from large pool |       3    |     604    |   33579 K  |   33579 K  |
|       from small pool |       0    |     237    |   26148 K  |   26148 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 514766 GiB | 514766 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508677 GiB | 508677 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 514766 GiB | 514766 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508677 GiB | 508677 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507474 GiB | 507474 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB |  95968 MiB |  95058 MiB |
|       from large pool |    858 MiB |  14422 MiB |  95804 MiB |  94946 MiB |
|       from small pool |     52 MiB |     70 MiB |    164 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 369020 GiB | 369020 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 362893 GiB | 362893 GiB |
|       from small pool |      0 KiB |     45 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    4067    |    4002    |
|       from large pool |      39    |     602    |    3985    |    3946    |
|       from small pool |      26    |      35    |      82    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   59728 K  |   59728 K  |
|       from large pool |       3    |     604    |   33579 K  |   33579 K  |
|       from small pool |       0    |     237    |   26148 K  |   26148 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369

 Experiment start at: 2024-07-29 07:11:31.179821
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9244792, 'precision': 0.92559505, 'recall': 0.9241046, 'specificity': 0.9241046, 'f1': 0.92436755, 'auroc': 0.9780295, 'binary_precision': 0.907362, 'binary_recall': 0.9480769, 'binary_specificity': 0.9001323, 'binary_f1_score': 0.9272727}
confusion matrix:
      0     1
0  1361   151
1    81  1479
---- Validation: 
scalar performance:
{'acc': 0.8415385, 'precision': 0.8415874, 'recall': 0.8414062, 'specificity': 0.8414062, 'f1': 0.8414649, 'auroc': 0.90230584, 'binary_precision': 0.8433544, 'binary_recall': 0.8328125, 'binary_specificity': 0.85, 'binary_f1_score': 0.8380503}
confusion matrix:
     0    1
0  561   99
1  107  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.8607022, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.86021936, 'auroc': 0.93833065, 'binary_precision': 0.84810126, 'binary_recall': 0.87772924, 'binary_specificity': 0.8427948, 'binary_f1_score': 0.8626609}
confusion matrix:
     0    1
0  193   36
1   28  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:13:11.012798,epoch time: 0:01:39.832977,used: 0:01:39.832977,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.96354914, 'recall': 0.96297824, 'specificity': 0.96297824, 'f1': 0.9625603, 'auroc': 0.995088, 'binary_precision': 0.9891672, 'binary_recall': 0.93653846, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.9621337}
confusion matrix:
      0     1
0  1496    16
1    99  1461
---- Validation: 
scalar performance:
{'acc': 0.83153844, 'precision': 0.84157896, 'recall': 0.8302083, 'specificity': 0.8302083, 'f1': 0.8298632, 'auroc': 0.89538586, 'binary_precision': 0.89642185, 'binary_recall': 0.74375, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.81298035}
confusion matrix:
     0    1
0  605   55
1  164  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.87988204, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.87281674, 'auroc': 0.94210637, 'binary_precision': 0.9296482, 'binary_recall': 0.80786026, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.8644859}
confusion matrix:
     0    1
0  215   14
1   44  185
new oracle model saved
early stop counter: 1
val acc:0.8315384387969971, best validation acc: 0.8415384888648987, corresponding to test acc:                         0.8602620363235474 / 0.8733624219894409
after epoch: 2,now: 2024-07-29 07:14:51.233903,epoch time: 0:01:40.221105,used: 0:03:20.054082,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97363114, 'recall': 0.97362125, 'specificity': 0.97362125, 'f1': 0.9736261, 'auroc': 0.9968356, 'binary_precision': 0.9737348, 'binary_recall': 0.974359, 'binary_specificity': 0.9728836, 'binary_f1_score': 0.97404677}
confusion matrix:
      0     1
0  1471    41
1    40  1520
---- Validation: 
scalar performance:
{'acc': 0.82076925, 'precision': 0.82532656, 'recall': 0.819839, 'specificity': 0.819839, 'f1': 0.81980693, 'auroc': 0.8824574, 'binary_precision': 0.860177, 'binary_recall': 0.759375, 'binary_specificity': 0.880303, 'binary_f1_score': 0.806639}
confusion matrix:
     0    1
0  581   79
1  154  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.8406699, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.84060454, 'auroc': 0.935928, 'binary_precision': 0.8362069, 'binary_recall': 0.8471616, 'binary_specificity': 0.83406115, 'binary_f1_score': 0.84164864}
confusion matrix:
     0    1
0  191   38
1   35  194
early stop counter: 2
val acc:0.8207692503929138, best validation acc: 0.8415384888648987, corresponding to test acc:                         0.8602620363235474 / 0.8733624219894409
after epoch: 3,now: 2024-07-29 07:16:31.794895,epoch time: 0:01:40.560992,used: 0:05:00.615074,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.97271097, 'recall': 0.97236466, 'specificity': 0.97236466, 'f1': 0.9720036, 'auroc': 0.9975542, 'binary_precision': 0.9952957, 'binary_recall': 0.949359, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.97178483}
confusion matrix:
      0     1
0  1505     7
1    79  1481
---- Validation: 
scalar performance:
{'acc': 0.7430769, 'precision': 0.8076347, 'recall': 0.7395123, 'specificity': 0.7395123, 'f1': 0.72694296, 'auroc': 0.887571, 'binary_precision': 0.9447674, 'binary_recall': 0.5078125, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.6605691}
confusion matrix:
     0    1
0  641   19
1  315  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.88294315, 'recall': 0.84716153, 'specificity': 0.84716153, 'f1': 0.843506, 'auroc': 0.93911254, 'binary_precision': 1.0, 'binary_recall': 0.6943231, 'binary_specificity': 1.0, 'binary_f1_score': 0.81958765}
confusion matrix:
     0    1
0  229    0
1   70  159
early stop counter: 3
val acc:0.7430769205093384, best validation acc: 0.8415384888648987, corresponding to test acc:                         0.8602620363235474 / 0.8733624219894409
after epoch: 4,now: 2024-07-29 07:18:15.796884,epoch time: 0:01:44.001989,used: 0:06:44.617063,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97880936, 'recall': 0.97889197, 'specificity': 0.97889197, 'f1': 0.978838, 'auroc': 0.99823797, 'binary_precision': 0.9825694, 'binary_recall': 0.975641, 'binary_specificity': 0.98214287, 'binary_f1_score': 0.9790929}
confusion matrix:
      0     1
0  1485    27
1    38  1522
---- Validation: 
scalar performance:
{'acc': 0.75846153, 'precision': 0.79827285, 'recall': 0.7556108, 'specificity': 0.7556108, 'f1': 0.7487171, 'auroc': 0.8593223, 'binary_precision': 0.90346533, 'binary_recall': 0.5703125, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.6992338}
confusion matrix:
     0    1
0  621   39
1  275  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84497815, 'precision': 0.866096, 'recall': 0.84497815, 'specificity': 0.84497815, 'f1': 0.8427099, 'auroc': 0.9343262, 'binary_precision': 0.954023, 'binary_recall': 0.7248908, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.82382137}
confusion matrix:
     0    1
0  221    8
1   63  166
early stop counter: 4
val acc:0.7584615349769592, best validation acc: 0.8415384888648987, corresponding to test acc:                         0.8602620363235474 / 0.8733624219894409
after epoch: 5,now: 2024-07-29 07:19:55.324004,epoch time: 0:01:39.527120,used: 0:08:24.144183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9749665, 'recall': 0.9732652, 'specificity': 0.9732652, 'f1': 0.9735932, 'auroc': 0.9990855, 'binary_precision': 0.9534028, 'binary_recall': 0.9967949, 'binary_specificity': 0.94973546, 'binary_f1_score': 0.9746161}
confusion matrix:
      0     1
0  1436    76
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.82153845, 'precision': 0.82285714, 'recall': 0.82102275, 'specificity': 0.82102275, 'f1': 0.8211575, 'auroc': 0.8931439, 'binary_precision': 0.84, 'binary_recall': 0.7875, 'binary_specificity': 0.8545455, 'binary_f1_score': 0.81290317}
confusion matrix:
     0    1
0  564   96
1  136  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.8430302, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8427678, 'auroc': 0.93068403, 'binary_precision': 0.85201794, 'binary_recall': 0.82969433, 'binary_specificity': 0.8558952, 'binary_f1_score': 0.84070796}
confusion matrix:
     0    1
0  196   33
1   39  190
early stop counter: 5
val acc:0.8215384483337402, best validation acc: 0.8415384888648987, corresponding to test acc:                         0.8602620363235474 / 0.8733624219894409
after epoch: 6,now: 2024-07-29 07:21:34.900616,epoch time: 0:01:39.576612,used: 0:10:03.720795,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9823915, 'recall': 0.9824888, 'specificity': 0.9824888, 'f1': 0.9824197, 'auroc': 0.99811, 'binary_precision': 0.9870634, 'binary_recall': 0.97820514, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9826143}
confusion matrix:
      0     1
0  1492    20
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.77692306, 'precision': 0.8165453, 'recall': 0.77417135, 'specificity': 0.77417135, 'f1': 0.76849806, 'auroc': 0.8935653, 'binary_precision': 0.9247573, 'binary_recall': 0.5953125, 'binary_specificity': 0.9530303, 'binary_f1_score': 0.7243346}
confusion matrix:
     0    1
0  629   31
1  259  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275109, 'precision': 0.8645568, 'recall': 0.82751095, 'specificity': 0.82751095, 'f1': 0.8230146, 'auroc': 0.93497455, 'binary_precision': 0.9807692, 'binary_recall': 0.6681223, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7948052}
confusion matrix:
     0    1
0  226    3
1   76  153
early stop counter: 6
val acc:0.7769230604171753, best validation acc: 0.8415384888648987, corresponding to test acc:                         0.8602620363235474 / 0.8733624219894409
after epoch: 7,now: 2024-07-29 07:23:13.577256,epoch time: 0:01:38.676640,used: 0:11:42.397435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97859615, 'recall': 0.9780067, 'specificity': 0.9780067, 'f1': 0.9781742, 'auroc': 0.9983766, 'binary_precision': 0.9680251, 'binary_recall': 0.9897436, 'binary_specificity': 0.96626985, 'binary_f1_score': 0.9787639}
confusion matrix:
      0     1
0  1461    51
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.8515385, 'precision': 0.8574679, 'recall': 0.8505445, 'specificity': 0.8505445, 'f1': 0.8506369, 'auroc': 0.9152746, 'binary_precision': 0.8998211, 'binary_recall': 0.7859375, 'binary_specificity': 0.91515154, 'binary_f1_score': 0.83903253}
confusion matrix:
     0    1
0  604   56
1  137  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88209605, 'precision': 0.8844715, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.88191366, 'auroc': 0.94155335, 'binary_precision': 0.9146919, 'binary_recall': 0.8427948, 'binary_specificity': 0.9213974, 'binary_f1_score': 0.8772727}
confusion matrix:
     0    1
0  211   18
1   36  193
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-29 07:24:53.937038,epoch time: 0:01:40.359782,used: 0:13:22.757217,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9830025, 'recall': 0.9829925, 'specificity': 0.9829925, 'f1': 0.9827474, 'auroc': 0.99904144, 'binary_precision': 0.99867636, 'binary_recall': 0.9673077, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.9827417}
confusion matrix:
      0     1
0  1510     2
1    51  1509
---- Validation: 
scalar performance:
{'acc': 0.8346154, 'precision': 0.8423051, 'recall': 0.83345175, 'specificity': 0.83345175, 'f1': 0.83331096, 'auroc': 0.8900426, 'binary_precision': 0.88990825, 'binary_recall': 0.7578125, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.81856537}
confusion matrix:
     0    1
0  600   60
1  155  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.8568752, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.85579616, 'auroc': 0.9250205, 'binary_precision': 0.875576, 'binary_recall': 0.82969433, 'binary_specificity': 0.88209605, 'binary_f1_score': 0.85201794}
confusion matrix:
     0    1
0  202   27
1   39  190
early stop counter: 1
val acc:0.8346154093742371, best validation acc: 0.8515384793281555, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 9,now: 2024-07-29 07:26:34.493105,epoch time: 0:01:40.556067,used: 0:15:03.313284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9876157, 'recall': 0.98715407, 'specificity': 0.98715407, 'f1': 0.9872967, 'auroc': 0.99963665, 'binary_precision': 0.9786029, 'binary_recall': 0.9967949, 'binary_specificity': 0.97751325, 'binary_f1_score': 0.9876151}
confusion matrix:
      0     1
0  1478    34
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.8453846, 'precision': 0.8506366, 'recall': 0.8444365, 'specificity': 0.8444365, 'f1': 0.84451896, 'auroc': 0.8982759, 'binary_precision': 0.88987565, 'binary_recall': 0.7828125, 'binary_specificity': 0.9060606, 'binary_f1_score': 0.8329177}
confusion matrix:
     0    1
0  598   62
1  139  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87772924, 'precision': 0.881248, 'recall': 0.8777293, 'specificity': 0.8777293, 'f1': 0.87744653, 'auroc': 0.9386549, 'binary_precision': 0.9178744, 'binary_recall': 0.82969433, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8715597}
confusion matrix:
     0    1
0  212   17
1   39  190
early stop counter: 2
val acc:0.8453845977783203, best validation acc: 0.8515384793281555, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 10,now: 2024-07-29 07:28:14.102138,epoch time: 0:01:39.609033,used: 0:16:42.922317,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98760176, 'recall': 0.9876679, 'specificity': 0.9876679, 'f1': 0.98762816, 'auroc': 0.99941623, 'binary_precision': 0.99033505, 'binary_recall': 0.98525643, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.9877893}
confusion matrix:
      0     1
0  1497    15
1    23  1537
---- Validation: 
scalar performance:
{'acc': 0.78923076, 'precision': 0.8259617, 'recall': 0.7866241, 'specificity': 0.7866241, 'f1': 0.7820479, 'auroc': 0.8982067, 'binary_precision': 0.9316038, 'binary_recall': 0.6171875, 'binary_specificity': 0.9560606, 'binary_f1_score': 0.74248123}
confusion matrix:
     0    1
0  631   29
1  245  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.879848, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.8584372, 'auroc': 0.9352034, 'binary_precision': 0.9661017, 'binary_recall': 0.7467249, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.8423645}
confusion matrix:
     0    1
0  223    6
1   58  171
early stop counter: 3
val acc:0.7892307639122009, best validation acc: 0.8515384793281555, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 11,now: 2024-07-29 07:29:57.223281,epoch time: 0:01:43.121143,used: 0:18:26.043460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895532, 'recall': 0.98965204, 'specificity': 0.98965204, 'f1': 0.98958206, 'auroc': 0.9995256, 'binary_precision': 0.99417853, 'binary_recall': 0.98525643, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.9896974}
confusion matrix:
      0     1
0  1503     9
1    23  1537
---- Validation: 
scalar performance:
{'acc': 0.76461536, 'precision': 0.81406367, 'recall': 0.7615293, 'specificity': 0.7615293, 'f1': 0.75350475, 'auroc': 0.8967128, 'binary_precision': 0.9348958, 'binary_recall': 0.5609375, 'binary_specificity': 0.9621212, 'binary_f1_score': 0.7011718}
confusion matrix:
     0    1
0  635   25
1  281  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6877729, 'precision': 0.7833506, 'recall': 0.6877729, 'specificity': 0.6877729, 'f1': 0.65901864, 'auroc': 0.91102374, 'binary_precision': 0.9479167, 'binary_recall': 0.3973799, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.56}
confusion matrix:
     0   1
0  224   5
1  138  91
early stop counter: 4
val acc:0.7646153569221497, best validation acc: 0.8515384793281555, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 12,now: 2024-07-29 07:31:35.545541,epoch time: 0:01:38.322260,used: 0:20:04.365720,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919808, 'recall': 0.9917837, 'specificity': 0.9917837, 'f1': 0.9918585, 'auroc': 0.9997282, 'binary_precision': 0.9873016, 'binary_recall': 0.9967949, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9920255}
confusion matrix:
      0     1
0  1492    20
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.86615384, 'precision': 0.87056696, 'recall': 0.8653172, 'specificity': 0.8653172, 'f1': 0.86553776, 'auroc': 0.9120904, 'binary_precision': 0.9073427, 'binary_recall': 0.8109375, 'binary_specificity': 0.919697, 'binary_f1_score': 0.8564357}
confusion matrix:
     0    1
0  607   53
1  121  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886463, 'precision': 0.8959013, 'recall': 0.88864625, 'specificity': 0.88864625, 'f1': 0.88813376, 'auroc': 0.9482275, 'binary_precision': 0.94949496, 'binary_recall': 0.8209607, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.88056207}
confusion matrix:
     0    1
0  219   10
1   41  188
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-29 07:33:09.820699,epoch time: 0:01:34.275158,used: 0:21:38.640878,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9860383, 'recall': 0.98551077, 'specificity': 0.98551077, 'f1': 0.98566735, 'auroc': 0.9994645, 'binary_precision': 0.97613066, 'binary_recall': 0.99615383, 'binary_specificity': 0.9748677, 'binary_f1_score': 0.9860406}
confusion matrix:
      0     1
0  1474    38
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.83692306, 'precision': 0.84551656, 'recall': 0.83570075, 'specificity': 0.83570075, 'f1': 0.8355216, 'auroc': 0.89999294, 'binary_precision': 0.8962963, 'binary_recall': 0.75625, 'binary_specificity': 0.91515154, 'binary_f1_score': 0.820339}
confusion matrix:
     0    1
0  604   56
1  156  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8930131, 'precision': 0.9024133, 'recall': 0.8930131, 'specificity': 0.8930131, 'f1': 0.89238465, 'auroc': 0.9567132, 'binary_precision': 0.96391755, 'binary_recall': 0.8165939, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.88416076}
confusion matrix:
     0    1
0  222    7
1   42  187
new oracle model saved
early stop counter: 1
val acc:0.8369230628013611, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 14,now: 2024-07-29 07:34:40.256778,epoch time: 0:01:30.436079,used: 0:23:09.076957,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9799589, 'recall': 0.9797975, 'specificity': 0.9797975, 'f1': 0.97949183, 'auroc': 0.9996918, 'binary_precision': 0.9993329, 'binary_recall': 0.9602564, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9794051}
confusion matrix:
      0     1
0  1511     1
1    62  1498
---- Validation: 
scalar performance:
{'acc': 0.53307694, 'precision': 0.7334639, 'recall': 0.5258286, 'specificity': 0.5258286, 'f1': 0.39387232, 'auroc': 0.9013103, 'binary_precision': 0.9459459, 'binary_recall': 0.0546875, 'binary_specificity': 0.9969697, 'binary_f1_score': 0.10339734}
confusion matrix:
     0   1
0  658   2
1  605  35
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9368051, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  229  0
1  229  0
early stop counter: 2
val acc:0.5330769419670105, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 15,now: 2024-07-29 07:36:05.355528,epoch time: 0:01:25.098750,used: 0:24:34.175707,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912386, 'recall': 0.99118334, 'specificity': 0.99118334, 'f1': 0.9912083, 'auroc': 0.999833, 'binary_precision': 0.9897764, 'binary_recall': 0.9929487, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.99135995}
confusion matrix:
      0     1
0  1496    16
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.8230769, 'precision': 0.84949374, 'recall': 0.8209517, 'specificity': 0.8209517, 'f1': 0.8189617, 'auroc': 0.9153006, 'binary_precision': 0.94181037, 'binary_recall': 0.6828125, 'binary_specificity': 0.9590909, 'binary_f1_score': 0.7916667}
confusion matrix:
     0    1
0  633   27
1  203  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.8681358, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.82512915, 'auroc': 0.94677824, 'binary_precision': 0.9870968, 'binary_recall': 0.6681223, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.796875}
confusion matrix:
     0    1
0  227    2
1   76  153
early stop counter: 3
val acc:0.8230769038200378, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 16,now: 2024-07-29 07:37:37.094529,epoch time: 0:01:31.739001,used: 0:26:05.914708,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9824158, 'recall': 0.9823616, 'specificity': 0.9823616, 'f1': 0.9820963, 'auroc': 0.9996952, 'binary_precision': 0.9993364, 'binary_recall': 0.9653846, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.98206717}
confusion matrix:
      0     1
0  1511     1
1    54  1506
---- Validation: 
scalar performance:
{'acc': 0.63769233, 'precision': 0.7731751, 'recall': 0.63219696, 'specificity': 0.63219696, 'f1': 0.58132505, 'auroc': 0.90307945, 'binary_precision': 0.96174866, 'binary_recall': 0.275, 'binary_specificity': 0.98939395, 'binary_f1_score': 0.42770353}
confusion matrix:
     0    1
0  653    7
1  464  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70305675, 'precision': 0.81369865, 'recall': 0.70305675, 'specificity': 0.70305675, 'f1': 0.67434174, 'auroc': 0.95026314, 'binary_precision': 1.0, 'binary_recall': 0.40611354, 'binary_specificity': 1.0, 'binary_f1_score': 0.57763976}
confusion matrix:
     0   1
0  229   0
1  136  93
early stop counter: 4
val acc:0.6376923322677612, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 17,now: 2024-07-29 07:39:09.551105,epoch time: 0:01:32.456576,used: 0:27:38.371284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.989607, 'recall': 0.9897232, 'specificity': 0.9897232, 'f1': 0.98958284, 'auroc': 0.9995791, 'binary_precision': 0.99869454, 'binary_recall': 0.9807692, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.98965067}
confusion matrix:
      0     1
0  1510     2
1    30  1530
---- Validation: 
scalar performance:
{'acc': 0.7030769, 'precision': 0.7939426, 'recall': 0.69874525, 'specificity': 0.69874525, 'f1': 0.6753364, 'auroc': 0.9035742, 'binary_precision': 0.95357144, 'binary_recall': 0.4171875, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.58043474}
confusion matrix:
     0    1
0  647   13
1  373  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65065503, 'precision': 0.7875314, 'recall': 0.65065503, 'specificity': 0.65065503, 'f1': 0.6034632, 'auroc': 0.94389886, 'binary_precision': 0.9859155, 'binary_recall': 0.30567685, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.46666667}
confusion matrix:
     0   1
0  228   1
1  159  70
early stop counter: 5
val acc:0.7030768990516663, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 18,now: 2024-07-29 07:40:52.162580,epoch time: 0:01:42.611475,used: 0:29:20.982759,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839351, 'recall': 0.983954, 'specificity': 0.983954, 'f1': 0.9837239, 'auroc': 0.9995438, 'binary_precision': 0.998679, 'binary_recall': 0.9692308, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.9837345}
confusion matrix:
      0     1
0  1510     2
1    48  1512
---- Validation: 
scalar performance:
{'acc': 0.70153844, 'precision': 0.7902019, 'recall': 0.6972301, 'specificity': 0.6972301, 'f1': 0.67397404, 'auroc': 0.8879261, 'binary_precision': 0.9468085, 'binary_recall': 0.4171875, 'binary_specificity': 0.97727275, 'binary_f1_score': 0.5791757}
confusion matrix:
     0    1
0  645   15
1  373  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7991266, 'precision': 0.84563184, 'recall': 0.7991266, 'specificity': 0.7991266, 'f1': 0.7921345, 'auroc': 0.93363965, 'binary_precision': 0.9724138, 'binary_recall': 0.6157205, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.7540107}
confusion matrix:
     0    1
0  225    4
1   88  141
early stop counter: 6
val acc:0.7015384435653687, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 19,now: 2024-07-29 07:42:26.170995,epoch time: 0:01:34.008415,used: 0:30:54.991174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921645, 'recall': 0.99227715, 'specificity': 0.99227715, 'f1': 0.9921868, 'auroc': 0.9998181, 'binary_precision': 0.9980545, 'binary_recall': 0.98653847, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9922631}
confusion matrix:
      0     1
0  1509     3
1    21  1539
---- Validation: 
scalar performance:
{'acc': 0.70615387, 'precision': 0.79699457, 'recall': 0.7018466, 'specificity': 0.7018466, 'f1': 0.67901564, 'auroc': 0.9041406, 'binary_precision': 0.9574468, 'binary_recall': 0.421875, 'binary_specificity': 0.9818182, 'binary_f1_score': 0.5856833}
confusion matrix:
     0    1
0  648   12
1  370  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5720524, 'precision': 0.7552178, 'recall': 0.5720524, 'specificity': 0.5720524, 'f1': 0.4784811, 'auroc': 0.94140077, 'binary_precision': 0.9714286, 'binary_recall': 0.14847161, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.25757572}
confusion matrix:
     0   1
0  228   1
1  195  34
early stop counter: 7
val acc:0.7061538696289062, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 20,now: 2024-07-29 07:44:06.700547,epoch time: 0:01:40.529552,used: 0:32:35.520726,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99448156, 'recall': 0.99444956, 'specificity': 0.99444956, 'f1': 0.99446464, 'auroc': 0.99981225, 'binary_precision': 0.99360204, 'binary_recall': 0.99551284, 'binary_specificity': 0.99338627, 'binary_f1_score': 0.99455655}
confusion matrix:
      0     1
0  1502    10
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.69153845, 'precision': 0.78962606, 'recall': 0.68700284, 'specificity': 0.68700284, 'f1': 0.6598127, 'auroc': 0.8951663, 'binary_precision': 0.95437264, 'binary_recall': 0.3921875, 'binary_specificity': 0.9818182, 'binary_f1_score': 0.5559247}
confusion matrix:
     0    1
0  648   12
1  389  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7947598, 'precision': 0.8458286, 'recall': 0.7947598, 'specificity': 0.7947598, 'f1': 0.7868924, 'auroc': 0.9380828, 'binary_precision': 0.9787234, 'binary_recall': 0.60262007, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.745946}
confusion matrix:
     0    1
0  226    3
1   91  138
early stop counter: 8
val acc:0.6915384531021118, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 21,now: 2024-07-29 07:45:45.693721,epoch time: 0:01:38.993174,used: 0:34:14.513900,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98772097, 'recall': 0.9878104, 'specificity': 0.9878104, 'f1': 0.98763, 'auroc': 0.9997922, 'binary_precision': 0.9993438, 'binary_recall': 0.97628206, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.98767835}
confusion matrix:
      0     1
0  1511     1
1    37  1523
---- Validation: 
scalar performance:
{'acc': 0.6930769, 'precision': 0.7953056, 'recall': 0.6884943, 'specificity': 0.6884943, 'f1': 0.66080284, 'auroc': 0.91057706, 'binary_precision': 0.96525097, 'binary_recall': 0.390625, 'binary_specificity': 0.98636365, 'binary_f1_score': 0.55617356}
confusion matrix:
     0    1
0  651    9
1  390  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6572052, 'precision': 0.7966321, 'recall': 0.6572052, 'specificity': 0.6572052, 'f1': 0.6115604, 'auroc': 0.94771266, 'binary_precision': 1.0, 'binary_recall': 0.31441048, 'binary_specificity': 1.0, 'binary_f1_score': 0.47840533}
confusion matrix:
     0   1
0  229   0
1  157  72
early stop counter: 9
val acc:0.6930769085884094, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 22,now: 2024-07-29 07:47:17.458329,epoch time: 0:01:31.764608,used: 0:35:46.278508,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918471, 'recall': 0.9918753, 'specificity': 0.9918753, 'f1': 0.9918603, 'auroc': 0.99979055, 'binary_precision': 0.9929351, 'binary_recall': 0.9910256, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.9919795}
confusion matrix:
      0     1
0  1501    11
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.80846155, 'precision': 0.8364328, 'recall': 0.8062263, 'specificity': 0.8062263, 'f1': 0.80357707, 'auroc': 0.91240525, 'binary_precision': 0.92967033, 'binary_recall': 0.6609375, 'binary_specificity': 0.95151514, 'binary_f1_score': 0.7726027}
confusion matrix:
     0    1
0  628   32
1  217  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.88463247, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.86043274, 'auroc': 0.93623304, 'binary_precision': 0.9770115, 'binary_recall': 0.7423581, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.84367245}
confusion matrix:
     0    1
0  225    4
1   59  170
early stop counter: 10
val acc:0.8084615468978882, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 23,now: 2024-07-29 07:48:54.151362,epoch time: 0:01:36.693033,used: 0:37:22.971541,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9890039, 'recall': 0.9891026, 'specificity': 0.9891026, 'f1': 0.988932, 'auroc': 0.9998927, 'binary_precision': 1.0, 'binary_recall': 0.97820514, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889825}
confusion matrix:
      0     1
0  1512     0
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.69, 'precision': 0.79730463, 'recall': 0.685322, 'specificity': 0.685322, 'f1': 0.65594447, 'auroc': 0.91924775, 'binary_precision': 0.9721116, 'binary_recall': 0.38125, 'binary_specificity': 0.98939395, 'binary_f1_score': 0.5476992}
confusion matrix:
     0    1
0  653    7
1  396  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53930134, 'precision': 0.76022726, 'recall': 0.53930134, 'specificity': 0.53930134, 'f1': 0.41517642, 'auroc': 0.932281, 'binary_precision': 1.0, 'binary_recall': 0.07860262, 'binary_specificity': 1.0, 'binary_f1_score': 0.14574897}
confusion matrix:
     0   1
0  229   0
1  211  18
early stop counter: 11
val acc:0.6899999976158142, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 24,now: 2024-07-29 07:50:33.933904,epoch time: 0:01:39.782542,used: 0:39:02.754083,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99482787, 'recall': 0.9947599, 'specificity': 0.9947599, 'f1': 0.9947901, 'auroc': 0.99976087, 'binary_precision': 0.9929757, 'binary_recall': 0.9967949, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.99488163}
confusion matrix:
      0     1
0  1501    11
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.77076924, 'precision': 0.80641234, 'recall': 0.76811075, 'specificity': 0.76811075, 'f1': 0.76268065, 'auroc': 0.8854166, 'binary_precision': 0.9071429, 'binary_recall': 0.5953125, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.7188679}
confusion matrix:
     0    1
0  621   39
1  259  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8882148, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.86012423, 'auroc': 0.94183934, 'binary_precision': 0.9882353, 'binary_recall': 0.73362446, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.8421053}
confusion matrix:
     0    1
0  227    2
1   61  168
early stop counter: 12
val acc:0.7707692384719849, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 25,now: 2024-07-29 07:52:05.833405,epoch time: 0:01:31.899501,used: 0:40:34.653584,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98547417, 'recall': 0.9855464, 'specificity': 0.9855464, 'f1': 0.98535144, 'auroc': 0.9996731, 'binary_precision': 0.9980276, 'binary_recall': 0.97307694, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.98539436}
confusion matrix:
      0     1
0  1509     3
1    42  1518
---- Validation: 
scalar performance:
{'acc': 0.56461537, 'precision': 0.7449037, 'recall': 0.5579072, 'specificity': 0.5579072, 'f1': 0.45734102, 'auroc': 0.89322853, 'binary_precision': 0.9512195, 'binary_recall': 0.121875, 'binary_specificity': 0.9939394, 'binary_f1_score': 0.2160665}
confusion matrix:
     0   1
0  656   4
1  562  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.510917, 'precision': 0.75275934, 'recall': 0.510917, 'specificity': 0.510917, 'f1': 0.35714465, 'auroc': 0.92952085, 'binary_precision': 1.0, 'binary_recall': 0.02183406, 'binary_specificity': 1.0, 'binary_f1_score': 0.042735044}
confusion matrix:
     0  1
0  229  0
1  224  5
early stop counter: 13
val acc:0.5646153688430786, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 26,now: 2024-07-29 07:53:43.862471,epoch time: 0:01:38.029066,used: 0:42:12.682650,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98629785, 'recall': 0.98639596, 'specificity': 0.98639596, 'f1': 0.98632646, 'auroc': 0.99924326, 'binary_precision': 0.9909444, 'binary_recall': 0.98205125, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.9864778}
confusion matrix:
      0     1
0  1498    14
1    28  1532
---- Validation: 
scalar performance:
{'acc': 0.82153845, 'precision': 0.8424251, 'recall': 0.819626, 'specificity': 0.819626, 'f1': 0.8181287, 'auroc': 0.91565514, 'binary_precision': 0.9232365, 'binary_recall': 0.6953125, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.79322636}
confusion matrix:
     0    1
0  623   37
1  195  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8253275, 'precision': 0.8547988, 'recall': 0.8253275, 'specificity': 0.8253275, 'f1': 0.8216233, 'auroc': 0.9260311, 'binary_precision': 0.9570552, 'binary_recall': 0.68122274, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.79591835}
confusion matrix:
     0    1
0  222    7
1   73  156
early stop counter: 14
val acc:0.8215384483337402, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 27,now: 2024-07-29 07:55:22.936994,epoch time: 0:01:39.074523,used: 0:43:51.757173,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98214287, 'recall': 0.98205125, 'specificity': 0.98205125, 'f1': 0.98177075, 'auroc': 0.999066, 'binary_precision': 1.0, 'binary_recall': 0.96410257, 'binary_specificity': 1.0, 'binary_f1_score': 0.98172325}
confusion matrix:
      0     1
0  1512     0
1    56  1504
---- Validation: 
scalar performance:
{'acc': 0.72, 'precision': 0.80539596, 'recall': 0.7158854, 'specificity': 0.7158854, 'f1': 0.6964636, 'auroc': 0.9097053, 'binary_precision': 0.96308726, 'binary_recall': 0.4484375, 'binary_specificity': 0.98333335, 'binary_f1_score': 0.6119403}
confusion matrix:
     0    1
0  649   11
1  353  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6419214, 'precision': 0.77728105, 'recall': 0.6419214, 'specificity': 0.6419214, 'f1': 0.59214616, 'auroc': 0.9175979, 'binary_precision': 0.9710145, 'binary_recall': 0.29257643, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.44966447}
confusion matrix:
     0   1
0  227   2
1  162  67
early stop counter: 15
val acc:0.7200000286102295, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 28,now: 2024-07-29 07:56:53.497368,epoch time: 0:01:30.560374,used: 0:45:22.317547,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.985684, 'recall': 0.9856634, 'specificity': 0.9856634, 'f1': 0.9856733, 'auroc': 0.99947476, 'binary_precision': 0.98527527, 'binary_recall': 0.98653847, 'binary_specificity': 0.98478836, 'binary_f1_score': 0.98590654}
confusion matrix:
      0     1
0  1489    23
1    21  1539
---- Validation: 
scalar performance:
{'acc': 0.8161538, 'precision': 0.842909, 'recall': 0.8139914, 'specificity': 0.8139914, 'f1': 0.81174254, 'auroc': 0.9121988, 'binary_precision': 0.93492407, 'binary_recall': 0.6734375, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.78292465}
confusion matrix:
     0    1
0  630   30
1  209  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.8604852, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.83096343, 'auroc': 0.9176932, 'binary_precision': 0.9580838, 'binary_recall': 0.69868994, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.80808073}
confusion matrix:
     0    1
0  222    7
1   69  160
early stop counter: 16
val acc:0.8161538243293762, best validation acc: 0.8661538362503052, corresponding to test acc:                         0.8886463046073914 / 0.8930131196975708
after epoch: 29,now: 2024-07-29 07:58:30.966322,epoch time: 0:01:37.468954,used: 0:46:59.786501,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98718214, 'recall': 0.9868641, 'specificity': 0.9868641, 'f1': 0.9869724, 'auroc': 0.9995252, 'binary_precision': 0.98040456, 'binary_recall': 0.99423075, 'binary_specificity': 0.9794974, 'binary_f1_score': 0.9872692}
confusion matrix:
      0     1
0  1481    31
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.8761538, 'precision': 0.8791764, 'recall': 0.8754735, 'specificity': 0.8754735, 'f1': 0.8757403, 'auroc': 0.9266193, 'binary_precision': 0.9094017, 'binary_recall': 0.83125, 'binary_specificity': 0.919697, 'binary_f1_score': 0.86857146}
confusion matrix:
     0    1
0  607   53
1  108  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88646287, 'precision': 0.89625573, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8857571, 'auroc': 0.9516027, 'binary_precision': 0.9585492, 'binary_recall': 0.80786026, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8767773}
confusion matrix:
     0    1
0  221    8
1   44  185
better model found
persisted
after epoch: 30,now: 2024-07-29 08:00:08.032469,epoch time: 0:01:37.066147,used: 0:48:36.852648,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_31_seed_7_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:36.852648 at 2024-07-29 08:00:08.032469
persisted model performance metric: 

scalar performance:
{'acc': 0.88646287, 'precision': 0.89625573, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8857571, 'auroc': 0.9516027, 'binary_precision': 0.9585492, 'binary_recall': 0.80786026, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8767773}
confusion matrix:
     0    1
0  221    8
1   44  185
oracle model performance metric: 

scalar performance:
{'acc': 0.8930131, 'precision': 0.9024133, 'recall': 0.8930131, 'specificity': 0.8930131, 'f1': 0.89238465, 'auroc': 0.9567132, 'binary_precision': 0.96391755, 'binary_recall': 0.8165939, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.88416076}
confusion matrix:
     0    1
0  222    7
1   42  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456214 KiB |  13219 MiB | 588547 GiB | 588546 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 581586 GiB | 581585 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456214 KiB |  13219 MiB | 588547 GiB | 588546 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 581586 GiB | 581585 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 587085 GiB | 587084 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB | 109534 MiB |  95058 MiB |
|       from large pool |  14410 MiB |  14422 MiB | 109356 MiB |  94946 MiB |
|       from small pool |     66 MiB |     70 MiB |    178 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475625 KiB |   1260 MiB | 421519 GiB | 421518 GiB |
|       from large pool | 462976 KiB |   1252 MiB | 414514 GiB | 414514 GiB |
|       from small pool |  12649 KiB |     45 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103447 K  |  103446 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50907 K  |   50906 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103447 K  |  103446 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50907 K  |   50906 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4637    |    4002    |
|       from large pool |     602    |     602    |    4548    |    3946    |
|       from small pool |      33    |      35    |      89    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     655    |   68522 K  |   68522 K  |
|       from large pool |      38    |     604    |   38659 K  |   38659 K  |
|       from small pool |      62    |     237    |   29862 K  |   29862 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 588547 GiB | 588547 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 581586 GiB | 581586 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 588547 GiB | 588547 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 581586 GiB | 581586 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587085 GiB | 587085 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 109534 MiB | 108624 MiB |
|       from large pool |    858 MiB |  14422 MiB | 109356 MiB | 108498 MiB |
|       from small pool |     52 MiB |     70 MiB |    178 MiB |    126 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 421519 GiB | 421519 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 414515 GiB | 414515 GiB |
|       from small pool |      0 KiB |     45 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103447 K  |  103447 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103447 K  |  103447 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    4637    |    4572    |
|       from large pool |      39    |     602    |    4548    |    4509    |
|       from small pool |      26    |      35    |      89    |      63    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   68522 K  |   68522 K  |
|       from large pool |       3    |     604    |   38659 K  |   38659 K  |
|       from small pool |       0    |     237    |   29863 K  |   29863 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 588547 GiB | 588547 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 581586 GiB | 581586 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 588547 GiB | 588547 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 581586 GiB | 581586 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587085 GiB | 587085 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 109534 MiB | 108624 MiB |
|       from large pool |    858 MiB |  14422 MiB | 109356 MiB | 108498 MiB |
|       from small pool |     52 MiB |     70 MiB |    178 MiB |    126 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 421519 GiB | 421519 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 414515 GiB | 414515 GiB |
|       from small pool |      0 KiB |     45 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103447 K  |  103447 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103447 K  |  103447 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    4637    |    4572    |
|       from large pool |      39    |     602    |    4548    |    4509    |
|       from small pool |      26    |      35    |      89    |      63    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   68522 K  |   68522 K  |
|       from large pool |       3    |     604    |   38659 K  |   38659 K  |
|       from small pool |       0    |     237    |   29863 K  |   29863 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369

 Experiment start at: 2024-07-29 08:00:52.307446
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94210523, 'precision': 0.94560355, 'recall': 0.9425906, 'specificity': 0.9425906, 'f1': 0.94202936, 'auroc': 0.99077237, 'binary_precision': 0.9878049, 'binary_recall': 0.8964844, 'binary_specificity': 0.9886968, 'binary_f1_score': 0.93993175}
confusion matrix:
      0     1
0  1487    17
1   159  1377
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7269915, 'precision': 0.77504396, 'recall': 0.72011316, 'specificity': 0.72011316, 'f1': 0.7103416, 'auroc': 0.8775333, 'binary_precision': 0.88235295, 'binary_recall': 0.50319487, 'binary_specificity': 0.9370315, 'binary_f1_score': 0.6408952}
confusion matrix:
     0    1
0  625   42
1  311  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79587156, 'precision': 0.82673407, 'recall': 0.79587156, 'specificity': 0.79587156, 'f1': 0.79093456, 'auroc': 0.914822, 'binary_precision': 0.92715234, 'binary_recall': 0.64220184, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.7588076}
confusion matrix:
     0    1
0  207   11
1   78  140
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:02:29.629635,epoch time: 0:01:37.322189,used: 0:01:37.322189,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9651316, 'precision': 0.96580774, 'recall': 0.9649205, 'specificity': 0.9649205, 'f1': 0.9651023, 'auroc': 0.9964715, 'binary_precision': 0.95091254, 'binary_recall': 0.9818064, 'binary_specificity': 0.94803464, 'binary_f1_score': 0.9661125}
confusion matrix:
      0     1
0  1423    78
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.8190255, 'precision': 0.82853645, 'recall': 0.82169104, 'specificity': 0.82169104, 'f1': 0.81841457, 'auroc': 0.91234416, 'binary_precision': 0.7641509, 'binary_recall': 0.9057508, 'binary_specificity': 0.7376312, 'binary_f1_score': 0.82894737}
confusion matrix:
     0    1
0  492  175
1   59  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.8075087, 'recall': 0.7981651, 'specificity': 0.7981651, 'f1': 0.79662025, 'auroc': 0.9098771, 'binary_precision': 0.75390625, 'binary_recall': 0.8853211, 'binary_specificity': 0.71100914, 'binary_f1_score': 0.81434596}
confusion matrix:
     0    1
0  155   63
1   25  193
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 08:04:07.923063,epoch time: 0:01:38.293428,used: 0:03:15.615617,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.97465307, 'recall': 0.9746948, 'specificity': 0.9746948, 'f1': 0.97466874, 'auroc': 0.9977399, 'binary_precision': 0.9771391, 'binary_recall': 0.97269183, 'binary_specificity': 0.97669774, 'binary_f1_score': 0.9749104}
confusion matrix:
      0     1
0  1467    35
1    42  1496
---- Validation: 
scalar performance:
{'acc': 0.8097448, 'precision': 0.81386244, 'recall': 0.8115172, 'specificity': 0.8115172, 'f1': 0.8095715, 'auroc': 0.8702215, 'binary_precision': 0.7691218, 'binary_recall': 0.86741215, 'binary_specificity': 0.7556222, 'binary_f1_score': 0.8153153}
confusion matrix:
     0    1
0  504  163
1   83  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7844037, 'precision': 0.80156183, 'recall': 0.7844037, 'specificity': 0.7844037, 'f1': 0.7812927, 'auroc': 0.8844163, 'binary_precision': 0.72962964, 'binary_recall': 0.9036697, 'binary_specificity': 0.6651376, 'binary_f1_score': 0.80737704}
confusion matrix:
     0    1
0  145   73
1   21  197
early stop counter: 1
val acc:0.8097447752952576, best validation acc: 0.8190255165100098, corresponding to test acc:                         0.7981651425361633 / 0.7981651425361633
after epoch: 3,now: 2024-07-29 08:05:47.942700,epoch time: 0:01:40.019637,used: 0:04:55.635254,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.98623437, 'recall': 0.9862782, 'specificity': 0.9862782, 'f1': 0.9861841, 'auroc': 0.9986272, 'binary_precision': 0.9947055, 'binary_recall': 0.977879, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.9862205}
confusion matrix:
      0     1
0  1495     8
1    34  1503
---- Validation: 
scalar performance:
{'acc': 0.8089714, 'precision': 0.83000946, 'recall': 0.8048759, 'specificity': 0.8048759, 'f1': 0.80428886, 'auroc': 0.9080787, 'binary_precision': 0.90578157, 'binary_recall': 0.67571884, 'binary_specificity': 0.934033, 'binary_f1_score': 0.7740165}
confusion matrix:
     0    1
0  623   44
1  203  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8348187, 'recall': 0.82568806, 'specificity': 0.82568806, 'f1': 0.8244915, 'auroc': 0.90585804, 'binary_precision': 0.8901099, 'binary_recall': 0.74311924, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.80999994}
confusion matrix:
     0    1
0  198   20
1   56  162
new oracle model saved
early stop counter: 2
val acc:0.8089714050292969, best validation acc: 0.8190255165100098, corresponding to test acc:                         0.7981651425361633 / 0.8256880640983582
after epoch: 4,now: 2024-07-29 08:07:13.495031,epoch time: 0:01:25.552331,used: 0:06:21.187585,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96842104, 'precision': 0.96975553, 'recall': 0.9687673, 'specificity': 0.9687673, 'f1': 0.9684111, 'auroc': 0.9993377, 'binary_precision': 0.9979282, 'binary_recall': 0.93953186, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.96784997}
confusion matrix:
      0     1
0  1499     3
1    93  1445
---- Validation: 
scalar performance:
{'acc': 0.55993813, 'precision': 0.7461092, 'recall': 0.54567444, 'specificity': 0.54567444, 'f1': 0.4371091, 'auroc': 0.90168655, 'binary_precision': 0.95238096, 'binary_recall': 0.095846646, 'binary_specificity': 0.99550223, 'binary_f1_score': 0.17416546}
confusion matrix:
     0   1
0  664   3
1  566  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5986239, 'precision': 0.73870635, 'recall': 0.5986239, 'specificity': 0.5986239, 'f1': 0.5296134, 'auroc': 0.89420086, 'binary_precision': 0.92156863, 'binary_recall': 0.21559633, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.3494424}
confusion matrix:
     0   1
0  214   4
1  171  47
early stop counter: 3
val acc:0.5599381327629089, best validation acc: 0.8190255165100098, corresponding to test acc:                         0.7981651425361633 / 0.8256880640983582
after epoch: 5,now: 2024-07-29 08:08:47.459800,epoch time: 0:01:33.964769,used: 0:07:55.152354,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9874865, 'recall': 0.9875194, 'specificity': 0.9875194, 'f1': 0.9874991, 'auroc': 0.9992671, 'binary_precision': 0.9895425, 'binary_recall': 0.98567706, 'binary_specificity': 0.9893617, 'binary_f1_score': 0.98760605}
confusion matrix:
      0     1
0  1488    16
1    22  1514
---- Validation: 
scalar performance:
{'acc': 0.82675946, 'precision': 0.8461406, 'recall': 0.8229519, 'specificity': 0.8229519, 'f1': 0.8229772, 'auroc': 0.9204726, 'binary_precision': 0.92050207, 'binary_recall': 0.7028754, 'binary_specificity': 0.9430285, 'binary_f1_score': 0.79710144}
confusion matrix:
     0    1
0  629   38
1  186  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68119264, 'precision': 0.76581264, 'recall': 0.68119264, 'specificity': 0.68119264, 'f1': 0.6536261, 'auroc': 0.90038717, 'binary_precision': 0.9157895, 'binary_recall': 0.39908257, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.5559106}
confusion matrix:
     0   1
0  210   8
1  131  87
better model found
persisted
after epoch: 6,now: 2024-07-29 08:10:24.028527,epoch time: 0:01:36.568727,used: 0:09:31.721081,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.9846256, 'recall': 0.9846581, 'specificity': 0.9846581, 'f1': 0.9845394, 'auroc': 0.999123, 'binary_precision': 0.99469143, 'binary_recall': 0.9746424, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.9845648}
confusion matrix:
      0     1
0  1494     8
1    39  1499
---- Validation: 
scalar performance:
{'acc': 0.7478732, 'precision': 0.78153783, 'recall': 0.7421696, 'specificity': 0.7421696, 'f1': 0.7369918, 'auroc': 0.8824909, 'binary_precision': 0.8712871, 'binary_recall': 0.5623003, 'binary_specificity': 0.922039, 'binary_f1_score': 0.68349516}
confusion matrix:
     0    1
0  615   52
1  274  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.8599286, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.8371328, 'auroc': 0.92553234, 'binary_precision': 0.94578314, 'binary_recall': 0.7201835, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.8177083}
confusion matrix:
     0    1
0  209    9
1   61  157
new oracle model saved
early stop counter: 1
val acc:0.7478731870651245, best validation acc: 0.8267594575881958, corresponding to test acc:                         0.6811926364898682 / 0.8394495248794556
after epoch: 7,now: 2024-07-29 08:11:58.197879,epoch time: 0:01:34.169352,used: 0:11:05.890433,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.98685503, 'recall': 0.98691404, 'specificity': 0.98691404, 'f1': 0.9868418, 'auroc': 0.9992957, 'binary_precision': 0.993408, 'binary_recall': 0.98048145, 'binary_specificity': 0.99334663, 'binary_f1_score': 0.9869024}
confusion matrix:
      0     1
0  1493    10
1    30  1507
---- Validation: 
scalar performance:
{'acc': 0.8576953, 'precision': 0.8592018, 'recall': 0.85661924, 'specificity': 0.85661924, 'f1': 0.8571621, 'auroc': 0.9214642, 'binary_precision': 0.8758503, 'binary_recall': 0.8226837, 'binary_specificity': 0.8905547, 'binary_f1_score': 0.8484349}
confusion matrix:
     0    1
0  594   73
1  111  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463303, 'precision': 0.85256946, 'recall': 0.8463303, 'specificity': 0.8463303, 'f1': 0.84564745, 'auroc': 0.90996134, 'binary_precision': 0.8994709, 'binary_recall': 0.7798165, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.83538085}
confusion matrix:
     0    1
0  199   19
1   48  170
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-29 08:13:33.391183,epoch time: 0:01:35.193304,used: 0:12:41.083737,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.97604966, 'recall': 0.9756088, 'specificity': 0.9756088, 'f1': 0.97532636, 'auroc': 0.99924934, 'binary_precision': 0.9979592, 'binary_recall': 0.9532164, 'binary_specificity': 0.99800134, 'binary_f1_score': 0.97507477}
confusion matrix:
      0     1
0  1498     3
1    72  1467
---- Validation: 
scalar performance:
{'acc': 0.6450116, 'precision': 0.77991885, 'recall': 0.6336812, 'specificity': 0.6336812, 'f1': 0.58604664, 'auroc': 0.9166162, 'binary_precision': 0.96648043, 'binary_recall': 0.27635783, 'binary_specificity': 0.9910045, 'binary_f1_score': 0.42981365}
confusion matrix:
     0    1
0  661    6
1  453  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64220184, 'precision': 0.7914438, 'recall': 0.64220184, 'specificity': 0.64220184, 'f1': 0.58967185, 'auroc': 0.9346225, 'binary_precision': 1.0, 'binary_recall': 0.28440368, 'binary_specificity': 1.0, 'binary_f1_score': 0.44285715}
confusion matrix:
     0   1
0  218   0
1  156  62
early stop counter: 1
val acc:0.6450116038322449, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8463302850723267 / 0.8463302850723267
after epoch: 9,now: 2024-07-29 08:15:11.831836,epoch time: 0:01:38.440653,used: 0:14:19.524390,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9884776, 'recall': 0.98849595, 'specificity': 0.98849595, 'f1': 0.98848575, 'auroc': 0.99940264, 'binary_precision': 0.9895629, 'binary_recall': 0.9876302, 'binary_specificity': 0.9893617, 'binary_f1_score': 0.9885956}
confusion matrix:
      0     1
0  1488    16
1    19  1517
---- Validation: 
scalar performance:
{'acc': 0.79891723, 'precision': 0.8292812, 'recall': 0.7940016, 'specificity': 0.7940016, 'f1': 0.7921685, 'auroc': 0.92160547, 'binary_precision': 0.921659, 'binary_recall': 0.63897765, 'binary_specificity': 0.9490255, 'binary_f1_score': 0.75471705}
confusion matrix:
     0    1
0  633   34
1  226  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79587156, 'precision': 0.82673407, 'recall': 0.79587156, 'specificity': 0.79587156, 'f1': 0.79093456, 'auroc': 0.89910364, 'binary_precision': 0.92715234, 'binary_recall': 0.64220184, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.7588076}
confusion matrix:
     0    1
0  207   11
1   78  140
early stop counter: 2
val acc:0.7989172339439392, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8463302850723267 / 0.8463302850723267
after epoch: 10,now: 2024-07-29 08:16:50.389238,epoch time: 0:01:38.557402,used: 0:15:58.081792,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.97899354, 'recall': 0.97879267, 'specificity': 0.97879267, 'f1': 0.97861755, 'auroc': 0.9989451, 'binary_precision': 0.99528617, 'binary_recall': 0.96223956, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.9784839}
confusion matrix:
      0     1
0  1497     7
1    58  1478
---- Validation: 
scalar performance:
{'acc': 0.8128384, 'precision': 0.84416246, 'recall': 0.8079858, 'specificity': 0.8079858, 'f1': 0.8066677, 'auroc': 0.93539095, 'binary_precision': 0.940367, 'binary_recall': 0.65495205, 'binary_specificity': 0.9610195, 'binary_f1_score': 0.77212805}
confusion matrix:
     0    1
0  641   26
1  216  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.86189723, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.83432436, 'auroc': 0.93613756, 'binary_precision': 0.95652175, 'binary_recall': 0.70642203, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.8126649}
confusion matrix:
     0    1
0  211    7
1   64  154
early stop counter: 3
val acc:0.8128383755683899, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8463302850723267 / 0.8463302850723267
after epoch: 11,now: 2024-07-29 08:18:31.805311,epoch time: 0:01:41.416073,used: 0:17:39.497865,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.98798704, 'recall': 0.98796356, 'specificity': 0.98796356, 'f1': 0.9878289, 'auroc': 0.99969095, 'binary_precision': 1.0, 'binary_recall': 0.9759271, 'binary_specificity': 1.0, 'binary_f1_score': 0.98781693}
confusion matrix:
      0     1
0  1503     0
1    37  1500
---- Validation: 
scalar performance:
{'acc': 0.66898686, 'precision': 0.7714262, 'recall': 0.6589325, 'specificity': 0.6589325, 'f1': 0.6263006, 'auroc': 0.9159893, 'binary_precision': 0.93043476, 'binary_recall': 0.34185302, 'binary_specificity': 0.976012, 'binary_f1_score': 0.49999994}
confusion matrix:
     0    1
0  651   16
1  412  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69495416, 'precision': 0.77382886, 'recall': 0.6949541, 'specificity': 0.6949541, 'f1': 0.6712829, 'auroc': 0.89232814, 'binary_precision': 0.9207921, 'binary_recall': 0.4266055, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.5830721}
confusion matrix:
     0   1
0  210   8
1  125  93
early stop counter: 4
val acc:0.6689868569374084, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8463302850723267 / 0.8463302850723267
after epoch: 12,now: 2024-07-29 08:20:08.573571,epoch time: 0:01:36.768260,used: 0:19:16.266125,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.9803712, 'recall': 0.97942793, 'specificity': 0.97942793, 'f1': 0.9795897, 'auroc': 0.999394, 'binary_precision': 0.96349907, 'binary_recall': 0.99739414, 'binary_specificity': 0.9614618, 'binary_f1_score': 0.9801537}
confusion matrix:
      0     1
0  1447    58
1     4  1531
---- Validation: 
scalar performance:
{'acc': 0.7594741, 'precision': 0.75934887, 'recall': 0.75891286, 'specificity': 0.75891286, 'f1': 0.7590538, 'auroc': 0.8400017, 'binary_precision': 0.7569331, 'binary_recall': 0.74121404, 'binary_specificity': 0.7766117, 'binary_f1_score': 0.74899113}
confusion matrix:
     0    1
0  518  149
1  162  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76376146, 'precision': 0.7950592, 'recall': 0.7637615, 'specificity': 0.7637615, 'f1': 0.7573262, 'auroc': 0.87147546, 'binary_precision': 0.6989619, 'binary_recall': 0.9266055, 'binary_specificity': 0.60091746, 'binary_f1_score': 0.7968442}
confusion matrix:
     0    1
0  131   87
1   16  202
early stop counter: 5
val acc:0.7594740986824036, best validation acc: 0.8576952815055847, corresponding to test acc:                         0.8463302850723267 / 0.8463302850723267
after epoch: 13,now: 2024-07-29 08:21:47.387024,epoch time: 0:01:38.813453,used: 0:20:55.079578,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98834026, 'recall': 0.9880705, 'specificity': 0.9880705, 'f1': 0.9881536, 'auroc': 0.99972856, 'binary_precision': 0.98141026, 'binary_recall': 0.99544865, 'binary_specificity': 0.9806924, 'binary_f1_score': 0.9883796}
confusion matrix:
      0     1
0  1473    29
1     7  1531
---- Validation: 
scalar performance:
{'acc': 0.8723898, 'precision': 0.8736365, 'recall': 0.87145126, 'specificity': 0.87145126, 'f1': 0.8719704, 'auroc': 0.9255021, 'binary_precision': 0.8887015, 'binary_recall': 0.841853, 'binary_specificity': 0.9010495, 'binary_f1_score': 0.86464316}
confusion matrix:
     0    1
0  601   66
1   99  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8715596, 'precision': 0.87873197, 'recall': 0.8715596, 'specificity': 0.8715596, 'f1': 0.8709487, 'auroc': 0.93569565, 'binary_precision': 0.93085104, 'binary_recall': 0.8027523, 'binary_specificity': 0.940367, 'binary_f1_score': 0.86206895}
confusion matrix:
     0    1
0  205   13
1   43  175
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-29 08:23:26.457887,epoch time: 0:01:39.070863,used: 0:22:34.150441,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98059213, 'precision': 0.98071116, 'recall': 0.98073304, 'specificity': 0.98073304, 'f1': 0.9805921, 'auroc': 0.99911046, 'binary_precision': 0.99202126, 'binary_recall': 0.96946067, 'binary_specificity': 0.99200535, 'binary_f1_score': 0.9806112}
confusion matrix:
      0     1
0  1489    12
1    47  1492
---- Validation: 
scalar performance:
{'acc': 0.6133024, 'precision': 0.76770234, 'recall': 0.60088444, 'specificity': 0.60088444, 'f1': 0.53485465, 'auroc': 0.90820026, 'binary_precision': 0.9632353, 'binary_recall': 0.20926517, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.34383202}
confusion matrix:
     0    1
0  662    5
1  495  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7270642, 'precision': 0.8146156, 'recall': 0.72706425, 'specificity': 0.72706425, 'f1': 0.7066562, 'auroc': 0.9262899, 'binary_precision': 0.98058254, 'binary_recall': 0.46330276, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.6292835}
confusion matrix:
     0    1
0  216    2
1  117  101
early stop counter: 1
val acc:0.6133024096488953, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 15,now: 2024-07-29 08:25:05.344338,epoch time: 0:01:38.886451,used: 0:24:13.036892,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.9898323, 'recall': 0.989886, 'specificity': 0.989886, 'f1': 0.9898025, 'auroc': 0.9994792, 'binary_precision': 0.99735796, 'binary_recall': 0.9824333, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.98983943}
confusion matrix:
      0     1
0  1499     4
1    27  1510
---- Validation: 
scalar performance:
{'acc': 0.6883217, 'precision': 0.788806, 'recall': 0.67870414, 'specificity': 0.67870414, 'f1': 0.65155685, 'auroc': 0.91460085, 'binary_precision': 0.951417, 'binary_recall': 0.37539935, 'binary_specificity': 0.982009, 'binary_f1_score': 0.5383735}
confusion matrix:
     0    1
0  655   12
1  391  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.85312, 'recall': 0.79816514, 'specificity': 0.79816514, 'f1': 0.7899945, 'auroc': 0.9278891, 'binary_precision': 0.99242425, 'binary_recall': 0.60091746, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.7485714}
confusion matrix:
     0    1
0  217    1
1   87  131
early stop counter: 2
val acc:0.6883217096328735, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 16,now: 2024-07-29 08:26:51.071679,epoch time: 0:01:45.727341,used: 0:25:58.764233,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.98356587, 'recall': 0.9833915, 'specificity': 0.9833915, 'f1': 0.98322314, 'auroc': 0.999623, 'binary_precision': 0.9993275, 'binary_recall': 0.96744794, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.9831293}
confusion matrix:
      0     1
0  1503     1
1    50  1486
---- Validation: 
scalar performance:
{'acc': 0.72389793, 'precision': 0.7951585, 'recall': 0.71588725, 'specificity': 0.71588725, 'f1': 0.701251, 'auroc': 0.9032768, 'binary_precision': 0.93247586, 'binary_recall': 0.46325877, 'binary_specificity': 0.96851575, 'binary_f1_score': 0.6189968}
confusion matrix:
     0    1
0  646   21
1  336  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74311924, 'precision': 0.8183973, 'recall': 0.74311924, 'specificity': 0.74311924, 'f1': 0.726982, 'auroc': 0.91015065, 'binary_precision': 0.97321427, 'binary_recall': 0.5, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.6606061}
confusion matrix:
     0    1
0  215    3
1  109  109
early stop counter: 3
val acc:0.7238979339599609, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 17,now: 2024-07-29 08:28:30.736437,epoch time: 0:01:39.664758,used: 0:27:38.428991,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.99342453, 'recall': 0.99347234, 'specificity': 0.99347234, 'f1': 0.9934209, 'auroc': 0.9996983, 'binary_precision': 0.99868333, 'binary_recall': 0.9882736, 'binary_specificity': 0.9986711, 'binary_f1_score': 0.9934512}
confusion matrix:
      0     1
0  1503     2
1    18  1517
---- Validation: 
scalar performance:
{'acc': 0.8012374, 'precision': 0.8294888, 'recall': 0.7964959, 'specificity': 0.7964959, 'f1': 0.79497373, 'auroc': 0.9067351, 'binary_precision': 0.9183673, 'binary_recall': 0.64696485, 'binary_specificity': 0.946027, 'binary_f1_score': 0.75913775}
confusion matrix:
     0    1
0  631   36
1  221  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7821101, 'precision': 0.8247584, 'recall': 0.7821101, 'specificity': 0.7821101, 'f1': 0.77471375, 'auroc': 0.8967048, 'binary_precision': 0.94244605, 'binary_recall': 0.60091746, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.7338936}
confusion matrix:
     0    1
0  210    8
1   87  131
early stop counter: 4
val acc:0.8012374043464661, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 18,now: 2024-07-29 08:30:05.626056,epoch time: 0:01:34.889619,used: 0:29:13.318610,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9802632, 'precision': 0.98072314, 'recall': 0.9804667, 'specificity': 0.9804667, 'f1': 0.98026216, 'auroc': 0.9996178, 'binary_precision': 0.99864954, 'binary_recall': 0.9622642, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.98011935}
confusion matrix:
      0     1
0  1501     2
1    58  1479
---- Validation: 
scalar performance:
{'acc': 0.5684455, 'precision': 0.7202511, 'recall': 0.554755, 'specificity': 0.554755, 'f1': 0.45926666, 'auroc': 0.8773297, 'binary_precision': 0.89534885, 'binary_recall': 0.12300319, 'binary_specificity': 0.98650676, 'binary_f1_score': 0.21629213}
confusion matrix:
     0   1
0  658   9
1  549  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51376146, 'precision': 0.6285378, 'recall': 0.51376146, 'specificity': 0.51376146, 'f1': 0.37402144, 'auroc': 0.89289623, 'binary_precision': 0.75, 'binary_recall': 0.041284405, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.078260876}
confusion matrix:
     0  1
0  215  3
1  209  9
early stop counter: 5
val acc:0.5684455037117004, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 19,now: 2024-07-29 08:31:48.059994,epoch time: 0:01:42.433938,used: 0:30:55.752548,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9901917, 'recall': 0.99023926, 'specificity': 0.99023926, 'f1': 0.99013156, 'auroc': 0.9994347, 'binary_precision': 0.99933773, 'binary_recall': 0.98114437, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.99015754}
confusion matrix:
      0     1
0  1501     1
1    29  1509
---- Validation: 
scalar performance:
{'acc': 0.68368137, 'precision': 0.7899825, 'recall': 0.6738137, 'specificity': 0.6738137, 'f1': 0.6443476, 'auroc': 0.931268, 'binary_precision': 0.95780593, 'binary_recall': 0.36261982, 'binary_specificity': 0.9850075, 'binary_f1_score': 0.52607185}
confusion matrix:
     0    1
0  657   10
1  399  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7591743, 'precision': 0.8374613, 'recall': 0.75917435, 'specificity': 0.75917435, 'f1': 0.7443472, 'auroc': 0.93054557, 'binary_precision': 1.0, 'binary_recall': 0.51834863, 'binary_specificity': 1.0, 'binary_f1_score': 0.68277943}
confusion matrix:
     0    1
0  218    0
1  105  113
early stop counter: 6
val acc:0.6836813688278198, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 20,now: 2024-07-29 08:33:25.459300,epoch time: 0:01:37.399306,used: 0:32:33.151854,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9944079, 'precision': 0.99443245, 'recall': 0.99438643, 'specificity': 0.99438643, 'f1': 0.9944068, 'auroc': 0.9996805, 'binary_precision': 0.99287564, 'binary_recall': 0.9961014, 'binary_specificity': 0.99267155, 'binary_f1_score': 0.9944859}
confusion matrix:
      0     1
0  1490    11
1     6  1533
---- Validation: 
scalar performance:
{'acc': 0.71616393, 'precision': 0.7920079, 'recall': 0.70785093, 'specificity': 0.70785093, 'f1': 0.691146, 'auroc': 0.91662633, 'binary_precision': 0.93311036, 'binary_recall': 0.4456869, 'binary_specificity': 0.970015, 'binary_f1_score': 0.60324323}
confusion matrix:
     0    1
0  647   20
1  347  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66972476, 'precision': 0.76338816, 'recall': 0.66972476, 'specificity': 0.66972476, 'f1': 0.6374974, 'auroc': 0.87755656, 'binary_precision': 0.92045456, 'binary_recall': 0.37155962, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.52941173}
confusion matrix:
     0   1
0  211   7
1  137  81
early stop counter: 7
val acc:0.7161639332771301, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 21,now: 2024-07-29 08:35:03.419392,epoch time: 0:01:37.960092,used: 0:34:11.111946,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.97598684, 'precision': 0.9772378, 'recall': 0.9756839, 'specificity': 0.9756839, 'f1': 0.9759559, 'auroc': 0.9995234, 'binary_precision': 0.9558732, 'binary_recall': 0.9987013, 'binary_specificity': 0.95266664, 'binary_f1_score': 0.97681797}
confusion matrix:
      0     1
0  1429    71
1     2  1538
---- Validation: 
scalar performance:
{'acc': 0.8383604, 'precision': 0.83848715, 'recall': 0.8388114, 'specificity': 0.8388114, 'f1': 0.83833563, 'auroc': 0.9123825, 'binary_precision': 0.8202765, 'binary_recall': 0.85303515, 'binary_specificity': 0.8245877, 'binary_f1_score': 0.8363351}
confusion matrix:
     0    1
0  550  117
1   92  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7912844, 'precision': 0.8054838, 'recall': 0.7912844, 'specificity': 0.7912844, 'f1': 0.7888305, 'auroc': 0.912802, 'binary_precision': 0.73962265, 'binary_recall': 0.89908254, 'binary_specificity': 0.6834862, 'binary_f1_score': 0.8115942}
confusion matrix:
     0    1
0  149   69
1   22  196
early stop counter: 8
val acc:0.8383604288101196, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 22,now: 2024-07-29 08:36:41.719308,epoch time: 0:01:38.299916,used: 0:35:49.411862,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98059213, 'precision': 0.98106074, 'recall': 0.9808115, 'specificity': 0.9808115, 'f1': 0.9805912, 'auroc': 0.99988186, 'binary_precision': 0.9993248, 'binary_recall': 0.9622887, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.9804571}
confusion matrix:
      0     1
0  1501     1
1    58  1480
---- Validation: 
scalar performance:
{'acc': 0.52822894, 'precision': 0.76115894, 'recall': 0.51277953, 'specificity': 0.51277953, 'f1': 0.36802915, 'auroc': 0.9095851, 'binary_precision': 1.0, 'binary_recall': 0.025559105, 'binary_specificity': 1.0, 'binary_f1_score': 0.04984424}
confusion matrix:
     0   1
0  667   0
1  610  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8877251, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  218  0
1  218  0
early stop counter: 9
val acc:0.5282289385795593, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 23,now: 2024-07-29 08:38:21.482225,epoch time: 0:01:39.762917,used: 0:37:29.174779,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9884696, 'recall': 0.9885125, 'specificity': 0.9885125, 'f1': 0.9884858, 'auroc': 0.9994901, 'binary_precision': 0.99085563, 'binary_recall': 0.9863459, 'binary_specificity': 0.9906791, 'binary_f1_score': 0.98859566}
confusion matrix:
      0     1
0  1488    14
1    21  1517
---- Validation: 
scalar performance:
{'acc': 0.61794275, 'precision': 0.7607459, 'recall': 0.6058241, 'specificity': 0.6058241, 'f1': 0.5445651, 'auroc': 0.9006064, 'binary_precision': 0.9459459, 'binary_recall': 0.22364217, 'binary_specificity': 0.988006, 'binary_f1_score': 0.3617571}
confusion matrix:
     0    1
0  659    8
1  486  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54587156, 'precision': 0.7620192, 'recall': 0.54587156, 'specificity': 0.54587156, 'f1': 0.42788216, 'auroc': 0.9080254, 'binary_precision': 1.0, 'binary_recall': 0.09174312, 'binary_specificity': 1.0, 'binary_f1_score': 0.16806723}
confusion matrix:
     0   1
0  218   0
1  198  20
early stop counter: 10
val acc:0.617942750453949, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 24,now: 2024-07-29 08:39:51.035502,epoch time: 0:01:29.553277,used: 0:38:58.728056,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.9906316, 'recall': 0.99037737, 'specificity': 0.99037737, 'f1': 0.9904572, 'auroc': 0.9998589, 'binary_precision': 0.9839641, 'binary_recall': 0.9973992, 'binary_specificity': 0.9833555, 'binary_f1_score': 0.9906361}
confusion matrix:
      0     1
0  1477    25
1     4  1534
---- Validation: 
scalar performance:
{'acc': 0.7509667, 'precision': 0.7888334, 'recall': 0.74502087, 'specificity': 0.74502087, 'f1': 0.7393472, 'auroc': 0.91274416, 'binary_precision': 0.88578683, 'binary_recall': 0.557508, 'binary_specificity': 0.93253374, 'binary_f1_score': 0.6843138}
confusion matrix:
     0    1
0  622   45
1  277  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809633, 'precision': 0.8323546, 'recall': 0.809633, 'specificity': 0.809633, 'f1': 0.8063228, 'auroc': 0.9122548, 'binary_precision': 0.91925466, 'binary_recall': 0.6788991, 'binary_specificity': 0.940367, 'binary_f1_score': 0.78100264}
confusion matrix:
     0    1
0  205   13
1   70  148
early stop counter: 11
val acc:0.7509667277336121, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 25,now: 2024-07-29 08:41:30.572898,epoch time: 0:01:39.537396,used: 0:40:38.265452,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934506, 'recall': 0.99339676, 'specificity': 0.99339676, 'f1': 0.99341977, 'auroc': 0.9997195, 'binary_precision': 0.9915803, 'binary_recall': 0.99544865, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.9935107}
confusion matrix:
      0     1
0  1489    13
1     7  1531
---- Validation: 
scalar performance:
{'acc': 0.8569219, 'precision': 0.87076354, 'recall': 0.8538566, 'specificity': 0.8538566, 'f1': 0.8546969, 'auroc': 0.9412347, 'binary_precision': 0.93491125, 'binary_recall': 0.7571885, 'binary_specificity': 0.95052475, 'binary_f1_score': 0.83671665}
confusion matrix:
     0    1
0  634   33
1  152  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8233945, 'precision': 0.85286415, 'recall': 0.82339454, 'specificity': 0.82339454, 'f1': 0.8196285, 'auroc': 0.91488516, 'binary_precision': 0.9548387, 'binary_recall': 0.6788991, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.7935657}
confusion matrix:
     0    1
0  211    7
1   70  148
early stop counter: 12
val acc:0.856921911239624, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 26,now: 2024-07-29 08:43:09.361042,epoch time: 0:01:38.788144,used: 0:42:17.053596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.9937359, 'recall': 0.9937998, 'specificity': 0.9937998, 'f1': 0.9937497, 'auroc': 0.9998177, 'binary_precision': 0.9980328, 'binary_recall': 0.9895969, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.99379694}
confusion matrix:
      0     1
0  1499     3
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.84686774, 'precision': 0.8726968, 'recall': 0.8426877, 'specificity': 0.8426877, 'f1': 0.84291923, 'auroc': 0.9369668, 'binary_precision': 0.9632035, 'binary_recall': 0.71086264, 'binary_specificity': 0.97451276, 'binary_f1_score': 0.81801474}
confusion matrix:
     0    1
0  650   17
1  181  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7591743, 'precision': 0.8199304, 'recall': 0.7591743, 'specificity': 0.7591743, 'f1': 0.747171, 'auroc': 0.9133701, 'binary_precision': 0.9593496, 'binary_recall': 0.5412844, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.6920821}
confusion matrix:
     0    1
0  213    5
1  100  118
early stop counter: 13
val acc:0.8468677401542664, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 27,now: 2024-07-29 08:44:48.486905,epoch time: 0:01:39.125863,used: 0:43:56.179459,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9911432, 'recall': 0.99120677, 'specificity': 0.99120677, 'f1': 0.99111825, 'auroc': 0.99984896, 'binary_precision': 0.9986799, 'binary_recall': 0.9837451, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9911562}
confusion matrix:
      0     1
0  1500     2
1    25  1513
---- Validation: 
scalar performance:
{'acc': 0.65119874, 'precision': 0.78522295, 'recall': 0.64002186, 'specificity': 0.64002186, 'f1': 0.594906, 'auroc': 0.9252459, 'binary_precision': 0.972973, 'binary_recall': 0.28753993, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.4438964}
confusion matrix:
     0    1
0  662    5
1  446  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57798165, 'precision': 0.7711443, 'recall': 0.57798165, 'specificity': 0.57798165, 'f1': 0.48653352, 'auroc': 0.92214453, 'binary_precision': 1.0, 'binary_recall': 0.1559633, 'binary_specificity': 1.0, 'binary_f1_score': 0.26984125}
confusion matrix:
     0   1
0  218   0
1  184  34
early stop counter: 14
val acc:0.6511987447738647, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 28,now: 2024-07-29 08:46:28.654489,epoch time: 0:01:40.167584,used: 0:45:36.347043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99539477, 'precision': 0.9953841, 'recall': 0.99540806, 'specificity': 0.99540806, 'f1': 0.99539435, 'auroc': 0.9999104, 'binary_precision': 0.9967363, 'binary_recall': 0.9941406, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.9954368}
confusion matrix:
      0     1
0  1499     5
1     9  1527
---- Validation: 
scalar performance:
{'acc': 0.8244393, 'precision': 0.853178, 'recall': 0.81986845, 'specificity': 0.81986845, 'f1': 0.8192052, 'auroc': 0.9254925, 'binary_precision': 0.94630873, 'binary_recall': 0.67571884, 'binary_specificity': 0.964018, 'binary_f1_score': 0.78844357}
confusion matrix:
     0    1
0  643   24
1  203  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165138, 'precision': 0.83887535, 'recall': 0.8165138, 'specificity': 0.8165138, 'f1': 0.81343603, 'auroc': 0.91147625, 'binary_precision': 0.9259259, 'binary_recall': 0.6880734, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.78947365}
confusion matrix:
     0    1
0  206   12
1   68  150
early stop counter: 15
val acc:0.824439287185669, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 29,now: 2024-07-29 08:48:06.600330,epoch time: 0:01:37.945841,used: 0:47:14.292884,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9917763, 'precision': 0.99179447, 'recall': 0.9918525, 'specificity': 0.9918525, 'f1': 0.9917761, 'auroc': 0.99977267, 'binary_precision': 0.9986807, 'binary_recall': 0.9850358, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.9918113}
confusion matrix:
      0     1
0  1501     2
1    23  1514
---- Validation: 
scalar performance:
{'acc': 0.7579273, 'precision': 0.81373894, 'recall': 0.75108016, 'specificity': 0.75108016, 'f1': 0.74316406, 'auroc': 0.9177544, 'binary_precision': 0.93837535, 'binary_recall': 0.5351438, 'binary_specificity': 0.9670165, 'binary_f1_score': 0.68158704}
confusion matrix:
     0    1
0  645   22
1  291  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.646789, 'precision': 0.7856675, 'recall': 0.64678895, 'specificity': 0.64678895, 'f1': 0.5979209, 'auroc': 0.9096404, 'binary_precision': 0.9848485, 'binary_recall': 0.29816514, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.4577465}
confusion matrix:
     0   1
0  217   1
1  153  65
early stop counter: 16
val acc:0.7579272985458374, best validation acc: 0.8723897933959961, corresponding to test acc:                         0.8715596199035645 / 0.8715596199035645
after epoch: 30,now: 2024-07-29 08:49:44.920909,epoch time: 0:01:38.320579,used: 0:48:52.613463,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_00_52_seed_8_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:52.613463 at 2024-07-29 08:49:44.920909
persisted model performance metric: 

scalar performance:
{'acc': 0.8715596, 'precision': 0.87873197, 'recall': 0.8715596, 'specificity': 0.8715596, 'f1': 0.8709487, 'auroc': 0.93569565, 'binary_precision': 0.93085104, 'binary_recall': 0.8027523, 'binary_specificity': 0.940367, 'binary_f1_score': 0.86206895}
confusion matrix:
     0    1
0  205   13
1   43  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8715596, 'precision': 0.87873197, 'recall': 0.8715596, 'specificity': 0.8715596, 'f1': 0.8709487, 'auroc': 0.93569565, 'binary_precision': 0.93085104, 'binary_recall': 0.8027523, 'binary_specificity': 0.940367, 'binary_f1_score': 0.86206895}
confusion matrix:
     0    1
0  205   13
1   43  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456211 KiB |  13219 MiB | 662039 GiB | 662039 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 654212 GiB | 654212 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456211 KiB |  13219 MiB | 662039 GiB | 662039 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 654212 GiB | 654212 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 660333 GiB | 660332 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 652522 GiB | 652522 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB | 123100 MiB | 108624 MiB |
|       from large pool |  14410 MiB |  14422 MiB | 122908 MiB | 108498 MiB |
|       from small pool |     66 MiB |     70 MiB |    192 MiB |    126 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475628 KiB |   1260 MiB | 473726 GiB | 473725 GiB |
|       from large pool | 462976 KiB |   1252 MiB | 465850 GiB | 465850 GiB |
|       from small pool |  12652 KiB |     45 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116341 K  |  116340 K  |
|       from large pool |     187    |    1413    |   59095 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57245 K  |   57244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116341 K  |  116340 K  |
|       from large pool |     187    |    1413    |   59095 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57245 K  |   57244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    5207    |    4572    |
|       from large pool |     602    |     602    |    5111    |    4509    |
|       from small pool |      33    |      35    |      96    |      63    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     655    |   77184 K  |   77184 K  |
|       from large pool |      38    |     604    |   43711 K  |   43711 K  |
|       from small pool |      58    |     237    |   33473 K  |   33473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 662039 GiB | 662039 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654212 GiB | 654212 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 662039 GiB | 662039 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654212 GiB | 654212 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660333 GiB | 660333 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652522 GiB | 652522 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 123100 MiB | 122190 MiB |
|       from large pool |    858 MiB |  14422 MiB | 122908 MiB | 122050 MiB |
|       from small pool |     52 MiB |     70 MiB |    192 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 473726 GiB | 473726 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 465850 GiB | 465850 GiB |
|       from small pool |      0 KiB |     46 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116341 K  |  116341 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57245 K  |   57245 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116341 K  |  116341 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57245 K  |   57245 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    5207    |    5142    |
|       from large pool |      39    |     602    |    5111    |    5072    |
|       from small pool |      26    |      35    |      96    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   77184 K  |   77184 K  |
|       from large pool |       3    |     604    |   43711 K  |   43711 K  |
|       from small pool |       0    |     237    |   33473 K  |   33473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 662039 GiB | 662039 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654212 GiB | 654212 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 662039 GiB | 662039 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654212 GiB | 654212 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660333 GiB | 660333 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652522 GiB | 652522 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB | 123100 MiB | 122190 MiB |
|       from large pool |    858 MiB |  14422 MiB | 122908 MiB | 122050 MiB |
|       from small pool |     52 MiB |     70 MiB |    192 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 473726 GiB | 473726 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 465850 GiB | 465850 GiB |
|       from small pool |      0 KiB |     46 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116341 K  |  116341 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57245 K  |   57245 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116341 K  |  116341 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57245 K  |   57245 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    5207    |    5142    |
|       from large pool |      39    |     602    |    5111    |    5072    |
|       from small pool |      26    |      35    |      96    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   77184 K  |   77184 K  |
|       from large pool |       3    |     604    |   43711 K  |   43711 K  |
|       from small pool |       0    |     237    |   33473 K  |   33473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369

 Experiment start at: 2024-07-29 08:50:36.330076
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95713353, 'precision': 0.95713115, 'recall': 0.95715916, 'specificity': 0.95715916, 'f1': 0.95713276, 'auroc': 0.99096346, 'binary_precision': 0.9607587, 'binary_recall': 0.9538961, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.95731515}
confusion matrix:
      0     1
0  1456    60
1    71  1469
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8208494, 'precision': 0.82404697, 'recall': 0.82134306, 'specificity': 0.82134306, 'f1': 0.8205489, 'auroc': 0.9000964, 'binary_precision': 0.7892504, 'binary_recall': 0.8705148, 'binary_specificity': 0.77217126, 'binary_f1_score': 0.8278932}
confusion matrix:
     0    1
0  505  149
1   83  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8021739, 'precision': 0.8070555, 'recall': 0.8021739, 'specificity': 0.8021739, 'f1': 0.80138457, 'auroc': 0.8881475, 'binary_precision': 0.76833975, 'binary_recall': 0.8652174, 'binary_specificity': 0.73913044, 'binary_f1_score': 0.81390595}
confusion matrix:
     0    1
0  170   60
1   31  199
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:52:25.253404,epoch time: 0:01:48.923328,used: 0:01:48.923328,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9515707, 'precision': 0.95378625, 'recall': 0.95132786, 'specificity': 0.95132786, 'f1': 0.95149076, 'auroc': 0.9952104, 'binary_precision': 0.92382693, 'binary_recall': 0.9850552, 'binary_specificity': 0.9176005, 'binary_f1_score': 0.9534591}
confusion matrix:
      0     1
0  1392   125
1    23  1516
---- Validation: 
scalar performance:
{'acc': 0.7760618, 'precision': 0.81232834, 'recall': 0.77776027, 'specificity': 0.77776027, 'f1': 0.77007294, 'auroc': 0.9210928, 'binary_precision': 0.7033604, 'binary_recall': 0.9469579, 'binary_specificity': 0.6085627, 'binary_f1_score': 0.8071808}
confusion matrix:
     0    1
0  398  256
1   34  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7282609, 'precision': 0.7684586, 'recall': 0.7282609, 'specificity': 0.7282609, 'f1': 0.71769303, 'auroc': 0.9024763, 'binary_precision': 0.6645768, 'binary_recall': 0.9217391, 'binary_specificity': 0.5347826, 'binary_f1_score': 0.77231336}
confusion matrix:
     0    1
0  123  107
1   18  212
early stop counter: 1
val acc:0.7760617733001709, best validation acc: 0.8208494186401367, corresponding to test acc:                         0.802173912525177 / 0.802173912525177
after epoch: 2,now: 2024-07-29 08:54:07.300710,epoch time: 0:01:42.047306,used: 0:03:30.970634,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97773945, 'recall': 0.9773455, 'specificity': 0.9773455, 'f1': 0.97741413, 'auroc': 0.99745274, 'binary_precision': 0.96694213, 'binary_recall': 0.9889467, 'binary_specificity': 0.9657444, 'binary_f1_score': 0.97782063}
confusion matrix:
      0     1
0  1466    52
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.8648649, 'precision': 0.8648697, 'recall': 0.864828, 'specificity': 0.864828, 'f1': 0.8648442, 'auroc': 0.92848516, 'binary_precision': 0.86520374, 'binary_recall': 0.86115444, 'binary_specificity': 0.86850154, 'binary_f1_score': 0.8631743}
confusion matrix:
     0    1
0  568   86
1   89  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87608695, 'precision': 0.8872205, 'recall': 0.87608695, 'specificity': 0.87608695, 'f1': 0.8751898, 'auroc': 0.91599244, 'binary_precision': 0.9528796, 'binary_recall': 0.79130435, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.86460805}
confusion matrix:
     0    1
0  221    9
1   48  182
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 08:55:51.600519,epoch time: 0:01:44.299809,used: 0:05:15.270443,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.97898746, 'recall': 0.9786631, 'specificity': 0.9786631, 'f1': 0.97872436, 'auroc': 0.99834704, 'binary_precision': 0.96940726, 'binary_recall': 0.9889467, 'binary_specificity': 0.96837944, 'binary_f1_score': 0.9790794}
confusion matrix:
      0     1
0  1470    48
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.8687259, 'precision': 0.86879516, 'recall': 0.86880565, 'specificity': 0.86880565, 'f1': 0.8687258, 'auroc': 0.93919563, 'binary_precision': 0.8606432, 'binary_recall': 0.87675506, 'binary_specificity': 0.8608563, 'binary_f1_score': 0.86862445}
confusion matrix:
     0    1
0  563   91
1   79  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8826087, 'precision': 0.89016116, 'recall': 0.88260865, 'specificity': 0.88260865, 'f1': 0.8820378, 'auroc': 0.9369565, 'binary_precision': 0.9444444, 'binary_recall': 0.8130435, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.87383175}
confusion matrix:
     0    1
0  219   11
1   43  187
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 08:57:35.146891,epoch time: 0:01:43.546372,used: 0:06:58.816815,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9763907, 'recall': 0.97592545, 'specificity': 0.97592545, 'f1': 0.97578156, 'auroc': 0.99811196, 'binary_precision': 0.9952671, 'binary_recall': 0.95646524, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.97548044}
confusion matrix:
      0     1
0  1510     7
1    67  1472
---- Validation: 
scalar performance:
{'acc': 0.77837837, 'precision': 0.82925045, 'recall': 0.7763946, 'specificity': 0.7763946, 'f1': 0.76861596, 'auroc': 0.92012906, 'binary_precision': 0.9561856, 'binary_recall': 0.57878315, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.72108847}
confusion matrix:
     0    1
0  637   17
1  270  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6347826, 'precision': 0.7889447, 'recall': 0.6347826, 'specificity': 0.6347826, 'f1': 0.57857084, 'auroc': 0.9058979, 'binary_precision': 1.0, 'binary_recall': 0.26956522, 'binary_specificity': 1.0, 'binary_f1_score': 0.42465755}
confusion matrix:
     0   1
0  230   0
1  168  62
early stop counter: 1
val acc:0.7783783674240112, best validation acc: 0.8687258958816528, corresponding to test acc:                         0.8826087117195129 / 0.8826087117195129
after epoch: 5,now: 2024-07-29 08:59:18.051406,epoch time: 0:01:42.904515,used: 0:08:41.721330,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98824024, 'recall': 0.98820513, 'specificity': 0.98820513, 'f1': 0.9882189, 'auroc': 0.99905634, 'binary_precision': 0.98640776, 'binary_recall': 0.9902534, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.98832685}
confusion matrix:
      0     1
0  1496    21
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.8378378, 'precision': 0.8427627, 'recall': 0.8372323, 'specificity': 0.8372323, 'f1': 0.83706826, 'auroc': 0.9091872, 'binary_precision': 0.8814159, 'binary_recall': 0.7769111, 'binary_specificity': 0.8975535, 'binary_f1_score': 0.82587063}
confusion matrix:
     0    1
0  587   67
1  143  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8304348, 'precision': 0.84074074, 'recall': 0.8304348, 'specificity': 0.8304348, 'f1': 0.8291428, 'auroc': 0.90848774, 'binary_precision': 0.9, 'binary_recall': 0.74347824, 'binary_specificity': 0.9173913, 'binary_f1_score': 0.8142857}
confusion matrix:
     0    1
0  211   19
1   59  171
early stop counter: 2
val acc:0.837837815284729, best validation acc: 0.8687258958816528, corresponding to test acc:                         0.8826087117195129 / 0.8826087117195129
after epoch: 6,now: 2024-07-29 09:00:59.797538,epoch time: 0:01:41.746132,used: 0:10:23.467462,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98477274, 'recall': 0.98469734, 'specificity': 0.98469734, 'f1': 0.9846202, 'auroc': 0.9989574, 'binary_precision': 0.9953519, 'binary_recall': 0.9740091, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.98456484}
confusion matrix:
      0     1
0  1510     7
1    40  1499
---- Validation: 
scalar performance:
{'acc': 0.7096525, 'precision': 0.7861422, 'recall': 0.7070339, 'specificity': 0.7070339, 'f1': 0.6871932, 'auroc': 0.87781715, 'binary_precision': 0.9315961, 'binary_recall': 0.44617784, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.6033755}
confusion matrix:
     0    1
0  633   21
1  355  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7717391, 'precision': 0.8171119, 'recall': 0.7717391, 'specificity': 0.7717391, 'f1': 0.7632712, 'auroc': 0.89172024, 'binary_precision': 0.9370629, 'binary_recall': 0.5826087, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.7184986}
confusion matrix:
     0    1
0  221    9
1   96  134
early stop counter: 3
val acc:0.7096524834632874, best validation acc: 0.8687258958816528, corresponding to test acc:                         0.8826087117195129 / 0.8826087117195129
after epoch: 7,now: 2024-07-29 09:02:41.698414,epoch time: 0:01:41.900876,used: 0:12:05.368338,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98243773, 'recall': 0.9821111, 'specificity': 0.9821111, 'f1': 0.9820008, 'auroc': 0.99905896, 'binary_precision': 0.998655, 'binary_recall': 0.96553963, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9818182}
confusion matrix:
      0     1
0  1516     2
1    53  1485
---- Validation: 
scalar performance:
{'acc': 0.7250965, 'precision': 0.7984513, 'recall': 0.722588, 'specificity': 0.722588, 'f1': 0.7056322, 'auroc': 0.9071095, 'binary_precision': 0.94392526, 'binary_recall': 0.4726989, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.62993765}
confusion matrix:
     0    1
0  636   18
1  338  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7282609, 'precision': 0.815612, 'recall': 0.7282609, 'specificity': 0.7282609, 'f1': 0.7080611, 'auroc': 0.89506614, 'binary_precision': 0.98165137, 'binary_recall': 0.46521738, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.63126844}
confusion matrix:
     0    1
0  228    2
1  123  107
early stop counter: 4
val acc:0.7250965237617493, best validation acc: 0.8687258958816528, corresponding to test acc:                         0.8826087117195129 / 0.8826087117195129
after epoch: 8,now: 2024-07-29 09:04:23.256021,epoch time: 0:01:41.557607,used: 0:13:46.925945,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98797566, 'recall': 0.9878534, 'specificity': 0.9878534, 'f1': 0.9878907, 'auroc': 0.99941146, 'binary_precision': 0.98327976, 'binary_recall': 0.99285716, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9880453}
confusion matrix:
      0     1
0  1490    26
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.86177605, 'precision': 0.86695796, 'recall': 0.86118066, 'specificity': 0.86118066, 'f1': 0.86113477, 'auroc': 0.9346539, 'binary_precision': 0.9081272, 'binary_recall': 0.8018721, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.85169834}
confusion matrix:
     0    1
0  602   52
1  127  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84565216, 'precision': 0.8607149, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.8440239, 'auroc': 0.91134214, 'binary_precision': 0.93442625, 'binary_recall': 0.74347824, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.82808715}
confusion matrix:
     0    1
0  218   12
1   59  171
early stop counter: 5
val acc:0.8617760539054871, best validation acc: 0.8687258958816528, corresponding to test acc:                         0.8826087117195129 / 0.8826087117195129
after epoch: 9,now: 2024-07-29 09:06:06.862033,epoch time: 0:01:43.606012,used: 0:15:30.531957,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99250925, 'recall': 0.99245423, 'specificity': 0.99245423, 'f1': 0.9924731, 'auroc': 0.99985135, 'binary_precision': 0.9896574, 'binary_recall': 0.99544865, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.99254465}
confusion matrix:
      0     1
0  1502    16
1     7  1531
---- Validation: 
scalar performance:
{'acc': 0.76833975, 'precision': 0.82253253, 'recall': 0.76626974, 'specificity': 0.76626974, 'f1': 0.7572324, 'auroc': 0.9148525, 'binary_precision': 0.95225465, 'binary_recall': 0.5600624, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.7053045}
confusion matrix:
     0    1
0  636   18
1  282  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74130434, 'precision': 0.8217391, 'recall': 0.74130434, 'specificity': 0.74130434, 'f1': 0.7240579, 'auroc': 0.90962195, 'binary_precision': 0.9826087, 'binary_recall': 0.49130434, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.65507245}
confusion matrix:
     0    1
0  228    2
1  117  113
early stop counter: 6
val acc:0.7683397531509399, best validation acc: 0.8687258958816528, corresponding to test acc:                         0.8826087117195129 / 0.8826087117195129
after epoch: 10,now: 2024-07-29 09:07:49.147527,epoch time: 0:01:42.285494,used: 0:17:12.817451,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9842925, 'recall': 0.9842925, 'specificity': 0.9842925, 'f1': 0.9842925, 'auroc': 0.9989245, 'binary_precision': 0.9843953, 'binary_recall': 0.9843953, 'binary_specificity': 0.98418975, 'binary_f1_score': 0.9843953}
confusion matrix:
      0     1
0  1494    24
1    24  1514
---- Validation: 
scalar performance:
{'acc': 0.8849421, 'precision': 0.8863486, 'recall': 0.8846437, 'specificity': 0.8846437, 'f1': 0.88477033, 'auroc': 0.9457294, 'binary_precision': 0.9072848, 'binary_recall': 0.8549142, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.8803213}
confusion matrix:
     0    1
0  598   56
1   93  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85, 'precision': 0.8666409, 'recall': 0.85, 'specificity': 0.85, 'f1': 0.84827846, 'auroc': 0.92606807, 'binary_precision': 0.9447514, 'binary_recall': 0.74347824, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.83211684}
confusion matrix:
     0    1
0  220   10
1   59  171
better model found
persisted
after epoch: 11,now: 2024-07-29 09:09:30.267593,epoch time: 0:01:41.120066,used: 0:18:53.937517,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.97642994, 'recall': 0.97564936, 'specificity': 0.97564936, 'f1': 0.97545123, 'auroc': 0.9994149, 'binary_precision': 1.0, 'binary_recall': 0.9512987, 'binary_specificity': 1.0, 'binary_f1_score': 0.9750416}
confusion matrix:
      0     1
0  1516     0
1    75  1465
---- Validation: 
scalar performance:
{'acc': 0.6138996, 'precision': 0.7733325, 'recall': 0.6100309, 'specificity': 0.6100309, 'f1': 0.5440064, 'auroc': 0.9280057, 'binary_precision': 0.97959185, 'binary_recall': 0.22464898, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.36548224}
confusion matrix:
     0    1
0  651    3
1  497  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5282609, 'precision': 0.7572707, 'recall': 0.5282609, 'specificity': 0.5282609, 'f1': 0.39323205, 'auroc': 0.91211724, 'binary_precision': 1.0, 'binary_recall': 0.05652174, 'binary_specificity': 1.0, 'binary_f1_score': 0.10699588}
confusion matrix:
     0   1
0  230   0
1  217  13
early stop counter: 1
val acc:0.6138995885848999, best validation acc: 0.8849421143531799, corresponding to test acc:                         0.8500000238418579 / 0.8826087117195129
after epoch: 12,now: 2024-07-29 09:11:07.540966,epoch time: 0:01:37.273373,used: 0:20:31.210890,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.98632514, 'recall': 0.98622596, 'specificity': 0.98622596, 'f1': 0.9862548, 'auroc': 0.9995005, 'binary_precision': 0.98195875, 'binary_recall': 0.9908973, 'binary_specificity': 0.9815547, 'binary_f1_score': 0.98640776}
confusion matrix:
      0     1
0  1490    28
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.827027, 'precision': 0.8563998, 'recall': 0.8255831, 'specificity': 0.8255831, 'f1': 0.8229294, 'auroc': 0.91900796, 'binary_precision': 0.9562363, 'binary_recall': 0.68174726, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.79599273}
confusion matrix:
     0    1
0  634   20
1  204  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7326087, 'precision': 0.7999829, 'recall': 0.7326087, 'specificity': 0.7326087, 'f1': 0.716702, 'auroc': 0.8901134, 'binary_precision': 0.94214875, 'binary_recall': 0.49565217, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.6495727}
confusion matrix:
     0    1
0  223    7
1  116  114
early stop counter: 2
val acc:0.8270270228385925, best validation acc: 0.8849421143531799, corresponding to test acc:                         0.8500000238418579 / 0.8826087117195129
after epoch: 13,now: 2024-07-29 09:12:40.242779,epoch time: 0:01:32.701813,used: 0:22:03.912703,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9846995, 'recall': 0.9845843, 'specificity': 0.9845843, 'f1': 0.9846182, 'auroc': 0.9987633, 'binary_precision': 0.98005146, 'binary_recall': 0.98960364, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.9848044}
confusion matrix:
      0     1
0  1486    31
1    16  1523
---- Validation: 
scalar performance:
{'acc': 0.803861, 'precision': 0.83506274, 'recall': 0.80232173, 'specificity': 0.80232173, 'f1': 0.7986156, 'auroc': 0.88982415, 'binary_precision': 0.93483144, 'binary_recall': 0.648986, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7661142}
confusion matrix:
     0    1
0  625   29
1  225  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78913045, 'precision': 0.84860396, 'recall': 0.78913045, 'specificity': 0.78913045, 'f1': 0.7797359, 'auroc': 0.9109074, 'binary_precision': 0.9925926, 'binary_recall': 0.5826087, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.7342466}
confusion matrix:
     0    1
0  229    1
1   96  134
early stop counter: 3
val acc:0.8038610219955444, best validation acc: 0.8849421143531799, corresponding to test acc:                         0.8500000238418579 / 0.8826087117195129
after epoch: 14,now: 2024-07-29 09:14:21.594907,epoch time: 0:01:41.352128,used: 0:23:45.264831,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.98207116, 'recall': 0.98180276, 'specificity': 0.98180276, 'f1': 0.9816741, 'auroc': 0.9988975, 'binary_precision': 0.99798656, 'binary_recall': 0.9655844, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98151815}
confusion matrix:
      0     1
0  1513     3
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.76602316, 'precision': 0.82533073, 'recall': 0.7638676, 'specificity': 0.7638676, 'f1': 0.7538488, 'auroc': 0.9292766, 'binary_precision': 0.96174866, 'binary_recall': 0.54914194, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.6991063}
confusion matrix:
     0    1
0  640   14
1  289  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8364389, 'recall': 0.7826087, 'specificity': 0.7826087, 'f1': 0.77355075, 'auroc': 0.903138, 'binary_precision': 0.9710145, 'binary_recall': 0.5826087, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7282609}
confusion matrix:
     0    1
0  226    4
1   96  134
early stop counter: 4
val acc:0.7660231590270996, best validation acc: 0.8849421143531799, corresponding to test acc:                         0.8500000238418579 / 0.8826087117195129
after epoch: 15,now: 2024-07-29 09:16:02.276709,epoch time: 0:01:40.681802,used: 0:25:25.946633,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934777, 'recall': 0.9934397, 'specificity': 0.9934397, 'f1': 0.99345493, 'auroc': 0.99968815, 'binary_precision': 0.9915912, 'binary_recall': 0.99545455, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9935191}
confusion matrix:
      0     1
0  1503    13
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.85328186, 'precision': 0.8711456, 'recall': 0.8521817, 'specificity': 0.8521817, 'f1': 0.8512049, 'auroc': 0.9353528, 'binary_precision': 0.9500998, 'binary_recall': 0.7425897, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.8336252}
confusion matrix:
     0    1
0  629   25
1  165  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84565216, 'precision': 0.8699994, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.8430705, 'auroc': 0.91166353, 'binary_precision': 0.9649123, 'binary_recall': 0.7173913, 'binary_specificity': 0.973913, 'binary_f1_score': 0.8229426}
confusion matrix:
     0    1
0  224    6
1   65  165
early stop counter: 5
val acc:0.8532818555831909, best validation acc: 0.8849421143531799, corresponding to test acc:                         0.8500000238418579 / 0.8826087117195129
after epoch: 16,now: 2024-07-29 09:17:50.315009,epoch time: 0:01:48.038300,used: 0:27:13.984933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895718, 'recall': 0.9895047, 'specificity': 0.9895047, 'f1': 0.98952764, 'auroc': 0.9994402, 'binary_precision': 0.98644286, 'binary_recall': 0.9928525, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.9896373}
confusion matrix:
      0     1
0  1496    21
1    11  1528
---- Validation: 
scalar performance:
{'acc': 0.8864865, 'precision': 0.8933072, 'recall': 0.8858316, 'specificity': 0.8858316, 'f1': 0.88585925, 'auroc': 0.9531623, 'binary_precision': 0.94265234, 'binary_recall': 0.8205928, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.8773979}
confusion matrix:
     0    1
0  622   32
1  115  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326087, 'precision': 0.86764246, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.8285235, 'auroc': 0.92888474, 'binary_precision': 0.9811321, 'binary_recall': 0.67826086, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  227    3
1   74  156
better model found
persisted
after epoch: 17,now: 2024-07-29 09:19:32.313216,epoch time: 0:01:41.998207,used: 0:28:55.983140,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878872, 'recall': 0.9878991, 'specificity': 0.9878991, 'f1': 0.9878922, 'auroc': 0.99922985, 'binary_precision': 0.9889323, 'binary_recall': 0.9870046, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9879675}
confusion matrix:
      0     1
0  1500    17
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.85328186, 'precision': 0.86054194, 'recall': 0.85256934, 'specificity': 0.85256934, 'f1': 0.8523478, 'auroc': 0.92915255, 'binary_precision': 0.9092559, 'binary_recall': 0.78159124, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.84060407}
confusion matrix:
     0    1
0  604   50
1  140  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8482474, 'recall': 0.8478261, 'specificity': 0.8478261, 'f1': 0.84778, 'auroc': 0.9155766, 'binary_precision': 0.8603604, 'binary_recall': 0.8304348, 'binary_specificity': 0.8652174, 'binary_f1_score': 0.84513277}
confusion matrix:
     0    1
0  199   31
1   39  191
early stop counter: 1
val acc:0.8532818555831909, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 18,now: 2024-07-29 09:21:16.235213,epoch time: 0:01:43.921997,used: 0:30:39.905137,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98235834, 'recall': 0.9819226, 'specificity': 0.9819226, 'f1': 0.98199636, 'auroc': 0.9995413, 'binary_precision': 0.97079366, 'binary_recall': 0.99414825, 'binary_specificity': 0.969697, 'binary_f1_score': 0.9823321}
confusion matrix:
      0     1
0  1472    46
1     9  1529
---- Validation: 
scalar performance:
{'acc': 0.8833977, 'precision': 0.88342947, 'recall': 0.88334715, 'specificity': 0.88334715, 'f1': 0.8833751, 'auroc': 0.9379864, 'binary_precision': 0.8852201, 'binary_recall': 0.87831515, 'binary_specificity': 0.8883792, 'binary_f1_score': 0.8817541}
confusion matrix:
     0    1
0  581   73
1   78  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83913046, 'precision': 0.84582466, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.83834815, 'auroc': 0.8994707, 'binary_precision': 0.8939394, 'binary_recall': 0.7695652, 'binary_specificity': 0.90869564, 'binary_f1_score': 0.8271028}
confusion matrix:
     0    1
0  209   21
1   53  177
early stop counter: 2
val acc:0.8833976984024048, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 19,now: 2024-07-29 09:22:56.212406,epoch time: 0:01:39.977193,used: 0:32:19.882330,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901811, 'recall': 0.9902063, 'specificity': 0.9902063, 'f1': 0.9901831, 'auroc': 0.99964106, 'binary_precision': 0.99345976, 'binary_recall': 0.9870046, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9902217}
confusion matrix:
      0     1
0  1507    10
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.6826255, 'precision': 0.7971663, 'recall': 0.6794847, 'specificity': 0.6794847, 'f1': 0.6464966, 'auroc': 0.928967, 'binary_precision': 0.9791667, 'binary_recall': 0.36661467, 'binary_specificity': 0.99235475, 'binary_f1_score': 0.5334847}
confusion matrix:
     0    1
0  649    5
1  406  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6195652, 'precision': 0.7839506, 'recall': 0.61956525, 'specificity': 0.61956525, 'f1': 0.55518717, 'auroc': 0.9390879, 'binary_precision': 1.0, 'binary_recall': 0.23913044, 'binary_specificity': 1.0, 'binary_f1_score': 0.3859649}
confusion matrix:
     0   1
0  230   0
1  175  55
early stop counter: 3
val acc:0.6826254725456238, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 20,now: 2024-07-29 09:24:34.781542,epoch time: 0:01:38.569136,used: 0:33:58.451466,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9915234, 'recall': 0.99147284, 'specificity': 0.99147284, 'f1': 0.9914913, 'auroc': 0.99968904, 'binary_precision': 0.989011, 'binary_recall': 0.99415207, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9915748}
confusion matrix:
      0     1
0  1500    17
1     9  1530
---- Validation: 
scalar performance:
{'acc': 0.8478764, 'precision': 0.8600162, 'recall': 0.8469541, 'specificity': 0.8469541, 'f1': 0.84632784, 'auroc': 0.9260235, 'binary_precision': 0.9236641, 'binary_recall': 0.7550702, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.8309013}
confusion matrix:
     0    1
0  614   40
1  157  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8086957, 'precision': 0.85620797, 'recall': 0.8086957, 'specificity': 0.8086957, 'f1': 0.80209637, 'auroc': 0.9325142, 'binary_precision': 0.98630136, 'binary_recall': 0.62608695, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7659574}
confusion matrix:
     0    1
0  228    2
1   86  144
early stop counter: 4
val acc:0.8478764295578003, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 21,now: 2024-07-29 09:26:14.474962,epoch time: 0:01:39.693420,used: 0:35:38.144886,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908403, 'recall': 0.99086547, 'specificity': 0.99086547, 'f1': 0.9908376, 'auroc': 0.99971086, 'binary_precision': 0.994761, 'binary_recall': 0.9870046, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9908676}
confusion matrix:
      0     1
0  1509     8
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.8810811, 'precision': 0.88897264, 'recall': 0.88037133, 'specificity': 0.88037133, 'f1': 0.880324, 'auroc': 0.94591963, 'binary_precision': 0.9419238, 'binary_recall': 0.8096724, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.8708054}
confusion matrix:
     0    1
0  622   32
1  122  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8652174, 'precision': 0.8865237, 'recall': 0.8652174, 'specificity': 0.8652174, 'f1': 0.86333406, 'auroc': 0.9294518, 'binary_precision': 0.97727275, 'binary_recall': 0.7478261, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.84729064}
confusion matrix:
     0    1
0  226    4
1   58  172
early stop counter: 5
val acc:0.8810811042785645, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 22,now: 2024-07-29 09:27:56.044820,epoch time: 0:01:41.569858,used: 0:37:19.714744,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941189, 'recall': 0.99414265, 'specificity': 0.99414265, 'f1': 0.99410987, 'auroc': 0.9998017, 'binary_precision': 0.9986885, 'binary_recall': 0.98960364, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9941253}
confusion matrix:
      0     1
0  1515     2
1    16  1523
---- Validation: 
scalar performance:
{'acc': 0.823166, 'precision': 0.85321, 'recall': 0.8216984, 'specificity': 0.8216984, 'f1': 0.81884515, 'auroc': 0.9436058, 'binary_precision': 0.9537445, 'binary_recall': 0.675507, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.79086757}
confusion matrix:
     0    1
0  633   21
1  208  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7304348, 'precision': 0.8166234, 'recall': 0.7304348, 'specificity': 0.7304348, 'f1': 0.7107506, 'auroc': 0.92077506, 'binary_precision': 0.9818182, 'binary_recall': 0.4695652, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.63529414}
confusion matrix:
     0    1
0  228    2
1  122  108
early stop counter: 6
val acc:0.823166012763977, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 23,now: 2024-07-29 09:29:35.704464,epoch time: 0:01:39.659644,used: 0:38:59.374388,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9896236, 'recall': 0.98960006, 'specificity': 0.98960006, 'f1': 0.9895288, 'auroc': 0.99973834, 'binary_precision': 0.99867725, 'binary_recall': 0.9805195, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.989515}
confusion matrix:
      0     1
0  1514     2
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.73899615, 'precision': 0.8197361, 'recall': 0.73645794, 'specificity': 0.73645794, 'f1': 0.72003686, 'auroc': 0.9281155, 'binary_precision': 0.97791797, 'binary_recall': 0.48361933, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.6471816}
confusion matrix:
     0    1
0  647    7
1  331  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59130436, 'precision': 0.7751196, 'recall': 0.59130436, 'specificity': 0.59130436, 'f1': 0.50935006, 'auroc': 0.9232893, 'binary_precision': 1.0, 'binary_recall': 0.1826087, 'binary_specificity': 1.0, 'binary_f1_score': 0.30882353}
confusion matrix:
     0   1
0  230   0
1  188  42
early stop counter: 7
val acc:0.738996148109436, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 24,now: 2024-07-29 09:31:23.612297,epoch time: 0:01:47.907833,used: 0:40:47.282221,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927945, 'recall': 0.9928148, 'specificity': 0.9928148, 'f1': 0.99280083, 'auroc': 0.9996629, 'binary_precision': 0.9947815, 'binary_recall': 0.9909032, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.99283856}
confusion matrix:
      0     1
0  1509     8
1    14  1525
---- Validation: 
scalar performance:
{'acc': 0.75135136, 'precision': 0.80478644, 'recall': 0.7492331, 'specificity': 0.7492331, 'f1': 0.73888123, 'auroc': 0.88829863, 'binary_precision': 0.9299191, 'binary_recall': 0.53822154, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.68181825}
confusion matrix:
     0    1
0  628   26
1  296  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73478264, 'precision': 0.8148768, 'recall': 0.73478264, 'specificity': 0.73478264, 'f1': 0.7167716, 'auroc': 0.9214556, 'binary_precision': 0.9736842, 'binary_recall': 0.4826087, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.64534885}
confusion matrix:
     0    1
0  227    3
1  119  111
early stop counter: 8
val acc:0.7513513565063477, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 25,now: 2024-07-29 09:33:02.381599,epoch time: 0:01:38.769302,used: 0:42:26.051523,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937992, 'recall': 0.9937706, 'specificity': 0.9937706, 'f1': 0.9937822, 'auroc': 0.99985564, 'binary_precision': 0.992228, 'binary_recall': 0.99545157, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9938372}
confusion matrix:
      0     1
0  1505    12
1     7  1532
---- Validation: 
scalar performance:
{'acc': 0.84247106, 'precision': 0.8592423, 'recall': 0.8413853, 'specificity': 0.8413853, 'f1': 0.8402997, 'auroc': 0.93638813, 'binary_precision': 0.93439364, 'binary_recall': 0.73322934, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.8216783}
confusion matrix:
     0    1
0  621   33
1  171  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130435, 'precision': 0.8470534, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.8083482, 'auroc': 0.9220605, 'binary_precision': 0.9556962, 'binary_recall': 0.65652174, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.77835053}
confusion matrix:
     0    1
0  223    7
1   79  151
early stop counter: 9
val acc:0.8424710631370544, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 26,now: 2024-07-29 09:34:40.810474,epoch time: 0:01:38.428875,used: 0:44:04.480398,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9903038, 'recall': 0.99025345, 'specificity': 0.99025345, 'f1': 0.9901832, 'auroc': 0.9997897, 'binary_precision': 1.0, 'binary_recall': 0.98050684, 'binary_specificity': 1.0, 'binary_f1_score': 0.9901575}
confusion matrix:
      0     1
0  1517     0
1    30  1509
---- Validation: 
scalar performance:
{'acc': 0.5868726, 'precision': 0.7660146, 'recall': 0.5827143, 'specificity': 0.5827143, 'f1': 0.49834877, 'auroc': 0.90250623, 'binary_precision': 0.9818182, 'binary_recall': 0.16848674, 'binary_specificity': 0.9969419, 'binary_f1_score': 0.28761652}
confusion matrix:
     0    1
0  652    2
1  533  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5173913, 'precision': 0.64734143, 'recall': 0.5173913, 'specificity': 0.5173913, 'f1': 0.38088077, 'auroc': 0.88353026, 'binary_precision': 0.78571427, 'binary_recall': 0.047826085, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.090163924}
confusion matrix:
     0   1
0  227   3
1  219  11
early stop counter: 10
val acc:0.5868725776672363, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 27,now: 2024-07-29 09:36:14.077409,epoch time: 0:01:33.266935,used: 0:45:37.747333,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.98509616, 'recall': 0.98489505, 'specificity': 0.98489505, 'f1': 0.98494446, 'auroc': 0.99921227, 'binary_precision': 0.9782191, 'binary_recall': 0.99220276, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9851613}
confusion matrix:
      0     1
0  1483    34
1    12  1527
---- Validation: 
scalar performance:
{'acc': 0.8440154, 'precision': 0.8688575, 'recall': 0.84271276, 'specificity': 0.84271276, 'f1': 0.8409772, 'auroc': 0.9437065, 'binary_precision': 0.9621053, 'binary_recall': 0.7129485, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.81899637}
confusion matrix:
     0    1
0  636   18
1  184  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73913044, 'precision': 0.82857144, 'recall': 0.73913044, 'specificity': 0.73913044, 'f1': 0.72008115, 'auroc': 0.9318336, 'binary_precision': 1.0, 'binary_recall': 0.47826087, 'binary_specificity': 1.0, 'binary_f1_score': 0.64705884}
confusion matrix:
     0    1
0  230    0
1  120  110
early stop counter: 11
val acc:0.8440154194831848, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 28,now: 2024-07-29 09:37:56.597473,epoch time: 0:01:42.520064,used: 0:47:20.267397,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941416, 'recall': 0.9940908, 'specificity': 0.9940908, 'f1': 0.9941094, 'auroc': 0.9998878, 'binary_precision': 0.99159664, 'binary_recall': 0.9967511, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9941672}
confusion matrix:
      0     1
0  1504    13
1     5  1534
---- Validation: 
scalar performance:
{'acc': 0.8208494, 'precision': 0.8510144, 'recall': 0.81937385, 'specificity': 0.81937385, 'f1': 0.816427, 'auroc': 0.9240853, 'binary_precision': 0.95143485, 'binary_recall': 0.6723869, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.7879341}
confusion matrix:
     0    1
0  632   22
1  210  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7304348, 'precision': 0.81275654, 'recall': 0.7304348, 'specificity': 0.7304348, 'f1': 0.711447, 'auroc': 0.91162574, 'binary_precision': 0.97321427, 'binary_recall': 0.47391304, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.63742685}
confusion matrix:
     0    1
0  227    3
1  121  109
early stop counter: 12
val acc:0.8208494186401367, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 29,now: 2024-07-29 09:39:40.636099,epoch time: 0:01:44.038626,used: 0:49:04.306023,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9916482, 'recall': 0.99143505, 'specificity': 0.99143505, 'f1': 0.99149024, 'auroc': 0.9999027, 'binary_precision': 0.98463506, 'binary_recall': 0.9987013, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.9916183}
confusion matrix:
      0     1
0  1492    24
1     2  1538
---- Validation: 
scalar performance:
{'acc': 0.8694981, 'precision': 0.87217957, 'recall': 0.869074, 'specificity': 0.869074, 'f1': 0.86915827, 'auroc': 0.9425019, 'binary_precision': 0.9013606, 'binary_recall': 0.82683307, 'binary_specificity': 0.91131496, 'binary_f1_score': 0.8624898}
confusion matrix:
     0    1
0  596   58
1  111  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8555968, 'recall': 0.84782606, 'specificity': 0.84782606, 'f1': 0.8469902, 'auroc': 0.9201701, 'binary_precision': 0.90816325, 'binary_recall': 0.773913, 'binary_specificity': 0.9217391, 'binary_f1_score': 0.8356808}
confusion matrix:
     0    1
0  212   18
1   52  178
early stop counter: 13
val acc:0.869498074054718, best validation acc: 0.8864864706993103, corresponding to test acc:                         0.832608699798584 / 0.8826087117195129
after epoch: 30,now: 2024-07-29 09:41:19.175143,epoch time: 0:01:38.539044,used: 0:50:42.845067,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_50_36_seed_9_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:50:42.845067 at 2024-07-29 09:41:19.175143
persisted model performance metric: 

scalar performance:
{'acc': 0.8326087, 'precision': 0.86764246, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.8285235, 'auroc': 0.92888474, 'binary_precision': 0.9811321, 'binary_recall': 0.67826086, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  227    3
1   74  156
oracle model performance metric: 

scalar performance:
{'acc': 0.8826087, 'precision': 0.89016116, 'recall': 0.88260865, 'specificity': 0.88260865, 'f1': 0.8820378, 'auroc': 0.9369565, 'binary_precision': 0.9444444, 'binary_recall': 0.8130435, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.87383175}
confusion matrix:
     0    1
0  219   11
1   43  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456214 KiB |  13219 MiB | 739284 GiB | 739284 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 730560 GiB | 730559 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456214 KiB |  13219 MiB | 739284 GiB | 739284 GiB |
|       from large pool | 415616 KiB |  13181 MiB | 730560 GiB | 730559 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 737329 GiB | 737329 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 728623 GiB | 728623 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB | 136666 MiB | 122190 MiB |
|       from large pool |  14410 MiB |  14422 MiB | 136460 MiB | 122050 MiB |
|       from small pool |     66 MiB |     70 MiB |    206 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473577 KiB |   1260 MiB | 528324 GiB | 528323 GiB |
|       from large pool | 462976 KiB |   1252 MiB | 519544 GiB | 519544 GiB |
|       from small pool |  10601 KiB |     46 MiB |   8779 GiB |   8779 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129766 K  |  129764 K  |
|       from large pool |     187    |    1413    |   65973 K  |   65972 K  |
|       from small pool |    1123    |    1419    |   63793 K  |   63791 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129766 K  |  129764 K  |
|       from large pool |     187    |    1413    |   65973 K  |   65972 K  |
|       from small pool |    1123    |    1419    |   63793 K  |   63791 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    5777    |    5142    |
|       from large pool |     602    |     602    |    5674    |    5072    |
|       from small pool |      33    |      35    |     103    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      96    |     655    |   86567 K  |   86567 K  |
|       from large pool |      38    |     604    |   49001 K  |   49001 K  |
|       from small pool |      58    |     237    |   37566 K  |   37566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 739284 GiB | 739284 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 730560 GiB | 730560 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 739284 GiB | 739284 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 730560 GiB | 730560 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737329 GiB | 737329 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728623 GiB | 728623 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB | 136666 MiB | 135758 MiB |
|       from large pool |    858 MiB |  14422 MiB | 136460 MiB | 135602 MiB |
|       from small pool |     50 MiB |     70 MiB |    206 MiB |    156 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 528324 GiB | 528324 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 519544 GiB | 519544 GiB |
|       from small pool |      0 KiB |     46 MiB |   8779 GiB |   8779 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129766 K  |  129766 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63793 K  |   63793 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129766 K  |  129766 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63793 K  |   63793 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    5777    |    5713    |
|       from large pool |      39    |     602    |    5674    |    5635    |
|       from small pool |      25    |      35    |     103    |      78    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   86567 K  |   86567 K  |
|       from large pool |       3    |     604    |   49001 K  |   49001 K  |
|       from small pool |       0    |     237    |   37566 K  |   37566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 739284 GiB | 739284 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 730560 GiB | 730560 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 739284 GiB | 739284 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 730560 GiB | 730560 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737329 GiB | 737329 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728623 GiB | 728623 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB | 136666 MiB | 135758 MiB |
|       from large pool |    858 MiB |  14422 MiB | 136460 MiB | 135602 MiB |
|       from small pool |     50 MiB |     70 MiB |    206 MiB |    156 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 528324 GiB | 528324 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 519544 GiB | 519544 GiB |
|       from small pool |      0 KiB |     46 MiB |   8779 GiB |   8779 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129766 K  |  129766 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63793 K  |   63793 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129766 K  |  129766 K  |
|       from large pool |       2    |    1413    |   65973 K  |   65973 K  |
|       from small pool |       0    |    1419    |   63793 K  |   63793 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    5777    |    5713    |
|       from large pool |      39    |     602    |    5674    |    5635    |
|       from small pool |      25    |      35    |     103    |      78    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   86567 K  |   86567 K  |
|       from large pool |       3    |     604    |   49001 K  |   49001 K  |
|       from small pool |       0    |     237    |   37566 K  |   37566 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369

 Experiment start at: 2024-07-29 09:42:00.421057
before training, model accuracy: 0.5113122463226318
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9292328, 'precision': 0.9367625, 'recall': 0.92958426, 'specificity': 0.92958426, 'f1': 0.928964, 'auroc': 0.98933804, 'binary_precision': 0.99544764, 'binary_recall': 0.86315787, 'binary_specificity': 0.99601066, 'binary_f1_score': 0.92459476}
confusion matrix:
      0     1
0  1498     6
1   208  1312
---- Validation: 
scalar performance:
{'acc': 0.8229329, 'precision': 0.8225966, 'recall': 0.82271695, 'specificity': 0.82271695, 'f1': 0.8226522, 'auroc': 0.8895483, 'binary_precision': 0.81361425, 'binary_recall': 0.8175896, 'binary_specificity': 0.8278443, 'binary_f1_score': 0.81559706}
confusion matrix:
     0    1
0  553  115
1  112  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.8426392, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.84151214, 'auroc': 0.9233022, 'binary_precision': 0.861244, 'binary_recall': 0.81447965, 'binary_specificity': 0.8687783, 'binary_f1_score': 0.8372093}
confusion matrix:
     0    1
0  192   29
1   41  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 09:43:47.488541,epoch time: 0:01:47.067484,used: 0:01:47.067484,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94775134, 'precision': 0.951756, 'recall': 0.9480053, 'specificity': 0.9480053, 'f1': 0.9476546, 'auroc': 0.9945072, 'binary_precision': 0.9956332, 'binary_recall': 0.9, 'binary_specificity': 0.99601066, 'binary_f1_score': 0.94540423}
confusion matrix:
      0     1
0  1498     6
1   152  1368
---- Validation: 
scalar performance:
{'acc': 0.75429016, 'precision': 0.80195117, 'recall': 0.7455919, 'specificity': 0.7455919, 'f1': 0.7395484, 'auroc': 0.88227844, 'binary_precision': 0.91184574, 'binary_recall': 0.53908795, 'binary_specificity': 0.9520958, 'binary_f1_score': 0.67758447}
confusion matrix:
     0    1
0  636   32
1  283  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986425, 'precision': 0.84239435, 'recall': 0.7986425, 'specificity': 0.7986425, 'f1': 0.7919978, 'auroc': 0.92369115, 'binary_precision': 0.96478873, 'binary_recall': 0.6199095, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.75482094}
confusion matrix:
     0    1
0  216    5
1   84  137
early stop counter: 1
val acc:0.7542901635169983, best validation acc: 0.8229328989982605, corresponding to test acc:                         0.8416289687156677 / 0.8416289687156677
after epoch: 2,now: 2024-07-29 09:45:18.692318,epoch time: 0:01:31.203777,used: 0:03:18.271261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96395504, 'precision': 0.9660428, 'recall': 0.96413773, 'specificity': 0.96413773, 'f1': 0.9639238, 'auroc': 0.9955425, 'binary_precision': 0.9985866, 'binary_recall': 0.92960525, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.96286196}
confusion matrix:
      0     1
0  1502     2
1   107  1413
---- Validation: 
scalar performance:
{'acc': 0.78861153, 'precision': 0.8118622, 'recall': 0.78260744, 'specificity': 0.78260744, 'f1': 0.78189325, 'auroc': 0.879591, 'binary_precision': 0.8871332, 'binary_recall': 0.64006513, 'binary_specificity': 0.9251497, 'binary_f1_score': 0.74361396}
confusion matrix:
     0    1
0  618   50
1  221  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82126695, 'precision': 0.8254314, 'recall': 0.821267, 'specificity': 0.821267, 'f1': 0.8206934, 'auroc': 0.9092361, 'binary_precision': 0.8622449, 'binary_recall': 0.7647059, 'binary_specificity': 0.87782806, 'binary_f1_score': 0.8105516}
confusion matrix:
     0    1
0  194   27
1   52  169
early stop counter: 2
val acc:0.7886115312576294, best validation acc: 0.8229328989982605, corresponding to test acc:                         0.8416289687156677 / 0.8416289687156677
after epoch: 3,now: 2024-07-29 09:46:57.096814,epoch time: 0:01:38.404496,used: 0:04:56.675757,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9348545, 'precision': 0.9415666, 'recall': 0.9345325, 'specificity': 0.9345325, 'f1': 0.93457115, 'auroc': 0.9977219, 'binary_precision': 0.8884322, 'binary_recall': 0.99539477, 'binary_specificity': 0.8736702, 'binary_f1_score': 0.93887687}
confusion matrix:
      0     1
0  1314   190
1     7  1513
---- Validation: 
scalar performance:
{'acc': 0.83073324, 'precision': 0.8386364, 'recall': 0.8339542, 'specificity': 0.8339542, 'f1': 0.8304435, 'auroc': 0.9159897, 'binary_precision': 0.77531207, 'binary_recall': 0.91042346, 'binary_specificity': 0.75748503, 'binary_f1_score': 0.8374532}
confusion matrix:
     0    1
0  506  162
1   55  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371041, 'precision': 0.8418354, 'recall': 0.8371041, 'specificity': 0.8371041, 'f1': 0.8365385, 'auroc': 0.9369587, 'binary_precision': 0.8016194, 'binary_recall': 0.8959276, 'binary_specificity': 0.77828056, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  172   49
1   23  198
better model found
persisted
after epoch: 4,now: 2024-07-29 09:48:30.400885,epoch time: 0:01:33.304071,used: 0:06:29.979828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96395504, 'precision': 0.96398723, 'recall': 0.9639838, 'specificity': 0.9639838, 'f1': 0.96395504, 'auroc': 0.99416995, 'binary_precision': 0.96939456, 'binary_recall': 0.95855266, 'binary_specificity': 0.9694149, 'binary_f1_score': 0.96394306}
confusion matrix:
      0     1
0  1458    46
1    63  1457
---- Validation: 
scalar performance:
{'acc': 0.83775353, 'precision': 0.8388177, 'recall': 0.83634603, 'specificity': 0.83634603, 'f1': 0.83698547, 'auroc': 0.9038948, 'binary_precision': 0.85, 'binary_recall': 0.8029316, 'binary_specificity': 0.86976045, 'binary_f1_score': 0.82579565}
confusion matrix:
     0    1
0  581   87
1  121  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84841627, 'precision': 0.8484234, 'recall': 0.8484163, 'specificity': 0.8484163, 'f1': 0.8484155, 'auroc': 0.92225796, 'binary_precision': 0.85, 'binary_recall': 0.84615386, 'binary_specificity': 0.85067874, 'binary_f1_score': 0.8480725}
confusion matrix:
     0    1
0  188   33
1   34  187
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 09:50:09.513462,epoch time: 0:01:39.112577,used: 0:08:09.092405,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98048943, 'precision': 0.98056036, 'recall': 0.9804627, 'specificity': 0.9804627, 'f1': 0.98048735, 'auroc': 0.99851626, 'binary_precision': 0.97589576, 'binary_recall': 0.9855263, 'binary_specificity': 0.97539896, 'binary_f1_score': 0.9806874}
confusion matrix:
      0     1
0  1467    37
1    22  1498
---- Validation: 
scalar performance:
{'acc': 0.8478939, 'precision': 0.85162985, 'recall': 0.84561574, 'specificity': 0.84561574, 'f1': 0.84666, 'auroc': 0.91263723, 'binary_precision': 0.87884265, 'binary_recall': 0.79153097, 'binary_specificity': 0.8997006, 'binary_f1_score': 0.8329048}
confusion matrix:
     0    1
0  601   67
1  128  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8393665, 'precision': 0.83937347, 'recall': 0.83936656, 'specificity': 0.83936656, 'f1': 0.8393657, 'auroc': 0.91058743, 'binary_precision': 0.84090906, 'binary_recall': 0.8371041, 'binary_specificity': 0.84162897, 'binary_f1_score': 0.8390023}
confusion matrix:
     0    1
0  186   35
1   36  185
better model found
persisted
after epoch: 6,now: 2024-07-29 09:51:46.855325,epoch time: 0:01:37.341863,used: 0:09:46.434268,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9811508, 'precision': 0.981465, 'recall': 0.981089, 'specificity': 0.981089, 'f1': 0.98114544, 'auroc': 0.99878263, 'binary_precision': 0.97041804, 'binary_recall': 0.99276316, 'binary_specificity': 0.9694149, 'binary_f1_score': 0.98146343}
confusion matrix:
      0     1
0  1458    46
1    11  1509
---- Validation: 
scalar performance:
{'acc': 0.7964119, 'precision': 0.83726394, 'recall': 0.7889075, 'specificity': 0.7889075, 'f1': 0.78688896, 'auroc': 0.9036479, 'binary_precision': 0.94458437, 'binary_recall': 0.6107492, 'binary_specificity': 0.9670659, 'binary_f1_score': 0.7418397}
confusion matrix:
     0    1
0  646   22
1  239  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.86099076, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.82921886, 'auroc': 0.9311235, 'binary_precision': 0.9622642, 'binary_recall': 0.6923077, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.8052632}
confusion matrix:
     0    1
0  215    6
1   68  153
early stop counter: 1
val acc:0.7964118719100952, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.848416268825531
after epoch: 7,now: 2024-07-29 09:53:21.701473,epoch time: 0:01:34.846148,used: 0:11:21.280416,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98710316, 'precision': 0.98725617, 'recall': 0.9871571, 'specificity': 0.9871571, 'f1': 0.98710287, 'auroc': 0.99937487, 'binary_precision': 0.9973136, 'binary_recall': 0.9769737, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9870389}
confusion matrix:
      0     1
0  1500     4
1    35  1485
---- Validation: 
scalar performance:
{'acc': 0.83073324, 'precision': 0.8492005, 'recall': 0.82579136, 'specificity': 0.82579136, 'f1': 0.8267243, 'auroc': 0.9101845, 'binary_precision': 0.91966176, 'binary_recall': 0.70846903, 'binary_specificity': 0.94311374, 'binary_f1_score': 0.800368}
confusion matrix:
     0    1
0  630   38
1  179  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.8724301, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.86101705, 'auroc': 0.9358326, 'binary_precision': 0.9347826, 'binary_recall': 0.77828056, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.8493827}
confusion matrix:
     0    1
0  209   12
1   49  172
new oracle model saved
early stop counter: 2
val acc:0.8307332396507263, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 8,now: 2024-07-29 09:55:02.467643,epoch time: 0:01:40.766170,used: 0:13:02.046586,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984127, 'precision': 0.9844314, 'recall': 0.9842, 'specificity': 0.9842, 'f1': 0.9841258, 'auroc': 0.9993588, 'binary_precision': 0.9979702, 'binary_recall': 0.97039473, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.9839893}
confusion matrix:
      0     1
0  1501     3
1    45  1475
---- Validation: 
scalar performance:
{'acc': 0.78081125, 'precision': 0.8346163, 'recall': 0.77216005, 'specificity': 0.77216005, 'f1': 0.7676606, 'auroc': 0.9187643, 'binary_precision': 0.9586777, 'binary_recall': 0.56677526, 'binary_specificity': 0.9775449, 'binary_f1_score': 0.7123849}
confusion matrix:
     0    1
0  653   15
1  266  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7669683, 'precision': 0.8339908, 'recall': 0.76696837, 'specificity': 0.76696837, 'f1': 0.7546601, 'auroc': 0.9289941, 'binary_precision': 0.9836066, 'binary_recall': 0.54298645, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.6997085}
confusion matrix:
     0    1
0  219    2
1  101  120
early stop counter: 3
val acc:0.7808112502098083, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 9,now: 2024-07-29 09:56:41.865715,epoch time: 0:01:39.398072,used: 0:14:41.444658,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98280424, 'precision': 0.9831759, 'recall': 0.9828843, 'specificity': 0.9828843, 'f1': 0.98280257, 'auroc': 0.9989134, 'binary_precision': 0.99796474, 'binary_recall': 0.9677632, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.982632}
confusion matrix:
      0     1
0  1501     3
1    49  1471
---- Validation: 
scalar performance:
{'acc': 0.6146646, 'precision': 0.7650988, 'recall': 0.59811485, 'specificity': 0.59811485, 'f1': 0.5330372, 'auroc': 0.8785353, 'binary_precision': 0.95454544, 'binary_recall': 0.20521173, 'binary_specificity': 0.99101794, 'binary_f1_score': 0.3378016}
confusion matrix:
     0    1
0  662    6
1  488  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72171944, 'precision': 0.8166374, 'recall': 0.72171944, 'specificity': 0.72171944, 'f1': 0.699175, 'auroc': 0.92665994, 'binary_precision': 0.99, 'binary_recall': 0.4479638, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.6168224}
confusion matrix:
     0   1
0  220   1
1  122  99
early stop counter: 4
val acc:0.614664614200592, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 10,now: 2024-07-29 09:58:23.372736,epoch time: 0:01:41.507021,used: 0:16:22.951679,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9857804, 'precision': 0.98593044, 'recall': 0.9857398, 'specificity': 0.9857398, 'f1': 0.9857781, 'auroc': 0.9995897, 'binary_precision': 0.9786131, 'binary_recall': 0.9934211, 'binary_specificity': 0.9780585, 'binary_f1_score': 0.9859615}
confusion matrix:
      0     1
0  1471    33
1    10  1510
---- Validation: 
scalar performance:
{'acc': 0.81669265, 'precision': 0.8409765, 'recall': 0.810936, 'specificity': 0.810936, 'f1': 0.8111826, 'auroc': 0.9084705, 'binary_precision': 0.922049, 'binary_recall': 0.6742671, 'binary_specificity': 0.9476048, 'binary_f1_score': 0.77892756}
confusion matrix:
     0    1
0  633   35
1  200  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7873303, 'precision': 0.8386054, 'recall': 0.7873303, 'specificity': 0.7873303, 'f1': 0.7789624, 'auroc': 0.9355459, 'binary_precision': 0.97037035, 'binary_recall': 0.5927602, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.73595506}
confusion matrix:
     0    1
0  217    4
1   90  131
early stop counter: 5
val acc:0.8166926503181458, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 11,now: 2024-07-29 10:00:04.349985,epoch time: 0:01:40.977249,used: 0:18:03.928928,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98941797, 'precision': 0.9894558, 'recall': 0.9894002, 'specificity': 0.9894002, 'f1': 0.9894172, 'auroc': 0.9995976, 'binary_precision': 0.9862745, 'binary_recall': 0.99276316, 'binary_specificity': 0.98603725, 'binary_f1_score': 0.98950815}
confusion matrix:
      0     1
0  1483    21
1    11  1509
---- Validation: 
scalar performance:
{'acc': 0.79875195, 'precision': 0.8215624, 'recall': 0.7929304, 'specificity': 0.7929304, 'f1': 0.7926456, 'auroc': 0.9025459, 'binary_precision': 0.8973214, 'binary_recall': 0.6547231, 'binary_specificity': 0.93113774, 'binary_f1_score': 0.75706214}
confusion matrix:
     0    1
0  622   46
1  212  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7760181, 'precision': 0.8021562, 'recall': 0.77601814, 'specificity': 0.77601814, 'f1': 0.77106714, 'auroc': 0.89625514, 'binary_precision': 0.89102566, 'binary_recall': 0.6289593, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.7374006}
confusion matrix:
     0    1
0  204   17
1   82  139
early stop counter: 6
val acc:0.798751950263977, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 12,now: 2024-07-29 10:01:41.618794,epoch time: 0:01:37.268809,used: 0:19:41.197737,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9808201, 'precision': 0.98134613, 'recall': 0.98091406, 'specificity': 0.98091406, 'f1': 0.9808171, 'auroc': 0.999175, 'binary_precision': 0.99863577, 'binary_recall': 0.9631579, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.98057604}
confusion matrix:
      0     1
0  1502     2
1    56  1464
---- Validation: 
scalar performance:
{'acc': 0.70670825, 'precision': 0.79400706, 'recall': 0.6947985, 'specificity': 0.6947985, 'f1': 0.67507637, 'auroc': 0.88473606, 'binary_precision': 0.94402987, 'binary_recall': 0.41205212, 'binary_specificity': 0.9775449, 'binary_f1_score': 0.57369614}
confusion matrix:
     0    1
0  653   15
1  361  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7013575, 'precision': 0.8130312, 'recall': 0.7013575, 'specificity': 0.7013575, 'f1': 0.6721142, 'auroc': 0.9365236, 'binary_precision': 1.0, 'binary_recall': 0.40271494, 'binary_specificity': 1.0, 'binary_f1_score': 0.57419354}
confusion matrix:
     0   1
0  221   0
1  132  89
early stop counter: 7
val acc:0.7067082524299622, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 13,now: 2024-07-29 10:03:20.924660,epoch time: 0:01:39.305866,used: 0:21:20.503603,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9814815, 'precision': 0.9819268, 'recall': 0.98156846, 'specificity': 0.98156846, 'f1': 0.9814791, 'auroc': 0.99957526, 'binary_precision': 0.9979592, 'binary_recall': 0.9651316, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.9812709}
confusion matrix:
      0     1
0  1501     3
1    53  1467
---- Validation: 
scalar performance:
{'acc': 0.6630265, 'precision': 0.77777016, 'recall': 0.6489326, 'specificity': 0.6489326, 'f1': 0.61222994, 'auroc': 0.8851986, 'binary_precision': 0.9460784, 'binary_recall': 0.31433225, 'binary_specificity': 0.9835329, 'binary_f1_score': 0.47188264}
confusion matrix:
     0    1
0  657   11
1  421  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52262443, 'precision': 0.7141473, 'recall': 0.52262443, 'specificity': 0.52262443, 'f1': 0.38515195, 'auroc': 0.90407646, 'binary_precision': 0.9166667, 'binary_recall': 0.049773756, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.094420604}
confusion matrix:
     0   1
0  220   1
1  210  11
early stop counter: 8
val acc:0.6630265116691589, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 14,now: 2024-07-29 10:04:59.241645,epoch time: 0:01:38.316985,used: 0:22:58.820588,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9884259, 'precision': 0.98860097, 'recall': 0.98838186, 'specificity': 0.98838186, 'f1': 0.9884238, 'auroc': 0.99971175, 'binary_precision': 0.98058254, 'binary_recall': 0.99671054, 'binary_specificity': 0.9800532, 'binary_f1_score': 0.9885808}
confusion matrix:
      0     1
0  1474    30
1     5  1515
---- Validation: 
scalar performance:
{'acc': 0.8385335, 'precision': 0.8382057, 'recall': 0.83847696, 'specificity': 0.83847696, 'f1': 0.8383162, 'auroc': 0.9184083, 'binary_precision': 0.8276973, 'binary_recall': 0.8371335, 'binary_specificity': 0.8398204, 'binary_f1_score': 0.83238864}
confusion matrix:
     0    1
0  561  107
1  100  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.83724695, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.8319979, 'auroc': 0.8969513, 'binary_precision': 0.7975708, 'binary_recall': 0.8914027, 'binary_specificity': 0.77375567, 'binary_f1_score': 0.8418803}
confusion matrix:
     0    1
0  171   50
1   24  197
early stop counter: 9
val acc:0.8385335206985474, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 15,now: 2024-07-29 10:06:35.885002,epoch time: 0:01:36.643357,used: 0:24:35.463945,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9914021, 'precision': 0.99144113, 'recall': 0.9914334, 'specificity': 0.9914334, 'f1': 0.9914021, 'auroc': 0.9997795, 'binary_precision': 0.99733686, 'binary_recall': 0.9855263, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9913964}
confusion matrix:
      0     1
0  1500     4
1    22  1498
---- Validation: 
scalar performance:
{'acc': 0.72386897, 'precision': 0.79920924, 'recall': 0.7129113, 'specificity': 0.7129113, 'f1': 0.6984812, 'auroc': 0.8952998, 'binary_precision': 0.9391892, 'binary_recall': 0.45276874, 'binary_specificity': 0.9730539, 'binary_f1_score': 0.610989}
confusion matrix:
     0    1
0  650   18
1  336  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7556561, 'precision': 0.7964717, 'recall': 0.7556561, 'specificity': 0.7556561, 'f1': 0.7469466, 'auroc': 0.88159543, 'binary_precision': 0.9064748, 'binary_recall': 0.5701358, 'binary_specificity': 0.9411765, 'binary_f1_score': 0.70000005}
confusion matrix:
     0    1
0  208   13
1   95  126
early stop counter: 10
val acc:0.7238689661026001, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 16,now: 2024-07-29 10:08:06.446758,epoch time: 0:01:30.561756,used: 0:26:06.025701,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9923942, 'precision': 0.9923909, 'recall': 0.9924027, 'specificity': 0.9924027, 'f1': 0.9923941, 'auroc': 0.9997686, 'binary_precision': 0.9940594, 'binary_recall': 0.9907895, 'binary_specificity': 0.99401593, 'binary_f1_score': 0.99242175}
confusion matrix:
      0     1
0  1495     9
1    14  1506
---- Validation: 
scalar performance:
{'acc': 0.7870515, 'precision': 0.8342917, 'recall': 0.77893806, 'specificity': 0.77893806, 'f1': 0.7756504, 'auroc': 0.9182181, 'binary_precision': 0.9498681, 'binary_recall': 0.5863192, 'binary_specificity': 0.9715569, 'binary_f1_score': 0.7250755}
confusion matrix:
     0    1
0  649   19
1  254  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74660635, 'precision': 0.8318318, 'recall': 0.74660635, 'specificity': 0.74660635, 'f1': 0.72922003, 'auroc': 0.9442681, 'binary_precision': 1.0, 'binary_recall': 0.49321267, 'binary_specificity': 1.0, 'binary_f1_score': 0.660606}
confusion matrix:
     0    1
0  221    0
1  112  109
early stop counter: 11
val acc:0.7870514988899231, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 17,now: 2024-07-29 10:09:45.535169,epoch time: 0:01:39.088411,used: 0:27:45.114112,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9930556, 'precision': 0.9930697, 'recall': 0.9930781, 'specificity': 0.9930781, 'f1': 0.9930556, 'auroc': 0.9998364, 'binary_precision': 0.99734575, 'binary_recall': 0.9888158, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9930625}
confusion matrix:
      0     1
0  1500     4
1    17  1503
---- Validation: 
scalar performance:
{'acc': 0.76911074, 'precision': 0.83025175, 'recall': 0.7598134, 'specificity': 0.7598134, 'f1': 0.75335705, 'auroc': 0.9277408, 'binary_precision': 0.9622093, 'binary_recall': 0.53908795, 'binary_specificity': 0.9805389, 'binary_f1_score': 0.691023}
confusion matrix:
     0    1
0  655   13
1  283  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.520362, 'precision': 0.6783217, 'recall': 0.520362, 'specificity': 0.520362, 'f1': 0.3839316, 'auroc': 0.89219606, 'binary_precision': 0.84615386, 'binary_recall': 0.049773756, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.094017096}
confusion matrix:
     0   1
0  219   2
1  210  11
early stop counter: 12
val acc:0.7691107392311096, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 18,now: 2024-07-29 10:11:22.411687,epoch time: 0:01:36.876518,used: 0:29:21.990630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99007934, 'precision': 0.99021983, 'recall': 0.99004054, 'specificity': 0.99004054, 'f1': 0.99007785, 'auroc': 0.9998237, 'binary_precision': 0.9831388, 'binary_recall': 0.9973684, 'binary_specificity': 0.98271275, 'binary_f1_score': 0.9902025}
confusion matrix:
      0     1
0  1478    26
1     4  1516
---- Validation: 
scalar performance:
{'acc': 0.81279254, 'precision': 0.83286875, 'recall': 0.80745673, 'specificity': 0.80745673, 'f1': 0.8078307, 'auroc': 0.9063426, 'binary_precision': 0.9047619, 'binary_recall': 0.6807818, 'binary_specificity': 0.93413174, 'binary_f1_score': 0.7769517}
confusion matrix:
     0    1
0  624   44
1  196  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7669683, 'precision': 0.7889849, 'recall': 0.76696837, 'specificity': 0.76696837, 'f1': 0.7624437, 'auroc': 0.8696126, 'binary_precision': 0.86875, 'binary_recall': 0.6289593, 'binary_specificity': 0.9049774, 'binary_f1_score': 0.7296588}
confusion matrix:
     0    1
0  200   21
1   82  139
early stop counter: 13
val acc:0.8127925395965576, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 19,now: 2024-07-29 10:12:57.442894,epoch time: 0:01:35.031207,used: 0:30:57.021837,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9880952, 'precision': 0.9881762, 'recall': 0.9880669, 'specificity': 0.9880669, 'f1': 0.98809385, 'auroc': 0.99959713, 'binary_precision': 0.98307294, 'binary_recall': 0.9934211, 'binary_specificity': 0.98271275, 'binary_f1_score': 0.98821986}
confusion matrix:
      0     1
0  1478    26
1    10  1510
---- Validation: 
scalar performance:
{'acc': 0.82683307, 'precision': 0.85244304, 'recall': 0.8210615, 'specificity': 0.8210615, 'f1': 0.8215788, 'auroc': 0.91797674, 'binary_precision': 0.9375, 'binary_recall': 0.6840391, 'binary_specificity': 0.9580838, 'binary_f1_score': 0.7909605}
confusion matrix:
     0    1
0  640   28
1  194  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.86506945, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.8390453, 'auroc': 0.94363344, 'binary_precision': 0.95757574, 'binary_recall': 0.71493214, 'binary_specificity': 0.9683258, 'binary_f1_score': 0.81865287}
confusion matrix:
     0    1
0  214    7
1   63  158
early stop counter: 14
val acc:0.8268330693244934, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 20,now: 2024-07-29 10:14:33.154917,epoch time: 0:01:35.712023,used: 0:32:32.733860,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9917328, 'precision': 0.991766, 'recall': 0.99176234, 'specificity': 0.99176234, 'f1': 0.99173284, 'auroc': 0.99959934, 'binary_precision': 0.99733865, 'binary_recall': 0.98618424, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9917301}
confusion matrix:
      0     1
0  1500     4
1    21  1499
---- Validation: 
scalar performance:
{'acc': 0.7269891, 'precision': 0.80495536, 'recall': 0.7159711, 'specificity': 0.7159711, 'f1': 0.7015924, 'auroc': 0.9179646, 'binary_precision': 0.9489796, 'binary_recall': 0.45439738, 'binary_specificity': 0.9775449, 'binary_f1_score': 0.6145374}
confusion matrix:
     0    1
0  653   15
1  335  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6447964, 'precision': 0.77807486, 'recall': 0.6447964, 'specificity': 0.6447964, 'f1': 0.596441, 'auroc': 0.9106283, 'binary_precision': 0.9705882, 'binary_recall': 0.29864255, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.45674744}
confusion matrix:
     0   1
0  219   2
1  155  66
early stop counter: 15
val acc:0.7269890904426575, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 21,now: 2024-07-29 10:16:12.716733,epoch time: 0:01:39.561816,used: 0:34:12.295676,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9950397, 'precision': 0.9950535, 'recall': 0.99503076, 'specificity': 0.99503076, 'f1': 0.99503946, 'auroc': 0.9999012, 'binary_precision': 0.9934426, 'binary_recall': 0.99671054, 'binary_specificity': 0.99335104, 'binary_f1_score': 0.9950739}
confusion matrix:
      0     1
0  1494    10
1     5  1515
---- Validation: 
scalar performance:
{'acc': 0.7948518, 'precision': 0.83052707, 'recall': 0.78773963, 'specificity': 0.78773963, 'f1': 0.7861223, 'auroc': 0.9277561, 'binary_precision': 0.9290953, 'binary_recall': 0.6188925, 'binary_specificity': 0.95658684, 'binary_f1_score': 0.742913}
confusion matrix:
     0    1
0  639   29
1  234  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.699095, 'precision': 0.8019876, 'recall': 0.699095, 'specificity': 0.699095, 'f1': 0.6710776, 'auroc': 0.9304273, 'binary_precision': 0.9782609, 'binary_recall': 0.40723982, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.57507986}
confusion matrix:
     0   1
0  219   2
1  131  90
early stop counter: 16
val acc:0.7948517799377441, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 22,now: 2024-07-29 10:17:51.499162,epoch time: 0:01:38.782429,used: 0:35:51.078105,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.9910786, 'recall': 0.9910904, 'specificity': 0.9910904, 'f1': 0.9910714, 'auroc': 0.99972486, 'binary_precision': 0.99469846, 'binary_recall': 0.9875, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.9910862}
confusion matrix:
      0     1
0  1496     8
1    19  1501
---- Validation: 
scalar performance:
{'acc': 0.84087366, 'precision': 0.86094224, 'recall': 0.8358511, 'specificity': 0.8358511, 'f1': 0.8369851, 'auroc': 0.9264151, 'binary_precision': 0.9361702, 'binary_recall': 0.7166124, 'binary_specificity': 0.9550898, 'binary_f1_score': 0.8118081}
confusion matrix:
     0    1
0  638   30
1  174  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348416, 'precision': 0.86053795, 'recall': 0.8348416, 'specificity': 0.8348416, 'f1': 0.83184546, 'auroc': 0.9245767, 'binary_precision': 0.95679015, 'binary_recall': 0.7013575, 'binary_specificity': 0.9683258, 'binary_f1_score': 0.8093995}
confusion matrix:
     0    1
0  214    7
1   66  155
early stop counter: 17
val acc:0.840873658657074, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 23,now: 2024-07-29 10:19:28.759512,epoch time: 0:01:37.260350,used: 0:37:28.338455,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.97619045, 'precision': 0.9771012, 'recall': 0.9763123, 'specificity': 0.9763123, 'f1': 0.9761829, 'auroc': 0.9993355, 'binary_precision': 0.9993104, 'binary_recall': 0.95328945, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.9757576}
confusion matrix:
      0     1
0  1503     1
1    71  1449
---- Validation: 
scalar performance:
{'acc': 0.53120124, 'precision': 0.7631993, 'recall': 0.5105863, 'specificity': 0.5105863, 'f1': 0.36559686, 'auroc': 0.9192921, 'binary_precision': 1.0, 'binary_recall': 0.021172639, 'binary_specificity': 1.0, 'binary_f1_score': 0.041467305}
confusion matrix:
     0   1
0  668   0
1  601  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9150918, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  221  0
1  221  0
early stop counter: 18
val acc:0.5312012434005737, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 24,now: 2024-07-29 10:21:05.806584,epoch time: 0:01:37.047072,used: 0:39:05.385527,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99338627, 'precision': 0.9933967, 'recall': 0.9934071, 'specificity': 0.9934071, 'f1': 0.99338627, 'auroc': 0.99967325, 'binary_precision': 0.9973475, 'binary_recall': 0.9894737, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.993395}
confusion matrix:
      0     1
0  1500     4
1    16  1504
---- Validation: 
scalar performance:
{'acc': 0.7870515, 'precision': 0.84021235, 'recall': 0.77854306, 'specificity': 0.77854306, 'f1': 0.77462757, 'auroc': 0.92953527, 'binary_precision': 0.9645777, 'binary_recall': 0.5765472, 'binary_specificity': 0.9805389, 'binary_f1_score': 0.7217125}
confusion matrix:
     0    1
0  655   13
1  260  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68325794, 'precision': 0.794958, 'recall': 0.68325794, 'specificity': 0.68325794, 'f1': 0.65013456, 'auroc': 0.9254571, 'binary_precision': 0.9764706, 'binary_recall': 0.37556562, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.5424837}
confusion matrix:
     0   1
0  219   2
1  138  83
early stop counter: 19
val acc:0.7870514988899231, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 25,now: 2024-07-29 10:22:41.661169,epoch time: 0:01:35.854585,used: 0:40:41.240112,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9890873, 'precision': 0.98919606, 'recall': 0.9890537, 'specificity': 0.9890537, 'f1': 0.9890858, 'auroc': 0.99971217, 'binary_precision': 0.9831059, 'binary_recall': 0.99539477, 'binary_specificity': 0.98271275, 'binary_f1_score': 0.98921216}
confusion matrix:
      0     1
0  1478    26
1     7  1513
---- Validation: 
scalar performance:
{'acc': 0.82527304, 'precision': 0.84054404, 'recall': 0.82068354, 'specificity': 0.82068354, 'f1': 0.82159793, 'auroc': 0.911428, 'binary_precision': 0.9028926, 'binary_recall': 0.71172637, 'binary_specificity': 0.9296407, 'binary_f1_score': 0.7959927}
confusion matrix:
     0    1
0  621   47
1  177  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7963801, 'precision': 0.81519866, 'recall': 0.7963801, 'specificity': 0.7963801, 'f1': 0.79329485, 'auroc': 0.8956, 'binary_precision': 0.89221555, 'binary_recall': 0.67420816, 'binary_specificity': 0.91855204, 'binary_f1_score': 0.76804125}
confusion matrix:
     0    1
0  203   18
1   72  149
early stop counter: 20
val acc:0.8252730369567871, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 26,now: 2024-07-29 10:24:17.483034,epoch time: 0:01:35.821865,used: 0:42:17.061977,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9917328, 'precision': 0.99180746, 'recall': 0.99177283, 'specificity': 0.99177283, 'f1': 0.9917328, 'auroc': 0.9996954, 'binary_precision': 0.999332, 'binary_recall': 0.98421055, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.99171364}
confusion matrix:
      0     1
0  1503     1
1    24  1496
---- Validation: 
scalar performance:
{'acc': 0.8198128, 'precision': 0.847706, 'recall': 0.81373245, 'specificity': 0.81373245, 'f1': 0.8138739, 'auroc': 0.92129076, 'binary_precision': 0.9362187, 'binary_recall': 0.6693811, 'binary_specificity': 0.9580838, 'binary_f1_score': 0.7806267}
confusion matrix:
     0    1
0  640   28
1  203  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7036199, 'precision': 0.7994039, 'recall': 0.7036199, 'specificity': 0.7036199, 'f1': 0.67785513, 'auroc': 0.9206046, 'binary_precision': 0.96875, 'binary_recall': 0.42081448, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.5867508}
confusion matrix:
     0   1
0  218   3
1  128  93
early stop counter: 21
val acc:0.8198127746582031, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 27,now: 2024-07-29 10:26:03.999078,epoch time: 0:01:46.516044,used: 0:44:03.578021,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99338627, 'precision': 0.99339056, 'recall': 0.99340355, 'specificity': 0.99340355, 'f1': 0.9933862, 'auroc': 0.9997397, 'binary_precision': 0.9966887, 'binary_recall': 0.99013156, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.9933993}
confusion matrix:
      0     1
0  1499     5
1    15  1505
---- Validation: 
scalar performance:
{'acc': 0.8478939, 'precision': 0.86879647, 'recall': 0.8428509, 'specificity': 0.8428509, 'f1': 0.8441384, 'auroc': 0.9221776, 'binary_precision': 0.9466951, 'binary_recall': 0.723127, 'binary_specificity': 0.96257484, 'binary_f1_score': 0.8199446}
confusion matrix:
     0    1
0  643   25
1  170  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.8536962, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.8300424, 'auroc': 0.9217051, 'binary_precision': 0.94011974, 'binary_recall': 0.71040726, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.80927837}
confusion matrix:
     0    1
0  211   10
1   64  157
early stop counter: 22
val acc:0.8478938937187195, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 28,now: 2024-07-29 10:27:41.796872,epoch time: 0:01:37.797794,used: 0:45:41.375815,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98974866, 'precision': 0.98987997, 'recall': 0.98979914, 'specificity': 0.98979914, 'f1': 0.9897485, 'auroc': 0.9997935, 'binary_precision': 0.9993293, 'binary_recall': 0.9802632, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.9897044}
confusion matrix:
      0     1
0  1503     1
1    30  1490
---- Validation: 
scalar performance:
{'acc': 0.69656783, 'precision': 0.8079082, 'recall': 0.6834881, 'specificity': 0.6834881, 'f1': 0.65708697, 'auroc': 0.91704595, 'binary_precision': 0.9828326, 'binary_recall': 0.37296417, 'binary_specificity': 0.994012, 'binary_f1_score': 0.54073197}
confusion matrix:
     0    1
0  664    4
1  385  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58144796, 'precision': 0.75911933, 'recall': 0.58144796, 'specificity': 0.58144796, 'f1': 0.4948572, 'auroc': 0.89532876, 'binary_precision': 0.9736842, 'binary_recall': 0.16742082, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  220   1
1  184  37
early stop counter: 23
val acc:0.6965678334236145, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 29,now: 2024-07-29 10:29:18.584994,epoch time: 0:01:36.788122,used: 0:47:18.163937,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96626985, 'precision': 0.96847105, 'recall': 0.9660939, 'specificity': 0.9660939, 'f1': 0.96622014, 'auroc': 0.9993416, 'binary_precision': 0.9376543, 'binary_recall': 0.9993421, 'binary_specificity': 0.9328458, 'binary_f1_score': 0.9675159}
confusion matrix:
      0     1
0  1403   101
1     1  1519
---- Validation: 
scalar performance:
{'acc': 0.8424337, 'precision': 0.84561557, 'recall': 0.8445235, 'specificity': 0.8445235, 'f1': 0.8424026, 'auroc': 0.9233187, 'binary_precision': 0.80029154, 'binary_recall': 0.8941368, 'binary_specificity': 0.7949102, 'binary_f1_score': 0.84461534}
confusion matrix:
     0    1
0  531  137
1   65  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7963801, 'precision': 0.8137504, 'recall': 0.7963801, 'specificity': 0.7963801, 'f1': 0.79352224, 'auroc': 0.89058375, 'binary_precision': 0.73992676, 'binary_recall': 0.91402715, 'binary_specificity': 0.67873305, 'binary_f1_score': 0.8178138}
confusion matrix:
     0    1
0  150   71
1   19  202
early stop counter: 24
val acc:0.8424336910247803, best validation acc: 0.8478938937187195, corresponding to test acc:                         0.8393664956092834 / 0.8619909286499023
after epoch: 30,now: 2024-07-29 10:30:52.731885,epoch time: 0:01:34.146891,used: 0:48:52.310828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_42_00_seed_10_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:52.310828 at 2024-07-29 10:30:52.731885
persisted model performance metric: 

scalar performance:
{'acc': 0.8393665, 'precision': 0.83937347, 'recall': 0.83936656, 'specificity': 0.83936656, 'f1': 0.8393657, 'auroc': 0.91058743, 'binary_precision': 0.84090906, 'binary_recall': 0.8371041, 'binary_specificity': 0.84162897, 'binary_f1_score': 0.8390023}
confusion matrix:
     0    1
0  186   35
1   36  185
oracle model performance metric: 

scalar performance:
{'acc': 0.8619909, 'precision': 0.8724301, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.86101705, 'auroc': 0.9358326, 'binary_precision': 0.9347826, 'binary_recall': 0.77828056, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.8493827}
confusion matrix:
     0    1
0  209   12
1   49  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456211 KiB |  13219 MiB |    795 TiB |    795 TiB |
|       from large pool | 415616 KiB |  13181 MiB |    785 TiB |    785 TiB |
|       from small pool |  40595 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456211 KiB |  13219 MiB |    795 TiB |    795 TiB |
|       from large pool | 415616 KiB |  13181 MiB |    785 TiB |    785 TiB |
|       from small pool |  40595 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |  40406 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB | 150234 MiB | 135758 MiB |
|       from large pool |  14410 MiB |  14422 MiB | 150012 MiB | 135602 MiB |
|       from small pool |     66 MiB |     70 MiB |    222 MiB |    156 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473580 KiB |   1260 MiB | 581572 GiB | 581571 GiB |
|       from large pool | 462976 KiB |   1252 MiB | 571904 GiB | 571903 GiB |
|       from small pool |  10604 KiB |     46 MiB |   9667 GiB |   9667 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  142885 K  |  142884 K  |
|       from large pool |     187    |    1413    |   72670 K  |   72670 K  |
|       from small pool |    1117    |    1419    |   70215 K  |   70214 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  142885 K  |  142884 K  |
|       from large pool |     187    |    1413    |   72670 K  |   72670 K  |
|       from small pool |    1117    |    1419    |   70215 K  |   70214 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    6348    |    5713    |
|       from large pool |     602    |     602    |    6237    |    5635    |
|       from small pool |      33    |      35    |     111    |      78    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      92    |     655    |   95672 K  |   95672 K  |
|       from large pool |      38    |     604    |   54157 K  |   54157 K  |
|       from small pool |      54    |     237    |   41514 K  |   41514 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB | 150234 MiB | 149326 MiB |
|       from large pool |    858 MiB |  14422 MiB | 150012 MiB | 149154 MiB |
|       from small pool |     50 MiB |     70 MiB |    222 MiB |    172 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 581572 GiB | 581572 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 571904 GiB | 571904 GiB |
|       from small pool |      0 KiB |     46 MiB |   9668 GiB |   9668 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    6348    |    6284    |
|       from large pool |      39    |     602    |    6237    |    6198    |
|       from small pool |      25    |      35    |     111    |      86    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   95672 K  |   95672 K  |
|       from large pool |       3    |     604    |   54157 K  |   54157 K  |
|       from small pool |       0    |     237    |   41515 K  |   41515 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    785 TiB |    785 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB | 150234 MiB | 149326 MiB |
|       from large pool |    858 MiB |  14422 MiB | 150012 MiB | 149154 MiB |
|       from small pool |     50 MiB |     70 MiB |    222 MiB |    172 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 581572 GiB | 581572 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 571904 GiB | 571904 GiB |
|       from small pool |      0 KiB |     46 MiB |   9668 GiB |   9668 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    6348    |    6284    |
|       from large pool |      39    |     602    |    6237    |    6198    |
|       from small pool |      25    |      35    |     111    |      86    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |   95672 K  |   95672 K  |
|       from large pool |       3    |     604    |   54157 K  |   54157 K  |
|       from small pool |       0    |     237    |   41515 K  |   41515 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369

 Experiment start at: 2024-07-29 10:31:45.925186
before training, model accuracy: 0.5371178984642029
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9492801, 'precision': 0.9516386, 'recall': 0.9486692, 'specificity': 0.9486692, 'f1': 0.94914925, 'auroc': 0.99156165, 'binary_precision': 0.92326283, 'binary_recall': 0.9820051, 'binary_specificity': 0.91533333, 'binary_f1_score': 0.9517284}
confusion matrix:
      0     1
0  1373   127
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.859447, 'precision': 0.8594952, 'recall': 0.8597983, 'specificity': 0.8597983, 'f1': 0.85942304, 'auroc': 0.9172044, 'binary_precision': 0.84379786, 'binary_recall': 0.8718355, 'binary_specificity': 0.8477612, 'binary_f1_score': 0.8575876}
confusion matrix:
     0    1
0  568  102
1   81  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.85592234, 'recall': 0.8558952, 'specificity': 0.8558952, 'f1': 0.8558924, 'auroc': 0.92481077, 'binary_precision': 0.85903084, 'binary_recall': 0.8515284, 'binary_specificity': 0.86026204, 'binary_f1_score': 0.8552632}
confusion matrix:
     0    1
0  197   32
1   34  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 10:33:34.766455,epoch time: 0:01:48.841269,used: 0:01:48.841269,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9689136, 'precision': 0.96983576, 'recall': 0.96941805, 'specificity': 0.96941805, 'f1': 0.9689115, 'auroc': 0.99632084, 'binary_precision': 0.9959294, 'binary_recall': 0.9428388, 'binary_specificity': 0.9959973, 'binary_f1_score': 0.96865726}
confusion matrix:
      0     1
0  1493     6
1    89  1468
---- Validation: 
scalar performance:
{'acc': 0.8402458, 'precision': 0.8433229, 'recall': 0.8388083, 'specificity': 0.8388083, 'f1': 0.8393725, 'auroc': 0.8882605, 'binary_precision': 0.869338, 'binary_recall': 0.789557, 'binary_specificity': 0.8880597, 'binary_f1_score': 0.827529}
confusion matrix:
     0    1
0  595   75
1  133  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87772924, 'precision': 0.87876934, 'recall': 0.8777293, 'specificity': 0.8777293, 'f1': 0.87764525, 'auroc': 0.931504, 'binary_precision': 0.8986175, 'binary_recall': 0.8515284, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.8744395}
confusion matrix:
     0    1
0  207   22
1   34  195
new oracle model saved
early stop counter: 1
val acc:0.84024578332901, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8777292370796204
after epoch: 2,now: 2024-07-29 10:35:32.744489,epoch time: 0:01:57.978034,used: 0:03:46.819303,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.97501934, 'recall': 0.97508913, 'specificity': 0.97508913, 'f1': 0.97480357, 'auroc': 0.9967725, 'binary_precision': 0.99071, 'binary_recall': 0.9595116, 'binary_specificity': 0.9906667, 'binary_f1_score': 0.9748613}
confusion matrix:
      0     1
0  1486    14
1    63  1493
---- Validation: 
scalar performance:
{'acc': 0.8341014, 'precision': 0.8432472, 'recall': 0.8316716, 'specificity': 0.8316716, 'f1': 0.83216083, 'auroc': 0.87387824, 'binary_precision': 0.89245284, 'binary_recall': 0.74841774, 'binary_specificity': 0.9149254, 'binary_f1_score': 0.81411356}
confusion matrix:
     0    1
0  613   57
1  159  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84497815, 'precision': 0.87132597, 'recall': 0.84497815, 'specificity': 0.84497815, 'f1': 0.8421786, 'auroc': 0.92454374, 'binary_precision': 0.9702381, 'binary_recall': 0.7117904, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.82115865}
confusion matrix:
     0    1
0  224    5
1   66  163
early stop counter: 2
val acc:0.8341013789176941, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8777292370796204
after epoch: 3,now: 2024-07-29 10:37:17.965827,epoch time: 0:01:45.221338,used: 0:05:32.040641,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98327327, 'recall': 0.98335004, 'specificity': 0.98335004, 'f1': 0.9833065, 'auroc': 0.9970243, 'binary_precision': 0.9858156, 'binary_recall': 0.98138636, 'binary_specificity': 0.9853138, 'binary_f1_score': 0.983596}
confusion matrix:
      0     1
0  1476    22
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.8494624, 'precision': 0.8494582, 'recall': 0.8491546, 'specificity': 0.8491546, 'f1': 0.8492743, 'auroc': 0.90750045, 'binary_precision': 0.849359, 'binary_recall': 0.8386076, 'binary_specificity': 0.8597015, 'binary_f1_score': 0.8439491}
confusion matrix:
     0    1
0  576   94
1  102  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88646287, 'precision': 0.8865808, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8864542, 'auroc': 0.9375489, 'binary_precision': 0.8933333, 'binary_recall': 0.87772924, 'binary_specificity': 0.8951965, 'binary_f1_score': 0.8854625}
confusion matrix:
     0    1
0  205   24
1   28  201
new oracle model saved
early stop counter: 3
val acc:0.8494623899459839, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 4,now: 2024-07-29 10:38:57.430253,epoch time: 0:01:39.464426,used: 0:07:11.505067,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.98211634, 'recall': 0.98144203, 'specificity': 0.98144203, 'f1': 0.98165727, 'auroc': 0.9989862, 'binary_precision': 0.9717514, 'binary_recall': 0.9929442, 'binary_specificity': 0.9699399, 'binary_f1_score': 0.98223346}
confusion matrix:
      0     1
0  1452    45
1    11  1548
---- Validation: 
scalar performance:
{'acc': 0.85099846, 'precision': 0.850997, 'recall': 0.8506919, 'specificity': 0.8506919, 'f1': 0.85081226, 'auroc': 0.9071462, 'binary_precision': 0.85096157, 'binary_recall': 0.8401899, 'binary_specificity': 0.861194, 'binary_f1_score': 0.8455414}
confusion matrix:
     0    1
0  577   93
1  101  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8799127, 'precision': 0.8815497, 'recall': 0.8799127, 'specificity': 0.8799127, 'f1': 0.87978375, 'auroc': 0.93526053, 'binary_precision': 0.90654206, 'binary_recall': 0.8471616, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.87584656}
confusion matrix:
     0    1
0  209   20
1   35  194
early stop counter: 4
val acc:0.8509984612464905, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 5,now: 2024-07-29 10:40:37.498147,epoch time: 0:01:40.067894,used: 0:08:51.572961,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9796645, 'recall': 0.9798199, 'specificity': 0.9798199, 'f1': 0.9797082, 'auroc': 0.9971092, 'binary_precision': 0.98571426, 'binary_recall': 0.9743261, 'binary_specificity': 0.9853138, 'binary_f1_score': 0.9799871}
confusion matrix:
      0     1
0  1476    22
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.83179724, 'precision': 0.8364545, 'recall': 0.8300161, 'specificity': 0.8300161, 'f1': 0.8305658, 'auroc': 0.9006447, 'binary_precision': 0.8694097, 'binary_recall': 0.76898736, 'binary_specificity': 0.8910448, 'binary_f1_score': 0.8161209}
confusion matrix:
     0    1
0  597   73
1  146  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8668122, 'precision': 0.86681926, 'recall': 0.8668122, 'specificity': 0.8668122, 'f1': 0.86681163, 'auroc': 0.9298068, 'binary_precision': 0.8652174, 'binary_recall': 0.8689956, 'binary_specificity': 0.8646288, 'binary_f1_score': 0.8671024}
confusion matrix:
     0    1
0  198   31
1   30  199
early stop counter: 5
val acc:0.8317972421646118, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 6,now: 2024-07-29 10:42:21.591991,epoch time: 0:01:44.093844,used: 0:10:35.666805,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.9838042, 'recall': 0.9830756, 'specificity': 0.9830756, 'f1': 0.9832953, 'auroc': 0.998994, 'binary_precision': 0.9723965, 'binary_recall': 0.9955042, 'binary_specificity': 0.9706471, 'binary_f1_score': 0.98381466}
confusion matrix:
      0     1
0  1455    44
1     7  1550
---- Validation: 
scalar performance:
{'acc': 0.85407066, 'precision': 0.8549834, 'recall': 0.85327315, 'specificity': 0.85327315, 'f1': 0.85367155, 'auroc': 0.90836716, 'binary_precision': 0.86710966, 'binary_recall': 0.8259494, 'binary_specificity': 0.880597, 'binary_f1_score': 0.8460292}
confusion matrix:
     0    1
0  590   80
1  110  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8697007, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8689332, 'auroc': 0.93953204, 'binary_precision': 0.88584477, 'binary_recall': 0.8471616, 'binary_specificity': 0.8908297, 'binary_f1_score': 0.86607146}
confusion matrix:
     0    1
0  204   25
1   35  194
early stop counter: 6
val acc:0.8540706634521484, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 7,now: 2024-07-29 10:44:03.001746,epoch time: 0:01:41.409755,used: 0:12:17.076560,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901575, 'recall': 0.9903288, 'specificity': 0.9903288, 'f1': 0.99018204, 'auroc': 0.999545, 'binary_precision': 0.99804306, 'binary_recall': 0.982659, 'binary_specificity': 0.99799865, 'binary_f1_score': 0.99029124}
confusion matrix:
      0     1
0  1496     3
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.781106, 'precision': 0.8302865, 'recall': 0.77537787, 'specificity': 0.77537787, 'f1': 0.7700899, 'auroc': 0.9173012, 'binary_precision': 0.9506493, 'binary_recall': 0.5791139, 'binary_specificity': 0.9716418, 'binary_f1_score': 0.719764}
confusion matrix:
     0    1
0  651   19
1  266  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7882096, 'precision': 0.8451315, 'recall': 0.7882096, 'specificity': 0.7882096, 'f1': 0.7791015, 'auroc': 0.93310577, 'binary_precision': 0.9852941, 'binary_recall': 0.58515286, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7342466}
confusion matrix:
     0    1
0  227    2
1   95  134
early stop counter: 7
val acc:0.7811059951782227, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 8,now: 2024-07-29 10:45:40.982980,epoch time: 0:01:37.981234,used: 0:13:55.057794,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.985884, 'recall': 0.98598325, 'specificity': 0.98598325, 'f1': 0.9859251, 'auroc': 0.9991238, 'binary_precision': 0.98903227, 'binary_recall': 0.9833226, 'binary_specificity': 0.98864394, 'binary_f1_score': 0.9861692}
confusion matrix:
      0     1
0  1480    17
1    26  1533
---- Validation: 
scalar performance:
{'acc': 0.8463902, 'precision': 0.8662173, 'recall': 0.84298366, 'specificity': 0.84298366, 'f1': 0.8432598, 'auroc': 0.90920556, 'binary_precision': 0.9444444, 'binary_recall': 0.72626585, 'binary_specificity': 0.9597015, 'binary_f1_score': 0.8211091}
confusion matrix:
     0    1
0  643   27
1  173  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.88212776, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.8533789, 'auroc': 0.93945575, 'binary_precision': 0.98224854, 'binary_recall': 0.7248908, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8341709}
confusion matrix:
     0    1
0  226    3
1   63  166
early stop counter: 8
val acc:0.8463901877403259, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 9,now: 2024-07-29 10:47:19.376219,epoch time: 0:01:38.393239,used: 0:15:33.451033,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98533785, 'recall': 0.98549944, 'specificity': 0.98549944, 'f1': 0.9852742, 'auroc': 0.9995235, 'binary_precision': 0.9973684, 'binary_recall': 0.9736673, 'binary_specificity': 0.99733156, 'binary_f1_score': 0.9853754}
confusion matrix:
      0     1
0  1495     4
1    41  1516
---- Validation: 
scalar performance:
{'acc': 0.764977, 'precision': 0.8179097, 'recall': 0.7588985, 'specificity': 0.7588985, 'f1': 0.7517997, 'auroc': 0.90044636, 'binary_precision': 0.94054055, 'binary_recall': 0.5506329, 'binary_specificity': 0.96716416, 'binary_f1_score': 0.6946107}
confusion matrix:
     0    1
0  648   22
1  284  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76419216, 'precision': 0.8264414, 'recall': 0.7641921, 'specificity': 0.7641921, 'f1': 0.75238776, 'auroc': 0.9288915, 'binary_precision': 0.96899223, 'binary_recall': 0.5458515, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.698324}
confusion matrix:
     0    1
0  225    4
1  104  125
early stop counter: 9
val acc:0.764976978302002, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 10,now: 2024-07-29 10:48:53.472744,epoch time: 0:01:34.096525,used: 0:17:07.547558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98982656, 'recall': 0.98988426, 'specificity': 0.98988426, 'f1': 0.9898528, 'auroc': 0.9997339, 'binary_precision': 0.9916291, 'binary_recall': 0.9884467, 'binary_specificity': 0.99132174, 'binary_f1_score': 0.9900354}
confusion matrix:
      0     1
0  1485    13
1    18  1540
---- Validation: 
scalar performance:
{'acc': 0.83870965, 'precision': 0.85969436, 'recall': 0.83516204, 'specificity': 0.83516204, 'f1': 0.83520025, 'auroc': 0.9145121, 'binary_precision': 0.93958336, 'binary_recall': 0.7136076, 'binary_specificity': 0.9567164, 'binary_f1_score': 0.8111511}
confusion matrix:
     0    1
0  641   29
1  181  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122271, 'precision': 0.8556287, 'recall': 0.8122271, 'specificity': 0.8122271, 'f1': 0.80631775, 'auroc': 0.9169543, 'binary_precision': 0.9798658, 'binary_recall': 0.6375546, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7724868}
confusion matrix:
     0    1
0  226    3
1   83  146
early stop counter: 10
val acc:0.8387096524238586, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 11,now: 2024-07-29 10:50:33.168471,epoch time: 0:01:39.695727,used: 0:18:47.243285,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9866314, 'recall': 0.98653364, 'specificity': 0.98653364, 'f1': 0.9865773, 'auroc': 0.999248, 'binary_precision': 0.98466456, 'binary_recall': 0.9890886, 'binary_specificity': 0.9839786, 'binary_f1_score': 0.98687154}
confusion matrix:
      0     1
0  1474    24
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.8371736, 'precision': 0.86040944, 'recall': 0.83344513, 'specificity': 0.83344513, 'f1': 0.8333188, 'auroc': 0.9262091, 'binary_precision': 0.94491524, 'binary_recall': 0.7056962, 'binary_specificity': 0.96119404, 'binary_f1_score': 0.807971}
confusion matrix:
     0    1
0  644   26
1  186  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7751092, 'precision': 0.8352622, 'recall': 0.7751092, 'specificity': 0.7751092, 'f1': 0.76454794, 'auroc': 0.940619, 'binary_precision': 0.97727275, 'binary_recall': 0.5633188, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7146815}
confusion matrix:
     0    1
0  226    3
1  100  129
early stop counter: 11
val acc:0.837173581123352, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 12,now: 2024-07-29 10:52:11.565244,epoch time: 0:01:38.396773,used: 0:20:25.640058,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9891745, 'recall': 0.98922795, 'specificity': 0.98922795, 'f1': 0.98919857, 'auroc': 0.999503, 'binary_precision': 0.9909736, 'binary_recall': 0.9877892, 'binary_specificity': 0.9906667, 'binary_f1_score': 0.9893788}
confusion matrix:
      0     1
0  1486    14
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.80184335, 'precision': 0.8069681, 'recall': 0.79983467, 'specificity': 0.79983467, 'f1': 0.8001456, 'auroc': 0.87934303, 'binary_precision': 0.84, 'binary_recall': 0.73101264, 'binary_specificity': 0.8686567, 'binary_f1_score': 0.7817259}
confusion matrix:
     0    1
0  582   88
1  170  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.84102917, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.83811927, 'auroc': 0.9140558, 'binary_precision': 0.81124496, 'binary_recall': 0.88209605, 'binary_specificity': 0.7947598, 'binary_f1_score': 0.84518826}
confusion matrix:
     0    1
0  182   47
1   27  202
early stop counter: 12
val acc:0.8018433451652527, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 13,now: 2024-07-29 10:53:51.706068,epoch time: 0:01:40.140824,used: 0:22:05.780882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9940728, 'recall': 0.99416596, 'specificity': 0.99416596, 'f1': 0.9941087, 'auroc': 0.9996102, 'binary_precision': 0.997411, 'binary_recall': 0.9909968, 'binary_specificity': 0.99733514, 'binary_f1_score': 0.9941935}
confusion matrix:
      0     1
0  1497     4
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8425499, 'precision': 0.8453535, 'recall': 0.84118176, 'specificity': 0.84118176, 'f1': 0.84174246, 'auroc': 0.89858776, 'binary_precision': 0.87001735, 'binary_recall': 0.7943038, 'binary_specificity': 0.8880597, 'binary_f1_score': 0.8304383}
confusion matrix:
     0    1
0  595   75
1  130  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.8683826, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.85948765, 'auroc': 0.92881525, 'binary_precision': 0.9230769, 'binary_recall': 0.7860262, 'binary_specificity': 0.93449783, 'binary_f1_score': 0.8490566}
confusion matrix:
     0    1
0  214   15
1   49  180
early stop counter: 13
val acc:0.8425499200820923, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 14,now: 2024-07-29 10:55:31.193103,epoch time: 0:01:39.487035,used: 0:23:45.267917,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934164, 'recall': 0.9935044, 'specificity': 0.9935044, 'f1': 0.9934536, 'auroc': 0.9997378, 'binary_precision': 0.99612904, 'binary_recall': 0.9910141, 'binary_specificity': 0.9959947, 'binary_f1_score': 0.993565}
confusion matrix:
      0     1
0  1492     6
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.7941628, 'precision': 0.82834107, 'recall': 0.78936565, 'specificity': 0.78936565, 'f1': 0.7866707, 'auroc': 0.8845757, 'binary_precision': 0.92723006, 'binary_recall': 0.625, 'binary_specificity': 0.95373136, 'binary_f1_score': 0.7466919}
confusion matrix:
     0    1
0  639   31
1  237  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.87373066, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.8517262, 'auroc': 0.9267558, 'binary_precision': 0.96022725, 'binary_recall': 0.7379913, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.83456784}
confusion matrix:
     0    1
0  222    7
1   60  169
early stop counter: 14
val acc:0.7941628098487854, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 15,now: 2024-07-29 10:57:07.544493,epoch time: 0:01:36.351390,used: 0:25:21.619307,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9844117, 'recall': 0.98375064, 'specificity': 0.98375064, 'f1': 0.9839517, 'auroc': 0.9996607, 'binary_precision': 0.9736015, 'binary_recall': 0.9955013, 'binary_specificity': 0.972, 'binary_f1_score': 0.98442954}
confusion matrix:
      0     1
0  1458    42
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.8402458, 'precision': 0.8405163, 'recall': 0.8397057, 'specificity': 0.8397057, 'f1': 0.8399497, 'auroc': 0.9057317, 'binary_precision': 0.8452769, 'binary_recall': 0.8212025, 'binary_specificity': 0.85820895, 'binary_f1_score': 0.83306587}
confusion matrix:
     0    1
0  575   95
1  113  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.8440823, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.8402084, 'auroc': 0.915486, 'binary_precision': 0.8786408, 'binary_recall': 0.790393, 'binary_specificity': 0.8908297, 'binary_f1_score': 0.83218396}
confusion matrix:
     0    1
0  204   25
1   48  181
early stop counter: 15
val acc:0.84024578332901, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 16,now: 2024-07-29 10:58:44.967825,epoch time: 0:01:37.423332,used: 0:26:59.042639,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865343, 'recall': 0.986675, 'specificity': 0.986675, 'f1': 0.98658085, 'auroc': 0.9994704, 'binary_precision': 0.9915749, 'binary_recall': 0.98202825, 'binary_specificity': 0.99132174, 'binary_f1_score': 0.98677844}
confusion matrix:
      0     1
0  1485    13
1    28  1530
---- Validation: 
scalar performance:
{'acc': 0.82411677, 'precision': 0.8529459, 'recall': 0.819906, 'specificity': 0.819906, 'f1': 0.8189957, 'auroc': 0.9237336, 'binary_precision': 0.9467849, 'binary_recall': 0.6756329, 'binary_specificity': 0.9641791, 'binary_f1_score': 0.7885503}
confusion matrix:
     0    1
0  646   24
1  205  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.8860482, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.85302526, 'auroc': 0.92915845, 'binary_precision': 0.9939394, 'binary_recall': 0.7161572, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.8324873}
confusion matrix:
     0    1
0  228    1
1   65  164
early stop counter: 16
val acc:0.8241167664527893, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 17,now: 2024-07-29 11:00:15.648481,epoch time: 0:01:30.680656,used: 0:28:29.723295,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9901279, 'recall': 0.98970264, 'specificity': 0.98970264, 'f1': 0.98984885, 'auroc': 0.99987185, 'binary_precision': 0.9822897, 'binary_recall': 0.99807197, 'binary_specificity': 0.9813333, 'binary_f1_score': 0.9901179}
confusion matrix:
      0     1
0  1472    28
1     3  1553
---- Validation: 
scalar performance:
{'acc': 0.85791093, 'precision': 0.85819936, 'recall': 0.8574084, 'specificity': 0.8574084, 'f1': 0.85765696, 'auroc': 0.9080814, 'binary_precision': 0.86341465, 'binary_recall': 0.8401899, 'binary_specificity': 0.8746269, 'binary_f1_score': 0.851644}
confusion matrix:
     0    1
0  586   84
1  101  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8580786, 'precision': 0.8584135, 'recall': 0.8580786, 'specificity': 0.8580786, 'f1': 0.85804546, 'auroc': 0.9252875, 'binary_precision': 0.8693694, 'binary_recall': 0.8427948, 'binary_specificity': 0.8733624, 'binary_f1_score': 0.85587585}
confusion matrix:
     0    1
0  200   29
1   36  193
early stop counter: 17
val acc:0.8579109311103821, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 18,now: 2024-07-29 11:01:58.932119,epoch time: 0:01:43.283638,used: 0:30:13.006933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99541885, 'precision': 0.99538016, 'recall': 0.9954685, 'specificity': 0.9954685, 'f1': 0.9954175, 'auroc': 0.9997591, 'binary_precision': 0.9980645, 'binary_recall': 0.99293965, 'binary_specificity': 0.99799734, 'binary_f1_score': 0.99549544}
confusion matrix:
      0     1
0  1495     3
1    11  1547
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.8450085, 'recall': 0.80478466, 'specificity': 0.80478466, 'f1': 0.802708, 'auroc': 0.9137516, 'binary_precision': 0.94859815, 'binary_recall': 0.6424051, 'binary_specificity': 0.96716416, 'binary_f1_score': 0.7660378}
confusion matrix:
     0    1
0  648   22
1  226  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8711546, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.834786, 'auroc': 0.9126257, 'binary_precision': 0.98136646, 'binary_recall': 0.6899563, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8102564}
confusion matrix:
     0    1
0  226    3
1   71  158
early stop counter: 18
val acc:0.8095238208770752, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 19,now: 2024-07-29 11:03:38.945662,epoch time: 0:01:40.013543,used: 0:31:53.020476,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98796356, 'recall': 0.98811054, 'specificity': 0.98811054, 'f1': 0.9878922, 'auroc': 0.9998933, 'binary_precision': 1.0, 'binary_recall': 0.9762211, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879675}
confusion matrix:
      0     1
0  1500     0
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.67127496, 'precision': 0.7818905, 'recall': 0.661886, 'specificity': 0.661886, 'f1': 0.62801695, 'auroc': 0.90107036, 'binary_precision': 0.95132744, 'binary_recall': 0.34018987, 'binary_specificity': 0.9835821, 'binary_f1_score': 0.50116557}
confusion matrix:
     0    1
0  659   11
1  417  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6834061, 'precision': 0.80063766, 'recall': 0.6834061, 'specificity': 0.6834061, 'f1': 0.64920896, 'auroc': 0.9340068, 'binary_precision': 0.9883721, 'binary_recall': 0.37117904, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.5396825}
confusion matrix:
     0   1
0  228   1
1  144  85
early stop counter: 19
val acc:0.6712749600410461, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 20,now: 2024-07-29 11:05:33.342957,epoch time: 0:01:54.397295,used: 0:33:47.417771,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9940747, 'recall': 0.99415594, 'specificity': 0.99415594, 'f1': 0.9941085, 'auroc': 0.9995347, 'binary_precision': 0.99677, 'binary_recall': 0.9916452, 'binary_specificity': 0.99666667, 'binary_f1_score': 0.994201}
confusion matrix:
      0     1
0  1495     5
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.84485406, 'precision': 0.85762113, 'recall': 0.84207445, 'specificity': 0.84207445, 'f1': 0.8425944, 'auroc': 0.90196013, 'binary_precision': 0.91828793, 'binary_recall': 0.7468355, 'binary_specificity': 0.93731344, 'binary_f1_score': 0.82373476}
confusion matrix:
     0    1
0  628   42
1  160  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8859525, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8675407, 'auroc': 0.9213211, 'binary_precision': 0.9668508, 'binary_recall': 0.76419216, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.85365856}
confusion matrix:
     0    1
0  223    6
1   54  175
early stop counter: 20
val acc:0.8448540568351746, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 21,now: 2024-07-29 11:07:21.497572,epoch time: 0:01:48.154615,used: 0:35:35.572386,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98756546, 'recall': 0.9877292, 'specificity': 0.9877292, 'f1': 0.98756444, 'auroc': 0.99969023, 'binary_precision': 0.99672776, 'binary_recall': 0.9787918, 'binary_specificity': 0.99666667, 'binary_f1_score': 0.98767835}
confusion matrix:
      0     1
0  1495     5
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.66129035, 'precision': 0.78295946, 'recall': 0.65146655, 'specificity': 0.65146655, 'f1': 0.61225796, 'auroc': 0.89643574, 'binary_precision': 0.96135265, 'binary_recall': 0.31487343, 'binary_specificity': 0.9880597, 'binary_f1_score': 0.47437426}
confusion matrix:
     0    1
0  662    8
1  433  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69213974, 'precision': 0.80945945, 'recall': 0.69213974, 'specificity': 0.69213974, 'f1': 0.6599064, 'auroc': 0.92719436, 'binary_precision': 1.0, 'binary_recall': 0.3842795, 'binary_specificity': 1.0, 'binary_f1_score': 0.55520505}
confusion matrix:
     0   1
0  229   0
1  141  88
early stop counter: 21
val acc:0.6612903475761414, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 22,now: 2024-07-29 11:09:05.108587,epoch time: 0:01:43.611015,used: 0:37:19.183401,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99378675, 'recall': 0.9937743, 'specificity': 0.9937743, 'f1': 0.9937804, 'auroc': 0.99952954, 'binary_precision': 0.99358153, 'binary_recall': 0.99421966, 'binary_specificity': 0.99332887, 'binary_f1_score': 0.9939005}
confusion matrix:
      0     1
0  1489    10
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.74577576, 'precision': 0.80560225, 'recall': 0.73916495, 'specificity': 0.73916495, 'f1': 0.7291038, 'auroc': 0.91474056, 'binary_precision': 0.9337176, 'binary_recall': 0.51265824, 'binary_specificity': 0.96567166, 'binary_f1_score': 0.6618999}
confusion matrix:
     0    1
0  647   23
1  308  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.779476, 'precision': 0.831884, 'recall': 0.779476, 'specificity': 0.779476, 'f1': 0.77041245, 'auroc': 0.9291966, 'binary_precision': 0.9637681, 'binary_recall': 0.58078605, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.72479564}
confusion matrix:
     0    1
0  224    5
1   96  133
early stop counter: 22
val acc:0.7457757592201233, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 23,now: 2024-07-29 11:10:48.806796,epoch time: 0:01:43.698209,used: 0:39:02.881610,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98763824, 'recall': 0.987797, 'specificity': 0.987797, 'f1': 0.9875649, 'auroc': 0.99972534, 'binary_precision': 1.0, 'binary_recall': 0.9755941, 'binary_specificity': 1.0, 'binary_f1_score': 0.98764634}
confusion matrix:
      0     1
0  1499     0
1    38  1519
---- Validation: 
scalar performance:
{'acc': 0.7380952, 'precision': 0.81428576, 'recall': 0.73076, 'specificity': 0.73076, 'f1': 0.7170609, 'auroc': 0.9170656, 'binary_precision': 0.96190476, 'binary_recall': 0.47943038, 'binary_specificity': 0.9820896, 'binary_f1_score': 0.63991547}
confusion matrix:
     0    1
0  658   12
1  329  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7576419, 'precision': 0.82960093, 'recall': 0.7576419, 'specificity': 0.7576419, 'f1': 0.74365026, 'auroc': 0.9154669, 'binary_precision': 0.9836066, 'binary_recall': 0.52401745, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.68376064}
confusion matrix:
     0    1
0  227    2
1  109  120
early stop counter: 23
val acc:0.738095223903656, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 24,now: 2024-07-29 11:12:36.059317,epoch time: 0:01:47.252521,used: 0:40:50.134131,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99442965, 'recall': 0.99444133, 'specificity': 0.99444133, 'f1': 0.9944354, 'auroc': 0.999647, 'binary_precision': 0.9948553, 'binary_recall': 0.99421597, 'binary_specificity': 0.9946667, 'binary_f1_score': 0.9945355}
confusion matrix:
      0     1
0  1492     8
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8371736, 'precision': 0.85582733, 'recall': 0.8338041, 'specificity': 0.8338041, 'f1': 0.8339285, 'auroc': 0.91687846, 'binary_precision': 0.9303279, 'binary_recall': 0.7183544, 'binary_specificity': 0.94925374, 'binary_f1_score': 0.81071424}
confusion matrix:
     0    1
0  636   34
1  178  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8799127, 'precision': 0.8937974, 'recall': 0.8799126, 'specificity': 0.8799126, 'f1': 0.87884474, 'auroc': 0.93983716, 'binary_precision': 0.9677419, 'binary_recall': 0.7860262, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86746985}
confusion matrix:
     0    1
0  223    6
1   49  180
early stop counter: 24
val acc:0.837173581123352, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 25,now: 2024-07-29 11:14:18.022514,epoch time: 0:01:41.963197,used: 0:42:32.097328,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99360096, 'recall': 0.9933573, 'specificity': 0.9933573, 'f1': 0.99345183, 'auroc': 0.9998959, 'binary_precision': 0.9885496, 'binary_recall': 0.9987146, 'binary_specificity': 0.988, 'binary_f1_score': 0.99360615}
confusion matrix:
      0     1
0  1482    18
1     2  1554
---- Validation: 
scalar performance:
{'acc': 0.84408605, 'precision': 0.8489937, 'recall': 0.8423153, 'specificity': 0.8423153, 'f1': 0.8429445, 'auroc': 0.89279, 'binary_precision': 0.88372093, 'binary_recall': 0.7816456, 'binary_specificity': 0.9029851, 'binary_f1_score': 0.829555}
confusion matrix:
     0    1
0  605   65
1  138  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8627844, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8624133, 'auroc': 0.91508555, 'binary_precision': 0.8738739, 'binary_recall': 0.8471616, 'binary_specificity': 0.87772924, 'binary_f1_score': 0.86031044}
confusion matrix:
     0    1
0  201   28
1   35  194
early stop counter: 25
val acc:0.8440860509872437, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8864628672599792
after epoch: 26,now: 2024-07-29 11:16:02.425939,epoch time: 0:01:44.403425,used: 0:44:16.500753,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.98962224, 'recall': 0.9894561, 'specificity': 0.9894561, 'f1': 0.9895239, 'auroc': 0.9996958, 'binary_precision': 0.9859604, 'binary_recall': 0.99356914, 'binary_specificity': 0.9853431, 'binary_f1_score': 0.98975015}
confusion matrix:
      0     1
0  1479    22
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.81797236, 'precision': 0.83992505, 'recall': 0.81420505, 'specificity': 0.81420505, 'f1': 0.81361836, 'auroc': 0.8893727, 'binary_precision': 0.9193206, 'binary_recall': 0.6851266, 'binary_specificity': 0.94328356, 'binary_f1_score': 0.7851315}
confusion matrix:
     0    1
0  632   38
1  199  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8930131, 'precision': 0.9060284, 'recall': 0.8930131, 'specificity': 0.8930131, 'f1': 0.89214885, 'auroc': 0.94319326, 'binary_precision': 0.9787234, 'binary_recall': 0.80349344, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.88249403}
confusion matrix:
     0    1
0  225    4
1   45  184
new oracle model saved
early stop counter: 26
val acc:0.8179723620414734, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8930131196975708
after epoch: 27,now: 2024-07-29 11:17:48.841786,epoch time: 0:01:46.415847,used: 0:46:02.916600,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99444145, 'recall': 0.994429, 'specificity': 0.994429, 'f1': 0.9944351, 'auroc': 0.9997592, 'binary_precision': 0.99422336, 'binary_recall': 0.9948619, 'binary_specificity': 0.993996, 'binary_f1_score': 0.99454254}
confusion matrix:
      0     1
0  1490     9
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.82872504, 'precision': 0.8455372, 'recall': 0.82546055, 'specificity': 0.82546055, 'f1': 0.82550013, 'auroc': 0.89001036, 'binary_precision': 0.9148073, 'binary_recall': 0.7136076, 'binary_specificity': 0.93731344, 'binary_f1_score': 0.8017778}
confusion matrix:
     0    1
0  628   42
1  181  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.87407184, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.8589603, 'auroc': 0.9035297, 'binary_precision': 0.9459459, 'binary_recall': 0.76419216, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.84541065}
confusion matrix:
     0    1
0  219   10
1   54  175
early stop counter: 27
val acc:0.8287250399589539, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8930131196975708
after epoch: 28,now: 2024-07-29 11:19:25.104178,epoch time: 0:01:36.262392,used: 0:47:39.178992,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.993801, 'recall': 0.99376106, 'specificity': 0.99376106, 'f1': 0.99378014, 'auroc': 0.99963623, 'binary_precision': 0.99295324, 'binary_recall': 0.99486524, 'binary_specificity': 0.9926569, 'binary_f1_score': 0.99390835}
confusion matrix:
      0     1
0  1487    11
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.8402458, 'precision': 0.84494615, 'recall': 0.83849424, 'specificity': 0.83849424, 'f1': 0.83909726, 'auroc': 0.90456617, 'binary_precision': 0.87857145, 'binary_recall': 0.778481, 'binary_specificity': 0.8985075, 'binary_f1_score': 0.82550335}
confusion matrix:
     0    1
0  602   68
1  140  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515284, 'precision': 0.8568635, 'recall': 0.8515284, 'specificity': 0.8515284, 'f1': 0.85097134, 'auroc': 0.9004786, 'binary_precision': 0.9004975, 'binary_recall': 0.790393, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.8418604}
confusion matrix:
     0    1
0  209   20
1   48  181
early stop counter: 28
val acc:0.84024578332901, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8930131196975708
after epoch: 29,now: 2024-07-29 11:21:16.069621,epoch time: 0:01:50.965443,used: 0:49:30.144435,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99244624, 'recall': 0.9925022, 'specificity': 0.9925022, 'f1': 0.9924716, 'auroc': 0.99964356, 'binary_precision': 0.994201, 'binary_recall': 0.99100834, 'binary_specificity': 0.993996, 'binary_f1_score': 0.9926021}
confusion matrix:
      0     1
0  1490     9
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.7235023, 'precision': 0.7914206, 'recall': 0.71626675, 'specificity': 0.71626675, 'f1': 0.7019656, 'auroc': 0.87172973, 'binary_precision': 0.925, 'binary_recall': 0.46835443, 'binary_specificity': 0.9641791, 'binary_f1_score': 0.62184876}
confusion matrix:
     0    1
0  646   24
1  336  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.89246523, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8670074, 'auroc': 0.9333346, 'binary_precision': 0.9884393, 'binary_recall': 0.7467249, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.8507463}
confusion matrix:
     0    1
0  227    2
1   58  171
early stop counter: 29
val acc:0.7235022783279419, best validation acc: 0.8594470024108887, corresponding to test acc:                         0.8558952212333679 / 0.8930131196975708
after epoch: 30,now: 2024-07-29 11:23:07.431193,epoch time: 0:01:51.361572,used: 0:51:21.506007,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_31_45_seed_11_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:51:21.506007 at 2024-07-29 11:23:07.431193
persisted model performance metric: 

scalar performance:
{'acc': 0.8558952, 'precision': 0.85592234, 'recall': 0.8558952, 'specificity': 0.8558952, 'f1': 0.8558924, 'auroc': 0.92481077, 'binary_precision': 0.85903084, 'binary_recall': 0.8515284, 'binary_specificity': 0.86026204, 'binary_f1_score': 0.8552632}
confusion matrix:
     0    1
0  197   32
1   34  195
oracle model performance metric: 

scalar performance:
{'acc': 0.8930131, 'precision': 0.9060284, 'recall': 0.8930131, 'specificity': 0.8930131, 'f1': 0.89214885, 'auroc': 0.94319326, 'binary_precision': 0.9787234, 'binary_recall': 0.80349344, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.88249403}
confusion matrix:
     0    1
0  225    4
1   45  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456214 KiB |  13219 MiB |    870 TiB |    870 TiB |
|       from large pool | 415616 KiB |  13181 MiB |    860 TiB |    860 TiB |
|       from small pool |  40598 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456214 KiB |  13219 MiB |    870 TiB |    870 TiB |
|       from large pool | 415616 KiB |  13181 MiB |    860 TiB |    860 TiB |
|       from small pool |  40598 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |  40407 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14488 MiB | 163800 MiB | 149326 MiB |
|       from large pool |  14410 MiB |  14422 MiB | 163564 MiB | 149154 MiB |
|       from small pool |     64 MiB |     70 MiB |    236 MiB |    172 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 473577 KiB |   1260 MiB | 636216 GiB | 636215 GiB |
|       from large pool | 462976 KiB |   1252 MiB | 625643 GiB | 625643 GiB |
|       from small pool |  10601 KiB |     46 MiB |  10572 GiB |  10572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  156328 K  |  156327 K  |
|       from large pool |     187    |    1413    |   79554 K  |   79554 K  |
|       from small pool |    1123    |    1419    |   76773 K  |   76772 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  156328 K  |  156327 K  |
|       from large pool |     187    |    1413    |   79554 K  |   79554 K  |
|       from small pool |    1123    |    1419    |   76773 K  |   76772 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     637    |    6918    |    6284    |
|       from large pool |     602    |     602    |    6800    |    6198    |
|       from small pool |      32    |      35    |     118    |      86    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      85    |     655    |  105027 K  |  105027 K  |
|       from large pool |      38    |     604    |   59453 K  |   59453 K  |
|       from small pool |      47    |     237    |   45574 K  |   45574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB | 163800 MiB | 162892 MiB |
|       from large pool |    858 MiB |  14422 MiB | 163564 MiB | 162706 MiB |
|       from small pool |     50 MiB |     70 MiB |    236 MiB |    186 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 636216 GiB | 636216 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 625643 GiB | 625643 GiB |
|       from small pool |      0 KiB |     46 MiB |  10572 GiB |  10572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    6918    |    6854    |
|       from large pool |      39    |     602    |    6800    |    6761    |
|       from small pool |      25    |      35    |     118    |      93    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |  105027 K  |  105027 K  |
|       from large pool |       3    |     604    |   59453 K  |   59453 K  |
|       from small pool |       0    |     237    |   45574 K  |   45574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13181 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    908 MiB |  14488 MiB | 163800 MiB | 162892 MiB |
|       from large pool |    858 MiB |  14422 MiB | 163564 MiB | 162706 MiB |
|       from small pool |     50 MiB |     70 MiB |    236 MiB |    186 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 636216 GiB | 636216 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 625643 GiB | 625643 GiB |
|       from small pool |      0 KiB |     46 MiB |  10572 GiB |  10572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     637    |    6918    |    6854    |
|       from large pool |      39    |     602    |    6800    |    6761    |
|       from small pool |      25    |      35    |     118    |      93    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     655    |  105027 K  |  105027 K  |
|       from large pool |       3    |     604    |   59453 K  |   59453 K  |
|       from small pool |       0    |     237    |   45574 K  |   45574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369

 Experiment start at: 2024-07-29 11:24:00.211760
before training, model accuracy: 0.6380090713500977
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9391108, 'precision': 0.94038236, 'recall': 0.93965495, 'specificity': 0.93965495, 'f1': 0.93910015, 'auroc': 0.98799336, 'binary_precision': 0.9689818, 'binary_recall': 0.9094937, 'binary_specificity': 0.96981627, 'binary_f1_score': 0.9382958}
confusion matrix:
      0     1
0  1478    46
1   143  1437
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.81803924, 'precision': 0.8193806, 'recall': 0.81758845, 'specificity': 0.81758845, 'f1': 0.81767476, 'auroc': 0.8939222, 'binary_precision': 0.8370119, 'binary_recall': 0.7837838, 'binary_specificity': 0.85139316, 'binary_f1_score': 0.80952376}
confusion matrix:
     0    1
0  550   96
1  136  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348416, 'precision': 0.8356732, 'recall': 0.8348416, 'specificity': 0.8348416, 'f1': 0.83473927, 'auroc': 0.911304, 'binary_precision': 0.8189655, 'binary_recall': 0.8597285, 'binary_specificity': 0.80995476, 'binary_f1_score': 0.83885205}
confusion matrix:
     0    1
0  179   42
1   31  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 11:25:53.274749,epoch time: 0:01:53.062989,used: 0:01:53.062989,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9526417, 'precision': 0.95431644, 'recall': 0.95320606, 'specificity': 0.95320606, 'f1': 0.9526269, 'auroc': 0.99407053, 'binary_precision': 0.9864038, 'binary_recall': 0.91951835, 'binary_specificity': 0.98689383, 'binary_f1_score': 0.9517875}
confusion matrix:
      0     1
0  1506    20
1   127  1451
---- Validation: 
scalar performance:
{'acc': 0.7992157, 'precision': 0.8181908, 'recall': 0.7975693, 'specificity': 0.7975693, 'f1': 0.79553795, 'auroc': 0.8851856, 'binary_precision': 0.8926316, 'binary_recall': 0.67408586, 'binary_specificity': 0.92105263, 'binary_f1_score': 0.76811594}
confusion matrix:
     0    1
0  595   51
1  205  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280543, 'precision': 0.8284848, 'recall': 0.8280543, 'specificity': 0.8280543, 'f1': 0.8279979, 'auroc': 0.9108331, 'binary_precision': 0.8403756, 'binary_recall': 0.80995476, 'binary_specificity': 0.84615386, 'binary_f1_score': 0.82488483}
confusion matrix:
     0    1
0  187   34
1   42  179
early stop counter: 1
val acc:0.7992156744003296, best validation acc: 0.8180392384529114, corresponding to test acc:                         0.8348416090011597 / 0.8348416090011597
after epoch: 2,now: 2024-07-29 11:27:28.391555,epoch time: 0:01:35.116806,used: 0:03:28.179795,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97261596, 'precision': 0.97269166, 'recall': 0.97281516, 'specificity': 0.97281516, 'f1': 0.9726152, 'auroc': 0.99681723, 'binary_precision': 0.9844358, 'binary_recall': 0.96136796, 'binary_specificity': 0.9842623, 'binary_f1_score': 0.97276515}
confusion matrix:
      0     1
0  1501    24
1    61  1518
---- Validation: 
scalar performance:
{'acc': 0.8227451, 'precision': 0.8376777, 'recall': 0.82133293, 'specificity': 0.82133293, 'f1': 0.82029086, 'auroc': 0.89560556, 'binary_precision': 0.9054326, 'binary_recall': 0.7154213, 'binary_specificity': 0.9272446, 'binary_f1_score': 0.7992895}
confusion matrix:
     0    1
0  599   47
1  179  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8371041, 'precision': 0.8393553, 'recall': 0.8371041, 'specificity': 0.8371041, 'f1': 0.83683354, 'auroc': 0.90739334, 'binary_precision': 0.8669951, 'binary_recall': 0.7963801, 'binary_specificity': 0.87782806, 'binary_f1_score': 0.83018875}
confusion matrix:
     0    1
0  194   27
1   45  176
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 11:29:02.646152,epoch time: 0:01:34.254597,used: 0:05:02.434392,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9739046, 'precision': 0.9739579, 'recall': 0.9738463, 'specificity': 0.9738463, 'f1': 0.9738939, 'auroc': 0.99679184, 'binary_precision': 0.97166246, 'binary_recall': 0.97720075, 'binary_specificity': 0.9704918, 'binary_f1_score': 0.9744237}
confusion matrix:
      0     1
0  1480    45
1    36  1543
---- Validation: 
scalar performance:
{'acc': 0.74039215, 'precision': 0.805592, 'recall': 0.7372814, 'specificity': 0.7372814, 'f1': 0.72408104, 'auroc': 0.8977418, 'binary_precision': 0.94345236, 'binary_recall': 0.50397456, 'binary_specificity': 0.9705882, 'binary_f1_score': 0.6569948}
confusion matrix:
     0    1
0  627   19
1  312  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348416, 'precision': 0.84677696, 'recall': 0.8348416, 'specificity': 0.8348416, 'f1': 0.83340824, 'auroc': 0.9058987, 'binary_precision': 0.9111111, 'binary_recall': 0.74208146, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.81795514}
confusion matrix:
     0    1
0  205   16
1   57  164
early stop counter: 1
val acc:0.7403921484947205, best validation acc: 0.8227450847625732, corresponding to test acc:                         0.837104082107544 / 0.837104082107544
after epoch: 4,now: 2024-07-29 11:30:53.021212,epoch time: 0:01:50.375060,used: 0:06:52.809452,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9797036, 'precision': 0.97966945, 'recall': 0.97974646, 'specificity': 0.97974646, 'f1': 0.97969973, 'auroc': 0.99859047, 'binary_precision': 0.9827916, 'binary_recall': 0.9771863, 'binary_specificity': 0.98230666, 'binary_f1_score': 0.979981}
confusion matrix:
      0     1
0  1499    27
1    36  1542
---- Validation: 
scalar performance:
{'acc': 0.7247059, 'precision': 0.7573644, 'recall': 0.72228265, 'specificity': 0.72228265, 'f1': 0.7142404, 'auroc': 0.84921515, 'binary_precision': 0.84577113, 'binary_recall': 0.5405405, 'binary_specificity': 0.9040248, 'binary_f1_score': 0.6595538}
confusion matrix:
     0    1
0  584   62
1  289  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122172, 'precision': 0.81273586, 'recall': 0.81221724, 'specificity': 0.81221724, 'f1': 0.8121393, 'auroc': 0.89011276, 'binary_precision': 0.8, 'binary_recall': 0.8325792, 'binary_specificity': 0.7918552, 'binary_f1_score': 0.8159645}
confusion matrix:
     0    1
0  175   46
1   37  184
early stop counter: 2
val acc:0.7247058749198914, best validation acc: 0.8227450847625732, corresponding to test acc:                         0.837104082107544 / 0.837104082107544
after epoch: 5,now: 2024-07-29 11:32:33.925001,epoch time: 0:01:40.903789,used: 0:08:33.713241,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98002577, 'precision': 0.9802042, 'recall': 0.9802776, 'specificity': 0.9802776, 'f1': 0.98002565, 'auroc': 0.9977578, 'binary_precision': 0.9947815, 'binary_recall': 0.9658011, 'binary_specificity': 0.9947541, 'binary_f1_score': 0.9800771}
confusion matrix:
      0     1
0  1517     8
1    54  1525
---- Validation: 
scalar performance:
{'acc': 0.7654902, 'precision': 0.8140327, 'recall': 0.7628441, 'specificity': 0.7628441, 'f1': 0.75481856, 'auroc': 0.8805711, 'binary_precision': 0.93421054, 'binary_recall': 0.5643879, 'binary_specificity': 0.9613003, 'binary_f1_score': 0.703667}
confusion matrix:
     0    1
0  621   25
1  274  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84615386, 'precision': 0.8648281, 'recall': 0.84615386, 'specificity': 0.84615386, 'f1': 0.84415966, 'auroc': 0.9169755, 'binary_precision': 0.94736844, 'binary_recall': 0.7330317, 'binary_specificity': 0.959276, 'binary_f1_score': 0.82653064}
confusion matrix:
     0    1
0  212    9
1   59  162
new oracle model saved
early stop counter: 3
val acc:0.7654901742935181, best validation acc: 0.8227450847625732, corresponding to test acc:                         0.837104082107544 / 0.8461538553237915
after epoch: 6,now: 2024-07-29 11:34:27.905807,epoch time: 0:01:53.980806,used: 0:10:27.694047,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9874356, 'precision': 0.9874252, 'recall': 0.98757195, 'specificity': 0.98757195, 'f1': 0.9874345, 'auroc': 0.99849045, 'binary_precision': 0.9954955, 'binary_recall': 0.979734, 'binary_specificity': 0.99540985, 'binary_f1_score': 0.98755187}
confusion matrix:
      0     1
0  1518     7
1    32  1547
---- Validation: 
scalar performance:
{'acc': 0.83215684, 'precision': 0.8380226, 'recall': 0.8312694, 'specificity': 0.8312694, 'f1': 0.83113873, 'auroc': 0.8958099, 'binary_precision': 0.87934184, 'binary_recall': 0.7647059, 'binary_specificity': 0.8978328, 'binary_f1_score': 0.8180272}
confusion matrix:
     0    1
0  580   66
1  148  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81900454, 'precision': 0.8194231, 'recall': 0.81900454, 'specificity': 0.81900454, 'f1': 0.81894517, 'auroc': 0.87936366, 'binary_precision': 0.80786026, 'binary_recall': 0.8371041, 'binary_specificity': 0.800905, 'binary_f1_score': 0.8222222}
confusion matrix:
     0    1
0  177   44
1   36  185
better model found
persisted
after epoch: 7,now: 2024-07-29 11:36:06.941211,epoch time: 0:01:39.035404,used: 0:12:06.729451,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98099226, 'precision': 0.9809529, 'recall': 0.98105943, 'specificity': 0.98105943, 'f1': 0.980989, 'auroc': 0.9979365, 'binary_precision': 0.9853129, 'binary_recall': 0.97720075, 'binary_specificity': 0.98491806, 'binary_f1_score': 0.98124003}
confusion matrix:
      0     1
0  1502    23
1    36  1543
---- Validation: 
scalar performance:
{'acc': 0.8690196, 'precision': 0.87486845, 'recall': 0.86819094, 'specificity': 0.86819094, 'f1': 0.8683038, 'auroc': 0.93264407, 'binary_precision': 0.91847825, 'binary_recall': 0.80604136, 'binary_specificity': 0.9303405, 'binary_f1_score': 0.8585944}
confusion matrix:
     0    1
0  601   45
1  122  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.8571, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.8398949, 'auroc': 0.90845805, 'binary_precision': 0.93142855, 'binary_recall': 0.7375566, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.82323235}
confusion matrix:
     0    1
0  209   12
1   58  163
better model found
persisted
after epoch: 8,now: 2024-07-29 11:38:07.350057,epoch time: 0:02:00.408846,used: 0:14:07.138297,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9842139, 'precision': 0.9841947, 'recall': 0.98433805, 'specificity': 0.98433805, 'f1': 0.98421234, 'auroc': 0.9989012, 'binary_precision': 0.9916452, 'binary_recall': 0.97720075, 'binary_specificity': 0.9914754, 'binary_f1_score': 0.98437}
confusion matrix:
      0     1
0  1512    13
1    36  1543
---- Validation: 
scalar performance:
{'acc': 0.78745097, 'precision': 0.83266544, 'recall': 0.7849761, 'specificity': 0.7849761, 'f1': 0.7789524, 'auroc': 0.8961741, 'binary_precision': 0.9520202, 'binary_recall': 0.59936404, 'binary_specificity': 0.9705882, 'binary_f1_score': 0.73560977}
confusion matrix:
     0    1
0  627   19
1  252  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7081448, 'precision': 0.78543353, 'recall': 0.7081448, 'specificity': 0.7081448, 'f1': 0.6869534, 'auroc': 0.8692901, 'binary_precision': 0.9339623, 'binary_recall': 0.4479638, 'binary_specificity': 0.9683258, 'binary_f1_score': 0.60550463}
confusion matrix:
     0   1
0  214   7
1  122  99
early stop counter: 1
val acc:0.7874509692192078, best validation acc: 0.869019627571106, corresponding to test acc:                         0.8416289687156677 / 0.8461538553237915
after epoch: 9,now: 2024-07-29 11:39:58.073153,epoch time: 0:01:50.723096,used: 0:15:57.861393,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9855026, 'precision': 0.98556745, 'recall': 0.9856875, 'specificity': 0.9856875, 'f1': 0.9855021, 'auroc': 0.99928284, 'binary_precision': 0.99675953, 'binary_recall': 0.97465146, 'binary_specificity': 0.9967235, 'binary_f1_score': 0.9855815}
confusion matrix:
      0     1
0  1521     5
1    40  1538
---- Validation: 
scalar performance:
{'acc': 0.8070588, 'precision': 0.84294116, 'recall': 0.8048908, 'specificity': 0.8048908, 'f1': 0.80108243, 'auroc': 0.9231814, 'binary_precision': 0.9505882, 'binary_recall': 0.64228934, 'binary_specificity': 0.9674923, 'binary_f1_score': 0.76660335}
confusion matrix:
     0    1
0  625   21
1  225  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85294116, 'precision': 0.8820479, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.85008585, 'auroc': 0.91785586, 'binary_precision': 0.9875, 'binary_recall': 0.71493214, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.82939637}
confusion matrix:
     0    1
0  219    2
1   63  158
new oracle model saved
early stop counter: 2
val acc:0.8070588111877441, best validation acc: 0.869019627571106, corresponding to test acc:                         0.8416289687156677 / 0.8529411554336548
after epoch: 10,now: 2024-07-29 11:41:46.554467,epoch time: 0:01:48.481314,used: 0:17:46.342707,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98936856, 'precision': 0.9893833, 'recall': 0.98934853, 'specificity': 0.98934853, 'f1': 0.989365, 'auroc': 0.99912536, 'binary_precision': 0.988622, 'binary_recall': 0.99050033, 'binary_specificity': 0.98819673, 'binary_f1_score': 0.98956025}
confusion matrix:
      0     1
0  1507    18
1    15  1564
---- Validation: 
scalar performance:
{'acc': 0.76705885, 'precision': 0.81974065, 'recall': 0.7643293, 'specificity': 0.7643293, 'f1': 0.75578004, 'auroc': 0.9014431, 'binary_precision': 0.94623655, 'binary_recall': 0.5596184, 'binary_specificity': 0.9690403, 'binary_f1_score': 0.7032967}
confusion matrix:
     0    1
0  626   20
1  277  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85067874, 'precision': 0.8581885, 'recall': 0.85067874, 'specificity': 0.85067874, 'f1': 0.8498919, 'auroc': 0.91779447, 'binary_precision': 0.9100529, 'binary_recall': 0.77828056, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.8390243}
confusion matrix:
     0    1
0  204   17
1   49  172
early stop counter: 3
val acc:0.7670588493347168, best validation acc: 0.869019627571106, corresponding to test acc:                         0.8416289687156677 / 0.8529411554336548
after epoch: 11,now: 2024-07-29 11:43:40.807695,epoch time: 0:01:54.253228,used: 0:19:40.595935,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9826031, 'precision': 0.98291135, 'recall': 0.9828898, 'specificity': 0.9828898, 'f1': 0.9826031, 'auroc': 0.99942565, 'binary_precision': 1.0, 'binary_recall': 0.9657795, 'binary_specificity': 1.0, 'binary_f1_score': 0.98259187}
confusion matrix:
      0     1
0  1526     0
1    54  1524
---- Validation: 
scalar performance:
{'acc': 0.7647059, 'precision': 0.8235409, 'recall': 0.76184, 'specificity': 0.76184, 'f1': 0.7521474, 'auroc': 0.91019213, 'binary_precision': 0.95821726, 'binary_recall': 0.54689986, 'binary_specificity': 0.9767802, 'binary_f1_score': 0.69635624}
confusion matrix:
     0    1
0  631   15
1  285  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8303167, 'precision': 0.8659936, 'recall': 0.8303168, 'specificity': 0.8303168, 'f1': 0.8260783, 'auroc': 0.9134129, 'binary_precision': 0.9802632, 'binary_recall': 0.67420816, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.7989276}
confusion matrix:
     0    1
0  218    3
1   72  149
early stop counter: 4
val acc:0.7647058963775635, best validation acc: 0.869019627571106, corresponding to test acc:                         0.8416289687156677 / 0.8529411554336548
after epoch: 12,now: 2024-07-29 11:45:27.854822,epoch time: 0:01:47.047127,used: 0:21:27.643062,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9838917, 'precision': 0.9841287, 'recall': 0.9837523, 'specificity': 0.9837523, 'f1': 0.9838816, 'auroc': 0.9990577, 'binary_precision': 0.9769183, 'binary_recall': 0.9917669, 'binary_specificity': 0.9757377, 'binary_f1_score': 0.9842866}
confusion matrix:
      0     1
0  1488    37
1    13  1566
---- Validation: 
scalar performance:
{'acc': 0.80941176, 'precision': 0.8110908, 'recall': 0.8098904, 'specificity': 0.8098904, 'f1': 0.80929166, 'auroc': 0.8836887, 'binary_precision': 0.78466076, 'binary_recall': 0.845787, 'binary_specificity': 0.7739938, 'binary_f1_score': 0.8140781}
confusion matrix:
     0    1
0  500  146
1   97  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7647059, 'precision': 0.7668917, 'recall': 0.7647059, 'specificity': 0.7647059, 'f1': 0.7642231, 'auroc': 0.86267686, 'binary_precision': 0.7427386, 'binary_recall': 0.80995476, 'binary_specificity': 0.71945703, 'binary_f1_score': 0.7748918}
confusion matrix:
     0    1
0  159   62
1   42  179
early stop counter: 5
val acc:0.8094117641448975, best validation acc: 0.869019627571106, corresponding to test acc:                         0.8416289687156677 / 0.8529411554336548
after epoch: 13,now: 2024-07-29 11:47:03.539109,epoch time: 0:01:35.684287,used: 0:23:03.327349,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9619845, 'precision': 0.9640682, 'recall': 0.9626582, 'specificity': 0.9626582, 'f1': 0.9619694, 'auroc': 0.9994422, 'binary_precision': 1.0, 'binary_recall': 0.92531645, 'binary_specificity': 1.0, 'binary_f1_score': 0.9612097}
confusion matrix:
      0     1
0  1524     0
1   118  1462
---- Validation: 
scalar performance:
{'acc': 0.5309804, 'precision': 0.7596463, 'recall': 0.5246423, 'specificity': 0.5246423, 'f1': 0.3887686, 'auroc': 0.89069337, 'binary_precision': 1.0, 'binary_recall': 0.049284577, 'binary_specificity': 1.0, 'binary_f1_score': 0.093939394}
confusion matrix:
     0   1
0  646   0
1  598  31
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.88763535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  221  0
1  221  0
early stop counter: 6
val acc:0.5309804081916809, best validation acc: 0.869019627571106, corresponding to test acc:                         0.8416289687156677 / 0.8529411554336548
after epoch: 14,now: 2024-07-29 11:48:40.322237,epoch time: 0:01:36.783128,used: 0:24:40.110477,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98679125, 'precision': 0.9868188, 'recall': 0.9867592, 'specificity': 0.9867592, 'f1': 0.9867865, 'auroc': 0.99881184, 'binary_precision': 0.9854798, 'binary_recall': 0.9886004, 'binary_specificity': 0.98491806, 'binary_f1_score': 0.98703766}
confusion matrix:
      0     1
0  1502    23
1    18  1561
---- Validation: 
scalar performance:
{'acc': 0.8729412, 'precision': 0.87757826, 'recall': 0.87220734, 'specificity': 0.87220734, 'f1': 0.87237394, 'auroc': 0.93004215, 'binary_precision': 0.916221, 'binary_recall': 0.8171701, 'binary_specificity': 0.9272446, 'binary_f1_score': 0.86386555}
confusion matrix:
     0    1
0  599   47
1  115  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8597285, 'precision': 0.8674321, 'recall': 0.8597285, 'specificity': 0.8597285, 'f1': 0.8589894, 'auroc': 0.9035851, 'binary_precision': 0.9206349, 'binary_recall': 0.7873303, 'binary_specificity': 0.9321267, 'binary_f1_score': 0.8487805}
confusion matrix:
     0    1
0  206   15
1   47  174
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-29 11:50:41.464193,epoch time: 0:02:01.141956,used: 0:26:41.252433,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98679125, 'precision': 0.98704195, 'recall': 0.98665255, 'specificity': 0.98665255, 'f1': 0.9867831, 'auroc': 0.99948335, 'binary_precision': 0.9794136, 'binary_recall': 0.99493027, 'binary_specificity': 0.97837484, 'binary_f1_score': 0.987111}
confusion matrix:
      0     1
0  1493    33
1     8  1570
---- Validation: 
scalar performance:
{'acc': 0.7835294, 'precision': 0.78789866, 'recall': 0.7843277, 'specificity': 0.7843277, 'f1': 0.7829996, 'auroc': 0.8557707, 'binary_precision': 0.7489422, 'binary_recall': 0.84419715, 'binary_specificity': 0.7244582, 'binary_f1_score': 0.793722}
confusion matrix:
     0    1
0  468  178
1   98  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75113124, 'precision': 0.7711147, 'recall': 0.75113124, 'specificity': 0.75113124, 'f1': 0.7464591, 'auroc': 0.844393, 'binary_precision': 0.6975089, 'binary_recall': 0.88687783, 'binary_specificity': 0.61538464, 'binary_f1_score': 0.78087646}
confusion matrix:
     0    1
0  136   85
1   25  196
early stop counter: 1
val acc:0.7835294008255005, best validation acc: 0.8729411959648132, corresponding to test acc:                         0.8597285151481628 / 0.8597285151481628
after epoch: 16,now: 2024-07-29 11:52:17.012184,epoch time: 0:01:35.547991,used: 0:28:16.800424,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9732603, 'precision': 0.97413695, 'recall': 0.97370636, 'specificity': 0.97370636, 'f1': 0.97325826, 'auroc': 0.9980515, 'binary_precision': 0.9993324, 'binary_recall': 0.9480684, 'binary_specificity': 0.9993443, 'binary_f1_score': 0.9730257}
confusion matrix:
      0     1
0  1524     1
1    82  1497
---- Validation: 
scalar performance:
{'acc': 0.7662745, 'precision': 0.8322226, 'recall': 0.76328343, 'specificity': 0.76328343, 'f1': 0.7526728, 'auroc': 0.9256431, 'binary_precision': 0.9769452, 'binary_recall': 0.53895074, 'binary_specificity': 0.9876161, 'binary_f1_score': 0.69467217}
confusion matrix:
     0    1
0  638    8
1  290  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986425, 'precision': 0.85645163, 'recall': 0.7986425, 'specificity': 0.7986425, 'f1': 0.79013354, 'auroc': 0.92160785, 'binary_precision': 1.0, 'binary_recall': 0.5972851, 'binary_specificity': 1.0, 'binary_f1_score': 0.7478754}
confusion matrix:
     0    1
0  221    0
1   89  132
early stop counter: 2
val acc:0.7662745118141174, best validation acc: 0.8729411959648132, corresponding to test acc:                         0.8597285151481628 / 0.8597285151481628
after epoch: 17,now: 2024-07-29 11:53:58.582977,epoch time: 0:01:41.570793,used: 0:29:58.371217,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9645619, 'precision': 0.96717405, 'recall': 0.9639456, 'specificity': 0.9639456, 'f1': 0.9644674, 'auroc': 0.99937785, 'binary_precision': 0.9364608, 'binary_recall': 0.9981013, 'binary_specificity': 0.92979, 'binary_f1_score': 0.966299}
confusion matrix:
      0     1
0  1417   107
1     3  1577
---- Validation: 
scalar performance:
{'acc': 0.7921569, 'precision': 0.812104, 'recall': 0.7938248, 'specificity': 0.7938248, 'f1': 0.78939533, 'auroc': 0.9212446, 'binary_precision': 0.72979796, 'binary_recall': 0.9189189, 'binary_specificity': 0.6687307, 'binary_f1_score': 0.81351155}
confusion matrix:
     0    1
0  432  214
1   51  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7873303, 'precision': 0.8154659, 'recall': 0.7873303, 'specificity': 0.7873303, 'f1': 0.78248036, 'auroc': 0.9138224, 'binary_precision': 0.72125435, 'binary_recall': 0.9366516, 'binary_specificity': 0.6380091, 'binary_f1_score': 0.81496066}
confusion matrix:
     0    1
0  141   80
1   14  207
early stop counter: 3
val acc:0.7921568751335144, best validation acc: 0.8729411959648132, corresponding to test acc:                         0.8597285151481628 / 0.8597285151481628
after epoch: 18,now: 2024-07-29 11:55:47.399474,epoch time: 0:01:48.816497,used: 0:31:47.187714,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98034793, 'precision': 0.98044395, 'recall': 0.98056066, 'specificity': 0.98056066, 'f1': 0.9803475, 'auroc': 0.99895304, 'binary_precision': 0.99285716, 'binary_recall': 0.9683344, 'binary_specificity': 0.9927869, 'binary_f1_score': 0.98044246}
confusion matrix:
      0     1
0  1514    11
1    50  1529
---- Validation: 
scalar performance:
{'acc': 0.8423529, 'precision': 0.8664887, 'recall': 0.84064096, 'specificity': 0.84064096, 'f1': 0.8392193, 'auroc': 0.92241114, 'binary_precision': 0.95726496, 'binary_recall': 0.71224165, 'binary_specificity': 0.9690403, 'binary_f1_score': 0.81677306}
confusion matrix:
     0    1
0  626   20
1  181  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.8720709, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.82801557, 'auroc': 0.9052435, 'binary_precision': 0.9932886, 'binary_recall': 0.6696833, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  220    1
1   73  148
early stop counter: 4
val acc:0.8423529267311096, best validation acc: 0.8729411959648132, corresponding to test acc:                         0.8597285151481628 / 0.8597285151481628
after epoch: 19,now: 2024-07-29 11:57:21.187605,epoch time: 0:01:33.788131,used: 0:33:20.975845,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98679125, 'precision': 0.9867531, 'recall': 0.98687136, 'specificity': 0.98687136, 'f1': 0.98678917, 'auroc': 0.9992691, 'binary_precision': 0.99168795, 'binary_recall': 0.98226726, 'binary_specificity': 0.9914754, 'binary_f1_score': 0.98695517}
confusion matrix:
      0     1
0  1512    13
1    28  1551
---- Validation: 
scalar performance:
{'acc': 0.84705883, 'precision': 0.8530821, 'recall': 0.8461844, 'specificity': 0.8461844, 'f1': 0.8461499, 'auroc': 0.89899445, 'binary_precision': 0.8959854, 'binary_recall': 0.7806041, 'binary_specificity': 0.9117647, 'binary_f1_score': 0.8343246}
confusion matrix:
     0    1
0  589   57
1  138  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8552036, 'precision': 0.8566348, 'recall': 0.8552036, 'specificity': 0.8552036, 'f1': 0.8550582, 'auroc': 0.9008005, 'binary_precision': 0.87922704, 'binary_recall': 0.8235294, 'binary_specificity': 0.88687783, 'binary_f1_score': 0.8504673}
confusion matrix:
     0    1
0  196   25
1   39  182
early stop counter: 5
val acc:0.8470588326454163, best validation acc: 0.8729411959648132, corresponding to test acc:                         0.8597285151481628 / 0.8597285151481628
after epoch: 20,now: 2024-07-29 11:59:13.542186,epoch time: 0:01:52.354581,used: 0:35:13.330426,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98872423, 'precision': 0.9886924, 'recall': 0.98882735, 'specificity': 0.98882735, 'f1': 0.9887228, 'auroc': 0.99916404, 'binary_precision': 0.9948718, 'binary_recall': 0.98290056, 'binary_specificity': 0.9947541, 'binary_f1_score': 0.98884994}
confusion matrix:
      0     1
0  1517     8
1    27  1552
---- Validation: 
scalar performance:
{'acc': 0.84392154, 'precision': 0.8528302, 'recall': 0.8428583, 'specificity': 0.8428583, 'f1': 0.8426188, 'auroc': 0.90758836, 'binary_precision': 0.9056604, 'binary_recall': 0.76311606, 'binary_specificity': 0.9226006, 'binary_f1_score': 0.8283002}
confusion matrix:
     0    1
0  596   50
1  149  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8438914, 'precision': 0.85494506, 'recall': 0.8438914, 'specificity': 0.8438914, 'f1': 0.8426665, 'auroc': 0.9108331, 'binary_precision': 0.9175824, 'binary_recall': 0.7556561, 'binary_specificity': 0.9321267, 'binary_f1_score': 0.82878417}
confusion matrix:
     0    1
0  206   15
1   54  167
early stop counter: 6
val acc:0.8439215421676636, best validation acc: 0.8729411959648132, corresponding to test acc:                         0.8597285151481628 / 0.8597285151481628
after epoch: 21,now: 2024-07-29 12:00:53.207735,epoch time: 0:01:39.665549,used: 0:36:52.995975,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9816366, 'precision': 0.98218864, 'recall': 0.98139226, 'specificity': 0.98139226, 'f1': 0.98161864, 'auroc': 0.9989983, 'binary_precision': 0.96977174, 'binary_recall': 0.9949367, 'binary_specificity': 0.96784776, 'binary_f1_score': 0.98219305}
confusion matrix:
      0     1
0  1475    49
1     8  1572
---- Validation: 
scalar performance:
{'acc': 0.88078433, 'precision': 0.8807631, 'recall': 0.8807631, 'specificity': 0.8807631, 'f1': 0.8807631, 'auroc': 0.9366113, 'binary_precision': 0.8791733, 'binary_recall': 0.8791733, 'binary_specificity': 0.88235295, 'binary_f1_score': 0.8791733}
confusion matrix:
     0    1
0  570   76
1   76  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85067874, 'precision': 0.8517157, 'recall': 0.85067874, 'specificity': 0.85067874, 'f1': 0.85056853, 'auroc': 0.91300344, 'binary_precision': 0.87081337, 'binary_recall': 0.8235294, 'binary_specificity': 0.87782806, 'binary_f1_score': 0.8465116}
confusion matrix:
     0    1
0  194   27
1   39  182
better model found
persisted
after epoch: 22,now: 2024-07-29 12:02:50.221970,epoch time: 0:01:57.014235,used: 0:38:50.010210,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9906572, 'precision': 0.99062234, 'recall': 0.99070483, 'specificity': 0.99070483, 'f1': 0.9906553, 'auroc': 0.9994763, 'binary_precision': 0.9936306, 'binary_recall': 0.9879671, 'binary_specificity': 0.9934426, 'binary_f1_score': 0.9907907}
confusion matrix:
      0     1
0  1515    10
1    19  1560
---- Validation: 
scalar performance:
{'acc': 0.7513726, 'precision': 0.7882452, 'recall': 0.74895406, 'specificity': 0.74895406, 'f1': 0.7419208, 'auroc': 0.8813907, 'binary_precision': 0.8880597, 'binary_recall': 0.5675676, 'binary_specificity': 0.9303405, 'binary_f1_score': 0.6925315}
confusion matrix:
     0    1
0  601   45
1  272  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733032, 'precision': 0.87854254, 'recall': 0.8733032, 'specificity': 0.8733032, 'f1': 0.8728633, 'auroc': 0.9310006, 'binary_precision': 0.9230769, 'binary_recall': 0.81447965, 'binary_specificity': 0.9321267, 'binary_f1_score': 0.86538464}
confusion matrix:
     0    1
0  206   15
1   41  180
new oracle model saved
early stop counter: 1
val acc:0.7513725757598877, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 23,now: 2024-07-29 12:04:42.739642,epoch time: 0:01:52.517672,used: 0:40:42.527882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9896907, 'precision': 0.98972815, 'recall': 0.9896525, 'specificity': 0.9896525, 'f1': 0.9896866, 'auroc': 0.99937785, 'binary_precision': 0.9880202, 'binary_recall': 0.9917722, 'binary_specificity': 0.9875328, 'binary_f1_score': 0.98989266}
confusion matrix:
      0     1
0  1505    19
1    13  1567
---- Validation: 
scalar performance:
{'acc': 0.7003922, 'precision': 0.75266623, 'recall': 0.6973057, 'specificity': 0.6973057, 'f1': 0.6819527, 'auroc': 0.83352613, 'binary_precision': 0.8643068, 'binary_recall': 0.46581876, 'binary_specificity': 0.9287926, 'binary_f1_score': 0.6053719}
confusion matrix:
     0    1
0  600   46
1  336  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82579184, 'precision': 0.84411764, 'recall': 0.82579184, 'specificity': 0.82579184, 'f1': 0.82344127, 'auroc': 0.8996949, 'binary_precision': 0.9235294, 'binary_recall': 0.71040726, 'binary_specificity': 0.9411765, 'binary_f1_score': 0.80306906}
confusion matrix:
     0    1
0  208   13
1   64  157
early stop counter: 2
val acc:0.7003921866416931, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 24,now: 2024-07-29 12:06:35.812649,epoch time: 0:01:53.073007,used: 0:42:35.600889,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9900129, 'precision': 0.98998106, 'recall': 0.99011636, 'specificity': 0.99011636, 'f1': 0.99001163, 'auroc': 0.9997417, 'binary_precision': 0.99615383, 'binary_recall': 0.9841672, 'binary_specificity': 0.99606556, 'binary_f1_score': 0.9901243}
confusion matrix:
      0     1
0  1519     6
1    25  1554
---- Validation: 
scalar performance:
{'acc': 0.72784317, 'precision': 0.8102679, 'recall': 0.72437453, 'specificity': 0.72437453, 'f1': 0.70647633, 'auroc': 0.92494416, 'binary_precision': 0.9668874, 'binary_recall': 0.46422893, 'binary_specificity': 0.98452014, 'binary_f1_score': 0.6272825}
confusion matrix:
     0    1
0  636   10
1  337  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8597285, 'precision': 0.89045936, 'recall': 0.8597285, 'specificity': 0.8597285, 'f1': 0.8569131, 'auroc': 0.9175898, 'binary_precision': 1.0, 'binary_recall': 0.71945703, 'binary_specificity': 1.0, 'binary_f1_score': 0.8368421}
confusion matrix:
     0    1
0  221    0
1   62  159
early stop counter: 3
val acc:0.727843165397644, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 25,now: 2024-07-29 12:08:08.782903,epoch time: 0:01:32.970254,used: 0:44:08.571143,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9935567, 'precision': 0.99351907, 'recall': 0.99365926, 'specificity': 0.99365926, 'f1': 0.9935558, 'auroc': 0.9997919, 'binary_precision': 0.9993598, 'binary_recall': 0.9879747, 'binary_specificity': 0.9993438, 'binary_f1_score': 0.99363464}
confusion matrix:
      0     1
0  1523     1
1    19  1561
---- Validation: 
scalar performance:
{'acc': 0.6682353, 'precision': 0.7829554, 'recall': 0.66394025, 'specificity': 0.66394025, 'f1': 0.6274198, 'auroc': 0.90064454, 'binary_precision': 0.9598214, 'binary_recall': 0.3418124, 'binary_specificity': 0.9860681, 'binary_f1_score': 0.5041032}
confusion matrix:
     0    1
0  637    9
1  414  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280543, 'precision': 0.86463666, 'recall': 0.8280543, 'specificity': 0.8280543, 'f1': 0.8236307, 'auroc': 0.9034827, 'binary_precision': 0.98013246, 'binary_recall': 0.6696833, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.79569894}
confusion matrix:
     0    1
0  218    3
1   73  148
early stop counter: 4
val acc:0.6682353019714355, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 26,now: 2024-07-29 12:10:01.305267,epoch time: 0:01:52.522364,used: 0:46:01.093507,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9909794, 'precision': 0.9909644, 'recall': 0.99111116, 'specificity': 0.99111116, 'f1': 0.9909785, 'auroc': 0.99971056, 'binary_precision': 0.99871385, 'binary_recall': 0.98353386, 'binary_specificity': 0.9986885, 'binary_f1_score': 0.99106574}
confusion matrix:
      0     1
0  1523     2
1    26  1553
---- Validation: 
scalar performance:
{'acc': 0.7827451, 'precision': 0.82987833, 'recall': 0.7802067, 'specificity': 0.7802067, 'f1': 0.77361864, 'auroc': 0.90392077, 'binary_precision': 0.951282, 'binary_recall': 0.5898251, 'binary_specificity': 0.9705882, 'binary_f1_score': 0.7281648}
confusion matrix:
     0    1
0  627   19
1  258  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7669683, 'precision': 0.8274814, 'recall': 0.76696837, 'specificity': 0.76696837, 'f1': 0.7556819, 'auroc': 0.8885977, 'binary_precision': 0.96825397, 'binary_recall': 0.5520362, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.70317006}
confusion matrix:
     0    1
0  217    4
1   99  122
early stop counter: 5
val acc:0.7827451229095459, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 27,now: 2024-07-29 12:11:39.875813,epoch time: 0:01:38.570546,used: 0:47:39.664053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9777706, 'precision': 0.9783699, 'recall': 0.9781369, 'specificity': 0.9781369, 'f1': 0.9777699, 'auroc': 0.9996588, 'binary_precision': 1.0, 'binary_recall': 0.95627373, 'binary_specificity': 1.0, 'binary_f1_score': 0.97764814}
confusion matrix:
      0     1
0  1526     0
1    69  1509
---- Validation: 
scalar performance:
{'acc': 0.5803922, 'precision': 0.76832855, 'recall': 0.5747427, 'specificity': 0.5747427, 'f1': 0.48445916, 'auroc': 0.89984965, 'binary_precision': 0.9895833, 'binary_recall': 0.15103339, 'binary_specificity': 0.998452, 'binary_f1_score': 0.262069}
confusion matrix:
     0   1
0  645   1
1  534  95
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5271493, 'precision': 0.7569767, 'recall': 0.5271493, 'specificity': 0.5271493, 'f1': 0.3909799, 'auroc': 0.8780686, 'binary_precision': 1.0, 'binary_recall': 0.054298643, 'binary_specificity': 1.0, 'binary_f1_score': 0.10300429}
confusion matrix:
     0   1
0  221   0
1  209  12
early stop counter: 6
val acc:0.5803921818733215, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 28,now: 2024-07-29 12:13:32.521080,epoch time: 0:01:52.645267,used: 0:49:32.309320,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9932345, 'precision': 0.99328196, 'recall': 0.99319166, 'specificity': 0.99319166, 'f1': 0.9932318, 'auroc': 0.9997861, 'binary_precision': 0.99117833, 'binary_recall': 0.99556965, 'binary_specificity': 0.9908137, 'binary_f1_score': 0.99336916}
confusion matrix:
      0     1
0  1510    14
1     7  1573
---- Validation: 
scalar performance:
{'acc': 0.8407843, 'precision': 0.85842973, 'recall': 0.8393021, 'specificity': 0.8393021, 'f1': 0.8383646, 'auroc': 0.9110614, 'binary_precision': 0.9346939, 'binary_recall': 0.7281399, 'binary_specificity': 0.95046437, 'binary_f1_score': 0.818588}
confusion matrix:
     0    1
0  614   32
1  171  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.87764865, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.8605454, 'auroc': 0.9115498, 'binary_precision': 0.95454544, 'binary_recall': 0.760181, 'binary_specificity': 0.9638009, 'binary_f1_score': 0.8463476}
confusion matrix:
     0    1
0  213    8
1   53  168
early stop counter: 7
val acc:0.8407843112945557, best validation acc: 0.8807843327522278, corresponding to test acc:                         0.8506787419319153 / 0.8733031749725342
after epoch: 29,now: 2024-07-29 12:15:12.480955,epoch time: 0:01:39.959875,used: 0:51:12.269195,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_24_00_seed_12_23190369
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
slurmstepd: error: *** JOB 23190369 ON supergpu02 CANCELLED AT 2024-07-29T12:16:30 ***
