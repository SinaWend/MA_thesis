Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Mon Jul 29 02:19:23 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370

 Experiment start at: 2024-07-29 02:21:23.137547
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9775479, 'recall': 0.97762024, 'specificity': 0.97762024, 'f1': 0.97753835, 'auroc': 0.99712026, 'binary_precision': 0.9843546, 'binary_recall': 0.9710611, 'binary_specificity': 0.9841793, 'binary_f1_score': 0.9776627}
confusion matrix:
      0     1
0  1493    24
1    45  1510
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.8051242, 'precision': 0.80954087, 'recall': 0.8059435, 'specificity': 0.8059435, 'f1': 0.80468607, 'auroc': 0.8778261, 'binary_precision': 0.76890755, 'binary_recall': 0.8645669, 'binary_specificity': 0.74732006, 'binary_f1_score': 0.81393623}
confusion matrix:
     0    1
0  488  165
1   86  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.7675339, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.75311005, 'auroc': 0.8755436, 'binary_precision': 0.71153843, 'binary_recall': 0.8604651, 'binary_specificity': 0.6511628, 'binary_f1_score': 0.77894735}
confusion matrix:
     0    1
0  140   75
1   30  185
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:23:20.271158,epoch time: 0:01:57.133611,used: 0:01:57.133611,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9758953, 'recall': 0.9755224, 'specificity': 0.9755224, 'f1': 0.97525835, 'auroc': 0.9973856, 'binary_precision': 0.99664205, 'binary_recall': 0.9543408, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.97503287}
confusion matrix:
      0     1
0  1512     5
1    71  1484
---- Validation: 
scalar performance:
{'acc': 0.59006214, 'precision': 0.7023697, 'recall': 0.5847512, 'specificity': 0.5847512, 'f1': 0.5173236, 'auroc': 0.8180976, 'binary_precision': 0.8496732, 'binary_recall': 0.20472442, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.32994926}
confusion matrix:
     0    1
0  630   23
1  505  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5976744, 'precision': 0.7092603, 'recall': 0.5976744, 'specificity': 0.5976744, 'f1': 0.53579074, 'auroc': 0.8528718, 'binary_precision': 0.86206895, 'binary_recall': 0.23255815, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.36630037}
confusion matrix:
     0   1
0  207   8
1  165  50
early stop counter: 1
val acc:0.590062141418457, best validation acc: 0.8051242232322693, corresponding to test acc:                         0.7558139562606812 / 0.7558139562606812
after epoch: 2,now: 2024-07-29 02:24:54.181444,epoch time: 0:01:33.910286,used: 0:03:31.043897,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.97979796, 'recall': 0.97985494, 'specificity': 0.97985494, 'f1': 0.9798161, 'auroc': 0.99786127, 'binary_precision': 0.9831715, 'binary_recall': 0.9768489, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.98}
confusion matrix:
      0     1
0  1491    26
1    36  1519
---- Validation: 
scalar performance:
{'acc': 0.78881985, 'precision': 0.82170033, 'recall': 0.7865647, 'specificity': 0.7865647, 'f1': 0.782354, 'auroc': 0.9132266, 'binary_precision': 0.92111367, 'binary_recall': 0.6251969, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.7448405}
confusion matrix:
     0    1
0  619   34
1  238  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.84752154, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83336884, 'auroc': 0.9185289, 'binary_precision': 0.9137931, 'binary_recall': 0.73953485, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.8174807}
confusion matrix:
     0    1
0  200   15
1   56  159
new oracle model saved
early stop counter: 2
val acc:0.7888198494911194, best validation acc: 0.8051242232322693, corresponding to test acc:                         0.7558139562606812 / 0.8348837494850159
after epoch: 3,now: 2024-07-29 02:26:45.711143,epoch time: 0:01:51.529699,used: 0:05:22.573596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.9639987, 'recall': 0.9604391, 'specificity': 0.9604391, 'f1': 0.9608365, 'auroc': 0.9986812, 'binary_precision': 0.92942584, 'binary_recall': 0.9987146, 'binary_specificity': 0.9221636, 'binary_f1_score': 0.9628253}
confusion matrix:
      0     1
0  1398   118
1     2  1554
---- Validation: 
scalar performance:
{'acc': 0.6467391, 'precision': 0.742866, 'recall': 0.65106535, 'specificity': 0.65106535, 'f1': 0.6116819, 'auroc': 0.8205014, 'binary_precision': 0.58653843, 'binary_recall': 0.96062994, 'binary_specificity': 0.34150076, 'binary_f1_score': 0.7283582}
confusion matrix:
     0    1
0  223  430
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511628, 'precision': 0.77413785, 'recall': 0.6511628, 'specificity': 0.6511628, 'f1': 0.60710025, 'auroc': 0.8988426, 'binary_precision': 0.59052926, 'binary_recall': 0.9860465, 'binary_specificity': 0.31627908, 'binary_f1_score': 0.738676}
confusion matrix:
    0    1
0  68  147
1   3  212
early stop counter: 3
val acc:0.64673912525177, best validation acc: 0.8051242232322693, corresponding to test acc:                         0.7558139562606812 / 0.8348837494850159
after epoch: 4,now: 2024-07-29 02:28:34.177775,epoch time: 0:01:48.466632,used: 0:07:11.040228,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98500293, 'recall': 0.9850589, 'specificity': 0.9850589, 'f1': 0.9850242, 'auroc': 0.9986136, 'binary_precision': 0.987734, 'binary_recall': 0.982659, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.98519003}
confusion matrix:
      0     1
0  1496    19
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.64052796, 'precision': 0.7366072, 'recall': 0.6359974, 'specificity': 0.6359974, 'f1': 0.59567237, 'auroc': 0.84932053, 'binary_precision': 0.8839286, 'binary_recall': 0.31181103, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.46100116}
confusion matrix:
     0    1
0  627   26
1  437  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.81187475, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.7617248, 'auroc': 0.8951433, 'binary_precision': 0.9264706, 'binary_recall': 0.5860465, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.71794873}
confusion matrix:
     0    1
0  205   10
1   89  126
early stop counter: 4
val acc:0.6405279636383057, best validation acc: 0.8051242232322693, corresponding to test acc:                         0.7558139562606812 / 0.8348837494850159
after epoch: 5,now: 2024-07-29 02:30:25.232614,epoch time: 0:01:51.054839,used: 0:09:02.095067,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863738, 'recall': 0.986288, 'specificity': 0.986288, 'f1': 0.9863242, 'auroc': 0.9988744, 'binary_precision': 0.98403573, 'binary_recall': 0.9890886, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.9865557}
confusion matrix:
      0     1
0  1489    25
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.80590063, 'precision': 0.8214936, 'recall': 0.80434334, 'specificity': 0.80434334, 'f1': 0.8029352, 'auroc': 0.9016001, 'binary_precision': 0.8888889, 'binary_recall': 0.6929134, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.7787611}
confusion matrix:
     0    1
0  598   55
1  195  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.80797684, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.75952935, 'auroc': 0.89700377, 'binary_precision': 0.919708, 'binary_recall': 0.5860465, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.7159091}
confusion matrix:
     0    1
0  204   11
1   89  126
better model found
persisted
after epoch: 6,now: 2024-07-29 02:32:10.138886,epoch time: 0:01:44.906272,used: 0:10:47.001339,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9852911, 'recall': 0.98491096, 'specificity': 0.98491096, 'f1': 0.98501915, 'auroc': 0.9993781, 'binary_precision': 0.97662663, 'binary_recall': 0.9942122, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.985341}
confusion matrix:
      0     1
0  1480    37
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.7872671, 'precision': 0.7872828, 'recall': 0.7871387, 'specificity': 0.7871387, 'f1': 0.7871803, 'auroc': 0.86946976, 'binary_precision': 0.7878788, 'binary_recall': 0.77795273, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.7828843}
confusion matrix:
     0    1
0  520  133
1  141  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8239566, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8231602, 'auroc': 0.90585184, 'binary_precision': 0.8088889, 'binary_recall': 0.8465116, 'binary_specificity': 0.8, 'binary_f1_score': 0.8272728}
confusion matrix:
     0    1
0  172   43
1   33  182
early stop counter: 1
val acc:0.7872670888900757, best validation acc: 0.8059006333351135, corresponding to test acc:                         0.7674418687820435 / 0.8348837494850159
after epoch: 7,now: 2024-07-29 02:33:59.641524,epoch time: 0:01:49.502638,used: 0:12:36.503977,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893033, 'recall': 0.9893649, 'specificity': 0.9893649, 'f1': 0.9892577, 'auroc': 0.9995625, 'binary_precision': 0.9980366, 'binary_recall': 0.9807074, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9892961}
confusion matrix:
      0     1
0  1514     3
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.70341617, 'precision': 0.7775276, 'recall': 0.6997552, 'specificity': 0.6997552, 'f1': 0.67976964, 'auroc': 0.8980918, 'binary_precision': 0.91749173, 'binary_recall': 0.43779528, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.5927505}
confusion matrix:
     0    1
0  628   25
1  357  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.8276685, 'recall': 0.7465116, 'specificity': 0.7465116, 'f1': 0.7297796, 'auroc': 0.93931854, 'binary_precision': 0.9907407, 'binary_recall': 0.4976744, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6625387}
confusion matrix:
     0    1
0  214    1
1  108  107
early stop counter: 2
val acc:0.7034161686897278, best validation acc: 0.8059006333351135, corresponding to test acc:                         0.7674418687820435 / 0.8348837494850159
after epoch: 8,now: 2024-07-29 02:35:47.040369,epoch time: 0:01:47.398845,used: 0:14:23.902822,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9881516, 'recall': 0.9878613, 'specificity': 0.9878613, 'f1': 0.98795104, 'auroc': 0.9996439, 'binary_precision': 0.9809886, 'binary_recall': 0.9954984, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9881903}
confusion matrix:
      0     1
0  1487    30
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.82686335, 'precision': 0.839278, 'recall': 0.82551634, 'specificity': 0.82551634, 'f1': 0.82482314, 'auroc': 0.90889776, 'binary_precision': 0.90077823, 'binary_recall': 0.72913384, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.80591816}
confusion matrix:
     0    1
0  602   51
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8631345, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8447347, 'auroc': 0.92110336, 'binary_precision': 0.9408284, 'binary_recall': 0.73953485, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.828125}
confusion matrix:
     0    1
0  205   10
1   56  159
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-29 02:37:35.059827,epoch time: 0:01:48.019458,used: 0:16:11.922280,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899186, 'recall': 0.99000937, 'specificity': 0.99000937, 'f1': 0.9899085, 'auroc': 0.9994048, 'binary_precision': 0.9973924, 'binary_recall': 0.982659, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9899709}
confusion matrix:
      0     1
0  1511     4
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.7080745, 'precision': 0.78657544, 'recall': 0.7043711, 'specificity': 0.7043711, 'f1': 0.6842207, 'auroc': 0.9071783, 'binary_precision': 0.93311036, 'binary_recall': 0.43937007, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.5974304}
confusion matrix:
     0    1
0  633   20
1  356  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66976744, 'precision': 0.7676045, 'recall': 0.66976744, 'specificity': 0.66976744, 'f1': 0.63654757, 'auroc': 0.87521905, 'binary_precision': 0.92941177, 'binary_recall': 0.36744186, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.52666664}
confusion matrix:
     0   1
0  209   6
1  136  79
early stop counter: 1
val acc:0.7080745100975037, best validation acc: 0.8268633484840393, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 10,now: 2024-07-29 02:39:21.297688,epoch time: 0:01:46.237861,used: 0:17:58.160141,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9753746, 'recall': 0.9749103, 'specificity': 0.9749103, 'f1': 0.97460663, 'auroc': 0.9995197, 'binary_precision': 0.99797845, 'binary_recall': 0.9517995, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97434217}
confusion matrix:
      0     1
0  1513     3
1    75  1481
---- Validation: 
scalar performance:
{'acc': 0.6040373, 'precision': 0.75279945, 'recall': 0.59859884, 'specificity': 0.59859884, 'f1': 0.5297251, 'auroc': 0.9233501, 'binary_precision': 0.9432624, 'binary_recall': 0.20944881, 'binary_specificity': 0.98774886, 'binary_f1_score': 0.34278354}
confusion matrix:
     0    1
0  645    8
1  502  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6581395, 'precision': 0.79007936, 'recall': 0.6581395, 'specificity': 0.6581395, 'f1': 0.6142792, 'auroc': 0.9511898, 'binary_precision': 0.98571426, 'binary_recall': 0.32093024, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.48421055}
confusion matrix:
     0   1
0  214   1
1  146  69
early stop counter: 2
val acc:0.6040372848510742, best validation acc: 0.8268633484840393, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 11,now: 2024-07-29 02:41:08.748507,epoch time: 0:01:47.450819,used: 0:19:45.610960,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9834286, 'recall': 0.9829409, 'specificity': 0.9829409, 'f1': 0.9830641, 'auroc': 0.999418, 'binary_precision': 0.9729219, 'binary_recall': 0.9942085, 'binary_specificity': 0.97167325, 'binary_f1_score': 0.98345006}
confusion matrix:
      0     1
0  1475    43
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8090062, 'precision': 0.82430863, 'recall': 0.8074713, 'specificity': 0.8074713, 'f1': 0.8061627, 'auroc': 0.9120208, 'binary_precision': 0.89134806, 'binary_recall': 0.6976378, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.78268546}
confusion matrix:
     0    1
0  599   54
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.8221778, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.7798749, 'auroc': 0.9120389, 'binary_precision': 0.9300699, 'binary_recall': 0.61860466, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.7430167}
confusion matrix:
     0    1
0  205   10
1   82  133
early stop counter: 3
val acc:0.8090062141418457, best validation acc: 0.8268633484840393, corresponding to test acc:                         0.8465116024017334 / 0.8465116024017334
after epoch: 12,now: 2024-07-29 02:42:59.597921,epoch time: 0:01:50.849414,used: 0:21:36.460374,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9919779, 'recall': 0.991787, 'specificity': 0.991787, 'f1': 0.9918588, 'auroc': 0.9997711, 'binary_precision': 0.98729354, 'binary_recall': 0.9967928, 'binary_specificity': 0.98678124, 'binary_f1_score': 0.9920205}
confusion matrix:
      0     1
0  1493    20
1     5  1554
---- Validation: 
scalar performance:
{'acc': 0.88897514, 'precision': 0.8907883, 'recall': 0.8885085, 'specificity': 0.8885085, 'f1': 0.88874173, 'auroc': 0.9309281, 'binary_precision': 0.9141414, 'binary_recall': 0.8551181, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.8836453}
confusion matrix:
     0    1
0  602   51
1   92  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.9037808, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88729686, 'auroc': 0.9217956, 'binary_precision': 0.982659, 'binary_recall': 0.7906977, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87628865}
confusion matrix:
     0    1
0  212    3
1   45  170
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-29 02:44:41.616686,epoch time: 0:01:42.018765,used: 0:23:18.479139,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866682, 'recall': 0.9867489, 'specificity': 0.9867489, 'f1': 0.9866532, 'auroc': 0.9993514, 'binary_precision': 0.9941292, 'binary_recall': 0.97943443, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9867271}
confusion matrix:
      0     1
0  1507     9
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.7633507, 'recall': 0.6602549, 'specificity': 0.6602549, 'f1': 0.6263658, 'auroc': 0.8778744, 'binary_precision': 0.92116183, 'binary_recall': 0.3496063, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.5068493}
confusion matrix:
     0    1
0  634   19
1  413  222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5744186, 'precision': 0.7701005, 'recall': 0.5744186, 'specificity': 0.5744186, 'f1': 0.48028877, 'auroc': 0.95039487, 'binary_precision': 1.0, 'binary_recall': 0.14883721, 'binary_specificity': 1.0, 'binary_f1_score': 0.25910932}
confusion matrix:
     0   1
0  215   0
1  183  32
early stop counter: 1
val acc:0.6645962595939636, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 14,now: 2024-07-29 02:46:27.680907,epoch time: 0:01:46.064221,used: 0:25:04.543360,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918439, 'recall': 0.99193954, 'specificity': 0.99193954, 'f1': 0.99186134, 'auroc': 0.99966043, 'binary_precision': 0.9974043, 'binary_recall': 0.9865212, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.99193287}
confusion matrix:
      0     1
0  1510     4
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8300169, 'recall': 0.77993995, 'specificity': 0.77993995, 'f1': 0.77337396, 'auroc': 0.9335357, 'binary_precision': 0.95165396, 'binary_recall': 0.5889764, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.72762644}
confusion matrix:
     0    1
0  634   19
1  261  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69069767, 'precision': 0.7979651, 'recall': 0.69069767, 'specificity': 0.69069767, 'f1': 0.6601073, 'auroc': 0.9332396, 'binary_precision': 0.9767442, 'binary_recall': 0.3906977, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.55813956}
confusion matrix:
     0   1
0  213   2
1  131  84
early stop counter: 2
val acc:0.782608687877655, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 15,now: 2024-07-29 02:48:17.788606,epoch time: 0:01:50.107699,used: 0:26:54.651059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.991566, 'recall': 0.991511, 'specificity': 0.991511, 'f1': 0.9915347, 'auroc': 0.99963796, 'binary_precision': 0.98975015, 'binary_recall': 0.99356914, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.99165595}
confusion matrix:
      0     1
0  1501    16
1    10  1545
---- Validation: 
scalar performance:
{'acc': 0.7158385, 'precision': 0.8002219, 'recall': 0.7120932, 'specificity': 0.7120932, 'f1': 0.6920472, 'auroc': 0.9261097, 'binary_precision': 0.9559322, 'binary_recall': 0.44409448, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.60645163}
confusion matrix:
     0    1
0  640   13
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837209, 'precision': 0.84564096, 'recall': 0.7837209, 'specificity': 0.7837209, 'f1': 0.77358043, 'auroc': 0.9379773, 'binary_precision': 0.9919355, 'binary_recall': 0.572093, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7256637}
confusion matrix:
     0    1
0  214    1
1   92  123
early stop counter: 3
val acc:0.7158384919166565, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 16,now: 2024-07-29 02:50:08.020535,epoch time: 0:01:50.231929,used: 0:28:44.882988,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921695, 'recall': 0.9922346, 'specificity': 0.9922346, 'f1': 0.9921869, 'auroc': 0.99963665, 'binary_precision': 0.99611145, 'binary_recall': 0.9884244, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.992253}
confusion matrix:
      0     1
0  1511     6
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.76863354, 'precision': 0.8291185, 'recall': 0.7656148, 'specificity': 0.7656148, 'f1': 0.7560978, 'auroc': 0.927793, 'binary_precision': 0.966759, 'binary_recall': 0.5496063, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.7008032}
confusion matrix:
     0    1
0  641   12
1  286  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73023254, 'precision': 0.82477343, 'recall': 0.73023254, 'specificity': 0.73023254, 'f1': 0.7090595, 'auroc': 0.9267496, 'binary_precision': 1.0, 'binary_recall': 0.4604651, 'binary_specificity': 1.0, 'binary_f1_score': 0.6305733}
confusion matrix:
     0   1
0  215   0
1  116  99
early stop counter: 4
val acc:0.7686335444450378, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 17,now: 2024-07-29 02:51:57.882281,epoch time: 0:01:49.861746,used: 0:30:34.744734,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938187, 'recall': 0.99380887, 'specificity': 0.99380887, 'f1': 0.99381363, 'auroc': 0.99982786, 'binary_precision': 0.99358976, 'binary_recall': 0.99422705, 'binary_specificity': 0.9933906, 'binary_f1_score': 0.9939083}
confusion matrix:
      0     1
0  1503    10
1     9  1550
---- Validation: 
scalar performance:
{'acc': 0.8035714, 'precision': 0.8364076, 'recall': 0.8013734, 'specificity': 0.8013734, 'f1': 0.7978329, 'auroc': 0.9259722, 'binary_precision': 0.9380734, 'binary_recall': 0.64409447, 'binary_specificity': 0.9586524, 'binary_f1_score': 0.76377213}
confusion matrix:
     0    1
0  626   27
1  226  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.84179485, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7797664, 'auroc': 0.933629, 'binary_precision': 0.97692305, 'binary_recall': 0.59069765, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7362318}
confusion matrix:
     0    1
0  212    3
1   88  127
early stop counter: 5
val acc:0.8035714030265808, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 18,now: 2024-07-29 02:53:48.795111,epoch time: 0:01:50.912830,used: 0:32:25.657564,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_21_22_seed_0_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 18 with time: 0:32:25.657564 at 2024-07-29 02:53:48.795111
persisted model performance metric: 

scalar performance:
{'acc': 0.88837206, 'precision': 0.9037808, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88729686, 'auroc': 0.9217956, 'binary_precision': 0.982659, 'binary_recall': 0.7906977, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87628865}
confusion matrix:
     0    1
0  212    3
1   45  170
oracle model performance metric: 

scalar performance:
{'acc': 0.88837206, 'precision': 0.9037808, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.88729686, 'auroc': 0.9217956, 'binary_precision': 0.982659, 'binary_recall': 0.7906977, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.87628865}
confusion matrix:
     0    1
0  212    3
1   45  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453045 KiB |   2001 MiB |  39005 GiB |  39005 GiB |
|       from large pool | 412453 KiB |   1969 MiB |  38506 GiB |  38506 GiB |
|       from small pool |  40592 KiB |     56 MiB |    499 GiB |    499 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453045 KiB |   2001 MiB |  39005 GiB |  39005 GiB |
|       from large pool | 412453 KiB |   1969 MiB |  38506 GiB |  38506 GiB |
|       from small pool |  40592 KiB |     56 MiB |    499 GiB |    499 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB |  38987 GiB |  38987 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  38489 GiB |  38489 GiB |
|       from small pool |  40405 KiB |     56 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   2276 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 370250 KiB | 417585 KiB |  29870 GiB |  29870 GiB |
|       from large pool | 363739 KiB | 410867 KiB |  29345 GiB |  29345 GiB |
|       from small pool |   6511 KiB |  12075 KiB |    525 GiB |    525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1669    |    7455 K  |    7453 K  |
|       from large pool |     187    |     311    |    3583 K  |    3583 K  |
|       from small pool |    1111    |    1407    |    3871 K  |    3870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1669    |    7455 K  |    7453 K  |
|       from large pool |     187    |     311    |    3583 K  |    3583 K  |
|       from small pool |    1111    |    1407    |    3871 K  |    3870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     124    |     124    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |     261    |    3741 K  |    3741 K  |
|       from large pool |      39    |      91    |    2164 K  |    2164 K  |
|       from small pool |      36    |     222    |    1577 K  |    1577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2001 MiB |  39005 GiB |  39005 GiB |
|       from large pool |  16640 KiB |   1969 MiB |  38506 GiB |  38506 GiB |
|       from small pool |      0 KiB |     56 MiB |    499 GiB |    499 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2001 MiB |  39005 GiB |  39005 GiB |
|       from large pool |  16640 KiB |   1969 MiB |  38506 GiB |  38506 GiB |
|       from small pool |      0 KiB |     56 MiB |    499 GiB |    499 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  38987 GiB |  38987 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  38489 GiB |  38489 GiB |
|       from small pool |      0 KiB |     56 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   2276 MiB |   1472 MiB |
|       from large pool |    758 MiB |   2212 MiB |   2212 MiB |   1454 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 447655 KiB |  29871 GiB |  29871 GiB |
|       from large pool |  24320 KiB | 429400 KiB |  29346 GiB |  29346 GiB |
|       from small pool |      0 KiB |  18493 KiB |    525 GiB |    525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    7455 K  |    7455 K  |
|       from large pool |       2    |     311    |    3583 K  |    3583 K  |
|       from small pool |       0    |    1407    |    3871 K  |    3871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    7455 K  |    7455 K  |
|       from large pool |       2    |     311    |    3583 K  |    3583 K  |
|       from small pool |       0    |    1407    |    3871 K  |    3871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |    3741 K  |    3741 K  |
|       from large pool |       4    |      91    |    2164 K  |    2164 K  |
|       from small pool |       0    |     222    |    1577 K  |    1577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2001 MiB |  39005 GiB |  39005 GiB |
|       from large pool |  16640 KiB |   1969 MiB |  38506 GiB |  38506 GiB |
|       from small pool |      0 KiB |     56 MiB |    499 GiB |    499 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2001 MiB |  39005 GiB |  39005 GiB |
|       from large pool |  16640 KiB |   1969 MiB |  38506 GiB |  38506 GiB |
|       from small pool |      0 KiB |     56 MiB |    499 GiB |    499 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  38987 GiB |  38987 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  38489 GiB |  38489 GiB |
|       from small pool |      0 KiB |     56 MiB |    498 GiB |    498 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    804 MiB |   2276 MiB |   2276 MiB |   1472 MiB |
|       from large pool |    758 MiB |   2212 MiB |   2212 MiB |   1454 MiB |
|       from small pool |     46 MiB |     64 MiB |     64 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 447655 KiB |  29871 GiB |  29871 GiB |
|       from large pool |  24320 KiB | 429400 KiB |  29346 GiB |  29346 GiB |
|       from small pool |      0 KiB |  18493 KiB |    525 GiB |    525 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1669    |    7455 K  |    7455 K  |
|       from large pool |       2    |     311    |    3583 K  |    3583 K  |
|       from small pool |       0    |    1407    |    3871 K  |    3871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1669    |    7455 K  |    7455 K  |
|       from large pool |       2    |     311    |    3583 K  |    3583 K  |
|       from small pool |       0    |    1407    |    3871 K  |    3871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     124    |     124    |      67    |
|       from large pool |      34    |      92    |      92    |      58    |
|       from small pool |      23    |      32    |      32    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |    3741 K  |    3741 K  |
|       from large pool |       4    |      91    |    2164 K  |    2164 K  |
|       from small pool |       0    |     222    |    1577 K  |    1577 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370

 Experiment start at: 2024-07-29 02:54:39.834650
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9564816, 'recall': 0.9529722, 'specificity': 0.9529722, 'f1': 0.9533317, 'auroc': 0.9967965, 'binary_precision': 0.9222488, 'binary_recall': 0.99163985, 'binary_specificity': 0.91430455, 'binary_f1_score': 0.95568633}
confusion matrix:
      0     1
0  1387   130
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.7681499, 'precision': 0.79262996, 'recall': 0.7704813, 'specificity': 0.7704813, 'f1': 0.76419, 'auroc': 0.887087, 'binary_precision': 0.70379436, 'binary_recall': 0.9126984, 'binary_specificity': 0.6282642, 'binary_f1_score': 0.79474777}
confusion matrix:
     0    1
0  409  242
1   55  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.80206954, 'recall': 0.7888889, 'specificity': 0.7888889, 'f1': 0.7865605, 'auroc': 0.8837136, 'binary_precision': 0.7389706, 'binary_recall': 0.8933333, 'binary_specificity': 0.6844444, 'binary_f1_score': 0.80885303}
confusion matrix:
     0    1
0  154   71
1   24  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:56:29.517272,epoch time: 0:01:49.682622,used: 0:01:49.682622,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.9475795, 'recall': 0.94340205, 'specificity': 0.94340205, 'f1': 0.9438343, 'auroc': 0.99597126, 'binary_precision': 0.911032, 'binary_recall': 0.98587936, 'binary_specificity': 0.9009247, 'binary_f1_score': 0.94697905}
confusion matrix:
      0     1
0  1364   150
1    22  1536
---- Validation: 
scalar performance:
{'acc': 0.8142077, 'precision': 0.81474894, 'recall': 0.8145417, 'specificity': 0.8145417, 'f1': 0.8141985, 'auroc': 0.88083047, 'binary_precision': 0.7969697, 'binary_recall': 0.83492064, 'binary_specificity': 0.7941628, 'binary_f1_score': 0.8155039}
confusion matrix:
     0    1
0  517  134
1  104  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8318051, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.825993, 'auroc': 0.9218371, 'binary_precision': 0.7905138, 'binary_recall': 0.8888889, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8368201}
confusion matrix:
     0    1
0  172   53
1   25  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 02:58:19.889192,epoch time: 0:01:50.371920,used: 0:03:40.054542,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9742305, 'recall': 0.9739039, 'specificity': 0.9739039, 'f1': 0.973631, 'auroc': 0.9986812, 'binary_precision': 0.99463445, 'binary_recall': 0.9530848, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9734164}
confusion matrix:
      0     1
0  1508     8
1    73  1483
---- Validation: 
scalar performance:
{'acc': 0.7259953, 'precision': 0.79423237, 'recall': 0.7219918, 'specificity': 0.7219918, 'f1': 0.7067708, 'auroc': 0.8966553, 'binary_precision': 0.9318885, 'binary_recall': 0.47777778, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.6316894}
confusion matrix:
     0    1
0  629   22
1  329  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.8038194, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.77560174, 'auroc': 0.894242, 'binary_precision': 0.8888889, 'binary_recall': 0.64, 'binary_specificity': 0.92, 'binary_f1_score': 0.74418604}
confusion matrix:
     0    1
0  207   18
1   81  144
early stop counter: 1
val acc:0.7259953022003174, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 3,now: 2024-07-29 03:00:09.897934,epoch time: 0:01:50.008742,used: 0:05:30.063284,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.9771854, 'recall': 0.97683835, 'specificity': 0.97683835, 'f1': 0.97656083, 'auroc': 0.9986867, 'binary_precision': 0.99798656, 'binary_recall': 0.9556555, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9763624}
confusion matrix:
      0     1
0  1513     3
1    69  1487
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.7987235, 'recall': 0.7761136, 'specificity': 0.7761136, 'f1': 0.7734708, 'auroc': 0.8876332, 'binary_precision': 0.8728448, 'binary_recall': 0.64285713, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.7404021}
confusion matrix:
     0    1
0  592   59
1  225  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.80891335, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80888516, 'auroc': 0.8839506, 'binary_precision': 0.8061674, 'binary_recall': 0.81333333, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.8097346}
confusion matrix:
     0    1
0  181   44
1   42  183
early stop counter: 2
val acc:0.7782981991767883, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 4,now: 2024-07-29 03:02:01.705266,epoch time: 0:01:51.807332,used: 0:07:21.870616,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9781531, 'recall': 0.9777974, 'specificity': 0.9777974, 'f1': 0.97753733, 'auroc': 0.99925935, 'binary_precision': 0.9986577, 'binary_recall': 0.9569132, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97733986}
confusion matrix:
      0     1
0  1515     2
1    67  1488
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8188467, 'recall': 0.8006145, 'specificity': 0.8006145, 'f1': 0.799207, 'auroc': 0.8922951, 'binary_precision': 0.8870637, 'binary_recall': 0.6857143, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.77350044}
confusion matrix:
     0    1
0  596   55
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.799782, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.79221594, 'auroc': 0.8610765, 'binary_precision': 0.84375, 'binary_recall': 0.72, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.77697843}
confusion matrix:
     0    1
0  195   30
1   63  162
early stop counter: 3
val acc:0.8024980425834656, best validation acc: 0.8142076730728149, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 5,now: 2024-07-29 03:03:51.828201,epoch time: 0:01:50.122935,used: 0:09:11.993551,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.983773, 'recall': 0.98381567, 'specificity': 0.98381567, 'f1': 0.9837239, 'auroc': 0.9991205, 'binary_precision': 0.9921414, 'binary_recall': 0.9755312, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.98376626}
confusion matrix:
      0     1
0  1507    12
1    38  1515
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.87028146, 'recall': 0.8523041, 'specificity': 0.8523041, 'f1': 0.8519355, 'auroc': 0.9233822, 'binary_precision': 0.94388777, 'binary_recall': 0.74761903, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.8343666}
confusion matrix:
     0    1
0  623   28
1  159  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.85648143, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8406285, 'auroc': 0.905758, 'binary_precision': 0.92777777, 'binary_recall': 0.74222225, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.82469136}
confusion matrix:
     0    1
0  212   13
1   58  167
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-29 03:05:47.080291,epoch time: 0:01:55.252090,used: 0:11:07.245641,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893784, 'recall': 0.9891915, 'specificity': 0.9891915, 'f1': 0.9892546, 'auroc': 0.9996045, 'binary_precision': 0.9840866, 'binary_recall': 0.994852, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.98943996}
confusion matrix:
      0     1
0  1493    25
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.84922755, 'recall': 0.847235, 'specificity': 0.847235, 'f1': 0.8474404, 'auroc': 0.9174091, 'binary_precision': 0.8680203, 'binary_recall': 0.8142857, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.8402948}
confusion matrix:
     0    1
0  573   78
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8631636, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8596945, 'auroc': 0.92618275, 'binary_precision': 0.89705884, 'binary_recall': 0.81333333, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.85314685}
confusion matrix:
     0    1
0  204   21
1   42  183
new oracle model saved
early stop counter: 1
val acc:0.8477751612663269, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8422222137451172 / 0.8600000143051147
after epoch: 7,now: 2024-07-29 03:07:31.973899,epoch time: 0:01:44.893608,used: 0:12:52.139249,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98676366, 'recall': 0.9867998, 'specificity': 0.9867998, 'f1': 0.9866536, 'auroc': 0.9995804, 'binary_precision': 0.9980276, 'binary_recall': 0.9755784, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9866753}
confusion matrix:
      0     1
0  1513     3
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.68384075, 'precision': 0.7889548, 'recall': 0.6788274, 'specificity': 0.6788274, 'f1': 0.64853585, 'auroc': 0.93342113, 'binary_precision': 0.9591837, 'binary_recall': 0.37301588, 'binary_specificity': 0.984639, 'binary_f1_score': 0.5371429}
confusion matrix:
     0    1
0  641   10
1  395  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.75, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.46101233, 'auroc': 0.932879, 'binary_precision': 0.96666664, 'binary_recall': 0.12888889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.22745097}
confusion matrix:
     0   1
0  224   1
1  196  29
early stop counter: 2
val acc:0.6838407516479492, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8422222137451172 / 0.8600000143051147
after epoch: 8,now: 2024-07-29 03:09:22.040467,epoch time: 0:01:50.066568,used: 0:14:42.205817,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928299, 'recall': 0.9928458, 'specificity': 0.9928458, 'f1': 0.9928375, 'auroc': 0.9997795, 'binary_precision': 0.993565, 'binary_recall': 0.99228793, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9929261}
confusion matrix:
      0     1
0  1506    10
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.8390118, 'recall': 0.7900922, 'specificity': 0.7900922, 'f1': 0.7846642, 'auroc': 0.930163, 'binary_precision': 0.9596977, 'binary_recall': 0.6047619, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.7419669}
confusion matrix:
     0    1
0  635   16
1  249  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8187709, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7622236, 'auroc': 0.9025383, 'binary_precision': 0.942029, 'binary_recall': 0.5777778, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.71625346}
confusion matrix:
     0    1
0  217    8
1   95  130
early stop counter: 3
val acc:0.7931303381919861, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8422222137451172 / 0.8600000143051147
after epoch: 9,now: 2024-07-29 03:11:11.591031,epoch time: 0:01:49.550564,used: 0:16:31.756381,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9758359, 'recall': 0.97427213, 'specificity': 0.97427213, 'f1': 0.9745743, 'auroc': 0.99939847, 'binary_precision': 0.9551321, 'binary_recall': 0.9967928, 'binary_specificity': 0.9517515, 'binary_f1_score': 0.97551787}
confusion matrix:
      0     1
0  1440    73
1     5  1554
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.85635924, 'recall': 0.8562724, 'specificity': 0.8562724, 'f1': 0.8563075, 'auroc': 0.91202545, 'binary_precision': 0.85623, 'binary_recall': 0.85079366, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.8535032}
confusion matrix:
     0    1
0  561   90
1   94  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8153516, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8130342, 'auroc': 0.8991803, 'binary_precision': 0.79012346, 'binary_recall': 0.85333335, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.82051283}
confusion matrix:
     0    1
0  174   51
1   33  192
better model found
persisted
after epoch: 10,now: 2024-07-29 03:13:01.729304,epoch time: 0:01:50.138273,used: 0:18:21.894654,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889128, 'recall': 0.9889709, 'specificity': 0.9889709, 'f1': 0.9889314, 'auroc': 0.99960196, 'binary_precision': 0.99223304, 'binary_recall': 0.98585206, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9890323}
confusion matrix:
      0     1
0  1505    12
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.8590313, 'recall': 0.84882236, 'specificity': 0.84882236, 'f1': 0.84881234, 'auroc': 0.9265032, 'binary_precision': 0.9116541, 'binary_recall': 0.76984125, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8347676}
confusion matrix:
     0    1
0  604   47
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8661384, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85696125, 'auroc': 0.92432594, 'binary_precision': 0.921466, 'binary_recall': 0.7822222, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  210   15
1   49  176
early stop counter: 1
val acc:0.8501170873641968, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8133333325386047 / 0.8600000143051147
after epoch: 11,now: 2024-07-29 03:14:55.640302,epoch time: 0:01:53.910998,used: 0:20:15.805652,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898944, 'recall': 0.98998266, 'specificity': 0.98998266, 'f1': 0.9899082, 'auroc': 0.9993174, 'binary_precision': 0.99545455, 'binary_recall': 0.98458576, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9899903}
confusion matrix:
      0     1
0  1508     7
1    24  1533
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8180866, 'recall': 0.78509986, 'specificity': 0.78509986, 'f1': 0.7813928, 'auroc': 0.8868383, 'binary_precision': 0.9124424, 'binary_recall': 0.62857145, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.7443609}
confusion matrix:
     0    1
0  613   38
1  234  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.853976, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8409015, 'auroc': 0.9224297, 'binary_precision': 0.91847825, 'binary_recall': 0.7511111, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8264059}
confusion matrix:
     0    1
0  210   15
1   56  169
early stop counter: 2
val acc:0.7876659035682678, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8133333325386047 / 0.8600000143051147
after epoch: 12,now: 2024-07-29 03:16:45.089051,epoch time: 0:01:49.448749,used: 0:22:05.254401,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98145115, 'recall': 0.98098093, 'specificity': 0.98098093, 'f1': 0.98110944, 'auroc': 0.9986464, 'binary_precision': 0.97166246, 'binary_recall': 0.9916452, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9815522}
confusion matrix:
      0     1
0  1471    45
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.8665105, 'precision': 0.86893284, 'recall': 0.8658474, 'specificity': 0.8658474, 'f1': 0.86611074, 'auroc': 0.92854947, 'binary_precision': 0.8950086, 'binary_recall': 0.82539684, 'binary_specificity': 0.906298, 'binary_f1_score': 0.8587944}
confusion matrix:
     0    1
0  590   61
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.87960196, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84576917, 'auroc': 0.93639505, 'binary_precision': 0.9875776, 'binary_recall': 0.70666665, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8238341}
confusion matrix:
     0    1
0  223    2
1   66  159
better model found
persisted
after epoch: 13,now: 2024-07-29 03:18:37.774985,epoch time: 0:01:52.685934,used: 0:23:57.940335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9863226, 'recall': 0.9858688, 'specificity': 0.9858688, 'f1': 0.98599505, 'auroc': 0.999593, 'binary_precision': 0.9766856, 'binary_recall': 0.99614394, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.98631877}
confusion matrix:
      0     1
0  1479    37
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.7712724, 'precision': 0.78614855, 'recall': 0.7693548, 'specificity': 0.7693548, 'f1': 0.76736593, 'auroc': 0.88652873, 'binary_precision': 0.84742266, 'binary_recall': 0.65238094, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.73721975}
confusion matrix:
     0    1
0  577   74
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8474972, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84657496, 'auroc': 0.8954667, 'binary_precision': 0.8305085, 'binary_recall': 0.8711111, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.85032535}
confusion matrix:
     0    1
0  185   40
1   29  196
early stop counter: 1
val acc:0.7712724208831787, best validation acc: 0.8665105104446411, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 14,now: 2024-07-29 03:20:28.743264,epoch time: 0:01:50.968279,used: 0:25:48.908614,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9970703, 'precision': 0.99707425, 'recall': 0.99706554, 'specificity': 0.99706554, 'f1': 0.99706984, 'auroc': 0.99996984, 'binary_precision': 0.9967887, 'binary_recall': 0.9974293, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99710894}
confusion matrix:
      0     1
0  1511     5
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.87275565, 'precision': 0.88253486, 'recall': 0.8714541, 'specificity': 0.8714541, 'f1': 0.8716291, 'auroc': 0.9397776, 'binary_precision': 0.93973637, 'binary_recall': 0.7920635, 'binary_specificity': 0.9508448, 'binary_f1_score': 0.85960376}
confusion matrix:
     0    1
0  619   32
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8844444, 'precision': 0.8957321, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.88361454, 'auroc': 0.9353284, 'binary_precision': 0.96256685, 'binary_recall': 0.8, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.87378645}
confusion matrix:
     0    1
0  218    7
1   45  180
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-29 03:22:21.667346,epoch time: 0:01:52.924082,used: 0:27:41.832696,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9737991, 'recall': 0.9729556, 'specificity': 0.9729556, 'f1': 0.97264904, 'auroc': 0.99967444, 'binary_precision': 1.0, 'binary_recall': 0.94591117, 'binary_specificity': 1.0, 'binary_f1_score': 0.97220385}
confusion matrix:
      0     1
0  1519     0
1    84  1469
---- Validation: 
scalar performance:
{'acc': 0.6284153, 'precision': 0.77675176, 'recall': 0.62232465, 'specificity': 0.62232465, 'f1': 0.56503165, 'auroc': 0.9362738, 'binary_precision': 0.97530866, 'binary_recall': 0.25079367, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.39898992}
confusion matrix:
     0    1
0  647    4
1  472  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52666664, 'precision': 0.7568493, 'recall': 0.52666664, 'specificity': 0.52666664, 'f1': 0.38999945, 'auroc': 0.93082464, 'binary_precision': 1.0, 'binary_recall': 0.053333335, 'binary_specificity': 1.0, 'binary_f1_score': 0.10126583}
confusion matrix:
     0   1
0  225   0
1  213  12
early stop counter: 1
val acc:0.6284152865409851, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8844444155693054 / 0.8844444155693054
after epoch: 16,now: 2024-07-29 03:24:13.339691,epoch time: 0:01:51.672345,used: 0:29:33.505041,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922179, 'recall': 0.992278, 'specificity': 0.992278, 'f1': 0.9921874, 'auroc': 0.99988294, 'binary_precision': 1.0, 'binary_recall': 0.98455596, 'binary_specificity': 1.0, 'binary_f1_score': 0.9922179}
confusion matrix:
      0     1
0  1518     0
1    24  1530
---- Validation: 
scalar performance:
{'acc': 0.6206089, 'precision': 0.77337885, 'recall': 0.6143881, 'specificity': 0.6143881, 'f1': 0.55274147, 'auroc': 0.92134935, 'binary_precision': 0.9736842, 'binary_recall': 0.23492064, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.37851664}
confusion matrix:
     0    1
0  647    4
1  482  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52444446, 'precision': 0.7562642, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.38546562, 'auroc': 0.9181432, 'binary_precision': 1.0, 'binary_recall': 0.04888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.09322034}
confusion matrix:
     0   1
0  225   0
1  214  11
early stop counter: 2
val acc:0.620608925819397, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8844444155693054 / 0.8844444155693054
after epoch: 17,now: 2024-07-29 03:26:06.687717,epoch time: 0:01:53.348026,used: 0:31:26.853067,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882642, 'recall': 0.9883503, 'specificity': 0.9883503, 'f1': 0.9882804, 'auroc': 0.9995879, 'binary_precision': 0.9935107, 'binary_recall': 0.9833012, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.98837966}
confusion matrix:
      0     1
0  1505    10
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.8660053, 'recall': 0.8541987, 'specificity': 0.8541987, 'f1': 0.8541707, 'auroc': 0.93845063, 'binary_precision': 0.9238095, 'binary_recall': 0.76984125, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8398269}
confusion matrix:
     0    1
0  611   40
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.849079, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8084291, 'auroc': 0.9155358, 'binary_precision': 0.9607843, 'binary_recall': 0.6533333, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.77777773}
confusion matrix:
     0    1
0  219    6
1   78  147
early stop counter: 3
val acc:0.8555815815925598, best validation acc: 0.8727556467056274, corresponding to test acc:                         0.8844444155693054 / 0.8844444155693054
after epoch: 18,now: 2024-07-29 03:27:48.139927,epoch time: 0:01:41.452210,used: 0:33:08.305277,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.987079, 'recall': 0.9871211, 'specificity': 0.9871211, 'f1': 0.9869791, 'auroc': 0.9997863, 'binary_precision': 0.99802893, 'binary_recall': 0.9762211, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9870045}
confusion matrix:
      0     1
0  1513     3
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.88056207, 'precision': 0.8869726, 'recall': 0.8795187, 'specificity': 0.8795187, 'f1': 0.87982976, 'auroc': 0.93337965, 'binary_precision': 0.93284935, 'binary_recall': 0.815873, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.8704488}
confusion matrix:
     0    1
0  614   37
1  116  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8872553, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86731565, 'auroc': 0.92977774, 'binary_precision': 0.97159094, 'binary_recall': 0.76, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8528678}
confusion matrix:
     0    1
0  220    5
1   54  171
better model found
persisted
after epoch: 19,now: 2024-07-29 03:29:39.778406,epoch time: 0:01:51.638479,used: 0:34:59.943756,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99089205, 'recall': 0.9908771, 'specificity': 0.9908771, 'f1': 0.9908842, 'auroc': 0.99982023, 'binary_precision': 0.9903537, 'binary_recall': 0.9916291, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.990991}
confusion matrix:
      0     1
0  1504    15
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.87740004, 'recall': 0.86346644, 'specificity': 0.86346644, 'f1': 0.8634552, 'auroc': 0.9363397, 'binary_precision': 0.9419729, 'binary_recall': 0.77301586, 'binary_specificity': 0.953917, 'binary_f1_score': 0.8491718}
confusion matrix:
     0    1
0  621   30
1  143  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8799392, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85320026, 'auroc': 0.92408884, 'binary_precision': 0.97619045, 'binary_recall': 0.72888887, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.83460563}
confusion matrix:
     0    1
0  221    4
1   61  164
early stop counter: 1
val acc:0.8649492859840393, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8844444155693054
after epoch: 20,now: 2024-07-29 03:31:31.412443,epoch time: 0:01:51.634037,used: 0:36:51.577793,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.97080743, 'recall': 0.96979433, 'specificity': 0.96979433, 'f1': 0.9693916, 'auroc': 0.99954975, 'binary_precision': 1.0, 'binary_recall': 0.93958867, 'binary_specificity': 1.0, 'binary_f1_score': 0.96885353}
confusion matrix:
      0     1
0  1516     0
1    94  1462
---- Validation: 
scalar performance:
{'acc': 0.5690867, 'precision': 0.75844705, 'recall': 0.561956, 'specificity': 0.561956, 'f1': 0.46317038, 'auroc': 0.9175682, 'binary_precision': 0.9756098, 'binary_recall': 0.12698413, 'binary_specificity': 0.9969278, 'binary_f1_score': 0.22471912}
confusion matrix:
     0   1
0  649   2
1  550  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.77573526, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.5127536, 'auroc': 0.9035951, 'binary_precision': 1.0, 'binary_recall': 0.18666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.31460673}
confusion matrix:
     0   1
0  225   0
1  183  42
early stop counter: 2
val acc:0.5690866708755493, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8844444155693054
after epoch: 21,now: 2024-07-29 03:33:22.168730,epoch time: 0:01:50.756287,used: 0:38:42.334080,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99541485, 'recall': 0.99549043, 'specificity': 0.99549043, 'f1': 0.9954421, 'auroc': 0.99993473, 'binary_precision': 0.99870884, 'binary_recall': 0.9923028, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.9954955}
confusion matrix:
      0     1
0  1511     2
1    12  1547
---- Validation: 
scalar performance:
{'acc': 0.7759563, 'precision': 0.8291082, 'recall': 0.7726319, 'specificity': 0.7726319, 'f1': 0.7650495, 'auroc': 0.94339174, 'binary_precision': 0.9573333, 'binary_recall': 0.56984127, 'binary_specificity': 0.97542244, 'binary_f1_score': 0.7144279}
confusion matrix:
     0    1
0  635   16
1  271  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8497882, 'recall': 0.8066666, 'specificity': 0.8066666, 'f1': 0.80051875, 'auroc': 0.9229827, 'binary_precision': 0.9726027, 'binary_recall': 0.6311111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7654987}
confusion matrix:
     0    1
0  221    4
1   83  142
early stop counter: 3
val acc:0.7759562730789185, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8844444155693054
after epoch: 22,now: 2024-07-29 03:35:12.082110,epoch time: 0:01:49.913380,used: 0:40:32.247460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928261, 'recall': 0.9928528, 'specificity': 0.9928528, 'f1': 0.9928378, 'auroc': 0.99980456, 'binary_precision': 0.99419355, 'binary_recall': 0.9916345, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.99291235}
confusion matrix:
      0     1
0  1509     9
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8547226, 'recall': 0.8260113, 'specificity': 0.8260113, 'f1': 0.8242701, 'auroc': 0.9480524, 'binary_precision': 0.9475983, 'binary_recall': 0.6888889, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.7977941}
confusion matrix:
     0    1
0  627   24
1  196  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88666666, 'precision': 0.9043085, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.8854167, 'auroc': 0.95093334, 'binary_precision': 0.98876405, 'binary_recall': 0.7822222, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8734491}
confusion matrix:
     0    1
0  223    2
1   49  176
new oracle model saved
early stop counter: 4
val acc:0.8282591700553894, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8866666555404663
after epoch: 23,now: 2024-07-29 03:37:04.462513,epoch time: 0:01:52.380403,used: 0:42:24.627863,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98960114, 'recall': 0.9895646, 'specificity': 0.9895646, 'f1': 0.9895812, 'auroc': 0.9990593, 'binary_precision': 0.98846155, 'binary_recall': 0.99100256, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9897305}
confusion matrix:
      0     1
0  1498    18
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.85922945, 'recall': 0.8405274, 'specificity': 0.8405274, 'f1': 0.83990586, 'auroc': 0.93911684, 'binary_precision': 0.9331984, 'binary_recall': 0.731746, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.82028466}
confusion matrix:
     0    1
0  618   33
1  169  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.85950303, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82261616, 'auroc': 0.911442, 'binary_precision': 0.9681529, 'binary_recall': 0.6755555, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7958115}
confusion matrix:
     0    1
0  220    5
1   73  152
early stop counter: 5
val acc:0.8423106670379639, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8866666555404663
after epoch: 24,now: 2024-07-29 03:38:52.044447,epoch time: 0:01:47.581934,used: 0:44:12.209797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_39_seed_1_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 24 with time: 0:44:12.209797 at 2024-07-29 03:38:52.044447
persisted model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.8872553, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86731565, 'auroc': 0.92977774, 'binary_precision': 0.97159094, 'binary_recall': 0.76, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8528678}
confusion matrix:
     0    1
0  220    5
1   54  171
oracle model performance metric: 

scalar performance:
{'acc': 0.88666666, 'precision': 0.9043085, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.8854167, 'auroc': 0.95093334, 'binary_precision': 0.98876405, 'binary_recall': 0.7822222, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.8734491}
confusion matrix:
     0    1
0  223    2
1   49  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455312 KiB |   2003 MiB |  91009 GiB |  91009 GiB |
|       from large pool | 414714 KiB |   1970 MiB |  89838 GiB |  89838 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455312 KiB |   2003 MiB |  91009 GiB |  91009 GiB |
|       from large pool | 414714 KiB |   1970 MiB |  89838 GiB |  89838 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB |  90964 GiB |  90963 GiB |
|       from large pool | 407075 KiB |   1966 MiB |  89795 GiB |  89795 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1168 GiB |   1168 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   3748 MiB |   1472 MiB |
|       from large pool |   2206 MiB |   2212 MiB |   3660 MiB |   1454 MiB |
|       from small pool |     70 MiB |     70 MiB |     88 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 406895 KiB | 447655 KiB |  70602 GiB |  70601 GiB |
|       from large pool | 400390 KiB | 429400 KiB |  69369 GiB |  69369 GiB |
|       from small pool |   6505 KiB |  18493 KiB |   1232 GiB |   1232 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   17413 K  |   17412 K  |
|       from large pool |     187    |     311    |    8358 K  |    8358 K  |
|       from small pool |    1123    |    1419    |    9054 K  |    9053 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   17413 K  |   17412 K  |
|       from large pool |     187    |     311    |    8358 K  |    8358 K  |
|       from small pool |    1123    |    1419    |    9054 K  |    9053 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     194    |      67    |
|       from large pool |      92    |      92    |     150    |      58    |
|       from small pool |      35    |      35    |      44    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |     261    |    8751 K  |    8751 K  |
|       from large pool |      35    |      91    |    5103 K  |    5103 K  |
|       from small pool |      35    |     223    |    3648 K  |    3648 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |  91009 GiB |  91009 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  89838 GiB |  89838 GiB |
|       from small pool |      0 KiB |     60 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |  91009 GiB |  91009 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  89838 GiB |  89838 GiB |
|       from small pool |      0 KiB |     60 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  90964 GiB |  90963 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  89795 GiB |  89795 GiB |
|       from small pool |      0 KiB |     60 MiB |   1168 GiB |   1168 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2276 MiB |   3748 MiB |   2906 MiB |
|       from large pool |    796 MiB |   2212 MiB |   3660 MiB |   2864 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB |  70602 GiB |  70602 GiB |
|       from large pool |  24320 KiB | 476433 KiB |  69370 GiB |  69370 GiB |
|       from small pool |      0 KiB |  18493 KiB |   1232 GiB |   1232 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   17413 K  |   17413 K  |
|       from large pool |       2    |     311    |    8358 K  |    8358 K  |
|       from small pool |       0    |    1419    |    9054 K  |    9054 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   17413 K  |   17413 K  |
|       from large pool |       2    |     311    |    8358 K  |    8358 K  |
|       from small pool |       0    |    1419    |    9054 K  |    9054 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     194    |     136    |
|       from large pool |      35    |      92    |     150    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |    8751 K  |    8751 K  |
|       from large pool |       4    |      91    |    5103 K  |    5103 K  |
|       from small pool |       0    |     223    |    3648 K  |    3648 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |  91009 GiB |  91009 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  89838 GiB |  89838 GiB |
|       from small pool |      0 KiB |     60 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |  91009 GiB |  91009 GiB |
|       from large pool |  16640 KiB |   1970 MiB |  89838 GiB |  89838 GiB |
|       from small pool |      0 KiB |     60 MiB |   1170 GiB |   1170 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |  90964 GiB |  90963 GiB |
|       from large pool |  16640 KiB |   1966 MiB |  89795 GiB |  89795 GiB |
|       from small pool |      0 KiB |     60 MiB |   1168 GiB |   1168 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2276 MiB |   3748 MiB |   2906 MiB |
|       from large pool |    796 MiB |   2212 MiB |   3660 MiB |   2864 MiB |
|       from small pool |     46 MiB |     70 MiB |     88 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB |  70602 GiB |  70602 GiB |
|       from large pool |  24320 KiB | 476433 KiB |  69370 GiB |  69370 GiB |
|       from small pool |      0 KiB |  18493 KiB |   1232 GiB |   1232 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   17413 K  |   17413 K  |
|       from large pool |       2    |     311    |    8358 K  |    8358 K  |
|       from small pool |       0    |    1419    |    9054 K  |    9054 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   17413 K  |   17413 K  |
|       from large pool |       2    |     311    |    8358 K  |    8358 K  |
|       from small pool |       0    |    1419    |    9054 K  |    9054 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     194    |     136    |
|       from large pool |      35    |      92    |     150    |     115    |
|       from small pool |      23    |      35    |      44    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |    8751 K  |    8751 K  |
|       from large pool |       4    |      91    |    5103 K  |    5103 K  |
|       from small pool |       0    |     223    |    3648 K  |    3648 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370

 Experiment start at: 2024-07-29 03:39:44.280191
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9492801, 'precision': 0.9508939, 'recall': 0.9495263, 'specificity': 0.9495263, 'f1': 0.9492512, 'auroc': 0.9877977, 'binary_precision': 0.979903, 'binary_recall': 0.91818184, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9480389}
confusion matrix:
      0     1
0  1487    29
1   126  1414
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.830475, 'recall': 0.81414694, 'specificity': 0.81414694, 'f1': 0.8139858, 'auroc': 0.89668214, 'binary_precision': 0.891129, 'binary_recall': 0.7106109, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.7906977}
confusion matrix:
     0    1
0  602   54
1  180  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.83613443, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.76769507, 'auroc': 0.90309924, 'binary_precision': 0.97619045, 'binary_recall': 0.5694444, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.71929824}
confusion matrix:
     0    1
0  213    3
1   93  123
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 03:41:37.040372,epoch time: 0:01:52.760181,used: 0:01:52.760181,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9587696, 'precision': 0.9609174, 'recall': 0.9590498, 'specificity': 0.9590498, 'f1': 0.9587369, 'auroc': 0.99491143, 'binary_precision': 0.99440557, 'binary_recall': 0.9233766, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.95757574}
confusion matrix:
      0     1
0  1508     8
1   118  1422
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.7012361, 'recall': 0.60676366, 'specificity': 0.60676366, 'f1': 0.5600393, 'auroc': 0.69823444, 'binary_precision': 0.82587063, 'binary_recall': 0.26688102, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.40340218}
confusion matrix:
     0    1
0  621   35
1  456  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6805556, 'precision': 0.7831025, 'recall': 0.6805556, 'specificity': 0.6805556, 'f1': 0.64874744, 'auroc': 0.8908179, 'binary_precision': 0.95348835, 'binary_recall': 0.37962964, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.5430464}
confusion matrix:
     0   1
0  212   4
1  134  82
early stop counter: 1
val acc:0.6158059239387512, best validation acc: 0.8169013857841492, corresponding to test acc:                         0.7777777910232544 / 0.7777777910232544
after epoch: 2,now: 2024-07-29 03:43:26.174492,epoch time: 0:01:49.134120,used: 0:03:41.894301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98103607, 'recall': 0.98081326, 'specificity': 0.98081326, 'f1': 0.9806926, 'auroc': 0.998721, 'binary_precision': 0.9959812, 'binary_recall': 0.9655844, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98054725}
confusion matrix:
      0     1
0  1510     6
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.5766823, 'precision': 0.7517081, 'recall': 0.5652792, 'specificity': 0.5652792, 'f1': 0.4729375, 'auroc': 0.83432424, 'binary_precision': 0.9550562, 'binary_recall': 0.13665594, 'binary_specificity': 0.99390244, 'binary_f1_score': 0.23909985}
confusion matrix:
     0   1
0  652   4
1  537  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.6553957, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.38844094, 'auroc': 0.7864584, 'binary_precision': 0.8, 'binary_recall': 0.055555556, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.103896104}
confusion matrix:
     0   1
0  213   3
1  204  12
early stop counter: 2
val acc:0.5766823291778564, best validation acc: 0.8169013857841492, corresponding to test acc:                         0.7777777910232544 / 0.7777777910232544
after epoch: 3,now: 2024-07-29 03:45:18.573518,epoch time: 0:01:52.399026,used: 0:05:34.293327,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98004884, 'recall': 0.98007655, 'specificity': 0.98007655, 'f1': 0.9800391, 'auroc': 0.9973152, 'binary_precision': 0.98491806, 'binary_recall': 0.9753247, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9800979}
confusion matrix:
      0     1
0  1493    23
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.6713615, 'precision': 0.78731173, 'recall': 0.66271275, 'specificity': 0.66271275, 'f1': 0.62762237, 'auroc': 0.8729211, 'binary_precision': 0.96330273, 'binary_recall': 0.3376206, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.5}
confusion matrix:
     0    1
0  648    8
1  412  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.71810174, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.39098442, 'auroc': 0.853095, 'binary_precision': 0.9230769, 'binary_recall': 0.055555556, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.104803495}
confusion matrix:
     0   1
0  215   1
1  204  12
early stop counter: 3
val acc:0.67136150598526, best validation acc: 0.8169013857841492, corresponding to test acc:                         0.7777777910232544 / 0.7777777910232544
after epoch: 4,now: 2024-07-29 03:47:08.775656,epoch time: 0:01:50.202138,used: 0:07:24.495465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.9835319, 'recall': 0.9834107, 'specificity': 0.9834107, 'f1': 0.9833112, 'auroc': 0.99846053, 'binary_precision': 0.9960027, 'binary_recall': 0.97077924, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9832293}
confusion matrix:
      0     1
0  1510     6
1    45  1495
---- Validation: 
scalar performance:
{'acc': 0.6064163, 'precision': 0.76044714, 'recall': 0.5959091, 'specificity': 0.5959091, 'f1': 0.5265129, 'auroc': 0.9046631, 'binary_precision': 0.9541985, 'binary_recall': 0.20096463, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.33200532}
confusion matrix:
     0    1
0  650    6
1  497  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.60236967, 'recall': 0.5092593, 'specificity': 0.5092593, 'f1': 0.36482927, 'auroc': 0.83719134, 'binary_precision': 0.7, 'binary_recall': 0.032407407, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.061946902}
confusion matrix:
     0  1
0  213  3
1  209  7
early stop counter: 4
val acc:0.6064162850379944, best validation acc: 0.8169013857841492, corresponding to test acc:                         0.7777777910232544 / 0.7777777910232544
after epoch: 5,now: 2024-07-29 03:48:51.308846,epoch time: 0:01:42.533190,used: 0:09:07.028655,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9853126, 'recall': 0.98525083, 'specificity': 0.98525083, 'f1': 0.9852732, 'auroc': 0.9989227, 'binary_precision': 0.9825694, 'binary_recall': 0.9883117, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9854322}
confusion matrix:
      0     1
0  1489    27
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.8356807, 'precision': 0.84593785, 'recall': 0.8333562, 'specificity': 0.8333562, 'f1': 0.8336849, 'auroc': 0.90797293, 'binary_precision': 0.8992248, 'binary_recall': 0.7459807, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.8154657}
confusion matrix:
     0    1
0  604   52
1  158  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.82053876, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.7672815, 'auroc': 0.89889836, 'binary_precision': 0.94074076, 'binary_recall': 0.587963, 'binary_specificity': 0.962963, 'binary_f1_score': 0.72364676}
confusion matrix:
     0    1
0  208    8
1   89  127
better model found
persisted
after epoch: 6,now: 2024-07-29 03:50:41.101884,epoch time: 0:01:49.793038,used: 0:10:56.821693,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.9801623, 'recall': 0.9801177, 'specificity': 0.9801177, 'f1': 0.98003924, 'auroc': 0.9980999, 'binary_precision': 0.9900596, 'binary_recall': 0.97012985, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.97999346}
confusion matrix:
      0     1
0  1501    15
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.74491394, 'precision': 0.8173669, 'recall': 0.73844206, 'specificity': 0.73844206, 'f1': 0.72597253, 'auroc': 0.9162663, 'binary_precision': 0.9625, 'binary_recall': 0.49517685, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.6539278}
confusion matrix:
     0    1
0  644   12
1  314  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5578704, 'precision': 0.7653563, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.4504439, 'auroc': 0.9004844, 'binary_precision': 1.0, 'binary_recall': 0.11574074, 'binary_specificity': 1.0, 'binary_f1_score': 0.20746887}
confusion matrix:
     0   1
0  216   0
1  191  25
early stop counter: 1
val acc:0.7449139356613159, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.7754629850387573 / 0.7777777910232544
after epoch: 7,now: 2024-07-29 03:52:31.512508,epoch time: 0:01:50.410624,used: 0:12:47.232317,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9873842, 'recall': 0.9873222, 'specificity': 0.9873222, 'f1': 0.9872381, 'auroc': 0.99850214, 'binary_precision': 0.99800926, 'binary_recall': 0.97662336, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9872005}
confusion matrix:
      0     1
0  1513     3
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.79499215, 'precision': 0.831396, 'recall': 0.790514, 'specificity': 0.790514, 'f1': 0.78736794, 'auroc': 0.90998256, 'binary_precision': 0.9347826, 'binary_recall': 0.6221865, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.7471042}
confusion matrix:
     0    1
0  629   27
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5925926, 'precision': 0.7530459, 'recall': 0.5925926, 'specificity': 0.5925926, 'f1': 0.5158431, 'auroc': 0.8913537, 'binary_precision': 0.95454544, 'binary_recall': 0.19444445, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.32307693}
confusion matrix:
     0   1
0  214   2
1  174  42
early stop counter: 2
val acc:0.7949921488761902, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.7754629850387573 / 0.7777777910232544
after epoch: 8,now: 2024-07-29 03:54:21.680318,epoch time: 0:01:50.167810,used: 0:14:37.400127,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9626963, 'precision': 0.96503067, 'recall': 0.962987, 'specificity': 0.962987, 'f1': 0.9626639, 'auroc': 0.999229, 'binary_precision': 1.0, 'binary_recall': 0.925974, 'binary_specificity': 1.0, 'binary_f1_score': 0.96156436}
confusion matrix:
      0     1
0  1516     0
1   114  1426
---- Validation: 
scalar performance:
{'acc': 0.52190924, 'precision': 0.72043175, 'recall': 0.50888413, 'specificity': 0.50888413, 'f1': 0.3598659, 'auroc': 0.86894834, 'binary_precision': 0.9230769, 'binary_recall': 0.019292604, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.037795275}
confusion matrix:
     0   1
0  655   1
1  610  12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.7553191, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.37802818, 'auroc': 0.9084791, 'binary_precision': 1.0, 'binary_recall': 0.041666668, 'binary_specificity': 1.0, 'binary_f1_score': 0.080000006}
confusion matrix:
     0  1
0  216  0
1  207  9
early stop counter: 3
val acc:0.521909236907959, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.7754629850387573 / 0.7777777910232544
after epoch: 9,now: 2024-07-29 03:56:12.721149,epoch time: 0:01:51.040831,used: 0:16:28.440958,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98311025, 'recall': 0.9827922, 'specificity': 0.9827922, 'f1': 0.9826555, 'auroc': 0.9991917, 'binary_precision': 1.0, 'binary_recall': 0.9655844, 'binary_specificity': 1.0, 'binary_f1_score': 0.9824909}
confusion matrix:
      0     1
0  1516     0
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.60172147, 'precision': 0.6695454, 'recall': 0.59283584, 'specificity': 0.59283584, 'f1': 0.54620624, 'auroc': 0.7775861, 'binary_precision': 0.7703349, 'binary_recall': 0.25884244, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.38748494}
confusion matrix:
     0    1
0  608   48
1  461  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6782407, 'precision': 0.7232663, 'recall': 0.6782408, 'specificity': 0.6782408, 'f1': 0.66115737, 'auroc': 0.8376415, 'binary_precision': 0.8235294, 'binary_recall': 0.4537037, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.58507466}
confusion matrix:
     0   1
0  195  21
1  118  98
early stop counter: 4
val acc:0.601721465587616, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.7754629850387573 / 0.7777777910232544
after epoch: 10,now: 2024-07-29 03:58:04.507833,epoch time: 0:01:51.786684,used: 0:18:20.227642,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98829687, 'recall': 0.988286, 'specificity': 0.988286, 'f1': 0.98821986, 'auroc': 0.9991802, 'binary_precision': 0.9966975, 'binary_recall': 0.97987014, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98821217}
confusion matrix:
      0     1
0  1511     5
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.7880194, 'recall': 0.6724424, 'specificity': 0.6724424, 'f1': 0.64168227, 'auroc': 0.9048555, 'binary_precision': 0.95726496, 'binary_recall': 0.3601286, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.5233645}
confusion matrix:
     0    1
0  646   10
1  398  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597222, 'precision': 0.78435147, 'recall': 0.6597222, 'specificity': 0.6597222, 'f1': 0.61784863, 'auroc': 0.88985336, 'binary_precision': 0.9726027, 'binary_recall': 0.3287037, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.49134946}
confusion matrix:
     0   1
0  214   2
1  145  71
early stop counter: 5
val acc:0.6807511448860168, best validation acc: 0.8356807231903076, corresponding to test acc:                         0.7754629850387573 / 0.7777777910232544
after epoch: 11,now: 2024-07-29 03:59:55.187617,epoch time: 0:01:50.679784,used: 0:20:10.907426,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_39_44_seed_2_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:20:10.907426 at 2024-07-29 03:59:55.187617
persisted model performance metric: 

scalar performance:
{'acc': 0.775463, 'precision': 0.82053876, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.7672815, 'auroc': 0.89889836, 'binary_precision': 0.94074076, 'binary_recall': 0.587963, 'binary_specificity': 0.962963, 'binary_f1_score': 0.72364676}
confusion matrix:
     0    1
0  208    8
1   89  127
oracle model performance metric: 

scalar performance:
{'acc': 0.7777778, 'precision': 0.83613443, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.76769507, 'auroc': 0.90309924, 'binary_precision': 0.97619045, 'binary_recall': 0.5694444, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.71929824}
confusion matrix:
     0    1
0  213    3
1   93  123
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 453982 KiB |   2003 MiB | 114850 GiB | 114850 GiB |
|       from large pool | 413389 KiB |   1971 MiB | 113375 GiB | 113374 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1475 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 453982 KiB |   2003 MiB | 114850 GiB | 114850 GiB |
|       from large pool | 413389 KiB |   1971 MiB | 113375 GiB | 113374 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1475 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 114744 GiB | 114743 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 113271 GiB | 113271 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1472 GiB |   1472 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2276 MiB |   5182 MiB |   2906 MiB |
|       from large pool |   2212 MiB |   2212 MiB |   5076 MiB |   2864 MiB |
|       from small pool |     64 MiB |     70 MiB |    106 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 375458 KiB | 489230 KiB |  88901 GiB |  88901 GiB |
|       from large pool | 368946 KiB | 476433 KiB |  87348 GiB |  87348 GiB |
|       from small pool |   6511 KiB |  18493 KiB |   1552 GiB |   1552 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   21960 K  |   21958 K  |
|       from large pool |     187    |     311    |   10543 K  |   10543 K  |
|       from small pool |    1111    |    1419    |   11416 K  |   11415 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   21960 K  |   21958 K  |
|       from large pool |     187    |     311    |   10543 K  |   10543 K  |
|       from small pool |    1111    |    1419    |   11416 K  |   11415 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     260    |     136    |
|       from large pool |      92    |      92    |     207    |     115    |
|       from small pool |      32    |      35    |      53    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |     261    |   11188 K  |   11188 K  |
|       from large pool |      39    |      92    |    6608 K  |    6608 K  |
|       from small pool |      37    |     223    |    4580 K  |    4579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 114850 GiB | 114850 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 113375 GiB | 113375 GiB |
|       from small pool |      0 KiB |     60 MiB |   1475 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 114850 GiB | 114850 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 113375 GiB | 113375 GiB |
|       from small pool |      0 KiB |     60 MiB |   1475 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 114744 GiB | 114744 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 113271 GiB | 113271 GiB |
|       from small pool |      0 KiB |     60 MiB |   1472 GiB |   1472 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    810 MiB |   2276 MiB |   5182 MiB |   4372 MiB |
|       from large pool |    764 MiB |   2212 MiB |   5076 MiB |   4312 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB |  88902 GiB |  88902 GiB |
|       from large pool |  24320 KiB | 476433 KiB |  87349 GiB |  87349 GiB |
|       from small pool |      0 KiB |  20228 KiB |   1552 GiB |   1552 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   21960 K  |   21960 K  |
|       from large pool |       2    |     311    |   10543 K  |   10543 K  |
|       from small pool |       0    |    1419    |   11416 K  |   11416 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   21960 K  |   21960 K  |
|       from large pool |       2    |     311    |   10543 K  |   10543 K  |
|       from small pool |       0    |    1419    |   11416 K  |   11416 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     260    |     203    |
|       from large pool |      34    |      92    |     207    |     173    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   11189 K  |   11189 K  |
|       from large pool |       4    |      92    |    6608 K  |    6608 K  |
|       from small pool |       0    |     223    |    4580 K  |    4580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 114850 GiB | 114850 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 113375 GiB | 113375 GiB |
|       from small pool |      0 KiB |     60 MiB |   1475 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 114850 GiB | 114850 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 113375 GiB | 113375 GiB |
|       from small pool |      0 KiB |     60 MiB |   1475 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 114744 GiB | 114744 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 113271 GiB | 113271 GiB |
|       from small pool |      0 KiB |     60 MiB |   1472 GiB |   1472 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    810 MiB |   2276 MiB |   5182 MiB |   4372 MiB |
|       from large pool |    764 MiB |   2212 MiB |   5076 MiB |   4312 MiB |
|       from small pool |     46 MiB |     70 MiB |    106 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB |  88902 GiB |  88902 GiB |
|       from large pool |  24320 KiB | 476433 KiB |  87349 GiB |  87349 GiB |
|       from small pool |      0 KiB |  20228 KiB |   1552 GiB |   1552 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   21960 K  |   21960 K  |
|       from large pool |       2    |     311    |   10543 K  |   10543 K  |
|       from small pool |       0    |    1419    |   11416 K  |   11416 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   21960 K  |   21960 K  |
|       from large pool |       2    |     311    |   10543 K  |   10543 K  |
|       from small pool |       0    |    1419    |   11416 K  |   11416 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     260    |     203    |
|       from large pool |      34    |      92    |     207    |     173    |
|       from small pool |      23    |      35    |      53    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   11189 K  |   11189 K  |
|       from large pool |       4    |      92    |    6608 K  |    6608 K  |
|       from small pool |       0    |     223    |    4580 K  |    4580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370

 Experiment start at: 2024-07-29 04:00:42.687252
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.96643305, 'recall': 0.9660059, 'specificity': 0.9660059, 'f1': 0.9661272, 'auroc': 0.9955347, 'binary_precision': 0.957782, 'binary_recall': 0.97623634, 'binary_specificity': 0.95577556, 'binary_f1_score': 0.9669211}
confusion matrix:
      0     1
0  1448    67
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.76929075, 'precision': 0.77977246, 'recall': 0.77111745, 'specificity': 0.77111745, 'f1': 0.76785207, 'auroc': 0.87498474, 'binary_precision': 0.7205298, 'binary_recall': 0.8648649, 'binary_specificity': 0.67737, 'binary_f1_score': 0.78612715}
confusion matrix:
     0    1
0  443  211
1   85  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7955142, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.752566, 'auroc': 0.9154568, 'binary_precision': 0.6930693, 'binary_recall': 0.93333334, 'binary_specificity': 0.58666664, 'binary_f1_score': 0.7954545}
confusion matrix:
     0    1
0  132   93
1   15  210
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:02:36.468033,epoch time: 0:01:53.780781,used: 0:01:53.780781,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97496724, 'recall': 0.97490096, 'specificity': 0.97490096, 'f1': 0.9749291, 'auroc': 0.9975518, 'binary_precision': 0.9731286, 'binary_recall': 0.9775064, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.97531265}
confusion matrix:
      0     1
0  1474    42
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.7848792, 'precision': 0.7868589, 'recall': 0.78564835, 'specificity': 0.78564835, 'f1': 0.78475356, 'auroc': 0.857769, 'binary_precision': 0.75766426, 'binary_recall': 0.82511926, 'binary_specificity': 0.7461774, 'binary_f1_score': 0.7899544}
confusion matrix:
     0    1
0  488  166
1  110  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.79054636, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7859521, 'auroc': 0.86615306, 'binary_precision': 0.75697213, 'binary_recall': 0.84444445, 'binary_specificity': 0.72888887, 'binary_f1_score': 0.79831934}
confusion matrix:
     0    1
0  164   61
1   35  190
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 04:04:26.421920,epoch time: 0:01:49.953887,used: 0:03:43.734668,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9791827, 'recall': 0.97914374, 'specificity': 0.97914374, 'f1': 0.97916156, 'auroc': 0.9971299, 'binary_precision': 0.97823304, 'binary_recall': 0.98074454, 'binary_specificity': 0.97754294, 'binary_f1_score': 0.9794872}
confusion matrix:
      0     1
0  1480    34
1    30  1528
---- Validation: 
scalar performance:
{'acc': 0.80358535, 'precision': 0.8049257, 'recall': 0.80420965, 'specificity': 0.80420965, 'f1': 0.80353266, 'auroc': 0.86776495, 'binary_precision': 0.77925926, 'binary_recall': 0.83624804, 'binary_specificity': 0.77217126, 'binary_f1_score': 0.8067484}
confusion matrix:
     0    1
0  505  149
1  103  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.7819074, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.76073915, 'auroc': 0.8856691, 'binary_precision': 0.7117438, 'binary_recall': 0.8888889, 'binary_specificity': 0.64, 'binary_f1_score': 0.7905139}
confusion matrix:
     0    1
0  144   81
1   25  200
better model found
persisted
after epoch: 3,now: 2024-07-29 04:06:16.081462,epoch time: 0:01:49.659542,used: 0:05:33.394210,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9686496, 'recall': 0.9667819, 'specificity': 0.9667819, 'f1': 0.96707296, 'auroc': 0.99770695, 'binary_precision': 0.94495416, 'binary_recall': 0.9929306, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.9683485}
confusion matrix:
      0     1
0  1426    90
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.80124706, 'precision': 0.8088852, 'recall': 0.7996675, 'specificity': 0.7996675, 'f1': 0.79937303, 'auroc': 0.85726094, 'binary_precision': 0.8528302, 'binary_recall': 0.7186009, 'binary_specificity': 0.88073397, 'binary_f1_score': 0.7799827}
confusion matrix:
     0    1
0  576   78
1  177  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8355821, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83555233, 'auroc': 0.8985284, 'binary_precision': 0.8325991, 'binary_recall': 0.84, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.83628315}
confusion matrix:
     0    1
0  187   38
1   36  189
new oracle model saved
early stop counter: 1
val acc:0.8012470602989197, best validation acc: 0.8035853505134583, corresponding to test acc:                         0.7644444704055786 / 0.8355555534362793
after epoch: 4,now: 2024-07-29 04:08:06.847540,epoch time: 0:01:50.766078,used: 0:07:24.160288,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97621775, 'recall': 0.9758796, 'specificity': 0.9758796, 'f1': 0.97558427, 'auroc': 0.99932975, 'binary_precision': 0.9973154, 'binary_recall': 0.95439947, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9753856}
confusion matrix:
      0     1
0  1511     4
1    71  1486
---- Validation: 
scalar performance:
{'acc': 0.5736555, 'precision': 0.740583, 'recall': 0.56536514, 'specificity': 0.56536514, 'f1': 0.47331575, 'auroc': 0.8349304, 'binary_precision': 0.9361702, 'binary_recall': 0.1399046, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.24343012}
confusion matrix:
     0   1
0  648   6
1  541  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.78125, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6255683, 'auroc': 0.89017284, 'binary_precision': 0.9625, 'binary_recall': 0.3422222, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.50491804}
confusion matrix:
     0   1
0  222   3
1  148  77
early stop counter: 2
val acc:0.5736554861068726, best validation acc: 0.8035853505134583, corresponding to test acc:                         0.7644444704055786 / 0.8355555534362793
after epoch: 5,now: 2024-07-29 04:09:45.157832,epoch time: 0:01:38.310292,used: 0:09:02.470580,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9838667, 'recall': 0.9838823, 'specificity': 0.9838823, 'f1': 0.9837239, 'auroc': 0.9985324, 'binary_precision': 0.99604744, 'binary_recall': 0.97172236, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9837345}
confusion matrix:
      0     1
0  1510     6
1    44  1512
---- Validation: 
scalar performance:
{'acc': 0.6874513, 'precision': 0.7640175, 'recall': 0.6820909, 'specificity': 0.6820909, 'f1': 0.6590997, 'auroc': 0.83774304, 'binary_precision': 0.90140843, 'binary_recall': 0.40699524, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.5607886}
confusion matrix:
     0    1
0  626   28
1  373  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.77020013, 'recall': 0.68, 'specificity': 0.68, 'f1': 0.65086204, 'auroc': 0.8806716, 'binary_precision': 0.9263158, 'binary_recall': 0.3911111, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.54999995}
confusion matrix:
     0   1
0  218   7
1  137  88
early stop counter: 3
val acc:0.6874513030052185, best validation acc: 0.8035853505134583, corresponding to test acc:                         0.7644444704055786 / 0.8355555534362793
after epoch: 6,now: 2024-07-29 04:11:28.424062,epoch time: 0:01:43.266230,used: 0:10:45.736810,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.977044, 'recall': 0.97652733, 'specificity': 0.97652733, 'f1': 0.9762339, 'auroc': 0.99891555, 'binary_precision': 1.0, 'binary_recall': 0.95305467, 'binary_specificity': 1.0, 'binary_f1_score': 0.9759631}
confusion matrix:
      0     1
0  1517     0
1    73  1482
---- Validation: 
scalar performance:
{'acc': 0.7544817, 'precision': 0.8098757, 'recall': 0.7503015, 'specificity': 0.7503015, 'f1': 0.7408751, 'auroc': 0.87435275, 'binary_precision': 0.9361111, 'binary_recall': 0.5357711, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.6814965}
confusion matrix:
     0    1
0  631   23
1  292  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.8362933, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.75115293, 'auroc': 0.919842, 'binary_precision': 0.9917355, 'binary_recall': 0.53333336, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.69364166}
confusion matrix:
     0    1
0  224    1
1  105  120
early stop counter: 4
val acc:0.7544816732406616, best validation acc: 0.8035853505134583, corresponding to test acc:                         0.7644444704055786 / 0.8355555534362793
after epoch: 7,now: 2024-07-29 04:13:12.117349,epoch time: 0:01:43.693287,used: 0:12:29.430097,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98574007, 'recall': 0.9858018, 'specificity': 0.9858018, 'f1': 0.98567694, 'auroc': 0.99948025, 'binary_precision': 0.9954128, 'binary_recall': 0.9762211, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.98572356}
confusion matrix:
      0     1
0  1509     7
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.7178488, 'precision': 0.7960989, 'recall': 0.71275824, 'specificity': 0.71275824, 'f1': 0.69474065, 'auroc': 0.8937297, 'binary_precision': 0.9435216, 'binary_recall': 0.45151034, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.6107527}
confusion matrix:
     0    1
0  637   17
1  345  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8214357, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.7807374, 'auroc': 0.9110913, 'binary_precision': 0.92715234, 'binary_recall': 0.62222224, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.7446809}
confusion matrix:
     0    1
0  214   11
1   85  140
early stop counter: 5
val acc:0.7178487777709961, best validation acc: 0.8035853505134583, corresponding to test acc:                         0.7644444704055786 / 0.8355555534362793
after epoch: 8,now: 2024-07-29 04:15:01.625380,epoch time: 0:01:49.508031,used: 0:14:18.938128,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_00_42_seed_3_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:14:18.938128 at 2024-07-29 04:15:01.625380
persisted model performance metric: 

scalar performance:
{'acc': 0.7644445, 'precision': 0.7819074, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.76073915, 'auroc': 0.8856691, 'binary_precision': 0.7117438, 'binary_recall': 0.8888889, 'binary_specificity': 0.64, 'binary_f1_score': 0.7905139}
confusion matrix:
     0    1
0  144   81
1   25  200
oracle model performance metric: 

scalar performance:
{'acc': 0.83555555, 'precision': 0.8355821, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83555233, 'auroc': 0.8985284, 'binary_precision': 0.8325991, 'binary_recall': 0.84, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.83628315}
confusion matrix:
     0    1
0  187   38
1   36  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455385 KiB |   2003 MiB | 132325 GiB | 132324 GiB |
|       from large pool | 414787 KiB |   1971 MiB | 130623 GiB | 130622 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1702 GiB |   1701 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455385 KiB |   2003 MiB | 132325 GiB | 132324 GiB |
|       from large pool | 414787 KiB |   1971 MiB | 130623 GiB | 130622 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1702 GiB |   1701 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 132208 GiB | 132208 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 130510 GiB | 130509 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1698 GiB |   1698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2282 MiB |   6654 MiB |   4372 MiB |
|       from large pool |   2212 MiB |   2212 MiB |   6524 MiB |   4312 MiB |
|       from small pool |     70 MiB |     70 MiB |    130 MiB |     60 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 380198 KiB | 489230 KiB | 102627 GiB | 102627 GiB |
|       from large pool | 373693 KiB | 476433 KiB | 100836 GiB | 100835 GiB |
|       from small pool |   6505 KiB |  20228 KiB |   1791 GiB |   1791 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   25313 K  |   25311 K  |
|       from large pool |     187    |     311    |   12150 K  |   12150 K  |
|       from small pool |    1123    |    1419    |   13162 K  |   13161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   25313 K  |   25311 K  |
|       from large pool |     187    |     311    |   12150 K  |   12150 K  |
|       from small pool |    1123    |    1419    |   13162 K  |   13161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     330    |     203    |
|       from large pool |      92    |      92    |     265    |     173    |
|       from small pool |      35    |      35    |      65    |      30    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     261    |   13142 K  |   13142 K  |
|       from large pool |      33    |      93    |    7867 K  |    7867 K  |
|       from small pool |      39    |     223    |    5275 K  |    5275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 132325 GiB | 132325 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 130623 GiB | 130623 GiB |
|       from small pool |      0 KiB |     60 MiB |   1702 GiB |   1702 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 132325 GiB | 132325 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 130623 GiB | 130623 GiB |
|       from small pool |      0 KiB |     60 MiB |   1702 GiB |   1702 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 132208 GiB | 132208 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 130510 GiB | 130510 GiB |
|       from small pool |      0 KiB |     60 MiB |   1698 GiB |   1698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    816 MiB |   2282 MiB |   6654 MiB |   5838 MiB |
|       from large pool |    770 MiB |   2212 MiB |   6524 MiB |   5754 MiB |
|       from small pool |     46 MiB |     70 MiB |    130 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 102627 GiB | 102627 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 100836 GiB | 100836 GiB |
|       from small pool |      0 KiB |  20228 KiB |   1791 GiB |   1791 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   25313 K  |   25313 K  |
|       from large pool |       2    |     311    |   12150 K  |   12150 K  |
|       from small pool |       0    |    1419    |   13162 K  |   13162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   25313 K  |   25313 K  |
|       from large pool |       2    |     311    |   12150 K  |   12150 K  |
|       from small pool |       0    |    1419    |   13162 K  |   13162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     330    |     273    |
|       from large pool |      34    |      92    |     265    |     231    |
|       from small pool |      23    |      35    |      65    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   13142 K  |   13142 K  |
|       from large pool |       4    |      93    |    7867 K  |    7867 K  |
|       from small pool |       0    |     223    |    5275 K  |    5275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 132325 GiB | 132325 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 130623 GiB | 130623 GiB |
|       from small pool |      0 KiB |     60 MiB |   1702 GiB |   1702 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 132325 GiB | 132325 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 130623 GiB | 130623 GiB |
|       from small pool |      0 KiB |     60 MiB |   1702 GiB |   1702 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 132208 GiB | 132208 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 130510 GiB | 130510 GiB |
|       from small pool |      0 KiB |     60 MiB |   1698 GiB |   1698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    816 MiB |   2282 MiB |   6654 MiB |   5838 MiB |
|       from large pool |    770 MiB |   2212 MiB |   6524 MiB |   5754 MiB |
|       from small pool |     46 MiB |     70 MiB |    130 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 102627 GiB | 102627 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 100836 GiB | 100836 GiB |
|       from small pool |      0 KiB |  20228 KiB |   1791 GiB |   1791 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   25313 K  |   25313 K  |
|       from large pool |       2    |     311    |   12150 K  |   12150 K  |
|       from small pool |       0    |    1419    |   13162 K  |   13162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   25313 K  |   25313 K  |
|       from large pool |       2    |     311    |   12150 K  |   12150 K  |
|       from small pool |       0    |    1419    |   13162 K  |   13162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     330    |     273    |
|       from large pool |      34    |      92    |     265    |     231    |
|       from small pool |      23    |      35    |      65    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   13142 K  |   13142 K  |
|       from large pool |       4    |      93    |    7867 K  |    7867 K  |
|       from small pool |       0    |     223    |    5275 K  |    5275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370

 Experiment start at: 2024-07-29 04:15:46.208115
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9702073, 'precision': 0.97071207, 'recall': 0.9705351, 'specificity': 0.9705351, 'f1': 0.9702066, 'auroc': 0.996118, 'binary_precision': 0.9906977, 'binary_recall': 0.9502868, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.9700716}
confusion matrix:
      0     1
0  1505    14
1    78  1491
---- Validation: 
scalar performance:
{'acc': 0.77907884, 'precision': 0.7792113, 'recall': 0.77888453, 'specificity': 0.77888453, 'f1': 0.7789409, 'auroc': 0.86480176, 'binary_precision': 0.7828201, 'binary_recall': 0.7642405, 'binary_specificity': 0.7935285, 'binary_f1_score': 0.7734188}
confusion matrix:
     0    1
0  515  134
1  149  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8578199, 'precision': 0.85794854, 'recall': 0.8578199, 'specificity': 0.8578199, 'f1': 0.85780716, 'auroc': 0.9101323, 'binary_precision': 0.8647343, 'binary_recall': 0.8483412, 'binary_specificity': 0.8672986, 'binary_f1_score': 0.8564593}
confusion matrix:
     0    1
0  183   28
1   32  179
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:17:39.531251,epoch time: 0:01:53.323136,used: 0:01:53.323136,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97506475, 'precision': 0.9751748, 'recall': 0.97529745, 'specificity': 0.97529745, 'f1': 0.97506416, 'auroc': 0.9962239, 'binary_precision': 0.988243, 'binary_recall': 0.9624682, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9751853}
confusion matrix:
      0     1
0  1498    18
1    59  1513
---- Validation: 
scalar performance:
{'acc': 0.8149883, 'precision': 0.8274275, 'recall': 0.81368124, 'specificity': 0.81368124, 'f1': 0.81275177, 'auroc': 0.891247, 'binary_precision': 0.8880157, 'binary_recall': 0.7151899, 'binary_specificity': 0.91217256, 'binary_f1_score': 0.79228747}
confusion matrix:
     0    1
0  592   57
1  180  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8838863, 'precision': 0.88702446, 'recall': 0.8838862, 'specificity': 0.8838862, 'f1': 0.8836504, 'auroc': 0.9363446, 'binary_precision': 0.921875, 'binary_recall': 0.83886254, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.8784119}
confusion matrix:
     0    1
0  196   15
1   34  177
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 04:19:17.297885,epoch time: 0:01:37.766634,used: 0:03:31.089770,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97700775, 'precision': 0.9770057, 'recall': 0.9769943, 'specificity': 0.9769943, 'f1': 0.9769999, 'auroc': 0.9977597, 'binary_precision': 0.9771138, 'binary_recall': 0.97773534, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.97742444}
confusion matrix:
      0     1
0  1480    36
1    35  1537
---- Validation: 
scalar performance:
{'acc': 0.82591724, 'precision': 0.82750106, 'recall': 0.82544106, 'specificity': 0.82544106, 'f1': 0.82553446, 'auroc': 0.8953575, 'binary_precision': 0.84719867, 'binary_recall': 0.789557, 'binary_specificity': 0.86132514, 'binary_f1_score': 0.81736284}
confusion matrix:
     0    1
0  559   90
1  133  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175355, 'precision': 0.8287674, 'recall': 0.8175355, 'specificity': 0.8175355, 'f1': 0.81596375, 'auroc': 0.9078412, 'binary_precision': 0.8895349, 'binary_recall': 0.72511846, 'binary_specificity': 0.9099526, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  192   19
1   58  153
better model found
persisted
after epoch: 3,now: 2024-07-29 04:21:01.945325,epoch time: 0:01:44.647440,used: 0:05:15.737210,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9808938, 'precision': 0.9809067, 'recall': 0.98107564, 'specificity': 0.98107564, 'f1': 0.98089236, 'auroc': 0.99791825, 'binary_precision': 0.9909209, 'binary_recall': 0.9713923, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.98105943}
confusion matrix:
      0     1
0  1501    14
1    45  1528
---- Validation: 
scalar performance:
{'acc': 0.78142077, 'precision': 0.78332186, 'recall': 0.7808435, 'specificity': 0.7808435, 'f1': 0.7807847, 'auroc': 0.87399065, 'binary_precision': 0.80344826, 'binary_recall': 0.73734176, 'binary_specificity': 0.8243452, 'binary_f1_score': 0.7689768}
confusion matrix:
     0    1
0  535  114
1  166  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8436019, 'precision': 0.8481056, 'recall': 0.84360194, 'specificity': 0.84360194, 'f1': 0.8430944, 'auroc': 0.9077065, 'binary_precision': 0.88770056, 'binary_recall': 0.7867299, 'binary_specificity': 0.90047395, 'binary_f1_score': 0.8341709}
confusion matrix:
     0    1
0  190   21
1   45  166
early stop counter: 1
val acc:0.7814207673072815, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8175355195999146 / 0.8838862776756287
after epoch: 4,now: 2024-07-29 04:22:51.286048,epoch time: 0:01:49.340723,used: 0:07:05.077933,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98445594, 'precision': 0.98440576, 'recall': 0.98456675, 'specificity': 0.98456675, 'f1': 0.9844528, 'auroc': 0.99834955, 'binary_precision': 0.9903661, 'binary_recall': 0.9790476, 'binary_specificity': 0.9900859, 'binary_f1_score': 0.98467433}
confusion matrix:
      0     1
0  1498    15
1    33  1542
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.80198884, 'recall': 0.77560294, 'specificity': 0.77560294, 'f1': 0.77207214, 'auroc': 0.8759923, 'binary_precision': 0.88470066, 'binary_recall': 0.6313291, 'binary_specificity': 0.91987675, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  597   52
1  233  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8720379, 'precision': 0.8754108, 'recall': 0.8720379, 'specificity': 0.8720379, 'f1': 0.8717499, 'auroc': 0.9226433, 'binary_precision': 0.91099477, 'binary_recall': 0.82464457, 'binary_specificity': 0.91943127, 'binary_f1_score': 0.86567163}
confusion matrix:
     0    1
0  194   17
1   37  174
early stop counter: 2
val acc:0.777517557144165, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8175355195999146 / 0.8838862776756287
after epoch: 5,now: 2024-07-29 04:24:34.852606,epoch time: 0:01:43.566558,used: 0:08:48.644491,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9857513, 'precision': 0.9857222, 'recall': 0.98578095, 'specificity': 0.98578095, 'f1': 0.9857478, 'auroc': 0.9984999, 'binary_precision': 0.9878594, 'binary_recall': 0.9840866, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.98596936}
confusion matrix:
      0     1
0  1498    19
1    25  1546
---- Validation: 
scalar performance:
{'acc': 0.7978142, 'precision': 0.79870087, 'recall': 0.798162, 'specificity': 0.798162, 'f1': 0.7977649, 'auroc': 0.8680126, 'binary_precision': 0.77877426, 'binary_recall': 0.8243671, 'binary_specificity': 0.77195686, 'binary_f1_score': 0.8009224}
confusion matrix:
     0    1
0  501  148
1  111  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.8301254, 'recall': 0.82938385, 'specificity': 0.82938385, 'f1': 0.829288, 'auroc': 0.8698143, 'binary_precision': 0.81447965, 'binary_recall': 0.8530806, 'binary_specificity': 0.8056872, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  170   41
1   31  180
early stop counter: 3
val acc:0.7978141903877258, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8175355195999146 / 0.8838862776756287
after epoch: 6,now: 2024-07-29 04:26:20.801000,epoch time: 0:01:45.948394,used: 0:10:34.592885,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9828368, 'precision': 0.9828078, 'recall': 0.9829215, 'specificity': 0.9829215, 'f1': 0.9828348, 'auroc': 0.9972912, 'binary_precision': 0.98840207, 'binary_recall': 0.9776928, 'binary_specificity': 0.9881501, 'binary_f1_score': 0.9830183}
confusion matrix:
      0     1
0  1501    18
1    35  1534
---- Validation: 
scalar performance:
{'acc': 0.77517563, 'precision': 0.77876955, 'recall': 0.7759028, 'specificity': 0.7759028, 'f1': 0.7747296, 'auroc': 0.8467481, 'binary_precision': 0.74362606, 'binary_recall': 0.8306962, 'binary_specificity': 0.7211094, 'binary_f1_score': 0.7847534}
confusion matrix:
     0    1
0  468  181
1  107  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79620856, 'precision': 0.8007754, 'recall': 0.7962085, 'specificity': 0.7962085, 'f1': 0.79543203, 'auroc': 0.8463197, 'binary_precision': 0.76371306, 'binary_recall': 0.8578199, 'binary_specificity': 0.73459715, 'binary_f1_score': 0.8080358}
confusion matrix:
     0    1
0  155   56
1   30  181
early stop counter: 4
val acc:0.7751756310462952, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8175355195999146 / 0.8838862776756287
after epoch: 7,now: 2024-07-29 04:28:10.064977,epoch time: 0:01:49.263977,used: 0:12:23.856862,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97959846, 'precision': 0.9796045, 'recall': 0.9797621, 'specificity': 0.9797621, 'f1': 0.9795969, 'auroc': 0.9978353, 'binary_precision': 0.9889825, 'binary_recall': 0.97073793, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9797753}
confusion matrix:
      0     1
0  1499    17
1    46  1526
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.7712797, 'recall': 0.71200097, 'specificity': 0.71200097, 'f1': 0.6975837, 'auroc': 0.87438315, 'binary_precision': 0.8914956, 'binary_recall': 0.48101267, 'binary_specificity': 0.94298923, 'binary_f1_score': 0.6248715}
confusion matrix:
     0    1
0  612   37
1  328  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6540284, 'precision': 0.7815412, 'recall': 0.6540284, 'specificity': 0.6540284, 'f1': 0.6098531, 'auroc': 0.9285506, 'binary_precision': 0.9710145, 'binary_recall': 0.31753555, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.47857141}
confusion matrix:
     0   1
0  209   2
1  144  67
early stop counter: 5
val acc:0.7150663733482361, best validation acc: 0.8259172439575195, corresponding to test acc:                         0.8175355195999146 / 0.8838862776756287
after epoch: 8,now: 2024-07-29 04:30:00.352377,epoch time: 0:01:50.287400,used: 0:14:14.144262,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_15_46_seed_4_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:14:14.144262 at 2024-07-29 04:30:00.352377
persisted model performance metric: 

scalar performance:
{'acc': 0.8175355, 'precision': 0.8287674, 'recall': 0.8175355, 'specificity': 0.8175355, 'f1': 0.81596375, 'auroc': 0.9078412, 'binary_precision': 0.8895349, 'binary_recall': 0.72511846, 'binary_specificity': 0.9099526, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  192   19
1   58  153
oracle model performance metric: 

scalar performance:
{'acc': 0.8838863, 'precision': 0.88702446, 'recall': 0.8838862, 'specificity': 0.8838862, 'f1': 0.8836504, 'auroc': 0.9363446, 'binary_precision': 0.921875, 'binary_recall': 0.83886254, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.8784119}
confusion matrix:
     0    1
0  196   15
1   34  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454059 KiB |   2003 MiB | 149827 GiB | 149826 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 147899 GiB | 147899 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1927 GiB |   1927 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454059 KiB |   2003 MiB | 149827 GiB | 149826 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 147899 GiB | 147899 GiB |
|       from small pool |  40592 KiB |     60 MiB |   1927 GiB |   1927 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB | 149702 GiB | 149702 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 147779 GiB | 147778 GiB |
|       from small pool |  40405 KiB |     60 MiB |   1923 GiB |   1923 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2282 MiB |   8114 MiB |   5838 MiB |
|       from large pool |   2212 MiB |   2212 MiB |   7966 MiB |   5754 MiB |
|       from small pool |     64 MiB |     70 MiB |    148 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 389716 KiB | 489230 KiB | 116349 GiB | 116349 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 114321 GiB | 114321 GiB |
|       from small pool |   8559 KiB |  20228 KiB |   2028 GiB |   2028 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   28666 K  |   28665 K  |
|       from large pool |     187    |     311    |   13759 K  |   13759 K  |
|       from small pool |    1111    |    1419    |   14907 K  |   14905 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   28666 K  |   28665 K  |
|       from large pool |     187    |     311    |   13759 K  |   13759 K  |
|       from small pool |    1111    |    1419    |   14907 K  |   14905 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     397    |     273    |
|       from large pool |      92    |      92    |     323    |     231    |
|       from small pool |      32    |      35    |      74    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |     261    |   15008 K  |   15008 K  |
|       from large pool |      35    |      94    |    9047 K  |    9047 K  |
|       from small pool |      42    |     223    |    5960 K  |    5960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 149827 GiB | 149827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 147899 GiB | 147899 GiB |
|       from small pool |      0 KiB |     60 MiB |   1927 GiB |   1927 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 149827 GiB | 149827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 147899 GiB | 147899 GiB |
|       from small pool |      0 KiB |     60 MiB |   1927 GiB |   1927 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 149702 GiB | 149702 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 147779 GiB | 147779 GiB |
|       from small pool |      0 KiB |     60 MiB |   1923 GiB |   1923 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2282 MiB |   8114 MiB |   7290 MiB |
|       from large pool |    776 MiB |   2212 MiB |   7966 MiB |   7190 MiB |
|       from small pool |     48 MiB |     70 MiB |    148 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 116350 GiB | 116350 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 114321 GiB | 114321 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2028 GiB |   2028 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   28666 K  |   28666 K  |
|       from large pool |       2    |     311    |   13759 K  |   13759 K  |
|       from small pool |       0    |    1419    |   14907 K  |   14907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   28666 K  |   28666 K  |
|       from large pool |       2    |     311    |   13759 K  |   13759 K  |
|       from small pool |       0    |    1419    |   14907 K  |   14907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     397    |     339    |
|       from large pool |      34    |      92    |     323    |     289    |
|       from small pool |      24    |      35    |      74    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   15008 K  |   15008 K  |
|       from large pool |       4    |      94    |    9047 K  |    9047 K  |
|       from small pool |       0    |     223    |    5960 K  |    5960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 149827 GiB | 149827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 147899 GiB | 147899 GiB |
|       from small pool |      0 KiB |     60 MiB |   1927 GiB |   1927 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 149827 GiB | 149827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 147899 GiB | 147899 GiB |
|       from small pool |      0 KiB |     60 MiB |   1927 GiB |   1927 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 149702 GiB | 149702 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 147779 GiB | 147779 GiB |
|       from small pool |      0 KiB |     60 MiB |   1923 GiB |   1923 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2282 MiB |   8114 MiB |   7290 MiB |
|       from large pool |    776 MiB |   2212 MiB |   7966 MiB |   7190 MiB |
|       from small pool |     48 MiB |     70 MiB |    148 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 116350 GiB | 116350 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 114321 GiB | 114321 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2028 GiB |   2028 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   28666 K  |   28666 K  |
|       from large pool |       2    |     311    |   13759 K  |   13759 K  |
|       from small pool |       0    |    1419    |   14907 K  |   14907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   28666 K  |   28666 K  |
|       from large pool |       2    |     311    |   13759 K  |   13759 K  |
|       from small pool |       0    |    1419    |   14907 K  |   14907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     397    |     339    |
|       from large pool |      34    |      92    |     323    |     289    |
|       from small pool |      24    |      35    |      74    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   15008 K  |   15008 K  |
|       from large pool |       4    |      94    |    9047 K  |    9047 K  |
|       from small pool |       0    |     223    |    5960 K  |    5960 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370

 Experiment start at: 2024-07-29 04:30:52.030906
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.96973836, 'recall': 0.96978164, 'specificity': 0.96978164, 'f1': 0.9695679, 'auroc': 0.9947113, 'binary_precision': 0.9834327, 'binary_recall': 0.9561856, 'binary_specificity': 0.98337764, 'binary_f1_score': 0.9696177}
confusion matrix:
      0     1
0  1479    25
1    68  1484
---- Validation: 
scalar performance:
{'acc': 0.7667185, 'precision': 0.76881963, 'recall': 0.765272, 'specificity': 0.765272, 'f1': 0.76546544, 'auroc': 0.8044708, 'binary_precision': 0.7865961, 'binary_recall': 0.7136, 'binary_specificity': 0.816944, 'binary_f1_score': 0.7483222}
confusion matrix:
     0    1
0  540  121
1  179  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75757575, 'precision': 0.78201365, 'recall': 0.75757575, 'specificity': 0.75757575, 'f1': 0.75220764, 'auroc': 0.82043064, 'binary_precision': 0.86503065, 'binary_recall': 0.6103896, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.71573603}
confusion matrix:
     0    1
0  209   22
1   90  141
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:32:45.442945,epoch time: 0:01:53.412039,used: 0:01:53.412039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.9783536, 'recall': 0.9783431, 'specificity': 0.9783431, 'f1': 0.97807586, 'auroc': 0.99670243, 'binary_precision': 0.9946738, 'binary_recall': 0.962009, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.97806877}
confusion matrix:
      0     1
0  1495     8
1    59  1494
---- Validation: 
scalar performance:
{'acc': 0.82426125, 'precision': 0.82418674, 'recall': 0.82442844, 'specificity': 0.82442844, 'f1': 0.8242098, 'auroc': 0.8962039, 'binary_precision': 0.81220657, 'binary_recall': 0.8304, 'binary_specificity': 0.8184569, 'binary_f1_score': 0.8212025}
confusion matrix:
     0    1
0  541  120
1  106  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85281384, 'precision': 0.8534763, 'recall': 0.85281384, 'specificity': 0.85281384, 'f1': 0.8527448, 'auroc': 0.9298364, 'binary_precision': 0.8687783, 'binary_recall': 0.83116883, 'binary_specificity': 0.87445885, 'binary_f1_score': 0.8495575}
confusion matrix:
     0    1
0  202   29
1   39  192
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 04:34:35.012896,epoch time: 0:01:49.569951,used: 0:03:42.981990,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9809935, 'recall': 0.98111224, 'specificity': 0.98111224, 'f1': 0.98101884, 'auroc': 0.9981805, 'binary_precision': 0.98697066, 'binary_recall': 0.9755312, 'binary_specificity': 0.98669326, 'binary_f1_score': 0.9812176}
confusion matrix:
      0     1
0  1483    20
1    38  1515
---- Validation: 
scalar performance:
{'acc': 0.8258165, 'precision': 0.8441342, 'recall': 0.8225428, 'specificity': 0.8225428, 'f1': 0.82233584, 'auroc': 0.90701365, 'binary_precision': 0.9168399, 'binary_recall': 0.7056, 'binary_specificity': 0.9394856, 'binary_f1_score': 0.79746836}
confusion matrix:
     0    1
0  621   40
1  184  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.84298074, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.79198766, 'auroc': 0.9184611, 'binary_precision': 0.9662162, 'binary_recall': 0.61904764, 'binary_specificity': 0.978355, 'binary_f1_score': 0.75461745}
confusion matrix:
     0    1
0  226    5
1   88  143
better model found
persisted
after epoch: 3,now: 2024-07-29 04:36:11.164207,epoch time: 0:01:36.151311,used: 0:05:19.133301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98461056, 'recall': 0.9847394, 'specificity': 0.9847394, 'f1': 0.9846192, 'auroc': 0.9981891, 'binary_precision': 0.99215686, 'binary_recall': 0.97746295, 'binary_specificity': 0.99201596, 'binary_f1_score': 0.98475516}
confusion matrix:
      0     1
0  1491    12
1    35  1518
---- Validation: 
scalar performance:
{'acc': 0.82270604, 'precision': 0.82255745, 'recall': 0.8226106, 'specificity': 0.8226106, 'f1': 0.822582, 'auroc': 0.89030194, 'binary_precision': 0.8165869, 'binary_recall': 0.8192, 'binary_specificity': 0.8260212, 'binary_f1_score': 0.81789136}
confusion matrix:
     0    1
0  546  115
1  113  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.8579365, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.85467803, 'auroc': 0.9135324, 'binary_precision': 0.89047617, 'binary_recall': 0.8095238, 'binary_specificity': 0.9004329, 'binary_f1_score': 0.8480725}
confusion matrix:
     0    1
0  208   23
1   44  187
new oracle model saved
early stop counter: 1
val acc:0.8227060437202454, best validation acc: 0.8258165121078491, corresponding to test acc:                         0.798701286315918 / 0.8549783825874329
after epoch: 4,now: 2024-07-29 04:38:00.510384,epoch time: 0:01:49.346177,used: 0:07:08.479478,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.98605967, 'recall': 0.9861536, 'specificity': 0.9861536, 'f1': 0.98592913, 'auroc': 0.9987923, 'binary_precision': 0.99933904, 'binary_recall': 0.972973, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.98597986}
confusion matrix:
      0     1
0  1501     1
1    42  1512
---- Validation: 
scalar performance:
{'acc': 0.80715394, 'precision': 0.83139074, 'recall': 0.80329925, 'specificity': 0.80329925, 'f1': 0.80207527, 'auroc': 0.9016932, 'binary_precision': 0.9142857, 'binary_recall': 0.6656, 'binary_specificity': 0.9409985, 'binary_f1_score': 0.77037036}
confusion matrix:
     0    1
0  622   39
1  209  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.83389896, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.79325277, 'auroc': 0.8988962, 'binary_precision': 0.9423077, 'binary_recall': 0.6363636, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.75968987}
confusion matrix:
     0    1
0  222    9
1   84  147
early stop counter: 2
val acc:0.8071539402008057, best validation acc: 0.8258165121078491, corresponding to test acc:                         0.798701286315918 / 0.8549783825874329
after epoch: 5,now: 2024-07-29 04:39:46.562926,epoch time: 0:01:46.052542,used: 0:08:54.532020,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.98632157, 'recall': 0.98643494, 'specificity': 0.98643494, 'f1': 0.9862561, 'auroc': 0.9989743, 'binary_precision': 0.99736667, 'binary_recall': 0.9755312, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.9863281}
confusion matrix:
      0     1
0  1499     4
1    38  1515
---- Validation: 
scalar performance:
{'acc': 0.7962675, 'precision': 0.820079, 'recall': 0.79236066, 'specificity': 0.79236066, 'f1': 0.79079455, 'auroc': 0.8825828, 'binary_precision': 0.90066224, 'binary_recall': 0.6528, 'binary_specificity': 0.9319213, 'binary_f1_score': 0.7569573}
confusion matrix:
     0    1
0  616   45
1  217  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75757575, 'precision': 0.7907227, 'recall': 0.75757575, 'specificity': 0.75757575, 'f1': 0.750463, 'auroc': 0.88208616, 'binary_precision': 0.8888889, 'binary_recall': 0.5887446, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.7083334}
confusion matrix:
     0    1
0  214   17
1   95  136
early stop counter: 3
val acc:0.7962675094604492, best validation acc: 0.8258165121078491, corresponding to test acc:                         0.798701286315918 / 0.8549783825874329
after epoch: 6,now: 2024-07-29 04:41:26.872405,epoch time: 0:01:40.309479,used: 0:10:34.841499,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97743165, 'recall': 0.9771557, 'specificity': 0.9771557, 'f1': 0.9767661, 'auroc': 0.99903905, 'binary_precision': 1.0, 'binary_recall': 0.95431143, 'binary_specificity': 1.0, 'binary_f1_score': 0.9766217}
confusion matrix:
      0     1
0  1502     0
1    71  1483
---- Validation: 
scalar performance:
{'acc': 0.5528771, 'precision': 0.69132113, 'recall': 0.5404793, 'specificity': 0.5404793, 'f1': 0.4341846, 'auroc': 0.85633165, 'binary_precision': 0.8472222, 'binary_recall': 0.0976, 'binary_specificity': 0.98335856, 'binary_f1_score': 0.17503586}
confusion matrix:
     0   1
0  650  11
1  564  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.512987, 'precision': 0.75328946, 'recall': 0.512987, 'specificity': 0.512987, 'f1': 0.36156097, 'auroc': 0.84421206, 'binary_precision': 1.0, 'binary_recall': 0.025974026, 'binary_specificity': 1.0, 'binary_f1_score': 0.050632913}
confusion matrix:
     0  1
0  231  0
1  225  6
early stop counter: 4
val acc:0.5528771281242371, best validation acc: 0.8258165121078491, corresponding to test acc:                         0.798701286315918 / 0.8549783825874329
after epoch: 7,now: 2024-07-29 04:43:15.097851,epoch time: 0:01:48.225446,used: 0:12:23.066945,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9610602, 'precision': 0.9641471, 'recall': 0.96039444, 'specificity': 0.96039444, 'f1': 0.9609436, 'auroc': 0.99953127, 'binary_precision': 0.9304556, 'binary_recall': 0.9980707, 'binary_specificity': 0.92271817, 'binary_f1_score': 0.96307784}
confusion matrix:
      0     1
0  1385   116
1     3  1552
---- Validation: 
scalar performance:
{'acc': 0.80715394, 'precision': 0.81365156, 'recall': 0.805042, 'specificity': 0.805042, 'f1': 0.80528474, 'auroc': 0.86860156, 'binary_precision': 0.85233647, 'binary_recall': 0.7296, 'binary_specificity': 0.8804841, 'binary_f1_score': 0.7862069}
confusion matrix:
     0    1
0  582   79
1  169  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7900433, 'precision': 0.7909648, 'recall': 0.7900433, 'specificity': 0.7900433, 'f1': 0.78987694, 'auroc': 0.8580986, 'binary_precision': 0.80733943, 'binary_recall': 0.7619048, 'binary_specificity': 0.8181818, 'binary_f1_score': 0.7839644}
confusion matrix:
     0    1
0  189   42
1   55  176
early stop counter: 5
val acc:0.8071539402008057, best validation acc: 0.8258165121078491, corresponding to test acc:                         0.798701286315918 / 0.8549783825874329
after epoch: 8,now: 2024-07-29 04:45:08.338133,epoch time: 0:01:53.240282,used: 0:14:16.307227,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_30_51_seed_5_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:14:16.307227 at 2024-07-29 04:45:08.338133
persisted model performance metric: 

scalar performance:
{'acc': 0.7987013, 'precision': 0.84298074, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.79198766, 'auroc': 0.9184611, 'binary_precision': 0.9662162, 'binary_recall': 0.61904764, 'binary_specificity': 0.978355, 'binary_f1_score': 0.75461745}
confusion matrix:
     0    1
0  226    5
1   88  143
oracle model performance metric: 

scalar performance:
{'acc': 0.8549784, 'precision': 0.8579365, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.85467803, 'auroc': 0.9135324, 'binary_precision': 0.89047617, 'binary_recall': 0.8095238, 'binary_specificity': 0.9004329, 'binary_f1_score': 0.8480725}
confusion matrix:
     0    1
0  208   23
1   44  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454797 KiB |   2003 MiB | 167243 GiB | 167243 GiB |
|       from large pool | 414198 KiB |   1971 MiB | 165091 GiB | 165091 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2151 GiB |   2151 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454797 KiB |   2003 MiB | 167243 GiB | 167243 GiB |
|       from large pool | 414198 KiB |   1971 MiB | 165091 GiB | 165091 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2151 GiB |   2151 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 167110 GiB | 167110 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 164963 GiB | 164963 GiB |
|       from small pool |  40407 KiB |     60 MiB |   2147 GiB |   2147 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2290 MiB |   2290 MiB |   9580 MiB |   7290 MiB |
|       from large pool |   2226 MiB |   2226 MiB |   9416 MiB |   7190 MiB |
|       from small pool |     64 MiB |     70 MiB |    164 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 327539 KiB | 489230 KiB | 129755 GiB | 129755 GiB |
|       from large pool | 321033 KiB | 476433 KiB | 127491 GiB | 127491 GiB |
|       from small pool |   6505 KiB |  22276 KiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   32005 K  |   32003 K  |
|       from large pool |     187    |     311    |   15360 K  |   15360 K  |
|       from small pool |    1123    |    1419    |   16644 K  |   16643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   32005 K  |   32003 K  |
|       from large pool |     187    |     311    |   15360 K  |   15360 K  |
|       from small pool |    1123    |    1419    |   16644 K  |   16643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     127    |     464    |     339    |
|       from large pool |      93    |      93    |     382    |     289    |
|       from small pool |      32    |      35    |      82    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     261    |   16797 K  |   16797 K  |
|       from large pool |      34    |      96    |   10165 K  |   10165 K  |
|       from small pool |      39    |     223    |    6632 K  |    6632 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 167243 GiB | 167243 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 165091 GiB | 165091 GiB |
|       from small pool |      0 KiB |     60 MiB |   2151 GiB |   2151 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 167243 GiB | 167243 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 165091 GiB | 165091 GiB |
|       from small pool |      0 KiB |     60 MiB |   2151 GiB |   2151 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 167110 GiB | 167110 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 164963 GiB | 164963 GiB |
|       from small pool |      0 KiB |     60 MiB |   2147 GiB |   2147 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 782336 KiB |   2290 MiB |   9580 MiB |   8816 MiB |
|       from large pool | 735232 KiB |   2226 MiB |   9416 MiB |   8698 MiB |
|       from small pool |  47104 KiB |     70 MiB |    164 MiB |    118 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 129756 GiB | 129756 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 127491 GiB | 127491 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   32005 K  |   32005 K  |
|       from large pool |       2    |     311    |   15360 K  |   15360 K  |
|       from small pool |       0    |    1419    |   16644 K  |   16644 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   32005 K  |   32005 K  |
|       from large pool |       2    |     311    |   15360 K  |   15360 K  |
|       from small pool |       0    |    1419    |   16644 K  |   16644 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     127    |     464    |     409    |
|       from large pool |      32    |      93    |     382    |     350    |
|       from small pool |      23    |      35    |      82    |      59    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   16797 K  |   16797 K  |
|       from large pool |       4    |      96    |   10165 K  |   10165 K  |
|       from small pool |       0    |     223    |    6632 K  |    6632 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 167243 GiB | 167243 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 165091 GiB | 165091 GiB |
|       from small pool |      0 KiB |     60 MiB |   2151 GiB |   2151 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 167243 GiB | 167243 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 165091 GiB | 165091 GiB |
|       from small pool |      0 KiB |     60 MiB |   2151 GiB |   2151 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 167110 GiB | 167110 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 164963 GiB | 164963 GiB |
|       from small pool |      0 KiB |     60 MiB |   2147 GiB |   2147 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 782336 KiB |   2290 MiB |   9580 MiB |   8816 MiB |
|       from large pool | 735232 KiB |   2226 MiB |   9416 MiB |   8698 MiB |
|       from small pool |  47104 KiB |     70 MiB |    164 MiB |    118 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 129756 GiB | 129756 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 127491 GiB | 127491 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   32005 K  |   32005 K  |
|       from large pool |       2    |     311    |   15360 K  |   15360 K  |
|       from small pool |       0    |    1419    |   16644 K  |   16644 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   32005 K  |   32005 K  |
|       from large pool |       2    |     311    |   15360 K  |   15360 K  |
|       from small pool |       0    |    1419    |   16644 K  |   16644 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     127    |     464    |     409    |
|       from large pool |      32    |      93    |     382    |     350    |
|       from small pool |      23    |      35    |      82    |      59    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   16797 K  |   16797 K  |
|       from large pool |       4    |      96    |   10165 K  |   10165 K  |
|       from small pool |       0    |     223    |    6632 K  |    6632 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370

 Experiment start at: 2024-07-29 04:46:01.838454
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.964108, 'recall': 0.9631605, 'specificity': 0.9631605, 'f1': 0.96287835, 'auroc': 0.9958602, 'binary_precision': 0.9904437, 'binary_recall': 0.9355255, 'binary_specificity': 0.99079555, 'binary_f1_score': 0.96220165}
confusion matrix:
      0     1
0  1507    14
1   100  1451
---- Validation: 
scalar performance:
{'acc': 0.80311286, 'precision': 0.8038661, 'recall': 0.8032831, 'specificity': 0.8032831, 'f1': 0.8030442, 'auroc': 0.88091165, 'binary_precision': 0.78688526, 'binary_recall': 0.82758623, 'binary_specificity': 0.7789799, 'binary_f1_score': 0.80672276}
confusion matrix:
     0    1
0  504  143
1  110  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.8314798, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82593286, 'auroc': 0.91346073, 'binary_precision': 0.8717949, 'binary_recall': 0.7657658, 'binary_specificity': 0.8873874, 'binary_f1_score': 0.81534773}
confusion matrix:
     0    1
0  197   25
1   52  170
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:47:43.157341,epoch time: 0:01:41.318887,used: 0:01:41.318887,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97522604, 'recall': 0.97482014, 'specificity': 0.97482014, 'f1': 0.9749237, 'auroc': 0.9978312, 'binary_precision': 0.96590906, 'binary_recall': 0.98519, 'binary_specificity': 0.9644503, 'binary_f1_score': 0.9754543}
confusion matrix:
      0     1
0  1465    54
1    23  1530
---- Validation: 
scalar performance:
{'acc': 0.8303502, 'precision': 0.83244514, 'recall': 0.8300693, 'specificity': 0.8300693, 'f1': 0.8299918, 'auroc': 0.89780414, 'binary_precision': 0.85714287, 'binary_recall': 0.78996867, 'binary_specificity': 0.87017, 'binary_f1_score': 0.822186}
confusion matrix:
     0    1
0  563   84
1  134  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8400901, 'precision': 0.8487588, 'recall': 0.8400901, 'specificity': 0.8400901, 'f1': 0.8390902, 'auroc': 0.9180465, 'binary_precision': 0.9037433, 'binary_recall': 0.7612613, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.8264059}
confusion matrix:
     0    1
0  204   18
1   53  169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 04:49:31.158235,epoch time: 0:01:48.000894,used: 0:03:29.319781,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97580755, 'recall': 0.9752176, 'specificity': 0.9752176, 'f1': 0.9749309, 'auroc': 0.99924207, 'binary_precision': 0.99932384, 'binary_recall': 0.951094, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.97461265}
confusion matrix:
      0     1
0  1517     1
1    76  1478
---- Validation: 
scalar performance:
{'acc': 0.7688716, 'precision': 0.8099257, 'recall': 0.7675902, 'specificity': 0.7675902, 'f1': 0.76037276, 'auroc': 0.89753044, 'binary_precision': 0.92098767, 'binary_recall': 0.5846395, 'binary_specificity': 0.95054096, 'binary_f1_score': 0.7152445}
confusion matrix:
     0    1
0  615   32
1  265  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.86784595, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8293301, 'auroc': 0.9255539, 'binary_precision': 0.9805195, 'binary_recall': 0.6801802, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.8031915}
confusion matrix:
     0    1
0  219    3
1   71  151
early stop counter: 1
val acc:0.7688716053962708, best validation acc: 0.8303502202033997, corresponding to test acc:                         0.8400900959968567 / 0.8400900959968567
after epoch: 3,now: 2024-07-29 04:51:19.484811,epoch time: 0:01:48.326576,used: 0:05:17.646357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98372054, 'recall': 0.98377967, 'specificity': 0.98377967, 'f1': 0.9837234, 'auroc': 0.9990072, 'binary_precision': 0.98893946, 'binary_recall': 0.9787508, 'binary_specificity': 0.98880845, 'binary_f1_score': 0.98381877}
confusion matrix:
      0     1
0  1502    17
1    33  1520
---- Validation: 
scalar performance:
{'acc': 0.8428016, 'precision': 0.8522557, 'recall': 0.842227, 'specificity': 0.842227, 'f1': 0.84157646, 'auroc': 0.91223055, 'binary_precision': 0.9082397, 'binary_recall': 0.7601881, 'binary_specificity': 0.92426586, 'binary_f1_score': 0.82764506}
confusion matrix:
     0    1
0  598   49
1  153  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8671171, 'precision': 0.88008106, 'recall': 0.86711717, 'specificity': 0.86711717, 'f1': 0.8659743, 'auroc': 0.9209074, 'binary_precision': 0.95027626, 'binary_recall': 0.7747748, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.85359806}
confusion matrix:
     0    1
0  213    9
1   50  172
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 04:53:10.646194,epoch time: 0:01:51.161383,used: 0:07:08.807740,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98632514, 'recall': 0.98637134, 'specificity': 0.98637134, 'f1': 0.98632777, 'auroc': 0.9990928, 'binary_precision': 0.99089134, 'binary_recall': 0.9819471, 'binary_specificity': 0.99079555, 'binary_f1_score': 0.986399}
confusion matrix:
      0     1
0  1507    14
1    28  1523
---- Validation: 
scalar performance:
{'acc': 0.83501947, 'precision': 0.8478128, 'recall': 0.8343464, 'specificity': 0.8343464, 'f1': 0.8332868, 'auroc': 0.9246074, 'binary_precision': 0.9127907, 'binary_recall': 0.73824453, 'binary_specificity': 0.93044823, 'binary_f1_score': 0.81629115}
confusion matrix:
     0    1
0  602   45
1  167  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8536036, 'precision': 0.87171257, 'recall': 0.8536036, 'specificity': 0.8536036, 'f1': 0.85179853, 'auroc': 0.93113387, 'binary_precision': 0.9537572, 'binary_recall': 0.7432432, 'binary_specificity': 0.963964, 'binary_f1_score': 0.83544296}
confusion matrix:
     0    1
0  214    8
1   57  165
early stop counter: 1
val acc:0.8350194692611694, best validation acc: 0.842801570892334, corresponding to test acc:                         0.8671171069145203 / 0.8671171069145203
after epoch: 5,now: 2024-07-29 04:55:00.512488,epoch time: 0:01:49.866294,used: 0:08:58.674034,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97366995, 'recall': 0.97237515, 'specificity': 0.97237515, 'f1': 0.9726249, 'auroc': 0.9989113, 'binary_precision': 0.95491046, 'binary_recall': 0.9929351, 'binary_specificity': 0.9518152, 'binary_f1_score': 0.97355163}
confusion matrix:
      0     1
0  1442    73
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.86070037, 'precision': 0.86382174, 'recall': 0.86102605, 'specificity': 0.86102605, 'f1': 0.8604719, 'auroc': 0.92665935, 'binary_precision': 0.82832617, 'binary_recall': 0.9075235, 'binary_specificity': 0.8145286, 'binary_f1_score': 0.86611825}
confusion matrix:
     0    1
0  527  120
1   59  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8693694, 'precision': 0.8718137, 'recall': 0.8693694, 'specificity': 0.8693694, 'f1': 0.86915433, 'auroc': 0.9340151, 'binary_precision': 0.9019608, 'binary_recall': 0.8288288, 'binary_specificity': 0.9099099, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  202   20
1   38  184
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-29 04:56:46.625895,epoch time: 0:01:46.113407,used: 0:10:44.787441,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9864036, 'recall': 0.9864407, 'specificity': 0.9864407, 'f1': 0.986328, 'auroc': 0.9991789, 'binary_precision': 0.996063, 'binary_recall': 0.976834, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.98635477}
confusion matrix:
      0     1
0  1512     6
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.7058366, 'precision': 0.7975453, 'recall': 0.7038817, 'specificity': 0.7038817, 'f1': 0.68001974, 'auroc': 0.9265746, 'binary_precision': 0.96099293, 'binary_recall': 0.4247649, 'binary_specificity': 0.98299843, 'binary_f1_score': 0.58913046}
confusion matrix:
     0    1
0  636   11
1  367  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.713964, 'precision': 0.80873954, 'recall': 0.713964, 'specificity': 0.713964, 'f1': 0.69018775, 'auroc': 0.93403536, 'binary_precision': 0.97979796, 'binary_recall': 0.43693694, 'binary_specificity': 0.990991, 'binary_f1_score': 0.60436136}
confusion matrix:
     0   1
0  220   2
1  125  97
early stop counter: 1
val acc:0.7058365941047668, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 7,now: 2024-07-29 04:58:35.803435,epoch time: 0:01:49.177540,used: 0:12:33.964981,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.9743166, 'recall': 0.97360885, 'specificity': 0.97360885, 'f1': 0.97330177, 'auroc': 0.9988493, 'binary_precision': 0.9993216, 'binary_recall': 0.94787645, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9729194}
confusion matrix:
      0     1
0  1517     1
1    81  1473
---- Validation: 
scalar performance:
{'acc': 0.57509726, 'precision': 0.7468342, 'recall': 0.5721548, 'specificity': 0.5721548, 'f1': 0.48190075, 'auroc': 0.8732073, 'binary_precision': 0.95098037, 'binary_recall': 0.15203762, 'binary_specificity': 0.992272, 'binary_f1_score': 0.26216215}
confusion matrix:
     0   1
0  642   5
1  541  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5045045, 'precision': 0.75113124, 'recall': 0.5045045, 'specificity': 0.5045045, 'f1': 0.34326592, 'auroc': 0.9136941, 'binary_precision': 1.0, 'binary_recall': 0.009009009, 'binary_specificity': 1.0, 'binary_f1_score': 0.017857144}
confusion matrix:
     0  1
0  222  0
1  220  2
early stop counter: 2
val acc:0.5750972628593445, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 8,now: 2024-07-29 05:00:26.242053,epoch time: 0:01:50.438618,used: 0:14:24.403599,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931531, 'recall': 0.99317515, 'specificity': 0.99317515, 'f1': 0.9931632, 'auroc': 0.9997554, 'binary_precision': 0.994201, 'binary_recall': 0.992283, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9932411}
confusion matrix:
      0     1
0  1508     9
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.8583658, 'precision': 0.8707499, 'recall': 0.8577265, 'specificity': 0.8577265, 'f1': 0.85701275, 'auroc': 0.9334813, 'binary_precision': 0.9367816, 'binary_recall': 0.7664577, 'binary_specificity': 0.94899535, 'binary_f1_score': 0.84310347}
confusion matrix:
     0    1
0  614   33
1  149  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130631, 'precision': 0.8510181, 'recall': 0.813063, 'specificity': 0.813063, 'f1': 0.8078694, 'auroc': 0.9046953, 'binary_precision': 0.96644294, 'binary_recall': 0.6486486, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.77628034}
confusion matrix:
     0    1
0  217    5
1   78  144
early stop counter: 3
val acc:0.8583657741546631, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 9,now: 2024-07-29 05:02:14.990564,epoch time: 0:01:48.748511,used: 0:16:13.152110,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866376, 'recall': 0.98671496, 'specificity': 0.98671496, 'f1': 0.98665273, 'auroc': 0.9990805, 'binary_precision': 0.9915639, 'binary_recall': 0.9820051, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9867614}
confusion matrix:
      0     1
0  1503    13
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.8101167, 'precision': 0.82929265, 'recall': 0.809268, 'specificity': 0.809268, 'f1': 0.8070115, 'auroc': 0.91161525, 'binary_precision': 0.9070248, 'binary_recall': 0.68808776, 'binary_specificity': 0.93044823, 'binary_f1_score': 0.7825312}
confusion matrix:
     0    1
0  602   45
1  199  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.786036, 'precision': 0.8325156, 'recall': 0.786036, 'specificity': 0.786036, 'f1': 0.77828825, 'auroc': 0.8927644, 'binary_precision': 0.95683455, 'binary_recall': 0.5990991, 'binary_specificity': 0.972973, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  216    6
1   89  133
early stop counter: 4
val acc:0.810116708278656, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 10,now: 2024-07-29 05:04:05.952938,epoch time: 0:01:50.962374,used: 0:18:04.114484,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97789717, 'recall': 0.9774839, 'specificity': 0.9774839, 'f1': 0.97721136, 'auroc': 0.99917126, 'binary_precision': 0.9993275, 'binary_recall': 0.955627, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.97698885}
confusion matrix:
      0     1
0  1516     1
1    69  1486
---- Validation: 
scalar performance:
{'acc': 0.6015564, 'precision': 0.7453847, 'recall': 0.5988551, 'specificity': 0.5988551, 'f1': 0.5301323, 'auroc': 0.88124835, 'binary_precision': 0.9315069, 'binary_recall': 0.21316615, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.3469388}
confusion matrix:
     0    1
0  637   10
1  502  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.509009, 'precision': 0.6689497, 'recall': 0.509009, 'specificity': 0.509009, 'f1': 0.35677826, 'auroc': 0.87022156, 'binary_precision': 0.8333333, 'binary_recall': 0.022522522, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.04385965}
confusion matrix:
     0  1
0  221  1
1  217  5
early stop counter: 5
val acc:0.6015564203262329, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.869369387626648 / 0.869369387626648
after epoch: 11,now: 2024-07-29 05:05:53.065366,epoch time: 0:01:47.112428,used: 0:19:51.226912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_46_01_seed_6_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:19:51.226912 at 2024-07-29 05:05:53.065366
persisted model performance metric: 

scalar performance:
{'acc': 0.8693694, 'precision': 0.8718137, 'recall': 0.8693694, 'specificity': 0.8693694, 'f1': 0.86915433, 'auroc': 0.9340151, 'binary_precision': 0.9019608, 'binary_recall': 0.8288288, 'binary_specificity': 0.9099099, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  202   20
1   38  184
oracle model performance metric: 

scalar performance:
{'acc': 0.8693694, 'precision': 0.8718137, 'recall': 0.8693694, 'specificity': 0.8693694, 'f1': 0.86915433, 'auroc': 0.9340151, 'binary_precision': 0.9019608, 'binary_recall': 0.8288288, 'binary_specificity': 0.9099099, 'binary_f1_score': 0.86384976}
confusion matrix:
     0    1
0  202   20
1   38  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455886 KiB |   2004 MiB | 191330 GiB | 191329 GiB |
|       from large pool | 415291 KiB |   1971 MiB | 188870 GiB | 188870 GiB |
|       from small pool |  40595 KiB |     60 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455886 KiB |   2004 MiB | 191330 GiB | 191329 GiB |
|       from large pool | 415291 KiB |   1971 MiB | 188870 GiB | 188870 GiB |
|       from small pool |  40595 KiB |     60 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 191037 GiB | 191037 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 188583 GiB | 188583 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2454 GiB |   2454 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  11092 MiB |   8816 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  10910 MiB |   8698 MiB |
|       from small pool |     64 MiB |     70 MiB |    182 MiB |    118 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 342833 KiB | 489230 KiB | 149293 GiB | 149293 GiB |
|       from large pool | 334277 KiB | 476433 KiB | 146705 GiB | 146705 GiB |
|       from small pool |   8556 KiB |  22276 KiB |   2587 GiB |   2587 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   36588 K  |   36587 K  |
|       from large pool |     187    |     311    |   17561 K  |   17561 K  |
|       from small pool |    1117    |    1419    |   19027 K  |   19026 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   36588 K  |   36587 K  |
|       from large pool |     187    |     311    |   17561 K  |   17561 K  |
|       from small pool |    1117    |    1419    |   19027 K  |   19026 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     533    |     409    |
|       from large pool |      92    |      93    |     442    |     350    |
|       from small pool |      32    |      35    |      91    |      59    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     261    |   19291 K  |   19291 K  |
|       from large pool |      34    |      96    |   11711 K  |   11711 K  |
|       from small pool |      38    |     223    |    7580 K  |    7580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 191330 GiB | 191330 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 188870 GiB | 188870 GiB |
|       from small pool |      0 KiB |     60 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 191330 GiB | 191330 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 188870 GiB | 188870 GiB |
|       from small pool |      0 KiB |     60 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 191037 GiB | 191037 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 188583 GiB | 188583 GiB |
|       from small pool |      0 KiB |     60 MiB |   2454 GiB |   2454 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    780 MiB |   2290 MiB |  11092 MiB |  10312 MiB |
|       from large pool |    732 MiB |   2226 MiB |  10910 MiB |  10178 MiB |
|       from small pool |     48 MiB |     70 MiB |    182 MiB |    134 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 149294 GiB | 149293 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 146706 GiB | 146706 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2587 GiB |   2587 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   36588 K  |   36588 K  |
|       from large pool |       2    |     311    |   17561 K  |   17561 K  |
|       from small pool |       0    |    1419    |   19027 K  |   19027 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   36588 K  |   36588 K  |
|       from large pool |       2    |     311    |   17561 K  |   17561 K  |
|       from small pool |       0    |    1419    |   19027 K  |   19027 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     533    |     476    |
|       from large pool |      33    |      93    |     442    |     409    |
|       from small pool |      24    |      35    |      91    |      67    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   19292 K  |   19292 K  |
|       from large pool |       4    |      96    |   11711 K  |   11711 K  |
|       from small pool |       0    |     223    |    7580 K  |    7580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 191330 GiB | 191330 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 188870 GiB | 188870 GiB |
|       from small pool |      0 KiB |     60 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 191330 GiB | 191330 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 188870 GiB | 188870 GiB |
|       from small pool |      0 KiB |     60 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 191037 GiB | 191037 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 188583 GiB | 188583 GiB |
|       from small pool |      0 KiB |     60 MiB |   2454 GiB |   2454 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    780 MiB |   2290 MiB |  11092 MiB |  10312 MiB |
|       from large pool |    732 MiB |   2226 MiB |  10910 MiB |  10178 MiB |
|       from small pool |     48 MiB |     70 MiB |    182 MiB |    134 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 149294 GiB | 149293 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 146706 GiB | 146706 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2587 GiB |   2587 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   36588 K  |   36588 K  |
|       from large pool |       2    |     311    |   17561 K  |   17561 K  |
|       from small pool |       0    |    1419    |   19027 K  |   19027 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   36588 K  |   36588 K  |
|       from large pool |       2    |     311    |   17561 K  |   17561 K  |
|       from small pool |       0    |    1419    |   19027 K  |   19027 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     533    |     476    |
|       from large pool |      33    |      93    |     442    |     409    |
|       from small pool |      24    |      35    |      91    |      67    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   19292 K  |   19292 K  |
|       from large pool |       4    |      96    |   11711 K  |   11711 K  |
|       from small pool |       0    |     223    |    7580 K  |    7580 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370

 Experiment start at: 2024-07-29 05:06:32.376017
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9586589, 'precision': 0.9592819, 'recall': 0.9589998, 'specificity': 0.9589998, 'f1': 0.9586569, 'auroc': 0.98826087, 'binary_precision': 0.98055, 'binary_recall': 0.9371795, 'binary_specificity': 0.9808201, 'binary_f1_score': 0.9583743}
confusion matrix:
      0     1
0  1483    29
1    98  1462
---- Validation: 
scalar performance:
{'acc': 0.66923076, 'precision': 0.6700441, 'recall': 0.6685369, 'specificity': 0.6685369, 'f1': 0.66821307, 'auroc': 0.74742424, 'binary_precision': 0.6785714, 'binary_recall': 0.6234375, 'binary_specificity': 0.71363634, 'binary_f1_score': 0.6498372}
confusion matrix:
     0    1
0  471  189
1  241  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72707427, 'precision': 0.7819129, 'recall': 0.72707427, 'specificity': 0.72707427, 'f1': 0.7131232, 'auroc': 0.88005567, 'binary_precision': 0.6575758, 'binary_recall': 0.9475983, 'binary_specificity': 0.5065502, 'binary_f1_score': 0.77638644}
confusion matrix:
     0    1
0  116  113
1   12  217
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 05:08:28.377284,epoch time: 0:01:56.001267,used: 0:01:56.001267,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97438234, 'recall': 0.9733669, 'specificity': 0.9733669, 'f1': 0.9736054, 'auroc': 0.99805105, 'binary_precision': 0.95903164, 'binary_recall': 0.99038464, 'binary_specificity': 0.9563492, 'binary_f1_score': 0.974456}
confusion matrix:
      0     1
0  1446    66
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.86, 'precision': 0.86254513, 'recall': 0.8606534, 'specificity': 0.8606534, 'f1': 0.8598802, 'auroc': 0.9186884, 'binary_precision': 0.82808024, 'binary_recall': 0.903125, 'binary_specificity': 0.8181818, 'binary_f1_score': 0.86397606}
confusion matrix:
     0    1
0  540  120
1   62  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.8535588, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.84889483, 'auroc': 0.9380256, 'binary_precision': 0.81496066, 'binary_recall': 0.9039301, 'binary_specificity': 0.7947598, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  182   47
1   22  207
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 05:10:18.784191,epoch time: 0:01:50.406907,used: 0:03:46.408174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9695652, 'recall': 0.9685898, 'specificity': 0.9685898, 'f1': 0.96809053, 'auroc': 0.9988774, 'binary_precision': 1.0, 'binary_recall': 0.9371795, 'binary_specificity': 1.0, 'binary_f1_score': 0.96757114}
confusion matrix:
      0     1
0  1512     0
1    98  1462
---- Validation: 
scalar performance:
{'acc': 0.7084615, 'precision': 0.79245794, 'recall': 0.704285, 'specificity': 0.704285, 'f1': 0.6832145, 'auroc': 0.9026396, 'binary_precision': 0.9453925, 'binary_recall': 0.4328125, 'binary_specificity': 0.9757576, 'binary_f1_score': 0.5937835}
confusion matrix:
     0    1
0  644   16
1  363  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74454147, 'precision': 0.83092487, 'recall': 0.74454147, 'specificity': 0.74454147, 'f1': 0.7267066, 'auroc': 0.9409622, 'binary_precision': 1.0, 'binary_recall': 0.48908296, 'binary_specificity': 1.0, 'binary_f1_score': 0.6568915}
confusion matrix:
     0    1
0  229    0
1  117  112
early stop counter: 1
val acc:0.7084615230560303, best validation acc: 0.8600000143051147, corresponding to test acc:                         0.8493449687957764 / 0.8493449687957764
after epoch: 3,now: 2024-07-29 05:12:09.968143,epoch time: 0:01:51.183952,used: 0:05:37.592126,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9804411, 'recall': 0.9805454, 'specificity': 0.9805454, 'f1': 0.98046666, 'auroc': 0.99868524, 'binary_precision': 0.9857513, 'binary_recall': 0.975641, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.9806701}
confusion matrix:
      0     1
0  1490    22
1    38  1522
---- Validation: 
scalar performance:
{'acc': 0.8769231, 'precision': 0.87964344, 'recall': 0.8762784, 'specificity': 0.8762784, 'f1': 0.87654436, 'auroc': 0.9201728, 'binary_precision': 0.90816325, 'binary_recall': 0.834375, 'binary_specificity': 0.91818184, 'binary_f1_score': 0.86970687}
confusion matrix:
     0    1
0  606   54
1  106  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8860979, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8627205, 'auroc': 0.9443184, 'binary_precision': 0.9771429, 'binary_recall': 0.7467249, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.84653467}
confusion matrix:
     0    1
0  225    4
1   58  171
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 05:14:00.859715,epoch time: 0:01:50.891572,used: 0:07:28.483698,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9819175, 'recall': 0.9816748, 'specificity': 0.9816748, 'f1': 0.9817624, 'auroc': 0.99883115, 'binary_precision': 0.9765526, 'binary_recall': 0.9878205, 'binary_specificity': 0.9755291, 'binary_f1_score': 0.98215425}
confusion matrix:
      0     1
0  1475    37
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.8638462, 'precision': 0.8673894, 'recall': 0.8630918, 'specificity': 0.8630918, 'f1': 0.86331546, 'auroc': 0.90935135, 'binary_precision': 0.8998273, 'binary_recall': 0.8140625, 'binary_specificity': 0.91212124, 'binary_f1_score': 0.854799}
confusion matrix:
     0    1
0  602   58
1  119  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88646287, 'precision': 0.88791275, 'recall': 0.8864629, 'specificity': 0.8864629, 'f1': 0.8863567, 'auroc': 0.94498575, 'binary_precision': 0.9116279, 'binary_recall': 0.8558952, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8828829}
confusion matrix:
     0    1
0  210   19
1   33  196
new oracle model saved
early stop counter: 1
val acc:0.8638461828231812, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.864628791809082 / 0.8864628672599792
after epoch: 5,now: 2024-07-29 05:15:51.563222,epoch time: 0:01:50.703507,used: 0:09:19.187205,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9823828, 'recall': 0.9823514, 'specificity': 0.9823514, 'f1': 0.9820963, 'auroc': 0.999314, 'binary_precision': 0.99867463, 'binary_recall': 0.96602565, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.98207885}
confusion matrix:
      0     1
0  1510     2
1    53  1507
---- Validation: 
scalar performance:
{'acc': 0.6615385, 'precision': 0.7842895, 'recall': 0.6564157, 'specificity': 0.6564157, 'f1': 0.6163865, 'auroc': 0.89665246, 'binary_precision': 0.96728975, 'binary_recall': 0.3234375, 'binary_specificity': 0.98939395, 'binary_f1_score': 0.4847775}
confusion matrix:
     0    1
0  653    7
1  433  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68122274, 'precision': 0.7997477, 'recall': 0.6812227, 'specificity': 0.6812227, 'f1': 0.64625347, 'auroc': 0.9360042, 'binary_precision': 0.9882353, 'binary_recall': 0.36681223, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.53503186}
confusion matrix:
     0   1
0  228   1
1  145  84
early stop counter: 2
val acc:0.6615384817123413, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.864628791809082 / 0.8864628672599792
after epoch: 6,now: 2024-07-29 05:17:32.892653,epoch time: 0:01:41.329431,used: 0:11:00.516636,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856484, 'recall': 0.9857143, 'specificity': 0.9857143, 'f1': 0.9856746, 'auroc': 0.9989219, 'binary_precision': 0.98840207, 'binary_recall': 0.98333335, 'binary_specificity': 0.9880952, 'binary_f1_score': 0.9858612}
confusion matrix:
      0     1
0  1494    18
1    26  1534
---- Validation: 
scalar performance:
{'acc': 0.77, 'precision': 0.8016509, 'recall': 0.76747155, 'specificity': 0.76747155, 'f1': 0.7626345, 'auroc': 0.8889252, 'binary_precision': 0.8955917, 'binary_recall': 0.603125, 'binary_specificity': 0.9318182, 'binary_f1_score': 0.7208216}
confusion matrix:
     0    1
0  615   45
1  254  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.866639, 'recall': 0.85371184, 'specificity': 0.85371184, 'f1': 0.8524109, 'auroc': 0.92141646, 'binary_precision': 0.9354839, 'binary_recall': 0.75982535, 'binary_specificity': 0.9475983, 'binary_f1_score': 0.83855426}
confusion matrix:
     0    1
0  217   12
1   55  174
early stop counter: 3
val acc:0.7699999809265137, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.864628791809082 / 0.8864628672599792
after epoch: 7,now: 2024-07-29 05:19:16.501090,epoch time: 0:01:43.608437,used: 0:12:44.125073,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9885759, 'recall': 0.9886701, 'specificity': 0.9886701, 'f1': 0.98860526, 'auroc': 0.9991441, 'binary_precision': 0.99288946, 'binary_recall': 0.9846154, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.9887351}
confusion matrix:
      0     1
0  1501    11
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.81153846, 'precision': 0.84048235, 'recall': 0.8092803, 'specificity': 0.8092803, 'f1': 0.80663586, 'auroc': 0.9079427, 'binary_precision': 0.93598235, 'binary_recall': 0.6625, 'binary_specificity': 0.9560606, 'binary_f1_score': 0.7758463}
confusion matrix:
     0    1
0  631   29
1  216  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.8708594, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.85442674, 'auroc': 0.91716397, 'binary_precision': 0.9453552, 'binary_recall': 0.75545853, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.83980584}
confusion matrix:
     0    1
0  219   10
1   56  173
early stop counter: 4
val acc:0.8115384578704834, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.864628791809082 / 0.8864628672599792
after epoch: 8,now: 2024-07-29 05:21:06.796414,epoch time: 0:01:50.295324,used: 0:14:34.420397,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9802557, 'recall': 0.9792277, 'specificity': 0.9792277, 'f1': 0.97947085, 'auroc': 0.99947894, 'binary_precision': 0.96461827, 'binary_recall': 0.99615383, 'binary_specificity': 0.9623016, 'binary_f1_score': 0.98013246}
confusion matrix:
      0     1
0  1455    57
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.82153845, 'precision': 0.82157207, 'recall': 0.8214015, 'specificity': 0.8214015, 'f1': 0.82145566, 'auroc': 0.8816974, 'binary_precision': 0.8227848, 'binary_recall': 0.8125, 'binary_specificity': 0.830303, 'binary_f1_score': 0.8176101}
confusion matrix:
     0    1
0  548  112
1  120  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.85485536, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.8535938, 'auroc': 0.9303026, 'binary_precision': 0.8347107, 'binary_recall': 0.88209605, 'binary_specificity': 0.8253275, 'binary_f1_score': 0.85774946}
confusion matrix:
     0    1
0  189   40
1   27  202
early stop counter: 5
val acc:0.8215384483337402, best validation acc: 0.8769230842590332, corresponding to test acc:                         0.864628791809082 / 0.8864628672599792
after epoch: 9,now: 2024-07-29 05:22:56.382550,epoch time: 0:01:49.586136,used: 0:16:24.006533,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_06_32_seed_7_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:16:24.006533 at 2024-07-29 05:22:56.382550
persisted model performance metric: 

scalar performance:
{'acc': 0.8646288, 'precision': 0.8860979, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8627205, 'auroc': 0.9443184, 'binary_precision': 0.9771429, 'binary_recall': 0.7467249, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.84653467}
confusion matrix:
     0    1
0  225    4
1   58  171
oracle model performance metric: 

scalar performance:
{'acc': 0.88646287, 'precision': 0.88791275, 'recall': 0.8864629, 'specificity': 0.8864629, 'f1': 0.8863567, 'auroc': 0.94498575, 'binary_precision': 0.9116279, 'binary_recall': 0.8558952, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8828829}
confusion matrix:
     0    1
0  210   19
1   33  196
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454973 KiB |   2004 MiB | 210998 GiB | 210998 GiB |
|       from large pool | 414374 KiB |   1971 MiB | 208286 GiB | 208285 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2712 GiB |   2712 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454973 KiB |   2004 MiB | 210998 GiB | 210998 GiB |
|       from large pool | 414374 KiB |   1971 MiB | 208286 GiB | 208285 GiB |
|       from small pool |  40598 KiB |     60 MiB |   2712 GiB |   2712 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 210696 GiB | 210696 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 207989 GiB | 207989 GiB |
|       from small pool |  40407 KiB |     60 MiB |   2706 GiB |   2706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2270 MiB |   2290 MiB |  12582 MiB |  10312 MiB |
|       from large pool |   2206 MiB |   2226 MiB |  12384 MiB |  10178 MiB |
|       from small pool |     64 MiB |     70 MiB |    198 MiB |    134 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 362179 KiB | 489230 KiB | 165691 GiB | 165690 GiB |
|       from large pool | 355673 KiB | 476433 KiB | 162836 GiB | 162836 GiB |
|       from small pool |   6505 KiB |  22276 KiB |   2854 GiB |   2854 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   40360 K  |   40359 K  |
|       from large pool |     187    |     311    |   19370 K  |   19370 K  |
|       from small pool |    1123    |    1419    |   20989 K  |   20988 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   40360 K  |   40359 K  |
|       from large pool |     187    |     311    |   19370 K  |   19370 K  |
|       from small pool |    1123    |    1419    |   20989 K  |   20988 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     600    |     476    |
|       from large pool |      92    |      93    |     501    |     409    |
|       from small pool |      32    |      35    |      99    |      67    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |     261    |   21120 K  |   21120 K  |
|       from large pool |      31    |      96    |   12765 K  |   12765 K  |
|       from small pool |      37    |     223    |    8355 K  |    8355 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 210998 GiB | 210998 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 208286 GiB | 208286 GiB |
|       from small pool |      0 KiB |     60 MiB |   2712 GiB |   2712 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 210998 GiB | 210998 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 208286 GiB | 208286 GiB |
|       from small pool |      0 KiB |     60 MiB |   2712 GiB |   2712 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 210696 GiB | 210696 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 207989 GiB | 207989 GiB |
|       from small pool |      0 KiB |     60 MiB |   2706 GiB |   2706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    798 MiB |   2290 MiB |  12582 MiB |  11784 MiB |
|       from large pool |    752 MiB |   2226 MiB |  12384 MiB |  11632 MiB |
|       from small pool |     46 MiB |     70 MiB |    198 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 165691 GiB | 165691 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 162837 GiB | 162837 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2854 GiB |   2854 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   40360 K  |   40360 K  |
|       from large pool |       2    |     311    |   19370 K  |   19370 K  |
|       from small pool |       0    |    1419    |   20989 K  |   20989 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   40360 K  |   40360 K  |
|       from large pool |       2    |     311    |   19370 K  |   19370 K  |
|       from small pool |       0    |    1419    |   20989 K  |   20989 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     600    |     543    |
|       from large pool |      34    |      93    |     501    |     467    |
|       from small pool |      23    |      35    |      99    |      76    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   21120 K  |   21120 K  |
|       from large pool |       4    |      96    |   12765 K  |   12765 K  |
|       from small pool |       0    |     223    |    8355 K  |    8355 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 210998 GiB | 210998 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 208286 GiB | 208286 GiB |
|       from small pool |      0 KiB |     60 MiB |   2712 GiB |   2712 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 210998 GiB | 210998 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 208286 GiB | 208286 GiB |
|       from small pool |      0 KiB |     60 MiB |   2712 GiB |   2712 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 210696 GiB | 210696 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 207989 GiB | 207989 GiB |
|       from small pool |      0 KiB |     60 MiB |   2706 GiB |   2706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    798 MiB |   2290 MiB |  12582 MiB |  11784 MiB |
|       from large pool |    752 MiB |   2226 MiB |  12384 MiB |  11632 MiB |
|       from small pool |     46 MiB |     70 MiB |    198 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 165691 GiB | 165691 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 162837 GiB | 162837 GiB |
|       from small pool |      0 KiB |  22276 KiB |   2854 GiB |   2854 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   40360 K  |   40360 K  |
|       from large pool |       2    |     311    |   19370 K  |   19370 K  |
|       from small pool |       0    |    1419    |   20989 K  |   20989 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   40360 K  |   40360 K  |
|       from large pool |       2    |     311    |   19370 K  |   19370 K  |
|       from small pool |       0    |    1419    |   20989 K  |   20989 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     600    |     543    |
|       from large pool |      34    |      93    |     501    |     467    |
|       from small pool |      23    |      35    |      99    |      76    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   21120 K  |   21120 K  |
|       from large pool |       4    |      96    |   12765 K  |   12765 K  |
|       from small pool |       0    |     223    |    8355 K  |    8355 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370

 Experiment start at: 2024-07-29 05:23:43.226744
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95690787, 'precision': 0.9581207, 'recall': 0.9572408, 'specificity': 0.9572408, 'f1': 0.95689577, 'auroc': 0.9942664, 'binary_precision': 0.98483807, 'binary_recall': 0.92912877, 'binary_specificity': 0.9853529, 'binary_f1_score': 0.95617265}
confusion matrix:
      0     1
0  1480    22
1   109  1429
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.68600154, 'precision': 0.74904335, 'recall': 0.67768276, 'specificity': 0.67768276, 'f1': 0.6584884, 'auroc': 0.8429284, 'binary_precision': 0.8666667, 'binary_recall': 0.41533548, 'binary_specificity': 0.94003, 'binary_f1_score': 0.5615551}
confusion matrix:
     0    1
0  627   40
1  366  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6995413, 'precision': 0.81232095, 'recall': 0.6995413, 'specificity': 0.6995413, 'f1': 0.6697256, 'auroc': 0.91486406, 'binary_precision': 1.0, 'binary_recall': 0.39908257, 'binary_specificity': 1.0, 'binary_f1_score': 0.5704918}
confusion matrix:
     0   1
0  218   0
1  131  87
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 05:25:36.761993,epoch time: 0:01:53.535249,used: 0:01:53.535249,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92401314, 'precision': 0.9338074, 'recall': 0.9231415, 'specificity': 0.9231415, 'f1': 0.9234662, 'auroc': 0.99693865, 'binary_precision': 0.8715179, 'binary_recall': 0.99674904, 'binary_specificity': 0.849534, 'binary_f1_score': 0.92993635}
confusion matrix:
      0     1
0  1276   226
1     5  1533
---- Validation: 
scalar performance:
{'acc': 0.81515855, 'precision': 0.81833935, 'recall': 0.8167155, 'specificity': 0.8167155, 'f1': 0.815059, 'auroc': 0.90563107, 'binary_precision': 0.77761835, 'binary_recall': 0.8658147, 'binary_specificity': 0.7676162, 'binary_f1_score': 0.81934994}
confusion matrix:
     0    1
0  512  155
1   84  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.8253871, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.8178867, 'auroc': 0.9172207, 'binary_precision': 0.77911645, 'binary_recall': 0.88990825, 'binary_specificity': 0.7477064, 'binary_f1_score': 0.8308351}
confusion matrix:
     0    1
0  163   55
1   24  194
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 05:27:22.430591,epoch time: 0:01:45.668598,used: 0:03:39.203847,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9263158, 'precision': 0.9342648, 'recall': 0.92718434, 'specificity': 0.92718434, 'f1': 0.926068, 'auroc': 0.9929352, 'binary_precision': 0.99622643, 'binary_recall': 0.8576998, 'binary_specificity': 0.9966689, 'binary_f1_score': 0.92178774}
confusion matrix:
      0     1
0  1496     5
1   219  1320
---- Validation: 
scalar performance:
{'acc': 0.771075, 'precision': 0.7986958, 'recall': 0.76608217, 'specificity': 0.76608217, 'f1': 0.76325476, 'auroc': 0.87371093, 'binary_precision': 0.8819444, 'binary_recall': 0.6086262, 'binary_specificity': 0.9235382, 'binary_f1_score': 0.7202268}
confusion matrix:
     0    1
0  616   51
1  245  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463303, 'precision': 0.87575054, 'recall': 0.8463303, 'specificity': 0.8463303, 'f1': 0.8432622, 'auroc': 0.92347026, 'binary_precision': 0.9808917, 'binary_recall': 0.70642203, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.8213333}
confusion matrix:
     0    1
0  215    3
1   64  154
new oracle model saved
early stop counter: 1
val acc:0.7710750102996826, best validation acc: 0.8151585459709167, corresponding to test acc:                         0.8188073635101318 / 0.8463302850723267
after epoch: 3,now: 2024-07-29 05:29:09.202756,epoch time: 0:01:46.772165,used: 0:05:25.976012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97105265, 'precision': 0.9725637, 'recall': 0.9707447, 'specificity': 0.9707447, 'f1': 0.9710119, 'auroc': 0.9990455, 'binary_precision': 0.9486386, 'binary_recall': 0.99674904, 'binary_specificity': 0.94474036, 'binary_f1_score': 0.97209895}
confusion matrix:
      0     1
0  1419    83
1     5  1533
---- Validation: 
scalar performance:
{'acc': 0.8213457, 'precision': 0.8383317, 'recall': 0.82487273, 'specificity': 0.82487273, 'f1': 0.82004327, 'auroc': 0.9271283, 'binary_precision': 0.75418276, 'binary_recall': 0.9361022, 'binary_specificity': 0.7136432, 'binary_f1_score': 0.83535284}
confusion matrix:
     0    1
0  476  191
1   40  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.8387598, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.836963, 'auroc': 0.9315083, 'binary_precision': 0.81545067, 'binary_recall': 0.8715596, 'binary_specificity': 0.8027523, 'binary_f1_score': 0.84257203}
confusion matrix:
     0    1
0  175   43
1   28  190
better model found
persisted
after epoch: 4,now: 2024-07-29 05:30:52.909895,epoch time: 0:01:43.707139,used: 0:07:09.683151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98223686, 'precision': 0.9822848, 'recall': 0.982355, 'specificity': 0.982355, 'f1': 0.9822365, 'auroc': 0.9989909, 'binary_precision': 0.9914021, 'binary_recall': 0.97337663, 'binary_specificity': 0.9913333, 'binary_f1_score': 0.98230666}
confusion matrix:
      0     1
0  1487    13
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.7494199, 'precision': 0.8143053, 'recall': 0.74204874, 'specificity': 0.74204874, 'f1': 0.73184717, 'auroc': 0.9099875, 'binary_precision': 0.9494048, 'binary_recall': 0.50958467, 'binary_specificity': 0.97451276, 'binary_f1_score': 0.6632017}
confusion matrix:
     0    1
0  650   17
1  307  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7706422, 'precision': 0.8427673, 'recall': 0.77064216, 'specificity': 0.77064216, 'f1': 0.7579069, 'auroc': 0.9189462, 'binary_precision': 1.0, 'binary_recall': 0.5412844, 'binary_specificity': 1.0, 'binary_f1_score': 0.70238096}
confusion matrix:
     0    1
0  218    0
1  100  118
early stop counter: 1
val acc:0.7494199275970459, best validation acc: 0.8213456869125366, corresponding to test acc:                         0.8371559381484985 / 0.8463302850723267
after epoch: 5,now: 2024-07-29 05:32:37.616973,epoch time: 0:01:44.707078,used: 0:08:54.390229,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.9853473, 'recall': 0.9853394, 'specificity': 0.9853394, 'f1': 0.98519737, 'auroc': 0.99941564, 'binary_precision': 0.99733514, 'binary_recall': 0.973342, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.98519254}
confusion matrix:
      0     1
0  1498     4
1    41  1497
---- Validation: 
scalar performance:
{'acc': 0.7525135, 'precision': 0.8025978, 'recall': 0.74588186, 'specificity': 0.74588186, 'f1': 0.7383332, 'auroc': 0.90156436, 'binary_precision': 0.91803277, 'binary_recall': 0.5367412, 'binary_specificity': 0.9550225, 'binary_f1_score': 0.67741936}
confusion matrix:
     0    1
0  637   30
1  290  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.690367, 'precision': 0.7929443, 'recall': 0.690367, 'specificity': 0.690367, 'f1': 0.6606612, 'auroc': 0.9031857, 'binary_precision': 0.96629214, 'binary_recall': 0.39449543, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.5602606}
confusion matrix:
     0   1
0  215   3
1  132  86
early stop counter: 2
val acc:0.7525135278701782, best validation acc: 0.8213456869125366, corresponding to test acc:                         0.8371559381484985 / 0.8463302850723267
after epoch: 6,now: 2024-07-29 05:34:18.219648,epoch time: 0:01:40.602675,used: 0:10:34.992904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.92467105, 'precision': 0.9350549, 'recall': 0.9237257, 'specificity': 0.9237257, 'f1': 0.9240942, 'auroc': 0.9989736, 'binary_precision': 0.8708947, 'binary_recall': 0.99935025, 'binary_specificity': 0.84810126, 'binary_f1_score': 0.930711}
confusion matrix:
      0     1
0  1273   228
1     1  1538
---- Validation: 
scalar performance:
{'acc': 0.8383604, 'precision': 0.84668803, 'recall': 0.84082437, 'specificity': 0.84082437, 'f1': 0.83793813, 'auroc': 0.9275211, 'binary_precision': 0.7844475, 'binary_recall': 0.91853034, 'binary_specificity': 0.76311845, 'binary_f1_score': 0.8462104}
confusion matrix:
     0    1
0  509  158
1   51  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8358941, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.82435393, 'auroc': 0.9314451, 'binary_precision': 0.77734375, 'binary_recall': 0.91284406, 'binary_specificity': 0.7385321, 'binary_f1_score': 0.8396625}
confusion matrix:
     0    1
0  161   57
1   19  199
better model found
persisted
after epoch: 7,now: 2024-07-29 05:36:04.997165,epoch time: 0:01:46.777517,used: 0:12:21.770421,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.9777495, 'recall': 0.9772284, 'specificity': 0.9772284, 'f1': 0.97697043, 'auroc': 0.99926186, 'binary_precision': 1.0, 'binary_recall': 0.95445675, 'binary_specificity': 1.0, 'binary_f1_score': 0.97669774}
confusion matrix:
      0     1
0  1503     0
1    70  1467
---- Validation: 
scalar performance:
{'acc': 0.52436197, 'precision': 0.6935055, 'recall': 0.50888413, 'specificity': 0.50888413, 'f1': 0.36218315, 'auroc': 0.888795, 'binary_precision': 0.8666667, 'binary_recall': 0.020766772, 'binary_specificity': 0.9970015, 'binary_f1_score': 0.04056162}
confusion matrix:
     0   1
0  665   2
1  613  13
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977064, 'precision': 0.24942529, 'recall': 0.4977064, 'specificity': 0.4977064, 'f1': 0.3323124, 'auroc': 0.8844952, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  217  1
1  218  0
early stop counter: 1
val acc:0.5243619680404663, best validation acc: 0.8383604288101196, corresponding to test acc:                         0.8256880640983582 / 0.8463302850723267
after epoch: 8,now: 2024-07-29 05:37:57.965236,epoch time: 0:01:52.968071,used: 0:14:14.738492,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.98430616, 'recall': 0.984333, 'specificity': 0.984333, 'f1': 0.9842105, 'auroc': 0.9984944, 'binary_precision': 0.9946879, 'binary_recall': 0.97399217, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.98423123}
confusion matrix:
      0     1
0  1494     8
1    40  1498
---- Validation: 
scalar performance:
{'acc': 0.73704565, 'precision': 0.80270284, 'recall': 0.72946554, 'specificity': 0.72946554, 'f1': 0.7176363, 'auroc': 0.91038334, 'binary_precision': 0.9359756, 'binary_recall': 0.49041533, 'binary_specificity': 0.96851575, 'binary_f1_score': 0.6436059}
confusion matrix:
     0    1
0  646   21
1  319  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6284404, 'precision': 0.77056736, 'recall': 0.6284404, 'specificity': 0.6284404, 'f1': 0.57226944, 'auroc': 0.91242313, 'binary_precision': 0.96666664, 'binary_recall': 0.26605505, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.4172662}
confusion matrix:
     0   1
0  216   2
1  160  58
early stop counter: 2
val acc:0.7370456457138062, best validation acc: 0.8383604288101196, corresponding to test acc:                         0.8256880640983582 / 0.8463302850723267
after epoch: 9,now: 2024-07-29 05:39:48.743686,epoch time: 0:01:50.778450,used: 0:16:05.516942,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.99053526, 'recall': 0.990566, 'specificity': 0.990566, 'f1': 0.9904605, 'auroc': 0.9996896, 'binary_precision': 1.0, 'binary_recall': 0.9811321, 'binary_specificity': 1.0, 'binary_f1_score': 0.99047625}
confusion matrix:
      0     1
0  1503     0
1    29  1508
---- Validation: 
scalar performance:
{'acc': 0.6952823, 'precision': 0.7800815, 'recall': 0.68628544, 'specificity': 0.68628544, 'f1': 0.6639174, 'auroc': 0.90891755, 'binary_precision': 0.9264706, 'binary_recall': 0.4025559, 'binary_specificity': 0.970015, 'binary_f1_score': 0.5612472}
confusion matrix:
     0    1
0  647   20
1  374  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6284404, 'precision': 0.72309947, 'recall': 0.6284404, 'specificity': 0.6284404, 'f1': 0.5843514, 'auroc': 0.87595737, 'binary_precision': 0.8684211, 'binary_recall': 0.3027523, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.44897962}
confusion matrix:
     0   1
0  208  10
1  152  66
early stop counter: 3
val acc:0.6952822804450989, best validation acc: 0.8383604288101196, corresponding to test acc:                         0.8256880640983582 / 0.8463302850723267
after epoch: 10,now: 2024-07-29 05:41:35.832583,epoch time: 0:01:47.088897,used: 0:17:52.605839,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.9779427, 'recall': 0.97755265, 'specificity': 0.97755265, 'f1': 0.9773005, 'auroc': 0.99946666, 'binary_precision': 0.9986422, 'binary_recall': 0.95643693, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.97708404}
confusion matrix:
      0     1
0  1500     2
1    67  1471
---- Validation: 
scalar performance:
{'acc': 0.6187162, 'precision': 0.7068478, 'recall': 0.60785025, 'specificity': 0.60785025, 'f1': 0.56123483, 'auroc': 0.8920708, 'binary_precision': 0.8341709, 'binary_recall': 0.26517573, 'binary_specificity': 0.95052475, 'binary_f1_score': 0.40242425}
confusion matrix:
     0    1
0  634   33
1  460  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6766055, 'precision': 0.7813139, 'recall': 0.67660546, 'specificity': 0.67660546, 'f1': 0.64342517, 'auroc': 0.9009763, 'binary_precision': 0.9529412, 'binary_recall': 0.37155962, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.5346534}
confusion matrix:
     0   1
0  214   4
1  137  81
early stop counter: 4
val acc:0.6187161803245544, best validation acc: 0.8383604288101196, corresponding to test acc:                         0.8256880640983582 / 0.8463302850723267
after epoch: 11,now: 2024-07-29 05:43:24.824651,epoch time: 0:01:48.992068,used: 0:19:41.597907,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98092103, 'precision': 0.9812943, 'recall': 0.98112094, 'specificity': 0.98112094, 'f1': 0.98092055, 'auroc': 0.99900746, 'binary_precision': 0.99798113, 'binary_recall': 0.9642393, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.9808201}
confusion matrix:
      0     1
0  1499     3
1    55  1483
---- Validation: 
scalar performance:
{'acc': 0.7741686, 'precision': 0.8303106, 'recall': 0.7675096, 'specificity': 0.7675096, 'f1': 0.7610465, 'auroc': 0.92635465, 'binary_precision': 0.9587912, 'binary_recall': 0.557508, 'binary_specificity': 0.9775112, 'binary_f1_score': 0.70505047}
confusion matrix:
     0    1
0  652   15
1  277  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7775229, 'precision': 0.8392669, 'recall': 0.7775229, 'specificity': 0.7775229, 'f1': 0.7669182, 'auroc': 0.92693686, 'binary_precision': 0.984, 'binary_recall': 0.5642202, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.71720123}
confusion matrix:
     0    1
0  216    2
1   95  123
early stop counter: 5
val acc:0.7741686105728149, best validation acc: 0.8383604288101196, corresponding to test acc:                         0.8256880640983582 / 0.8463302850723267
after epoch: 12,now: 2024-07-29 05:45:13.737101,epoch time: 0:01:48.912450,used: 0:21:30.510357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_23_43_seed_8_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:21:30.510357 at 2024-07-29 05:45:13.737101
persisted model performance metric: 

scalar performance:
{'acc': 0.82568806, 'precision': 0.8358941, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.82435393, 'auroc': 0.9314451, 'binary_precision': 0.77734375, 'binary_recall': 0.91284406, 'binary_specificity': 0.7385321, 'binary_f1_score': 0.8396625}
confusion matrix:
     0    1
0  161   57
1   19  199
oracle model performance metric: 

scalar performance:
{'acc': 0.8463303, 'precision': 0.87575054, 'recall': 0.8463303, 'specificity': 0.8463303, 'f1': 0.8432622, 'auroc': 0.92347026, 'binary_precision': 0.9808917, 'binary_recall': 0.70642203, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.8213333}
confusion matrix:
     0    1
0  215    3
1   64  154
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454062 KiB |   2004 MiB | 236853 GiB | 236853 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 233809 GiB | 233808 GiB |
|       from small pool |  40595 KiB |     60 MiB |   3044 GiB |   3044 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454062 KiB |   2004 MiB | 236853 GiB | 236853 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 233809 GiB | 233808 GiB |
|       from small pool |  40595 KiB |     60 MiB |   3044 GiB |   3044 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 236539 GiB | 236539 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 233501 GiB | 233501 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3038 GiB |   3038 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |   2290 MiB |  14062 MiB |  11784 MiB |
|       from large pool |   2214 MiB |   2226 MiB |  13846 MiB |  11632 MiB |
|       from small pool |     64 MiB |     70 MiB |    216 MiB |    152 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 408145 KiB | 489230 KiB | 185807 GiB | 185807 GiB |
|       from large pool | 401637 KiB | 476433 KiB | 182604 GiB | 182603 GiB |
|       from small pool |   6508 KiB |  22276 KiB |   3203 GiB |   3203 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   45312 K  |   45311 K  |
|       from large pool |     187    |     311    |   21747 K  |   21747 K  |
|       from small pool |    1117    |    1419    |   23565 K  |   23563 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   45312 K  |   45311 K  |
|       from large pool |     187    |     311    |   21747 K  |   21747 K  |
|       from small pool |    1117    |    1419    |   23565 K  |   23563 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     127    |     668    |     543    |
|       from large pool |      93    |      93    |     560    |     467    |
|       from small pool |      32    |      35    |     108    |      76    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |     261    |   23872 K  |   23872 K  |
|       from large pool |      37    |      96    |   14512 K  |   14512 K  |
|       from small pool |      37    |     223    |    9359 K  |    9359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 236853 GiB | 236853 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 233809 GiB | 233809 GiB |
|       from small pool |      0 KiB |     60 MiB |   3044 GiB |   3044 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 236853 GiB | 236853 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 233809 GiB | 233809 GiB |
|       from small pool |      0 KiB |     60 MiB |   3044 GiB |   3044 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 236539 GiB | 236539 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 233501 GiB | 233501 GiB |
|       from small pool |      0 KiB |     60 MiB |   3038 GiB |   3038 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2290 MiB |  14062 MiB |  13220 MiB |
|       from large pool |    796 MiB |   2226 MiB |  13846 MiB |  13050 MiB |
|       from small pool |     46 MiB |     70 MiB |    216 MiB |    170 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 185807 GiB | 185807 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 182604 GiB | 182604 GiB |
|       from small pool |      0 KiB |  22276 KiB |   3203 GiB |   3203 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   45312 K  |   45312 K  |
|       from large pool |       2    |     311    |   21747 K  |   21747 K  |
|       from small pool |       0    |    1419    |   23565 K  |   23565 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   45312 K  |   45312 K  |
|       from large pool |       2    |     311    |   21747 K  |   21747 K  |
|       from small pool |       0    |    1419    |   23565 K  |   23565 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     668    |     610    |
|       from large pool |      35    |      93    |     560    |     525    |
|       from small pool |      23    |      35    |     108    |      85    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   23872 K  |   23872 K  |
|       from large pool |       4    |      96    |   14512 K  |   14512 K  |
|       from small pool |       0    |     223    |    9360 K  |    9360 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 236853 GiB | 236853 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 233809 GiB | 233809 GiB |
|       from small pool |      0 KiB |     60 MiB |   3044 GiB |   3044 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 236853 GiB | 236853 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 233809 GiB | 233809 GiB |
|       from small pool |      0 KiB |     60 MiB |   3044 GiB |   3044 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 236539 GiB | 236539 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 233501 GiB | 233501 GiB |
|       from small pool |      0 KiB |     60 MiB |   3038 GiB |   3038 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2290 MiB |  14062 MiB |  13220 MiB |
|       from large pool |    796 MiB |   2226 MiB |  13846 MiB |  13050 MiB |
|       from small pool |     46 MiB |     70 MiB |    216 MiB |    170 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 185807 GiB | 185807 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 182604 GiB | 182604 GiB |
|       from small pool |      0 KiB |  22276 KiB |   3203 GiB |   3203 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   45312 K  |   45312 K  |
|       from large pool |       2    |     311    |   21747 K  |   21747 K  |
|       from small pool |       0    |    1419    |   23565 K  |   23565 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   45312 K  |   45312 K  |
|       from large pool |       2    |     311    |   21747 K  |   21747 K  |
|       from small pool |       0    |    1419    |   23565 K  |   23565 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     668    |     610    |
|       from large pool |      35    |      93    |     560    |     525    |
|       from small pool |      23    |      35    |     108    |      85    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   23872 K  |   23872 K  |
|       from large pool |       4    |      96    |   14512 K  |   14512 K  |
|       from small pool |       0    |     223    |    9360 K  |    9360 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370

 Experiment start at: 2024-07-29 05:45:56.952714
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95386124, 'precision': 0.9546505, 'recall': 0.95371985, 'specificity': 0.95371985, 'f1': 0.9538288, 'auroc': 0.99358535, 'binary_precision': 0.9374218, 'binary_recall': 0.97335935, 'binary_specificity': 0.9340804, 'binary_f1_score': 0.9550526}
confusion matrix:
      0     1
0  1417   100
1    41  1498
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.7861004, 'precision': 0.79734504, 'recall': 0.78510976, 'specificity': 0.78510976, 'f1': 0.7836435, 'auroc': 0.87917864, 'binary_precision': 0.85271317, 'binary_recall': 0.6864275, 'binary_specificity': 0.88379204, 'binary_f1_score': 0.7605877}
confusion matrix:
     0    1
0  578   76
1  201  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82608694, 'precision': 0.83427644, 'recall': 0.826087, 'specificity': 0.826087, 'f1': 0.82501525, 'auroc': 0.88948965, 'binary_precision': 0.88659793, 'binary_recall': 0.7478261, 'binary_specificity': 0.90434784, 'binary_f1_score': 0.8113208}
confusion matrix:
     0    1
0  208   22
1   58  172
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 05:47:47.114077,epoch time: 0:01:50.161363,used: 0:01:50.161363,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93586385, 'precision': 0.9427904, 'recall': 0.93632233, 'specificity': 0.93632233, 'f1': 0.93565524, 'auroc': 0.9974882, 'binary_precision': 1.0, 'binary_recall': 0.8726446, 'binary_specificity': 1.0, 'binary_f1_score': 0.93199164}
confusion matrix:
      0     1
0  1517     0
1   196  1343
---- Validation: 
scalar performance:
{'acc': 0.6054054, 'precision': 0.7664061, 'recall': 0.60146606, 'specificity': 0.60146606, 'f1': 0.53093314, 'auroc': 0.9114438, 'binary_precision': 0.9710145, 'binary_recall': 0.20904836, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.3440308}
confusion matrix:
     0    1
0  650    4
1  507  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6652174, 'precision': 0.76698434, 'recall': 0.6652174, 'specificity': 0.6652174, 'f1': 0.6299547, 'auroc': 0.8686768, 'binary_precision': 0.9318182, 'binary_recall': 0.35652173, 'binary_specificity': 0.973913, 'binary_f1_score': 0.5157233}
confusion matrix:
     0   1
0  224   6
1  148  82
early stop counter: 1
val acc:0.6054053902626038, best validation acc: 0.7861003875732422, corresponding to test acc:                         0.8260869383811951 / 0.8260869383811951
after epoch: 2,now: 2024-07-29 05:49:32.573411,epoch time: 0:01:45.459334,used: 0:03:35.620697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.97191286, 'recall': 0.9710568, 'specificity': 0.9710568, 'f1': 0.9708675, 'auroc': 0.99871457, 'binary_precision': 0.99589604, 'binary_recall': 0.9460689, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.97034323}
confusion matrix:
      0     1
0  1511     6
1    83  1456
---- Validation: 
scalar performance:
{'acc': 0.7042471, 'precision': 0.7884377, 'recall': 0.7015116, 'specificity': 0.7015116, 'f1': 0.6791778, 'auroc': 0.9073719, 'binary_precision': 0.9417808, 'binary_recall': 0.42901716, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.58949625}
confusion matrix:
     0    1
0  637   17
1  366  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67608696, 'precision': 0.79223526, 'recall': 0.67608696, 'specificity': 0.67608696, 'f1': 0.64035153, 'auroc': 0.8895085, 'binary_precision': 0.9764706, 'binary_recall': 0.36086956, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.52698416}
confusion matrix:
     0   1
0  228   2
1  147  83
early stop counter: 2
val acc:0.7042471170425415, best validation acc: 0.7861003875732422, corresponding to test acc:                         0.8260869383811951 / 0.8260869383811951
after epoch: 3,now: 2024-07-29 05:51:18.468416,epoch time: 0:01:45.895005,used: 0:05:21.515702,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.9722227, 'recall': 0.97197026, 'specificity': 0.97197026, 'f1': 0.9718566, 'auroc': 0.9948622, 'binary_precision': 0.9872569, 'binary_recall': 0.95646524, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.97161716}
confusion matrix:
      0     1
0  1498    19
1    67  1472
---- Validation: 
scalar performance:
{'acc': 0.76447874, 'precision': 0.81736946, 'recall': 0.7624161, 'specificity': 0.7624161, 'f1': 0.7532716, 'auroc': 0.90098614, 'binary_precision': 0.9444444, 'binary_recall': 0.5569423, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.700687}
confusion matrix:
     0    1
0  633   21
1  284  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6869565, 'precision': 0.80748665, 'recall': 0.6869565, 'specificity': 0.6869565, 'f1': 0.6529466, 'auroc': 0.889811, 'binary_precision': 1.0, 'binary_recall': 0.37391305, 'binary_specificity': 1.0, 'binary_f1_score': 0.5443038}
confusion matrix:
     0   1
0  230   0
1  144  86
early stop counter: 3
val acc:0.7644787430763245, best validation acc: 0.7861003875732422, corresponding to test acc:                         0.8260869383811951 / 0.8260869383811951
after epoch: 4,now: 2024-07-29 05:53:07.630696,epoch time: 0:01:49.162280,used: 0:07:10.677982,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9759046, 'recall': 0.9757415, 'specificity': 0.9757415, 'f1': 0.9757812, 'auroc': 0.99784386, 'binary_precision': 0.96983314, 'binary_recall': 0.98244476, 'binary_specificity': 0.9690382, 'binary_f1_score': 0.97609824}
confusion matrix:
      0     1
0  1471    47
1    27  1511
---- Validation: 
scalar performance:
{'acc': 0.83088803, 'precision': 0.8313471, 'recall': 0.83069265, 'specificity': 0.83069265, 'f1': 0.83075726, 'auroc': 0.89553785, 'binary_precision': 0.8414239, 'binary_recall': 0.81123245, 'binary_specificity': 0.8501529, 'binary_f1_score': 0.8260524}
confusion matrix:
     0    1
0  556   98
1  121  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.8284161, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.8282406, 'auroc': 0.90892255, 'binary_precision': 0.8212766, 'binary_recall': 0.83913046, 'binary_specificity': 0.8173913, 'binary_f1_score': 0.8301075}
confusion matrix:
     0    1
0  188   42
1   37  193
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 05:54:50.981422,epoch time: 0:01:43.350726,used: 0:08:54.028708,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9851438, 'recall': 0.9850241, 'specificity': 0.9850241, 'f1': 0.9849472, 'auroc': 0.99875355, 'binary_precision': 0.9966711, 'binary_recall': 0.973342, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9848684}
confusion matrix:
      0     1
0  1513     5
1    41  1497
---- Validation: 
scalar performance:
{'acc': 0.56293434, 'precision': 0.73877007, 'recall': 0.55857986, 'specificity': 0.55857986, 'f1': 0.4583688, 'auroc': 0.9065507, 'binary_precision': 0.9411765, 'binary_recall': 0.12480499, 'binary_specificity': 0.99235475, 'binary_f1_score': 0.22038567}
confusion matrix:
     0   1
0  649   5
1  561  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5543478, 'precision': 0.70403093, 'recall': 0.5543478, 'specificity': 0.5543478, 'f1': 0.45425394, 'auroc': 0.9054017, 'binary_precision': 0.8787879, 'binary_recall': 0.12608695, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.22053231}
confusion matrix:
     0   1
0  226   4
1  201  29
early stop counter: 1
val acc:0.5629343390464783, best validation acc: 0.830888032913208, corresponding to test acc:                         0.8282608985900879 / 0.8282608985900879
after epoch: 6,now: 2024-07-29 05:56:42.037273,epoch time: 0:01:51.055851,used: 0:10:45.084559,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9797179, 'recall': 0.9792936, 'specificity': 0.9792936, 'f1': 0.97937715, 'auroc': 0.9985368, 'binary_precision': 0.9688889, 'binary_recall': 0.9909091, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.97977525}
confusion matrix:
      0     1
0  1467    49
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.83706564, 'precision': 0.84684306, 'recall': 0.83621967, 'specificity': 0.83621967, 'f1': 0.8356545, 'auroc': 0.90300417, 'binary_precision': 0.90262175, 'binary_recall': 0.7519501, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.82042557}
confusion matrix:
     0    1
0  602   52
1  159  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82391304, 'precision': 0.84066284, 'recall': 0.82391304, 'specificity': 0.82391304, 'f1': 0.8217217, 'auroc': 0.90850663, 'binary_precision': 0.9162011, 'binary_recall': 0.71304345, 'binary_specificity': 0.9347826, 'binary_f1_score': 0.801956}
confusion matrix:
     0    1
0  215   15
1   66  164
better model found
persisted
after epoch: 7,now: 2024-07-29 05:58:33.042627,epoch time: 0:01:51.005354,used: 0:12:36.089913,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.972924, 'recall': 0.9717118, 'specificity': 0.9717118, 'f1': 0.9718353, 'auroc': 0.9985399, 'binary_precision': 0.9520548, 'binary_recall': 0.99414825, 'binary_specificity': 0.9492754, 'binary_f1_score': 0.97264636}
confusion matrix:
      0     1
0  1441    77
1     9  1529
---- Validation: 
scalar performance:
{'acc': 0.8903475, 'precision': 0.8939877, 'recall': 0.88987124, 'specificity': 0.88987124, 'f1': 0.88999796, 'auroc': 0.94376147, 'binary_precision': 0.92943203, 'binary_recall': 0.8424337, 'binary_specificity': 0.93730885, 'binary_f1_score': 0.88379705}
confusion matrix:
     0    1
0  613   41
1  101  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8695652, 'precision': 0.8836041, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.8683609, 'auroc': 0.92408323, 'binary_precision': 0.9569892, 'binary_recall': 0.773913, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.8557693}
confusion matrix:
     0    1
0  222    8
1   52  178
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-29 06:00:18.261068,epoch time: 0:01:45.218441,used: 0:14:21.308354,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99022144, 'recall': 0.99022985, 'specificity': 0.99022985, 'f1': 0.99018323, 'auroc': 0.9995759, 'binary_precision': 0.99670833, 'binary_recall': 0.9837557, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9901897}
confusion matrix:
      0     1
0  1512     5
1    25  1514
---- Validation: 
scalar performance:
{'acc': 0.8525097, 'precision': 0.8643985, 'recall': 0.85160327, 'specificity': 0.85160327, 'f1': 0.8510545, 'auroc': 0.92770046, 'binary_precision': 0.92775667, 'binary_recall': 0.76131046, 'binary_specificity': 0.941896, 'binary_f1_score': 0.8363325}
confusion matrix:
     0    1
0  616   38
1  153  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8652174, 'precision': 0.87660813, 'recall': 0.8652174, 'specificity': 0.8652174, 'f1': 0.86419046, 'auroc': 0.93224955, 'binary_precision': 0.94210523, 'binary_recall': 0.7782609, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.85238093}
confusion matrix:
     0    1
0  219   11
1   51  179
early stop counter: 1
val acc:0.8525096774101257, best validation acc: 0.8903474807739258, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 9,now: 2024-07-29 06:01:54.427261,epoch time: 0:01:36.166193,used: 0:15:57.474547,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9852804, 'recall': 0.9853047, 'specificity': 0.9853047, 'f1': 0.98527473, 'auroc': 0.99883413, 'binary_precision': 0.98951507, 'binary_recall': 0.9811566, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9853181}
confusion matrix:
      0     1
0  1501    16
1    29  1510
---- Validation: 
scalar performance:
{'acc': 0.7776062, 'precision': 0.81822693, 'recall': 0.77580065, 'specificity': 0.77580065, 'f1': 0.76948977, 'auroc': 0.92775285, 'binary_precision': 0.9294404, 'binary_recall': 0.5959438, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7262357}
confusion matrix:
     0    1
0  625   29
1  259  382
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6717391, 'precision': 0.7661803, 'recall': 0.6717391, 'specificity': 0.6717391, 'f1': 0.63978815, 'auroc': 0.89538753, 'binary_precision': 0.9247312, 'binary_recall': 0.37391305, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.5325077}
confusion matrix:
     0   1
0  223   7
1  144  86
early stop counter: 2
val acc:0.777606189250946, best validation acc: 0.8903474807739258, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 10,now: 2024-07-29 06:03:31.597575,epoch time: 0:01:37.170314,used: 0:17:34.644861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.981146, 'recall': 0.9809729, 'specificity': 0.9809729, 'f1': 0.98101735, 'auroc': 0.99856985, 'binary_precision': 0.974984, 'binary_recall': 0.9876543, 'binary_specificity': 0.9742914, 'binary_f1_score': 0.9812782}
confusion matrix:
      0     1
0  1478    39
1    19  1520
---- Validation: 
scalar performance:
{'acc': 0.86795366, 'precision': 0.86804444, 'recall': 0.86787057, 'specificity': 0.86787057, 'f1': 0.8679156, 'auroc': 0.9382893, 'binary_precision': 0.8718355, 'binary_recall': 0.8595944, 'binary_specificity': 0.8761468, 'binary_f1_score': 0.8656717}
confusion matrix:
     0    1
0  573   81
1   90  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8608696, 'precision': 0.87212473, 'recall': 0.8608695, 'specificity': 0.8608695, 'f1': 0.8598095, 'auroc': 0.934121, 'binary_precision': 0.9368421, 'binary_recall': 0.773913, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.84761906}
confusion matrix:
     0    1
0  218   12
1   52  178
early stop counter: 3
val acc:0.8679536581039429, best validation acc: 0.8903474807739258, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 11,now: 2024-07-29 06:05:11.775759,epoch time: 0:01:40.178184,used: 0:19:14.823045,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9883479, 'recall': 0.9881722, 'specificity': 0.9881722, 'f1': 0.9882177, 'auroc': 0.9993528, 'binary_precision': 0.98203975, 'binary_recall': 0.9948018, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.9883796}
confusion matrix:
      0     1
0  1489    28
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.85405403, 'precision': 0.8611704, 'recall': 0.8533493, 'specificity': 0.8533493, 'f1': 0.853143, 'auroc': 0.9249238, 'binary_precision': 0.9094203, 'binary_recall': 0.7831513, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.8415759}
confusion matrix:
     0    1
0  604   50
1  139  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85, 'precision': 0.87648183, 'recall': 0.85, 'specificity': 0.85, 'f1': 0.847315, 'auroc': 0.92852557, 'binary_precision': 0.97633135, 'binary_recall': 0.7173913, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.8270676}
confusion matrix:
     0    1
0  226    4
1   65  165
early stop counter: 4
val acc:0.8540540337562561, best validation acc: 0.8903474807739258, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 12,now: 2024-07-29 06:06:46.304253,epoch time: 0:01:34.528494,used: 0:20:49.351539,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9871077, 'recall': 0.98698753, 'specificity': 0.98698753, 'f1': 0.98691064, 'auroc': 0.999648, 'binary_precision': 0.99866843, 'binary_recall': 0.97529256, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9868421}
confusion matrix:
      0     1
0  1516     2
1    38  1500
---- Validation: 
scalar performance:
{'acc': 0.7250965, 'precision': 0.79368746, 'recall': 0.72265, 'specificity': 0.72265, 'f1': 0.7066183, 'auroc': 0.90099263, 'binary_precision': 0.9331307, 'binary_recall': 0.47893915, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.6329897}
confusion matrix:
     0    1
0  632   22
1  334  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74347824, 'precision': 0.7852334, 'recall': 0.7434783, 'specificity': 0.7434783, 'f1': 0.73373365, 'auroc': 0.8761059, 'binary_precision': 0.8943662, 'binary_recall': 0.5521739, 'binary_specificity': 0.9347826, 'binary_f1_score': 0.6827957}
confusion matrix:
     0    1
0  215   15
1  103  127
early stop counter: 5
val acc:0.7250965237617493, best validation acc: 0.8903474807739258, corresponding to test acc:                         0.8695651888847351 / 0.8695651888847351
after epoch: 13,now: 2024-07-29 06:08:36.323461,epoch time: 0:01:50.019208,used: 0:22:39.370747,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_45_56_seed_9_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:22:39.370747 at 2024-07-29 06:08:36.323461
persisted model performance metric: 

scalar performance:
{'acc': 0.8695652, 'precision': 0.8836041, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.8683609, 'auroc': 0.92408323, 'binary_precision': 0.9569892, 'binary_recall': 0.773913, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.8557693}
confusion matrix:
     0    1
0  222    8
1   52  178
oracle model performance metric: 

scalar performance:
{'acc': 0.8695652, 'precision': 0.8836041, 'recall': 0.86956525, 'specificity': 0.86956525, 'f1': 0.8683609, 'auroc': 0.92408323, 'binary_precision': 0.9569892, 'binary_recall': 0.773913, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.8557693}
confusion matrix:
     0    1
0  222    8
1   52  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454065 KiB |   2004 MiB | 265036 GiB | 265036 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 261630 GiB | 261630 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3406 GiB |   3406 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454065 KiB |   2004 MiB | 265036 GiB | 265036 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 261630 GiB | 261630 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3406 GiB |   3406 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 264709 GiB | 264709 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 261310 GiB | 261309 GiB |
|       from small pool |  40407 KiB |     60 MiB |   3399 GiB |   3399 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  15496 MiB |  13220 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  15262 MiB |  13050 MiB |
|       from small pool |     64 MiB |     70 MiB |    234 MiB |    170 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387662 KiB | 489230 KiB | 207907 GiB | 207907 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 204323 GiB | 204323 GiB |
|       from small pool |   6505 KiB |  22276 KiB |   3583 GiB |   3583 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   50706 K  |   50705 K  |
|       from large pool |     187    |     311    |   24336 K  |   24336 K  |
|       from small pool |    1123    |    1419    |   26369 K  |   26368 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   50706 K  |   50705 K  |
|       from large pool |     187    |     311    |   24336 K  |   24336 K  |
|       from small pool |    1123    |    1419    |   26369 K  |   26368 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     734    |     610    |
|       from large pool |      92    |      93    |     617    |     525    |
|       from small pool |      32    |      35    |     117    |      85    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     261    |   26857 K  |   26856 K  |
|       from large pool |      35    |      96    |   16405 K  |   16405 K  |
|       from small pool |      37    |     223    |   10451 K  |   10451 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 265036 GiB | 265036 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 261630 GiB | 261630 GiB |
|       from small pool |      0 KiB |     60 MiB |   3406 GiB |   3406 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 265036 GiB | 265036 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 261630 GiB | 261630 GiB |
|       from small pool |      0 KiB |     60 MiB |   3406 GiB |   3406 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 264709 GiB | 264709 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 261310 GiB | 261310 GiB |
|       from small pool |      0 KiB |     60 MiB |   3399 GiB |   3399 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  15496 MiB |  14674 MiB |
|       from large pool |    776 MiB |   2226 MiB |  15262 MiB |  14486 MiB |
|       from small pool |     46 MiB |     70 MiB |    234 MiB |    188 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 207907 GiB | 207907 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 204323 GiB | 204323 GiB |
|       from small pool |      0 KiB |  22276 KiB |   3583 GiB |   3583 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   50706 K  |   50706 K  |
|       from large pool |       2    |     311    |   24336 K  |   24336 K  |
|       from small pool |       0    |    1419    |   26369 K  |   26369 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   50706 K  |   50706 K  |
|       from large pool |       2    |     311    |   24336 K  |   24336 K  |
|       from small pool |       0    |    1419    |   26369 K  |   26369 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     734    |     677    |
|       from large pool |      34    |      93    |     617    |     583    |
|       from small pool |      23    |      35    |     117    |      94    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   26857 K  |   26857 K  |
|       from large pool |       4    |      96    |   16405 K  |   16405 K  |
|       from small pool |       0    |     223    |   10452 K  |   10452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 265036 GiB | 265036 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 261630 GiB | 261630 GiB |
|       from small pool |      0 KiB |     60 MiB |   3406 GiB |   3406 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 265036 GiB | 265036 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 261630 GiB | 261630 GiB |
|       from small pool |      0 KiB |     60 MiB |   3406 GiB |   3406 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 264709 GiB | 264709 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 261310 GiB | 261310 GiB |
|       from small pool |      0 KiB |     60 MiB |   3399 GiB |   3399 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  15496 MiB |  14674 MiB |
|       from large pool |    776 MiB |   2226 MiB |  15262 MiB |  14486 MiB |
|       from small pool |     46 MiB |     70 MiB |    234 MiB |    188 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 207907 GiB | 207907 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 204323 GiB | 204323 GiB |
|       from small pool |      0 KiB |  22276 KiB |   3583 GiB |   3583 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   50706 K  |   50706 K  |
|       from large pool |       2    |     311    |   24336 K  |   24336 K  |
|       from small pool |       0    |    1419    |   26369 K  |   26369 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   50706 K  |   50706 K  |
|       from large pool |       2    |     311    |   24336 K  |   24336 K  |
|       from small pool |       0    |    1419    |   26369 K  |   26369 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     734    |     677    |
|       from large pool |      34    |      93    |     617    |     583    |
|       from small pool |      23    |      35    |     117    |      94    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   26857 K  |   26857 K  |
|       from large pool |       4    |      96    |   16405 K  |   16405 K  |
|       from small pool |       0    |     223    |   10452 K  |   10452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370

 Experiment start at: 2024-07-29 06:09:18.925832
before training, model accuracy: 0.5113122463226318
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.9556776, 'recall': 0.9535344, 'specificity': 0.9535344, 'f1': 0.9536401, 'auroc': 0.99514234, 'binary_precision': 0.9269802, 'binary_recall': 0.9855263, 'binary_specificity': 0.9215425, 'binary_f1_score': 0.9553571}
confusion matrix:
      0     1
0  1386   118
1    22  1498
---- Validation: 
scalar performance:
{'acc': 0.78159124, 'precision': 0.80984485, 'recall': 0.787786, 'specificity': 0.787786, 'f1': 0.77872133, 'auroc': 0.9075635, 'binary_precision': 0.7051597, 'binary_recall': 0.93485343, 'binary_specificity': 0.6407186, 'binary_f1_score': 0.8039216}
confusion matrix:
     0    1
0  428  240
1   40  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7760181, 'precision': 0.8039547, 'recall': 0.77601814, 'specificity': 0.77601814, 'f1': 0.7707505, 'auroc': 0.9132901, 'binary_precision': 0.7118056, 'binary_recall': 0.9276018, 'binary_specificity': 0.6244344, 'binary_f1_score': 0.805501}
confusion matrix:
     0    1
0  138   83
1   16  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:11:10.537074,epoch time: 0:01:51.611242,used: 0:01:51.611242,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96395504, 'precision': 0.9660428, 'recall': 0.96413773, 'specificity': 0.96413773, 'f1': 0.9639238, 'auroc': 0.9968846, 'binary_precision': 0.9985866, 'binary_recall': 0.92960525, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.96286196}
confusion matrix:
      0     1
0  1502     2
1   107  1413
---- Validation: 
scalar performance:
{'acc': 0.6918877, 'precision': 0.7781055, 'recall': 0.6796553, 'specificity': 0.6796553, 'f1': 0.65697384, 'auroc': 0.87808, 'binary_precision': 0.9227799, 'binary_recall': 0.38925081, 'binary_specificity': 0.9700599, 'binary_f1_score': 0.5475372}
confusion matrix:
     0    1
0  648   20
1  375  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5723982, 'precision': 0.6542758, 'recall': 0.5723982, 'specificity': 0.5723982, 'f1': 0.50698465, 'auroc': 0.8391106, 'binary_precision': 0.76666665, 'binary_recall': 0.2081448, 'binary_specificity': 0.9366516, 'binary_f1_score': 0.32740214}
confusion matrix:
     0   1
0  207  14
1  175  46
early stop counter: 1
val acc:0.6918876767158508, best validation acc: 0.7815912365913391, corresponding to test acc:                         0.7760180830955505 / 0.7760180830955505
after epoch: 2,now: 2024-07-29 06:12:51.266990,epoch time: 0:01:40.729916,used: 0:03:32.341158,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9563492, 'precision': 0.95965767, 'recall': 0.95657897, 'specificity': 0.95657897, 'f1': 0.9562849, 'auroc': 0.9987411, 'binary_precision': 1.0, 'binary_recall': 0.9131579, 'binary_specificity': 1.0, 'binary_f1_score': 0.95460796}
confusion matrix:
      0     1
0  1504     0
1   132  1388
---- Validation: 
scalar performance:
{'acc': 0.6193448, 'precision': 0.77088463, 'recall': 0.602935, 'specificity': 0.602935, 'f1': 0.5401573, 'auroc': 0.9240477, 'binary_precision': 0.9632353, 'binary_recall': 0.21335505, 'binary_specificity': 0.99251497, 'binary_f1_score': 0.34933335}
confusion matrix:
     0    1
0  663    5
1  483  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51357466, 'precision': 0.7534404, 'recall': 0.51357466, 'specificity': 0.51357466, 'f1': 0.36280918, 'auroc': 0.9227493, 'binary_precision': 1.0, 'binary_recall': 0.027149322, 'binary_specificity': 1.0, 'binary_f1_score': 0.052863438}
confusion matrix:
     0  1
0  221  0
1  215  6
early stop counter: 2
val acc:0.6193447709083557, best validation acc: 0.7815912365913391, corresponding to test acc:                         0.7760180830955505 / 0.7760180830955505
after epoch: 3,now: 2024-07-29 06:14:31.752527,epoch time: 0:01:40.485537,used: 0:05:12.826695,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97354496, 'precision': 0.97424436, 'recall': 0.9736527, 'specificity': 0.9736527, 'f1': 0.9735388, 'auroc': 0.9974174, 'binary_precision': 0.99382716, 'binary_recall': 0.95328945, 'binary_specificity': 0.99401593, 'binary_f1_score': 0.9731363}
confusion matrix:
      0     1
0  1495     9
1    71  1449
---- Validation: 
scalar performance:
{'acc': 0.7090484, 'precision': 0.78146446, 'recall': 0.6978998, 'specificity': 0.6978998, 'f1': 0.6815055, 'auroc': 0.8928982, 'binary_precision': 0.9140893, 'binary_recall': 0.43322477, 'binary_specificity': 0.96257484, 'binary_f1_score': 0.5878453}
confusion matrix:
     0    1
0  643   25
1  348  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64253396, 'precision': 0.7840849, 'recall': 0.64253396, 'specificity': 0.64253396, 'f1': 0.5916692, 'auroc': 0.9118978, 'binary_precision': 0.9846154, 'binary_recall': 0.28959277, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.44755247}
confusion matrix:
     0   1
0  220   1
1  157  64
early stop counter: 3
val acc:0.7090483903884888, best validation acc: 0.7815912365913391, corresponding to test acc:                         0.7760180830955505 / 0.7760180830955505
after epoch: 4,now: 2024-07-29 06:16:15.731346,epoch time: 0:01:43.978819,used: 0:06:56.805514,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98280424, 'precision': 0.9828013, 'recall': 0.9828073, 'specificity': 0.9828073, 'f1': 0.9828038, 'auroc': 0.99820125, 'binary_precision': 0.98353094, 'binary_recall': 0.98223686, 'binary_specificity': 0.98337764, 'binary_f1_score': 0.98288345}
confusion matrix:
      0     1
0  1479    25
1    27  1493
---- Validation: 
scalar performance:
{'acc': 0.76365054, 'precision': 0.7919422, 'recall': 0.7567463, 'specificity': 0.7567463, 'f1': 0.7542294, 'auroc': 0.8565678, 'binary_precision': 0.8729017, 'binary_recall': 0.5928339, 'binary_specificity': 0.9206587, 'binary_f1_score': 0.70611054}
confusion matrix:
     0    1
0  615   53
1  250  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65837103, 'precision': 0.7230392, 'recall': 0.65837103, 'specificity': 0.65837103, 'f1': 0.63167274, 'auroc': 0.848488, 'binary_precision': 0.84313726, 'binary_recall': 0.38914028, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.5325077}
confusion matrix:
     0   1
0  205  16
1  135  86
early stop counter: 4
val acc:0.7636505365371704, best validation acc: 0.7815912365913391, corresponding to test acc:                         0.7760180830955505 / 0.7760180830955505
after epoch: 5,now: 2024-07-29 06:17:53.845314,epoch time: 0:01:38.113968,used: 0:08:34.919482,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9751984, 'precision': 0.9762989, 'recall': 0.975077, 'specificity': 0.975077, 'f1': 0.97517884, 'auroc': 0.9992975, 'binary_precision': 0.9546885, 'binary_recall': 0.9980263, 'binary_specificity': 0.95212764, 'binary_f1_score': 0.97587645}
confusion matrix:
      0     1
0  1432    72
1     3  1517
---- Validation: 
scalar performance:
{'acc': 0.8689548, 'precision': 0.8691415, 'recall': 0.8697751, 'specificity': 0.8697751, 'f1': 0.86891615, 'auroc': 0.93163025, 'binary_precision': 0.84520125, 'binary_recall': 0.8892508, 'binary_specificity': 0.8502994, 'binary_f1_score': 0.86666673}
confusion matrix:
     0    1
0  568  100
1   68  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.8620577, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.8619846, 'auroc': 0.92164373, 'binary_precision': 0.8669725, 'binary_recall': 0.8552036, 'binary_specificity': 0.8687783, 'binary_f1_score': 0.86104786}
confusion matrix:
     0    1
0  192   29
1   32  189
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-29 06:19:23.860853,epoch time: 0:01:30.015539,used: 0:10:04.935021,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9699074, 'precision': 0.9715286, 'recall': 0.9697578, 'specificity': 0.9697578, 'f1': 0.9698738, 'auroc': 0.9995849, 'binary_precision': 0.94517136, 'binary_recall': 0.9980263, 'binary_specificity': 0.94148934, 'binary_f1_score': 0.97088003}
confusion matrix:
      0     1
0  1416    88
1     3  1517
---- Validation: 
scalar performance:
{'acc': 0.7823713, 'precision': 0.8103696, 'recall': 0.7885345, 'specificity': 0.7885345, 'f1': 0.77955115, 'auroc': 0.8973551, 'binary_precision': 0.70602703, 'binary_recall': 0.93485343, 'binary_specificity': 0.64221555, 'binary_f1_score': 0.8044849}
confusion matrix:
     0    1
0  429  239
1   40  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986425, 'precision': 0.8140827, 'recall': 0.7986425, 'specificity': 0.7986425, 'f1': 0.7961371, 'auroc': 0.8973608, 'binary_precision': 0.74444443, 'binary_recall': 0.90950227, 'binary_specificity': 0.6877828, 'binary_f1_score': 0.81873727}
confusion matrix:
     0    1
0  152   69
1   20  201
early stop counter: 1
val acc:0.7823712825775146, best validation acc: 0.8689547777175903, corresponding to test acc:                         0.8619909286499023 / 0.8619909286499023
after epoch: 7,now: 2024-07-29 06:21:08.679736,epoch time: 0:01:44.818883,used: 0:11:49.753904,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9864418, 'precision': 0.9865005, 'recall': 0.98647815, 'specificity': 0.98647815, 'f1': 0.9864418, 'auroc': 0.99912465, 'binary_precision': 0.99332887, 'binary_recall': 0.97960526, 'binary_specificity': 0.99335104, 'binary_f1_score': 0.9864194}
confusion matrix:
      0     1
0  1494    10
1    31  1489
---- Validation: 
scalar performance:
{'acc': 0.7925117, 'precision': 0.8298112, 'recall': 0.7852308, 'specificity': 0.7852308, 'f1': 0.7833232, 'auroc': 0.92170954, 'binary_precision': 0.9306931, 'binary_recall': 0.6123778, 'binary_specificity': 0.9580838, 'binary_f1_score': 0.7387033}
confusion matrix:
     0    1
0  640   28
1  238  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.800905, 'precision': 0.83036983, 'recall': 0.800905, 'specificity': 0.800905, 'f1': 0.79636455, 'auroc': 0.90383077, 'binary_precision': 0.92903227, 'binary_recall': 0.65158373, 'binary_specificity': 0.95022625, 'binary_f1_score': 0.7659575}
confusion matrix:
     0    1
0  210   11
1   77  144
early stop counter: 2
val acc:0.7925117015838623, best validation acc: 0.8689547777175903, corresponding to test acc:                         0.8619909286499023 / 0.8619909286499023
after epoch: 8,now: 2024-07-29 06:22:41.997857,epoch time: 0:01:33.318121,used: 0:13:23.072025,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98743385, 'precision': 0.9875733, 'recall': 0.98739505, 'specificity': 0.98739505, 'f1': 0.9874319, 'auroc': 0.99970293, 'binary_precision': 0.98054475, 'binary_recall': 0.99473685, 'binary_specificity': 0.9800532, 'binary_f1_score': 0.98758984}
confusion matrix:
      0     1
0  1474    30
1     8  1512
---- Validation: 
scalar performance:
{'acc': 0.85725427, 'precision': 0.8643704, 'recall': 0.85426867, 'specificity': 0.85426867, 'f1': 0.85560524, 'auroc': 0.93022346, 'binary_precision': 0.905838, 'binary_recall': 0.7833876, 'binary_specificity': 0.9251497, 'binary_f1_score': 0.8401746}
confusion matrix:
     0    1
0  618   50
1  133  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8393665, 'precision': 0.86938405, 'recall': 0.83936656, 'specificity': 0.83936656, 'f1': 0.8360354, 'auroc': 0.92729473, 'binary_precision': 0.9746835, 'binary_recall': 0.6968326, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.81266487}
confusion matrix:
     0    1
0  217    4
1   67  154
early stop counter: 3
val acc:0.8572542667388916, best validation acc: 0.8689547777175903, corresponding to test acc:                         0.8619909286499023 / 0.8619909286499023
after epoch: 9,now: 2024-07-29 06:24:26.845242,epoch time: 0:01:44.847385,used: 0:15:07.919410,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9797124, 'recall': 0.97926235, 'specificity': 0.97926235, 'f1': 0.97916317, 'auroc': 0.99928784, 'binary_precision': 0.99726963, 'binary_recall': 0.9611842, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9788944}
confusion matrix:
      0     1
0  1500     4
1    59  1461
---- Validation: 
scalar performance:
{'acc': 0.7425897, 'precision': 0.8109261, 'recall': 0.73238945, 'specificity': 0.73238945, 'f1': 0.7218585, 'auroc': 0.93063307, 'binary_precision': 0.9465409, 'binary_recall': 0.49022803, 'binary_specificity': 0.9745509, 'binary_f1_score': 0.6459228}
confusion matrix:
     0    1
0  651   17
1  313  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5950226, 'precision': 0.77625, 'recall': 0.5950226, 'specificity': 0.5950226, 'f1': 0.51557344, 'auroc': 0.9224013, 'binary_precision': 1.0, 'binary_recall': 0.19004525, 'binary_specificity': 1.0, 'binary_f1_score': 0.31939164}
confusion matrix:
     0   1
0  221   0
1  179  42
early stop counter: 4
val acc:0.7425897121429443, best validation acc: 0.8689547777175903, corresponding to test acc:                         0.8619909286499023 / 0.8619909286499023
after epoch: 10,now: 2024-07-29 06:26:08.443885,epoch time: 0:01:41.598643,used: 0:16:49.518053,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99206346, 'precision': 0.9920678, 'recall': 0.9920808, 'specificity': 0.9920808, 'f1': 0.99206346, 'auroc': 0.9996623, 'binary_precision': 0.99536425, 'binary_recall': 0.9888158, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.99207926}
confusion matrix:
      0     1
0  1497     7
1    17  1503
---- Validation: 
scalar performance:
{'acc': 0.79719186, 'precision': 0.8297781, 'recall': 0.7903801, 'specificity': 0.7903801, 'f1': 0.78917456, 'auroc': 0.922419, 'binary_precision': 0.923445, 'binary_recall': 0.6286645, 'binary_specificity': 0.9520958, 'binary_f1_score': 0.748062}
confusion matrix:
     0    1
0  636   32
1  228  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6719457, 'precision': 0.77926314, 'recall': 0.6719457, 'specificity': 0.6719457, 'f1': 0.6370792, 'auroc': 0.91032124, 'binary_precision': 0.95238096, 'binary_recall': 0.36199096, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.52459013}
confusion matrix:
     0   1
0  217   4
1  141  80
early stop counter: 5
val acc:0.797191858291626, best validation acc: 0.8689547777175903, corresponding to test acc:                         0.8619909286499023 / 0.8619909286499023
after epoch: 11,now: 2024-07-29 06:27:53.987094,epoch time: 0:01:45.543209,used: 0:18:35.061262,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_18_seed_10_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:18:35.061262 at 2024-07-29 06:27:53.987094
persisted model performance metric: 

scalar performance:
{'acc': 0.8619909, 'precision': 0.8620577, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.8619846, 'auroc': 0.92164373, 'binary_precision': 0.8669725, 'binary_recall': 0.8552036, 'binary_specificity': 0.8687783, 'binary_f1_score': 0.86104786}
confusion matrix:
     0    1
0  192   29
1   32  189
oracle model performance metric: 

scalar performance:
{'acc': 0.8619909, 'precision': 0.8620577, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.8619846, 'auroc': 0.92164373, 'binary_precision': 0.8669725, 'binary_recall': 0.8552036, 'binary_specificity': 0.8687783, 'binary_f1_score': 0.86104786}
confusion matrix:
     0    1
0  192   29
1   32  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454062 KiB |   2004 MiB | 288639 GiB | 288638 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 284928 GiB | 284927 GiB |
|       from small pool |  40595 KiB |     60 MiB |   3711 GiB |   3711 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454062 KiB |   2004 MiB | 288639 GiB | 288638 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 284928 GiB | 284927 GiB |
|       from small pool |  40595 KiB |     60 MiB |   3711 GiB |   3711 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 288301 GiB | 288300 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 284597 GiB | 284597 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3703 GiB |   3703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  16950 MiB |  14674 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  16698 MiB |  14486 MiB |
|       from small pool |     64 MiB |     70 MiB |    252 MiB |    188 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387665 KiB | 489230 KiB | 226422 GiB | 226422 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 222518 GiB | 222517 GiB |
|       from small pool |   6508 KiB |  22276 KiB |   3904 GiB |   3904 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   55230 K  |   55228 K  |
|       from large pool |     187    |     311    |   26505 K  |   26505 K  |
|       from small pool |    1117    |    1419    |   28724 K  |   28723 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   55230 K  |   55228 K  |
|       from large pool |     187    |     311    |   26505 K  |   26505 K  |
|       from small pool |    1117    |    1419    |   28724 K  |   28723 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     801    |     677    |
|       from large pool |      92    |      93    |     675    |     583    |
|       from small pool |      32    |      35    |     126    |      94    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     261    |   29382 K  |   29382 K  |
|       from large pool |      35    |      96    |   17997 K  |   17997 K  |
|       from small pool |      38    |     223    |   11385 K  |   11385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 288639 GiB | 288639 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 284928 GiB | 284928 GiB |
|       from small pool |      0 KiB |     60 MiB |   3711 GiB |   3711 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 288639 GiB | 288639 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 284928 GiB | 284928 GiB |
|       from small pool |      0 KiB |     60 MiB |   3711 GiB |   3711 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 288301 GiB | 288301 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 284597 GiB | 284597 GiB |
|       from small pool |      0 KiB |     60 MiB |   3703 GiB |   3703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  16950 MiB |  16128 MiB |
|       from large pool |    776 MiB |   2226 MiB |  16698 MiB |  15922 MiB |
|       from small pool |     46 MiB |     70 MiB |    252 MiB |    206 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 226423 GiB | 226423 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 222518 GiB | 222518 GiB |
|       from small pool |      0 KiB |  22276 KiB |   3904 GiB |   3904 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   55230 K  |   55230 K  |
|       from large pool |       2    |     311    |   26505 K  |   26505 K  |
|       from small pool |       0    |    1419    |   28724 K  |   28724 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   55230 K  |   55230 K  |
|       from large pool |       2    |     311    |   26505 K  |   26505 K  |
|       from small pool |       0    |    1419    |   28724 K  |   28724 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     801    |     744    |
|       from large pool |      34    |      93    |     675    |     641    |
|       from small pool |      23    |      35    |     126    |     103    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   29382 K  |   29382 K  |
|       from large pool |       4    |      96    |   17997 K  |   17997 K  |
|       from small pool |       0    |     223    |   11385 K  |   11385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 288639 GiB | 288639 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 284928 GiB | 284928 GiB |
|       from small pool |      0 KiB |     60 MiB |   3711 GiB |   3711 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 288639 GiB | 288639 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 284928 GiB | 284928 GiB |
|       from small pool |      0 KiB |     60 MiB |   3711 GiB |   3711 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 288301 GiB | 288301 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 284597 GiB | 284597 GiB |
|       from small pool |      0 KiB |     60 MiB |   3703 GiB |   3703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  16950 MiB |  16128 MiB |
|       from large pool |    776 MiB |   2226 MiB |  16698 MiB |  15922 MiB |
|       from small pool |     46 MiB |     70 MiB |    252 MiB |    206 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 226423 GiB | 226423 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 222518 GiB | 222518 GiB |
|       from small pool |      0 KiB |  22276 KiB |   3904 GiB |   3904 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   55230 K  |   55230 K  |
|       from large pool |       2    |     311    |   26505 K  |   26505 K  |
|       from small pool |       0    |    1419    |   28724 K  |   28724 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   55230 K  |   55230 K  |
|       from large pool |       2    |     311    |   26505 K  |   26505 K  |
|       from small pool |       0    |    1419    |   28724 K  |   28724 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     801    |     744    |
|       from large pool |      34    |      93    |     675    |     641    |
|       from small pool |      23    |      35    |     126    |     103    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   29382 K  |   29382 K  |
|       from large pool |       4    |      96    |   17997 K  |   17997 K  |
|       from small pool |       0    |     223    |   11385 K  |   11385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370

 Experiment start at: 2024-07-29 06:28:44.763560
before training, model accuracy: 0.5371178984642029
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.96590644, 'recall': 0.96523094, 'specificity': 0.96523094, 'f1': 0.9646548, 'auroc': 0.9970659, 'binary_precision': 0.9952153, 'binary_recall': 0.93513167, 'binary_specificity': 0.9953302, 'binary_f1_score': 0.9642384}
confusion matrix:
      0     1
0  1492     7
1   101  1456
---- Validation: 
scalar performance:
{'acc': 0.8033794, 'precision': 0.8297293, 'recall': 0.7991734, 'specificity': 0.7991734, 'f1': 0.7977083, 'auroc': 0.8716394, 'binary_precision': 0.9159292, 'binary_recall': 0.6550633, 'binary_specificity': 0.94328356, 'binary_f1_score': 0.7638376}
confusion matrix:
     0    1
0  632   38
1  218  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558952, 'precision': 0.88212776, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.8533789, 'auroc': 0.9284529, 'binary_precision': 0.98224854, 'binary_recall': 0.7248908, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8341709}
confusion matrix:
     0    1
0  226    3
1   63  166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:30:31.478094,epoch time: 0:01:46.714534,used: 0:01:46.714534,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.9777526, 'recall': 0.9777273, 'specificity': 0.9777273, 'f1': 0.9777395, 'auroc': 0.99761295, 'binary_precision': 0.9775641, 'binary_recall': 0.978819, 'binary_specificity': 0.9766355, 'binary_f1_score': 0.97819114}
confusion matrix:
      0     1
0  1463    35
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.77572966, 'precision': 0.78670275, 'recall': 0.7727116, 'specificity': 0.7727116, 'f1': 0.772114, 'auroc': 0.8377315, 'binary_precision': 0.8359684, 'binary_recall': 0.6693038, 'binary_specificity': 0.8761194, 'binary_f1_score': 0.74340945}
confusion matrix:
     0    1
0  587   83
1  209  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.8614311, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8407418, 'auroc': 0.9180794, 'binary_precision': 0.94350284, 'binary_recall': 0.72925764, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.8226601}
confusion matrix:
     0    1
0  219   10
1   62  167
early stop counter: 1
val acc:0.7757296562194824, best validation acc: 0.8033794164657593, corresponding to test acc:                         0.8558952212333679 / 0.8558952212333679
after epoch: 2,now: 2024-07-29 06:32:24.182200,epoch time: 0:01:52.704106,used: 0:03:39.418640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97120416, 'precision': 0.97117543, 'recall': 0.9713265, 'specificity': 0.9713265, 'f1': 0.9712006, 'auroc': 0.9974023, 'binary_precision': 0.9784876, 'binary_recall': 0.96465296, 'binary_specificity': 0.978, 'binary_f1_score': 0.971521}
confusion matrix:
      0     1
0  1467    33
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.797235, 'precision': 0.8255056, 'recall': 0.7928443, 'specificity': 0.7928443, 'f1': 0.790936, 'auroc': 0.8777607, 'binary_precision': 0.9144144, 'binary_recall': 0.6424051, 'binary_specificity': 0.94328356, 'binary_f1_score': 0.7546469}
confusion matrix:
     0    1
0  632   38
1  226  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8144105, 'precision': 0.82107806, 'recall': 0.81441045, 'specificity': 0.81441045, 'f1': 0.813442, 'auroc': 0.8717034, 'binary_precision': 0.86734694, 'binary_recall': 0.7423581, 'binary_specificity': 0.88646287, 'binary_f1_score': 0.8000001}
confusion matrix:
     0    1
0  203   26
1   59  170
early stop counter: 2
val acc:0.7972350120544434, best validation acc: 0.8033794164657593, corresponding to test acc:                         0.8558952212333679 / 0.8558952212333679
after epoch: 3,now: 2024-07-29 06:34:03.721195,epoch time: 0:01:39.538995,used: 0:05:18.957635,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.97606754, 'recall': 0.9761612, 'specificity': 0.9761612, 'f1': 0.9761059, 'auroc': 0.997658, 'binary_precision': 0.9793415, 'binary_recall': 0.9736842, 'binary_specificity': 0.9786382, 'binary_f1_score': 0.9765047}
confusion matrix:
      0     1
0  1466    32
1    41  1517
---- Validation: 
scalar performance:
{'acc': 0.85099846, 'precision': 0.854016, 'recall': 0.8496151, 'specificity': 0.8496151, 'f1': 0.8502177, 'auroc': 0.9151355, 'binary_precision': 0.8802083, 'binary_recall': 0.8022152, 'binary_specificity': 0.8970149, 'binary_f1_score': 0.8394039}
confusion matrix:
     0    1
0  601   69
1  125  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8711546, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.834786, 'auroc': 0.93524146, 'binary_precision': 0.98136646, 'binary_recall': 0.6899563, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8102564}
confusion matrix:
     0    1
0  226    3
1   71  158
better model found
persisted
after epoch: 4,now: 2024-07-29 06:35:55.753002,epoch time: 0:01:52.031807,used: 0:07:10.989442,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.99177516, 'recall': 0.991922, 'specificity': 0.991922, 'f1': 0.99181795, 'auroc': 0.99897337, 'binary_precision': 0.9974026, 'binary_recall': 0.98651254, 'binary_specificity': 0.99733156, 'binary_f1_score': 0.99192774}
confusion matrix:
      0     1
0  1495     4
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.5829493, 'precision': 0.73074204, 'recall': 0.5708601, 'specificity': 0.5708601, 'f1': 0.48787057, 'auroc': 0.8488735, 'binary_precision': 0.9082569, 'binary_recall': 0.15664557, 'binary_specificity': 0.98507464, 'binary_f1_score': 0.26720646}
confusion matrix:
     0   1
0  660  10
1  533  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5633188, 'precision': 0.76689976, 'recall': 0.5633188, 'specificity': 0.5633188, 'f1': 0.4604274, 'auroc': 0.9088309, 'binary_precision': 1.0, 'binary_recall': 0.12663755, 'binary_specificity': 1.0, 'binary_f1_score': 0.22480619}
confusion matrix:
     0   1
0  229   0
1  200  29
early stop counter: 1
val acc:0.5829492807388306, best validation acc: 0.8509984612464905, corresponding to test acc:                         0.8384279608726501 / 0.8558952212333679
after epoch: 5,now: 2024-07-29 06:37:36.587279,epoch time: 0:01:40.834277,used: 0:08:51.823719,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98108554, 'recall': 0.98125786, 'specificity': 0.98125786, 'f1': 0.98102, 'auroc': 0.9976541, 'binary_precision': 0.9934211, 'binary_recall': 0.96919125, 'binary_specificity': 0.99332446, 'binary_f1_score': 0.9811566}
confusion matrix:
      0     1
0  1488    10
1    48  1510
---- Validation: 
scalar performance:
{'acc': 0.78187406, 'precision': 0.83073795, 'recall': 0.776169, 'specificity': 0.776169, 'f1': 0.7709774, 'auroc': 0.8988074, 'binary_precision': 0.9507772, 'binary_recall': 0.5806962, 'binary_specificity': 0.9716418, 'binary_f1_score': 0.7210216}
confusion matrix:
     0    1
0  651   19
1  265  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77729255, 'precision': 0.8394612, 'recall': 0.7772926, 'specificity': 0.7772926, 'f1': 0.7666067, 'auroc': 0.89029574, 'binary_precision': 0.9847328, 'binary_recall': 0.5633188, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7166667}
confusion matrix:
     0    1
0  227    2
1  100  129
early stop counter: 2
val acc:0.7818740606307983, best validation acc: 0.8509984612464905, corresponding to test acc:                         0.8384279608726501 / 0.8558952212333679
after epoch: 6,now: 2024-07-29 06:39:23.366809,epoch time: 0:01:46.779530,used: 0:10:38.603249,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99015224, 'recall': 0.9903337, 'specificity': 0.9903337, 'f1': 0.9901819, 'auroc': 0.9996307, 'binary_precision': 0.9980443, 'binary_recall': 0.98267007, 'binary_specificity': 0.99799734, 'binary_f1_score': 0.99029756}
confusion matrix:
      0     1
0  1495     3
1    27  1531
---- Validation: 
scalar performance:
{'acc': 0.7711213, 'precision': 0.8215488, 'recall': 0.7652277, 'specificity': 0.7652277, 'f1': 0.7589997, 'auroc': 0.9011879, 'binary_precision': 0.9417989, 'binary_recall': 0.56329113, 'binary_specificity': 0.96716416, 'binary_f1_score': 0.7049505}
confusion matrix:
     0    1
0  648   22
1  276  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6855895, 'precision': 0.79635215, 'recall': 0.68558955, 'specificity': 0.68558955, 'f1': 0.6531836, 'auroc': 0.92635536, 'binary_precision': 0.9775281, 'binary_recall': 0.37991267, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.54716986}
confusion matrix:
     0   1
0  227   2
1  142  87
early stop counter: 3
val acc:0.7711213231086731, best validation acc: 0.8509984612464905, corresponding to test acc:                         0.8384279608726501 / 0.8558952212333679
after epoch: 7,now: 2024-07-29 06:41:10.336864,epoch time: 0:01:46.970055,used: 0:12:25.573304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98654294, 'recall': 0.98663485, 'specificity': 0.98663485, 'f1': 0.9865803, 'auroc': 0.99809086, 'binary_precision': 0.9896641, 'binary_recall': 0.98394346, 'binary_specificity': 0.98932624, 'binary_f1_score': 0.9867955}
confusion matrix:
      0     1
0  1483    16
1    25  1532
---- Validation: 
scalar performance:
{'acc': 0.8402458, 'precision': 0.8596511, 'recall': 0.8368341, 'specificity': 0.8368341, 'f1': 0.83699024, 'auroc': 0.9073688, 'binary_precision': 0.93621397, 'binary_recall': 0.7199367, 'binary_specificity': 0.95373136, 'binary_f1_score': 0.81395346}
confusion matrix:
     0    1
0  639   31
1  177  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8318777, 'precision': 0.85722494, 'recall': 0.8318777, 'specificity': 0.8318777, 'f1': 0.82884157, 'auroc': 0.92462003, 'binary_precision': 0.95238096, 'binary_recall': 0.69868994, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.80604535}
confusion matrix:
     0    1
0  221    8
1   69  160
early stop counter: 4
val acc:0.84024578332901, best validation acc: 0.8509984612464905, corresponding to test acc:                         0.8384279608726501 / 0.8558952212333679
after epoch: 8,now: 2024-07-29 06:42:57.930515,epoch time: 0:01:47.593651,used: 0:14:13.166955,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9854116, 'recall': 0.9855279, 'specificity': 0.9855279, 'f1': 0.9852746, 'auroc': 0.999036, 'binary_precision': 0.99933904, 'binary_recall': 0.97172236, 'binary_specificity': 0.9993333, 'binary_f1_score': 0.98533726}
confusion matrix:
      0     1
0  1499     1
1    44  1512
---- Validation: 
scalar performance:
{'acc': 0.66129035, 'precision': 0.76537913, 'recall': 0.65187037, 'specificity': 0.65187037, 'f1': 0.6164907, 'auroc': 0.86392045, 'binary_precision': 0.92444444, 'binary_recall': 0.32911393, 'binary_specificity': 0.97462684, 'binary_f1_score': 0.4854142}
confusion matrix:
     0    1
0  653   17
1  424  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6681223, 'precision': 0.80052495, 'recall': 0.6681223, 'specificity': 0.6681223, 'f1': 0.62704384, 'auroc': 0.9030148, 'binary_precision': 1.0, 'binary_recall': 0.33624455, 'binary_specificity': 1.0, 'binary_f1_score': 0.503268}
confusion matrix:
     0   1
0  229   0
1  152  77
early stop counter: 5
val acc:0.6612903475761414, best validation acc: 0.8509984612464905, corresponding to test acc:                         0.8384279608726501 / 0.8558952212333679
after epoch: 9,now: 2024-07-29 06:44:46.419463,epoch time: 0:01:48.488948,used: 0:16:01.655903,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_28_44_seed_11_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:16:01.655903 at 2024-07-29 06:44:46.419463
persisted model performance metric: 

scalar performance:
{'acc': 0.83842796, 'precision': 0.8711546, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.834786, 'auroc': 0.93524146, 'binary_precision': 0.98136646, 'binary_recall': 0.6899563, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8102564}
confusion matrix:
     0    1
0  226    3
1   71  158
oracle model performance metric: 

scalar performance:
{'acc': 0.8558952, 'precision': 0.88212776, 'recall': 0.85589516, 'specificity': 0.85589516, 'f1': 0.8533789, 'auroc': 0.9284529, 'binary_precision': 0.98224854, 'binary_recall': 0.7248908, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8341709}
confusion matrix:
     0    1
0  226    3
1   63  166
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454065 KiB |   2004 MiB | 308220 GiB | 308220 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 304257 GiB | 304256 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3963 GiB |   3963 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454065 KiB |   2004 MiB | 308220 GiB | 308220 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 304257 GiB | 304256 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3963 GiB |   3963 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 307873 GiB | 307873 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 303918 GiB | 303918 GiB |
|       from small pool |  40407 KiB |     60 MiB |   3955 GiB |   3955 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  18404 MiB |  16128 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  18134 MiB |  15922 MiB |
|       from small pool |     64 MiB |     70 MiB |    270 MiB |    206 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 389710 KiB | 489230 KiB | 241794 GiB | 241794 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 237624 GiB | 237624 GiB |
|       from small pool |   8553 KiB |  22276 KiB |   4169 GiB |   4169 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   58984 K  |   58983 K  |
|       from large pool |     187    |     311    |   28306 K  |   28306 K  |
|       from small pool |    1123    |    1419    |   30677 K  |   30676 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   58984 K  |   58983 K  |
|       from large pool |     187    |     311    |   28306 K  |   28306 K  |
|       from small pool |    1123    |    1419    |   30677 K  |   30676 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     868    |     744    |
|       from large pool |      92    |      93    |     733    |     641    |
|       from small pool |      32    |      35    |     135    |     103    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      76    |     261    |   31465 K  |   31465 K  |
|       from large pool |      35    |      96    |   19313 K  |   19313 K  |
|       from small pool |      41    |     223    |   12151 K  |   12151 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 308220 GiB | 308220 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 304257 GiB | 304257 GiB |
|       from small pool |      0 KiB |     60 MiB |   3963 GiB |   3963 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 308220 GiB | 308220 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 304257 GiB | 304257 GiB |
|       from small pool |      0 KiB |     60 MiB |   3963 GiB |   3963 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 307873 GiB | 307873 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 303918 GiB | 303918 GiB |
|       from small pool |      0 KiB |     60 MiB |   3955 GiB |   3955 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2290 MiB |  18404 MiB |  17580 MiB |
|       from large pool |    776 MiB |   2226 MiB |  18134 MiB |  17358 MiB |
|       from small pool |     48 MiB |     70 MiB |    270 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 241795 GiB | 241795 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 237625 GiB | 237625 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4169 GiB |   4169 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   58984 K  |   58984 K  |
|       from large pool |       2    |     311    |   28306 K  |   28306 K  |
|       from small pool |       0    |    1419    |   30677 K  |   30677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   58984 K  |   58984 K  |
|       from large pool |       2    |     311    |   28306 K  |   28306 K  |
|       from small pool |       0    |    1419    |   30677 K  |   30677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     868    |     810    |
|       from large pool |      34    |      93    |     733    |     699    |
|       from small pool |      24    |      35    |     135    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   31465 K  |   31465 K  |
|       from large pool |       4    |      96    |   19313 K  |   19313 K  |
|       from small pool |       0    |     223    |   12152 K  |   12152 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 308220 GiB | 308220 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 304257 GiB | 304257 GiB |
|       from small pool |      0 KiB |     60 MiB |   3963 GiB |   3963 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 308220 GiB | 308220 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 304257 GiB | 304257 GiB |
|       from small pool |      0 KiB |     60 MiB |   3963 GiB |   3963 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 307873 GiB | 307873 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 303918 GiB | 303918 GiB |
|       from small pool |      0 KiB |     60 MiB |   3955 GiB |   3955 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2290 MiB |  18404 MiB |  17580 MiB |
|       from large pool |    776 MiB |   2226 MiB |  18134 MiB |  17358 MiB |
|       from small pool |     48 MiB |     70 MiB |    270 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 241795 GiB | 241795 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 237625 GiB | 237625 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4169 GiB |   4169 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   58984 K  |   58984 K  |
|       from large pool |       2    |     311    |   28306 K  |   28306 K  |
|       from small pool |       0    |    1419    |   30677 K  |   30677 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   58984 K  |   58984 K  |
|       from large pool |       2    |     311    |   28306 K  |   28306 K  |
|       from small pool |       0    |    1419    |   30677 K  |   30677 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     868    |     810    |
|       from large pool |      34    |      93    |     733    |     699    |
|       from small pool |      24    |      35    |     135    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   31465 K  |   31465 K  |
|       from large pool |       4    |      96    |   19313 K  |   19313 K  |
|       from small pool |       0    |     223    |   12152 K  |   12152 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370

 Experiment start at: 2024-07-29 06:45:33.136761
before training, model accuracy: 0.6380090713500977
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96488404, 'precision': 0.9662248, 'recall': 0.9654172, 'specificity': 0.9654172, 'f1': 0.96487725, 'auroc': 0.99762046, 'binary_precision': 0.9959514, 'binary_recall': 0.93476886, 'binary_specificity': 0.99606556, 'binary_f1_score': 0.9643907}
confusion matrix:
      0     1
0  1519     6
1   103  1476
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5905882, 'precision': 0.7554028, 'recall': 0.58516026, 'specificity': 0.58516026, 'f1': 0.50545555, 'auroc': 0.8928467, 'binary_precision': 0.95726496, 'binary_recall': 0.17806041, 'binary_specificity': 0.99226004, 'binary_f1_score': 0.30026808}
confusion matrix:
     0    1
0  641    5
1  517  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.739819, 'precision': 0.8207284, 'recall': 0.739819, 'specificity': 0.739819, 'f1': 0.7223057, 'auroc': 0.92690563, 'binary_precision': 0.9818182, 'binary_recall': 0.48868778, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.652568}
confusion matrix:
     0    1
0  219    2
1  113  108
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:47:18.587907,epoch time: 0:01:45.451146,used: 0:01:45.451146,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.974549, 'precision': 0.9746446, 'recall': 0.97475994, 'specificity': 0.97475994, 'f1': 0.97454834, 'auroc': 0.99731886, 'binary_precision': 0.987013, 'binary_recall': 0.96263456, 'binary_specificity': 0.98688525, 'binary_f1_score': 0.97467136}
confusion matrix:
      0     1
0  1505    20
1    59  1520
---- Validation: 
scalar performance:
{'acc': 0.8290196, 'precision': 0.8315528, 'recall': 0.8284244, 'specificity': 0.8284244, 'f1': 0.82848775, 'auroc': 0.90803874, 'binary_precision': 0.8573913, 'binary_recall': 0.7837838, 'binary_specificity': 0.873065, 'binary_f1_score': 0.81893694}
confusion matrix:
     0    1
0  564   82
1  136  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122172, 'precision': 0.81273586, 'recall': 0.81221724, 'specificity': 0.81221724, 'f1': 0.8121393, 'auroc': 0.9118569, 'binary_precision': 0.8, 'binary_recall': 0.8325792, 'binary_specificity': 0.7918552, 'binary_f1_score': 0.8159645}
confusion matrix:
     0    1
0  175   46
1   37  184
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 06:49:06.169822,epoch time: 0:01:47.581915,used: 0:03:33.033061,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96488404, 'precision': 0.96627164, 'recall': 0.96444815, 'specificity': 0.96444815, 'f1': 0.96482325, 'auroc': 0.9969497, 'binary_precision': 0.94494855, 'binary_recall': 0.9886076, 'binary_specificity': 0.9402887, 'binary_f1_score': 0.96628517}
confusion matrix:
      0     1
0  1433    91
1    18  1562
---- Validation: 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8675214, 'recall': 0.86699855, 'specificity': 0.86699855, 'f1': 0.86664295, 'auroc': 0.9325309, 'binary_precision': 0.84615386, 'binary_recall': 0.8918919, 'binary_specificity': 0.84210527, 'binary_f1_score': 0.8684211}
confusion matrix:
     0    1
0  544  102
1   68  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85294116, 'precision': 0.8545746, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.85277164, 'auroc': 0.91822445, 'binary_precision': 0.8786408, 'binary_recall': 0.81900454, 'binary_specificity': 0.88687783, 'binary_f1_score': 0.84777516}
confusion matrix:
     0    1
0  196   25
1   40  181
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 06:50:55.062343,epoch time: 0:01:48.892521,used: 0:05:21.925582,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.9694103, 'recall': 0.9684666, 'specificity': 0.9684666, 'f1': 0.96871555, 'auroc': 0.9956743, 'binary_precision': 0.95574677, 'binary_recall': 0.98417723, 'binary_specificity': 0.9527559, 'binary_f1_score': 0.9697537}
confusion matrix:
      0     1
0  1452    72
1    25  1555
---- Validation: 
scalar performance:
{'acc': 0.83686274, 'precision': 0.83910656, 'recall': 0.83631074, 'specificity': 0.83631074, 'f1': 0.83641106, 'auroc': 0.90538573, 'binary_precision': 0.8635579, 'binary_recall': 0.7949126, 'binary_specificity': 0.877709, 'binary_f1_score': 0.82781464}
confusion matrix:
     0    1
0  567   79
1  129  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.83391917, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.83241105, 'auroc': 0.9131877, 'binary_precision': 0.81276596, 'binary_recall': 0.8642534, 'binary_specificity': 0.800905, 'binary_f1_score': 0.83771926}
confusion matrix:
     0    1
0  177   44
1   30  191
early stop counter: 1
val acc:0.8368627429008484, best validation acc: 0.8666666746139526, corresponding to test acc:                         0.8529411554336548 / 0.8529411554336548
after epoch: 4,now: 2024-07-29 06:52:44.215631,epoch time: 0:01:49.153288,used: 0:07:11.078870,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9816366, 'precision': 0.98175156, 'recall': 0.98155046, 'specificity': 0.98155046, 'f1': 0.98162806, 'auroc': 0.9978829, 'binary_precision': 0.97740114, 'binary_recall': 0.986692, 'binary_specificity': 0.9764089, 'binary_f1_score': 0.9820246}
confusion matrix:
      0     1
0  1490    36
1    21  1557
---- Validation: 
scalar performance:
{'acc': 0.8462745, 'precision': 0.8540219, 'recall': 0.84528494, 'specificity': 0.84528494, 'f1': 0.8451428, 'auroc': 0.9170042, 'binary_precision': 0.90316576, 'binary_recall': 0.7710652, 'binary_specificity': 0.91950464, 'binary_f1_score': 0.831904}
confusion matrix:
     0    1
0  594   52
1  144  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84841627, 'precision': 0.8484234, 'recall': 0.8484163, 'specificity': 0.8484163, 'f1': 0.8484155, 'auroc': 0.9190434, 'binary_precision': 0.85, 'binary_recall': 0.84615386, 'binary_specificity': 0.85067874, 'binary_f1_score': 0.8480725}
confusion matrix:
     0    1
0  188   33
1   34  187
early stop counter: 2
val acc:0.8462744951248169, best validation acc: 0.8666666746139526, corresponding to test acc:                         0.8529411554336548 / 0.8529411554336548
after epoch: 5,now: 2024-07-29 06:54:33.668246,epoch time: 0:01:49.452615,used: 0:09:00.531485,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9777706, 'precision': 0.9780792, 'recall': 0.9776013, 'specificity': 0.9776013, 'f1': 0.9777547, 'auroc': 0.99841154, 'binary_precision': 0.96952736, 'binary_recall': 0.9873338, 'binary_specificity': 0.96786886, 'binary_f1_score': 0.97834957}
confusion matrix:
      0     1
0  1476    49
1    20  1559
---- Validation: 
scalar performance:
{'acc': 0.83686274, 'precision': 0.83889556, 'recall': 0.83737767, 'specificity': 0.83737767, 'f1': 0.8367397, 'auroc': 0.91384673, 'binary_precision': 0.80910426, 'binary_recall': 0.87599367, 'binary_specificity': 0.7987616, 'binary_f1_score': 0.8412214}
confusion matrix:
     0    1
0  516  130
1   78  551
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7352941, 'precision': 0.76976526, 'recall': 0.7352941, 'specificity': 0.7352941, 'f1': 0.7265589, 'auroc': 0.9123124, 'binary_precision': 0.67333335, 'binary_recall': 0.91402715, 'binary_specificity': 0.5565611, 'binary_f1_score': 0.7754319}
confusion matrix:
     0    1
0  123   98
1   19  202
early stop counter: 3
val acc:0.8368627429008484, best validation acc: 0.8666666746139526, corresponding to test acc:                         0.8529411554336548 / 0.8529411554336548
after epoch: 6,now: 2024-07-29 06:56:20.372171,epoch time: 0:01:46.703925,used: 0:10:47.235410,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842139, 'precision': 0.9843318, 'recall': 0.984439, 'specificity': 0.984439, 'f1': 0.98421365, 'auroc': 0.9990058, 'binary_precision': 0.9973992, 'binary_recall': 0.97150093, 'binary_specificity': 0.99737704, 'binary_f1_score': 0.98427975}
confusion matrix:
      0     1
0  1521     4
1    45  1534
---- Validation: 
scalar performance:
{'acc': 0.78431374, 'precision': 0.83172536, 'recall': 0.7817756, 'specificity': 0.7817756, 'f1': 0.7752532, 'auroc': 0.9134512, 'binary_precision': 0.95384616, 'binary_recall': 0.5914149, 'binary_specificity': 0.9721362, 'binary_f1_score': 0.7301276}
confusion matrix:
     0    1
0  628   18
1  257  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.8762343, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.86067235, 'auroc': 0.92360926, 'binary_precision': 0.9494382, 'binary_recall': 0.7647059, 'binary_specificity': 0.959276, 'binary_f1_score': 0.84711784}
confusion matrix:
     0    1
0  212    9
1   52  169
new oracle model saved
early stop counter: 4
val acc:0.7843137383460999, best validation acc: 0.8666666746139526, corresponding to test acc:                         0.8529411554336548 / 0.8619909286499023
after epoch: 7,now: 2024-07-29 06:57:57.480284,epoch time: 0:01:37.108113,used: 0:12:24.343523,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9832474, 'precision': 0.98330677, 'recall': 0.98345125, 'specificity': 0.98345125, 'f1': 0.9832467, 'auroc': 0.99921674, 'binary_precision': 0.9948186, 'binary_recall': 0.9721519, 'binary_specificity': 0.9947507, 'binary_f1_score': 0.9833547}
confusion matrix:
      0     1
0  1516     8
1    44  1536
---- Validation: 
scalar performance:
{'acc': 0.7607843, 'precision': 0.82472193, 'recall': 0.7578027, 'specificity': 0.7578027, 'f1': 0.7469615, 'auroc': 0.9229107, 'binary_precision': 0.9655172, 'binary_recall': 0.53418124, 'binary_specificity': 0.98142415, 'binary_f1_score': 0.6878199}
confusion matrix:
     0    1
0  634   12
1  293  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7669683, 'precision': 0.83067054, 'recall': 0.76696837, 'specificity': 0.76696837, 'f1': 0.7551774, 'auroc': 0.88540363, 'binary_precision': 0.9758065, 'binary_recall': 0.54751134, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.7014493}
confusion matrix:
     0    1
0  218    3
1  100  121
early stop counter: 5
val acc:0.7607843279838562, best validation acc: 0.8666666746139526, corresponding to test acc:                         0.8529411554336548 / 0.8619909286499023
after epoch: 8,now: 2024-07-29 06:59:47.310169,epoch time: 0:01:49.829885,used: 0:14:14.173408,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_45_32_seed_12_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:14:14.173408 at 2024-07-29 06:59:47.310169
persisted model performance metric: 

scalar performance:
{'acc': 0.85294116, 'precision': 0.8545746, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.85277164, 'auroc': 0.91822445, 'binary_precision': 0.8786408, 'binary_recall': 0.81900454, 'binary_specificity': 0.88687783, 'binary_f1_score': 0.84777516}
confusion matrix:
     0    1
0  196   25
1   40  181
oracle model performance metric: 

scalar performance:
{'acc': 0.8619909, 'precision': 0.8762343, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.86067235, 'auroc': 0.92360926, 'binary_precision': 0.9494382, 'binary_recall': 0.7647059, 'binary_specificity': 0.959276, 'binary_f1_score': 0.84711784}
confusion matrix:
     0    1
0  212    9
1   52  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454062 KiB |   2004 MiB | 325827 GiB | 325826 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 321638 GiB | 321637 GiB |
|       from small pool |  40595 KiB |     60 MiB |   4189 GiB |   4189 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454062 KiB |   2004 MiB | 325827 GiB | 325826 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 321638 GiB | 321637 GiB |
|       from small pool |  40595 KiB |     60 MiB |   4189 GiB |   4189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 325472 GiB | 325472 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 321291 GiB | 321291 GiB |
|       from small pool |  40406 KiB |     60 MiB |   4180 GiB |   4180 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  19856 MiB |  17580 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  19570 MiB |  17358 MiB |
|       from small pool |     64 MiB |     70 MiB |    286 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 408145 KiB | 489230 KiB | 255600 GiB | 255600 GiB |
|       from large pool | 401637 KiB | 476433 KiB | 251193 GiB | 251192 GiB |
|       from small pool |   6508 KiB |  22276 KiB |   4407 GiB |   4407 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   62354 K  |   62353 K  |
|       from large pool |     187    |     311    |   29925 K  |   29925 K  |
|       from small pool |    1117    |    1419    |   32429 K  |   32428 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   62354 K  |   62353 K  |
|       from large pool |     187    |     311    |   29925 K  |   29925 K  |
|       from small pool |    1117    |    1419    |   32429 K  |   32428 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     934    |     810    |
|       from large pool |      92    |      93    |     791    |     699    |
|       from small pool |      32    |      35    |     143    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |     261    |   33338 K  |   33338 K  |
|       from large pool |      37    |      96    |   20492 K  |   20492 K  |
|       from small pool |      38    |     223    |   12846 K  |   12846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 325827 GiB | 325827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 321638 GiB | 321637 GiB |
|       from small pool |      0 KiB |     60 MiB |   4189 GiB |   4189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 325827 GiB | 325827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 321638 GiB | 321637 GiB |
|       from small pool |      0 KiB |     60 MiB |   4189 GiB |   4189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 325472 GiB | 325472 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 321291 GiB | 321291 GiB |
|       from small pool |      0 KiB |     60 MiB |   4180 GiB |   4180 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2290 MiB |  19856 MiB |  19014 MiB |
|       from large pool |    796 MiB |   2226 MiB |  19570 MiB |  18774 MiB |
|       from small pool |     46 MiB |     70 MiB |    286 MiB |    240 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 255601 GiB | 255601 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 251193 GiB | 251193 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4407 GiB |   4407 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   62354 K  |   62354 K  |
|       from large pool |       2    |     311    |   29925 K  |   29925 K  |
|       from small pool |       0    |    1419    |   32429 K  |   32429 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   62354 K  |   62354 K  |
|       from large pool |       2    |     311    |   29925 K  |   29925 K  |
|       from small pool |       0    |    1419    |   32429 K  |   32429 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     934    |     876    |
|       from large pool |      35    |      93    |     791    |     756    |
|       from small pool |      23    |      35    |     143    |     120    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   33338 K  |   33338 K  |
|       from large pool |       4    |      96    |   20492 K  |   20492 K  |
|       from small pool |       0    |     223    |   12846 K  |   12846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 325827 GiB | 325827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 321638 GiB | 321637 GiB |
|       from small pool |      0 KiB |     60 MiB |   4189 GiB |   4189 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 325827 GiB | 325827 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 321638 GiB | 321637 GiB |
|       from small pool |      0 KiB |     60 MiB |   4189 GiB |   4189 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 325472 GiB | 325472 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 321291 GiB | 321291 GiB |
|       from small pool |      0 KiB |     60 MiB |   4180 GiB |   4180 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    842 MiB |   2290 MiB |  19856 MiB |  19014 MiB |
|       from large pool |    796 MiB |   2226 MiB |  19570 MiB |  18774 MiB |
|       from small pool |     46 MiB |     70 MiB |    286 MiB |    240 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 255601 GiB | 255601 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 251193 GiB | 251193 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4407 GiB |   4407 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   62354 K  |   62354 K  |
|       from large pool |       2    |     311    |   29925 K  |   29925 K  |
|       from small pool |       0    |    1419    |   32429 K  |   32429 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   62354 K  |   62354 K  |
|       from large pool |       2    |     311    |   29925 K  |   29925 K  |
|       from small pool |       0    |    1419    |   32429 K  |   32429 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     934    |     876    |
|       from large pool |      35    |      93    |     791    |     756    |
|       from small pool |      23    |      35    |     143    |     120    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   33338 K  |   33338 K  |
|       from large pool |       4    |      96    |   20492 K  |   20492 K  |
|       from small pool |       0    |     223    |   12846 K  |   12846 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370

 Experiment start at: 2024-07-29 07:00:32.655901
before training, model accuracy: 0.38596493005752563
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9486842, 'precision': 0.95263374, 'recall': 0.94771624, 'specificity': 0.94771624, 'f1': 0.94847, 'auroc': 0.99537075, 'binary_precision': 0.9155767, 'binary_recall': 0.990991, 'binary_specificity': 0.9044415, 'binary_f1_score': 0.9517923}
confusion matrix:
      0     1
0  1344   142
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.8248457, 'precision': 0.8247186, 'recall': 0.82375324, 'specificity': 0.82375324, 'f1': 0.82412434, 'auroc': 0.88832843, 'binary_precision': 0.8230384, 'binary_recall': 0.8029316, 'binary_specificity': 0.8445748, 'binary_f1_score': 0.81286067}
confusion matrix:
     0    1
0  576  106
1  121  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8399123, 'precision': 0.84340686, 'recall': 0.8399123, 'specificity': 0.8399123, 'f1': 0.839504, 'auroc': 0.9107418, 'binary_precision': 0.8780488, 'binary_recall': 0.7894737, 'binary_specificity': 0.8903509, 'binary_f1_score': 0.8314088}
confusion matrix:
     0    1
0  203   25
1   48  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:02:23.864880,epoch time: 0:01:51.208979,used: 0:01:51.208979,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.9829765, 'recall': 0.9823216, 'specificity': 0.9823216, 'f1': 0.98254657, 'auroc': 0.99862415, 'binary_precision': 0.9735183, 'binary_recall': 0.99292606, 'binary_specificity': 0.9717172, 'binary_f1_score': 0.9831264}
confusion matrix:
      0     1
0  1443    42
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.7037037, 'precision': 0.73721135, 'recall': 0.6928176, 'specificity': 0.6928176, 'f1': 0.68497497, 'auroc': 0.8070439, 'binary_precision': 0.8142077, 'binary_recall': 0.48534203, 'binary_specificity': 0.90029323, 'binary_f1_score': 0.6081633}
confusion matrix:
     0    1
0  614   68
1  316  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85745615, 'precision': 0.8582901, 'recall': 0.8574561, 'specificity': 0.8574561, 'f1': 0.8573732, 'auroc': 0.9291705, 'binary_precision': 0.875576, 'binary_recall': 0.8333333, 'binary_specificity': 0.8815789, 'binary_f1_score': 0.8539326}
confusion matrix:
     0    1
0  201   27
1   38  190
new oracle model saved
early stop counter: 1
val acc:0.7037037014961243, best validation acc: 0.8248456716537476, corresponding to test acc:                         0.8399122953414917 / 0.8574561476707458
after epoch: 2,now: 2024-07-29 07:04:09.181181,epoch time: 0:01:45.316301,used: 0:03:36.525280,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.98463845, 'recall': 0.9844422, 'specificity': 0.9844422, 'f1': 0.98452735, 'auroc': 0.9992932, 'binary_precision': 0.9815051, 'binary_recall': 0.9884393, 'binary_specificity': 0.980445, 'binary_f1_score': 0.98495996}
confusion matrix:
      0     1
0  1454    29
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.81790125, 'precision': 0.82128197, 'recall': 0.8148003, 'specificity': 0.8148003, 'f1': 0.81599236, 'auroc': 0.86611044, 'binary_precision': 0.84363633, 'binary_recall': 0.75570035, 'binary_specificity': 0.8739003, 'binary_f1_score': 0.7972509}
confusion matrix:
     0    1
0  596   86
1  150  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8684211, 'precision': 0.8840539, 'recall': 0.8684211, 'specificity': 0.8684211, 'f1': 0.8670683, 'auroc': 0.9384426, 'binary_precision': 0.96153843, 'binary_recall': 0.76754385, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.8536585}
confusion matrix:
     0    1
0  221    7
1   53  175
new oracle model saved
early stop counter: 2
val acc:0.8179012537002563, best validation acc: 0.8248456716537476, corresponding to test acc:                         0.8399122953414917 / 0.8684210777282715
after epoch: 3,now: 2024-07-29 07:05:50.132572,epoch time: 0:01:40.951391,used: 0:05:17.476671,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9444079, 'precision': 0.9492669, 'recall': 0.9432292, 'specificity': 0.9432292, 'f1': 0.94412315, 'auroc': 0.99636257, 'binary_precision': 0.9082353, 'binary_recall': 0.9916506, 'binary_specificity': 0.8948078, 'binary_f1_score': 0.9481117}
confusion matrix:
      0     1
0  1327   156
1    13  1544
---- Validation: 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8236338, 'recall': 0.82243735, 'specificity': 0.82243735, 'f1': 0.8194096, 'auroc': 0.89412725, 'binary_precision': 0.7714286, 'binary_recall': 0.8794788, 'binary_specificity': 0.7653959, 'binary_f1_score': 0.82191783}
confusion matrix:
     0    1
0  522  160
1   74  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8815789, 'precision': 0.8883016, 'recall': 0.8815789, 'specificity': 0.8815789, 'f1': 0.8810641, 'auroc': 0.9542744, 'binary_precision': 0.93939394, 'binary_recall': 0.81578946, 'binary_specificity': 0.94736844, 'binary_f1_score': 0.87323934}
confusion matrix:
     0    1
0  216   12
1   42  186
new oracle model saved
early stop counter: 3
val acc:0.8194444179534912, best validation acc: 0.8248456716537476, corresponding to test acc:                         0.8399122953414917 / 0.8815789222717285
after epoch: 4,now: 2024-07-29 07:07:28.931904,epoch time: 0:01:38.799332,used: 0:06:56.276003,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.9894191, 'recall': 0.989542, 'specificity': 0.989542, 'f1': 0.9894698, 'auroc': 0.999583, 'binary_precision': 0.99287564, 'binary_recall': 0.9864865, 'binary_specificity': 0.9925976, 'binary_f1_score': 0.98967075}
confusion matrix:
      0     1
0  1475    11
1    21  1533
---- Validation: 
scalar performance:
{'acc': 0.76080245, 'precision': 0.8114376, 'recall': 0.74974924, 'specificity': 0.74974924, 'f1': 0.74485594, 'auroc': 0.88587886, 'binary_precision': 0.924581, 'binary_recall': 0.53908795, 'binary_specificity': 0.96041054, 'binary_f1_score': 0.68106997}
confusion matrix:
     0    1
0  655   27
1  283  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.87258106, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8288255, 'auroc': 0.9296707, 'binary_precision': 0.9935065, 'binary_recall': 0.67105263, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.80104715}
confusion matrix:
     0    1
0  227    1
1   75  153
early stop counter: 4
val acc:0.7608024477958679, best validation acc: 0.8248456716537476, corresponding to test acc:                         0.8399122953414917 / 0.8815789222717285
after epoch: 5,now: 2024-07-29 07:09:12.816626,epoch time: 0:01:43.884722,used: 0:08:40.160725,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.9864484, 'recall': 0.9866045, 'specificity': 0.9866045, 'f1': 0.9865084, 'auroc': 0.9991417, 'binary_precision': 0.9909209, 'binary_recall': 0.98263663, 'binary_specificity': 0.9905724, 'binary_f1_score': 0.9867614}
confusion matrix:
      0     1
0  1471    14
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8299056, 'recall': 0.7902199, 'specificity': 0.7902199, 'f1': 0.79009795, 'auroc': 0.8977953, 'binary_precision': 0.9192399, 'binary_recall': 0.63029313, 'binary_specificity': 0.9501466, 'binary_f1_score': 0.74782604}
confusion matrix:
     0    1
0  648   34
1  227  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8399123, 'precision': 0.86611897, 'recall': 0.8399123, 'specificity': 0.8399123, 'f1': 0.8369953, 'auroc': 0.907159, 'binary_precision': 0.96407187, 'binary_recall': 0.70614034, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.81518984}
confusion matrix:
     0    1
0  222    6
1   67  161
early stop counter: 5
val acc:0.7986111044883728, best validation acc: 0.8248456716537476, corresponding to test acc:                         0.8399122953414917 / 0.8815789222717285
after epoch: 6,now: 2024-07-29 07:11:01.510447,epoch time: 0:01:48.693821,used: 0:10:28.854546,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_00_32_seed_13_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:10:28.854546 at 2024-07-29 07:11:01.510447
persisted model performance metric: 

scalar performance:
{'acc': 0.8399123, 'precision': 0.84340686, 'recall': 0.8399123, 'specificity': 0.8399123, 'f1': 0.839504, 'auroc': 0.9107418, 'binary_precision': 0.8780488, 'binary_recall': 0.7894737, 'binary_specificity': 0.8903509, 'binary_f1_score': 0.8314088}
confusion matrix:
     0    1
0  203   25
1   48  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8815789, 'precision': 0.8883016, 'recall': 0.8815789, 'specificity': 0.8815789, 'f1': 0.8810641, 'auroc': 0.9542744, 'binary_precision': 0.93939394, 'binary_recall': 0.81578946, 'binary_specificity': 0.94736844, 'binary_f1_score': 0.87323934}
confusion matrix:
     0    1
0  216   12
1   42  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454065 KiB |   2004 MiB | 338883 GiB | 338883 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 334525 GiB | 334525 GiB |
|       from small pool |  40598 KiB |     60 MiB |   4357 GiB |   4357 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454065 KiB |   2004 MiB | 338883 GiB | 338883 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 334525 GiB | 334525 GiB |
|       from small pool |  40598 KiB |     60 MiB |   4357 GiB |   4357 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 338522 GiB | 338522 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 334173 GiB | 334173 GiB |
|       from small pool |  40407 KiB |     60 MiB |   4349 GiB |   4349 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  21290 MiB |  19014 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  20986 MiB |  18774 MiB |
|       from small pool |     64 MiB |     70 MiB |    304 MiB |    240 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 389710 KiB | 489230 KiB | 265859 GiB | 265859 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 261274 GiB | 261274 GiB |
|       from small pool |   8553 KiB |  22276 KiB |   4585 GiB |   4585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   64860 K  |   64859 K  |
|       from large pool |     187    |     311    |   31125 K  |   31125 K  |
|       from small pool |    1123    |    1419    |   33734 K  |   33733 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   64860 K  |   64859 K  |
|       from large pool |     187    |     311    |   31125 K  |   31125 K  |
|       from small pool |    1123    |    1419    |   33734 K  |   33733 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |    1000    |     876    |
|       from large pool |      92    |      93    |     848    |     756    |
|       from small pool |      32    |      35    |     152    |     120    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      77    |     261    |   34724 K  |   34724 K  |
|       from large pool |      35    |      96    |   21368 K  |   21368 K  |
|       from small pool |      42    |     223    |   13356 K  |   13356 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 338883 GiB | 338883 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 334525 GiB | 334525 GiB |
|       from small pool |      0 KiB |     60 MiB |   4357 GiB |   4357 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 338883 GiB | 338883 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 334525 GiB | 334525 GiB |
|       from small pool |      0 KiB |     60 MiB |   4357 GiB |   4357 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 338522 GiB | 338522 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 334173 GiB | 334173 GiB |
|       from small pool |      0 KiB |     60 MiB |   4349 GiB |   4349 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2290 MiB |  21290 MiB |  20466 MiB |
|       from large pool |    776 MiB |   2226 MiB |  20986 MiB |  20210 MiB |
|       from small pool |     48 MiB |     70 MiB |    304 MiB |    256 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 265860 GiB | 265859 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 261274 GiB | 261274 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4585 GiB |   4585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   64860 K  |   64860 K  |
|       from large pool |       2    |     311    |   31125 K  |   31125 K  |
|       from small pool |       0    |    1419    |   33734 K  |   33734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   64860 K  |   64860 K  |
|       from large pool |       2    |     311    |   31125 K  |   31125 K  |
|       from small pool |       0    |    1419    |   33734 K  |   33734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |    1000    |     942    |
|       from large pool |      34    |      93    |     848    |     814    |
|       from small pool |      24    |      35    |     152    |     128    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   34725 K  |   34725 K  |
|       from large pool |       4    |      96    |   21368 K  |   21368 K  |
|       from small pool |       0    |     223    |   13356 K  |   13356 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 338883 GiB | 338883 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 334525 GiB | 334525 GiB |
|       from small pool |      0 KiB |     60 MiB |   4357 GiB |   4357 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 338883 GiB | 338883 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 334525 GiB | 334525 GiB |
|       from small pool |      0 KiB |     60 MiB |   4357 GiB |   4357 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 338522 GiB | 338522 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 334173 GiB | 334173 GiB |
|       from small pool |      0 KiB |     60 MiB |   4349 GiB |   4349 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    824 MiB |   2290 MiB |  21290 MiB |  20466 MiB |
|       from large pool |    776 MiB |   2226 MiB |  20986 MiB |  20210 MiB |
|       from small pool |     48 MiB |     70 MiB |    304 MiB |    256 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 265860 GiB | 265859 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 261274 GiB | 261274 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4585 GiB |   4585 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   64860 K  |   64860 K  |
|       from large pool |       2    |     311    |   31125 K  |   31125 K  |
|       from small pool |       0    |    1419    |   33734 K  |   33734 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   64860 K  |   64860 K  |
|       from large pool |       2    |     311    |   31125 K  |   31125 K  |
|       from small pool |       0    |    1419    |   33734 K  |   33734 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |    1000    |     942    |
|       from large pool |      34    |      93    |     848    |     814    |
|       from small pool |      24    |      35    |     152    |     128    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   34725 K  |   34725 K  |
|       from large pool |       4    |      96    |   21368 K  |   21368 K  |
|       from small pool |       0    |     223    |   13356 K  |   13356 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370

 Experiment start at: 2024-07-29 07:11:40.123967
before training, model accuracy: 0.5177778005599976
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9129581, 'precision': 0.925141, 'recall': 0.9134046, 'specificity': 0.9134046, 'f1': 0.9123905, 'auroc': 0.9910649, 'binary_precision': 0.99843013, 'binary_recall': 0.828125, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.9053381}
confusion matrix:
      0     1
0  1518     2
1   264  1272
---- Validation: 
scalar performance:
{'acc': 0.7679688, 'precision': 0.7991854, 'recall': 0.76488316, 'specificity': 0.76488316, 'f1': 0.76029646, 'auroc': 0.8674754, 'binary_precision': 0.89125293, 'binary_recall': 0.6003185, 'binary_specificity': 0.9294478, 'binary_f1_score': 0.717412}
confusion matrix:
     0    1
0  606   46
1  251  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8248922, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7934687, 'auroc': 0.90583706, 'binary_precision': 0.91875, 'binary_recall': 0.6533333, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.76363635}
confusion matrix:
     0    1
0  212   13
1   78  147
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:13:30.142002,epoch time: 0:01:50.018035,used: 0:01:50.018035,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93815446, 'precision': 0.94472396, 'recall': 0.9377248, 'specificity': 0.9377248, 'f1': 0.93788034, 'auroc': 0.997643, 'binary_precision': 0.89244187, 'binary_recall': 0.99740094, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.94200677}
confusion matrix:
      0     1
0  1332   185
1     4  1535
---- Validation: 
scalar performance:
{'acc': 0.68671876, 'precision': 0.7546591, 'recall': 0.69145894, 'specificity': 0.69145894, 'f1': 0.6675973, 'auroc': 0.86970514, 'binary_precision': 0.6183525, 'binary_recall': 0.9442675, 'binary_specificity': 0.4386503, 'binary_f1_score': 0.747322}
confusion matrix:
     0    1
0  286  366
1   35  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.81197476, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7901993, 'auroc': 0.90317035, 'binary_precision': 0.73571426, 'binary_recall': 0.91555554, 'binary_specificity': 0.6711111, 'binary_f1_score': 0.81584156}
confusion matrix:
     0    1
0  151   74
1   19  206
early stop counter: 1
val acc:0.686718761920929, best validation acc: 0.7679687738418579, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 2,now: 2024-07-29 07:15:19.724178,epoch time: 0:01:49.582176,used: 0:03:39.600211,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96433246, 'precision': 0.9663187, 'recall': 0.964578, 'specificity': 0.964578, 'f1': 0.9643061, 'auroc': 0.9985459, 'binary_precision': 0.9986053, 'binary_recall': 0.93047434, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9633367}
confusion matrix:
      0     1
0  1515     2
1   107  1432
---- Validation: 
scalar performance:
{'acc': 0.721875, 'precision': 0.77480143, 'recall': 0.7176742, 'specificity': 0.7176742, 'f1': 0.7052492, 'auroc': 0.8617239, 'binary_precision': 0.8908046, 'binary_recall': 0.4936306, 'binary_specificity': 0.9417178, 'binary_f1_score': 0.6352459}
confusion matrix:
     0    1
0  614   38
1  318  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.79613125, 'recall': 0.7422222, 'specificity': 0.7422222, 'f1': 0.72993106, 'auroc': 0.8984889, 'binary_precision': 0.92248064, 'binary_recall': 0.5288889, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.6723164}
confusion matrix:
     0    1
0  215   10
1  106  119
early stop counter: 2
val acc:0.721875011920929, best validation acc: 0.7679687738418579, corresponding to test acc:                         0.7977777719497681 / 0.7977777719497681
after epoch: 3,now: 2024-07-29 07:17:16.034572,epoch time: 0:01:56.310394,used: 0:05:35.910605,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.97826445, 'recall': 0.9781426, 'specificity': 0.9781426, 'f1': 0.9780752, 'auroc': 0.9972489, 'binary_precision': 0.9893475, 'binary_recall': 0.96681845, 'binary_specificity': 0.9894667, 'binary_f1_score': 0.9779532}
confusion matrix:
      0     1
0  1503    16
1    51  1486
---- Validation: 
scalar performance:
{'acc': 0.8101562, 'precision': 0.81012607, 'recall': 0.8100162, 'specificity': 0.8100162, 'f1': 0.8100587, 'auroc': 0.87865853, 'binary_precision': 0.80898875, 'binary_recall': 0.80254775, 'binary_specificity': 0.8174847, 'binary_f1_score': 0.8057554}
confusion matrix:
     0    1
0  533  119
1  124  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8272908, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8215313, 'auroc': 0.90350616, 'binary_precision': 0.8680203, 'binary_recall': 0.76, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8104266}
confusion matrix:
     0    1
0  199   26
1   54  171
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 07:19:05.672346,epoch time: 0:01:49.637774,used: 0:07:25.548379,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.983307, 'recall': 0.98332584, 'specificity': 0.98332584, 'f1': 0.98331124, 'auroc': 0.99850047, 'binary_precision': 0.98563033, 'binary_recall': 0.98114437, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.9833822}
confusion matrix:
      0     1
0  1496    22
1    29  1509
---- Validation: 
scalar performance:
{'acc': 0.76875, 'precision': 0.7758318, 'recall': 0.767174, 'specificity': 0.767174, 'f1': 0.7664873, 'auroc': 0.8528316, 'binary_precision': 0.81558937, 'binary_recall': 0.683121, 'binary_specificity': 0.851227, 'binary_f1_score': 0.7435009}
confusion matrix:
     0    1
0  555   97
1  199  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.86206686, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8597999, 'auroc': 0.92185676, 'binary_precision': 0.8894231, 'binary_recall': 0.82222223, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.85450345}
confusion matrix:
     0    1
0  202   23
1   40  185
new oracle model saved
early stop counter: 1
val acc:0.768750011920929, best validation acc: 0.8101562261581421, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 5,now: 2024-07-29 07:20:55.538113,epoch time: 0:01:49.865767,used: 0:09:15.414146,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98471683, 'recall': 0.98467755, 'specificity': 0.98467755, 'f1': 0.98462033, 'auroc': 0.99851155, 'binary_precision': 0.99338186, 'binary_recall': 0.9759428, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9845851}
confusion matrix:
      0     1
0  1508    10
1    37  1501
---- Validation: 
scalar performance:
{'acc': 0.77421874, 'precision': 0.80486697, 'recall': 0.771194, 'specificity': 0.771194, 'f1': 0.7670199, 'auroc': 0.87808704, 'binary_precision': 0.8969555, 'binary_recall': 0.60987264, 'binary_specificity': 0.9325153, 'binary_f1_score': 0.72606635}
confusion matrix:
     0    1
0  608   44
1  245  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.87012744, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8491738, 'auroc': 0.9148247, 'binary_precision': 0.954023, 'binary_recall': 0.73777777, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8320801}
confusion matrix:
     0    1
0  217    8
1   59  166
early stop counter: 2
val acc:0.774218738079071, best validation acc: 0.8101562261581421, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 6,now: 2024-07-29 07:22:44.543261,epoch time: 0:01:49.005148,used: 0:11:04.419294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9739368, 'recall': 0.97378254, 'specificity': 0.97378254, 'f1': 0.97381794, 'auroc': 0.9975898, 'binary_precision': 0.967887, 'binary_recall': 0.98048145, 'binary_specificity': 0.96708363, 'binary_f1_score': 0.9741435}
confusion matrix:
      0     1
0  1469    50
1    30  1507
---- Validation: 
scalar performance:
{'acc': 0.809375, 'precision': 0.8375488, 'recall': 0.806641, 'specificity': 0.806641, 'f1': 0.8043064, 'auroc': 0.917786, 'binary_precision': 0.9304933, 'binary_recall': 0.66082805, 'binary_specificity': 0.952454, 'binary_f1_score': 0.77281195}
confusion matrix:
     0    1
0  621   31
1  213  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.86937153, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8392687, 'auroc': 0.9133432, 'binary_precision': 0.9695122, 'binary_recall': 0.70666665, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8174807}
confusion matrix:
     0    1
0  220    5
1   66  159
early stop counter: 3
val acc:0.809374988079071, best validation acc: 0.8101562261581421, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 7,now: 2024-07-29 07:24:34.141849,epoch time: 0:01:49.598588,used: 0:12:54.017882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98253256, 'recall': 0.9823986, 'specificity': 0.9823986, 'f1': 0.98232925, 'auroc': 0.99889755, 'binary_precision': 0.994004, 'binary_recall': 0.9707222, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.9822251}
confusion matrix:
      0     1
0  1510     9
1    45  1492
---- Validation: 
scalar performance:
{'acc': 0.715625, 'precision': 0.78960824, 'recall': 0.71080655, 'specificity': 0.71080655, 'f1': 0.6932081, 'auroc': 0.8825191, 'binary_precision': 0.9313725, 'binary_recall': 0.45382166, 'binary_specificity': 0.96779144, 'binary_f1_score': 0.61027837}
confusion matrix:
     0    1
0  631   21
1  343  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.83952606, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7589691, 'auroc': 0.92318517, 'binary_precision': 0.9919355, 'binary_recall': 0.5466667, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7048711}
confusion matrix:
     0    1
0  224    1
1  102  123
early stop counter: 4
val acc:0.715624988079071, best validation acc: 0.8101562261581421, corresponding to test acc:                         0.8222222328186035 / 0.8600000143051147
after epoch: 8,now: 2024-07-29 07:26:24.503816,epoch time: 0:01:50.361967,used: 0:14:44.379849,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.9808517, 'recall': 0.9806385, 'specificity': 0.9806385, 'f1': 0.9806895, 'auroc': 0.9986602, 'binary_precision': 0.9737516, 'binary_recall': 0.9883041, 'binary_specificity': 0.972973, 'binary_f1_score': 0.9809739}
confusion matrix:
      0     1
0  1476    41
1    18  1521
---- Validation: 
scalar performance:
{'acc': 0.8382813, 'precision': 0.8404808, 'recall': 0.83750635, 'specificity': 0.83750635, 'f1': 0.8377536, 'auroc': 0.9045758, 'binary_precision': 0.8635579, 'binary_recall': 0.79617834, 'binary_specificity': 0.87883437, 'binary_f1_score': 0.82850045}
confusion matrix:
     0    1
0  573   79
1  128  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8755556, 'precision': 0.88330877, 'recall': 0.8755555, 'specificity': 0.8755555, 'f1': 0.874923, 'auroc': 0.94010866, 'binary_precision': 0.93782383, 'binary_recall': 0.80444443, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.86602867}
confusion matrix:
     0    1
0  213   12
1   44  181
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-29 07:28:14.237268,epoch time: 0:01:49.733452,used: 0:16:34.113301,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.98646045, 'recall': 0.98632544, 'specificity': 0.98632544, 'f1': 0.9862561, 'auroc': 0.999239, 'binary_precision': 0.99800134, 'binary_recall': 0.9746259, 'binary_specificity': 0.998025, 'binary_f1_score': 0.9861752}
confusion matrix:
      0     1
0  1516     3
1    39  1498
---- Validation: 
scalar performance:
{'acc': 0.75078124, 'precision': 0.8107667, 'recall': 0.7466053, 'specificity': 0.7466053, 'f1': 0.73598707, 'auroc': 0.8885497, 'binary_precision': 0.9426934, 'binary_recall': 0.52388537, 'binary_specificity': 0.9693251, 'binary_f1_score': 0.67349035}
confusion matrix:
     0    1
0  632   20
1  299  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70666665, 'precision': 0.8102298, 'recall': 0.7066667, 'specificity': 0.7066667, 'f1': 0.6799569, 'auroc': 0.91340244, 'binary_precision': 0.9894737, 'binary_recall': 0.41777778, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.5875}
confusion matrix:
     0   1
0  224   1
1  131  94
early stop counter: 1
val acc:0.750781238079071, best validation acc: 0.8382812738418579, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 10,now: 2024-07-29 07:30:03.728582,epoch time: 0:01:49.491314,used: 0:18:23.604615,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.992822, 'recall': 0.9927865, 'specificity': 0.9927865, 'f1': 0.9928005, 'auroc': 0.9997742, 'binary_precision': 0.9909385, 'binary_recall': 0.9948018, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9928664}
confusion matrix:
      0     1
0  1503    14
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.8179687, 'precision': 0.8196695, 'recall': 0.81724536, 'specificity': 0.81724536, 'f1': 0.81743824, 'auroc': 0.88709414, 'binary_precision': 0.838765, 'binary_recall': 0.77866244, 'binary_specificity': 0.8558282, 'binary_f1_score': 0.80759704}
confusion matrix:
     0    1
0  558   94
1  139  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8401075, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8399874, 'auroc': 0.90386176, 'binary_precision': 0.84615386, 'binary_recall': 0.83111113, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8385651}
confusion matrix:
     0    1
0  191   34
1   38  187
early stop counter: 2
val acc:0.8179687261581421, best validation acc: 0.8382812738418579, corresponding to test acc:                         0.8755555748939514 / 0.8755555748939514
after epoch: 11,now: 2024-07-29 07:31:54.363980,epoch time: 0:01:50.635398,used: 0:20:14.240013,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98991454, 'recall': 0.98990965, 'specificity': 0.98990965, 'f1': 0.989856, 'auroc': 0.99928725, 'binary_precision': 0.9973615, 'binary_recall': 0.98245615, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9898527}
confusion matrix:
      0     1
0  1513     4
1    27  1512
---- Validation: 
scalar performance:
{'acc': 0.8234375, 'precision': 0.8384628, 'recall': 0.8214411, 'specificity': 0.8214411, 'f1': 0.8207754, 'auroc': 0.913622, 'binary_precision': 0.9052419, 'binary_recall': 0.71496814, 'binary_specificity': 0.9279141, 'binary_f1_score': 0.7989324}
confusion matrix:
     0    1
0  605   47
1  179  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88222224, 'precision': 0.89406157, 'recall': 0.8822222, 'specificity': 0.8822222, 'f1': 0.88133085, 'auroc': 0.92564934, 'binary_precision': 0.96236557, 'binary_recall': 0.79555553, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8710462}
confusion matrix:
     0    1
0  218    7
1   46  179
new oracle model saved
early stop counter: 3
val acc:0.823437511920929, best validation acc: 0.8382812738418579, corresponding to test acc:                         0.8755555748939514 / 0.8822222352027893
after epoch: 12,now: 2024-07-29 07:33:35.415243,epoch time: 0:01:41.051263,used: 0:21:55.291276,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99087036, 'recall': 0.9908166, 'specificity': 0.9908166, 'f1': 0.99083674, 'auroc': 0.9995259, 'binary_precision': 0.9883721, 'binary_recall': 0.9935065, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9909327}
confusion matrix:
      0     1
0  1498    18
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.8359375, 'precision': 0.8385713, 'recall': 0.8350885, 'specificity': 0.8350885, 'f1': 0.83532596, 'auroc': 0.89097977, 'binary_precision': 0.8641115, 'binary_recall': 0.7898089, 'binary_specificity': 0.8803681, 'binary_f1_score': 0.82529116}
confusion matrix:
     0    1
0  574   78
1  132  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8844444, 'precision': 0.88750625, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.8842158, 'auroc': 0.9291061, 'binary_precision': 0.92195123, 'binary_recall': 0.84, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8790698}
confusion matrix:
     0    1
0  209   16
1   36  189
new oracle model saved
early stop counter: 4
val acc:0.8359375, best validation acc: 0.8382812738418579, corresponding to test acc:                         0.8755555748939514 / 0.8844444155693054
after epoch: 13,now: 2024-07-29 07:35:11.962455,epoch time: 0:01:36.547212,used: 0:23:31.838488,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927993, 'recall': 0.9928162, 'specificity': 0.9928162, 'f1': 0.99280095, 'auroc': 0.9997035, 'binary_precision': 0.9954218, 'binary_recall': 0.99024075, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.99282455}
confusion matrix:
      0     1
0  1512     7
1    15  1522
---- Validation: 
scalar performance:
{'acc': 0.7914063, 'precision': 0.82206595, 'recall': 0.78847545, 'specificity': 0.78847545, 'f1': 0.78511596, 'auroc': 0.9051546, 'binary_precision': 0.91685915, 'binary_recall': 0.6321656, 'binary_specificity': 0.9447853, 'binary_f1_score': 0.7483506}
confusion matrix:
     0    1
0  616   36
1  231  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.86, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8148571, 'auroc': 0.93625677, 'binary_precision': 0.98, 'binary_recall': 0.6533333, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.784}
confusion matrix:
     0    1
0  222    3
1   78  147
early stop counter: 5
val acc:0.7914062738418579, best validation acc: 0.8382812738418579, corresponding to test acc:                         0.8755555748939514 / 0.8844444155693054
after epoch: 14,now: 2024-07-29 07:36:46.627050,epoch time: 0:01:34.664595,used: 0:25:06.503083,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_11_39_seed_14_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:25:06.503083 at 2024-07-29 07:36:46.627050
persisted model performance metric: 

scalar performance:
{'acc': 0.8755556, 'precision': 0.88330877, 'recall': 0.8755555, 'specificity': 0.8755555, 'f1': 0.874923, 'auroc': 0.94010866, 'binary_precision': 0.93782383, 'binary_recall': 0.80444443, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.86602867}
confusion matrix:
     0    1
0  213   12
1   44  181
oracle model performance metric: 

scalar performance:
{'acc': 0.8844444, 'precision': 0.88750625, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.8842158, 'auroc': 0.9291061, 'binary_precision': 0.92195123, 'binary_recall': 0.84, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8790698}
confusion matrix:
     0    1
0  209   16
1   36  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454065 KiB |   2004 MiB | 369160 GiB | 369160 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 364412 GiB | 364411 GiB |
|       from small pool |  40598 KiB |     60 MiB |   4748 GiB |   4748 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454065 KiB |   2004 MiB | 369160 GiB | 369160 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 364412 GiB | 364411 GiB |
|       from small pool |  40598 KiB |     60 MiB |   4748 GiB |   4748 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 368786 GiB | 368786 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 364047 GiB | 364047 GiB |
|       from small pool |  40406 KiB |     60 MiB |   4738 GiB |   4738 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2290 MiB |  22748 MiB |  20466 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  22422 MiB |  20210 MiB |
|       from small pool |     70 MiB |     70 MiB |    326 MiB |    256 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387662 KiB | 489230 KiB | 289599 GiB | 289599 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 284603 GiB | 284603 GiB |
|       from small pool |   6505 KiB |  22276 KiB |   4996 GiB |   4996 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   70657 K  |   70655 K  |
|       from large pool |     187    |     311    |   33906 K  |   33906 K  |
|       from small pool |    1123    |    1419    |   36750 K  |   36749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   70657 K  |   70655 K  |
|       from large pool |     187    |     311    |   33906 K  |   33906 K  |
|       from small pool |    1123    |    1419    |   36750 K  |   36749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |    1069    |     942    |
|       from large pool |      92    |      93    |     906    |     814    |
|       from small pool |      35    |      35    |     163    |     128    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |     261    |   37957 K  |   37957 K  |
|       from large pool |      35    |      96    |   23408 K  |   23408 K  |
|       from small pool |      36    |     223    |   14548 K  |   14548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 369160 GiB | 369160 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 364412 GiB | 364412 GiB |
|       from small pool |      0 KiB |     60 MiB |   4748 GiB |   4748 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 369160 GiB | 369160 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 364412 GiB | 364412 GiB |
|       from small pool |      0 KiB |     60 MiB |   4748 GiB |   4748 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 368786 GiB | 368786 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 364047 GiB | 364047 GiB |
|       from small pool |      0 KiB |     60 MiB |   4738 GiB |   4738 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  22748 MiB |  21926 MiB |
|       from large pool |    776 MiB |   2226 MiB |  22422 MiB |  21646 MiB |
|       from small pool |     46 MiB |     70 MiB |    326 MiB |    280 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 289600 GiB | 289600 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 284603 GiB | 284603 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4996 GiB |   4996 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   70657 K  |   70657 K  |
|       from large pool |       2    |     311    |   33906 K  |   33906 K  |
|       from small pool |       0    |    1419    |   36750 K  |   36750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   70657 K  |   70657 K  |
|       from large pool |       2    |     311    |   33906 K  |   33906 K  |
|       from small pool |       0    |    1419    |   36750 K  |   36750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1069    |    1012    |
|       from large pool |      34    |      93    |     906    |     872    |
|       from small pool |      23    |      35    |     163    |     140    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   37957 K  |   37957 K  |
|       from large pool |       4    |      96    |   23408 K  |   23408 K  |
|       from small pool |       0    |     223    |   14548 K  |   14548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 369160 GiB | 369160 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 364412 GiB | 364412 GiB |
|       from small pool |      0 KiB |     60 MiB |   4748 GiB |   4748 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 369160 GiB | 369160 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 364412 GiB | 364412 GiB |
|       from small pool |      0 KiB |     60 MiB |   4748 GiB |   4748 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 368786 GiB | 368786 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 364047 GiB | 364047 GiB |
|       from small pool |      0 KiB |     60 MiB |   4738 GiB |   4738 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  22748 MiB |  21926 MiB |
|       from large pool |    776 MiB |   2226 MiB |  22422 MiB |  21646 MiB |
|       from small pool |     46 MiB |     70 MiB |    326 MiB |    280 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 289600 GiB | 289600 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 284603 GiB | 284603 GiB |
|       from small pool |      0 KiB |  22276 KiB |   4996 GiB |   4996 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   70657 K  |   70657 K  |
|       from large pool |       2    |     311    |   33906 K  |   33906 K  |
|       from small pool |       0    |    1419    |   36750 K  |   36750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   70657 K  |   70657 K  |
|       from large pool |       2    |     311    |   33906 K  |   33906 K  |
|       from small pool |       0    |    1419    |   36750 K  |   36750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1069    |    1012    |
|       from large pool |      34    |      93    |     906    |     872    |
|       from small pool |      23    |      35    |     163    |     140    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   37957 K  |   37957 K  |
|       from large pool |       4    |      96    |   23408 K  |   23408 K  |
|       from small pool |       0    |     223    |   14548 K  |   14548 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370

 Experiment start at: 2024-07-29 07:37:31.941380
before training, model accuracy: 0.5043668150901794
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.9626976, 'recall': 0.96172726, 'specificity': 0.96172726, 'f1': 0.96125233, 'auroc': 0.99494654, 'binary_precision': 0.99247605, 'binary_recall': 0.9307248, 'binary_specificity': 0.99272966, 'binary_f1_score': 0.9606091}
confusion matrix:
      0     1
0  1502    11
1   108  1451
---- Validation: 
scalar performance:
{'acc': 0.59415835, 'precision': 0.71198326, 'recall': 0.59097064, 'specificity': 0.59097064, 'f1': 0.524812, 'auroc': 0.82229155, 'binary_precision': 0.8679245, 'binary_recall': 0.2139535, 'binary_specificity': 0.9679878, 'binary_f1_score': 0.34328362}
confusion matrix:
     0    1
0  635   21
1  507  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7467249, 'precision': 0.80204034, 'recall': 0.74672484, 'specificity': 0.74672484, 'f1': 0.73457235, 'auroc': 0.8850899, 'binary_precision': 0.9312977, 'binary_recall': 0.5327511, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.67777777}
confusion matrix:
     0    1
0  220    9
1  107  122
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:39:17.553635,epoch time: 0:01:45.612255,used: 0:01:45.612255,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9762274, 'recall': 0.9762365, 'specificity': 0.9762365, 'f1': 0.9762318, 'auroc': 0.9974588, 'binary_precision': 0.9768934, 'binary_recall': 0.97626686, 'binary_specificity': 0.9762062, 'binary_f1_score': 0.97658}
confusion matrix:
      0     1
0  1477    36
1    37  1522
---- Validation: 
scalar performance:
{'acc': 0.6541122, 'precision': 0.7185159, 'recall': 0.65178674, 'specificity': 0.65178674, 'f1': 0.6245613, 'auroc': 0.811895, 'binary_precision': 0.83505154, 'binary_recall': 0.37674418, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.5192308}
confusion matrix:
     0    1
0  608   48
1  402  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71834064, 'precision': 0.7737139, 'recall': 0.71834064, 'specificity': 0.71834064, 'f1': 0.7033366, 'auroc': 0.86920536, 'binary_precision': 0.8968254, 'binary_recall': 0.49344978, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.63661975}
confusion matrix:
     0    1
0  216   13
1  116  113
better model found
persisted
after epoch: 2,now: 2024-07-29 07:41:09.860478,epoch time: 0:01:52.306843,used: 0:03:37.919098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97264224, 'recall': 0.9726598, 'specificity': 0.9726598, 'f1': 0.97265065, 'auroc': 0.99647915, 'binary_precision': 0.9736673, 'binary_recall': 0.9724182, 'binary_specificity': 0.9729015, 'binary_f1_score': 0.97304237}
confusion matrix:
      0     1
0  1472    41
1    43  1516
---- Validation: 
scalar performance:
{'acc': 0.8086088, 'precision': 0.8255075, 'recall': 0.8076397, 'specificity': 0.8076397, 'f1': 0.8057437, 'auroc': 0.9025147, 'binary_precision': 0.89759034, 'binary_recall': 0.69302326, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.78215224}
confusion matrix:
     0    1
0  605   51
1  198  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.8371259, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.8287506, 'auroc': 0.89401424, 'binary_precision': 0.8871795, 'binary_recall': 0.75545853, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.81603783}
confusion matrix:
     0    1
0  207   22
1   56  173
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 07:42:57.091320,epoch time: 0:01:47.230842,used: 0:05:25.149940,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9814347, 'recall': 0.9809693, 'specificity': 0.9809693, 'f1': 0.9811082, 'auroc': 0.9984212, 'binary_precision': 0.97230965, 'binary_recall': 0.9910199, 'binary_specificity': 0.9709187, 'binary_f1_score': 0.9815756}
confusion matrix:
      0     1
0  1469    44
1    14  1545
---- Validation: 
scalar performance:
{'acc': 0.8285934, 'precision': 0.8386998, 'recall': 0.82785976, 'specificity': 0.82785976, 'f1': 0.82707274, 'auroc': 0.9085649, 'binary_precision': 0.8951311, 'binary_recall': 0.7410853, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.8108567}
confusion matrix:
     0    1
0  600   56
1  167  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.84619856, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.8276401, 'auroc': 0.9042543, 'binary_precision': 0.92178774, 'binary_recall': 0.720524, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.8088235}
confusion matrix:
     0    1
0  215   14
1   64  165
better model found
persisted
after epoch: 4,now: 2024-07-29 07:44:48.408461,epoch time: 0:01:51.317141,used: 0:07:16.467081,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9829348, 'recall': 0.9822141, 'specificity': 0.9822141, 'f1': 0.9824074, 'auroc': 0.998857, 'binary_precision': 0.970625, 'binary_recall': 0.99551284, 'binary_specificity': 0.96891534, 'binary_f1_score': 0.98291135}
confusion matrix:
      0     1
0  1465    47
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.7886241, 'precision': 0.8137444, 'recall': 0.7874197, 'specificity': 0.7874197, 'f1': 0.7838172, 'auroc': 0.8782426, 'binary_precision': 0.9004329, 'binary_recall': 0.64496124, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.75158083}
confusion matrix:
     0    1
0  610   46
1  229  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8485334, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.8347883, 'auroc': 0.89632154, 'binary_precision': 0.9139785, 'binary_recall': 0.7423581, 'binary_specificity': 0.930131, 'binary_f1_score': 0.81927717}
confusion matrix:
     0    1
0  213   16
1   59  170
new oracle model saved
early stop counter: 1
val acc:0.788624107837677, best validation acc: 0.828593373298645, corresponding to test acc:                         0.8296943306922913 / 0.836244523525238
after epoch: 5,now: 2024-07-29 07:46:30.258550,epoch time: 0:01:41.850089,used: 0:08:58.317170,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98793626, 'recall': 0.98797655, 'specificity': 0.98797655, 'f1': 0.9879538, 'auroc': 0.9991361, 'binary_precision': 0.98969734, 'binary_recall': 0.9865212, 'binary_specificity': 0.989432, 'binary_f1_score': 0.9881067}
confusion matrix:
      0     1
0  1498    16
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.76940817, 'precision': 0.7914041, 'recall': 0.7682348, 'specificity': 0.7682348, 'f1': 0.76443684, 'auroc': 0.8691553, 'binary_precision': 0.86937904, 'binary_recall': 0.62945735, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.73021585}
confusion matrix:
     0    1
0  595   61
1  239  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860262, 'precision': 0.8257857, 'recall': 0.7860262, 'specificity': 0.7860262, 'f1': 0.7792923, 'auroc': 0.8895902, 'binary_precision': 0.9395973, 'binary_recall': 0.6113537, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.7407407}
confusion matrix:
     0    1
0  220    9
1   89  140
early stop counter: 2
val acc:0.7694081664085388, best validation acc: 0.828593373298645, corresponding to test acc:                         0.8296943306922913 / 0.836244523525238
after epoch: 6,now: 2024-07-29 07:48:16.159371,epoch time: 0:01:45.900821,used: 0:10:44.217991,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866313, 'recall': 0.986709, 'specificity': 0.986709, 'f1': 0.9866525, 'auroc': 0.9989817, 'binary_precision': 0.99093264, 'binary_recall': 0.982659, 'binary_specificity': 0.9907591, 'binary_f1_score': 0.9867785}
confusion matrix:
      0     1
0  1501    14
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.7563413, 'precision': 0.8068795, 'recall': 0.75461453, 'specificity': 0.75461453, 'f1': 0.7450321, 'auroc': 0.8995397, 'binary_precision': 0.9293194, 'binary_recall': 0.5503876, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.691334}
confusion matrix:
     0    1
0  629   27
1  290  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.8500364, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.81716394, 'auroc': 0.8908297, 'binary_precision': 0.9509202, 'binary_recall': 0.6768559, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.79081637}
confusion matrix:
     0    1
0  221    8
1   74  155
early stop counter: 3
val acc:0.756341278553009, best validation acc: 0.828593373298645, corresponding to test acc:                         0.8296943306922913 / 0.836244523525238
after epoch: 7,now: 2024-07-29 07:50:07.285125,epoch time: 0:01:51.125754,used: 0:12:35.343745,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.96942157, 'recall': 0.9670215, 'specificity': 0.9670215, 'f1': 0.9673859, 'auroc': 0.9993048, 'binary_precision': 0.9423544, 'binary_recall': 0.99679077, 'binary_specificity': 0.9372523, 'binary_f1_score': 0.96880853}
confusion matrix:
      0     1
0  1419    95
1     5  1553
---- Validation: 
scalar performance:
{'acc': 0.7563413, 'precision': 0.79019755, 'recall': 0.75777316, 'specificity': 0.75777316, 'f1': 0.7496948, 'auroc': 0.874454, 'binary_precision': 0.6889401, 'binary_recall': 0.9271318, 'binary_specificity': 0.5884146, 'binary_f1_score': 0.79048246}
confusion matrix:
     0    1
0  386  270
1   47  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7620087, 'precision': 0.79947686, 'recall': 0.7620088, 'specificity': 0.7620088, 'f1': 0.75432456, 'auroc': 0.8834118, 'binary_precision': 0.6935484, 'binary_recall': 0.93886465, 'binary_specificity': 0.58515286, 'binary_f1_score': 0.79777366}
confusion matrix:
     0    1
0  134   95
1   14  215
early stop counter: 4
val acc:0.756341278553009, best validation acc: 0.828593373298645, corresponding to test acc:                         0.8296943306922913 / 0.836244523525238
after epoch: 8,now: 2024-07-29 07:51:51.347305,epoch time: 0:01:44.062180,used: 0:14:19.405925,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889622, 'recall': 0.98890495, 'specificity': 0.98890495, 'f1': 0.9889298, 'auroc': 0.9991212, 'binary_precision': 0.9871959, 'binary_recall': 0.99100256, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.98909557}
confusion matrix:
      0     1
0  1496    20
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.81245196, 'precision': 0.8283769, 'recall': 0.8115157, 'specificity': 0.8115157, 'f1': 0.8098217, 'auroc': 0.9033395, 'binary_precision': 0.8986083, 'binary_recall': 0.7007752, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.7874564}
confusion matrix:
     0    1
0  605   51
1  193  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275109, 'precision': 0.8507966, 'recall': 0.8275109, 'specificity': 0.8275109, 'f1': 0.8246002, 'auroc': 0.91298795, 'binary_precision': 0.9411765, 'binary_recall': 0.69868994, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.802005}
confusion matrix:
     0    1
0  219   10
1   69  160
early stop counter: 5
val acc:0.812451958656311, best validation acc: 0.828593373298645, corresponding to test acc:                         0.8296943306922913 / 0.836244523525238
after epoch: 9,now: 2024-07-29 07:53:38.506959,epoch time: 0:01:47.159654,used: 0:16:06.565579,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_37_31_seed_15_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:16:06.565579 at 2024-07-29 07:53:38.506959
persisted model performance metric: 

scalar performance:
{'acc': 0.82969433, 'precision': 0.84619856, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.8276401, 'auroc': 0.9042543, 'binary_precision': 0.92178774, 'binary_recall': 0.720524, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.8088235}
confusion matrix:
     0    1
0  215   14
1   64  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8362445, 'precision': 0.8485334, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.8347883, 'auroc': 0.89632154, 'binary_precision': 0.9139785, 'binary_recall': 0.7423581, 'binary_specificity': 0.930131, 'binary_f1_score': 0.81927717}
confusion matrix:
     0    1
0  213   16
1   59  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454065 KiB |   2004 MiB | 388830 GiB | 388829 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 383828 GiB | 383827 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5001 GiB |   5001 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454065 KiB |   2004 MiB | 388830 GiB | 388829 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 383828 GiB | 383827 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5001 GiB |   5001 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |   1998 MiB | 388446 GiB | 388446 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 383455 GiB | 383454 GiB |
|       from small pool |  40407 KiB |     60 MiB |   4991 GiB |   4991 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  24202 MiB |  21926 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  23858 MiB |  21646 MiB |
|       from small pool |     64 MiB |     70 MiB |    344 MiB |    280 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387662 KiB | 489230 KiB | 305037 GiB | 305037 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 299775 GiB | 299774 GiB |
|       from small pool |   6505 KiB |  22276 KiB |   5262 GiB |   5262 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    1681    |   74428 K  |   74427 K  |
|       from large pool |     187    |     311    |   35715 K  |   35715 K  |
|       from small pool |    1123    |    1419    |   38713 K  |   38712 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    1681    |   74428 K  |   74427 K  |
|       from large pool |     187    |     311    |   35715 K  |   35715 K  |
|       from small pool |    1123    |    1419    |   38713 K  |   38712 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |    1136    |    1012    |
|       from large pool |      92    |      93    |     964    |     872    |
|       from small pool |      32    |      35    |     172    |     140    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      72    |     261    |   40049 K  |   40049 K  |
|       from large pool |      35    |      96    |   24729 K  |   24729 K  |
|       from small pool |      37    |     223    |   15320 K  |   15320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 388830 GiB | 388830 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 383828 GiB | 383828 GiB |
|       from small pool |      0 KiB |     60 MiB |   5001 GiB |   5001 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 388830 GiB | 388830 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 383828 GiB | 383828 GiB |
|       from small pool |      0 KiB |     60 MiB |   5001 GiB |   5001 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 388446 GiB | 388446 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 383455 GiB | 383455 GiB |
|       from small pool |      0 KiB |     60 MiB |   4991 GiB |   4991 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  24202 MiB |  23380 MiB |
|       from large pool |    776 MiB |   2226 MiB |  23858 MiB |  23082 MiB |
|       from small pool |     46 MiB |     70 MiB |    344 MiB |    298 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 305038 GiB | 305038 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 299775 GiB | 299775 GiB |
|       from small pool |      0 KiB |  22276 KiB |   5262 GiB |   5262 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   74428 K  |   74428 K  |
|       from large pool |       2    |     311    |   35715 K  |   35715 K  |
|       from small pool |       0    |    1419    |   38713 K  |   38713 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   74428 K  |   74428 K  |
|       from large pool |       2    |     311    |   35715 K  |   35715 K  |
|       from small pool |       0    |    1419    |   38713 K  |   38713 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1136    |    1079    |
|       from large pool |      34    |      93    |     964    |     930    |
|       from small pool |      23    |      35    |     172    |     149    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   40049 K  |   40049 K  |
|       from large pool |       4    |      96    |   24729 K  |   24729 K  |
|       from small pool |       0    |     223    |   15320 K  |   15320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 388830 GiB | 388830 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 383828 GiB | 383828 GiB |
|       from small pool |      0 KiB |     60 MiB |   5001 GiB |   5001 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 388830 GiB | 388830 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 383828 GiB | 383828 GiB |
|       from small pool |      0 KiB |     60 MiB |   5001 GiB |   5001 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 388446 GiB | 388446 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 383455 GiB | 383455 GiB |
|       from small pool |      0 KiB |     60 MiB |   4991 GiB |   4991 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  24202 MiB |  23380 MiB |
|       from large pool |    776 MiB |   2226 MiB |  23858 MiB |  23082 MiB |
|       from small pool |     46 MiB |     70 MiB |    344 MiB |    298 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 305038 GiB | 305038 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 299775 GiB | 299775 GiB |
|       from small pool |      0 KiB |  22276 KiB |   5262 GiB |   5262 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   74428 K  |   74428 K  |
|       from large pool |       2    |     311    |   35715 K  |   35715 K  |
|       from small pool |       0    |    1419    |   38713 K  |   38713 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   74428 K  |   74428 K  |
|       from large pool |       2    |     311    |   35715 K  |   35715 K  |
|       from small pool |       0    |    1419    |   38713 K  |   38713 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1136    |    1079    |
|       from large pool |      34    |      93    |     964    |     930    |
|       from small pool |      23    |      35    |     172    |     149    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   40049 K  |   40049 K  |
|       from large pool |       4    |      96    |   24729 K  |   24729 K  |
|       from small pool |       0    |     223    |   15320 K  |   15320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370

 Experiment start at: 2024-07-29 07:54:29.298127
before training, model accuracy: 0.40740740299224854
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97771823, 'recall': 0.9778574, 'specificity': 0.9778574, 'f1': 0.9777459, 'auroc': 0.99724, 'binary_precision': 0.9843648, 'binary_recall': 0.9717042, 'binary_specificity': 0.98401064, 'binary_f1_score': 0.9779935}
confusion matrix:
      0     1
0  1477    24
1    44  1511
---- Validation: 
scalar performance:
{'acc': 0.80389106, 'precision': 0.8234544, 'recall': 0.79965633, 'specificity': 0.79965633, 'f1': 0.7991709, 'auroc': 0.9065004, 'binary_precision': 0.89507496, 'binary_recall': 0.67310786, 'binary_specificity': 0.9262048, 'binary_f1_score': 0.7683824}
confusion matrix:
     0    1
0  615   49
1  203  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7546296, 'precision': 0.7884896, 'recall': 0.7546296, 'specificity': 0.7546296, 'f1': 0.74721223, 'auroc': 0.8715278, 'binary_precision': 0.8873239, 'binary_recall': 0.5833333, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.7039106}
confusion matrix:
     0    1
0  200   16
1   90  126
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:56:19.493470,epoch time: 0:01:50.195343,used: 0:01:50.195343,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9633508, 'precision': 0.96532154, 'recall': 0.96283036, 'specificity': 0.96283036, 'f1': 0.9632715, 'auroc': 0.997596, 'binary_precision': 0.93913573, 'binary_recall': 0.992283, 'binary_specificity': 0.93337774, 'binary_f1_score': 0.96497816}
confusion matrix:
      0     1
0  1401   100
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.8342413, 'precision': 0.83406496, 'recall': 0.8340293, 'specificity': 0.8340293, 'f1': 0.8340467, 'auroc': 0.8975588, 'binary_precision': 0.82903224, 'binary_recall': 0.8276973, 'binary_specificity': 0.8403614, 'binary_f1_score': 0.82836425}
confusion matrix:
     0    1
0  558  106
1  107  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.8243243, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.8240402, 'auroc': 0.87502146, 'binary_precision': 0.8333333, 'binary_recall': 0.8101852, 'binary_specificity': 0.837963, 'binary_f1_score': 0.82159626}
confusion matrix:
     0    1
0  181   35
1   41  175
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 07:58:02.229641,epoch time: 0:01:42.736171,used: 0:03:32.931514,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9813136, 'recall': 0.98141277, 'specificity': 0.98141277, 'f1': 0.9813454, 'auroc': 0.997911, 'binary_precision': 0.98571426, 'binary_recall': 0.97746295, 'binary_specificity': 0.9853626, 'binary_f1_score': 0.9815713}
confusion matrix:
      0     1
0  1481    22
1    35  1518
---- Validation: 
scalar performance:
{'acc': 0.68560314, 'precision': 0.76703423, 'recall': 0.6760217, 'specificity': 0.6760217, 'f1': 0.65242743, 'auroc': 0.8863061, 'binary_precision': 0.90636706, 'binary_recall': 0.38969404, 'binary_specificity': 0.9623494, 'binary_f1_score': 0.5450451}
confusion matrix:
     0    1
0  639   25
1  379  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.7743969, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.73550296, 'auroc': 0.8560957, 'binary_precision': 0.86713284, 'binary_recall': 0.5740741, 'binary_specificity': 0.912037, 'binary_f1_score': 0.6908078}
confusion matrix:
     0    1
0  197   19
1   92  124
early stop counter: 1
val acc:0.685603141784668, best validation acc: 0.8342412710189819, corresponding to test acc:                         0.8240740895271301 / 0.8240740895271301
after epoch: 3,now: 2024-07-29 07:59:51.144228,epoch time: 0:01:48.914587,used: 0:05:21.846101,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9795388, 'recall': 0.9796183, 'specificity': 0.9796183, 'f1': 0.97938466, 'auroc': 0.99871814, 'binary_precision': 0.99338186, 'binary_recall': 0.96589446, 'binary_specificity': 0.9933422, 'binary_f1_score': 0.97944534}
confusion matrix:
      0     1
0  1492    10
1    53  1501
---- Validation: 
scalar performance:
{'acc': 0.6614786, 'precision': 0.7669579, 'recall': 0.6505927, 'specificity': 0.6505927, 'f1': 0.6151129, 'auroc': 0.87982845, 'binary_precision': 0.9266055, 'binary_recall': 0.3252818, 'binary_specificity': 0.97590363, 'binary_f1_score': 0.4815256}
confusion matrix:
     0    1
0  648   16
1  419  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6898148, 'precision': 0.7831202, 'recall': 0.6898148, 'specificity': 0.6898148, 'f1': 0.66196394, 'auroc': 0.88016546, 'binary_precision': 0.9456522, 'binary_recall': 0.4027778, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.5649351}
confusion matrix:
     0   1
0  211   5
1  129  87
early stop counter: 2
val acc:0.661478579044342, best validation acc: 0.8342412710189819, corresponding to test acc:                         0.8240740895271301 / 0.8240740895271301
after epoch: 4,now: 2024-07-29 08:01:34.726241,epoch time: 0:01:43.582013,used: 0:07:05.428114,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.9808568, 'recall': 0.9809188, 'specificity': 0.9809188, 'f1': 0.9806936, 'auroc': 0.99871945, 'binary_precision': 0.994702, 'binary_recall': 0.96716034, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.98073786}
confusion matrix:
      0     1
0  1495     8
1    51  1502
---- Validation: 
scalar performance:
{'acc': 0.69338524, 'precision': 0.7930661, 'recall': 0.6833433, 'specificity': 0.6833433, 'f1': 0.65768087, 'auroc': 0.92940056, 'binary_precision': 0.9558233, 'binary_recall': 0.38325283, 'binary_specificity': 0.9834337, 'binary_f1_score': 0.5471264}
confusion matrix:
     0    1
0  653   11
1  383  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.73457485, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.46424845, 'auroc': 0.8849666, 'binary_precision': 0.9354839, 'binary_recall': 0.13425925, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.2348178}
confusion matrix:
     0   1
0  214   2
1  187  29
early stop counter: 3
val acc:0.6933852434158325, best validation acc: 0.8342412710189819, corresponding to test acc:                         0.8240740895271301 / 0.8240740895271301
after epoch: 5,now: 2024-07-29 08:03:15.104855,epoch time: 0:01:40.378614,used: 0:08:45.806728,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98751926, 'recall': 0.98764795, 'specificity': 0.98764795, 'f1': 0.9875629, 'auroc': 0.99917865, 'binary_precision': 0.99222296, 'binary_recall': 0.9833012, 'binary_specificity': 0.9919947, 'binary_f1_score': 0.98774195}
confusion matrix:
      0     1
0  1487    12
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.80544746, 'precision': 0.8322896, 'recall': 0.80058885, 'specificity': 0.80058885, 'f1': 0.7995175, 'auroc': 0.9084672, 'binary_precision': 0.9187359, 'binary_recall': 0.65539455, 'binary_specificity': 0.94578314, 'binary_f1_score': 0.7650376}
confusion matrix:
     0    1
0  628   36
1  214  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.77787304, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7777587, 'auroc': 0.8505444, 'binary_precision': 0.7830189, 'binary_recall': 0.7685185, 'binary_specificity': 0.787037, 'binary_f1_score': 0.7757009}
confusion matrix:
     0    1
0  170   46
1   50  166
early stop counter: 4
val acc:0.8054474592208862, best validation acc: 0.8342412710189819, corresponding to test acc:                         0.8240740895271301 / 0.8240740895271301
after epoch: 6,now: 2024-07-29 08:05:12.778995,epoch time: 0:01:57.674140,used: 0:10:43.480868,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98854005, 'recall': 0.9885495, 'specificity': 0.9885495, 'f1': 0.98854464, 'auroc': 0.99939597, 'binary_precision': 0.98903227, 'binary_recall': 0.98839456, 'binary_specificity': 0.9887043, 'binary_f1_score': 0.9887133}
confusion matrix:
      0     1
0  1488    17
1    18  1533
---- Validation: 
scalar performance:
{'acc': 0.79066145, 'precision': 0.80600417, 'recall': 0.7867509, 'specificity': 0.7867509, 'f1': 0.78627944, 'auroc': 0.88475645, 'binary_precision': 0.8666667, 'binary_recall': 0.6698873, 'binary_specificity': 0.90361446, 'binary_f1_score': 0.7556767}
confusion matrix:
     0    1
0  600   64
1  205  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.7481618, 'recall': 0.7314815, 'specificity': 0.7314815, 'f1': 0.72689223, 'auroc': 0.8218236, 'binary_precision': 0.8125, 'binary_recall': 0.6018519, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.69148934}
confusion matrix:
     0    1
0  186   30
1   86  130
early stop counter: 5
val acc:0.7906614542007446, best validation acc: 0.8342412710189819, corresponding to test acc:                         0.8240740895271301 / 0.8240740895271301
after epoch: 7,now: 2024-07-29 08:06:47.175398,epoch time: 0:01:34.396403,used: 0:12:17.877271,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_54_29_seed_16_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:12:17.877271 at 2024-07-29 08:06:47.175398
persisted model performance metric: 

scalar performance:
{'acc': 0.8240741, 'precision': 0.8243243, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.8240402, 'auroc': 0.87502146, 'binary_precision': 0.8333333, 'binary_recall': 0.8101852, 'binary_specificity': 0.837963, 'binary_f1_score': 0.82159626}
confusion matrix:
     0    1
0  181   35
1   41  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8240741, 'precision': 0.8243243, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.8240402, 'auroc': 0.87502146, 'binary_precision': 0.8333333, 'binary_recall': 0.8101852, 'binary_specificity': 0.837963, 'binary_f1_score': 0.82159626}
confusion matrix:
     0    1
0  181   35
1   41  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454059 KiB |   2004 MiB | 404049 GiB | 404048 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 398851 GiB | 398851 GiB |
|       from small pool |  40592 KiB |     60 MiB |   5197 GiB |   5197 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454059 KiB |   2004 MiB | 404049 GiB | 404048 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 398851 GiB | 398851 GiB |
|       from small pool |  40592 KiB |     60 MiB |   5197 GiB |   5197 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 403658 GiB | 403658 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 398471 GiB | 398471 GiB |
|       from small pool |  40406 KiB |     60 MiB |   5187 GiB |   5187 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  25656 MiB |  23380 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  25294 MiB |  23082 MiB |
|       from small pool |     64 MiB |     70 MiB |    362 MiB |    298 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387668 KiB | 489230 KiB | 316980 GiB | 316980 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 311512 GiB | 311511 GiB |
|       from small pool |   6511 KiB |  22276 KiB |   5468 GiB |   5468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   77344 K  |   77342 K  |
|       from large pool |     187    |     311    |   37114 K  |   37114 K  |
|       from small pool |    1111    |    1419    |   40229 K  |   40228 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   77344 K  |   77342 K  |
|       from large pool |     187    |     311    |   37114 K  |   37114 K  |
|       from small pool |    1111    |    1419    |   40229 K  |   40228 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |    1203    |    1079    |
|       from large pool |      92    |      93    |    1022    |     930    |
|       from small pool |      32    |      35    |     181    |     149    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      75    |     261    |   41671 K  |   41671 K  |
|       from large pool |      35    |      96    |   25749 K  |   25749 K  |
|       from small pool |      40    |     223    |   15922 K  |   15922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 404049 GiB | 404049 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 398851 GiB | 398851 GiB |
|       from small pool |      0 KiB |     60 MiB |   5197 GiB |   5197 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 404049 GiB | 404049 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 398851 GiB | 398851 GiB |
|       from small pool |      0 KiB |     60 MiB |   5197 GiB |   5197 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 403658 GiB | 403658 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 398471 GiB | 398471 GiB |
|       from small pool |      0 KiB |     60 MiB |   5187 GiB |   5187 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  25656 MiB |  24834 MiB |
|       from large pool |    776 MiB |   2226 MiB |  25294 MiB |  24518 MiB |
|       from small pool |     46 MiB |     70 MiB |    362 MiB |    316 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 316980 GiB | 316980 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 311512 GiB | 311512 GiB |
|       from small pool |      0 KiB |  22276 KiB |   5468 GiB |   5468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   77344 K  |   77344 K  |
|       from large pool |       2    |     311    |   37114 K  |   37114 K  |
|       from small pool |       0    |    1419    |   40229 K  |   40229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   77344 K  |   77344 K  |
|       from large pool |       2    |     311    |   37114 K  |   37114 K  |
|       from small pool |       0    |    1419    |   40229 K  |   40229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1203    |    1146    |
|       from large pool |      34    |      93    |    1022    |     988    |
|       from small pool |      23    |      35    |     181    |     158    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   41672 K  |   41672 K  |
|       from large pool |       4    |      96    |   25749 K  |   25749 K  |
|       from small pool |       0    |     223    |   15922 K  |   15922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 404049 GiB | 404049 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 398851 GiB | 398851 GiB |
|       from small pool |      0 KiB |     60 MiB |   5197 GiB |   5197 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 404049 GiB | 404049 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 398851 GiB | 398851 GiB |
|       from small pool |      0 KiB |     60 MiB |   5197 GiB |   5197 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 403658 GiB | 403658 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 398471 GiB | 398471 GiB |
|       from small pool |      0 KiB |     60 MiB |   5187 GiB |   5187 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  25656 MiB |  24834 MiB |
|       from large pool |    776 MiB |   2226 MiB |  25294 MiB |  24518 MiB |
|       from small pool |     46 MiB |     70 MiB |    362 MiB |    316 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 316980 GiB | 316980 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 311512 GiB | 311512 GiB |
|       from small pool |      0 KiB |  22276 KiB |   5468 GiB |   5468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   77344 K  |   77344 K  |
|       from large pool |       2    |     311    |   37114 K  |   37114 K  |
|       from small pool |       0    |    1419    |   40229 K  |   40229 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   77344 K  |   77344 K  |
|       from large pool |       2    |     311    |   37114 K  |   37114 K  |
|       from small pool |       0    |    1419    |   40229 K  |   40229 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1203    |    1146    |
|       from large pool |      34    |      93    |    1022    |     988    |
|       from small pool |      23    |      35    |     181    |     158    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   41672 K  |   41672 K  |
|       from large pool |       4    |      96    |   25749 K  |   25749 K  |
|       from small pool |       0    |     223    |   15922 K  |   15922 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370

 Experiment start at: 2024-07-29 08:07:26.062150
before training, model accuracy: 0.5279069542884827
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9697368, 'precision': 0.96975386, 'recall': 0.96977335, 'specificity': 0.96977335, 'f1': 0.9697367, 'auroc': 0.9940375, 'binary_precision': 0.9749175, 'binary_recall': 0.96472895, 'binary_specificity': 0.97481775, 'binary_f1_score': 0.9697964}
confusion matrix:
      0     1
0  1471    38
1    54  1477
---- Validation: 
scalar performance:
{'acc': 0.7560405, 'precision': 0.79311216, 'recall': 0.76051307, 'specificity': 0.76051307, 'f1': 0.7500886, 'auroc': 0.8967271, 'binary_precision': 0.682243, 'binary_recall': 0.9344, 'binary_specificity': 0.5866261, 'binary_f1_score': 0.78865635}
confusion matrix:
     0    1
0  386  272
1   41  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8171526, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79725873, 'auroc': 0.8952731, 'binary_precision': 0.7433962, 'binary_recall': 0.9162791, 'binary_specificity': 0.68372095, 'binary_f1_score': 0.8208333}
confusion matrix:
     0    1
0  147   68
1   18  197
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:09:15.864756,epoch time: 0:01:49.802606,used: 0:01:49.802606,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.97736037, 'recall': 0.9768735, 'specificity': 0.9768735, 'f1': 0.9769641, 'auroc': 0.9979353, 'binary_precision': 0.9656051, 'binary_recall': 0.98955613, 'binary_specificity': 0.96419096, 'binary_f1_score': 0.9774339}
confusion matrix:
      0     1
0  1454    54
1    16  1516
---- Validation: 
scalar performance:
{'acc': 0.79657054, 'precision': 0.80444396, 'recall': 0.7985824, 'specificity': 0.7985824, 'f1': 0.7958915, 'auroc': 0.8837981, 'binary_precision': 0.74863386, 'binary_recall': 0.8768, 'binary_specificity': 0.72036475, 'binary_f1_score': 0.8076639}
confusion matrix:
     0    1
0  474  184
1   77  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8270401, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81475526, 'auroc': 0.8978907, 'binary_precision': 0.7677165, 'binary_recall': 0.90697676, 'binary_specificity': 0.7255814, 'binary_f1_score': 0.8315565}
confusion matrix:
     0    1
0  156   59
1   20  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 08:10:58.020463,epoch time: 0:01:42.155707,used: 0:03:31.958313,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.9801332, 'recall': 0.9797375, 'specificity': 0.9797375, 'f1': 0.9796027, 'auroc': 0.99877465, 'binary_precision': 0.9979661, 'binary_recall': 0.9614631, 'binary_specificity': 0.99801195, 'binary_f1_score': 0.9793746}
confusion matrix:
      0     1
0  1506     3
1    59  1472
---- Validation: 
scalar performance:
{'acc': 0.71317226, 'precision': 0.7995318, 'recall': 0.70612156, 'specificity': 0.70612156, 'f1': 0.68637973, 'auroc': 0.89349544, 'binary_precision': 0.9540636, 'binary_recall': 0.432, 'binary_specificity': 0.98024315, 'binary_f1_score': 0.5947137}
confusion matrix:
     0    1
0  645   13
1  355  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.83055127, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.7470574, 'auroc': 0.91335857, 'binary_precision': 0.98275864, 'binary_recall': 0.53023255, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.68882173}
confusion matrix:
     0    1
0  213    2
1  101  114
early stop counter: 1
val acc:0.7131722569465637, best validation acc: 0.7965705394744873, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 3,now: 2024-07-29 08:12:41.332771,epoch time: 0:01:43.312308,used: 0:05:15.270621,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.982582, 'recall': 0.9825517, 'specificity': 0.9825517, 'f1': 0.9825642, 'auroc': 0.99870753, 'binary_precision': 0.9811321, 'binary_recall': 0.98433423, 'binary_specificity': 0.9807692, 'binary_f1_score': 0.98273057}
confusion matrix:
      0     1
0  1479    29
1    24  1508
---- Validation: 
scalar performance:
{'acc': 0.8168355, 'precision': 0.8386644, 'recall': 0.8135246, 'specificity': 0.8135246, 'f1': 0.8126396, 'auroc': 0.90769124, 'binary_precision': 0.91845495, 'binary_recall': 0.6848, 'binary_specificity': 0.94224924, 'binary_f1_score': 0.7846013}
confusion matrix:
     0    1
0  620   38
1  197  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8633102, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83686596, 'auroc': 0.92759323, 'binary_precision': 0.95625, 'binary_recall': 0.7116279, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.816}
confusion matrix:
     0    1
0  208    7
1   62  153
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 08:14:28.876834,epoch time: 0:01:47.544063,used: 0:07:02.814684,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.98424244, 'recall': 0.9841888, 'specificity': 0.9841888, 'f1': 0.9842088, 'auroc': 0.9987664, 'binary_precision': 0.9818182, 'binary_recall': 0.98694515, 'binary_specificity': 0.9814324, 'binary_f1_score': 0.984375}
confusion matrix:
      0     1
0  1480    28
1    20  1512
---- Validation: 
scalar performance:
{'acc': 0.82073265, 'precision': 0.8414337, 'recall': 0.8175246, 'specificity': 0.8175246, 'f1': 0.8168417, 'auroc': 0.9088973, 'binary_precision': 0.9193206, 'binary_recall': 0.6928, 'binary_specificity': 0.94224924, 'binary_f1_score': 0.790146}
confusion matrix:
     0    1
0  620   38
1  192  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.87615776, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8538377, 'auroc': 0.9403137, 'binary_precision': 0.96363634, 'binary_recall': 0.73953485, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.83684206}
confusion matrix:
     0    1
0  209    6
1   56  159
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 08:16:18.305642,epoch time: 0:01:49.428808,used: 0:08:52.243492,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9828947, 'precision': 0.98307, 'recall': 0.9829948, 'specificity': 0.9829948, 'f1': 0.98289454, 'auroc': 0.99849105, 'binary_precision': 0.99465597, 'binary_recall': 0.9712981, 'binary_specificity': 0.99469143, 'binary_f1_score': 0.9828383}
confusion matrix:
      0     1
0  1499     8
1    44  1489
---- Validation: 
scalar performance:
{'acc': 0.68667185, 'precision': 0.78412706, 'recall': 0.6789617, 'specificity': 0.6789617, 'f1': 0.6516131, 'auroc': 0.9131866, 'binary_precision': 0.9442231, 'binary_recall': 0.3792, 'binary_specificity': 0.9787234, 'binary_f1_score': 0.5410959}
confusion matrix:
     0    1
0  644   14
1  388  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67674416, 'precision': 0.78110373, 'recall': 0.6767442, 'specificity': 0.6767442, 'f1': 0.6436726, 'auroc': 0.931033, 'binary_precision': 0.95238096, 'binary_recall': 0.37209302, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.5351171}
confusion matrix:
     0   1
0  211   4
1  135  80
early stop counter: 1
val acc:0.6866718530654907, best validation acc: 0.8207326531410217, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 6,now: 2024-07-29 08:18:07.866310,epoch time: 0:01:49.560668,used: 0:10:41.804160,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97039473, 'precision': 0.971737, 'recall': 0.9706589, 'specificity': 0.9706589, 'f1': 0.97038317, 'auroc': 0.99824214, 'binary_precision': 0.9993084, 'binary_recall': 0.94198173, 'binary_specificity': 0.999336, 'binary_f1_score': 0.9697986}
confusion matrix:
      0     1
0  1505     1
1    89  1445
---- Validation: 
scalar performance:
{'acc': 0.60639125, 'precision': 0.75717044, 'recall': 0.5962809, 'specificity': 0.5962809, 'f1': 0.52759105, 'auroc': 0.90733194, 'binary_precision': 0.9477612, 'binary_recall': 0.2032, 'binary_specificity': 0.9893617, 'binary_f1_score': 0.33465084}
confusion matrix:
     0    1
0  651    7
1  498  127
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53488374, 'precision': 0.7590362, 'recall': 0.53488374, 'specificity': 0.53488374, 'f1': 0.40648723, 'auroc': 0.9417577, 'binary_precision': 1.0, 'binary_recall': 0.069767445, 'binary_specificity': 1.0, 'binary_f1_score': 0.13043478}
confusion matrix:
     0   1
0  215   0
1  200  15
early stop counter: 2
val acc:0.6063912510871887, best validation acc: 0.8207326531410217, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 7,now: 2024-07-29 08:19:53.919523,epoch time: 0:01:46.053213,used: 0:12:27.857373,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96151316, 'precision': 0.96432877, 'recall': 0.9612173, 'specificity': 0.9612173, 'f1': 0.96143484, 'auroc': 0.9990741, 'binary_precision': 0.9300912, 'binary_recall': 0.99869454, 'binary_specificity': 0.92374, 'binary_f1_score': 0.9631728}
confusion matrix:
      0     1
0  1393   115
1     2  1530
---- Validation: 
scalar performance:
{'acc': 0.7996882, 'precision': 0.8177469, 'recall': 0.80270517, 'specificity': 0.80270517, 'f1': 0.79779947, 'auroc': 0.91298723, 'binary_precision': 0.7352941, 'binary_recall': 0.92, 'binary_specificity': 0.6854103, 'binary_f1_score': 0.8173418}
confusion matrix:
     0    1
0  451  207
1   50  575
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8750218, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87184286, 'auroc': 0.9555868, 'binary_precision': 0.8418803, 'binary_recall': 0.9162791, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8775056}
confusion matrix:
     0    1
0  178   37
1   18  197
new oracle model saved
early stop counter: 3
val acc:0.7996882200241089, best validation acc: 0.8207326531410217, corresponding to test acc:                         0.8558139801025391 / 0.8720930218696594
after epoch: 8,now: 2024-07-29 08:21:43.113927,epoch time: 0:01:49.194404,used: 0:14:17.051777,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98223686, 'precision': 0.98242986, 'recall': 0.98235047, 'specificity': 0.98235047, 'f1': 0.9822366, 'auroc': 0.99830234, 'binary_precision': 0.9946524, 'binary_recall': 0.970013, 'binary_specificity': 0.9946879, 'binary_f1_score': 0.98217815}
confusion matrix:
      0     1
0  1498     8
1    46  1488
---- Validation: 
scalar performance:
{'acc': 0.7318784, 'precision': 0.7797394, 'recall': 0.72640485, 'specificity': 0.72640485, 'f1': 0.71669704, 'auroc': 0.8626796, 'binary_precision': 0.8891967, 'binary_recall': 0.5136, 'binary_specificity': 0.9392097, 'binary_f1_score': 0.6511156}
confusion matrix:
     0    1
0  618   40
1  304  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.8330817, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.76115984, 'auroc': 0.92700917, 'binary_precision': 0.9756098, 'binary_recall': 0.55813956, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.71005917}
confusion matrix:
     0    1
0  212    3
1   95  120
early stop counter: 4
val acc:0.731878399848938, best validation acc: 0.8207326531410217, corresponding to test acc:                         0.8558139801025391 / 0.8720930218696594
after epoch: 9,now: 2024-07-29 08:23:30.971362,epoch time: 0:01:47.857435,used: 0:16:04.909212,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.9880104, 'recall': 0.98794, 'specificity': 0.98794, 'f1': 0.98782885, 'auroc': 0.99942994, 'binary_precision': 1.0, 'binary_recall': 0.97588, 'binary_specificity': 1.0, 'binary_f1_score': 0.9877928}
confusion matrix:
      0     1
0  1506     0
1    37  1497
---- Validation: 
scalar performance:
{'acc': 0.6679657, 'precision': 0.7797271, 'recall': 0.6596413, 'specificity': 0.6596413, 'f1': 0.62438977, 'auroc': 0.9084425, 'binary_precision': 0.95022625, 'binary_recall': 0.336, 'binary_specificity': 0.9832827, 'binary_f1_score': 0.49645388}
confusion matrix:
     0    1
0  647   11
1  415  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.80844563, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.69022894, 'auroc': 0.9475825, 'binary_precision': 0.9791667, 'binary_recall': 0.4372093, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.6045016}
confusion matrix:
     0   1
0  213   2
1  121  94
early stop counter: 5
val acc:0.6679657101631165, best validation acc: 0.8207326531410217, corresponding to test acc:                         0.8558139801025391 / 0.8720930218696594
after epoch: 10,now: 2024-07-29 08:25:20.505692,epoch time: 0:01:49.534330,used: 0:17:54.443542,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_07_25_seed_17_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:17:54.443542 at 2024-07-29 08:25:20.505692
persisted model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.87615776, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8538377, 'auroc': 0.9403137, 'binary_precision': 0.96363634, 'binary_recall': 0.73953485, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.83684206}
confusion matrix:
     0    1
0  209    6
1   56  159
oracle model performance metric: 

scalar performance:
{'acc': 0.872093, 'precision': 0.8750218, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87184286, 'auroc': 0.9555868, 'binary_precision': 0.8418803, 'binary_recall': 0.9162791, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8775056}
confusion matrix:
     0    1
0  178   37
1   18  197
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454059 KiB |   2004 MiB | 425601 GiB | 425601 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 420127 GiB | 420126 GiB |
|       from small pool |  40592 KiB |     60 MiB |   5474 GiB |   5474 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454059 KiB |   2004 MiB | 425601 GiB | 425601 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 420127 GiB | 420126 GiB |
|       from small pool |  40592 KiB |     60 MiB |   5474 GiB |   5474 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |   1998 MiB | 425201 GiB | 425200 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 419737 GiB | 419737 GiB |
|       from small pool |  40405 KiB |     60 MiB |   5463 GiB |   5463 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  27110 MiB |  24834 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  26730 MiB |  24518 MiB |
|       from small pool |     64 MiB |     70 MiB |    380 MiB |    316 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387668 KiB | 489230 KiB | 333884 GiB | 333884 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 328125 GiB | 328124 GiB |
|       from small pool |   6511 KiB |  22276 KiB |   5759 GiB |   5759 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    1681    |   81472 K  |   81470 K  |
|       from large pool |     187    |     311    |   39096 K  |   39095 K  |
|       from small pool |    1111    |    1419    |   42376 K  |   42374 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    1681    |   81472 K  |   81470 K  |
|       from large pool |     187    |     311    |   39096 K  |   39095 K  |
|       from small pool |    1111    |    1419    |   42376 K  |   42374 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |    1270    |    1146    |
|       from large pool |      92    |      93    |    1080    |     988    |
|       from small pool |      32    |      35    |     190    |     158    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      73    |     261    |   43973 K  |   43973 K  |
|       from large pool |      35    |      96    |   27196 K  |   27196 K  |
|       from small pool |      38    |     223    |   16777 K  |   16777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 425601 GiB | 425601 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 420127 GiB | 420127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5474 GiB |   5474 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 425601 GiB | 425601 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 420127 GiB | 420127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5474 GiB |   5474 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 425201 GiB | 425201 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 419737 GiB | 419737 GiB |
|       from small pool |      0 KiB |     60 MiB |   5463 GiB |   5463 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  27110 MiB |  26288 MiB |
|       from large pool |    776 MiB |   2226 MiB |  26730 MiB |  25954 MiB |
|       from small pool |     46 MiB |     70 MiB |    380 MiB |    334 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 333885 GiB | 333885 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 328125 GiB | 328125 GiB |
|       from small pool |      0 KiB |  22276 KiB |   5759 GiB |   5759 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   81472 K  |   81472 K  |
|       from large pool |       2    |     311    |   39096 K  |   39096 K  |
|       from small pool |       0    |    1419    |   42376 K  |   42376 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   81472 K  |   81472 K  |
|       from large pool |       2    |     311    |   39096 K  |   39096 K  |
|       from small pool |       0    |    1419    |   42376 K  |   42376 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1270    |    1213    |
|       from large pool |      34    |      93    |    1080    |    1046    |
|       from small pool |      23    |      35    |     190    |     167    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   43973 K  |   43973 K  |
|       from large pool |       4    |      96    |   27196 K  |   27196 K  |
|       from small pool |       0    |     223    |   16777 K  |   16777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 425601 GiB | 425601 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 420127 GiB | 420127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5474 GiB |   5474 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 425601 GiB | 425601 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 420127 GiB | 420127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5474 GiB |   5474 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 425201 GiB | 425201 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 419737 GiB | 419737 GiB |
|       from small pool |      0 KiB |     60 MiB |   5463 GiB |   5463 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  27110 MiB |  26288 MiB |
|       from large pool |    776 MiB |   2226 MiB |  26730 MiB |  25954 MiB |
|       from small pool |     46 MiB |     70 MiB |    380 MiB |    334 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 333885 GiB | 333885 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 328125 GiB | 328125 GiB |
|       from small pool |      0 KiB |  22276 KiB |   5759 GiB |   5759 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   81472 K  |   81472 K  |
|       from large pool |       2    |     311    |   39096 K  |   39096 K  |
|       from small pool |       0    |    1419    |   42376 K  |   42376 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   81472 K  |   81472 K  |
|       from large pool |       2    |     311    |   39096 K  |   39096 K  |
|       from small pool |       0    |    1419    |   42376 K  |   42376 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1270    |    1213    |
|       from large pool |      34    |      93    |    1080    |    1046    |
|       from small pool |      23    |      35    |     190    |     167    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   43973 K  |   43973 K  |
|       from large pool |       4    |      96    |   27196 K  |   27196 K  |
|       from small pool |       0    |     223    |   16777 K  |   16777 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370

 Experiment start at: 2024-07-29 08:26:12.066406
before training, model accuracy: 0.35779815912246704
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9526316, 'precision': 0.9545838, 'recall': 0.9522665, 'specificity': 0.9522665, 'f1': 0.95254743, 'auroc': 0.99526167, 'binary_precision': 0.92760736, 'binary_recall': 0.98309493, 'binary_specificity': 0.9214381, 'binary_f1_score': 0.9545455}
confusion matrix:
      0     1
0  1384   118
1    26  1512
---- Validation: 
scalar performance:
{'acc': 0.79289025, 'precision': 0.81038475, 'recall': 0.7948806, 'specificity': 0.7948806, 'f1': 0.79064524, 'auroc': 0.9007164, 'binary_precision': 0.7323232, 'binary_recall': 0.9119497, 'binary_specificity': 0.67781156, 'binary_f1_score': 0.81232494}
confusion matrix:
     0    1
0  446  212
1   56  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88073397, 'precision': 0.88622785, 'recall': 0.88073397, 'specificity': 0.88073397, 'f1': 0.8803083, 'auroc': 0.9591154, 'binary_precision': 0.84016395, 'binary_recall': 0.940367, 'binary_specificity': 0.8211009, 'binary_f1_score': 0.88744587}
confusion matrix:
     0    1
0  179   39
1   13  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:28:12.795353,epoch time: 0:02:00.728947,used: 0:02:00.728947,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9819038, 'recall': 0.9819094, 'specificity': 0.9819094, 'f1': 0.98190653, 'auroc': 0.99805164, 'binary_precision': 0.9823875, 'binary_recall': 0.9817471, 'binary_specificity': 0.9820717, 'binary_f1_score': 0.9820672}
confusion matrix:
      0     1
0  1479    27
1    28  1506
---- Validation: 
scalar performance:
{'acc': 0.8493045, 'precision': 0.8539119, 'recall': 0.84832776, 'specificity': 0.84832776, 'f1': 0.84852207, 'auroc': 0.9089388, 'binary_precision': 0.89026546, 'binary_recall': 0.7908805, 'binary_specificity': 0.90577507, 'binary_f1_score': 0.8376353}
confusion matrix:
     0    1
0  596   62
1  133  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8944954, 'precision': 0.90318274, 'recall': 0.89449537, 'specificity': 0.89449537, 'f1': 0.893924, 'auroc': 0.95103526, 'binary_precision': 0.96236557, 'binary_recall': 0.8211009, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.88613856}
confusion matrix:
     0    1
0  211    7
1   39  179
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 08:29:58.340218,epoch time: 0:01:45.544865,used: 0:03:46.273812,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9661184, 'precision': 0.96748376, 'recall': 0.96638525, 'specificity': 0.96638525, 'f1': 0.96610475, 'auroc': 0.99678385, 'binary_precision': 0.9951557, 'binary_recall': 0.9374185, 'binary_specificity': 0.9953519, 'binary_f1_score': 0.9654246}
confusion matrix:
      0     1
0  1499     7
1    96  1438
---- Validation: 
scalar performance:
{'acc': 0.64451313, 'precision': 0.774085, 'recall': 0.6385751, 'specificity': 0.6385751, 'f1': 0.5915404, 'auroc': 0.8924103, 'binary_precision': 0.9583333, 'binary_recall': 0.2893082, 'binary_specificity': 0.98784196, 'binary_f1_score': 0.44444445}
confusion matrix:
     0    1
0  650    8
1  452  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68119264, 'precision': 0.8053222, 'recall': 0.68119264, 'specificity': 0.68119264, 'f1': 0.6451237, 'auroc': 0.94375473, 'binary_precision': 1.0, 'binary_recall': 0.36238533, 'binary_specificity': 1.0, 'binary_f1_score': 0.5319866}
confusion matrix:
     0   1
0  218   0
1  139  79
early stop counter: 1
val acc:0.6445131301879883, best validation acc: 0.8493044972419739, corresponding to test acc:                         0.89449542760849 / 0.89449542760849
after epoch: 3,now: 2024-07-29 08:31:50.958580,epoch time: 0:01:52.618362,used: 0:05:38.892174,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.9791267, 'recall': 0.9785201, 'specificity': 0.9785201, 'f1': 0.9786086, 'auroc': 0.99912524, 'binary_precision': 0.96507937, 'binary_recall': 0.99346405, 'binary_specificity': 0.96357614, 'binary_f1_score': 0.979066}
confusion matrix:
      0     1
0  1455    55
1    10  1520
---- Validation: 
scalar performance:
{'acc': 0.8732612, 'precision': 0.87324107, 'recall': 0.8731983, 'specificity': 0.8731983, 'f1': 0.8732176, 'auroc': 0.9242368, 'binary_precision': 0.87223977, 'binary_recall': 0.8694969, 'binary_specificity': 0.8768997, 'binary_f1_score': 0.8708661}
confusion matrix:
     0    1
0  577   81
1   83  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89220184, 'precision': 0.89360154, 'recall': 0.89220184, 'specificity': 0.89220184, 'f1': 0.89210594, 'auroc': 0.9563168, 'binary_precision': 0.8701299, 'binary_recall': 0.92201835, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.8953229}
confusion matrix:
     0    1
0  188   30
1   17  201
better model found
persisted
after epoch: 4,now: 2024-07-29 08:33:39.635504,epoch time: 0:01:48.676924,used: 0:07:27.569098,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.97765434, 'recall': 0.97683716, 'specificity': 0.97683716, 'f1': 0.97695935, 'auroc': 0.9988075, 'binary_precision': 0.9614899, 'binary_recall': 0.9941253, 'binary_specificity': 0.95954907, 'binary_f1_score': 0.9775353}
confusion matrix:
      0     1
0  1447    61
1     9  1523
---- Validation: 
scalar performance:
{'acc': 0.8431221, 'precision': 0.84391105, 'recall': 0.8426956, 'specificity': 0.8426956, 'f1': 0.84287804, 'auroc': 0.90864015, 'binary_precision': 0.85667217, 'binary_recall': 0.8176101, 'binary_specificity': 0.86778116, 'binary_f1_score': 0.8366854}
confusion matrix:
     0    1
0  571   87
1  116  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86238533, 'precision': 0.8634867, 'recall': 0.86238533, 'specificity': 0.86238533, 'f1': 0.86228096, 'auroc': 0.9173471, 'binary_precision': 0.88349515, 'binary_recall': 0.8348624, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.8584905}
confusion matrix:
     0    1
0  194   24
1   36  182
early stop counter: 1
val acc:0.843122124671936, best validation acc: 0.8732612133026123, corresponding to test acc:                         0.892201840877533 / 0.89449542760849
after epoch: 5,now: 2024-07-29 08:35:27.885121,epoch time: 0:01:48.249617,used: 0:09:15.818715,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.97993374, 'recall': 0.97972345, 'specificity': 0.97972345, 'f1': 0.97960424, 'auroc': 0.99847806, 'binary_precision': 0.99461645, 'binary_recall': 0.96475196, 'binary_specificity': 0.99469495, 'binary_f1_score': 0.9794566}
confusion matrix:
      0     1
0  1500     8
1    54  1478
---- Validation: 
scalar performance:
{'acc': 0.69783616, 'precision': 0.7838649, 'recall': 0.69308317, 'specificity': 0.69308317, 'f1': 0.669809, 'auroc': 0.87601614, 'binary_precision': 0.93594307, 'binary_recall': 0.413522, 'binary_specificity': 0.9726444, 'binary_f1_score': 0.57360953}
confusion matrix:
     0    1
0  640   18
1  373  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77522933, 'precision': 0.83808935, 'recall': 0.77522933, 'specificity': 0.77522933, 'f1': 0.76427233, 'auroc': 0.9335283, 'binary_precision': 0.983871, 'binary_recall': 0.559633, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.71345025}
confusion matrix:
     0    1
0  216    2
1   96  122
early stop counter: 2
val acc:0.69783616065979, best validation acc: 0.8732612133026123, corresponding to test acc:                         0.892201840877533 / 0.89449542760849
after epoch: 6,now: 2024-07-29 08:37:16.915410,epoch time: 0:01:49.030289,used: 0:11:04.849004,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98157895, 'precision': 0.98226774, 'recall': 0.98144275, 'specificity': 0.98144275, 'f1': 0.9815674, 'auroc': 0.9997338, 'binary_precision': 0.96590906, 'binary_recall': 0.99869454, 'binary_specificity': 0.96419096, 'binary_f1_score': 0.98202825}
confusion matrix:
      0     1
0  1454    54
1     2  1530
---- Validation: 
scalar performance:
{'acc': 0.8323029, 'precision': 0.8342268, 'recall': 0.8316367, 'specificity': 0.8316367, 'f1': 0.8318248, 'auroc': 0.9042243, 'binary_precision': 0.8556876, 'binary_recall': 0.7924528, 'binary_specificity': 0.87082064, 'binary_f1_score': 0.82285714}
confusion matrix:
     0    1
0  573   85
1  132  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86009175, 'precision': 0.8602812, 'recall': 0.86009175, 'specificity': 0.86009175, 'f1': 0.8600733, 'auroc': 0.9129913, 'binary_precision': 0.85201794, 'binary_recall': 0.8715596, 'binary_specificity': 0.8486239, 'binary_f1_score': 0.861678}
confusion matrix:
     0    1
0  185   33
1   28  190
early stop counter: 3
val acc:0.8323029279708862, best validation acc: 0.8732612133026123, corresponding to test acc:                         0.892201840877533 / 0.89449542760849
after epoch: 7,now: 2024-07-29 08:39:02.039699,epoch time: 0:01:45.124289,used: 0:12:49.973293,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9855263, 'precision': 0.9857588, 'recall': 0.9854527, 'specificity': 0.9854527, 'f1': 0.98552203, 'auroc': 0.9994283, 'binary_precision': 0.97692305, 'binary_recall': 0.9947781, 'binary_specificity': 0.9761273, 'binary_f1_score': 0.98576975}
confusion matrix:
      0     1
0  1472    36
1     8  1524
---- Validation: 
scalar performance:
{'acc': 0.86089647, 'precision': 0.8699647, 'recall': 0.85956824, 'specificity': 0.85956824, 'f1': 0.8596898, 'auroc': 0.92499423, 'binary_precision': 0.9237918, 'binary_recall': 0.7814465, 'binary_specificity': 0.93768996, 'binary_f1_score': 0.846678}
confusion matrix:
     0    1
0  617   41
1  139  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761468, 'precision': 0.89883983, 'recall': 0.8761468, 'specificity': 0.8761468, 'f1': 0.8743596, 'auroc': 0.96326065, 'binary_precision': 0.9939759, 'binary_recall': 0.75688076, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.85937506}
confusion matrix:
     0    1
0  217    1
1   53  165
early stop counter: 4
val acc:0.8608964681625366, best validation acc: 0.8732612133026123, corresponding to test acc:                         0.892201840877533 / 0.89449542760849
after epoch: 8,now: 2024-07-29 08:40:43.258754,epoch time: 0:01:41.219055,used: 0:14:31.192348,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9743421, 'precision': 0.9743537, 'recall': 0.974398, 'specificity': 0.974398, 'f1': 0.97434163, 'auroc': 0.99780273, 'binary_precision': 0.98022413, 'binary_recall': 0.9687296, 'binary_specificity': 0.9800664, 'binary_f1_score': 0.97444296}
confusion matrix:
      0     1
0  1475    30
1    48  1487
---- Validation: 
scalar performance:
{'acc': 0.64451313, 'precision': 0.70393944, 'recall': 0.63978416, 'specificity': 0.63978416, 'f1': 0.6121103, 'auroc': 0.7822751, 'binary_precision': 0.80985916, 'binary_recall': 0.3616352, 'binary_specificity': 0.9179331, 'binary_f1_score': 0.5}
confusion matrix:
     0    1
0  604   54
1  406  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6215596, 'precision': 0.74584025, 'recall': 0.6215596, 'specificity': 0.6215596, 'f1': 0.5668118, 'auroc': 0.89733607, 'binary_precision': 0.9206349, 'binary_recall': 0.26605505, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.4128114}
confusion matrix:
     0   1
0  213   5
1  160  58
early stop counter: 5
val acc:0.6445131301879883, best validation acc: 0.8732612133026123, corresponding to test acc:                         0.892201840877533 / 0.89449542760849
after epoch: 9,now: 2024-07-29 08:42:33.345758,epoch time: 0:01:50.087004,used: 0:16:21.279352,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_26_11_seed_18_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:16:21.279352 at 2024-07-29 08:42:33.345758
persisted model performance metric: 

scalar performance:
{'acc': 0.89220184, 'precision': 0.89360154, 'recall': 0.89220184, 'specificity': 0.89220184, 'f1': 0.89210594, 'auroc': 0.9563168, 'binary_precision': 0.8701299, 'binary_recall': 0.92201835, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.8953229}
confusion matrix:
     0    1
0  188   30
1   17  201
oracle model performance metric: 

scalar performance:
{'acc': 0.8944954, 'precision': 0.90318274, 'recall': 0.89449537, 'specificity': 0.89449537, 'f1': 0.893924, 'auroc': 0.95103526, 'binary_precision': 0.96236557, 'binary_recall': 0.8211009, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.88613856}
confusion matrix:
     0    1
0  211    7
1   39  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454062 KiB |   2004 MiB | 445044 GiB | 445044 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 439319 GiB | 439319 GiB |
|       from small pool |  40595 KiB |     60 MiB |   5724 GiB |   5724 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454062 KiB |   2004 MiB | 445044 GiB | 445044 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 439319 GiB | 439319 GiB |
|       from small pool |  40595 KiB |     60 MiB |   5724 GiB |   5724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 444634 GiB | 444633 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 438921 GiB | 438920 GiB |
|       from small pool |  40406 KiB |     60 MiB |   5713 GiB |   5713 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  28564 MiB |  26288 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  28166 MiB |  25954 MiB |
|       from small pool |     64 MiB |     70 MiB |    398 MiB |    334 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387665 KiB | 489230 KiB | 349141 GiB | 349141 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 343119 GiB | 343118 GiB |
|       from small pool |   6508 KiB |  22276 KiB |   6022 GiB |   6022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   85198 K  |   85196 K  |
|       from large pool |     187    |     311    |   40884 K  |   40883 K  |
|       from small pool |    1117    |    1419    |   44314 K  |   44313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   85198 K  |   85196 K  |
|       from large pool |     187    |     311    |   40884 K  |   40883 K  |
|       from small pool |    1117    |    1419    |   44314 K  |   44313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |    1337    |    1213    |
|       from large pool |      92    |      93    |    1138    |    1046    |
|       from small pool |      32    |      35    |     199    |     167    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      74    |     261    |   46036 K  |   46036 K  |
|       from large pool |      35    |      96    |   28501 K  |   28501 K  |
|       from small pool |      39    |     223    |   17534 K  |   17534 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 445044 GiB | 445044 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 439319 GiB | 439319 GiB |
|       from small pool |      0 KiB |     60 MiB |   5724 GiB |   5724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 445044 GiB | 445044 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 439319 GiB | 439319 GiB |
|       from small pool |      0 KiB |     60 MiB |   5724 GiB |   5724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 444634 GiB | 444634 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 438921 GiB | 438921 GiB |
|       from small pool |      0 KiB |     60 MiB |   5713 GiB |   5713 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  28564 MiB |  27742 MiB |
|       from large pool |    776 MiB |   2226 MiB |  28166 MiB |  27390 MiB |
|       from small pool |     46 MiB |     70 MiB |    398 MiB |    352 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 349142 GiB | 349142 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 343119 GiB | 343119 GiB |
|       from small pool |      0 KiB |  22276 KiB |   6022 GiB |   6022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   85198 K  |   85198 K  |
|       from large pool |       2    |     311    |   40884 K  |   40884 K  |
|       from small pool |       0    |    1419    |   44314 K  |   44314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   85198 K  |   85198 K  |
|       from large pool |       2    |     311    |   40884 K  |   40884 K  |
|       from small pool |       0    |    1419    |   44314 K  |   44314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1337    |    1280    |
|       from large pool |      34    |      93    |    1138    |    1104    |
|       from small pool |      23    |      35    |     199    |     176    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   46036 K  |   46036 K  |
|       from large pool |       4    |      96    |   28501 K  |   28501 K  |
|       from small pool |       0    |     223    |   17535 K  |   17535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 445044 GiB | 445044 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 439319 GiB | 439319 GiB |
|       from small pool |      0 KiB |     60 MiB |   5724 GiB |   5724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 445044 GiB | 445044 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 439319 GiB | 439319 GiB |
|       from small pool |      0 KiB |     60 MiB |   5724 GiB |   5724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 444634 GiB | 444634 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 438921 GiB | 438921 GiB |
|       from small pool |      0 KiB |     60 MiB |   5713 GiB |   5713 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  28564 MiB |  27742 MiB |
|       from large pool |    776 MiB |   2226 MiB |  28166 MiB |  27390 MiB |
|       from small pool |     46 MiB |     70 MiB |    398 MiB |    352 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 349142 GiB | 349142 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 343119 GiB | 343119 GiB |
|       from small pool |      0 KiB |  22276 KiB |   6022 GiB |   6022 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   85198 K  |   85198 K  |
|       from large pool |       2    |     311    |   40884 K  |   40884 K  |
|       from small pool |       0    |    1419    |   44314 K  |   44314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   85198 K  |   85198 K  |
|       from large pool |       2    |     311    |   40884 K  |   40884 K  |
|       from small pool |       0    |    1419    |   44314 K  |   44314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1337    |    1280    |
|       from large pool |      34    |      93    |    1138    |    1104    |
|       from small pool |      23    |      35    |     199    |     176    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   46036 K  |   46036 K  |
|       from large pool |       4    |      96    |   28501 K  |   28501 K  |
|       from small pool |       0    |     223    |   17535 K  |   17535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370

 Experiment start at: 2024-07-29 08:43:25.619042
before training, model accuracy: 0.5158371329307556
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9555921, 'precision': 0.9580517, 'recall': 0.9561082, 'specificity': 0.9561082, 'f1': 0.95556056, 'auroc': 0.9946407, 'binary_precision': 0.99506694, 'binary_recall': 0.9168831, 'binary_specificity': 0.9953333, 'binary_f1_score': 0.95437646}
confusion matrix:
      0     1
0  1493     7
1   128  1412
---- Validation: 
scalar performance:
{'acc': 0.6585938, 'precision': 0.738338, 'recall': 0.64415216, 'specificity': 0.64415216, 'f1': 0.6144767, 'auroc': 0.82251406, 'binary_precision': 0.8649789, 'binary_recall': 0.33606556, 'binary_specificity': 0.9522388, 'binary_f1_score': 0.4840614}
confusion matrix:
     0    1
0  638   32
1  405  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67420816, 'precision': 0.7505669, 'recall': 0.67420816, 'specificity': 0.67420816, 'f1': 0.6473404, 'auroc': 0.86609614, 'binary_precision': 0.8888889, 'binary_recall': 0.39819005, 'binary_specificity': 0.95022625, 'binary_f1_score': 0.55}
confusion matrix:
     0   1
0  210  11
1  133  88
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:45:20.545936,epoch time: 0:01:54.926894,used: 0:01:54.926894,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98157895, 'precision': 0.9817122, 'recall': 0.98150206, 'specificity': 0.98150206, 'f1': 0.9815726, 'auroc': 0.9986416, 'binary_precision': 0.97623634, 'binary_recall': 0.9876543, 'binary_specificity': 0.9753498, 'binary_f1_score': 0.98191214}
confusion matrix:
      0     1
0  1464    37
1    19  1520
---- Validation: 
scalar performance:
{'acc': 0.8328125, 'precision': 0.8351914, 'recall': 0.83486664, 'specificity': 0.83486664, 'f1': 0.83280885, 'auroc': 0.90232444, 'binary_precision': 0.7928994, 'binary_recall': 0.8786885, 'binary_specificity': 0.7910448, 'binary_f1_score': 0.83359253}
confusion matrix:
     0    1
0  530  140
1   74  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82579184, 'precision': 0.83001494, 'recall': 0.82579184, 'specificity': 0.82579184, 'f1': 0.82523274, 'auroc': 0.9202514, 'binary_precision': 0.79268295, 'binary_recall': 0.88235295, 'binary_specificity': 0.7692308, 'binary_f1_score': 0.83511776}
confusion matrix:
     0    1
0  170   51
1   26  195
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 08:47:11.973728,epoch time: 0:01:51.427792,used: 0:03:46.354686,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.985181, 'recall': 0.9852598, 'specificity': 0.9852598, 'f1': 0.98519635, 'auroc': 0.9990554, 'binary_precision': 0.9901639, 'binary_recall': 0.9805195, 'binary_specificity': 0.99, 'binary_f1_score': 0.9853181}
confusion matrix:
      0     1
0  1485    15
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.796875, 'precision': 0.8268098, 'recall': 0.7895278, 'specificity': 0.7895278, 'f1': 0.78895247, 'auroc': 0.91287255, 'binary_precision': 0.9146919, 'binary_recall': 0.63278687, 'binary_specificity': 0.9462687, 'binary_f1_score': 0.74806195}
confusion matrix:
     0    1
0  634   36
1  224  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280543, 'precision': 0.8505634, 'recall': 0.8280543, 'specificity': 0.8280543, 'f1': 0.8252492, 'auroc': 0.9171598, 'binary_precision': 0.93939394, 'binary_recall': 0.7013575, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.8031089}
confusion matrix:
     0    1
0  211   10
1   66  155
new oracle model saved
early stop counter: 1
val acc:0.796875, best validation acc: 0.832812488079071, corresponding to test acc:                         0.8257918357849121 / 0.8280543088912964
after epoch: 3,now: 2024-07-29 08:49:01.572950,epoch time: 0:01:49.599222,used: 0:05:35.953908,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9874803, 'recall': 0.98753095, 'specificity': 0.98753095, 'f1': 0.9874988, 'auroc': 0.99891734, 'binary_precision': 0.9902025, 'binary_recall': 0.9850552, 'binary_specificity': 0.9900067, 'binary_f1_score': 0.9876222}
confusion matrix:
      0     1
0  1486    15
1    23  1516
---- Validation: 
scalar performance:
{'acc': 0.87109375, 'precision': 0.8729013, 'recall': 0.8693785, 'specificity': 0.8693785, 'f1': 0.870318, 'auroc': 0.926484, 'binary_precision': 0.8896673, 'binary_recall': 0.83278686, 'binary_specificity': 0.90597016, 'binary_f1_score': 0.8602879}
confusion matrix:
     0    1
0  607   63
1  102  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8710407, 'precision': 0.8795024, 'recall': 0.8710407, 'specificity': 0.8710407, 'f1': 0.8703178, 'auroc': 0.92117286, 'binary_precision': 0.9361702, 'binary_recall': 0.7963801, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.8606357}
confusion matrix:
     0    1
0  209   12
1   45  176
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 08:50:50.882577,epoch time: 0:01:49.309627,used: 0:07:25.263535,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891259, 'recall': 0.98917186, 'specificity': 0.98917186, 'f1': 0.9891436, 'auroc': 0.99932086, 'binary_precision': 0.9915144, 'binary_recall': 0.9870046, 'binary_specificity': 0.9913391, 'binary_f1_score': 0.98925436}
confusion matrix:
      0     1
0  1488    13
1    20  1519
---- Validation: 
scalar performance:
{'acc': 0.6585938, 'precision': 0.72287273, 'recall': 0.64503306, 'specificity': 0.64503306, 'f1': 0.61977243, 'auroc': 0.804551, 'binary_precision': 0.8314176, 'binary_recall': 0.35573772, 'binary_specificity': 0.9343284, 'binary_f1_score': 0.4982778}
confusion matrix:
     0    1
0  626   44
1  393  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82126695, 'precision': 0.8327184, 'recall': 0.821267, 'specificity': 0.821267, 'f1': 0.81971574, 'auroc': 0.88200486, 'binary_precision': 0.89444447, 'binary_recall': 0.7285068, 'binary_specificity': 0.91402715, 'binary_f1_score': 0.8029925}
confusion matrix:
     0    1
0  202   19
1   60  161
early stop counter: 1
val acc:0.6585937738418579, best validation acc: 0.87109375, corresponding to test acc:                         0.8710407018661499 / 0.8710407018661499
after epoch: 5,now: 2024-07-29 08:52:39.593215,epoch time: 0:01:48.710638,used: 0:09:13.974173,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9858553, 'precision': 0.9859823, 'recall': 0.98598963, 'specificity': 0.98598963, 'f1': 0.9858553, 'auroc': 0.9991256, 'binary_precision': 0.99733865, 'binary_recall': 0.9746424, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.98585993}
confusion matrix:
      0     1
0  1498     4
1    39  1499
---- Validation: 
scalar performance:
{'acc': 0.7546875, 'precision': 0.80323315, 'recall': 0.74489844, 'specificity': 0.74489844, 'f1': 0.73919183, 'auroc': 0.89036036, 'binary_precision': 0.9134078, 'binary_recall': 0.5360656, 'binary_specificity': 0.95373136, 'binary_f1_score': 0.67561984}
confusion matrix:
     0    1
0  639   31
1  283  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81674206, 'precision': 0.83607054, 'recall': 0.81674206, 'specificity': 0.81674206, 'f1': 0.8140687, 'auroc': 0.8966032, 'binary_precision': 0.9166667, 'binary_recall': 0.6968326, 'binary_specificity': 0.9366516, 'binary_f1_score': 0.7917738}
confusion matrix:
     0    1
0  207   14
1   67  154
early stop counter: 2
val acc:0.754687488079071, best validation acc: 0.87109375, corresponding to test acc:                         0.8710407018661499 / 0.8710407018661499
after epoch: 6,now: 2024-07-29 08:54:28.791520,epoch time: 0:01:49.198305,used: 0:11:03.172478,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.9827075, 'recall': 0.98271525, 'specificity': 0.98271525, 'f1': 0.98256576, 'auroc': 0.99889743, 'binary_precision': 0.9946738, 'binary_recall': 0.9707602, 'binary_specificity': 0.9946702, 'binary_f1_score': 0.9825715}
confusion matrix:
      0     1
0  1493     8
1    45  1494
---- Validation: 
scalar performance:
{'acc': 0.790625, 'precision': 0.8304362, 'recall': 0.78223634, 'specificity': 0.78223634, 'f1': 0.7804156, 'auroc': 0.91466355, 'binary_precision': 0.93401015, 'binary_recall': 0.6032787, 'binary_specificity': 0.96119404, 'binary_f1_score': 0.7330677}
confusion matrix:
     0    1
0  644   26
1  242  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.800905, 'precision': 0.8366356, 'recall': 0.800905, 'specificity': 0.800905, 'f1': 0.795478, 'auroc': 0.92686474, 'binary_precision': 0.94630873, 'binary_recall': 0.6380091, 'binary_specificity': 0.9638009, 'binary_f1_score': 0.7621622}
confusion matrix:
     0    1
0  213    8
1   80  141
early stop counter: 3
val acc:0.7906249761581421, best validation acc: 0.87109375, corresponding to test acc:                         0.8710407018661499 / 0.8710407018661499
after epoch: 7,now: 2024-07-29 08:56:20.372255,epoch time: 0:01:51.580735,used: 0:12:54.753213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.99110705, 'recall': 0.9911294, 'specificity': 0.9911294, 'f1': 0.99111724, 'auroc': 0.9997645, 'binary_precision': 0.9921875, 'binary_recall': 0.9902534, 'binary_specificity': 0.99200535, 'binary_f1_score': 0.9912195}
confusion matrix:
      0     1
0  1489    12
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.8773438, 'precision': 0.8796092, 'recall': 0.8754955, 'specificity': 0.8754955, 'f1': 0.8765443, 'auroc': 0.9297058, 'binary_precision': 0.8994709, 'binary_recall': 0.8360656, 'binary_specificity': 0.9149254, 'binary_f1_score': 0.86661}
confusion matrix:
     0    1
0  613   57
1  100  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.8439104, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.84136593, 'auroc': 0.9122868, 'binary_precision': 0.8719212, 'binary_recall': 0.800905, 'binary_specificity': 0.88235295, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  195   26
1   44  177
better model found
persisted
after epoch: 8,now: 2024-07-29 08:58:10.390019,epoch time: 0:01:50.017764,used: 0:14:44.770977,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.98956877, 'recall': 0.98941445, 'specificity': 0.98941445, 'f1': 0.98947066, 'auroc': 0.99965453, 'binary_precision': 0.98519, 'binary_recall': 0.99415207, 'binary_specificity': 0.9846769, 'binary_f1_score': 0.9896508}
confusion matrix:
      0     1
0  1478    23
1     9  1530
---- Validation: 
scalar performance:
{'acc': 0.809375, 'precision': 0.8154261, 'recall': 0.812552, 'specificity': 0.812552, 'f1': 0.80920684, 'auroc': 0.8840103, 'binary_precision': 0.7584746, 'binary_recall': 0.8803279, 'binary_specificity': 0.7447761, 'binary_f1_score': 0.81487095}
confusion matrix:
     0    1
0  499  171
1   73  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122172, 'precision': 0.8176875, 'recall': 0.81221724, 'specificity': 0.81221724, 'f1': 0.8114053, 'auroc': 0.89373684, 'binary_precision': 0.776, 'binary_recall': 0.87782806, 'binary_specificity': 0.74660635, 'binary_f1_score': 0.82377917}
confusion matrix:
     0    1
0  165   56
1   27  194
early stop counter: 1
val acc:0.809374988079071, best validation acc: 0.8773437738418579, corresponding to test acc:                         0.8416289687156677 / 0.8710407018661499
after epoch: 9,now: 2024-07-29 08:59:59.635405,epoch time: 0:01:49.245386,used: 0:16:34.016363,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9874896, 'recall': 0.98756385, 'specificity': 0.98756385, 'f1': 0.98749936, 'auroc': 0.99942815, 'binary_precision': 0.9927774, 'binary_recall': 0.98245615, 'binary_specificity': 0.99267155, 'binary_f1_score': 0.98758984}
confusion matrix:
      0     1
0  1490    11
1    27  1512
---- Validation: 
scalar performance:
{'acc': 0.8257812, 'precision': 0.84052384, 'recall': 0.82073647, 'specificity': 0.82073647, 'f1': 0.82198167, 'auroc': 0.9068681, 'binary_precision': 0.9006211, 'binary_recall': 0.71311474, 'binary_specificity': 0.9283582, 'binary_f1_score': 0.7959743}
confusion matrix:
     0    1
0  622   48
1  175  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8642534, 'precision': 0.8701958, 'recall': 0.8642534, 'specificity': 0.8642534, 'f1': 0.86370647, 'auroc': 0.92737657, 'binary_precision': 0.91709846, 'binary_recall': 0.800905, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.8550725}
confusion matrix:
     0    1
0  205   16
1   44  177
early stop counter: 2
val acc:0.8257812261581421, best validation acc: 0.8773437738418579, corresponding to test acc:                         0.8416289687156677 / 0.8710407018661499
after epoch: 10,now: 2024-07-29 09:01:47.443585,epoch time: 0:01:47.808180,used: 0:18:21.824543,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.9895278, 'recall': 0.9895872, 'specificity': 0.9895872, 'f1': 0.9894736, 'auroc': 0.9997935, 'binary_precision': 0.99867636, 'binary_recall': 0.98050684, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.9895082}
confusion matrix:
      0     1
0  1499     2
1    30  1509
---- Validation: 
scalar performance:
{'acc': 0.8296875, 'precision': 0.8520482, 'recall': 0.8236604, 'specificity': 0.8236604, 'f1': 0.8247901, 'auroc': 0.9260118, 'binary_precision': 0.9298246, 'binary_recall': 0.69508195, 'binary_specificity': 0.9522388, 'binary_f1_score': 0.79549724}
confusion matrix:
     0    1
0  638   32
1  186  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8235294, 'precision': 0.8492739, 'recall': 0.8235294, 'specificity': 0.8235294, 'f1': 0.82021654, 'auroc': 0.9107717, 'binary_precision': 0.94409937, 'binary_recall': 0.6877828, 'binary_specificity': 0.959276, 'binary_f1_score': 0.79581153}
confusion matrix:
     0    1
0  212    9
1   69  152
early stop counter: 3
val acc:0.8296874761581421, best validation acc: 0.8773437738418579, corresponding to test acc:                         0.8416289687156677 / 0.8710407018661499
after epoch: 11,now: 2024-07-29 09:03:36.492558,epoch time: 0:01:49.048973,used: 0:20:10.873516,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.9907895, 'recall': 0.99087447, 'specificity': 0.99087447, 'f1': 0.99078906, 'auroc': 0.99951684, 'binary_precision': 0.9973684, 'binary_recall': 0.9844156, 'binary_specificity': 0.99733335, 'binary_f1_score': 0.9908497}
confusion matrix:
      0     1
0  1496     4
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.80390626, 'precision': 0.842985, 'recall': 0.7958038, 'specificity': 0.7958038, 'f1': 0.79484546, 'auroc': 0.9342226, 'binary_precision': 0.94763094, 'binary_recall': 0.6229508, 'binary_specificity': 0.9686567, 'binary_f1_score': 0.751731}
confusion matrix:
     0    1
0  649   21
1  230  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85067874, 'precision': 0.87858355, 'recall': 0.85067874, 'specificity': 0.85067874, 'f1': 0.8478755, 'auroc': 0.925882, 'binary_precision': 0.98136646, 'binary_recall': 0.71493214, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.82722515}
confusion matrix:
     0    1
0  218    3
1   63  158
early stop counter: 4
val acc:0.803906261920929, best validation acc: 0.8773437738418579, corresponding to test acc:                         0.8416289687156677 / 0.8710407018661499
after epoch: 12,now: 2024-07-29 09:05:26.540656,epoch time: 0:01:50.048098,used: 0:22:00.921614,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.99277055, 'recall': 0.99275434, 'specificity': 0.99275434, 'f1': 0.992762, 'auroc': 0.99978006, 'binary_precision': 0.99220777, 'binary_recall': 0.993498, 'binary_specificity': 0.99201065, 'binary_f1_score': 0.99285245}
confusion matrix:
      0     1
0  1490    12
1    10  1528
---- Validation: 
scalar performance:
{'acc': 0.85, 'precision': 0.85345995, 'recall': 0.847541, 'specificity': 0.847541, 'f1': 0.8487143, 'auroc': 0.9011451, 'binary_precision': 0.8786232, 'binary_recall': 0.795082, 'binary_specificity': 0.9, 'binary_f1_score': 0.8347677}
confusion matrix:
     0    1
0  603   67
1  125  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8438914, 'precision': 0.84910214, 'recall': 0.8438914, 'specificity': 0.8438914, 'f1': 0.8433068, 'auroc': 0.89809793, 'binary_precision': 0.8917526, 'binary_recall': 0.78280544, 'binary_specificity': 0.9049774, 'binary_f1_score': 0.833735}
confusion matrix:
     0    1
0  200   21
1   48  173
early stop counter: 5
val acc:0.8500000238418579, best validation acc: 0.8773437738418579, corresponding to test acc:                         0.8416289687156677 / 0.8710407018661499
after epoch: 13,now: 2024-07-29 09:07:16.960956,epoch time: 0:01:50.420300,used: 0:23:51.341914,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_43_25_seed_19_23190370
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:23:51.341914 at 2024-07-29 09:07:16.960956
persisted model performance metric: 

scalar performance:
{'acc': 0.84162897, 'precision': 0.8439104, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.84136593, 'auroc': 0.9122868, 'binary_precision': 0.8719212, 'binary_recall': 0.800905, 'binary_specificity': 0.88235295, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  195   26
1   44  177
oracle model performance metric: 

scalar performance:
{'acc': 0.8710407, 'precision': 0.8795024, 'recall': 0.8710407, 'specificity': 0.8710407, 'f1': 0.8703178, 'auroc': 0.92117286, 'binary_precision': 0.9361702, 'binary_recall': 0.7963801, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.8606357}
confusion matrix:
     0    1
0  209   12
1   45  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454062 KiB |   2004 MiB | 473025 GiB | 473025 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 466942 GiB | 466941 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6083 GiB |   6083 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454062 KiB |   2004 MiB | 473025 GiB | 473025 GiB |
|       from large pool | 413467 KiB |   1971 MiB | 466942 GiB | 466941 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6083 GiB |   6083 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |   1998 MiB | 472602 GiB | 472602 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 466531 GiB | 466531 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6071 GiB |   6071 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2276 MiB |   2290 MiB |  30018 MiB |  27742 MiB |
|       from large pool |   2212 MiB |   2226 MiB |  29602 MiB |  27390 MiB |
|       from small pool |     64 MiB |     70 MiB |    416 MiB |    352 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 387665 KiB | 489230 KiB | 371082 GiB | 371081 GiB |
|       from large pool | 381157 KiB | 476433 KiB | 364681 GiB | 364681 GiB |
|       from small pool |   6508 KiB |  22276 KiB |   6400 GiB |   6400 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    1681    |   90551 K  |   90550 K  |
|       from large pool |     187    |     311    |   43454 K  |   43454 K  |
|       from small pool |    1117    |    1419    |   47096 K  |   47095 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    1681    |   90551 K  |   90550 K  |
|       from large pool |     187    |     311    |   43454 K  |   43454 K  |
|       from small pool |    1117    |    1419    |   47096 K  |   47095 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |    1404    |    1280    |
|       from large pool |      92    |      93    |    1196    |    1104    |
|       from small pool |      32    |      35    |     208    |     176    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      70    |     261    |   49019 K  |   49019 K  |
|       from large pool |      35    |      96    |   30379 K  |   30379 K  |
|       from small pool |      35    |     223    |   18640 K  |   18640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 473025 GiB | 473025 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 466942 GiB | 466942 GiB |
|       from small pool |      0 KiB |     60 MiB |   6083 GiB |   6083 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 473025 GiB | 473025 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 466942 GiB | 466942 GiB |
|       from small pool |      0 KiB |     60 MiB |   6083 GiB |   6083 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 472602 GiB | 472602 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 466531 GiB | 466531 GiB |
|       from small pool |      0 KiB |     60 MiB |   6071 GiB |   6071 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    822 MiB |   2290 MiB |  30018 MiB |  29196 MiB |
|       from large pool |    776 MiB |   2226 MiB |  29602 MiB |  28826 MiB |
|       from small pool |     46 MiB |     70 MiB |    416 MiB |    370 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 489230 KiB | 371082 GiB | 371082 GiB |
|       from large pool |  24320 KiB | 476433 KiB | 364682 GiB | 364682 GiB |
|       from small pool |      0 KiB |  22276 KiB |   6400 GiB |   6400 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1681    |   90551 K  |   90551 K  |
|       from large pool |       2    |     311    |   43454 K  |   43454 K  |
|       from small pool |       0    |    1419    |   47096 K  |   47096 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1681    |   90551 K  |   90551 K  |
|       from large pool |       2    |     311    |   43454 K  |   43454 K  |
|       from small pool |       0    |    1419    |   47096 K  |   47096 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |    1404    |    1347    |
|       from large pool |      34    |      93    |    1196    |    1162    |
|       from small pool |      23    |      35    |     208    |     185    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     261    |   49019 K  |   49019 K  |
|       from large pool |       4    |      96    |   30379 K  |   30379 K  |
|       from small pool |       0    |     223    |   18640 K  |   18640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Mon Jul 29 09:07:29 2024]
Finished job 0.
1 of 1 steps (100%) done
