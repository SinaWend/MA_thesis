Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sun Jul 28 23:11:55 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367

 Experiment start at: 2024-07-28 23:13:49.151644
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9202474, 'precision': 0.93039775, 'recall': 0.92132306, 'specificity': 0.92132306, 'f1': 0.9198976, 'auroc': 0.98894715, 'binary_precision': 1.0, 'binary_recall': 0.8426461, 'binary_specificity': 1.0, 'binary_f1_score': 0.9146044}
confusion matrix:
      0     1
0  1515     0
1   245  1312
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6459627, 'precision': 0.7206419, 'recall': 0.64181304, 'specificity': 0.64181304, 'f1': 0.6094135, 'auroc': 0.82822347, 'binary_precision': 0.84555984, 'binary_recall': 0.3448819, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.4899329}
confusion matrix:
     0    1
0  613   40
1  416  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73953485, 'precision': 0.7644558, 'recall': 0.73953485, 'specificity': 0.73953485, 'f1': 0.7332506, 'auroc': 0.8690752, 'binary_precision': 0.84563756, 'binary_recall': 0.5860465, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.6923077}
confusion matrix:
     0    1
0  192   23
1   89  126
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-28 23:15:58.746685,epoch time: 0:02:09.595041,used: 0:02:09.595041,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.96741116, 'recall': 0.96699965, 'specificity': 0.96699965, 'f1': 0.96710676, 'auroc': 0.99603724, 'binary_precision': 0.9583596, 'binary_recall': 0.9774775, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.96782416}
confusion matrix:
      0     1
0  1452    66
1    35  1519
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.81572783, 'recall': 0.80272275, 'specificity': 0.80272275, 'f1': 0.7994429, 'auroc': 0.90015316, 'binary_precision': 0.74451613, 'binary_recall': 0.9086614, 'binary_specificity': 0.6967841, 'binary_f1_score': 0.8184397}
confusion matrix:
     0    1
0  455  198
1   58  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8136991, 'recall': 0.7953489, 'specificity': 0.7953489, 'f1': 0.79231155, 'auroc': 0.9224013, 'binary_precision': 0.7378277, 'binary_recall': 0.9162791, 'binary_specificity': 0.6744186, 'binary_f1_score': 0.81742734}
confusion matrix:
     0    1
0  145   70
1   18  197
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-28 23:17:33.721228,epoch time: 0:01:34.974543,used: 0:03:44.569584,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.95167065, 'recall': 0.94801027, 'specificity': 0.94801027, 'f1': 0.94718766, 'auroc': 0.9970199, 'binary_precision': 1.0, 'binary_recall': 0.89602053, 'binary_specificity': 1.0, 'binary_f1_score': 0.9451591}
confusion matrix:
      0     1
0  1514     0
1   162  1396
---- Validation: 
scalar performance:
{'acc': 0.5939441, 'precision': 0.7611587, 'recall': 0.5882758, 'specificity': 0.5882758, 'f1': 0.51004, 'auroc': 0.9060954, 'binary_precision': 0.96666664, 'binary_recall': 0.18267716, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.30728477}
confusion matrix:
     0    1
0  649    4
1  519  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.81899107, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.6914408, 'auroc': 0.9151758, 'binary_precision': 1.0, 'binary_recall': 0.43255815, 'binary_specificity': 1.0, 'binary_f1_score': 0.6038961}
confusion matrix:
     0   1
0  215   0
1  122  93
early stop counter: 1
val acc:0.5939440727233887, best validation acc: 0.8012422323226929, corresponding to test acc:                         0.7953488230705261 / 0.7953488230705261
after epoch: 3,now: 2024-07-28 23:19:05.116603,epoch time: 0:01:31.395375,used: 0:05:15.964959,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9821741, 'recall': 0.98221844, 'specificity': 0.98221844, 'f1': 0.98209625, 'auroc': 0.9980211, 'binary_precision': 0.992126, 'binary_recall': 0.97234726, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.982137}
confusion matrix:
      0     1
0  1505    12
1    43  1512
---- Validation: 
scalar performance:
{'acc': 0.8113354, 'precision': 0.8173456, 'recall': 0.81035435, 'specificity': 0.81035435, 'f1': 0.8100732, 'auroc': 0.8839445, 'binary_precision': 0.8576642, 'binary_recall': 0.7401575, 'binary_specificity': 0.8805513, 'binary_f1_score': 0.79459}
confusion matrix:
     0    1
0  575   78
1  165  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.8522601, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.85104674, 'auroc': 0.9291942, 'binary_precision': 0.8325991, 'binary_recall': 0.87906975, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.85520357}
confusion matrix:
     0    1
0  177   38
1   26  189
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-28 23:20:29.800441,epoch time: 0:01:24.683838,used: 0:06:40.648797,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9808157, 'recall': 0.9807277, 'specificity': 0.9807277, 'f1': 0.98046863, 'auroc': 0.9987345, 'binary_precision': 0.99800664, 'binary_recall': 0.9634381, 'binary_specificity': 0.9980172, 'binary_f1_score': 0.9804178}
confusion matrix:
      0     1
0  1510     3
1    57  1502
---- Validation: 
scalar performance:
{'acc': 0.6956522, 'precision': 0.7435576, 'recall': 0.6924889, 'specificity': 0.6924889, 'f1': 0.6776974, 'auroc': 0.8447553, 'binary_precision': 0.84813756, 'binary_recall': 0.46614173, 'binary_specificity': 0.9188361, 'binary_f1_score': 0.601626}
confusion matrix:
     0    1
0  600   53
1  339  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.85914266, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8267459, 'auroc': 0.929735, 'binary_precision': 0.96103895, 'binary_recall': 0.6883721, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.802168}
confusion matrix:
     0    1
0  209    6
1   67  148
early stop counter: 1
val acc:0.695652186870575, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8511627912521362 / 0.8511627912521362
after epoch: 5,now: 2024-07-28 23:22:03.553493,epoch time: 0:01:33.753052,used: 0:08:14.401849,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.976251, 'recall': 0.9759027, 'specificity': 0.9759027, 'f1': 0.9755843, 'auroc': 0.9984119, 'binary_precision': 0.99798524, 'binary_recall': 0.9537869, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9753856}
confusion matrix:
      0     1
0  1511     3
1    72  1486
---- Validation: 
scalar performance:
{'acc': 0.6545031, 'precision': 0.7703798, 'recall': 0.64986676, 'specificity': 0.64986676, 'f1': 0.6090908, 'auroc': 0.8917365, 'binary_precision': 0.94392526, 'binary_recall': 0.31811023, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.47585395}
confusion matrix:
     0    1
0  641   12
1  433  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6418605, 'precision': 0.79132795, 'recall': 0.6418605, 'specificity': 0.6418605, 'f1': 0.5891652, 'auroc': 0.8998594, 'binary_precision': 1.0, 'binary_recall': 0.28372094, 'binary_specificity': 1.0, 'binary_f1_score': 0.442029}
confusion matrix:
     0   1
0  215   0
1  154  61
early stop counter: 2
val acc:0.6545031070709229, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8511627912521362 / 0.8511627912521362
after epoch: 6,now: 2024-07-28 23:23:33.567592,epoch time: 0:01:30.014099,used: 0:09:44.415948,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9814291, 'recall': 0.980976, 'specificity': 0.980976, 'f1': 0.9811088, 'auroc': 0.9989227, 'binary_precision': 0.9722922, 'binary_recall': 0.9910141, 'binary_specificity': 0.9709379, 'binary_f1_score': 0.98156387}
confusion matrix:
      0     1
0  1470    44
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8143662, 'recall': 0.79526114, 'specificity': 0.79526114, 'f1': 0.79063874, 'auroc': 0.8978042, 'binary_precision': 0.7297634, 'binary_recall': 0.92283463, 'binary_specificity': 0.6676876, 'binary_f1_score': 0.81502086}
confusion matrix:
     0    1
0  436  217
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.79726464, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.74991053, 'auroc': 0.9211898, 'binary_precision': 0.6894198, 'binary_recall': 0.9395349, 'binary_specificity': 0.5767442, 'binary_f1_score': 0.7952756}
confusion matrix:
     0    1
0  124   91
1   13  202
early stop counter: 3
val acc:0.79347825050354, best validation acc: 0.8113353848457336, corresponding to test acc:                         0.8511627912521362 / 0.8511627912521362
after epoch: 7,now: 2024-07-28 23:25:11.000883,epoch time: 0:01:37.433291,used: 0:11:21.849239,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870066, 'recall': 0.9870925, 'specificity': 0.9870925, 'f1': 0.9869788, 'auroc': 0.9994383, 'binary_precision': 0.99542785, 'binary_recall': 0.9788054, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.98704666}
confusion matrix:
      0     1
0  1508     7
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.8776716, 'recall': 0.8702029, 'specificity': 0.8702029, 'f1': 0.8703364, 'auroc': 0.9350978, 'binary_precision': 0.9240506, 'binary_recall': 0.8047244, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.86026937}
confusion matrix:
     0    1
0  611   42
1  124  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8971704, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8877504, 'auroc': 0.9489237, 'binary_precision': 0.95628417, 'binary_recall': 0.81395346, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8793969}
confusion matrix:
     0    1
0  207    8
1   40  175
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-28 23:26:37.060071,epoch time: 0:01:26.059188,used: 0:12:47.908427,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.97044754, 'recall': 0.96946454, 'specificity': 0.96946454, 'f1': 0.9690664, 'auroc': 0.9982598, 'binary_precision': 0.99931645, 'binary_recall': 0.93958867, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9685326}
confusion matrix:
      0     1
0  1515     1
1    94  1462
---- Validation: 
scalar performance:
{'acc': 0.5590062, 'precision': 0.7408519, 'recall': 0.55284274, 'specificity': 0.55284274, 'f1': 0.44780275, 'auroc': 0.8352685, 'binary_precision': 0.94666666, 'binary_recall': 0.11181103, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.2}
confusion matrix:
     0   1
0  649   4
1  564  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255814, 'precision': 0.7771677, 'recall': 0.6255814, 'specificity': 0.6255814, 'f1': 0.5662797, 'auroc': 0.8991022, 'binary_precision': 0.98214287, 'binary_recall': 0.25581396, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.40590408}
confusion matrix:
     0   1
0  214   1
1  160  55
early stop counter: 1
val acc:0.5590062141418457, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 9,now: 2024-07-28 23:28:12.769141,epoch time: 0:01:35.709070,used: 0:14:23.617497,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9765625, 'precision': 0.97724545, 'recall': 0.97683275, 'specificity': 0.97683275, 'f1': 0.97656024, 'auroc': 0.9988016, 'binary_precision': 0.998655, 'binary_recall': 0.95498395, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97633135}
confusion matrix:
      0     1
0  1515     2
1    70  1485
---- Validation: 
scalar performance:
{'acc': 0.6281056, 'precision': 0.7582903, 'recall': 0.6230734, 'specificity': 0.6230734, 'f1': 0.5695641, 'auroc': 0.8700377, 'binary_precision': 0.93820226, 'binary_recall': 0.2629921, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.41082406}
confusion matrix:
     0    1
0  642   11
1  468  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.78666663, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.56811047, 'auroc': 0.92623043, 'binary_precision': 1.0, 'binary_recall': 0.25581396, 'binary_specificity': 1.0, 'binary_f1_score': 0.4074074}
confusion matrix:
     0   1
0  215   0
1  160  55
early stop counter: 2
val acc:0.6281055808067322, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8883720636367798
after epoch: 10,now: 2024-07-28 23:29:38.213605,epoch time: 0:01:25.444464,used: 0:15:49.061961,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98893976, 'recall': 0.9889207, 'specificity': 0.9889207, 'f1': 0.9889298, 'auroc': 0.9991784, 'binary_precision': 0.98846155, 'binary_recall': 0.9897304, 'binary_specificity': 0.98811096, 'binary_f1_score': 0.98909557}
confusion matrix:
      0     1
0  1496    18
1    16  1542
---- Validation: 
scalar performance:
{'acc': 0.81055903, 'precision': 0.8228874, 'recall': 0.8091763, 'specificity': 0.8091763, 'f1': 0.808228, 'auroc': 0.8921778, 'binary_precision': 0.88258314, 'binary_recall': 0.7102362, 'binary_specificity': 0.9081164, 'binary_f1_score': 0.7870855}
confusion matrix:
     0    1
0  593   60
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9, 'precision': 0.9038529, 'recall': 0.9, 'specificity': 0.9, 'f1': 0.89976096, 'auroc': 0.9543753, 'binary_precision': 0.943299, 'binary_recall': 0.8511628, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8948656}
confusion matrix:
     0    1
0  204   11
1   32  183
new oracle model saved
early stop counter: 3
val acc:0.8105590343475342, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 11,now: 2024-07-28 23:31:17.666857,epoch time: 0:01:39.453252,used: 0:17:28.515213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98600256, 'recall': 0.98607695, 'specificity': 0.98607695, 'f1': 0.986002, 'auroc': 0.9992794, 'binary_precision': 0.9921875, 'binary_recall': 0.98006433, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.98608863}
confusion matrix:
      0     1
0  1505    12
1    31  1524
---- Validation: 
scalar performance:
{'acc': 0.8338509, 'precision': 0.8367691, 'recall': 0.833189, 'specificity': 0.833189, 'f1': 0.83327043, 'auroc': 0.9114445, 'binary_precision': 0.86481804, 'binary_recall': 0.78582674, 'binary_specificity': 0.8805513, 'binary_f1_score': 0.8234323}
confusion matrix:
     0    1
0  575   78
1  136  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.8780552, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.8715868, 'auroc': 0.944013, 'binary_precision': 0.9255319, 'binary_recall': 0.80930233, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.8635236}
confusion matrix:
     0    1
0  201   14
1   41  174
early stop counter: 4
val acc:0.8338509202003479, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 12,now: 2024-07-28 23:32:52.119069,epoch time: 0:01:34.452212,used: 0:19:02.967425,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9875045, 'recall': 0.987205, 'specificity': 0.987205, 'f1': 0.9872993, 'auroc': 0.9996401, 'binary_precision': 0.9803673, 'binary_recall': 0.9948586, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.9875598}
confusion matrix:
      0     1
0  1485    31
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.8253106, 'precision': 0.84060013, 'recall': 0.8267849, 'specificity': 0.8267849, 'f1': 0.8237551, 'auroc': 0.9147991, 'binary_precision': 0.7648579, 'binary_recall': 0.93228346, 'binary_specificity': 0.72128636, 'binary_f1_score': 0.84031224}
confusion matrix:
     0    1
0  471  182
1   43  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8325318, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8166852, 'auroc': 0.9414386, 'binary_precision': 0.76447874, 'binary_recall': 0.9209302, 'binary_specificity': 0.7162791, 'binary_f1_score': 0.835443}
confusion matrix:
     0    1
0  154   61
1   17  198
early stop counter: 5
val acc:0.8253105878829956, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 13,now: 2024-07-28 23:34:24.083542,epoch time: 0:01:31.964473,used: 0:20:34.931898,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98806584, 'recall': 0.9881021, 'specificity': 0.9881021, 'f1': 0.9879557, 'auroc': 0.9997499, 'binary_precision': 0.99934256, 'binary_recall': 0.97686374, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9879753}
confusion matrix:
      0     1
0  1515     1
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.85559005, 'precision': 0.8634333, 'recall': 0.8545635, 'specificity': 0.8545635, 'f1': 0.854529, 'auroc': 0.92912424, 'binary_precision': 0.9134438, 'binary_recall': 0.78110236, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.8421052}
confusion matrix:
     0    1
0  606   47
1  139  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.9021288, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8823748, 'auroc': 0.94730127, 'binary_precision': 0.9881657, 'binary_recall': 0.7767442, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8697917}
confusion matrix:
     0    1
0  213    2
1   48  167
early stop counter: 6
val acc:0.8555900454521179, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 14,now: 2024-07-28 23:35:51.564472,epoch time: 0:01:27.480930,used: 0:22:02.412828,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97577804, 'recall': 0.9752486, 'specificity': 0.9752486, 'f1': 0.9749316, 'auroc': 0.9991853, 'binary_precision': 0.9993248, 'binary_recall': 0.9511568, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.974646}
confusion matrix:
      0     1
0  1515     1
1    76  1480
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.7435974, 'recall': 0.6725, 'specificity': 0.6725, 'f1': 0.6492996, 'auroc': 0.8648931, 'binary_precision': 0.8682432, 'binary_recall': 0.40472442, 'binary_specificity': 0.94027567, 'binary_f1_score': 0.5520946}
confusion matrix:
     0    1
0  614   39
1  378  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8285196, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8064721, 'auroc': 0.91294754, 'binary_precision': 0.90797544, 'binary_recall': 0.6883721, 'binary_specificity': 0.9302326, 'binary_f1_score': 0.7830687}
confusion matrix:
     0    1
0  200   15
1   67  148
early stop counter: 7
val acc:0.6762422323226929, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 15,now: 2024-07-28 23:37:27.480669,epoch time: 0:01:35.916197,used: 0:23:38.329025,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908627, 'recall': 0.99091935, 'specificity': 0.99091935, 'f1': 0.9908843, 'auroc': 0.9990555, 'binary_precision': 0.9935442, 'binary_recall': 0.9884393, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9909852}
confusion matrix:
      0     1
0  1505    10
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.8481822, 'recall': 0.8440173, 'specificity': 0.8440173, 'f1': 0.8441192, 'auroc': 0.91101456, 'binary_precision': 0.87958115, 'binary_recall': 0.7937008, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.83443713}
confusion matrix:
     0    1
0  584   69
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8619529, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8552, 'auroc': 0.9120389, 'binary_precision': 0.90909094, 'binary_recall': 0.7906977, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8457712}
confusion matrix:
     0    1
0  198   17
1   45  170
early stop counter: 8
val acc:0.8447204828262329, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 16,now: 2024-07-28 23:38:53.533098,epoch time: 0:01:26.052429,used: 0:25:04.381454,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99152195, 'recall': 0.991552, 'specificity': 0.991552, 'f1': 0.9915353, 'auroc': 0.99955106, 'binary_precision': 0.99291235, 'binary_recall': 0.9903599, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9916344}
confusion matrix:
      0     1
0  1505    11
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8501553, 'precision': 0.8555629, 'recall': 0.8492904, 'specificity': 0.8492904, 'f1': 0.8493357, 'auroc': 0.9164052, 'binary_precision': 0.89605737, 'binary_recall': 0.78740156, 'binary_specificity': 0.9111792, 'binary_f1_score': 0.838223}
confusion matrix:
     0    1
0  595   58
1  135  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88372093, 'precision': 0.88492, 'recall': 0.88372093, 'specificity': 0.88372093, 'f1': 0.8836303, 'auroc': 0.9427366, 'binary_precision': 0.90640396, 'binary_recall': 0.855814, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8803828}
confusion matrix:
     0    1
0  196   19
1   31  184
early stop counter: 9
val acc:0.8501552939414978, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 17,now: 2024-07-28 23:40:29.507971,epoch time: 0:01:35.974873,used: 0:26:40.356327,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889891, 'recall': 0.98906374, 'specificity': 0.98906374, 'f1': 0.98893213, 'auroc': 0.99966633, 'binary_precision': 0.99869025, 'binary_recall': 0.97944766, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98897535}
confusion matrix:
      0     1
0  1513     2
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.6925466, 'precision': 0.78827715, 'recall': 0.68847114, 'specificity': 0.68847114, 'f1': 0.66186154, 'auroc': 0.8960817, 'binary_precision': 0.9509434, 'binary_recall': 0.3968504, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.56}
confusion matrix:
     0    1
0  640   13
1  383  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.85478544, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.78640294, 'auroc': 0.93667924, 'binary_precision': 1.0, 'binary_recall': 0.59069765, 'binary_specificity': 1.0, 'binary_f1_score': 0.74269}
confusion matrix:
     0    1
0  215    0
1   88  127
early stop counter: 10
val acc:0.6925466060638428, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 18,now: 2024-07-28 23:41:59.637837,epoch time: 0:01:30.129866,used: 0:28:10.486193,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98553973, 'recall': 0.9855144, 'specificity': 0.9855144, 'f1': 0.98535156, 'auroc': 0.99943316, 'binary_precision': 0.998679, 'binary_recall': 0.97234726, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98533726}
confusion matrix:
      0     1
0  1515     2
1    43  1512
---- Validation: 
scalar performance:
{'acc': 0.78493786, 'precision': 0.83607817, 'recall': 0.78219366, 'specificity': 0.78219366, 'f1': 0.77528113, 'auroc': 0.93117654, 'binary_precision': 0.9637306, 'binary_recall': 0.58582675, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.7286973}
confusion matrix:
     0    1
0  639   14
1  263  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69534886, 'precision': 0.8106936, 'recall': 0.69534886, 'specificity': 0.69534886, 'f1': 0.66418064, 'auroc': 0.9380205, 'binary_precision': 1.0, 'binary_recall': 0.3906977, 'binary_specificity': 1.0, 'binary_f1_score': 0.5618729}
confusion matrix:
     0   1
0  215   0
1  131  84
early stop counter: 11
val acc:0.784937858581543, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8883720636367798 / 0.8999999761581421
after epoch: 19,now: 2024-07-28 23:43:33.059503,epoch time: 0:01:33.421666,used: 0:29:43.907859,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97579885, 'recall': 0.9739195, 'specificity': 0.9739195, 'f1': 0.9742439, 'auroc': 0.99946237, 'binary_precision': 0.9522936, 'binary_recall': 0.9993582, 'binary_specificity': 0.94848084, 'binary_f1_score': 0.97525835}
confusion matrix:
      0     1
0  1436    78
1     1  1557
---- Validation: 
scalar performance:
{'acc': 0.8742236, 'precision': 0.8761933, 'recall': 0.8747417, 'specificity': 0.8747417, 'f1': 0.8741459, 'auroc': 0.9327682, 'binary_precision': 0.8452555, 'binary_recall': 0.911811, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.8772727}
confusion matrix:
     0    1
0  547  106
1   56  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8791026, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.8790672, 'auroc': 0.94533265, 'binary_precision': 0.8826291, 'binary_recall': 0.8744186, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8785047}
confusion matrix:
     0    1
0  190   25
1   27  188
better model found
persisted
after epoch: 20,now: 2024-07-28 23:44:57.836938,epoch time: 0:01:24.777435,used: 0:31:08.685294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9913914, 'recall': 0.9911158, 'specificity': 0.9911158, 'f1': 0.99120724, 'auroc': 0.9997562, 'binary_precision': 0.98479086, 'binary_recall': 0.9980732, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.99138755}
confusion matrix:
      0     1
0  1491    24
1     3  1554
---- Validation: 
scalar performance:
{'acc': 0.8703416, 'precision': 0.87036693, 'recall': 0.8704357, 'specificity': 0.8704357, 'f1': 0.87033784, 'auroc': 0.92964995, 'binary_precision': 0.8622291, 'binary_recall': 0.8771654, 'binary_specificity': 0.863706, 'binary_f1_score': 0.86963314}
confusion matrix:
     0    1
0  564   89
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8884057, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8883697, 'auroc': 0.9483829, 'binary_precision': 0.8847926, 'binary_recall': 0.89302325, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8888889}
confusion matrix:
     0    1
0  190   25
1   23  192
early stop counter: 1
val acc:0.8703415989875793, best validation acc: 0.8742235898971558, corresponding to test acc:                         0.8790697455406189 / 0.8999999761581421
after epoch: 21,now: 2024-07-28 23:46:33.155141,epoch time: 0:01:35.318203,used: 0:32:44.003497,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9792664, 'recall': 0.9786725, 'specificity': 0.9786725, 'f1': 0.9788272, 'auroc': 0.9989109, 'binary_precision': 0.968005, 'binary_recall': 0.99100834, 'binary_specificity': 0.9663366, 'binary_f1_score': 0.97937167}
confusion matrix:
      0     1
0  1464    51
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.85636646, 'precision': 0.857431, 'recall': 0.8559803, 'specificity': 0.8559803, 'f1': 0.8561409, 'auroc': 0.9220991, 'binary_precision': 0.87375414, 'binary_recall': 0.82834643, 'binary_specificity': 0.88361406, 'binary_f1_score': 0.8504447}
confusion matrix:
     0    1
0  577   76
1  109  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.84902596, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.84881675, 'auroc': 0.92404544, 'binary_precision': 0.84090906, 'binary_recall': 0.8604651, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8505747}
confusion matrix:
     0    1
0  180   35
1   30  185
early stop counter: 2
val acc:0.8563664555549622, best validation acc: 0.8742235898971558, corresponding to test acc:                         0.8790697455406189 / 0.8999999761581421
after epoch: 22,now: 2024-07-28 23:47:58.556133,epoch time: 0:01:25.400992,used: 0:34:09.404489,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99282885, 'recall': 0.99284637, 'specificity': 0.99284637, 'f1': 0.9928372, 'auroc': 0.9997567, 'binary_precision': 0.99357325, 'binary_recall': 0.9922978, 'binary_specificity': 0.993395, 'binary_f1_score': 0.9929351}
confusion matrix:
      0     1
0  1504    10
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.757764, 'precision': 0.8041478, 'recall': 0.7550036, 'specificity': 0.7550036, 'f1': 0.74680173, 'auroc': 0.89691675, 'binary_precision': 0.9194805, 'binary_recall': 0.55748034, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.69411767}
confusion matrix:
     0    1
0  622   31
1  281  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.879771, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8535036, 'auroc': 0.92521363, 'binary_precision': 0.9751553, 'binary_recall': 0.73023254, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.8351064}
confusion matrix:
     0    1
0  211    4
1   58  157
early stop counter: 3
val acc:0.7577639818191528, best validation acc: 0.8742235898971558, corresponding to test acc:                         0.8790697455406189 / 0.8999999761581421
after epoch: 23,now: 2024-07-28 23:49:29.427251,epoch time: 0:01:30.871118,used: 0:35:40.275607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9861724, 'recall': 0.98549634, 'specificity': 0.98549634, 'f1': 0.9856669, 'auroc': 0.9998224, 'binary_precision': 0.9737007, 'binary_recall': 0.99871546, 'binary_specificity': 0.9722772, 'binary_f1_score': 0.9860495}
confusion matrix:
      0     1
0  1473    42
1     2  1555
---- Validation: 
scalar performance:
{'acc': 0.88121116, 'precision': 0.8834787, 'recall': 0.8817631, 'specificity': 0.8817631, 'f1': 0.8811234, 'auroc': 0.93532455, 'binary_precision': 0.8502907, 'binary_recall': 0.9212598, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.88435376}
confusion matrix:
     0    1
0  550  103
1   50  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8767442, 'precision': 0.87694806, 'recall': 0.87674415, 'specificity': 0.87674415, 'f1': 0.87672746, 'auroc': 0.93698215, 'binary_precision': 0.8857143, 'binary_recall': 0.8651163, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8752941}
confusion matrix:
     0    1
0  191   24
1   29  186
better model found
persisted
after epoch: 24,now: 2024-07-28 23:50:53.134556,epoch time: 0:01:23.707305,used: 0:37:03.982912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99481, 'recall': 0.99477476, 'specificity': 0.99477476, 'f1': 0.9947907, 'auroc': 0.99993, 'binary_precision': 0.99358565, 'binary_recall': 0.9961415, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9948619}
confusion matrix:
      0     1
0  1507    10
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.9076087, 'precision': 0.9090407, 'recall': 0.9072108, 'specificity': 0.9072108, 'f1': 0.907452, 'auroc': 0.9421663, 'binary_precision': 0.93, 'binary_recall': 0.87874013, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.9036437}
confusion matrix:
     0    1
0  611   42
1   77  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.8905973, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8806926, 'auroc': 0.926252, 'binary_precision': 0.9505494, 'binary_recall': 0.80465114, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8715365}
confusion matrix:
     0    1
0  206    9
1   42  173
better model found
persisted
after epoch: 25,now: 2024-07-28 23:52:28.131555,epoch time: 0:01:34.996999,used: 0:38:38.979911,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99547446, 'recall': 0.9954165, 'specificity': 0.9954165, 'f1': 0.9954417, 'auroc': 0.99990976, 'binary_precision': 0.9935979, 'binary_recall': 0.9974293, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9955099}
confusion matrix:
      0     1
0  1506    10
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.8423913, 'precision': 0.8613856, 'recall': 0.84078693, 'specificity': 0.84078693, 'f1': 0.839826, 'auroc': 0.92908084, 'binary_precision': 0.94081634, 'binary_recall': 0.7259843, 'binary_specificity': 0.9555896, 'binary_f1_score': 0.8195556}
confusion matrix:
     0    1
0  624   29
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8757771, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84346384, 'auroc': 0.9353813, 'binary_precision': 0.9806452, 'binary_recall': 0.7069768, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.82162166}
confusion matrix:
     0    1
0  212    3
1   63  152
early stop counter: 1
val acc:0.842391312122345, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8813953399658203 / 0.8999999761581421
after epoch: 26,now: 2024-07-28 23:53:52.543547,epoch time: 0:01:24.411992,used: 0:40:03.391903,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931905, 'recall': 0.9931394, 'specificity': 0.9931394, 'f1': 0.9931624, 'auroc': 0.99967015, 'binary_precision': 0.99168265, 'binary_recall': 0.99486524, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9932714}
confusion matrix:
      0     1
0  1501    13
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8509121, 'recall': 0.8355572, 'specificity': 0.8355572, 'f1': 0.83489275, 'auroc': 0.9232935, 'binary_precision': 0.91748524, 'binary_recall': 0.73543304, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.8164335}
confusion matrix:
     0    1
0  611   42
1  168  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8540179, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81395197, 'auroc': 0.9228556, 'binary_precision': 0.9659864, 'binary_recall': 0.6604651, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.7845304}
confusion matrix:
     0    1
0  210    5
1   73  142
early stop counter: 2
val acc:0.8369565010070801, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8813953399658203 / 0.8999999761581421
after epoch: 27,now: 2024-07-28 23:55:25.572024,epoch time: 0:01:33.028477,used: 0:41:36.420380,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915288, 'recall': 0.99161136, 'specificity': 0.99161136, 'f1': 0.991536, 'auroc': 0.9997202, 'binary_precision': 0.9973992, 'binary_recall': 0.9858612, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99159664}
confusion matrix:
      0     1
0  1512     4
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.6863354, 'precision': 0.7834686, 'recall': 0.68219364, 'specificity': 0.68219364, 'f1': 0.65395415, 'auroc': 0.9098883, 'binary_precision': 0.9459459, 'binary_recall': 0.38582677, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.54809844}
confusion matrix:
     0    1
0  639   14
1  390  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.8143275, 'recall': 0.7046512, 'specificity': 0.7046512, 'f1': 0.67642546, 'auroc': 0.9190048, 'binary_precision': 1.0, 'binary_recall': 0.40930232, 'binary_specificity': 1.0, 'binary_f1_score': 0.58085805}
confusion matrix:
     0   1
0  215   0
1  127  88
early stop counter: 3
val acc:0.6863353848457336, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8813953399658203 / 0.8999999761581421
after epoch: 28,now: 2024-07-28 23:56:57.764292,epoch time: 0:01:32.192268,used: 0:43:08.612648,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99413043, 'recall': 0.99420416, 'specificity': 0.99420416, 'f1': 0.9941403, 'auroc': 0.99975884, 'binary_precision': 0.99935025, 'binary_recall': 0.9890675, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9941823}
confusion matrix:
      0     1
0  1516     1
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.7181677, 'precision': 0.8028144, 'recall': 0.71443367, 'specificity': 0.71443367, 'f1': 0.69471407, 'auroc': 0.93002135, 'binary_precision': 0.9594595, 'binary_recall': 0.4472441, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.6100967}
confusion matrix:
     0    1
0  641   12
1  351  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.7851459, 'recall': 0.6232558, 'specificity': 0.6232558, 'f1': 0.56093687, 'auroc': 0.8975338, 'binary_precision': 1.0, 'binary_recall': 0.24651162, 'binary_specificity': 1.0, 'binary_f1_score': 0.3955224}
confusion matrix:
     0   1
0  215   0
1  162  53
early stop counter: 4
val acc:0.7181677222251892, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8813953399658203 / 0.8999999761581421
after epoch: 29,now: 2024-07-28 23:58:24.315917,epoch time: 0:01:26.551625,used: 0:44:35.164273,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957433, 'recall': 0.995828, 'specificity': 0.995828, 'f1': 0.99576783, 'auroc': 0.99996865, 'binary_precision': 1.0, 'binary_recall': 0.99165595, 'binary_specificity': 1.0, 'binary_f1_score': 0.9958105}
confusion matrix:
      0     1
0  1514     0
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.867236, 'precision': 0.8782496, 'recall': 0.8660489, 'specificity': 0.8660489, 'f1': 0.86597365, 'auroc': 0.93650866, 'binary_precision': 0.93939394, 'binary_recall': 0.78110236, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.8529664}
confusion matrix:
     0    1
0  621   32
1  139  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.872216, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84119636, 'auroc': 0.9301677, 'binary_precision': 0.974359, 'binary_recall': 0.7069768, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.81940705}
confusion matrix:
     0    1
0  211    4
1   63  152
early stop counter: 5
val acc:0.8672360181808472, best validation acc: 0.907608687877655, corresponding to test acc:                         0.8813953399658203 / 0.8999999761581421
after epoch: 30,now: 2024-07-28 23:59:57.232526,epoch time: 0:01:32.916609,used: 0:46:08.080882,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_28_23_13_48_seed_0_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:46:08.080882 at 2024-07-28 23:59:57.232526
persisted model performance metric: 

scalar performance:
{'acc': 0.88139534, 'precision': 0.8905973, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.8806926, 'auroc': 0.926252, 'binary_precision': 0.9505494, 'binary_recall': 0.80465114, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8715365}
confusion matrix:
     0    1
0  206    9
1   42  173
oracle model performance metric: 

scalar performance:
{'acc': 0.9, 'precision': 0.9038529, 'recall': 0.9, 'specificity': 0.9, 'f1': 0.89976096, 'auroc': 0.9543753, 'binary_precision': 0.943299, 'binary_recall': 0.8511628, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.8948656}
confusion matrix:
     0    1
0  204   11
1   32  183
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457386 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool | 416794 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457386 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool | 416794 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72474 GiB |  72473 GiB |
|       from small pool |  40405 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14488 MiB |  14488 MiB |  14488 MiB |      0 B   |
|       from large pool |  14422 MiB |  14422 MiB |  14422 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 419157 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool | 406502 KiB |   1252 MiB |  53506 GiB |  53505 GiB |
|       from small pool |  12655 KiB |     17 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12911 K  |   12910 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6349 K  |    6348 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12911 K  |   12910 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6349 K  |    6348 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     635    |     635    |       0    |
|       from large pool |     602    |     602    |     602    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      88    |     652    |    8533 K  |    8533 K  |
|       from large pool |      30    |     604    |    4792 K  |    4792 K  |
|       from small pool |      58    |     234    |    3740 K  |    3740 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72474 GiB |  72474 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14488 MiB |  14488 MiB |  13632 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool |  24320 KiB |   1252 MiB |  53506 GiB |  53506 GiB |
|       from small pool |      0 KiB |     45 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6349 K  |    6349 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6349 K  |    6349 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |     635    |     573    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |    8533 K  |    8533 K  |
|       from large pool |       3    |     604    |    4792 K  |    4792 K  |
|       from small pool |       0    |     234    |    3741 K  |    3741 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73409 GiB |  73409 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72542 GiB |  72542 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72474 GiB |  72474 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    856 MiB |  14488 MiB |  14488 MiB |  13632 MiB |
|       from large pool |    804 MiB |  14422 MiB |  14422 MiB |  13618 MiB |
|       from small pool |     52 MiB |     66 MiB |     66 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |  54377 GiB |  54377 GiB |
|       from large pool |  24320 KiB |   1252 MiB |  53506 GiB |  53506 GiB |
|       from small pool |      0 KiB |     45 MiB |    871 GiB |    871 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6349 K  |    6349 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6349 K  |    6349 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     635    |     635    |     573    |
|       from large pool |      36    |     602    |     602    |     566    |
|       from small pool |      26    |      33    |      33    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |    8533 K  |    8533 K  |
|       from large pool |       3    |     604    |    4792 K  |    4792 K  |
|       from small pool |       0    |     234    |    3741 K  |    3741 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367

 Experiment start at: 2024-07-29 00:00:47.145344
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.929362, 'precision': 0.9369626, 'recall': 0.93020093, 'specificity': 0.93020093, 'f1': 0.92913723, 'auroc': 0.98791623, 'binary_precision': 0.99776787, 'binary_recall': 0.86237943, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.92514664}
confusion matrix:
      0     1
0  1514     3
1   214  1341
---- Validation: 
scalar performance:
{'acc': 0.67291176, 'precision': 0.7247469, 'recall': 0.6688684, 'specificity': 0.6688684, 'f1': 0.64966214, 'auroc': 0.8567064, 'binary_precision': 0.8286604, 'binary_recall': 0.42222223, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.55941117}
confusion matrix:
     0    1
0  596   55
1  364  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.83460015, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8180148, 'auroc': 0.8934519, 'binary_precision': 0.9044944, 'binary_recall': 0.71555555, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7990074}
confusion matrix:
     0    1
0  208   17
1   64  161
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 00:02:37.880281,epoch time: 0:01:50.734937,used: 0:01:50.734937,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9684049, 'recall': 0.96848536, 'specificity': 0.96848536, 'f1': 0.968422, 'auroc': 0.99438584, 'binary_precision': 0.97341114, 'binary_recall': 0.9640334, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.9686996}
confusion matrix:
      0     1
0  1474    41
1    56  1501
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.80731577, 'recall': 0.7955965, 'specificity': 0.7955965, 'f1': 0.79223657, 'auroc': 0.8435789, 'binary_precision': 0.7389034, 'binary_recall': 0.8984127, 'binary_specificity': 0.6927803, 'binary_f1_score': 0.8108883}
confusion matrix:
     0    1
0  451  200
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75333333, 'precision': 0.77963114, 'recall': 0.75333333, 'specificity': 0.75333333, 'f1': 0.7473943, 'auroc': 0.89212835, 'binary_precision': 0.6938776, 'binary_recall': 0.9066667, 'binary_specificity': 0.6, 'binary_f1_score': 0.7861272}
confusion matrix:
     0    1
0  135   90
1   21  204
better model found
persisted
after epoch: 2,now: 2024-07-29 00:04:05.604696,epoch time: 0:01:27.724415,used: 0:03:18.459352,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97500765, 'recall': 0.9748119, 'specificity': 0.9748119, 'f1': 0.9746085, 'auroc': 0.9972115, 'binary_precision': 0.992, 'binary_recall': 0.95752895, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.9744597}
confusion matrix:
      0     1
0  1506    12
1    66  1488
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8105004, 'recall': 0.80199695, 'specificity': 0.80199695, 'f1': 0.8016238, 'auroc': 0.87260866, 'binary_precision': 0.85393256, 'binary_recall': 0.72380954, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.7835052}
confusion matrix:
     0    1
0  573   78
1  174  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8673924, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86660075, 'auroc': 0.93570375, 'binary_precision': 0.88372093, 'binary_recall': 0.84444445, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8636364}
confusion matrix:
     0    1
0  200   25
1   35  190
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 00:05:31.615571,epoch time: 0:01:26.010875,used: 0:04:44.470227,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.97402847, 'recall': 0.97390306, 'specificity': 0.97390306, 'f1': 0.97395086, 'auroc': 0.99546564, 'binary_precision': 0.97066325, 'binary_recall': 0.9781491, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9743918}
confusion matrix:
      0     1
0  1470    46
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.85468966, 'recall': 0.8491807, 'specificity': 0.8491807, 'f1': 0.8493569, 'auroc': 0.9126545, 'binary_precision': 0.89107144, 'binary_recall': 0.7920635, 'binary_specificity': 0.906298, 'binary_f1_score': 0.8386555}
confusion matrix:
     0    1
0  590   61
1  131  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8466631, 'recall': 0.8444444, 'specificity': 0.8444444, 'f1': 0.8441951, 'auroc': 0.9178667, 'binary_precision': 0.87439615, 'binary_recall': 0.80444443, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8379629}
confusion matrix:
     0    1
0  199   26
1   44  181
better model found
persisted
after epoch: 4,now: 2024-07-29 00:07:07.345951,epoch time: 0:01:35.730380,used: 0:06:20.200607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.9745548, 'recall': 0.97375894, 'specificity': 0.97375894, 'f1': 0.97393787, 'auroc': 0.99742085, 'binary_precision': 0.96067417, 'binary_recall': 0.9890745, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.97466743}
confusion matrix:
      0     1
0  1453    63
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.84543324, 'precision': 0.84583414, 'recall': 0.8457245, 'specificity': 0.8457245, 'f1': 0.8454309, 'auroc': 0.9142662, 'binary_precision': 0.8292683, 'binary_recall': 0.8634921, 'binary_specificity': 0.827957, 'binary_f1_score': 0.8460342}
confusion matrix:
     0    1
0  539  112
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8111173, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8111102, 'auroc': 0.9005234, 'binary_precision': 0.8097345, 'binary_recall': 0.81333333, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.81152993}
confusion matrix:
     0    1
0  182   43
1   42  183
early stop counter: 1
val acc:0.845433235168457, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8444444537162781 / 0.8666666746139526
after epoch: 5,now: 2024-07-29 00:08:35.059356,epoch time: 0:01:27.713405,used: 0:07:47.914012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9794767, 'recall': 0.9793751, 'specificity': 0.9793751, 'f1': 0.97916645, 'auroc': 0.9982865, 'binary_precision': 0.9953519, 'binary_recall': 0.9633676, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9790986}
confusion matrix:
      0     1
0  1509     7
1    57  1499
---- Validation: 
scalar performance:
{'acc': 0.78454334, 'precision': 0.82189965, 'recall': 0.7817204, 'specificity': 0.7817204, 'f1': 0.77690697, 'auroc': 0.9032332, 'binary_precision': 0.92753625, 'binary_recall': 0.60952383, 'binary_specificity': 0.953917, 'binary_f1_score': 0.7356322}
confusion matrix:
     0    1
0  621   30
1  246  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.85467935, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8282581, 'auroc': 0.9248988, 'binary_precision': 0.9461078, 'binary_recall': 0.7022222, 'binary_specificity': 0.96, 'binary_f1_score': 0.8061225}
confusion matrix:
     0    1
0  216    9
1   67  158
early stop counter: 2
val acc:0.7845433354377747, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8444444537162781 / 0.8666666746139526
after epoch: 6,now: 2024-07-29 00:10:08.959553,epoch time: 0:01:33.900197,used: 0:09:21.814209,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.97540987, 'recall': 0.9751761, 'specificity': 0.9751761, 'f1': 0.97525156, 'auroc': 0.9978732, 'binary_precision': 0.9695238, 'binary_recall': 0.98199356, 'binary_specificity': 0.9683586, 'binary_f1_score': 0.97571886}
confusion matrix:
      0     1
0  1469    48
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.891491, 'precision': 0.89274585, 'recall': 0.89103943, 'specificity': 0.89103943, 'f1': 0.8912979, 'auroc': 0.9311218, 'binary_precision': 0.91122276, 'binary_recall': 0.8634921, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.8867156}
confusion matrix:
     0    1
0  598   53
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.87100685, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8687015, 'auroc': 0.931121, 'binary_precision': 0.89903843, 'binary_recall': 0.83111113, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86374134}
confusion matrix:
     0    1
0  204   21
1   38  187
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-29 00:11:36.919415,epoch time: 0:01:27.959862,used: 0:10:49.774071,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98222667, 'recall': 0.98228246, 'specificity': 0.98228246, 'f1': 0.9820962, 'auroc': 0.99861324, 'binary_precision': 0.99473685, 'binary_recall': 0.96985245, 'binary_specificity': 0.9947125, 'binary_f1_score': 0.982137}
confusion matrix:
      0     1
0  1505     8
1    47  1512
---- Validation: 
scalar performance:
{'acc': 0.8321624, 'precision': 0.8459095, 'recall': 0.8305172, 'specificity': 0.8305172, 'f1': 0.82995343, 'auroc': 0.90935063, 'binary_precision': 0.9108911, 'binary_recall': 0.73015875, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.8105727}
confusion matrix:
     0    1
0  606   45
1  170  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8626163, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8523886, 'auroc': 0.9270123, 'binary_precision': 0.9206349, 'binary_recall': 0.7733333, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8405796}
confusion matrix:
     0    1
0  210   15
1   51  174
early stop counter: 1
val acc:0.8321623802185059, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 8,now: 2024-07-29 00:13:13.359438,epoch time: 0:01:36.440023,used: 0:12:26.214094,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97328866, 'recall': 0.9729179, 'specificity': 0.9729179, 'f1': 0.972654, 'auroc': 0.9983959, 'binary_precision': 0.9939557, 'binary_recall': 0.9517685, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9724047}
confusion matrix:
      0     1
0  1508     9
1    75  1480
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.83899295, 'recall': 0.80140805, 'specificity': 0.80140805, 'f1': 0.797879, 'auroc': 0.9155097, 'binary_precision': 0.9437939, 'binary_recall': 0.63968253, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.76253545}
confusion matrix:
     0    1
0  627   24
1  227  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8611841, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81213343, 'auroc': 0.9301728, 'binary_precision': 0.9863946, 'binary_recall': 0.64444447, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.77956986}
confusion matrix:
     0    1
0  223    2
1   80  145
early stop counter: 2
val acc:0.8040593266487122, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 9,now: 2024-07-29 00:14:46.197223,epoch time: 0:01:32.837785,used: 0:13:59.051879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9788382, 'recall': 0.9783834, 'specificity': 0.9783834, 'f1': 0.9785045, 'auroc': 0.9987906, 'binary_precision': 0.96912414, 'binary_recall': 0.9890675, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.97899425}
confusion matrix:
      0     1
0  1468    49
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.8601907, 'recall': 0.8592422, 'specificity': 0.8592422, 'f1': 0.85865456, 'auroc': 0.92297995, 'binary_precision': 0.8325926, 'binary_recall': 0.8920635, 'binary_specificity': 0.8264209, 'binary_f1_score': 0.86130273}
confusion matrix:
     0    1
0  538  113
1   68  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8408339, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8349164, 'auroc': 0.9324049, 'binary_precision': 0.798419, 'binary_recall': 0.8977778, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8451883}
confusion matrix:
     0    1
0  174   51
1   23  202
early stop counter: 3
val acc:0.858704149723053, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 10,now: 2024-07-29 00:17:07.153390,epoch time: 0:02:20.956167,used: 0:16:20.008046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9547526, 'precision': 0.95854414, 'recall': 0.9541896, 'specificity': 0.9541896, 'f1': 0.954612, 'auroc': 0.9984247, 'binary_precision': 0.9199763, 'binary_recall': 0.9974293, 'binary_specificity': 0.9109499, 'binary_f1_score': 0.9571384}
confusion matrix:
      0     1
0  1381   135
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.8212334, 'precision': 0.82274866, 'recall': 0.821787, 'specificity': 0.821787, 'f1': 0.8211597, 'auroc': 0.88672614, 'binary_precision': 0.7961595, 'binary_recall': 0.85555553, 'binary_specificity': 0.7880184, 'binary_f1_score': 0.8247896}
confusion matrix:
     0    1
0  513  138
1   91  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82850003, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82390094, 'auroc': 0.9224296, 'binary_precision': 0.792, 'binary_recall': 0.88, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.8336842}
confusion matrix:
     0    1
0  173   52
1   27  198
early stop counter: 4
val acc:0.8212333917617798, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 11,now: 2024-07-29 00:19:38.400239,epoch time: 0:02:31.246849,used: 0:18:51.254895,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98461306, 'recall': 0.9845407, 'specificity': 0.9845407, 'f1': 0.98437494, 'auroc': 0.99921745, 'binary_precision': 0.9986755, 'binary_recall': 0.97039896, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.98433423}
confusion matrix:
      0     1
0  1516     2
1    46  1508
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8497554, 'recall': 0.8172555, 'specificity': 0.8172555, 'f1': 0.814885, 'auroc': 0.9282179, 'binary_precision': 0.9483146, 'binary_recall': 0.6698413, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.78511626}
confusion matrix:
     0    1
0  628   23
1  208  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8535089, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82331264, 'auroc': 0.9295802, 'binary_precision': 0.9509202, 'binary_recall': 0.6888889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7989691}
confusion matrix:
     0    1
0  217    8
1   70  155
early stop counter: 5
val acc:0.8196721076965332, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 12,now: 2024-07-29 00:22:00.170426,epoch time: 0:02:21.770187,used: 0:21:13.025082,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909042, 'recall': 0.99086595, 'specificity': 0.99086595, 'f1': 0.99088335, 'auroc': 0.9996591, 'binary_precision': 0.98975015, 'binary_recall': 0.9922929, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.99101985}
confusion matrix:
      0     1
0  1499    16
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.88212335, 'precision': 0.8870692, 'recall': 0.8812084, 'specificity': 0.8812084, 'f1': 0.88153857, 'auroc': 0.9294126, 'binary_precision': 0.92691624, 'binary_recall': 0.82539684, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.87321573}
confusion matrix:
     0    1
0  610   41
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8711111, 'precision': 0.8832228, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.87008464, 'auroc': 0.946, 'binary_precision': 0.95135134, 'binary_recall': 0.7822222, 'binary_specificity': 0.96, 'binary_f1_score': 0.8585366}
confusion matrix:
     0    1
0  216    9
1   49  176
new oracle model saved
early stop counter: 6
val acc:0.8821233510971069, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 13,now: 2024-07-29 00:24:35.780819,epoch time: 0:02:35.610393,used: 0:23:48.635475,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.9619893, 'recall': 0.95853615, 'specificity': 0.95853615, 'f1': 0.9588837, 'auroc': 0.9989152, 'binary_precision': 0.9275449, 'binary_recall': 0.9967825, 'binary_specificity': 0.9202899, 'binary_f1_score': 0.96091807}
confusion matrix:
      0     1
0  1397   121
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.8332639, 'recall': 0.83320534, 'specificity': 0.83320534, 'f1': 0.83294207, 'auroc': 0.8890449, 'binary_precision': 0.8180428, 'binary_recall': 0.8492063, 'binary_specificity': 0.8172043, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  532  119
1   95  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85434127, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8532289, 'auroc': 0.9164444, 'binary_precision': 0.835443, 'binary_recall': 0.88, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  186   39
1   27  198
early stop counter: 7
val acc:0.8329430222511292, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 14,now: 2024-07-29 00:27:05.175229,epoch time: 0:02:29.394410,used: 0:26:18.029885,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.97526, 'recall': 0.9736644, 'specificity': 0.9736644, 'f1': 0.9739249, 'auroc': 0.99959385, 'binary_precision': 0.95328826, 'binary_recall': 0.99742764, 'binary_specificity': 0.9499011, 'binary_f1_score': 0.9748586}
confusion matrix:
      0     1
0  1441    76
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.87665886, 'precision': 0.87820673, 'recall': 0.8761393, 'specificity': 0.8761393, 'f1': 0.87639666, 'auroc': 0.92211497, 'binary_precision': 0.8986486, 'binary_recall': 0.84444445, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.8707038}
confusion matrix:
     0    1
0  591   60
1   98  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86792, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86168677, 'auroc': 0.9259654, 'binary_precision': 0.9137056, 'binary_recall': 0.8, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.85308063}
confusion matrix:
     0    1
0  208   17
1   45  180
early stop counter: 8
val acc:0.8766588568687439, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 15,now: 2024-07-29 00:29:23.250912,epoch time: 0:02:18.075683,used: 0:28:36.105568,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925047, 'recall': 0.99255633, 'specificity': 0.99255633, 'f1': 0.9925127, 'auroc': 0.999688, 'binary_precision': 0.9967511, 'binary_recall': 0.98840207, 'binary_specificity': 0.99671054, 'binary_f1_score': 0.992559}
confusion matrix:
      0     1
0  1515     5
1    18  1534
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.83877575, 'recall': 0.8046595, 'specificity': 0.8046595, 'f1': 0.8016462, 'auroc': 0.9159187, 'binary_precision': 0.9382151, 'binary_recall': 0.6507937, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.7685098}
confusion matrix:
     0    1
0  624   27
1  220  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8462589, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8113742, 'auroc': 0.9238864, 'binary_precision': 0.9493671, 'binary_recall': 0.6666667, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.78328985}
confusion matrix:
     0    1
0  217    8
1   75  150
early stop counter: 9
val acc:0.8071818947792053, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 16,now: 2024-07-29 00:31:54.725223,epoch time: 0:02:31.474311,used: 0:31:07.579879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918475, 'recall': 0.99193615, 'specificity': 0.99193615, 'f1': 0.99186146, 'auroc': 0.99952686, 'binary_precision': 0.9974026, 'binary_recall': 0.98651254, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.99192774}
confusion matrix:
      0     1
0  1511     4
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.84648633, 'recall': 0.82718897, 'specificity': 0.82718897, 'f1': 0.8262612, 'auroc': 0.9176121, 'binary_precision': 0.9202454, 'binary_recall': 0.71428573, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8042896}
confusion matrix:
     0    1
0  612   39
1  180  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.82179636, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.80953, 'auroc': 0.90366423, 'binary_precision': 0.8804348, 'binary_recall': 0.72, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.7921761}
confusion matrix:
     0    1
0  203   22
1   63  162
early stop counter: 10
val acc:0.8290398120880127, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 17,now: 2024-07-29 00:33:31.191993,epoch time: 0:01:36.466770,used: 0:32:44.046649,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918664, 'recall': 0.9919496, 'specificity': 0.9919496, 'f1': 0.99186164, 'auroc': 0.99984056, 'binary_precision': 0.99869704, 'binary_recall': 0.9852185, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.991912}
confusion matrix:
      0     1
0  1514     2
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.8483461, 'recall': 0.8213774, 'specificity': 0.8213774, 'f1': 0.8196494, 'auroc': 0.9210129, 'binary_precision': 0.93722945, 'binary_recall': 0.6873016, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.7930403}
confusion matrix:
     0    1
0  622   29
1  197  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8450992, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.82432085, 'auroc': 0.91083455, 'binary_precision': 0.9248555, 'binary_recall': 0.7111111, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.80402017}
confusion matrix:
     0    1
0  212   13
1   65  160
early stop counter: 11
val acc:0.8235753178596497, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 18,now: 2024-07-29 00:36:06.482380,epoch time: 0:02:35.290387,used: 0:35:19.337036,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98817915, 'recall': 0.98785317, 'specificity': 0.98785317, 'f1': 0.9879507, 'auroc': 0.9996706, 'binary_precision': 0.98037976, 'binary_recall': 0.9961415, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.9881978}
confusion matrix:
      0     1
0  1486    31
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.85480094, 'precision': 0.85652447, 'recall': 0.85422426, 'specificity': 0.85422426, 'f1': 0.8544489, 'auroc': 0.91927433, 'binary_precision': 0.877551, 'binary_recall': 0.81904763, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.84729064}
confusion matrix:
     0    1
0  579   72
1  114  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84219, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8397436, 'auroc': 0.9158716, 'binary_precision': 0.8695652, 'binary_recall': 0.8, 'binary_specificity': 0.88, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  198   27
1   45  180
early stop counter: 12
val acc:0.8548009395599365, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 19,now: 2024-07-29 00:38:33.402023,epoch time: 0:02:26.919643,used: 0:37:46.256679,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9815708, 'recall': 0.98131925, 'specificity': 0.98131925, 'f1': 0.9811188, 'auroc': 0.9993578, 'binary_precision': 0.999332, 'binary_recall': 0.96329683, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9809836}
confusion matrix:
      0     1
0  1518     1
1    57  1496
---- Validation: 
scalar performance:
{'acc': 0.7470726, 'precision': 0.8107449, 'recall': 0.74331796, 'specificity': 0.74331796, 'f1': 0.73144656, 'auroc': 0.8878045, 'binary_precision': 0.94736844, 'binary_recall': 0.51428574, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  633   18
1  306  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7111111, 'precision': 0.7950311, 'recall': 0.7111111, 'specificity': 0.7111111, 'f1': 0.6889952, 'auroc': 0.90921474, 'binary_precision': 0.95238096, 'binary_recall': 0.44444445, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.60606056}
confusion matrix:
     0    1
0  220    5
1  125  100
early stop counter: 13
val acc:0.7470725774765015, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 20,now: 2024-07-29 00:40:20.238038,epoch time: 0:01:46.836015,used: 0:39:33.092694,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931487, 'recall': 0.99318314, 'specificity': 0.99318314, 'f1': 0.9931632, 'auroc': 0.9996986, 'binary_precision': 0.9948387, 'binary_recall': 0.99163985, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9932367}
confusion matrix:
      0     1
0  1509     8
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.86726093, 'recall': 0.8516385, 'specificity': 0.8516385, 'f1': 0.85138774, 'auroc': 0.92552304, 'binary_precision': 0.93503934, 'binary_recall': 0.75396824, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.8347979}
confusion matrix:
     0    1
0  618   33
1  155  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.85498035, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8256858, 'auroc': 0.92454314, 'binary_precision': 0.9512195, 'binary_recall': 0.6933333, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  217    8
1   69  156
early stop counter: 14
val acc:0.8532396554946899, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 21,now: 2024-07-29 00:43:03.579271,epoch time: 0:02:43.341233,used: 0:42:16.433927,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870789, 'recall': 0.9869112, 'specificity': 0.9869112, 'f1': 0.9869745, 'auroc': 0.99946374, 'binary_precision': 0.98282444, 'binary_recall': 0.99165595, 'binary_specificity': 0.98216647, 'binary_f1_score': 0.9872204}
confusion matrix:
      0     1
0  1487    27
1    13  1545
---- Validation: 
scalar performance:
{'acc': 0.84231067, 'precision': 0.84652936, 'recall': 0.8432156, 'specificity': 0.8432156, 'f1': 0.8420403, 'auroc': 0.9151561, 'binary_precision': 0.80397725, 'binary_recall': 0.8984127, 'binary_specificity': 0.7880184, 'binary_f1_score': 0.8485757}
confusion matrix:
     0    1
0  513  138
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8231414, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8220957, 'auroc': 0.9001087, 'binary_precision': 0.8059072, 'binary_recall': 0.8488889, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.8268398}
confusion matrix:
     0    1
0  179   46
1   34  191
early stop counter: 15
val acc:0.8423106670379639, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 22,now: 2024-07-29 00:45:19.118390,epoch time: 0:02:15.539119,used: 0:44:31.973046,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9849349, 'recall': 0.9848887, 'specificity': 0.9848887, 'f1': 0.9847005, 'auroc': 0.99907243, 'binary_precision': 0.9993382, 'binary_recall': 0.970437, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9846756}
confusion matrix:
      0     1
0  1515     1
1    46  1510
---- Validation: 
scalar performance:
{'acc': 0.6736924, 'precision': 0.7877743, 'recall': 0.66845876, 'specificity': 0.66845876, 'f1': 0.6337577, 'auroc': 0.92029357, 'binary_precision': 0.9649123, 'binary_recall': 0.34920636, 'binary_specificity': 0.9877112, 'binary_f1_score': 0.51282054}
confusion matrix:
     0    1
0  643    8
1  410  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62222224, 'precision': 0.76075685, 'recall': 0.62222224, 'specificity': 0.62222224, 'f1': 0.56436074, 'auroc': 0.9254123, 'binary_precision': 0.9508197, 'binary_recall': 0.25777778, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.4055944}
confusion matrix:
     0   1
0  222   3
1  167  58
early stop counter: 16
val acc:0.6736924052238464, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 23,now: 2024-07-29 00:48:05.680328,epoch time: 0:02:46.561938,used: 0:47:18.534984,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928525, 'recall': 0.992926, 'specificity': 0.992926, 'f1': 0.9928384, 'auroc': 0.9997592, 'binary_precision': 1.0, 'binary_recall': 0.98585206, 'binary_specificity': 1.0, 'binary_f1_score': 0.99287564}
confusion matrix:
      0     1
0  1517     0
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.72131145, 'precision': 0.80449307, 'recall': 0.7169739, 'specificity': 0.7169739, 'f1': 0.69826907, 'auroc': 0.9190921, 'binary_precision': 0.959596, 'binary_recall': 0.45238096, 'binary_specificity': 0.98156685, 'binary_f1_score': 0.61488676}
confusion matrix:
     0    1
0  639   12
1  345  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511111, 'precision': 0.76913875, 'recall': 0.6511111, 'specificity': 0.6511111, 'f1': 0.6081509, 'auroc': 0.92303216, 'binary_precision': 0.94736844, 'binary_recall': 0.32, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.47840533}
confusion matrix:
     0   1
0  221   4
1  153  72
early stop counter: 17
val acc:0.7213114500045776, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 24,now: 2024-07-29 00:50:22.018173,epoch time: 0:02:16.337845,used: 0:49:34.872829,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941217, 'recall': 0.994172, 'specificity': 0.994172, 'f1': 0.99414, 'auroc': 0.9998139, 'binary_precision': 0.99676794, 'binary_recall': 0.99163985, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.99419725}
confusion matrix:
      0     1
0  1512     5
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.8545488, 'recall': 0.83830005, 'specificity': 0.83830005, 'f1': 0.8378037, 'auroc': 0.9161022, 'binary_precision': 0.9224652, 'binary_recall': 0.73650795, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8190644}
confusion matrix:
     0    1
0  612   39
1  166  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8344941, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8231158, 'auroc': 0.9049679, 'binary_precision': 0.8924731, 'binary_recall': 0.73777777, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8077858}
confusion matrix:
     0    1
0  205   20
1   59  166
early stop counter: 18
val acc:0.8399688005447388, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 25,now: 2024-07-29 00:53:05.586821,epoch time: 0:02:43.568648,used: 0:52:18.441477,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99413383, 'recall': 0.9942008, 'specificity': 0.9942008, 'f1': 0.9941404, 'auroc': 0.99984276, 'binary_precision': 0.99934983, 'binary_recall': 0.98906046, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.99417853}
confusion matrix:
      0     1
0  1517     1
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.7587822, 'precision': 0.8142116, 'recall': 0.75529957, 'specificity': 0.75529957, 'f1': 0.74594057, 'auroc': 0.90361655, 'binary_precision': 0.94214875, 'binary_recall': 0.54285717, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.6888218}
confusion matrix:
     0    1
0  630   21
1  288  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8453863, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81663054, 'auroc': 0.90885925, 'binary_precision': 0.9390244, 'binary_recall': 0.6844444, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.79177374}
confusion matrix:
     0    1
0  215   10
1   71  154
early stop counter: 19
val acc:0.7587822079658508, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 26,now: 2024-07-29 00:55:49.418429,epoch time: 0:02:43.831608,used: 0:55:02.273085,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.99576384, 'recall': 0.99577165, 'specificity': 0.99577165, 'f1': 0.9957676, 'auroc': 0.9997991, 'binary_precision': 0.996139, 'binary_recall': 0.9954984, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9958186}
confusion matrix:
      0     1
0  1511     6
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.8604944, 'recall': 0.8306708, 'specificity': 0.8306708, 'f1': 0.8289801, 'auroc': 0.9265715, 'binary_precision': 0.95614034, 'binary_recall': 0.6920635, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.8029466}
confusion matrix:
     0    1
0  631   20
1  194  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.85, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8057143, 'auroc': 0.9314568, 'binary_precision': 0.96666664, 'binary_recall': 0.64444447, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7733333}
confusion matrix:
     0    1
0  220    5
1   80  145
early stop counter: 20
val acc:0.8329430222511292, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 27,now: 2024-07-29 00:58:32.149656,epoch time: 0:02:42.731227,used: 0:57:45.004312,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99444735, 'recall': 0.9945096, 'specificity': 0.9945096, 'f1': 0.9944657, 'auroc': 0.9998627, 'binary_precision': 0.998057, 'binary_recall': 0.9909968, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.99451435}
confusion matrix:
      0     1
0  1514     3
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.81889147, 'precision': 0.85142756, 'recall': 0.81638503, 'specificity': 0.81638503, 'f1': 0.81374186, 'auroc': 0.9240637, 'binary_precision': 0.9543379, 'binary_recall': 0.6634921, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.7827715}
confusion matrix:
     0    1
0  631   20
1  212  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.81624424, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76264244, 'auroc': 0.913679, 'binary_precision': 0.9357143, 'binary_recall': 0.5822222, 'binary_specificity': 0.96, 'binary_f1_score': 0.71780825}
confusion matrix:
     0    1
0  216    9
1   94  131
early stop counter: 21
val acc:0.8188914656639099, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 28,now: 2024-07-29 01:01:09.838222,epoch time: 0:02:37.688566,used: 1:00:22.692878,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98716307, 'recall': 0.98713, 'specificity': 0.98713, 'f1': 0.9869791, 'auroc': 0.99988127, 'binary_precision': 1.0, 'binary_recall': 0.97426, 'binary_specificity': 1.0, 'binary_f1_score': 0.9869622}
confusion matrix:
      0     1
0  1518     0
1    40  1514
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.82996774, 'recall': 0.7621608, 'specificity': 0.7621608, 'f1': 0.75212204, 'auroc': 0.9297893, 'binary_precision': 0.9714286, 'binary_recall': 0.53968257, 'binary_specificity': 0.984639, 'binary_f1_score': 0.6938776}
confusion matrix:
     0    1
0  641   10
1  290  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5733333, 'precision': 0.7316115, 'recall': 0.5733333, 'specificity': 0.5733333, 'f1': 0.48542026, 'auroc': 0.9090766, 'binary_precision': 0.9230769, 'binary_recall': 0.16, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.27272725}
confusion matrix:
     0   1
0  222   3
1  189  36
early stop counter: 22
val acc:0.7658079862594604, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 29,now: 2024-07-29 01:03:57.010882,epoch time: 0:02:47.172660,used: 1:03:09.865538,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934703, 'recall': 0.99352884, 'specificity': 0.99352884, 'f1': 0.993489, 'auroc': 0.9998801, 'binary_precision': 0.99676377, 'binary_recall': 0.9903537, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9935484}
confusion matrix:
      0     1
0  1512     5
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.7892272, 'precision': 0.83489984, 'recall': 0.78617513, 'specificity': 0.78617513, 'f1': 0.78053045, 'auroc': 0.93479145, 'binary_precision': 0.95454544, 'binary_recall': 0.6, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  633   18
1  252  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.7393081, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.50423884, 'auroc': 0.9278419, 'binary_precision': 0.9318182, 'binary_recall': 0.18222222, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.3048327}
confusion matrix:
     0   1
0  222   3
1  184  41
early stop counter: 23
val acc:0.7892271876335144, best validation acc: 0.8914909958839417, corresponding to test acc:                         0.8688889145851135 / 0.8711110949516296
after epoch: 30,now: 2024-07-29 01:06:35.892678,epoch time: 0:02:38.881796,used: 1:05:48.747334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_00_00_46_seed_1_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 1:05:48.747334 at 2024-07-29 01:06:35.892678
persisted model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.87100685, 'recall': 0.8688889, 'specificity': 0.8688889, 'f1': 0.8687015, 'auroc': 0.931121, 'binary_precision': 0.89903843, 'binary_recall': 0.83111113, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.86374134}
confusion matrix:
     0    1
0  204   21
1   38  187
oracle model performance metric: 

scalar performance:
{'acc': 0.8711111, 'precision': 0.8832228, 'recall': 0.8711111, 'specificity': 0.8711111, 'f1': 0.87008464, 'auroc': 0.946, 'binary_precision': 0.95135134, 'binary_recall': 0.7822222, 'binary_specificity': 0.96, 'binary_f1_score': 0.8585366}
confusion matrix:
     0    1
0  216    9
1   49  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455482 KiB |  13219 MiB | 148643 GiB | 148642 GiB |
|       from large pool | 414883 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455482 KiB |  13219 MiB | 148643 GiB | 148642 GiB |
|       from large pool | 414883 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 146769 GiB | 146768 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14488 MiB |  28104 MiB |  13632 MiB |
|       from large pool |  14402 MiB |  14422 MiB |  28020 MiB |  13618 MiB |
|       from small pool |     70 MiB |     70 MiB |     84 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 486598 KiB |   1260 MiB | 110441 GiB | 110440 GiB |
|       from large pool | 475996 KiB |   1252 MiB | 108672 GiB | 108671 GiB |
|       from small pool |  10601 KiB |     45 MiB |   1769 GiB |   1769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26108 K  |   26107 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12825 K  |   12824 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26108 K  |   26107 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12825 K  |   12824 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1209    |     573    |
|       from large pool |     601    |     602    |    1167    |     566    |
|       from small pool |      35    |      35    |      42    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |   17840 K  |   17840 K  |
|       from large pool |      41    |     604    |   10094 K  |   10094 K  |
|       from small pool |      56    |     234    |    7746 K  |    7745 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146769 GiB | 146769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14488 MiB |  28104 MiB |  27184 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 110441 GiB | 110441 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 108672 GiB | 108672 GiB |
|       from small pool |      0 KiB |     45 MiB |   1769 GiB |   1769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1209    |    1145    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   17840 K  |   17840 K  |
|       from large pool |       3    |     604    |   10094 K  |   10094 K  |
|       from small pool |       0    |     234    |    7746 K  |    7746 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 148643 GiB | 148643 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 146885 GiB | 146885 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146769 GiB | 146769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    920 MiB |  14488 MiB |  28104 MiB |  27184 MiB |
|       from large pool |    870 MiB |  14422 MiB |  28020 MiB |  27150 MiB |
|       from small pool |     50 MiB |     70 MiB |     84 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 110441 GiB | 110441 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 108672 GiB | 108672 GiB |
|       from small pool |      0 KiB |     45 MiB |   1769 GiB |   1769 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1209    |    1145    |
|       from large pool |      39    |     602    |    1167    |    1128    |
|       from small pool |      25    |      35    |      42    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   17840 K  |   17840 K  |
|       from large pool |       3    |     604    |   10094 K  |   10094 K  |
|       from small pool |       0    |     234    |    7746 K  |    7746 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367

 Experiment start at: 2024-07-29 01:07:40.608757
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94993454, 'precision': 0.9532893, 'recall': 0.9502835, 'specificity': 0.9502835, 'f1': 0.94986594, 'auroc': 0.9948854, 'binary_precision': 0.9942979, 'binary_recall': 0.90584415, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9480122}
confusion matrix:
      0     1
0  1508     8
1   145  1395
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.75892836, 'recall': 0.73218274, 'specificity': 0.73218274, 'f1': 0.72802585, 'auroc': 0.8356403, 'binary_precision': 0.8290993, 'binary_recall': 0.57717043, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.6805687}
confusion matrix:
     0    1
0  582   74
1  263  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7805797, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7799971, 'auroc': 0.8836162, 'binary_precision': 0.7688889, 'binary_recall': 0.8009259, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.78458047}
confusion matrix:
     0    1
0  164   52
1   43  173
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 01:10:22.964057,epoch time: 0:02:42.355300,used: 0:02:42.355300,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95909685, 'precision': 0.96163553, 'recall': 0.9594002, 'specificity': 0.9594002, 'f1': 0.95905733, 'auroc': 0.99512213, 'binary_precision': 0.9978888, 'binary_recall': 0.9207792, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.95778453}
confusion matrix:
      0     1
0  1513     3
1   122  1418
---- Validation: 
scalar performance:
{'acc': 0.7097027, 'precision': 0.77209103, 'recall': 0.70314336, 'specificity': 0.70314336, 'f1': 0.6877308, 'auroc': 0.86449105, 'binary_precision': 0.89589906, 'binary_recall': 0.45659164, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.6048988}
confusion matrix:
     0    1
0  623   33
1  338  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.82961285, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82333195, 'auroc': 0.8918896, 'binary_precision': 0.87234044, 'binary_recall': 0.7592593, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.81188124}
confusion matrix:
     0    1
0  192   24
1   52  164
new oracle model saved
early stop counter: 1
val acc:0.7097026705741882, best validation acc: 0.7363067269325256, corresponding to test acc:                         0.7800925970077515 / 0.8240740895271301
after epoch: 2,now: 2024-07-29 01:12:50.628961,epoch time: 0:02:27.664904,used: 0:05:10.020204,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.97641957, 'recall': 0.97622675, 'specificity': 0.97622675, 'f1': 0.9761114, 'auroc': 0.9971096, 'binary_precision': 0.99063545, 'binary_recall': 0.96168834, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.97594726}
confusion matrix:
      0     1
0  1502    14
1    59  1481
---- Validation: 
scalar performance:
{'acc': 0.771518, 'precision': 0.78862774, 'recall': 0.76814806, 'specificity': 0.76814806, 'f1': 0.76646435, 'auroc': 0.86624086, 'binary_precision': 0.8525641, 'binary_recall': 0.6414791, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.7321101}
confusion matrix:
     0    1
0  587   69
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.82231885, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82168186, 'auroc': 0.89308983, 'binary_precision': 0.8088889, 'binary_recall': 0.8425926, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  173   43
1   34  182
better model found
persisted
after epoch: 3,now: 2024-07-29 01:14:52.924860,epoch time: 0:02:02.295899,used: 0:07:12.316103,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.98172176, 'recall': 0.9817308, 'specificity': 0.9817308, 'f1': 0.9816754, 'auroc': 0.99784374, 'binary_precision': 0.98880106, 'binary_recall': 0.9746753, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9816873}
confusion matrix:
      0     1
0  1499    17
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8170873, 'recall': 0.81382346, 'specificity': 0.81382346, 'f1': 0.81191874, 'auroc': 0.8922217, 'binary_precision': 0.7705383, 'binary_recall': 0.8745981, 'binary_specificity': 0.7530488, 'binary_f1_score': 0.8192771}
confusion matrix:
     0    1
0  494  162
1   78  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.76080585, 'recall': 0.7060185, 'specificity': 0.7060185, 'f1': 0.6897236, 'auroc': 0.9035494, 'binary_precision': 0.64126986, 'binary_recall': 0.9351852, 'binary_specificity': 0.47685185, 'binary_f1_score': 0.76082855}
confusion matrix:
     0    1
0  103  113
1   14  202
better model found
persisted
after epoch: 4,now: 2024-07-29 01:16:38.499147,epoch time: 0:01:45.574287,used: 0:08:57.890390,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98316514, 'recall': 0.98307574, 'specificity': 0.98307574, 'f1': 0.982984, 'auroc': 0.9985218, 'binary_precision': 0.9946808, 'binary_recall': 0.9714286, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9829172}
confusion matrix:
      0     1
0  1508     8
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.8419405, 'precision': 0.8509122, 'recall': 0.8397871, 'specificity': 0.8397871, 'f1': 0.8402362, 'auroc': 0.9126245, 'binary_precision': 0.90076333, 'binary_recall': 0.75884247, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.82373476}
confusion matrix:
     0    1
0  604   52
1  150  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.8365209, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8355416, 'auroc': 0.91072965, 'binary_precision': 0.81938326, 'binary_recall': 0.8611111, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8397292}
confusion matrix:
     0    1
0  175   41
1   30  186
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 01:18:49.442950,epoch time: 0:02:10.943803,used: 0:11:08.834193,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9839332, 'recall': 0.9837508, 'specificity': 0.9837508, 'f1': 0.98363805, 'auroc': 0.99838734, 'binary_precision': 0.99799466, 'binary_recall': 0.9694805, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.983531}
confusion matrix:
      0     1
0  1513     3
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.74804384, 'precision': 0.7920401, 'recall': 0.74274075, 'specificity': 0.74274075, 'f1': 0.73533976, 'auroc': 0.8773068, 'binary_precision': 0.89893615, 'binary_recall': 0.54340833, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.6773547}
confusion matrix:
     0    1
0  618   38
1  284  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.7845385, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77923024, 'auroc': 0.85345936, 'binary_precision': 0.8201058, 'binary_recall': 0.7175926, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.7654321}
confusion matrix:
     0    1
0  182   34
1   61  155
early stop counter: 1
val acc:0.7480438351631165, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 6,now: 2024-07-29 01:21:23.024882,epoch time: 0:02:33.581932,used: 0:13:42.416125,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9803549, 'recall': 0.97987014, 'specificity': 0.97987014, 'f1': 0.9797089, 'auroc': 0.99877024, 'binary_precision': 1.0, 'binary_recall': 0.9597403, 'binary_specificity': 1.0, 'binary_f1_score': 0.9794566}
confusion matrix:
      0     1
0  1516     0
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.76447576, 'precision': 0.8122835, 'recall': 0.7591635, 'specificity': 0.7591635, 'f1': 0.7525109, 'auroc': 0.8826832, 'binary_precision': 0.928, 'binary_recall': 0.55948555, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.6980943}
confusion matrix:
     0    1
0  629   27
1  274  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8263889, 'precision': 0.82656384, 'recall': 0.8263889, 'specificity': 0.8263889, 'f1': 0.82636565, 'auroc': 0.8905607, 'binary_precision': 0.8341232, 'binary_recall': 0.8148148, 'binary_specificity': 0.837963, 'binary_f1_score': 0.82435596}
confusion matrix:
     0    1
0  181   35
1   40  176
early stop counter: 2
val acc:0.7644757628440857, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 7,now: 2024-07-29 01:22:58.004227,epoch time: 0:01:34.979345,used: 0:15:17.395470,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9840696, 'recall': 0.9840395, 'specificity': 0.9840395, 'f1': 0.983966, 'auroc': 0.9990829, 'binary_precision': 0.99338186, 'binary_recall': 0.9746753, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9839397}
confusion matrix:
      0     1
0  1506    10
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.7879499, 'precision': 0.80019736, 'recall': 0.7851541, 'specificity': 0.7851541, 'f1': 0.78453034, 'auroc': 0.86919653, 'binary_precision': 0.8545455, 'binary_recall': 0.6800643, 'binary_specificity': 0.8902439, 'binary_f1_score': 0.75738585}
confusion matrix:
     0    1
0  584   72
1  199  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.800982, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.7900421, 'auroc': 0.893347, 'binary_precision': 0.7480315, 'binary_recall': 0.8796296, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.8085106}
confusion matrix:
     0    1
0  152   64
1   26  190
early stop counter: 3
val acc:0.7879499197006226, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 8,now: 2024-07-29 01:25:13.691558,epoch time: 0:02:15.687331,used: 0:17:33.082801,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9848641, 'recall': 0.98454493, 'specificity': 0.98454493, 'f1': 0.9846158, 'auroc': 0.99925125, 'binary_precision': 0.9757807, 'binary_recall': 0.9941558, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9848826}
confusion matrix:
      0     1
0  1478    38
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.7762128, 'precision': 0.77734905, 'recall': 0.7751794, 'specificity': 0.7751794, 'f1': 0.77541864, 'auroc': 0.8403042, 'binary_precision': 0.78965515, 'binary_recall': 0.7363344, 'binary_specificity': 0.8140244, 'binary_f1_score': 0.7620632}
confusion matrix:
     0    1
0  534  122
1  164  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.7745742, 'recall': 0.7615741, 'specificity': 0.7615741, 'f1': 0.75871813, 'auroc': 0.864519, 'binary_precision': 0.7148289, 'binary_recall': 0.8703704, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.7849687}
confusion matrix:
     0    1
0  141   75
1   28  188
early stop counter: 4
val acc:0.7762128114700317, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 9,now: 2024-07-29 01:27:15.967475,epoch time: 0:02:02.275917,used: 0:19:35.358718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.9777812, 'recall': 0.9772573, 'specificity': 0.9772573, 'f1': 0.97709036, 'auroc': 0.99871963, 'binary_precision': 0.9979675, 'binary_recall': 0.9564935, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9767905}
confusion matrix:
      0     1
0  1513     3
1    67  1473
---- Validation: 
scalar performance:
{'acc': 0.7034429, 'precision': 0.757622, 'recall': 0.69712913, 'specificity': 0.69712913, 'f1': 0.6826675, 'auroc': 0.8266858, 'binary_precision': 0.8693009, 'binary_recall': 0.45980707, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.6014721}
confusion matrix:
     0    1
0  613   43
1  336  286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.7894206, 'recall': 0.7615741, 'specificity': 0.7615741, 'f1': 0.7556977, 'auroc': 0.8562671, 'binary_precision': 0.8791946, 'binary_recall': 0.6064815, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.7178083}
confusion matrix:
     0    1
0  198   18
1   85  131
early stop counter: 5
val acc:0.7034428715705872, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 10,now: 2024-07-29 01:29:57.132091,epoch time: 0:02:41.164616,used: 0:22:16.523334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98928726, 'recall': 0.9892703, 'specificity': 0.9892703, 'f1': 0.98920155, 'auroc': 0.99967015, 'binary_precision': 0.9980172, 'binary_recall': 0.9805195, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.989191}
confusion matrix:
      0     1
0  1513     3
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.7261346, 'precision': 0.80763197, 'recall': 0.7191495, 'specificity': 0.7191495, 'f1': 0.7025306, 'auroc': 0.8915012, 'binary_precision': 0.9594595, 'binary_recall': 0.45659164, 'binary_specificity': 0.98170733, 'binary_f1_score': 0.6187364}
confusion matrix:
     0    1
0  644   12
1  338  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8326925, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80421853, 'auroc': 0.89263976, 'binary_precision': 0.9235669, 'binary_recall': 0.6712963, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7774799}
confusion matrix:
     0    1
0  204   12
1   71  145
early stop counter: 6
val acc:0.7261345982551575, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 11,now: 2024-07-29 01:31:35.715676,epoch time: 0:01:38.583585,used: 0:23:55.106919,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.97726154, 'recall': 0.9762893, 'specificity': 0.9762893, 'f1': 0.9764228, 'auroc': 0.9991776, 'binary_precision': 0.9593242, 'binary_recall': 0.99545455, 'binary_specificity': 0.957124, 'binary_f1_score': 0.9770555}
confusion matrix:
      0     1
0  1451    65
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.81298906, 'precision': 0.81717247, 'recall': 0.8113775, 'specificity': 0.8113775, 'f1': 0.8117181, 'auroc': 0.86935824, 'binary_precision': 0.8475499, 'binary_recall': 0.7508039, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.7962489}
confusion matrix:
     0    1
0  572   84
1  155  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.7482648, 'recall': 0.73842597, 'specificity': 0.73842597, 'f1': 0.73580843, 'auroc': 0.871935, 'binary_precision': 0.6988417, 'binary_recall': 0.837963, 'binary_specificity': 0.6388889, 'binary_f1_score': 0.7621053}
confusion matrix:
     0    1
0  138   78
1   35  181
early stop counter: 7
val acc:0.8129890561103821, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 12,now: 2024-07-29 01:33:02.673507,epoch time: 0:01:26.957831,used: 0:25:22.064750,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98496485, 'recall': 0.98474026, 'specificity': 0.98474026, 'f1': 0.98461956, 'auroc': 0.9995991, 'binary_precision': 1.0, 'binary_recall': 0.9694805, 'binary_specificity': 1.0, 'binary_f1_score': 0.9845038}
confusion matrix:
      0     1
0  1516     0
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.64397496, 'precision': 0.76704276, 'recall': 0.6347027, 'specificity': 0.6347027, 'f1': 0.58910966, 'auroc': 0.85714114, 'binary_precision': 0.9417989, 'binary_recall': 0.28617364, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.43896425}
confusion matrix:
     0    1
0  645   11
1  444  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.76832294, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.6847219, 'auroc': 0.8157364, 'binary_precision': 0.9, 'binary_recall': 0.45833334, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.607362}
confusion matrix:
     0   1
0  205  11
1  117  99
early stop counter: 8
val acc:0.6439749598503113, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 13,now: 2024-07-29 01:35:37.229747,epoch time: 0:02:34.556240,used: 0:27:56.620990,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99280643, 'recall': 0.99279547, 'specificity': 0.99279547, 'f1': 0.99280053, 'auroc': 0.99960256, 'binary_precision': 0.9922179, 'binary_recall': 0.9935065, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.99286175}
confusion matrix:
      0     1
0  1504    12
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.7438016, 'recall': 0.73106277, 'specificity': 0.73106277, 'f1': 0.72950494, 'auroc': 0.8062848, 'binary_precision': 0.7865854, 'binary_recall': 0.6221865, 'binary_specificity': 0.839939, 'binary_f1_score': 0.6947935}
confusion matrix:
     0    1
0  551  105
1  235  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.7182008, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.714321, 'auroc': 0.7780564, 'binary_precision': 0.74345547, 'binary_recall': 0.6574074, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.69778866}
confusion matrix:
     0    1
0  167   49
1   74  142
early stop counter: 9
val acc:0.7339593172073364, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 14,now: 2024-07-29 01:37:50.090992,epoch time: 0:02:12.861245,used: 0:30:09.482235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9626963, 'precision': 0.9648226, 'recall': 0.96244216, 'specificity': 0.96244216, 'f1': 0.9626368, 'auroc': 0.9988568, 'binary_precision': 0.93528694, 'binary_recall': 0.9948052, 'binary_specificity': 0.93007916, 'binary_f1_score': 0.96412843}
confusion matrix:
      0     1
0  1410   106
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.7605634, 'precision': 0.7988738, 'recall': 0.7652267, 'specificity': 0.7652267, 'f1': 0.7546748, 'auroc': 0.90179205, 'binary_precision': 0.6850117, 'binary_recall': 0.94051445, 'binary_specificity': 0.589939, 'binary_f1_score': 0.7926829}
confusion matrix:
     0    1
0  387  269
1   37  585
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6736111, 'precision': 0.7610293, 'recall': 0.6736111, 'specificity': 0.6736111, 'f1': 0.64378744, 'auroc': 0.9041924, 'binary_precision': 0.6099707, 'binary_recall': 0.962963, 'binary_specificity': 0.38425925, 'binary_f1_score': 0.74685824}
confusion matrix:
    0    1
0  83  133
1   8  208
early stop counter: 10
val acc:0.7605633735656738, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 15,now: 2024-07-29 01:40:02.512796,epoch time: 0:02:12.421804,used: 0:32:21.904039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.9783441, 'recall': 0.9779015, 'specificity': 0.9779015, 'f1': 0.97774565, 'auroc': 0.99924874, 'binary_precision': 0.9972973, 'binary_recall': 0.95844156, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97748345}
confusion matrix:
      0     1
0  1512     4
1    64  1476
---- Validation: 
scalar performance:
{'acc': 0.6510172, 'precision': 0.74139977, 'recall': 0.642604, 'specificity': 0.642604, 'f1': 0.6073944, 'auroc': 0.81695306, 'binary_precision': 0.8826087, 'binary_recall': 0.32636657, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.47652584}
confusion matrix:
     0    1
0  629   27
1  419  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7314815, 'precision': 0.81660414, 'recall': 0.73148143, 'specificity': 0.73148143, 'f1': 0.71213233, 'auroc': 0.86876285, 'binary_precision': 0.9807692, 'binary_recall': 0.4722222, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.6374999}
confusion matrix:
     0    1
0  214    2
1  114  102
early stop counter: 11
val acc:0.6510171890258789, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 16,now: 2024-07-29 01:42:01.700351,epoch time: 0:01:59.187555,used: 0:34:21.091594,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9915049, 'recall': 0.99148136, 'specificity': 0.99148136, 'f1': 0.99149144, 'auroc': 0.9995836, 'binary_precision': 0.990285, 'binary_recall': 0.99285716, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9915694}
confusion matrix:
      0     1
0  1501    15
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.8239437, 'precision': 0.8305342, 'recall': 0.8220066, 'specificity': 0.8220066, 'f1': 0.8223512, 'auroc': 0.8936726, 'binary_precision': 0.87102807, 'binary_recall': 0.7491961, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.8055315}
confusion matrix:
     0    1
0  587   69
1  156  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.835513, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8304507, 'auroc': 0.8955332, 'binary_precision': 0.87434554, 'binary_recall': 0.7731481, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.82063884}
confusion matrix:
     0    1
0  192   24
1   49  167
early stop counter: 12
val acc:0.8239436745643616, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 17,now: 2024-07-29 01:44:34.957104,epoch time: 0:02:33.256753,used: 0:36:54.348347,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99378, 'recall': 0.9937849, 'specificity': 0.9937849, 'f1': 0.9937824, 'auroc': 0.9994787, 'binary_precision': 0.99415207, 'binary_recall': 0.9935065, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9938292}
confusion matrix:
      0     1
0  1507     9
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.7934272, 'precision': 0.81328106, 'recall': 0.78998953, 'specificity': 0.78998953, 'f1': 0.7886571, 'auroc': 0.8881142, 'binary_precision': 0.88577586, 'binary_recall': 0.6607717, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.7569061}
confusion matrix:
     0    1
0  603   53
1  211  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8342881, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8067008, 'auroc': 0.8771648, 'binary_precision': 0.9240506, 'binary_recall': 0.6759259, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7807486}
confusion matrix:
     0    1
0  204   12
1   70  146
early stop counter: 13
val acc:0.7934272289276123, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 18,now: 2024-07-29 01:46:03.947016,epoch time: 0:01:28.989912,used: 0:38:23.338259,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9887937, 'recall': 0.98847187, 'specificity': 0.98847187, 'f1': 0.9885436, 'auroc': 0.9998424, 'binary_precision': 0.97960484, 'binary_recall': 0.99805194, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.98874235}
confusion matrix:
      0     1
0  1484    32
1     3  1537
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.8181132, 'recall': 0.81598014, 'specificity': 0.81598014, 'f1': 0.8163184, 'auroc': 0.8752059, 'binary_precision': 0.83219177, 'binary_recall': 0.7813505, 'binary_specificity': 0.8506098, 'binary_f1_score': 0.80597013}
confusion matrix:
     0    1
0  558   98
1  136  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.7837213, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.76537555, 'auroc': 0.8995199, 'binary_precision': 0.7180451, 'binary_recall': 0.8842593, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.79253113}
confusion matrix:
     0    1
0  141   75
1   25  191
early stop counter: 14
val acc:0.8169013857841492, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 19,now: 2024-07-29 01:47:38.616691,epoch time: 0:01:34.669675,used: 0:39:58.007934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.98953474, 'recall': 0.9895641, 'specificity': 0.9895641, 'f1': 0.98952866, 'auroc': 0.9993819, 'binary_precision': 0.99410224, 'binary_recall': 0.9850649, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9895629}
confusion matrix:
      0     1
0  1507     9
1    23  1517
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.7526417, 'recall': 0.6415085, 'specificity': 0.6415085, 'f1': 0.6029574, 'auroc': 0.8463019, 'binary_precision': 0.90697676, 'binary_recall': 0.31350482, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.46594977}
confusion matrix:
     0    1
0  636   20
1  427  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041667, 'precision': 0.7790698, 'recall': 0.6041667, 'specificity': 0.6041667, 'f1': 0.5306227, 'auroc': 0.88976765, 'binary_precision': 1.0, 'binary_recall': 0.20833333, 'binary_specificity': 1.0, 'binary_f1_score': 0.34482756}
confusion matrix:
     0   1
0  216   0
1  171  45
early stop counter: 15
val acc:0.6502347588539124, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 20,now: 2024-07-29 01:49:14.397288,epoch time: 0:01:35.780597,used: 0:41:33.788531,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9871465, 'recall': 0.987013, 'specificity': 0.987013, 'f1': 0.98691064, 'auroc': 0.9998488, 'binary_precision': 1.0, 'binary_recall': 0.97402596, 'binary_specificity': 1.0, 'binary_f1_score': 0.9868421}
confusion matrix:
      0     1
0  1516     0
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.6596244, 'precision': 0.77953994, 'recall': 0.6506965, 'specificity': 0.6506965, 'f1': 0.611206, 'auroc': 0.8950279, 'binary_precision': 0.95609754, 'binary_recall': 0.31511253, 'binary_specificity': 0.9862805, 'binary_f1_score': 0.47400242}
confusion matrix:
     0    1
0  647    9
1  426  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.82053876, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.7672815, 'auroc': 0.8852023, 'binary_precision': 0.94074076, 'binary_recall': 0.587963, 'binary_specificity': 0.962963, 'binary_f1_score': 0.72364676}
confusion matrix:
     0    1
0  208    8
1   89  127
early stop counter: 16
val acc:0.6596243977546692, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 21,now: 2024-07-29 01:50:53.401227,epoch time: 0:01:39.003939,used: 0:43:12.792470,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9860985, 'recall': 0.9860184, 'specificity': 0.9860184, 'f1': 0.98592913, 'auroc': 0.9996612, 'binary_precision': 0.99734217, 'binary_recall': 0.9746753, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9858784}
confusion matrix:
      0     1
0  1512     4
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.7782744, 'recall': 0.6434201, 'specificity': 0.6434201, 'f1': 0.60035497, 'auroc': 0.91436946, 'binary_precision': 0.9587629, 'binary_recall': 0.29903537, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.45588237}
confusion matrix:
     0    1
0  648    8
1  436  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6203704, 'precision': 0.7751323, 'recall': 0.6203704, 'specificity': 0.6203704, 'f1': 0.5582491, 'auroc': 0.9153378, 'binary_precision': 0.9814815, 'binary_recall': 0.24537037, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.3925926}
confusion matrix:
     0   1
0  215   1
1  163  53
early stop counter: 17
val acc:0.6525821685791016, best validation acc: 0.8419405221939087, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 22,now: 2024-07-29 01:52:34.186716,epoch time: 0:01:40.785489,used: 0:44:53.577959,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931456, 'recall': 0.993115, 'specificity': 0.993115, 'f1': 0.9931277, 'auroc': 0.99974126, 'binary_precision': 0.99158573, 'binary_recall': 0.9948052, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.99319285}
confusion matrix:
      0     1
0  1503    13
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.85211265, 'precision': 0.85705245, 'recall': 0.8505289, 'specificity': 0.8505289, 'f1': 0.85110766, 'auroc': 0.9140999, 'binary_precision': 0.892922, 'binary_recall': 0.7909968, 'binary_specificity': 0.910061, 'binary_f1_score': 0.8388747}
confusion matrix:
     0    1
0  597   59
1  130  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8541667, 'precision': 0.85978836, 'recall': 0.8541667, 'specificity': 0.8541667, 'f1': 0.8535948, 'auroc': 0.9252615, 'binary_precision': 0.9047619, 'binary_recall': 0.7916667, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  198   18
1   45  171
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-29 01:54:14.560364,epoch time: 0:01:40.373648,used: 0:46:33.951607,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9941559, 'recall': 0.9940839, 'specificity': 0.9940839, 'f1': 0.9941093, 'auroc': 0.9998059, 'binary_precision': 0.99096775, 'binary_recall': 0.9974026, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9941748}
confusion matrix:
      0     1
0  1502    14
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.8594625, 'recall': 0.8510828, 'specificity': 0.8510828, 'f1': 0.8516731, 'auroc': 0.9167516, 'binary_precision': 0.90185183, 'binary_recall': 0.7829582, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.83821}
confusion matrix:
     0    1
0  603   53
1  135  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8472222, 'precision': 0.8491379, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8470124, 'auroc': 0.9194959, 'binary_precision': 0.875, 'binary_recall': 0.8101852, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.84134614}
confusion matrix:
     0    1
0  191   25
1   41  175
better model found
persisted
after epoch: 24,now: 2024-07-29 01:55:48.057136,epoch time: 0:01:33.496772,used: 0:48:07.448379,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.9957385, 'recall': 0.99575865, 'specificity': 0.99575865, 'f1': 0.9957459, 'auroc': 0.9997207, 'binary_precision': 0.99739414, 'binary_recall': 0.9941558, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99577236}
confusion matrix:
      0     1
0  1512     4
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.7942097, 'precision': 0.8215456, 'recall': 0.79025173, 'specificity': 0.79025173, 'f1': 0.7881004, 'auroc': 0.88261706, 'binary_precision': 0.9088838, 'binary_recall': 0.6414791, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.7521206}
confusion matrix:
     0    1
0  616   40
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8140143, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8122736, 'auroc': 0.8814086, 'binary_precision': 0.8358209, 'binary_recall': 0.7777778, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.80575544}
confusion matrix:
     0    1
0  183   33
1   48  168
early stop counter: 1
val acc:0.7942097187042236, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8472222089767456 / 0.8541666865348816
after epoch: 25,now: 2024-07-29 01:57:24.272195,epoch time: 0:01:36.215059,used: 0:49:43.663438,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99443996, 'recall': 0.99447024, 'specificity': 0.99447024, 'f1': 0.9944371, 'auroc': 0.9999486, 'binary_precision': 0.99869025, 'binary_recall': 0.99025977, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9944571}
confusion matrix:
      0     1
0  1514     2
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.7253521, 'precision': 0.80049706, 'recall': 0.71855396, 'specificity': 0.71855396, 'f1': 0.7029448, 'auroc': 0.9126705, 'binary_precision': 0.94426227, 'binary_recall': 0.4630225, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.6213592}
confusion matrix:
     0    1
0  639   17
1  334  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6967593, 'precision': 0.7867406, 'recall': 0.6967593, 'specificity': 0.6967593, 'f1': 0.6709442, 'auroc': 0.9223894, 'binary_precision': 0.94736844, 'binary_recall': 0.41666666, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.57877815}
confusion matrix:
     0   1
0  211   5
1  126  90
early stop counter: 2
val acc:0.7253521084785461, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8472222089767456 / 0.8541666865348816
after epoch: 26,now: 2024-07-29 01:59:02.186970,epoch time: 0:01:37.914775,used: 0:51:21.578213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918884, 'recall': 0.99188316, 'specificity': 0.99188316, 'f1': 0.9918194, 'auroc': 0.999967, 'binary_precision': 1.0, 'binary_recall': 0.98376626, 'binary_specificity': 1.0, 'binary_f1_score': 0.9918167}
confusion matrix:
      0     1
0  1516     0
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.6768388, 'precision': 0.79594994, 'recall': 0.66821474, 'specificity': 0.66821474, 'f1': 0.6340508, 'auroc': 0.9090837, 'binary_precision': 0.977169, 'binary_recall': 0.34405145, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.5089179}
confusion matrix:
     0    1
0  651    5
1  408  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5833333, 'precision': 0.77272725, 'recall': 0.5833333, 'specificity': 0.5833333, 'f1': 0.49579835, 'auroc': 0.88725996, 'binary_precision': 1.0, 'binary_recall': 0.16666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  216   0
1  180  36
early stop counter: 3
val acc:0.6768388152122498, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8472222089767456 / 0.8541666865348816
after epoch: 27,now: 2024-07-29 02:00:38.980950,epoch time: 0:01:36.793980,used: 0:52:58.372193,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.9957638, 'recall': 0.99573296, 'specificity': 0.99573296, 'f1': 0.9957457, 'auroc': 0.99993575, 'binary_precision': 0.9941748, 'binary_recall': 0.9974026, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9957861}
confusion matrix:
      0     1
0  1507     9
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.78716743, 'precision': 0.826424, 'recall': 0.78247535, 'specificity': 0.78247535, 'f1': 0.7785575, 'auroc': 0.8993333, 'binary_precision': 0.9331683, 'binary_recall': 0.6061093, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.7348928}
confusion matrix:
     0    1
0  629   27
1  245  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6296296, 'precision': 0.670751, 'recall': 0.6296296, 'specificity': 0.6296296, 'f1': 0.6059023, 'auroc': 0.8066915, 'binary_precision': 0.75454545, 'binary_recall': 0.38425925, 'binary_specificity': 0.875, 'binary_f1_score': 0.5092025}
confusion matrix:
     0   1
0  189  27
1  133  83
early stop counter: 4
val acc:0.7871674299240112, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8472222089767456 / 0.8541666865348816
after epoch: 28,now: 2024-07-29 02:02:14.795417,epoch time: 0:01:35.814467,used: 0:54:34.186660,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9906126, 'recall': 0.9904662, 'specificity': 0.9904662, 'f1': 0.9905088, 'auroc': 0.99983335, 'binary_precision': 0.985228, 'binary_recall': 0.9961039, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.99063617}
confusion matrix:
      0     1
0  1493    23
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.73787165, 'precision': 0.78359413, 'recall': 0.73237395, 'specificity': 0.73237395, 'f1': 0.72374487, 'auroc': 0.88035005, 'binary_precision': 0.8910082, 'binary_recall': 0.52572346, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.661274}
confusion matrix:
     0    1
0  616   40
1  295  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.7115736, 'recall': 0.7060185, 'specificity': 0.7060185, 'f1': 0.7040761, 'auroc': 0.79138803, 'binary_precision': 0.74585634, 'binary_recall': 0.625, 'binary_specificity': 0.787037, 'binary_f1_score': 0.6801008}
confusion matrix:
     0    1
0  170   46
1   81  135
early stop counter: 5
val acc:0.7378716468811035, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8472222089767456 / 0.8541666865348816
after epoch: 29,now: 2024-07-29 02:03:47.902394,epoch time: 0:01:33.106977,used: 0:56:07.293637,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918215, 'recall': 0.9918163, 'specificity': 0.9918163, 'f1': 0.9918188, 'auroc': 0.9998137, 'binary_precision': 0.9915639, 'binary_recall': 0.99220777, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9918857}
confusion matrix:
      0     1
0  1503    13
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.63928014, 'precision': 0.77167904, 'recall': 0.62975454, 'specificity': 0.62975454, 'f1': 0.5803249, 'auroc': 0.90313196, 'binary_precision': 0.9548023, 'binary_recall': 0.27170417, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.42302877}
confusion matrix:
     0    1
0  648    8
1  453  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6805556, 'precision': 0.79351914, 'recall': 0.6805555, 'specificity': 0.6805555, 'f1': 0.6465483, 'auroc': 0.93034124, 'binary_precision': 0.9756098, 'binary_recall': 0.37037036, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.53691274}
confusion matrix:
     0   1
0  214   2
1  136  80
early stop counter: 6
val acc:0.6392801403999329, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8472222089767456 / 0.8541666865348816
after epoch: 30,now: 2024-07-29 02:05:24.943970,epoch time: 0:01:37.041576,used: 0:57:44.335213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_01_07_40_seed_2_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:57:44.335213 at 2024-07-29 02:05:24.943970
persisted model performance metric: 

scalar performance:
{'acc': 0.8472222, 'precision': 0.8491379, 'recall': 0.8472222, 'specificity': 0.8472222, 'f1': 0.8470124, 'auroc': 0.9194959, 'binary_precision': 0.875, 'binary_recall': 0.8101852, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.84134614}
confusion matrix:
     0    1
0  191   25
1   41  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8541667, 'precision': 0.85978836, 'recall': 0.8541667, 'specificity': 0.8541667, 'f1': 0.8535948, 'auroc': 0.9252615, 'binary_precision': 0.9047619, 'binary_recall': 0.7916667, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.84444445}
confusion matrix:
     0    1
0  198   18
1   45  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454144 KiB |  13219 MiB | 222134 GiB | 222133 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454144 KiB |  13219 MiB | 222134 GiB | 222133 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 221754 GiB | 221753 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  41660 MiB |  27184 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  41560 MiB |  27150 MiB |
|       from small pool |     66 MiB |     70 MiB |    100 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 463359 KiB |   1260 MiB | 161217 GiB | 161217 GiB |
|       from large pool | 450704 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |  12655 KiB |     45 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38981 K  |   38980 K  |
|       from large pool |     187    |    1413    |   19831 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19150 K  |   19149 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38981 K  |   38980 K  |
|       from large pool |     187    |    1413    |   19831 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19150 K  |   19149 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     636    |    1780    |    1145    |
|       from large pool |     602    |     602    |    1730    |    1128    |
|       from small pool |      33    |      35    |      50    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     652    |   26174 K  |   26173 K  |
|       from large pool |      38    |     604    |   14861 K  |   14861 K  |
|       from small pool |      63    |     234    |   11312 K  |   11312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222134 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222134 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221754 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14488 MiB |  41660 MiB |  40764 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 161218 GiB | 161218 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |      0 KiB |     45 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1780    |    1716    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   26174 K  |   26174 K  |
|       from large pool |       3    |     604    |   14861 K  |   14861 K  |
|       from small pool |       0    |     234    |   11312 K  |   11312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222134 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222134 GiB | 222133 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219512 GiB | 219512 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221754 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    896 MiB |  14488 MiB |  41660 MiB |  40764 MiB |
|       from large pool |    844 MiB |  14422 MiB |  41560 MiB |  40716 MiB |
|       from small pool |     52 MiB |     70 MiB |    100 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 161218 GiB | 161218 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 158580 GiB | 158580 GiB |
|       from small pool |      0 KiB |     45 MiB |   2637 GiB |   2637 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      64    |     636    |    1780    |    1716    |
|       from large pool |      38    |     602    |    1730    |    1692    |
|       from small pool |      26    |      35    |      50    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   26174 K  |   26174 K  |
|       from large pool |       3    |     604    |   14861 K  |   14861 K  |
|       from small pool |       0    |     234    |   11312 K  |   11312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367

 Experiment start at: 2024-07-29 02:06:13.517292
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.9498852, 'recall': 0.94981176, 'specificity': 0.94981176, 'f1': 0.949544, 'auroc': 0.9889504, 'binary_precision': 0.9667774, 'binary_recall': 0.9326923, 'binary_specificity': 0.9669312, 'binary_f1_score': 0.94942904}
confusion matrix:
      0     1
0  1462    50
1   105  1455
---- Validation: 
scalar performance:
{'acc': 0.8098207, 'precision': 0.81280893, 'recall': 0.81075126, 'specificity': 0.81075126, 'f1': 0.80962634, 'auroc': 0.8886466, 'binary_precision': 0.77697843, 'binary_recall': 0.85850555, 'binary_specificity': 0.762997, 'binary_f1_score': 0.81570995}
confusion matrix:
     0    1
0  499  155
1   89  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.81635785, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8128861, 'auroc': 0.9030124, 'binary_precision': 0.7854251, 'binary_recall': 0.8622222, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.8220339}
confusion matrix:
     0    1
0  172   53
1   31  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:07:48.329826,epoch time: 0:01:34.812534,used: 0:01:34.812534,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.9632699, 'recall': 0.96230185, 'specificity': 0.96230185, 'f1': 0.96190274, 'auroc': 0.9963145, 'binary_precision': 0.9917977, 'binary_recall': 0.93251926, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9612455}
confusion matrix:
      0     1
0  1504    12
1   105  1451
---- Validation: 
scalar performance:
{'acc': 0.71628994, 'precision': 0.7817501, 'recall': 0.7115027, 'specificity': 0.7115027, 'f1': 0.6957973, 'auroc': 0.85919106, 'binary_precision': 0.9127726, 'binary_recall': 0.46581876, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.61684215}
confusion matrix:
     0    1
0  626   28
1  336  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.8151978, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.76554835, 'auroc': 0.8609185, 'binary_precision': 0.9300699, 'binary_recall': 0.5911111, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7228261}
confusion matrix:
     0    1
0  215   10
1   92  133
early stop counter: 1
val acc:0.7162899374961853, best validation acc: 0.8098207116127014, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 2,now: 2024-07-29 02:09:27.492073,epoch time: 0:01:39.162247,used: 0:03:13.974781,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97323906, 'recall': 0.9726366, 'specificity': 0.9726366, 'f1': 0.9723263, 'auroc': 0.9980813, 'binary_precision': 0.99729365, 'binary_recall': 0.94790995, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.97197497}
confusion matrix:
      0     1
0  1513     4
1    81  1474
---- Validation: 
scalar performance:
{'acc': 0.75759935, 'precision': 0.7950938, 'recall': 0.7540584, 'specificity': 0.7540584, 'f1': 0.7478726, 'auroc': 0.87055326, 'binary_precision': 0.8955224, 'binary_recall': 0.57233703, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.6983511}
confusion matrix:
     0    1
0  612   42
1  269  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8249351, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80649996, 'auroc': 0.8933531, 'binary_precision': 0.8971428, 'binary_recall': 0.69777775, 'binary_specificity': 0.92, 'binary_f1_score': 0.78499997}
confusion matrix:
     0    1
0  207   18
1   68  157
early stop counter: 2
val acc:0.7575993537902832, best validation acc: 0.8098207116127014, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 3,now: 2024-07-29 02:10:57.914608,epoch time: 0:01:30.422535,used: 0:04:44.397316,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97636735, 'recall': 0.97638977, 'specificity': 0.97638977, 'f1': 0.97623694, 'auroc': 0.9963652, 'binary_precision': 0.9881501, 'binary_recall': 0.96465296, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9762601}
confusion matrix:
      0     1
0  1498    18
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.6929073, 'precision': 0.7825041, 'recall': 0.687321, 'specificity': 0.687321, 'f1': 0.6625181, 'auroc': 0.8356694, 'binary_precision': 0.936803, 'binary_recall': 0.40063593, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.56124717}
confusion matrix:
     0    1
0  637   17
1  377  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.83206284, 'recall': 0.75555557, 'specificity': 0.75555557, 'f1': 0.740615, 'auroc': 0.8762074, 'binary_precision': 0.991453, 'binary_recall': 0.51555556, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.6783626}
confusion matrix:
     0    1
0  224    1
1  109  116
early stop counter: 3
val acc:0.6929072737693787, best validation acc: 0.8098207116127014, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 4,now: 2024-07-29 02:12:37.494331,epoch time: 0:01:39.579723,used: 0:06:23.977039,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9342448, 'precision': 0.9412449, 'recall': 0.9350482, 'specificity': 0.9350482, 'f1': 0.9340569, 'auroc': 0.9950744, 'binary_precision': 1.0, 'binary_recall': 0.87009645, 'binary_specificity': 1.0, 'binary_f1_score': 0.93053645}
confusion matrix:
      0     1
0  1517     0
1   202  1353
---- Validation: 
scalar performance:
{'acc': 0.59937644, 'precision': 0.75665474, 'recall': 0.59159726, 'specificity': 0.59159726, 'f1': 0.5180639, 'auroc': 0.8608271, 'binary_precision': 0.9527559, 'binary_recall': 0.19236884, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.3201058}
confusion matrix:
     0    1
0  648    6
1  508  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.7730583, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.49770486, 'auroc': 0.8724148, 'binary_precision': 1.0, 'binary_recall': 0.16888888, 'binary_specificity': 1.0, 'binary_f1_score': 0.28897336}
confusion matrix:
     0   1
0  225   0
1  187  38
early stop counter: 4
val acc:0.5993764400482178, best validation acc: 0.8098207116127014, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 5,now: 2024-07-29 02:14:13.224100,epoch time: 0:01:35.729769,used: 0:07:59.706808,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9358724, 'precision': 0.94232297, 'recall': 0.9367284, 'specificity': 0.9367284, 'f1': 0.93571293, 'auroc': 0.99614215, 'binary_precision': 0.9992658, 'binary_recall': 0.8741169, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.93251115}
confusion matrix:
      0     1
0  1514     1
1   196  1361
---- Validation: 
scalar performance:
{'acc': 0.6484801, 'precision': 0.76724434, 'recall': 0.64185905, 'specificity': 0.64185905, 'f1': 0.59866905, 'auroc': 0.89544773, 'binary_precision': 0.9405941, 'binary_recall': 0.30206677, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.4572804}
confusion matrix:
     0    1
0  642   12
1  439  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6377778, 'precision': 0.78994846, 'recall': 0.6377778, 'specificity': 0.6377778, 'f1': 0.58307517, 'auroc': 0.89829135, 'binary_precision': 1.0, 'binary_recall': 0.27555555, 'binary_specificity': 1.0, 'binary_f1_score': 0.4320557}
confusion matrix:
     0   1
0  225   0
1  163  62
early stop counter: 5
val acc:0.6484801173210144, best validation acc: 0.8098207116127014, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 6,now: 2024-07-29 02:15:50.038082,epoch time: 0:01:36.813982,used: 0:09:36.520790,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.96863776, 'recall': 0.9678335, 'specificity': 0.9678335, 'f1': 0.9674406, 'auroc': 0.99620914, 'binary_precision': 0.9959156, 'binary_recall': 0.93962747, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.96695304}
confusion matrix:
      0     1
0  1509     6
1    94  1463
---- Validation: 
scalar performance:
{'acc': 0.745908, 'precision': 0.8007378, 'recall': 0.74167895, 'specificity': 0.74167895, 'f1': 0.731521, 'auroc': 0.88502455, 'binary_precision': 0.92436975, 'binary_recall': 0.5246423, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.6693712}
confusion matrix:
     0    1
0  627   27
1  299  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.84412754, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80386794, 'auroc': 0.9026765, 'binary_precision': 0.95424837, 'binary_recall': 0.6488889, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7724868}
confusion matrix:
     0    1
0  218    7
1   79  146
early stop counter: 6
val acc:0.7459080219268799, best validation acc: 0.8098207116127014, corresponding to test acc:                         0.8133333325386047 / 0.8133333325386047
after epoch: 7,now: 2024-07-29 02:17:28.012752,epoch time: 0:01:37.974670,used: 0:11:14.495460,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9728637, 'recall': 0.9710187, 'specificity': 0.9710187, 'f1': 0.9713118, 'auroc': 0.9989881, 'binary_precision': 0.9492044, 'binary_recall': 0.99678665, 'binary_specificity': 0.94525063, 'binary_f1_score': 0.9724138}
confusion matrix:
      0     1
0  1433    83
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.82774746, 'precision': 0.8276781, 'recall': 0.8276973, 'specificity': 0.8276973, 'f1': 0.82768714, 'auroc': 0.8806999, 'binary_precision': 0.8238095, 'binary_recall': 0.82511926, 'binary_specificity': 0.83027524, 'binary_f1_score': 0.82446384}
confusion matrix:
     0    1
0  543  111
1  110  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.78924954, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7835455, 'auroc': 0.90198517, 'binary_precision': 0.7519685, 'binary_recall': 0.8488889, 'binary_specificity': 0.72, 'binary_f1_score': 0.79749477}
confusion matrix:
     0    1
0  162   63
1   34  191
better model found
persisted
after epoch: 8,now: 2024-07-29 02:18:59.513050,epoch time: 0:01:31.500298,used: 0:12:45.995758,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98528105, 'recall': 0.98489594, 'specificity': 0.98489594, 'f1': 0.98501784, 'auroc': 0.99896896, 'binary_precision': 0.97728705, 'binary_recall': 0.99358565, 'binary_specificity': 0.9762062, 'binary_f1_score': 0.98536897}
confusion matrix:
      0     1
0  1477    36
1    10  1549
---- Validation: 
scalar performance:
{'acc': 0.78409976, 'precision': 0.79120374, 'recall': 0.7825136, 'specificity': 0.7825136, 'f1': 0.7820641, 'auroc': 0.85218513, 'binary_precision': 0.8320755, 'binary_recall': 0.70111287, 'binary_specificity': 0.8639144, 'binary_f1_score': 0.7610009}
confusion matrix:
     0    1
0  565   89
1  188  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85612535, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8554978, 'auroc': 0.93015313, 'binary_precision': 0.8703704, 'binary_recall': 0.83555555, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8526077}
confusion matrix:
     0    1
0  197   28
1   37  188
new oracle model saved
early stop counter: 1
val acc:0.7840997576713562, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 9,now: 2024-07-29 02:20:31.748112,epoch time: 0:01:32.235062,used: 0:14:18.230820,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9760453, 'recall': 0.9754078, 'specificity': 0.9754078, 'f1': 0.975569, 'auroc': 0.9983802, 'binary_precision': 0.96428573, 'binary_recall': 0.9884393, 'binary_specificity': 0.96237624, 'binary_f1_score': 0.97621316}
confusion matrix:
      0     1
0  1458    57
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.8098207, 'precision': 0.8172482, 'recall': 0.80828995, 'specificity': 0.80828995, 'f1': 0.80811405, 'auroc': 0.8726852, 'binary_precision': 0.8611632, 'binary_recall': 0.7297297, 'binary_specificity': 0.8868502, 'binary_f1_score': 0.7900172}
confusion matrix:
     0    1
0  580   74
1  170  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8280543, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82142854, 'auroc': 0.90253824, 'binary_precision': 0.8717949, 'binary_recall': 0.75555557, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8095238}
confusion matrix:
     0    1
0  200   25
1   55  170
early stop counter: 2
val acc:0.8098207116127014, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 10,now: 2024-07-29 02:22:01.032553,epoch time: 0:01:29.284441,used: 0:15:47.515261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873445, 'recall': 0.987417, 'specificity': 0.987417, 'f1': 0.98730445, 'auroc': 0.99897873, 'binary_precision': 0.99607587, 'binary_recall': 0.9787918, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9873582}
confusion matrix:
      0     1
0  1510     6
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.609509, 'precision': 0.7051443, 'recall': 0.6026604, 'specificity': 0.6026604, 'f1': 0.5501657, 'auroc': 0.7648736, 'binary_precision': 0.84042555, 'binary_recall': 0.25119236, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.3867809}
confusion matrix:
     0    1
0  624   30
1  471  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73333335, 'precision': 0.780176, 'recall': 0.73333335, 'specificity': 0.73333335, 'f1': 0.72170115, 'auroc': 0.85799503, 'binary_precision': 0.8947368, 'binary_recall': 0.5288889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.66480446}
confusion matrix:
     0    1
0  211   14
1  106  119
early stop counter: 3
val acc:0.6095089912414551, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 11,now: 2024-07-29 02:23:38.742160,epoch time: 0:01:37.709607,used: 0:17:25.224868,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98595893, 'recall': 0.9855436, 'specificity': 0.9855436, 'f1': 0.98566926, 'auroc': 0.9995926, 'binary_precision': 0.97730136, 'binary_recall': 0.99486524, 'binary_specificity': 0.9762219, 'binary_f1_score': 0.98600507}
confusion matrix:
      0     1
0  1478    36
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.7926734, 'precision': 0.8091382, 'recall': 0.7903764, 'specificity': 0.7903764, 'f1': 0.7889239, 'auroc': 0.86419153, 'binary_precision': 0.8757764, 'binary_recall': 0.672496, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.7607914}
confusion matrix:
     0    1
0  594   60
1  206  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82877076, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8263889, 'auroc': 0.8910618, 'binary_precision': 0.80246913, 'binary_recall': 0.8666667, 'binary_specificity': 0.7866667, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  177   48
1   30  195
early stop counter: 4
val acc:0.7926734089851379, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 12,now: 2024-07-29 02:25:05.770682,epoch time: 0:01:27.028522,used: 0:18:52.253390,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880731, 'recall': 0.98809487, 'specificity': 0.98809487, 'f1': 0.9879557, 'auroc': 0.99918264, 'binary_precision': 0.9993421, 'binary_recall': 0.9768489, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9879675}
confusion matrix:
      0     1
0  1516     1
1    36  1519
---- Validation: 
scalar performance:
{'acc': 0.63522995, 'precision': 0.76697993, 'recall': 0.6282544, 'specificity': 0.6282544, 'f1': 0.5772902, 'auroc': 0.84822273, 'binary_precision': 0.9497207, 'binary_recall': 0.27027026, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.42079207}
confusion matrix:
     0    1
0  645    9
1  459  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8213985, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76179343, 'auroc': 0.90702224, 'binary_precision': 0.9485294, 'binary_recall': 0.5733333, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.71468145}
confusion matrix:
     0    1
0  218    7
1   96  129
early stop counter: 5
val acc:0.6352299451828003, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 13,now: 2024-07-29 02:26:46.510560,epoch time: 0:01:40.739878,used: 0:20:32.993268,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.982013, 'recall': 0.98165166, 'specificity': 0.98165166, 'f1': 0.98176193, 'auroc': 0.9991348, 'binary_precision': 0.9740998, 'binary_recall': 0.9903661, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.98216563}
confusion matrix:
      0     1
0  1474    41
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.7724084, 'precision': 0.7979187, 'recall': 0.769496, 'specificity': 0.769496, 'f1': 0.7660818, 'auroc': 0.86167306, 'binary_precision': 0.8803612, 'binary_recall': 0.6200318, 'binary_specificity': 0.9189603, 'binary_f1_score': 0.727612}
confusion matrix:
     0    1
0  601   53
1  239  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.7999164, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.79741657, 'auroc': 0.881363, 'binary_precision': 0.8252427, 'binary_recall': 0.75555557, 'binary_specificity': 0.84, 'binary_f1_score': 0.7888631}
confusion matrix:
     0    1
0  189   36
1   55  170
early stop counter: 6
val acc:0.7724084258079529, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 14,now: 2024-07-29 02:28:24.106454,epoch time: 0:01:37.595894,used: 0:22:10.589162,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98731756, 'recall': 0.9872872, 'specificity': 0.9872872, 'f1': 0.98730147, 'auroc': 0.9993217, 'binary_precision': 0.9865557, 'binary_recall': 0.98845416, 'binary_specificity': 0.9861203, 'binary_f1_score': 0.98750395}
confusion matrix:
      0     1
0  1492    21
1    18  1541
---- Validation: 
scalar performance:
{'acc': 0.7014809, 'precision': 0.7776872, 'recall': 0.69627774, 'specificity': 0.69627774, 'f1': 0.67596924, 'auroc': 0.8400086, 'binary_precision': 0.9183673, 'binary_recall': 0.42925277, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.58504874}
confusion matrix:
     0    1
0  630   24
1  359  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.81738657, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7813765, 'auroc': 0.900879, 'binary_precision': 0.91612905, 'binary_recall': 0.6311111, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.7473684}
confusion matrix:
     0    1
0  212   13
1   83  142
early stop counter: 7
val acc:0.7014809250831604, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 15,now: 2024-07-29 02:30:02.707974,epoch time: 0:01:38.601520,used: 0:23:49.190682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98839694, 'recall': 0.9882114, 'specificity': 0.9882114, 'f1': 0.9882773, 'auroc': 0.9996244, 'binary_precision': 0.98346055, 'binary_recall': 0.99357325, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.988491}
confusion matrix:
      0     1
0  1490    26
1    10  1546
---- Validation: 
scalar performance:
{'acc': 0.7996882, 'precision': 0.81636655, 'recall': 0.7974091, 'specificity': 0.7974091, 'f1': 0.7961086, 'auroc': 0.8684578, 'binary_precision': 0.88429755, 'binary_recall': 0.68044513, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.76909256}
confusion matrix:
     0    1
0  598   56
1  201  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.81548226, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7816815, 'auroc': 0.8946173, 'binary_precision': 0.91082805, 'binary_recall': 0.63555557, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.74869114}
confusion matrix:
     0    1
0  211   14
1   82  143
early stop counter: 8
val acc:0.7996882200241089, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 16,now: 2024-07-29 02:31:37.284500,epoch time: 0:01:34.576526,used: 0:25:23.767208,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911875, 'recall': 0.9912493, 'specificity': 0.9912493, 'f1': 0.99121, 'auroc': 0.9995858, 'binary_precision': 0.99418604, 'binary_recall': 0.9884393, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9913044}
confusion matrix:
      0     1
0  1506     9
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.791894, 'precision': 0.81317496, 'recall': 0.7893081, 'specificity': 0.7893081, 'f1': 0.78722775, 'auroc': 0.8723813, 'binary_precision': 0.89008623, 'binary_recall': 0.6565978, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.75571823}
confusion matrix:
     0    1
0  603   51
1  216  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8388486, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.8301414, 'auroc': 0.9138172, 'binary_precision': 0.8900524, 'binary_recall': 0.75555557, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8173077}
confusion matrix:
     0    1
0  204   21
1   55  170
early stop counter: 9
val acc:0.7918940186500549, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 17,now: 2024-07-29 02:33:15.139350,epoch time: 0:01:37.854850,used: 0:27:01.622058,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9714108, 'recall': 0.970418, 'specificity': 0.970418, 'f1': 0.9700428, 'auroc': 0.9987905, 'binary_precision': 1.0, 'binary_recall': 0.940836, 'binary_specificity': 1.0, 'binary_f1_score': 0.9695163}
confusion matrix:
      0     1
0  1517     0
1    92  1463
---- Validation: 
scalar performance:
{'acc': 0.6929073, 'precision': 0.77955794, 'recall': 0.6873818, 'specificity': 0.6873818, 'f1': 0.66320705, 'auroc': 0.8990382, 'binary_precision': 0.93040293, 'binary_recall': 0.40381557, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.5631929}
confusion matrix:
     0    1
0  635   19
1  375  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.8063862, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.69578254, 'auroc': 0.93801475, 'binary_precision': 0.97115386, 'binary_recall': 0.4488889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6139818}
confusion matrix:
     0    1
0  222    3
1  124  101
early stop counter: 10
val acc:0.6929072737693787, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 18,now: 2024-07-29 02:34:52.050613,epoch time: 0:01:36.911263,used: 0:28:38.533321,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9900207, 'recall': 0.9898368, 'specificity': 0.9898368, 'f1': 0.9899051, 'auroc': 0.99955744, 'binary_precision': 0.98537827, 'binary_recall': 0.99486524, 'binary_specificity': 0.98480844, 'binary_f1_score': 0.9900991}
confusion matrix:
      0     1
0  1491    23
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.8144973, 'precision': 0.835616, 'recall': 0.81202626, 'specificity': 0.81202626, 'f1': 0.810645, 'auroc': 0.8944669, 'binary_precision': 0.9150743, 'binary_recall': 0.68521464, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.78363645}
confusion matrix:
     0    1
0  614   40
1  198  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8623264, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8400028, 'auroc': 0.9346568, 'binary_precision': 0.9476744, 'binary_recall': 0.72444445, 'binary_specificity': 0.96, 'binary_f1_score': 0.82115865}
confusion matrix:
     0    1
0  216    9
1   62  163
early stop counter: 11
val acc:0.8144972920417786, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 19,now: 2024-07-29 02:36:26.812864,epoch time: 0:01:34.762251,used: 0:30:13.295572,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9833784, 'recall': 0.98341835, 'specificity': 0.98341835, 'f1': 0.98339576, 'auroc': 0.9988155, 'binary_precision': 0.98519, 'binary_recall': 0.98202825, 'binary_specificity': 0.98480844, 'binary_f1_score': 0.9836066}
confusion matrix:
      0     1
0  1491    23
1    28  1530
---- Validation: 
scalar performance:
{'acc': 0.76227593, 'precision': 0.7975037, 'recall': 0.7588583, 'specificity': 0.7588583, 'f1': 0.7533552, 'auroc': 0.83287084, 'binary_precision': 0.89512193, 'binary_recall': 0.5834658, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.7064485}
confusion matrix:
     0    1
0  611   43
1  262  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8111173, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8111102, 'auroc': 0.8878617, 'binary_precision': 0.8097345, 'binary_recall': 0.81333333, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.81152993}
confusion matrix:
     0    1
0  182   43
1   42  183
early stop counter: 12
val acc:0.7622759342193604, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 20,now: 2024-07-29 02:38:06.499811,epoch time: 0:01:39.686947,used: 0:31:52.982519,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892385, 'recall': 0.9892789, 'specificity': 0.9892789, 'f1': 0.98925614, 'auroc': 0.99921024, 'binary_precision': 0.9909852, 'binary_recall': 0.9878049, 'binary_specificity': 0.990753, 'binary_f1_score': 0.9893925}
confusion matrix:
      0     1
0  1500    14
1    19  1539
---- Validation: 
scalar performance:
{'acc': 0.78176147, 'precision': 0.8058388, 'recall': 0.7789742, 'specificity': 0.7789742, 'f1': 0.77615774, 'auroc': 0.8656136, 'binary_precision': 0.88691795, 'binary_recall': 0.63593006, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.7407407}
confusion matrix:
     0    1
0  603   51
1  229  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8461951, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8442476, 'auroc': 0.91020244, 'binary_precision': 0.87081337, 'binary_recall': 0.8088889, 'binary_specificity': 0.88, 'binary_f1_score': 0.8387097}
confusion matrix:
     0    1
0  198   27
1   43  182
early stop counter: 13
val acc:0.7817614674568176, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 21,now: 2024-07-29 02:39:37.949332,epoch time: 0:01:31.449521,used: 0:33:24.432040,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.99250025, 'recall': 0.9925723, 'specificity': 0.9925723, 'f1': 0.9925126, 'auroc': 0.9996685, 'binary_precision': 0.9974026, 'binary_recall': 0.98778135, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9925686}
confusion matrix:
      0     1
0  1513     4
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.6391271, 'precision': 0.7666461, 'recall': 0.63225937, 'specificity': 0.63225937, 'f1': 0.5837407, 'auroc': 0.88035953, 'binary_precision': 0.94623655, 'binary_recall': 0.2798092, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.43190184}
confusion matrix:
     0    1
0  644   10
1  453  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67333335, 'precision': 0.80241936, 'recall': 0.67333335, 'specificity': 0.67333335, 'f1': 0.6343101, 'auroc': 0.91223705, 'binary_precision': 1.0, 'binary_recall': 0.34666666, 'binary_specificity': 1.0, 'binary_f1_score': 0.51485145}
confusion matrix:
     0   1
0  225   0
1  147  78
early stop counter: 14
val acc:0.6391270756721497, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 22,now: 2024-07-29 02:41:14.799464,epoch time: 0:01:36.850132,used: 0:35:01.282172,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893487, 'recall': 0.989195, 'specificity': 0.989195, 'f1': 0.9892541, 'auroc': 0.99933827, 'binary_precision': 0.98535967, 'binary_recall': 0.99358153, 'binary_specificity': 0.98480844, 'binary_f1_score': 0.98945355}
confusion matrix:
      0     1
0  1491    23
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.8191738, 'precision': 0.83346415, 'recall': 0.81712997, 'specificity': 0.81712997, 'f1': 0.81649554, 'auroc': 0.8986183, 'binary_precision': 0.8977956, 'binary_recall': 0.71224165, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.79432625}
confusion matrix:
     0    1
0  603   51
1  181  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8108307, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7982425, 'auroc': 0.8946765, 'binary_precision': 0.86885244, 'binary_recall': 0.70666665, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.7794118}
confusion matrix:
     0    1
0  201   24
1   66  159
early stop counter: 15
val acc:0.8191738128662109, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 23,now: 2024-07-29 02:42:52.994461,epoch time: 0:01:38.194997,used: 0:36:39.477169,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909057, 'recall': 0.99098563, 'specificity': 0.99098563, 'f1': 0.99088514, 'auroc': 0.9995451, 'binary_precision': 0.99869454, 'binary_recall': 0.9832905, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.99093264}
confusion matrix:
      0     1
0  1514     2
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.7123928, 'precision': 0.79178303, 'recall': 0.70722425, 'specificity': 0.70722425, 'f1': 0.6881091, 'auroc': 0.89277494, 'binary_precision': 0.9391892, 'binary_recall': 0.4419714, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.6010811}
confusion matrix:
     0    1
0  636   18
1  351  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.80834913, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6741879, 'auroc': 0.90512586, 'binary_precision': 0.9892473, 'binary_recall': 0.40888888, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.5786164}
confusion matrix:
     0   1
0  224   1
1  133  92
early stop counter: 16
val acc:0.7123928070068359, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 24,now: 2024-07-29 02:44:26.004141,epoch time: 0:01:33.009680,used: 0:38:12.486849,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931381, 'recall': 0.99321395, 'specificity': 0.99321395, 'f1': 0.9931632, 'auroc': 0.9995922, 'binary_precision': 0.99676794, 'binary_recall': 0.9897304, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.9932367}
confusion matrix:
      0     1
0  1509     5
1    16  1542
---- Validation: 
scalar performance:
{'acc': 0.82774746, 'precision': 0.8467618, 'recall': 0.82544863, 'specificity': 0.82544863, 'f1': 0.8245951, 'auroc': 0.90768564, 'binary_precision': 0.9232365, 'binary_recall': 0.7074722, 'binary_specificity': 0.94342506, 'binary_f1_score': 0.8010801}
confusion matrix:
     0    1
0  617   37
1  184  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8216616, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.81467605, 'auroc': 0.8981136, 'binary_precision': 0.8659794, 'binary_recall': 0.74666667, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.80190927}
confusion matrix:
     0    1
0  199   26
1   57  168
early stop counter: 17
val acc:0.8277474641799927, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 25,now: 2024-07-29 02:45:58.702406,epoch time: 0:01:32.698265,used: 0:39:45.185114,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.994766, 'recall': 0.9948466, 'specificity': 0.9948466, 'f1': 0.99479115, 'auroc': 0.99994195, 'binary_precision': 0.99870634, 'binary_recall': 0.9910141, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9948454}
confusion matrix:
      0     1
0  1512     2
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.66017145, 'precision': 0.77347594, 'recall': 0.6537827, 'specificity': 0.6537827, 'f1': 0.6155726, 'auroc': 0.87310815, 'binary_precision': 0.9447005, 'binary_recall': 0.32591414, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.48463356}
confusion matrix:
     0    1
0  642   12
1  424  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.7584586, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.6758317, 'auroc': 0.8693333, 'binary_precision': 0.88596493, 'binary_recall': 0.4488889, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.5958702}
confusion matrix:
     0    1
0  212   13
1  124  101
early stop counter: 18
val acc:0.6601714491844177, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 26,now: 2024-07-29 02:47:36.160663,epoch time: 0:01:37.458257,used: 0:41:22.643371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883946, 'recall': 0.9884393, 'specificity': 0.9884393, 'f1': 0.9882812, 'auroc': 0.99963534, 'binary_precision': 1.0, 'binary_recall': 0.9768786, 'binary_specificity': 1.0, 'binary_f1_score': 0.9883041}
confusion matrix:
      0     1
0  1515     0
1    36  1521
---- Validation: 
scalar performance:
{'acc': 0.7420109, 'precision': 0.8058639, 'recall': 0.73749167, 'specificity': 0.73749167, 'f1': 0.7253499, 'auroc': 0.91587174, 'binary_precision': 0.9408284, 'binary_recall': 0.5055644, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.65770423}
confusion matrix:
     0    1
0  634   20
1  311  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.82539684, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.7638889, 'auroc': 0.9027951, 'binary_precision': 0.95555556, 'binary_recall': 0.5733333, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.71666664}
confusion matrix:
     0    1
0  219    6
1   96  129
early stop counter: 19
val acc:0.7420108914375305, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 27,now: 2024-07-29 02:49:13.838473,epoch time: 0:01:37.677810,used: 0:43:00.321181,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928258, 'recall': 0.99293447, 'specificity': 0.99293447, 'f1': 0.992838, 'auroc': 0.99971175, 'binary_precision': 0.99935025, 'binary_recall': 0.9865298, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.99289864}
confusion matrix:
      0     1
0  1512     1
1    21  1538
---- Validation: 
scalar performance:
{'acc': 0.71317226, 'precision': 0.7821778, 'recall': 0.7082622, 'specificity': 0.7082622, 'f1': 0.69137037, 'auroc': 0.88170576, 'binary_precision': 0.9169329, 'binary_recall': 0.4562798, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.6093418}
confusion matrix:
     0    1
0  628   26
1  342  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74444443, 'precision': 0.8002475, 'recall': 0.74444443, 'specificity': 0.74444443, 'f1': 0.73199165, 'auroc': 0.8939457, 'binary_precision': 0.9296875, 'binary_recall': 0.5288889, 'binary_specificity': 0.96, 'binary_f1_score': 0.6742209}
confusion matrix:
     0    1
0  216    9
1  106  119
early stop counter: 20
val acc:0.7131722569465637, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 28,now: 2024-07-29 02:50:51.366062,epoch time: 0:01:37.527589,used: 0:44:37.848770,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921684, 'recall': 0.9922185, 'specificity': 0.9922185, 'f1': 0.9921868, 'auroc': 0.99962485, 'binary_precision': 0.9948287, 'binary_recall': 0.9897106, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.99226314}
confusion matrix:
      0     1
0  1509     8
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.7412315, 'precision': 0.804302, 'recall': 0.7367271, 'specificity': 0.7367271, 'f1': 0.7246325, 'auroc': 0.88819206, 'binary_precision': 0.9380531, 'binary_recall': 0.5055644, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.6570248}
confusion matrix:
     0    1
0  633   21
1  311  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.83953726, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.78605497, 'auroc': 0.92815804, 'binary_precision': 0.96478873, 'binary_recall': 0.60888886, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.746594}
confusion matrix:
     0    1
0  220    5
1   88  137
early stop counter: 21
val acc:0.7412315011024475, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 29,now: 2024-07-29 02:52:28.773468,epoch time: 0:01:37.407406,used: 0:46:15.256176,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.995417, 'recall': 0.9954884, 'specificity': 0.9954884, 'f1': 0.99544215, 'auroc': 0.999663, 'binary_precision': 0.998708, 'binary_recall': 0.9922978, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9954926}
confusion matrix:
      0     1
0  1512     2
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.7856586, 'precision': 0.82601905, 'recall': 0.78218913, 'specificity': 0.78218913, 'f1': 0.7773392, 'auroc': 0.8855636, 'binary_precision': 0.9359606, 'binary_recall': 0.60413355, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.7342995}
confusion matrix:
     0    1
0  628   26
1  249  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8544897, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83333004, 'auroc': 0.91984195, 'binary_precision': 0.9364162, 'binary_recall': 0.72, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.81407034}
confusion matrix:
     0    1
0  214   11
1   63  162
early stop counter: 22
val acc:0.785658597946167, best validation acc: 0.8277474641799927, corresponding to test acc:                         0.7844444513320923 / 0.855555534362793
after epoch: 30,now: 2024-07-29 02:54:06.693689,epoch time: 0:01:37.920221,used: 0:47:53.176397,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_06_13_seed_3_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:53.176397 at 2024-07-29 02:54:06.693689
persisted model performance metric: 

scalar performance:
{'acc': 0.78444445, 'precision': 0.78924954, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7835455, 'auroc': 0.90198517, 'binary_precision': 0.7519685, 'binary_recall': 0.8488889, 'binary_specificity': 0.72, 'binary_f1_score': 0.79749477}
confusion matrix:
     0    1
0  162   63
1   34  191
oracle model performance metric: 

scalar performance:
{'acc': 0.85555553, 'precision': 0.85612535, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8554978, 'auroc': 0.93015313, 'binary_precision': 0.8703704, 'binary_recall': 0.83555555, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.8526077}
confusion matrix:
     0    1
0  197   28
1   37  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454150 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454150 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14488 MiB |  55244 MiB |  40764 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  55126 MiB |  40716 MiB |
|       from small pool |     70 MiB |     70 MiB |    118 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 461305 KiB |   1260 MiB | 212167 GiB | 212166 GiB |
|       from large pool | 450704 KiB |   1252 MiB | 208649 GiB | 208649 GiB |
|       from small pool |  10601 KiB |     45 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51931 K  |   51930 K  |
|       from large pool |     187    |    1413    |   26403 K  |   26402 K  |
|       from small pool |    1123    |    1419    |   25528 K  |   25527 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51931 K  |   51930 K  |
|       from large pool |     187    |    1413    |   26403 K  |   26402 K  |
|       from small pool |    1123    |    1419    |   25528 K  |   25527 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     637    |     637    |    2353    |    1716    |
|       from large pool |     602    |     602    |    2294    |    1692    |
|       from small pool |      35    |      35    |      59    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     652    |   34650 K  |   34650 K  |
|       from large pool |      38    |     604    |   19645 K  |   19645 K  |
|       from small pool |      60    |     236    |   15004 K  |   15004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14488 MiB |  55244 MiB |  54350 MiB |
|       from large pool |    844 MiB |  14422 MiB |  55126 MiB |  54282 MiB |
|       from small pool |     50 MiB |     70 MiB |    118 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 212167 GiB | 212167 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 208650 GiB | 208650 GiB |
|       from small pool |      0 KiB |     45 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    2353    |    2290    |
|       from large pool |      38    |     602    |    2294    |    2256    |
|       from small pool |      25    |      35    |      59    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   34650 K  |   34650 K  |
|       from large pool |       3    |     604    |   19645 K  |   19645 K  |
|       from small pool |       0    |     236    |   15005 K  |   15005 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295813 GiB | 295813 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292317 GiB | 292317 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    894 MiB |  14488 MiB |  55244 MiB |  54350 MiB |
|       from large pool |    844 MiB |  14422 MiB |  55126 MiB |  54282 MiB |
|       from small pool |     50 MiB |     70 MiB |    118 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 212167 GiB | 212167 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 208650 GiB | 208650 GiB |
|       from small pool |      0 KiB |     45 MiB |   3517 GiB |   3517 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    2353    |    2290    |
|       from large pool |      38    |     602    |    2294    |    2256    |
|       from small pool |      25    |      35    |      59    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   34650 K  |   34650 K  |
|       from large pool |       3    |     604    |   19645 K  |   19645 K  |
|       from small pool |       0    |     236    |   15005 K  |   15005 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367

 Experiment start at: 2024-07-29 02:54:50.968349
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9015544, 'precision': 0.9162274, 'recall': 0.90335715, 'specificity': 0.90335715, 'f1': 0.9009359, 'auroc': 0.9778464, 'binary_precision': 0.9992132, 'binary_recall': 0.8073744, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.89310825}
confusion matrix:
      0     1
0  1514     1
1   303  1270
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.76373404, 'recall': 0.7049428, 'specificity': 0.7049428, 'f1': 0.6897542, 'auroc': 0.82911885, 'binary_precision': 0.8816568, 'binary_recall': 0.471519, 'binary_specificity': 0.9383667, 'binary_f1_score': 0.61443293}
confusion matrix:
     0    1
0  609   40
1  334  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7867299, 'precision': 0.8269433, 'recall': 0.7867298, 'specificity': 0.7867298, 'f1': 0.77996385, 'auroc': 0.89921606, 'binary_precision': 0.94160587, 'binary_recall': 0.6113744, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.7413793}
confusion matrix:
     0    1
0  203    8
1   82  129
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 02:56:32.043817,epoch time: 0:01:41.075468,used: 0:01:41.075468,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9449482, 'precision': 0.94741225, 'recall': 0.94568205, 'specificity': 0.94568205, 'f1': 0.94491816, 'auroc': 0.98887897, 'binary_precision': 0.98545706, 'binary_recall': 0.9052163, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.9436339}
confusion matrix:
      0     1
0  1495    21
1   149  1423
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8040749, 'recall': 0.8029125, 'specificity': 0.8029125, 'f1': 0.80299044, 'auroc': 0.87519014, 'binary_precision': 0.81666666, 'binary_recall': 0.7753165, 'binary_specificity': 0.8305085, 'binary_f1_score': 0.7954546}
confusion matrix:
     0    1
0  539  110
1  142  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84123224, 'precision': 0.8414239, 'recall': 0.84123224, 'specificity': 0.84123224, 'f1': 0.84120995, 'auroc': 0.9212955, 'binary_precision': 0.8333333, 'binary_recall': 0.8530806, 'binary_specificity': 0.8293839, 'binary_f1_score': 0.84309137}
confusion matrix:
     0    1
0  175   36
1   31  180
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 02:58:08.662506,epoch time: 0:01:36.618689,used: 0:03:17.694157,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9384715, 'precision': 0.94398236, 'recall': 0.9394577, 'specificity': 0.9394577, 'f1': 0.9383589, 'auroc': 0.9938437, 'binary_precision': 0.9978355, 'binary_recall': 0.88089174, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.93572396}
confusion matrix:
      0     1
0  1515     3
1   187  1383
---- Validation: 
scalar performance:
{'acc': 0.7025761, 'precision': 0.7743852, 'recall': 0.6991355, 'specificity': 0.6991355, 'f1': 0.67946076, 'auroc': 0.8705384, 'binary_precision': 0.9114754, 'binary_recall': 0.43987343, 'binary_specificity': 0.9583975, 'binary_f1_score': 0.59338313}
confusion matrix:
     0    1
0  622   27
1  354  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7985782, 'precision': 0.8472571, 'recall': 0.79857814, 'specificity': 0.79857814, 'f1': 0.791263, 'auroc': 0.92107093, 'binary_precision': 0.97727275, 'binary_recall': 0.6113744, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.7521866}
confusion matrix:
     0    1
0  208    3
1   82  129
early stop counter: 1
val acc:0.7025761008262634, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8412322402000427 / 0.8412322402000427
after epoch: 3,now: 2024-07-29 02:59:45.486634,epoch time: 0:01:36.824128,used: 0:04:54.518285,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97830313, 'precision': 0.9782665, 'recall': 0.9784076, 'specificity': 0.9784076, 'f1': 0.9783, 'auroc': 0.9974127, 'binary_precision': 0.98454607, 'binary_recall': 0.9726463, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.97856}
confusion matrix:
      0     1
0  1492    24
1    43  1529
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.7923316, 'recall': 0.79227173, 'specificity': 0.79227173, 'f1': 0.7922939, 'auroc': 0.8691366, 'binary_precision': 0.79140127, 'binary_recall': 0.7863924, 'binary_specificity': 0.798151, 'binary_f1_score': 0.78888893}
confusion matrix:
     0    1
0  518  131
1  135  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.83437824, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.823359, 'auroc': 0.9073471, 'binary_precision': 0.77732795, 'binary_recall': 0.9099526, 'binary_specificity': 0.7393365, 'binary_f1_score': 0.83842796}
confusion matrix:
     0    1
0  156   55
1   19  192
early stop counter: 2
val acc:0.7923497557640076, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8412322402000427 / 0.8412322402000427
after epoch: 4,now: 2024-07-29 03:01:22.696046,epoch time: 0:01:37.209412,used: 0:06:31.727697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98056996, 'precision': 0.980522, 'recall': 0.98063815, 'specificity': 0.98063815, 'f1': 0.98056525, 'auroc': 0.9977242, 'binary_precision': 0.98463506, 'binary_recall': 0.9771283, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.9808673}
confusion matrix:
      0     1
0  1490    24
1    36  1538
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.830106, 'recall': 0.8078531, 'specificity': 0.8078531, 'f1': 0.80590135, 'auroc': 0.897264, 'binary_precision': 0.9092827, 'binary_recall': 0.681962, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.77938515}
confusion matrix:
     0    1
0  606   43
1  201  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7867299, 'precision': 0.8269433, 'recall': 0.7867298, 'specificity': 0.7867298, 'f1': 0.77996385, 'auroc': 0.9026527, 'binary_precision': 0.94160587, 'binary_recall': 0.6113744, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.7413793}
confusion matrix:
     0    1
0  203    8
1   82  129
better model found
persisted
after epoch: 5,now: 2024-07-29 03:02:59.930372,epoch time: 0:01:37.234326,used: 0:08:08.962023,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9821891, 'precision': 0.9821514, 'recall': 0.9822265, 'specificity': 0.9822265, 'f1': 0.9821839, 'auroc': 0.99834245, 'binary_precision': 0.9846841, 'binary_recall': 0.98030496, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.98248965}
confusion matrix:
      0     1
0  1490    24
1    31  1543
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8120643, 'recall': 0.8038109, 'specificity': 0.8038109, 'f1': 0.80330944, 'auroc': 0.88725114, 'binary_precision': 0.85634327, 'binary_recall': 0.72626585, 'binary_specificity': 0.88135594, 'binary_f1_score': 0.7859589}
confusion matrix:
     0    1
0  572   77
1  173  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8151659, 'precision': 0.8161886, 'recall': 0.8151659, 'specificity': 0.8151659, 'f1': 0.8150163, 'auroc': 0.8912424, 'binary_precision': 0.8341709, 'binary_recall': 0.7867299, 'binary_specificity': 0.8436019, 'binary_f1_score': 0.80975616}
confusion matrix:
     0    1
0  178   33
1   45  166
early stop counter: 1
val acc:0.8048399686813354, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.7867298722267151 / 0.8412322402000427
after epoch: 6,now: 2024-07-29 03:04:42.635288,epoch time: 0:01:42.704916,used: 0:09:51.666939,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9705311, 'precision': 0.97168636, 'recall': 0.971056, 'specificity': 0.971056, 'f1': 0.9705273, 'auroc': 0.9986237, 'binary_precision': 1.0, 'binary_recall': 0.94211197, 'binary_specificity': 1.0, 'binary_f1_score': 0.97019327}
confusion matrix:
      0     1
0  1516     0
1    91  1481
---- Validation: 
scalar performance:
{'acc': 0.6159251, 'precision': 0.7537634, 'recall': 0.61096674, 'specificity': 0.61096674, 'f1': 0.55041087, 'auroc': 0.86245143, 'binary_precision': 0.9375, 'binary_recall': 0.23734178, 'binary_specificity': 0.98459166, 'binary_f1_score': 0.37878788}
confusion matrix:
     0    1
0  639   10
1  482  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5900474, 'precision': 0.7511905, 'recall': 0.59004736, 'specificity': 0.59004736, 'f1': 0.5117407, 'auroc': 0.9104917, 'binary_precision': 0.95238096, 'binary_recall': 0.18957347, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.31620556}
confusion matrix:
     0   1
0  209   2
1  171  40
early stop counter: 2
val acc:0.6159250736236572, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.7867298722267151 / 0.8412322402000427
after epoch: 7,now: 2024-07-29 03:06:15.053517,epoch time: 0:01:32.418229,used: 0:11:24.085168,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9757124, 'precision': 0.97640026, 'recall': 0.9761753, 'specificity': 0.9761753, 'f1': 0.9757119, 'auroc': 0.99876124, 'binary_precision': 1.0, 'binary_recall': 0.9523507, 'binary_specificity': 1.0, 'binary_f1_score': 0.9755939}
confusion matrix:
      0     1
0  1514     0
1    75  1499
---- Validation: 
scalar performance:
{'acc': 0.6401249, 'precision': 0.7692308, 'recall': 0.63547134, 'specificity': 0.63547134, 'f1': 0.58684963, 'auroc': 0.90596294, 'binary_precision': 0.95238096, 'binary_recall': 0.28481013, 'binary_specificity': 0.9861325, 'binary_f1_score': 0.43848965}
confusion matrix:
     0    1
0  640    9
1  452  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5450237, 'precision': 0.73803586, 'recall': 0.5450237, 'specificity': 0.5450237, 'f1': 0.42934418, 'auroc': 0.8719481, 'binary_precision': 0.95238096, 'binary_recall': 0.09478673, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.17241381}
confusion matrix:
     0   1
0  210   1
1  191  20
early stop counter: 3
val acc:0.6401249170303345, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.7867298722267151 / 0.8412322402000427
after epoch: 8,now: 2024-07-29 03:07:49.596021,epoch time: 0:01:34.542504,used: 0:12:58.627672,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9747409, 'precision': 0.9749782, 'recall': 0.974586, 'specificity': 0.974586, 'f1': 0.9747231, 'auroc': 0.9977021, 'binary_precision': 0.96806514, 'binary_recall': 0.98283535, 'binary_specificity': 0.9663366, 'binary_f1_score': 0.97539425}
confusion matrix:
      0     1
0  1464    51
1    27  1546
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.80430883, 'recall': 0.80108154, 'specificity': 0.80108154, 'f1': 0.8010354, 'auroc': 0.88260174, 'binary_precision': 0.8292683, 'binary_recall': 0.7531645, 'binary_specificity': 0.8489985, 'binary_f1_score': 0.7893864}
confusion matrix:
     0    1
0  551   98
1  156  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76303315, 'precision': 0.8125717, 'recall': 0.76303315, 'specificity': 0.76303315, 'f1': 0.75325674, 'auroc': 0.90195644, 'binary_precision': 0.93700784, 'binary_recall': 0.56398106, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.704142}
confusion matrix:
     0    1
0  203    8
1   92  119
early stop counter: 4
val acc:0.8017174005508423, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.7867298722267151 / 0.8412322402000427
after epoch: 9,now: 2024-07-29 03:09:25.252880,epoch time: 0:01:35.656859,used: 0:14:34.284531,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.98327386, 'recall': 0.98306954, 'specificity': 0.98306954, 'f1': 0.98315144, 'auroc': 0.9986501, 'binary_precision': 0.979206, 'binary_recall': 0.9879212, 'binary_specificity': 0.97821784, 'binary_f1_score': 0.9835443}
confusion matrix:
      0     1
0  1482    33
1    19  1554
---- Validation: 
scalar performance:
{'acc': 0.785324, 'precision': 0.7887206, 'recall': 0.7860218, 'specificity': 0.7860218, 'f1': 0.7849418, 'auroc': 0.87231815, 'binary_precision': 0.7539118, 'binary_recall': 0.8386076, 'binary_specificity': 0.73343605, 'binary_f1_score': 0.79400754}
confusion matrix:
     0    1
0  476  173
1  102  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81279624, 'precision': 0.8165575, 'recall': 0.81279624, 'specificity': 0.81279624, 'f1': 0.81223845, 'auroc': 0.90200126, 'binary_precision': 0.78205127, 'binary_recall': 0.8672986, 'binary_specificity': 0.75829387, 'binary_f1_score': 0.82247186}
confusion matrix:
     0    1
0  160   51
1   28  183
early stop counter: 5
val acc:0.785323977470398, best validation acc: 0.8095238208770752, corresponding to test acc:                         0.7867298722267151 / 0.8412322402000427
after epoch: 10,now: 2024-07-29 03:11:01.413976,epoch time: 0:01:36.161096,used: 0:16:10.445627,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.98770237, 'recall': 0.9876778, 'specificity': 0.9876778, 'f1': 0.9876897, 'auroc': 0.9993177, 'binary_precision': 0.9873016, 'binary_recall': 0.9885569, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.98792887}
confusion matrix:
      0     1
0  1495    20
1    18  1555
---- Validation: 
scalar performance:
{'acc': 0.8196721, 'precision': 0.8314868, 'recall': 0.8184073, 'specificity': 0.8184073, 'f1': 0.8176164, 'auroc': 0.9053558, 'binary_precision': 0.8908382, 'binary_recall': 0.72310126, 'binary_specificity': 0.9137134, 'binary_f1_score': 0.79825324}
confusion matrix:
     0    1
0  593   56
1  175  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.8408443, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.8225359, 'auroc': 0.92273307, 'binary_precision': 0.91515154, 'binary_recall': 0.7156398, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8031915}
confusion matrix:
     0    1
0  197   14
1   60  151
better model found
persisted
after epoch: 11,now: 2024-07-29 03:12:37.877731,epoch time: 0:01:36.463755,used: 0:17:46.909382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.992228, 'precision': 0.9922515, 'recall': 0.9922019, 'specificity': 0.9922019, 'f1': 0.99222505, 'auroc': 0.99965173, 'binary_precision': 0.99111676, 'binary_recall': 0.9936387, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9923761}
confusion matrix:
      0     1
0  1502    14
1    10  1562
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.8251815, 'recall': 0.82502294, 'specificity': 0.82502294, 'f1': 0.82507, 'auroc': 0.8949138, 'binary_precision': 0.8269231, 'binary_recall': 0.8164557, 'binary_specificity': 0.83359015, 'binary_f1_score': 0.8216561}
confusion matrix:
     0    1
0  541  108
1  116  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8341232, 'precision': 0.8356007, 'recall': 0.83412325, 'specificity': 0.83412325, 'f1': 0.8339405, 'auroc': 0.9058198, 'binary_precision': 0.857868, 'binary_recall': 0.80094784, 'binary_specificity': 0.8672986, 'binary_f1_score': 0.82843137}
confusion matrix:
     0    1
0  183   28
1   42  169
better model found
persisted
after epoch: 12,now: 2024-07-29 03:14:15.421908,epoch time: 0:01:37.544177,used: 0:19:24.453559,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96049225, 'precision': 0.9635991, 'recall': 0.9597846, 'specificity': 0.9597846, 'f1': 0.9603692, 'auroc': 0.99905753, 'binary_precision': 0.93005335, 'binary_recall': 0.9974571, 'binary_specificity': 0.9221122, 'binary_f1_score': 0.9625766}
confusion matrix:
      0     1
0  1397   118
1     4  1569
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8438423, 'recall': 0.8438859, 'specificity': 0.8438859, 'f1': 0.84385586, 'auroc': 0.91078043, 'binary_precision': 0.8396226, 'binary_recall': 0.8449367, 'binary_specificity': 0.8428351, 'binary_f1_score': 0.8422713}
confusion matrix:
     0    1
0  547  102
1   98  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.8249073, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.8246091, 'auroc': 0.9082006, 'binary_precision': 0.8341463, 'binary_recall': 0.81042653, 'binary_specificity': 0.83886254, 'binary_f1_score': 0.82211536}
confusion matrix:
     0    1
0  177   34
1   40  171
better model found
persisted
after epoch: 13,now: 2024-07-29 03:15:55.566014,epoch time: 0:01:40.144106,used: 0:21:04.597665,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9779793, 'precision': 0.9782796, 'recall': 0.9778075, 'specificity': 0.9778075, 'f1': 0.977963, 'auroc': 0.9970082, 'binary_precision': 0.97, 'binary_recall': 0.9872773, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9785625}
confusion matrix:
      0     1
0  1468    48
1    20  1552
---- Validation: 
scalar performance:
{'acc': 0.7978142, 'precision': 0.8009306, 'recall': 0.7984728, 'specificity': 0.7984728, 'f1': 0.7975057, 'auroc': 0.88509035, 'binary_precision': 0.7668097, 'binary_recall': 0.84810126, 'binary_specificity': 0.7488444, 'binary_f1_score': 0.80540943}
confusion matrix:
     0    1
0  486  163
1   96  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84123224, 'precision': 0.8446461, 'recall': 0.84123224, 'specificity': 0.84123224, 'f1': 0.8408381, 'auroc': 0.9222839, 'binary_precision': 0.8103448, 'binary_recall': 0.89099526, 'binary_specificity': 0.7914692, 'binary_f1_score': 0.84875846}
confusion matrix:
     0    1
0  167   44
1   23  188
early stop counter: 1
val acc:0.7978141903877258, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8412322402000427
after epoch: 14,now: 2024-07-29 03:17:30.033702,epoch time: 0:01:34.467688,used: 0:22:39.065353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.9835448, 'recall': 0.98342615, 'specificity': 0.98342615, 'f1': 0.9834771, 'auroc': 0.9983736, 'binary_precision': 0.9810247, 'binary_recall': 0.9866412, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98382497}
confusion matrix:
      0     1
0  1486    30
1    21  1551
---- Validation: 
scalar performance:
{'acc': 0.70569867, 'precision': 0.70573217, 'recall': 0.7054914, 'specificity': 0.7054914, 'f1': 0.7055149, 'auroc': 0.7955301, 'binary_precision': 0.7066451, 'binary_recall': 0.6898734, 'binary_specificity': 0.7211094, 'binary_f1_score': 0.6981585}
confusion matrix:
     0    1
0  468  181
1  196  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81042653, 'precision': 0.8245392, 'recall': 0.81042653, 'specificity': 0.81042653, 'f1': 0.808343, 'auroc': 0.9015521, 'binary_precision': 0.75686276, 'binary_recall': 0.9146919, 'binary_specificity': 0.70616114, 'binary_f1_score': 0.8283262}
confusion matrix:
     0    1
0  149   62
1   18  193
early stop counter: 2
val acc:0.7056986689567566, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8412322402000427
after epoch: 15,now: 2024-07-29 03:19:06.815354,epoch time: 0:01:36.781652,used: 0:24:15.847005,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9821891, 'precision': 0.982329, 'recall': 0.9824656, 'specificity': 0.9824656, 'f1': 0.98218876, 'auroc': 0.9986932, 'binary_precision': 0.9967299, 'binary_recall': 0.9682338, 'binary_specificity': 0.9966975, 'binary_f1_score': 0.9822753}
confusion matrix:
      0     1
0  1509     5
1    50  1524
---- Validation: 
scalar performance:
{'acc': 0.6167057, 'precision': 0.7349315, 'recall': 0.61192364, 'specificity': 0.61192364, 'f1': 0.5564933, 'auroc': 0.8742028, 'binary_precision': 0.89830506, 'binary_recall': 0.25158226, 'binary_specificity': 0.972265, 'binary_f1_score': 0.39307785}
confusion matrix:
     0    1
0  631   18
1  473  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6540284, 'precision': 0.78831196, 'recall': 0.6540284, 'specificity': 0.6540284, 'f1': 0.6084348, 'auroc': 0.9144, 'binary_precision': 0.98507464, 'binary_recall': 0.3127962, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.47482014}
confusion matrix:
     0   1
0  210   1
1  145  66
early stop counter: 3
val acc:0.6167057156562805, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8412322402000427
after epoch: 16,now: 2024-07-29 03:20:41.397711,epoch time: 0:01:34.582357,used: 0:25:50.429362,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9812176, 'precision': 0.9815222, 'recall': 0.9810469, 'specificity': 0.9810469, 'f1': 0.9812037, 'auroc': 0.99860144, 'binary_precision': 0.973125, 'binary_recall': 0.990458, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.98171496}
confusion matrix:
      0     1
0  1473    43
1    15  1557
---- Validation: 
scalar performance:
{'acc': 0.8384075, 'precision': 0.84007263, 'recall': 0.8379335, 'specificity': 0.8379335, 'f1': 0.8380522, 'auroc': 0.9136013, 'binary_precision': 0.860781, 'binary_recall': 0.8022152, 'binary_specificity': 0.87365174, 'binary_f1_score': 0.8304668}
confusion matrix:
     0    1
0  567   82
1  125  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8459716, 'precision': 0.8692702, 'recall': 0.8459716, 'specificity': 0.8459716, 'f1': 0.84350306, 'auroc': 0.9223063, 'binary_precision': 0.96202534, 'binary_recall': 0.7203792, 'binary_specificity': 0.971564, 'binary_f1_score': 0.82384825}
confusion matrix:
     0    1
0  205    6
1   59  152
new oracle model saved
early stop counter: 4
val acc:0.8384075164794922, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 17,now: 2024-07-29 03:22:19.990065,epoch time: 0:01:38.592354,used: 0:27:29.021716,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.9876647, 'recall': 0.9878038, 'specificity': 0.9878038, 'f1': 0.98769283, 'auroc': 0.99924934, 'binary_precision': 0.9941973, 'binary_recall': 0.98154044, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9878283}
confusion matrix:
      0     1
0  1508     9
1    29  1542
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8104501, 'recall': 0.78665817, 'specificity': 0.78665817, 'f1': 0.78389037, 'auroc': 0.89526, 'binary_precision': 0.8898488, 'binary_recall': 0.65189874, 'binary_specificity': 0.9214176, 'binary_f1_score': 0.75251144}
confusion matrix:
     0    1
0  598   51
1  220  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7606635, 'precision': 0.82351136, 'recall': 0.7606635, 'specificity': 0.7606635, 'f1': 0.74844635, 'auroc': 0.91936386, 'binary_precision': 0.9661017, 'binary_recall': 0.54028434, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.6930091}
confusion matrix:
     0    1
0  207    4
1   97  114
early stop counter: 5
val acc:0.7884465456008911, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 18,now: 2024-07-29 03:23:57.435104,epoch time: 0:01:37.445039,used: 0:29:06.466755,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.988342, 'precision': 0.9883365, 'recall': 0.9884857, 'specificity': 0.9884857, 'f1': 0.988341, 'auroc': 0.9991843, 'binary_precision': 0.99676377, 'binary_recall': 0.98026735, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9884467}
confusion matrix:
      0     1
0  1512     5
1    31  1540
---- Validation: 
scalar performance:
{'acc': 0.7236534, 'precision': 0.78488755, 'recall': 0.72053766, 'specificity': 0.72053766, 'f1': 0.7061074, 'auroc': 0.8966991, 'binary_precision': 0.91369045, 'binary_recall': 0.4857595, 'binary_specificity': 0.9553159, 'binary_f1_score': 0.6342975}
confusion matrix:
     0    1
0  620   29
1  325  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75592417, 'precision': 0.8027742, 'recall': 0.75592417, 'specificity': 0.75592417, 'f1': 0.74610233, 'auroc': 0.8860538, 'binary_precision': 0.921875, 'binary_recall': 0.5592417, 'binary_specificity': 0.9526066, 'binary_f1_score': 0.6961652}
confusion matrix:
     0    1
0  201   10
1   93  118
early stop counter: 6
val acc:0.7236533761024475, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 19,now: 2024-07-29 03:25:36.761672,epoch time: 0:01:39.326568,used: 0:30:45.793323,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9828368, 'precision': 0.98297983, 'recall': 0.9827353, 'specificity': 0.9827353, 'f1': 0.9828278, 'auroc': 0.9989103, 'binary_precision': 0.9779597, 'binary_recall': 0.9885423, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.9832226}
confusion matrix:
      0     1
0  1482    35
1    18  1553
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.8066014, 'recall': 0.7851795, 'specificity': 0.7851795, 'f1': 0.7826894, 'auroc': 0.89585483, 'binary_precision': 0.88110405, 'binary_recall': 0.6566456, 'binary_specificity': 0.9137134, 'binary_f1_score': 0.75249326}
confusion matrix:
     0    1
0  593   56
1  217  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7796208, 'precision': 0.84351546, 'recall': 0.7796209, 'specificity': 0.7796209, 'f1': 0.76887333, 'auroc': 0.94986635, 'binary_precision': 0.9916667, 'binary_recall': 0.56398106, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.71903324}
confusion matrix:
     0    1
0  210    1
1   92  119
early stop counter: 7
val acc:0.7868852615356445, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 20,now: 2024-07-29 03:27:07.297577,epoch time: 0:01:30.535905,used: 0:32:16.329228,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97862697, 'precision': 0.9791371, 'recall': 0.978957, 'specificity': 0.978957, 'f1': 0.9786265, 'auroc': 0.9992107, 'binary_precision': 0.9993355, 'binary_recall': 0.9585723, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9785296}
confusion matrix:
      0     1
0  1518     1
1    65  1504
---- Validation: 
scalar performance:
{'acc': 0.57220924, 'precision': 0.7494972, 'recall': 0.5665386, 'specificity': 0.5665386, 'f1': 0.4724719, 'auroc': 0.9049438, 'binary_precision': 0.95652175, 'binary_recall': 0.1392405, 'binary_specificity': 0.9938367, 'binary_f1_score': 0.24309391}
confusion matrix:
     0   1
0  645   4
1  544  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50473934, 'precision': 0.7511905, 'recall': 0.50473934, 'specificity': 0.50473934, 'f1': 0.34377953, 'auroc': 0.9189147, 'binary_precision': 1.0, 'binary_recall': 0.009478673, 'binary_specificity': 1.0, 'binary_f1_score': 0.018779343}
confusion matrix:
     0  1
0  211  0
1  209  2
early stop counter: 8
val acc:0.5722092390060425, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 21,now: 2024-07-29 03:28:42.868182,epoch time: 0:01:35.570605,used: 0:33:51.899833,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99093264, 'precision': 0.99097306, 'recall': 0.99089146, 'specificity': 0.99089146, 'f1': 0.99092853, 'auroc': 0.9994545, 'binary_precision': 0.9892405, 'binary_recall': 0.9930114, 'binary_specificity': 0.98877144, 'binary_f1_score': 0.9911224}
confusion matrix:
      0     1
0  1497    17
1    11  1563
---- Validation: 
scalar performance:
{'acc': 0.63856363, 'precision': 0.7493132, 'recall': 0.6340755, 'specificity': 0.6340755, 'f1': 0.589214, 'auroc': 0.85442066, 'binary_precision': 0.91219515, 'binary_recall': 0.29588607, 'binary_specificity': 0.972265, 'binary_f1_score': 0.4468339}
confusion matrix:
     0    1
0  631   18
1  445  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6137441, 'precision': 0.78208554, 'recall': 0.6137441, 'specificity': 0.6137441, 'f1': 0.5460119, 'auroc': 0.9447676, 'binary_precision': 1.0, 'binary_recall': 0.22748815, 'binary_specificity': 1.0, 'binary_f1_score': 0.37065637}
confusion matrix:
     0   1
0  211   0
1  163  48
early stop counter: 9
val acc:0.6385636329650879, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 22,now: 2024-07-29 03:30:20.706023,epoch time: 0:01:37.837841,used: 0:35:29.737674,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9944948, 'precision': 0.9944769, 'recall': 0.9945111, 'specificity': 0.9945111, 'f1': 0.9944931, 'auroc': 0.9998758, 'binary_precision': 0.9955414, 'binary_recall': 0.99364275, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9945912}
confusion matrix:
      0     1
0  1508     7
1    10  1563
---- Validation: 
scalar performance:
{'acc': 0.75956285, 'precision': 0.80869323, 'recall': 0.7568886, 'specificity': 0.7568886, 'f1': 0.7482979, 'auroc': 0.9157418, 'binary_precision': 0.9285714, 'binary_recall': 0.55537975, 'binary_specificity': 0.9583975, 'binary_f1_score': 0.6950495}
confusion matrix:
     0    1
0  622   27
1  281  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6161137, 'precision': 0.77321494, 'recall': 0.6161137, 'specificity': 0.6161137, 'f1': 0.5516644, 'auroc': 0.8902091, 'binary_precision': 0.98039216, 'binary_recall': 0.23696682, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.3816794}
confusion matrix:
     0   1
0  210   1
1  161  50
early stop counter: 10
val acc:0.7595628499984741, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 23,now: 2024-07-29 03:31:58.887099,epoch time: 0:01:38.181076,used: 0:37:07.918750,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99190414, 'precision': 0.9918989, 'recall': 0.99203825, 'specificity': 0.99203825, 'f1': 0.99190354, 'auroc': 0.99989676, 'binary_precision': 1.0, 'binary_recall': 0.98407644, 'binary_specificity': 1.0, 'binary_f1_score': 0.9919743}
confusion matrix:
      0     1
0  1518     0
1    25  1545
---- Validation: 
scalar performance:
{'acc': 0.66588604, 'precision': 0.7780334, 'recall': 0.6616204, 'specificity': 0.6616204, 'f1': 0.62499595, 'auroc': 0.9171352, 'binary_precision': 0.95132744, 'binary_recall': 0.34018987, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.50116557}
confusion matrix:
     0    1
0  638   11
1  417  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51184833, 'precision': 0.6815835, 'recall': 0.51184833, 'specificity': 0.51184833, 'f1': 0.3629862, 'auroc': 0.8899621, 'binary_precision': 0.85714287, 'binary_recall': 0.028436018, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.055045873}
confusion matrix:
     0  1
0  210  1
1  205  6
early stop counter: 11
val acc:0.6658860445022583, best validation acc: 0.8438719511032104, corresponding to test acc:                         0.8246445655822754 / 0.8459715843200684
after epoch: 24,now: 2024-07-29 03:33:36.393363,epoch time: 0:01:37.506264,used: 0:38:45.425014,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99287564, 'precision': 0.9930664, 'recall': 0.9927602, 'specificity': 0.9927602, 'f1': 0.9928715, 'auroc': 0.99992865, 'binary_precision': 0.98680073, 'binary_recall': 0.9993635, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.99304235}
confusion matrix:
      0     1
0  1496    21
1     1  1570
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.86971825, 'recall': 0.8608594, 'specificity': 0.8608594, 'f1': 0.8608375, 'auroc': 0.9409778, 'binary_precision': 0.92051756, 'binary_recall': 0.78797466, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.8491048}
confusion matrix:
     0    1
0  606   43
1  134  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7914692, 'precision': 0.83492064, 'recall': 0.7914692, 'specificity': 0.7914692, 'f1': 0.78447896, 'auroc': 0.92998815, 'binary_precision': 0.95555556, 'binary_recall': 0.6113744, 'binary_specificity': 0.971564, 'binary_f1_score': 0.7456647}
confusion matrix:
     0    1
0  205    6
1   82  129
better model found
persisted
after epoch: 25,now: 2024-07-29 03:35:13.350111,epoch time: 0:01:36.956748,used: 0:40:22.381762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9906088, 'precision': 0.9907948, 'recall': 0.99048567, 'specificity': 0.99048567, 'f1': 0.9906027, 'auroc': 0.99977255, 'binary_precision': 0.9849341, 'binary_recall': 0.9968234, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.9908431}
confusion matrix:
      0     1
0  1490    24
1     5  1569
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8154037, 'recall': 0.80195916, 'specificity': 0.80195916, 'f1': 0.80086607, 'auroc': 0.9080767, 'binary_precision': 0.87401575, 'binary_recall': 0.70253164, 'binary_specificity': 0.90138674, 'binary_f1_score': 0.77894735}
confusion matrix:
     0    1
0  585   64
1  188  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83175355, 'precision': 0.8461286, 'recall': 0.83175355, 'specificity': 0.83175355, 'f1': 0.82998836, 'auroc': 0.91586554, 'binary_precision': 0.9166667, 'binary_recall': 0.7298578, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8126649}
confusion matrix:
     0    1
0  197   14
1   57  154
early stop counter: 1
val acc:0.8032786846160889, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.7914692163467407 / 0.8459715843200684
after epoch: 26,now: 2024-07-29 03:36:52.083653,epoch time: 0:01:38.733542,used: 0:42:01.115304,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9925518, 'precision': 0.9925553, 'recall': 0.9925427, 'specificity': 0.9925427, 'f1': 0.9925489, 'auroc': 0.9996077, 'binary_precision': 0.992381, 'binary_recall': 0.9930114, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.9926961}
confusion matrix:
      0     1
0  1502    12
1    11  1563
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.82817894, 'recall': 0.8210916, 'specificity': 0.8210916, 'f1': 0.82085586, 'auroc': 0.9082742, 'binary_precision': 0.86996335, 'binary_recall': 0.75158226, 'binary_specificity': 0.8906009, 'binary_f1_score': 0.8064516}
confusion matrix:
     0    1
0  578   71
1  157  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80094784, 'precision': 0.8237526, 'recall': 0.8009479, 'specificity': 0.8009479, 'f1': 0.79737973, 'auroc': 0.8957795, 'binary_precision': 0.90967745, 'binary_recall': 0.66824645, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.7704918}
confusion matrix:
     0    1
0  197   14
1   70  141
early stop counter: 2
val acc:0.8220140337944031, best validation acc: 0.8618267178535461, corresponding to test acc:                         0.7914692163467407 / 0.8459715843200684
after epoch: 27,now: 2024-07-29 03:38:26.862170,epoch time: 0:01:34.778517,used: 0:43:35.893821,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.9880309, 'recall': 0.9875272, 'specificity': 0.9875272, 'f1': 0.9876856, 'auroc': 0.99976885, 'binary_precision': 0.97875, 'binary_recall': 0.99745226, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.9880126}
confusion matrix:
      0     1
0  1484    34
1     4  1566
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.8650465, 'recall': 0.8620651, 'specificity': 0.8620651, 'f1': 0.8622304, 'auroc': 0.91914046, 'binary_precision': 0.8917526, 'binary_recall': 0.8212025, 'binary_specificity': 0.9029276, 'binary_f1_score': 0.8550247}
confusion matrix:
     0    1
0  586   63
1  113  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8591533, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.83387244, 'auroc': 0.92744994, 'binary_precision': 0.9493671, 'binary_recall': 0.7109005, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.8130081}
confusion matrix:
     0    1
0  203    8
1   61  150
better model found
persisted
after epoch: 28,now: 2024-07-29 03:40:03.771031,epoch time: 0:01:36.908861,used: 0:45:12.802682,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9915803, 'precision': 0.9915391, 'recall': 0.9916481, 'specificity': 0.9916481, 'f1': 0.9915786, 'auroc': 0.9997563, 'binary_precision': 0.99551284, 'binary_recall': 0.9879135, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9916986}
confusion matrix:
      0     1
0  1509     7
1    19  1553
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.8202576, 'recall': 0.7847236, 'specificity': 0.7847236, 'f1': 0.7802865, 'auroc': 0.9209933, 'binary_precision': 0.9203747, 'binary_recall': 0.6218355, 'binary_specificity': 0.9476117, 'binary_f1_score': 0.74220973}
confusion matrix:
     0    1
0  615   34
1  239  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5687204, 'precision': 0.7684479, 'recall': 0.5687204, 'specificity': 0.5687204, 'f1': 0.4701711, 'auroc': 0.92399657, 'binary_precision': 1.0, 'binary_recall': 0.13744076, 'binary_specificity': 1.0, 'binary_f1_score': 0.24166666}
confusion matrix:
     0   1
0  211   0
1  182  29
early stop counter: 1
val acc:0.7868852615356445, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8364928960800171 / 0.8459715843200684
after epoch: 29,now: 2024-07-29 03:41:40.028067,epoch time: 0:01:36.257036,used: 0:46:49.059718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99287564, 'precision': 0.99295485, 'recall': 0.99281, 'specificity': 0.99281, 'f1': 0.992872, 'auroc': 0.99984515, 'binary_precision': 0.989899, 'binary_recall': 0.99618804, 'binary_specificity': 0.989432, 'binary_f1_score': 0.9930335}
confusion matrix:
      0     1
0  1498    16
1     6  1568
---- Validation: 
scalar performance:
{'acc': 0.74160814, 'precision': 0.80197656, 'recall': 0.73860955, 'specificity': 0.73860955, 'f1': 0.7264017, 'auroc': 0.8956409, 'binary_precision': 0.9337176, 'binary_recall': 0.51265824, 'binary_specificity': 0.96456087, 'binary_f1_score': 0.6618999}
confusion matrix:
     0    1
0  626   23
1  308  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59952605, 'precision': 0.7382258, 'recall': 0.59952605, 'specificity': 0.59952605, 'f1': 0.53130525, 'auroc': 0.8888614, 'binary_precision': 0.92, 'binary_recall': 0.21800947, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.3524904}
confusion matrix:
     0   1
0  207   4
1  165  46
early stop counter: 2
val acc:0.7416081428527832, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8364928960800171 / 0.8459715843200684
after epoch: 30,now: 2024-07-29 03:43:16.700143,epoch time: 0:01:36.672076,used: 0:48:25.731794,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_02_54_50_seed_4_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:25.731794 at 2024-07-29 03:43:16.700143
persisted model performance metric: 

scalar performance:
{'acc': 0.8364929, 'precision': 0.8591533, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.83387244, 'auroc': 0.92744994, 'binary_precision': 0.9493671, 'binary_recall': 0.7109005, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.8130081}
confusion matrix:
     0    1
0  203    8
1   61  150
oracle model performance metric: 

scalar performance:
{'acc': 0.8459716, 'precision': 0.8692702, 'recall': 0.8459716, 'specificity': 0.8459716, 'f1': 0.84350306, 'auroc': 0.9223063, 'binary_precision': 0.96202534, 'binary_recall': 0.7203792, 'binary_specificity': 0.971564, 'binary_f1_score': 0.82384825}
confusion matrix:
     0    1
0  205    6
1   59  152
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454144 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 363283 GiB | 363282 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 454144 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool | 413552 KiB |  13181 MiB | 363283 GiB | 363282 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14476 MiB |  14488 MiB |  68826 MiB |  54350 MiB |
|       from large pool |  14410 MiB |  14422 MiB |  68692 MiB |  54282 MiB |
|       from small pool |     66 MiB |     70 MiB |    134 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 434687 KiB |   1260 MiB | 261988 GiB | 261987 GiB |
|       from large pool | 424080 KiB |   1252 MiB | 257608 GiB | 257607 GiB |
|       from small pool |  10607 KiB |     45 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64614 K  |   64613 K  |
|       from large pool |     187    |    1413    |   32814 K  |   32813 K  |
|       from small pool |    1111    |    1419    |   31800 K  |   31799 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64614 K  |   64613 K  |
|       from large pool |     187    |    1413    |   32814 K  |   32813 K  |
|       from small pool |    1111    |    1419    |   31800 K  |   31799 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    2925    |    2290    |
|       from large pool |     602    |     602    |    2858    |    2256    |
|       from small pool |      33    |      35    |      67    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |     652    |   42978 K  |   42978 K  |
|       from large pool |      36    |     604    |   24165 K  |   24165 K  |
|       from small pool |      57    |     236    |   18812 K  |   18812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    868 MiB |  14488 MiB |  68826 MiB |  67958 MiB |
|       from large pool |    818 MiB |  14422 MiB |  68692 MiB |  67874 MiB |
|       from small pool |     50 MiB |     70 MiB |    134 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 261988 GiB | 261988 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |      0 KiB |     45 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64614 K  |   64614 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31800 K  |   31800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64614 K  |   64614 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31800 K  |   31800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2925    |    2863    |
|       from large pool |      37    |     602    |    2858    |    2821    |
|       from small pool |      25    |      35    |      67    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   42978 K  |   42978 K  |
|       from large pool |       3    |     604    |   24165 K  |   24165 K  |
|       from small pool |       0    |     236    |   18812 K  |   18812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367634 GiB | 367634 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363283 GiB | 363283 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    868 MiB |  14488 MiB |  68826 MiB |  67958 MiB |
|       from large pool |    818 MiB |  14422 MiB |  68692 MiB |  67874 MiB |
|       from small pool |     50 MiB |     70 MiB |    134 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 261988 GiB | 261988 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 257608 GiB | 257608 GiB |
|       from small pool |      0 KiB |     45 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64614 K  |   64614 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31800 K  |   31800 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64614 K  |   64614 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31800 K  |   31800 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     637    |    2925    |    2863    |
|       from large pool |      37    |     602    |    2858    |    2821    |
|       from small pool |      25    |      35    |      67    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   42978 K  |   42978 K  |
|       from large pool |       3    |     604    |   24165 K  |   24165 K  |
|       from small pool |       0    |     236    |   18812 K  |   18812 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367

 Experiment start at: 2024-07-29 03:43:59.978320
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9594241, 'precision': 0.9594296, 'recall': 0.9595524, 'specificity': 0.9595524, 'f1': 0.9594216, 'auroc': 0.9898927, 'binary_precision': 0.96791095, 'binary_recall': 0.95170635, 'binary_specificity': 0.9673985, 'binary_f1_score': 0.9597403}
confusion matrix:
      0     1
0  1454    49
1    75  1478
---- Validation: 
scalar performance:
{'acc': 0.80559874, 'precision': 0.8147034, 'recall': 0.8079298, 'specificity': 0.8079298, 'f1': 0.804881, 'auroc': 0.91190076, 'binary_precision': 0.75372124, 'binary_recall': 0.8912, 'binary_specificity': 0.7246596, 'binary_f1_score': 0.81671554}
confusion matrix:
     0    1
0  479  182
1   68  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8095238, 'precision': 0.81413925, 'recall': 0.8095238, 'specificity': 0.8095238, 'f1': 0.80882156, 'auroc': 0.9223778, 'binary_precision': 0.7760618, 'binary_recall': 0.8701299, 'binary_specificity': 0.74891776, 'binary_f1_score': 0.8204082}
confusion matrix:
     0    1
0  173   58
1   30  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 03:45:48.112561,epoch time: 0:01:48.134241,used: 0:01:48.134241,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9649869, 'precision': 0.96595955, 'recall': 0.96536136, 'specificity': 0.96536136, 'f1': 0.9649818, 'auroc': 0.9954072, 'binary_precision': 0.99115044, 'binary_recall': 0.93935484, 'binary_specificity': 0.9913679, 'binary_f1_score': 0.96455777}
confusion matrix:
      0     1
0  1493    13
1    94  1456
---- Validation: 
scalar performance:
{'acc': 0.85614306, 'precision': 0.86859053, 'recall': 0.85356855, 'specificity': 0.85356855, 'f1': 0.85418564, 'auroc': 0.9154469, 'binary_precision': 0.9296875, 'binary_recall': 0.7616, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.8372911}
confusion matrix:
     0    1
0  625   36
1  149  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85064936, 'precision': 0.87338364, 'recall': 0.85064936, 'specificity': 0.85064936, 'f1': 0.84834087, 'auroc': 0.92297745, 'binary_precision': 0.9655172, 'binary_recall': 0.72727275, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.82962966}
confusion matrix:
     0    1
0  225    6
1   63  168
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 03:47:27.206669,epoch time: 0:01:39.094108,used: 0:03:27.228349,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9716199, 'recall': 0.9713017, 'specificity': 0.9713017, 'f1': 0.9708756, 'auroc': 0.99701077, 'binary_precision': 0.99527025, 'binary_recall': 0.9472669, 'binary_specificity': 0.9953364, 'binary_f1_score': 0.97067547}
confusion matrix:
      0     1
0  1494     7
1    82  1473
---- Validation: 
scalar performance:
{'acc': 0.722395, 'precision': 0.7869127, 'recall': 0.7155764, 'specificity': 0.7155764, 'f1': 0.7016639, 'auroc': 0.8716998, 'binary_precision': 0.9161491, 'binary_recall': 0.472, 'binary_specificity': 0.9591528, 'binary_f1_score': 0.6230201}
confusion matrix:
     0    1
0  634   27
1  330  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203463, 'precision': 0.8341805, 'recall': 0.8203463, 'specificity': 0.8203463, 'f1': 0.8184676, 'auroc': 0.889676, 'binary_precision': 0.90217394, 'binary_recall': 0.7186147, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  213   18
1   65  166
early stop counter: 1
val acc:0.7223950028419495, best validation acc: 0.856143057346344, corresponding to test acc:                         0.850649356842041 / 0.850649356842041
after epoch: 3,now: 2024-07-29 03:48:58.540646,epoch time: 0:01:31.333977,used: 0:04:58.562326,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9790318, 'recall': 0.9790909, 'specificity': 0.9790909, 'f1': 0.9790547, 'auroc': 0.9980829, 'binary_precision': 0.98184174, 'binary_recall': 0.9767742, 'binary_specificity': 0.9814077, 'binary_f1_score': 0.9793014}
confusion matrix:
      0     1
0  1478    28
1    36  1514
---- Validation: 
scalar performance:
{'acc': 0.8421462, 'precision': 0.8539875, 'recall': 0.8395606, 'specificity': 0.8395606, 'f1': 0.83999825, 'auroc': 0.9091437, 'binary_precision': 0.9121094, 'binary_recall': 0.7472, 'binary_specificity': 0.9319213, 'binary_f1_score': 0.82146}
confusion matrix:
     0    1
0  616   45
1  158  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8414057, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.8298937, 'auroc': 0.9091284, 'binary_precision': 0.90052354, 'binary_recall': 0.74458873, 'binary_specificity': 0.9177489, 'binary_f1_score': 0.8151659}
confusion matrix:
     0    1
0  212   19
1   59  172
early stop counter: 2
val acc:0.8421462178230286, best validation acc: 0.856143057346344, corresponding to test acc:                         0.850649356842041 / 0.850649356842041
after epoch: 4,now: 2024-07-29 03:50:36.722377,epoch time: 0:01:38.181731,used: 0:06:36.744057,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9689136, 'precision': 0.9696597, 'recall': 0.9686438, 'specificity': 0.9686438, 'f1': 0.96888095, 'auroc': 0.997331, 'binary_precision': 0.9544604, 'binary_recall': 0.98582476, 'binary_specificity': 0.95146275, 'binary_f1_score': 0.96988904}
confusion matrix:
      0     1
0  1431    73
1    22  1530
---- Validation: 
scalar performance:
{'acc': 0.86936235, 'precision': 0.8698268, 'recall': 0.86882424, 'specificity': 0.86882424, 'f1': 0.86911416, 'auroc': 0.92318547, 'binary_precision': 0.87768596, 'binary_recall': 0.8496, 'binary_specificity': 0.8880484, 'binary_f1_score': 0.86341465}
confusion matrix:
     0    1
0  587   74
1   94  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86580086, 'precision': 0.882308, 'recall': 0.86580086, 'specificity': 0.86580086, 'f1': 0.8643365, 'auroc': 0.9326099, 'binary_precision': 0.96174866, 'binary_recall': 0.7619048, 'binary_specificity': 0.969697, 'binary_f1_score': 0.8502416}
confusion matrix:
     0    1
0  224    7
1   55  176
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 03:52:15.857954,epoch time: 0:01:39.135577,used: 0:08:15.879634,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9610602, 'precision': 0.9637769, 'recall': 0.9605242, 'specificity': 0.9605242, 'f1': 0.96096236, 'auroc': 0.9983065, 'binary_precision': 0.9318456, 'binary_recall': 0.99613154, 'binary_specificity': 0.9249169, 'binary_f1_score': 0.9629168}
confusion matrix:
      0     1
0  1392   113
1     6  1545
---- Validation: 
scalar performance:
{'acc': 0.82270604, 'precision': 0.836611, 'recall': 0.8255298, 'specificity': 0.8255298, 'f1': 0.82162744, 'auroc': 0.91912985, 'binary_precision': 0.760841, 'binary_recall': 0.9264, 'binary_specificity': 0.7246596, 'binary_f1_score': 0.8354978}
confusion matrix:
     0    1
0  479  182
1   46  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8030303, 'precision': 0.8149836, 'recall': 0.80303025, 'specificity': 0.80303025, 'f1': 0.80114365, 'auroc': 0.9128952, 'binary_precision': 0.7536232, 'binary_recall': 0.9004329, 'binary_specificity': 0.7056277, 'binary_f1_score': 0.8205128}
confusion matrix:
     0    1
0  163   68
1   23  208
early stop counter: 1
val acc:0.8227060437202454, best validation acc: 0.8693623542785645, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 6,now: 2024-07-29 03:53:54.584398,epoch time: 0:01:38.726444,used: 0:09:54.606078,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9829607, 'recall': 0.98300207, 'specificity': 0.98300207, 'f1': 0.9829798, 'auroc': 0.9985094, 'binary_precision': 0.9845261, 'binary_recall': 0.98199356, 'binary_specificity': 0.98401064, 'binary_f1_score': 0.98325825}
confusion matrix:
      0     1
0  1477    24
1    28  1527
---- Validation: 
scalar performance:
{'acc': 0.87091756, 'precision': 0.8740401, 'recall': 0.86963993, 'specificity': 0.86963993, 'f1': 0.8702823, 'auroc': 0.9238584, 'binary_precision': 0.90192646, 'binary_recall': 0.824, 'binary_specificity': 0.91527987, 'binary_f1_score': 0.8612041}
confusion matrix:
     0    1
0  605   56
1  110  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86580086, 'precision': 0.8837813, 'recall': 0.86580086, 'specificity': 0.86580086, 'f1': 0.86421037, 'auroc': 0.93017375, 'binary_precision': 0.9668508, 'binary_recall': 0.75757575, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.84951454}
confusion matrix:
     0    1
0  225    6
1   56  175
better model found
persisted
after epoch: 7,now: 2024-07-29 03:55:35.033127,epoch time: 0:01:40.448729,used: 0:11:35.054807,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9850468, 'recall': 0.9851216, 'specificity': 0.9851216, 'f1': 0.98494756, 'auroc': 0.99889255, 'binary_precision': 0.9966997, 'binary_recall': 0.97356546, 'binary_specificity': 0.99667776, 'binary_f1_score': 0.9849968}
confusion matrix:
      0     1
0  1500     5
1    41  1510
---- Validation: 
scalar performance:
{'acc': 0.7566096, 'precision': 0.8086458, 'recall': 0.7507328, 'specificity': 0.7507328, 'f1': 0.74289644, 'auroc': 0.8904182, 'binary_precision': 0.9285714, 'binary_recall': 0.5408, 'binary_specificity': 0.96066564, 'binary_f1_score': 0.6835187}
confusion matrix:
     0    1
0  635   26
1  287  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.8763112, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.8528935, 'auroc': 0.9218155, 'binary_precision': 0.96590906, 'binary_recall': 0.73593074, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.83538085}
confusion matrix:
     0    1
0  225    6
1   61  170
early stop counter: 1
val acc:0.7566096186637878, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 8,now: 2024-07-29 03:57:14.863654,epoch time: 0:01:39.830527,used: 0:13:14.885334,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98315513, 'recall': 0.9828819, 'specificity': 0.9828819, 'f1': 0.9829763, 'auroc': 0.9986514, 'binary_precision': 0.97708464, 'binary_recall': 0.98968405, 'binary_specificity': 0.97607976, 'binary_f1_score': 0.98334396}
confusion matrix:
      0     1
0  1469    36
1    16  1535
---- Validation: 
scalar performance:
{'acc': 0.7962675, 'precision': 0.79770136, 'recall': 0.797197, 'specificity': 0.797197, 'f1': 0.7962433, 'auroc': 0.86113405, 'binary_precision': 0.7688889, 'binary_recall': 0.8304, 'binary_specificity': 0.7639939, 'binary_f1_score': 0.7984615}
confusion matrix:
     0    1
0  505  156
1  106  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7922078, 'precision': 0.79229546, 'recall': 0.79220784, 'specificity': 0.79220784, 'f1': 0.7921922, 'auroc': 0.8710481, 'binary_precision': 0.78723407, 'binary_recall': 0.8008658, 'binary_specificity': 0.7835498, 'binary_f1_score': 0.7939914}
confusion matrix:
     0    1
0  181   50
1   46  185
early stop counter: 2
val acc:0.7962675094604492, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 9,now: 2024-07-29 03:58:52.362662,epoch time: 0:01:37.499008,used: 0:14:52.384342,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.97863066, 'recall': 0.97783196, 'specificity': 0.97783196, 'f1': 0.97805476, 'auroc': 0.9987074, 'binary_precision': 0.9661654, 'binary_recall': 0.99163985, 'binary_specificity': 0.964024, 'binary_f1_score': 0.97873694}
confusion matrix:
      0     1
0  1447    54
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.7947123, 'precision': 0.79817414, 'recall': 0.79306984, 'specificity': 0.79306984, 'f1': 0.7933608, 'auroc': 0.8654499, 'binary_precision': 0.82405746, 'binary_recall': 0.7344, 'binary_specificity': 0.85173976, 'binary_f1_score': 0.7766498}
confusion matrix:
     0    1
0  563   98
1  166  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8518555, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83111066, 'auroc': 0.9071232, 'binary_precision': 0.9325843, 'binary_recall': 0.7186147, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.8117359}
confusion matrix:
     0    1
0  219   12
1   65  166
early stop counter: 3
val acc:0.7947123050689697, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 10,now: 2024-07-29 04:00:30.916655,epoch time: 0:01:38.553993,used: 0:16:30.938335,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98675895, 'recall': 0.9864697, 'specificity': 0.9864697, 'f1': 0.9865761, 'auroc': 0.99929655, 'binary_precision': 0.9809403, 'binary_recall': 0.99292606, 'binary_specificity': 0.9800133, 'binary_f1_score': 0.98689675}
confusion matrix:
      0     1
0  1471    30
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.8452566, 'precision': 0.8477592, 'recall': 0.8440242, 'specificity': 0.8440242, 'f1': 0.8445451, 'auroc': 0.9042372, 'binary_precision': 0.87108016, 'binary_recall': 0.8, 'binary_specificity': 0.8880484, 'binary_f1_score': 0.83402836}
confusion matrix:
     0    1
0  587   74
1  125  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85281384, 'precision': 0.86873496, 'recall': 0.85281384, 'specificity': 0.85281384, 'f1': 0.85120773, 'auroc': 0.91818, 'binary_precision': 0.9453552, 'binary_recall': 0.74891776, 'binary_specificity': 0.95671, 'binary_f1_score': 0.83574873}
confusion matrix:
     0    1
0  221   10
1   58  173
early stop counter: 4
val acc:0.8452566266059875, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 11,now: 2024-07-29 04:02:10.354429,epoch time: 0:01:39.437774,used: 0:18:10.376109,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98889995, 'recall': 0.9890382, 'specificity': 0.9890382, 'f1': 0.9888737, 'auroc': 0.9995562, 'binary_precision': 0.9986877, 'binary_recall': 0.97940797, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9889538}
confusion matrix:
      0     1
0  1500     2
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.7589425, 'precision': 0.8203957, 'recall': 0.7526971, 'specificity': 0.7526971, 'f1': 0.74366, 'auroc': 0.9100708, 'binary_precision': 0.9538905, 'binary_recall': 0.5296, 'binary_specificity': 0.97579426, 'binary_f1_score': 0.68106997}
confusion matrix:
     0    1
0  645   16
1  294  331
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6926407, 'precision': 0.79483724, 'recall': 0.69264066, 'specificity': 0.69264066, 'f1': 0.66347957, 'auroc': 0.9116021, 'binary_precision': 0.96842104, 'binary_recall': 0.3982684, 'binary_specificity': 0.987013, 'binary_f1_score': 0.5644172}
confusion matrix:
     0   1
0  228   3
1  139  92
early stop counter: 5
val acc:0.7589424848556519, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 12,now: 2024-07-29 04:03:47.207939,epoch time: 0:01:36.853510,used: 0:19:47.229619,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921291, 'recall': 0.9921645, 'specificity': 0.9921645, 'f1': 0.99214506, 'auroc': 0.9996444, 'binary_precision': 0.9935359, 'binary_recall': 0.9909736, 'binary_specificity': 0.99335545, 'binary_f1_score': 0.99225307}
confusion matrix:
      0     1
0  1495    10
1    14  1537
---- Validation: 
scalar performance:
{'acc': 0.83592534, 'precision': 0.85155964, 'recall': 0.83294284, 'specificity': 0.83294284, 'f1': 0.833111, 'auroc': 0.91244537, 'binary_precision': 0.91902834, 'binary_recall': 0.7264, 'binary_specificity': 0.9394856, 'binary_f1_score': 0.8114388}
confusion matrix:
     0    1
0  621   40
1  171  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7878788, 'precision': 0.8293844, 'recall': 0.78787875, 'specificity': 0.78787875, 'f1': 0.78097904, 'auroc': 0.9113023, 'binary_precision': 0.94630873, 'binary_recall': 0.6103896, 'binary_specificity': 0.965368, 'binary_f1_score': 0.74210525}
confusion matrix:
     0    1
0  223    8
1   90  141
early stop counter: 6
val acc:0.8359253406524658, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 13,now: 2024-07-29 04:05:24.744900,epoch time: 0:01:37.536961,used: 0:21:24.766580,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895159, 'recall': 0.9895369, 'specificity': 0.9895369, 'f1': 0.989526, 'auroc': 0.9995177, 'binary_precision': 0.99033505, 'binary_recall': 0.98906046, 'binary_specificity': 0.9900133, 'binary_f1_score': 0.98969734}
confusion matrix:
      0     1
0  1487    15
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.7721617, 'precision': 0.8199663, 'recall': 0.76664567, 'specificity': 0.76664567, 'f1': 0.7607381, 'auroc': 0.9111117, 'binary_precision': 0.9368421, 'binary_recall': 0.5696, 'binary_specificity': 0.96369135, 'binary_f1_score': 0.7084577}
confusion matrix:
     0    1
0  637   24
1  269  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85281384, 'precision': 0.87833846, 'recall': 0.85281384, 'specificity': 0.85281384, 'f1': 0.85028875, 'auroc': 0.92756885, 'binary_precision': 0.9766082, 'binary_recall': 0.7229437, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.8308458}
confusion matrix:
     0    1
0  227    4
1   64  167
early stop counter: 7
val acc:0.7721617221832275, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 14,now: 2024-07-29 04:07:02.157192,epoch time: 0:01:37.412292,used: 0:23:02.178872,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937541, 'recall': 0.9938355, 'specificity': 0.9938355, 'f1': 0.9937819, 'auroc': 0.9998094, 'binary_precision': 0.9974026, 'binary_recall': 0.99032885, 'binary_specificity': 0.99734217, 'binary_f1_score': 0.9938531}
confusion matrix:
      0     1
0  1501     4
1    15  1536
---- Validation: 
scalar performance:
{'acc': 0.83592534, 'precision': 0.8520535, 'recall': 0.8328992, 'specificity': 0.8328992, 'f1': 0.833042, 'auroc': 0.907436, 'binary_precision': 0.9207317, 'binary_recall': 0.7248, 'binary_specificity': 0.9409985, 'binary_f1_score': 0.8111012}
confusion matrix:
     0    1
0  622   39
1  172  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8246753, 'precision': 0.8585472, 'recall': 0.8246753, 'specificity': 0.8246753, 'f1': 0.82043445, 'auroc': 0.92942417, 'binary_precision': 0.96875, 'binary_recall': 0.67099565, 'binary_specificity': 0.978355, 'binary_f1_score': 0.7928388}
confusion matrix:
     0    1
0  226    5
1   76  155
early stop counter: 8
val acc:0.8359253406524658, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 15,now: 2024-07-29 04:08:36.621823,epoch time: 0:01:34.464631,used: 0:24:36.643503,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9814222, 'recall': 0.98132646, 'specificity': 0.98132646, 'f1': 0.9810208, 'auroc': 0.99908704, 'binary_precision': 1.0, 'binary_recall': 0.9626529, 'binary_specificity': 1.0, 'binary_f1_score': 0.9809711}
confusion matrix:
      0     1
0  1503     0
1    58  1495
---- Validation: 
scalar performance:
{'acc': 0.8172628, 'precision': 0.8460792, 'recall': 0.8131764, 'specificity': 0.8131764, 'f1': 0.8119073, 'auroc': 0.93608236, 'binary_precision': 0.9391892, 'binary_recall': 0.6672, 'binary_specificity': 0.9591528, 'binary_f1_score': 0.7801684}
confusion matrix:
     0    1
0  634   27
1  208  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74458873, 'precision': 0.8233371, 'recall': 0.74458873, 'specificity': 0.74458873, 'f1': 0.72802925, 'auroc': 0.93356574, 'binary_precision': 0.982906, 'binary_recall': 0.4978355, 'binary_specificity': 0.991342, 'binary_f1_score': 0.66091955}
confusion matrix:
     0    1
0  229    2
1  116  115
early stop counter: 9
val acc:0.8172628283500671, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 16,now: 2024-07-29 04:10:04.483783,epoch time: 0:01:27.861960,used: 0:26:04.505463,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9914973, 'recall': 0.99160844, 'specificity': 0.99160844, 'f1': 0.9914917, 'auroc': 0.9998869, 'binary_precision': 0.9993451, 'binary_recall': 0.98388135, 'binary_specificity': 0.9993355, 'binary_f1_score': 0.9915529}
confusion matrix:
      0     1
0  1504     1
1    25  1526
---- Validation: 
scalar performance:
{'acc': 0.8133748, 'precision': 0.8407713, 'recall': 0.80935067, 'specificity': 0.80935067, 'f1': 0.8080597, 'auroc': 0.9150378, 'binary_precision': 0.93064874, 'binary_recall': 0.6656, 'binary_specificity': 0.95310134, 'binary_f1_score': 0.77611935}
confusion matrix:
     0    1
0  630   31
1  209  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77922076, 'precision': 0.8346322, 'recall': 0.77922076, 'specificity': 0.77922076, 'f1': 0.76968634, 'auroc': 0.923952, 'binary_precision': 0.9708029, 'binary_recall': 0.57575756, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.722826}
confusion matrix:
     0    1
0  227    4
1   98  133
early stop counter: 10
val acc:0.8133748173713684, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 17,now: 2024-07-29 04:11:38.633689,epoch time: 0:01:34.149906,used: 0:27:38.655369,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879297, 'recall': 0.9880328, 'specificity': 0.9880328, 'f1': 0.98789227, 'auroc': 0.9996046, 'binary_precision': 0.99737185, 'binary_recall': 0.9787234, 'binary_specificity': 0.99734217, 'binary_f1_score': 0.9879597}
confusion matrix:
      0     1
0  1501     4
1    33  1518
---- Validation: 
scalar performance:
{'acc': 0.8087092, 'precision': 0.83248115, 'recall': 0.8048992, 'specificity': 0.8048992, 'f1': 0.80377126, 'auroc': 0.913404, 'binary_precision': 0.9146608, 'binary_recall': 0.6688, 'binary_specificity': 0.9409985, 'binary_f1_score': 0.77264327}
confusion matrix:
     0    1
0  622   39
1  207  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.8686774, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.8341749, 'auroc': 0.922434, 'binary_precision': 0.9756098, 'binary_recall': 0.6926407, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.81012654}
confusion matrix:
     0    1
0  227    4
1   71  160
early stop counter: 11
val acc:0.8087092041969299, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8658008575439453
after epoch: 18,now: 2024-07-29 04:13:10.781727,epoch time: 0:01:32.148038,used: 0:29:10.803407,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9887438, 'recall': 0.9884316, 'specificity': 0.9884316, 'f1': 0.9885409, 'auroc': 0.999644, 'binary_precision': 0.98221093, 'binary_recall': 0.9954926, 'binary_specificity': 0.98137057, 'binary_f1_score': 0.98880714}
confusion matrix:
      0     1
0  1475    28
1     7  1546
---- Validation: 
scalar performance:
{'acc': 0.85458785, 'precision': 0.85554343, 'recall': 0.855367, 'specificity': 0.855367, 'f1': 0.85458565, 'auroc': 0.91735184, 'binary_precision': 0.8288288, 'binary_recall': 0.8832, 'binary_specificity': 0.827534, 'binary_f1_score': 0.85515106}
confusion matrix:
     0    1
0  547  114
1   73  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87229437, 'precision': 0.8734772, 'recall': 0.87229437, 'specificity': 0.87229437, 'f1': 0.8721932, 'auroc': 0.92213416, 'binary_precision': 0.8944954, 'binary_recall': 0.84415585, 'binary_specificity': 0.9004329, 'binary_f1_score': 0.8685969}
confusion matrix:
     0    1
0  208   23
1   36  195
new oracle model saved
early stop counter: 12
val acc:0.8545878529548645, best validation acc: 0.870917558670044, corresponding to test acc:                         0.8658008575439453 / 0.8722943663597107
after epoch: 19,now: 2024-07-29 04:14:48.643199,epoch time: 0:01:37.861472,used: 0:30:48.664879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9866264, 'recall': 0.98611605, 'specificity': 0.98611605, 'f1': 0.98624897, 'auroc': 0.99972457, 'binary_precision': 0.9759646, 'binary_recall': 0.99741435, 'binary_specificity': 0.97481775, 'binary_f1_score': 0.986573}
confusion matrix:
      0     1
0  1471    38
1     4  1543
---- Validation: 
scalar performance:
{'acc': 0.89891136, 'precision': 0.8992035, 'recall': 0.8985271, 'specificity': 0.8985271, 'f1': 0.8987583, 'auroc': 0.9342233, 'binary_precision': 0.90507364, 'binary_recall': 0.8848, 'binary_specificity': 0.91225415, 'binary_f1_score': 0.894822}
confusion matrix:
     0    1
0  603   58
1   72  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701299, 'precision': 0.8804245, 'recall': 0.8701299, 'specificity': 0.8701299, 'f1': 0.8692453, 'auroc': 0.9261633, 'binary_precision': 0.9430052, 'binary_recall': 0.7878788, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.8584905}
confusion matrix:
     0    1
0  220   11
1   49  182
better model found
persisted
after epoch: 20,now: 2024-07-29 04:16:19.557051,epoch time: 0:01:30.913852,used: 0:32:19.578731,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99375415, 'recall': 0.9938867, 'specificity': 0.9938867, 'f1': 0.993782, 'auroc': 0.99992466, 'binary_precision': 1.0, 'binary_recall': 0.9877735, 'binary_specificity': 1.0, 'binary_f1_score': 0.99384916}
confusion matrix:
      0     1
0  1502     0
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.70995337, 'precision': 0.7868663, 'recall': 0.702515, 'specificity': 0.702515, 'f1': 0.6842369, 'auroc': 0.8993138, 'binary_precision': 0.9285714, 'binary_recall': 0.4368, 'binary_specificity': 0.96822995, 'binary_f1_score': 0.594124}
confusion matrix:
     0    1
0  640   21
1  352  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7467533, 'precision': 0.8208333, 'recall': 0.7467532, 'specificity': 0.7467532, 'f1': 0.73123914, 'auroc': 0.89958954, 'binary_precision': 0.975, 'binary_recall': 0.5064935, 'binary_specificity': 0.987013, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  228    3
1  114  117
early stop counter: 1
val acc:0.7099533677101135, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8722943663597107
after epoch: 21,now: 2024-07-29 04:17:59.201527,epoch time: 0:01:39.644476,used: 0:33:59.223207,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99311024, 'recall': 0.9932389, 'specificity': 0.9932389, 'f1': 0.99312764, 'auroc': 0.99962294, 'binary_precision': 1.0, 'binary_recall': 0.9864778, 'binary_specificity': 1.0, 'binary_f1_score': 0.99319285}
confusion matrix:
      0     1
0  1503     0
1    21  1532
---- Validation: 
scalar performance:
{'acc': 0.59953344, 'precision': 0.7497195, 'recall': 0.58834857, 'specificity': 0.58834857, 'f1': 0.51571804, 'auroc': 0.8685398, 'binary_precision': 0.93650794, 'binary_recall': 0.1888, 'binary_specificity': 0.9878971, 'binary_f1_score': 0.3142477}
confusion matrix:
     0    1
0  653    8
1  507  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5865801, 'precision': 0.7619047, 'recall': 0.5865801, 'specificity': 0.5865801, 'f1': 0.50348574, 'auroc': 0.8890107, 'binary_precision': 0.97619045, 'binary_recall': 0.17748918, 'binary_specificity': 0.995671, 'binary_f1_score': 0.3003663}
confusion matrix:
     0   1
0  230   1
1  190  41
early stop counter: 2
val acc:0.5995334386825562, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8722943663597107
after epoch: 22,now: 2024-07-29 04:19:23.487503,epoch time: 0:01:24.285976,used: 0:35:23.509183,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.99149686, 'recall': 0.9915895, 'specificity': 0.9915895, 'f1': 0.9914918, 'auroc': 0.99970657, 'binary_precision': 0.99869025, 'binary_recall': 0.98450613, 'binary_specificity': 0.99867284, 'binary_f1_score': 0.99154747}
confusion matrix:
      0     1
0  1505     2
1    24  1525
---- Validation: 
scalar performance:
{'acc': 0.8289269, 'precision': 0.849668, 'recall': 0.8254814, 'specificity': 0.8254814, 'f1': 0.825191, 'auroc': 0.91557455, 'binary_precision': 0.9281184, 'binary_recall': 0.7024, 'binary_specificity': 0.9485628, 'binary_f1_score': 0.79963577}
confusion matrix:
     0    1
0  627   34
1  186  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64718616, 'precision': 0.7677257, 'recall': 0.64718616, 'specificity': 0.64718616, 'f1': 0.6024369, 'auroc': 0.86124694, 'binary_precision': 0.94736844, 'binary_recall': 0.3116883, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.46905535}
confusion matrix:
     0   1
0  227   4
1  159  72
early stop counter: 3
val acc:0.8289269208908081, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8722943663597107
after epoch: 23,now: 2024-07-29 04:20:56.810399,epoch time: 0:01:33.322896,used: 0:36:56.832079,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9841746, 'recall': 0.9834112, 'specificity': 0.9834112, 'f1': 0.98362386, 'auroc': 0.99941826, 'binary_precision': 0.97176915, 'binary_recall': 0.9967825, 'binary_specificity': 0.97003996, 'binary_f1_score': 0.9841169}
confusion matrix:
      0     1
0  1457    45
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.88180405, 'precision': 0.8818513, 'recall': 0.8821471, 'specificity': 0.8821471, 'f1': 0.88178575, 'auroc': 0.9336593, 'binary_precision': 0.8666667, 'binary_recall': 0.8944, 'binary_specificity': 0.8698941, 'binary_f1_score': 0.88031495}
confusion matrix:
     0    1
0  575   86
1   66  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8766234, 'precision': 0.89288783, 'recall': 0.8766234, 'specificity': 0.8766234, 'f1': 0.8753332, 'auroc': 0.9350275, 'binary_precision': 0.97282606, 'binary_recall': 0.7748918, 'binary_specificity': 0.978355, 'binary_f1_score': 0.86265063}
confusion matrix:
     0    1
0  226    5
1   52  179
new oracle model saved
early stop counter: 4
val acc:0.8818040490150452, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 24,now: 2024-07-29 04:22:36.559012,epoch time: 0:01:39.748613,used: 0:38:36.580692,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895081, 'recall': 0.989602, 'specificity': 0.989602, 'f1': 0.98952794, 'auroc': 0.99934113, 'binary_precision': 0.9947849, 'binary_recall': 0.98451614, 'binary_specificity': 0.9946879, 'binary_f1_score': 0.9896239}
confusion matrix:
      0     1
0  1498     8
1    24  1526
---- Validation: 
scalar performance:
{'acc': 0.748056, 'precision': 0.80147326, 'recall': 0.74202, 'specificity': 0.74202, 'f1': 0.73314375, 'auroc': 0.8956733, 'binary_precision': 0.92156863, 'binary_recall': 0.5264, 'binary_specificity': 0.95763993, 'binary_f1_score': 0.6700611}
confusion matrix:
     0    1
0  633   28
1  296  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6883117, 'precision': 0.7579118, 'recall': 0.6883117, 'specificity': 0.6883117, 'f1': 0.66576236, 'auroc': 0.8891512, 'binary_precision': 0.8918919, 'binary_recall': 0.42857143, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.5789474}
confusion matrix:
     0   1
0  219  12
1  132  99
early stop counter: 5
val acc:0.7480559945106506, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 25,now: 2024-07-29 04:24:10.632833,epoch time: 0:01:34.073821,used: 0:40:10.654513,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99346507, 'recall': 0.993443, 'specificity': 0.993443, 'f1': 0.9934536, 'auroc': 0.9997486, 'binary_precision': 0.99292606, 'binary_recall': 0.99420476, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.99356496}
confusion matrix:
      0     1
0  1492    11
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.84992224, 'precision': 0.8524791, 'recall': 0.8486935, 'specificity': 0.8486935, 'f1': 0.8492322, 'auroc': 0.9069991, 'binary_precision': 0.8763066, 'binary_recall': 0.8048, 'binary_specificity': 0.892587, 'binary_f1_score': 0.8390325}
confusion matrix:
     0    1
0  590   71
1  122  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7748918, 'precision': 0.7895651, 'recall': 0.77489173, 'specificity': 0.77489173, 'f1': 0.7720034, 'auroc': 0.8743464, 'binary_precision': 0.8547486, 'binary_recall': 0.66233766, 'binary_specificity': 0.88744587, 'binary_f1_score': 0.74634147}
confusion matrix:
     0    1
0  205   26
1   78  153
early stop counter: 6
val acc:0.849922239780426, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 26,now: 2024-07-29 04:25:40.348530,epoch time: 0:01:29.715697,used: 0:41:40.370210,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908248, 'recall': 0.99093413, 'specificity': 0.99093413, 'f1': 0.99083704, 'auroc': 0.9998882, 'binary_precision': 0.99738735, 'binary_recall': 0.9845261, 'binary_specificity': 0.99734217, 'binary_f1_score': 0.990915}
confusion matrix:
      0     1
0  1501     4
1    24  1527
---- Validation: 
scalar performance:
{'acc': 0.60419905, 'precision': 0.73466384, 'recall': 0.59341, 'specificity': 0.59341, 'f1': 0.52789706, 'auroc': 0.9023558, 'binary_precision': 0.9027778, 'binary_recall': 0.208, 'binary_specificity': 0.97881997, 'binary_f1_score': 0.33810142}
confusion matrix:
     0    1
0  647   14
1  495  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54329, 'precision': 0.71974885, 'recall': 0.5432901, 'specificity': 0.5432901, 'f1': 0.42857644, 'auroc': 0.8834355, 'binary_precision': 0.9166667, 'binary_recall': 0.0952381, 'binary_specificity': 0.991342, 'binary_f1_score': 0.17254901}
confusion matrix:
     0   1
0  229   2
1  209  22
early stop counter: 7
val acc:0.6041990518569946, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 27,now: 2024-07-29 04:27:18.035661,epoch time: 0:01:37.687131,used: 0:43:18.057341,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9938226, 'recall': 0.9937501, 'specificity': 0.9937501, 'f1': 0.9937811, 'auroc': 0.99982774, 'binary_precision': 0.9916452, 'binary_recall': 0.99612653, 'binary_specificity': 0.9913736, 'binary_f1_score': 0.9938808}
confusion matrix:
      0     1
0  1494    13
1     6  1543
---- Validation: 
scalar performance:
{'acc': 0.85069984, 'precision': 0.85186917, 'recall': 0.8498421, 'specificity': 0.8498421, 'f1': 0.85025615, 'auroc': 0.9106178, 'binary_precision': 0.86632824, 'binary_recall': 0.8192, 'binary_specificity': 0.8804841, 'binary_f1_score': 0.8421052}
confusion matrix:
     0    1
0  582   79
1  113  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.8606626, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.8544047, 'auroc': 0.9085662, 'binary_precision': 0.9059406, 'binary_recall': 0.7922078, 'binary_specificity': 0.9177489, 'binary_f1_score': 0.8452656}
confusion matrix:
     0    1
0  212   19
1   48  183
early stop counter: 8
val acc:0.8506998419761658, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 28,now: 2024-07-29 04:28:55.985199,epoch time: 0:01:37.949538,used: 0:44:56.006879,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99443066, 'recall': 0.99444103, 'specificity': 0.99444103, 'f1': 0.9944357, 'auroc': 0.99986374, 'binary_precision': 0.9948454, 'binary_recall': 0.99420476, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.99452496}
confusion matrix:
      0     1
0  1495     8
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.85381025, 'precision': 0.86310256, 'recall': 0.85156065, 'specificity': 0.85156065, 'f1': 0.8522056, 'auroc': 0.92927325, 'binary_precision': 0.914611, 'binary_recall': 0.7712, 'binary_specificity': 0.9319213, 'binary_f1_score': 0.8368055}
confusion matrix:
     0    1
0  616   45
1  143  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.84547853, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.7916487, 'auroc': 0.93716383, 'binary_precision': 0.9726027, 'binary_recall': 0.6147186, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.7533157}
confusion matrix:
     0    1
0  227    4
1   89  142
early stop counter: 9
val acc:0.8538102507591248, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 29,now: 2024-07-29 04:30:34.145087,epoch time: 0:01:38.159888,used: 0:46:34.166767,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99312377, 'recall': 0.9932258, 'specificity': 0.9932258, 'f1': 0.9931279, 'auroc': 0.9998616, 'binary_precision': 1.0, 'binary_recall': 0.9864516, 'binary_specificity': 1.0, 'binary_f1_score': 0.9931796}
confusion matrix:
      0     1
0  1506     0
1    21  1529
---- Validation: 
scalar performance:
{'acc': 0.81881803, 'precision': 0.8344221, 'recall': 0.815735, 'specificity': 0.815735, 'f1': 0.8155569, 'auroc': 0.9199352, 'binary_precision': 0.9, 'binary_recall': 0.7056, 'binary_specificity': 0.9258699, 'binary_f1_score': 0.79103136}
confusion matrix:
     0    1
0  612   49
1  184  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7164502, 'precision': 0.79113734, 'recall': 0.7164502, 'specificity': 0.7164502, 'f1': 0.69701886, 'auroc': 0.89477336, 'binary_precision': 0.9385965, 'binary_recall': 0.46320346, 'binary_specificity': 0.969697, 'binary_f1_score': 0.62028986}
confusion matrix:
     0    1
0  224    7
1  124  107
early stop counter: 10
val acc:0.8188180327415466, best validation acc: 0.8989113569259644, corresponding to test acc:                         0.8701298832893372 / 0.8766233921051025
after epoch: 30,now: 2024-07-29 04:32:11.383119,epoch time: 0:01:37.238032,used: 0:48:11.404799,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_03_43_59_seed_5_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:11.404799 at 2024-07-29 04:32:11.383119
persisted model performance metric: 

scalar performance:
{'acc': 0.8701299, 'precision': 0.8804245, 'recall': 0.8701299, 'specificity': 0.8701299, 'f1': 0.8692453, 'auroc': 0.9261633, 'binary_precision': 0.9430052, 'binary_recall': 0.7878788, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.8584905}
confusion matrix:
     0    1
0  220   11
1   49  182
oracle model performance metric: 

scalar performance:
{'acc': 0.8766234, 'precision': 0.89288783, 'recall': 0.8766234, 'specificity': 0.8766234, 'f1': 0.8753332, 'auroc': 0.9350275, 'binary_precision': 0.97282606, 'binary_recall': 0.7748918, 'binary_specificity': 0.978355, 'binary_f1_score': 0.86265063}
confusion matrix:
     0    1
0  226    5
1   52  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 458085 KiB |  13221 MiB | 441348 GiB | 441347 GiB |
|       from large pool | 417487 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 458085 KiB |  13221 MiB | 441348 GiB | 441347 GiB |
|       from large pool | 417487 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 434946 GiB | 434945 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14488 MiB |  82428 MiB |  67958 MiB |
|       from large pool |  14404 MiB |  14422 MiB |  82278 MiB |  67874 MiB |
|       from small pool |     66 MiB |     70 MiB |    150 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 492186 KiB |   1260 MiB | 317447 GiB | 317447 GiB |
|       from large pool | 481585 KiB |   1252 MiB | 312193 GiB | 312193 GiB |
|       from small pool |  10601 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77547 K  |   77546 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38162 K  |   38161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77547 K  |   77546 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38162 K  |   38161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    3498    |    2863    |
|       from large pool |     602    |     602    |    3423    |    2821    |
|       from small pool |      33    |      35    |      75    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     652    |   51886 K  |   51886 K  |
|       from large pool |      40    |     604    |   29479 K  |   29479 K  |
|       from small pool |      60    |     236    |   22407 K  |   22407 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434946 GiB | 434946 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    928 MiB |  14488 MiB |  82428 MiB |  81500 MiB |
|       from large pool |    878 MiB |  14422 MiB |  82278 MiB |  81400 MiB |
|       from small pool |     50 MiB |     70 MiB |    150 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 317447 GiB | 317447 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 312194 GiB | 312194 GiB |
|       from small pool |      0 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77547 K  |   77547 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38162 K  |   38162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77547 K  |   77547 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38162 K  |   38162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    3498    |    3433    |
|       from large pool |      40    |     602    |    3423    |    3383    |
|       from small pool |      25    |      35    |      75    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   51887 K  |   51887 K  |
|       from large pool |       3    |     604    |   29479 K  |   29479 K  |
|       from small pool |       0    |     236    |   22407 K  |   22407 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 441348 GiB | 441348 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 436127 GiB | 436127 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434946 GiB | 434946 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    928 MiB |  14488 MiB |  82428 MiB |  81500 MiB |
|       from large pool |    878 MiB |  14422 MiB |  82278 MiB |  81400 MiB |
|       from small pool |     50 MiB |     70 MiB |    150 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 317447 GiB | 317447 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 312194 GiB | 312194 GiB |
|       from small pool |      0 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77547 K  |   77547 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38162 K  |   38162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77547 K  |   77547 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38162 K  |   38162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    3498    |    3433    |
|       from large pool |      40    |     602    |    3423    |    3383    |
|       from small pool |      25    |      35    |      75    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   51887 K  |   51887 K  |
|       from large pool |       3    |     604    |   29479 K  |   29479 K  |
|       from small pool |       0    |     236    |   22407 K  |   22407 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367

 Experiment start at: 2024-07-29 04:32:56.009715
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95076555, 'recall': 0.95066464, 'specificity': 0.95066464, 'f1': 0.95052004, 'auroc': 0.985809, 'binary_precision': 0.96419096, 'binary_recall': 0.9368557, 'binary_specificity': 0.96447366, 'binary_f1_score': 0.9503268}
confusion matrix:
      0     1
0  1466    54
1    98  1454
---- Validation: 
scalar performance:
{'acc': 0.8428016, 'precision': 0.84477866, 'recall': 0.84306633, 'specificity': 0.84306633, 'f1': 0.84264135, 'auroc': 0.9145199, 'binary_precision': 0.81686044, 'binary_recall': 0.88087773, 'binary_specificity': 0.805255, 'binary_f1_score': 0.84766215}
confusion matrix:
     0    1
0  521  126
1   76  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445946, 'precision': 0.8451619, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.8445307, 'auroc': 0.9297135, 'binary_precision': 0.85915494, 'binary_recall': 0.8243243, 'binary_specificity': 0.8648649, 'binary_f1_score': 0.8413793}
confusion matrix:
     0    1
0  192   30
1   39  183
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 04:34:40.330299,epoch time: 0:01:44.320584,used: 0:01:44.320584,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97753274, 'recall': 0.9775398, 'specificity': 0.9775398, 'f1': 0.9775362, 'auroc': 0.99696773, 'binary_precision': 0.9781069, 'binary_recall': 0.9774775, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.97779214}
confusion matrix:
      0     1
0  1484    34
1    35  1519
---- Validation: 
scalar performance:
{'acc': 0.8389105, 'precision': 0.84504926, 'recall': 0.8393768, 'specificity': 0.8393768, 'f1': 0.8383148, 'auroc': 0.9242368, 'binary_precision': 0.7972414, 'binary_recall': 0.9059561, 'binary_specificity': 0.7727975, 'binary_f1_score': 0.84812915}
confusion matrix:
     0    1
0  500  147
1   60  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8018018, 'precision': 0.8255844, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.7981151, 'auroc': 0.93227005, 'binary_precision': 0.73758864, 'binary_recall': 0.9369369, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  148   74
1   14  208
early stop counter: 1
val acc:0.8389105200767517, best validation acc: 0.842801570892334, corresponding to test acc:                         0.8445945978164673 / 0.8445945978164673
after epoch: 2,now: 2024-07-29 04:36:07.205441,epoch time: 0:01:26.875142,used: 0:03:11.195726,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97624564, 'recall': 0.97622323, 'specificity': 0.97622323, 'f1': 0.97623354, 'auroc': 0.99775374, 'binary_precision': 0.9755784, 'binary_recall': 0.97746295, 'binary_specificity': 0.9749835, 'binary_f1_score': 0.9765198}
confusion matrix:
      0     1
0  1481    38
1    35  1518
---- Validation: 
scalar performance:
{'acc': 0.8466926, 'precision': 0.84717876, 'recall': 0.84655976, 'specificity': 0.84655976, 'f1': 0.84659743, 'auroc': 0.91265935, 'binary_precision': 0.8585366, 'binary_recall': 0.82758623, 'binary_specificity': 0.86553323, 'binary_f1_score': 0.8427773}
confusion matrix:
     0    1
0  560   87
1  110  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.835806, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.82793504, 'auroc': 0.9273597, 'binary_precision': 0.78740156, 'binary_recall': 0.9009009, 'binary_specificity': 0.7567568, 'binary_f1_score': 0.84033614}
confusion matrix:
     0    1
0  168   54
1   22  200
better model found
persisted
after epoch: 3,now: 2024-07-29 04:37:43.840484,epoch time: 0:01:36.635043,used: 0:04:47.830769,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9809801, 'recall': 0.9809245, 'specificity': 0.9809245, 'f1': 0.9807942, 'auroc': 0.9984722, 'binary_precision': 0.9933906, 'binary_recall': 0.96842784, 'binary_specificity': 0.9934211, 'binary_f1_score': 0.98075044}
confusion matrix:
      0     1
0  1510    10
1    49  1503
---- Validation: 
scalar performance:
{'acc': 0.8389105, 'precision': 0.8425398, 'recall': 0.8385483, 'specificity': 0.8385483, 'f1': 0.8383745, 'auroc': 0.90937436, 'binary_precision': 0.87609076, 'binary_recall': 0.7868339, 'binary_specificity': 0.8902627, 'binary_f1_score': 0.82906693}
confusion matrix:
     0    1
0  576   71
1  136  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558559, 'precision': 0.85611594, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.85582954, 'auroc': 0.92151606, 'binary_precision': 0.8657407, 'binary_recall': 0.8423423, 'binary_specificity': 0.8693694, 'binary_f1_score': 0.85388124}
confusion matrix:
     0    1
0  193   29
1   35  187
new oracle model saved
early stop counter: 1
val acc:0.8389105200767517, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8558558821678162
after epoch: 4,now: 2024-07-29 04:39:22.683255,epoch time: 0:01:38.842771,used: 0:06:26.673540,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98274744, 'recall': 0.98280656, 'specificity': 0.98280656, 'f1': 0.98274684, 'auroc': 0.99781984, 'binary_precision': 0.98828125, 'binary_recall': 0.97746295, 'binary_specificity': 0.9881501, 'binary_f1_score': 0.9828423}
confusion matrix:
      0     1
0  1501    18
1    35  1518
---- Validation: 
scalar performance:
{'acc': 0.7789883, 'precision': 0.79062617, 'recall': 0.7782798, 'specificity': 0.7782798, 'f1': 0.77644724, 'auroc': 0.875255, 'binary_precision': 0.84705883, 'binary_recall': 0.677116, 'binary_specificity': 0.8794436, 'binary_f1_score': 0.75261325}
confusion matrix:
     0    1
0  569   78
1  206  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8478763, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.84171283, 'auroc': 0.9061359, 'binary_precision': 0.8917526, 'binary_recall': 0.7792793, 'binary_specificity': 0.9054054, 'binary_f1_score': 0.8317308}
confusion matrix:
     0    1
0  201   21
1   49  173
early stop counter: 2
val acc:0.7789883017539978, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8558558821678162
after epoch: 5,now: 2024-07-29 04:40:51.670329,epoch time: 0:01:28.987074,used: 0:07:55.660614,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97130436, 'recall': 0.9705372, 'specificity': 0.9705372, 'f1': 0.9706833, 'auroc': 0.99715006, 'binary_precision': 0.956875, 'binary_recall': 0.9864691, 'binary_specificity': 0.9546053, 'binary_f1_score': 0.97144675}
confusion matrix:
      0     1
0  1451    69
1    21  1531
---- Validation: 
scalar performance:
{'acc': 0.65603113, 'precision': 0.77084935, 'recall': 0.6537359, 'specificity': 0.6537359, 'f1': 0.61333543, 'auroc': 0.89835894, 'binary_precision': 0.94545454, 'binary_recall': 0.3260188, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.48484847}
confusion matrix:
     0    1
0  635   12
1  430  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364865, 'precision': 0.81160605, 'recall': 0.7364865, 'specificity': 0.7364865, 'f1': 0.7195865, 'auroc': 0.8985472, 'binary_precision': 0.96460176, 'binary_recall': 0.490991, 'binary_specificity': 0.981982, 'binary_f1_score': 0.6507463}
confusion matrix:
     0    1
0  218    4
1  113  109
early stop counter: 3
val acc:0.6560311317443848, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8558558821678162
after epoch: 6,now: 2024-07-29 04:42:26.192338,epoch time: 0:01:34.522009,used: 0:09:30.182623,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9775864, 'recall': 0.9774971, 'specificity': 0.9774971, 'f1': 0.97753334, 'auroc': 0.99747044, 'binary_precision': 0.9750799, 'binary_recall': 0.9807198, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.97789174}
confusion matrix:
      0     1
0  1477    39
1    30  1526
---- Validation: 
scalar performance:
{'acc': 0.736965, 'precision': 0.79483974, 'recall': 0.7354041, 'specificity': 0.7354041, 'f1': 0.7225395, 'auroc': 0.89740443, 'binary_precision': 0.9237288, 'binary_recall': 0.5125392, 'binary_specificity': 0.95826894, 'binary_f1_score': 0.65927416}
confusion matrix:
     0    1
0  620   27
1  311  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5788288, 'precision': 0.74596393, 'recall': 0.5788288, 'specificity': 0.5788288, 'f1': 0.49263963, 'auroc': 0.8766131, 'binary_precision': 0.94871795, 'binary_recall': 0.16666667, 'binary_specificity': 0.990991, 'binary_f1_score': 0.28352493}
confusion matrix:
     0   1
0  220   2
1  185  37
early stop counter: 4
val acc:0.736965000629425, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8558558821678162
after epoch: 7,now: 2024-07-29 04:44:05.278912,epoch time: 0:01:39.086574,used: 0:11:09.269197,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98893106, 'recall': 0.98893106, 'specificity': 0.98893106, 'f1': 0.98893106, 'auroc': 0.9994854, 'binary_precision': 0.9890464, 'binary_recall': 0.9890464, 'binary_specificity': 0.9888158, 'binary_f1_score': 0.9890464}
confusion matrix:
      0     1
0  1503    17
1    17  1535
---- Validation: 
scalar performance:
{'acc': 0.8412451, 'precision': 0.84548414, 'recall': 0.84085584, 'specificity': 0.84085584, 'f1': 0.8406428, 'auroc': 0.91662693, 'binary_precision': 0.8820422, 'binary_recall': 0.78526646, 'binary_specificity': 0.89644516, 'binary_f1_score': 0.8308457}
confusion matrix:
     0    1
0  580   67
1  137  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8085586, 'precision': 0.80906653, 'recall': 0.8085586, 'specificity': 0.8085586, 'f1': 0.8084799, 'auroc': 0.8943268, 'binary_precision': 0.7965368, 'binary_recall': 0.8288288, 'binary_specificity': 0.7882883, 'binary_f1_score': 0.8123621}
confusion matrix:
     0    1
0  175   47
1   38  184
early stop counter: 5
val acc:0.8412451148033142, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8558558821678162
after epoch: 8,now: 2024-07-29 04:45:44.400287,epoch time: 0:01:39.121375,used: 0:12:48.390572,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9807763, 'recall': 0.98063934, 'specificity': 0.98063934, 'f1': 0.9804684, 'auroc': 0.99915904, 'binary_precision': 0.9960133, 'binary_recall': 0.9652286, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.98037934}
confusion matrix:
      0     1
0  1513     6
1    54  1499
---- Validation: 
scalar performance:
{'acc': 0.76731515, 'precision': 0.8186799, 'recall': 0.76590294, 'specificity': 0.76590294, 'f1': 0.75689816, 'auroc': 0.91060257, 'binary_precision': 0.9448819, 'binary_recall': 0.56426334, 'binary_specificity': 0.9675425, 'binary_f1_score': 0.7065751}
confusion matrix:
     0    1
0  626   21
1  278  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175676, 'precision': 0.85606873, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.81249905, 'auroc': 0.9116549, 'binary_precision': 0.97315437, 'binary_recall': 0.6531532, 'binary_specificity': 0.981982, 'binary_f1_score': 0.7816712}
confusion matrix:
     0    1
0  218    4
1   77  145
early stop counter: 6
val acc:0.767315149307251, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8558558821678162
after epoch: 9,now: 2024-07-29 04:47:14.122068,epoch time: 0:01:29.721781,used: 0:14:18.112353,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9860045, 'recall': 0.9859977, 'specificity': 0.9859977, 'f1': 0.986001, 'auroc': 0.99927056, 'binary_precision': 0.9858339, 'binary_recall': 0.9864691, 'binary_specificity': 0.9855263, 'binary_f1_score': 0.9861514}
confusion matrix:
      0     1
0  1498    22
1    21  1531
---- Validation: 
scalar performance:
{'acc': 0.80466926, 'precision': 0.8259064, 'recall': 0.80377126, 'specificity': 0.80377126, 'f1': 0.8011058, 'auroc': 0.90786994, 'binary_precision': 0.9073684, 'binary_recall': 0.6755486, 'binary_specificity': 0.93199384, 'binary_f1_score': 0.77448344}
confusion matrix:
     0    1
0  603   44
1  207  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8603604, 'precision': 0.875095, 'recall': 0.8603604, 'specificity': 0.8603604, 'f1': 0.8589754, 'auroc': 0.9169102, 'binary_precision': 0.9494382, 'binary_recall': 0.7612613, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  213    9
1   53  169
new oracle model saved
early stop counter: 7
val acc:0.8046692609786987, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8603603839874268
after epoch: 10,now: 2024-07-29 04:48:45.488655,epoch time: 0:01:31.366587,used: 0:15:49.478940,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873289, 'recall': 0.9873907, 'specificity': 0.9873907, 'f1': 0.98730445, 'auroc': 0.99868584, 'binary_precision': 0.99477464, 'binary_recall': 0.98005146, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.98735815}
confusion matrix:
      0     1
0  1510     8
1    31  1523
---- Validation: 
scalar performance:
{'acc': 0.6754864, 'precision': 0.7861428, 'recall': 0.6732956, 'specificity': 0.6732956, 'f1': 0.63910353, 'auroc': 0.9006822, 'binary_precision': 0.9623431, 'binary_recall': 0.36050156, 'binary_specificity': 0.98608965, 'binary_f1_score': 0.5245154}
confusion matrix:
     0    1
0  638    9
1  408  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837838, 'precision': 0.8457773, 'recall': 0.7837838, 'specificity': 0.7837838, 'f1': 0.7736379, 'auroc': 0.9135419, 'binary_precision': 0.9921875, 'binary_recall': 0.5720721, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.7257143}
confusion matrix:
     0    1
0  221    1
1   95  127
early stop counter: 8
val acc:0.6754863858222961, best validation acc: 0.8466926217079163, corresponding to test acc:                         0.8288288116455078 / 0.8603603839874268
after epoch: 11,now: 2024-07-29 04:50:22.062184,epoch time: 0:01:36.573529,used: 0:17:26.052469,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97316754, 'recall': 0.9714087, 'specificity': 0.9714087, 'f1': 0.9716427, 'auroc': 0.99919116, 'binary_precision': 0.949111, 'binary_recall': 0.9974227, 'binary_specificity': 0.94539475, 'binary_f1_score': 0.9726673}
confusion matrix:
      0     1
0  1437    83
1     4  1548
---- Validation: 
scalar performance:
{'acc': 0.86070037, 'precision': 0.86069417, 'recall': 0.8607099, 'specificity': 0.8607099, 'f1': 0.8606974, 'auroc': 0.9158014, 'binary_precision': 0.8580343, 'binary_recall': 0.86206895, 'binary_specificity': 0.85935086, 'binary_f1_score': 0.8600469}
confusion matrix:
     0    1
0  556   91
1   88  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8040541, 'precision': 0.82551324, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.8007705, 'auroc': 0.9110056, 'binary_precision': 0.90909094, 'binary_recall': 0.6756757, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.7751938}
confusion matrix:
     0    1
0  207   15
1   72  150
better model found
persisted
after epoch: 12,now: 2024-07-29 04:51:58.035216,epoch time: 0:01:35.973032,used: 0:19:02.025501,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882982, 'recall': 0.98834777, 'specificity': 0.98834777, 'f1': 0.9882811, 'auroc': 0.9995278, 'binary_precision': 0.9947781, 'binary_recall': 0.98195875, 'binary_specificity': 0.99473685, 'binary_f1_score': 0.9883269}
confusion matrix:
      0     1
0  1512     8
1    28  1524
---- Validation: 
scalar performance:
{'acc': 0.707393, 'precision': 0.7983161, 'recall': 0.70544904, 'specificity': 0.70544904, 'f1': 0.68201774, 'auroc': 0.9098952, 'binary_precision': 0.9612676, 'binary_recall': 0.4278997, 'binary_specificity': 0.98299843, 'binary_f1_score': 0.59219086}
confusion matrix:
     0    1
0  636   11
1  365  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5923423, 'precision': 0.77543426, 'recall': 0.5923423, 'specificity': 0.5923423, 'f1': 0.51109356, 'auroc': 0.8917702, 'binary_precision': 1.0, 'binary_recall': 0.18468468, 'binary_specificity': 1.0, 'binary_f1_score': 0.31178707}
confusion matrix:
     0   1
0  222   0
1  181  41
early stop counter: 1
val acc:0.7073929905891418, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 13,now: 2024-07-29 04:53:36.623649,epoch time: 0:01:38.588433,used: 0:20:40.613934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873003, 'recall': 0.9873067, 'specificity': 0.9873067, 'f1': 0.98730344, 'auroc': 0.9994676, 'binary_precision': 0.9877498, 'binary_recall': 0.9871134, 'binary_specificity': 0.9875, 'binary_f1_score': 0.9874315}
confusion matrix:
      0     1
0  1501    19
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.80622566, 'precision': 0.8165239, 'recall': 0.8055893, 'specificity': 0.8055893, 'f1': 0.8044043, 'auroc': 0.8962834, 'binary_precision': 0.8718929, 'binary_recall': 0.71473354, 'binary_specificity': 0.89644516, 'binary_f1_score': 0.7855297}
confusion matrix:
     0    1
0  580   67
1  182  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8468468, 'precision': 0.84968495, 'recall': 0.8468468, 'specificity': 0.8468468, 'f1': 0.84653544, 'auroc': 0.91301435, 'binary_precision': 0.8811881, 'binary_recall': 0.8018018, 'binary_specificity': 0.8918919, 'binary_f1_score': 0.8396227}
confusion matrix:
     0    1
0  198   24
1   44  178
early stop counter: 2
val acc:0.8062256574630737, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 14,now: 2024-07-29 04:55:13.663294,epoch time: 0:01:37.039645,used: 0:22:17.653579,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98221254, 'recall': 0.98160666, 'specificity': 0.98160666, 'f1': 0.9817591, 'auroc': 0.9992658, 'binary_precision': 0.9705144, 'binary_recall': 0.99421597, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9822222}
confusion matrix:
      0     1
0  1469    47
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8575876, 'precision': 0.8588585, 'recall': 0.8573789, 'specificity': 0.8573789, 'f1': 0.8574048, 'auroc': 0.91234684, 'binary_precision': 0.87853575, 'binary_recall': 0.82758623, 'binary_specificity': 0.88717157, 'binary_f1_score': 0.8523002}
confusion matrix:
     0    1
0  574   73
1  110  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.82690156, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82653344, 'auroc': 0.91043746, 'binary_precision': 0.8165939, 'binary_recall': 0.8423423, 'binary_specificity': 0.8108108, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  180   42
1   35  187
early stop counter: 3
val acc:0.8575875759124756, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 15,now: 2024-07-29 04:56:47.835222,epoch time: 0:01:34.171928,used: 0:23:51.825507,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893013, 'recall': 0.98932517, 'specificity': 0.98932517, 'f1': 0.9892578, 'auroc': 0.9995295, 'binary_precision': 0.9967256, 'binary_recall': 0.9819355, 'binary_specificity': 0.99671483, 'binary_f1_score': 0.9892753}
confusion matrix:
      0     1
0  1517     5
1    28  1522
---- Validation: 
scalar performance:
{'acc': 0.7322957, 'precision': 0.79205, 'recall': 0.73070186, 'specificity': 0.73070186, 'f1': 0.71697193, 'auroc': 0.9196484, 'binary_precision': 0.92241377, 'binary_recall': 0.5031348, 'binary_specificity': 0.95826894, 'binary_f1_score': 0.6511156}
confusion matrix:
     0    1
0  620   27
1  317  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5315315, 'precision': 0.7581395, 'recall': 0.5315315, 'specificity': 0.5315315, 'f1': 0.39981282, 'auroc': 0.9198117, 'binary_precision': 1.0, 'binary_recall': 0.06306306, 'binary_specificity': 1.0, 'binary_f1_score': 0.11864407}
confusion matrix:
     0   1
0  222   0
1  208  14
early stop counter: 4
val acc:0.7322956919670105, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 16,now: 2024-07-29 04:58:24.886445,epoch time: 0:01:37.051223,used: 0:25:28.876730,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98520947, 'recall': 0.98517656, 'specificity': 0.98517656, 'f1': 0.985026, 'auroc': 0.9992395, 'binary_precision': 0.9980185, 'binary_recall': 0.9723295, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9850066}
confusion matrix:
      0     1
0  1515     3
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.5844358, 'precision': 0.72754157, 'recall': 0.58163553, 'specificity': 0.58163553, 'f1': 0.50343156, 'auroc': 0.9000741, 'binary_precision': 0.90625, 'binary_recall': 0.18181819, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.30287206}
confusion matrix:
     0    1
0  635   12
1  522  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.518018, 'precision': 0.7545872, 'recall': 0.518018, 'specificity': 0.518018, 'f1': 0.3721686, 'auroc': 0.90037334, 'binary_precision': 1.0, 'binary_recall': 0.036036037, 'binary_specificity': 1.0, 'binary_f1_score': 0.06956522}
confusion matrix:
     0  1
0  222  0
1  214  8
early stop counter: 5
val acc:0.5844358205795288, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 17,now: 2024-07-29 05:00:04.085224,epoch time: 0:01:39.198779,used: 0:27:08.075509,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9807286, 'recall': 0.9799491, 'specificity': 0.9799491, 'f1': 0.98012805, 'auroc': 0.99926955, 'binary_precision': 0.9668957, 'binary_recall': 0.9948586, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.9806779}
confusion matrix:
      0     1
0  1463    53
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.8575876, 'precision': 0.8595549, 'recall': 0.85784763, 'specificity': 0.85784763, 'f1': 0.8574494, 'auroc': 0.925075, 'binary_precision': 0.83114994, 'binary_recall': 0.8949843, 'binary_specificity': 0.82071096, 'binary_f1_score': 0.86188674}
confusion matrix:
     0    1
0  531  116
1   67  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8536036, 'precision': 0.8552253, 'recall': 0.8536036, 'specificity': 0.8536036, 'f1': 0.85343635, 'auroc': 0.929754, 'binary_precision': 0.8312236, 'binary_recall': 0.8873874, 'binary_specificity': 0.8198198, 'binary_f1_score': 0.8583878}
confusion matrix:
     0    1
0  182   40
1   25  197
early stop counter: 6
val acc:0.8575875759124756, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 18,now: 2024-07-29 05:01:41.485409,epoch time: 0:01:37.400185,used: 0:28:45.475694,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.992831, 'recall': 0.9928452, 'specificity': 0.9928452, 'f1': 0.99283767, 'auroc': 0.99956083, 'binary_precision': 0.9935567, 'binary_recall': 0.992278, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.99291694}
confusion matrix:
      0     1
0  1508    10
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.8342413, 'precision': 0.8494986, 'recall': 0.83350813, 'specificity': 0.83350813, 'f1': 0.83219206, 'auroc': 0.922951, 'binary_precision': 0.9207921, 'binary_recall': 0.7288401, 'binary_specificity': 0.9381762, 'binary_f1_score': 0.8136483}
confusion matrix:
     0    1
0  607   40
1  173  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445946, 'precision': 0.87690586, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.84119105, 'auroc': 0.9208262, 'binary_precision': 0.9872612, 'binary_recall': 0.6981982, 'binary_specificity': 0.990991, 'binary_f1_score': 0.81794196}
confusion matrix:
     0    1
0  220    2
1   67  155
early stop counter: 7
val acc:0.8342412710189819, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 19,now: 2024-07-29 05:03:18.506697,epoch time: 0:01:37.021288,used: 0:30:22.496982,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915892, 'recall': 0.9915016, 'specificity': 0.9915016, 'f1': 0.99153495, 'auroc': 0.99976003, 'binary_precision': 0.98847634, 'binary_recall': 0.9948454, 'binary_specificity': 0.98815787, 'binary_f1_score': 0.9916507}
confusion matrix:
      0     1
0  1502    18
1     8  1544
---- Validation: 
scalar performance:
{'acc': 0.85291827, 'precision': 0.8610346, 'recall': 0.85239327, 'specificity': 0.85239327, 'f1': 0.8519485, 'auroc': 0.92345667, 'binary_precision': 0.9134438, 'binary_recall': 0.77742946, 'binary_specificity': 0.927357, 'binary_f1_score': 0.8399661}
confusion matrix:
     0    1
0  600   47
1  142  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581081, 'precision': 0.8593403, 'recall': 0.8581081, 'specificity': 0.8581081, 'f1': 0.85798633, 'auroc': 0.92261183, 'binary_precision': 0.8803828, 'binary_recall': 0.8288288, 'binary_specificity': 0.8873874, 'binary_f1_score': 0.8538283}
confusion matrix:
     0    1
0  197   25
1   38  184
early stop counter: 8
val acc:0.852918267250061, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 20,now: 2024-07-29 05:04:55.970766,epoch time: 0:01:37.464069,used: 0:31:59.961051,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918517, 'recall': 0.9918723, 'specificity': 0.9918723, 'f1': 0.9918611, 'auroc': 0.99886215, 'binary_precision': 0.9929078, 'binary_recall': 0.990991, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9919485}
confusion matrix:
      0     1
0  1507    11
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.83501947, 'precision': 0.8491461, 'recall': 0.83431363, 'specificity': 0.83431363, 'f1': 0.8331226, 'auroc': 0.91294277, 'binary_precision': 0.91764706, 'binary_recall': 0.7335423, 'binary_specificity': 0.935085, 'binary_f1_score': 0.81533104}
confusion matrix:
     0    1
0  605   42
1  170  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8468468, 'precision': 0.8486579, 'recall': 0.8468468, 'specificity': 0.8468468, 'f1': 0.84664774, 'auroc': 0.90633875, 'binary_precision': 0.8737864, 'binary_recall': 0.8108108, 'binary_specificity': 0.8828829, 'binary_f1_score': 0.8411215}
confusion matrix:
     0    1
0  196   26
1   42  180
early stop counter: 9
val acc:0.8350194692611694, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 21,now: 2024-07-29 05:06:23.827608,epoch time: 0:01:27.856842,used: 0:33:27.817893,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957564, 'recall': 0.9957847, 'specificity': 0.9957847, 'f1': 0.99576795, 'auroc': 0.99989104, 'binary_precision': 0.99741435, 'binary_recall': 0.994201, 'binary_specificity': 0.9973684, 'binary_f1_score': 0.99580514}
confusion matrix:
      0     1
0  1516     4
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.8498055, 'precision': 0.86166525, 'recall': 0.8491712, 'specificity': 0.8491712, 'f1': 0.8483937, 'auroc': 0.91974056, 'binary_precision': 0.92543024, 'binary_recall': 0.7586207, 'binary_specificity': 0.93972176, 'binary_f1_score': 0.833764}
confusion matrix:
     0    1
0  608   39
1  154  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8220721, 'precision': 0.8385662, 'recall': 0.822072, 'specificity': 0.822072, 'f1': 0.81987834, 'auroc': 0.9036198, 'binary_precision': 0.9132948, 'binary_recall': 0.7117117, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  207   15
1   64  158
early stop counter: 10
val acc:0.849805474281311, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 22,now: 2024-07-29 05:07:58.839189,epoch time: 0:01:35.011581,used: 0:35:02.829474,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.99575526, 'recall': 0.9957857, 'specificity': 0.9957857, 'f1': 0.99576783, 'auroc': 0.9998991, 'binary_precision': 0.997416, 'binary_recall': 0.99420476, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.99580777}
confusion matrix:
      0     1
0  1515     4
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.71284044, 'precision': 0.7981681, 'recall': 0.71095675, 'specificity': 0.71095675, 'f1': 0.6895447, 'auroc': 0.9004787, 'binary_precision': 0.9559322, 'binary_recall': 0.44200626, 'binary_specificity': 0.9799073, 'binary_f1_score': 0.6045016}
confusion matrix:
     0    1
0  634   13
1  356  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5900901, 'precision': 0.74251693, 'recall': 0.5900901, 'specificity': 0.5900901, 'f1': 0.5136736, 'auroc': 0.8850337, 'binary_precision': 0.9347826, 'binary_recall': 0.1936937, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.32089552}
confusion matrix:
     0   1
0  219   3
1  179  43
early stop counter: 11
val acc:0.7128404378890991, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 23,now: 2024-07-29 05:09:36.255746,epoch time: 0:01:37.416557,used: 0:36:40.246031,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99161184, 'recall': 0.99148685, 'specificity': 0.99148685, 'f1': 0.9915342, 'auroc': 0.99977326, 'binary_precision': 0.9878749, 'binary_recall': 0.9954984, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.991672}
confusion matrix:
      0     1
0  1498    19
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.8412451, 'precision': 0.84479094, 'recall': 0.8408885, 'specificity': 0.8408885, 'f1': 0.84073114, 'auroc': 0.9081098, 'binary_precision': 0.8780488, 'binary_recall': 0.78996867, 'binary_specificity': 0.89180833, 'binary_f1_score': 0.8316832}
confusion matrix:
     0    1
0  577   70
1  134  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8085586, 'precision': 0.80931795, 'recall': 0.8085586, 'specificity': 0.8085586, 'f1': 0.808441, 'auroc': 0.8841815, 'binary_precision': 0.7939914, 'binary_recall': 0.8333333, 'binary_specificity': 0.7837838, 'binary_f1_score': 0.8131868}
confusion matrix:
     0    1
0  174   48
1   37  185
early stop counter: 12
val acc:0.8412451148033142, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 24,now: 2024-07-29 05:11:13.894345,epoch time: 0:01:37.638599,used: 0:38:17.884630,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934828, 'recall': 0.9935497, 'specificity': 0.9935497, 'f1': 0.9934893, 'auroc': 0.99987996, 'binary_precision': 0.9986996, 'binary_recall': 0.98841697, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9935317}
confusion matrix:
      0     1
0  1516     2
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.72684824, 'precision': 0.8135753, 'recall': 0.72499794, 'specificity': 0.72499794, 'f1': 0.7054963, 'auroc': 0.91898227, 'binary_precision': 0.9767442, 'binary_recall': 0.46081504, 'binary_specificity': 0.98918086, 'binary_f1_score': 0.62619805}
confusion matrix:
     0    1
0  640    7
1  344  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6373874, 'precision': 0.7748529, 'recall': 0.6373874, 'specificity': 0.6373874, 'f1': 0.5855688, 'auroc': 0.9082258, 'binary_precision': 0.9692308, 'binary_recall': 0.2837838, 'binary_specificity': 0.990991, 'binary_f1_score': 0.4390244}
confusion matrix:
     0   1
0  220   2
1  159  63
early stop counter: 13
val acc:0.7268482446670532, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 25,now: 2024-07-29 05:12:50.945783,epoch time: 0:01:37.051438,used: 0:39:54.936068,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98813343, 'recall': 0.9880645, 'specificity': 0.9880645, 'f1': 0.98795563, 'auroc': 0.9997609, 'binary_precision': 1.0, 'binary_recall': 0.97612906, 'binary_specificity': 1.0, 'binary_f1_score': 0.98792034}
confusion matrix:
      0     1
0  1522     0
1    37  1513
---- Validation: 
scalar performance:
{'acc': 0.66459143, 'precision': 0.78491473, 'recall': 0.662302, 'specificity': 0.662302, 'f1': 0.6231771, 'auroc': 0.8947396, 'binary_precision': 0.9683258, 'binary_recall': 0.3354232, 'binary_specificity': 0.98918086, 'binary_f1_score': 0.4982538}
confusion matrix:
     0    1
0  640    7
1  424  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5788288, 'precision': 0.77139366, 'recall': 0.5788288, 'specificity': 0.5788288, 'f1': 0.48800927, 'auroc': 0.884567, 'binary_precision': 1.0, 'binary_recall': 0.15765765, 'binary_specificity': 1.0, 'binary_f1_score': 0.27237353}
confusion matrix:
     0   1
0  222   0
1  187  35
early stop counter: 14
val acc:0.6645914316177368, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 26,now: 2024-07-29 05:14:28.363552,epoch time: 0:01:37.417769,used: 0:41:32.353837,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99217474, 'recall': 0.9922298, 'specificity': 0.9922298, 'f1': 0.99218714, 'auroc': 0.999758, 'binary_precision': 0.99610645, 'binary_recall': 0.9884095, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.99224305}
confusion matrix:
      0     1
0  1513     6
1    18  1535
---- Validation: 
scalar performance:
{'acc': 0.7610895, 'precision': 0.81215674, 'recall': 0.759666, 'specificity': 0.759666, 'f1': 0.75022495, 'auroc': 0.9067992, 'binary_precision': 0.9366755, 'binary_recall': 0.55642635, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.6981318}
confusion matrix:
     0    1
0  623   24
1  283  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5878378, 'precision': 0.7236631, 'recall': 0.5878378, 'specificity': 0.5878378, 'f1': 0.5140634, 'auroc': 0.85839224, 'binary_precision': 0.8979592, 'binary_recall': 0.1981982, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.32472327}
confusion matrix:
     0   1
0  217   5
1  178  44
early stop counter: 15
val acc:0.7610895037651062, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 27,now: 2024-07-29 05:16:06.784115,epoch time: 0:01:38.420563,used: 0:43:10.774400,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9901472, 'recall': 0.9898162, 'specificity': 0.9898162, 'f1': 0.9899052, 'auroc': 0.9999174, 'binary_precision': 0.98163396, 'binary_recall': 0.99871135, 'binary_specificity': 0.98092103, 'binary_f1_score': 0.9900991}
confusion matrix:
      0     1
0  1491    29
1     2  1550
---- Validation: 
scalar performance:
{'acc': 0.8381323, 'precision': 0.8497788, 'recall': 0.8374921, 'specificity': 0.8374921, 'f1': 0.83658594, 'auroc': 0.9093253, 'binary_precision': 0.9118774, 'binary_recall': 0.74608153, 'binary_specificity': 0.9289026, 'binary_f1_score': 0.8206896}
confusion matrix:
     0    1
0  601   46
1  162  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8243243, 'precision': 0.8463639, 'recall': 0.82432437, 'specificity': 0.82432437, 'f1': 0.8214845, 'auroc': 0.91135055, 'binary_precision': 0.93373495, 'binary_recall': 0.6981982, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.79896903}
confusion matrix:
     0    1
0  211   11
1   67  155
early stop counter: 16
val acc:0.8381323218345642, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 28,now: 2024-07-29 05:17:35.704833,epoch time: 0:01:28.920718,used: 0:44:39.695118,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97813773, 'recall': 0.9769945, 'specificity': 0.9769945, 'f1': 0.97719216, 'auroc': 0.9993006, 'binary_precision': 0.95970243, 'binary_recall': 0.9967804, 'binary_specificity': 0.9572087, 'binary_f1_score': 0.9778901}
confusion matrix:
      0     1
0  1454    65
1     5  1548
---- Validation: 
scalar performance:
{'acc': 0.8599222, 'precision': 0.85997856, 'recall': 0.85996985, 'specificity': 0.85996985, 'f1': 0.8599221, 'auroc': 0.92159617, 'binary_precision': 0.85339504, 'binary_recall': 0.86677116, 'binary_specificity': 0.8531685, 'binary_f1_score': 0.8600311}
confusion matrix:
     0    1
0  552   95
1   85  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8513514, 'precision': 0.8513514, 'recall': 0.8513514, 'specificity': 0.8513514, 'f1': 0.8513514, 'auroc': 0.92386985, 'binary_precision': 0.8513514, 'binary_recall': 0.8513514, 'binary_specificity': 0.8513514, 'binary_f1_score': 0.8513514}
confusion matrix:
     0    1
0  189   33
1   33  189
early stop counter: 17
val acc:0.8599221706390381, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 29,now: 2024-07-29 05:19:08.076158,epoch time: 0:01:32.371325,used: 0:46:12.066443,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9922324, 'recall': 0.9921523, 'specificity': 0.9921523, 'f1': 0.9921856, 'auroc': 0.9998144, 'binary_precision': 0.9897698, 'binary_recall': 0.9948586, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99230766}
confusion matrix:
      0     1
0  1500    16
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.7945525, 'precision': 0.8127199, 'recall': 0.793703, 'specificity': 0.793703, 'f1': 0.7911927, 'auroc': 0.9033058, 'binary_precision': 0.8863636, 'binary_recall': 0.67241377, 'binary_specificity': 0.9149923, 'binary_f1_score': 0.7647059}
confusion matrix:
     0    1
0  592   55
1  209  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.795045, 'precision': 0.8158684, 'recall': 0.795045, 'specificity': 0.795045, 'f1': 0.7916106, 'auroc': 0.8788096, 'binary_precision': 0.8969697, 'binary_recall': 0.6666667, 'binary_specificity': 0.9234234, 'binary_f1_score': 0.7648579}
confusion matrix:
     0    1
0  205   17
1   74  148
early stop counter: 18
val acc:0.7945525050163269, best validation acc: 0.8607003688812256, corresponding to test acc:                         0.8040540814399719 / 0.8603603839874268
after epoch: 30,now: 2024-07-29 05:20:45.712893,epoch time: 0:01:37.636735,used: 0:47:49.703178,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_04_32_55_seed_6_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:49.703178 at 2024-07-29 05:20:45.712893
persisted model performance metric: 

scalar performance:
{'acc': 0.8040541, 'precision': 0.82551324, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.8007705, 'auroc': 0.9110056, 'binary_precision': 0.90909094, 'binary_recall': 0.6756757, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.7751938}
confusion matrix:
     0    1
0  207   15
1   72  150
oracle model performance metric: 

scalar performance:
{'acc': 0.8603604, 'precision': 0.875095, 'recall': 0.8603604, 'specificity': 0.8603604, 'f1': 0.8589754, 'auroc': 0.9169102, 'binary_precision': 0.9494382, 'binary_recall': 0.7612613, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  213    9
1   53  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456803 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool | 416208 KiB |  13182 MiB | 508915 GiB | 508914 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456803 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool | 416208 KiB |  13182 MiB | 508915 GiB | 508914 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 507475 GiB | 507474 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14488 MiB |  95978 MiB |  81500 MiB |
|       from large pool |  14412 MiB |  14422 MiB |  95812 MiB |  81400 MiB |
|       from small pool |     66 MiB |     70 MiB |    166 MiB |    100 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475036 KiB |   1260 MiB | 368219 GiB | 368219 GiB |
|       from large pool | 462384 KiB |   1252 MiB | 362091 GiB | 362091 GiB |
|       from small pool |  12652 KiB |     45 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90477 K  |   90476 K  |
|       from large pool |     187    |    1413    |   45954 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44523 K  |   44521 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90477 K  |   90476 K  |
|       from large pool |     187    |    1413    |   45954 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44523 K  |   44521 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    4069    |    3433    |
|       from large pool |     603    |     603    |    3986    |    3383    |
|       from small pool |      33    |      35    |      83    |      50    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     652    |   60205 K  |   60205 K  |
|       from large pool |      39    |     605    |   34096 K  |   34096 K  |
|       from small pool |      60    |     236    |   26109 K  |   26109 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507475 GiB | 507475 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB |  95978 MiB |  95068 MiB |
|       from large pool |    858 MiB |  14422 MiB |  95812 MiB |  94954 MiB |
|       from small pool |     52 MiB |     70 MiB |    166 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 368219 GiB | 368219 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 362092 GiB | 362091 GiB |
|       from small pool |      0 KiB |     45 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90477 K  |   90477 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44523 K  |   44523 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90477 K  |   90477 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44523 K  |   44523 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    4069    |    4004    |
|       from large pool |      39    |     603    |    3986    |    3947    |
|       from small pool |      26    |      35    |      83    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   60206 K  |   60206 K  |
|       from large pool |       3    |     605    |   34096 K  |   34096 K  |
|       from small pool |       0    |     236    |   26109 K  |   26109 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 515004 GiB | 515004 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 508915 GiB | 508915 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507475 GiB | 507475 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14488 MiB |  95978 MiB |  95068 MiB |
|       from large pool |    858 MiB |  14422 MiB |  95812 MiB |  94954 MiB |
|       from small pool |     52 MiB |     70 MiB |    166 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 368219 GiB | 368219 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 362092 GiB | 362091 GiB |
|       from small pool |      0 KiB |     45 MiB |   6127 GiB |   6127 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90477 K  |   90477 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44523 K  |   44523 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90477 K  |   90477 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44523 K  |   44523 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    4069    |    4004    |
|       from large pool |      39    |     603    |    3986    |    3947    |
|       from small pool |      26    |      35    |      83    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   60206 K  |   60206 K  |
|       from large pool |       3    |     605    |   34096 K  |   34096 K  |
|       from small pool |       0    |     236    |   26109 K  |   26109 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367

 Experiment start at: 2024-07-29 05:21:34.349357
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9404297, 'precision': 0.9411467, 'recall': 0.9401455, 'specificity': 0.9401455, 'f1': 0.9403652, 'auroc': 0.98665583, 'binary_precision': 0.9268444, 'binary_recall': 0.9583333, 'binary_specificity': 0.9219577, 'binary_f1_score': 0.94232583}
confusion matrix:
      0     1
0  1394   118
1    65  1495
---- Validation: 
scalar performance:
{'acc': 0.85, 'precision': 0.8501662, 'recall': 0.8498106, 'specificity': 0.8498106, 'f1': 0.8499033, 'auroc': 0.90208805, 'binary_precision': 0.8548644, 'binary_recall': 0.8375, 'binary_specificity': 0.8621212, 'binary_f1_score': 0.8460931}
confusion matrix:
     0    1
0  569   91
1  104  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.83842796, 'recall': 0.83842796, 'specificity': 0.83842796, 'f1': 0.83842796, 'auroc': 0.92355216, 'binary_precision': 0.83842796, 'binary_recall': 0.83842796, 'binary_specificity': 0.83842796, 'binary_f1_score': 0.83842796}
confusion matrix:
     0    1
0  192   37
1   37  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 05:23:16.972357,epoch time: 0:01:42.623000,used: 0:01:42.623000,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9375, 'precision': 0.9427337, 'recall': 0.9383903, 'specificity': 0.9383903, 'f1': 0.93738794, 'auroc': 0.99322295, 'binary_precision': 0.99493486, 'binary_recall': 0.88141024, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.9347383}
confusion matrix:
      0     1
0  1505     7
1   185  1375
---- Validation: 
scalar performance:
{'acc': 0.6176923, 'precision': 0.7578267, 'recall': 0.6119318, 'specificity': 0.6119318, 'f1': 0.5516305, 'auroc': 0.8624598, 'binary_precision': 0.94409937, 'binary_recall': 0.2375, 'binary_specificity': 0.98636365, 'binary_f1_score': 0.37952557}
confusion matrix:
     0    1
0  651    9
1  488  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.8631581, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.81052005, 'auroc': 0.9324765, 'binary_precision': 0.99319726, 'binary_recall': 0.6375546, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.7765957}
confusion matrix:
     0    1
0  228    1
1   83  146
early stop counter: 1
val acc:0.6176922917366028, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8384279608726501
after epoch: 2,now: 2024-07-29 05:24:55.380291,epoch time: 0:01:38.407934,used: 0:03:21.030934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.9698309, 'recall': 0.96917987, 'specificity': 0.96917987, 'f1': 0.96874523, 'auroc': 0.99630094, 'binary_precision': 0.99660784, 'binary_recall': 0.94166666, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9683586}
confusion matrix:
      0     1
0  1507     5
1    91  1469
---- Validation: 
scalar performance:
{'acc': 0.7907692, 'precision': 0.82471406, 'recall': 0.7882576, 'specificity': 0.7882576, 'f1': 0.7841291, 'auroc': 0.8977865, 'binary_precision': 0.9259259, 'binary_recall': 0.625, 'binary_specificity': 0.95151514, 'binary_f1_score': 0.74626863}
confusion matrix:
     0    1
0  628   32
1  240  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.85762745, 'recall': 0.8296943, 'specificity': 0.8296943, 'f1': 0.8263025, 'auroc': 0.9197765, 'binary_precision': 0.95757574, 'binary_recall': 0.6899563, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.80203044}
confusion matrix:
     0    1
0  222    7
1   71  158
early stop counter: 2
val acc:0.7907692193984985, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8384279608726501
after epoch: 3,now: 2024-07-29 05:26:30.868512,epoch time: 0:01:35.488221,used: 0:04:56.519155,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97074467, 'recall': 0.97065526, 'specificity': 0.97065526, 'f1': 0.97069335, 'auroc': 0.9965079, 'binary_precision': 0.96875, 'binary_recall': 0.9737179, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.9712276}
confusion matrix:
      0     1
0  1463    49
1    41  1519
---- Validation: 
scalar performance:
{'acc': 0.83153844, 'precision': 0.8376262, 'recall': 0.8304924, 'specificity': 0.8304924, 'f1': 0.8304323, 'auroc': 0.89668083, 'binary_precision': 0.87927926, 'binary_recall': 0.7625, 'binary_specificity': 0.8984848, 'binary_f1_score': 0.81673646}
confusion matrix:
     0    1
0  593   67
1  152  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886463, 'precision': 0.88990283, 'recall': 0.8886463, 'specificity': 0.8886463, 'f1': 0.88855654, 'auroc': 0.9380065, 'binary_precision': 0.912037, 'binary_recall': 0.86026204, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.88539326}
confusion matrix:
     0    1
0  210   19
1   32  197
new oracle model saved
early stop counter: 3
val acc:0.8315384387969971, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 4,now: 2024-07-29 05:28:06.416344,epoch time: 0:01:35.547832,used: 0:06:32.066987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9733627, 'recall': 0.9730159, 'specificity': 0.9730159, 'f1': 0.9726546, 'auroc': 0.9975669, 'binary_precision': 0.99596775, 'binary_recall': 0.95, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.972441}
confusion matrix:
      0     1
0  1506     6
1    78  1482
---- Validation: 
scalar performance:
{'acc': 0.64076924, 'precision': 0.74386096, 'recall': 0.6356771, 'specificity': 0.6356771, 'f1': 0.5935735, 'auroc': 0.81826586, 'binary_precision': 0.8986175, 'binary_recall': 0.3046875, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.45507583}
confusion matrix:
     0    1
0  638   22
1  445  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80131006, 'precision': 0.8397188, 'recall': 0.80131006, 'specificity': 0.80131006, 'f1': 0.79553074, 'auroc': 0.9238764, 'binary_precision': 0.95394737, 'binary_recall': 0.6331878, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.7611549}
confusion matrix:
     0    1
0  222    7
1   84  145
early stop counter: 4
val acc:0.6407692432403564, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 5,now: 2024-07-29 05:29:41.135183,epoch time: 0:01:34.718839,used: 0:08:06.785826,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9724096, 'recall': 0.97229344, 'specificity': 0.97229344, 'f1': 0.9720049, 'auroc': 0.9975529, 'binary_precision': 0.9906791, 'binary_recall': 0.95384616, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.97191375}
confusion matrix:
      0     1
0  1498    14
1    72  1488
---- Validation: 
scalar performance:
{'acc': 0.6430769, 'precision': 0.7226666, 'recall': 0.63837594, 'specificity': 0.63837594, 'f1': 0.6036533, 'auroc': 0.79598725, 'binary_precision': 0.852, 'binary_recall': 0.3328125, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.47865167}
confusion matrix:
     0    1
0  623   37
1  427  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.84352016, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.8329109, 'auroc': 0.9175454, 'binary_precision': 0.90052354, 'binary_recall': 0.7510917, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8190476}
confusion matrix:
     0    1
0  210   19
1   57  172
early stop counter: 5
val acc:0.6430768966674805, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 6,now: 2024-07-29 05:31:11.720915,epoch time: 0:01:30.585732,used: 0:09:37.371558,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98282003, 'recall': 0.98268723, 'specificity': 0.98268723, 'f1': 0.982741, 'auroc': 0.9992034, 'binary_precision': 0.9796308, 'binary_recall': 0.98653847, 'binary_specificity': 0.978836, 'binary_f1_score': 0.98307246}
confusion matrix:
      0     1
0  1480    32
1    21  1539
---- Validation: 
scalar performance:
{'acc': 0.84923077, 'precision': 0.8533966, 'recall': 0.8483901, 'specificity': 0.8483901, 'f1': 0.84853673, 'auroc': 0.8963542, 'binary_precision': 0.8881119, 'binary_recall': 0.79375, 'binary_specificity': 0.9030303, 'binary_f1_score': 0.83828384}
confusion matrix:
     0    1
0  596   64
1  132  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88209605, 'precision': 0.88503295, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.88187087, 'auroc': 0.9429263, 'binary_precision': 0.9186603, 'binary_recall': 0.83842796, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8767124}
confusion matrix:
     0    1
0  212   17
1   37  192
early stop counter: 6
val acc:0.8492307662963867, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 7,now: 2024-07-29 05:32:47.946537,epoch time: 0:01:36.225622,used: 0:11:13.597180,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853225, 'recall': 0.9854243, 'specificity': 0.9854243, 'f1': 0.98534983, 'auroc': 0.9985391, 'binary_precision': 0.99029124, 'binary_recall': 0.9807692, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.9855072}
confusion matrix:
      0     1
0  1497    15
1    30  1530
---- Validation: 
scalar performance:
{'acc': 0.8138462, 'precision': 0.82532054, 'recall': 0.8123816, 'specificity': 0.8123816, 'f1': 0.81166196, 'auroc': 0.8806398, 'binary_precision': 0.88269234, 'binary_recall': 0.7171875, 'binary_specificity': 0.9075758, 'binary_f1_score': 0.79137933}
confusion matrix:
     0    1
0  599   61
1  181  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.8674368, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.85957646, 'auroc': 0.94058084, 'binary_precision': 0.9187817, 'binary_recall': 0.790393, 'binary_specificity': 0.930131, 'binary_f1_score': 0.84976524}
confusion matrix:
     0    1
0  213   16
1   48  181
early stop counter: 7
val acc:0.8138461709022522, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 8,now: 2024-07-29 05:34:17.554955,epoch time: 0:01:29.608418,used: 0:12:43.205598,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863111, 'recall': 0.9864266, 'specificity': 0.9864266, 'f1': 0.98632705, 'auroc': 0.9991962, 'binary_precision': 0.99285716, 'binary_recall': 0.9801282, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.9864516}
confusion matrix:
      0     1
0  1501    11
1    31  1529
---- Validation: 
scalar performance:
{'acc': 0.7623077, 'precision': 0.7840899, 'recall': 0.76013255, 'specificity': 0.76013255, 'f1': 0.75660425, 'auroc': 0.86298776, 'binary_precision': 0.8590022, 'binary_recall': 0.61875, 'binary_specificity': 0.9015151, 'binary_f1_score': 0.719346}
confusion matrix:
     0    1
0  595   65
1  244  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.8537185, 'recall': 0.85371184, 'specificity': 0.85371184, 'f1': 0.8537111, 'auroc': 0.94141984, 'binary_precision': 0.8552632, 'binary_recall': 0.8515284, 'binary_specificity': 0.8558952, 'binary_f1_score': 0.8533917}
confusion matrix:
     0    1
0  196   33
1   34  195
early stop counter: 8
val acc:0.7623077034950256, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 9,now: 2024-07-29 05:35:52.341327,epoch time: 0:01:34.786372,used: 0:14:17.991970,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873504, 'recall': 0.9874593, 'specificity': 0.9874593, 'f1': 0.98730433, 'auroc': 0.9996295, 'binary_precision': 0.9973839, 'binary_recall': 0.9775641, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9873746}
confusion matrix:
      0     1
0  1508     4
1    35  1525
---- Validation: 
scalar performance:
{'acc': 0.81461537, 'precision': 0.8445556, 'recall': 0.8123343, 'specificity': 0.8123343, 'f1': 0.8096967, 'auroc': 0.9116359, 'binary_precision': 0.9423503, 'binary_recall': 0.6640625, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.7791017}
confusion matrix:
     0    1
0  634   26
1  215  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.87594366, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8392512, 'auroc': 0.9284148, 'binary_precision': 0.9875776, 'binary_recall': 0.6943231, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.81538457}
confusion matrix:
     0    1
0  227    2
1   70  159
early stop counter: 9
val acc:0.8146153688430786, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 10,now: 2024-07-29 05:37:30.537276,epoch time: 0:01:38.195949,used: 0:15:56.187919,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9866214, 'recall': 0.98618233, 'specificity': 0.98618233, 'f1': 0.9863198, 'auroc': 0.99920213, 'binary_precision': 0.9779597, 'binary_recall': 0.99551284, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.98665816}
confusion matrix:
      0     1
0  1477    35
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.82153845, 'precision': 0.8368031, 'recall': 0.8198863, 'specificity': 0.8198863, 'f1': 0.8189311, 'auroc': 0.8919413, 'binary_precision': 0.9047619, 'binary_recall': 0.7125, 'binary_specificity': 0.92727274, 'binary_f1_score': 0.79720277}
confusion matrix:
     0    1
0  612   48
1  184  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87117904, 'precision': 0.89390075, 'recall': 0.87117904, 'specificity': 0.87117904, 'f1': 0.8692941, 'auroc': 0.94878054, 'binary_precision': 0.9885057, 'binary_recall': 0.7510917, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.853598}
confusion matrix:
     0    1
0  227    2
1   57  172
early stop counter: 10
val acc:0.8215384483337402, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 11,now: 2024-07-29 05:39:12.770181,epoch time: 0:01:42.232905,used: 0:17:38.420824,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874275, 'recall': 0.9875, 'specificity': 0.9875, 'f1': 0.98730457, 'auroc': 0.99944246, 'binary_precision': 1.0, 'binary_recall': 0.975, 'binary_specificity': 1.0, 'binary_f1_score': 0.98734176}
confusion matrix:
      0     1
0  1512     0
1    39  1521
---- Validation: 
scalar performance:
{'acc': 0.7753846, 'precision': 0.8205885, 'recall': 0.77246684, 'specificity': 0.77246684, 'f1': 0.765875, 'auroc': 0.8948153, 'binary_precision': 0.93718594, 'binary_recall': 0.5828125, 'binary_specificity': 0.9621212, 'binary_f1_score': 0.7186898}
confusion matrix:
     0    1
0  635   25
1  267  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7947598, 'precision': 0.85149056, 'recall': 0.7947598, 'specificity': 0.7947598, 'f1': 0.78613013, 'auroc': 0.94733125, 'binary_precision': 0.99270076, 'binary_recall': 0.59388644, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.74316937}
confusion matrix:
     0    1
0  228    1
1   93  136
early stop counter: 11
val acc:0.7753846049308777, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 12,now: 2024-07-29 05:40:48.999822,epoch time: 0:01:36.229641,used: 0:19:14.650465,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.9699055, 'recall': 0.9684066, 'specificity': 0.9684066, 'f1': 0.96870685, 'auroc': 0.99770343, 'binary_precision': 0.9501845, 'binary_recall': 0.99038464, 'binary_specificity': 0.9464286, 'binary_f1_score': 0.9698682}
confusion matrix:
      0     1
0  1431    81
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.74538463, 'precision': 0.7455301, 'recall': 0.7450994, 'specificity': 0.7450994, 'f1': 0.7451552, 'auroc': 0.7996496, 'binary_precision': 0.7487923, 'binary_recall': 0.7265625, 'binary_specificity': 0.76363635, 'binary_f1_score': 0.7375099}
confusion matrix:
     0    1
0  504  156
1  175  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.768559, 'precision': 0.79801935, 'recall': 0.768559, 'specificity': 0.768559, 'f1': 0.76269436, 'auroc': 0.8275204, 'binary_precision': 0.70431894, 'binary_recall': 0.9257642, 'binary_specificity': 0.6113537, 'binary_f1_score': 0.8000001}
confusion matrix:
     0    1
0  140   89
1   17  212
early stop counter: 12
val acc:0.7453846335411072, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 13,now: 2024-07-29 05:42:22.400383,epoch time: 0:01:33.400561,used: 0:20:48.051026,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9875516, 'recall': 0.9871744, 'specificity': 0.9871744, 'f1': 0.98729753, 'auroc': 0.9995476, 'binary_precision': 0.9798107, 'binary_recall': 0.99551284, 'binary_specificity': 0.978836, 'binary_f1_score': 0.9875994}
confusion matrix:
      0     1
0  1480    32
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.84, 'precision': 0.84061885, 'recall': 0.8396543, 'specificity': 0.8396543, 'f1': 0.8397994, 'auroc': 0.8957386, 'binary_precision': 0.85179156, 'binary_recall': 0.8171875, 'binary_specificity': 0.8621212, 'binary_f1_score': 0.8341308}
confusion matrix:
     0    1
0  569   91
1  117  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87772924, 'precision': 0.8779887, 'recall': 0.87772924, 'specificity': 0.87772924, 'f1': 0.87770826, 'auroc': 0.9415724, 'binary_precision': 0.88789237, 'binary_recall': 0.8646288, 'binary_specificity': 0.8908297, 'binary_f1_score': 0.87610614}
confusion matrix:
     0    1
0  204   25
1   31  198
early stop counter: 13
val acc:0.8399999737739563, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 14,now: 2024-07-29 05:44:02.011057,epoch time: 0:01:39.610674,used: 0:22:27.661700,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.98987806, 'recall': 0.98997253, 'specificity': 0.98997253, 'f1': 0.98990756, 'auroc': 0.9992691, 'binary_precision': 0.9941823, 'binary_recall': 0.9858974, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.99002254}
confusion matrix:
      0     1
0  1503     9
1    22  1538
---- Validation: 
scalar performance:
{'acc': 0.80153847, 'precision': 0.8121276, 'recall': 0.8000947, 'specificity': 0.8000947, 'f1': 0.7992766, 'auroc': 0.88086176, 'binary_precision': 0.8659004, 'binary_recall': 0.70625, 'binary_specificity': 0.8939394, 'binary_f1_score': 0.777969}
confusion matrix:
     0    1
0  590   70
1  188  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886463, 'precision': 0.89333415, 'recall': 0.8886463, 'specificity': 0.8886463, 'f1': 0.88831353, 'auroc': 0.94296443, 'binary_precision': 0.9362745, 'binary_recall': 0.83406115, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.8822171}
confusion matrix:
     0    1
0  216   13
1   38  191
early stop counter: 14
val acc:0.8015384674072266, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 15,now: 2024-07-29 05:45:37.007631,epoch time: 0:01:34.996574,used: 0:24:02.658274,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9892282, 'recall': 0.98930097, 'specificity': 0.98930097, 'f1': 0.9892561, 'auroc': 0.9996134, 'binary_precision': 0.9922631, 'binary_recall': 0.98653847, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9893925}
confusion matrix:
      0     1
0  1500    12
1    21  1539
---- Validation: 
scalar performance:
{'acc': 0.7661539, 'precision': 0.81779176, 'recall': 0.7630208, 'specificity': 0.7630208, 'f1': 0.7547779, 'auroc': 0.9004853, 'binary_precision': 0.94210523, 'binary_recall': 0.559375, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.7019608}
confusion matrix:
     0    1
0  638   22
1  282  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7532751, 'precision': 0.83479536, 'recall': 0.7532751, 'specificity': 0.7532751, 'f1': 0.73728263, 'auroc': 0.9463016, 'binary_precision': 1.0, 'binary_recall': 0.5065502, 'binary_specificity': 1.0, 'binary_f1_score': 0.6724638}
confusion matrix:
     0    1
0  229    0
1  113  116
early stop counter: 15
val acc:0.766153872013092, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 16,now: 2024-07-29 05:47:12.032385,epoch time: 0:01:35.024754,used: 0:25:37.683028,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9840142, 'recall': 0.9835775, 'specificity': 0.9835775, 'f1': 0.983714, 'auroc': 0.9993136, 'binary_precision': 0.9754408, 'binary_recall': 0.9929487, 'binary_specificity': 0.9742063, 'binary_f1_score': 0.98411685}
confusion matrix:
      0     1
0  1473    39
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.8292308, 'precision': 0.8489916, 'recall': 0.8273911, 'specificity': 0.8273911, 'f1': 0.82618815, 'auroc': 0.911659, 'binary_precision': 0.9282787, 'binary_recall': 0.7078125, 'binary_specificity': 0.9469697, 'binary_f1_score': 0.8031915}
confusion matrix:
     0    1
0  625   35
1  187  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.779476, 'precision': 0.8405838, 'recall': 0.779476, 'specificity': 0.779476, 'f1': 0.76911986, 'auroc': 0.9326862, 'binary_precision': 0.9848485, 'binary_recall': 0.5676856, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7202216}
confusion matrix:
     0    1
0  227    2
1   99  130
early stop counter: 16
val acc:0.829230785369873, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 17,now: 2024-07-29 05:48:42.019838,epoch time: 0:01:29.987453,used: 0:27:07.670481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909531, 'recall': 0.9908323, 'specificity': 0.9908323, 'f1': 0.99088216, 'auroc': 0.9997244, 'binary_precision': 0.9878981, 'binary_recall': 0.99423075, 'binary_specificity': 0.98743385, 'binary_f1_score': 0.9910543}
confusion matrix:
      0     1
0  1493    19
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.8038462, 'precision': 0.8288511, 'recall': 0.8017045, 'specificity': 0.8017045, 'f1': 0.7992358, 'auroc': 0.89899385, 'binary_precision': 0.9157667, 'binary_recall': 0.6625, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.76881236}
confusion matrix:
     0    1
0  621   39
1  216  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8318777, 'precision': 0.860959, 'recall': 0.8318777, 'specificity': 0.8318777, 'f1': 0.82842183, 'auroc': 0.9322095, 'binary_precision': 0.9634146, 'binary_recall': 0.6899563, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.80407125}
confusion matrix:
     0    1
0  223    6
1   71  158
early stop counter: 17
val acc:0.8038461804389954, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 18,now: 2024-07-29 05:50:20.031508,epoch time: 0:01:38.011670,used: 0:28:45.682151,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99155736, 'recall': 0.991514, 'specificity': 0.991514, 'f1': 0.991534, 'auroc': 0.99976087, 'binary_precision': 0.9904092, 'binary_recall': 0.9929487, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.99167734}
confusion matrix:
      0     1
0  1497    15
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.83, 'precision': 0.8469361, 'recall': 0.8282907, 'specificity': 0.8282907, 'f1': 0.8273519, 'auroc': 0.9032972, 'binary_precision': 0.9198397, 'binary_recall': 0.7171875, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.80597013}
confusion matrix:
     0    1
0  620   40
1  181  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87554586, 'precision': 0.8935652, 'recall': 0.87554586, 'specificity': 0.87554586, 'f1': 0.87410486, 'auroc': 0.94647324, 'binary_precision': 0.9777778, 'binary_recall': 0.768559, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.8606357}
confusion matrix:
     0    1
0  225    4
1   53  176
early stop counter: 18
val acc:0.8299999833106995, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 19,now: 2024-07-29 05:51:50.135489,epoch time: 0:01:30.103981,used: 0:30:15.786132,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98718214, 'recall': 0.9868641, 'specificity': 0.9868641, 'f1': 0.9869724, 'auroc': 0.9996439, 'binary_precision': 0.98040456, 'binary_recall': 0.99423075, 'binary_specificity': 0.9794974, 'binary_f1_score': 0.9872692}
confusion matrix:
      0     1
0  1481    31
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.83, 'precision': 0.837566, 'recall': 0.82883525, 'specificity': 0.82883525, 'f1': 0.8286592, 'auroc': 0.90867186, 'binary_precision': 0.88440365, 'binary_recall': 0.753125, 'binary_specificity': 0.9045454, 'binary_f1_score': 0.81350213}
confusion matrix:
     0    1
0  597   63
1  158  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.8807982, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.8727412, 'auroc': 0.94296443, 'binary_precision': 0.93401015, 'binary_recall': 0.80349344, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.8638498}
confusion matrix:
     0    1
0  216   13
1   45  184
early stop counter: 19
val acc:0.8299999833106995, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 20,now: 2024-07-29 05:53:29.396436,epoch time: 0:01:39.260947,used: 0:31:55.047079,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937898, 'recall': 0.99390006, 'specificity': 0.99390006, 'f1': 0.99381447, 'auroc': 0.99977493, 'binary_precision': 0.9993519, 'binary_recall': 0.98846155, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9938769}
confusion matrix:
      0     1
0  1511     1
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.77615386, 'precision': 0.8284066, 'recall': 0.7730587, 'specificity': 0.7730587, 'f1': 0.7655075, 'auroc': 0.9114009, 'binary_precision': 0.95561355, 'binary_recall': 0.571875, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.71554255}
confusion matrix:
     0    1
0  643   17
1  274  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7467249, 'precision': 0.831884, 'recall': 0.7467249, 'specificity': 0.7467249, 'f1': 0.72936404, 'auroc': 0.9523274, 'binary_precision': 1.0, 'binary_recall': 0.49344978, 'binary_specificity': 1.0, 'binary_f1_score': 0.6608187}
confusion matrix:
     0    1
0  229    0
1  116  113
early stop counter: 20
val acc:0.7761538624763489, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 21,now: 2024-07-29 05:55:01.365856,epoch time: 0:01:31.969420,used: 0:33:27.016499,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869902, 'recall': 0.98710823, 'specificity': 0.98710823, 'f1': 0.98697853, 'auroc': 0.9994111, 'binary_precision': 0.9954368, 'binary_recall': 0.97884613, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.9870717}
confusion matrix:
      0     1
0  1505     7
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.70384616, 'precision': 0.7914182, 'recall': 0.6995739, 'specificity': 0.6995739, 'f1': 0.67696655, 'auroc': 0.9094881, 'binary_precision': 0.94736844, 'binary_recall': 0.421875, 'binary_specificity': 0.97727275, 'binary_f1_score': 0.5837838}
confusion matrix:
     0    1
0  645   15
1  370  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6113537, 'precision': 0.7720475, 'recall': 0.6113537, 'specificity': 0.6113537, 'f1': 0.5440186, 'auroc': 0.9438988, 'binary_precision': 0.9811321, 'binary_recall': 0.22707424, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.36879435}
confusion matrix:
     0   1
0  228   1
1  177  52
early stop counter: 21
val acc:0.7038461565971375, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8886463046073914
after epoch: 22,now: 2024-07-29 05:56:40.280883,epoch time: 0:01:38.915027,used: 0:35:05.931526,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98899025, 'recall': 0.9884361, 'specificity': 0.9884361, 'f1': 0.9885988, 'auroc': 0.999805, 'binary_precision': 0.97865665, 'binary_recall': 0.99935895, 'binary_specificity': 0.97751325, 'binary_f1_score': 0.98889947}
confusion matrix:
      0     1
0  1478    34
1     1  1559
---- Validation: 
scalar performance:
{'acc': 0.8353846, 'precision': 0.83912134, 'recall': 0.8345644, 'specificity': 0.8345644, 'f1': 0.834661, 'auroc': 0.89775276, 'binary_precision': 0.87108016, 'binary_recall': 0.78125, 'binary_specificity': 0.8878788, 'binary_f1_score': 0.82372326}
confusion matrix:
     0    1
0  586   74
1  140  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8908297, 'precision': 0.89383376, 'recall': 0.8908297, 'specificity': 0.8908297, 'f1': 0.8906212, 'auroc': 0.94197285, 'binary_precision': 0.9282297, 'binary_recall': 0.8471616, 'binary_specificity': 0.93449783, 'binary_f1_score': 0.88584477}
confusion matrix:
     0    1
0  214   15
1   35  194
new oracle model saved
early stop counter: 22
val acc:0.8353846073150635, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 23,now: 2024-07-29 05:58:22.646401,epoch time: 0:01:42.365518,used: 0:36:48.297044,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98703307, 'recall': 0.98713875, 'specificity': 0.98713875, 'f1': 0.9869788, 'auroc': 0.9995378, 'binary_precision': 0.9973822, 'binary_recall': 0.97692305, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.98704666}
confusion matrix:
      0     1
0  1508     4
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.7253846, 'precision': 0.79900396, 'recall': 0.7215199, 'specificity': 0.7215199, 'f1': 0.7050935, 'auroc': 0.8976326, 'binary_precision': 0.94357365, 'binary_recall': 0.4703125, 'binary_specificity': 0.9727273, 'binary_f1_score': 0.6277372}
confusion matrix:
     0    1
0  642   18
1  339  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.779476, 'precision': 0.8469697, 'recall': 0.779476, 'specificity': 0.779476, 'f1': 0.7682035, 'auroc': 0.94344115, 'binary_precision': 1.0, 'binary_recall': 0.558952, 'binary_specificity': 1.0, 'binary_f1_score': 0.71708685}
confusion matrix:
     0    1
0  229    0
1  101  128
early stop counter: 23
val acc:0.7253845930099487, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 24,now: 2024-07-29 05:59:57.312270,epoch time: 0:01:34.665869,used: 0:38:22.962913,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883352, 'recall': 0.9884412, 'specificity': 0.9884412, 'f1': 0.98828095, 'auroc': 0.99981606, 'binary_precision': 0.9986911, 'binary_recall': 0.97820514, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.988342}
confusion matrix:
      0     1
0  1510     2
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.7323077, 'precision': 0.8089895, 'recall': 0.7284328, 'specificity': 0.7284328, 'f1': 0.7124033, 'auroc': 0.8996922, 'binary_precision': 0.9591195, 'binary_recall': 0.4765625, 'binary_specificity': 0.98030305, 'binary_f1_score': 0.6367432}
confusion matrix:
     0    1
0  647   13
1  335  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63973796, 'precision': 0.7906091, 'recall': 0.63973796, 'specificity': 0.63973796, 'f1': 0.5860063, 'auroc': 0.95179343, 'binary_precision': 1.0, 'binary_recall': 0.279476, 'binary_specificity': 1.0, 'binary_f1_score': 0.43686008}
confusion matrix:
     0   1
0  229   0
1  165  64
early stop counter: 24
val acc:0.7323076725006104, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 25,now: 2024-07-29 06:01:26.358803,epoch time: 0:01:29.046533,used: 0:39:52.009446,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98891526, 'recall': 0.9890313, 'specificity': 0.9890313, 'f1': 0.9889314, 'auroc': 0.999459, 'binary_precision': 0.99545455, 'binary_recall': 0.9826923, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.98903227}
confusion matrix:
      0     1
0  1505     7
1    27  1533
---- Validation: 
scalar performance:
{'acc': 0.8192308, 'precision': 0.8425356, 'recall': 0.81721115, 'specificity': 0.81721115, 'f1': 0.8154113, 'auroc': 0.9123834, 'binary_precision': 0.9281184, 'binary_recall': 0.6859375, 'binary_specificity': 0.94848484, 'binary_f1_score': 0.788859}
confusion matrix:
     0    1
0  626   34
1  201  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8318777, 'precision': 0.8650168, 'recall': 0.8318777, 'specificity': 0.8318777, 'f1': 0.82797325, 'auroc': 0.9519651, 'binary_precision': 0.975, 'binary_recall': 0.68122274, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  225    4
1   73  156
early stop counter: 25
val acc:0.8192307949066162, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 26,now: 2024-07-29 06:02:53.777974,epoch time: 0:01:27.419171,used: 0:41:19.428617,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9932073, 'recall': 0.99312675, 'specificity': 0.99312675, 'f1': 0.9931619, 'auroc': 0.99969184, 'binary_precision': 0.99106574, 'binary_recall': 0.99551284, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.99328434}
confusion matrix:
      0     1
0  1498    14
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.8223077, 'precision': 0.84297067, 'recall': 0.82040715, 'specificity': 0.82040715, 'f1': 0.8189514, 'auroc': 0.9103007, 'binary_precision': 0.92339545, 'binary_recall': 0.696875, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.794301}
confusion matrix:
     0    1
0  623   37
1  194  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.88288176, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.862996, 'auroc': 0.9480177, 'binary_precision': 0.96648043, 'binary_recall': 0.75545853, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.84803927}
confusion matrix:
     0    1
0  223    6
1   56  173
early stop counter: 26
val acc:0.8223077058792114, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 27,now: 2024-07-29 06:04:23.988037,epoch time: 0:01:30.210063,used: 0:42:49.638680,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99411285, 'recall': 0.9941799, 'specificity': 0.9941799, 'f1': 0.99413955, 'auroc': 0.99975157, 'binary_precision': 0.99677837, 'binary_recall': 0.9916667, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9942159}
confusion matrix:
      0     1
0  1507     5
1    13  1547
---- Validation: 
scalar performance:
{'acc': 0.73538464, 'precision': 0.81446177, 'recall': 0.73148674, 'specificity': 0.73148674, 'f1': 0.7154608, 'auroc': 0.9122046, 'binary_precision': 0.9683544, 'binary_recall': 0.478125, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.64016736}
confusion matrix:
     0    1
0  650   10
1  334  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72925764, 'precision': 0.8201134, 'recall': 0.72925764, 'specificity': 0.72925764, 'f1': 0.70857966, 'auroc': 0.94401324, 'binary_precision': 0.99065423, 'binary_recall': 0.4628821, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.6309524}
confusion matrix:
     0    1
0  228    1
1  123  106
early stop counter: 27
val acc:0.7353846430778503, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 28,now: 2024-07-29 06:05:54.524651,epoch time: 0:01:30.536614,used: 0:44:20.175294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909091, 'recall': 0.9910256, 'specificity': 0.9910256, 'f1': 0.990885, 'auroc': 0.9993467, 'binary_precision': 1.0, 'binary_recall': 0.98205125, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909444}
confusion matrix:
      0     1
0  1512     0
1    28  1532
---- Validation: 
scalar performance:
{'acc': 0.6992308, 'precision': 0.7966406, 'recall': 0.694768, 'specificity': 0.694768, 'f1': 0.6693164, 'auroc': 0.91138136, 'binary_precision': 0.9628253, 'binary_recall': 0.4046875, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.569857}
confusion matrix:
     0    1
0  650   10
1  381  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6462882, 'precision': 0.7791971, 'recall': 0.6462882, 'specificity': 0.6462882, 'f1': 0.59850645, 'auroc': 0.91769797, 'binary_precision': 0.97183096, 'binary_recall': 0.30131003, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.45999998}
confusion matrix:
     0   1
0  227   2
1  160  69
early stop counter: 28
val acc:0.6992307901382446, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 29,now: 2024-07-29 06:07:25.786344,epoch time: 0:01:31.261693,used: 0:45:51.436987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915091, 'recall': 0.9916158, 'specificity': 0.9916158, 'f1': 0.99153554, 'auroc': 0.999749, 'binary_precision': 0.9967617, 'binary_recall': 0.98653847, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.9916237}
confusion matrix:
      0     1
0  1507     5
1    21  1539
---- Validation: 
scalar performance:
{'acc': 0.7569231, 'precision': 0.81544137, 'recall': 0.75357485, 'specificity': 0.75357485, 'f1': 0.74344176, 'auroc': 0.91621983, 'binary_precision': 0.9475138, 'binary_recall': 0.5359375, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.6846307}
confusion matrix:
     0    1
0  641   19
1  297  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7882096, 'precision': 0.851227, 'recall': 0.7882096, 'specificity': 0.7882096, 'f1': 0.77826357, 'auroc': 0.9363237, 'binary_precision': 1.0, 'binary_recall': 0.57641923, 'binary_specificity': 1.0, 'binary_f1_score': 0.73130196}
confusion matrix:
     0    1
0  229    0
1   97  132
early stop counter: 29
val acc:0.7569230794906616, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8384279608726501 / 0.8908296823501587
after epoch: 30,now: 2024-07-29 06:08:59.451000,epoch time: 0:01:33.664656,used: 0:47:25.101643,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_05_21_34_seed_7_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:47:25.101643 at 2024-07-29 06:08:59.451000
persisted model performance metric: 

scalar performance:
{'acc': 0.83842796, 'precision': 0.83842796, 'recall': 0.83842796, 'specificity': 0.83842796, 'f1': 0.83842796, 'auroc': 0.92355216, 'binary_precision': 0.83842796, 'binary_recall': 0.83842796, 'binary_specificity': 0.83842796, 'binary_f1_score': 0.83842796}
confusion matrix:
     0    1
0  192   37
1   37  192
oracle model performance metric: 

scalar performance:
{'acc': 0.8908297, 'precision': 0.89383376, 'recall': 0.8908297, 'specificity': 0.8908297, 'f1': 0.8906212, 'auroc': 0.94197285, 'binary_precision': 0.9282297, 'binary_recall': 0.8471616, 'binary_specificity': 0.93449783, 'binary_f1_score': 0.88584477}
confusion matrix:
     0    1
0  214   15
1   35  194
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455470 KiB |  13221 MiB | 588951 GiB | 588950 GiB |
|       from large pool | 414872 KiB |  13182 MiB | 581990 GiB | 581989 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455470 KiB |  13221 MiB | 588951 GiB | 588950 GiB |
|       from large pool | 414872 KiB |  13182 MiB | 581990 GiB | 581989 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 587085 GiB | 587084 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14470 MiB |  14488 MiB | 109538 MiB |  95068 MiB |
|       from large pool |  14404 MiB |  14422 MiB | 109358 MiB |  94954 MiB |
|       from small pool |     66 MiB |     70 MiB |    180 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 496849 KiB |   1260 MiB | 419645 GiB | 419645 GiB |
|       from large pool | 484200 KiB |   1252 MiB | 412640 GiB | 412640 GiB |
|       from small pool |  12649 KiB |     45 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103446 K  |  103445 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50907 K  |   50906 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103446 K  |  103445 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50907 K  |   50906 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     635    |     637    |    4639    |    4004    |
|       from large pool |     602    |     603    |    4549    |    3947    |
|       from small pool |      33    |      35    |      90    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     652    |   69428 K  |   69428 K  |
|       from large pool |      39    |     605    |   39618 K  |   39618 K  |
|       from small pool |      61    |     236    |   29810 K  |   29810 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 588951 GiB | 588951 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 588951 GiB | 588951 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587085 GiB | 587085 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14488 MiB | 109538 MiB | 108608 MiB |
|       from large pool |    878 MiB |  14422 MiB | 109358 MiB | 108480 MiB |
|       from small pool |     52 MiB |     70 MiB |    180 MiB |    128 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 419646 GiB | 419645 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 412641 GiB | 412641 GiB |
|       from small pool |      0 KiB |     45 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103446 K  |  103446 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103446 K  |  103446 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    4639    |    4573    |
|       from large pool |      40    |     603    |    4549    |    4509    |
|       from small pool |      26    |      35    |      90    |      64    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   69429 K  |   69429 K  |
|       from large pool |       3    |     605    |   39618 K  |   39618 K  |
|       from small pool |       0    |     236    |   29810 K  |   29810 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 588951 GiB | 588951 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 588951 GiB | 588951 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 581990 GiB | 581990 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587085 GiB | 587085 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    930 MiB |  14488 MiB | 109538 MiB | 108608 MiB |
|       from large pool |    878 MiB |  14422 MiB | 109358 MiB | 108480 MiB |
|       from small pool |     52 MiB |     70 MiB |    180 MiB |    128 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 419646 GiB | 419645 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 412641 GiB | 412641 GiB |
|       from small pool |      0 KiB |     45 MiB |   7004 GiB |   7004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103446 K  |  103446 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103446 K  |  103446 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50907 K  |   50907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    4639    |    4573    |
|       from large pool |      40    |     603    |    4549    |    4509    |
|       from small pool |      26    |      35    |      90    |      64    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   69429 K  |   69429 K  |
|       from large pool |       3    |     605    |   39618 K  |   39618 K  |
|       from small pool |       0    |     236    |   29810 K  |   29810 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367

 Experiment start at: 2024-07-29 06:09:34.793401
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91348684, 'precision': 0.925071, 'recall': 0.91453844, 'specificity': 0.91453844, 'f1': 0.91302717, 'auroc': 0.9893322, 'binary_precision': 0.9984375, 'binary_recall': 0.83040935, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.9067045}
confusion matrix:
      0     1
0  1499     2
1   261  1278
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6937355, 'precision': 0.763396, 'recall': 0.68527716, 'specificity': 0.68527716, 'f1': 0.66593504, 'auroc': 0.8851517, 'binary_precision': 0.89115644, 'binary_recall': 0.41853034, 'binary_specificity': 0.952024, 'binary_f1_score': 0.5695652}
confusion matrix:
     0    1
0  635   32
1  364  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8004587, 'precision': 0.8317997, 'recall': 0.8004587, 'specificity': 0.8004587, 'f1': 0.7956327, 'auroc': 0.9086988, 'binary_precision': 0.9337748, 'binary_recall': 0.646789, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.76422775}
confusion matrix:
     0    1
0  208   10
1   77  141
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:11:17.806516,epoch time: 0:01:43.013115,used: 0:01:43.013115,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9723684, 'precision': 0.97236496, 'recall': 0.9724238, 'specificity': 0.9724238, 'f1': 0.97236747, 'auroc': 0.99663866, 'binary_precision': 0.9776463, 'binary_recall': 0.9674691, 'binary_specificity': 0.97737855, 'binary_f1_score': 0.9725311}
confusion matrix:
      0     1
0  1469    34
1    50  1487
---- Validation: 
scalar performance:
{'acc': 0.83139986, 'precision': 0.8313066, 'recall': 0.8310829, 'specificity': 0.8310829, 'f1': 0.83117676, 'auroc': 0.9008459, 'binary_precision': 0.82903224, 'binary_recall': 0.8210863, 'binary_specificity': 0.8410795, 'binary_f1_score': 0.82504004}
confusion matrix:
     0    1
0  561  106
1  112  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.8397069, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.8394191, 'auroc': 0.91555846, 'binary_precision': 0.83035713, 'binary_recall': 0.853211, 'binary_specificity': 0.82568806, 'binary_f1_score': 0.8416289}
confusion matrix:
     0    1
0  180   38
1   32  186
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 06:12:49.580262,epoch time: 0:01:31.773746,used: 0:03:14.786861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9460526, 'precision': 0.9490397, 'recall': 0.94556713, 'specificity': 0.94556713, 'f1': 0.9459138, 'auroc': 0.9946209, 'binary_precision': 0.91540784, 'binary_recall': 0.98440546, 'binary_specificity': 0.90672886, 'binary_f1_score': 0.9486537}
confusion matrix:
      0     1
0  1361   140
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.7525135, 'precision': 0.78650075, 'recall': 0.7578124, 'specificity': 0.7578124, 'f1': 0.7473413, 'auroc': 0.89811325, 'binary_precision': 0.67957747, 'binary_recall': 0.92492014, 'binary_specificity': 0.5907046, 'binary_f1_score': 0.7834912}
confusion matrix:
     0    1
0  394  273
1   47  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6834862, 'precision': 0.7431679, 'recall': 0.6834862, 'specificity': 0.6834862, 'f1': 0.6627959, 'auroc': 0.9046166, 'binary_precision': 0.6226994, 'binary_recall': 0.93119264, 'binary_specificity': 0.4357798, 'binary_f1_score': 0.74632347}
confusion matrix:
    0    1
0  95  123
1  15  203
early stop counter: 1
val acc:0.7525135278701782, best validation acc: 0.8313998579978943, corresponding to test acc:                         0.8394495248794556 / 0.8394495248794556
after epoch: 3,now: 2024-07-29 06:14:21.794481,epoch time: 0:01:32.214219,used: 0:04:47.001080,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.9769632, 'recall': 0.9770359, 'specificity': 0.9770359, 'f1': 0.97697246, 'auroc': 0.99715763, 'binary_precision': 0.98227185, 'binary_recall': 0.9720598, 'binary_specificity': 0.982012, 'binary_f1_score': 0.9771391}
confusion matrix:
      0     1
0  1474    27
1    43  1496
---- Validation: 
scalar performance:
{'acc': 0.7540603, 'precision': 0.7795764, 'recall': 0.7490504, 'specificity': 0.7490504, 'f1': 0.7456588, 'auroc': 0.88397336, 'binary_precision': 0.8564815, 'binary_recall': 0.5910543, 'binary_specificity': 0.9070465, 'binary_f1_score': 0.6994329}
confusion matrix:
     0    1
0  605   62
1  256  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86009175, 'precision': 0.86070657, 'recall': 0.86009175, 'specificity': 0.86009175, 'f1': 0.86003214, 'auroc': 0.9293199, 'binary_precision': 0.845815, 'binary_recall': 0.88073397, 'binary_specificity': 0.8394495, 'binary_f1_score': 0.8629214}
confusion matrix:
     0    1
0  183   35
1   26  192
new oracle model saved
early stop counter: 2
val acc:0.7540603280067444, best validation acc: 0.8313998579978943, corresponding to test acc:                         0.8394495248794556 / 0.8600917458534241
after epoch: 4,now: 2024-07-29 06:15:55.676972,epoch time: 0:01:33.882491,used: 0:06:20.883571,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.9756535, 'recall': 0.975212, 'specificity': 0.975212, 'f1': 0.9753176, 'auroc': 0.9984139, 'binary_precision': 0.96558315, 'binary_recall': 0.9863281, 'binary_specificity': 0.9640958, 'binary_f1_score': 0.9758454}
confusion matrix:
      0     1
0  1450    54
1    21  1515
---- Validation: 
scalar performance:
{'acc': 0.8507347, 'precision': 0.85242236, 'recall': 0.85188556, 'specificity': 0.85188556, 'f1': 0.85072184, 'auroc': 0.92354304, 'binary_precision': 0.81885123, 'binary_recall': 0.8881789, 'binary_specificity': 0.8155922, 'binary_f1_score': 0.8521073}
confusion matrix:
     0    1
0  544  123
1   70  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.8171587, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.81114775, 'auroc': 0.9106767, 'binary_precision': 0.77642274, 'binary_recall': 0.8761468, 'binary_specificity': 0.7477064, 'binary_f1_score': 0.82327586}
confusion matrix:
     0    1
0  163   55
1   27  191
better model found
persisted
after epoch: 5,now: 2024-07-29 06:17:26.740801,epoch time: 0:01:31.063829,used: 0:07:51.947400,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9700658, 'precision': 0.97133505, 'recall': 0.969785, 'specificity': 0.969785, 'f1': 0.97002864, 'auroc': 0.99823, 'binary_precision': 0.94965816, 'binary_recall': 0.993498, 'binary_specificity': 0.9460719, 'binary_f1_score': 0.9710835}
confusion matrix:
      0     1
0  1421    81
1    10  1528
---- Validation: 
scalar performance:
{'acc': 0.79195666, 'precision': 0.79187715, 'recall': 0.79147726, 'specificity': 0.79147726, 'f1': 0.79161966, 'auroc': 0.85549235, 'binary_precision': 0.7902439, 'binary_recall': 0.7763578, 'binary_specificity': 0.8065967, 'binary_f1_score': 0.7832393}
confusion matrix:
     0    1
0  538  129
1  140  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79587156, 'precision': 0.8175833, 'recall': 0.79587156, 'specificity': 0.79587156, 'f1': 0.79232204, 'auroc': 0.91284406, 'binary_precision': 0.73454547, 'binary_recall': 0.9266055, 'binary_specificity': 0.6651376, 'binary_f1_score': 0.8194727}
confusion matrix:
     0    1
0  145   73
1   16  202
early stop counter: 1
val acc:0.7919566631317139, best validation acc: 0.8507347106933594, corresponding to test acc:                         0.8119266033172607 / 0.8600917458534241
after epoch: 6,now: 2024-07-29 06:18:50.663909,epoch time: 0:01:23.923108,used: 0:09:15.870508,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.9848579, 'recall': 0.98490834, 'specificity': 0.98490834, 'f1': 0.9848678, 'auroc': 0.9984888, 'binary_precision': 0.98884517, 'binary_recall': 0.9811198, 'binary_specificity': 0.9886968, 'binary_f1_score': 0.9849673}
confusion matrix:
      0     1
0  1487    17
1    29  1507
---- Validation: 
scalar performance:
{'acc': 0.81979895, 'precision': 0.8224178, 'recall': 0.8212132, 'specificity': 0.8212132, 'f1': 0.81973684, 'auroc': 0.9014447, 'binary_precision': 0.7843705, 'binary_recall': 0.8658147, 'binary_specificity': 0.7766117, 'binary_f1_score': 0.82308275}
confusion matrix:
     0    1
0  518  149
1   84  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7821101, 'precision': 0.79712117, 'recall': 0.7821101, 'specificity': 0.7821101, 'f1': 0.7793228, 'auroc': 0.89316976, 'binary_precision': 0.7303371, 'binary_recall': 0.8944954, 'binary_specificity': 0.66972476, 'binary_f1_score': 0.8041237}
confusion matrix:
     0    1
0  146   72
1   23  195
early stop counter: 2
val acc:0.8197989463806152, best validation acc: 0.8507347106933594, corresponding to test acc:                         0.8119266033172607 / 0.8600917458534241
after epoch: 7,now: 2024-07-29 06:20:24.207262,epoch time: 0:01:33.543353,used: 0:10:49.413861,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9799342, 'precision': 0.9799383, 'recall': 0.9800054, 'specificity': 0.9800054, 'f1': 0.9799336, 'auroc': 0.9987204, 'binary_precision': 0.9861751, 'binary_recall': 0.97399217, 'binary_specificity': 0.98601866, 'binary_f1_score': 0.98004574}
confusion matrix:
      0     1
0  1481    21
1    40  1498
---- Validation: 
scalar performance:
{'acc': 0.83990717, 'precision': 0.84963745, 'recall': 0.83721757, 'specificity': 0.83721757, 'f1': 0.8378966, 'auroc': 0.9102246, 'binary_precision': 0.9005736, 'binary_recall': 0.75239617, 'binary_specificity': 0.922039, 'binary_f1_score': 0.8198433}
confusion matrix:
     0    1
0  615   52
1  155  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.80790305, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.80459255, 'auroc': 0.8886037, 'binary_precision': 0.83756346, 'binary_recall': 0.75688076, 'binary_specificity': 0.853211, 'binary_f1_score': 0.79518074}
confusion matrix:
     0    1
0  186   32
1   53  165
early stop counter: 3
val acc:0.839907169342041, best validation acc: 0.8507347106933594, corresponding to test acc:                         0.8119266033172607 / 0.8600917458534241
after epoch: 8,now: 2024-07-29 06:21:54.990932,epoch time: 0:01:30.783670,used: 0:12:20.197531,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9799342, 'precision': 0.98006046, 'recall': 0.98006773, 'specificity': 0.98006773, 'f1': 0.9799342, 'auroc': 0.99884164, 'binary_precision': 0.99135065, 'binary_recall': 0.96879065, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.97994083}
confusion matrix:
      0     1
0  1489    13
1    48  1490
---- Validation: 
scalar performance:
{'acc': 0.7857695, 'precision': 0.79473877, 'recall': 0.78282905, 'specificity': 0.78282905, 'f1': 0.7827674, 'auroc': 0.87465215, 'binary_precision': 0.83883494, 'binary_recall': 0.69009584, 'binary_specificity': 0.8755622, 'binary_f1_score': 0.75723046}
confusion matrix:
     0    1
0  584   83
1  194  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7912844, 'precision': 0.8030761, 'recall': 0.79128444, 'specificity': 0.79128444, 'f1': 0.7892344, 'auroc': 0.88460565, 'binary_precision': 0.86285716, 'binary_recall': 0.69266057, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.76844794}
confusion matrix:
     0    1
0  194   24
1   67  151
early stop counter: 4
val acc:0.785769522190094, best validation acc: 0.8507347106933594, corresponding to test acc:                         0.8119266033172607 / 0.8600917458534241
after epoch: 9,now: 2024-07-29 06:23:26.413667,epoch time: 0:01:31.422735,used: 0:13:51.620266,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9855263, 'precision': 0.9856645, 'recall': 0.9856645, 'specificity': 0.9856645, 'f1': 0.9855263, 'auroc': 0.9993195, 'binary_precision': 0.99733686, 'binary_recall': 0.97399217, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.9855263}
confusion matrix:
      0     1
0  1498     4
1    40  1498
---- Validation: 
scalar performance:
{'acc': 0.7842227, 'precision': 0.81183034, 'recall': 0.7793659, 'specificity': 0.7793659, 'f1': 0.7771721, 'auroc': 0.90736985, 'binary_precision': 0.89702517, 'binary_recall': 0.62619805, 'binary_specificity': 0.93253374, 'binary_f1_score': 0.7375353}
confusion matrix:
     0    1
0  622   45
1  234  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.83116317, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.8197316, 'auroc': 0.9117708, 'binary_precision': 0.8888889, 'binary_recall': 0.73394495, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.80402017}
confusion matrix:
     0    1
0  198   20
1   58  160
early stop counter: 5
val acc:0.7842227220535278, best validation acc: 0.8507347106933594, corresponding to test acc:                         0.8119266033172607 / 0.8600917458534241
after epoch: 10,now: 2024-07-29 06:24:56.964593,epoch time: 0:01:30.550926,used: 0:15:22.171192,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97763157, 'precision': 0.97826177, 'recall': 0.97786427, 'specificity': 0.97786427, 'f1': 0.9776294, 'auroc': 0.9993926, 'binary_precision': 0.9986422, 'binary_recall': 0.9570592, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.97740865}
confusion matrix:
      0     1
0  1501     2
1    66  1471
---- Validation: 
scalar performance:
{'acc': 0.6156226, 'precision': 0.7827581, 'recall': 0.60308427, 'specificity': 0.60308427, 'f1': 0.53586394, 'auroc': 0.91950035, 'binary_precision': 0.99236643, 'binary_recall': 0.20766774, 'binary_specificity': 0.99850076, 'binary_f1_score': 0.34346104}
confusion matrix:
     0    1
0  666    1
1  496  130
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5114679, 'precision': 0.75290024, 'recall': 0.5114679, 'specificity': 0.5114679, 'f1': 0.35832295, 'auroc': 0.9144012, 'binary_precision': 1.0, 'binary_recall': 0.02293578, 'binary_specificity': 1.0, 'binary_f1_score': 0.04484305}
confusion matrix:
     0  1
0  218  0
1  213  5
early stop counter: 6
val acc:0.6156225800514221, best validation acc: 0.8507347106933594, corresponding to test acc:                         0.8119266033172607 / 0.8600917458534241
after epoch: 11,now: 2024-07-29 06:26:31.757048,epoch time: 0:01:34.792455,used: 0:16:56.963647,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9875, 'recall': 0.9875684, 'specificity': 0.9875684, 'f1': 0.98749954, 'auroc': 0.999413, 'binary_precision': 0.9934211, 'binary_recall': 0.98179454, 'binary_specificity': 0.9933422, 'binary_f1_score': 0.9875735}
confusion matrix:
      0     1
0  1492    10
1    28  1510
---- Validation: 
scalar performance:
{'acc': 0.85305494, 'precision': 0.8642957, 'recall': 0.8502558, 'specificity': 0.8502558, 'f1': 0.8510773, 'auroc': 0.9353694, 'binary_precision': 0.92084944, 'binary_recall': 0.76198083, 'binary_specificity': 0.93853074, 'binary_f1_score': 0.83391607}
confusion matrix:
     0    1
0  626   41
1  149  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486239, 'precision': 0.87930405, 'recall': 0.8486239, 'specificity': 0.8486239, 'f1': 0.84549963, 'auroc': 0.93117166, 'binary_precision': 0.98717946, 'binary_recall': 0.70642203, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  216    2
1   64  154
better model found
persisted
after epoch: 12,now: 2024-07-29 06:28:07.544656,epoch time: 0:01:35.787608,used: 0:18:32.751255,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9707237, 'precision': 0.9715066, 'recall': 0.97053, 'specificity': 0.97053, 'f1': 0.9706997, 'auroc': 0.998159, 'binary_precision': 0.9547455, 'binary_recall': 0.9889323, 'binary_specificity': 0.95212764, 'binary_f1_score': 0.97153825}
confusion matrix:
      0     1
0  1432    72
1    17  1519
---- Validation: 
scalar performance:
{'acc': 0.8159319, 'precision': 0.8158369, 'recall': 0.81613946, 'specificity': 0.81613946, 'f1': 0.81586313, 'auroc': 0.8853936, 'binary_precision': 0.8021807, 'binary_recall': 0.8226837, 'binary_specificity': 0.8095952, 'binary_f1_score': 0.8123028}
confusion matrix:
     0    1
0  540  127
1  111  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8341508, 'recall': 0.8325688, 'specificity': 0.8325688, 'f1': 0.8323704, 'auroc': 0.89769375, 'binary_precision': 0.8111588, 'binary_recall': 0.8669725, 'binary_specificity': 0.79816514, 'binary_f1_score': 0.83813745}
confusion matrix:
     0    1
0  174   44
1   29  189
early stop counter: 1
val acc:0.8159319162368774, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8486238718032837 / 0.8600917458534241
after epoch: 13,now: 2024-07-29 06:29:36.738429,epoch time: 0:01:29.193773,used: 0:20:01.945028,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891797, 'recall': 0.98911595, 'specificity': 0.98911595, 'f1': 0.98914266, 'auroc': 0.99962384, 'binary_precision': 0.987055, 'binary_recall': 0.99154747, 'binary_specificity': 0.98668444, 'binary_f1_score': 0.9892962}
confusion matrix:
      0     1
0  1482    20
1    13  1525
---- Validation: 
scalar performance:
{'acc': 0.8507347, 'precision': 0.85055614, 'recall': 0.8507073, 'specificity': 0.8507073, 'f1': 0.85061896, 'auroc': 0.9201051, 'binary_precision': 0.8431062, 'binary_recall': 0.8498403, 'binary_specificity': 0.85157424, 'binary_f1_score': 0.8464599}
confusion matrix:
     0    1
0  568   99
1   94  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.853211, 'precision': 0.85332996, 'recall': 0.85321105, 'specificity': 0.85321105, 'f1': 0.85319865, 'auroc': 0.9304352, 'binary_precision': 0.8598131, 'binary_recall': 0.8440367, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.8518518}
confusion matrix:
     0    1
0  188   30
1   34  184
early stop counter: 2
val acc:0.8507347106933594, best validation acc: 0.853054940700531, corresponding to test acc:                         0.8486238718032837 / 0.8600917458534241
after epoch: 14,now: 2024-07-29 06:31:12.276004,epoch time: 0:01:35.537575,used: 0:21:37.482603,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.98529756, 'recall': 0.98513687, 'specificity': 0.98513687, 'f1': 0.9851932, 'auroc': 0.9995606, 'binary_precision': 0.98068255, 'binary_recall': 0.9902471, 'binary_specificity': 0.9800266, 'binary_f1_score': 0.9854416}
confusion matrix:
      0     1
0  1472    30
1    15  1523
---- Validation: 
scalar performance:
{'acc': 0.87857693, 'precision': 0.8795883, 'recall': 0.8777428, 'specificity': 0.8777428, 'f1': 0.87822, 'auroc': 0.94100475, 'binary_precision': 0.8927973, 'binary_recall': 0.8514377, 'binary_specificity': 0.90404797, 'binary_f1_score': 0.8716271}
confusion matrix:
     0    1
0  603   64
1   93  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.82112795, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.82109714, 'auroc': 0.8919283, 'binary_precision': 0.8240741, 'binary_recall': 0.8165138, 'binary_specificity': 0.82568806, 'binary_f1_score': 0.8202765}
confusion matrix:
     0    1
0  180   38
1   40  178
better model found
persisted
after epoch: 15,now: 2024-07-29 06:32:49.034058,epoch time: 0:01:36.758054,used: 0:23:14.240657,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.99045205, 'recall': 0.9905045, 'specificity': 0.9905045, 'f1': 0.99046016, 'auroc': 0.9995922, 'binary_precision': 0.9947472, 'binary_recall': 0.9863281, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.9905198}
confusion matrix:
      0     1
0  1496     8
1    21  1515
---- Validation: 
scalar performance:
{'acc': 0.8592421, 'precision': 0.8636304, 'recall': 0.8574802, 'specificity': 0.8574802, 'f1': 0.8582715, 'auroc': 0.9220581, 'binary_precision': 0.8964286, 'binary_recall': 0.80191696, 'binary_specificity': 0.9130435, 'binary_f1_score': 0.846543}
confusion matrix:
     0    1
0  609   58
1  124  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8326318, 'recall': 0.83256876, 'specificity': 0.83256876, 'f1': 0.8325609, 'auroc': 0.8918231, 'binary_precision': 0.8372093, 'binary_recall': 0.82568806, 'binary_specificity': 0.8394495, 'binary_f1_score': 0.83140874}
confusion matrix:
     0    1
0  183   35
1   38  180
early stop counter: 1
val acc:0.8592420816421509, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 16,now: 2024-07-29 06:34:17.755642,epoch time: 0:01:28.721584,used: 0:24:42.962241,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9884868, 'recall': 0.9885479, 'specificity': 0.9885479, 'f1': 0.9884864, 'auroc': 0.9992775, 'binary_precision': 0.99407893, 'binary_recall': 0.9830839, 'binary_specificity': 0.994012, 'binary_f1_score': 0.98855084}
confusion matrix:
      0     1
0  1494     9
1    26  1511
---- Validation: 
scalar performance:
{'acc': 0.8244393, 'precision': 0.8366947, 'recall': 0.82134134, 'specificity': 0.82134134, 'f1': 0.8217092, 'auroc': 0.9144325, 'binary_precision': 0.89349115, 'binary_recall': 0.7236422, 'binary_specificity': 0.9190405, 'binary_f1_score': 0.7996469}
confusion matrix:
     0    1
0  613   54
1  173  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76376146, 'precision': 0.80600786, 'recall': 0.76376146, 'specificity': 0.76376146, 'f1': 0.7553164, 'auroc': 0.90440094, 'binary_precision': 0.919708, 'binary_recall': 0.57798165, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.70985913}
confusion matrix:
     0    1
0  207   11
1   92  126
early stop counter: 2
val acc:0.824439287185669, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 17,now: 2024-07-29 06:35:56.076601,epoch time: 0:01:38.320959,used: 0:26:21.283200,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.988629, 'recall': 0.9886068, 'specificity': 0.9886068, 'f1': 0.9884868, 'auroc': 0.99973595, 'binary_precision': 1.0, 'binary_recall': 0.97721356, 'binary_specificity': 1.0, 'binary_f1_score': 0.98847544}
confusion matrix:
      0     1
0  1504     0
1    35  1501
---- Validation: 
scalar performance:
{'acc': 0.6612529, 'precision': 0.7896569, 'recall': 0.6504052, 'specificity': 0.6504052, 'f1': 0.6099327, 'auroc': 0.93884444, 'binary_precision': 0.9747475, 'binary_recall': 0.30830672, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.4684466}
confusion matrix:
     0    1
0  662    5
1  433  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64908254, 'precision': 0.7733938, 'recall': 0.64908254, 'specificity': 0.64908254, 'f1': 0.60407627, 'auroc': 0.89925086, 'binary_precision': 0.9577465, 'binary_recall': 0.3119266, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.47058824}
confusion matrix:
     0   1
0  215   3
1  150  68
early stop counter: 3
val acc:0.6612529158592224, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 18,now: 2024-07-29 06:37:26.111975,epoch time: 0:01:30.035374,used: 0:27:51.318574,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9885798, 'recall': 0.9885995, 'specificity': 0.9885995, 'f1': 0.9884868, 'auroc': 0.9998892, 'binary_precision': 0.998672, 'binary_recall': 0.97852963, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.98849815}
confusion matrix:
      0     1
0  1501     2
1    33  1504
---- Validation: 
scalar performance:
{'acc': 0.64269143, 'precision': 0.78681314, 'recall': 0.6311377, 'specificity': 0.6311377, 'f1': 0.58074874, 'auroc': 0.926211, 'binary_precision': 0.9823529, 'binary_recall': 0.26677316, 'binary_specificity': 0.99550223, 'binary_f1_score': 0.41959795}
confusion matrix:
     0    1
0  664    3
1  459  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6536697, 'precision': 0.76973224, 'recall': 0.6536697, 'specificity': 0.6536697, 'f1': 0.6119236, 'auroc': 0.8919914, 'binary_precision': 0.94666666, 'binary_recall': 0.32568806, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.4846416}
confusion matrix:
     0   1
0  214   4
1  147  71
early stop counter: 4
val acc:0.642691433429718, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 19,now: 2024-07-29 06:39:02.090707,epoch time: 0:01:35.978732,used: 0:29:27.297306,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.98352325, 'recall': 0.9831145, 'specificity': 0.9831145, 'f1': 0.98321646, 'auroc': 0.9992269, 'binary_precision': 0.97383535, 'binary_recall': 0.99348956, 'binary_specificity': 0.97273934, 'binary_f1_score': 0.98356426}
confusion matrix:
      0     1
0  1463    41
1    10  1526
---- Validation: 
scalar performance:
{'acc': 0.8569219, 'precision': 0.8590006, 'recall': 0.8556732, 'specificity': 0.8556732, 'f1': 0.85628617, 'auroc': 0.9234903, 'binary_precision': 0.8795181, 'binary_recall': 0.81629395, 'binary_specificity': 0.8950525, 'binary_f1_score': 0.84672743}
confusion matrix:
     0    1
0  597   70
1  115  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.8212476, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.8184626, 'auroc': 0.89367473, 'binary_precision': 0.8492462, 'binary_recall': 0.77522933, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.8105515}
confusion matrix:
     0    1
0  188   30
1   49  169
early stop counter: 5
val acc:0.856921911239624, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 20,now: 2024-07-29 06:40:38.249655,epoch time: 0:01:36.158948,used: 0:31:03.456254,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97598684, 'precision': 0.9771848, 'recall': 0.9757452, 'specificity': 0.9757452, 'f1': 0.97596025, 'auroc': 0.999629, 'binary_precision': 0.9557632, 'binary_recall': 0.99869794, 'binary_specificity': 0.9527925, 'binary_f1_score': 0.976759}
confusion matrix:
      0     1
0  1433    71
1     2  1534
---- Validation: 
scalar performance:
{'acc': 0.8607889, 'precision': 0.8607329, 'recall': 0.86109066, 'specificity': 0.86109066, 'f1': 0.86074483, 'auroc': 0.9299519, 'binary_precision': 0.8462733, 'binary_recall': 0.870607, 'binary_specificity': 0.85157424, 'binary_f1_score': 0.8582677}
confusion matrix:
     0    1
0  568   99
1   81  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.8085532, 'recall': 0.79816514, 'specificity': 0.79816514, 'f1': 0.7964519, 'auroc': 0.909835, 'binary_precision': 0.751938, 'binary_recall': 0.88990825, 'binary_specificity': 0.70642203, 'binary_f1_score': 0.8151261}
confusion matrix:
     0    1
0  154   64
1   24  194
early stop counter: 6
val acc:0.860788881778717, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 21,now: 2024-07-29 06:42:13.351493,epoch time: 0:01:35.101838,used: 0:32:38.558092,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98825383, 'recall': 0.9882809, 'specificity': 0.9882809, 'f1': 0.98815787, 'auroc': 0.99987876, 'binary_precision': 0.998672, 'binary_recall': 0.97789335, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9881735}
confusion matrix:
      0     1
0  1500     2
1    34  1504
---- Validation: 
scalar performance:
{'acc': 0.67053366, 'precision': 0.7894836, 'recall': 0.66008806, 'specificity': 0.66008806, 'f1': 0.6244354, 'auroc': 0.917155, 'binary_precision': 0.96728975, 'binary_recall': 0.33067092, 'binary_specificity': 0.98950523, 'binary_f1_score': 0.49285716}
confusion matrix:
     0    1
0  660    7
1  419  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6238532, 'precision': 0.76090425, 'recall': 0.6238532, 'specificity': 0.6238532, 'f1': 0.5669888, 'auroc': 0.9091407, 'binary_precision': 0.95, 'binary_recall': 0.2614679, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.41007197}
confusion matrix:
     0   1
0  215   3
1  161  57
early stop counter: 7
val acc:0.6705336570739746, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 22,now: 2024-07-29 06:43:50.313564,epoch time: 0:01:36.962071,used: 0:34:15.520163,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.99307287, 'recall': 0.9931363, 'specificity': 0.9931363, 'f1': 0.9930916, 'auroc': 0.9997575, 'binary_precision': 0.99672776, 'binary_recall': 0.98960364, 'binary_specificity': 0.9966689, 'binary_f1_score': 0.9931529}
confusion matrix:
      0     1
0  1496     5
1    16  1523
---- Validation: 
scalar performance:
{'acc': 0.7076566, 'precision': 0.80343324, 'recall': 0.69852495, 'specificity': 0.69852495, 'f1': 0.67654634, 'auroc': 0.90570235, 'binary_precision': 0.9661654, 'binary_recall': 0.41054314, 'binary_specificity': 0.98650676, 'binary_f1_score': 0.5762332}
confusion matrix:
     0    1
0  658    9
1  369  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64908254, 'precision': 0.79380053, 'recall': 0.64908254, 'specificity': 0.64908254, 'f1': 0.5998008, 'auroc': 0.93184495, 'binary_precision': 1.0, 'binary_recall': 0.29816514, 'binary_specificity': 1.0, 'binary_f1_score': 0.459364}
confusion matrix:
     0   1
0  218   0
1  153  65
early stop counter: 8
val acc:0.7076566219329834, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 23,now: 2024-07-29 06:45:23.474041,epoch time: 0:01:33.160477,used: 0:35:48.680640,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9911699, 'recall': 0.99108005, 'specificity': 0.99108005, 'f1': 0.99111634, 'auroc': 0.99947834, 'binary_precision': 0.9883721, 'binary_recall': 0.99415207, 'binary_specificity': 0.988008, 'binary_f1_score': 0.9912537}
confusion matrix:
      0     1
0  1483    18
1     9  1530
---- Validation: 
scalar performance:
{'acc': 0.85150814, 'precision': 0.8667478, 'recall': 0.8482655, 'specificity': 0.8482655, 'f1': 0.848989, 'auroc': 0.92424715, 'binary_precision': 0.934, 'binary_recall': 0.74600637, 'binary_specificity': 0.95052475, 'binary_f1_score': 0.8294849}
confusion matrix:
     0    1
0  634   33
1  159  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8440367, 'precision': 0.85368174, 'recall': 0.8440367, 'specificity': 0.8440367, 'f1': 0.8429661, 'auroc': 0.9101717, 'binary_precision': 0.9120879, 'binary_recall': 0.7614679, 'binary_specificity': 0.9266055, 'binary_f1_score': 0.83}
confusion matrix:
     0    1
0  202   16
1   52  166
early stop counter: 9
val acc:0.8515081405639648, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 24,now: 2024-07-29 06:46:49.502235,epoch time: 0:01:26.028194,used: 0:37:14.708834,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.9850303, 'recall': 0.9850143, 'specificity': 0.9850143, 'f1': 0.98486847, 'auroc': 0.9995165, 'binary_precision': 0.99733335, 'binary_recall': 0.97269183, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.9848585}
confusion matrix:
      0     1
0  1498     4
1    42  1496
---- Validation: 
scalar performance:
{'acc': 0.80510443, 'precision': 0.84387726, 'recall': 0.79970396, 'specificity': 0.79970396, 'f1': 0.7973455, 'auroc': 0.92312145, 'binary_precision': 0.9516908, 'binary_recall': 0.629393, 'binary_specificity': 0.970015, 'binary_f1_score': 0.75769234}
confusion matrix:
     0    1
0  647   20
1  232  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6284404, 'precision': 0.7632396, 'recall': 0.6284404, 'specificity': 0.6284404, 'f1': 0.57389, 'auroc': 0.921829, 'binary_precision': 0.9516129, 'binary_recall': 0.2706422, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.42142856}
confusion matrix:
     0   1
0  215   3
1  159  59
early stop counter: 10
val acc:0.8051044344902039, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 25,now: 2024-07-29 06:48:26.222813,epoch time: 0:01:36.720578,used: 0:38:51.429412,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.9934134, 'recall': 0.99342793, 'specificity': 0.99342793, 'f1': 0.99342024, 'auroc': 0.99971426, 'binary_precision': 0.9941406, 'binary_recall': 0.99284786, 'binary_specificity': 0.994008, 'binary_f1_score': 0.9934938}
confusion matrix:
      0     1
0  1493     9
1    11  1527
---- Validation: 
scalar performance:
{'acc': 0.7733952, 'precision': 0.7973381, 'recall': 0.76872385, 'specificity': 0.76872385, 'f1': 0.7665123, 'auroc': 0.88461757, 'binary_precision': 0.8741573, 'binary_recall': 0.6214058, 'binary_specificity': 0.916042, 'binary_f1_score': 0.7264239}
confusion matrix:
     0    1
0  611   56
1  237  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8027523, 'precision': 0.80316055, 'recall': 0.80275226, 'specificity': 0.80275226, 'f1': 0.80268586, 'auroc': 0.83492553, 'binary_precision': 0.8142857, 'binary_recall': 0.7844037, 'binary_specificity': 0.8211009, 'binary_f1_score': 0.7990654}
confusion matrix:
     0    1
0  179   39
1   47  171
early stop counter: 11
val acc:0.7733951807022095, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 26,now: 2024-07-29 06:50:00.566812,epoch time: 0:01:34.343999,used: 0:40:25.773411,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9911029, 'recall': 0.99114305, 'specificity': 0.99114305, 'f1': 0.9911177, 'auroc': 0.9998372, 'binary_precision': 0.99346405, 'binary_recall': 0.98893946, 'binary_specificity': 0.99334663, 'binary_f1_score': 0.99119663}
confusion matrix:
      0     1
0  1493    10
1    17  1520
---- Validation: 
scalar performance:
{'acc': 0.8112916, 'precision': 0.8477155, 'recall': 0.80609375, 'specificity': 0.80609375, 'f1': 0.80426395, 'auroc': 0.93690455, 'binary_precision': 0.9526066, 'binary_recall': 0.6421725, 'binary_specificity': 0.970015, 'binary_f1_score': 0.76717556}
confusion matrix:
     0    1
0  647   20
1  224  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53669727, 'precision': 0.7595238, 'recall': 0.53669727, 'specificity': 0.53669727, 'f1': 0.41006884, 'auroc': 0.9122969, 'binary_precision': 1.0, 'binary_recall': 0.07339449, 'binary_specificity': 1.0, 'binary_f1_score': 0.13675213}
confusion matrix:
     0   1
0  218   0
1  202  16
early stop counter: 12
val acc:0.8112915754318237, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 27,now: 2024-07-29 06:51:36.239472,epoch time: 0:01:35.672660,used: 0:42:01.446071,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.99280447, 'recall': 0.9927328, 'specificity': 0.9927328, 'f1': 0.99276173, 'auroc': 0.99975455, 'binary_precision': 0.99029124, 'binary_recall': 0.99544567, 'binary_specificity': 0.99002, 'binary_f1_score': 0.9928618}
confusion matrix:
      0     1
0  1488    15
1     7  1530
---- Validation: 
scalar performance:
{'acc': 0.8244393, 'precision': 0.85458106, 'recall': 0.8197702, 'specificity': 0.8197702, 'f1': 0.8190073, 'auroc': 0.9281564, 'binary_precision': 0.9503386, 'binary_recall': 0.672524, 'binary_specificity': 0.9670165, 'binary_f1_score': 0.787652}
confusion matrix:
     0    1
0  645   22
1  205  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6651376, 'precision': 0.77035964, 'recall': 0.6651376, 'specificity': 0.6651376, 'f1': 0.6290443, 'auroc': 0.9204875, 'binary_precision': 0.9390244, 'binary_recall': 0.35321102, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.5133334}
confusion matrix:
     0   1
0  213   5
1  141  77
early stop counter: 13
val acc:0.824439287185669, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 28,now: 2024-07-29 06:53:12.971390,epoch time: 0:01:36.731918,used: 0:43:38.177989,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9875502, 'recall': 0.9875941, 'specificity': 0.9875941, 'f1': 0.9874999, 'auroc': 0.9995675, 'binary_precision': 0.99602914, 'binary_recall': 0.9791802, 'binary_specificity': 0.996008, 'binary_f1_score': 0.9875328}
confusion matrix:
      0     1
0  1497     6
1    32  1505
---- Validation: 
scalar performance:
{'acc': 0.7888631, 'precision': 0.807197, 'recall': 0.7848456, 'specificity': 0.7848456, 'f1': 0.78389746, 'auroc': 0.8895824, 'binary_precision': 0.8747346, 'binary_recall': 0.658147, 'binary_specificity': 0.9115442, 'binary_f1_score': 0.7511395}
confusion matrix:
     0    1
0  608   59
1  214  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61926603, 'precision': 0.6600045, 'recall': 0.61926603, 'specificity': 0.61926603, 'f1': 0.59338415, 'auroc': 0.80207896, 'binary_precision': 0.7407407, 'binary_recall': 0.36697248, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.49079752}
confusion matrix:
     0   1
0  190  28
1  138  80
early stop counter: 14
val acc:0.7888631224632263, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 29,now: 2024-07-29 06:54:49.208473,epoch time: 0:01:36.237083,used: 0:45:14.415072,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.97920084, 'recall': 0.9788742, 'specificity': 0.9788742, 'f1': 0.97861695, 'auroc': 0.99969435, 'binary_precision': 0.9993225, 'binary_recall': 0.95841455, 'binary_specificity': 0.9993338, 'binary_f1_score': 0.9784412}
confusion matrix:
      0     1
0  1500     1
1    64  1475
---- Validation: 
scalar performance:
{'acc': 0.6744006, 'precision': 0.78926986, 'recall': 0.6641308, 'specificity': 0.6641308, 'f1': 0.63042927, 'auroc': 0.9228437, 'binary_precision': 0.9638009, 'binary_recall': 0.3402556, 'binary_specificity': 0.988006, 'binary_f1_score': 0.50295156}
confusion matrix:
     0    1
0  659    8
1  413  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5848624, 'precision': 0.773183, 'recall': 0.5848624, 'specificity': 0.5848624, 'f1': 0.49842054, 'auroc': 0.93131363, 'binary_precision': 1.0, 'binary_recall': 0.16972478, 'binary_specificity': 1.0, 'binary_f1_score': 0.2901961}
confusion matrix:
     0   1
0  218   0
1  181  37
early stop counter: 15
val acc:0.6744006276130676, best validation acc: 0.878576934337616, corresponding to test acc:                         0.8211008906364441 / 0.8600917458534241
after epoch: 30,now: 2024-07-29 06:56:22.546293,epoch time: 0:01:33.337820,used: 0:46:47.752892,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_09_34_seed_8_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:46:47.752892 at 2024-07-29 06:56:22.546293
persisted model performance metric: 

scalar performance:
{'acc': 0.8211009, 'precision': 0.82112795, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.82109714, 'auroc': 0.8919283, 'binary_precision': 0.8240741, 'binary_recall': 0.8165138, 'binary_specificity': 0.82568806, 'binary_f1_score': 0.8202765}
confusion matrix:
     0    1
0  180   38
1   40  178
oracle model performance metric: 

scalar performance:
{'acc': 0.86009175, 'precision': 0.86070657, 'recall': 0.86009175, 'specificity': 0.86009175, 'f1': 0.86003214, 'auroc': 0.9293199, 'binary_precision': 0.845815, 'binary_recall': 0.88073397, 'binary_specificity': 0.8394495, 'binary_f1_score': 0.8629214}
confusion matrix:
     0    1
0  183   35
1   26  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457959 KiB |  13221 MiB | 662461 GiB | 662460 GiB |
|       from large pool | 417363 KiB |  13182 MiB | 654634 GiB | 654634 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457959 KiB |  13221 MiB | 662461 GiB | 662460 GiB |
|       from large pool | 417363 KiB |  13182 MiB | 654634 GiB | 654634 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 660332 GiB | 660332 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 652522 GiB | 652521 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14488 MiB | 123086 MiB | 108608 MiB |
|       from large pool |  14412 MiB |  14422 MiB | 122892 MiB | 108480 MiB |
|       from small pool |     66 MiB |     70 MiB |    194 MiB |    128 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 467737 KiB |   1260 MiB | 470469 GiB | 470469 GiB |
|       from large pool | 455084 KiB |   1252 MiB | 462593 GiB | 462593 GiB |
|       from small pool |  12652 KiB |     45 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116339 K  |  116338 K  |
|       from large pool |     187    |    1413    |   59095 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57244 K  |   57243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116339 K  |  116338 K  |
|       from large pool |     187    |    1413    |   59095 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57244 K  |   57243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    5209    |    4573    |
|       from large pool |     603    |     603    |    5112    |    4509    |
|       from small pool |      33    |      35    |      97    |      64    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     652    |   78420 K  |   78420 K  |
|       from large pool |      39    |     605    |   44947 K  |   44947 K  |
|       from small pool |      64    |     236    |   33473 K  |   33473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 662461 GiB | 662461 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654634 GiB | 654634 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 662461 GiB | 662461 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654634 GiB | 654634 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660332 GiB | 660332 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652522 GiB | 652522 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    904 MiB |  14488 MiB | 123086 MiB | 122182 MiB |
|       from large pool |    852 MiB |  14422 MiB | 122892 MiB | 122040 MiB |
|       from small pool |     52 MiB |     70 MiB |    194 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 470470 GiB | 470469 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 462594 GiB | 462594 GiB |
|       from small pool |      0 KiB |     45 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116339 K  |  116339 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57244 K  |   57244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116339 K  |  116339 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57244 K  |   57244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    5209    |    5144    |
|       from large pool |      39    |     603    |    5112    |    5073    |
|       from small pool |      26    |      35    |      97    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   78420 K  |   78420 K  |
|       from large pool |       3    |     605    |   44947 K  |   44947 K  |
|       from small pool |       0    |     236    |   33473 K  |   33473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 662461 GiB | 662461 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654634 GiB | 654634 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 662461 GiB | 662461 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 654634 GiB | 654634 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660332 GiB | 660332 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652522 GiB | 652522 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    904 MiB |  14488 MiB | 123086 MiB | 122182 MiB |
|       from large pool |    852 MiB |  14422 MiB | 122892 MiB | 122040 MiB |
|       from small pool |     52 MiB |     70 MiB |    194 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 470470 GiB | 470469 GiB |
|       from large pool |  24320 KiB |   1252 MiB | 462594 GiB | 462594 GiB |
|       from small pool |      0 KiB |     45 MiB |   7875 GiB |   7875 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116339 K  |  116339 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57244 K  |   57244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116339 K  |  116339 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57244 K  |   57244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    5209    |    5144    |
|       from large pool |      39    |     603    |    5112    |    5073    |
|       from small pool |      26    |      35    |      97    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   78420 K  |   78420 K  |
|       from large pool |       3    |     605    |   44947 K  |   44947 K  |
|       from small pool |       0    |     236    |   33473 K  |   33473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367

 Experiment start at: 2024-07-29 06:57:02.833902
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.953534, 'precision': 0.95391953, 'recall': 0.9534374, 'specificity': 0.9534374, 'f1': 0.9535149, 'auroc': 0.99171484, 'binary_precision': 0.94236857, 'binary_recall': 0.9668616, 'binary_specificity': 0.9400132, 'binary_f1_score': 0.95445794}
confusion matrix:
      0     1
0  1426    91
1    51  1488
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.83474904, 'precision': 0.84619045, 'recall': 0.8338331, 'specificity': 0.8338331, 'f1': 0.8330928, 'auroc': 0.9156803, 'binary_precision': 0.9066667, 'binary_recall': 0.7425897, 'binary_specificity': 0.9250764, 'binary_f1_score': 0.81646657}
confusion matrix:
     0    1
0  605   49
1  165  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84347826, 'precision': 0.8591193, 'recall': 0.84347826, 'specificity': 0.84347826, 'f1': 0.8417553, 'auroc': 0.91330814, 'binary_precision': 0.93406594, 'binary_recall': 0.73913044, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.82524276}
confusion matrix:
     0    1
0  218   12
1   60  170
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 06:58:41.935009,epoch time: 0:01:39.101107,used: 0:01:39.101107,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96695024, 'precision': 0.9686558, 'recall': 0.9671566, 'specificity': 0.9671566, 'f1': 0.9669292, 'auroc': 0.9973521, 'binary_precision': 0.99861205, 'binary_recall': 0.9356307, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.966096}
confusion matrix:
      0     1
0  1516     2
1    99  1439
---- Validation: 
scalar performance:
{'acc': 0.65791506, 'precision': 0.7740698, 'recall': 0.6546167, 'specificity': 0.6546167, 'f1': 0.61463225, 'auroc': 0.8684753, 'binary_precision': 0.95, 'binary_recall': 0.32605305, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.485482}
confusion matrix:
     0    1
0  643   11
1  432  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.776087, 'precision': 0.838871, 'recall': 0.7760869, 'specificity': 0.7760869, 'f1': 0.76521194, 'auroc': 0.89604914, 'binary_precision': 0.9847328, 'binary_recall': 0.5608696, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.71468145}
confusion matrix:
     0    1
0  228    2
1  101  129
early stop counter: 1
val acc:0.6579150557518005, best validation acc: 0.8347490429878235, corresponding to test acc:                         0.843478262424469 / 0.843478262424469
after epoch: 2,now: 2024-07-29 07:00:23.398341,epoch time: 0:01:41.463332,used: 0:03:20.564439,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.97973233, 'recall': 0.9796954, 'specificity': 0.9796954, 'f1': 0.9797101, 'auroc': 0.9969717, 'binary_precision': 0.97800773, 'binary_recall': 0.9818182, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.97990924}
confusion matrix:
      0     1
0  1482    34
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.78301156, 'precision': 0.8283039, 'recall': 0.7811369, 'specificity': 0.7811369, 'f1': 0.77447146, 'auroc': 0.91933954, 'binary_precision': 0.9477612, 'binary_recall': 0.5943838, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.7305848}
confusion matrix:
     0    1
0  633   21
1  260  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76304346, 'precision': 0.81995124, 'recall': 0.76304346, 'specificity': 0.76304346, 'f1': 0.75201666, 'auroc': 0.8859546, 'binary_precision': 0.9548872, 'binary_recall': 0.5521739, 'binary_specificity': 0.973913, 'binary_f1_score': 0.69972456}
confusion matrix:
     0    1
0  224    6
1  103  127
early stop counter: 2
val acc:0.7830115556716919, best validation acc: 0.8347490429878235, corresponding to test acc:                         0.843478262424469 / 0.843478262424469
after epoch: 3,now: 2024-07-29 07:02:02.838283,epoch time: 0:01:39.439942,used: 0:05:00.004381,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94404453, 'precision': 0.94934833, 'recall': 0.9444444, 'specificity': 0.9444444, 'f1': 0.9439112, 'auroc': 0.99865973, 'binary_precision': 1.0, 'binary_recall': 0.8888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.94117653}
confusion matrix:
      0     1
0  1517     0
1   171  1368
---- Validation: 
scalar performance:
{'acc': 0.53359073, 'precision': 0.7599364, 'recall': 0.52886117, 'specificity': 0.52886117, 'f1': 0.39662248, 'auroc': 0.92760265, 'binary_precision': 1.0, 'binary_recall': 0.057722308, 'binary_specificity': 1.0, 'binary_f1_score': 0.10914454}
confusion matrix:
     0   1
0  654   0
1  604  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5021739, 'precision': 0.75054467, 'recall': 0.5021739, 'specificity': 0.5021739, 'f1': 0.33814612, 'auroc': 0.9097353, 'binary_precision': 1.0, 'binary_recall': 0.004347826, 'binary_specificity': 1.0, 'binary_f1_score': 0.008658009}
confusion matrix:
     0  1
0  230  0
1  229  1
early stop counter: 3
val acc:0.5335907340049744, best validation acc: 0.8347490429878235, corresponding to test acc:                         0.843478262424469 / 0.843478262424469
after epoch: 4,now: 2024-07-29 07:03:36.707042,epoch time: 0:01:33.868759,used: 0:06:33.873140,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97849673, 'recall': 0.9784738, 'specificity': 0.9784738, 'f1': 0.9784031, 'auroc': 0.9981556, 'binary_precision': 0.98743385, 'binary_recall': 0.9694805, 'binary_specificity': 0.987467, 'binary_f1_score': 0.9783748}
confusion matrix:
      0     1
0  1497    19
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.8563706, 'precision': 0.85636616, 'recall': 0.85634065, 'specificity': 0.85634065, 'f1': 0.8563514, 'auroc': 0.92886925, 'binary_precision': 0.85602504, 'binary_recall': 0.85335416, 'binary_specificity': 0.8593272, 'binary_f1_score': 0.8546875}
confusion matrix:
     0    1
0  562   92
1   94  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326087, 'precision': 0.832615, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.83260787, 'auroc': 0.90170133, 'binary_precision': 0.83406115, 'binary_recall': 0.8304348, 'binary_specificity': 0.8347826, 'binary_f1_score': 0.83224404}
confusion matrix:
     0    1
0  192   38
1   39  191
better model found
persisted
after epoch: 5,now: 2024-07-29 07:05:15.797386,epoch time: 0:01:39.090344,used: 0:08:12.963484,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98267233, 'recall': 0.9826444, 'specificity': 0.9826444, 'f1': 0.9826557, 'auroc': 0.9988277, 'binary_precision': 0.9812176, 'binary_recall': 0.98440546, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.98280895}
confusion matrix:
      0     1
0  1488    29
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.8277992, 'precision': 0.8542248, 'recall': 0.8264252, 'specificity': 0.8264252, 'f1': 0.8240919, 'auroc': 0.92538655, 'binary_precision': 0.94849783, 'binary_recall': 0.6895476, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.7985546}
confusion matrix:
     0    1
0  630   24
1  199  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8173913, 'precision': 0.84979165, 'recall': 0.8173913, 'specificity': 0.8173913, 'f1': 0.8130624, 'auroc': 0.89741015, 'binary_precision': 0.95625, 'binary_recall': 0.6652174, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.7846154}
confusion matrix:
     0    1
0  223    7
1   77  153
early stop counter: 1
val acc:0.8277992010116577, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.832608699798584 / 0.843478262424469
after epoch: 6,now: 2024-07-29 07:06:45.427311,epoch time: 0:01:29.629925,used: 0:09:42.593409,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.9683559, 'recall': 0.966414, 'specificity': 0.966414, 'f1': 0.96657974, 'auroc': 0.9991772, 'binary_precision': 0.94161034, 'binary_recall': 0.99545157, 'binary_specificity': 0.9373764, 'binary_f1_score': 0.9677827}
confusion matrix:
      0     1
0  1422    95
1     7  1532
---- Validation: 
scalar performance:
{'acc': 0.86177605, 'precision': 0.8618287, 'recall': 0.86170787, 'specificity': 0.86170787, 'f1': 0.8617431, 'auroc': 0.93279326, 'binary_precision': 0.8643533, 'binary_recall': 0.8549142, 'binary_specificity': 0.86850154, 'binary_f1_score': 0.8596079}
confusion matrix:
     0    1
0  568   86
1   93  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84782606, 'precision': 0.8487755, 'recall': 0.8478261, 'specificity': 0.8478261, 'f1': 0.8477224, 'auroc': 0.9242155, 'binary_precision': 0.8669725, 'binary_recall': 0.82173914, 'binary_specificity': 0.87391305, 'binary_f1_score': 0.84375}
confusion matrix:
     0    1
0  201   29
1   41  189
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-29 07:08:20.214138,epoch time: 0:01:34.786827,used: 0:11:17.380236,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.983003, 'recall': 0.9829707, 'specificity': 0.9829707, 'f1': 0.9829831, 'auroc': 0.9983852, 'binary_precision': 0.9812176, 'binary_recall': 0.9850455, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.98312783}
confusion matrix:
      0     1
0  1489    29
1    23  1515
---- Validation: 
scalar performance:
{'acc': 0.85328186, 'precision': 0.8615474, 'recall': 0.85252285, 'specificity': 0.85252285, 'f1': 0.85223496, 'auroc': 0.9266079, 'binary_precision': 0.9137615, 'binary_recall': 0.7769111, 'binary_specificity': 0.92813456, 'binary_f1_score': 0.8397976}
confusion matrix:
     0    1
0  607   47
1  143  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83913046, 'precision': 0.85201323, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.837645, 'auroc': 0.9090549, 'binary_precision': 0.91935486, 'binary_recall': 0.74347824, 'binary_specificity': 0.9347826, 'binary_f1_score': 0.82211536}
confusion matrix:
     0    1
0  215   15
1   59  171
early stop counter: 1
val acc:0.8532818555831909, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 8,now: 2024-07-29 07:09:58.877546,epoch time: 0:01:38.663408,used: 0:12:56.043644,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908581, 'recall': 0.99087155, 'specificity': 0.99087155, 'f1': 0.99083763, 'auroc': 0.9991939, 'binary_precision': 0.9960578, 'binary_recall': 0.9856957, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9908496}
confusion matrix:
      0     1
0  1512     6
1    22  1516
---- Validation: 
scalar performance:
{'acc': 0.8216216, 'precision': 0.8515141, 'recall': 0.82015395, 'specificity': 0.82015395, 'f1': 0.81726307, 'auroc': 0.92716193, 'binary_precision': 0.95154184, 'binary_recall': 0.673947, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.78904116}
confusion matrix:
     0    1
0  632   22
1  209  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108696, 'precision': 0.8436135, 'recall': 0.8108696, 'specificity': 0.8108696, 'f1': 0.8062539, 'auroc': 0.9065548, 'binary_precision': 0.9496855, 'binary_recall': 0.65652174, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.7763496}
confusion matrix:
     0    1
0  222    8
1   79  151
early stop counter: 2
val acc:0.8216215968132019, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 9,now: 2024-07-29 07:11:35.003165,epoch time: 0:01:36.125619,used: 0:14:32.169263,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.9947641, 'recall': 0.9947641, 'specificity': 0.9947641, 'f1': 0.9947641, 'auroc': 0.99989766, 'binary_precision': 0.9948052, 'binary_recall': 0.9948052, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9948052}
confusion matrix:
      0     1
0  1508     8
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.8277992, 'precision': 0.8555422, 'recall': 0.8263942, 'specificity': 0.8263942, 'f1': 0.82392883, 'auroc': 0.93580127, 'binary_precision': 0.95238096, 'binary_recall': 0.6864275, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.7978241}
confusion matrix:
     0    1
0  632   22
1  201  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108696, 'precision': 0.85010964, 'recall': 0.8108696, 'specificity': 0.8108696, 'f1': 0.80541736, 'auroc': 0.9188658, 'binary_precision': 0.96732026, 'binary_recall': 0.6434783, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7728459}
confusion matrix:
     0    1
0  225    5
1   82  148
early stop counter: 3
val acc:0.8277992010116577, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 10,now: 2024-07-29 07:13:11.741298,epoch time: 0:01:36.738133,used: 0:16:08.907396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98725986, 'recall': 0.9872776, 'specificity': 0.9872776, 'f1': 0.98723817, 'auroc': 0.99923456, 'binary_precision': 0.99277264, 'binary_recall': 0.9818064, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.98725903}
confusion matrix:
      0     1
0  1506    11
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.79305017, 'precision': 0.83604854, 'recall': 0.7912463, 'specificity': 0.7912463, 'f1': 0.7854974, 'auroc': 0.91811824, 'binary_precision': 0.9537713, 'binary_recall': 0.6115445, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.7452472}
confusion matrix:
     0    1
0  635   19
1  249  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8416518, 'recall': 0.8043478, 'specificity': 0.8043478, 'f1': 0.7988573, 'auroc': 0.90716445, 'binary_precision': 0.95454544, 'binary_recall': 0.6391304, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.765625}
confusion matrix:
     0    1
0  223    7
1   83  147
early stop counter: 4
val acc:0.7930501699447632, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 11,now: 2024-07-29 07:14:53.710030,epoch time: 0:01:41.968732,used: 0:17:50.876128,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99443954, 'recall': 0.99446046, 'specificity': 0.99446046, 'f1': 0.99443716, 'auroc': 0.9994308, 'binary_precision': 0.9980354, 'binary_recall': 0.9908973, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.99445355}
confusion matrix:
      0     1
0  1515     3
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.83474904, 'precision': 0.8564825, 'recall': 0.8335074, 'specificity': 0.8335074, 'f1': 0.83181655, 'auroc': 0.9345012, 'binary_precision': 0.942029, 'binary_recall': 0.7098284, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.8096086}
confusion matrix:
     0    1
0  626   28
1  186  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76521736, 'precision': 0.79062057, 'recall': 0.7652174, 'specificity': 0.7652174, 'f1': 0.7599722, 'auroc': 0.8808696, 'binary_precision': 0.8765432, 'binary_recall': 0.6173913, 'binary_specificity': 0.9130435, 'binary_f1_score': 0.7244898}
confusion matrix:
     0    1
0  210   20
1   88  142
early stop counter: 5
val acc:0.8347490429878235, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 12,now: 2024-07-29 07:16:35.735951,epoch time: 0:01:42.025921,used: 0:19:32.902049,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895236, 'recall': 0.9895412, 'specificity': 0.9895412, 'f1': 0.9895286, 'auroc': 0.99922, 'binary_precision': 0.9915144, 'binary_recall': 0.9876463, 'binary_specificity': 0.9914361, 'binary_f1_score': 0.9895766}
confusion matrix:
      0     1
0  1505    13
1    19  1519
---- Validation: 
scalar performance:
{'acc': 0.8046332, 'precision': 0.8463676, 'recall': 0.8028847, 'specificity': 0.8028847, 'f1': 0.797922, 'auroc': 0.94215906, 'binary_precision': 0.96411484, 'binary_recall': 0.62870514, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.7610954}
confusion matrix:
     0    1
0  639   15
1  238  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6934783, 'precision': 0.79987407, 'recall': 0.6934782, 'specificity': 0.6934782, 'f1': 0.6636433, 'auroc': 0.908828, 'binary_precision': 0.97849464, 'binary_recall': 0.39565217, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.5634675}
confusion matrix:
     0   1
0  228   2
1  139  91
early stop counter: 6
val acc:0.8046332001686096, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 13,now: 2024-07-29 07:18:22.552995,epoch time: 0:01:46.817044,used: 0:21:19.719093,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918133, 'recall': 0.9918266, 'specificity': 0.9918266, 'f1': 0.991819, 'auroc': 0.99961966, 'binary_precision': 0.9928432, 'binary_recall': 0.9909091, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9918753}
confusion matrix:
      0     1
0  1505    11
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.8092664, 'precision': 0.8443691, 'recall': 0.8076579, 'specificity': 0.8076579, 'f1': 0.8037037, 'auroc': 0.9185046, 'binary_precision': 0.95183486, 'binary_recall': 0.6474259, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.7706592}
confusion matrix:
     0    1
0  633   21
1  226  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78913045, 'precision': 0.8456419, 'recall': 0.78913045, 'specificity': 0.78913045, 'f1': 0.780144, 'auroc': 0.91941875, 'binary_precision': 0.98540145, 'binary_recall': 0.5869565, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.7356948}
confusion matrix:
     0    1
0  228    2
1   95  135
early stop counter: 7
val acc:0.8092663884162903, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 14,now: 2024-07-29 07:20:05.379207,epoch time: 0:01:42.826212,used: 0:23:02.545305,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865777, 'recall': 0.98659956, 'specificity': 0.98659956, 'f1': 0.9865835, 'auroc': 0.9989228, 'binary_precision': 0.9889034, 'binary_recall': 0.98440546, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.98664933}
confusion matrix:
      0     1
0  1500    17
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.83474904, 'precision': 0.8634563, 'recall': 0.83333695, 'specificity': 0.83333695, 'f1': 0.8309952, 'auroc': 0.92650473, 'binary_precision': 0.9631236, 'binary_recall': 0.6926677, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.80580765}
confusion matrix:
     0    1
0  637   17
1  197  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8021739, 'precision': 0.8499726, 'recall': 0.8021739, 'specificity': 0.8021739, 'f1': 0.7951804, 'auroc': 0.9194329, 'binary_precision': 0.97931033, 'binary_recall': 0.6173913, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.7573333}
confusion matrix:
     0    1
0  227    3
1   88  142
early stop counter: 8
val acc:0.8347490429878235, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8478260636329651
after epoch: 15,now: 2024-07-29 07:21:47.133903,epoch time: 0:01:41.754696,used: 0:24:44.300001,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.989074, 'recall': 0.98881257, 'specificity': 0.98881257, 'f1': 0.9888716, 'auroc': 0.99974173, 'binary_precision': 0.98083067, 'binary_recall': 0.99740094, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9890464}
confusion matrix:
      0     1
0  1487    30
1     4  1535
---- Validation: 
scalar performance:
{'acc': 0.8586873, 'precision': 0.8586775, 'recall': 0.8587118, 'specificity': 0.8587118, 'f1': 0.85868186, 'auroc': 0.93375695, 'binary_precision': 0.85448915, 'binary_recall': 0.86115444, 'binary_specificity': 0.8562691, 'binary_f1_score': 0.8578088}
confusion matrix:
     0    1
0  560   94
1   89  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673913, 'precision': 0.87178385, 'recall': 0.8673913, 'specificity': 0.8673913, 'f1': 0.8669985, 'auroc': 0.9296975, 'binary_precision': 0.91219515, 'binary_recall': 0.8130435, 'binary_specificity': 0.9217391, 'binary_f1_score': 0.8597702}
confusion matrix:
     0    1
0  212   18
1   43  187
new oracle model saved
early stop counter: 9
val acc:0.8586872816085815, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 16,now: 2024-07-29 07:23:28.740385,epoch time: 0:01:41.606482,used: 0:26:25.906483,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97957957, 'recall': 0.97918844, 'specificity': 0.97918844, 'f1': 0.97905505, 'auroc': 0.99903584, 'binary_precision': 0.9973028, 'binary_recall': 0.9610137, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.978822}
confusion matrix:
      0     1
0  1513     4
1    60  1479
---- Validation: 
scalar performance:
{'acc': 0.75521237, 'precision': 0.8314629, 'recall': 0.7527921, 'specificity': 0.7527921, 'f1': 0.73908067, 'auroc': 0.9500661, 'binary_precision': 0.9879518, 'binary_recall': 0.51170045, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.67420346}
confusion matrix:
     0    1
0  650    4
1  313  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.723913, 'precision': 0.8221289, 'recall': 0.7239131, 'specificity': 0.7239131, 'f1': 0.7011321, 'auroc': 0.93077505, 'binary_precision': 1.0, 'binary_recall': 0.4478261, 'binary_specificity': 1.0, 'binary_f1_score': 0.6186186}
confusion matrix:
     0    1
0  230    0
1  127  103
early stop counter: 10
val acc:0.7552123665809631, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 17,now: 2024-07-29 07:25:10.595512,epoch time: 0:01:41.855127,used: 0:28:07.761610,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9902172, 'recall': 0.990234, 'specificity': 0.990234, 'f1': 0.99018323, 'auroc': 0.99958146, 'binary_precision': 0.99671054, 'binary_recall': 0.98376626, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99019605}
confusion matrix:
      0     1
0  1511     5
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.81389964, 'precision': 0.85112226, 'recall': 0.81226057, 'specificity': 0.81226057, 'f1': 0.808265, 'auroc': 0.9340027, 'binary_precision': 0.962963, 'binary_recall': 0.648986, 'binary_specificity': 0.97553515, 'binary_f1_score': 0.7753961}
confusion matrix:
     0    1
0  638   16
1  225  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79347825, 'precision': 0.85083956, 'recall': 0.79347825, 'specificity': 0.79347825, 'f1': 0.7846771, 'auroc': 0.9230813, 'binary_precision': 0.99270076, 'binary_recall': 0.59130436, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.7411444}
confusion matrix:
     0    1
0  229    1
1   94  136
early stop counter: 11
val acc:0.8138996362686157, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 18,now: 2024-07-29 07:26:52.935896,epoch time: 0:01:42.340384,used: 0:29:50.101994,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99249977, 'recall': 0.9924569, 'specificity': 0.9924569, 'f1': 0.9924731, 'auroc': 0.9996282, 'binary_precision': 0.99029756, 'binary_recall': 0.9948018, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9925446}
confusion matrix:
      0     1
0  1502    15
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.7567568, 'precision': 0.8191882, 'recall': 0.75452274, 'specificity': 0.75452274, 'f1': 0.743156, 'auroc': 0.9241569, 'binary_precision': 0.9578652, 'binary_recall': 0.5319813, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.68405217}
confusion matrix:
     0    1
0  639   15
1  300  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8065217, 'precision': 0.85500824, 'recall': 0.8065218, 'specificity': 0.8065218, 'f1': 0.7996819, 'auroc': 0.9234594, 'binary_precision': 0.9862069, 'binary_recall': 0.62173915, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.76266664}
confusion matrix:
     0    1
0  228    2
1   87  143
early stop counter: 12
val acc:0.7567567825317383, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 19,now: 2024-07-29 07:28:34.239774,epoch time: 0:01:41.303878,used: 0:31:31.405872,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99346066, 'recall': 0.9934809, 'specificity': 0.9934809, 'f1': 0.9934554, 'auroc': 0.99933565, 'binary_precision': 0.99737877, 'binary_recall': 0.9895969, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9934726}
confusion matrix:
      0     1
0  1514     4
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.75521237, 'precision': 0.82058203, 'recall': 0.7529317, 'specificity': 0.7529317, 'f1': 0.7409361, 'auroc': 0.9401833, 'binary_precision': 0.9628571, 'binary_recall': 0.52574104, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.68012106}
confusion matrix:
     0    1
0  641   13
1  304  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6391304, 'precision': 0.7904041, 'recall': 0.6391304, 'specificity': 0.6391304, 'f1': 0.5850992, 'auroc': 0.92463136, 'binary_precision': 1.0, 'binary_recall': 0.27826086, 'binary_specificity': 1.0, 'binary_f1_score': 0.43537414}
confusion matrix:
     0   1
0  230   0
1  166  64
early stop counter: 13
val acc:0.7552123665809631, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 20,now: 2024-07-29 07:30:14.344061,epoch time: 0:01:40.104287,used: 0:33:11.510159,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99246776, 'recall': 0.99248993, 'specificity': 0.99248993, 'f1': 0.99247366, 'auroc': 0.99966633, 'binary_precision': 0.9947781, 'binary_recall': 0.9902534, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9925106}
confusion matrix:
      0     1
0  1509     8
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.6895753, 'precision': 0.79839265, 'recall': 0.6865205, 'specificity': 0.6865205, 'f1': 0.6562891, 'auroc': 0.9189286, 'binary_precision': 0.9760956, 'binary_recall': 0.3822153, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.5493274}
confusion matrix:
     0    1
0  648    6
1  396  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6434783, 'precision': 0.778022, 'recall': 0.6434783, 'specificity': 0.6434783, 'f1': 0.59440863, 'auroc': 0.9118148, 'binary_precision': 0.9714286, 'binary_recall': 0.29565218, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.45333335}
confusion matrix:
     0   1
0  228   2
1  162  68
early stop counter: 14
val acc:0.6895753145217896, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 21,now: 2024-07-29 07:31:54.405213,epoch time: 0:01:40.061152,used: 0:34:51.571311,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99091494, 'recall': 0.990904, 'specificity': 0.990904, 'f1': 0.9908377, 'auroc': 0.9996462, 'binary_precision': 0.9993395, 'binary_recall': 0.98246753, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.99083173}
confusion matrix:
      0     1
0  1515     1
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.68725866, 'precision': 0.80291843, 'recall': 0.6841339, 'specificity': 0.6841339, 'f1': 0.652039, 'auroc': 0.9282234, 'binary_precision': 0.9876033, 'binary_recall': 0.37285492, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.54133636}
confusion matrix:
     0    1
0  651    3
1  402  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5804348, 'precision': 0.759151, 'recall': 0.5804348, 'specificity': 0.5804348, 'f1': 0.4930305, 'auroc': 0.9025898, 'binary_precision': 0.974359, 'binary_recall': 0.16521738, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.2825279}
confusion matrix:
     0   1
0  229   1
1  192  38
early stop counter: 15
val acc:0.6872586607933044, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 22,now: 2024-07-29 07:33:28.518838,epoch time: 0:01:34.113625,used: 0:36:25.684936,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918356, 'recall': 0.99180716, 'specificity': 0.99180716, 'f1': 0.99181867, 'auroc': 0.99966335, 'binary_precision': 0.990285, 'binary_recall': 0.99350226, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.99189097}
confusion matrix:
      0     1
0  1502    15
1    10  1529
---- Validation: 
scalar performance:
{'acc': 0.81621623, 'precision': 0.8439008, 'recall': 0.8147867, 'specificity': 0.8147867, 'f1': 0.8119525, 'auroc': 0.92879057, 'binary_precision': 0.9389978, 'binary_recall': 0.6723869, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.7836364}
confusion matrix:
     0    1
0  626   28
1  210  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8364389, 'recall': 0.7826087, 'specificity': 0.7826087, 'f1': 0.77355075, 'auroc': 0.90616256, 'binary_precision': 0.9710145, 'binary_recall': 0.5826087, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7282609}
confusion matrix:
     0    1
0  226    4
1   96  134
early stop counter: 16
val acc:0.816216230392456, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 23,now: 2024-07-29 07:34:59.813702,epoch time: 0:01:31.294864,used: 0:37:56.979800,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9883479, 'recall': 0.9881722, 'specificity': 0.9881722, 'f1': 0.9882177, 'auroc': 0.9996067, 'binary_precision': 0.98203975, 'binary_recall': 0.9948018, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.9883796}
confusion matrix:
      0     1
0  1489    28
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.82857144, 'precision': 0.8616985, 'recall': 0.82705015, 'specificity': 0.82705015, 'f1': 0.8240765, 'auroc': 0.9436803, 'binary_precision': 0.9686801, 'binary_recall': 0.675507, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.79595584}
confusion matrix:
     0    1
0  640   14
1  208  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76521736, 'precision': 0.8270396, 'recall': 0.7652174, 'specificity': 0.7652174, 'f1': 0.7535714, 'auroc': 0.907259, 'binary_precision': 0.9692308, 'binary_recall': 0.5478261, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7}
confusion matrix:
     0    1
0  226    4
1  104  126
early stop counter: 17
val acc:0.8285714387893677, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 24,now: 2024-07-29 07:36:26.361507,epoch time: 0:01:26.547805,used: 0:39:23.527605,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9916482, 'recall': 0.99143505, 'specificity': 0.99143505, 'f1': 0.99149024, 'auroc': 0.9999392, 'binary_precision': 0.98463506, 'binary_recall': 0.9987013, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.9916183}
confusion matrix:
      0     1
0  1492    24
1     2  1538
---- Validation: 
scalar performance:
{'acc': 0.84710425, 'precision': 0.8673511, 'recall': 0.8459259, 'specificity': 0.8459259, 'f1': 0.84464294, 'auroc': 0.9486575, 'binary_precision': 0.95112014, 'binary_recall': 0.7285491, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.8250883}
confusion matrix:
     0    1
0  630   24
1  174  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8565217, 'precision': 0.8807332, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.8542039, 'auroc': 0.93425333, 'binary_precision': 0.9767442, 'binary_recall': 0.7304348, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.8358209}
confusion matrix:
     0    1
0  226    4
1   62  168
early stop counter: 18
val acc:0.8471042513847351, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 25,now: 2024-07-29 07:38:02.202155,epoch time: 0:01:35.840648,used: 0:40:59.368253,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899998, 'recall': 0.9898014, 'specificity': 0.9898014, 'f1': 0.98985386, 'auroc': 0.9997995, 'binary_precision': 0.983344, 'binary_recall': 0.9967533, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9900032}
confusion matrix:
      0     1
0  1490    26
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.8216216, 'precision': 0.85899746, 'recall': 0.81999886, 'specificity': 0.81999886, 'f1': 0.81632054, 'auroc': 0.9574537, 'binary_precision': 0.97235024, 'binary_recall': 0.65834635, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.7851163}
confusion matrix:
     0    1
0  642   12
1  219  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6826087, 'precision': 0.80033576, 'recall': 0.6826087, 'specificity': 0.6826087, 'f1': 0.64812636, 'auroc': 0.9390737, 'binary_precision': 0.9883721, 'binary_recall': 0.36956522, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.53797466}
confusion matrix:
     0   1
0  229   1
1  145  85
early stop counter: 19
val acc:0.8216215968132019, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 26,now: 2024-07-29 07:39:38.404390,epoch time: 0:01:36.202235,used: 0:42:35.570488,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.99413043, 'recall': 0.99414396, 'specificity': 0.99414396, 'f1': 0.99411, 'auroc': 0.9999136, 'binary_precision': 0.999343, 'binary_recall': 0.9889467, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9941177}
confusion matrix:
      0     1
0  1517     1
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.6803089, 'precision': 0.7980931, 'recall': 0.6771291, 'specificity': 0.6771291, 'f1': 0.6429285, 'auroc': 0.92555237, 'binary_precision': 0.9829787, 'binary_recall': 0.36037442, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.5273973}
confusion matrix:
     0    1
0  650    4
1  410  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6152174, 'precision': 0.7825553, 'recall': 0.6152174, 'specificity': 0.6152174, 'f1': 0.54834664, 'auroc': 0.9220794, 'binary_precision': 1.0, 'binary_recall': 0.23043478, 'binary_specificity': 1.0, 'binary_f1_score': 0.3745583}
confusion matrix:
     0   1
0  230   0
1  177  53
early stop counter: 20
val acc:0.6803088784217834, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 27,now: 2024-07-29 07:41:20.645417,epoch time: 0:01:42.241027,used: 0:44:17.811515,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905913, 'recall': 0.99047464, 'specificity': 0.99047464, 'f1': 0.99050903, 'auroc': 0.9993206, 'binary_precision': 0.985843, 'binary_recall': 0.99545157, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.99062395}
confusion matrix:
      0     1
0  1495    22
1     7  1532
---- Validation: 
scalar performance:
{'acc': 0.7420849, 'precision': 0.798257, 'recall': 0.7398882, 'specificity': 0.7398882, 'f1': 0.72816956, 'auroc': 0.90377766, 'binary_precision': 0.92520773, 'binary_recall': 0.5210608, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  627   27
1  307  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79130435, 'precision': 0.8249409, 'recall': 0.79130435, 'specificity': 0.79130435, 'f1': 0.78576005, 'auroc': 0.8950095, 'binary_precision': 0.92948717, 'binary_recall': 0.6304348, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.7512953}
confusion matrix:
     0    1
0  219   11
1   85  145
early stop counter: 21
val acc:0.7420849204063416, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 28,now: 2024-07-29 07:42:59.922070,epoch time: 0:01:39.276653,used: 0:45:57.088168,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.9761456, 'recall': 0.97530866, 'specificity': 0.97530866, 'f1': 0.97512317, 'auroc': 0.99982655, 'binary_precision': 1.0, 'binary_recall': 0.9506173, 'binary_specificity': 1.0, 'binary_f1_score': 0.9746836}
confusion matrix:
      0     1
0  1517     0
1    76  1463
---- Validation: 
scalar performance:
{'acc': 0.5590734, 'precision': 0.76002204, 'recall': 0.5546177, 'specificity': 0.5546177, 'f1': 0.4474748, 'auroc': 0.927568, 'binary_precision': 0.9861111, 'binary_recall': 0.11076443, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.19915847}
confusion matrix:
     0   1
0  653   1
1  570  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5326087, 'precision': 0.72905326, 'recall': 0.5326087, 'specificity': 0.5326087, 'f1': 0.4050448, 'auroc': 0.9208459, 'binary_precision': 0.9411765, 'binary_recall': 0.069565214, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.12955466}
confusion matrix:
     0   1
0  229   1
1  214  16
early stop counter: 22
val acc:0.5590733885765076, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8478260636329651 / 0.8673912882804871
after epoch: 29,now: 2024-07-29 07:44:42.680448,epoch time: 0:01:42.758378,used: 0:47:39.846546,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9871365, 'recall': 0.98684436, 'specificity': 0.98684436, 'f1': 0.9869075, 'auroc': 0.999788, 'binary_precision': 0.9783025, 'binary_recall': 0.9961014, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9871217}
confusion matrix:
      0     1
0  1483    34
1     6  1533
---- Validation: 
scalar performance:
{'acc': 0.86563706, 'precision': 0.876119, 'recall': 0.86480176, 'specificity': 0.86480176, 'f1': 0.86449283, 'auroc': 0.94021195, 'binary_precision': 0.9364486, 'binary_recall': 0.78159124, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.8520408}
confusion matrix:
     0    1
0  620   34
1  140  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84565216, 'precision': 0.8682705, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.84324527, 'auroc': 0.91876656, 'binary_precision': 0.95953757, 'binary_recall': 0.7217391, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.82382137}
confusion matrix:
     0    1
0  223    7
1   64  166
better model found
persisted
after epoch: 30,now: 2024-07-29 07:46:18.375564,epoch time: 0:01:35.695116,used: 0:49:15.541662,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_06_57_02_seed_9_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:49:15.541662 at 2024-07-29 07:46:18.375564
persisted model performance metric: 

scalar performance:
{'acc': 0.84565216, 'precision': 0.8682705, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.84324527, 'auroc': 0.91876656, 'binary_precision': 0.95953757, 'binary_recall': 0.7217391, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.82382137}
confusion matrix:
     0    1
0  223    7
1   64  166
oracle model performance metric: 

scalar performance:
{'acc': 0.8673913, 'precision': 0.87178385, 'recall': 0.8673913, 'specificity': 0.8673913, 'f1': 0.8669985, 'auroc': 0.9296975, 'binary_precision': 0.91219515, 'binary_recall': 0.8130435, 'binary_specificity': 0.9217391, 'binary_f1_score': 0.8597702}
confusion matrix:
     0    1
0  212   18
1   43  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455693 KiB |  13221 MiB | 739521 GiB | 739521 GiB |
|       from large pool | 415095 KiB |  13182 MiB | 730797 GiB | 730796 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455693 KiB |  13221 MiB | 739521 GiB | 739521 GiB |
|       from large pool | 415095 KiB |  13182 MiB | 730797 GiB | 730796 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 737329 GiB | 737328 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 728623 GiB | 728622 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14490 MiB |  14490 MiB | 136672 MiB | 122182 MiB |
|       from large pool |  14424 MiB |  14424 MiB | 136464 MiB | 122040 MiB |
|       from small pool |     66 MiB |     70 MiB |    208 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 441330 KiB |   1260 MiB | 524737 GiB | 524737 GiB |
|       from large pool | 430729 KiB |   1256 MiB | 515959 GiB | 515958 GiB |
|       from small pool |  10601 KiB |     45 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129764 K  |  129762 K  |
|       from large pool |     187    |    1413    |   65972 K  |   65972 K  |
|       from small pool |    1123    |    1419    |   63791 K  |   63790 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129764 K  |  129762 K  |
|       from large pool |     187    |    1413    |   65972 K  |   65972 K  |
|       from small pool |    1123    |    1419    |   63791 K  |   63790 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    5780    |    5144    |
|       from large pool |     603    |     603    |    5676    |    5073    |
|       from small pool |      33    |      35    |     104    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |     652    |   87404 K  |   87404 K  |
|       from large pool |      36    |     608    |   49957 K  |   49957 K  |
|       from small pool |      57    |     236    |   37446 K  |   37446 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 739521 GiB | 739521 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730797 GiB | 730797 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 739521 GiB | 739521 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730797 GiB | 730797 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737329 GiB | 737329 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728623 GiB | 728623 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    876 MiB |  14490 MiB | 136672 MiB | 135796 MiB |
|       from large pool |    826 MiB |  14424 MiB | 136464 MiB | 135638 MiB |
|       from small pool |     50 MiB |     70 MiB |    208 MiB |    158 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 524738 GiB | 524738 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 515959 GiB | 515959 GiB |
|       from small pool |      0 KiB |     45 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129764 K  |  129764 K  |
|       from large pool |       2    |    1413    |   65972 K  |   65972 K  |
|       from small pool |       0    |    1419    |   63791 K  |   63791 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129764 K  |  129764 K  |
|       from large pool |       2    |    1413    |   65972 K  |   65972 K  |
|       from small pool |       0    |    1419    |   63791 K  |   63791 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    5780    |    5717    |
|       from large pool |      38    |     603    |    5676    |    5638    |
|       from small pool |      25    |      35    |     104    |      79    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   87404 K  |   87404 K  |
|       from large pool |       3    |     608    |   49957 K  |   49957 K  |
|       from small pool |       0    |     236    |   37446 K  |   37446 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB | 739521 GiB | 739521 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730797 GiB | 730797 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB | 739521 GiB | 739521 GiB |
|       from large pool |  16640 KiB |  13182 MiB | 730797 GiB | 730797 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737329 GiB | 737329 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728623 GiB | 728623 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    876 MiB |  14490 MiB | 136672 MiB | 135796 MiB |
|       from large pool |    826 MiB |  14424 MiB | 136464 MiB | 135638 MiB |
|       from small pool |     50 MiB |     70 MiB |    208 MiB |    158 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 524738 GiB | 524738 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 515959 GiB | 515959 GiB |
|       from small pool |      0 KiB |     45 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129764 K  |  129764 K  |
|       from large pool |       2    |    1413    |   65972 K  |   65972 K  |
|       from small pool |       0    |    1419    |   63791 K  |   63791 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129764 K  |  129764 K  |
|       from large pool |       2    |    1413    |   65972 K  |   65972 K  |
|       from small pool |       0    |    1419    |   63791 K  |   63791 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    5780    |    5717    |
|       from large pool |      38    |     603    |    5676    |    5638    |
|       from small pool |      25    |      35    |     104    |      79    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   87404 K  |   87404 K  |
|       from large pool |       3    |     608    |   49957 K  |   49957 K  |
|       from small pool |       0    |     236    |   37446 K  |   37446 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367

 Experiment start at: 2024-07-29 07:47:00.986905
before training, model accuracy: 0.5113122463226318
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9209656, 'precision': 0.92879283, 'recall': 0.92061174, 'specificity': 0.92061174, 'f1': 0.92055655, 'auroc': 0.99319625, 'binary_precision': 0.87216735, 'binary_recall': 0.9875, 'binary_specificity': 0.8537234, 'binary_f1_score': 0.9262573}
confusion matrix:
      0     1
0  1284   220
1    19  1501
---- Validation: 
scalar performance:
{'acc': 0.72620904, 'precision': 0.7764789, 'recall': 0.7348398, 'specificity': 0.7348398, 'f1': 0.7176663, 'auroc': 0.9012488, 'binary_precision': 0.647587, 'binary_recall': 0.9397394, 'binary_specificity': 0.5299401, 'binary_f1_score': 0.7667774}
confusion matrix:
     0    1
0  354  314
1   37  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78280544, 'precision': 0.8230465, 'recall': 0.78280544, 'specificity': 0.78280544, 'f1': 0.7758242, 'auroc': 0.9518846, 'binary_precision': 0.7090301, 'binary_recall': 0.959276, 'binary_specificity': 0.60633487, 'binary_f1_score': 0.8153846}
confusion matrix:
     0    1
0  134   87
1    9  212
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 07:48:42.831165,epoch time: 0:01:41.844260,used: 0:01:41.844260,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95039684, 'precision': 0.9537685, 'recall': 0.9506299, 'specificity': 0.9506299, 'f1': 0.9503212, 'auroc': 0.99304444, 'binary_precision': 0.994228, 'binary_recall': 0.90657896, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.94838274}
confusion matrix:
      0     1
0  1496     8
1   142  1378
---- Validation: 
scalar performance:
{'acc': 0.78627145, 'precision': 0.785914, 'recall': 0.7862207, 'specificity': 0.7862207, 'f1': 0.78601944, 'auroc': 0.8616245, 'binary_precision': 0.7724359, 'binary_recall': 0.7850163, 'binary_specificity': 0.78742516, 'binary_f1_score': 0.7786753}
confusion matrix:
     0    1
0  526  142
1  132  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82126695, 'precision': 0.8220649, 'recall': 0.821267, 'specificity': 0.821267, 'f1': 0.8211562, 'auroc': 0.89195555, 'binary_precision': 0.8060345, 'binary_recall': 0.84615386, 'binary_specificity': 0.7963801, 'binary_f1_score': 0.82560706}
confusion matrix:
     0    1
0  176   45
1   34  187
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 07:50:22.821149,epoch time: 0:01:39.989984,used: 0:03:21.834244,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.978836, 'precision': 0.97917056, 'recall': 0.97891235, 'specificity': 0.97891235, 'f1': 0.97883415, 'auroc': 0.997899, 'binary_precision': 0.9932249, 'binary_recall': 0.96447366, 'binary_specificity': 0.99335104, 'binary_f1_score': 0.9786382}
confusion matrix:
      0     1
0  1494    10
1    54  1466
---- Validation: 
scalar performance:
{'acc': 0.851014, 'precision': 0.85073686, 'recall': 0.85078216, 'specificity': 0.85078216, 'f1': 0.85075897, 'auroc': 0.9065956, 'binary_precision': 0.84390247, 'binary_recall': 0.8452769, 'binary_specificity': 0.8562874, 'binary_f1_score': 0.8445891}
confusion matrix:
     0    1
0  572   96
1   95  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.8348001, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.832301, 'auroc': 0.9188796, 'binary_precision': 0.80753136, 'binary_recall': 0.8733032, 'binary_specificity': 0.7918552, 'binary_f1_score': 0.8391304}
confusion matrix:
     0    1
0  175   46
1   28  193
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-29 07:51:55.792970,epoch time: 0:01:32.971821,used: 0:04:54.806065,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9580026, 'precision': 0.96106684, 'recall': 0.9582237, 'specificity': 0.9582237, 'f1': 0.95794594, 'auroc': 0.9968181, 'binary_precision': 1.0, 'binary_recall': 0.91644734, 'binary_specificity': 1.0, 'binary_f1_score': 0.9564023}
confusion matrix:
      0     1
0  1504     0
1   127  1393
---- Validation: 
scalar performance:
{'acc': 0.7371295, 'precision': 0.80301404, 'recall': 0.72695243, 'specificity': 0.72695243, 'f1': 0.71608895, 'auroc': 0.892474, 'binary_precision': 0.9341693, 'binary_recall': 0.48534203, 'binary_specificity': 0.9685629, 'binary_f1_score': 0.63879955}
confusion matrix:
     0    1
0  647   21
1  316  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7352941, 'precision': 0.7761438, 'recall': 0.7352941, 'specificity': 0.7352941, 'f1': 0.72512877, 'auroc': 0.8863455, 'binary_precision': 0.88235295, 'binary_recall': 0.54298645, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.6722689}
confusion matrix:
     0    1
0  205   16
1  101  120
early stop counter: 1
val acc:0.7371295094490051, best validation acc: 0.8510140180587769, corresponding to test acc:                         0.8325791954994202 / 0.8325791954994202
after epoch: 4,now: 2024-07-29 07:53:34.391771,epoch time: 0:01:38.598801,used: 0:06:33.404866,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9864418, 'precision': 0.986455, 'recall': 0.9864327, 'specificity': 0.9864327, 'f1': 0.98644114, 'auroc': 0.9989431, 'binary_precision': 0.98491806, 'binary_recall': 0.98815787, 'binary_specificity': 0.9847075, 'binary_f1_score': 0.9865353}
confusion matrix:
      0     1
0  1481    23
1    18  1502
---- Validation: 
scalar performance:
{'acc': 0.81825274, 'precision': 0.82995903, 'recall': 0.8221757, 'specificity': 0.8221757, 'f1': 0.8176286, 'auroc': 0.9158044, 'binary_precision': 0.756393, 'binary_recall': 0.9153094, 'binary_specificity': 0.72904193, 'binary_f1_score': 0.82829773}
confusion matrix:
     0    1
0  487  181
1   52  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8303167, 'precision': 0.83610415, 'recall': 0.8303168, 'specificity': 0.8303168, 'f1': 0.8295831, 'auroc': 0.92700803, 'binary_precision': 0.792, 'binary_recall': 0.8959276, 'binary_specificity': 0.7647059, 'binary_f1_score': 0.8407643}
confusion matrix:
     0    1
0  169   52
1   23  198
early stop counter: 2
val acc:0.8182527422904968, best validation acc: 0.8510140180587769, corresponding to test acc:                         0.8325791954994202 / 0.8325791954994202
after epoch: 5,now: 2024-07-29 07:55:13.330018,epoch time: 0:01:38.938247,used: 0:08:12.343113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9811508, 'precision': 0.9811955, 'recall': 0.9811835, 'specificity': 0.9811835, 'f1': 0.98115075, 'auroc': 0.99853283, 'binary_precision': 0.98734176, 'binary_recall': 0.975, 'binary_specificity': 0.98736703, 'binary_f1_score': 0.9811321}
confusion matrix:
      0     1
0  1485    19
1    38  1482
---- Validation: 
scalar performance:
{'acc': 0.8135725, 'precision': 0.8150295, 'recall': 0.8118259, 'specificity': 0.8118259, 'f1': 0.81249917, 'auroc': 0.86642754, 'binary_precision': 0.8283713, 'binary_recall': 0.7703583, 'binary_specificity': 0.8532934, 'binary_f1_score': 0.79831225}
confusion matrix:
     0    1
0  570   98
1  141  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8303167, 'precision': 0.8314637, 'recall': 0.8303168, 'specificity': 0.8303168, 'f1': 0.8301698, 'auroc': 0.9036466, 'binary_precision': 0.8119658, 'binary_recall': 0.8597285, 'binary_specificity': 0.800905, 'binary_f1_score': 0.83516484}
confusion matrix:
     0    1
0  177   44
1   31  190
early stop counter: 3
val acc:0.8135725259780884, best validation acc: 0.8510140180587769, corresponding to test acc:                         0.8325791954994202 / 0.8325791954994202
after epoch: 6,now: 2024-07-29 07:56:44.802543,epoch time: 0:01:31.472525,used: 0:09:43.815638,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9606481, 'precision': 0.9628629, 'recall': 0.9604703, 'specificity': 0.9604703, 'f1': 0.9605892, 'auroc': 0.9984086, 'binary_precision': 0.93214065, 'binary_recall': 0.99407893, 'binary_specificity': 0.9268617, 'binary_f1_score': 0.962114}
confusion matrix:
      0     1
0  1394   110
1     9  1511
---- Validation: 
scalar performance:
{'acc': 0.8135725, 'precision': 0.83411026, 'recall': 0.818738, 'specificity': 0.818738, 'f1': 0.8121128, 'auroc': 0.9354361, 'binary_precision': 0.74007684, 'binary_recall': 0.9413681, 'binary_specificity': 0.6961078, 'binary_f1_score': 0.82867384}
confusion matrix:
     0    1
0  465  203
1   36  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.8620577, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.8619846, 'auroc': 0.94478, 'binary_precision': 0.85714287, 'binary_recall': 0.8687783, 'binary_specificity': 0.8552036, 'binary_f1_score': 0.86292136}
confusion matrix:
     0    1
0  189   32
1   29  192
new oracle model saved
early stop counter: 4
val acc:0.8135725259780884, best validation acc: 0.8510140180587769, corresponding to test acc:                         0.8325791954994202 / 0.8619909286499023
after epoch: 7,now: 2024-07-29 07:58:21.609621,epoch time: 0:01:36.807078,used: 0:11:20.622716,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9837963, 'precision': 0.98379827, 'recall': 0.9838116, 'specificity': 0.9838116, 'f1': 0.98379624, 'auroc': 0.9991133, 'binary_precision': 0.9867637, 'binary_recall': 0.98092103, 'binary_specificity': 0.98670214, 'binary_f1_score': 0.98383373}
confusion matrix:
      0     1
0  1484    20
1    29  1491
---- Validation: 
scalar performance:
{'acc': 0.85881436, 'precision': 0.86814165, 'recall': 0.85543656, 'specificity': 0.85543656, 'f1': 0.8568811, 'auroc': 0.9235064, 'binary_precision': 0.91714835, 'binary_recall': 0.7752443, 'binary_specificity': 0.9356288, 'binary_f1_score': 0.84024715}
confusion matrix:
     0    1
0  625   43
1  138  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85746604, 'precision': 0.88106775, 'recall': 0.8574661, 'specificity': 0.8574661, 'f1': 0.8552244, 'auroc': 0.94623375, 'binary_precision': 0.97590363, 'binary_recall': 0.7330317, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.83720934}
confusion matrix:
     0    1
0  217    4
1   59  162
better model found
persisted
after epoch: 8,now: 2024-07-29 07:59:59.079739,epoch time: 0:01:37.470118,used: 0:12:58.092834,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9867725, 'precision': 0.9867768, 'recall': 0.9867896, 'specificity': 0.9867896, 'f1': 0.9867724, 'auroc': 0.9991037, 'binary_precision': 0.99006623, 'binary_recall': 0.98355263, 'binary_specificity': 0.9900266, 'binary_f1_score': 0.9867987}
confusion matrix:
      0     1
0  1489    15
1    25  1495
---- Validation: 
scalar performance:
{'acc': 0.83619344, 'precision': 0.85069317, 'recall': 0.8318209, 'specificity': 0.8318209, 'f1': 0.8329735, 'auroc': 0.92060566, 'binary_precision': 0.9122449, 'binary_recall': 0.72801304, 'binary_specificity': 0.9356288, 'binary_f1_score': 0.8097826}
confusion matrix:
     0    1
0  625   43
1  167  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8665158, 'precision': 0.88713235, 'recall': 0.8665159, 'specificity': 0.8665159, 'f1': 0.86471474, 'auroc': 0.94852686, 'binary_precision': 0.9764706, 'binary_recall': 0.75113124, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.8491049}
confusion matrix:
     0    1
0  217    4
1   55  166
new oracle model saved
early stop counter: 1
val acc:0.8361934423446655, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8665158152580261
after epoch: 9,now: 2024-07-29 08:01:34.145656,epoch time: 0:01:35.065917,used: 0:14:33.158751,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98048943, 'precision': 0.9808718, 'recall': 0.98042065, 'specificity': 0.98042065, 'f1': 0.98048294, 'auroc': 0.99917716, 'binary_precision': 0.9685696, 'binary_recall': 0.9934211, 'binary_specificity': 0.9674202, 'binary_f1_score': 0.98083794}
confusion matrix:
      0     1
0  1455    49
1    10  1510
---- Validation: 
scalar performance:
{'acc': 0.81591266, 'precision': 0.8451004, 'recall': 0.8096608, 'specificity': 0.8096608, 'f1': 0.80956817, 'auroc': 0.9195225, 'binary_precision': 0.9354839, 'binary_recall': 0.6612378, 'binary_specificity': 0.9580838, 'binary_f1_score': 0.7748092}
confusion matrix:
     0    1
0  640   28
1  208  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7307692, 'precision': 0.79804844, 'recall': 0.7307692, 'specificity': 0.7307692, 'f1': 0.71466696, 'auroc': 0.9215208, 'binary_precision': 0.9396552, 'binary_recall': 0.49321267, 'binary_specificity': 0.9683258, 'binary_f1_score': 0.64688426}
confusion matrix:
     0    1
0  214    7
1  112  109
early stop counter: 2
val acc:0.815912663936615, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8665158152580261
after epoch: 10,now: 2024-07-29 08:03:05.294047,epoch time: 0:01:31.148391,used: 0:16:04.307142,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98511904, 'precision': 0.98532104, 'recall': 0.9851799, 'specificity': 0.9851799, 'f1': 0.9851185, 'auroc': 0.99920607, 'binary_precision': 0.996633, 'binary_recall': 0.9736842, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.985025}
confusion matrix:
      0     1
0  1499     5
1    40  1480
---- Validation: 
scalar performance:
{'acc': 0.7620905, 'precision': 0.82760894, 'recall': 0.75241864, 'specificity': 0.75241864, 'f1': 0.74465466, 'auroc': 0.9327292, 'binary_precision': 0.963964, 'binary_recall': 0.5228013, 'binary_specificity': 0.98203593, 'binary_f1_score': 0.6779303}
confusion matrix:
     0    1
0  656   12
1  293  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78054297, 'precision': 0.8474843, 'recall': 0.78054297, 'specificity': 0.78054297, 'f1': 0.76943886, 'auroc': 0.94817877, 'binary_precision': 1.0, 'binary_recall': 0.561086, 'binary_specificity': 1.0, 'binary_f1_score': 0.7188406}
confusion matrix:
     0    1
0  221    0
1   97  124
early stop counter: 3
val acc:0.7620905041694641, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8665158152580261
after epoch: 11,now: 2024-07-29 08:04:54.511332,epoch time: 0:01:49.217285,used: 0:17:53.524427,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9884259, 'precision': 0.9884987, 'recall': 0.9883994, 'specificity': 0.9883994, 'f1': 0.9884248, 'auroc': 0.99921304, 'binary_precision': 0.9837133, 'binary_recall': 0.9934211, 'binary_specificity': 0.98337764, 'binary_f1_score': 0.9885434}
confusion matrix:
      0     1
0  1479    25
1    10  1510
---- Validation: 
scalar performance:
{'acc': 0.78861153, 'precision': 0.8068978, 'recall': 0.7831999, 'specificity': 0.7831999, 'f1': 0.7829528, 'auroc': 0.8850701, 'binary_precision': 0.8720173, 'binary_recall': 0.6547231, 'binary_specificity': 0.91167665, 'binary_f1_score': 0.7479069}
confusion matrix:
     0    1
0  609   59
1  212  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81447965, 'precision': 0.8300492, 'recall': 0.81447965, 'specificity': 0.81447965, 'f1': 0.81226563, 'auroc': 0.90409696, 'binary_precision': 0.9017341, 'binary_recall': 0.7058824, 'binary_specificity': 0.9230769, 'binary_f1_score': 0.7918782}
confusion matrix:
     0    1
0  204   17
1   65  156
early stop counter: 4
val acc:0.7886115312576294, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8665158152580261
after epoch: 12,now: 2024-07-29 08:06:23.722224,epoch time: 0:01:29.210892,used: 0:19:22.735319,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9907407, 'precision': 0.9908073, 'recall': 0.990779, 'specificity': 0.990779, 'f1': 0.99074066, 'auroc': 0.99946725, 'binary_precision': 0.99799734, 'binary_recall': 0.98355263, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.99072236}
confusion matrix:
      0     1
0  1501     3
1    25  1495
---- Validation: 
scalar performance:
{'acc': 0.650546, 'precision': 0.7756345, 'recall': 0.63577163, 'specificity': 0.63577163, 'f1': 0.59245795, 'auroc': 0.85828793, 'binary_precision': 0.95108694, 'binary_recall': 0.2850163, 'binary_specificity': 0.98652697, 'binary_f1_score': 0.4385965}
confusion matrix:
     0    1
0  659    9
1  439  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74886876, 'precision': 0.82506955, 'recall': 0.7488688, 'specificity': 0.7488688, 'f1': 0.7332355, 'auroc': 0.90872425, 'binary_precision': 0.98245615, 'binary_recall': 0.50678736, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.6686567}
confusion matrix:
     0    1
0  219    2
1  109  112
early stop counter: 5
val acc:0.6505460143089294, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8665158152580261
after epoch: 13,now: 2024-07-29 08:07:49.973893,epoch time: 0:01:26.251669,used: 0:20:48.986988,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9907407, 'precision': 0.9907372, 'recall': 0.99074745, 'specificity': 0.99074745, 'f1': 0.99074054, 'auroc': 0.99974275, 'binary_precision': 0.99208444, 'binary_recall': 0.9894737, 'binary_specificity': 0.99202126, 'binary_f1_score': 0.9907774}
confusion matrix:
      0     1
0  1492    12
1    16  1504
---- Validation: 
scalar performance:
{'acc': 0.85569423, 'precision': 0.86691684, 'recall': 0.8519817, 'specificity': 0.8519817, 'f1': 0.8534398, 'auroc': 0.92587376, 'binary_precision': 0.92141455, 'binary_recall': 0.76384366, 'binary_specificity': 0.94011974, 'binary_f1_score': 0.8352627}
confusion matrix:
     0    1
0  628   40
1  145  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8665158, 'precision': 0.87829673, 'recall': 0.8665159, 'specificity': 0.8665159, 'f1': 0.8654685, 'auroc': 0.9365902, 'binary_precision': 0.94505495, 'binary_recall': 0.77828056, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.85359806}
confusion matrix:
     0    1
0  211   10
1   49  172
early stop counter: 6
val acc:0.8556942343711853, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8665158152580261
after epoch: 14,now: 2024-07-29 08:09:28.971878,epoch time: 0:01:38.997985,used: 0:22:27.984973,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96660054, 'precision': 0.96867704, 'recall': 0.9664299, 'specificity': 0.9664299, 'f1': 0.9665539, 'auroc': 0.9991343, 'binary_precision': 0.93877554, 'binary_recall': 0.9986842, 'binary_specificity': 0.93417555, 'binary_f1_score': 0.9678037}
confusion matrix:
      0     1
0  1405    99
1     2  1518
---- Validation: 
scalar performance:
{'acc': 0.8424337, 'precision': 0.8421473, 'recall': 0.8426144, 'specificity': 0.8426144, 'f1': 0.84228015, 'auroc': 0.90640295, 'binary_precision': 0.82802546, 'binary_recall': 0.8469055, 'binary_specificity': 0.83832335, 'binary_f1_score': 0.837359}
confusion matrix:
     0    1
0  560  108
1   94  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89366513, 'precision': 0.89548707, 'recall': 0.8936652, 'specificity': 0.8936652, 'f1': 0.8935426, 'auroc': 0.9452509, 'binary_precision': 0.9223301, 'binary_recall': 0.8597285, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.8899298}
confusion matrix:
     0    1
0  205   16
1   31  190
new oracle model saved
early stop counter: 7
val acc:0.8424336910247803, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 15,now: 2024-07-29 08:11:01.472670,epoch time: 0:01:32.500792,used: 0:24:00.485765,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98544973, 'precision': 0.98575485, 'recall': 0.9855228, 'specificity': 0.9855228, 'f1': 0.98544866, 'auroc': 0.9995289, 'binary_precision': 0.9993234, 'binary_recall': 0.9717105, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.98532355}
confusion matrix:
      0     1
0  1503     1
1    43  1477
---- Validation: 
scalar performance:
{'acc': 0.6544462, 'precision': 0.7898241, 'recall': 0.63951415, 'specificity': 0.63951415, 'f1': 0.5956104, 'auroc': 0.9127872, 'binary_precision': 0.9776536, 'binary_recall': 0.2850163, 'binary_specificity': 0.994012, 'binary_f1_score': 0.44136193}
confusion matrix:
     0    1
0  664    4
1  439  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60181, 'precision': 0.77833754, 'recall': 0.60181, 'specificity': 0.60181, 'f1': 0.5267781, 'auroc': 0.93135375, 'binary_precision': 1.0, 'binary_recall': 0.20361991, 'binary_specificity': 1.0, 'binary_f1_score': 0.33834586}
confusion matrix:
     0   1
0  221   0
1  176  45
early stop counter: 8
val acc:0.6544461846351624, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 16,now: 2024-07-29 08:12:37.148776,epoch time: 0:01:35.676106,used: 0:25:36.161871,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9910714, 'precision': 0.9910855, 'recall': 0.99109393, 'specificity': 0.99109393, 'f1': 0.99107146, 'auroc': 0.9994917, 'binary_precision': 0.995355, 'binary_recall': 0.9868421, 'binary_specificity': 0.9953458, 'binary_f1_score': 0.9910803}
confusion matrix:
      0     1
0  1497     7
1    20  1500
---- Validation: 
scalar performance:
{'acc': 0.7714509, 'precision': 0.82112384, 'recall': 0.7629147, 'specificity': 0.7629147, 'f1': 0.75811684, 'auroc': 0.9136052, 'binary_precision': 0.9373297, 'binary_recall': 0.5602606, 'binary_specificity': 0.96556884, 'binary_f1_score': 0.70132524}
confusion matrix:
     0    1
0  645   23
1  270  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.760181, 'precision': 0.83418804, 'recall': 0.760181, 'specificity': 0.760181, 'f1': 0.7461257, 'auroc': 0.94389963, 'binary_precision': 0.991453, 'binary_recall': 0.5248869, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.6863906}
confusion matrix:
     0    1
0  220    1
1  105  116
early stop counter: 9
val acc:0.7714508771896362, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 17,now: 2024-07-29 08:14:14.865760,epoch time: 0:01:37.716984,used: 0:27:13.878855,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98743385, 'precision': 0.9874985, 'recall': 0.987409, 'specificity': 0.987409, 'f1': 0.9874326, 'auroc': 0.9993924, 'binary_precision': 0.9830508, 'binary_recall': 0.99210525, 'binary_specificity': 0.98271275, 'binary_f1_score': 0.9875573}
confusion matrix:
      0     1
0  1478    26
1    12  1508
---- Validation: 
scalar performance:
{'acc': 0.7176287, 'precision': 0.7340369, 'recall': 0.7113997, 'specificity': 0.7113997, 'f1': 0.7084057, 'auroc': 0.8304628, 'binary_precision': 0.78636366, 'binary_recall': 0.5635179, 'binary_specificity': 0.8592814, 'binary_f1_score': 0.6565465}
confusion matrix:
     0    1
0  574   94
1  268  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81447965, 'precision': 0.8212142, 'recall': 0.81447965, 'specificity': 0.81447965, 'f1': 0.81350213, 'auroc': 0.8781147, 'binary_precision': 0.8677249, 'binary_recall': 0.74208146, 'binary_specificity': 0.88687783, 'binary_f1_score': 0.8000001}
confusion matrix:
     0    1
0  196   25
1   57  164
early stop counter: 10
val acc:0.7176287174224854, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 18,now: 2024-07-29 08:15:53.801904,epoch time: 0:01:38.936144,used: 0:28:52.814999,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9927249, 'precision': 0.99272925, 'recall': 0.9927422, 'specificity': 0.9927422, 'f1': 0.9927249, 'auroc': 0.9998114, 'binary_precision': 0.9960265, 'binary_recall': 0.9894737, 'binary_specificity': 0.99601066, 'binary_f1_score': 0.9927393}
confusion matrix:
      0     1
0  1498     6
1    16  1504
---- Validation: 
scalar performance:
{'acc': 0.7199688, 'precision': 0.7845411, 'recall': 0.7094979, 'specificity': 0.7094979, 'f1': 0.69642794, 'auroc': 0.88361454, 'binary_precision': 0.90996784, 'binary_recall': 0.46091205, 'binary_specificity': 0.9580838, 'binary_f1_score': 0.61189187}
confusion matrix:
     0    1
0  640   28
1  331  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325792, 'precision': 0.86514556, 'recall': 0.8325792, 'specificity': 0.8325792, 'f1': 0.8287611, 'auroc': 0.92381394, 'binary_precision': 0.9741936, 'binary_recall': 0.68325794, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.80319154}
confusion matrix:
     0    1
0  217    4
1   70  151
early stop counter: 11
val acc:0.7199687957763672, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 19,now: 2024-07-29 08:17:33.922923,epoch time: 0:01:40.121019,used: 0:30:32.936018,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9818122, 'precision': 0.9822329, 'recall': 0.98173994, 'specificity': 0.98173994, 'f1': 0.9818057, 'auroc': 0.99968374, 'binary_precision': 0.9692505, 'binary_recall': 0.99539477, 'binary_specificity': 0.9680851, 'binary_f1_score': 0.9821487}
confusion matrix:
      0     1
0  1456    48
1     7  1513
---- Validation: 
scalar performance:
{'acc': 0.8096724, 'precision': 0.82839984, 'recall': 0.8044628, 'specificity': 0.8044628, 'f1': 0.8048268, 'auroc': 0.90031683, 'binary_precision': 0.8969957, 'binary_recall': 0.6807818, 'binary_specificity': 0.92814374, 'binary_f1_score': 0.7740741}
confusion matrix:
     0    1
0  620   48
1  196  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348416, 'precision': 0.8665501, 'recall': 0.8348416, 'specificity': 0.8348416, 'f1': 0.83119094, 'auroc': 0.9362216, 'binary_precision': 0.974359, 'binary_recall': 0.6877828, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.806366}
confusion matrix:
     0    1
0  217    4
1   69  152
early stop counter: 12
val acc:0.8096724152565002, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 20,now: 2024-07-29 08:19:11.912678,epoch time: 0:01:37.989755,used: 0:32:10.925773,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9930556, 'precision': 0.9930693, 'recall': 0.99304664, 'specificity': 0.99304664, 'f1': 0.9930552, 'auroc': 0.9998127, 'binary_precision': 0.9914754, 'binary_recall': 0.99473685, 'binary_specificity': 0.9913564, 'binary_f1_score': 0.99310344}
confusion matrix:
      0     1
0  1491    13
1     8  1512
---- Validation: 
scalar performance:
{'acc': 0.84165365, 'precision': 0.84767854, 'recall': 0.83877194, 'specificity': 0.83877194, 'f1': 0.8399309, 'auroc': 0.908785, 'binary_precision': 0.8841122, 'binary_recall': 0.7703583, 'binary_specificity': 0.9071856, 'binary_f1_score': 0.82332474}
confusion matrix:
     0    1
0  606   62
1  141  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.8520371, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.8404497, 'auroc': 0.9113859, 'binary_precision': 0.91256833, 'binary_recall': 0.7556561, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.8267327}
confusion matrix:
     0    1
0  205   16
1   54  167
early stop counter: 13
val acc:0.8416536450386047, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 21,now: 2024-07-29 08:20:49.604195,epoch time: 0:01:37.691517,used: 0:33:48.617290,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99338627, 'precision': 0.9933835, 'recall': 0.99338955, 'specificity': 0.99338955, 'f1': 0.9933861, 'auroc': 0.9998727, 'binary_precision': 0.9940711, 'binary_recall': 0.99276316, 'binary_specificity': 0.99401593, 'binary_f1_score': 0.9934167}
confusion matrix:
      0     1
0  1495     9
1    11  1509
---- Validation: 
scalar performance:
{'acc': 0.8471139, 'precision': 0.8617655, 'recall': 0.84282655, 'specificity': 0.84282655, 'f1': 0.844177, 'auroc': 0.9228865, 'binary_precision': 0.92479676, 'binary_recall': 0.7410423, 'binary_specificity': 0.9446108, 'binary_f1_score': 0.8227848}
confusion matrix:
     0    1
0  631   37
1  159  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8552036, 'precision': 0.867234, 'recall': 0.8552036, 'specificity': 0.8552036, 'f1': 0.85400796, 'auroc': 0.92805225, 'binary_precision': 0.93370163, 'binary_recall': 0.7647059, 'binary_specificity': 0.94570136, 'binary_f1_score': 0.840796}
confusion matrix:
     0    1
0  209   12
1   52  169
early stop counter: 14
val acc:0.8471139073371887, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 22,now: 2024-07-29 08:22:29.123648,epoch time: 0:01:39.519453,used: 0:35:28.136743,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98710316, 'precision': 0.98730576, 'recall': 0.987164, 'specificity': 0.987164, 'f1': 0.9871026, 'auroc': 0.99957085, 'binary_precision': 0.9986532, 'binary_recall': 0.9756579, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.98702157}
confusion matrix:
      0     1
0  1502     2
1    37  1483
---- Validation: 
scalar performance:
{'acc': 0.60530424, 'precision': 0.77151674, 'recall': 0.5881454, 'specificity': 0.5881454, 'f1': 0.514673, 'auroc': 0.91204417, 'binary_precision': 0.9736842, 'binary_recall': 0.18078175, 'binary_specificity': 0.99550897, 'binary_f1_score': 0.30494505}
confusion matrix:
     0    1
0  665    3
1  503  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58371043, 'precision': 0.77283955, 'recall': 0.58371043, 'specificity': 0.58371043, 'f1': 0.496446, 'auroc': 0.9410127, 'binary_precision': 1.0, 'binary_recall': 0.16742082, 'binary_specificity': 1.0, 'binary_f1_score': 0.2868217}
confusion matrix:
     0   1
0  221   0
1  184  37
early stop counter: 15
val acc:0.6053042411804199, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 23,now: 2024-07-29 08:24:08.702744,epoch time: 0:01:39.579096,used: 0:37:07.715839,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99041003, 'precision': 0.99042416, 'recall': 0.9904325, 'specificity': 0.9904325, 'f1': 0.99041, 'auroc': 0.99970996, 'binary_precision': 0.99469143, 'binary_recall': 0.98618424, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.9904195}
confusion matrix:
      0     1
0  1496     8
1    21  1499
---- Validation: 
scalar performance:
{'acc': 0.71372855, 'precision': 0.81029224, 'recall': 0.7016009, 'specificity': 0.7016009, 'f1': 0.6816415, 'auroc': 0.9274586, 'binary_precision': 0.97318006, 'binary_recall': 0.4136808, 'binary_specificity': 0.98952097, 'binary_f1_score': 0.5805714}
confusion matrix:
     0    1
0  661    7
1  360  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7375566, 'precision': 0.8236853, 'recall': 0.7375566, 'specificity': 0.7375566, 'f1': 0.7188542, 'auroc': 0.9435924, 'binary_precision': 0.99065423, 'binary_recall': 0.479638, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.64634144}
confusion matrix:
     0    1
0  220    1
1  115  106
early stop counter: 16
val acc:0.7137285470962524, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 24,now: 2024-07-29 08:25:48.035976,epoch time: 0:01:39.333232,used: 0:38:47.049071,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99041003, 'precision': 0.99042356, 'recall': 0.990401, 'specificity': 0.990401, 'f1': 0.9904096, 'auroc': 0.9995923, 'binary_precision': 0.98885244, 'binary_recall': 0.99210525, 'binary_specificity': 0.9886968, 'binary_f1_score': 0.9904762}
confusion matrix:
      0     1
0  1487    17
1    12  1508
---- Validation: 
scalar performance:
{'acc': 0.84477377, 'precision': 0.862076, 'recall': 0.8401202, 'specificity': 0.8401202, 'f1': 0.8413992, 'auroc': 0.9219582, 'binary_precision': 0.9313929, 'binary_recall': 0.7296417, 'binary_specificity': 0.9505988, 'binary_f1_score': 0.8182648}
confusion matrix:
     0    1
0  635   33
1  166  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8642534, 'precision': 0.8753507, 'recall': 0.8642534, 'specificity': 0.8642534, 'f1': 0.8632425, 'auroc': 0.92408013, 'binary_precision': 0.9398907, 'binary_recall': 0.77828056, 'binary_specificity': 0.95022625, 'binary_f1_score': 0.85148513}
confusion matrix:
     0    1
0  210   11
1   49  172
early stop counter: 17
val acc:0.8447737693786621, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 25,now: 2024-07-29 08:27:31.622154,epoch time: 0:01:43.586178,used: 0:40:30.635249,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98974866, 'precision': 0.9898231, 'recall': 0.98978865, 'specificity': 0.98978865, 'f1': 0.9897486, 'auroc': 0.99967235, 'binary_precision': 0.997328, 'binary_recall': 0.98223686, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9897249}
confusion matrix:
      0     1
0  1500     4
1    27  1493
---- Validation: 
scalar performance:
{'acc': 0.7215289, 'precision': 0.81084585, 'recall': 0.7098759, 'specificity': 0.7098759, 'f1': 0.69264543, 'auroc': 0.93113774, 'binary_precision': 0.9672727, 'binary_recall': 0.43322477, 'binary_specificity': 0.98652697, 'binary_f1_score': 0.5984252}
confusion matrix:
     0    1
0  659    9
1  348  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6334842, 'precision': 0.7730452, 'recall': 0.6334842, 'specificity': 0.6334842, 'f1': 0.5797887, 'auroc': 0.9233841, 'binary_precision': 0.96825397, 'binary_recall': 0.2760181, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.42957747}
confusion matrix:
     0   1
0  219   2
1  160  61
early stop counter: 18
val acc:0.7215288877487183, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 26,now: 2024-07-29 08:29:11.607028,epoch time: 0:01:39.984874,used: 0:42:10.620123,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9950397, 'precision': 0.99503636, 'recall': 0.9950483, 'specificity': 0.9950483, 'f1': 0.9950396, 'auroc': 0.9998894, 'binary_precision': 0.9966997, 'binary_recall': 0.9934211, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.99505764}
confusion matrix:
      0     1
0  1499     5
1    10  1510
---- Validation: 
scalar performance:
{'acc': 0.85569423, 'precision': 0.87844193, 'recall': 0.8505335, 'specificity': 0.8505335, 'f1': 0.85198283, 'auroc': 0.94751394, 'binary_precision': 0.9612903, 'binary_recall': 0.72801304, 'binary_specificity': 0.9730539, 'binary_f1_score': 0.82854486}
confusion matrix:
     0    1
0  650   18
1  167  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8054299, 'precision': 0.8541919, 'recall': 0.8054299, 'specificity': 0.8054299, 'f1': 0.7984945, 'auroc': 0.94007087, 'binary_precision': 0.9856115, 'binary_recall': 0.6199095, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.76111114}
confusion matrix:
     0    1
0  219    2
1   84  137
early stop counter: 19
val acc:0.8556942343711853, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 27,now: 2024-07-29 08:30:50.708262,epoch time: 0:01:39.101234,used: 0:43:49.721357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99404764, 'precision': 0.9941137, 'recall': 0.99402297, 'specificity': 0.99402297, 'f1': 0.99404705, 'auroc': 0.99994576, 'binary_precision': 0.9895697, 'binary_recall': 0.9986842, 'binary_specificity': 0.9893617, 'binary_f1_score': 0.99410605}
confusion matrix:
      0     1
0  1488    16
1     2  1518
---- Validation: 
scalar performance:
{'acc': 0.8315133, 'precision': 0.84870625, 'recall': 0.8267374, 'specificity': 0.8267374, 'f1': 0.82772934, 'auroc': 0.9257275, 'binary_precision': 0.916318, 'binary_recall': 0.71335506, 'binary_specificity': 0.94011974, 'binary_f1_score': 0.8021978}
confusion matrix:
     0    1
0  628   40
1  176  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7647059, 'precision': 0.814585, 'recall': 0.7647059, 'specificity': 0.7647059, 'f1': 0.75499415, 'auroc': 0.9289532, 'binary_precision': 0.9398496, 'binary_recall': 0.5656109, 'binary_specificity': 0.9638009, 'binary_f1_score': 0.70621467}
confusion matrix:
     0    1
0  213    8
1   96  125
early stop counter: 20
val acc:0.8315132856369019, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 28,now: 2024-07-29 08:32:30.675110,epoch time: 0:01:39.966848,used: 0:45:29.688205,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99603176, 'precision': 0.99602914, 'recall': 0.99604213, 'specificity': 0.99604213, 'f1': 0.9960317, 'auroc': 0.9998512, 'binary_precision': 0.9980185, 'binary_recall': 0.99407893, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.9960449}
confusion matrix:
      0     1
0  1501     3
1     9  1511
---- Validation: 
scalar performance:
{'acc': 0.78627145, 'precision': 0.8218025, 'recall': 0.77904534, 'specificity': 0.77904534, 'f1': 0.7769557, 'auroc': 0.91903186, 'binary_precision': 0.91871923, 'binary_recall': 0.60749185, 'binary_specificity': 0.9505988, 'binary_f1_score': 0.7313726}
confusion matrix:
     0    1
0  635   33
1  241  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7692308, 'precision': 0.80534077, 'recall': 0.7692308, 'specificity': 0.7692308, 'f1': 0.7622002, 'auroc': 0.89312255, 'binary_precision': 0.91034484, 'binary_recall': 0.5972851, 'binary_specificity': 0.9411765, 'binary_f1_score': 0.7213115}
confusion matrix:
     0    1
0  208   13
1   89  132
early stop counter: 21
val acc:0.7862714529037476, best validation acc: 0.8588143587112427, corresponding to test acc:                         0.8574660420417786 / 0.8936651349067688
after epoch: 29,now: 2024-07-29 08:34:09.103290,epoch time: 0:01:38.428180,used: 0:47:08.116385,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.97652113, 'precision': 0.97739464, 'recall': 0.9764138, 'specificity': 0.9764138, 'f1': 0.97650594, 'auroc': 0.9996172, 'binary_precision': 0.9582543, 'binary_recall': 0.99671054, 'binary_specificity': 0.95611703, 'binary_f1_score': 0.9771041}
confusion matrix:
      0     1
0  1438    66
1     5  1515
---- Validation: 
scalar performance:
{'acc': 0.8603744, 'precision': 0.8603122, 'recall': 0.86094916, 'specificity': 0.86094916, 'f1': 0.8603029, 'auroc': 0.93070865, 'binary_precision': 0.8403756, 'binary_recall': 0.87459284, 'binary_specificity': 0.8473054, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  566  102
1   77  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8665158, 'precision': 0.87829673, 'recall': 0.8665159, 'specificity': 0.8665159, 'f1': 0.8654685, 'auroc': 0.9357916, 'binary_precision': 0.94505495, 'binary_recall': 0.77828056, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.85359806}
confusion matrix:
     0    1
0  211   10
1   49  172
better model found
persisted
after epoch: 30,now: 2024-07-29 08:35:48.427063,epoch time: 0:01:39.323773,used: 0:48:47.440158,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_07_47_00_seed_10_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:47.440158 at 2024-07-29 08:35:48.427063
persisted model performance metric: 

scalar performance:
{'acc': 0.8665158, 'precision': 0.87829673, 'recall': 0.8665159, 'specificity': 0.8665159, 'f1': 0.8654685, 'auroc': 0.9357916, 'binary_precision': 0.94505495, 'binary_recall': 0.77828056, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.85359806}
confusion matrix:
     0    1
0  211   10
1   49  172
oracle model performance metric: 

scalar performance:
{'acc': 0.89366513, 'precision': 0.89548707, 'recall': 0.8936652, 'specificity': 0.8936652, 'f1': 0.8935426, 'auroc': 0.9452509, 'binary_precision': 0.9223301, 'binary_recall': 0.8597285, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.8899298}
confusion matrix:
     0    1
0  205   16
1   31  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454147 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool | 413552 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |  40595 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454147 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool | 413552 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |  40595 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |  40406 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14490 MiB | 150274 MiB | 135796 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 150050 MiB | 135638 MiB |
|       from small pool |     66 MiB |     70 MiB |    224 MiB |    158 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 436732 KiB |   1260 MiB | 576489 GiB | 576489 GiB |
|       from large pool | 426128 KiB |   1256 MiB | 566822 GiB | 566821 GiB |
|       from small pool |  10604 KiB |     45 MiB |   9667 GiB |   9667 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  142885 K  |  142883 K  |
|       from large pool |     187    |    1413    |   72670 K  |   72669 K  |
|       from small pool |    1117    |    1419    |   70215 K  |   70213 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  142885 K  |  142883 K  |
|       from large pool |     187    |    1413    |   72670 K  |   72669 K  |
|       from small pool |    1117    |    1419    |   70215 K  |   70213 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    6353    |    5717    |
|       from large pool |     603    |     603    |    6241    |    5638    |
|       from small pool |      33    |      35    |     112    |      79    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     652    |   96191 K  |   96191 K  |
|       from large pool |      37    |     608    |   54699 K  |   54699 K  |
|       from small pool |      63    |     236    |   41492 K  |   41492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    870 MiB |  14490 MiB | 150274 MiB | 149404 MiB |
|       from large pool |    820 MiB |  14424 MiB | 150050 MiB | 149230 MiB |
|       from small pool |     50 MiB |     70 MiB |    224 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 576489 GiB | 576489 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 566822 GiB | 566822 GiB |
|       from small pool |      0 KiB |     45 MiB |   9667 GiB |   9667 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    6353    |    6290    |
|       from large pool |      38    |     603    |    6241    |    6203    |
|       from small pool |      25    |      35    |     112    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   96191 K  |   96191 K  |
|       from large pool |       3    |     608    |   54699 K  |   54699 K  |
|       from small pool |       0    |     236    |   41492 K  |   41492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    795 TiB |    795 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    786 TiB |    786 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    793 TiB |    793 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    783 TiB |    783 TiB |
|       from small pool |      0 KiB |     60 MiB |      9 TiB |      9 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    870 MiB |  14490 MiB | 150274 MiB | 149404 MiB |
|       from large pool |    820 MiB |  14424 MiB | 150050 MiB | 149230 MiB |
|       from small pool |     50 MiB |     70 MiB |    224 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 576489 GiB | 576489 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 566822 GiB | 566822 GiB |
|       from small pool |      0 KiB |     45 MiB |   9667 GiB |   9667 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  142885 K  |  142885 K  |
|       from large pool |       2    |    1413    |   72670 K  |   72670 K  |
|       from small pool |       0    |    1419    |   70215 K  |   70215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     637    |    6353    |    6290    |
|       from large pool |      38    |     603    |    6241    |    6203    |
|       from small pool |      25    |      35    |     112    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |   96191 K  |   96191 K  |
|       from large pool |       3    |     608    |   54699 K  |   54699 K  |
|       from small pool |       0    |     236    |   41492 K  |   41492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367

 Experiment start at: 2024-07-29 08:36:37.517898
before training, model accuracy: 0.5371178984642029
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9424084, 'precision': 0.9463078, 'recall': 0.9433248, 'specificity': 0.9433248, 'f1': 0.9423467, 'auroc': 0.9914263, 'binary_precision': 0.99285716, 'binary_recall': 0.8933162, 'binary_specificity': 0.99333334, 'binary_f1_score': 0.94046015}
confusion matrix:
      0     1
0  1490    10
1   166  1390
---- Validation: 
scalar performance:
{'acc': 0.843318, 'precision': 0.8431634, 'recall': 0.843319, 'specificity': 0.843319, 'f1': 0.84322333, 'auroc': 0.907961, 'binary_precision': 0.8354232, 'binary_recall': 0.8433544, 'binary_specificity': 0.8432836, 'binary_f1_score': 0.8393701}
confusion matrix:
     0    1
0  565  105
1   99  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.86250764, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8624395, 'auroc': 0.9329914, 'binary_precision': 0.86725664, 'binary_recall': 0.8558952, 'binary_specificity': 0.8689956, 'binary_f1_score': 0.86153847}
confusion matrix:
     0    1
0  199   30
1   33  196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 08:38:27.041535,epoch time: 0:01:49.523637,used: 0:01:49.523637,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.9733976, 'recall': 0.9734584, 'specificity': 0.9734584, 'f1': 0.9731674, 'auroc': 0.9962609, 'binary_precision': 0.9893758, 'binary_recall': 0.95758355, 'binary_specificity': 0.98933333, 'binary_f1_score': 0.9732201}
confusion matrix:
      0     1
0  1484    16
1    66  1490
---- Validation: 
scalar performance:
{'acc': 0.7880184, 'precision': 0.82589924, 'recall': 0.7829468, 'specificity': 0.7829468, 'f1': 0.77949375, 'auroc': 0.89348435, 'binary_precision': 0.92995167, 'binary_recall': 0.60917723, 'binary_specificity': 0.9567164, 'binary_f1_score': 0.7361377}
confusion matrix:
     0    1
0  641   29
1  247  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.8807266, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.8510699, 'auroc': 0.93405926, 'binary_precision': 0.98214287, 'binary_recall': 0.720524, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8312343}
confusion matrix:
     0    1
0  226    3
1   64  165
early stop counter: 1
val acc:0.7880184054374695, best validation acc: 0.843317985534668, corresponding to test acc:                         0.8624454140663147 / 0.8624454140663147
after epoch: 2,now: 2024-07-29 08:39:58.619576,epoch time: 0:01:31.578041,used: 0:03:21.101678,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.98000735, 'recall': 0.98015857, 'specificity': 0.98015857, 'f1': 0.9800366, 'auroc': 0.9976941, 'binary_precision': 0.98697066, 'binary_recall': 0.9736504, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.98026526}
confusion matrix:
      0     1
0  1480    20
1    41  1515
---- Validation: 
scalar performance:
{'acc': 0.8325653, 'precision': 0.83314836, 'recall': 0.8318392, 'specificity': 0.8318392, 'f1': 0.83215976, 'auroc': 0.9021065, 'binary_precision': 0.84158415, 'binary_recall': 0.806962, 'binary_specificity': 0.8567164, 'binary_f1_score': 0.8239095}
confusion matrix:
     0    1
0  574   96
1  122  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.84249884, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.8403914, 'auroc': 0.92973053, 'binary_precision': 0.81707317, 'binary_recall': 0.87772924, 'binary_specificity': 0.80349344, 'binary_f1_score': 0.84631574}
confusion matrix:
     0    1
0  184   45
1   28  201
early stop counter: 2
val acc:0.8325653076171875, best validation acc: 0.843317985534668, corresponding to test acc:                         0.8624454140663147 / 0.8624454140663147
after epoch: 3,now: 2024-07-29 08:41:41.703192,epoch time: 0:01:43.083616,used: 0:05:04.185294,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.98032284, 'recall': 0.98048747, 'specificity': 0.98048747, 'f1': 0.98036313, 'auroc': 0.9978242, 'binary_precision': 0.9869961, 'binary_recall': 0.9743261, 'binary_specificity': 0.98664886, 'binary_f1_score': 0.98062015}
confusion matrix:
      0     1
0  1478    20
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.8663595, 'precision': 0.8718638, 'recall': 0.8645853, 'specificity': 0.8645853, 'f1': 0.8653632, 'auroc': 0.91186, 'binary_precision': 0.91039425, 'binary_recall': 0.8037975, 'binary_specificity': 0.92537314, 'binary_f1_score': 0.8537815}
confusion matrix:
     0    1
0  620   50
1  124  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8668122, 'precision': 0.88441247, 'recall': 0.8668122, 'specificity': 0.8668122, 'f1': 0.86527014, 'auroc': 0.924067, 'binary_precision': 0.96666664, 'binary_recall': 0.75982535, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.8508558}
confusion matrix:
     0    1
0  223    6
1   55  174
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-29 08:43:24.492125,epoch time: 0:01:42.788933,used: 0:06:46.974227,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98391366, 'recall': 0.98407227, 'specificity': 0.98407227, 'f1': 0.9839624, 'auroc': 0.9987304, 'binary_precision': 0.98962384, 'binary_recall': 0.9788326, 'binary_specificity': 0.98931193, 'binary_f1_score': 0.98419863}
confusion matrix:
      0     1
0  1481    16
1    33  1526
---- Validation: 
scalar performance:
{'acc': 0.81490016, 'precision': 0.8401872, 'recall': 0.81086105, 'specificity': 0.81086105, 'f1': 0.8099078, 'auroc': 0.9124882, 'binary_precision': 0.9259259, 'binary_recall': 0.67246836, 'binary_specificity': 0.94925374, 'binary_f1_score': 0.7791017}
confusion matrix:
     0    1
0  636   34
1  207  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056769, 'precision': 0.84938973, 'recall': 0.8056768, 'specificity': 0.8056768, 'f1': 0.7994026, 'auroc': 0.9177742, 'binary_precision': 0.972973, 'binary_recall': 0.62882096, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.76392573}
confusion matrix:
     0    1
0  225    4
1   85  144
early stop counter: 1
val acc:0.8149001598358154, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8668122291564941
after epoch: 5,now: 2024-07-29 08:45:06.513943,epoch time: 0:01:42.021818,used: 0:08:28.996045,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9610602, 'precision': 0.9639877, 'recall': 0.960369, 'specificity': 0.960369, 'f1': 0.9609436, 'auroc': 0.9988642, 'binary_precision': 0.9315726, 'binary_recall': 0.9967887, 'binary_specificity': 0.9239493, 'binary_f1_score': 0.9630779}
confusion matrix:
      0     1
0  1385   114
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.8202765, 'precision': 0.82252127, 'recall': 0.8189566, 'specificity': 0.8189566, 'f1': 0.81941366, 'auroc': 0.8758832, 'binary_precision': 0.84310347, 'binary_recall': 0.77373415, 'binary_specificity': 0.8641791, 'binary_f1_score': 0.8069307}
confusion matrix:
     0    1
0  579   91
1  143  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8794439, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.86808753, 'auroc': 0.943403, 'binary_precision': 0.9424084, 'binary_recall': 0.7860262, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  218   11
1   49  180
new oracle model saved
early stop counter: 2
val acc:0.8202764987945557, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 6,now: 2024-07-29 08:46:49.926269,epoch time: 0:01:43.412326,used: 0:10:12.408371,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9761711, 'recall': 0.97604805, 'specificity': 0.97604805, 'f1': 0.97610104, 'auroc': 0.9974404, 'binary_precision': 0.97381866, 'binary_recall': 0.97944766, 'binary_specificity': 0.97264844, 'binary_f1_score': 0.976625}
confusion matrix:
      0     1
0  1458    41
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.8356375, 'precision': 0.8444805, 'recall': 0.83325386, 'specificity': 0.83325386, 'f1': 0.83377004, 'auroc': 0.8913919, 'binary_precision': 0.89285713, 'binary_recall': 0.75158226, 'binary_specificity': 0.9149254, 'binary_f1_score': 0.8161512}
confusion matrix:
     0    1
0  613   57
1  157  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.85140085, 'recall': 0.83842796, 'specificity': 0.83842796, 'f1': 0.8369228, 'auroc': 0.90961266, 'binary_precision': 0.9189189, 'binary_recall': 0.7423581, 'binary_specificity': 0.93449783, 'binary_f1_score': 0.821256}
confusion matrix:
     0    1
0  214   15
1   59  170
early stop counter: 3
val acc:0.8356375098228455, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 7,now: 2024-07-29 08:48:31.995063,epoch time: 0:01:42.068794,used: 0:11:54.477165,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.97132957, 'recall': 0.9708333, 'specificity': 0.9708333, 'f1': 0.9702202, 'auroc': 0.99921286, 'binary_precision': 1.0, 'binary_recall': 0.94166666, 'binary_specificity': 1.0, 'binary_f1_score': 0.9699571}
confusion matrix:
      0     1
0  1496     0
1    91  1469
---- Validation: 
scalar performance:
{'acc': 0.56374806, 'precision': 0.7492695, 'recall': 0.55076754, 'specificity': 0.55076754, 'f1': 0.4461251, 'auroc': 0.8791925, 'binary_precision': 0.95714283, 'binary_recall': 0.10601266, 'binary_specificity': 0.9955224, 'binary_f1_score': 0.19088319}
confusion matrix:
     0   1
0  667   3
1  565  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5327511, 'precision': 0.75846505, 'recall': 0.5327511, 'specificity': 0.5327511, 'f1': 0.4022492, 'auroc': 0.92986405, 'binary_precision': 1.0, 'binary_recall': 0.06550218, 'binary_specificity': 1.0, 'binary_f1_score': 0.122950815}
confusion matrix:
     0   1
0  229   0
1  214  15
early stop counter: 4
val acc:0.5637480616569519, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 8,now: 2024-07-29 08:50:12.874696,epoch time: 0:01:40.879633,used: 0:13:35.356798,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885355, 'recall': 0.98871076, 'specificity': 0.98871076, 'f1': 0.9885459, 'auroc': 0.9996671, 'binary_precision': 0.9973856, 'binary_recall': 0.9800899, 'binary_specificity': 0.99733156, 'binary_f1_score': 0.9886621}
confusion matrix:
      0     1
0  1495     4
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.7066052, 'precision': 0.78666353, 'recall': 0.69868225, 'specificity': 0.69868225, 'f1': 0.67928636, 'auroc': 0.89826417, 'binary_precision': 0.9310345, 'binary_recall': 0.4272152, 'binary_specificity': 0.9701493, 'binary_f1_score': 0.5856833}
confusion matrix:
     0    1
0  650   20
1  362  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.87045795, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.837335, 'auroc': 0.93732, 'binary_precision': 0.9756098, 'binary_recall': 0.69868994, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.81424934}
confusion matrix:
     0    1
0  225    4
1   69  160
early stop counter: 5
val acc:0.7066051959991455, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 9,now: 2024-07-29 08:51:54.532380,epoch time: 0:01:41.657684,used: 0:15:17.014482,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97796667, 'recall': 0.97781575, 'specificity': 0.97781575, 'f1': 0.97742116, 'auroc': 0.99949956, 'binary_precision': 0.99932843, 'binary_recall': 0.9562982, 'binary_specificity': 0.9993333, 'binary_f1_score': 0.97733986}
confusion matrix:
      0     1
0  1499     1
1    68  1488
---- Validation: 
scalar performance:
{'acc': 0.6966206, 'precision': 0.7883352, 'recall': 0.68817306, 'specificity': 0.68817306, 'f1': 0.6644757, 'auroc': 0.90659595, 'binary_precision': 0.94382024, 'binary_recall': 0.39873418, 'binary_specificity': 0.97761196, 'binary_f1_score': 0.56062293}
confusion matrix:
     0    1
0  655   15
1  380  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6899563, 'precision': 0.80862534, 'recall': 0.6899563, 'specificity': 0.6899563, 'f1': 0.65698314, 'auroc': 0.92757577, 'binary_precision': 1.0, 'binary_recall': 0.37991267, 'binary_specificity': 1.0, 'binary_f1_score': 0.55063295}
confusion matrix:
     0   1
0  229   0
1  142  87
early stop counter: 6
val acc:0.6966205835342407, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 10,now: 2024-07-29 08:53:36.588025,epoch time: 0:01:42.055645,used: 0:16:59.070127,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901921, 'recall': 0.9901686, 'specificity': 0.9901686, 'f1': 0.9901799, 'auroc': 0.99971724, 'binary_precision': 0.9897238, 'binary_recall': 0.9909968, 'binary_specificity': 0.9893404, 'binary_f1_score': 0.9903599}
confusion matrix:
      0     1
0  1485    16
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8302611, 'precision': 0.8550776, 'recall': 0.82636976, 'specificity': 0.82636976, 'f1': 0.8259462, 'auroc': 0.8952036, 'binary_precision': 0.9419355, 'binary_recall': 0.693038, 'binary_specificity': 0.9597015, 'binary_f1_score': 0.7985414}
confusion matrix:
     0    1
0  643   27
1  194  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231441, 'precision': 0.86935484, 'recall': 0.8231441, 'specificity': 0.8231441, 'f1': 0.81743383, 'auroc': 0.929559, 'binary_precision': 1.0, 'binary_recall': 0.6462882, 'binary_specificity': 1.0, 'binary_f1_score': 0.78514594}
confusion matrix:
     0    1
0  229    0
1   81  148
early stop counter: 7
val acc:0.8302611112594604, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 11,now: 2024-07-29 08:55:20.988071,epoch time: 0:01:44.400046,used: 0:18:43.470173,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98888034, 'recall': 0.98903286, 'specificity': 0.98903286, 'f1': 0.9888735, 'auroc': 0.9991826, 'binary_precision': 0.9980354, 'binary_recall': 0.98006433, 'binary_specificity': 0.99800134, 'binary_f1_score': 0.9889682}
confusion matrix:
      0     1
0  1498     3
1    31  1524
---- Validation: 
scalar performance:
{'acc': 0.827957, 'precision': 0.84599423, 'recall': 0.8245796, 'specificity': 0.8245796, 'f1': 0.8245283, 'auroc': 0.8971566, 'binary_precision': 0.91803277, 'binary_recall': 0.70886075, 'binary_specificity': 0.9402985, 'binary_f1_score': 0.79999995}
confusion matrix:
     0    1
0  630   40
1  184  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8783843, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8609814, 'auroc': 0.9382162, 'binary_precision': 0.95604396, 'binary_recall': 0.75982535, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.84671533}
confusion matrix:
     0    1
0  221    8
1   55  174
early stop counter: 8
val acc:0.8279569745063782, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 12,now: 2024-07-29 08:57:04.980385,epoch time: 0:01:43.992314,used: 0:20:27.462487,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99047387, 'recall': 0.9905518, 'specificity': 0.9905518, 'f1': 0.9905076, 'auroc': 0.9992485, 'binary_precision': 0.9929078, 'binary_recall': 0.9884467, 'binary_specificity': 0.9926569, 'binary_f1_score': 0.9906723}
confusion matrix:
      0     1
0  1487    11
1    18  1540
---- Validation: 
scalar performance:
{'acc': 0.813364, 'precision': 0.826514, 'recall': 0.81035566, 'specificity': 0.81035566, 'f1': 0.8103178, 'auroc': 0.884248, 'binary_precision': 0.8851485, 'binary_recall': 0.7072785, 'binary_specificity': 0.91343284, 'binary_f1_score': 0.78627974}
confusion matrix:
     0    1
0  612   58
1  185  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81877726, 'precision': 0.820987, 'recall': 0.8187773, 'specificity': 0.8187773, 'f1': 0.8184649, 'auroc': 0.8909632, 'binary_precision': 0.84761906, 'binary_recall': 0.77729255, 'binary_specificity': 0.86026204, 'binary_f1_score': 0.81093395}
confusion matrix:
     0    1
0  197   32
1   51  178
early stop counter: 9
val acc:0.8133640289306641, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 13,now: 2024-07-29 08:58:48.100391,epoch time: 0:01:43.120006,used: 0:22:10.582493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.987007, 'recall': 0.9868317, 'specificity': 0.9868317, 'f1': 0.98690414, 'auroc': 0.9993321, 'binary_precision': 0.98342896, 'binary_recall': 0.99100834, 'binary_specificity': 0.9826551, 'binary_f1_score': 0.98720413}
confusion matrix:
      0     1
0  1473    26
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.813364, 'precision': 0.83550733, 'recall': 0.809548, 'specificity': 0.809548, 'f1': 0.80880743, 'auroc': 0.9030205, 'binary_precision': 0.91471213, 'binary_recall': 0.6787975, 'binary_specificity': 0.9402985, 'binary_f1_score': 0.7792915}
confusion matrix:
     0    1
0  630   40
1  203  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8668122, 'precision': 0.8789598, 'recall': 0.8668122, 'specificity': 0.8668122, 'f1': 0.86573625, 'auroc': 0.9399134, 'binary_precision': 0.9468085, 'binary_recall': 0.77729255, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.85371697}
confusion matrix:
     0    1
0  219   10
1   51  178
early stop counter: 10
val acc:0.8133640289306641, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 14,now: 2024-07-29 09:00:29.224412,epoch time: 0:01:41.124021,used: 0:23:51.706514,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98729783, 'recall': 0.98743665, 'specificity': 0.98743665, 'f1': 0.9872377, 'auroc': 0.9994756, 'binary_precision': 0.9986842, 'binary_recall': 0.97620577, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.987317}
confusion matrix:
      0     1
0  1499     2
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.7619048, 'precision': 0.8201993, 'recall': 0.7555545, 'specificity': 0.7555545, 'f1': 0.7473996, 'auroc': 0.90054727, 'binary_precision': 0.9497207, 'binary_recall': 0.53797466, 'binary_specificity': 0.97313434, 'binary_f1_score': 0.68686867}
confusion matrix:
     0    1
0  652   18
1  292  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8253275, 'precision': 0.8632599, 'recall': 0.8253275, 'specificity': 0.8253275, 'f1': 0.82064533, 'auroc': 0.9059895, 'binary_precision': 0.9806452, 'binary_recall': 0.6637555, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7916667}
confusion matrix:
     0    1
0  226    3
1   77  152
early stop counter: 11
val acc:0.761904776096344, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 15,now: 2024-07-29 09:02:11.640307,epoch time: 0:01:42.415895,used: 0:25:34.122409,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98915905, 'recall': 0.98925525, 'specificity': 0.98925525, 'f1': 0.98919857, 'auroc': 0.9991456, 'binary_precision': 0.99225307, 'binary_recall': 0.9865212, 'binary_specificity': 0.9919893, 'binary_f1_score': 0.9893788}
confusion matrix:
      0     1
0  1486    12
1    21  1537
---- Validation: 
scalar performance:
{'acc': 0.72427034, 'precision': 0.7830922, 'recall': 0.7174169, 'specificity': 0.7174169, 'f1': 0.70497155, 'auroc': 0.9061585, 'binary_precision': 0.9050445, 'binary_recall': 0.48259494, 'binary_specificity': 0.9522388, 'binary_f1_score': 0.629515}
confusion matrix:
     0    1
0  638   32
1  327  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.720524, 'precision': 0.8207283, 'recall': 0.720524, 'specificity': 0.720524, 'f1': 0.6968456, 'auroc': 0.93977994, 'binary_precision': 1.0, 'binary_recall': 0.44104803, 'binary_specificity': 1.0, 'binary_f1_score': 0.6121212}
confusion matrix:
     0    1
0  229    0
1  128  101
early stop counter: 12
val acc:0.7242703437805176, best validation acc: 0.8663594722747803, corresponding to test acc:                         0.8668122291564941 / 0.8689956068992615
after epoch: 16,now: 2024-07-29 09:03:53.137512,epoch time: 0:01:41.497205,used: 0:27:15.619614,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878439, 'recall': 0.98797154, 'specificity': 0.98797154, 'f1': 0.9878898, 'auroc': 0.99927545, 'binary_precision': 0.99223304, 'binary_recall': 0.9839538, 'binary_specificity': 0.9919893, 'binary_f1_score': 0.9880761}
confusion matrix:
      0     1
0  1486    12
1    25  1533
---- Validation: 
scalar performance:
{'acc': 0.8694316, 'precision': 0.8782966, 'recall': 0.8672114, 'specificity': 0.8672114, 'f1': 0.86807567, 'auroc': 0.92810315, 'binary_precision': 0.929368, 'binary_recall': 0.79113925, 'binary_specificity': 0.94328356, 'binary_f1_score': 0.85470086}
confusion matrix:
     0    1
0  632   38
1  132  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88209605, 'precision': 0.89816195, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.8808946, 'auroc': 0.942011, 'binary_precision': 0.9781421, 'binary_recall': 0.78165936, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.86893207}
confusion matrix:
     0    1
0  225    4
1   50  179
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-29 09:05:36.758127,epoch time: 0:01:43.620615,used: 0:28:59.240229,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.983559, 'recall': 0.9836118, 'specificity': 0.9836118, 'f1': 0.9833114, 'auroc': 0.9992888, 'binary_precision': 1.0, 'binary_recall': 0.96722364, 'binary_specificity': 1.0, 'binary_f1_score': 0.9833388}
confusion matrix:
      0     1
0  1500     0
1    51  1505
---- Validation: 
scalar performance:
{'acc': 0.8041475, 'precision': 0.8408451, 'recall': 0.7992915, 'specificity': 0.7992915, 'f1': 0.7968357, 'auroc': 0.9182056, 'binary_precision': 0.9456265, 'binary_recall': 0.6329114, 'binary_specificity': 0.96567166, 'binary_f1_score': 0.75829375}
confusion matrix:
     0    1
0  647   23
1  232  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.768559, 'precision': 0.83502626, 'recall': 0.768559, 'specificity': 0.768559, 'f1': 0.75648075, 'auroc': 0.9394176, 'binary_precision': 0.984252, 'binary_recall': 0.5458515, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.70224726}
confusion matrix:
     0    1
0  227    2
1  104  125
early stop counter: 1
val acc:0.804147481918335, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 18,now: 2024-07-29 09:07:17.979688,epoch time: 0:01:41.221561,used: 0:30:40.461790,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.9957274, 'recall': 0.9957637, 'specificity': 0.9957637, 'f1': 0.9957446, 'auroc': 0.99970776, 'binary_precision': 0.99678457, 'binary_recall': 0.99486524, 'binary_specificity': 0.9966622, 'binary_f1_score': 0.9958239}
confusion matrix:
      0     1
0  1493     5
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.7980031, 'precision': 0.84208953, 'recall': 0.79269314, 'specificity': 0.79269314, 'f1': 0.7891355, 'auroc': 0.89803755, 'binary_precision': 0.95781636, 'binary_recall': 0.6107595, 'binary_specificity': 0.97462684, 'binary_f1_score': 0.7458937}
confusion matrix:
     0    1
0  653   17
1  246  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6943231, 'precision': 0.8102981, 'recall': 0.6943231, 'specificity': 0.6943231, 'f1': 0.66281736, 'auroc': 0.93482196, 'binary_precision': 1.0, 'binary_recall': 0.38864627, 'binary_specificity': 1.0, 'binary_f1_score': 0.5597484}
confusion matrix:
     0   1
0  229   0
1  140  89
early stop counter: 2
val acc:0.798003077507019, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 19,now: 2024-07-29 09:08:58.618492,epoch time: 0:01:40.638804,used: 0:32:21.100594,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.9944124, 'recall': 0.9944644, 'specificity': 0.9944644, 'f1': 0.9944357, 'auroc': 0.99986285, 'binary_precision': 0.99612904, 'binary_recall': 0.99292606, 'binary_specificity': 0.9960027, 'binary_f1_score': 0.9945249}
confusion matrix:
      0     1
0  1495     6
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.7480799, 'precision': 0.8124068, 'recall': 0.741314, 'specificity': 0.741314, 'f1': 0.7307855, 'auroc': 0.88523287, 'binary_precision': 0.9470588, 'binary_recall': 0.50949365, 'binary_specificity': 0.97313434, 'binary_f1_score': 0.66255134}
confusion matrix:
     0    1
0  652   18
1  310  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.779476, 'precision': 0.84371483, 'recall': 0.779476, 'specificity': 0.779476, 'f1': 0.7686672, 'auroc': 0.92988306, 'binary_precision': 0.99230766, 'binary_recall': 0.5633188, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.718663}
confusion matrix:
     0    1
0  228    1
1  100  129
early stop counter: 3
val acc:0.7480798959732056, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 20,now: 2024-07-29 09:10:39.238651,epoch time: 0:01:40.620159,used: 0:34:01.720753,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.9944047, 'recall': 0.9944773, 'specificity': 0.9944773, 'f1': 0.9944358, 'auroc': 0.9997897, 'binary_precision': 0.9967721, 'binary_recall': 0.99228793, 'binary_specificity': 0.99666667, 'binary_f1_score': 0.994525}
confusion matrix:
      0     1
0  1495     5
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.7288787, 'precision': 0.8055368, 'recall': 0.7214009, 'specificity': 0.7214009, 'f1': 0.70630014, 'auroc': 0.87507856, 'binary_precision': 0.9514563, 'binary_recall': 0.46518987, 'binary_specificity': 0.97761196, 'binary_f1_score': 0.62486714}
confusion matrix:
     0    1
0  655   15
1  338  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70742357, 'precision': 0.81063485, 'recall': 0.70742357, 'specificity': 0.70742357, 'f1': 0.68091923, 'auroc': 0.93013096, 'binary_precision': 0.9896907, 'binary_recall': 0.41921398, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.5889571}
confusion matrix:
     0   1
0  228   1
1  133  96
early stop counter: 4
val acc:0.7288786768913269, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 21,now: 2024-07-29 09:12:09.426957,epoch time: 0:01:30.188306,used: 0:35:31.909059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895352, 'recall': 0.9897114, 'specificity': 0.9897114, 'f1': 0.98952794, 'auroc': 0.99973345, 'binary_precision': 0.9993451, 'binary_recall': 0.9800899, 'binary_specificity': 0.9993329, 'binary_f1_score': 0.9896239}
confusion matrix:
      0     1
0  1498     1
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.7380952, 'precision': 0.8033498, 'recall': 0.7311638, 'specificity': 0.7311638, 'f1': 0.7192892, 'auroc': 0.873746, 'binary_precision': 0.9369369, 'binary_recall': 0.49367088, 'binary_specificity': 0.9686567, 'binary_f1_score': 0.64663213}
confusion matrix:
     0    1
0  649   21
1  320  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5458515, 'precision': 0.76201373, 'recall': 0.5458515, 'specificity': 0.5458515, 'f1': 0.42784384, 'auroc': 0.8751978, 'binary_precision': 1.0, 'binary_recall': 0.09170306, 'binary_specificity': 1.0, 'binary_f1_score': 0.168}
confusion matrix:
     0   1
0  229   0
1  208  21
early stop counter: 5
val acc:0.738095223903656, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 22,now: 2024-07-29 09:13:49.177757,epoch time: 0:01:39.750800,used: 0:37:11.659859,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99015534, 'recall': 0.9903519, 'specificity': 0.9903519, 'f1': 0.9901819, 'auroc': 0.9995236, 'binary_precision': 0.9986954, 'binary_recall': 0.98203975, 'binary_specificity': 0.998664, 'binary_f1_score': 0.99029756}
confusion matrix:
      0     1
0  1495     2
1    28  1531
---- Validation: 
scalar performance:
{'acc': 0.71351767, 'precision': 0.8016641, 'recall': 0.7054435, 'specificity': 0.7054435, 'f1': 0.6857545, 'auroc': 0.8821982, 'binary_precision': 0.9575972, 'binary_recall': 0.42879745, 'binary_specificity': 0.9820896, 'binary_f1_score': 0.5923497}
confusion matrix:
     0    1
0  658   12
1  361  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7423581, 'precision': 0.8299712, 'recall': 0.7423581, 'specificity': 0.7423581, 'f1': 0.72404003, 'auroc': 0.91172934, 'binary_precision': 1.0, 'binary_recall': 0.48471615, 'binary_specificity': 1.0, 'binary_f1_score': 0.65294117}
confusion matrix:
     0    1
0  229    0
1  118  111
early stop counter: 6
val acc:0.7135176658630371, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 23,now: 2024-07-29 09:15:31.329135,epoch time: 0:01:42.151378,used: 0:38:53.811237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99640054, 'precision': 0.99638426, 'recall': 0.9964168, 'specificity': 0.9964168, 'f1': 0.9963995, 'auroc': 0.99992335, 'binary_precision': 0.9974227, 'binary_recall': 0.9954984, 'binary_specificity': 0.99733514, 'binary_f1_score': 0.99645966}
confusion matrix:
      0     1
0  1497     4
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.72427034, 'precision': 0.76912236, 'recall': 0.71808994, 'specificity': 0.71808994, 'f1': 0.7084823, 'auroc': 0.8350652, 'binary_precision': 0.8719346, 'binary_recall': 0.5063291, 'binary_specificity': 0.92985076, 'binary_f1_score': 0.6406407}
confusion matrix:
     0    1
0  623   47
1  312  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6113537, 'precision': 0.76345587, 'recall': 0.6113537, 'specificity': 0.6113537, 'f1': 0.54579693, 'auroc': 0.84216547, 'binary_precision': 0.96363634, 'binary_recall': 0.23144105, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.37323943}
confusion matrix:
     0   1
0  227   2
1  176  53
early stop counter: 7
val acc:0.7242703437805176, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 24,now: 2024-07-29 09:17:12.163988,epoch time: 0:01:40.834853,used: 0:40:34.646090,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99276793, 'recall': 0.9929351, 'specificity': 0.9929351, 'f1': 0.99280006, 'auroc': 0.9996538, 'binary_precision': 1.0, 'binary_recall': 0.98587024, 'binary_specificity': 1.0, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1499     0
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.68356377, 'precision': 0.79543597, 'recall': 0.67436475, 'specificity': 0.67436475, 'f1': 0.6435977, 'auroc': 0.876672, 'binary_precision': 0.97008544, 'binary_recall': 0.3591772, 'binary_specificity': 0.98955226, 'binary_f1_score': 0.52424943}
confusion matrix:
     0    1
0  663    7
1  405  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5458515, 'precision': 0.76201373, 'recall': 0.5458515, 'specificity': 0.5458515, 'f1': 0.42784384, 'auroc': 0.9052268, 'binary_precision': 1.0, 'binary_recall': 0.09170306, 'binary_specificity': 1.0, 'binary_f1_score': 0.168}
confusion matrix:
     0   1
0  229   0
1  208  21
early stop counter: 8
val acc:0.683563768863678, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 25,now: 2024-07-29 09:19:06.492500,epoch time: 0:01:54.328512,used: 0:42:28.974602,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.991906, 'recall': 0.9917506, 'specificity': 0.9917506, 'f1': 0.99181545, 'auroc': 0.99982345, 'binary_precision': 0.9885131, 'binary_recall': 0.9955013, 'binary_specificity': 0.988, 'binary_f1_score': 0.9919949}
confusion matrix:
      0     1
0  1482    18
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.7519201, 'precision': 0.8134602, 'recall': 0.7453146, 'specificity': 0.7453146, 'f1': 0.73565114, 'auroc': 0.8967646, 'binary_precision': 0.94524497, 'binary_recall': 0.51898736, 'binary_specificity': 0.9716418, 'binary_f1_score': 0.67007154}
confusion matrix:
     0    1
0  651   19
1  304  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7947598, 'precision': 0.85149056, 'recall': 0.7947598, 'specificity': 0.7947598, 'f1': 0.78613013, 'auroc': 0.9265269, 'binary_precision': 0.99270076, 'binary_recall': 0.59388644, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.74316937}
confusion matrix:
     0    1
0  228    1
1   93  136
early stop counter: 9
val acc:0.7519201040267944, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 26,now: 2024-07-29 09:20:47.353880,epoch time: 0:01:40.861380,used: 0:44:09.835982,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99311924, 'recall': 0.9931321, 'specificity': 0.9931321, 'f1': 0.9931255, 'auroc': 0.99971807, 'binary_precision': 0.99358153, 'binary_recall': 0.9929442, 'binary_specificity': 0.99332, 'binary_f1_score': 0.9932627}
confusion matrix:
      0     1
0  1487    10
1    11  1548
---- Validation: 
scalar performance:
{'acc': 0.8325653, 'precision': 0.8344424, 'recall': 0.8313905, 'specificity': 0.8313905, 'f1': 0.83186555, 'auroc': 0.89102113, 'binary_precision': 0.85324234, 'binary_recall': 0.79113925, 'binary_specificity': 0.8716418, 'binary_f1_score': 0.8210181}
confusion matrix:
     0    1
0  584   86
1  132  500
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7576419, 'precision': 0.8011009, 'recall': 0.7576419, 'specificity': 0.7576419, 'f1': 0.7485694, 'auroc': 0.8853569, 'binary_precision': 0.91549295, 'binary_recall': 0.5676856, 'binary_specificity': 0.9475983, 'binary_f1_score': 0.7008086}
confusion matrix:
     0    1
0  217   12
1   99  130
early stop counter: 10
val acc:0.8325653076171875, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 27,now: 2024-07-29 09:22:31.299942,epoch time: 0:01:43.946062,used: 0:45:53.782044,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9980366, 'precision': 0.9980254, 'recall': 0.9980476, 'specificity': 0.9980476, 'f1': 0.998036, 'auroc': 0.99996746, 'binary_precision': 0.9987122, 'binary_recall': 0.99742764, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.9980695}
confusion matrix:
      0     1
0  1499     2
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.74731183, 'precision': 0.80756676, 'recall': 0.74070233, 'specificity': 0.74070233, 'f1': 0.7307406, 'auroc': 0.8846277, 'binary_precision': 0.93659943, 'binary_recall': 0.5142405, 'binary_specificity': 0.96716416, 'binary_f1_score': 0.66394275}
confusion matrix:
     0    1
0  648   22
1  307  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55676854, 'precision': 0.7650463, 'recall': 0.55676854, 'specificity': 0.55676854, 'f1': 0.44840556, 'auroc': 0.8936376, 'binary_precision': 1.0, 'binary_recall': 0.11353712, 'binary_specificity': 1.0, 'binary_f1_score': 0.20392157}
confusion matrix:
     0   1
0  229   0
1  203  26
early stop counter: 11
val acc:0.7473118305206299, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 28,now: 2024-07-29 09:24:11.431230,epoch time: 0:01:40.131288,used: 0:47:33.913332,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99470973, 'recall': 0.9948581, 'specificity': 0.9948581, 'f1': 0.994763, 'auroc': 0.9999126, 'binary_precision': 0.9993532, 'binary_recall': 0.99038464, 'binary_specificity': 0.99933153, 'binary_f1_score': 0.9948487}
confusion matrix:
      0     1
0  1495     1
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.72043014, 'precision': 0.81258863, 'recall': 0.7123394, 'specificity': 0.7123394, 'f1': 0.69318295, 'auroc': 0.9196049, 'binary_precision': 0.9751773, 'binary_recall': 0.43512657, 'binary_specificity': 0.98955226, 'binary_f1_score': 0.60175055}
confusion matrix:
     0    1
0  663    7
1  357  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52838427, 'precision': 0.75730336, 'recall': 0.52838427, 'specificity': 0.52838427, 'f1': 0.3934816, 'auroc': 0.9454243, 'binary_precision': 1.0, 'binary_recall': 0.05676856, 'binary_specificity': 1.0, 'binary_f1_score': 0.10743802}
confusion matrix:
     0   1
0  229   0
1  216  13
early stop counter: 12
val acc:0.7204301357269287, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 29,now: 2024-07-29 09:25:47.722787,epoch time: 0:01:36.291557,used: 0:49:10.204889,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879557, 'recall': 0.9881182, 'specificity': 0.9881182, 'f1': 0.98789215, 'auroc': 0.99992585, 'binary_precision': 1.0, 'binary_recall': 0.97623634, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879753}
confusion matrix:
      0     1
0  1499     0
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.6113671, 'precision': 0.76348424, 'recall': 0.59995276, 'specificity': 0.59995276, 'f1': 0.53347874, 'auroc': 0.8575318, 'binary_precision': 0.95652175, 'binary_recall': 0.20886075, 'binary_specificity': 0.99104476, 'binary_f1_score': 0.34285712}
confusion matrix:
     0    1
0  664    6
1  500  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9065616, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  229  0
1  229  0
early stop counter: 13
val acc:0.6113671064376831, best validation acc: 0.8694316148757935, corresponding to test acc:                         0.8820960521697998 / 0.8820960521697998
after epoch: 30,now: 2024-07-29 09:27:26.506756,epoch time: 0:01:38.783969,used: 0:50:48.988858,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_08_36_37_seed_11_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:50:48.988858 at 2024-07-29 09:27:26.506756
persisted model performance metric: 

scalar performance:
{'acc': 0.88209605, 'precision': 0.89816195, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.8808946, 'auroc': 0.942011, 'binary_precision': 0.9781421, 'binary_recall': 0.78165936, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.86893207}
confusion matrix:
     0    1
0  225    4
1   50  179
oracle model performance metric: 

scalar performance:
{'acc': 0.88209605, 'precision': 0.89816195, 'recall': 0.88209605, 'specificity': 0.88209605, 'f1': 0.8808946, 'auroc': 0.942011, 'binary_precision': 0.9781421, 'binary_recall': 0.78165936, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.86893207}
confusion matrix:
     0    1
0  225    4
1   50  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455269 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool | 414671 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |  40598 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 455269 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool | 414671 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |  40598 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |  40407 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14490 MiB | 163876 MiB | 149404 MiB |
|       from large pool |  14406 MiB |  14424 MiB | 163636 MiB | 149230 MiB |
|       from small pool |     66 MiB |     70 MiB |    240 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 503194 KiB |   1260 MiB | 633484 GiB | 633484 GiB |
|       from large pool | 492593 KiB |   1256 MiB | 622912 GiB | 622912 GiB |
|       from small pool |  10601 KiB |     45 MiB |  10572 GiB |  10572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  156328 K  |  156327 K  |
|       from large pool |     187    |    1413    |   79554 K  |   79554 K  |
|       from small pool |    1123    |    1419    |   76773 K  |   76772 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  156328 K  |  156327 K  |
|       from large pool |     187    |    1413    |   79554 K  |   79554 K  |
|       from small pool |    1123    |    1419    |   76773 K  |   76772 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    6926    |    6290    |
|       from large pool |     603    |     603    |    6806    |    6203    |
|       from small pool |      33    |      35    |     120    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     652    |  104823 K  |  104823 K  |
|       from large pool |      43    |     608    |   59287 K  |   59287 K  |
|       from small pool |      60    |     236    |   45535 K  |   45535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14490 MiB | 163876 MiB | 162940 MiB |
|       from large pool |    886 MiB |  14424 MiB | 163636 MiB | 162750 MiB |
|       from small pool |     50 MiB |     70 MiB |    240 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 633484 GiB | 633484 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 622912 GiB | 622912 GiB |
|       from small pool |      0 KiB |     45 MiB |  10572 GiB |  10572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    6926    |    6860    |
|       from large pool |      41    |     603    |    6806    |    6765    |
|       from small pool |      25    |      35    |     120    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  104823 K  |  104823 K  |
|       from large pool |       3    |     608    |   59287 K  |   59287 K  |
|       from small pool |       0    |     236    |   45535 K  |   45535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    870 TiB |    870 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    860 TiB |    860 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    868 TiB |    868 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    858 TiB |    858 TiB |
|       from small pool |      0 KiB |     60 MiB |     10 TiB |     10 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    936 MiB |  14490 MiB | 163876 MiB | 162940 MiB |
|       from large pool |    886 MiB |  14424 MiB | 163636 MiB | 162750 MiB |
|       from small pool |     50 MiB |     70 MiB |    240 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 633484 GiB | 633484 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 622912 GiB | 622912 GiB |
|       from small pool |      0 KiB |     45 MiB |  10572 GiB |  10572 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  156328 K  |  156328 K  |
|       from large pool |       2    |    1413    |   79554 K  |   79554 K  |
|       from small pool |       0    |    1419    |   76773 K  |   76773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     637    |    6926    |    6860    |
|       from large pool |      41    |     603    |    6806    |    6765    |
|       from small pool |      25    |      35    |     120    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  104823 K  |  104823 K  |
|       from large pool |       3    |     608    |   59287 K  |   59287 K  |
|       from small pool |       0    |     236    |   45535 K  |   45535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367

 Experiment start at: 2024-07-29 09:28:17.754350
before training, model accuracy: 0.6380090713500977
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9236469, 'precision': 0.9321357, 'recall': 0.9248618, 'specificity': 0.9248618, 'f1': 0.9233979, 'auroc': 0.988073, 'binary_precision': 0.99703485, 'binary_recall': 0.85234475, 'binary_specificity': 0.99737877, 'binary_f1_score': 0.9190297}
confusion matrix:
      0     1
0  1522     4
1   233  1345
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.6180392, 'precision': 0.7472174, 'recall': 0.6131495, 'specificity': 0.6131495, 'f1': 0.55557454, 'auroc': 0.88600755, 'binary_precision': 0.92261904, 'binary_recall': 0.24642289, 'binary_specificity': 0.97987616, 'binary_f1_score': 0.3889586}
confusion matrix:
     0    1
0  633   13
1  474  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8054299, 'precision': 0.84889024, 'recall': 0.8054299, 'specificity': 0.8054299, 'f1': 0.79917586, 'auroc': 0.922217, 'binary_precision': 0.97202796, 'binary_recall': 0.6289593, 'binary_specificity': 0.98190045, 'binary_f1_score': 0.7637363}
confusion matrix:
     0    1
0  217    4
1   82  139
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 09:30:09.716620,epoch time: 0:01:51.962270,used: 0:01:51.962270,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9681057, 'precision': 0.96838284, 'recall': 0.9683932, 'specificity': 0.9683932, 'f1': 0.9681057, 'auroc': 0.9943372, 'binary_precision': 0.9849279, 'binary_recall': 0.9518683, 'binary_specificity': 0.98491806, 'binary_f1_score': 0.9681159}
confusion matrix:
      0     1
0  1502    23
1    76  1503
---- Validation: 
scalar performance:
{'acc': 0.8172549, 'precision': 0.817256, 'recall': 0.81717014, 'specificity': 0.81717014, 'f1': 0.8172005, 'auroc': 0.8946581, 'binary_precision': 0.8173077, 'binary_recall': 0.8108108, 'binary_specificity': 0.8235294, 'binary_f1_score': 0.8140463}
confusion matrix:
     0    1
0  532  114
1  119  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.800905, 'precision': 0.8051282, 'recall': 0.800905, 'specificity': 0.800905, 'f1': 0.8002137, 'auroc': 0.9106898, 'binary_precision': 0.7692308, 'binary_recall': 0.8597285, 'binary_specificity': 0.74208146, 'binary_f1_score': 0.8119658}
confusion matrix:
     0    1
0  164   57
1   31  190
better model found
persisted
after epoch: 2,now: 2024-07-29 09:31:52.314566,epoch time: 0:01:42.597946,used: 0:03:34.560216,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97261596, 'precision': 0.97318625, 'recall': 0.9723666, 'specificity': 0.9723666, 'f1': 0.97258925, 'auroc': 0.99746764, 'binary_precision': 0.96054256, 'binary_recall': 0.9867004, 'binary_specificity': 0.9580328, 'binary_f1_score': 0.9734458}
confusion matrix:
      0     1
0  1461    64
1    21  1558
---- Validation: 
scalar performance:
{'acc': 0.8109804, 'precision': 0.81687486, 'recall': 0.81187767, 'specificity': 0.81187767, 'f1': 0.8103757, 'auroc': 0.8933095, 'binary_precision': 0.770195, 'binary_recall': 0.8791733, 'binary_specificity': 0.74458206, 'binary_f1_score': 0.8210839}
confusion matrix:
     0    1
0  481  165
1   76  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.760181, 'precision': 0.78399825, 'recall': 0.760181, 'specificity': 0.760181, 'f1': 0.7550453, 'auroc': 0.88626873, 'binary_precision': 0.7017544, 'binary_recall': 0.9049774, 'binary_specificity': 0.61538464, 'binary_f1_score': 0.7905139}
confusion matrix:
     0    1
0  136   85
1   21  200
early stop counter: 1
val acc:0.8109803795814514, best validation acc: 0.817254900932312, corresponding to test acc:                         0.8009049892425537 / 0.8054298758506775
after epoch: 3,now: 2024-07-29 09:33:31.652773,epoch time: 0:01:39.338207,used: 0:05:13.898423,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97164947, 'precision': 0.9716932, 'recall': 0.971596, 'specificity': 0.971596, 'f1': 0.97163814, 'auroc': 0.9966121, 'binary_precision': 0.9697543, 'binary_recall': 0.9746675, 'binary_specificity': 0.9685246, 'binary_f1_score': 0.9722047}
confusion matrix:
      0     1
0  1477    48
1    40  1539
---- Validation: 
scalar performance:
{'acc': 0.7121569, 'precision': 0.7351465, 'recall': 0.7141871, 'specificity': 0.7141871, 'f1': 0.7061697, 'auroc': 0.7985623, 'binary_precision': 0.65821254, 'binary_recall': 0.86645466, 'binary_specificity': 0.5619195, 'binary_f1_score': 0.7481125}
confusion matrix:
     0    1
0  363  283
1   84  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65158373, 'precision': 0.75318897, 'recall': 0.65158373, 'specificity': 0.65158373, 'f1': 0.6127307, 'auroc': 0.8757806, 'binary_precision': 0.59279776, 'binary_recall': 0.9683258, 'binary_specificity': 0.33484164, 'binary_f1_score': 0.73539513}
confusion matrix:
    0    1
0  74  147
1   7  214
early stop counter: 2
val acc:0.7121568918228149, best validation acc: 0.817254900932312, corresponding to test acc:                         0.8009049892425537 / 0.8054298758506775
after epoch: 4,now: 2024-07-29 09:35:09.647409,epoch time: 0:01:37.994636,used: 0:06:51.893059,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9732603, 'precision': 0.9737573, 'recall': 0.9736166, 'specificity': 0.9736166, 'f1': 0.97326, 'auroc': 0.9970565, 'binary_precision': 0.9940555, 'binary_recall': 0.9531349, 'binary_specificity': 0.99409837, 'binary_f1_score': 0.9731652}
confusion matrix:
      0     1
0  1516     9
1    74  1505
---- Validation: 
scalar performance:
{'acc': 0.8392157, 'precision': 0.8600886, 'recall': 0.83760774, 'specificity': 0.83760774, 'f1': 0.8363748, 'auroc': 0.93041444, 'binary_precision': 0.94351465, 'binary_recall': 0.71701115, 'binary_specificity': 0.9582043, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  619   27
1  178  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8438914, 'precision': 0.8743092, 'recall': 0.8438914, 'specificity': 0.8438914, 'f1': 0.84065413, 'auroc': 0.93261296, 'binary_precision': 0.98101264, 'binary_recall': 0.7013575, 'binary_specificity': 0.98642534, 'binary_f1_score': 0.8179419}
confusion matrix:
     0    1
0  218    3
1   66  155
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-29 09:36:45.056210,epoch time: 0:01:35.408801,used: 0:08:27.301860,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9806701, 'precision': 0.9806397, 'recall': 0.9807619, 'specificity': 0.9807619, 'f1': 0.9806678, 'auroc': 0.99747217, 'binary_precision': 0.98653847, 'binary_recall': 0.9752852, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.98087955}
confusion matrix:
      0     1
0  1505    21
1    39  1539
---- Validation: 
scalar performance:
{'acc': 0.84862745, 'precision': 0.8532903, 'recall': 0.84785795, 'specificity': 0.84785795, 'f1': 0.84790295, 'auroc': 0.92328966, 'binary_precision': 0.890681, 'binary_recall': 0.7901431, 'binary_specificity': 0.9055728, 'binary_f1_score': 0.83740526}
confusion matrix:
     0    1
0  585   61
1  132  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84841627, 'precision': 0.8714205, 'recall': 0.8484163, 'specificity': 0.8484163, 'f1': 0.84603226, 'auroc': 0.92928076, 'binary_precision': 0.96385545, 'binary_recall': 0.7239819, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.8268734}
confusion matrix:
     0    1
0  215    6
1   61  160
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-29 09:38:26.622932,epoch time: 0:01:41.566722,used: 0:10:08.868582,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842139, 'precision': 0.9841782, 'recall': 0.9842596, 'specificity': 0.9842596, 'f1': 0.9842106, 'auroc': 0.9990648, 'binary_precision': 0.9872612, 'binary_recall': 0.98163396, 'binary_specificity': 0.98688525, 'binary_f1_score': 0.9844395}
confusion matrix:
      0     1
0  1505    20
1    29  1550
---- Validation: 
scalar performance:
{'acc': 0.86745095, 'precision': 0.8682216, 'recall': 0.867145, 'specificity': 0.867145, 'f1': 0.8672929, 'auroc': 0.9249657, 'binary_precision': 0.8820598, 'binary_recall': 0.84419715, 'binary_specificity': 0.89009285, 'binary_f1_score': 0.8627132}
confusion matrix:
     0    1
0  575   71
1   98  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8687783, 'precision': 0.8702642, 'recall': 0.8687783, 'specificity': 0.8687783, 'f1': 0.8686465, 'auroc': 0.92426443, 'binary_precision': 0.8937198, 'binary_recall': 0.8371041, 'binary_specificity': 0.9004525, 'binary_f1_score': 0.864486}
confusion matrix:
     0    1
0  199   22
1   36  185
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-29 09:40:08.723603,epoch time: 0:01:42.100671,used: 0:11:50.969253,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9848583, 'precision': 0.98500144, 'recall': 0.9847584, 'specificity': 0.9847584, 'f1': 0.9848504, 'auroc': 0.9988493, 'binary_precision': 0.9799499, 'binary_recall': 0.99050033, 'binary_specificity': 0.9790164, 'binary_f1_score': 0.98519695}
confusion matrix:
      0     1
0  1493    32
1    15  1564
---- Validation: 
scalar performance:
{'acc': 0.8360784, 'precision': 0.83897185, 'recall': 0.8354531, 'specificity': 0.8354531, 'f1': 0.8355244, 'auroc': 0.9008845, 'binary_precision': 0.86713284, 'binary_recall': 0.78855324, 'binary_specificity': 0.88235295, 'binary_f1_score': 0.82597834}
confusion matrix:
     0    1
0  570   76
1  133  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8552036, 'precision': 0.8556697, 'recall': 0.8552036, 'specificity': 0.8552036, 'f1': 0.8551562, 'auroc': 0.91013694, 'binary_precision': 0.8685446, 'binary_recall': 0.8371041, 'binary_specificity': 0.8733032, 'binary_f1_score': 0.8525346}
confusion matrix:
     0    1
0  193   28
1   36  185
early stop counter: 1
val acc:0.836078405380249, best validation acc: 0.8674509525299072, corresponding to test acc:                         0.8687782883644104 / 0.8687782883644104
after epoch: 8,now: 2024-07-29 09:41:45.058370,epoch time: 0:01:36.334767,used: 0:13:27.304020,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9855026, 'precision': 0.98549306, 'recall': 0.9855038, 'specificity': 0.9855038, 'f1': 0.9854983, 'auroc': 0.9989983, 'binary_precision': 0.9860583, 'binary_recall': 0.9854338, 'binary_specificity': 0.98557377, 'binary_f1_score': 0.98574597}
confusion matrix:
      0     1
0  1503    22
1    23  1556
---- Validation: 
scalar performance:
{'acc': 0.8258824, 'precision': 0.84614444, 'recall': 0.82426155, 'specificity': 0.82426155, 'f1': 0.8227685, 'auroc': 0.9202651, 'binary_precision': 0.9266247, 'binary_recall': 0.7027027, 'binary_specificity': 0.94582045, 'binary_f1_score': 0.79927665}
confusion matrix:
     0    1
0  611   35
1  187  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8597285, 'precision': 0.8775383, 'recall': 0.8597285, 'specificity': 0.8597285, 'f1': 0.8580545, 'auroc': 0.92678285, 'binary_precision': 0.95953757, 'binary_recall': 0.75113124, 'binary_specificity': 0.9683258, 'binary_f1_score': 0.8426396}
confusion matrix:
     0    1
0  214    7
1   55  166
early stop counter: 2
val acc:0.8258823752403259, best validation acc: 0.8674509525299072, corresponding to test acc:                         0.8687782883644104 / 0.8687782883644104
after epoch: 9,now: 2024-07-29 09:43:30.608942,epoch time: 0:01:45.550572,used: 0:15:12.854592,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9848583, 'precision': 0.98524725, 'recall': 0.9846686, 'specificity': 0.9846686, 'f1': 0.98484635, 'auroc': 0.999287, 'binary_precision': 0.9751861, 'binary_recall': 0.9955668, 'binary_specificity': 0.9737705, 'binary_f1_score': 0.98527104}
confusion matrix:
      0     1
0  1485    40
1     7  1572
---- Validation: 
scalar performance:
{'acc': 0.87215686, 'precision': 0.87344074, 'recall': 0.87176806, 'specificity': 0.87176806, 'f1': 0.87194383, 'auroc': 0.93190575, 'binary_precision': 0.8922559, 'binary_recall': 0.8426073, 'binary_specificity': 0.9009288, 'binary_f1_score': 0.86672115}
confusion matrix:
     0    1
0  582   64
1   99  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8642534, 'precision': 0.8678992, 'recall': 0.8642534, 'specificity': 0.8642534, 'f1': 0.8639162, 'auroc': 0.91478467, 'binary_precision': 0.9045226, 'binary_recall': 0.81447965, 'binary_specificity': 0.91402715, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  202   19
1   41  180
better model found
persisted
after epoch: 10,now: 2024-07-29 09:45:07.159122,epoch time: 0:01:36.550180,used: 0:16:49.404772,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9890464, 'precision': 0.9890171, 'recall': 0.9891552, 'specificity': 0.9891552, 'f1': 0.9890451, 'auroc': 0.9995345, 'binary_precision': 0.9955099, 'binary_recall': 0.98290056, 'binary_specificity': 0.99540985, 'binary_f1_score': 0.98916507}
confusion matrix:
      0     1
0  1518     7
1    27  1552
---- Validation: 
scalar performance:
{'acc': 0.78039217, 'precision': 0.83639205, 'recall': 0.7776546, 'specificity': 0.7776546, 'f1': 0.76967746, 'auroc': 0.9280715, 'binary_precision': 0.9703504, 'binary_recall': 0.57233703, 'binary_specificity': 0.98297215, 'binary_f1_score': 0.72}
confusion matrix:
     0    1
0  635   11
1  269  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71493214, 'precision': 0.8184438, 'recall': 0.71493214, 'specificity': 0.71493214, 'f1': 0.6897174, 'auroc': 0.92051756, 'binary_precision': 1.0, 'binary_recall': 0.42986426, 'binary_specificity': 1.0, 'binary_f1_score': 0.6012658}
confusion matrix:
     0   1
0  221   0
1  126  95
early stop counter: 1
val acc:0.7803921699523926, best validation acc: 0.8721568584442139, corresponding to test acc:                         0.8642534017562866 / 0.8687782883644104
after epoch: 11,now: 2024-07-29 09:46:48.594803,epoch time: 0:01:41.435681,used: 0:18:30.840453,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9864691, 'precision': 0.98645407, 'recall': 0.98659956, 'specificity': 0.98659956, 'f1': 0.98646784, 'auroc': 0.99952745, 'binary_precision': 0.9942122, 'binary_recall': 0.9791007, 'binary_specificity': 0.99409837, 'binary_f1_score': 0.9865986}
confusion matrix:
      0     1
0  1516     9
1    33  1546
---- Validation: 
scalar performance:
{'acc': 0.6431373, 'precision': 0.7578198, 'recall': 0.63862854, 'specificity': 0.63862854, 'f1': 0.5943922, 'auroc': 0.8811667, 'binary_precision': 0.9264706, 'binary_recall': 0.30047694, 'binary_specificity': 0.9767802, 'binary_f1_score': 0.4537815}
confusion matrix:
     0    1
0  631   15
1  440  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6266968, 'precision': 0.77783763, 'recall': 0.6266968, 'specificity': 0.6266968, 'f1': 0.5679375, 'auroc': 0.86574805, 'binary_precision': 0.98275864, 'binary_recall': 0.25791857, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.40860218}
confusion matrix:
     0   1
0  220   1
1  164  57
early stop counter: 2
val acc:0.6431372761726379, best validation acc: 0.8721568584442139, corresponding to test acc:                         0.8642534017562866 / 0.8687782883644104
after epoch: 12,now: 2024-07-29 09:48:24.676434,epoch time: 0:01:36.081631,used: 0:20:06.922084,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93782216, 'precision': 0.9449068, 'recall': 0.93680596, 'specificity': 0.93680596, 'f1': 0.93745756, 'auroc': 0.99842274, 'binary_precision': 0.8927964, 'binary_recall': 0.99746513, 'binary_specificity': 0.8761468, 'binary_f1_score': 0.94223285}
confusion matrix:
      0     1
0  1337   189
1     4  1574
---- Validation: 
scalar performance:
{'acc': 0.73176473, 'precision': 0.78104705, 'recall': 0.73452014, 'specificity': 0.73452014, 'f1': 0.7209501, 'auroc': 0.91035944, 'binary_precision': 0.6599777, 'binary_recall': 0.9411765, 'binary_specificity': 0.5278638, 'binary_f1_score': 0.7758846}
confusion matrix:
     0    1
0  341  305
1   37  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7352941, 'precision': 0.8038925, 'recall': 0.7352941, 'specificity': 0.7352941, 'f1': 0.7194625, 'auroc': 0.94475955, 'binary_precision': 0.6595092, 'binary_recall': 0.9728507, 'binary_specificity': 0.49773756, 'binary_f1_score': 0.786106}
confusion matrix:
     0    1
0  110  111
1    6  215
early stop counter: 3
val acc:0.7317647337913513, best validation acc: 0.8721568584442139, corresponding to test acc:                         0.8642534017562866 / 0.8687782883644104
after epoch: 13,now: 2024-07-29 09:50:06.121271,epoch time: 0:01:41.444837,used: 0:21:48.366921,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9832474, 'precision': 0.9832965, 'recall': 0.983433, 'specificity': 0.983433, 'f1': 0.98324674, 'auroc': 0.998338, 'binary_precision': 0.9941748, 'binary_recall': 0.9727676, 'binary_specificity': 0.99409837, 'binary_f1_score': 0.9833547}
confusion matrix:
      0     1
0  1516     9
1    43  1536
---- Validation: 
scalar performance:
{'acc': 0.73333335, 'precision': 0.80526656, 'recall': 0.7300644, 'specificity': 0.7300644, 'f1': 0.7148026, 'auroc': 0.9211978, 'binary_precision': 0.95015574, 'binary_recall': 0.48489666, 'binary_specificity': 0.9752322, 'binary_f1_score': 0.6421052}
confusion matrix:
     0    1
0  630   16
1  324  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8031674, 'precision': 0.845055, 'recall': 0.80316746, 'specificity': 0.80316746, 'f1': 0.79700696, 'auroc': 0.92369115, 'binary_precision': 0.9652778, 'binary_recall': 0.6289593, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.7616439}
confusion matrix:
     0    1
0  216    5
1   82  139
early stop counter: 4
val acc:0.7333333492279053, best validation acc: 0.8721568584442139, corresponding to test acc:                         0.8642534017562866 / 0.8687782883644104
after epoch: 14,now: 2024-07-29 09:51:46.024296,epoch time: 0:01:39.903025,used: 0:23:28.269946,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98775774, 'precision': 0.987754, 'recall': 0.987754, 'specificity': 0.987754, 'f1': 0.987754, 'auroc': 0.9993795, 'binary_precision': 0.9879671, 'binary_recall': 0.9879671, 'binary_specificity': 0.98754096, 'binary_f1_score': 0.9879671}
confusion matrix:
      0     1
0  1506    19
1    19  1560
---- Validation: 
scalar performance:
{'acc': 0.73490196, 'precision': 0.76882386, 'recall': 0.732491, 'specificity': 0.732491, 'f1': 0.7249096, 'auroc': 0.8869945, 'binary_precision': 0.8610422, 'binary_recall': 0.5516693, 'binary_specificity': 0.9133127, 'binary_f1_score': 0.6724806}
confusion matrix:
     0    1
0  590   56
1  282  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8280543, 'precision': 0.8319693, 'recall': 0.8280543, 'specificity': 0.8280543, 'f1': 0.8275458, 'auroc': 0.88792205, 'binary_precision': 0.8680203, 'binary_recall': 0.77375567, 'binary_specificity': 0.88235295, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  195   26
1   50  171
early stop counter: 5
val acc:0.7349019646644592, best validation acc: 0.8721568584442139, corresponding to test acc:                         0.8642534017562866 / 0.8687782883644104
after epoch: 15,now: 2024-07-29 09:53:23.576189,epoch time: 0:01:37.551893,used: 0:25:05.821839,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98195875, 'precision': 0.98213404, 'recall': 0.98184574, 'specificity': 0.98184574, 'f1': 0.98194903, 'auroc': 0.99923086, 'binary_precision': 0.97622025, 'binary_recall': 0.98859316, 'binary_specificity': 0.9750983, 'binary_f1_score': 0.98236775}
confusion matrix:
      0     1
0  1488    38
1    18  1560
---- Validation: 
scalar performance:
{'acc': 0.8917647, 'precision': 0.89173746, 'recall': 0.89176637, 'specificity': 0.89176637, 'f1': 0.89174974, 'auroc': 0.94810915, 'binary_precision': 0.88906497, 'binary_recall': 0.8918919, 'binary_specificity': 0.89164084, 'binary_f1_score': 0.8904762}
confusion matrix:
     0    1
0  576   70
1   68  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9072398, 'precision': 0.914375, 'recall': 0.9072398, 'specificity': 0.9072398, 'f1': 0.9068388, 'auroc': 0.9340718, 'binary_precision': 0.96875, 'binary_recall': 0.84162897, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.9007264}
confusion matrix:
     0    1
0  215    6
1   35  186
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-29 09:55:06.715632,epoch time: 0:01:43.139443,used: 0:26:48.961282,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99130154, 'precision': 0.9912697, 'recall': 0.9914054, 'specificity': 0.9914054, 'f1': 0.99130046, 'auroc': 0.99962795, 'binary_precision': 0.99743587, 'binary_recall': 0.9854338, 'binary_specificity': 0.99737704, 'binary_f1_score': 0.9913986}
confusion matrix:
      0     1
0  1521     4
1    23  1556
---- Validation: 
scalar performance:
{'acc': 0.8117647, 'precision': 0.8567901, 'recall': 0.80938834, 'specificity': 0.80938834, 'f1': 0.8047902, 'auroc': 0.9261322, 'binary_precision': 0.9802469, 'binary_recall': 0.63116056, 'binary_specificity': 0.9876161, 'binary_f1_score': 0.76789165}
confusion matrix:
     0    1
0  638    8
1  232  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8031674, 'precision': 0.8558006, 'recall': 0.80316746, 'specificity': 0.80316746, 'f1': 0.7956086, 'auroc': 0.89826167, 'binary_precision': 0.99264705, 'binary_recall': 0.61085975, 'binary_specificity': 0.9954751, 'binary_f1_score': 0.75630254}
confusion matrix:
     0    1
0  220    1
1   86  135
early stop counter: 1
val acc:0.8117647171020508, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 17,now: 2024-07-29 09:56:48.663308,epoch time: 0:01:41.947676,used: 0:28:30.908958,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98582476, 'precision': 0.9860898, 'recall': 0.98568034, 'specificity': 0.98568034, 'f1': 0.98581576, 'auroc': 0.9993135, 'binary_precision': 0.9781796, 'binary_recall': 0.99429655, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.9861722}
confusion matrix:
      0     1
0  1491    35
1     9  1569
---- Validation: 
scalar performance:
{'acc': 0.8690196, 'precision': 0.87043077, 'recall': 0.8686093, 'specificity': 0.8686093, 'f1': 0.86878425, 'auroc': 0.9245695, 'binary_precision': 0.8902027, 'binary_recall': 0.8378378, 'binary_specificity': 0.8993808, 'binary_f1_score': 0.8632269}
confusion matrix:
     0    1
0  581   65
1  102  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88687783, 'precision': 0.89075005, 'recall': 0.88687783, 'specificity': 0.88687783, 'f1': 0.8865969, 'auroc': 0.91523516, 'binary_precision': 0.9296482, 'binary_recall': 0.8371041, 'binary_specificity': 0.9366516, 'binary_f1_score': 0.8809524}
confusion matrix:
     0    1
0  207   14
1   36  185
early stop counter: 2
val acc:0.869019627571106, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 18,now: 2024-07-29 09:58:31.443115,epoch time: 0:01:42.779807,used: 0:30:13.688765,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9890464, 'precision': 0.9890678, 'recall': 0.98902065, 'specificity': 0.98902065, 'f1': 0.9890426, 'auroc': 0.99950254, 'binary_precision': 0.9879975, 'binary_recall': 0.99050033, 'binary_specificity': 0.98754096, 'binary_f1_score': 0.9892474}
confusion matrix:
      0     1
0  1506    19
1    15  1564
---- Validation: 
scalar performance:
{'acc': 0.8376471, 'precision': 0.85564214, 'recall': 0.83614343, 'specificity': 0.83614343, 'f1': 0.83511496, 'auroc': 0.92130613, 'binary_precision': 0.93237704, 'binary_recall': 0.72337043, 'binary_specificity': 0.94891644, 'binary_f1_score': 0.8146822}
confusion matrix:
     0    1
0  613   33
1  174  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85067874, 'precision': 0.8729451, 'recall': 0.85067874, 'specificity': 0.85067874, 'f1': 0.8484162, 'auroc': 0.9223194, 'binary_precision': 0.96407187, 'binary_recall': 0.7285068, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.8298969}
confusion matrix:
     0    1
0  215    6
1   60  161
early stop counter: 3
val acc:0.8376470804214478, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 19,now: 2024-07-29 10:00:11.363183,epoch time: 0:01:39.920068,used: 0:31:53.608833,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.992268, 'precision': 0.99223113, 'recall': 0.9923554, 'specificity': 0.9923554, 'f1': 0.9922669, 'auroc': 0.9997043, 'binary_precision': 0.9974408, 'binary_recall': 0.9873338, 'binary_specificity': 0.99737704, 'binary_f1_score': 0.99236155}
confusion matrix:
      0     1
0  1521     4
1    20  1559
---- Validation: 
scalar performance:
{'acc': 0.85411763, 'precision': 0.87449807, 'recall': 0.8525647, 'specificity': 0.8525647, 'f1': 0.85169375, 'auroc': 0.94292444, 'binary_precision': 0.9585921, 'binary_recall': 0.73608905, 'binary_specificity': 0.9690403, 'binary_f1_score': 0.8327338}
confusion matrix:
     0    1
0  626   20
1  166  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8552036, 'precision': 0.8834685, 'recall': 0.8552036, 'specificity': 0.8552036, 'f1': 0.8524854, 'auroc': 0.9303249, 'binary_precision': 0.9875776, 'binary_recall': 0.71945703, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.83246076}
confusion matrix:
     0    1
0  219    2
1   62  159
early stop counter: 4
val acc:0.8541176319122314, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 20,now: 2024-07-29 10:01:51.169163,epoch time: 0:01:39.805980,used: 0:33:33.414813,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9861469, 'precision': 0.9864664, 'recall': 0.98598015, 'specificity': 0.98598015, 'f1': 0.98613703, 'auroc': 0.999358, 'binary_precision': 0.97761196, 'binary_recall': 0.9955668, 'binary_specificity': 0.97639346, 'binary_f1_score': 0.98650765}
confusion matrix:
      0     1
0  1489    36
1     7  1572
---- Validation: 
scalar performance:
{'acc': 0.8611765, 'precision': 0.8655136, 'recall': 0.860451, 'specificity': 0.860451, 'f1': 0.86057127, 'auroc': 0.93194515, 'binary_precision': 0.90213525, 'binary_recall': 0.80604136, 'binary_specificity': 0.91486067, 'binary_f1_score': 0.8513854}
confusion matrix:
     0    1
0  591   55
1  122  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733032, 'precision': 0.87854254, 'recall': 0.8733032, 'specificity': 0.8733032, 'f1': 0.8728633, 'auroc': 0.9283184, 'binary_precision': 0.9230769, 'binary_recall': 0.81447965, 'binary_specificity': 0.9321267, 'binary_f1_score': 0.86538464}
confusion matrix:
     0    1
0  206   15
1   41  180
early stop counter: 5
val acc:0.8611764907836914, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 21,now: 2024-07-29 10:03:31.683172,epoch time: 0:01:40.514009,used: 0:35:13.928822,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9842139, 'precision': 0.98467946, 'recall': 0.98400176, 'specificity': 0.98400176, 'f1': 0.98420036, 'auroc': 0.9995166, 'binary_precision': 0.9733911, 'binary_recall': 0.99620014, 'binary_specificity': 0.9718033, 'binary_f1_score': 0.98466355}
confusion matrix:
      0     1
0  1482    43
1     6  1573
---- Validation: 
scalar performance:
{'acc': 0.8682353, 'precision': 0.86876047, 'recall': 0.8679818, 'specificity': 0.8679818, 'f1': 0.86811185, 'auroc': 0.92852676, 'binary_precision': 0.8797364, 'binary_recall': 0.8489666, 'binary_specificity': 0.8869969, 'binary_f1_score': 0.8640776}
confusion matrix:
     0    1
0  573   73
1   95  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84162897, 'precision': 0.8557297, 'recall': 0.84162897, 'specificity': 0.84162897, 'f1': 0.8400439, 'auroc': 0.9162793, 'binary_precision': 0.92655367, 'binary_recall': 0.74208146, 'binary_specificity': 0.9411765, 'binary_f1_score': 0.82412064}
confusion matrix:
     0    1
0  208   13
1   57  164
early stop counter: 6
val acc:0.8682352900505066, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 22,now: 2024-07-29 10:05:12.459800,epoch time: 0:01:40.776628,used: 0:36:54.705450,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98872423, 'precision': 0.98895144, 'recall': 0.9885919, 'specificity': 0.9885919, 'f1': 0.98871726, 'auroc': 0.9994887, 'binary_precision': 0.98189765, 'binary_recall': 0.99620014, 'binary_specificity': 0.9809836, 'binary_f1_score': 0.98899716}
confusion matrix:
      0     1
0  1496    29
1     6  1573
---- Validation: 
scalar performance:
{'acc': 0.83215684, 'precision': 0.8331933, 'recall': 0.8317714, 'specificity': 0.8317714, 'f1': 0.8318879, 'auroc': 0.89160144, 'binary_precision': 0.8487395, 'binary_recall': 0.8028617, 'binary_specificity': 0.8606811, 'binary_f1_score': 0.8251634}
confusion matrix:
     0    1
0  556   90
1  124  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81674206, 'precision': 0.8169043, 'recall': 0.81674206, 'specificity': 0.81674206, 'f1': 0.8167187, 'auroc': 0.89842546, 'binary_precision': 0.8097345, 'binary_recall': 0.8280543, 'binary_specificity': 0.8054299, 'binary_f1_score': 0.818792}
confusion matrix:
     0    1
0  178   43
1   38  183
early stop counter: 7
val acc:0.8321568369865417, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 23,now: 2024-07-29 10:06:52.010300,epoch time: 0:01:39.550500,used: 0:38:34.255950,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99291235, 'precision': 0.99287546, 'recall': 0.9929999, 'specificity': 0.9929999, 'f1': 0.9929112, 'auroc': 0.99979734, 'binary_precision': 0.9980806, 'binary_recall': 0.9879671, 'binary_specificity': 0.9980328, 'binary_f1_score': 0.992998}
confusion matrix:
      0     1
0  1522     3
1    19  1560
---- Validation: 
scalar performance:
{'acc': 0.8007843, 'precision': 0.84501565, 'recall': 0.7983851, 'specificity': 0.7983851, 'f1': 0.7932753, 'auroc': 0.91997224, 'binary_precision': 0.96526057, 'binary_recall': 0.618442, 'binary_specificity': 0.97832817, 'binary_f1_score': 0.75387603}
confusion matrix:
     0    1
0  632   14
1  240  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.800905, 'precision': 0.8517171, 'recall': 0.800905, 'specificity': 0.800905, 'f1': 0.79344475, 'auroc': 0.87960935, 'binary_precision': 0.98540145, 'binary_recall': 0.61085975, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.7541899}
confusion matrix:
     0    1
0  219    2
1   86  135
early stop counter: 8
val acc:0.8007842898368835, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 24,now: 2024-07-29 10:08:24.832514,epoch time: 0:01:32.822214,used: 0:40:07.078164,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9932345, 'precision': 0.9931988, 'recall': 0.99334276, 'specificity': 0.99334276, 'f1': 0.99323356, 'auroc': 0.99980396, 'binary_precision': 0.99935937, 'binary_recall': 0.98734176, 'binary_specificity': 0.9993438, 'binary_f1_score': 0.9933142}
confusion matrix:
      0     1
0  1523     1
1    20  1560
---- Validation: 
scalar performance:
{'acc': 0.827451, 'precision': 0.8507577, 'recall': 0.8257259, 'specificity': 0.8257259, 'f1': 0.82398164, 'auroc': 0.91530365, 'binary_precision': 0.9379015, 'binary_recall': 0.6963434, 'binary_specificity': 0.95510834, 'binary_f1_score': 0.7992701}
confusion matrix:
     0    1
0  617   29
1  191  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85294116, 'precision': 0.87624407, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.8506283, 'auroc': 0.90321654, 'binary_precision': 0.9698795, 'binary_recall': 0.7285068, 'binary_specificity': 0.97737557, 'binary_f1_score': 0.8320414}
confusion matrix:
     0    1
0  216    5
1   60  161
early stop counter: 9
val acc:0.8274509906768799, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 25,now: 2024-07-29 10:10:04.893711,epoch time: 0:01:40.061197,used: 0:41:47.139361,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9948454, 'precision': 0.9948102, 'recall': 0.99491954, 'specificity': 0.99491954, 'f1': 0.9948446, 'auroc': 0.9999461, 'binary_precision': 0.9993606, 'binary_recall': 0.9904943, 'binary_specificity': 0.9993447, 'binary_f1_score': 0.99490774}
confusion matrix:
      0     1
0  1525     1
1    15  1563
---- Validation: 
scalar performance:
{'acc': 0.83686274, 'precision': 0.86349404, 'recall': 0.8350556, 'specificity': 0.8350556, 'f1': 0.8332763, 'auroc': 0.93378174, 'binary_precision': 0.95860565, 'binary_recall': 0.69952303, 'binary_specificity': 0.9705882, 'binary_f1_score': 0.80882347}
confusion matrix:
     0    1
0  627   19
1  189  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84615386, 'precision': 0.8778411, 'recall': 0.84615386, 'specificity': 0.84615386, 'f1': 0.84285927, 'auroc': 0.93155336, 'binary_precision': 0.9872612, 'binary_recall': 0.7013575, 'binary_specificity': 0.9909502, 'binary_f1_score': 0.8201058}
confusion matrix:
     0    1
0  219    2
1   66  155
early stop counter: 10
val acc:0.8368627429008484, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 26,now: 2024-07-29 10:11:43.481660,epoch time: 0:01:38.587949,used: 0:43:25.727310,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954897, 'precision': 0.995562, 'recall': 0.9954344, 'specificity': 0.9954344, 'f1': 0.99548787, 'auroc': 0.99993145, 'binary_precision': 0.9924433, 'binary_recall': 0.99873257, 'binary_specificity': 0.9921363, 'binary_f1_score': 0.99557805}
confusion matrix:
      0     1
0  1514    12
1     2  1576
---- Validation: 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8749337, 'recall': 0.8656807, 'specificity': 0.8656807, 'f1': 0.865685, 'auroc': 0.93204606, 'binary_precision': 0.9273743, 'binary_recall': 0.7917329, 'binary_specificity': 0.9396285, 'binary_f1_score': 0.8542024}
confusion matrix:
     0    1
0  607   39
1  131  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8710407, 'precision': 0.8758503, 'recall': 0.8710407, 'specificity': 0.8710407, 'f1': 0.87062687, 'auroc': 0.91713417, 'binary_precision': 0.9183673, 'binary_recall': 0.81447965, 'binary_specificity': 0.9276018, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  205   16
1   41  180
early stop counter: 11
val acc:0.8666666746139526, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 27,now: 2024-07-29 10:13:20.044103,epoch time: 0:01:36.562443,used: 0:45:02.289753,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99516755, 'precision': 0.99521595, 'recall': 0.9951253, 'specificity': 0.9951253, 'f1': 0.99516547, 'auroc': 0.9998679, 'binary_precision': 0.9930687, 'binary_recall': 0.99746835, 'binary_specificity': 0.9927822, 'binary_f1_score': 0.99526364}
confusion matrix:
      0     1
0  1513    11
1     4  1576
---- Validation: 
scalar performance:
{'acc': 0.85019606, 'precision': 0.8633987, 'recall': 0.84892476, 'specificity': 0.84892476, 'f1': 0.848472, 'auroc': 0.9209665, 'binary_precision': 0.92941177, 'binary_recall': 0.7535771, 'binary_specificity': 0.94427246, 'binary_f1_score': 0.832309}
confusion matrix:
     0    1
0  610   36
1  155  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8619909, 'precision': 0.8713038, 'recall': 0.8619909, 'specificity': 0.8619909, 'f1': 0.86112016, 'auroc': 0.9193096, 'binary_precision': 0.93010753, 'binary_recall': 0.78280544, 'binary_specificity': 0.9411765, 'binary_f1_score': 0.85012287}
confusion matrix:
     0    1
0  208   13
1   48  173
early stop counter: 12
val acc:0.8501960635185242, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 28,now: 2024-07-29 10:15:01.738769,epoch time: 0:01:41.694666,used: 0:46:43.984419,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9958119, 'precision': 0.9958162, 'recall': 0.99580526, 'specificity': 0.99580526, 'f1': 0.9958106, 'auroc': 0.99984926, 'binary_precision': 0.9955668, 'binary_recall': 0.9961977, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.99588215}
confusion matrix:
      0     1
0  1519     7
1     6  1572
---- Validation: 
scalar performance:
{'acc': 0.8682353, 'precision': 0.86885405, 'recall': 0.8679608, 'specificity': 0.8679608, 'f1': 0.8680989, 'auroc': 0.93128073, 'binary_precision': 0.88099176, 'binary_recall': 0.84737676, 'binary_specificity': 0.8885449, 'binary_f1_score': 0.8638574}
confusion matrix:
     0    1
0  574   72
1   96  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8800905, 'precision': 0.88235295, 'recall': 0.8800905, 'specificity': 0.8800905, 'f1': 0.87991285, 'auroc': 0.9284413, 'binary_precision': 0.9117647, 'binary_recall': 0.84162897, 'binary_specificity': 0.91855204, 'binary_f1_score': 0.8752941}
confusion matrix:
     0    1
0  203   18
1   35  186
early stop counter: 13
val acc:0.8682352900505066, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 29,now: 2024-07-29 10:16:40.856192,epoch time: 0:01:39.117423,used: 0:48:23.101842,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98679125, 'precision': 0.98711157, 'recall': 0.98662466, 'specificity': 0.98662466, 'f1': 0.98678184, 'auroc': 0.9997338, 'binary_precision': 0.9782338, 'binary_recall': 0.99620014, 'binary_specificity': 0.9770492, 'binary_f1_score': 0.9871353}
confusion matrix:
      0     1
0  1490    35
1     6  1573
---- Validation: 
scalar performance:
{'acc': 0.84862745, 'precision': 0.86412907, 'recall': 0.8472513, 'specificity': 0.8472513, 'f1': 0.84661615, 'auroc': 0.90995157, 'binary_precision': 0.936, 'binary_recall': 0.74403816, 'binary_specificity': 0.95046437, 'binary_f1_score': 0.8290522}
confusion matrix:
     0    1
0  614   32
1  161  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85294116, 'precision': 0.86820745, 'recall': 0.85294116, 'specificity': 0.85294116, 'f1': 0.8514009, 'auroc': 0.8992444, 'binary_precision': 0.9431818, 'binary_recall': 0.75113124, 'binary_specificity': 0.95475113, 'binary_f1_score': 0.836272}
confusion matrix:
     0    1
0  211   10
1   55  166
early stop counter: 14
val acc:0.8486274480819702, best validation acc: 0.8917647004127502, corresponding to test acc:                         0.9072397947311401 / 0.9072397947311401
after epoch: 30,now: 2024-07-29 10:18:18.431833,epoch time: 0:01:37.575641,used: 0:50:00.677483,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_09_28_17_seed_12_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:50:00.677483 at 2024-07-29 10:18:18.431833
persisted model performance metric: 

scalar performance:
{'acc': 0.9072398, 'precision': 0.914375, 'recall': 0.9072398, 'specificity': 0.9072398, 'f1': 0.9068388, 'auroc': 0.9340718, 'binary_precision': 0.96875, 'binary_recall': 0.84162897, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.9007264}
confusion matrix:
     0    1
0  215    6
1   35  186
oracle model performance metric: 

scalar performance:
{'acc': 0.9072398, 'precision': 0.914375, 'recall': 0.9072398, 'specificity': 0.9072398, 'f1': 0.9068388, 'auroc': 0.9340718, 'binary_precision': 0.96875, 'binary_recall': 0.84162897, 'binary_specificity': 0.9728507, 'binary_f1_score': 0.9007264}
confusion matrix:
     0    1
0  215    6
1   35  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456211 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool | 415616 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |  40595 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456211 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool | 415616 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |  40595 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB |    943 TiB |    943 TiB |
|       from large pool | 407075 KiB |  13175 MiB |    932 TiB |    932 TiB |
|       from small pool |  40406 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14490 MiB | 177418 MiB | 162940 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 177162 MiB | 162750 MiB |
|       from small pool |     66 MiB |     70 MiB |    256 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475628 KiB |   1260 MiB | 688135 GiB | 688134 GiB |
|       from large pool | 465024 KiB |   1256 MiB | 676658 GiB | 676657 GiB |
|       from small pool |  10604 KiB |     45 MiB |  11476 GiB |  11476 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  169771 K  |  169770 K  |
|       from large pool |     187    |    1413    |   86438 K  |   86437 K  |
|       from small pool |    1117    |    1419    |   83333 K  |   83332 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  169771 K  |  169770 K  |
|       from large pool |     187    |    1413    |   86438 K  |   86437 K  |
|       from small pool |    1117    |    1419    |   83333 K  |   83332 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    7496    |    6860    |
|       from large pool |     603    |     603    |    7368    |    6765    |
|       from small pool |      33    |      35    |     128    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |  114094 K  |  114094 K  |
|       from large pool |      39    |     608    |   64583 K  |   64583 K  |
|       from small pool |      58    |     236    |   49511 K  |   49511 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    943 TiB |    943 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14490 MiB | 177418 MiB | 176508 MiB |
|       from large pool |    860 MiB |  14424 MiB | 177162 MiB | 176302 MiB |
|       from small pool |     50 MiB |     70 MiB |    256 MiB |    206 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 688135 GiB | 688135 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 676658 GiB | 676658 GiB |
|       from small pool |      0 KiB |     45 MiB |  11476 GiB |  11476 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  169771 K  |  169771 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83333 K  |   83333 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  169771 K  |  169771 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83333 K  |   83333 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    7496    |    7431    |
|       from large pool |      40    |     603    |    7368    |    7328    |
|       from small pool |      25    |      35    |     128    |     103    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  114095 K  |  114095 K  |
|       from large pool |       3    |     608    |   64583 K  |   64583 K  |
|       from small pool |       0    |     236    |   49511 K  |   49511 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |    946 TiB |    946 TiB |
|       from large pool |  16640 KiB |  13182 MiB |    935 TiB |    935 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |    943 TiB |    943 TiB |
|       from large pool |  16640 KiB |  13175 MiB |    932 TiB |    932 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14490 MiB | 177418 MiB | 176508 MiB |
|       from large pool |    860 MiB |  14424 MiB | 177162 MiB | 176302 MiB |
|       from small pool |     50 MiB |     70 MiB |    256 MiB |    206 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 688135 GiB | 688135 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 676658 GiB | 676658 GiB |
|       from small pool |      0 KiB |     45 MiB |  11476 GiB |  11476 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  169771 K  |  169771 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83333 K  |   83333 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  169771 K  |  169771 K  |
|       from large pool |       2    |    1413    |   86438 K  |   86438 K  |
|       from small pool |       0    |    1419    |   83333 K  |   83333 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    7496    |    7431    |
|       from large pool |      40    |     603    |    7368    |    7328    |
|       from small pool |      25    |      35    |     128    |     103    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  114095 K  |  114095 K  |
|       from large pool |       3    |     608    |   64583 K  |   64583 K  |
|       from small pool |       0    |     236    |   49511 K  |   49511 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367

 Experiment start at: 2024-07-29 10:19:03.860144
before training, model accuracy: 0.38596493005752563
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93782896, 'precision': 0.9409456, 'recall': 0.9389243, 'specificity': 0.9389243, 'f1': 0.9377931, 'auroc': 0.98984027, 'binary_precision': 0.9844082, 'binary_recall': 0.8926735, 'binary_specificity': 0.9851752, 'binary_f1_score': 0.93629926}
confusion matrix:
      0     1
0  1462    22
1   167  1389
---- Validation: 
scalar performance:
{'acc': 0.8356481, 'precision': 0.8538663, 'recall': 0.82955146, 'specificity': 0.82955146, 'f1': 0.83134556, 'auroc': 0.90826225, 'binary_precision': 0.92210525, 'binary_recall': 0.71335506, 'binary_specificity': 0.9457478, 'binary_f1_score': 0.8044077}
confusion matrix:
     0    1
0  645   37
1  176  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8464912, 'precision': 0.8670824, 'recall': 0.8464912, 'specificity': 0.8464912, 'f1': 0.8443079, 'auroc': 0.91518545, 'binary_precision': 0.954023, 'binary_recall': 0.7280702, 'binary_specificity': 0.9649123, 'binary_f1_score': 0.8258707}
confusion matrix:
     0    1
0  220    8
1   62  166
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 10:20:46.996340,epoch time: 0:01:43.136196,used: 0:01:43.136196,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9717105, 'precision': 0.97183347, 'recall': 0.9720688, 'specificity': 0.9720688, 'f1': 0.9717088, 'auroc': 0.9974696, 'binary_precision': 0.98740053, 'binary_recall': 0.9569409, 'binary_specificity': 0.98719674, 'binary_f1_score': 0.9719321}
confusion matrix:
      0     1
0  1465    19
1    67  1489
---- Validation: 
scalar performance:
{'acc': 0.8217593, 'precision': 0.8306446, 'recall': 0.81716686, 'specificity': 0.81716686, 'f1': 0.81867594, 'auroc': 0.888606, 'binary_precision': 0.87329435, 'binary_recall': 0.7296417, 'binary_specificity': 0.90469205, 'binary_f1_score': 0.7950311}
confusion matrix:
     0    1
0  617   65
1  166  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8530702, 'precision': 0.863712, 'recall': 0.85307014, 'specificity': 0.85307014, 'f1': 0.8519875, 'auroc': 0.9198215, 'binary_precision': 0.9259259, 'binary_recall': 0.76754385, 'binary_specificity': 0.9385965, 'binary_f1_score': 0.8393286}
confusion matrix:
     0    1
0  214   14
1   53  175
new oracle model saved
early stop counter: 1
val acc:0.8217592835426331, best validation acc: 0.8356481194496155, corresponding to test acc:                         0.8464912176132202 / 0.8530701994895935
after epoch: 2,now: 2024-07-29 10:22:21.865257,epoch time: 0:01:34.868917,used: 0:03:18.005113,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97203946, 'precision': 0.97198534, 'recall': 0.9720783, 'specificity': 0.9720783, 'f1': 0.9720267, 'auroc': 0.99684906, 'binary_precision': 0.97482246, 'binary_recall': 0.970437, 'binary_specificity': 0.97371966, 'binary_f1_score': 0.9726248}
confusion matrix:
      0     1
0  1445    39
1    46  1510
---- Validation: 
scalar performance:
{'acc': 0.80941355, 'precision': 0.8287164, 'recall': 0.80275726, 'specificity': 0.80275726, 'f1': 0.80381143, 'auroc': 0.8983494, 'binary_precision': 0.8963283, 'binary_recall': 0.67589575, 'binary_specificity': 0.9296188, 'binary_f1_score': 0.7706592}
confusion matrix:
     0    1
0  634   48
1  199  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8596491, 'precision': 0.866876, 'recall': 0.8596492, 'specificity': 0.8596492, 'f1': 0.85895455, 'auroc': 0.9167628, 'binary_precision': 0.9183673, 'binary_recall': 0.7894737, 'binary_specificity': 0.9298246, 'binary_f1_score': 0.8490566}
confusion matrix:
     0    1
0  212   16
1   48  180
new oracle model saved
early stop counter: 2
val acc:0.8094135522842407, best validation acc: 0.8356481194496155, corresponding to test acc:                         0.8464912176132202 / 0.859649121761322
after epoch: 3,now: 2024-07-29 10:23:55.433139,epoch time: 0:01:33.567882,used: 0:04:51.572995,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9799342, 'precision': 0.9798777, 'recall': 0.9799918, 'specificity': 0.9799918, 'f1': 0.9799261, 'auroc': 0.9979439, 'binary_precision': 0.98318243, 'binary_recall': 0.977492, 'binary_specificity': 0.98249155, 'binary_f1_score': 0.980329}
confusion matrix:
      0     1
0  1459    26
1    35  1520
---- Validation: 
scalar performance:
{'acc': 0.7847222, 'precision': 0.8214227, 'recall': 0.77548075, 'specificity': 0.77548075, 'f1': 0.77410245, 'auroc': 0.8836024, 'binary_precision': 0.9177057, 'binary_recall': 0.59934855, 'binary_specificity': 0.9516129, 'binary_f1_score': 0.7251231}
confusion matrix:
     0    1
0  649   33
1  246  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74561405, 'precision': 0.82373226, 'recall': 0.74561405, 'specificity': 0.74561405, 'f1': 0.7292827, 'auroc': 0.9100492, 'binary_precision': 0.98275864, 'binary_recall': 0.5, 'binary_specificity': 0.99122804, 'binary_f1_score': 0.6627907}
confusion matrix:
     0    1
0  226    2
1  114  114
early stop counter: 3
val acc:0.7847222089767456, best validation acc: 0.8356481194496155, corresponding to test acc:                         0.8464912176132202 / 0.859649121761322
after epoch: 4,now: 2024-07-29 10:25:39.977509,epoch time: 0:01:44.544370,used: 0:06:36.117365,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98519737, 'precision': 0.9853716, 'recall': 0.9850607, 'specificity': 0.9850607, 'f1': 0.98518527, 'auroc': 0.9986974, 'binary_precision': 0.9802799, 'binary_recall': 0.9909968, 'binary_specificity': 0.9791246, 'binary_f1_score': 0.98560923}
confusion matrix:
      0     1
0  1454    31
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.83719134, 'precision': 0.8413961, 'recall': 0.8340219, 'specificity': 0.8340219, 'f1': 0.83540547, 'auroc': 0.8940939, 'binary_precision': 0.8683729, 'binary_recall': 0.77361566, 'binary_specificity': 0.89442813, 'binary_f1_score': 0.8182602}
confusion matrix:
     0    1
0  610   72
1  139  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85087717, 'precision': 0.85417473, 'recall': 0.85087717, 'specificity': 0.85087717, 'f1': 0.85052925, 'auroc': 0.9215143, 'binary_precision': 0.88834953, 'binary_recall': 0.80263156, 'binary_specificity': 0.89912283, 'binary_f1_score': 0.8433179}
confusion matrix:
     0    1
0  205   23
1   45  183
better model found
persisted
after epoch: 5,now: 2024-07-29 10:27:14.819729,epoch time: 0:01:34.842220,used: 0:08:10.959585,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9700658, 'precision': 0.9710873, 'recall': 0.970706, 'specificity': 0.970706, 'f1': 0.97006434, 'auroc': 0.99830157, 'binary_precision': 0.9993174, 'binary_recall': 0.94208497, 'binary_specificity': 0.99932706, 'binary_f1_score': 0.9698575}
confusion matrix:
      0     1
0  1485     1
1    90  1464
---- Validation: 
scalar performance:
{'acc': 0.69367284, 'precision': 0.78922117, 'recall': 0.67784685, 'specificity': 0.67784685, 'f1': 0.65437603, 'auroc': 0.8344338, 'binary_precision': 0.94285715, 'binary_recall': 0.3762215, 'binary_specificity': 0.97947216, 'binary_f1_score': 0.53783464}
confusion matrix:
     0    1
0  668   14
1  383  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8201754, 'precision': 0.84574157, 'recall': 0.8201754, 'specificity': 0.8201754, 'f1': 0.81678843, 'auroc': 0.9021237, 'binary_precision': 0.939759, 'binary_recall': 0.68421054, 'binary_specificity': 0.95614034, 'binary_f1_score': 0.79187816}
confusion matrix:
     0    1
0  218   10
1   72  156
early stop counter: 1
val acc:0.6936728358268738, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 6,now: 2024-07-29 10:28:49.043312,epoch time: 0:01:34.223583,used: 0:09:45.183168,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9858553, 'precision': 0.98580617, 'recall': 0.9859019, 'specificity': 0.9859019, 'f1': 0.9858488, 'auroc': 0.9990897, 'binary_precision': 0.9883796, 'binary_recall': 0.98393315, 'binary_specificity': 0.98787063, 'binary_f1_score': 0.9861514}
confusion matrix:
      0     1
0  1466    18
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.7731481, 'precision': 0.8219172, 'recall': 0.762535, 'specificity': 0.762535, 'f1': 0.75900114, 'auroc': 0.90291536, 'binary_precision': 0.9347826, 'binary_recall': 0.5602606, 'binary_specificity': 0.96480936, 'binary_f1_score': 0.700611}
confusion matrix:
     0    1
0  658   24
1  270  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8114035, 'precision': 0.8526797, 'recall': 0.8114035, 'specificity': 0.8114035, 'f1': 0.8057191, 'auroc': 0.91339636, 'binary_precision': 0.97333336, 'binary_recall': 0.6403509, 'binary_specificity': 0.98245615, 'binary_f1_score': 0.7724868}
confusion matrix:
     0    1
0  224    4
1   82  146
early stop counter: 2
val acc:0.7731481194496155, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 7,now: 2024-07-29 10:30:20.646335,epoch time: 0:01:31.603023,used: 0:11:16.786191,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9782895, 'precision': 0.97910714, 'recall': 0.97789204, 'specificity': 0.97789204, 'f1': 0.97825444, 'auroc': 0.9989164, 'binary_precision': 0.964486, 'binary_recall': 0.99421966, 'binary_specificity': 0.9615644, 'binary_f1_score': 0.97912717}
confusion matrix:
      0     1
0  1426    57
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.80632716, 'precision': 0.8060795, 'recall': 0.80688864, 'specificity': 0.80688864, 'f1': 0.80613315, 'auroc': 0.88132954, 'binary_precision': 0.7831513, 'binary_recall': 0.8175896, 'binary_specificity': 0.7961877, 'binary_f1_score': 0.79999995}
confusion matrix:
     0    1
0  543  139
1  112  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75438595, 'precision': 0.7761444, 'recall': 0.75438595, 'specificity': 0.75438595, 'f1': 0.74945056, 'auroc': 0.9025662, 'binary_precision': 0.69863015, 'binary_recall': 0.8947368, 'binary_specificity': 0.61403507, 'binary_f1_score': 0.7846154}
confusion matrix:
     0    1
0  140   88
1   24  204
early stop counter: 3
val acc:0.8063271641731262, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 8,now: 2024-07-29 10:31:56.091776,epoch time: 0:01:35.445441,used: 0:12:52.231632,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.98263055, 'recall': 0.9828912, 'specificity': 0.9828912, 'f1': 0.98256415, 'auroc': 0.9988463, 'binary_precision': 0.9966953, 'binary_recall': 0.9691517, 'binary_specificity': 0.9966307, 'binary_f1_score': 0.98273045}
confusion matrix:
      0     1
0  1479     5
1    48  1508
---- Validation: 
scalar performance:
{'acc': 0.78549385, 'precision': 0.8294956, 'recall': 0.7755643, 'specificity': 0.7755643, 'f1': 0.77351946, 'auroc': 0.8986455, 'binary_precision': 0.9375, 'binary_recall': 0.5863192, 'binary_specificity': 0.96480936, 'binary_f1_score': 0.7214429}
confusion matrix:
     0    1
0  658   24
1  254  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377193, 'precision': 0.8666054, 'recall': 0.8377193, 'specificity': 0.8377193, 'f1': 0.8344584, 'auroc': 0.9200908, 'binary_precision': 0.9695122, 'binary_recall': 0.69736844, 'binary_specificity': 0.9780702, 'binary_f1_score': 0.8112245}
confusion matrix:
     0    1
0  223    5
1   69  159
early stop counter: 4
val acc:0.7854938507080078, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 9,now: 2024-07-29 10:33:29.539547,epoch time: 0:01:33.447771,used: 0:14:25.679403,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9820652, 'recall': 0.9822595, 'specificity': 0.9822595, 'f1': 0.9819071, 'auroc': 0.9995349, 'binary_precision': 0.99800664, 'binary_recall': 0.96653795, 'binary_specificity': 0.99798113, 'binary_f1_score': 0.98202026}
confusion matrix:
      0     1
0  1483     3
1    52  1502
---- Validation: 
scalar performance:
{'acc': 0.6566358, 'precision': 0.77482414, 'recall': 0.6385153, 'specificity': 0.6385153, 'f1': 0.5990921, 'auroc': 0.87258625, 'binary_precision': 0.9424084, 'binary_recall': 0.2931596, 'binary_specificity': 0.983871, 'binary_f1_score': 0.44720498}
confusion matrix:
     0    1
0  671   11
1  434  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.747807, 'precision': 0.82849675, 'recall': 0.747807, 'specificity': 0.747807, 'f1': 0.731307, 'auroc': 0.89864194, 'binary_precision': 0.99130434, 'binary_recall': 0.5, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.664723}
confusion matrix:
     0    1
0  227    1
1  114  114
early stop counter: 5
val acc:0.6566358208656311, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 10,now: 2024-07-29 10:35:25.236156,epoch time: 0:01:55.696609,used: 0:16:21.376012,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9884868, 'precision': 0.9884726, 'recall': 0.9884881, 'specificity': 0.9884881, 'f1': 0.9884802, 'auroc': 0.9992291, 'binary_precision': 0.9890745, 'binary_recall': 0.9884393, 'binary_specificity': 0.9885368, 'binary_f1_score': 0.98875684}
confusion matrix:
      0     1
0  1466    17
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.81558645, 'precision': 0.8408152, 'recall': 0.8082164, 'specificity': 0.8082164, 'f1': 0.8092059, 'auroc': 0.9059548, 'binary_precision': 0.92134833, 'binary_recall': 0.66775244, 'binary_specificity': 0.94868034, 'binary_f1_score': 0.77431536}
confusion matrix:
     0    1
0  647   35
1  204  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355263, 'precision': 0.8467388, 'recall': 0.83552635, 'specificity': 0.83552635, 'f1': 0.83418584, 'auroc': 0.9041436, 'binary_precision': 0.90909094, 'binary_recall': 0.74561405, 'binary_specificity': 0.9254386, 'binary_f1_score': 0.8192771}
confusion matrix:
     0    1
0  211   17
1   58  170
early stop counter: 6
val acc:0.8155864477157593, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 11,now: 2024-07-29 10:37:09.482947,epoch time: 0:01:44.246791,used: 0:18:05.622803,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.99208856, 'recall': 0.99211586, 'specificity': 0.99211586, 'f1': 0.9921018, 'auroc': 0.9997272, 'binary_precision': 0.9929078, 'binary_recall': 0.9916291, 'binary_specificity': 0.9926025, 'binary_f1_score': 0.9922681}
confusion matrix:
      0     1
0  1476    11
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.79243827, 'precision': 0.83294934, 'recall': 0.7829745, 'specificity': 0.7829745, 'f1': 0.78173447, 'auroc': 0.8991297, 'binary_precision': 0.93670887, 'binary_recall': 0.6026059, 'binary_specificity': 0.9633431, 'binary_f1_score': 0.73339945}
confusion matrix:
     0    1
0  657   25
1  244  370
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377193, 'precision': 0.86468637, 'recall': 0.8377193, 'specificity': 0.8377193, 'f1': 0.8346628, 'auroc': 0.91441596, 'binary_precision': 0.96385545, 'binary_recall': 0.7017544, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.8121828}
confusion matrix:
     0    1
0  222    6
1   68  160
early stop counter: 7
val acc:0.792438268661499, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 12,now: 2024-07-29 10:38:44.612024,epoch time: 0:01:35.129077,used: 0:19:40.751880,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.98619974, 'recall': 0.9864423, 'specificity': 0.9864423, 'f1': 0.9861827, 'auroc': 0.99959946, 'binary_precision': 0.9980237, 'binary_recall': 0.97490346, 'binary_specificity': 0.99798113, 'binary_f1_score': 0.9863281}
confusion matrix:
      0     1
0  1483     3
1    39  1515
---- Validation: 
scalar performance:
{'acc': 0.7029321, 'precision': 0.7910878, 'recall': 0.6877812, 'specificity': 0.6877812, 'f1': 0.6678859, 'auroc': 0.8578978, 'binary_precision': 0.93869734, 'binary_recall': 0.3990228, 'binary_specificity': 0.9765396, 'binary_f1_score': 0.56}
confusion matrix:
     0    1
0  666   16
1  369  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82894737, 'precision': 0.8500655, 'recall': 0.82894737, 'specificity': 0.82894737, 'f1': 0.82632816, 'auroc': 0.896699, 'binary_precision': 0.93604654, 'binary_recall': 0.70614034, 'binary_specificity': 0.9517544, 'binary_f1_score': 0.805}
confusion matrix:
     0    1
0  217   11
1   67  161
early stop counter: 8
val acc:0.7029321193695068, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 13,now: 2024-07-29 10:40:12.894871,epoch time: 0:01:28.282847,used: 0:21:09.034727,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.99383056, 'recall': 0.99367845, 'specificity': 0.99367845, 'f1': 0.9937458, 'auroc': 0.9997952, 'binary_precision': 0.9910486, 'binary_recall': 0.99678457, 'binary_specificity': 0.9905724, 'binary_f1_score': 0.9939083}
confusion matrix:
      0     1
0  1471    14
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.7978395, 'precision': 0.82938683, 'recall': 0.7894056, 'specificity': 0.7894056, 'f1': 0.78922534, 'auroc': 0.8868096, 'binary_precision': 0.9190476, 'binary_recall': 0.6286645, 'binary_specificity': 0.9501466, 'binary_f1_score': 0.7466151}
confusion matrix:
     0    1
0  648   34
1  228  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377193, 'precision': 0.8666054, 'recall': 0.8377193, 'specificity': 0.8377193, 'f1': 0.8344584, 'auroc': 0.918321, 'binary_precision': 0.9695122, 'binary_recall': 0.69736844, 'binary_specificity': 0.9780702, 'binary_f1_score': 0.8112245}
confusion matrix:
     0    1
0  223    5
1   69  159
early stop counter: 9
val acc:0.7978395223617554, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 14,now: 2024-07-29 10:41:53.282381,epoch time: 0:01:40.387510,used: 0:22:49.422237,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.978348, 'recall': 0.9784133, 'specificity': 0.9784133, 'f1': 0.97796047, 'auroc': 0.9992829, 'binary_precision': 0.9986586, 'binary_recall': 0.95817244, 'binary_specificity': 0.9986541, 'binary_f1_score': 0.9779967}
confusion matrix:
      0     1
0  1484     2
1    65  1489
---- Validation: 
scalar performance:
{'acc': 0.650463, 'precision': 0.7836385, 'recall': 0.63159466, 'specificity': 0.63159466, 'f1': 0.58671343, 'auroc': 0.8698585, 'binary_precision': 0.9653179, 'binary_recall': 0.27198696, 'binary_specificity': 0.99120235, 'binary_f1_score': 0.4243964}
confusion matrix:
     0    1
0  676    6
1  447  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69078946, 'precision': 0.8089431, 'recall': 0.69078946, 'specificity': 0.69078946, 'f1': 0.6581, 'auroc': 0.908164, 'binary_precision': 1.0, 'binary_recall': 0.38157895, 'binary_specificity': 1.0, 'binary_f1_score': 0.552381}
confusion matrix:
     0   1
0  228   0
1  141  87
early stop counter: 10
val acc:0.6504629850387573, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 15,now: 2024-07-29 10:43:27.982467,epoch time: 0:01:34.700086,used: 0:24:24.122323,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9927273, 'recall': 0.99280155, 'specificity': 0.99280155, 'f1': 0.9927605, 'auroc': 0.999777, 'binary_precision': 0.99482536, 'binary_recall': 0.9909794, 'binary_specificity': 0.99462366, 'binary_f1_score': 0.9928986}
confusion matrix:
      0     1
0  1480     8
1    14  1538
---- Validation: 
scalar performance:
{'acc': 0.7646605, 'precision': 0.82193756, 'recall': 0.7531714, 'specificity': 0.7531714, 'f1': 0.74781024, 'auroc': 0.8989613, 'binary_precision': 0.94524497, 'binary_recall': 0.534202, 'binary_specificity': 0.9721408, 'binary_f1_score': 0.6826223}
confusion matrix:
     0    1
0  663   19
1  286  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8114035, 'precision': 0.84589744, 'recall': 0.8114035, 'specificity': 0.8114035, 'f1': 0.80658144, 'auroc': 0.91288185, 'binary_precision': 0.9551282, 'binary_recall': 0.6535088, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.7760417}
confusion matrix:
     0    1
0  221    7
1   79  149
early stop counter: 11
val acc:0.7646604776382446, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 16,now: 2024-07-29 10:45:05.329373,epoch time: 0:01:37.346906,used: 0:26:01.469229,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9926962, 'recall': 0.9928806, 'specificity': 0.9928806, 'f1': 0.9927609, 'auroc': 0.9995587, 'binary_precision': 0.9980507, 'binary_recall': 0.98778135, 'binary_specificity': 0.9979798, 'binary_f1_score': 0.9928895}
confusion matrix:
      0     1
0  1482     3
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.6535494, 'precision': 0.7825955, 'recall': 0.6349332, 'specificity': 0.6349332, 'f1': 0.59210634, 'auroc': 0.8717892, 'binary_precision': 0.96089387, 'binary_recall': 0.2801303, 'binary_specificity': 0.9897361, 'binary_f1_score': 0.43379575}
confusion matrix:
     0    1
0  675    7
1  442  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6951754, 'precision': 0.81062675, 'recall': 0.6951754, 'specificity': 0.6951754, 'f1': 0.6639504, 'auroc': 0.91148716, 'binary_precision': 1.0, 'binary_recall': 0.39035088, 'binary_specificity': 1.0, 'binary_f1_score': 0.5615142}
confusion matrix:
     0   1
0  228   0
1  139  89
early stop counter: 12
val acc:0.6535493731498718, best validation acc: 0.8371913433074951, corresponding to test acc:                         0.8508771657943726 / 0.859649121761322
after epoch: 17,now: 2024-07-29 10:46:36.368985,epoch time: 0:01:31.039612,used: 0:27:32.508841,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97763157, 'precision': 0.97871923, 'recall': 0.9771801, 'specificity': 0.9771801, 'f1': 0.9775918, 'auroc': 0.99957824, 'binary_precision': 0.9609423, 'binary_recall': 0.99678457, 'binary_specificity': 0.95757574, 'binary_f1_score': 0.9785353}
confusion matrix:
      0     1
0  1422    63
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.87808645, 'precision': 0.8790463, 'recall': 0.87661314, 'specificity': 0.87661314, 'f1': 0.87741375, 'auroc': 0.92719495, 'binary_precision': 0.8890785, 'binary_recall': 0.8485342, 'binary_specificity': 0.90469205, 'binary_f1_score': 0.86833334}
confusion matrix:
     0    1
0  617   65
1   93  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87938595, 'precision': 0.8920641, 'recall': 0.87938595, 'specificity': 0.87938595, 'f1': 0.87840295, 'auroc': 0.93498003, 'binary_precision': 0.96256685, 'binary_recall': 0.7894737, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.8674699}
confusion matrix:
     0    1
0  221    7
1   48  180
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-29 10:48:07.546067,epoch time: 0:01:31.177082,used: 0:29:03.685923,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.99075294, 'recall': 0.990991, 'specificity': 0.990991, 'f1': 0.99078786, 'auroc': 0.9998263, 'binary_precision': 1.0, 'binary_recall': 0.981982, 'binary_specificity': 1.0, 'binary_f1_score': 0.9909091}
confusion matrix:
      0     1
0  1486     0
1    28  1526
---- Validation: 
scalar performance:
{'acc': 0.7083333, 'precision': 0.8035457, 'recall': 0.69299436, 'specificity': 0.69299436, 'f1': 0.6730025, 'auroc': 0.8901696, 'binary_precision': 0.9609375, 'binary_recall': 0.40065145, 'binary_specificity': 0.98533726, 'binary_f1_score': 0.56551725}
confusion matrix:
     0    1
0  672   10
1  368  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7916667, 'precision': 0.85294116, 'recall': 0.7916666, 'specificity': 0.7916666, 'f1': 0.78221416, 'auroc': 0.9066636, 'binary_precision': 1.0, 'binary_recall': 0.5833333, 'binary_specificity': 1.0, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  228    0
1   95  133
early stop counter: 1
val acc:0.7083333134651184, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 19,now: 2024-07-29 10:49:37.447808,epoch time: 0:01:29.901741,used: 0:30:33.587664,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.9930352, 'recall': 0.9931601, 'specificity': 0.9931601, 'f1': 0.99308896, 'auroc': 0.9998008, 'binary_precision': 0.996124, 'binary_recall': 0.9903661, 'binary_specificity': 0.99595416, 'binary_f1_score': 0.9932367}
confusion matrix:
      0     1
0  1477     6
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.8271605, 'precision': 0.8582176, 'recall': 0.8192947, 'specificity': 0.8192947, 'f1': 0.82048035, 'auroc': 0.91125095, 'binary_precision': 0.9513889, 'binary_recall': 0.6693811, 'binary_specificity': 0.96920824, 'binary_f1_score': 0.7858508}
confusion matrix:
     0    1
0  661   21
1  203  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82894737, 'precision': 0.8631807, 'recall': 0.82894737, 'specificity': 0.82894737, 'f1': 0.8248192, 'auroc': 0.9100877, 'binary_precision': 0.9746835, 'binary_recall': 0.6754386, 'binary_specificity': 0.98245615, 'binary_f1_score': 0.7979274}
confusion matrix:
     0    1
0  224    4
1   74  154
early stop counter: 2
val acc:0.8271604776382446, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 20,now: 2024-07-29 10:51:11.914078,epoch time: 0:01:34.466270,used: 0:32:08.053934,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9902421, 'recall': 0.9900383, 'specificity': 0.9900383, 'f1': 0.9901247, 'auroc': 0.9996358, 'binary_precision': 0.98659, 'binary_recall': 0.9942085, 'binary_specificity': 0.9858681, 'binary_f1_score': 0.99038464}
confusion matrix:
      0     1
0  1465    21
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.7824074, 'precision': 0.8266867, 'recall': 0.77238816, 'specificity': 0.77238816, 'f1': 0.77008784, 'auroc': 0.9073936, 'binary_precision': 0.934555, 'binary_recall': 0.58143324, 'binary_specificity': 0.9633431, 'binary_f1_score': 0.7168675}
confusion matrix:
     0    1
0  657   25
1  257  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8267544, 'precision': 0.8664013, 'recall': 0.82675433, 'specificity': 0.82675433, 'f1': 0.82193744, 'auroc': 0.920841, 'binary_precision': 0.9869281, 'binary_recall': 0.6622807, 'binary_specificity': 0.99122804, 'binary_f1_score': 0.7926509}
confusion matrix:
     0    1
0  226    2
1   77  151
early stop counter: 3
val acc:0.7824074029922485, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 21,now: 2024-07-29 10:52:41.298391,epoch time: 0:01:29.384313,used: 0:33:37.438247,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.9907996, 'recall': 0.99077153, 'specificity': 0.99077153, 'f1': 0.9907851, 'auroc': 0.9997757, 'binary_precision': 0.9903475, 'binary_recall': 0.9916237, 'binary_specificity': 0.98991936, 'binary_f1_score': 0.99098516}
confusion matrix:
      0     1
0  1473    15
1    13  1539
---- Validation: 
scalar performance:
{'acc': 0.8009259, 'precision': 0.84429747, 'recall': 0.79136384, 'specificity': 0.79136384, 'f1': 0.7904327, 'auroc': 0.9186026, 'binary_precision': 0.95408165, 'binary_recall': 0.60912055, 'binary_specificity': 0.97360706, 'binary_f1_score': 0.7435388}
confusion matrix:
     0    1
0  664   18
1  240  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8201754, 'precision': 0.855641, 'recall': 0.8201754, 'specificity': 0.8201754, 'f1': 0.8155776, 'auroc': 0.921572, 'binary_precision': 0.96794873, 'binary_recall': 0.6622807, 'binary_specificity': 0.9780702, 'binary_f1_score': 0.78645825}
confusion matrix:
     0    1
0  223    5
1   77  151
early stop counter: 4
val acc:0.8009259104728699, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 22,now: 2024-07-29 10:54:15.909146,epoch time: 0:01:34.610755,used: 0:35:12.049002,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99375, 'precision': 0.9937407, 'recall': 0.99375415, 'specificity': 0.99375415, 'f1': 0.9937473, 'auroc': 0.9997289, 'binary_precision': 0.9941973, 'binary_recall': 0.9935567, 'binary_specificity': 0.9939516, 'binary_f1_score': 0.9938769}
confusion matrix:
      0     1
0  1479     9
1    10  1542
---- Validation: 
scalar performance:
{'acc': 0.8117284, 'precision': 0.8525827, 'recall': 0.80260205, 'specificity': 0.80260205, 'f1': 0.8025101, 'auroc': 0.91900617, 'binary_precision': 0.960199, 'binary_recall': 0.6286645, 'binary_specificity': 0.9765396, 'binary_f1_score': 0.7598425}
confusion matrix:
     0    1
0  666   16
1  228  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8135965, 'precision': 0.8642173, 'recall': 0.8135965, 'specificity': 0.8135965, 'f1': 0.8068865, 'auroc': 0.92334175, 'binary_precision': 1.0, 'binary_recall': 0.627193, 'binary_specificity': 1.0, 'binary_f1_score': 0.77088946}
confusion matrix:
     0    1
0  228    0
1   85  143
early stop counter: 5
val acc:0.8117284178733826, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 23,now: 2024-07-29 10:55:49.407363,epoch time: 0:01:33.498217,used: 0:36:45.547219,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99407893, 'precision': 0.9941931, 'recall': 0.9939877, 'specificity': 0.9939877, 'f1': 0.9940748, 'auroc': 0.99990773, 'binary_precision': 0.9904215, 'binary_recall': 0.9980695, 'binary_specificity': 0.9899058, 'binary_f1_score': 0.99423075}
confusion matrix:
      0     1
0  1471    15
1     3  1551
---- Validation: 
scalar performance:
{'acc': 0.8294753, 'precision': 0.8568947, 'recall': 0.82206243, 'specificity': 0.82206243, 'f1': 0.82347184, 'auroc': 0.9095763, 'binary_precision': 0.9435666, 'binary_recall': 0.6807818, 'binary_specificity': 0.9633431, 'binary_f1_score': 0.7909177}
confusion matrix:
     0    1
0  657   25
1  196  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377193, 'precision': 0.86468637, 'recall': 0.8377193, 'specificity': 0.8377193, 'f1': 0.8346628, 'auroc': 0.9209372, 'binary_precision': 0.96385545, 'binary_recall': 0.7017544, 'binary_specificity': 0.9736842, 'binary_f1_score': 0.8121828}
confusion matrix:
     0    1
0  222    6
1   68  160
early stop counter: 6
val acc:0.8294752836227417, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 24,now: 2024-07-29 10:57:22.684131,epoch time: 0:01:33.276768,used: 0:38:18.823987,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.99475, 'recall': 0.9947183, 'specificity': 0.9947183, 'f1': 0.9947337, 'auroc': 0.99968904, 'binary_precision': 0.99422336, 'binary_recall': 0.9955013, 'binary_specificity': 0.9939353, 'binary_f1_score': 0.9948619}
confusion matrix:
      0     1
0  1475     9
1     7  1549
---- Validation: 
scalar performance:
{'acc': 0.75848764, 'precision': 0.79998296, 'recall': 0.7481994, 'specificity': 0.7481994, 'f1': 0.7443273, 'auroc': 0.84101415, 'binary_precision': 0.89920425, 'binary_recall': 0.5521173, 'binary_specificity': 0.9442815, 'binary_f1_score': 0.68415743}
confusion matrix:
     0    1
0  644   38
1  275  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83114034, 'precision': 0.85490584, 'recall': 0.83114034, 'specificity': 0.83114034, 'f1': 0.82826537, 'auroc': 0.9138581, 'binary_precision': 0.9467456, 'binary_recall': 0.7017544, 'binary_specificity': 0.9605263, 'binary_f1_score': 0.80604535}
confusion matrix:
     0    1
0  219    9
1   68  160
early stop counter: 7
val acc:0.7584876418113708, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 25,now: 2024-07-29 10:58:53.761906,epoch time: 0:01:31.077775,used: 0:39:49.901762,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99473685, 'precision': 0.9948056, 'recall': 0.9946753, 'specificity': 0.9946753, 'f1': 0.9947336, 'auroc': 0.99968994, 'binary_precision': 0.99231756, 'binary_recall': 0.997426, 'binary_specificity': 0.99192464, 'binary_f1_score': 0.99486524}
confusion matrix:
      0     1
0  1474    12
1     4  1550
---- Validation: 
scalar performance:
{'acc': 0.82330245, 'precision': 0.82791126, 'recall': 0.81985104, 'specificity': 0.81985104, 'f1': 0.8211859, 'auroc': 0.89276606, 'binary_precision': 0.85582256, 'binary_recall': 0.75407165, 'binary_specificity': 0.8856305, 'binary_f1_score': 0.8017316}
confusion matrix:
     0    1
0  604   78
1  151  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355263, 'precision': 0.8410437, 'recall': 0.83552635, 'specificity': 0.83552635, 'f1': 0.8348584, 'auroc': 0.9064135, 'binary_precision': 0.8844221, 'binary_recall': 0.7719298, 'binary_specificity': 0.89912283, 'binary_f1_score': 0.82435596}
confusion matrix:
     0    1
0  205   23
1   52  176
early stop counter: 8
val acc:0.8233024477958679, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 26,now: 2024-07-29 11:00:20.439743,epoch time: 0:01:26.677837,used: 0:41:16.579599,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.9927007, 'recall': 0.992926, 'specificity': 0.992926, 'f1': 0.9927614, 'auroc': 0.9999251, 'binary_precision': 1.0, 'binary_recall': 0.98585206, 'binary_specificity': 1.0, 'binary_f1_score': 0.99287564}
confusion matrix:
      0     1
0  1485     0
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.7970679, 'precision': 0.83670294, 'recall': 0.7877793, 'specificity': 0.7877793, 'f1': 0.78690696, 'auroc': 0.9007398, 'binary_precision': 0.9398496, 'binary_recall': 0.6107492, 'binary_specificity': 0.96480936, 'binary_f1_score': 0.7403751}
confusion matrix:
     0    1
0  658   24
1  239  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79605263, 'precision': 0.84650457, 'recall': 0.79605263, 'specificity': 0.79605263, 'f1': 0.78834844, 'auroc': 0.91074175, 'binary_precision': 0.9787234, 'binary_recall': 0.6052632, 'binary_specificity': 0.9868421, 'binary_f1_score': 0.74796754}
confusion matrix:
     0    1
0  225    3
1   90  138
early stop counter: 9
val acc:0.7970678806304932, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 27,now: 2024-07-29 11:01:59.224440,epoch time: 0:01:38.784697,used: 0:42:55.364296,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99572366, 'precision': 0.9956907, 'recall': 0.99575835, 'specificity': 0.99575835, 'f1': 0.9957218, 'auroc': 0.999906, 'binary_precision': 0.9974177, 'binary_recall': 0.9942085, 'binary_specificity': 0.9973082, 'binary_f1_score': 0.9958105}
confusion matrix:
      0     1
0  1482     4
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8441358, 'precision': 0.8616421, 'recall': 0.8382655, 'specificity': 0.8382655, 'f1': 0.840255, 'auroc': 0.91841394, 'binary_precision': 0.9291667, 'binary_recall': 0.72638434, 'binary_specificity': 0.9501466, 'binary_f1_score': 0.8153565}
confusion matrix:
     0    1
0  648   34
1  168  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8114035, 'precision': 0.8503289, 'recall': 0.8114035, 'specificity': 0.8114035, 'f1': 0.806015, 'auroc': 0.9190713, 'binary_precision': 0.96710527, 'binary_recall': 0.6447368, 'binary_specificity': 0.9780702, 'binary_f1_score': 0.77368414}
confusion matrix:
     0    1
0  223    5
1   81  147
early stop counter: 10
val acc:0.8441358208656311, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 28,now: 2024-07-29 11:03:36.170234,epoch time: 0:01:36.945794,used: 0:44:32.310090,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99276316, 'precision': 0.99270475, 'recall': 0.9928371, 'specificity': 0.9928371, 'f1': 0.9927602, 'auroc': 0.99965096, 'binary_precision': 0.996119, 'binary_recall': 0.98971725, 'binary_specificity': 0.9959569, 'binary_f1_score': 0.9929078}
confusion matrix:
      0     1
0  1478     6
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.8001543, 'precision': 0.8420532, 'recall': 0.7907119, 'specificity': 0.7907119, 'f1': 0.7898484, 'auroc': 0.9004873, 'binary_precision': 0.9493671, 'binary_recall': 0.6107492, 'binary_specificity': 0.9706745, 'binary_f1_score': 0.74331015}
confusion matrix:
     0    1
0  662   20
1  239  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7872807, 'precision': 0.84763384, 'recall': 0.7872807, 'specificity': 0.7872807, 'f1': 0.7776292, 'auroc': 0.92215395, 'binary_precision': 0.99248123, 'binary_recall': 0.57894737, 'binary_specificity': 0.99561405, 'binary_f1_score': 0.73130196}
confusion matrix:
     0    1
0  227    1
1   96  132
early stop counter: 11
val acc:0.8001543283462524, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 29,now: 2024-07-29 11:05:25.381261,epoch time: 0:01:49.211027,used: 0:46:21.521117,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9910891, 'recall': 0.99130154, 'specificity': 0.99130154, 'f1': 0.9911171, 'auroc': 0.99985456, 'binary_precision': 1.0, 'binary_recall': 0.9826031, 'binary_specificity': 1.0, 'binary_f1_score': 0.9912252}
confusion matrix:
      0     1
0  1488     0
1    27  1525
---- Validation: 
scalar performance:
{'acc': 0.69521606, 'precision': 0.8063276, 'recall': 0.67874473, 'specificity': 0.67874473, 'f1': 0.652796, 'auroc': 0.8935649, 'binary_precision': 0.9781659, 'binary_recall': 0.36482084, 'binary_specificity': 0.9926686, 'binary_f1_score': 0.5314353}
confusion matrix:
     0    1
0  677    5
1  390  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7368421, 'precision': 0.8275862, 'recall': 0.7368421, 'specificity': 0.7368421, 'f1': 0.7172619, 'auroc': 0.91870093, 'binary_precision': 1.0, 'binary_recall': 0.47368422, 'binary_specificity': 1.0, 'binary_f1_score': 0.6428572}
confusion matrix:
     0    1
0  228    0
1  120  108
early stop counter: 12
val acc:0.6952160596847534, best validation acc: 0.8780864477157593, corresponding to test acc:                         0.8793859481811523 / 0.8793859481811523
after epoch: 30,now: 2024-07-29 11:07:16.553187,epoch time: 0:01:51.171926,used: 0:48:12.693043,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_10_19_03_seed_13_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:48:12.693043 at 2024-07-29 11:07:16.553187
persisted model performance metric: 

scalar performance:
{'acc': 0.87938595, 'precision': 0.8920641, 'recall': 0.87938595, 'specificity': 0.87938595, 'f1': 0.87840295, 'auroc': 0.93498003, 'binary_precision': 0.96256685, 'binary_recall': 0.7894737, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.8674699}
confusion matrix:
     0    1
0  221    7
1   48  180
oracle model performance metric: 

scalar performance:
{'acc': 0.87938595, 'precision': 0.8920641, 'recall': 0.87938595, 'specificity': 0.87938595, 'f1': 0.87840295, 'auroc': 0.93498003, 'binary_precision': 0.96256685, 'binary_recall': 0.7894737, 'binary_specificity': 0.96929824, 'binary_f1_score': 0.8674699}
confusion matrix:
     0    1
0  221    7
1   48  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456214 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool | 415616 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |  40598 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456214 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool | 415616 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |  40598 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB |   1013 TiB |   1013 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1001 TiB |   1001 TiB |
|       from small pool |  40407 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14490 MiB | 190986 MiB | 176508 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 190714 MiB | 176302 MiB |
|       from small pool |     66 MiB |     70 MiB |    272 MiB |    206 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 475625 KiB |   1260 MiB | 739368 GiB | 739368 GiB |
|       from large pool | 465024 KiB |   1256 MiB | 727033 GiB | 727033 GiB |
|       from small pool |  10601 KiB |     45 MiB |  12335 GiB |  12335 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  182438 K  |  182437 K  |
|       from large pool |     187    |    1413    |   92848 K  |   92848 K  |
|       from small pool |    1123    |    1419    |   89590 K  |   89589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  182438 K  |  182437 K  |
|       from large pool |     187    |    1413    |   92848 K  |   92848 K  |
|       from small pool |    1123    |    1419    |   89590 K  |   89589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     637    |    8067    |    7431    |
|       from large pool |     603    |     603    |    7931    |    7328    |
|       from small pool |      33    |      35    |     136    |     103    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |  122745 K  |  122745 K  |
|       from large pool |      39    |     608    |   69531 K  |   69531 K  |
|       from small pool |      58    |     236    |   53214 K  |   53214 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1013 TiB |   1013 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1001 TiB |   1001 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14490 MiB | 190986 MiB | 190076 MiB |
|       from large pool |    860 MiB |  14424 MiB | 190714 MiB | 189854 MiB |
|       from small pool |     50 MiB |     70 MiB |    272 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 739368 GiB | 739368 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 727033 GiB | 727033 GiB |
|       from small pool |      0 KiB |     45 MiB |  12335 GiB |  12335 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  182438 K  |  182438 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89590 K  |   89590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  182438 K  |  182438 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89590 K  |   89590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    8067    |    8002    |
|       from large pool |      40    |     603    |    7931    |    7891    |
|       from small pool |      25    |      35    |     136    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  122746 K  |  122746 K  |
|       from large pool |       3    |     608    |   69531 K  |   69531 K  |
|       from small pool |       0    |     236    |   53215 K  |   53215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |   1016 TiB |   1016 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1004 TiB |   1004 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1013 TiB |   1013 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1001 TiB |   1001 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    910 MiB |  14490 MiB | 190986 MiB | 190076 MiB |
|       from large pool |    860 MiB |  14424 MiB | 190714 MiB | 189854 MiB |
|       from small pool |     50 MiB |     70 MiB |    272 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB | 739368 GiB | 739368 GiB |
|       from large pool |  24320 KiB |   1256 MiB | 727033 GiB | 727033 GiB |
|       from small pool |      0 KiB |     45 MiB |  12335 GiB |  12335 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  182438 K  |  182438 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89590 K  |   89590 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  182438 K  |  182438 K  |
|       from large pool |       2    |    1413    |   92848 K  |   92848 K  |
|       from small pool |       0    |    1419    |   89590 K  |   89590 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      65    |     637    |    8067    |    8002    |
|       from large pool |      40    |     603    |    7931    |    7891    |
|       from small pool |      25    |      35    |     136    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  122746 K  |  122746 K  |
|       from large pool |       3    |     608    |   69531 K  |   69531 K  |
|       from small pool |       0    |     236    |   53215 K  |   53215 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367

 Experiment start at: 2024-07-29 11:08:14.266525
before training, model accuracy: 0.5177778005599976
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94993454, 'precision': 0.95044696, 'recall': 0.94982123, 'specificity': 0.94982123, 'f1': 0.949909, 'auroc': 0.9885354, 'binary_precision': 0.9369483, 'binary_recall': 0.96556205, 'binary_specificity': 0.9340804, 'binary_f1_score': 0.95103997}
confusion matrix:
      0     1
0  1417   100
1    53  1486
---- Validation: 
scalar performance:
{'acc': 0.7710937, 'precision': 0.8054342, 'recall': 0.77419305, 'specificity': 0.77419305, 'f1': 0.76576847, 'auroc': 0.9107865, 'binary_precision': 0.69822484, 'binary_recall': 0.93949044, 'binary_specificity': 0.6088957, 'binary_f1_score': 0.8010862}
confusion matrix:
     0    1
0  397  255
1   38  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.8072438, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.7750125, 'auroc': 0.9128889, 'binary_precision': 0.71575344, 'binary_recall': 0.9288889, 'binary_specificity': 0.6311111, 'binary_f1_score': 0.80851066}
confusion matrix:
     0    1
0  142   83
1   16  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 11:10:08.453391,epoch time: 0:01:54.186866,used: 0:01:54.186866,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9698953, 'precision': 0.96989167, 'recall': 0.9699013, 'specificity': 0.9699013, 'f1': 0.9698948, 'auroc': 0.9962711, 'binary_precision': 0.9712794, 'binary_recall': 0.96875, 'binary_specificity': 0.97105265, 'binary_f1_score': 0.970013}
confusion matrix:
      0     1
0  1476    44
1    48  1488
---- Validation: 
scalar performance:
{'acc': 0.8257812, 'precision': 0.83115906, 'recall': 0.8269655, 'specificity': 0.8269655, 'f1': 0.8253846, 'auroc': 0.90845907, 'binary_precision': 0.78401124, 'binary_recall': 0.89012736, 'binary_specificity': 0.76380366, 'binary_f1_score': 0.8337062}
confusion matrix:
     0    1
0  498  154
1   69  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8088692, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.8063214, 'auroc': 0.9131852, 'binary_precision': 0.7827869, 'binary_recall': 0.8488889, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.81449896}
confusion matrix:
     0    1
0  172   53
1   34  191
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-29 11:11:55.228394,epoch time: 0:01:46.775003,used: 0:03:40.961869,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94600785, 'precision': 0.9509804, 'recall': 0.9463589, 'specificity': 0.9463589, 'f1': 0.945886, 'auroc': 0.995599, 'binary_precision': 1.0, 'binary_recall': 0.89271784, 'binary_specificity': 1.0, 'binary_f1_score': 0.9433185}
confusion matrix:
      0     1
0  1518     0
1   165  1373
---- Validation: 
scalar performance:
{'acc': 0.8078125, 'precision': 0.8345114, 'recall': 0.80513656, 'specificity': 0.80513656, 'f1': 0.8029039, 'auroc': 0.891031, 'binary_precision': 0.92444444, 'binary_recall': 0.6624204, 'binary_specificity': 0.9478528, 'binary_f1_score': 0.7717996}
confusion matrix:
     0    1
0  618   34
1  212  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.88103896, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.86050004, 'auroc': 0.9269334, 'binary_precision': 0.9657143, 'binary_recall': 0.7511111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.845}
confusion matrix:
     0    1
0  219    6
1   56  169
new oracle model saved
early stop counter: 1
val acc:0.807812511920929, best validation acc: 0.8257812261581421, corresponding to test acc:                         0.8066666722297668 / 0.8622221946716309
after epoch: 3,now: 2024-07-29 11:13:35.653055,epoch time: 0:01:40.424661,used: 0:05:21.386530,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93520945, 'precision': 0.94209385, 'recall': 0.9347679, 'specificity': 0.9347679, 'f1': 0.93490785, 'auroc': 0.99665177, 'binary_precision': 0.88869566, 'binary_recall': 0.9961014, 'binary_specificity': 0.8734344, 'binary_f1_score': 0.9393382}
confusion matrix:
      0     1
0  1325   192
1     6  1533
---- Validation: 
scalar performance:
{'acc': 0.709375, 'precision': 0.7708346, 'recall': 0.7137568, 'specificity': 0.7137568, 'f1': 0.69454914, 'auroc': 0.89988184, 'binary_precision': 0.63704497, 'binary_recall': 0.94745225, 'binary_specificity': 0.48006135, 'binary_f1_score': 0.7618438}
confusion matrix:
     0    1
0  313  339
1   33  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.77810305, 'recall': 0.66888887, 'specificity': 0.66888887, 'f1': 0.6328422, 'auroc': 0.91776794, 'binary_precision': 0.60382515, 'binary_recall': 0.9822222, 'binary_specificity': 0.35555556, 'binary_f1_score': 0.7478849}
confusion matrix:
    0    1
0  80  145
1   4  221
early stop counter: 2
val acc:0.7093750238418579, best validation acc: 0.8257812261581421, corresponding to test acc:                         0.8066666722297668 / 0.8622221946716309
after epoch: 4,now: 2024-07-29 11:15:19.915313,epoch time: 0:01:44.262258,used: 0:07:05.648788,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.9734354, 'recall': 0.9732651, 'specificity': 0.9732651, 'f1': 0.97316635, 'auroc': 0.9967259, 'binary_precision': 0.9866399, 'binary_recall': 0.9597141, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.97299075}
confusion matrix:
      0     1
0  1497    20
1    62  1477
---- Validation: 
scalar performance:
{'acc': 0.846875, 'precision': 0.84687495, 'recall': 0.846997, 'specificity': 0.846997, 'f1': 0.84686154, 'auroc': 0.91197836, 'binary_precision': 0.8375, 'binary_recall': 0.85350317, 'binary_specificity': 0.8404908, 'binary_f1_score': 0.8454259}
confusion matrix:
     0    1
0  548  104
1   92  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.81832856, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.815153, 'auroc': 0.92233086, 'binary_precision': 0.7886179, 'binary_recall': 0.8622222, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.8237792}
confusion matrix:
     0    1
0  173   52
1   31  194
better model found
persisted
after epoch: 5,now: 2024-07-29 11:16:55.315840,epoch time: 0:01:35.400527,used: 0:08:41.049315,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.9796337, 'recall': 0.97918093, 'specificity': 0.97918093, 'f1': 0.97905433, 'auroc': 0.9973898, 'binary_precision': 0.99797297, 'binary_recall': 0.9603381, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9787939}
confusion matrix:
      0     1
0  1515     3
1    61  1477
---- Validation: 
scalar performance:
{'acc': 0.8023437, 'precision': 0.807474, 'recall': 0.80108726, 'specificity': 0.80108726, 'f1': 0.80100465, 'auroc': 0.88807833, 'binary_precision': 0.8427788, 'binary_recall': 0.73407644, 'binary_specificity': 0.86809814, 'binary_f1_score': 0.7846809}
confusion matrix:
     0    1
0  566   86
1  167  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84, 'recall': 0.84, 'specificity': 0.84, 'f1': 0.84, 'auroc': 0.9101827, 'binary_precision': 0.84, 'binary_recall': 0.84, 'binary_specificity': 0.84, 'binary_f1_score': 0.84}
confusion matrix:
     0    1
0  189   36
1   36  189
early stop counter: 1
val acc:0.8023437261581421, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 6,now: 2024-07-29 11:18:36.378712,epoch time: 0:01:41.062872,used: 0:10:22.112187,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9790576, 'precision': 0.97925925, 'recall': 0.9791262, 'specificity': 0.9791262, 'f1': 0.97905684, 'auroc': 0.9988589, 'binary_precision': 0.9906729, 'binary_recall': 0.9674691, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.9789335}
confusion matrix:
      0     1
0  1505    14
1    50  1487
---- Validation: 
scalar performance:
{'acc': 0.840625, 'precision': 0.8479694, 'recall': 0.8392501, 'specificity': 0.8392501, 'f1': 0.8393507, 'auroc': 0.9009442, 'binary_precision': 0.894052, 'binary_recall': 0.76592356, 'binary_specificity': 0.9125767, 'binary_f1_score': 0.8250429}
confusion matrix:
     0    1
0  595   57
1  147  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8602754, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84768534, 'auroc': 0.9174716, 'binary_precision': 0.92432433, 'binary_recall': 0.76, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8341463}
confusion matrix:
     0    1
0  211   14
1   54  171
early stop counter: 2
val acc:0.840624988079071, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 7,now: 2024-07-29 11:20:19.833524,epoch time: 0:01:43.454812,used: 0:12:05.566999,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.97977185, 'recall': 0.97975373, 'specificity': 0.97975373, 'f1': 0.979712, 'auroc': 0.9974301, 'binary_precision': 0.9867987, 'binary_recall': 0.972674, 'binary_specificity': 0.98683345, 'binary_f1_score': 0.9796855}
confusion matrix:
      0     1
0  1499    20
1    42  1495
---- Validation: 
scalar performance:
{'acc': 0.771875, 'precision': 0.78935224, 'recall': 0.76950884, 'specificity': 0.76950884, 'f1': 0.7672727, 'auroc': 0.832192, 'binary_precision': 0.8559322, 'binary_recall': 0.6433121, 'binary_specificity': 0.8957055, 'binary_f1_score': 0.73454547}
confusion matrix:
     0    1
0  584   68
1  224  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.86525977, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8594942, 'auroc': 0.9202173, 'binary_precision': 0.90909094, 'binary_recall': 0.8, 'binary_specificity': 0.92, 'binary_f1_score': 0.85106385}
confusion matrix:
     0    1
0  207   18
1   45  180
early stop counter: 3
val acc:0.7718750238418579, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 8,now: 2024-07-29 11:21:55.695942,epoch time: 0:01:35.862418,used: 0:13:41.429417,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.97658277, 'recall': 0.9759443, 'specificity': 0.9759443, 'f1': 0.97577983, 'auroc': 0.9974193, 'binary_precision': 0.99796057, 'binary_recall': 0.9538661, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9754153}
confusion matrix:
      0     1
0  1514     3
1    71  1468
---- Validation: 
scalar performance:
{'acc': 0.7398437, 'precision': 0.8034133, 'recall': 0.73548806, 'specificity': 0.73548806, 'f1': 0.7230724, 'auroc': 0.8773812, 'binary_precision': 0.9376855, 'binary_recall': 0.50318474, 'binary_specificity': 0.96779144, 'binary_f1_score': 0.6549223}
confusion matrix:
     0    1
0  631   21
1  312  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.85942495, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.79666865, 'auroc': 0.9105778, 'binary_precision': 1.0, 'binary_recall': 0.60888886, 'binary_specificity': 1.0, 'binary_f1_score': 0.75690603}
confusion matrix:
     0    1
0  225    0
1   88  137
early stop counter: 4
val acc:0.7398437261581421, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 9,now: 2024-07-29 11:23:39.443627,epoch time: 0:01:43.747685,used: 0:15:25.177102,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9743391, 'recall': 0.97372234, 'specificity': 0.97372234, 'f1': 0.9738098, 'auroc': 0.9981929, 'binary_precision': 0.96022725, 'binary_recall': 0.9889467, 'binary_specificity': 0.958498, 'binary_f1_score': 0.9743754}
confusion matrix:
      0     1
0  1455    63
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.78984374, 'precision': 0.7919463, 'recall': 0.79060507, 'specificity': 0.79060507, 'f1': 0.78970397, 'auroc': 0.8776767, 'binary_precision': 0.7620438, 'binary_recall': 0.8312102, 'binary_specificity': 0.75, 'binary_f1_score': 0.79512566}
confusion matrix:
     0    1
0  489  163
1  106  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8200405, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8072095, 'auroc': 0.918242, 'binary_precision': 0.7602996, 'binary_recall': 0.9022222, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.82520324}
confusion matrix:
     0    1
0  161   64
1   22  203
early stop counter: 5
val acc:0.789843738079071, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 10,now: 2024-07-29 11:25:14.850524,epoch time: 0:01:35.406897,used: 0:17:00.583999,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96433246, 'precision': 0.9662474, 'recall': 0.96411157, 'specificity': 0.96411157, 'f1': 0.9642819, 'auroc': 0.99880284, 'binary_precision': 0.93811274, 'binary_recall': 0.9948018, 'binary_specificity': 0.93342125, 'binary_f1_score': 0.965626}
confusion matrix:
      0     1
0  1416   101
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.82109374, 'precision': 0.82614774, 'recall': 0.822247, 'specificity': 0.822247, 'f1': 0.8207128, 'auroc': 0.90289557, 'binary_precision': 0.7805907, 'binary_recall': 0.88375795, 'binary_specificity': 0.76073617, 'binary_f1_score': 0.82897687}
confusion matrix:
     0    1
0  496  156
1   73  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.7866143, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.7375207, 'auroc': 0.906963, 'binary_precision': 0.6796116, 'binary_recall': 0.93333334, 'binary_specificity': 0.56, 'binary_f1_score': 0.7865168}
confusion matrix:
     0    1
0  126   99
1   15  210
early stop counter: 6
val acc:0.821093738079071, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 11,now: 2024-07-29 11:26:51.327040,epoch time: 0:01:36.476516,used: 0:18:37.060515,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.9833696, 'recall': 0.9833648, 'specificity': 0.9833648, 'f1': 0.98331153, 'auroc': 0.99848205, 'binary_precision': 0.99076515, 'binary_recall': 0.9759584, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.98330605}
confusion matrix:
      0     1
0  1503    14
1    37  1502
---- Validation: 
scalar performance:
{'acc': 0.81640625, 'precision': 0.83746153, 'recall': 0.8140411, 'specificity': 0.8140411, 'f1': 0.8126602, 'auroc': 0.91140926, 'binary_precision': 0.91719747, 'binary_recall': 0.6878981, 'binary_specificity': 0.94018406, 'binary_f1_score': 0.78616923}
confusion matrix:
     0    1
0  613   39
1  196  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.86857533, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8468438, 'auroc': 0.92616296, 'binary_precision': 0.9537572, 'binary_recall': 0.73333335, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8291457}
confusion matrix:
     0    1
0  217    8
1   60  165
early stop counter: 7
val acc:0.81640625, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 12,now: 2024-07-29 11:28:19.644126,epoch time: 0:01:28.317086,used: 0:20:05.377601,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98395985, 'recall': 0.9839816, 'specificity': 0.9839816, 'f1': 0.9839655, 'auroc': 0.9990628, 'binary_precision': 0.9862924, 'binary_recall': 0.9818064, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.98404425}
confusion matrix:
      0     1
0  1496    21
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.82734376, 'precision': 0.8278115, 'recall': 0.826946, 'specificity': 0.826946, 'f1': 0.82711065, 'auroc': 0.90074146, 'binary_precision': 0.8363636, 'binary_recall': 0.8057325, 'binary_specificity': 0.8481595, 'binary_f1_score': 0.8207624}
confusion matrix:
     0    1
0  553   99
1  122  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8352529, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.828073, 'auroc': 0.9169382, 'binary_precision': 0.7890625, 'binary_recall': 0.8977778, 'binary_specificity': 0.76, 'binary_f1_score': 0.8399169}
confusion matrix:
     0    1
0  171   54
1   23  202
early stop counter: 8
val acc:0.827343761920929, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 13,now: 2024-07-29 11:29:57.238418,epoch time: 0:01:37.594292,used: 0:21:42.971893,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98920393, 'recall': 0.9892247, 'specificity': 0.9892247, 'f1': 0.9892014, 'auroc': 0.99959004, 'binary_precision': 0.99279636, 'binary_recall': 0.9856957, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9892333}
confusion matrix:
      0     1
0  1507    11
1    22  1516
---- Validation: 
scalar performance:
{'acc': 0.8140625, 'precision': 0.8319814, 'recall': 0.8118577, 'specificity': 0.8118577, 'f1': 0.8107238, 'auroc': 0.8714465, 'binary_precision': 0.9045643, 'binary_recall': 0.6942675, 'binary_specificity': 0.9294478, 'binary_f1_score': 0.7855855}
confusion matrix:
     0    1
0  606   46
1  192  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.87327063, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8513484, 'auroc': 0.9195457, 'binary_precision': 0.95953757, 'binary_recall': 0.73777777, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.8341709}
confusion matrix:
     0    1
0  218    7
1   59  166
early stop counter: 9
val acc:0.8140624761581421, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 14,now: 2024-07-29 11:31:42.585710,epoch time: 0:01:45.347292,used: 0:23:28.319185,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98480374, 'recall': 0.9846947, 'specificity': 0.9846947, 'f1': 0.98462003, 'auroc': 0.9990611, 'binary_precision': 0.996008, 'binary_recall': 0.973342, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9845445}
confusion matrix:
      0     1
0  1512     6
1    41  1497
---- Validation: 
scalar performance:
{'acc': 0.8046875, 'precision': 0.8372642, 'recall': 0.8017467, 'specificity': 0.8017467, 'f1': 0.7987422, 'auroc': 0.9133582, 'binary_precision': 0.9375, 'binary_recall': 0.64490443, 'binary_specificity': 0.95858896, 'binary_f1_score': 0.764151}
confusion matrix:
     0    1
0  625   27
1  223  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8823668, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85049534, 'auroc': 0.9424592, 'binary_precision': 0.9877301, 'binary_recall': 0.71555555, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.82989687}
confusion matrix:
     0    1
0  223    2
1   64  161
early stop counter: 10
val acc:0.8046875, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 15,now: 2024-07-29 11:33:23.379121,epoch time: 0:01:40.793411,used: 0:25:09.112596,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.983029, 'recall': 0.9827471, 'specificity': 0.9827471, 'f1': 0.9826555, 'auroc': 0.9991938, 'binary_precision': 0.99798656, 'binary_recall': 0.9674691, 'binary_specificity': 0.998025, 'binary_f1_score': 0.9824909}
confusion matrix:
      0     1
0  1516     3
1    50  1487
---- Validation: 
scalar performance:
{'acc': 0.66484374, 'precision': 0.7758378, 'recall': 0.6587912, 'specificity': 0.6587912, 'f1': 0.62243164, 'auroc': 0.8462338, 'binary_precision': 0.94618833, 'binary_recall': 0.33598727, 'binary_specificity': 0.9815951, 'binary_f1_score': 0.49588725}
confusion matrix:
     0    1
0  640   12
1  417  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.8378378, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7453311, 'auroc': 0.9425777, 'binary_precision': 1.0, 'binary_recall': 0.52, 'binary_specificity': 1.0, 'binary_f1_score': 0.68421054}
confusion matrix:
     0    1
0  225    0
1  108  117
early stop counter: 11
val acc:0.664843738079071, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 16,now: 2024-07-29 11:35:04.756432,epoch time: 0:01:41.377311,used: 0:26:50.489907,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98691696, 'recall': 0.98694617, 'specificity': 0.98694617, 'f1': 0.9869108, 'auroc': 0.9991039, 'binary_precision': 0.991481, 'binary_recall': 0.98246753, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.98695374}
confusion matrix:
      0     1
0  1503    13
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.78125, 'precision': 0.8059753, 'recall': 0.7785354, 'specificity': 0.7785354, 'f1': 0.7755488, 'auroc': 0.88884765, 'binary_precision': 0.88839287, 'binary_recall': 0.63375795, 'binary_specificity': 0.9233129, 'binary_f1_score': 0.7397769}
confusion matrix:
     0    1
0  602   50
1  230  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.8561473, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8530431, 'auroc': 0.92397034, 'binary_precision': 0.88780487, 'binary_recall': 0.8088889, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.84651166}
confusion matrix:
     0    1
0  202   23
1   43  182
early stop counter: 12
val acc:0.78125, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 17,now: 2024-07-29 11:36:48.829286,epoch time: 0:01:44.072854,used: 0:28:34.562761,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.98441565, 'recall': 0.9842497, 'specificity': 0.9842497, 'f1': 0.9842905, 'auroc': 0.999017, 'binary_precision': 0.97817713, 'binary_recall': 0.9908973, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.9844961}
confusion matrix:
      0     1
0  1484    34
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.796875, 'precision': 0.8257576, 'recall': 0.79404867, 'specificity': 0.79404867, 'f1': 0.7911458, 'auroc': 0.89041805, 'binary_precision': 0.91818184, 'binary_recall': 0.6433121, 'binary_specificity': 0.9447853, 'binary_f1_score': 0.75655437}
confusion matrix:
     0    1
0  616   36
1  224  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8639706, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.83982956, 'auroc': 0.9334321, 'binary_precision': 0.9529412, 'binary_recall': 0.72, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.82025313}
confusion matrix:
     0    1
0  217    8
1   63  162
early stop counter: 13
val acc:0.796875, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 18,now: 2024-07-29 11:38:31.028446,epoch time: 0:01:42.199160,used: 0:30:16.761921,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98929656, 'recall': 0.9891647, 'specificity': 0.9891647, 'f1': 0.9892, 'auroc': 0.99956787, 'binary_precision': 0.98392284, 'binary_recall': 0.9947984, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.98933077}
confusion matrix:
      0     1
0  1493    25
1     8  1530
---- Validation: 
scalar performance:
{'acc': 0.8046875, 'precision': 0.8292029, 'recall': 0.8020984, 'specificity': 0.8020984, 'f1': 0.79999804, 'auroc': 0.89848244, 'binary_precision': 0.9144737, 'binary_recall': 0.66401273, 'binary_specificity': 0.94018406, 'binary_f1_score': 0.7693727}
confusion matrix:
     0    1
0  613   39
1  211  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72888887, 'precision': 0.8157271, 'recall': 0.72888887, 'specificity': 0.72888887, 'f1': 0.7088707, 'auroc': 0.90921485, 'binary_precision': 0.9813084, 'binary_recall': 0.46666667, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.63253015}
confusion matrix:
     0    1
0  223    2
1  120  105
early stop counter: 14
val acc:0.8046875, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 19,now: 2024-07-29 11:40:16.442516,epoch time: 0:01:45.414070,used: 0:32:02.175991,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.9836494, 'recall': 0.98339766, 'specificity': 0.98339766, 'f1': 0.9833102, 'auroc': 0.9993125, 'binary_precision': 0.9979893, 'binary_recall': 0.9687703, 'binary_specificity': 0.998025, 'binary_f1_score': 0.98316276}
confusion matrix:
      0     1
0  1516     3
1    48  1489
---- Validation: 
scalar performance:
{'acc': 0.5914062, 'precision': 0.748366, 'recall': 0.5838039, 'specificity': 0.5838039, 'f1': 0.505697, 'auroc': 0.8617385, 'binary_precision': 0.9411765, 'binary_recall': 0.17834395, 'binary_specificity': 0.98926383, 'binary_f1_score': 0.29986614}
confusion matrix:
     0    1
0  645    7
1  516  112
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.7653302, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.4502729, 'auroc': 0.903921, 'binary_precision': 1.0, 'binary_recall': 0.115555555, 'binary_specificity': 1.0, 'binary_f1_score': 0.20717132}
confusion matrix:
     0   1
0  225   0
1  199  26
early stop counter: 15
val acc:0.5914062261581421, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 20,now: 2024-07-29 11:41:55.670935,epoch time: 0:01:39.228419,used: 0:33:41.404410,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.97785515, 'recall': 0.97696114, 'specificity': 0.97696114, 'f1': 0.9770793, 'auroc': 0.9995014, 'binary_precision': 0.96050155, 'binary_recall': 0.99545157, 'binary_specificity': 0.95847064, 'binary_f1_score': 0.9776643}
confusion matrix:
      0     1
0  1454    63
1     7  1532
---- Validation: 
scalar performance:
{'acc': 0.83984375, 'precision': 0.8412344, 'recall': 0.8404468, 'specificity': 0.8404468, 'f1': 0.83980066, 'auroc': 0.90762377, 'binary_precision': 0.8142645, 'binary_recall': 0.87261146, 'binary_specificity': 0.8082822, 'binary_f1_score': 0.8424289}
confusion matrix:
     0    1
0  527  125
1   80  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8214012, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7939923, 'auroc': 0.91375804, 'binary_precision': 0.73426574, 'binary_recall': 0.93333334, 'binary_specificity': 0.6622222, 'binary_f1_score': 0.82191783}
confusion matrix:
     0    1
0  149   76
1   15  210
early stop counter: 16
val acc:0.83984375, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 21,now: 2024-07-29 11:43:41.010805,epoch time: 0:01:45.339870,used: 0:35:26.744280,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98535377, 'recall': 0.9853278, 'specificity': 0.9853278, 'f1': 0.9852748, 'auroc': 0.9988594, 'binary_precision': 0.9933906, 'binary_recall': 0.9772432, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9852508}
confusion matrix:
      0     1
0  1508    10
1    35  1503
---- Validation: 
scalar performance:
{'acc': 0.6539062, 'precision': 0.72480047, 'recall': 0.6484946, 'specificity': 0.6484946, 'f1': 0.6194809, 'auroc': 0.7843969, 'binary_precision': 0.8464419, 'binary_recall': 0.3598726, 'binary_specificity': 0.93711656, 'binary_f1_score': 0.5050279}
confusion matrix:
     0    1
0  611   41
1  402  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8316282, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7977385, 'auroc': 0.88422716, 'binary_precision': 0.93037975, 'binary_recall': 0.6533333, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.76762396}
confusion matrix:
     0    1
0  214   11
1   78  147
early stop counter: 17
val acc:0.6539062261581421, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 22,now: 2024-07-29 11:45:25.085797,epoch time: 0:01:44.074992,used: 0:37:10.819272,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934599, 'recall': 0.9934514, 'specificity': 0.9934514, 'f1': 0.99345523, 'auroc': 0.999791, 'binary_precision': 0.9928525, 'binary_recall': 0.99414444, 'binary_specificity': 0.9927584, 'binary_f1_score': 0.9934981}
confusion matrix:
      0     1
0  1508    11
1     9  1528
---- Validation: 
scalar performance:
{'acc': 0.78125, 'precision': 0.8231818, 'recall': 0.77783203, 'specificity': 0.77783203, 'f1': 0.7724294, 'auroc': 0.9008636, 'binary_precision': 0.935, 'binary_recall': 0.5955414, 'binary_specificity': 0.9601227, 'binary_f1_score': 0.7276265}
confusion matrix:
     0    1
0  626   26
1  254  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.85898197, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81755155, 'auroc': 0.9306667, 'binary_precision': 0.9738562, 'binary_recall': 0.6622222, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7883598}
confusion matrix:
     0    1
0  221    4
1   76  149
early stop counter: 18
val acc:0.78125, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 23,now: 2024-07-29 11:46:58.177576,epoch time: 0:01:33.091779,used: 0:38:43.911051,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98273623, 'recall': 0.98244673, 'specificity': 0.98244673, 'f1': 0.9823283, 'auroc': 0.99897206, 'binary_precision': 0.9986568, 'binary_recall': 0.96621186, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9821664}
confusion matrix:
      0     1
0  1515     2
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.6171875, 'precision': 0.76287794, 'recall': 0.6100778, 'specificity': 0.6100778, 'f1': 0.548257, 'auroc': 0.8589678, 'binary_precision': 0.95394737, 'binary_recall': 0.23089172, 'binary_specificity': 0.98926383, 'binary_f1_score': 0.37179485}
confusion matrix:
     0    1
0  645    7
1  483  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.7665877, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.45843083, 'auroc': 0.88410866, 'binary_precision': 1.0, 'binary_recall': 0.12444445, 'binary_specificity': 1.0, 'binary_f1_score': 0.22134387}
confusion matrix:
     0   1
0  225   0
1  197  28
early stop counter: 19
val acc:0.6171875, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 24,now: 2024-07-29 11:48:30.561257,epoch time: 0:01:32.383681,used: 0:40:16.294732,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9957461, 'precision': 0.99576175, 'recall': 0.99573517, 'specificity': 0.99573517, 'f1': 0.9957458, 'auroc': 0.9999405, 'binary_precision': 0.9941672, 'binary_recall': 0.9973992, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9957806}
confusion matrix:
      0     1
0  1509     9
1     4  1534
---- Validation: 
scalar performance:
{'acc': 0.834375, 'precision': 0.850976, 'recall': 0.8323239, 'specificity': 0.8323239, 'f1': 0.83174604, 'auroc': 0.92075336, 'binary_precision': 0.92276424, 'binary_recall': 0.72292995, 'binary_specificity': 0.9417178, 'binary_f1_score': 0.8107143}
confusion matrix:
     0    1
0  614   38
1  174  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.86088955, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8250097, 'auroc': 0.9340444, 'binary_precision': 0.9683544, 'binary_recall': 0.68, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7989556}
confusion matrix:
     0    1
0  220    5
1   72  153
early stop counter: 20
val acc:0.8343750238418579, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 25,now: 2024-07-29 11:50:28.940387,epoch time: 0:01:58.379130,used: 0:42:14.673862,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.98962945, 'recall': 0.9895942, 'specificity': 0.9895942, 'f1': 0.9895288, 'auroc': 0.9991807, 'binary_precision': 0.99867636, 'binary_recall': 0.98050684, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9895082}
confusion matrix:
      0     1
0  1515     2
1    30  1509
---- Validation: 
scalar performance:
{'acc': 0.62109375, 'precision': 0.7677562, 'recall': 0.61402935, 'specificity': 0.61402935, 'f1': 0.5538278, 'auroc': 0.9208236, 'binary_precision': 0.9612903, 'binary_recall': 0.23726115, 'binary_specificity': 0.9907975, 'binary_f1_score': 0.3805875}
confusion matrix:
     0    1
0  646    6
1  479  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.75, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.46101233, 'auroc': 0.93579257, 'binary_precision': 0.96666664, 'binary_recall': 0.12888889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.22745097}
confusion matrix:
     0   1
0  224   1
1  196  29
early stop counter: 21
val acc:0.62109375, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 26,now: 2024-07-29 11:52:05.182246,epoch time: 0:01:36.241859,used: 0:43:50.915721,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.9914904, 'recall': 0.9915073, 'specificity': 0.9915073, 'f1': 0.99149203, 'auroc': 0.99941015, 'binary_precision': 0.9941138, 'binary_recall': 0.98893946, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.99151987}
confusion matrix:
      0     1
0  1510     9
1    17  1520
---- Validation: 
scalar performance:
{'acc': 0.7109375, 'precision': 0.8008571, 'recall': 0.7057364, 'specificity': 0.7057364, 'f1': 0.68427, 'auroc': 0.89749205, 'binary_precision': 0.9607143, 'binary_recall': 0.42834395, 'binary_specificity': 0.98312885, 'binary_f1_score': 0.592511}
confusion matrix:
     0    1
0  641   11
1  359  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.8248663, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.72183335, 'auroc': 0.92420745, 'binary_precision': 0.9909091, 'binary_recall': 0.48444444, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.6507463}
confusion matrix:
     0    1
0  224    1
1  116  109
early stop counter: 22
val acc:0.7109375, best validation acc: 0.846875011920929, corresponding to test acc:                         0.8155555725097656 / 0.8622221946716309
after epoch: 27,now: 2024-07-29 11:53:40.485074,epoch time: 0:01:35.302828,used: 0:45:26.218549,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.977701, 'recall': 0.9766311, 'specificity': 0.9766311, 'f1': 0.9767499, 'auroc': 0.9992149, 'binary_precision': 0.95815116, 'binary_recall': 0.9973992, 'binary_specificity': 0.955863, 'binary_f1_score': 0.9773813}
confusion matrix:
      0     1
0  1451    67
1     4  1534
---- Validation: 
scalar performance:
{'acc': 0.853125, 'precision': 0.85833555, 'recall': 0.851989, 'specificity': 0.851989, 'f1': 0.8522589, 'auroc': 0.9158115, 'binary_precision': 0.8971119, 'binary_recall': 0.79140127, 'binary_specificity': 0.9125767, 'binary_f1_score': 0.8409475}
confusion matrix:
     0    1
0  595   57
1  131  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.8825896, 'recall': 0.8644445, 'specificity': 0.8644445, 'f1': 0.8628179, 'auroc': 0.9424593, 'binary_precision': 0.96590906, 'binary_recall': 0.75555557, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8478803}
confusion matrix:
     0    1
0  219    6
1   55  170
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-29 11:55:31.014675,epoch time: 0:01:50.529601,used: 0:47:16.748150,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911809, 'recall': 0.99119663, 'specificity': 0.99119663, 'f1': 0.99116486, 'auroc': 0.99958754, 'binary_precision': 0.99606043, 'binary_recall': 0.9863459, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9911793}
confusion matrix:
      0     1
0  1512     6
1    21  1517
---- Validation: 
scalar performance:
{'acc': 0.85234374, 'precision': 0.8615948, 'recall': 0.8508411, 'specificity': 0.8508411, 'f1': 0.8509676, 'auroc': 0.9197936, 'binary_precision': 0.91493386, 'binary_recall': 0.77070063, 'binary_specificity': 0.9309816, 'binary_f1_score': 0.8366465}
confusion matrix:
     0    1
0  607   45
1  144  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.87168837, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85150003, 'auroc': 0.92418766, 'binary_precision': 0.95428574, 'binary_recall': 0.74222225, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.8350001}
confusion matrix:
     0    1
0  217    8
1   58  167
early stop counter: 1
val acc:0.852343738079071, best validation acc: 0.8531249761581421, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 29,now: 2024-07-29 11:56:59.545916,epoch time: 0:01:28.531241,used: 0:48:45.279391,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99316746, 'recall': 0.9931047, 'specificity': 0.9931047, 'f1': 0.99312747, 'auroc': 0.9998235, 'binary_precision': 0.99031633, 'binary_recall': 0.9961039, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.99320173}
confusion matrix:
      0     1
0  1501    15
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.8515625, 'precision': 0.86338735, 'recall': 0.84986913, 'specificity': 0.84986913, 'f1': 0.84986764, 'auroc': 0.92418784, 'binary_precision': 0.9244186, 'binary_recall': 0.75955415, 'binary_specificity': 0.94018406, 'binary_f1_score': 0.83391607}
confusion matrix:
     0    1
0  613   39
1  151  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8741685, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8437964, 'auroc': 0.94486916, 'binary_precision': 0.9756098, 'binary_recall': 0.7111111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8226221}
confusion matrix:
     0    1
0  221    4
1   65  160
early stop counter: 2
val acc:0.8515625, best validation acc: 0.8531249761581421, corresponding to test acc:                         0.8644444346427917 / 0.8644444346427917
after epoch: 30,now: 2024-07-29 11:58:45.870483,epoch time: 0:01:46.324567,used: 0:50:31.603958,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_08_14_seed_14_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:50:31.603958 at 2024-07-29 11:58:45.870483
persisted model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.8825896, 'recall': 0.8644445, 'specificity': 0.8644445, 'f1': 0.8628179, 'auroc': 0.9424593, 'binary_precision': 0.96590906, 'binary_recall': 0.75555557, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8478803}
confusion matrix:
     0    1
0  219    6
1   55  170
oracle model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.8825896, 'recall': 0.8644445, 'specificity': 0.8644445, 'f1': 0.8628179, 'auroc': 0.9424593, 'binary_precision': 0.96590906, 'binary_recall': 0.75555557, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.8478803}
confusion matrix:
     0    1
0  219    6
1   55  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_20seeds_nofreeze_2024-07-28_12-10-29/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456214 KiB |  13221 MiB |   1088 TiB |   1088 TiB |
|       from large pool | 415616 KiB |  13182 MiB |   1075 TiB |   1075 TiB |
|       from small pool |  40598 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 456214 KiB |  13221 MiB |   1088 TiB |   1088 TiB |
|       from large pool | 415616 KiB |  13182 MiB |   1075 TiB |   1075 TiB |
|       from small pool |  40598 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB |   1085 TiB |   1085 TiB |
|       from large pool | 407075 KiB |  13175 MiB |   1072 TiB |   1072 TiB |
|       from small pool |  40406 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14482 MiB |  14490 MiB | 204558 MiB | 190076 MiB |
|       from large pool |  14412 MiB |  14424 MiB | 204266 MiB | 189854 MiB |
|       from small pool |     70 MiB |     70 MiB |    292 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 477673 KiB |   1260 MiB |    773 TiB |    773 TiB |
|       from large pool | 465024 KiB |   1256 MiB |    760 TiB |    760 TiB |
|       from small pool |  12649 KiB |     45 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  195352 K  |  195350 K  |
|       from large pool |     187    |    1413    |   99406 K  |   99406 K  |
|       from small pool |    1123    |    1419    |   95945 K  |   95944 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  195352 K  |  195350 K  |
|       from large pool |     187    |    1413    |   99406 K  |   99406 K  |
|       from small pool |    1123    |    1419    |   95945 K  |   95944 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     638    |     638    |    8640    |    8002    |
|       from large pool |     603    |     603    |    8494    |    7891    |
|       from small pool |      35    |      35    |     146    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     652    |  131385 K  |  131385 K  |
|       from large pool |      39    |     608    |   74587 K  |   74587 K  |
|       from small pool |      63    |     236    |   56798 K  |   56798 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |   1088 TiB |   1088 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1075 TiB |   1075 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |   1088 TiB |   1088 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1075 TiB |   1075 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1072 TiB |   1072 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    912 MiB |  14490 MiB | 204558 MiB | 203646 MiB |
|       from large pool |    860 MiB |  14424 MiB | 204266 MiB | 203406 MiB |
|       from small pool |     52 MiB |     70 MiB |    292 MiB |    240 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |    773 TiB |    773 TiB |
|       from large pool |  24320 KiB |   1256 MiB |    760 TiB |    760 TiB |
|       from small pool |      0 KiB |     45 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  195352 K  |  195352 K  |
|       from large pool |       2    |    1413    |   99406 K  |   99406 K  |
|       from small pool |       0    |    1419    |   95945 K  |   95945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  195352 K  |  195352 K  |
|       from large pool |       2    |    1413    |   99406 K  |   99406 K  |
|       from small pool |       0    |    1419    |   95945 K  |   95945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     638    |    8640    |    8574    |
|       from large pool |      40    |     603    |    8494    |    8454    |
|       from small pool |      26    |      35    |     146    |     120    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  131385 K  |  131385 K  |
|       from large pool |       3    |     608    |   74587 K  |   74587 K  |
|       from small pool |       0    |     236    |   56798 K  |   56798 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13221 MiB |   1088 TiB |   1088 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1075 TiB |   1075 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13221 MiB |   1088 TiB |   1088 TiB |
|       from large pool |  16640 KiB |  13182 MiB |   1075 TiB |   1075 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |   1085 TiB |   1085 TiB |
|       from large pool |  16640 KiB |  13175 MiB |   1072 TiB |   1072 TiB |
|       from small pool |      0 KiB |     60 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    912 MiB |  14490 MiB | 204558 MiB | 203646 MiB |
|       from large pool |    860 MiB |  14424 MiB | 204266 MiB | 203406 MiB |
|       from small pool |     52 MiB |     70 MiB |    292 MiB |    240 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1260 MiB |    773 TiB |    773 TiB |
|       from large pool |  24320 KiB |   1256 MiB |    760 TiB |    760 TiB |
|       from small pool |      0 KiB |     45 MiB |     12 TiB |     12 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  195352 K  |  195352 K  |
|       from large pool |       2    |    1413    |   99406 K  |   99406 K  |
|       from small pool |       0    |    1419    |   95945 K  |   95945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  195352 K  |  195352 K  |
|       from large pool |       2    |    1413    |   99406 K  |   99406 K  |
|       from small pool |       0    |    1419    |   95945 K  |   95945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      66    |     638    |    8640    |    8574    |
|       from large pool |      40    |     603    |    8494    |    8454    |
|       from small pool |      26    |      35    |     146    |     120    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     652    |  131385 K  |  131385 K  |
|       from large pool |       3    |     608    |   74587 K  |   74587 K  |
|       from small pool |       0    |     236    |   56798 K  |   56798 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367

 Experiment start at: 2024-07-29 11:59:48.253727
before training, model accuracy: 0.5043668150901794
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.95231616, 'recall': 0.9521022, 'specificity': 0.9521022, 'f1': 0.95182127, 'auroc': 0.9881338, 'binary_precision': 0.9712567, 'binary_recall': 0.9326059, 'binary_specificity': 0.9715984, 'binary_f1_score': 0.951539}
confusion matrix:
      0     1
0  1471    43
1   105  1453
---- Validation: 
scalar performance:
{'acc': 0.7916987, 'precision': 0.8264528, 'recall': 0.7903124, 'specificity': 0.7903124, 'f1': 0.78545165, 'auroc': 0.8927444, 'binary_precision': 0.9308756, 'binary_recall': 0.6263566, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.7488416}
confusion matrix:
     0    1
0  626   30
1  241  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515284, 'precision': 0.87388706, 'recall': 0.8515284, 'specificity': 0.8515284, 'f1': 0.849275, 'auroc': 0.90127957, 'binary_precision': 0.9653179, 'binary_recall': 0.72925764, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.8308458}
confusion matrix:
     0    1
0  223    6
1   62  167
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-29 12:01:41.577784,epoch time: 0:01:53.324057,used: 0:01:53.324057,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.96546817, 'recall': 0.96552503, 'specificity': 0.96552503, 'f1': 0.96549004, 'auroc': 0.9943684, 'binary_precision': 0.96838707, 'binary_recall': 0.9634146, 'binary_specificity': 0.9676354, 'binary_f1_score': 0.96589446}
confusion matrix:
      0     1
0  1465    49
1    57  1501
---- Validation: 
scalar performance:
{'acc': 0.8139892, 'precision': 0.8340287, 'recall': 0.81294906, 'specificity': 0.81294906, 'f1': 0.8107966, 'auroc': 0.88992727, 'binary_precision': 0.9137577, 'binary_recall': 0.68992245, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.78621906}
confusion matrix:
     0    1
0  614   42
1  200  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.8592458, 'recall': 0.8471616, 'specificity': 0.8471616, 'f1': 0.84586537, 'auroc': 0.88247746, 'binary_precision': 0.9251337, 'binary_recall': 0.75545853, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.8317308}
confusion matrix:
     0    1
0  215   14
1   56  173
better model found
persisted
after epoch: 2,now: 2024-07-29 12:03:22.963930,epoch time: 0:01:41.386146,used: 0:03:34.710203,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9804907, 'recall': 0.98058593, 'specificity': 0.98058593, 'f1': 0.98046803, 'auroc': 0.9980762, 'binary_precision': 0.9889034, 'binary_recall': 0.9724005, 'binary_specificity': 0.98877144, 'binary_f1_score': 0.9805825}
confusion matrix:
      0     1
0  1497    17
1    43  1515
---- Validation: 
scalar performance:
{'acc': 0.7847809, 'precision': 0.8104407, 'recall': 0.7835567, 'specificity': 0.7835567, 'f1': 0.7797305, 'auroc': 0.8613892, 'binary_precision': 0.8976035, 'binary_recall': 0.6387597, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.7463769}
confusion matrix:
     0    1
0  609   47
1  233  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.82979494, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.8296813, 'auroc': 0.89483416, 'binary_precision': 0.83555555, 'binary_recall': 0.8209607, 'binary_specificity': 0.83842796, 'binary_f1_score': 0.8281938}
confusion matrix:
     0    1
0  192   37
1   41  188
early stop counter: 1
val acc:0.7847809195518494, best validation acc: 0.8139892220497131, corresponding to test acc:                         0.847161591053009 / 0.8515284061431885
after epoch: 3,now: 2024-07-29 12:05:06.382327,epoch time: 0:01:43.418397,used: 0:05:18.128600,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98470205, 'recall': 0.98469317, 'specificity': 0.98469317, 'f1': 0.9846976, 'auroc': 0.99812496, 'binary_precision': 0.98459566, 'binary_recall': 0.985228, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.9849118}
confusion matrix:
      0     1
0  1491    24
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.8093774, 'precision': 0.81289434, 'recall': 0.8089218, 'specificity': 0.8089218, 'f1': 0.8086719, 'auroc': 0.85926926, 'binary_precision': 0.8440208, 'binary_recall': 0.75503874, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.79705393}
confusion matrix:
     0    1
0  566   90
1  158  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860262, 'precision': 0.7969904, 'recall': 0.7860262, 'specificity': 0.7860262, 'f1': 0.78403294, 'auroc': 0.89191663, 'binary_precision': 0.73992676, 'binary_recall': 0.88209605, 'binary_specificity': 0.6899563, 'binary_f1_score': 0.80478084}
confusion matrix:
     0    1
0  158   71
1   27  202
early stop counter: 2
val acc:0.8093773722648621, best validation acc: 0.8139892220497131, corresponding to test acc:                         0.847161591053009 / 0.8515284061431885
after epoch: 4,now: 2024-07-29 12:06:53.191822,epoch time: 0:01:46.809495,used: 0:07:04.938095,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9832746, 'recall': 0.9832746, 'specificity': 0.9832746, 'f1': 0.98307294, 'auroc': 0.99799097, 'binary_precision': 0.99735796, 'binary_recall': 0.96919125, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.98307294}
confusion matrix:
      0     1
0  1510     4
1    48  1510
---- Validation: 
scalar performance:
{'acc': 0.7840123, 'precision': 0.8163953, 'recall': 0.7826515, 'specificity': 0.7826515, 'f1': 0.7777727, 'auroc': 0.8898326, 'binary_precision': 0.91552514, 'binary_recall': 0.6217054, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.74053556}
confusion matrix:
     0    1
0  619   37
1  244  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80131006, 'precision': 0.829517, 'recall': 0.80131006, 'specificity': 0.80131006, 'f1': 0.796965, 'auroc': 0.8812952, 'binary_precision': 0.9259259, 'binary_recall': 0.65502185, 'binary_specificity': 0.9475983, 'binary_f1_score': 0.7672634}
confusion matrix:
     0    1
0  217   12
1   79  150
early stop counter: 3
val acc:0.7840123176574707, best validation acc: 0.8139892220497131, corresponding to test acc:                         0.847161591053009 / 0.8515284061431885
after epoch: 5,now: 2024-07-29 12:08:24.433666,epoch time: 0:01:31.241844,used: 0:08:36.179939,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9717629, 'recall': 0.97077346, 'specificity': 0.97077346, 'f1': 0.9709997, 'auroc': 0.99733424, 'binary_precision': 0.95652175, 'binary_recall': 0.9878127, 'binary_specificity': 0.9537343, 'binary_f1_score': 0.9719154}
confusion matrix:
      0     1
0  1443    70
1    19  1540
---- Validation: 
scalar performance:
{'acc': 0.81629515, 'precision': 0.81635356, 'recall': 0.81635356, 'specificity': 0.81635356, 'f1': 0.81629515, 'auroc': 0.88765836, 'binary_precision': 0.8094512, 'binary_recall': 0.82325584, 'binary_specificity': 0.8094512, 'binary_f1_score': 0.81629515}
confusion matrix:
     0    1
0  531  125
1  114  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81877726, 'precision': 0.8189293, 'recall': 0.8187773, 'specificity': 0.8187773, 'f1': 0.81875575, 'auroc': 0.8931562, 'binary_precision': 0.82589287, 'binary_recall': 0.80786026, 'binary_specificity': 0.82969433, 'binary_f1_score': 0.8167771}
confusion matrix:
     0    1
0  190   39
1   44  185
better model found
persisted
after epoch: 6,now: 2024-07-29 12:10:14.558198,epoch time: 0:01:50.124532,used: 0:10:26.304471,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9838432, 'recall': 0.98390555, 'specificity': 0.98390555, 'f1': 0.9837238, 'auroc': 0.99897146, 'binary_precision': 0.99605525, 'binary_recall': 0.9717768, 'binary_specificity': 0.9960344, 'binary_f1_score': 0.9837662}
confusion matrix:
      0     1
0  1507     6
1    44  1515
---- Validation: 
scalar performance:
{'acc': 0.71483475, 'precision': 0.7820686, 'recall': 0.7127541, 'specificity': 0.7127541, 'f1': 0.69547904, 'auroc': 0.85461336, 'binary_precision': 0.91768295, 'binary_recall': 0.46666667, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.61870503}
confusion matrix:
     0    1
0  629   27
1  344  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6462882, 'precision': 0.7562206, 'recall': 0.6462882, 'specificity': 0.6462882, 'f1': 0.6037893, 'auroc': 0.86445725, 'binary_precision': 0.9240506, 'binary_recall': 0.3187773, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.474026}
confusion matrix:
     0   1
0  223   6
1  156  73
early stop counter: 1
val acc:0.7148347496986389, best validation acc: 0.8162951469421387, corresponding to test acc:                         0.8187772631645203 / 0.8515284061431885
after epoch: 7,now: 2024-07-29 12:11:48.192962,epoch time: 0:01:33.634764,used: 0:11:59.939235,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9822047, 'recall': 0.98227274, 'specificity': 0.98227274, 'f1': 0.9820962, 'auroc': 0.9985217, 'binary_precision': 0.99408674, 'binary_recall': 0.9704939, 'binary_specificity': 0.9940516, 'binary_f1_score': 0.98214865}
confusion matrix:
      0     1
0  1504     9
1    46  1513
---- Validation: 
scalar performance:
{'acc': 0.6679477, 'precision': 0.74952966, 'recall': 0.66550624, 'specificity': 0.66550624, 'f1': 0.6364399, 'auroc': 0.8548739, 'binary_precision': 0.8901099, 'binary_recall': 0.37674418, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.5294118}
confusion matrix:
     0    1
0  626   30
1  402  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.8519982, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.81692505, 'auroc': 0.90465474, 'binary_precision': 0.95652175, 'binary_recall': 0.6724891, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.7897436}
confusion matrix:
     0    1
0  222    7
1   75  154
early stop counter: 2
val acc:0.6679477095603943, best validation acc: 0.8162951469421387, corresponding to test acc:                         0.8187772631645203 / 0.8515284061431885
after epoch: 8,now: 2024-07-29 12:13:36.411893,epoch time: 0:01:48.218931,used: 0:13:48.158166,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98429435, 'recall': 0.9842654, 'specificity': 0.9842654, 'f1': 0.98404944, 'auroc': 0.99941576, 'binary_precision': 0.9993382, 'binary_recall': 0.96919125, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9840339}
confusion matrix:
      0     1
0  1513     1
1    48  1510
---- Validation: 
scalar performance:
{'acc': 0.5772483, 'precision': 0.7362329, 'recall': 0.5737474, 'specificity': 0.5737474, 'f1': 0.48727268, 'auroc': 0.8671725, 'binary_precision': 0.9279279, 'binary_recall': 0.15968992, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.27248678}
confusion matrix:
     0    1
0  648    8
1  542  103
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6877729, 'precision': 0.8077957, 'recall': 0.6877729, 'specificity': 0.6877729, 'f1': 0.6540475, 'auroc': 0.8974229, 'binary_precision': 1.0, 'binary_recall': 0.37554586, 'binary_specificity': 1.0, 'binary_f1_score': 0.5460318}
confusion matrix:
     0   1
0  229   0
1  143  86
early stop counter: 3
val acc:0.5772482752799988, best validation acc: 0.8162951469421387, corresponding to test acc:                         0.8187772631645203 / 0.8515284061431885
after epoch: 9,now: 2024-07-29 12:15:13.720678,epoch time: 0:01:37.308785,used: 0:15:25.466951,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_29_11_59_48_seed_15_23190367
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
slurmstepd: error: *** JOB 23190367 ON supergpu02 CANCELLED AT 2024-07-29T12:16:41 ***
