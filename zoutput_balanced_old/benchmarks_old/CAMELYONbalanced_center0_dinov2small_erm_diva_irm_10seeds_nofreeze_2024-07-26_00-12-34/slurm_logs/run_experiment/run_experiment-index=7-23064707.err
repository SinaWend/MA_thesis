Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:15:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=7
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707

 Experiment start at: 2024-07-26 00:15:44.067690
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.77734375, 'precision': 0.8468089, 'recall': 0.7744148, 'specificity': 0.7744148, 'f1': 0.76432574, 'auroc': 0.99196875, 'binary_precision': 0.6948168, 'binary_recall': 0.99935734, 'binary_specificity': 0.5494723, 'binary_f1_score': 0.8197153}
confusion matrix:
     0     1
0  833   683
1    1  1555
---- Validation: 
scalar performance:
{'acc': 0.64052796, 'precision': 0.7561712, 'recall': 0.6451568, 'specificity': 0.6451568, 'f1': 0.59888583, 'auroc': 0.8841597, 'binary_precision': 0.5805243, 'binary_recall': 0.97637796, 'binary_specificity': 0.31393567, 'binary_f1_score': 0.7281268}
confusion matrix:
     0    1
0  205  448
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.7459954, 'recall': 0.63255817, 'specificity': 0.63255817, 'f1': 0.5846782, 'auroc': 0.9097674, 'binary_precision': 0.57894737, 'binary_recall': 0.97209305, 'binary_specificity': 0.29302326, 'binary_f1_score': 0.7256944}
confusion matrix:
    0    1
0  63  152
1   6  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:18:29.451564,epoch time: 0:02:45.383874,used: 0:02:45.383874,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9721953, 'recall': 0.9721785, 'specificity': 0.9721785, 'f1': 0.9720052, 'auroc': 0.9970715, 'binary_precision': 0.985469, 'binary_recall': 0.9588689, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.971987}
confusion matrix:
      0     1
0  1494    22
1    64  1492
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.78600055, 'recall': 0.7614185, 'specificity': 0.7614185, 'f1': 0.75452244, 'auroc': 0.8532274, 'binary_precision': 0.695078, 'binary_recall': 0.911811, 'binary_specificity': 0.61102605, 'binary_f1_score': 0.7888283}
confusion matrix:
     0    1
0  399  254
1   56  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.7888415, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.7743819, 'auroc': 0.849324, 'binary_precision': 0.7297297, 'binary_recall': 0.87906975, 'binary_specificity': 0.6744186, 'binary_f1_score': 0.7974683}
confusion matrix:
     0    1
0  145   70
1   26  189
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:21:14.632254,epoch time: 0:02:45.180690,used: 0:05:30.564564,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.966728, 'recall': 0.96517676, 'specificity': 0.96517676, 'f1': 0.96544886, 'auroc': 0.997241, 'binary_precision': 0.9459127, 'binary_recall': 0.9884393, 'binary_specificity': 0.9419142, 'binary_f1_score': 0.9667086}
confusion matrix:
      0     1
0  1427    88
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8122852, 'recall': 0.7951743, 'specificity': 0.7951743, 'f1': 0.7909372, 'auroc': 0.9043181, 'binary_precision': 0.73207545, 'binary_recall': 0.91653544, 'binary_specificity': 0.67381316, 'binary_f1_score': 0.81398606}
confusion matrix:
     0    1
0  440  213
1   53  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8016707, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7997227, 'auroc': 0.89626825, 'binary_precision': 0.77922076, 'binary_recall': 0.8372093, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.80717486}
confusion matrix:
     0    1
0  164   51
1   35  180
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 00:24:00.036474,epoch time: 0:02:45.404220,used: 0:08:15.968784,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98073745, 'recall': 0.9806788, 'specificity': 0.9806788, 'f1': 0.98046875, 'auroc': 0.9976095, 'binary_precision': 0.99602383, 'binary_recall': 0.9653179, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.98043054}
confusion matrix:
      0     1
0  1509     6
1    54  1503
---- Validation: 
scalar performance:
{'acc': 0.7484472, 'precision': 0.7652966, 'recall': 0.74663997, 'specificity': 0.74663997, 'f1': 0.74343646, 'auroc': 0.8483993, 'binary_precision': 0.82875264, 'binary_recall': 0.61732286, 'binary_specificity': 0.87595713, 'binary_f1_score': 0.7075813}
confusion matrix:
     0    1
0  572   81
1  243  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.77726245, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7625154, 'auroc': 0.84049755, 'binary_precision': 0.8352941, 'binary_recall': 0.6604651, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.7376624}
confusion matrix:
     0    1
0  187   28
1   73  142
early stop counter: 1
val acc:0.7484471797943115, best validation acc: 0.79347825050354, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 4,now: 2024-07-26 00:26:44.207365,epoch time: 0:02:44.170891,used: 0:11:00.139675,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9834937, 'recall': 0.98355824, 'specificity': 0.98355824, 'f1': 0.9833983, 'auroc': 0.9976967, 'binary_precision': 0.9947472, 'binary_recall': 0.9724005, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9834469}
confusion matrix:
      0     1
0  1506     8
1    43  1515
---- Validation: 
scalar performance:
{'acc': 0.7173913, 'precision': 0.7510706, 'recall': 0.71477497, 'specificity': 0.71477497, 'f1': 0.705956, 'auroc': 0.8098612, 'binary_precision': 0.839599, 'binary_recall': 0.52755904, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.64796907}
confusion matrix:
     0    1
0  589   64
1  300  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67674416, 'precision': 0.70123154, 'recall': 0.6767442, 'specificity': 0.6767442, 'f1': 0.66660166, 'auroc': 0.79325044, 'binary_precision': 0.7714286, 'binary_recall': 0.5023256, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.6084508}
confusion matrix:
     0    1
0  183   32
1  107  108
early stop counter: 2
val acc:0.717391312122345, best validation acc: 0.79347825050354, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 5,now: 2024-07-26 00:29:28.440543,epoch time: 0:02:44.233178,used: 0:13:44.372853,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9567014, 'recall': 0.9529297, 'specificity': 0.9529297, 'f1': 0.9533223, 'auroc': 0.9968748, 'binary_precision': 0.921288, 'binary_recall': 0.9929306, 'binary_specificity': 0.91292876, 'binary_f1_score': 0.95576864}
confusion matrix:
      0     1
0  1384   132
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.71118015, 'precision': 0.7114248, 'recall': 0.71084154, 'specificity': 0.71084154, 'f1': 0.7108427, 'auroc': 0.78942496, 'binary_precision': 0.7159278, 'binary_recall': 0.68661416, 'binary_specificity': 0.7350689, 'binary_f1_score': 0.7009647}
confusion matrix:
     0    1
0  480  173
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.85249007, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84585804, 'auroc': 0.9138777, 'binary_precision': 0.8983957, 'binary_recall': 0.7813954, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8358209}
confusion matrix:
     0    1
0  196   19
1   47  168
new oracle model saved
early stop counter: 3
val acc:0.7111801505088806, best validation acc: 0.79347825050354, corresponding to test acc:                         0.800000011920929 / 0.8465116024017334
after epoch: 6,now: 2024-07-26 00:32:12.864605,epoch time: 0:02:44.424062,used: 0:16:28.796915,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9750545, 'recall': 0.974427, 'specificity': 0.974427, 'f1': 0.97459126, 'auroc': 0.99836564, 'binary_precision': 0.96365917, 'binary_recall': 0.987163, 'binary_specificity': 0.9616909, 'binary_f1_score': 0.97526956}
confusion matrix:
      0     1
0  1456    58
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.8128882, 'precision': 0.81347716, 'recall': 0.81255865, 'specificity': 0.81255865, 'f1': 0.8126595, 'auroc': 0.8689296, 'binary_precision': 0.8240132, 'binary_recall': 0.7889764, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.80611426}
confusion matrix:
     0    1
0  546  107
1  134  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8031744, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79947513, 'auroc': 0.87575984, 'binary_precision': 0.83419687, 'binary_recall': 0.74883723, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.7892157}
confusion matrix:
     0    1
0  183   32
1   54  161
better model found
persisted
after epoch: 7,now: 2024-07-26 00:34:57.433419,epoch time: 0:02:44.568814,used: 0:19:13.365729,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.96476924, 'recall': 0.96290207, 'specificity': 0.96290207, 'f1': 0.96316266, 'auroc': 0.9976121, 'binary_precision': 0.94067276, 'binary_recall': 0.989704, 'binary_specificity': 0.9361001, 'binary_f1_score': 0.9645657}
confusion matrix:
      0     1
0  1421    97
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.79014146, 'recall': 0.77273035, 'specificity': 0.77273035, 'f1': 0.76785606, 'auroc': 0.8428983, 'binary_precision': 0.7119701, 'binary_recall': 0.8992126, 'binary_specificity': 0.6462481, 'binary_f1_score': 0.79471123}
confusion matrix:
     0    1
0  422  231
1   64  571
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.75083333, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.72154427, 'auroc': 0.81776094, 'binary_precision': 0.675, 'binary_recall': 0.87906975, 'binary_specificity': 0.5767442, 'binary_f1_score': 0.7636364}
confusion matrix:
     0    1
0  124   91
1   26  189
early stop counter: 1
val acc:0.7709627151489258, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.800000011920929 / 0.8465116024017334
after epoch: 8,now: 2024-07-26 00:37:41.328403,epoch time: 0:02:43.894984,used: 0:21:57.260713,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.97099876, 'recall': 0.97014475, 'specificity': 0.97014475, 'f1': 0.9697194, 'auroc': 0.99800885, 'binary_precision': 0.99931836, 'binary_recall': 0.9409499, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.96925616}
confusion matrix:
      0     1
0  1513     1
1    92  1466
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.7486291, 'recall': 0.65887547, 'specificity': 0.65887547, 'f1': 0.6278666, 'auroc': 0.8717054, 'binary_precision': 0.8910506, 'binary_recall': 0.36062992, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.5134529}
confusion matrix:
     0    1
0  625   28
1  406  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5627907, 'precision': 0.7495915, 'recall': 0.5627907, 'specificity': 0.5627907, 'f1': 0.4621567, 'auroc': 0.8742888, 'binary_precision': 0.9655172, 'binary_recall': 0.13023256, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.2295082}
confusion matrix:
     0   1
0  214   1
1  187  28
early stop counter: 2
val acc:0.6630434989929199, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.800000011920929 / 0.8465116024017334
after epoch: 9,now: 2024-07-26 00:40:25.268057,epoch time: 0:02:43.939654,used: 0:24:41.200367,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895697, 'recall': 0.9896494, 'specificity': 0.9896494, 'f1': 0.98958266, 'auroc': 0.9990716, 'binary_precision': 0.9948052, 'binary_recall': 0.9845758, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.989664}
confusion matrix:
      0     1
0  1508     8
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.79567486, 'recall': 0.7697194, 'specificity': 0.7697194, 'f1': 0.76609945, 'auroc': 0.87720877, 'binary_precision': 0.87637967, 'binary_recall': 0.6251969, 'binary_specificity': 0.91424197, 'binary_f1_score': 0.7297795}
confusion matrix:
     0    1
0  597   56
1  238  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.7702718, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.7668315, 'auroc': 0.83351004, 'binary_precision': 0.79792744, 'binary_recall': 0.7162791, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.75490195}
confusion matrix:
     0    1
0  176   39
1   61  154
early stop counter: 3
val acc:0.77173912525177, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.800000011920929 / 0.8465116024017334
after epoch: 10,now: 2024-07-26 00:43:09.229520,epoch time: 0:02:43.961463,used: 0:27:25.161830,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899137, 'recall': 0.990014, 'specificity': 0.990014, 'f1': 0.98990846, 'auroc': 0.999122, 'binary_precision': 0.99739414, 'binary_recall': 0.98267007, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.9899774}
confusion matrix:
      0     1
0  1510     4
1    27  1531
---- Validation: 
scalar performance:
{'acc': 0.7663044, 'precision': 0.7987858, 'recall': 0.7639688, 'specificity': 0.7639688, 'f1': 0.7586758, 'auroc': 0.8818584, 'binary_precision': 0.8938679, 'binary_recall': 0.5968504, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.7157696}
confusion matrix:
     0    1
0  608   45
1  256  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.83890927, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.80775917, 'auroc': 0.8917469, 'binary_precision': 0.9350649, 'binary_recall': 0.66976744, 'binary_specificity': 0.95348835, 'binary_f1_score': 0.7804878}
confusion matrix:
     0    1
0  205   10
1   71  144
early stop counter: 4
val acc:0.7663043737411499, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.800000011920929 / 0.8465116024017334
after epoch: 11,now: 2024-07-26 00:45:52.923517,epoch time: 0:02:43.693997,used: 0:30:08.855827,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9753746, 'recall': 0.9749103, 'specificity': 0.9749103, 'f1': 0.97460663, 'auroc': 0.9983152, 'binary_precision': 0.99797845, 'binary_recall': 0.9517995, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97434217}
confusion matrix:
      0     1
0  1513     3
1    75  1481
---- Validation: 
scalar performance:
{'acc': 0.5295031, 'precision': 0.7432186, 'recall': 0.52285635, 'specificity': 0.52285635, 'f1': 0.3864063, 'auroc': 0.8857207, 'binary_precision': 0.9677419, 'binary_recall': 0.047244094, 'binary_specificity': 0.9984686, 'binary_f1_score': 0.09009009}
confusion matrix:
     0   1
0  652   1
1  605  30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5116279, 'precision': 0.68152654, 'recall': 0.5116279, 'specificity': 0.5116279, 'f1': 0.36245024, 'auroc': 0.9103894, 'binary_precision': 0.85714287, 'binary_recall': 0.027906977, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.054054055}
confusion matrix:
     0  1
0  214  1
1  209  6
early stop counter: 5
val acc:0.5295031070709229, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.800000011920929 / 0.8465116024017334
after epoch: 12,now: 2024-07-26 00:48:36.017136,epoch time: 0:02:43.093619,used: 0:32:51.949446,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_15_44_seed_0_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:32:51.949446 at 2024-07-26 00:48:36.017136
persisted model performance metric: 

scalar performance:
{'acc': 0.8, 'precision': 0.8031744, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79947513, 'auroc': 0.87575984, 'binary_precision': 0.83419687, 'binary_recall': 0.74883723, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.7892157}
confusion matrix:
     0    1
0  183   32
1   54  161
oracle model performance metric: 

scalar performance:
{'acc': 0.8465116, 'precision': 0.85249007, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.84585804, 'auroc': 0.9138777, 'binary_precision': 0.8983957, 'binary_recall': 0.7813954, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.8358209}
confusion matrix:
     0    1
0  196   19
1   47  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1985 MiB |   8587 MiB |  79847 GiB |  79845 GiB |
|       from large pool |   1894 MiB |   8511 MiB |  79152 GiB |  79150 GiB |
|       from small pool |     91 MiB |    129 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1985 MiB |   8587 MiB |  79847 GiB |  79845 GiB |
|       from large pool |   1894 MiB |   8511 MiB |  79152 GiB |  79150 GiB |
|       from small pool |     91 MiB |    129 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB |  79617 GiB |  79615 GiB |
|       from large pool |   1881 MiB |   8503 MiB |  78923 GiB |  78921 GiB |
|       from small pool |     91 MiB |    128 MiB |    693 GiB |    693 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9644 MiB |   9644 MiB |   9644 MiB |      0 B   |
|       from large pool |   9508 MiB |   9508 MiB |   9508 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1076 MiB |   1310 MiB |  52643 GiB |  52642 GiB |
|       from large pool |   1063 MiB |   1296 MiB |  51929 GiB |  51928 GiB |
|       from small pool |     12 MiB |     22 MiB |    714 GiB |    714 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3289    |   11218 K  |   11216 K  |
|       from large pool |     382    |     808    |    5710 K  |    5709 K  |
|       from small pool |    2062    |    2754    |    5508 K  |    5506 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3289    |   11218 K  |   11216 K  |
|       from large pool |     382    |     808    |    5710 K  |    5709 K  |
|       from small pool |    2062    |    2754    |    5508 K  |    5506 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     328    |     328    |     328    |       0    |
|       from large pool |     260    |     260    |     260    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |     315    |    6405 K  |    6404 K  |
|       from large pool |      75    |     251    |    3581 K  |    3581 K  |
|       from small pool |      69    |     229    |    2823 K  |    2823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8587 MiB |  79847 GiB |  79847 GiB |
|       from large pool |  16640 KiB |   8511 MiB |  79152 GiB |  79152 GiB |
|       from small pool |      0 KiB |    129 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8587 MiB |  79847 GiB |  79847 GiB |
|       from large pool |  16640 KiB |   8511 MiB |  79152 GiB |  79152 GiB |
|       from small pool |      0 KiB |    129 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB |  79617 GiB |  79617 GiB |
|       from large pool |  16640 KiB |   8503 MiB |  78923 GiB |  78923 GiB |
|       from small pool |      0 KiB |    128 MiB |    693 GiB |    693 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3062 MiB |   9644 MiB |   9644 MiB |   6582 MiB |
|       from large pool |   2958 MiB |   9508 MiB |   9508 MiB |   6550 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1438 MiB |  52644 GiB |  52644 GiB |
|       from large pool |  24320 KiB |   1410 MiB |  51930 GiB |  51930 GiB |
|       from small pool |      0 KiB |     56 MiB |    714 GiB |    714 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |   11218 K  |   11218 K  |
|       from large pool |       2    |     808    |    5710 K  |    5710 K  |
|       from small pool |       0    |    2754    |    5508 K  |    5508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |   11218 K  |   11218 K  |
|       from large pool |       2    |     808    |    5710 K  |    5710 K  |
|       from small pool |       0    |    2754    |    5508 K  |    5508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     328    |     328    |     200    |
|       from large pool |      76    |     260    |     260    |     184    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |    6405 K  |    6405 K  |
|       from large pool |       4    |     251    |    3581 K  |    3581 K  |
|       from small pool |       0    |     229    |    2823 K  |    2823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8587 MiB |  79847 GiB |  79847 GiB |
|       from large pool |  16640 KiB |   8511 MiB |  79152 GiB |  79152 GiB |
|       from small pool |      0 KiB |    129 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8587 MiB |  79847 GiB |  79847 GiB |
|       from large pool |  16640 KiB |   8511 MiB |  79152 GiB |  79152 GiB |
|       from small pool |      0 KiB |    129 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB |  79617 GiB |  79617 GiB |
|       from large pool |  16640 KiB |   8503 MiB |  78923 GiB |  78923 GiB |
|       from small pool |      0 KiB |    128 MiB |    693 GiB |    693 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3062 MiB |   9644 MiB |   9644 MiB |   6582 MiB |
|       from large pool |   2958 MiB |   9508 MiB |   9508 MiB |   6550 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1438 MiB |  52644 GiB |  52644 GiB |
|       from large pool |  24320 KiB |   1410 MiB |  51930 GiB |  51930 GiB |
|       from small pool |      0 KiB |     56 MiB |    714 GiB |    714 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |   11218 K  |   11218 K  |
|       from large pool |       2    |     808    |    5710 K  |    5710 K  |
|       from small pool |       0    |    2754    |    5508 K  |    5508 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |   11218 K  |   11218 K  |
|       from large pool |       2    |     808    |    5710 K  |    5710 K  |
|       from small pool |       0    |    2754    |    5508 K  |    5508 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     328    |     328    |     200    |
|       from large pool |      76    |     260    |     260    |     184    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |    6405 K  |    6405 K  |
|       from large pool |       4    |     251    |    3581 K  |    3581 K  |
|       from small pool |       0    |     229    |    2823 K  |    2823 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707

 Experiment start at: 2024-07-26 00:49:10.061820
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.91889524, 'recall': 0.91022146, 'specificity': 0.91022146, 'f1': 0.91057324, 'auroc': 0.98613393, 'binary_precision': 0.8651877, 'binary_recall': 0.9768786, 'binary_specificity': 0.84356433, 'binary_f1_score': 0.917647}
confusion matrix:
      0     1
0  1278   237
1    36  1521
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.80713713, 'recall': 0.79485404, 'specificity': 0.79485404, 'f1': 0.79136, 'auroc': 0.8778729, 'binary_precision': 0.7373212, 'binary_recall': 0.9, 'binary_specificity': 0.6897081, 'binary_f1_score': 0.81057894}
confusion matrix:
     0    1
0  449  202
1   63  567
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.7859336, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7761818, 'auroc': 0.8862617, 'binary_precision': 0.7376426, 'binary_recall': 0.8622222, 'binary_specificity': 0.6933333, 'binary_f1_score': 0.79508203}
confusion matrix:
     0    1
0  156   69
1   31  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:51:54.890582,epoch time: 0:02:44.828762,used: 0:02:44.828762,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.96008456, 'recall': 0.9587458, 'specificity': 0.9587458, 'f1': 0.95831406, 'auroc': 0.99566245, 'binary_precision': 0.99172986, 'binary_recall': 0.9254019, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.95741844}
confusion matrix:
      0     1
0  1505    12
1   116  1439
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.8561548, 'recall': 0.85337937, 'specificity': 0.85337937, 'f1': 0.8536078, 'auroc': 0.90494716, 'binary_precision': 0.8799314, 'binary_recall': 0.8142857, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.84583676}
confusion matrix:
     0    1
0  581   70
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.87602687, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8682637, 'auroc': 0.92659754, 'binary_precision': 0.92783505, 'binary_recall': 0.8, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8591885}
confusion matrix:
     0    1
0  211   14
1   45  180
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:54:40.094176,epoch time: 0:02:45.203594,used: 0:05:30.032356,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9322917, 'precision': 0.9400477, 'recall': 0.931492, 'specificity': 0.931492, 'f1': 0.93189657, 'auroc': 0.99786043, 'binary_precision': 0.88463736, 'binary_recall': 0.9961415, 'binary_specificity': 0.86684245, 'binary_f1_score': 0.93708414}
confusion matrix:
      0     1
0  1315   202
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.6916472, 'precision': 0.7706594, 'recall': 0.6960062, 'specificity': 0.6960062, 'f1': 0.6702939, 'auroc': 0.8972331, 'binary_precision': 0.62026614, 'binary_recall': 0.96190476, 'binary_specificity': 0.43010753, 'binary_f1_score': 0.75420034}
confusion matrix:
     0    1
0  280  371
1   24  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.79036754, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7049087, 'auroc': 0.9249778, 'binary_precision': 0.6497006, 'binary_recall': 0.96444446, 'binary_specificity': 0.48, 'binary_f1_score': 0.77638644}
confusion matrix:
     0    1
0  108  117
1    8  217
early stop counter: 1
val acc:0.6916471719741821, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 3,now: 2024-07-26 00:57:24.594698,epoch time: 0:02:44.500522,used: 0:08:14.532878,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.94908226, 'recall': 0.9446945, 'specificity': 0.9446945, 'f1': 0.9439037, 'auroc': 0.9976324, 'binary_precision': 1.0, 'binary_recall': 0.88938904, 'binary_specificity': 1.0, 'binary_f1_score': 0.94145674}
confusion matrix:
      0     1
0  1517     0
1   172  1383
---- Validation: 
scalar performance:
{'acc': 0.53239655, 'precision': 0.7199096, 'recall': 0.52468, 'specificity': 0.52468, 'f1': 0.392927, 'auroc': 0.9019006, 'binary_precision': 0.9189189, 'binary_recall': 0.053968254, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.10194903}
confusion matrix:
     0   1
0  648   3
1  596  34
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8808889, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  225  0
1  225  0
early stop counter: 2
val acc:0.5323965549468994, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 4,now: 2024-07-26 01:00:09.308857,epoch time: 0:02:44.714159,used: 0:10:59.247037,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9814179, 'recall': 0.98130035, 'specificity': 0.98130035, 'f1': 0.9811195, 'auroc': 0.99865067, 'binary_precision': 0.99667996, 'binary_recall': 0.96589446, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9810457}
confusion matrix:
      0     1
0  1513     5
1    53  1501
---- Validation: 
scalar performance:
{'acc': 0.7283372, 'precision': 0.7921703, 'recall': 0.7244496, 'specificity': 0.7244496, 'f1': 0.71037686, 'auroc': 0.8973173, 'binary_precision': 0.92469877, 'binary_recall': 0.4873016, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.6382536}
confusion matrix:
     0    1
0  626   25
1  323  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8467016, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82666254, 'auroc': 0.9051062, 'binary_precision': 0.92528737, 'binary_recall': 0.71555555, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.80701756}
confusion matrix:
     0    1
0  212   13
1   64  161
early stop counter: 3
val acc:0.7283372282981873, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 5,now: 2024-07-26 01:02:53.486380,epoch time: 0:02:44.177523,used: 0:13:43.424560,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9784437, 'recall': 0.9781321, 'specificity': 0.9781321, 'f1': 0.97786325, 'auroc': 0.998803, 'binary_precision': 0.9986595, 'binary_recall': 0.95758355, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9776903}
confusion matrix:
      0     1
0  1514     2
1    66  1490
---- Validation: 
scalar performance:
{'acc': 0.6229508, 'precision': 0.7630272, 'recall': 0.6168715, 'specificity': 0.6168715, 'f1': 0.55894244, 'auroc': 0.8921208, 'binary_precision': 0.9509202, 'binary_recall': 0.24603175, 'binary_specificity': 0.9877112, 'binary_f1_score': 0.39092055}
confusion matrix:
     0    1
0  643    8
1  475  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8472804, 'recall': 0.7866667, 'specificity': 0.7866667, 'f1': 0.7769333, 'auroc': 0.90712094, 'binary_precision': 0.99236643, 'binary_recall': 0.5777778, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.73033714}
confusion matrix:
     0    1
0  224    1
1   95  130
early stop counter: 4
val acc:0.6229507923126221, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 6,now: 2024-07-26 01:05:36.985909,epoch time: 0:02:43.499529,used: 0:16:26.924089,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9781743, 'recall': 0.97821265, 'specificity': 0.97821265, 'f1': 0.9781884, 'auroc': 0.9976851, 'binary_precision': 0.9805951, 'binary_recall': 0.9761751, 'binary_specificity': 0.9802502, 'binary_f1_score': 0.97838014}
confusion matrix:
      0     1
0  1489    30
1    37  1516
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8243095, 'recall': 0.82437277, 'specificity': 0.82437277, 'f1': 0.82432854, 'auroc': 0.89399457, 'binary_precision': 0.81889766, 'binary_recall': 0.82539684, 'binary_specificity': 0.8233487, 'binary_f1_score': 0.8221344}
confusion matrix:
     0    1
0  536  115
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.9294617, 'binary_precision': 0.8200837, 'binary_recall': 0.8711111, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  182   43
1   29  196
early stop counter: 5
val acc:0.824355959892273, best validation acc: 0.8540202975273132, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 7,now: 2024-07-26 01:08:20.953725,epoch time: 0:02:43.967816,used: 0:19:10.891905,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_49_10_seed_1_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:10.891905 at 2024-07-26 01:08:20.953725
persisted model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.87602687, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8682637, 'auroc': 0.92659754, 'binary_precision': 0.92783505, 'binary_recall': 0.8, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8591885}
confusion matrix:
     0    1
0  211   14
1   45  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.87602687, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.8682637, 'auroc': 0.92659754, 'binary_precision': 0.92783505, 'binary_recall': 0.8, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8591885}
confusion matrix:
     0    1
0  211   14
1   45  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1987 MiB |   8587 MiB | 126404 GiB | 126402 GiB |
|       from large pool |   1896 MiB |   8512 MiB | 125300 GiB | 125298 GiB |
|       from small pool |     91 MiB |    132 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1987 MiB |   8587 MiB | 126404 GiB | 126402 GiB |
|       from large pool |   1896 MiB |   8512 MiB | 125300 GiB | 125298 GiB |
|       from small pool |     91 MiB |    132 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 126135 GiB | 126133 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 125033 GiB | 125031 GiB |
|       from small pool |     91 MiB |    132 MiB |   1102 GiB |   1101 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9566 MiB |   9644 MiB |  16148 MiB |   6582 MiB |
|       from large pool |   9426 MiB |   9508 MiB |  15976 MiB |   6550 MiB |
|       from small pool |    140 MiB |    140 MiB |    172 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1214 MiB |   1438 MiB |  86875 GiB |  86874 GiB |
|       from large pool |   1205 MiB |   1410 MiB |  85740 GiB |  85739 GiB |
|       from small pool |      8 MiB |     56 MiB |   1135 GiB |   1135 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   17789 K  |   17786 K  |
|       from large pool |     382    |     808    |    9047 K  |    9047 K  |
|       from small pool |    2074    |    2766    |    8741 K  |    8739 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   17789 K  |   17786 K  |
|       from large pool |     382    |     808    |    9047 K  |    9047 K  |
|       from small pool |    2074    |    2766    |    8741 K  |    8739 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     328    |     491    |     200    |
|       from large pool |     221    |     260    |     405    |     184    |
|       from small pool |      70    |      70    |      86    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |     315    |    9782 K  |    9782 K  |
|       from large pool |      77    |     251    |    5317 K  |    5316 K  |
|       from small pool |      68    |     229    |    4465 K  |    4465 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8587 MiB | 126404 GiB | 126404 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 125300 GiB | 125300 GiB |
|       from small pool |      0 KiB |    132 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8587 MiB | 126404 GiB | 126404 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 125300 GiB | 125300 GiB |
|       from small pool |      0 KiB |    132 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 126135 GiB | 126135 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 125033 GiB | 125033 GiB |
|       from small pool |      0 KiB |    132 MiB |   1102 GiB |   1102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3202 MiB |   9644 MiB |  16148 MiB |  12946 MiB |
|       from large pool |   3102 MiB |   9508 MiB |  15976 MiB |  12874 MiB |
|       from small pool |    100 MiB |    140 MiB |    172 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1438 MiB |  86876 GiB |  86876 GiB |
|       from large pool |  24320 KiB |   1410 MiB |  85741 GiB |  85741 GiB |
|       from small pool |      0 KiB |     56 MiB |   1135 GiB |   1135 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   17789 K  |   17789 K  |
|       from large pool |       2    |     808    |    9047 K  |    9047 K  |
|       from small pool |       0    |    2766    |    8741 K  |    8741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   17789 K  |   17789 K  |
|       from large pool |       2    |     808    |    9047 K  |    9047 K  |
|       from small pool |       0    |    2766    |    8741 K  |    8741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     328    |     491    |     366    |
|       from large pool |      75    |     260    |     405    |     330    |
|       from small pool |      50    |      70    |      86    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |    9782 K  |    9782 K  |
|       from large pool |       4    |     251    |    5317 K  |    5317 K  |
|       from small pool |       0    |     229    |    4465 K  |    4465 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8587 MiB | 126404 GiB | 126404 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 125300 GiB | 125300 GiB |
|       from small pool |      0 KiB |    132 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8587 MiB | 126404 GiB | 126404 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 125300 GiB | 125300 GiB |
|       from small pool |      0 KiB |    132 MiB |   1103 GiB |   1103 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 126135 GiB | 126135 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 125033 GiB | 125033 GiB |
|       from small pool |      0 KiB |    132 MiB |   1102 GiB |   1102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3202 MiB |   9644 MiB |  16148 MiB |  12946 MiB |
|       from large pool |   3102 MiB |   9508 MiB |  15976 MiB |  12874 MiB |
|       from small pool |    100 MiB |    140 MiB |    172 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1438 MiB |  86876 GiB |  86876 GiB |
|       from large pool |  24320 KiB |   1410 MiB |  85741 GiB |  85741 GiB |
|       from small pool |      0 KiB |     56 MiB |   1135 GiB |   1135 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   17789 K  |   17789 K  |
|       from large pool |       2    |     808    |    9047 K  |    9047 K  |
|       from small pool |       0    |    2766    |    8741 K  |    8741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   17789 K  |   17789 K  |
|       from large pool |       2    |     808    |    9047 K  |    9047 K  |
|       from small pool |       0    |    2766    |    8741 K  |    8741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     328    |     491    |     366    |
|       from large pool |      75    |     260    |     405    |     330    |
|       from small pool |      50    |      70    |      86    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |    9782 K  |    9782 K  |
|       from large pool |       4    |     251    |    5317 K  |    5317 K  |
|       from small pool |       0    |     229    |    4465 K  |    4465 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707

 Experiment start at: 2024-07-26 01:08:54.285215
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94895285, 'precision': 0.95245683, 'recall': 0.9493095, 'specificity': 0.9493095, 'f1': 0.94887924, 'auroc': 0.9894134, 'binary_precision': 0.9942857, 'binary_recall': 0.9038961, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.94693875}
confusion matrix:
      0     1
0  1508     8
1   148  1392
---- Validation: 
scalar performance:
{'acc': 0.7370892, 'precision': 0.7373294, 'recall': 0.73631966, 'specificity': 0.73631966, 'f1': 0.736469, 'auroc': 0.7962806, 'binary_precision': 0.7407407, 'binary_recall': 0.7073955, 'binary_specificity': 0.7652439, 'binary_f1_score': 0.7236842}
confusion matrix:
     0    1
0  502  154
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.7656032, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.7549472, 'auroc': 0.8446287, 'binary_precision': 0.8135593, 'binary_recall': 0.6666667, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.7328244}
confusion matrix:
     0    1
0  183   33
1   72  144
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:11:38.464532,epoch time: 0:02:44.179317,used: 0:02:44.179317,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9545157, 'precision': 0.95779824, 'recall': 0.95485985, 'specificity': 0.95485985, 'f1': 0.9544556, 'auroc': 0.99431217, 'binary_precision': 0.9985765, 'binary_recall': 0.91103894, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.95280135}
confusion matrix:
      0     1
0  1514     2
1   137  1403
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.8498697, 'recall': 0.828712, 'specificity': 0.828712, 'f1': 0.8285537, 'auroc': 0.91804814, 'binary_precision': 0.9230769, 'binary_recall': 0.71382636, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.8050771}
confusion matrix:
     0    1
0  619   37
1  178  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.8648648, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8243516, 'auroc': 0.9166881, 'binary_precision': 0.9797297, 'binary_recall': 0.6712963, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7967033}
confusion matrix:
     0    1
0  213    3
1   71  145
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:14:23.226044,epoch time: 0:02:44.761512,used: 0:05:28.940829,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94600785, 'precision': 0.9509221, 'recall': 0.94642854, 'specificity': 0.94642854, 'f1': 0.9458927, 'auroc': 0.9909489, 'binary_precision': 1.0, 'binary_recall': 0.89285713, 'binary_specificity': 1.0, 'binary_f1_score': 0.9433963}
confusion matrix:
      0     1
0  1516     0
1   165  1375
---- Validation: 
scalar performance:
{'acc': 0.68935835, 'precision': 0.75539804, 'recall': 0.68236804, 'specificity': 0.68236804, 'f1': 0.6627459, 'auroc': 0.8167374, 'binary_precision': 0.8787879, 'binary_recall': 0.41961414, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.56800866}
confusion matrix:
     0    1
0  620   36
1  361  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921296, 'precision': 0.71690416, 'recall': 0.6921296, 'specificity': 0.6921296, 'f1': 0.68308, 'auroc': 0.8249314, 'binary_precision': 0.7902098, 'binary_recall': 0.5231481, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.62952644}
confusion matrix:
     0    1
0  186   30
1  103  113
early stop counter: 1
val acc:0.6893583536148071, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 3,now: 2024-07-26 01:17:06.569020,epoch time: 0:02:43.342976,used: 0:08:12.283805,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.97614217, 'recall': 0.9759072, 'specificity': 0.9759072, 'f1': 0.9757838, 'auroc': 0.9959599, 'binary_precision': 0.9912869, 'binary_recall': 0.9603896, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9755936}
confusion matrix:
      0     1
0  1503    13
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.7390759, 'recall': 0.6730967, 'specificity': 0.6730967, 'f1': 0.6535357, 'auroc': 0.8690887, 'binary_precision': 0.85148513, 'binary_recall': 0.414791, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.55783784}
confusion matrix:
     0    1
0  611   45
1  364  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8148119, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7959864, 'auroc': 0.8975909, 'binary_precision': 0.88622755, 'binary_recall': 0.6851852, 'binary_specificity': 0.912037, 'binary_f1_score': 0.7728459}
confusion matrix:
     0    1
0  197   19
1   68  148
early stop counter: 2
val acc:0.6799687147140503, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8287037014961243 / 0.8287037014961243
after epoch: 4,now: 2024-07-26 01:19:50.251805,epoch time: 0:02:43.682785,used: 0:10:55.966590,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.978101, 'recall': 0.97805655, 'specificity': 0.97805655, 'f1': 0.9780737, 'auroc': 0.997035, 'binary_precision': 0.97608274, 'binary_recall': 0.9805195, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9782961}
confusion matrix:
      0     1
0  1479    37
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8375633, 'recall': 0.8372432, 'specificity': 0.8372432, 'f1': 0.8364551, 'auroc': 0.9047698, 'binary_precision': 0.8105263, 'binary_recall': 0.8665595, 'binary_specificity': 0.80792683, 'binary_f1_score': 0.8376068}
confusion matrix:
     0    1
0  530  126
1   83  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8011583, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.80088747, 'auroc': 0.8604038, 'binary_precision': 0.8095238, 'binary_recall': 0.787037, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.79812205}
confusion matrix:
     0    1
0  176   40
1   46  170
better model found
persisted
after epoch: 5,now: 2024-07-26 01:22:33.456430,epoch time: 0:02:43.204625,used: 0:13:39.171215,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9813738, 'recall': 0.9813291, 'specificity': 0.9813291, 'f1': 0.98134625, 'auroc': 0.9983822, 'binary_precision': 0.9793148, 'binary_recall': 0.98376626, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9815355}
confusion matrix:
      0     1
0  1484    32
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.8239437, 'precision': 0.8436818, 'recall': 0.82071507, 'specificity': 0.82071507, 'f1': 0.82025826, 'auroc': 0.90521824, 'binary_precision': 0.91966176, 'binary_recall': 0.6993569, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.79452056}
confusion matrix:
     0    1
0  618   38
1  187  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.84155595, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8084258, 'auroc': 0.89643884, 'binary_precision': 0.9411765, 'binary_recall': 0.6666667, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.78048784}
confusion matrix:
     0    1
0  207    9
1   72  144
early stop counter: 1
val acc:0.8239436745643616, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8009259104728699 / 0.8287037014961243
after epoch: 6,now: 2024-07-26 01:25:16.051075,epoch time: 0:02:42.594645,used: 0:16:21.765860,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98267317, 'recall': 0.9826431, 'specificity': 0.9826431, 'f1': 0.9826555, 'auroc': 0.9984088, 'binary_precision': 0.9812298, 'binary_recall': 0.9844156, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.98282015}
confusion matrix:
      0     1
0  1487    29
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.74647886, 'precision': 0.7467009, 'recall': 0.7457577, 'specificity': 0.7457577, 'f1': 0.74591887, 'auroc': 0.80004513, 'binary_precision': 0.75, 'binary_recall': 0.7186495, 'binary_specificity': 0.77286583, 'binary_f1_score': 0.7339902}
confusion matrix:
     0    1
0  507  149
1  175  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8009259, 'precision': 0.8279454, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.7967392, 'auroc': 0.8550669, 'binary_precision': 0.9220779, 'binary_recall': 0.6574074, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7675676}
confusion matrix:
     0    1
0  204   12
1   74  142
early stop counter: 2
val acc:0.7464788556098938, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8009259104728699 / 0.8287037014961243
after epoch: 7,now: 2024-07-26 01:27:58.196787,epoch time: 0:02:42.145712,used: 0:19:03.911572,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.96727747, 'precision': 0.9690594, 'recall': 0.96753246, 'specificity': 0.96753246, 'f1': 0.96725726, 'auroc': 0.99419737, 'binary_precision': 1.0, 'binary_recall': 0.9350649, 'binary_specificity': 1.0, 'binary_f1_score': 0.96644294}
confusion matrix:
      0     1
0  1516     0
1   100  1440
---- Validation: 
scalar performance:
{'acc': 0.53051645, 'precision': 0.6730187, 'recall': 0.51793486, 'specificity': 0.51793486, 'f1': 0.38478816, 'auroc': 0.802858, 'binary_precision': 0.8235294, 'binary_recall': 0.045016076, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.085365854}
confusion matrix:
     0   1
0  650   6
1  594  28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.7097087, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.41703552, 'auroc': 0.8697916, 'binary_precision': 0.9, 'binary_recall': 0.083333336, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.15254238}
confusion matrix:
     0   1
0  214   2
1  198  18
early stop counter: 3
val acc:0.5305164456367493, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8009259104728699 / 0.8287037014961243
after epoch: 8,now: 2024-07-26 01:30:40.530783,epoch time: 0:02:42.333996,used: 0:21:46.245568,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898483, 'recall': 0.9898683, 'specificity': 0.9898683, 'f1': 0.98985565, 'auroc': 0.99864566, 'binary_precision': 0.99153095, 'binary_recall': 0.9883117, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9899187}
confusion matrix:
      0     1
0  1503    13
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.7370112, 'recall': 0.6361731, 'specificity': 0.6361731, 'f1': 0.5984492, 'auroc': 0.86093247, 'binary_precision': 0.8783784, 'binary_recall': 0.31350482, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.46208528}
confusion matrix:
     0    1
0  629   27
1  427  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7453704, 'precision': 0.79974866, 'recall': 0.7453704, 'specificity': 0.7453704, 'f1': 0.7332735, 'auroc': 0.8688539, 'binary_precision': 0.92741936, 'binary_recall': 0.5324074, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.67647064}
confusion matrix:
     0    1
0  207    9
1  101  115
early stop counter: 4
val acc:0.6447574496269226, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8009259104728699 / 0.8287037014961243
after epoch: 9,now: 2024-07-26 01:33:22.696679,epoch time: 0:02:42.165896,used: 0:24:28.411464,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.93390054, 'precision': 0.94094086, 'recall': 0.93341327, 'specificity': 0.93341327, 'f1': 0.9335809, 'auroc': 0.99482363, 'binary_precision': 0.8871528, 'binary_recall': 0.99545455, 'binary_specificity': 0.87137204, 'binary_f1_score': 0.9381885}
confusion matrix:
      0     1
0  1321   195
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.6001565, 'precision': 0.61267143, 'recall': 0.5949362, 'specificity': 0.5949362, 'f1': 0.58133096, 'auroc': 0.6835567, 'binary_precision': 0.64415586, 'binary_recall': 0.39871383, 'binary_specificity': 0.79115856, 'binary_f1_score': 0.49255213}
confusion matrix:
     0    1
0  519  137
1  374  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.83359975, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.830691, 'auroc': 0.86274004, 'binary_precision': 0.8629442, 'binary_recall': 0.787037, 'binary_specificity': 0.875, 'binary_f1_score': 0.8232445}
confusion matrix:
     0    1
0  189   27
1   46  170
new oracle model saved
early stop counter: 5
val acc:0.6001564860343933, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8009259104728699 / 0.8310185074806213
after epoch: 10,now: 2024-07-26 01:36:05.780714,epoch time: 0:02:43.084035,used: 0:27:11.495499,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_08_54_seed_2_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:27:11.495499 at 2024-07-26 01:36:05.780714
persisted model performance metric: 

scalar performance:
{'acc': 0.8009259, 'precision': 0.8011583, 'recall': 0.8009259, 'specificity': 0.8009259, 'f1': 0.80088747, 'auroc': 0.8604038, 'binary_precision': 0.8095238, 'binary_recall': 0.787037, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.79812205}
confusion matrix:
     0    1
0  176   40
1   46  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8310185, 'precision': 0.83359975, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.830691, 'auroc': 0.86274004, 'binary_precision': 0.8629442, 'binary_recall': 0.787037, 'binary_specificity': 0.875, 'binary_f1_score': 0.8232445}
confusion matrix:
     0    1
0  189   27
1   46  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1989 MiB |   8588 MiB | 192571 GiB | 192569 GiB |
|       from large pool |   1897 MiB |   8512 MiB | 190891 GiB | 190889 GiB |
|       from small pool |     91 MiB |    132 MiB |   1679 GiB |   1679 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1989 MiB |   8588 MiB | 192571 GiB | 192569 GiB |
|       from large pool |   1897 MiB |   8512 MiB | 190891 GiB | 190889 GiB |
|       from small pool |     91 MiB |    132 MiB |   1679 GiB |   1679 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 192161 GiB | 192159 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 190483 GiB | 190482 GiB |
|       from small pool |     91 MiB |    132 MiB |   1677 GiB |   1677 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9542 MiB |   9644 MiB |  22488 MiB |  12946 MiB |
|       from large pool |   9406 MiB |   9508 MiB |  22280 MiB |  12874 MiB |
|       from small pool |    136 MiB |    140 MiB |    208 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1326 MiB |   1590 MiB | 137275 GiB | 137273 GiB |
|       from large pool |   1318 MiB |   1584 MiB | 135546 GiB | 135545 GiB |
|       from small pool |      8 MiB |     56 MiB |   1728 GiB |   1728 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   27092 K  |   27090 K  |
|       from large pool |     382    |     808    |   13782 K  |   13782 K  |
|       from small pool |    2062    |    2766    |   13309 K  |   13307 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   27092 K  |   27090 K  |
|       from large pool |     382    |     808    |   13782 K  |   13782 K  |
|       from small pool |    2062    |    2766    |   13309 K  |   13307 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     281    |     328    |     647    |     366    |
|       from large pool |     213    |     260    |     543    |     330    |
|       from small pool |      68    |      70    |     104    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |     315    |   14985 K  |   14985 K  |
|       from large pool |      77    |     251    |    8208 K  |    8208 K  |
|       from small pool |      67    |     229    |    6776 K  |    6776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8588 MiB | 192571 GiB | 192571 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 190891 GiB | 190891 GiB |
|       from small pool |      0 KiB |    132 MiB |   1679 GiB |   1679 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8588 MiB | 192571 GiB | 192571 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 190891 GiB | 190891 GiB |
|       from small pool |      0 KiB |    132 MiB |   1679 GiB |   1679 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 192161 GiB | 192161 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 190483 GiB | 190483 GiB |
|       from small pool |      0 KiB |    132 MiB |   1677 GiB |   1677 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3316 MiB |   9644 MiB |  22488 MiB |  19172 MiB |
|       from large pool |   3216 MiB |   9508 MiB |  22280 MiB |  19064 MiB |
|       from small pool |    100 MiB |    140 MiB |    208 MiB |    108 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1590 MiB | 137275 GiB | 137275 GiB |
|       from large pool |  24320 KiB |   1584 MiB | 135547 GiB | 135547 GiB |
|       from small pool |      0 KiB |     56 MiB |   1728 GiB |   1728 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   27092 K  |   27092 K  |
|       from large pool |       2    |     808    |   13782 K  |   13782 K  |
|       from small pool |       0    |    2766    |   13309 K  |   13309 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   27092 K  |   27092 K  |
|       from large pool |       2    |     808    |   13782 K  |   13782 K  |
|       from small pool |       0    |    2766    |   13309 K  |   13309 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     328    |     647    |     522    |
|       from large pool |      75    |     260    |     543    |     468    |
|       from small pool |      50    |      70    |     104    |      54    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   14985 K  |   14985 K  |
|       from large pool |       4    |     251    |    8208 K  |    8208 K  |
|       from small pool |       0    |     229    |    6776 K  |    6776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8588 MiB | 192571 GiB | 192571 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 190891 GiB | 190891 GiB |
|       from small pool |      0 KiB |    132 MiB |   1679 GiB |   1679 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8588 MiB | 192571 GiB | 192571 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 190891 GiB | 190891 GiB |
|       from small pool |      0 KiB |    132 MiB |   1679 GiB |   1679 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 192161 GiB | 192161 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 190483 GiB | 190483 GiB |
|       from small pool |      0 KiB |    132 MiB |   1677 GiB |   1677 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3316 MiB |   9644 MiB |  22488 MiB |  19172 MiB |
|       from large pool |   3216 MiB |   9508 MiB |  22280 MiB |  19064 MiB |
|       from small pool |    100 MiB |    140 MiB |    208 MiB |    108 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1590 MiB | 137275 GiB | 137275 GiB |
|       from large pool |  24320 KiB |   1584 MiB | 135547 GiB | 135547 GiB |
|       from small pool |      0 KiB |     56 MiB |   1728 GiB |   1728 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   27092 K  |   27092 K  |
|       from large pool |       2    |     808    |   13782 K  |   13782 K  |
|       from small pool |       0    |    2766    |   13309 K  |   13309 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   27092 K  |   27092 K  |
|       from large pool |       2    |     808    |   13782 K  |   13782 K  |
|       from small pool |       0    |    2766    |   13309 K  |   13309 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     328    |     647    |     522    |
|       from large pool |      75    |     260    |     543    |     468    |
|       from small pool |      50    |      70    |     104    |      54    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   14985 K  |   14985 K  |
|       from large pool |       4    |     251    |    8208 K  |    8208 K  |
|       from small pool |       0    |     229    |    6776 K  |    6776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707

 Experiment start at: 2024-07-26 01:36:37.935410
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9433594, 'precision': 0.94741637, 'recall': 0.94404316, 'specificity': 0.94404316, 'f1': 0.94328123, 'auroc': 0.99308515, 'binary_precision': 0.993576, 'binary_recall': 0.894027, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9411764}
confusion matrix:
      0     1
0  1506     9
1   165  1392
---- Validation: 
scalar performance:
{'acc': 0.79423225, 'precision': 0.79811776, 'recall': 0.7953088, 'specificity': 0.7953088, 'f1': 0.79390657, 'auroc': 0.8723035, 'binary_precision': 0.75886524, 'binary_recall': 0.85055643, 'binary_specificity': 0.74006116, 'binary_f1_score': 0.8020989}
confusion matrix:
     0    1
0  484  170
1   94  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.7990093, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.79234785, 'auroc': 0.89817286, 'binary_precision': 0.7578125, 'binary_recall': 0.8622222, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.8066528}
confusion matrix:
     0    1
0  163   62
1   31  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:39:23.469789,epoch time: 0:02:45.534379,used: 0:02:45.534379,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9527995, 'precision': 0.95606625, 'recall': 0.9533521, 'specificity': 0.9533521, 'f1': 0.9527484, 'auroc': 0.99603474, 'binary_precision': 0.99788135, 'binary_recall': 0.9086817, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9511949}
confusion matrix:
      0     1
0  1514     3
1   142  1413
---- Validation: 
scalar performance:
{'acc': 0.82774746, 'precision': 0.830572, 'recall': 0.826816, 'specificity': 0.826816, 'f1': 0.8270409, 'auroc': 0.88733387, 'binary_precision': 0.8566434, 'binary_recall': 0.7790143, 'binary_specificity': 0.87461776, 'binary_f1_score': 0.81598663}
confusion matrix:
     0    1
0  572   82
1  139  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8399383, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.804423, 'auroc': 0.88713086, 'binary_precision': 0.9426752, 'binary_recall': 0.6577778, 'binary_specificity': 0.96, 'binary_f1_score': 0.7748692}
confusion matrix:
     0    1
0  216    9
1   77  148
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:42:09.521299,epoch time: 0:02:46.051510,used: 0:05:31.585889,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9778921, 'recall': 0.97783375, 'specificity': 0.97783375, 'f1': 0.97785914, 'auroc': 0.9973475, 'binary_precision': 0.9763276, 'binary_recall': 0.9800899, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.9782051}
confusion matrix:
      0     1
0  1478    37
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8316446, 'precision': 0.8354759, 'recall': 0.83057785, 'specificity': 0.83057785, 'f1': 0.8307934, 'auroc': 0.8802824, 'binary_precision': 0.8667851, 'binary_recall': 0.7758347, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.8187919}
confusion matrix:
     0    1
0  579   75
1  141  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.85225666, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84852684, 'auroc': 0.93327403, 'binary_precision': 0.8866995, 'binary_recall': 0.8, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.8411215}
confusion matrix:
     0    1
0  202   23
1   45  180
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 01:44:55.443908,epoch time: 0:02:45.922609,used: 0:08:17.508498,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9771918, 'recall': 0.97724354, 'specificity': 0.97724354, 'f1': 0.97721106, 'auroc': 0.99780834, 'binary_precision': 0.97997415, 'binary_recall': 0.9749357, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.97744846}
confusion matrix:
      0     1
0  1485    31
1    39  1517
---- Validation: 
scalar performance:
{'acc': 0.80358535, 'precision': 0.8038577, 'recall': 0.8038754, 'specificity': 0.8038754, 'f1': 0.80358523, 'auroc': 0.8630805, 'binary_precision': 0.7886677, 'binary_recall': 0.8187599, 'binary_specificity': 0.78899086, 'binary_f1_score': 0.8034321}
confusion matrix:
     0    1
0  516  138
1  114  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8472222, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.8466053, 'auroc': 0.91885436, 'binary_precision': 0.8611111, 'binary_recall': 0.82666665, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.8435374}
confusion matrix:
     0    1
0  195   30
1   39  186
early stop counter: 1
val acc:0.8035853505134583, best validation acc: 0.831644594669342, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 4,now: 2024-07-26 01:47:40.172060,epoch time: 0:02:44.728152,used: 0:11:02.236650,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98340964, 'recall': 0.983382, 'specificity': 0.983382, 'f1': 0.98339486, 'auroc': 0.9983123, 'binary_precision': 0.9826923, 'binary_recall': 0.98458576, 'binary_specificity': 0.9821782, 'binary_f1_score': 0.98363817}
confusion matrix:
      0     1
0  1488    27
1    24  1533
---- Validation: 
scalar performance:
{'acc': 0.79423225, 'precision': 0.80206937, 'recall': 0.79576457, 'specificity': 0.79576457, 'f1': 0.7934088, 'auroc': 0.88569057, 'binary_precision': 0.7482993, 'binary_recall': 0.87440383, 'binary_specificity': 0.71712536, 'binary_f1_score': 0.8064516}
confusion matrix:
     0    1
0  469  185
1   79  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.7732167, 'recall': 0.7511111, 'specificity': 0.7511111, 'f1': 0.7459729, 'auroc': 0.873521, 'binary_precision': 0.69550174, 'binary_recall': 0.8933333, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.7821012}
confusion matrix:
     0    1
0  137   88
1   24  201
early stop counter: 2
val acc:0.7942322492599487, best validation acc: 0.831644594669342, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 5,now: 2024-07-26 01:50:24.854768,epoch time: 0:02:44.682708,used: 0:13:46.919358,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98677766, 'recall': 0.9868158, 'specificity': 0.9868158, 'f1': 0.9866536, 'auroc': 0.9988426, 'binary_precision': 0.9986842, 'binary_recall': 0.9749518, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9866753}
confusion matrix:
      0     1
0  1513     2
1    39  1518
---- Validation: 
scalar performance:
{'acc': 0.74356973, 'precision': 0.8013704, 'recall': 0.73923343, 'specificity': 0.73923343, 'f1': 0.72831666, 'auroc': 0.8914161, 'binary_precision': 0.9285714, 'binary_recall': 0.5166932, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.6639428}
confusion matrix:
     0    1
0  629   25
1  304  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.86254084, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.80937946, 'auroc': 0.9344988, 'binary_precision': 0.9930556, 'binary_recall': 0.63555557, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7750678}
confusion matrix:
     0    1
0  224    1
1   82  143
early stop counter: 3
val acc:0.7435697317123413, best validation acc: 0.831644594669342, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 6,now: 2024-07-26 01:53:09.121879,epoch time: 0:02:44.267111,used: 0:16:31.186469,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866774, 'recall': 0.9866289, 'specificity': 0.9866289, 'f1': 0.9866505, 'auroc': 0.998916, 'binary_precision': 0.98527527, 'binary_recall': 0.9884393, 'binary_specificity': 0.98481846, 'binary_f1_score': 0.9868548}
confusion matrix:
      0     1
0  1492    23
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.78643805, 'precision': 0.7934673, 'recall': 0.784868, 'specificity': 0.784868, 'f1': 0.78445697, 'auroc': 0.8363586, 'binary_precision': 0.83427495, 'binary_recall': 0.70429254, 'binary_specificity': 0.8654434, 'binary_f1_score': 0.7637931}
confusion matrix:
     0    1
0  566   88
1  186  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8677672, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85434645, 'auroc': 0.91512096, 'binary_precision': 0.9347826, 'binary_recall': 0.7644445, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.84107584}
confusion matrix:
     0    1
0  213   12
1   53  172
new oracle model saved
early stop counter: 4
val acc:0.7864380478858948, best validation acc: 0.831644594669342, corresponding to test acc:                         0.8488888740539551 / 0.855555534362793
after epoch: 7,now: 2024-07-26 01:55:54.063725,epoch time: 0:02:44.941846,used: 0:19:16.128315,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856564, 'recall': 0.9857255, 'specificity': 0.9857255, 'f1': 0.98567593, 'auroc': 0.99893427, 'binary_precision': 0.9896373, 'binary_recall': 0.9820051, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.98580647}
confusion matrix:
      0     1
0  1500    16
1    28  1528
---- Validation: 
scalar performance:
{'acc': 0.83320343, 'precision': 0.8477508, 'recall': 0.83119535, 'specificity': 0.83119535, 'f1': 0.8307972, 'auroc': 0.9005338, 'binary_precision': 0.91417164, 'binary_recall': 0.7281399, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.8106194}
confusion matrix:
     0    1
0  611   43
1  171  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.8306878, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.75479895, 'auroc': 0.9159703, 'binary_precision': 0.97619045, 'binary_recall': 0.5466667, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7008547}
confusion matrix:
     0    1
0  222    3
1  102  123
better model found
persisted
after epoch: 8,now: 2024-07-26 01:58:39.040914,epoch time: 0:02:44.977189,used: 0:22:01.105504,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97902703, 'recall': 0.9788003, 'specificity': 0.9788003, 'f1': 0.9785149, 'auroc': 0.99666727, 'binary_precision': 0.9986631, 'binary_recall': 0.9589217, 'binary_specificity': 0.998679, 'binary_f1_score': 0.97838897}
confusion matrix:
      0     1
0  1512     2
1    64  1494
---- Validation: 
scalar performance:
{'acc': 0.7466875, 'precision': 0.8085234, 'recall': 0.7422612, 'specificity': 0.7422612, 'f1': 0.73098195, 'auroc': 0.8728827, 'binary_precision': 0.94186044, 'binary_recall': 0.51510334, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.66598153}
confusion matrix:
     0    1
0  634   20
1  305  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.85771894, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.7995135, 'auroc': 0.9048296, 'binary_precision': 0.99285716, 'binary_recall': 0.61777776, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7616438}
confusion matrix:
     0    1
0  224    1
1   86  139
early stop counter: 1
val acc:0.7466874718666077, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.7666666507720947 / 0.855555534362793
after epoch: 9,now: 2024-07-26 02:01:23.473067,epoch time: 0:02:44.432153,used: 0:24:45.537657,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9802666, 'recall': 0.98030424, 'specificity': 0.98030424, 'f1': 0.9801432, 'auroc': 0.99891984, 'binary_precision': 0.99210525, 'binary_recall': 0.9685292, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9801755}
confusion matrix:
      0     1
0  1503    12
1    49  1508
---- Validation: 
scalar performance:
{'acc': 0.6882307, 'precision': 0.7769195, 'recall': 0.6826123, 'specificity': 0.6826123, 'f1': 0.6570252, 'auroc': 0.8631754, 'binary_precision': 0.92883897, 'binary_recall': 0.39427662, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.5535714}
confusion matrix:
     0    1
0  635   19
1  381  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8567523, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.81781375, 'auroc': 0.9263407, 'binary_precision': 0.9677419, 'binary_recall': 0.6666667, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.78947365}
confusion matrix:
     0    1
0  220    5
1   75  150
early stop counter: 2
val acc:0.6882306933403015, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.7666666507720947 / 0.855555534362793
after epoch: 10,now: 2024-07-26 02:04:08.129216,epoch time: 0:02:44.656149,used: 0:27:30.193806,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99151945, 'recall': 0.9916061, 'specificity': 0.9916061, 'f1': 0.9915359, 'auroc': 0.9996519, 'binary_precision': 0.99675536, 'binary_recall': 0.98651254, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9916075}
confusion matrix:
      0     1
0  1510     5
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.77942324, 'precision': 0.81962657, 'recall': 0.775921, 'specificity': 0.775921, 'f1': 0.7707176, 'auroc': 0.89796185, 'binary_precision': 0.9282178, 'binary_recall': 0.59618443, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.72604066}
confusion matrix:
     0    1
0  625   29
1  254  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8553878, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8154047, 'auroc': 0.92920494, 'binary_precision': 0.96753246, 'binary_recall': 0.6622222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7862797}
confusion matrix:
     0    1
0  220    5
1   76  149
early stop counter: 3
val acc:0.7794232368469238, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.7666666507720947 / 0.855555534362793
after epoch: 11,now: 2024-07-26 02:06:52.070763,epoch time: 0:02:43.941547,used: 0:30:14.135353,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99348533, 'recall': 0.99357736, 'specificity': 0.99357736, 'f1': 0.99348927, 'auroc': 0.9995353, 'binary_precision': 1.0, 'binary_recall': 0.9871548, 'binary_specificity': 1.0, 'binary_f1_score': 0.9935359}
confusion matrix:
      0     1
0  1515     0
1    20  1537
---- Validation: 
scalar performance:
{'acc': 0.77708495, 'precision': 0.81414205, 'recall': 0.77368814, 'specificity': 0.77368814, 'f1': 0.76879096, 'auroc': 0.86971456, 'binary_precision': 0.91727495, 'binary_recall': 0.59936404, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.72499996}
confusion matrix:
     0    1
0  620   34
1  252  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8564593, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8280543, 'auroc': 0.9073185, 'binary_precision': 0.95151514, 'binary_recall': 0.69777775, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.80512816}
confusion matrix:
     0    1
0  217    8
1   68  157
early stop counter: 4
val acc:0.7770849466323853, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.7666666507720947 / 0.855555534362793
after epoch: 12,now: 2024-07-26 02:09:36.371464,epoch time: 0:02:44.300701,used: 0:32:58.436054,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9924936, 'recall': 0.9925481, 'specificity': 0.9925481, 'f1': 0.9925124, 'auroc': 0.9994862, 'binary_precision': 0.9954722, 'binary_recall': 0.9897106, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9925831}
confusion matrix:
      0     1
0  1510     7
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.80436474, 'precision': 0.83359873, 'recall': 0.8014493, 'specificity': 0.8014493, 'f1': 0.7988733, 'auroc': 0.8892416, 'binary_precision': 0.9276018, 'binary_recall': 0.6518283, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.76563954}
confusion matrix:
     0    1
0  622   32
1  219  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8453863, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81663054, 'auroc': 0.9221926, 'binary_precision': 0.9390244, 'binary_recall': 0.6844444, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.79177374}
confusion matrix:
     0    1
0  215   10
1   71  154
early stop counter: 5
val acc:0.8043647408485413, best validation acc: 0.8332034349441528, corresponding to test acc:                         0.7666666507720947 / 0.855555534362793
after epoch: 13,now: 2024-07-26 02:12:20.805526,epoch time: 0:02:44.434062,used: 0:35:42.870116,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_36_37_seed_3_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:35:42.870116 at 2024-07-26 02:12:20.805526
persisted model performance metric: 

scalar performance:
{'acc': 0.76666665, 'precision': 0.8306878, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.75479895, 'auroc': 0.9159703, 'binary_precision': 0.97619045, 'binary_recall': 0.5466667, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7008547}
confusion matrix:
     0    1
0  222    3
1  102  123
oracle model performance metric: 

scalar performance:
{'acc': 0.85555553, 'precision': 0.8677672, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.85434645, 'auroc': 0.91512096, 'binary_precision': 0.9347826, 'binary_recall': 0.7644445, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.84107584}
confusion matrix:
     0    1
0  213   12
1   53  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1987 MiB |   8588 MiB | 278920 GiB | 278918 GiB |
|       from large pool |   1895 MiB |   8512 MiB | 276484 GiB | 276482 GiB |
|       from small pool |     91 MiB |    132 MiB |   2435 GiB |   2435 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1987 MiB |   8588 MiB | 278920 GiB | 278918 GiB |
|       from large pool |   1895 MiB |   8512 MiB | 276484 GiB | 276482 GiB |
|       from small pool |     91 MiB |    132 MiB |   2435 GiB |   2435 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 278438 GiB | 278436 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 276005 GiB | 276004 GiB |
|       from small pool |     91 MiB |    132 MiB |   2432 GiB |   2432 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9542 MiB |   9644 MiB |  28714 MiB |  19172 MiB |
|       from large pool |   9402 MiB |   9508 MiB |  28466 MiB |  19064 MiB |
|       from small pool |    140 MiB |    140 MiB |    248 MiB |    108 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1122 MiB |   1743 MiB | 203392 GiB | 203391 GiB |
|       from large pool |   1112 MiB |   1729 MiB | 200887 GiB | 200885 GiB |
|       from small pool |     10 MiB |     56 MiB |   2505 GiB |   2505 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   39261 K  |   39259 K  |
|       from large pool |     382    |     808    |   19972 K  |   19971 K  |
|       from small pool |    2074    |    2766    |   19289 K  |   19287 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   39261 K  |   39259 K  |
|       from large pool |     382    |     808    |   19972 K  |   19971 K  |
|       from small pool |    2074    |    2766    |   19289 K  |   19287 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     278    |     328    |     800    |     522    |
|       from large pool |     208    |     260    |     676    |     468    |
|       from small pool |      70    |      70    |     124    |      54    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |     315    |   21367 K  |   21367 K  |
|       from large pool |      75    |     251    |   11525 K  |   11525 K  |
|       from small pool |      64    |     229    |    9841 K  |    9841 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8588 MiB | 278920 GiB | 278919 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 276484 GiB | 276484 GiB |
|       from small pool |      0 KiB |    132 MiB |   2435 GiB |   2435 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8588 MiB | 278920 GiB | 278919 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 276484 GiB | 276484 GiB |
|       from small pool |      0 KiB |    132 MiB |   2435 GiB |   2435 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 278438 GiB | 278438 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 276005 GiB | 276005 GiB |
|       from small pool |      0 KiB |    132 MiB |   2432 GiB |   2432 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3110 MiB |   9644 MiB |  28714 MiB |  25604 MiB |
|       from large pool |   3008 MiB |   9508 MiB |  28466 MiB |  25458 MiB |
|       from small pool |    102 MiB |    140 MiB |    248 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 203393 GiB | 203393 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 200887 GiB | 200887 GiB |
|       from small pool |      0 KiB |     56 MiB |   2505 GiB |   2505 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   39261 K  |   39261 K  |
|       from large pool |       2    |     808    |   19972 K  |   19972 K  |
|       from small pool |       0    |    2766    |   19289 K  |   19289 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   39261 K  |   39261 K  |
|       from large pool |       2    |     808    |   19972 K  |   19972 K  |
|       from small pool |       0    |    2766    |   19289 K  |   19289 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     328    |     800    |     675    |
|       from large pool |      74    |     260    |     676    |     602    |
|       from small pool |      51    |      70    |     124    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   21367 K  |   21367 K  |
|       from large pool |       4    |     251    |   11525 K  |   11525 K  |
|       from small pool |       0    |     229    |    9842 K  |    9842 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8588 MiB | 278920 GiB | 278919 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 276484 GiB | 276484 GiB |
|       from small pool |      0 KiB |    132 MiB |   2435 GiB |   2435 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8588 MiB | 278920 GiB | 278919 GiB |
|       from large pool |  16640 KiB |   8512 MiB | 276484 GiB | 276484 GiB |
|       from small pool |      0 KiB |    132 MiB |   2435 GiB |   2435 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 278438 GiB | 278438 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 276005 GiB | 276005 GiB |
|       from small pool |      0 KiB |    132 MiB |   2432 GiB |   2432 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3110 MiB |   9644 MiB |  28714 MiB |  25604 MiB |
|       from large pool |   3008 MiB |   9508 MiB |  28466 MiB |  25458 MiB |
|       from small pool |    102 MiB |    140 MiB |    248 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 203393 GiB | 203393 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 200887 GiB | 200887 GiB |
|       from small pool |      0 KiB |     56 MiB |   2505 GiB |   2505 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   39261 K  |   39261 K  |
|       from large pool |       2    |     808    |   19972 K  |   19972 K  |
|       from small pool |       0    |    2766    |   19289 K  |   19289 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   39261 K  |   39261 K  |
|       from large pool |       2    |     808    |   19972 K  |   19972 K  |
|       from small pool |       0    |    2766    |   19289 K  |   19289 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     328    |     800    |     675    |
|       from large pool |      74    |     260    |     676    |     602    |
|       from small pool |      51    |      70    |     124    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   21367 K  |   21367 K  |
|       from large pool |       4    |     251    |   11525 K  |   11525 K  |
|       from small pool |       0    |     229    |    9842 K  |    9842 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707

 Experiment start at: 2024-07-26 02:12:54.395328
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91256475, 'precision': 0.92441213, 'recall': 0.9141221, 'specificity': 0.9141221, 'f1': 0.9121429, 'auroc': 0.98691094, 'binary_precision': 1.0, 'binary_recall': 0.82824427, 'binary_specificity': 1.0, 'binary_f1_score': 0.9060543}
confusion matrix:
      0     1
0  1516     0
1   270  1302
---- Validation: 
scalar performance:
{'acc': 0.52849334, 'precision': 0.58722365, 'recall': 0.5227943, 'specificity': 0.5227943, 'f1': 0.41758704, 'auroc': 0.7449746, 'binary_precision': 0.65555555, 'binary_recall': 0.093354434, 'binary_specificity': 0.9522342, 'binary_f1_score': 0.16343491}
confusion matrix:
     0   1
0  618  31
1  573  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49289098, 'precision': 0.4299934, 'recall': 0.492891, 'specificity': 0.492891, 'f1': 0.3459923, 'auroc': 0.7904135, 'binary_precision': 0.36363637, 'binary_recall': 0.018957347, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.036036037}
confusion matrix:
     0  1
0  204  7
1  207  4
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:15:40.317192,epoch time: 0:02:45.921864,used: 0:02:45.921864,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96761656, 'precision': 0.96778584, 'recall': 0.96787614, 'specificity': 0.96787614, 'f1': 0.9676162, 'auroc': 0.99366844, 'binary_precision': 0.98230666, 'binary_recall': 0.9535623, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.9677211}
confusion matrix:
      0     1
0  1489    27
1    73  1499
---- Validation: 
scalar performance:
{'acc': 0.65886027, 'precision': 0.65879273, 'recall': 0.65872765, 'specificity': 0.65872765, 'f1': 0.65874046, 'auroc': 0.73645437, 'binary_precision': 0.656, 'binary_recall': 0.64873415, 'binary_specificity': 0.6687211, 'binary_f1_score': 0.65234685}
confusion matrix:
     0    1
0  434  215
1  222  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75592417, 'precision': 0.7608516, 'recall': 0.75592417, 'specificity': 0.75592417, 'f1': 0.75476605, 'auroc': 0.8462299, 'binary_precision': 0.7967033, 'binary_recall': 0.68720376, 'binary_specificity': 0.82464457, 'binary_f1_score': 0.7379135}
confusion matrix:
     0    1
0  174   37
1   66  145
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:18:26.729912,epoch time: 0:02:46.412720,used: 0:05:32.334584,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9637306, 'precision': 0.96466136, 'recall': 0.9642924, 'specificity': 0.9642924, 'f1': 0.9637287, 'auroc': 0.993333, 'binary_precision': 0.9912752, 'binary_recall': 0.9371827, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.9634703}
confusion matrix:
      0     1
0  1499    13
1    99  1477
---- Validation: 
scalar performance:
{'acc': 0.74395, 'precision': 0.74406123, 'recall': 0.7440707, 'specificity': 0.7440707, 'f1': 0.7439499, 'auroc': 0.83797616, 'binary_precision': 0.7345679, 'binary_recall': 0.7531645, 'binary_specificity': 0.7349769, 'binary_f1_score': 0.74375}
confusion matrix:
     0    1
0  477  172
1  156  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7796208, 'precision': 0.7850046, 'recall': 0.7796209, 'specificity': 0.7796209, 'f1': 0.7785752, 'auroc': 0.88344824, 'binary_precision': 0.82417583, 'binary_recall': 0.7109005, 'binary_specificity': 0.8483412, 'binary_f1_score': 0.7633587}
confusion matrix:
     0    1
0  179   32
1   61  150
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 02:21:13.268407,epoch time: 0:02:46.538495,used: 0:08:18.873079,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9776554, 'precision': 0.97782034, 'recall': 0.9779428, 'specificity': 0.9779428, 'f1': 0.977655, 'auroc': 0.99484265, 'binary_precision': 0.99279636, 'binary_recall': 0.9631512, 'binary_specificity': 0.9927345, 'binary_f1_score': 0.97774905}
confusion matrix:
      0     1
0  1503    11
1    58  1516
---- Validation: 
scalar performance:
{'acc': 0.7907885, 'precision': 0.79247904, 'recall': 0.79025424, 'specificity': 0.79025424, 'f1': 0.7902484, 'auroc': 0.87040436, 'binary_precision': 0.81164384, 'binary_recall': 0.75, 'binary_specificity': 0.8305085, 'binary_f1_score': 0.77960527}
confusion matrix:
     0    1
0  539  110
1  158  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7701422, 'precision': 0.77087843, 'recall': 0.7701422, 'specificity': 0.7701422, 'f1': 0.7699859, 'auroc': 0.8817861, 'binary_precision': 0.7567568, 'binary_recall': 0.79620856, 'binary_specificity': 0.74407583, 'binary_f1_score': 0.7759815}
confusion matrix:
     0    1
0  157   54
1   43  168
better model found
persisted
after epoch: 4,now: 2024-07-26 02:23:59.255971,epoch time: 0:02:45.987564,used: 0:11:04.860643,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9757124, 'precision': 0.9756732, 'recall': 0.97578996, 'specificity': 0.97578996, 'f1': 0.9757086, 'auroc': 0.9966016, 'binary_precision': 0.9807198, 'binary_recall': 0.9713558, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9760153}
confusion matrix:
      0     1
0  1487    30
1    45  1526
---- Validation: 
scalar performance:
{'acc': 0.657299, 'precision': 0.6973467, 'recall': 0.6542234, 'specificity': 0.6542234, 'f1': 0.63627183, 'auroc': 0.79957724, 'binary_precision': 0.78299123, 'binary_recall': 0.42246836, 'binary_specificity': 0.8859784, 'binary_f1_score': 0.5488181}
confusion matrix:
     0    1
0  575   74
1  365  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73459715, 'precision': 0.76361024, 'recall': 0.7345972, 'specificity': 0.7345972, 'f1': 0.727088, 'auroc': 0.8641989, 'binary_precision': 0.85106385, 'binary_recall': 0.5687204, 'binary_specificity': 0.90047395, 'binary_f1_score': 0.6818182}
confusion matrix:
     0    1
0  190   21
1   91  120
early stop counter: 1
val acc:0.6572989821434021, best validation acc: 0.790788471698761, corresponding to test acc:                         0.7701421976089478 / 0.7796208262443542
after epoch: 5,now: 2024-07-26 02:26:44.975096,epoch time: 0:02:45.719125,used: 0:13:50.579768,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9838083, 'precision': 0.9837786, 'recall': 0.98391664, 'specificity': 0.98391664, 'f1': 0.9838064, 'auroc': 0.99820787, 'binary_precision': 0.99032885, 'binary_recall': 0.9777212, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9839847}
confusion matrix:
      0     1
0  1502    15
1    35  1536
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.843966, 'recall': 0.8392464, 'specificity': 0.8392464, 'f1': 0.8392776, 'auroc': 0.90598977, 'binary_precision': 0.8778761, 'binary_recall': 0.7848101, 'binary_specificity': 0.8936826, 'binary_f1_score': 0.8287385}
confusion matrix:
     0    1
0  580   69
1  136  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7606635, 'precision': 0.81405604, 'recall': 0.7606635, 'specificity': 0.7606635, 'f1': 0.7500396, 'auroc': 0.90613425, 'binary_precision': 0.9435484, 'binary_recall': 0.55450237, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.6985075}
confusion matrix:
     0    1
0  204    7
1   94  117
better model found
persisted
after epoch: 6,now: 2024-07-26 02:29:30.920289,epoch time: 0:02:45.945193,used: 0:16:36.524961,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9828368, 'precision': 0.98280627, 'recall': 0.9828701, 'specificity': 0.9828701, 'f1': 0.98283315, 'auroc': 0.9988063, 'binary_precision': 0.9852847, 'binary_recall': 0.9808917, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.98308325}
confusion matrix:
      0     1
0  1495    23
1    30  1540
---- Validation: 
scalar performance:
{'acc': 0.7946916, 'precision': 0.8172147, 'recall': 0.7929044, 'specificity': 0.7929044, 'f1': 0.79027, 'auroc': 0.8860198, 'binary_precision': 0.8984881, 'binary_recall': 0.65822786, 'binary_specificity': 0.9275809, 'binary_f1_score': 0.75981736}
confusion matrix:
     0    1
0  602   47
1  216  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77488154, 'precision': 0.83769315, 'recall': 0.7748815, 'specificity': 0.7748815, 'f1': 0.7639029, 'auroc': 0.89330876, 'binary_precision': 0.98333335, 'binary_recall': 0.5592417, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.71299094}
confusion matrix:
     0    1
0  209    2
1   93  118
early stop counter: 1
val acc:0.7946916222572327, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.7606635093688965 / 0.7796208262443542
after epoch: 7,now: 2024-07-26 02:32:16.210769,epoch time: 0:02:45.290480,used: 0:19:21.815441,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9838083, 'precision': 0.9839452, 'recall': 0.9840703, 'specificity': 0.9840703, 'f1': 0.983808, 'auroc': 0.99826276, 'binary_precision': 0.99803793, 'binary_recall': 0.9701208, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9838814}
confusion matrix:
      0     1
0  1512     3
1    47  1526
---- Validation: 
scalar performance:
{'acc': 0.69476974, 'precision': 0.75697184, 'recall': 0.691452, 'specificity': 0.691452, 'f1': 0.67279094, 'auroc': 0.86173475, 'binary_precision': 0.8801262, 'binary_recall': 0.4414557, 'binary_specificity': 0.9414484, 'binary_f1_score': 0.58798736}
confusion matrix:
     0    1
0  611   38
1  353  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.549763, 'precision': 0.65552825, 'recall': 0.549763, 'specificity': 0.549763, 'f1': 0.4575395, 'auroc': 0.82565534, 'binary_precision': 0.7837838, 'binary_recall': 0.13744076, 'binary_specificity': 0.9620853, 'binary_f1_score': 0.23387097}
confusion matrix:
     0   1
0  203   8
1  182  29
early stop counter: 2
val acc:0.6947697401046753, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.7606635093688965 / 0.7796208262443542
after epoch: 8,now: 2024-07-26 02:35:01.743307,epoch time: 0:02:45.532538,used: 0:22:07.347979,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.9835951, 'recall': 0.9837199, 'specificity': 0.9837199, 'f1': 0.983484, 'auroc': 0.9986081, 'binary_precision': 0.99673414, 'binary_recall': 0.97073793, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98356426}
confusion matrix:
      0     1
0  1511     5
1    46  1526
---- Validation: 
scalar performance:
{'acc': 0.64949256, 'precision': 0.7138787, 'recall': 0.6457732, 'specificity': 0.6457732, 'f1': 0.61758924, 'auroc': 0.78601205, 'binary_precision': 0.827957, 'binary_recall': 0.36550632, 'binary_specificity': 0.92604005, 'binary_f1_score': 0.507135}
confusion matrix:
     0    1
0  601   48
1  401  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7109005, 'precision': 0.7631217, 'recall': 0.7109005, 'specificity': 0.7109005, 'f1': 0.69580734, 'auroc': 0.86637765, 'binary_precision': 0.8803419, 'binary_recall': 0.48815167, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.6280488}
confusion matrix:
     0    1
0  197   14
1  108  103
early stop counter: 3
val acc:0.6494925618171692, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.7606635093688965 / 0.7796208262443542
after epoch: 9,now: 2024-07-26 02:37:47.016243,epoch time: 0:02:45.272936,used: 0:24:52.620915,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873705, 'precision': 0.987407, 'recall': 0.987586, 'specificity': 0.987586, 'f1': 0.98736966, 'auroc': 0.99816126, 'binary_precision': 0.99870044, 'binary_recall': 0.976493, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9874719}
confusion matrix:
      0     1
0  1512     2
1    37  1537
---- Validation: 
scalar performance:
{'acc': 0.6057767, 'precision': 0.72468233, 'recall': 0.6008684, 'specificity': 0.6008684, 'f1': 0.54012746, 'auroc': 0.7428109, 'binary_precision': 0.8848485, 'binary_recall': 0.23101266, 'binary_specificity': 0.97072417, 'binary_f1_score': 0.36637387}
confusion matrix:
     0    1
0  630   19
1  486  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6066351, 'precision': 0.7509117, 'recall': 0.60663503, 'specificity': 0.60663503, 'f1': 0.5405944, 'auroc': 0.8834932, 'binary_precision': 0.9411765, 'binary_recall': 0.22748815, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.36641222}
confusion matrix:
     0   1
0  208   3
1  163  48
early stop counter: 4
val acc:0.6057767271995544, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.7606635093688965 / 0.7796208262443542
after epoch: 10,now: 2024-07-26 02:40:32.486267,epoch time: 0:02:45.470024,used: 0:27:38.090939,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97603625, 'precision': 0.976373, 'recall': 0.9758453, 'specificity': 0.9758453, 'f1': 0.97601676, 'auroc': 0.9974853, 'binary_precision': 0.9675608, 'binary_recall': 0.986014, 'binary_specificity': 0.96567655, 'binary_f1_score': 0.97670025}
confusion matrix:
      0     1
0  1463    52
1    22  1551
---- Validation: 
scalar performance:
{'acc': 0.57220924, 'precision': 0.58628607, 'recall': 0.56927407, 'specificity': 0.56927407, 'f1': 0.5485933, 'auroc': 0.5756836, 'binary_precision': 0.6179775, 'binary_recall': 0.34810126, 'binary_specificity': 0.7904468, 'binary_f1_score': 0.44534412}
confusion matrix:
     0    1
0  513  136
1  412  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69668245, 'precision': 0.7083839, 'recall': 0.69668245, 'specificity': 0.69668245, 'f1': 0.69236374, 'auroc': 0.7989713, 'binary_precision': 0.757764, 'binary_recall': 0.578199, 'binary_specificity': 0.8151659, 'binary_f1_score': 0.65591395}
confusion matrix:
     0    1
0  172   39
1   89  122
early stop counter: 5
val acc:0.5722092390060425, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.7606635093688965 / 0.7796208262443542
after epoch: 11,now: 2024-07-26 02:43:17.986816,epoch time: 0:02:45.500549,used: 0:30:23.591488,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_12_54_seed_4_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:30:23.591488 at 2024-07-26 02:43:17.986816
persisted model performance metric: 

scalar performance:
{'acc': 0.7606635, 'precision': 0.81405604, 'recall': 0.7606635, 'specificity': 0.7606635, 'f1': 0.7500396, 'auroc': 0.90613425, 'binary_precision': 0.9435484, 'binary_recall': 0.55450237, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.6985075}
confusion matrix:
     0    1
0  204    7
1   94  117
oracle model performance metric: 

scalar performance:
{'acc': 0.7796208, 'precision': 0.7850046, 'recall': 0.7796209, 'specificity': 0.7796209, 'f1': 0.7785752, 'auroc': 0.88344824, 'binary_precision': 0.82417583, 'binary_recall': 0.7109005, 'binary_specificity': 0.8483412, 'binary_f1_score': 0.7633587}
confusion matrix:
     0    1
0  179   32
1   61  150
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1986 MiB |   8590 MiB | 352307 GiB | 352306 GiB |
|       from large pool |   1894 MiB |   8514 MiB | 349231 GiB | 349229 GiB |
|       from small pool |     91 MiB |    132 MiB |   3076 GiB |   3076 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1986 MiB |   8590 MiB | 352307 GiB | 352306 GiB |
|       from large pool |   1894 MiB |   8514 MiB | 349231 GiB | 349229 GiB |
|       from small pool |     91 MiB |    132 MiB |   3076 GiB |   3076 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 351769 GiB | 351767 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 348697 GiB | 348695 GiB |
|       from small pool |     91 MiB |    132 MiB |   3071 GiB |   3071 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9560 MiB |   9644 MiB |  35164 MiB |  25604 MiB |
|       from large pool |   9424 MiB |   9508 MiB |  34882 MiB |  25458 MiB |
|       from small pool |    136 MiB |    140 MiB |    282 MiB |    146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1155 MiB |   1743 MiB | 257007 GiB | 257006 GiB |
|       from large pool |   1147 MiB |   1729 MiB | 253842 GiB | 253841 GiB |
|       from small pool |      8 MiB |     56 MiB |   3165 GiB |   3165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   49597 K  |   49595 K  |
|       from large pool |     382    |     808    |   25231 K  |   25231 K  |
|       from small pool |    2062    |    2766    |   24366 K  |   24364 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   49597 K  |   49595 K  |
|       from large pool |     382    |     808    |   25231 K  |   25231 K  |
|       from small pool |    2062    |    2766    |   24366 K  |   24364 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     328    |     960    |     675    |
|       from large pool |     217    |     260    |     819    |     602    |
|       from small pool |      68    |      70    |     141    |      73    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     315    |   27140 K  |   27140 K  |
|       from large pool |      78    |     251    |   14768 K  |   14768 K  |
|       from small pool |      64    |     229    |   12371 K  |   12371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 352307 GiB | 352307 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 349231 GiB | 349231 GiB |
|       from small pool |      0 KiB |    132 MiB |   3076 GiB |   3076 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 352307 GiB | 352307 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 349231 GiB | 349231 GiB |
|       from small pool |      0 KiB |    132 MiB |   3076 GiB |   3076 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 351769 GiB | 351769 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 348697 GiB | 348697 GiB |
|       from small pool |      0 KiB |    132 MiB |   3071 GiB |   3071 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3142 MiB |   9644 MiB |  35164 MiB |  32022 MiB |
|       from large pool |   3042 MiB |   9508 MiB |  34882 MiB |  31840 MiB |
|       from small pool |    100 MiB |    140 MiB |    282 MiB |    182 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 257008 GiB | 257008 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 253843 GiB | 253843 GiB |
|       from small pool |      0 KiB |     56 MiB |   3165 GiB |   3165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   49597 K  |   49597 K  |
|       from large pool |       2    |     808    |   25231 K  |   25231 K  |
|       from small pool |       0    |    2766    |   24366 K  |   24366 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   49597 K  |   49597 K  |
|       from large pool |       2    |     808    |   25231 K  |   25231 K  |
|       from small pool |       0    |    2766    |   24366 K  |   24366 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     328    |     960    |     840    |
|       from large pool |      70    |     260    |     819    |     749    |
|       from small pool |      50    |      70    |     141    |      91    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   27140 K  |   27140 K  |
|       from large pool |       4    |     251    |   14768 K  |   14768 K  |
|       from small pool |       0    |     229    |   12371 K  |   12371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 352307 GiB | 352307 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 349231 GiB | 349231 GiB |
|       from small pool |      0 KiB |    132 MiB |   3076 GiB |   3076 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 352307 GiB | 352307 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 349231 GiB | 349231 GiB |
|       from small pool |      0 KiB |    132 MiB |   3076 GiB |   3076 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 351769 GiB | 351769 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 348697 GiB | 348697 GiB |
|       from small pool |      0 KiB |    132 MiB |   3071 GiB |   3071 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3142 MiB |   9644 MiB |  35164 MiB |  32022 MiB |
|       from large pool |   3042 MiB |   9508 MiB |  34882 MiB |  31840 MiB |
|       from small pool |    100 MiB |    140 MiB |    282 MiB |    182 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 257008 GiB | 257008 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 253843 GiB | 253843 GiB |
|       from small pool |      0 KiB |     56 MiB |   3165 GiB |   3165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   49597 K  |   49597 K  |
|       from large pool |       2    |     808    |   25231 K  |   25231 K  |
|       from small pool |       0    |    2766    |   24366 K  |   24366 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   49597 K  |   49597 K  |
|       from large pool |       2    |     808    |   25231 K  |   25231 K  |
|       from small pool |       0    |    2766    |   24366 K  |   24366 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     328    |     960    |     840    |
|       from large pool |      70    |     260    |     819    |     749    |
|       from small pool |      50    |      70    |     141    |      91    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   27140 K  |   27140 K  |
|       from large pool |       4    |     251    |   14768 K  |   14768 K  |
|       from small pool |       0    |     229    |   12371 K  |   12371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707

 Experiment start at: 2024-07-26 02:43:51.668115
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95778793, 'precision': 0.9577839, 'recall': 0.95786214, 'specificity': 0.95786214, 'f1': 0.95778596, 'auroc': 0.9930953, 'binary_precision': 0.9640288, 'binary_recall': 0.95219636, 'binary_specificity': 0.96352786, 'binary_f1_score': 0.958076}
confusion matrix:
      0     1
0  1453    55
1    74  1474
---- Validation: 
scalar performance:
{'acc': 0.7332815, 'precision': 0.78252923, 'recall': 0.7389761, 'specificity': 0.7389761, 'f1': 0.72406733, 'auroc': 0.8932648, 'binary_precision': 0.6573661, 'binary_recall': 0.9424, 'binary_specificity': 0.5355522, 'binary_f1_score': 0.7744905}
confusion matrix:
     0    1
0  354  307
1   36  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7099567, 'precision': 0.7775548, 'recall': 0.7099567, 'specificity': 0.7099567, 'f1': 0.69115186, 'auroc': 0.920916, 'binary_precision': 0.6405797, 'binary_recall': 0.95671, 'binary_specificity': 0.46320346, 'binary_f1_score': 0.7673611}
confusion matrix:
     0    1
0  107  124
1   10  221
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:46:37.400102,epoch time: 0:02:45.731987,used: 0:02:45.731987,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.9646454, 'recall': 0.96476805, 'specificity': 0.96476805, 'f1': 0.9646567, 'auroc': 0.9926375, 'binary_precision': 0.97191375, 'binary_recall': 0.9581455, 'binary_specificity': 0.97139055, 'binary_f1_score': 0.96498054}
confusion matrix:
      0     1
0  1460    43
1    65  1488
---- Validation: 
scalar performance:
{'acc': 0.7573872, 'precision': 0.7676137, 'recall': 0.75998545, 'specificity': 0.75998545, 'f1': 0.75613916, 'auroc': 0.82848895, 'binary_precision': 0.7078353, 'binary_recall': 0.8528, 'binary_specificity': 0.66717094, 'binary_f1_score': 0.7735849}
confusion matrix:
     0    1
0  441  220
1   92  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8030303, 'precision': 0.8185579, 'recall': 0.8030303, 'specificity': 0.8030303, 'f1': 0.80060047, 'auroc': 0.9056052, 'binary_precision': 0.74822694, 'binary_recall': 0.9134199, 'binary_specificity': 0.6926407, 'binary_f1_score': 0.8226121}
confusion matrix:
     0    1
0  160   71
1   20  211
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:49:22.909470,epoch time: 0:02:45.509368,used: 0:05:31.241355,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.9680184, 'recall': 0.96791196, 'specificity': 0.96791196, 'f1': 0.9676044, 'auroc': 0.9961909, 'binary_precision': 0.9866131, 'binary_recall': 0.9491307, 'binary_specificity': 0.98669326, 'binary_f1_score': 0.96750903}
confusion matrix:
      0     1
0  1483    20
1    79  1474
---- Validation: 
scalar performance:
{'acc': 0.8273717, 'precision': 0.8372133, 'recall': 0.8249271, 'specificity': 0.8249271, 'f1': 0.8252409, 'auroc': 0.88986385, 'binary_precision': 0.88824666, 'binary_recall': 0.7376, 'binary_specificity': 0.91225415, 'binary_f1_score': 0.8059441}
confusion matrix:
     0    1
0  603   58
1  164  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83549786, 'precision': 0.8615425, 'recall': 0.83549786, 'specificity': 0.83549786, 'f1': 0.83248097, 'auroc': 0.8997021, 'binary_precision': 0.9585799, 'binary_recall': 0.7012987, 'binary_specificity': 0.969697, 'binary_f1_score': 0.81000006}
confusion matrix:
     0    1
0  224    7
1   69  162
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 02:52:08.311452,epoch time: 0:02:45.401982,used: 0:08:16.643337,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9617147, 'precision': 0.96357536, 'recall': 0.96127737, 'specificity': 0.96127737, 'f1': 0.961642, 'auroc': 0.99658346, 'binary_precision': 0.93772894, 'binary_recall': 0.99032885, 'binary_specificity': 0.93222594, 'binary_f1_score': 0.96331143}
confusion matrix:
      0     1
0  1403   102
1    15  1536
---- Validation: 
scalar performance:
{'acc': 0.7682737, 'precision': 0.80045754, 'recall': 0.772754, 'specificity': 0.772754, 'f1': 0.76374745, 'auroc': 0.90100336, 'binary_precision': 0.6948748, 'binary_recall': 0.9328, 'binary_specificity': 0.61270803, 'binary_f1_score': 0.79644805}
confusion matrix:
     0    1
0  405  256
1   42  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74458873, 'precision': 0.78836083, 'recall': 0.74458873, 'specificity': 0.74458873, 'f1': 0.73451376, 'auroc': 0.91773015, 'binary_precision': 0.67601246, 'binary_recall': 0.93939394, 'binary_specificity': 0.5497835, 'binary_f1_score': 0.7862319}
confusion matrix:
     0    1
0  127  104
1   14  217
early stop counter: 1
val acc:0.7682737112045288, best validation acc: 0.8273717164993286, corresponding to test acc:                         0.8354978561401367 / 0.8354978561401367
after epoch: 4,now: 2024-07-26 02:54:52.154771,epoch time: 0:02:43.843319,used: 0:11:00.486656,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.9706353, 'recall': 0.9692508, 'specificity': 0.9692508, 'f1': 0.9695293, 'auroc': 0.9976052, 'binary_precision': 0.95167285, 'binary_recall': 0.99032885, 'binary_specificity': 0.94817275, 'binary_f1_score': 0.9706161}
confusion matrix:
      0     1
0  1427    78
1    15  1536
---- Validation: 
scalar performance:
{'acc': 0.8281493, 'precision': 0.82804203, 'recall': 0.82794917, 'specificity': 0.82794917, 'f1': 0.8279911, 'auroc': 0.88763934, 'binary_precision': 0.8247588, 'binary_recall': 0.8208, 'binary_specificity': 0.8350983, 'binary_f1_score': 0.8227747}
confusion matrix:
     0    1
0  552  109
1  112  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.8022413, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.7981101, 'auroc': 0.9008639, 'binary_precision': 0.83495146, 'binary_recall': 0.74458873, 'binary_specificity': 0.85281384, 'binary_f1_score': 0.7871853}
confusion matrix:
     0    1
0  197   34
1   59  172
better model found
persisted
after epoch: 5,now: 2024-07-26 02:57:37.086013,epoch time: 0:02:44.931242,used: 0:13:45.417898,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98654366, 'recall': 0.98665476, 'specificity': 0.98665476, 'f1': 0.9865814, 'auroc': 0.99874634, 'binary_precision': 0.9909209, 'binary_recall': 0.98263663, 'binary_specificity': 0.9906729, 'binary_f1_score': 0.9867614}
confusion matrix:
      0     1
0  1487    14
1    27  1528
---- Validation: 
scalar performance:
{'acc': 0.6998445, 'precision': 0.75840026, 'recall': 0.6929428, 'specificity': 0.6929428, 'f1': 0.67700046, 'auroc': 0.8917326, 'binary_precision': 0.87460816, 'binary_recall': 0.4464, 'binary_specificity': 0.9394856, 'binary_f1_score': 0.59110165}
confusion matrix:
     0    1
0  621   40
1  346  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8181818, 'precision': 0.8325401, 'recall': 0.8181818, 'specificity': 0.8181818, 'f1': 0.8161978, 'auroc': 0.8930305, 'binary_precision': 0.90163934, 'binary_recall': 0.71428573, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.7971015}
confusion matrix:
     0    1
0  213   18
1   66  165
early stop counter: 1
val acc:0.699844479560852, best validation acc: 0.8281493186950684, corresponding to test acc:                         0.798701286315918 / 0.8354978561401367
after epoch: 6,now: 2024-07-26 03:00:21.369103,epoch time: 0:02:44.283090,used: 0:16:29.700988,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.981856, 'recall': 0.9815587, 'specificity': 0.9815587, 'f1': 0.9816652, 'auroc': 0.9987186, 'binary_precision': 0.9758577, 'binary_recall': 0.98841697, 'binary_specificity': 0.9747004, 'binary_f1_score': 0.9820972}
confusion matrix:
      0     1
0  1464    38
1    18  1536
---- Validation: 
scalar performance:
{'acc': 0.7332815, 'precision': 0.74664056, 'recall': 0.72978276, 'specificity': 0.72978276, 'f1': 0.72752, 'auroc': 0.8348006, 'binary_precision': 0.79746836, 'binary_recall': 0.6048, 'binary_specificity': 0.85476553, 'binary_f1_score': 0.68789804}
confusion matrix:
     0    1
0  565   96
1  247  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72077924, 'precision': 0.7438121, 'recall': 0.7207792, 'specificity': 0.7207792, 'f1': 0.71402526, 'auroc': 0.84732294, 'binary_precision': 0.66887414, 'binary_recall': 0.87445885, 'binary_specificity': 0.5670996, 'binary_f1_score': 0.75797373}
confusion matrix:
     0    1
0  131  100
1   29  202
early stop counter: 2
val acc:0.7332814931869507, best validation acc: 0.8281493186950684, corresponding to test acc:                         0.798701286315918 / 0.8354978561401367
after epoch: 7,now: 2024-07-26 03:03:05.290574,epoch time: 0:02:43.921471,used: 0:19:13.622459,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9829361, 'recall': 0.98292553, 'specificity': 0.98292553, 'f1': 0.9826571, 'auroc': 0.99922585, 'binary_precision': 0.9993342, 'binary_recall': 0.96651644, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9826514}
confusion matrix:
      0     1
0  1502     1
1    52  1501
---- Validation: 
scalar performance:
{'acc': 0.69284606, 'precision': 0.7798764, 'recall': 0.6848278, 'specificity': 0.6848278, 'f1': 0.6612059, 'auroc': 0.884279, 'binary_precision': 0.9291045, 'binary_recall': 0.3984, 'binary_specificity': 0.97125566, 'binary_f1_score': 0.5576708}
confusion matrix:
     0    1
0  642   19
1  376  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7056277, 'precision': 0.800938, 'recall': 0.7056277, 'specificity': 0.7056277, 'f1': 0.68031585, 'auroc': 0.8916999, 'binary_precision': 0.97029704, 'binary_recall': 0.42424244, 'binary_specificity': 0.987013, 'binary_f1_score': 0.5903615}
confusion matrix:
     0   1
0  228   3
1  133  98
early stop counter: 3
val acc:0.6928460597991943, best validation acc: 0.8281493186950684, corresponding to test acc:                         0.798701286315918 / 0.8354978561401367
after epoch: 8,now: 2024-07-26 03:05:49.236288,epoch time: 0:02:43.945714,used: 0:21:57.568173,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.987556, 'recall': 0.9876754, 'specificity': 0.9876754, 'f1': 0.98756456, 'auroc': 0.9982872, 'binary_precision': 0.99477124, 'binary_recall': 0.9806701, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.98767036}
confusion matrix:
      0     1
0  1496     8
1    30  1522
---- Validation: 
scalar performance:
{'acc': 0.785381, 'precision': 0.8177943, 'recall': 0.78081214, 'specificity': 0.78081214, 'f1': 0.77776945, 'auroc': 0.883108, 'binary_precision': 0.9125295, 'binary_recall': 0.6176, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.7366412}
confusion matrix:
     0    1
0  624   37
1  239  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8008658, 'precision': 0.846712, 'recall': 0.80086577, 'specificity': 0.80086577, 'f1': 0.79405785, 'auroc': 0.89494205, 'binary_precision': 0.9727891, 'binary_recall': 0.61904764, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.75661385}
confusion matrix:
     0    1
0  227    4
1   88  143
early stop counter: 4
val acc:0.785381019115448, best validation acc: 0.8281493186950684, corresponding to test acc:                         0.798701286315918 / 0.8354978561401367
after epoch: 9,now: 2024-07-26 03:08:33.229721,epoch time: 0:02:43.993433,used: 0:24:41.561606,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98472786, 'recall': 0.9848332, 'specificity': 0.9848332, 'f1': 0.9846202, 'auroc': 0.99932563, 'binary_precision': 0.99735975, 'binary_recall': 0.9723295, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.9846856}
confusion matrix:
      0     1
0  1498     4
1    43  1511
---- Validation: 
scalar performance:
{'acc': 0.7161742, 'precision': 0.7970494, 'recall': 0.70869714, 'specificity': 0.70869714, 'f1': 0.69070953, 'auroc': 0.8981483, 'binary_precision': 0.94520545, 'binary_recall': 0.4416, 'binary_specificity': 0.97579426, 'binary_f1_score': 0.6019629}
confusion matrix:
     0    1
0  645   16
1  349  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7251082, 'precision': 0.80642855, 'recall': 0.7251082, 'specificity': 0.7251082, 'f1': 0.70557445, 'auroc': 0.89601016, 'binary_precision': 0.96428573, 'binary_recall': 0.46753246, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.62973756}
confusion matrix:
     0    1
0  227    4
1  123  108
early stop counter: 5
val acc:0.7161741852760315, best validation acc: 0.8281493186950684, corresponding to test acc:                         0.798701286315918 / 0.8354978561401367
after epoch: 10,now: 2024-07-26 03:11:17.291520,epoch time: 0:02:44.061799,used: 0:27:25.623405,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_43_51_seed_5_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:27:25.623405 at 2024-07-26 03:11:17.291520
persisted model performance metric: 

scalar performance:
{'acc': 0.7987013, 'precision': 0.8022413, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.7981101, 'auroc': 0.9008639, 'binary_precision': 0.83495146, 'binary_recall': 0.74458873, 'binary_specificity': 0.85281384, 'binary_f1_score': 0.7871853}
confusion matrix:
     0    1
0  197   34
1   59  172
oracle model performance metric: 

scalar performance:
{'acc': 0.83549786, 'precision': 0.8615425, 'recall': 0.83549786, 'specificity': 0.83549786, 'f1': 0.83248097, 'auroc': 0.8997021, 'binary_precision': 0.9585799, 'binary_recall': 0.7012987, 'binary_specificity': 0.969697, 'binary_f1_score': 0.81000006}
confusion matrix:
     0    1
0  224    7
1   69  162
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1988 MiB |   8590 MiB | 418461 GiB | 418459 GiB |
|       from large pool |   1897 MiB |   8514 MiB | 414806 GiB | 414804 GiB |
|       from small pool |     91 MiB |    132 MiB |   3654 GiB |   3654 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1988 MiB |   8590 MiB | 418461 GiB | 418459 GiB |
|       from large pool |   1897 MiB |   8514 MiB | 414806 GiB | 414804 GiB |
|       from small pool |     91 MiB |    132 MiB |   3654 GiB |   3654 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 417862 GiB | 417860 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 414213 GiB | 414211 GiB |
|       from small pool |     91 MiB |    132 MiB |   3649 GiB |   3648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9548 MiB |   9644 MiB |  41570 MiB |  32022 MiB |
|       from large pool |   9412 MiB |   9508 MiB |  41252 MiB |  31840 MiB |
|       from small pool |    136 MiB |    140 MiB |    318 MiB |    182 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1271 MiB |   1743 MiB | 306595 GiB | 306594 GiB |
|       from large pool |   1262 MiB |   1729 MiB | 302836 GiB | 302834 GiB |
|       from small pool |      8 MiB |     56 MiB |   3759 GiB |   3759 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   58923 K  |   58921 K  |
|       from large pool |     382    |     808    |   29974 K  |   29974 K  |
|       from small pool |    2074    |    2766    |   28949 K  |   28947 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   58923 K  |   58921 K  |
|       from large pool |     382    |     808    |   29974 K  |   29974 K  |
|       from small pool |    2074    |    2766    |   28949 K  |   28947 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     279    |     328    |    1119    |     840    |
|       from large pool |     211    |     260    |     960    |     749    |
|       from small pool |      68    |      70    |     159    |      91    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     138    |     315    |   32164 K  |   32164 K  |
|       from large pool |      75    |     251    |   17504 K  |   17504 K  |
|       from small pool |      63    |     229    |   14659 K  |   14659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 418461 GiB | 418461 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 414806 GiB | 414806 GiB |
|       from small pool |      0 KiB |    132 MiB |   3654 GiB |   3654 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 418461 GiB | 418461 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 414806 GiB | 414806 GiB |
|       from small pool |      0 KiB |    132 MiB |   3654 GiB |   3654 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 417862 GiB | 417862 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 414213 GiB | 414213 GiB |
|       from small pool |      0 KiB |    132 MiB |   3649 GiB |   3649 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3260 MiB |   9644 MiB |  41570 MiB |  38310 MiB |
|       from large pool |   3160 MiB |   9508 MiB |  41252 MiB |  38092 MiB |
|       from small pool |    100 MiB |    140 MiB |    318 MiB |    218 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 306596 GiB | 306596 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 302836 GiB | 302836 GiB |
|       from small pool |      0 KiB |     56 MiB |   3759 GiB |   3759 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   58923 K  |   58923 K  |
|       from large pool |       2    |     808    |   29974 K  |   29974 K  |
|       from small pool |       0    |    2766    |   28949 K  |   28949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   58923 K  |   58923 K  |
|       from large pool |       2    |     808    |   29974 K  |   29974 K  |
|       from small pool |       0    |    2766    |   28949 K  |   28949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     328    |    1119    |     996    |
|       from large pool |      73    |     260    |     960    |     887    |
|       from small pool |      50    |      70    |     159    |     109    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   32164 K  |   32164 K  |
|       from large pool |       4    |     251    |   17505 K  |   17505 K  |
|       from small pool |       0    |     229    |   14659 K  |   14659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 418461 GiB | 418461 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 414806 GiB | 414806 GiB |
|       from small pool |      0 KiB |    132 MiB |   3654 GiB |   3654 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 418461 GiB | 418461 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 414806 GiB | 414806 GiB |
|       from small pool |      0 KiB |    132 MiB |   3654 GiB |   3654 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 417862 GiB | 417862 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 414213 GiB | 414213 GiB |
|       from small pool |      0 KiB |    132 MiB |   3649 GiB |   3649 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3260 MiB |   9644 MiB |  41570 MiB |  38310 MiB |
|       from large pool |   3160 MiB |   9508 MiB |  41252 MiB |  38092 MiB |
|       from small pool |    100 MiB |    140 MiB |    318 MiB |    218 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 306596 GiB | 306596 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 302836 GiB | 302836 GiB |
|       from small pool |      0 KiB |     56 MiB |   3759 GiB |   3759 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   58923 K  |   58923 K  |
|       from large pool |       2    |     808    |   29974 K  |   29974 K  |
|       from small pool |       0    |    2766    |   28949 K  |   28949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   58923 K  |   58923 K  |
|       from large pool |       2    |     808    |   29974 K  |   29974 K  |
|       from small pool |       0    |    2766    |   28949 K  |   28949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     328    |    1119    |     996    |
|       from large pool |      73    |     260    |     960    |     887    |
|       from small pool |      50    |      70    |     159    |     109    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   32164 K  |   32164 K  |
|       from large pool |       4    |     251    |   17505 K  |   17505 K  |
|       from small pool |       0    |     229    |   14659 K  |   14659 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707

 Experiment start at: 2024-07-26 03:11:50.941747
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95214844, 'precision': 0.9544138, 'recall': 0.9525882, 'specificity': 0.9525882, 'f1': 0.9521152, 'auroc': 0.9870795, 'binary_precision': 0.98956156, 'binary_recall': 0.9150579, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9508526}
confusion matrix:
      0     1
0  1503    15
1   132  1422
---- Validation: 
scalar performance:
{'acc': 0.71828794, 'precision': 0.7894592, 'recall': 0.7165408, 'specificity': 0.7165408, 'f1': 0.69878185, 'auroc': 0.8916242, 'binary_precision': 0.93125, 'binary_recall': 0.46708465, 'binary_specificity': 0.9659969, 'binary_f1_score': 0.62212944}
confusion matrix:
     0    1
0  625   22
1  340  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.768018, 'precision': 0.837973, 'recall': 0.768018, 'specificity': 0.768018, 'f1': 0.7553588, 'auroc': 0.89262235, 'binary_precision': 0.9917355, 'binary_recall': 0.5405405, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.6997084}
confusion matrix:
     0    1
0  221    1
1  102  120
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:14:37.047651,epoch time: 0:02:46.105904,used: 0:02:46.105904,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9736189, 'recall': 0.97366047, 'specificity': 0.97366047, 'f1': 0.9736313, 'auroc': 0.9964541, 'binary_precision': 0.97666883, 'binary_recall': 0.97100514, 'binary_specificity': 0.9763158, 'binary_f1_score': 0.97382873}
confusion matrix:
      0     1
0  1484    36
1    45  1507
---- Validation: 
scalar performance:
{'acc': 0.8023346, 'precision': 0.81423414, 'recall': 0.8030117, 'specificity': 0.8030117, 'f1': 0.8006822, 'auroc': 0.90263236, 'binary_precision': 0.7513089, 'binary_recall': 0.8996865, 'binary_specificity': 0.7063369, 'binary_f1_score': 0.8188302}
confusion matrix:
     0    1
0  457  190
1   64  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747748, 'precision': 0.78497475, 'recall': 0.7747748, 'specificity': 0.7747748, 'f1': 0.77274126, 'auroc': 0.904817, 'binary_precision': 0.7310606, 'binary_recall': 0.8693694, 'binary_specificity': 0.6801802, 'binary_f1_score': 0.7942387}
confusion matrix:
     0    1
0  151   71
1   29  193
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:17:23.570098,epoch time: 0:02:46.522447,used: 0:05:32.628351,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.9640034, 'recall': 0.9640107, 'specificity': 0.9640107, 'f1': 0.9638672, 'auroc': 0.9954772, 'binary_precision': 0.9756258, 'binary_recall': 0.9524116, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9638789}
confusion matrix:
      0     1
0  1480    37
1    74  1481
---- Validation: 
scalar performance:
{'acc': 0.7151751, 'precision': 0.72259927, 'recall': 0.71451795, 'specificity': 0.71451795, 'f1': 0.7123655, 'auroc': 0.8079998, 'binary_precision': 0.76153845, 'binary_recall': 0.62068963, 'binary_specificity': 0.8083462, 'binary_f1_score': 0.6839378}
confusion matrix:
     0    1
0  523  124
1  242  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108108, 'precision': 0.8144863, 'recall': 0.8108108, 'specificity': 0.8108108, 'f1': 0.8102565, 'auroc': 0.8999473, 'binary_precision': 0.7804878, 'binary_recall': 0.8648649, 'binary_specificity': 0.7567568, 'binary_f1_score': 0.82051283}
confusion matrix:
     0    1
0  168   54
1   30  192
new oracle model saved
early stop counter: 1
val acc:0.7151750922203064, best validation acc: 0.8023346066474915, corresponding to test acc:                         0.7747747898101807 / 0.8108108043670654
after epoch: 3,now: 2024-07-26 03:20:08.562764,epoch time: 0:02:44.992666,used: 0:08:17.621017,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97489226, 'recall': 0.9747626, 'specificity': 0.9747626, 'f1': 0.9746089, 'auroc': 0.99796784, 'binary_precision': 0.9893758, 'binary_recall': 0.96005154, 'binary_specificity': 0.9894737, 'binary_f1_score': 0.97449315}
confusion matrix:
      0     1
0  1504    16
1    62  1490
---- Validation: 
scalar performance:
{'acc': 0.7922179, 'precision': 0.80901957, 'recall': 0.79139555, 'specificity': 0.79139555, 'f1': 0.7890283, 'auroc': 0.8898267, 'binary_precision': 0.8793456, 'binary_recall': 0.6739812, 'binary_specificity': 0.9088099, 'binary_f1_score': 0.7630878}
confusion matrix:
     0    1
0  588   59
1  208  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7725225, 'precision': 0.8120368, 'recall': 0.77252257, 'specificity': 0.77252257, 'f1': 0.76508546, 'auroc': 0.8770596, 'binary_precision': 0.9230769, 'binary_recall': 0.5945946, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.72328764}
confusion matrix:
     0    1
0  211   11
1   90  132
early stop counter: 2
val acc:0.7922179102897644, best validation acc: 0.8023346066474915, corresponding to test acc:                         0.7747747898101807 / 0.8108108043670654
after epoch: 4,now: 2024-07-26 03:22:53.287332,epoch time: 0:02:44.724568,used: 0:11:02.345585,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98535603, 'recall': 0.9854381, 'specificity': 0.9854381, 'f1': 0.985351, 'auroc': 0.99870145, 'binary_precision': 0.99218243, 'binary_recall': 0.9787918, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9854416}
confusion matrix:
      0     1
0  1504    12
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.81089497, 'precision': 0.81710076, 'recall': 0.81040055, 'specificity': 0.81040055, 'f1': 0.8097886, 'auroc': 0.8895941, 'binary_precision': 0.85974497, 'binary_recall': 0.7398119, 'binary_specificity': 0.8809892, 'binary_f1_score': 0.7952822}
confusion matrix:
     0    1
0  570   77
1  166  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8153153, 'precision': 0.8401629, 'recall': 0.81531537, 'specificity': 0.81531537, 'f1': 0.81188, 'auroc': 0.8875903, 'binary_precision': 0.93209875, 'binary_recall': 0.6801802, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.7864584}
confusion matrix:
     0    1
0  211   11
1   71  151
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 03:25:39.776655,epoch time: 0:02:46.489323,used: 0:13:48.834908,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9860045, 'recall': 0.9859965, 'specificity': 0.9859965, 'f1': 0.98600036, 'auroc': 0.9985019, 'binary_precision': 0.9858612, 'binary_recall': 0.9864952, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.9861781}
confusion matrix:
      0     1
0  1495    22
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.80389106, 'precision': 0.8090207, 'recall': 0.8034345, 'specificity': 0.8034345, 'f1': 0.80290264, 'auroc': 0.87959135, 'binary_precision': 0.8471223, 'binary_recall': 0.73824453, 'binary_specificity': 0.86862445, 'binary_f1_score': 0.7889448}
confusion matrix:
     0    1
0  562   85
1  167  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7387387, 'precision': 0.74259794, 'recall': 0.7387388, 'specificity': 0.7387388, 'f1': 0.7376956, 'auroc': 0.8567689, 'binary_precision': 0.712, 'binary_recall': 0.8018018, 'binary_specificity': 0.6756757, 'binary_f1_score': 0.75423735}
confusion matrix:
     0    1
0  150   72
1   44  178
early stop counter: 1
val acc:0.8038910627365112, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.815315306186676 / 0.815315306186676
after epoch: 6,now: 2024-07-26 03:28:24.306865,epoch time: 0:02:44.530210,used: 0:16:33.365118,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98598397, 'recall': 0.9860287, 'specificity': 0.9860287, 'f1': 0.9860012, 'auroc': 0.99891096, 'binary_precision': 0.9883721, 'binary_recall': 0.98392284, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.9861424}
confusion matrix:
      0     1
0  1499    18
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.8015564, 'precision': 0.80219537, 'recall': 0.8013886, 'specificity': 0.8013886, 'f1': 0.8013828, 'auroc': 0.880088, 'binary_precision': 0.8144499, 'binary_recall': 0.77742946, 'binary_specificity': 0.8253478, 'binary_f1_score': 0.7955092}
confusion matrix:
     0    1
0  534  113
1  142  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.759009, 'precision': 0.76134753, 'recall': 0.759009, 'specificity': 0.759009, 'f1': 0.75846875, 'auroc': 0.86612284, 'binary_precision': 0.7366255, 'binary_recall': 0.8063063, 'binary_specificity': 0.7117117, 'binary_f1_score': 0.7698925}
confusion matrix:
     0    1
0  158   64
1   43  179
early stop counter: 2
val acc:0.801556408405304, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.815315306186676 / 0.815315306186676
after epoch: 7,now: 2024-07-26 03:31:08.835845,epoch time: 0:02:44.528980,used: 0:19:17.894098,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9855064, 'recall': 0.9855144, 'specificity': 0.9855144, 'f1': 0.98535156, 'auroc': 0.99695957, 'binary_precision': 0.99802244, 'binary_recall': 0.97300774, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98535633}
confusion matrix:
      0     1
0  1513     3
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.67081714, 'precision': 0.77843267, 'recall': 0.6686261, 'specificity': 0.6686261, 'f1': 0.6339108, 'auroc': 0.8268764, 'binary_precision': 0.9497908, 'binary_recall': 0.35579938, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.5176739}
confusion matrix:
     0    1
0  635   12
1  411  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5675676, 'precision': 0.73888093, 'recall': 0.5675676, 'specificity': 0.5675676, 'f1': 0.47310126, 'auroc': 0.79419285, 'binary_precision': 0.9411765, 'binary_recall': 0.14414415, 'binary_specificity': 0.990991, 'binary_f1_score': 0.25}
confusion matrix:
     0   1
0  220   2
1  190  32
early stop counter: 3
val acc:0.6708171367645264, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.815315306186676 / 0.815315306186676
after epoch: 8,now: 2024-07-26 03:33:53.498437,epoch time: 0:02:44.662592,used: 0:22:02.556690,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9718747, 'recall': 0.9709674, 'specificity': 0.9709674, 'f1': 0.97069407, 'auroc': 0.99276626, 'binary_precision': 0.997955, 'binary_recall': 0.94390714, 'binary_specificity': 0.9980276, 'binary_f1_score': 0.9701789}
confusion matrix:
      0     1
0  1518     3
1    87  1464
---- Validation: 
scalar performance:
{'acc': 0.57431906, 'precision': 0.7604821, 'recall': 0.5713384, 'specificity': 0.5713384, 'f1': 0.47799182, 'auroc': 0.8656144, 'binary_precision': 0.97894734, 'binary_recall': 0.14576803, 'binary_specificity': 0.9969088, 'binary_f1_score': 0.25375172}
confusion matrix:
     0   1
0  645   2
1  545  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5067568, 'precision': 0.75170064, 'recall': 0.5067568, 'specificity': 0.5067568, 'f1': 0.34817496, 'auroc': 0.8684056, 'binary_precision': 1.0, 'binary_recall': 0.013513514, 'binary_specificity': 1.0, 'binary_f1_score': 0.026666665}
confusion matrix:
     0  1
0  222  0
1  219  3
early stop counter: 4
val acc:0.574319064617157, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.815315306186676 / 0.815315306186676
after epoch: 9,now: 2024-07-26 03:36:38.363342,epoch time: 0:02:44.864905,used: 0:24:47.421595,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.980069, 'recall': 0.9796842, 'specificity': 0.9796842, 'f1': 0.97949004, 'auroc': 0.99905473, 'binary_precision': 0.99932885, 'binary_recall': 0.9600258, 'binary_specificity': 0.99934256, 'binary_f1_score': 0.9792831}
confusion matrix:
      0     1
0  1520     1
1    62  1489
---- Validation: 
scalar performance:
{'acc': 0.5797665, 'precision': 0.7538208, 'recall': 0.5768461, 'specificity': 0.5768461, 'f1': 0.4892326, 'auroc': 0.8847829, 'binary_precision': 0.9622642, 'binary_recall': 0.1598746, 'binary_specificity': 0.9938176, 'binary_f1_score': 0.27419356}
confusion matrix:
     0    1
0  643    4
1  536  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8908723, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  222  0
1  222  0
early stop counter: 5
val acc:0.5797665119171143, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.815315306186676 / 0.815315306186676
after epoch: 10,now: 2024-07-26 03:39:23.286346,epoch time: 0:02:44.923004,used: 0:27:32.344599,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_11_50_seed_6_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:27:32.344599 at 2024-07-26 03:39:23.286346
persisted model performance metric: 

scalar performance:
{'acc': 0.8153153, 'precision': 0.8401629, 'recall': 0.81531537, 'specificity': 0.81531537, 'f1': 0.81188, 'auroc': 0.8875903, 'binary_precision': 0.93209875, 'binary_recall': 0.6801802, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.7864584}
confusion matrix:
     0    1
0  211   11
1   71  151
oracle model performance metric: 

scalar performance:
{'acc': 0.8153153, 'precision': 0.8401629, 'recall': 0.81531537, 'specificity': 0.81531537, 'f1': 0.81188, 'auroc': 0.8875903, 'binary_precision': 0.93209875, 'binary_recall': 0.6801802, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.7864584}
confusion matrix:
     0    1
0  211   11
1   71  151
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1990 MiB |   8590 MiB | 484912 GiB | 484910 GiB |
|       from large pool |   1898 MiB |   8514 MiB | 480677 GiB | 480675 GiB |
|       from small pool |     91 MiB |    132 MiB |   4234 GiB |   4234 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1990 MiB |   8590 MiB | 484912 GiB | 484910 GiB |
|       from large pool |   1898 MiB |   8514 MiB | 480677 GiB | 480675 GiB |
|       from small pool |     91 MiB |    132 MiB |   4234 GiB |   4234 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 484253 GiB | 484251 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 480025 GiB | 480023 GiB |
|       from small pool |     91 MiB |    132 MiB |   4228 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9528 MiB |   9644 MiB |  47838 MiB |  38310 MiB |
|       from large pool |   9392 MiB |   9508 MiB |  47484 MiB |  38092 MiB |
|       from small pool |    136 MiB |    140 MiB |    354 MiB |    218 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    939 MiB |   1743 MiB | 358029 GiB | 358028 GiB |
|       from large pool |    931 MiB |   1729 MiB | 353673 GiB | 353672 GiB |
|       from small pool |      8 MiB |     56 MiB |   4356 GiB |   4356 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2450    |    3301    |   68287 K  |   68284 K  |
|       from large pool |     382    |     808    |   34737 K  |   34737 K  |
|       from small pool |    2068    |    2766    |   33549 K  |   33547 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2450    |    3301    |   68287 K  |   68284 K  |
|       from large pool |     382    |     808    |   34737 K  |   34737 K  |
|       from small pool |    2068    |    2766    |   33549 K  |   33547 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     276    |     328    |    1272    |     996    |
|       from large pool |     208    |     260    |    1095    |     887    |
|       from small pool |      68    |      70    |     177    |     109    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     135    |     315    |   37258 K  |   37258 K  |
|       from large pool |      69    |     251    |   20275 K  |   20275 K  |
|       from small pool |      66    |     229    |   16982 K  |   16982 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 484912 GiB | 484912 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 480677 GiB | 480677 GiB |
|       from small pool |      0 KiB |    132 MiB |   4234 GiB |   4234 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 484912 GiB | 484912 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 480677 GiB | 480677 GiB |
|       from small pool |      0 KiB |    132 MiB |   4234 GiB |   4234 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 484253 GiB | 484253 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 480025 GiB | 480025 GiB |
|       from small pool |      0 KiB |    132 MiB |   4228 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2930 MiB |   9644 MiB |  47838 MiB |  44908 MiB |
|       from large pool |   2830 MiB |   9508 MiB |  47484 MiB |  44654 MiB |
|       from small pool |    100 MiB |    140 MiB |    354 MiB |    254 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 358030 GiB | 358030 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 353674 GiB | 353674 GiB |
|       from small pool |      0 KiB |     56 MiB |   4356 GiB |   4356 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   68287 K  |   68287 K  |
|       from large pool |       2    |     808    |   34737 K  |   34737 K  |
|       from small pool |       0    |    2766    |   33549 K  |   33549 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   68287 K  |   68287 K  |
|       from large pool |       2    |     808    |   34737 K  |   34737 K  |
|       from small pool |       0    |    2766    |   33549 K  |   33549 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     328    |    1272    |    1151    |
|       from large pool |      71    |     260    |    1095    |    1024    |
|       from small pool |      50    |      70    |     177    |     127    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   37259 K  |   37259 K  |
|       from large pool |       4    |     251    |   20275 K  |   20275 K  |
|       from small pool |       0    |     229    |   16983 K  |   16983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 484912 GiB | 484912 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 480677 GiB | 480677 GiB |
|       from small pool |      0 KiB |    132 MiB |   4234 GiB |   4234 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 484912 GiB | 484912 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 480677 GiB | 480677 GiB |
|       from small pool |      0 KiB |    132 MiB |   4234 GiB |   4234 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 484253 GiB | 484253 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 480025 GiB | 480025 GiB |
|       from small pool |      0 KiB |    132 MiB |   4228 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2930 MiB |   9644 MiB |  47838 MiB |  44908 MiB |
|       from large pool |   2830 MiB |   9508 MiB |  47484 MiB |  44654 MiB |
|       from small pool |    100 MiB |    140 MiB |    354 MiB |    254 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 358030 GiB | 358030 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 353674 GiB | 353674 GiB |
|       from small pool |      0 KiB |     56 MiB |   4356 GiB |   4356 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   68287 K  |   68287 K  |
|       from large pool |       2    |     808    |   34737 K  |   34737 K  |
|       from small pool |       0    |    2766    |   33549 K  |   33549 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   68287 K  |   68287 K  |
|       from large pool |       2    |     808    |   34737 K  |   34737 K  |
|       from small pool |       0    |    2766    |   33549 K  |   33549 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     328    |    1272    |    1151    |
|       from large pool |      71    |     260    |    1095    |    1024    |
|       from small pool |      50    |      70    |     177    |     127    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   37259 K  |   37259 K  |
|       from large pool |       4    |     251    |   20275 K  |   20275 K  |
|       from small pool |       0    |     229    |   16983 K  |   16983 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707

 Experiment start at: 2024-07-26 03:39:56.228209
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.9630457, 'recall': 0.9630952, 'specificity': 0.9630952, 'f1': 0.96289045, 'auroc': 0.99417996, 'binary_precision': 0.97628456, 'binary_recall': 0.95, 'binary_specificity': 0.97619045, 'binary_f1_score': 0.9629629}
confusion matrix:
      0     1
0  1476    36
1    78  1482
---- Validation: 
scalar performance:
{'acc': 0.8269231, 'precision': 0.8269197, 'recall': 0.8268229, 'specificity': 0.8268229, 'f1': 0.82685906, 'auroc': 0.892197, 'binary_precision': 0.8267717, 'binary_recall': 0.8203125, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  550  110
1  115  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.8599547, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8408986, 'auroc': 0.9251921, 'binary_precision': 0.9385475, 'binary_recall': 0.73362446, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  218   11
1   61  168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:42:42.730353,epoch time: 0:02:46.502144,used: 0:02:46.502144,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9593099, 'precision': 0.9615587, 'recall': 0.9599054, 'specificity': 0.9599054, 'f1': 0.9592882, 'auroc': 0.9950253, 'binary_precision': 0.9979181, 'binary_recall': 0.9217949, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.95834726}
confusion matrix:
      0     1
0  1509     3
1   122  1438
---- Validation: 
scalar performance:
{'acc': 0.65615386, 'precision': 0.70307696, 'recall': 0.65234375, 'specificity': 0.65234375, 'f1': 0.6316965, 'auroc': 0.80131626, 'binary_precision': 0.7969231, 'binary_recall': 0.4046875, 'binary_specificity': 0.9, 'binary_f1_score': 0.53678757}
confusion matrix:
     0    1
0  594   66
1  381  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6484716, 'precision': 0.7206916, 'recall': 0.6484716, 'specificity': 0.6484716, 'f1': 0.6171503, 'auroc': 0.839267, 'binary_precision': 0.8469388, 'binary_recall': 0.3624454, 'binary_specificity': 0.93449783, 'binary_f1_score': 0.50764525}
confusion matrix:
     0   1
0  214  15
1  146  83
early stop counter: 1
val acc:0.6561538577079773, best validation acc: 0.8269230723381042, corresponding to test acc:                         0.8427947759628296 / 0.8427947759628296
after epoch: 2,now: 2024-07-26 03:45:27.615217,epoch time: 0:02:44.884864,used: 0:05:31.387008,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.9524535, 'recall': 0.95107853, 'specificity': 0.95107853, 'f1': 0.9504993, 'auroc': 0.9937148, 'binary_precision': 0.9861878, 'binary_recall': 0.9153846, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.949468}
confusion matrix:
      0     1
0  1492    20
1   132  1428
---- Validation: 
scalar performance:
{'acc': 0.65, 'precision': 0.75150776, 'recall': 0.6450284, 'specificity': 0.6450284, 'f1': 0.6063257, 'auroc': 0.8743768, 'binary_precision': 0.907489, 'binary_recall': 0.321875, 'binary_specificity': 0.9681818, 'binary_f1_score': 0.47520182}
confusion matrix:
     0    1
0  639   21
1  434  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57641923, 'precision': 0.745242, 'recall': 0.57641923, 'specificity': 0.57641923, 'f1': 0.48836833, 'auroc': 0.8806039, 'binary_precision': 0.94871795, 'binary_recall': 0.16157205, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.27611938}
confusion matrix:
     0   1
0  227   2
1  192  37
early stop counter: 2
val acc:0.6499999761581421, best validation acc: 0.8269230723381042, corresponding to test acc:                         0.8427947759628296 / 0.8427947759628296
after epoch: 3,now: 2024-07-26 03:48:12.553826,epoch time: 0:02:44.938609,used: 0:08:16.325617,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96223956, 'precision': 0.96298647, 'recall': 0.9619658, 'specificity': 0.9619658, 'f1': 0.96219957, 'auroc': 0.99529994, 'binary_precision': 0.9478908, 'binary_recall': 0.9794872, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.96343005}
confusion matrix:
      0     1
0  1428    84
1    32  1528
---- Validation: 
scalar performance:
{'acc': 0.6676923, 'precision': 0.7197729, 'recall': 0.6638495, 'specificity': 0.6638495, 'f1': 0.6435997, 'auroc': 0.8293016, 'binary_precision': 0.82298136, 'binary_recall': 0.4140625, 'binary_specificity': 0.9136364, 'binary_f1_score': 0.55093557}
confusion matrix:
     0    1
0  603   57
1  375  265
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73580784, 'precision': 0.7848259, 'recall': 0.7358079, 'specificity': 0.7358079, 'f1': 0.7239301, 'auroc': 0.8904674, 'binary_precision': 0.9029851, 'binary_recall': 0.52838427, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  216   13
1  108  121
early stop counter: 3
val acc:0.6676923036575317, best validation acc: 0.8269230723381042, corresponding to test acc:                         0.8427947759628296 / 0.8427947759628296
after epoch: 4,now: 2024-07-26 03:50:57.590634,epoch time: 0:02:45.036808,used: 0:11:01.362425,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98401934, 'recall': 0.9840914, 'specificity': 0.9840914, 'f1': 0.9840469, 'auroc': 0.99812984, 'binary_precision': 0.9871051, 'binary_recall': 0.98141026, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9842494}
confusion matrix:
      0     1
0  1492    20
1    29  1531
---- Validation: 
scalar performance:
{'acc': 0.79923075, 'precision': 0.8214934, 'recall': 0.7971828, 'specificity': 0.7971828, 'f1': 0.7948955, 'auroc': 0.89912164, 'binary_precision': 0.90233546, 'binary_recall': 0.6640625, 'binary_specificity': 0.93030304, 'binary_f1_score': 0.7650766}
confusion matrix:
     0    1
0  614   46
1  215  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8427948, 'precision': 0.87183785, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8396639, 'auroc': 0.9173357, 'binary_precision': 0.9757576, 'binary_recall': 0.70305675, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.8172589}
confusion matrix:
     0    1
0  225    4
1   68  161
early stop counter: 4
val acc:0.7992307543754578, best validation acc: 0.8269230723381042, corresponding to test acc:                         0.8427947759628296 / 0.8427947759628296
after epoch: 5,now: 2024-07-26 03:53:42.168745,epoch time: 0:02:44.578111,used: 0:13:45.940536,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97831047, 'recall': 0.97816443, 'specificity': 0.97816443, 'f1': 0.97786427, 'auroc': 0.99817526, 'binary_precision': 0.99733335, 'binary_recall': 0.95897436, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9777778}
confusion matrix:
      0     1
0  1508     4
1    64  1496
---- Validation: 
scalar performance:
{'acc': 0.57, 'precision': 0.7215543, 'recall': 0.563518, 'specificity': 0.563518, 'f1': 0.47245735, 'auroc': 0.837039, 'binary_precision': 0.9009901, 'binary_recall': 0.1421875, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.24561407}
confusion matrix:
     0   1
0  650  10
1  549  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.510917, 'precision': 0.75275934, 'recall': 0.510917, 'specificity': 0.510917, 'f1': 0.35714465, 'auroc': 0.8641807, 'binary_precision': 1.0, 'binary_recall': 0.02183406, 'binary_specificity': 1.0, 'binary_f1_score': 0.042735044}
confusion matrix:
     0  1
0  229  0
1  224  5
early stop counter: 5
val acc:0.5699999928474426, best validation acc: 0.8269230723381042, corresponding to test acc:                         0.8427947759628296 / 0.8427947759628296
after epoch: 6,now: 2024-07-26 03:56:26.904291,epoch time: 0:02:44.735546,used: 0:16:30.676082,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_56_seed_7_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:16:30.676082 at 2024-07-26 03:56:26.904291
persisted model performance metric: 

scalar performance:
{'acc': 0.8427948, 'precision': 0.8599547, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8408986, 'auroc': 0.9251921, 'binary_precision': 0.9385475, 'binary_recall': 0.73362446, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  218   11
1   61  168
oracle model performance metric: 

scalar performance:
{'acc': 0.8427948, 'precision': 0.8599547, 'recall': 0.8427948, 'specificity': 0.8427948, 'f1': 0.8408986, 'auroc': 0.9251921, 'binary_precision': 0.9385475, 'binary_recall': 0.73362446, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  218   11
1   61  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1989 MiB |   8590 MiB | 524889 GiB | 524887 GiB |
|       from large pool |   1898 MiB |   8514 MiB | 520304 GiB | 520303 GiB |
|       from small pool |     91 MiB |    132 MiB |   4584 GiB |   4584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1989 MiB |   8590 MiB | 524889 GiB | 524887 GiB |
|       from large pool |   1898 MiB |   8514 MiB | 520304 GiB | 520303 GiB |
|       from small pool |     91 MiB |    132 MiB |   4584 GiB |   4584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 524172 GiB | 524170 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 519594 GiB | 519592 GiB |
|       from small pool |     91 MiB |    132 MiB |   4577 GiB |   4577 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9558 MiB |   9644 MiB |  54466 MiB |  44908 MiB |
|       from large pool |   9422 MiB |   9508 MiB |  54076 MiB |  44654 MiB |
|       from small pool |    136 MiB |    140 MiB |    390 MiB |    254 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    938 MiB |   1743 MiB | 386954 GiB | 386953 GiB |
|       from large pool |    931 MiB |   1729 MiB | 382238 GiB | 382237 GiB |
|       from small pool |      6 MiB |     56 MiB |   4716 GiB |   4716 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   73928 K  |   73925 K  |
|       from large pool |     382    |     808    |   37604 K  |   37604 K  |
|       from small pool |    2074    |    2766    |   36323 K  |   36321 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   73928 K  |   73925 K  |
|       from large pool |     382    |     808    |   37604 K  |   37604 K  |
|       from small pool |    2074    |    2766    |   36323 K  |   36321 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     289    |     328    |    1440    |    1151    |
|       from large pool |     221    |     260    |    1245    |    1024    |
|       from small pool |      68    |      70    |     195    |     127    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     137    |     315    |   40385 K  |   40385 K  |
|       from large pool |      71    |     251    |   22014 K  |   22014 K  |
|       from small pool |      66    |     229    |   18371 K  |   18371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 524889 GiB | 524889 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 520304 GiB | 520304 GiB |
|       from small pool |      0 KiB |    132 MiB |   4584 GiB |   4584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 524889 GiB | 524889 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 520304 GiB | 520304 GiB |
|       from small pool |      0 KiB |    132 MiB |   4584 GiB |   4584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 524172 GiB | 524172 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 519594 GiB | 519594 GiB |
|       from small pool |      0 KiB |    132 MiB |   4577 GiB |   4577 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2928 MiB |   9644 MiB |  54466 MiB |  51538 MiB |
|       from large pool |   2830 MiB |   9508 MiB |  54076 MiB |  51246 MiB |
|       from small pool |     98 MiB |    140 MiB |    390 MiB |    292 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 386955 GiB | 386955 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 382239 GiB | 382239 GiB |
|       from small pool |      0 KiB |     56 MiB |   4716 GiB |   4716 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   73928 K  |   73928 K  |
|       from large pool |       2    |     808    |   37604 K  |   37604 K  |
|       from small pool |       0    |    2766    |   36323 K  |   36323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   73928 K  |   73928 K  |
|       from large pool |       2    |     808    |   37604 K  |   37604 K  |
|       from small pool |       0    |    2766    |   36323 K  |   36323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     328    |    1440    |    1318    |
|       from large pool |      73    |     260    |    1245    |    1172    |
|       from small pool |      49    |      70    |     195    |     146    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   40386 K  |   40386 K  |
|       from large pool |       4    |     251    |   22014 K  |   22014 K  |
|       from small pool |       0    |     229    |   18371 K  |   18371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 524889 GiB | 524889 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 520304 GiB | 520304 GiB |
|       from small pool |      0 KiB |    132 MiB |   4584 GiB |   4584 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 524889 GiB | 524889 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 520304 GiB | 520304 GiB |
|       from small pool |      0 KiB |    132 MiB |   4584 GiB |   4584 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 524172 GiB | 524172 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 519594 GiB | 519594 GiB |
|       from small pool |      0 KiB |    132 MiB |   4577 GiB |   4577 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2928 MiB |   9644 MiB |  54466 MiB |  51538 MiB |
|       from large pool |   2830 MiB |   9508 MiB |  54076 MiB |  51246 MiB |
|       from small pool |     98 MiB |    140 MiB |    390 MiB |    292 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 386955 GiB | 386955 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 382239 GiB | 382239 GiB |
|       from small pool |      0 KiB |     56 MiB |   4716 GiB |   4716 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   73928 K  |   73928 K  |
|       from large pool |       2    |     808    |   37604 K  |   37604 K  |
|       from small pool |       0    |    2766    |   36323 K  |   36323 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   73928 K  |   73928 K  |
|       from large pool |       2    |     808    |   37604 K  |   37604 K  |
|       from small pool |       0    |    2766    |   36323 K  |   36323 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     328    |    1440    |    1318    |
|       from large pool |      73    |     260    |    1245    |    1172    |
|       from small pool |      49    |      70    |     195    |     146    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   40386 K  |   40386 K  |
|       from large pool |       4    |     251    |   22014 K  |   22014 K  |
|       from small pool |       0    |     229    |   18371 K  |   18371 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707

 Experiment start at: 2024-07-26 03:56:59.935602
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9519737, 'precision': 0.9542346, 'recall': 0.9515997, 'specificity': 0.9515997, 'f1': 0.9518802, 'auroc': 0.9958067, 'binary_precision': 0.92486256, 'binary_recall': 0.9850358, 'binary_specificity': 0.91816366, 'binary_f1_score': 0.9540013}
confusion matrix:
      0     1
0  1380   123
1    23  1514
---- Validation: 
scalar performance:
{'acc': 0.8275329, 'precision': 0.8389515, 'recall': 0.8304278, 'specificity': 0.8304278, 'f1': 0.8268019, 'auroc': 0.92699414, 'binary_precision': 0.76830894, 'binary_recall': 0.9217252, 'binary_specificity': 0.73913044, 'binary_f1_score': 0.8380537}
confusion matrix:
     0    1
0  493  174
1   49  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.81216305, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.81189096, 'auroc': 0.8896347, 'binary_precision': 0.8035714, 'binary_recall': 0.82568806, 'binary_specificity': 0.79816514, 'binary_f1_score': 0.8144796}
confusion matrix:
     0    1
0  174   44
1   38  180
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:59:44.017279,epoch time: 0:02:44.081677,used: 0:02:44.081677,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94375, 'precision': 0.9444431, 'recall': 0.9435356, 'specificity': 0.9435356, 'f1': 0.94370174, 'auroc': 0.9881359, 'binary_precision': 0.929604, 'binary_recall': 0.9616385, 'binary_specificity': 0.92543274, 'binary_f1_score': 0.94534993}
confusion matrix:
      0     1
0  1390   112
1    59  1479
---- Validation: 
scalar performance:
{'acc': 0.8205723, 'precision': 0.83877707, 'recall': 0.82422125, 'specificity': 0.82422125, 'f1': 0.8191416, 'auroc': 0.93794155, 'binary_precision': 0.75191814, 'binary_recall': 0.93929714, 'binary_specificity': 0.7091454, 'binary_f1_score': 0.8352273}
confusion matrix:
     0    1
0  473  194
1   38  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8784404, 'precision': 0.88348365, 'recall': 0.8784404, 'specificity': 0.8784404, 'f1': 0.87803936, 'auroc': 0.94560647, 'binary_precision': 0.92746115, 'binary_recall': 0.8211009, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.8710462}
confusion matrix:
     0    1
0  204   14
1   39  179
new oracle model saved
early stop counter: 1
val acc:0.8205723166465759, best validation acc: 0.8275328874588013, corresponding to test acc:                         0.8119266033172607 / 0.8784403800964355
after epoch: 2,now: 2024-07-26 04:02:28.088543,epoch time: 0:02:44.071264,used: 0:05:28.152941,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.9845872, 'recall': 0.9845022, 'specificity': 0.9845022, 'f1': 0.98453605, 'auroc': 0.99838233, 'binary_precision': 0.98190045, 'binary_recall': 0.9876463, 'binary_specificity': 0.9813582, 'binary_f1_score': 0.98476493}
confusion matrix:
      0     1
0  1474    28
1    19  1519
---- Validation: 
scalar performance:
{'acc': 0.84996134, 'precision': 0.8606677, 'recall': 0.84720814, 'specificity': 0.84720814, 'f1': 0.84799665, 'auroc': 0.9269031, 'binary_precision': 0.9153846, 'binary_recall': 0.76038337, 'binary_specificity': 0.934033, 'binary_f1_score': 0.83071554}
confusion matrix:
     0    1
0  623   44
1  150  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85779816, 'precision': 0.87938416, 'recall': 0.85779816, 'specificity': 0.85779816, 'f1': 0.85574627, 'auroc': 0.9141907, 'binary_precision': 0.9698795, 'binary_recall': 0.7385321, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.8385417}
confusion matrix:
     0    1
0  213    5
1   57  161
better model found
persisted
after epoch: 3,now: 2024-07-26 04:05:11.724580,epoch time: 0:02:43.636037,used: 0:08:11.788978,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9723684, 'precision': 0.97344077, 'recall': 0.9727013, 'specificity': 0.9727013, 'f1': 0.97236264, 'auroc': 0.99906373, 'binary_precision': 0.99931365, 'binary_recall': 0.9460689, 'binary_specificity': 0.9993338, 'binary_f1_score': 0.9719626}
confusion matrix:
      0     1
0  1500     1
1    83  1456
---- Validation: 
scalar performance:
{'acc': 0.6133024, 'precision': 0.76770234, 'recall': 0.60088444, 'specificity': 0.60088444, 'f1': 0.53485465, 'auroc': 0.9200152, 'binary_precision': 0.9632353, 'binary_recall': 0.20926517, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.34383202}
confusion matrix:
     0    1
0  662    5
1  495  131
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56880736, 'precision': 0.7684729, 'recall': 0.56880736, 'specificity': 0.56880736, 'f1': 0.47032672, 'auroc': 0.91618973, 'binary_precision': 1.0, 'binary_recall': 0.13761468, 'binary_specificity': 1.0, 'binary_f1_score': 0.24193548}
confusion matrix:
     0   1
0  218   0
1  188  30
early stop counter: 1
val acc:0.6133024096488953, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.857798159122467 / 0.8784403800964355
after epoch: 4,now: 2024-07-26 04:07:54.671900,epoch time: 0:02:42.947320,used: 0:10:54.736298,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98717105, 'precision': 0.987193, 'recall': 0.9871498, 'specificity': 0.9871498, 'f1': 0.98716867, 'auroc': 0.9991247, 'binary_precision': 0.98574203, 'binary_recall': 0.9889467, 'binary_specificity': 0.9853529, 'binary_f1_score': 0.9873417}
confusion matrix:
      0     1
0  1480    22
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.7811292, 'precision': 0.81748104, 'recall': 0.77563095, 'specificity': 0.77563095, 'f1': 0.7721994, 'auroc': 0.90337014, 'binary_precision': 0.91727495, 'binary_recall': 0.60223645, 'binary_specificity': 0.9490255, 'binary_f1_score': 0.72709733}
confusion matrix:
     0    1
0  633   34
1  249  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.83284354, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.80088866, 'auroc': 0.9014814, 'binary_precision': 0.92903227, 'binary_recall': 0.6605505, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.77211803}
confusion matrix:
     0    1
0  207   11
1   74  144
early stop counter: 2
val acc:0.7811291813850403, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.857798159122467 / 0.8784403800964355
after epoch: 5,now: 2024-07-26 04:10:37.586496,epoch time: 0:02:42.914596,used: 0:13:37.650894,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.98821795, 'recall': 0.9882653, 'specificity': 0.9882653, 'f1': 0.9881578, 'auroc': 0.999184, 'binary_precision': 0.997351, 'binary_recall': 0.97919375, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.988189}
confusion matrix:
      0     1
0  1498     4
1    32  1506
---- Validation: 
scalar performance:
{'acc': 0.8066512, 'precision': 0.8464868, 'recall': 0.80120325, 'specificity': 0.80120325, 'f1': 0.79882675, 'auroc': 0.93327856, 'binary_precision': 0.9563107, 'binary_recall': 0.629393, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.75915223}
confusion matrix:
     0    1
0  649   18
1  232  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7522936, 'precision': 0.82300645, 'recall': 0.7522936, 'specificity': 0.7522936, 'f1': 0.73795164, 'auroc': 0.8831959, 'binary_precision': 0.9741379, 'binary_recall': 0.51834863, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.67664677}
confusion matrix:
     0    1
0  215    3
1  105  113
early stop counter: 3
val acc:0.8066511750221252, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.857798159122467 / 0.8784403800964355
after epoch: 6,now: 2024-07-26 04:13:20.636734,epoch time: 0:02:43.050238,used: 0:16:20.701132,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98092103, 'precision': 0.9812254, 'recall': 0.9811053, 'specificity': 0.9811053, 'f1': 0.9809208, 'auroc': 0.998194, 'binary_precision': 0.9966443, 'binary_recall': 0.96553963, 'binary_specificity': 0.9966711, 'binary_f1_score': 0.98084545}
confusion matrix:
      0     1
0  1497     5
1    53  1485
---- Validation: 
scalar performance:
{'acc': 0.68213457, 'precision': 0.7821458, 'recall': 0.67241263, 'specificity': 0.67241263, 'f1': 0.6438358, 'auroc': 0.85923696, 'binary_precision': 0.9423868, 'binary_recall': 0.3658147, 'binary_specificity': 0.9790105, 'binary_f1_score': 0.5270425}
confusion matrix:
     0    1
0  653   14
1  397  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6857798, 'precision': 0.79592764, 'recall': 0.6857798, 'specificity': 0.6857798, 'f1': 0.65354073, 'auroc': 0.8821858, 'binary_precision': 0.9764706, 'binary_recall': 0.38073394, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.5478547}
confusion matrix:
     0   1
0  216   2
1  135  83
early stop counter: 4
val acc:0.6821345686912537, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.857798159122467 / 0.8784403800964355
after epoch: 7,now: 2024-07-26 04:16:03.437499,epoch time: 0:02:42.800765,used: 0:19:03.501897,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9825653, 'recall': 0.9817362, 'specificity': 0.9817362, 'f1': 0.9818951, 'auroc': 0.99959093, 'binary_precision': 0.9671924, 'binary_recall': 0.9980469, 'binary_specificity': 0.96542555, 'binary_f1_score': 0.9823774}
confusion matrix:
      0     1
0  1452    52
1     3  1533
---- Validation: 
scalar performance:
{'acc': 0.82985306, 'precision': 0.82994854, 'recall': 0.830271, 'specificity': 0.830271, 'f1': 0.8298236, 'auroc': 0.9015285, 'binary_precision': 0.8123077, 'binary_recall': 0.8434505, 'binary_specificity': 0.81709146, 'binary_f1_score': 0.82758623}
confusion matrix:
     0    1
0  545  122
1   98  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8353139, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8348068, 'auroc': 0.8888141, 'binary_precision': 0.82300884, 'binary_recall': 0.853211, 'binary_specificity': 0.8165138, 'binary_f1_score': 0.8378378}
confusion matrix:
     0    1
0  178   40
1   32  186
early stop counter: 5
val acc:0.8298530578613281, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.857798159122467 / 0.8784403800964355
after epoch: 8,now: 2024-07-26 04:18:46.346202,epoch time: 0:02:42.908703,used: 0:21:46.410600,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_56_59_seed_8_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:21:46.410600 at 2024-07-26 04:18:46.346202
persisted model performance metric: 

scalar performance:
{'acc': 0.85779816, 'precision': 0.87938416, 'recall': 0.85779816, 'specificity': 0.85779816, 'f1': 0.85574627, 'auroc': 0.9141907, 'binary_precision': 0.9698795, 'binary_recall': 0.7385321, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.8385417}
confusion matrix:
     0    1
0  213    5
1   57  161
oracle model performance metric: 

scalar performance:
{'acc': 0.8784404, 'precision': 0.88348365, 'recall': 0.8784404, 'specificity': 0.8784404, 'f1': 0.87803936, 'auroc': 0.94560647, 'binary_precision': 0.92746115, 'binary_recall': 0.8211009, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.8710462}
confusion matrix:
     0    1
0  204   14
1   39  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1987 MiB |   8590 MiB | 577539 GiB | 577537 GiB |
|       from large pool |   1896 MiB |   8514 MiB | 572494 GiB | 572492 GiB |
|       from small pool |     91 MiB |    132 MiB |   5044 GiB |   5044 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1987 MiB |   8590 MiB | 577539 GiB | 577537 GiB |
|       from large pool |   1896 MiB |   8514 MiB | 572494 GiB | 572492 GiB |
|       from small pool |     91 MiB |    132 MiB |   5044 GiB |   5044 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 576778 GiB | 576776 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 571741 GiB | 571739 GiB |
|       from small pool |     91 MiB |    132 MiB |   5037 GiB |   5037 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9558 MiB |   9644 MiB |  61096 MiB |  51538 MiB |
|       from large pool |   9422 MiB |   9508 MiB |  60668 MiB |  51246 MiB |
|       from small pool |    136 MiB |    140 MiB |    428 MiB |    292 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1014 MiB |   1743 MiB | 426430 GiB | 426429 GiB |
|       from large pool |   1007 MiB |   1729 MiB | 421240 GiB | 421239 GiB |
|       from small pool |      6 MiB |     56 MiB |   5189 GiB |   5189 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2450    |    3301    |   81353 K  |   81351 K  |
|       from large pool |     382    |     808    |   41380 K  |   41380 K  |
|       from small pool |    2068    |    2766    |   39973 K  |   39971 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2450    |    3301    |   81353 K  |   81351 K  |
|       from large pool |     382    |     808    |   41380 K  |   41380 K  |
|       from small pool |    2068    |    2766    |   39973 K  |   39971 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     291    |     328    |    1609    |    1318    |
|       from large pool |     223    |     260    |    1395    |    1172    |
|       from small pool |      68    |      70    |     214    |     146    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     137    |     315    |   44514 K  |   44514 K  |
|       from large pool |      74    |     251    |   24311 K  |   24311 K  |
|       from small pool |      63    |     229    |   20202 K  |   20202 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 577539 GiB | 577539 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 572494 GiB | 572494 GiB |
|       from small pool |      0 KiB |    132 MiB |   5044 GiB |   5044 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 577539 GiB | 577539 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 572494 GiB | 572494 GiB |
|       from small pool |      0 KiB |    132 MiB |   5044 GiB |   5044 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 576778 GiB | 576778 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 571741 GiB | 571741 GiB |
|       from small pool |      0 KiB |    132 MiB |   5037 GiB |   5037 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3002 MiB |   9644 MiB |  61096 MiB |  58094 MiB |
|       from large pool |   2904 MiB |   9508 MiB |  60668 MiB |  57764 MiB |
|       from small pool |     98 MiB |    140 MiB |    428 MiB |    330 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 426431 GiB | 426431 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 421241 GiB | 421241 GiB |
|       from small pool |      0 KiB |     56 MiB |   5189 GiB |   5189 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   81353 K  |   81353 K  |
|       from large pool |       2    |     808    |   41380 K  |   41380 K  |
|       from small pool |       0    |    2766    |   39973 K  |   39973 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   81353 K  |   81353 K  |
|       from large pool |       2    |     808    |   41380 K  |   41380 K  |
|       from small pool |       0    |    2766    |   39973 K  |   39973 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     328    |    1609    |    1489    |
|       from large pool |      71    |     260    |    1395    |    1324    |
|       from small pool |      49    |      70    |     214    |     165    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   44514 K  |   44514 K  |
|       from large pool |       4    |     251    |   24311 K  |   24311 K  |
|       from small pool |       0    |     229    |   20203 K  |   20203 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 577539 GiB | 577539 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 572494 GiB | 572494 GiB |
|       from small pool |      0 KiB |    132 MiB |   5044 GiB |   5044 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 577539 GiB | 577539 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 572494 GiB | 572494 GiB |
|       from small pool |      0 KiB |    132 MiB |   5044 GiB |   5044 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 576778 GiB | 576778 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 571741 GiB | 571741 GiB |
|       from small pool |      0 KiB |    132 MiB |   5037 GiB |   5037 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3002 MiB |   9644 MiB |  61096 MiB |  58094 MiB |
|       from large pool |   2904 MiB |   9508 MiB |  60668 MiB |  57764 MiB |
|       from small pool |     98 MiB |    140 MiB |    428 MiB |    330 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 426431 GiB | 426431 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 421241 GiB | 421241 GiB |
|       from small pool |      0 KiB |     56 MiB |   5189 GiB |   5189 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   81353 K  |   81353 K  |
|       from large pool |       2    |     808    |   41380 K  |   41380 K  |
|       from small pool |       0    |    2766    |   39973 K  |   39973 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   81353 K  |   81353 K  |
|       from large pool |       2    |     808    |   41380 K  |   41380 K  |
|       from small pool |       0    |    2766    |   39973 K  |   39973 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     328    |    1609    |    1489    |
|       from large pool |      71    |     260    |    1395    |    1324    |
|       from small pool |      49    |      70    |     214    |     165    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   44514 K  |   44514 K  |
|       from large pool |       4    |     251    |   24311 K  |   24311 K  |
|       from small pool |       0    |     229    |   20203 K  |   20203 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707

 Experiment start at: 2024-07-26 04:19:21.469321
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94600785, 'precision': 0.950374, 'recall': 0.94633746, 'specificity': 0.94633746, 'f1': 0.9459022, 'auroc': 0.99400485, 'binary_precision': 0.9963847, 'binary_recall': 0.8959688, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9435125}
confusion matrix:
      0     1
0  1513     5
1   160  1378
---- Validation: 
scalar performance:
{'acc': 0.6262548, 'precision': 0.7304542, 'recall': 0.622837, 'specificity': 0.622837, 'f1': 0.5751865, 'auroc': 0.8564433, 'binary_precision': 0.8829268, 'binary_recall': 0.28237128, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.42789596}
confusion matrix:
     0    1
0  630   24
1  460  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6347826, 'precision': 0.70404077, 'recall': 0.6347826, 'specificity': 0.6347826, 'f1': 0.6009171, 'auroc': 0.84517485, 'binary_precision': 0.8229167, 'binary_recall': 0.34347826, 'binary_specificity': 0.92608696, 'binary_f1_score': 0.48466256}
confusion matrix:
     0   1
0  213  17
1  151  79
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:22:07.575161,epoch time: 0:02:46.105840,used: 0:02:46.105840,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9741492, 'precision': 0.9743667, 'recall': 0.9742479, 'specificity': 0.9742479, 'f1': 0.97414863, 'auroc': 0.9972458, 'binary_precision': 0.98667556, 'binary_recall': 0.96168834, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9740217}
confusion matrix:
      0     1
0  1496    20
1    59  1481
---- Validation: 
scalar performance:
{'acc': 0.83088803, 'precision': 0.83259284, 'recall': 0.8305221, 'specificity': 0.8305221, 'f1': 0.8305481, 'auroc': 0.90856457, 'binary_precision': 0.85402685, 'binary_recall': 0.79407173, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.82295877}
confusion matrix:
     0    1
0  567   87
1  132  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82173914, 'precision': 0.83076805, 'recall': 0.82173914, 'specificity': 0.82173914, 'f1': 0.8205143, 'auroc': 0.90102077, 'binary_precision': 0.8854167, 'binary_recall': 0.73913044, 'binary_specificity': 0.90434784, 'binary_f1_score': 0.80568725}
confusion matrix:
     0    1
0  208   22
1   60  170
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:24:53.046536,epoch time: 0:02:45.471375,used: 0:05:31.577215,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9741532, 'recall': 0.9737438, 'specificity': 0.9737438, 'f1': 0.9738132, 'auroc': 0.9976468, 'binary_precision': 0.9631512, 'binary_recall': 0.9856957, 'binary_specificity': 0.9617918, 'binary_f1_score': 0.97429305}
confusion matrix:
      0     1
0  1460    58
1    22  1516
---- Validation: 
scalar performance:
{'acc': 0.82239383, 'precision': 0.8339139, 'recall': 0.82332176, 'specificity': 0.82332176, 'f1': 0.82112664, 'auroc': 0.9182714, 'binary_precision': 0.7693316, 'binary_recall': 0.91575664, 'binary_specificity': 0.7308869, 'binary_f1_score': 0.8361824}
confusion matrix:
     0    1
0  478  176
1   54  587
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8062674, 'recall': 0.79347825, 'specificity': 0.79347825, 'f1': 0.7912995, 'auroc': 0.90752363, 'binary_precision': 0.7436823, 'binary_recall': 0.8956522, 'binary_specificity': 0.6913043, 'binary_f1_score': 0.8126233}
confusion matrix:
     0    1
0  159   71
1   24  206
early stop counter: 1
val acc:0.8223938345909119, best validation acc: 0.830888032913208, corresponding to test acc:                         0.821739137172699 / 0.821739137172699
after epoch: 3,now: 2024-07-26 04:27:36.924209,epoch time: 0:02:43.877673,used: 0:08:15.454888,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9836557, 'recall': 0.9836756, 'specificity': 0.9836756, 'f1': 0.98363876, 'auroc': 0.99729896, 'binary_precision': 0.98883784, 'binary_recall': 0.9785575, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9836709}
confusion matrix:
      0     1
0  1500    17
1    33  1506
---- Validation: 
scalar performance:
{'acc': 0.83088803, 'precision': 0.8348555, 'recall': 0.83033603, 'specificity': 0.83033603, 'f1': 0.8302072, 'auroc': 0.8961103, 'binary_precision': 0.8688811, 'binary_recall': 0.775351, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.8194559}
confusion matrix:
     0    1
0  579   75
1  144  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8173913, 'precision': 0.83590746, 'recall': 0.8173913, 'specificity': 0.8173913, 'f1': 0.8148396, 'auroc': 0.899603, 'binary_precision': 0.91477275, 'binary_recall': 0.7, 'binary_specificity': 0.9347826, 'binary_f1_score': 0.79310346}
confusion matrix:
     0    1
0  215   15
1   69  161
early stop counter: 2
val acc:0.830888032913208, best validation acc: 0.830888032913208, corresponding to test acc:                         0.821739137172699 / 0.821739137172699
after epoch: 4,now: 2024-07-26 04:30:20.718984,epoch time: 0:02:43.794775,used: 0:10:59.249663,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98310626, 'recall': 0.98294073, 'specificity': 0.98294073, 'f1': 0.98298144, 'auroc': 0.99862206, 'binary_precision': 0.9768934, 'binary_recall': 0.9895969, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.9832042}
confusion matrix:
      0     1
0  1482    36
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.83243245, 'precision': 0.833196, 'recall': 0.8326714, 'specificity': 0.8326714, 'f1': 0.8323925, 'auroc': 0.90467393, 'binary_precision': 0.8145401, 'binary_recall': 0.8564743, 'binary_specificity': 0.8088685, 'binary_f1_score': 0.834981}
confusion matrix:
     0    1
0  529  125
1   92  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7782609, 'precision': 0.7878598, 'recall': 0.7782608, 'specificity': 0.7782608, 'f1': 0.77639675, 'auroc': 0.8814367, 'binary_precision': 0.7352941, 'binary_recall': 0.8695652, 'binary_specificity': 0.6869565, 'binary_f1_score': 0.7968127}
confusion matrix:
     0    1
0  158   72
1   30  200
better model found
persisted
after epoch: 5,now: 2024-07-26 04:33:05.314496,epoch time: 0:02:44.595512,used: 0:13:43.845175,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9802888, 'recall': 0.9798354, 'specificity': 0.9798354, 'f1': 0.9797089, 'auroc': 0.9980658, 'binary_precision': 0.99864864, 'binary_recall': 0.9609883, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.97945654}
confusion matrix:
      0     1
0  1516     2
1    60  1478
---- Validation: 
scalar performance:
{'acc': 0.6888031, 'precision': 0.7578924, 'recall': 0.68617463, 'specificity': 0.68617463, 'f1': 0.6645813, 'auroc': 0.8466028, 'binary_precision': 0.8888889, 'binary_recall': 0.42433697, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.5744456}
confusion matrix:
     0    1
0  620   34
1  369  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65, 'precision': 0.7489412, 'recall': 0.65, 'specificity': 0.65, 'f1': 0.6113866, 'auroc': 0.842552, 'binary_precision': 0.90588236, 'binary_recall': 0.3347826, 'binary_specificity': 0.9652174, 'binary_f1_score': 0.4888889}
confusion matrix:
     0   1
0  222   8
1  153  77
early stop counter: 1
val acc:0.6888030767440796, best validation acc: 0.8324324488639832, corresponding to test acc:                         0.7782608866691589 / 0.821739137172699
after epoch: 6,now: 2024-07-26 04:35:49.268593,epoch time: 0:02:43.954097,used: 0:16:27.799272,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9872316, 'recall': 0.9872494, 'specificity': 0.9872494, 'f1': 0.9872378, 'auroc': 0.99863154, 'binary_precision': 0.9889179, 'binary_recall': 0.985705, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1500    17
1    22  1517
---- Validation: 
scalar performance:
{'acc': 0.827027, 'precision': 0.8322866, 'recall': 0.8263894, 'specificity': 0.8263894, 'f1': 0.8261303, 'auroc': 0.90200233, 'binary_precision': 0.8716577, 'binary_recall': 0.7628705, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.8136439}
confusion matrix:
     0    1
0  582   72
1  152  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82173914, 'precision': 0.8487419, 'recall': 0.82173914, 'specificity': 0.82173914, 'f1': 0.8182204, 'auroc': 0.9072968, 'binary_precision': 0.94578314, 'binary_recall': 0.6826087, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.79292935}
confusion matrix:
     0    1
0  221    9
1   73  157
early stop counter: 2
val acc:0.8270270228385925, best validation acc: 0.8324324488639832, corresponding to test acc:                         0.7782608866691589 / 0.821739137172699
after epoch: 7,now: 2024-07-26 04:38:33.375318,epoch time: 0:02:44.106725,used: 0:19:11.905997,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.9889749, 'recall': 0.98893976, 'specificity': 0.98893976, 'f1': 0.9888743, 'auroc': 0.9993348, 'binary_precision': 0.99801457, 'binary_recall': 0.979857, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98885244}
confusion matrix:
      0     1
0  1514     3
1    31  1508
---- Validation: 
scalar performance:
{'acc': 0.6942085, 'precision': 0.7032088, 'recall': 0.69310784, 'specificity': 0.69310784, 'f1': 0.6899936, 'auroc': 0.8115664, 'binary_precision': 0.7435388, 'binary_recall': 0.5834633, 'binary_specificity': 0.8027523, 'binary_f1_score': 0.6538462}
confusion matrix:
     0    1
0  525  129
1  267  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76521736, 'precision': 0.7718781, 'recall': 0.7652174, 'specificity': 0.7652174, 'f1': 0.7637706, 'auroc': 0.7255198, 'binary_precision': 0.7293233, 'binary_recall': 0.84347826, 'binary_specificity': 0.6869565, 'binary_f1_score': 0.7822581}
confusion matrix:
     0    1
0  158   72
1   36  194
early stop counter: 3
val acc:0.6942085027694702, best validation acc: 0.8324324488639832, corresponding to test acc:                         0.7782608866691589 / 0.821739137172699
after epoch: 8,now: 2024-07-26 04:41:17.177002,epoch time: 0:02:43.801684,used: 0:21:55.707681,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.97730684, 'recall': 0.97718257, 'specificity': 0.97718257, 'f1': 0.9770936, 'auroc': 0.9958465, 'binary_precision': 0.9893404, 'binary_recall': 0.9649123, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9769737}
confusion matrix:
      0     1
0  1501    16
1    54  1485
---- Validation: 
scalar performance:
{'acc': 0.7482625, 'precision': 0.7921146, 'recall': 0.746299, 'specificity': 0.746299, 'f1': 0.73743296, 'auroc': 0.8547001, 'binary_precision': 0.9028133, 'binary_recall': 0.55070204, 'binary_specificity': 0.941896, 'binary_f1_score': 0.68410856}
confusion matrix:
     0    1
0  616   38
1  288  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71304345, 'precision': 0.7458337, 'recall': 0.71304345, 'specificity': 0.71304345, 'f1': 0.70314455, 'auroc': 0.82126653, 'binary_precision': 0.8356164, 'binary_recall': 0.5304348, 'binary_specificity': 0.8956522, 'binary_f1_score': 0.64893615}
confusion matrix:
     0    1
0  206   24
1  108  122
early stop counter: 4
val acc:0.7482625246047974, best validation acc: 0.8324324488639832, corresponding to test acc:                         0.7782608866691589 / 0.821739137172699
after epoch: 9,now: 2024-07-26 04:44:01.121705,epoch time: 0:02:43.944703,used: 0:24:39.652384,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9848696, 'recall': 0.9847249, 'specificity': 0.9847249, 'f1': 0.98462, 'auroc': 0.9981072, 'binary_precision': 0.99799865, 'binary_recall': 0.9714286, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9845344}
confusion matrix:
      0     1
0  1513     3
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.5837838, 'precision': 0.69967926, 'recall': 0.5799043, 'specificity': 0.5799043, 'f1': 0.5080873, 'auroc': 0.8608897, 'binary_precision': 0.84931505, 'binary_recall': 0.19344774, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.31512073}
confusion matrix:
     0    1
0  632   22
1  517  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48913044, 'precision': 0.44279176, 'recall': 0.48913044, 'specificity': 0.48913044, 'f1': 0.3594112, 'auroc': 0.8366777, 'binary_precision': 0.39130434, 'binary_recall': 0.039130434, 'binary_specificity': 0.9391304, 'binary_f1_score': 0.07114625}
confusion matrix:
     0   1
0  216  14
1  221   9
early stop counter: 5
val acc:0.5837838053703308, best validation acc: 0.8324324488639832, corresponding to test acc:                         0.7782608866691589 / 0.821739137172699
after epoch: 10,now: 2024-07-26 04:46:45.230871,epoch time: 0:02:44.109166,used: 0:27:23.761550,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_19_21_seed_9_23064707
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:27:23.761550 at 2024-07-26 04:46:45.230871
persisted model performance metric: 

scalar performance:
{'acc': 0.7782609, 'precision': 0.7878598, 'recall': 0.7782608, 'specificity': 0.7782608, 'f1': 0.77639675, 'auroc': 0.8814367, 'binary_precision': 0.7352941, 'binary_recall': 0.8695652, 'binary_specificity': 0.6869565, 'binary_f1_score': 0.7968127}
confusion matrix:
     0    1
0  158   72
1   30  200
oracle model performance metric: 

scalar performance:
{'acc': 0.82173914, 'precision': 0.83076805, 'recall': 0.82173914, 'specificity': 0.82173914, 'f1': 0.8205143, 'auroc': 0.90102077, 'binary_precision': 0.8854167, 'binary_recall': 0.73913044, 'binary_specificity': 0.90434784, 'binary_f1_score': 0.80568725}
confusion matrix:
     0    1
0  208   22
1   60  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/7.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/7.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1989 MiB |   8590 MiB | 643778 GiB | 643776 GiB |
|       from large pool |   1897 MiB |   8514 MiB | 638155 GiB | 638153 GiB |
|       from small pool |     91 MiB |    132 MiB |   5622 GiB |   5622 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1989 MiB |   8590 MiB | 643778 GiB | 643776 GiB |
|       from large pool |   1897 MiB |   8514 MiB | 638155 GiB | 638153 GiB |
|       from small pool |     91 MiB |    132 MiB |   5622 GiB |   5622 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1972 MiB |   8579 MiB | 642881 GiB | 642879 GiB |
|       from large pool |   1881 MiB |   8503 MiB | 637266 GiB | 637264 GiB |
|       from small pool |     91 MiB |    132 MiB |   5614 GiB |   5614 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9554 MiB |   9644 MiB |  67648 MiB |  58094 MiB |
|       from large pool |   9418 MiB |   9508 MiB |  67182 MiB |  57764 MiB |
|       from small pool |    136 MiB |    140 MiB |    466 MiB |    330 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1258 MiB |   1743 MiB | 478050 GiB | 478048 GiB |
|       from large pool |   1252 MiB |   1729 MiB | 472265 GiB | 472264 GiB |
|       from small pool |      6 MiB |     56 MiB |   5784 GiB |   5784 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   90678 K  |   90675 K  |
|       from large pool |     382    |     808    |   46123 K  |   46122 K  |
|       from small pool |    2074    |    2766    |   44554 K  |   44552 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   90678 K  |   90675 K  |
|       from large pool |     382    |     808    |   46123 K  |   46122 K  |
|       from small pool |    2074    |    2766    |   44554 K  |   44552 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     328    |    1775    |    1489    |
|       from large pool |     218    |     260    |    1542    |    1324    |
|       from small pool |      68    |      70    |     233    |     165    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     134    |     315    |   49575 K  |   49575 K  |
|       from large pool |      72    |     251    |   27062 K  |   27061 K  |
|       from small pool |      62    |     229    |   22513 K  |   22513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8590 MiB | 643778 GiB | 643778 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 638155 GiB | 638155 GiB |
|       from small pool |      0 KiB |    132 MiB |   5622 GiB |   5622 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8590 MiB | 643778 GiB | 643778 GiB |
|       from large pool |  16640 KiB |   8514 MiB | 638155 GiB | 638155 GiB |
|       from small pool |      0 KiB |    132 MiB |   5622 GiB |   5622 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8579 MiB | 642881 GiB | 642881 GiB |
|       from large pool |  16640 KiB |   8503 MiB | 637266 GiB | 637266 GiB |
|       from small pool |      0 KiB |    132 MiB |   5614 GiB |   5614 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3248 MiB |   9644 MiB |  67648 MiB |  64400 MiB |
|       from large pool |   3150 MiB |   9508 MiB |  67182 MiB |  64032 MiB |
|       from small pool |     98 MiB |    140 MiB |    466 MiB |    368 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1743 MiB | 478050 GiB | 478050 GiB |
|       from large pool |  24320 KiB |   1729 MiB | 472266 GiB | 472266 GiB |
|       from small pool |      0 KiB |     56 MiB |   5784 GiB |   5784 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   90678 K  |   90678 K  |
|       from large pool |       2    |     808    |   46123 K  |   46123 K  |
|       from small pool |       0    |    2766    |   44554 K  |   44554 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   90678 K  |   90678 K  |
|       from large pool |       2    |     808    |   46123 K  |   46123 K  |
|       from small pool |       0    |    2766    |   44554 K  |   44554 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     328    |    1775    |    1654    |
|       from large pool |      72    |     260    |    1542    |    1470    |
|       from small pool |      49    |      70    |     233    |     184    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     315    |   49575 K  |   49575 K  |
|       from large pool |       4    |     251    |   27062 K  |   27062 K  |
|       from small pool |       0    |     229    |   22513 K  |   22513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 04:46:56 2024]
Finished job 0.
1 of 1 steps (100%) done
