Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:13:12 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693

 Experiment start at: 2024-07-26 00:13:54.486098
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.9232203, 'recall': 0.91499174, 'specificity': 0.91499174, 'f1': 0.91371125, 'auroc': 0.9761405, 'binary_precision': 0.98864496, 'binary_recall': 0.8398714, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.9082058}
confusion matrix:
      0     1
0  1502    15
1   249  1306
---- Validation: 
scalar performance:
{'acc': 0.7958075, 'precision': 0.79631025, 'recall': 0.79608226, 'specificity': 0.79608226, 'f1': 0.7957926, 'auroc': 0.8688621, 'binary_precision': 0.7801205, 'binary_recall': 0.81574804, 'binary_specificity': 0.77641654, 'binary_f1_score': 0.79753655}
confusion matrix:
     0    1
0  507  146
1  117  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8168342, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8161986, 'auroc': 0.8572201, 'binary_precision': 0.8300971, 'binary_recall': 0.7953488, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8123516}
confusion matrix:
     0    1
0  180   35
1   44  171
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:16:08.833260,epoch time: 0:02:14.347162,used: 0:02:14.347162,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9423828, 'precision': 0.9450431, 'recall': 0.9418142, 'specificity': 0.9418142, 'f1': 0.94223195, 'auroc': 0.9935359, 'binary_precision': 0.91431993, 'binary_recall': 0.97820514, 'binary_specificity': 0.9054233, 'binary_f1_score': 0.9451843}
confusion matrix:
      0     1
0  1369   143
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.7989768, 'recall': 0.7738216, 'specificity': 0.7738216, 'f1': 0.76729476, 'auroc': 0.90267575, 'binary_precision': 0.7051745, 'binary_recall': 0.92283463, 'binary_specificity': 0.62480855, 'binary_f1_score': 0.79945433}
confusion matrix:
     0    1
0  408  245
1   49  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.7964699, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7896739, 'auroc': 0.8954624, 'binary_precision': 0.75510204, 'binary_recall': 0.8604651, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.8043478}
confusion matrix:
     0    1
0  155   60
1   30  185
early stop counter: 1
val acc:0.77173912525177, best validation acc: 0.7958074808120728, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 2,now: 2024-07-26 00:17:55.983679,epoch time: 0:01:47.150419,used: 0:04:01.497581,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93684894, 'precision': 0.9411833, 'recall': 0.9362278, 'specificity': 0.9362278, 'f1': 0.93662155, 'auroc': 0.9955026, 'binary_precision': 0.9005882, 'binary_recall': 0.98393315, 'binary_specificity': 0.88852245, 'binary_f1_score': 0.94041765}
confusion matrix:
      0     1
0  1347   169
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.7534936, 'recall': 0.61619055, 'specificity': 0.61619055, 'f1': 0.5527278, 'auroc': 0.8848326, 'binary_precision': 0.5599284, 'binary_recall': 0.9858268, 'binary_specificity': 0.24655436, 'binary_f1_score': 0.7142042}
confusion matrix:
     0    1
0  161  492
1    9  626
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69302326, 'precision': 0.784691, 'recall': 0.69302326, 'specificity': 0.69302326, 'f1': 0.66614914, 'auroc': 0.9118496, 'binary_precision': 0.6231454, 'binary_recall': 0.9767442, 'binary_specificity': 0.40930232, 'binary_f1_score': 0.7608696}
confusion matrix:
    0    1
0  88  127
1   5  210
early stop counter: 2
val acc:0.6110248565673828, best validation acc: 0.7958074808120728, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 3,now: 2024-07-26 00:19:42.822468,epoch time: 0:01:46.838789,used: 0:05:48.336370,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94596356, 'precision': 0.9506246, 'recall': 0.94669235, 'specificity': 0.94669235, 'f1': 0.94587535, 'auroc': 0.9954058, 'binary_precision': 1.0, 'binary_recall': 0.8933847, 'binary_specificity': 1.0, 'binary_f1_score': 0.9436906}
confusion matrix:
      0     1
0  1515     0
1   166  1391
---- Validation: 
scalar performance:
{'acc': 0.57841617, 'precision': 0.7626538, 'recall': 0.5724844, 'specificity': 0.5724844, 'f1': 0.48143652, 'auroc': 0.87553024, 'binary_precision': 0.9791667, 'binary_recall': 0.1480315, 'binary_specificity': 0.9969372, 'binary_f1_score': 0.25718194}
confusion matrix:
     0   1
0  651   2
1  541  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5744186, 'precision': 0.75549614, 'recall': 0.5744186, 'specificity': 0.5744186, 'f1': 0.48277563, 'auroc': 0.9091834, 'binary_precision': 0.9705882, 'binary_recall': 0.15348837, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.26506022}
confusion matrix:
     0   1
0  214   1
1  182  33
early stop counter: 3
val acc:0.5784161686897278, best validation acc: 0.7958074808120728, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 4,now: 2024-07-26 00:21:30.040053,epoch time: 0:01:47.217585,used: 0:07:35.553955,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9812544, 'recall': 0.9812854, 'specificity': 0.9812854, 'f1': 0.98111975, 'auroc': 0.997988, 'binary_precision': 0.9934167, 'binary_recall': 0.96917146, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9811443}
confusion matrix:
      0     1
0  1505    10
1    48  1509
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.81133646, 'recall': 0.765218, 'specificity': 0.765218, 'f1': 0.7582314, 'auroc': 0.88535047, 'binary_precision': 0.92424244, 'binary_recall': 0.5763779, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.70999026}
confusion matrix:
     0    1
0  623   30
1  269  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7372093, 'precision': 0.8192698, 'recall': 0.7372093, 'specificity': 0.7372093, 'f1': 0.7191638, 'auroc': 0.8976095, 'binary_precision': 0.9811321, 'binary_recall': 0.48372093, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.647975}
confusion matrix:
     0    1
0  213    2
1  111  104
early stop counter: 4
val acc:0.7678571343421936, best validation acc: 0.7958074808120728, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 5,now: 2024-07-26 00:23:17.937821,epoch time: 0:01:47.897768,used: 0:09:23.451723,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9775936, 'recall': 0.9776582, 'specificity': 0.9776582, 'f1': 0.9775388, 'auroc': 0.9972873, 'binary_precision': 0.9869024, 'binary_recall': 0.968509, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.97761923}
confusion matrix:
      0     1
0  1496    20
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.6708075, 'precision': 0.7470603, 'recall': 0.666858, 'specificity': 0.666858, 'f1': 0.64014006, 'auroc': 0.81440717, 'binary_precision': 0.8808664, 'binary_recall': 0.38425198, 'binary_specificity': 0.949464, 'binary_f1_score': 0.53508776}
confusion matrix:
     0    1
0  620   33
1  391  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.78520644, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.6394, 'auroc': 0.89105463, 'binary_precision': 0.962963, 'binary_recall': 0.3627907, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.5270271}
confusion matrix:
     0   1
0  212   3
1  137  78
early stop counter: 5
val acc:0.6708074808120728, best validation acc: 0.7958074808120728, corresponding to test acc:                         0.8162790536880493 / 0.8162790536880493
after epoch: 6,now: 2024-07-26 00:25:06.154934,epoch time: 0:01:48.217113,used: 0:11:11.668836,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_13_54_seed_0_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:11:11.668836 at 2024-07-26 00:25:06.154934
persisted model performance metric: 

scalar performance:
{'acc': 0.81627905, 'precision': 0.8168342, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8161986, 'auroc': 0.8572201, 'binary_precision': 0.8300971, 'binary_recall': 0.7953488, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8123516}
confusion matrix:
     0    1
0  180   35
1   44  171
oracle model performance metric: 

scalar performance:
{'acc': 0.81627905, 'precision': 0.8168342, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8161986, 'auroc': 0.8572201, 'binary_precision': 0.8300971, 'binary_recall': 0.7953488, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8123516}
confusion matrix:
     0    1
0  180   35
1   44  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1247 MiB |   7995 MiB |  39848 GiB |  39847 GiB |
|       from large pool |   1158 MiB |   7922 MiB |  39502 GiB |  39501 GiB |
|       from small pool |     88 MiB |    124 MiB |    346 GiB |    345 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1247 MiB |   7995 MiB |  39848 GiB |  39847 GiB |
|       from large pool |   1158 MiB |   7922 MiB |  39502 GiB |  39501 GiB |
|       from small pool |     88 MiB |    124 MiB |    346 GiB |    345 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB |  39811 GiB |  39810 GiB |
|       from large pool |   1146 MiB |   7915 MiB |  39466 GiB |  39465 GiB |
|       from small pool |     88 MiB |    124 MiB |    345 GiB |    345 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8946 MiB |   8946 MiB |   8946 MiB |      0 B   |
|       from large pool |   8812 MiB |   8812 MiB |   8812 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1114 MiB |   1114 MiB |  27281 GiB |  27280 GiB |
|       from large pool |   1103 MiB |   1103 MiB |  26926 GiB |  26925 GiB |
|       from small pool |     11 MiB |     25 MiB |    355 GiB |    355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3289    |    5626 K  |    5624 K  |
|       from large pool |     382    |     808    |    2861 K  |    2861 K  |
|       from small pool |    2062    |    2754    |    2765 K  |    2763 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3289    |    5626 K  |    5624 K  |
|       from large pool |     382    |     808    |    2861 K  |    2861 K  |
|       from small pool |    2062    |    2754    |    2765 K  |    2763 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     326    |     326    |     326    |       0    |
|       from large pool |     259    |     259    |     259    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     160    |     346    |    3004 K  |    3003 K  |
|       from large pool |      83    |     256    |    1690 K  |    1690 K  |
|       from small pool |      77    |     236    |    1313 K  |    1313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7995 MiB |  39848 GiB |  39848 GiB |
|       from large pool |  16640 KiB |   7922 MiB |  39502 GiB |  39502 GiB |
|       from small pool |      0 KiB |    124 MiB |    346 GiB |    346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7995 MiB |  39848 GiB |  39848 GiB |
|       from large pool |  16640 KiB |   7922 MiB |  39502 GiB |  39502 GiB |
|       from small pool |      0 KiB |    124 MiB |    346 GiB |    346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB |  39811 GiB |  39811 GiB |
|       from large pool |  16640 KiB |   7915 MiB |  39466 GiB |  39466 GiB |
|       from small pool |      0 KiB |    124 MiB |    345 GiB |    345 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2362 MiB |   8946 MiB |   8946 MiB |   6584 MiB |
|       from large pool |   2262 MiB |   8812 MiB |   8812 MiB |   6550 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1175 MiB |  27282 GiB |  27282 GiB |
|       from large pool |  24320 KiB |   1153 MiB |  26926 GiB |  26926 GiB |
|       from small pool |      0 KiB |     51 MiB |    355 GiB |    355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    5626 K  |    5626 K  |
|       from large pool |       2    |     808    |    2861 K  |    2861 K  |
|       from small pool |       0    |    2754    |    2765 K  |    2765 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    5626 K  |    5626 K  |
|       from large pool |       2    |     808    |    2861 K  |    2861 K  |
|       from small pool |       0    |    2754    |    2765 K  |    2765 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     326    |     326    |     200    |
|       from large pool |      76    |     259    |     259    |     183    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |    3004 K  |    3004 K  |
|       from large pool |       3    |     256    |    1690 K  |    1690 K  |
|       from small pool |       0    |     236    |    1313 K  |    1313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7995 MiB |  39848 GiB |  39848 GiB |
|       from large pool |  16640 KiB |   7922 MiB |  39502 GiB |  39502 GiB |
|       from small pool |      0 KiB |    124 MiB |    346 GiB |    346 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7995 MiB |  39848 GiB |  39848 GiB |
|       from large pool |  16640 KiB |   7922 MiB |  39502 GiB |  39502 GiB |
|       from small pool |      0 KiB |    124 MiB |    346 GiB |    346 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB |  39811 GiB |  39811 GiB |
|       from large pool |  16640 KiB |   7915 MiB |  39466 GiB |  39466 GiB |
|       from small pool |      0 KiB |    124 MiB |    345 GiB |    345 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2362 MiB |   8946 MiB |   8946 MiB |   6584 MiB |
|       from large pool |   2262 MiB |   8812 MiB |   8812 MiB |   6550 MiB |
|       from small pool |    100 MiB |    134 MiB |    134 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1175 MiB |  27282 GiB |  27282 GiB |
|       from large pool |  24320 KiB |   1153 MiB |  26926 GiB |  26926 GiB |
|       from small pool |      0 KiB |     51 MiB |    355 GiB |    355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    5626 K  |    5626 K  |
|       from large pool |       2    |     808    |    2861 K  |    2861 K  |
|       from small pool |       0    |    2754    |    2765 K  |    2765 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    5626 K  |    5626 K  |
|       from large pool |       2    |     808    |    2861 K  |    2861 K  |
|       from small pool |       0    |    2754    |    2765 K  |    2765 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     326    |     326    |     200    |
|       from large pool |      76    |     259    |     259    |     183    |
|       from small pool |      50    |      67    |      67    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |    3004 K  |    3004 K  |
|       from large pool |       3    |     256    |    1690 K  |    1690 K  |
|       from small pool |       0    |     236    |    1313 K  |    1313 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693

 Experiment start at: 2024-07-26 00:25:40.910844
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9684098, 'recall': 0.96843183, 'specificity': 0.96843183, 'f1': 0.9684199, 'auroc': 0.99549025, 'binary_precision': 0.969736, 'binary_recall': 0.9678663, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.96880025}
confusion matrix:
      0     1
0  1469    47
1    50  1506
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.8308871, 'recall': 0.83085, 'specificity': 0.83085, 'f1': 0.83060074, 'auroc': 0.88819885, 'binary_precision': 0.8162328, 'binary_recall': 0.8460317, 'binary_specificity': 0.8156682, 'binary_f1_score': 0.83086514}
confusion matrix:
     0    1
0  531  120
1   97  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8056277, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.804255, 'auroc': 0.87610865, 'binary_precision': 0.7866109, 'binary_recall': 0.83555555, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8103448}
confusion matrix:
     0    1
0  174   51
1   37  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:27:39.149445,epoch time: 0:01:58.238601,used: 0:01:58.238601,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9508464, 'precision': 0.9508215, 'recall': 0.95086837, 'specificity': 0.95086837, 'f1': 0.95083994, 'auroc': 0.98988044, 'binary_precision': 0.9535484, 'binary_recall': 0.9492614, 'binary_specificity': 0.95247525, 'binary_f1_score': 0.95140004}
confusion matrix:
      0     1
0  1443    72
1    79  1478
---- Validation: 
scalar performance:
{'acc': 0.704918, 'precision': 0.7668201, 'recall': 0.700896, 'specificity': 0.700896, 'f1': 0.6840793, 'auroc': 0.8642454, 'binary_precision': 0.8913044, 'binary_recall': 0.45555556, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.6029412}
confusion matrix:
     0    1
0  616   35
1  343  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7111111, 'precision': 0.7950311, 'recall': 0.7111111, 'specificity': 0.7111111, 'f1': 0.6889952, 'auroc': 0.9011556, 'binary_precision': 0.95238096, 'binary_recall': 0.44444445, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.60606056}
confusion matrix:
     0    1
0  220    5
1  125  100
early stop counter: 1
val acc:0.7049180269241333, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.804444432258606 / 0.804444432258606
after epoch: 2,now: 2024-07-26 00:29:25.886754,epoch time: 0:01:46.737309,used: 0:03:44.975910,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9586589, 'precision': 0.9608668, 'recall': 0.9590919, 'specificity': 0.9590919, 'f1': 0.9586315, 'auroc': 0.99505043, 'binary_precision': 0.9958304, 'binary_recall': 0.9221364, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.95756763}
confusion matrix:
      0     1
0  1512     6
1   121  1433
---- Validation: 
scalar performance:
{'acc': 0.6159251, 'precision': 0.72178525, 'recall': 0.61013824, 'specificity': 0.61013824, 'f1': 0.55763596, 'auroc': 0.88215685, 'binary_precision': 0.87096775, 'binary_recall': 0.25714287, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.3970588}
confusion matrix:
     0    1
0  627   24
1  468  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.78125, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6255683, 'auroc': 0.87597036, 'binary_precision': 0.9625, 'binary_recall': 0.3422222, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.50491804}
confusion matrix:
     0   1
0  222   3
1  148  77
early stop counter: 2
val acc:0.6159250736236572, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.804444432258606 / 0.804444432258606
after epoch: 3,now: 2024-07-26 00:31:13.906853,epoch time: 0:01:48.020099,used: 0:05:32.996009,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9586589, 'precision': 0.9613982, 'recall': 0.9591377, 'specificity': 0.9591377, 'f1': 0.9586226, 'auroc': 0.9973484, 'binary_precision': 1.0, 'binary_recall': 0.9182754, 'binary_specificity': 1.0, 'binary_f1_score': 0.95739686}
confusion matrix:
      0     1
0  1518     0
1   127  1427
---- Validation: 
scalar performance:
{'acc': 0.5620609, 'precision': 0.73707324, 'recall': 0.5548899, 'specificity': 0.5548899, 'f1': 0.4529962, 'auroc': 0.89009404, 'binary_precision': 0.93670887, 'binary_recall': 0.11746032, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.20874472}
confusion matrix:
     0   1
0  646   5
1  556  74
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5288889, 'precision': 0.7574371, 'recall': 0.5288889, 'specificity': 0.5288889, 'f1': 0.394501, 'auroc': 0.89700747, 'binary_precision': 1.0, 'binary_recall': 0.057777777, 'binary_specificity': 1.0, 'binary_f1_score': 0.1092437}
confusion matrix:
     0   1
0  225   0
1  212  13
early stop counter: 3
val acc:0.5620608925819397, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.804444432258606 / 0.804444432258606
after epoch: 4,now: 2024-07-26 00:33:01.467339,epoch time: 0:01:47.560486,used: 0:07:20.556495,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.958654, 'recall': 0.95597076, 'specificity': 0.95597076, 'f1': 0.95629203, 'auroc': 0.9974005, 'binary_precision': 0.92930514, 'binary_recall': 0.9890675, 'binary_specificity': 0.9228741, 'binary_f1_score': 0.95825547}
confusion matrix:
      0     1
0  1400   117
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.75565964, 'precision': 0.788947, 'recall': 0.75839734, 'specificity': 0.75839734, 'f1': 0.7496792, 'auroc': 0.8562456, 'binary_precision': 0.6866902, 'binary_recall': 0.9253968, 'binary_specificity': 0.5913978, 'binary_f1_score': 0.7883705}
confusion matrix:
     0    1
0  385  266
1   47  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7133333, 'precision': 0.7550539, 'recall': 0.71333337, 'specificity': 0.71333337, 'f1': 0.7011106, 'auroc': 0.8081185, 'binary_precision': 0.65189874, 'binary_recall': 0.91555554, 'binary_specificity': 0.51111114, 'binary_f1_score': 0.76155263}
confusion matrix:
     0    1
0  115  110
1   19  206
early stop counter: 4
val acc:0.7556596398353577, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.804444432258606 / 0.804444432258606
after epoch: 5,now: 2024-07-26 00:34:49.705970,epoch time: 0:01:48.238631,used: 0:09:08.795126,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839916, 'recall': 0.9838972, 'specificity': 0.9838972, 'f1': 0.98372376, 'auroc': 0.99899876, 'binary_precision': 0.99867374, 'binary_recall': 0.969112, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9836708}
confusion matrix:
      0     1
0  1516     2
1    48  1506
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.83703995, 'recall': 0.8112391, 'specificity': 0.8112391, 'f1': 0.80932003, 'auroc': 0.91390777, 'binary_precision': 0.9222462, 'binary_recall': 0.67777777, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.7813357}
confusion matrix:
     0    1
0  615   36
1  203  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.80069125, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.7488158, 'auroc': 0.88703215, 'binary_precision': 0.9142857, 'binary_recall': 0.5688889, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.7013699}
confusion matrix:
     0    1
0  213   12
1   97  128
early stop counter: 5
val acc:0.8134270310401917, best validation acc: 0.8306010961532593, corresponding to test acc:                         0.804444432258606 / 0.804444432258606
after epoch: 6,now: 2024-07-26 00:36:37.621605,epoch time: 0:01:47.915635,used: 0:10:56.710761,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_25_40_seed_1_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:10:56.710761 at 2024-07-26 00:36:37.621605
persisted model performance metric: 

scalar performance:
{'acc': 0.80444443, 'precision': 0.8056277, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.804255, 'auroc': 0.87610865, 'binary_precision': 0.7866109, 'binary_recall': 0.83555555, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8103448}
confusion matrix:
     0    1
0  174   51
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.80444443, 'precision': 0.8056277, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.804255, 'auroc': 0.87610865, 'binary_precision': 0.7866109, 'binary_recall': 0.83555555, 'binary_specificity': 0.7733333, 'binary_f1_score': 0.8103448}
confusion matrix:
     0    1
0  174   51
1   37  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1252 MiB |   7999 MiB |  79711 GiB |  79710 GiB |
|       from large pool |   1164 MiB |   7925 MiB |  79017 GiB |  79015 GiB |
|       from small pool |     88 MiB |    128 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1252 MiB |   7999 MiB |  79711 GiB |  79710 GiB |
|       from large pool |   1164 MiB |   7925 MiB |  79017 GiB |  79015 GiB |
|       from small pool |     88 MiB |    128 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB |  79641 GiB |  79640 GiB |
|       from large pool |   1146 MiB |   7915 MiB |  78948 GiB |  78947 GiB |
|       from small pool |     88 MiB |    128 MiB |    693 GiB |    693 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8696 MiB |   8946 MiB |  15280 MiB |   6584 MiB |
|       from large pool |   8558 MiB |   8812 MiB |  15108 MiB |   6550 MiB |
|       from small pool |    138 MiB |    138 MiB |    172 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1163 MiB |   1180 MiB |  57076 GiB |  57075 GiB |
|       from large pool |   1153 MiB |   1168 MiB |  56362 GiB |  56361 GiB |
|       from small pool |      9 MiB |     51 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   11263 K  |   11261 K  |
|       from large pool |     382    |     808    |    5724 K  |    5723 K  |
|       from small pool |    2074    |    2766    |    5539 K  |    5537 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   11263 K  |   11261 K  |
|       from large pool |     382    |     808    |    5724 K  |    5723 K  |
|       from small pool |    2074    |    2766    |    5539 K  |    5537 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     306    |     326    |     506    |     200    |
|       from large pool |     237    |     259    |     420    |     183    |
|       from small pool |      69    |      69    |      86    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     148    |     346    |    6159 K  |    6159 K  |
|       from large pool |      74    |     256    |    3399 K  |    3399 K  |
|       from small pool |      74    |     236    |    2760 K  |    2760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7999 MiB |  79711 GiB |  79711 GiB |
|       from large pool |  16640 KiB |   7925 MiB |  79017 GiB |  79017 GiB |
|       from small pool |      0 KiB |    128 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7999 MiB |  79711 GiB |  79711 GiB |
|       from large pool |  16640 KiB |   7925 MiB |  79017 GiB |  79017 GiB |
|       from small pool |      0 KiB |    128 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB |  79641 GiB |  79641 GiB |
|       from large pool |  16640 KiB |   7915 MiB |  78948 GiB |  78948 GiB |
|       from small pool |      0 KiB |    128 MiB |    693 GiB |    693 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2416 MiB |   8946 MiB |  15280 MiB |  12864 MiB |
|       from large pool |   2318 MiB |   8812 MiB |  15108 MiB |  12790 MiB |
|       from small pool |     98 MiB |    138 MiB |    172 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB |  57076 GiB |  57076 GiB |
|       from large pool |  24320 KiB |   1244 MiB |  56363 GiB |  56363 GiB |
|       from small pool |      0 KiB |     51 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   11263 K  |   11263 K  |
|       from large pool |       2    |     808    |    5724 K  |    5724 K  |
|       from small pool |       0    |    2766    |    5539 K  |    5539 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   11263 K  |   11263 K  |
|       from large pool |       2    |     808    |    5724 K  |    5724 K  |
|       from small pool |       0    |    2766    |    5539 K  |    5539 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     326    |     506    |     380    |
|       from large pool |      77    |     259    |     420    |     343    |
|       from small pool |      49    |      69    |      86    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |    6160 K  |    6160 K  |
|       from large pool |       3    |     256    |    3399 K  |    3399 K  |
|       from small pool |       0    |     236    |    2760 K  |    2760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7999 MiB |  79711 GiB |  79711 GiB |
|       from large pool |  16640 KiB |   7925 MiB |  79017 GiB |  79017 GiB |
|       from small pool |      0 KiB |    128 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7999 MiB |  79711 GiB |  79711 GiB |
|       from large pool |  16640 KiB |   7925 MiB |  79017 GiB |  79017 GiB |
|       from small pool |      0 KiB |    128 MiB |    694 GiB |    694 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB |  79641 GiB |  79641 GiB |
|       from large pool |  16640 KiB |   7915 MiB |  78948 GiB |  78948 GiB |
|       from small pool |      0 KiB |    128 MiB |    693 GiB |    693 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2416 MiB |   8946 MiB |  15280 MiB |  12864 MiB |
|       from large pool |   2318 MiB |   8812 MiB |  15108 MiB |  12790 MiB |
|       from small pool |     98 MiB |    138 MiB |    172 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB |  57076 GiB |  57076 GiB |
|       from large pool |  24320 KiB |   1244 MiB |  56363 GiB |  56363 GiB |
|       from small pool |      0 KiB |     51 MiB |    713 GiB |    713 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   11263 K  |   11263 K  |
|       from large pool |       2    |     808    |    5724 K  |    5724 K  |
|       from small pool |       0    |    2766    |    5539 K  |    5539 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   11263 K  |   11263 K  |
|       from large pool |       2    |     808    |    5724 K  |    5724 K  |
|       from small pool |       0    |    2766    |    5539 K  |    5539 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     326    |     506    |     380    |
|       from large pool |      77    |     259    |     420    |     343    |
|       from small pool |      49    |      69    |      86    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |    6160 K  |    6160 K  |
|       from large pool |       3    |     256    |    3399 K  |    3399 K  |
|       from small pool |       0    |     236    |    2760 K  |    2760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693

 Experiment start at: 2024-07-26 00:37:11.592897
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.88743454, 'precision': 0.90752685, 'recall': 0.8883117, 'specificity': 0.8883117, 'f1': 0.88618666, 'auroc': 0.9913541, 'binary_precision': 1.0, 'binary_recall': 0.77662337, 'binary_specificity': 1.0, 'binary_f1_score': 0.874269}
confusion matrix:
      0     1
0  1516     0
1   344  1196
---- Validation: 
scalar performance:
{'acc': 0.6259781, 'precision': 0.77043056, 'recall': 0.6160056, 'specificity': 0.6160056, 'f1': 0.5583813, 'auroc': 0.89869237, 'binary_precision': 0.96153843, 'binary_recall': 0.24115756, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.3856041}
confusion matrix:
     0    1
0  650    6
1  472  150
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5671296, 'precision': 0.7679901, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.46731725, 'auroc': 0.9182527, 'binary_precision': 1.0, 'binary_recall': 0.13425925, 'binary_specificity': 1.0, 'binary_f1_score': 0.23673469}
confusion matrix:
     0   1
0  216   0
1  187  29
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:39:05.011630,epoch time: 0:01:53.418733,used: 0:01:53.418733,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9685864, 'precision': 0.96904874, 'recall': 0.96872324, 'specificity': 0.96872324, 'f1': 0.96858335, 'auroc': 0.99457943, 'binary_precision': 0.9858681, 'binary_recall': 0.9512987, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.96827495}
confusion matrix:
      0     1
0  1495    21
1    75  1465
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.8011842, 'recall': 0.7885362, 'specificity': 0.7885362, 'f1': 0.78820086, 'auroc': 0.8788355, 'binary_precision': 0.8500986, 'binary_recall': 0.69292605, 'binary_specificity': 0.88414633, 'binary_f1_score': 0.76350754}
confusion matrix:
     0    1
0  580   76
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.837963, 'precision': 0.8499645, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8365618, 'auroc': 0.9113726, 'binary_precision': 0.91477275, 'binary_recall': 0.7453704, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8214286}
confusion matrix:
     0    1
0  201   15
1   55  161
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:40:50.968259,epoch time: 0:01:45.956629,used: 0:03:39.375362,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.9763199, 'recall': 0.97563905, 'specificity': 0.97563905, 'f1': 0.9754523, 'auroc': 0.99679613, 'binary_precision': 0.9986385, 'binary_recall': 0.9525974, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.97507477}
confusion matrix:
      0     1
0  1514     2
1    73  1467
---- Validation: 
scalar performance:
{'acc': 0.7887324, 'precision': 0.8177699, 'recall': 0.7846247, 'specificity': 0.7846247, 'f1': 0.7820363, 'auroc': 0.88256073, 'binary_precision': 0.9074074, 'binary_recall': 0.63022506, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.74383295}
confusion matrix:
     0    1
0  616   40
1  230  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.7972621, 'recall': 0.67592597, 'specificity': 0.67592597, 'f1': 0.63909775, 'auroc': 0.9216821, 'binary_precision': 0.98717946, 'binary_recall': 0.3564815, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.52380955}
confusion matrix:
     0   1
0  215   1
1  139  77
early stop counter: 1
val acc:0.7887324094772339, best validation acc: 0.7910798192024231, corresponding to test acc:                         0.8379629850387573 / 0.8379629850387573
after epoch: 3,now: 2024-07-26 00:42:37.666268,epoch time: 0:01:46.698009,used: 0:05:26.073371,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9859389, 'recall': 0.985967, 'specificity': 0.985967, 'f1': 0.9859292, 'auroc': 0.9978279, 'binary_precision': 0.9908197, 'binary_recall': 0.9811688, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9859706}
confusion matrix:
      0     1
0  1502    14
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.8149266, 'recall': 0.789019, 'specificity': 0.789019, 'f1': 0.7873856, 'auroc': 0.8967532, 'binary_precision': 0.8923077, 'binary_recall': 0.65273315, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.7539462}
confusion matrix:
     0    1
0  607   49
1  216  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.8429457, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.7751801, 'auroc': 0.9289695, 'binary_precision': 0.984252, 'binary_recall': 0.5787037, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.728863}
confusion matrix:
     0    1
0  214    2
1   91  125
better model found
persisted
after epoch: 4,now: 2024-07-26 00:44:23.440622,epoch time: 0:01:45.774354,used: 0:07:11.847725,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9810158, 'recall': 0.9810249, 'specificity': 0.9810249, 'f1': 0.98102, 'auroc': 0.9982699, 'binary_precision': 0.98179454, 'binary_recall': 0.9805195, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9811566}
confusion matrix:
      0     1
0  1488    28
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.7870306, 'recall': 0.76315826, 'specificity': 0.76315826, 'f1': 0.76084846, 'auroc': 0.8342507, 'binary_precision': 0.8568282, 'binary_recall': 0.6254019, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.7230483}
confusion matrix:
     0    1
0  591   65
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.82666296, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78316003, 'auroc': 0.8961762, 'binary_precision': 0.9370629, 'binary_recall': 0.6203704, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.7465181}
confusion matrix:
     0    1
0  207    9
1   82  134
early stop counter: 1
val acc:0.7668231725692749, best validation acc: 0.792644739151001, corresponding to test acc:                         0.7847222089767456 / 0.8379629850387573
after epoch: 5,now: 2024-07-26 00:46:09.364315,epoch time: 0:01:45.923693,used: 0:08:57.771418,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9813577, 'recall': 0.9813856, 'specificity': 0.9813856, 'f1': 0.98134804, 'auroc': 0.9979963, 'binary_precision': 0.9862295, 'binary_recall': 0.97662336, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.98140293}
confusion matrix:
      0     1
0  1495    21
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.70187795, 'precision': 0.77670014, 'recall': 0.69477147, 'specificity': 0.69477147, 'f1': 0.67540073, 'auroc': 0.87333715, 'binary_precision': 0.9140893, 'binary_recall': 0.42765275, 'binary_specificity': 0.9618902, 'binary_f1_score': 0.5826944}
confusion matrix:
     0    1
0  631   25
1  356  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.8697917, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.8238095, 'auroc': 0.946845, 'binary_precision': 0.9930556, 'binary_recall': 0.662037, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.7944444}
confusion matrix:
     0    1
0  215    1
1   73  143
early stop counter: 2
val acc:0.7018779516220093, best validation acc: 0.792644739151001, corresponding to test acc:                         0.7847222089767456 / 0.8379629850387573
after epoch: 6,now: 2024-07-26 00:47:55.995098,epoch time: 0:01:46.630783,used: 0:10:44.402201,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.9786067, 'recall': 0.97822106, 'specificity': 0.97822106, 'f1': 0.97807336, 'auroc': 0.996958, 'binary_precision': 0.99662846, 'binary_recall': 0.9597403, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9778366}
confusion matrix:
      0     1
0  1511     5
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.79499215, 'precision': 0.81238586, 'recall': 0.7917639, 'specificity': 0.7917639, 'f1': 0.7907484, 'auroc': 0.8926457, 'binary_precision': 0.87974685, 'binary_recall': 0.670418, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.7609489}
confusion matrix:
     0    1
0  599   57
1  205  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.84897757, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.8288162, 'auroc': 0.93145573, 'binary_precision': 0.92814374, 'binary_recall': 0.7175926, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8093995}
confusion matrix:
     0    1
0  204   12
1   61  155
better model found
persisted
after epoch: 7,now: 2024-07-26 00:49:42.169416,epoch time: 0:01:46.174318,used: 0:12:30.576519,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.9756645, 'recall': 0.9749846, 'specificity': 0.9749846, 'f1': 0.9747977, 'auroc': 0.9978734, 'binary_precision': 0.99795777, 'binary_recall': 0.95194805, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.97441006}
confusion matrix:
      0     1
0  1513     3
1    74  1466
---- Validation: 
scalar performance:
{'acc': 0.68935835, 'precision': 0.7855028, 'recall': 0.68145144, 'specificity': 0.68145144, 'f1': 0.6550584, 'auroc': 0.90515935, 'binary_precision': 0.94466406, 'binary_recall': 0.38424438, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.54628575}
confusion matrix:
     0    1
0  642   14
1  383  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5972222, 'precision': 0.7656982, 'recall': 0.5972222, 'specificity': 0.5972222, 'f1': 0.5213449, 'auroc': 0.93246317, 'binary_precision': 0.97727275, 'binary_recall': 0.19907407, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.33076924}
confusion matrix:
     0   1
0  215   1
1  173  43
early stop counter: 1
val acc:0.6893583536148071, best validation acc: 0.7949921488761902, corresponding to test acc:                         0.8310185074806213 / 0.8379629850387573
after epoch: 8,now: 2024-07-26 00:51:27.844842,epoch time: 0:01:45.675426,used: 0:14:16.251945,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.97256804, 'recall': 0.97248054, 'specificity': 0.97248054, 'f1': 0.97250926, 'auroc': 0.9951217, 'binary_precision': 0.96907216, 'binary_recall': 0.97662336, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9728331}
confusion matrix:
      0     1
0  1468    48
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.81846637, 'precision': 0.83445567, 'recall': 0.81550467, 'specificity': 0.81550467, 'f1': 0.8151964, 'auroc': 0.90400755, 'binary_precision': 0.90123457, 'binary_recall': 0.70418006, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.7906137}
confusion matrix:
     0    1
0  608   48
1  184  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.8347689, 'recall': 0.7615741, 'specificity': 0.7615741, 'f1': 0.747788, 'auroc': 0.92993397, 'binary_precision': 0.99130434, 'binary_recall': 0.5277778, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6888218}
confusion matrix:
     0    1
0  215    1
1  102  114
better model found
persisted
after epoch: 9,now: 2024-07-26 00:53:15.071520,epoch time: 0:01:47.226678,used: 0:16:03.478623,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918215, 'recall': 0.9918163, 'specificity': 0.9918163, 'f1': 0.9918188, 'auroc': 0.9996929, 'binary_precision': 0.9915639, 'binary_recall': 0.99220777, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9918857}
confusion matrix:
      0     1
0  1503    13
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.80773985, 'recall': 0.77687776, 'specificity': 0.77687776, 'f1': 0.7742169, 'auroc': 0.88975865, 'binary_precision': 0.89220184, 'binary_recall': 0.6254019, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.73534966}
confusion matrix:
     0    1
0  609   47
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.8411105, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.7782489, 'auroc': 0.93374914, 'binary_precision': 0.97692305, 'binary_recall': 0.587963, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.73410404}
confusion matrix:
     0    1
0  213    3
1   89  127
early stop counter: 1
val acc:0.7809076905250549, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7615740895271301 / 0.8379629850387573
after epoch: 10,now: 2024-07-26 00:55:00.945858,epoch time: 0:01:45.874338,used: 0:17:49.352961,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895518, 'recall': 0.98957443, 'specificity': 0.98957443, 'f1': 0.9895288, 'auroc': 0.9981437, 'binary_precision': 0.9954008, 'binary_recall': 0.98376626, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9895494}
confusion matrix:
      0     1
0  1509     7
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.7183099, 'precision': 0.802178, 'recall': 0.71115255, 'specificity': 0.71115255, 'f1': 0.69284177, 'auroc': 0.9035468, 'binary_precision': 0.9548611, 'binary_recall': 0.4421222, 'binary_specificity': 0.98018295, 'binary_f1_score': 0.6043956}
confusion matrix:
     0    1
0  643   13
1  347  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.625, 'precision': 0.7769757, 'recall': 0.625, 'specificity': 0.625, 'f1': 0.5653815, 'auroc': 0.91238, 'binary_precision': 0.98214287, 'binary_recall': 0.25462964, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.40441173}
confusion matrix:
     0   1
0  215   1
1  161  55
early stop counter: 2
val acc:0.7183098793029785, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7615740895271301 / 0.8379629850387573
after epoch: 11,now: 2024-07-26 00:56:47.296114,epoch time: 0:01:46.350256,used: 0:19:35.703217,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98691696, 'recall': 0.98694617, 'specificity': 0.98694617, 'f1': 0.9869108, 'auroc': 0.99879897, 'binary_precision': 0.991481, 'binary_recall': 0.98246753, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.98695374}
confusion matrix:
      0     1
0  1503    13
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.6830986, 'precision': 0.7666617, 'recall': 0.6754372, 'specificity': 0.6754372, 'f1': 0.6503722, 'auroc': 0.90221596, 'binary_precision': 0.90943396, 'binary_recall': 0.3874598, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.5434047}
confusion matrix:
     0    1
0  632   24
1  381  241
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.8336824, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.76237094, 'auroc': 0.93692136, 'binary_precision': 0.9758065, 'binary_recall': 0.5601852, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.71176475}
confusion matrix:
     0    1
0  213    3
1   95  121
early stop counter: 3
val acc:0.6830986142158508, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7615740895271301 / 0.8379629850387573
after epoch: 12,now: 2024-07-26 00:58:33.756447,epoch time: 0:01:46.460333,used: 0:21:22.163550,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.9809346, 'recall': 0.980618, 'specificity': 0.980618, 'f1': 0.9806879, 'auroc': 0.99874663, 'binary_precision': 0.9719567, 'binary_recall': 0.99025977, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9810229}
confusion matrix:
      0     1
0  1472    44
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.7879499, 'precision': 0.8127372, 'recall': 0.7841125, 'specificity': 0.7841125, 'f1': 0.78200775, 'auroc': 0.8980595, 'binary_precision': 0.894382, 'binary_recall': 0.63987136, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.7460168}
confusion matrix:
     0    1
0  609   47
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8266129, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.81844825, 'auroc': 0.90256345, 'binary_precision': 0.875, 'binary_recall': 0.7453704, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.805}
confusion matrix:
     0    1
0  193   23
1   55  161
early stop counter: 4
val acc:0.7879499197006226, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7615740895271301 / 0.8379629850387573
after epoch: 13,now: 2024-07-26 01:00:19.163386,epoch time: 0:01:45.406939,used: 0:23:07.570489,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.99151516, 'recall': 0.99153787, 'specificity': 0.99153787, 'f1': 0.99149215, 'auroc': 0.999674, 'binary_precision': 0.99737185, 'binary_recall': 0.98571426, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9915088}
confusion matrix:
      0     1
0  1512     4
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.614241, 'precision': 0.75838023, 'recall': 0.6040311, 'specificity': 0.6040311, 'f1': 0.54083157, 'auroc': 0.8516661, 'binary_precision': 0.94482756, 'binary_recall': 0.22025724, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.35723597}
confusion matrix:
     0    1
0  648    8
1  485  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6064815, 'precision': 0.76953125, 'recall': 0.6064815, 'specificity': 0.6064815, 'f1': 0.53636366, 'auroc': 0.89338994, 'binary_precision': 0.9791667, 'binary_recall': 0.2175926, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.35606062}
confusion matrix:
     0   1
0  215   1
1  169  47
early stop counter: 5
val acc:0.6142410039901733, best validation acc: 0.8184663653373718, corresponding to test acc:                         0.7615740895271301 / 0.8379629850387573
after epoch: 14,now: 2024-07-26 01:02:04.460112,epoch time: 0:01:45.296726,used: 0:24:52.867215,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_37_11_seed_2_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:24:52.867215 at 2024-07-26 01:02:04.460112
persisted model performance metric: 

scalar performance:
{'acc': 0.7615741, 'precision': 0.8347689, 'recall': 0.7615741, 'specificity': 0.7615741, 'f1': 0.747788, 'auroc': 0.92993397, 'binary_precision': 0.99130434, 'binary_recall': 0.5277778, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6888218}
confusion matrix:
     0    1
0  215    1
1  102  114
oracle model performance metric: 

scalar performance:
{'acc': 0.837963, 'precision': 0.8499645, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8365618, 'auroc': 0.9113726, 'binary_precision': 0.91477275, 'binary_recall': 0.7453704, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.8214286}
confusion matrix:
     0    1
0  201   15
1   55  161
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1250 MiB |   7999 MiB | 172130 GiB | 172129 GiB |
|       from large pool |   1161 MiB |   7925 MiB | 170637 GiB | 170636 GiB |
|       from small pool |     88 MiB |    128 MiB |   1493 GiB |   1493 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1250 MiB |   7999 MiB | 172130 GiB | 172129 GiB |
|       from large pool |   1161 MiB |   7925 MiB | 170637 GiB | 170636 GiB |
|       from small pool |     88 MiB |    128 MiB |   1493 GiB |   1493 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 171880 GiB | 171879 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 170389 GiB | 170388 GiB |
|       from small pool |     88 MiB |    128 MiB |   1491 GiB |   1490 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8906 MiB |   8946 MiB |  21770 MiB |  12864 MiB |
|       from large pool |   8772 MiB |   8812 MiB |  21562 MiB |  12790 MiB |
|       from small pool |    134 MiB |    138 MiB |    208 MiB |     74 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    997 MiB |   1271 MiB | 125669 GiB | 125668 GiB |
|       from large pool |    988 MiB |   1244 MiB | 124135 GiB | 124134 GiB |
|       from small pool |      9 MiB |     51 MiB |   1533 GiB |   1533 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   24271 K  |   24269 K  |
|       from large pool |     382    |     808    |   12347 K  |   12347 K  |
|       from small pool |    2062    |    2766    |   11923 K  |   11921 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   24271 K  |   24269 K  |
|       from large pool |     382    |     808    |   12347 K  |   12347 K  |
|       from small pool |    2062    |    2766    |   11923 K  |   11921 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     304    |     326    |     684    |     380    |
|       from large pool |     237    |     259    |     580    |     343    |
|       from small pool |      67    |      69    |     104    |      37    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     153    |     346    |   12907 K  |   12906 K  |
|       from large pool |      78    |     256    |    6881 K  |    6881 K  |
|       from small pool |      75    |     236    |    6025 K  |    6025 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7999 MiB | 172130 GiB | 172130 GiB |
|       from large pool |  16640 KiB |   7925 MiB | 170637 GiB | 170637 GiB |
|       from small pool |      0 KiB |    128 MiB |   1493 GiB |   1493 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7999 MiB | 172130 GiB | 172130 GiB |
|       from large pool |  16640 KiB |   7925 MiB | 170637 GiB | 170637 GiB |
|       from small pool |      0 KiB |    128 MiB |   1493 GiB |   1493 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 171880 GiB | 171880 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 170389 GiB | 170389 GiB |
|       from small pool |      0 KiB |    128 MiB |   1491 GiB |   1491 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2248 MiB |   8946 MiB |  21770 MiB |  19522 MiB |
|       from large pool |   2150 MiB |   8812 MiB |  21562 MiB |  19412 MiB |
|       from small pool |     98 MiB |    138 MiB |    208 MiB |    110 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 125669 GiB | 125669 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 124136 GiB | 124136 GiB |
|       from small pool |      0 KiB |     53 MiB |   1533 GiB |   1533 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   24271 K  |   24271 K  |
|       from large pool |       2    |     808    |   12347 K  |   12347 K  |
|       from small pool |       0    |    2766    |   11923 K  |   11923 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   24271 K  |   24271 K  |
|       from large pool |       2    |     808    |   12347 K  |   12347 K  |
|       from small pool |       0    |    2766    |   11923 K  |   11923 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     326    |     684    |     561    |
|       from large pool |      74    |     259    |     580    |     506    |
|       from small pool |      49    |      69    |     104    |      55    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   12907 K  |   12907 K  |
|       from large pool |       3    |     256    |    6881 K  |    6881 K  |
|       from small pool |       0    |     236    |    6026 K  |    6026 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7999 MiB | 172130 GiB | 172130 GiB |
|       from large pool |  16640 KiB |   7925 MiB | 170637 GiB | 170637 GiB |
|       from small pool |      0 KiB |    128 MiB |   1493 GiB |   1493 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7999 MiB | 172130 GiB | 172130 GiB |
|       from large pool |  16640 KiB |   7925 MiB | 170637 GiB | 170637 GiB |
|       from small pool |      0 KiB |    128 MiB |   1493 GiB |   1493 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 171880 GiB | 171880 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 170389 GiB | 170389 GiB |
|       from small pool |      0 KiB |    128 MiB |   1491 GiB |   1491 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2248 MiB |   8946 MiB |  21770 MiB |  19522 MiB |
|       from large pool |   2150 MiB |   8812 MiB |  21562 MiB |  19412 MiB |
|       from small pool |     98 MiB |    138 MiB |    208 MiB |    110 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 125669 GiB | 125669 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 124136 GiB | 124136 GiB |
|       from small pool |      0 KiB |     53 MiB |   1533 GiB |   1533 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   24271 K  |   24271 K  |
|       from large pool |       2    |     808    |   12347 K  |   12347 K  |
|       from small pool |       0    |    2766    |   11923 K  |   11923 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   24271 K  |   24271 K  |
|       from large pool |       2    |     808    |   12347 K  |   12347 K  |
|       from small pool |       0    |    2766    |   11923 K  |   11923 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     326    |     684    |     561    |
|       from large pool |      74    |     259    |     580    |     506    |
|       from small pool |      49    |      69    |     104    |      55    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   12907 K  |   12907 K  |
|       from large pool |       3    |     256    |    6881 K  |    6881 K  |
|       from small pool |       0    |     236    |    6026 K  |    6026 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693

 Experiment start at: 2024-07-26 01:02:38.856164
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9584105, 'recall': 0.9584898, 'specificity': 0.9584898, 'f1': 0.9583327, 'auroc': 0.9918376, 'binary_precision': 0.96918035, 'binary_recall': 0.94804364, 'binary_specificity': 0.9689359, 'binary_f1_score': 0.9584955}
confusion matrix:
      0     1
0  1466    47
1    81  1478
---- Validation: 
scalar performance:
{'acc': 0.6929073, 'precision': 0.7791184, 'recall': 0.6982298, 'specificity': 0.6982298, 'f1': 0.67072564, 'auroc': 0.8651371, 'binary_precision': 0.61904764, 'binary_recall': 0.97138315, 'binary_specificity': 0.42507645, 'binary_f1_score': 0.75618815}
confusion matrix:
     0    1
0  278  376
1   18  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511111, 'precision': 0.78745055, 'recall': 0.75111115, 'specificity': 0.75111115, 'f1': 0.7429883, 'auroc': 0.8917926, 'binary_precision': 0.68524593, 'binary_recall': 0.9288889, 'binary_specificity': 0.5733333, 'binary_f1_score': 0.7886793}
confusion matrix:
     0    1
0  129   96
1   16  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:04:34.711028,epoch time: 0:01:55.854864,used: 0:01:55.854864,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.930013, 'precision': 0.93767107, 'recall': 0.930992, 'specificity': 0.930992, 'f1': 0.92980057, 'auroc': 0.99027896, 'binary_precision': 0.9992565, 'binary_recall': 0.86264443, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.92593867}
confusion matrix:
      0     1
0  1513     1
1   214  1344
---- Validation: 
scalar performance:
{'acc': 0.7240842, 'precision': 0.7651422, 'recall': 0.7201507, 'specificity': 0.7201507, 'f1': 0.7105942, 'auroc': 0.84619534, 'binary_precision': 0.8647215, 'binary_recall': 0.518283, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.6481114}
confusion matrix:
     0    1
0  603   51
1  303  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8338552, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82066, 'auroc': 0.89362967, 'binary_precision': 0.89617485, 'binary_recall': 0.72888887, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8039216}
confusion matrix:
     0    1
0  206   19
1   61  164
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:06:21.874154,epoch time: 0:01:47.163126,used: 0:03:43.017990,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.9534062, 'recall': 0.951072, 'specificity': 0.951072, 'f1': 0.9504764, 'auroc': 0.99192584, 'binary_precision': 0.9929775, 'binary_recall': 0.90874034, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9489932}
confusion matrix:
      0     1
0  1506    10
1   142  1414
---- Validation: 
scalar performance:
{'acc': 0.7957911, 'precision': 0.7988796, 'recall': 0.79474115, 'specificity': 0.79474115, 'f1': 0.79480374, 'auroc': 0.87069666, 'binary_precision': 0.82477874, 'binary_recall': 0.7408585, 'binary_specificity': 0.8486239, 'binary_f1_score': 0.7805695}
confusion matrix:
     0    1
0  555   99
1  163  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8105, 'recall': 0.8066666, 'specificity': 0.8066666, 'f1': 0.8060681, 'auroc': 0.8759506, 'binary_precision': 0.845, 'binary_recall': 0.7511111, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.79529417}
confusion matrix:
     0    1
0  194   31
1   56  169
better model found
persisted
after epoch: 3,now: 2024-07-26 01:08:09.058148,epoch time: 0:01:47.183994,used: 0:05:30.201984,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9730101, 'recall': 0.9731021, 'specificity': 0.9731021, 'f1': 0.972981, 'auroc': 0.9957466, 'binary_precision': 0.9817113, 'binary_recall': 0.9646983, 'binary_specificity': 0.98150593, 'binary_f1_score': 0.97313046}
confusion matrix:
      0     1
0  1486    28
1    55  1503
---- Validation: 
scalar performance:
{'acc': 0.771629, 'precision': 0.7907226, 'recall': 0.76906574, 'specificity': 0.76906574, 'f1': 0.76661795, 'auroc': 0.84587693, 'binary_precision': 0.860515, 'binary_recall': 0.6375199, 'binary_specificity': 0.90061164, 'binary_f1_score': 0.7324201}
confusion matrix:
     0    1
0  589   65
1  228  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8016572, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.79451644, 'auroc': 0.8695506, 'binary_precision': 0.8445596, 'binary_recall': 0.72444445, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.7799043}
confusion matrix:
     0    1
0  195   30
1   62  163
early stop counter: 1
val acc:0.7716289758682251, best validation acc: 0.7957910895347595, corresponding to test acc:                         0.8066666722297668 / 0.8222222328186035
after epoch: 4,now: 2024-07-26 01:09:55.541885,epoch time: 0:01:46.483737,used: 0:07:16.685721,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9796709, 'recall': 0.97966254, 'specificity': 0.97966254, 'f1': 0.9794922, 'auroc': 0.99840945, 'binary_precision': 0.99273926, 'binary_recall': 0.966581, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9794855}
confusion matrix:
      0     1
0  1505    11
1    52  1504
---- Validation: 
scalar performance:
{'acc': 0.7778644, 'precision': 0.78694046, 'recall': 0.7760632, 'specificity': 0.7760632, 'f1': 0.7752644, 'auroc': 0.85286343, 'binary_precision': 0.8333333, 'binary_recall': 0.6836248, 'binary_specificity': 0.86850154, 'binary_f1_score': 0.75109166}
confusion matrix:
     0    1
0  568   86
1  199  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.80039454, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7973364, 'auroc': 0.8744494, 'binary_precision': 0.82843137, 'binary_recall': 0.7511111, 'binary_specificity': 0.84444445, 'binary_f1_score': 0.7878788}
confusion matrix:
     0    1
0  190   35
1   56  169
early stop counter: 2
val acc:0.777864396572113, best validation acc: 0.7957910895347595, corresponding to test acc:                         0.8066666722297668 / 0.8222222328186035
after epoch: 5,now: 2024-07-26 01:11:41.748962,epoch time: 0:01:46.207077,used: 0:09:02.892798,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9846878, 'recall': 0.98471063, 'specificity': 0.98471063, 'f1': 0.9846983, 'auroc': 0.998116, 'binary_precision': 0.9858339, 'binary_recall': 0.98393315, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9848826}
confusion matrix:
      0     1
0  1494    22
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.7996882, 'precision': 0.79960966, 'recall': 0.7996577, 'specificity': 0.7996577, 'f1': 0.7996293, 'auroc': 0.86432767, 'binary_precision': 0.7943038, 'binary_recall': 0.7980922, 'binary_specificity': 0.8012232, 'binary_f1_score': 0.7961935}
confusion matrix:
     0    1
0  524  130
1  127  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.77763283, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.77245235, 'auroc': 0.8595555, 'binary_precision': 0.743083, 'binary_recall': 0.83555555, 'binary_specificity': 0.7111111, 'binary_f1_score': 0.78661084}
confusion matrix:
     0    1
0  160   65
1   37  188
better model found
persisted
after epoch: 6,now: 2024-07-26 01:13:29.726550,epoch time: 0:01:47.977588,used: 0:10:50.870386,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9810881, 'recall': 0.98117626, 'specificity': 0.98117626, 'f1': 0.9811172, 'auroc': 0.99824053, 'binary_precision': 0.9851421, 'binary_recall': 0.9775641, 'binary_specificity': 0.98478836, 'binary_f1_score': 0.9813385}
confusion matrix:
      0     1
0  1489    23
1    35  1525
---- Validation: 
scalar performance:
{'acc': 0.8074825, 'precision': 0.8090925, 'recall': 0.8067256, 'specificity': 0.8067256, 'f1': 0.80690765, 'auroc': 0.8566046, 'binary_precision': 0.8270548, 'binary_recall': 0.7678855, 'binary_specificity': 0.84556574, 'binary_f1_score': 0.7963726}
confusion matrix:
     0    1
0  553  101
1  146  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.741518, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.7367586, 'auroc': 0.80519503, 'binary_precision': 0.71146244, 'binary_recall': 0.8, 'binary_specificity': 0.6755555, 'binary_f1_score': 0.75313807}
confusion matrix:
     0    1
0  152   73
1   45  180
better model found
persisted
after epoch: 7,now: 2024-07-26 01:15:18.231269,epoch time: 0:01:48.504719,used: 0:12:39.375105,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857198, 'recall': 0.98564076, 'specificity': 0.98564076, 'f1': 0.9856736, 'auroc': 0.9982729, 'binary_precision': 0.98337597, 'binary_recall': 0.9884319, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9858974}
confusion matrix:
      0     1
0  1490    26
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.8355417, 'precision': 0.8410914, 'recall': 0.83427894, 'specificity': 0.83427894, 'f1': 0.83445394, 'auroc': 0.8800144, 'binary_precision': 0.88, 'binary_recall': 0.76947534, 'binary_specificity': 0.89908254, 'binary_f1_score': 0.8210347}
confusion matrix:
     0    1
0  588   66
1  145  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7824231, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7821835, 'auroc': 0.81827164, 'binary_precision': 0.78995436, 'binary_recall': 0.7688889, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.7792793}
confusion matrix:
     0    1
0  179   46
1   52  173
better model found
persisted
after epoch: 8,now: 2024-07-26 01:17:10.389528,epoch time: 0:01:52.158259,used: 0:14:31.533364,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9831532, 'recall': 0.9832057, 'specificity': 0.9832057, 'f1': 0.98307276, 'auroc': 0.99831027, 'binary_precision': 0.9934383, 'binary_recall': 0.97300774, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.98311687}
confusion matrix:
      0     1
0  1506    10
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.78643805, 'precision': 0.81037396, 'recall': 0.7836829, 'specificity': 0.7836829, 'f1': 0.78106457, 'auroc': 0.864967, 'binary_precision': 0.89183223, 'binary_recall': 0.64228934, 'binary_specificity': 0.9250764, 'binary_f1_score': 0.7467653}
confusion matrix:
     0    1
0  605   49
1  225  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.78753245, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.77049994, 'auroc': 0.8642766, 'binary_precision': 0.85142857, 'binary_recall': 0.6622222, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.745}
confusion matrix:
     0    1
0  199   26
1   76  149
early stop counter: 1
val acc:0.7864380478858948, best validation acc: 0.8355417251586914, corresponding to test acc:                         0.7822222113609314 / 0.8222222328186035
after epoch: 9,now: 2024-07-26 01:18:59.548333,epoch time: 0:01:49.158805,used: 0:16:20.692169,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9794924, 'recall': 0.97948337, 'specificity': 0.97948337, 'f1': 0.9794878, 'auroc': 0.99813807, 'binary_precision': 0.979474, 'binary_recall': 0.9801027, 'binary_specificity': 0.97886395, 'binary_f1_score': 0.97978824}
confusion matrix:
      0     1
0  1482    32
1    31  1527
---- Validation: 
scalar performance:
{'acc': 0.8519096, 'precision': 0.8539647, 'recall': 0.85115445, 'specificity': 0.85115445, 'f1': 0.85145473, 'auroc': 0.8856882, 'binary_precision': 0.87650084, 'binary_recall': 0.81240064, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.84323436}
confusion matrix:
     0    1
0  582   72
1  118  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.78571427, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7842047, 'auroc': 0.8622222, 'binary_precision': 0.8047619, 'binary_recall': 0.7511111, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.7770115}
confusion matrix:
     0    1
0  184   41
1   56  169
better model found
persisted
after epoch: 10,now: 2024-07-26 01:20:48.015720,epoch time: 0:01:48.467387,used: 0:18:09.159556,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9843635, 'recall': 0.98445225, 'specificity': 0.98445225, 'f1': 0.98437405, 'auroc': 0.9985781, 'binary_precision': 0.9902534, 'binary_recall': 0.9788054, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9844962}
confusion matrix:
      0     1
0  1500    15
1    33  1524
---- Validation: 
scalar performance:
{'acc': 0.826968, 'precision': 0.8451321, 'recall': 0.8247145, 'specificity': 0.8247145, 'f1': 0.82391274, 'auroc': 0.90298426, 'binary_precision': 0.9195876, 'binary_recall': 0.709062, 'binary_specificity': 0.940367, 'binary_f1_score': 0.80071807}
confusion matrix:
     0    1
0  615   39
1  183  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8499295, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8313335, 'auroc': 0.90759504, 'binary_precision': 0.9261364, 'binary_recall': 0.72444445, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8129676}
confusion matrix:
     0    1
0  212   13
1   62  163
new oracle model saved
early stop counter: 1
val acc:0.8269680142402649, best validation acc: 0.8519095778465271, corresponding to test acc:                         0.7844444513320923 / 0.8333333134651184
after epoch: 11,now: 2024-07-26 01:22:36.399101,epoch time: 0:01:48.383381,used: 0:19:57.542937,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839258, 'recall': 0.9839258, 'specificity': 0.9839258, 'f1': 0.983724, 'auroc': 0.9985844, 'binary_precision': 0.9980185, 'binary_recall': 0.96983314, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.983724}
confusion matrix:
      0     1
0  1511     3
1    47  1511
---- Validation: 
scalar performance:
{'acc': 0.7926734, 'precision': 0.82512164, 'recall': 0.789556, 'specificity': 0.789556, 'f1': 0.78609484, 'auroc': 0.8804957, 'binary_precision': 0.9230769, 'binary_recall': 0.6295707, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.74858224}
confusion matrix:
     0    1
0  621   33
1  233  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.8423125, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7962568, 'auroc': 0.89200985, 'binary_precision': 0.9594595, 'binary_recall': 0.6311111, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7613941}
confusion matrix:
     0    1
0  219    6
1   83  142
early stop counter: 2
val acc:0.7926734089851379, best validation acc: 0.8519095778465271, corresponding to test acc:                         0.7844444513320923 / 0.8333333134651184
after epoch: 12,now: 2024-07-26 01:24:24.240860,epoch time: 0:01:47.841759,used: 0:21:45.384696,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98797154, 'recall': 0.9880699, 'specificity': 0.9880699, 'f1': 0.9879553, 'auroc': 0.9986671, 'binary_precision': 0.9960861, 'binary_recall': 0.9801027, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9880298}
confusion matrix:
      0     1
0  1508     6
1    31  1527
---- Validation: 
scalar performance:
{'acc': 0.7630553, 'precision': 0.7853235, 'recall': 0.76026094, 'specificity': 0.76026094, 'f1': 0.75697124, 'auroc': 0.83906, 'binary_precision': 0.86031044, 'binary_recall': 0.61685216, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.71851856}
confusion matrix:
     0    1
0  591   63
1  241  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8263183, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8063024, 'auroc': 0.8845629, 'binary_precision': 0.9017341, 'binary_recall': 0.6933333, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7839196}
confusion matrix:
     0    1
0  208   17
1   69  156
early stop counter: 3
val acc:0.7630553245544434, best validation acc: 0.8519095778465271, corresponding to test acc:                         0.7844444513320923 / 0.8333333134651184
after epoch: 13,now: 2024-07-26 01:26:15.359001,epoch time: 0:01:51.118141,used: 0:23:36.502837,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99086547, 'recall': 0.9909104, 'specificity': 0.9909104, 'f1': 0.9908842, 'auroc': 0.99889433, 'binary_precision': 0.9929078, 'binary_recall': 0.98908156, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.990991}
confusion matrix:
      0     1
0  1504    11
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.8051442, 'precision': 0.825552, 'recall': 0.80266964, 'specificity': 0.80266964, 'f1': 0.80109763, 'auroc': 0.8802721, 'binary_precision': 0.90233546, 'binary_recall': 0.6756757, 'binary_specificity': 0.9296636, 'binary_f1_score': 0.7727273}
confusion matrix:
     0    1
0  608   46
1  204  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8340932, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.812961, 'auroc': 0.88912594, 'binary_precision': 0.9127907, 'binary_recall': 0.69777775, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.79093194}
confusion matrix:
     0    1
0  210   15
1   68  157
early stop counter: 4
val acc:0.805144190788269, best validation acc: 0.8519095778465271, corresponding to test acc:                         0.7844444513320923 / 0.8333333134651184
after epoch: 14,now: 2024-07-26 01:28:05.096223,epoch time: 0:01:49.737222,used: 0:25:26.240059,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9879477, 'recall': 0.98803806, 'specificity': 0.98803806, 'f1': 0.9879551, 'auroc': 0.9988079, 'binary_precision': 0.99414825, 'binary_recall': 0.9820167, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9880453}
confusion matrix:
      0     1
0  1506     9
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.80436474, 'precision': 0.83714014, 'recall': 0.8012974, 'specificity': 0.8012974, 'f1': 0.79832673, 'auroc': 0.90949667, 'binary_precision': 0.9375, 'binary_recall': 0.6438792, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.7634308}
confusion matrix:
     0    1
0  627   27
1  224  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.8523284, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.80019295, 'auroc': 0.9236345, 'binary_precision': 0.9791667, 'binary_recall': 0.62666667, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7642276}
confusion matrix:
     0    1
0  222    3
1   84  141
early stop counter: 5
val acc:0.8043647408485413, best validation acc: 0.8519095778465271, corresponding to test acc:                         0.7844444513320923 / 0.8333333134651184
after epoch: 15,now: 2024-07-26 01:29:55.964615,epoch time: 0:01:50.868392,used: 0:27:17.108451,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_02_38_seed_3_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:27:17.108451 at 2024-07-26 01:29:55.964615
persisted model performance metric: 

scalar performance:
{'acc': 0.78444445, 'precision': 0.78571427, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7842047, 'auroc': 0.8622222, 'binary_precision': 0.8047619, 'binary_recall': 0.7511111, 'binary_specificity': 0.81777775, 'binary_f1_score': 0.7770115}
confusion matrix:
     0    1
0  184   41
1   56  169
oracle model performance metric: 

scalar performance:
{'acc': 0.8333333, 'precision': 0.8499295, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8313335, 'auroc': 0.90759504, 'binary_precision': 0.9261364, 'binary_recall': 0.72444445, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.8129676}
confusion matrix:
     0    1
0  212   13
1   62  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1253 MiB |   8001 MiB | 271596 GiB | 271595 GiB |
|       from large pool |   1165 MiB |   7927 MiB | 269238 GiB | 269237 GiB |
|       from small pool |     88 MiB |    128 MiB |   2358 GiB |   2357 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1253 MiB |   8001 MiB | 271596 GiB | 271595 GiB |
|       from large pool |   1165 MiB |   7927 MiB | 269238 GiB | 269237 GiB |
|       from small pool |     88 MiB |    128 MiB |   2358 GiB |   2357 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 271255 GiB | 271253 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 268900 GiB | 268899 GiB |
|       from small pool |     88 MiB |    128 MiB |   2354 GiB |   2354 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8702 MiB |   8946 MiB |  28224 MiB |  19522 MiB |
|       from large pool |   8564 MiB |   8812 MiB |  27976 MiB |  19412 MiB |
|       from small pool |    138 MiB |    138 MiB |    248 MiB |    110 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    900 MiB |   1271 MiB | 197010 GiB | 197009 GiB |
|       from large pool |    890 MiB |   1244 MiB | 194587 GiB | 194586 GiB |
|       from small pool |      9 MiB |     53 MiB |   2423 GiB |   2423 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   38307 K  |   38304 K  |
|       from large pool |     382    |     808    |   19487 K  |   19486 K  |
|       from small pool |    2074    |    2766    |   18819 K  |   18817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   38307 K  |   38304 K  |
|       from large pool |     382    |     808    |   19487 K  |   19486 K  |
|       from small pool |    2074    |    2766    |   18819 K  |   18817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     309    |     326    |     870    |     561    |
|       from large pool |     240    |     259    |     746    |     506    |
|       from small pool |      69    |      69    |     124    |      55    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |     346    |   20729 K  |   20728 K  |
|       from large pool |      66    |     256    |   11116 K  |   11116 K  |
|       from small pool |      79    |     236    |    9612 K  |    9612 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 271596 GiB | 271596 GiB |
|       from large pool |  16640 KiB |   7927 MiB | 269238 GiB | 269238 GiB |
|       from small pool |      0 KiB |    128 MiB |   2358 GiB |   2358 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 271596 GiB | 271596 GiB |
|       from large pool |  16640 KiB |   7927 MiB | 269238 GiB | 269238 GiB |
|       from small pool |      0 KiB |    128 MiB |   2358 GiB |   2358 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 271255 GiB | 271255 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 268900 GiB | 268900 GiB |
|       from small pool |      0 KiB |    128 MiB |   2354 GiB |   2354 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2154 MiB |   8946 MiB |  28224 MiB |  26070 MiB |
|       from large pool |   2056 MiB |   8812 MiB |  27976 MiB |  25920 MiB |
|       from small pool |     98 MiB |    138 MiB |    248 MiB |    150 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 197010 GiB | 197010 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 194587 GiB | 194587 GiB |
|       from small pool |      0 KiB |     53 MiB |   2423 GiB |   2423 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   38307 K  |   38307 K  |
|       from large pool |       2    |     808    |   19487 K  |   19487 K  |
|       from small pool |       0    |    2766    |   18819 K  |   18819 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   38307 K  |   38307 K  |
|       from large pool |       2    |     808    |   19487 K  |   19487 K  |
|       from small pool |       0    |    2766    |   18819 K  |   18819 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |     870    |     748    |
|       from large pool |      73    |     259    |     746    |     673    |
|       from small pool |      49    |      69    |     124    |      75    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   20729 K  |   20729 K  |
|       from large pool |       3    |     256    |   11116 K  |   11116 K  |
|       from small pool |       0    |     236    |    9612 K  |    9612 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 271596 GiB | 271596 GiB |
|       from large pool |  16640 KiB |   7927 MiB | 269238 GiB | 269238 GiB |
|       from small pool |      0 KiB |    128 MiB |   2358 GiB |   2358 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 271596 GiB | 271596 GiB |
|       from large pool |  16640 KiB |   7927 MiB | 269238 GiB | 269238 GiB |
|       from small pool |      0 KiB |    128 MiB |   2358 GiB |   2358 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 271255 GiB | 271255 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 268900 GiB | 268900 GiB |
|       from small pool |      0 KiB |    128 MiB |   2354 GiB |   2354 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2154 MiB |   8946 MiB |  28224 MiB |  26070 MiB |
|       from large pool |   2056 MiB |   8812 MiB |  27976 MiB |  25920 MiB |
|       from small pool |     98 MiB |    138 MiB |    248 MiB |    150 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 197010 GiB | 197010 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 194587 GiB | 194587 GiB |
|       from small pool |      0 KiB |     53 MiB |   2423 GiB |   2423 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   38307 K  |   38307 K  |
|       from large pool |       2    |     808    |   19487 K  |   19487 K  |
|       from small pool |       0    |    2766    |   18819 K  |   18819 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   38307 K  |   38307 K  |
|       from large pool |       2    |     808    |   19487 K  |   19487 K  |
|       from small pool |       0    |    2766    |   18819 K  |   18819 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |     870    |     748    |
|       from large pool |      73    |     259    |     746    |     673    |
|       from small pool |      49    |      69    |     124    |      75    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   20729 K  |   20729 K  |
|       from large pool |       3    |     256    |   11116 K  |   11116 K  |
|       from small pool |       0    |     236    |    9612 K  |    9612 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693

 Experiment start at: 2024-07-26 01:30:33.003163
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9523964, 'precision': 0.9527372, 'recall': 0.95270467, 'specificity': 0.95270467, 'f1': 0.95239633, 'auroc': 0.9910331, 'binary_precision': 0.9702774, 'binary_recall': 0.9350732, 'binary_specificity': 0.9703362, 'binary_f1_score': 0.9523501}
confusion matrix:
      0     1
0  1472    45
1   102  1469
---- Validation: 
scalar performance:
{'acc': 0.81576896, 'precision': 0.82498163, 'recall': 0.8168763, 'specificity': 0.8168763, 'f1': 0.81479275, 'auroc': 0.902084, 'binary_precision': 0.76684636, 'binary_recall': 0.9003165, 'binary_specificity': 0.73343605, 'binary_f1_score': 0.8282387}
confusion matrix:
     0    1
0  476  173
1   63  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.8473601, 'recall': 0.8293839, 'specificity': 0.8293839, 'f1': 0.8271476, 'auroc': 0.9390625, 'binary_precision': 0.76833975, 'binary_recall': 0.943128, 'binary_specificity': 0.7156398, 'binary_f1_score': 0.84680855}
confusion matrix:
     0    1
0  151   60
1   12  199
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:32:31.192558,epoch time: 0:01:58.189395,used: 0:01:58.189395,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96470207, 'precision': 0.965262, 'recall': 0.9644477, 'specificity': 0.9644477, 'f1': 0.9646672, 'auroc': 0.99551654, 'binary_precision': 0.95291203, 'binary_recall': 0.97899425, 'binary_specificity': 0.9499011, 'binary_f1_score': 0.9657771}
confusion matrix:
      0     1
0  1441    76
1    33  1538
---- Validation: 
scalar performance:
{'acc': 0.6307572, 'precision': 0.7307317, 'recall': 0.6350544, 'specificity': 0.6350544, 'f1': 0.58997464, 'auroc': 0.81870663, 'binary_precision': 0.5754986, 'binary_recall': 0.95886075, 'binary_specificity': 0.31124806, 'binary_f1_score': 0.7192879}
confusion matrix:
     0    1
0  202  447
1   26  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57109004, 'precision': 0.7691326, 'recall': 0.57109004, 'specificity': 0.57109004, 'f1': 0.47439843, 'auroc': 0.9169886, 'binary_precision': 0.5382653, 'binary_recall': 1.0, 'binary_specificity': 0.1421801, 'binary_f1_score': 0.69983417}
confusion matrix:
    0    1
0  30  181
1   0  211
early stop counter: 1
val acc:0.630757212638855, best validation acc: 0.8157689571380615, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 2,now: 2024-07-26 01:34:19.069431,epoch time: 0:01:47.876873,used: 0:03:46.066268,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9572539, 'precision': 0.9576801, 'recall': 0.95700246, 'specificity': 0.95700246, 'f1': 0.9572108, 'auroc': 0.99351346, 'binary_precision': 0.94785845, 'binary_recall': 0.9695238, 'binary_specificity': 0.94448113, 'binary_f1_score': 0.9585687}
confusion matrix:
      0     1
0  1429    84
1    48  1527
---- Validation: 
scalar performance:
{'acc': 0.7189696, 'precision': 0.77695525, 'recall': 0.7219664, 'specificity': 0.7219664, 'f1': 0.70518446, 'auroc': 0.8895477, 'binary_precision': 0.6468682, 'binary_recall': 0.9477848, 'binary_specificity': 0.49614793, 'binary_f1_score': 0.76893455}
confusion matrix:
     0    1
0  322  327
1   33  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77251184, 'precision': 0.8238356, 'recall': 0.77251184, 'specificity': 0.77251184, 'f1': 0.7631265, 'auroc': 0.94609284, 'binary_precision': 0.69491524, 'binary_recall': 0.971564, 'binary_specificity': 0.57345974, 'binary_f1_score': 0.8102767}
confusion matrix:
     0    1
0  121   90
1    6  205
early stop counter: 2
val acc:0.7189695835113525, best validation acc: 0.8157689571380615, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 3,now: 2024-07-26 01:36:09.270973,epoch time: 0:01:50.201542,used: 0:05:36.267810,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9650259, 'precision': 0.965947, 'recall': 0.9646996, 'specificity': 0.9646996, 'f1': 0.9649815, 'auroc': 0.9952632, 'binary_precision': 0.9490172, 'binary_recall': 0.98407644, 'binary_specificity': 0.9453228, 'binary_f1_score': 0.9662289}
confusion matrix:
      0     1
0  1435    83
1    25  1545
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.83463466, 'recall': 0.8343508, 'specificity': 0.8343508, 'f1': 0.8344194, 'auroc': 0.8959719, 'binary_precision': 0.83870965, 'binary_recall': 0.8227848, 'binary_specificity': 0.8459168, 'binary_f1_score': 0.8306709}
confusion matrix:
     0    1
0  549  100
1  112  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8886256, 'precision': 0.8983699, 'recall': 0.8886256, 'specificity': 0.8886256, 'f1': 0.8879403, 'auroc': 0.9400283, 'binary_precision': 0.96067417, 'binary_recall': 0.81042653, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.87917733}
confusion matrix:
     0    1
0  204    7
1   40  171
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 01:37:57.833740,epoch time: 0:01:48.562767,used: 0:07:24.830577,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97279793, 'precision': 0.97365236, 'recall': 0.9724717, 'specificity': 0.9724717, 'f1': 0.97276336, 'auroc': 0.997839, 'binary_precision': 0.9575646, 'binary_recall': 0.990458, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.97373354}
confusion matrix:
      0     1
0  1447    69
1    15  1557
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.79304683, 'recall': 0.77604425, 'specificity': 0.77604425, 'f1': 0.77142584, 'auroc': 0.8918687, 'binary_precision': 0.7157233, 'binary_recall': 0.9003165, 'binary_specificity': 0.65177196, 'binary_f1_score': 0.79747725}
confusion matrix:
     0    1
0  423  226
1   63  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80331755, 'precision': 0.82213736, 'recall': 0.80331755, 'specificity': 0.80331755, 'f1': 0.8004023, 'auroc': 0.92444015, 'binary_precision': 0.7442748, 'binary_recall': 0.9241706, 'binary_specificity': 0.6824645, 'binary_f1_score': 0.82452434}
confusion matrix:
     0    1
0  144   67
1   16  195
early stop counter: 1
val acc:0.7743949890136719, best validation acc: 0.8345043063163757, corresponding to test acc:                         0.8886256217956543 / 0.8886256217956543
after epoch: 5,now: 2024-07-26 01:39:44.616741,epoch time: 0:01:46.783001,used: 0:09:11.613578,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97506475, 'precision': 0.9751808, 'recall': 0.97496843, 'specificity': 0.97496843, 'f1': 0.9750516, 'auroc': 0.9977932, 'binary_precision': 0.9710145, 'binary_recall': 0.9802799, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9756252}
confusion matrix:
      0     1
0  1470    46
1    31  1541
---- Validation: 
scalar performance:
{'acc': 0.8274785, 'precision': 0.8284274, 'recall': 0.82710624, 'specificity': 0.82710624, 'f1': 0.82721525, 'auroc': 0.88847494, 'binary_precision': 0.84307176, 'binary_recall': 0.7990506, 'binary_specificity': 0.8551618, 'binary_f1_score': 0.8204711}
confusion matrix:
     0    1
0  555   94
1  127  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86255926, 'precision': 0.86905825, 'recall': 0.86255926, 'specificity': 0.86255926, 'f1': 0.8619515, 'auroc': 0.93288565, 'binary_precision': 0.91803277, 'binary_recall': 0.79620856, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.8527919}
confusion matrix:
     0    1
0  196   15
1   43  168
early stop counter: 2
val acc:0.8274785280227661, best validation acc: 0.8345043063163757, corresponding to test acc:                         0.8886256217956543 / 0.8886256217956543
after epoch: 6,now: 2024-07-26 01:41:32.806482,epoch time: 0:01:48.189741,used: 0:10:59.803319,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9893135, 'precision': 0.9893135, 'recall': 0.98948616, 'specificity': 0.98948616, 'f1': 0.9893125, 'auroc': 0.9981624, 'binary_precision': 0.9987047, 'binary_recall': 0.98029244, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.9894129}
confusion matrix:
      0     1
0  1513     2
1    31  1542
---- Validation: 
scalar performance:
{'acc': 0.8446526, 'precision': 0.84946656, 'recall': 0.84386885, 'specificity': 0.84386885, 'f1': 0.84388196, 'auroc': 0.9112778, 'binary_precision': 0.88729876, 'binary_recall': 0.7848101, 'binary_specificity': 0.9029276, 'binary_f1_score': 0.8329135}
confusion matrix:
     0    1
0  586   63
1  136  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8610227, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8336675, 'auroc': 0.91793203, 'binary_precision': 0.9551282, 'binary_recall': 0.70616114, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.8119891}
confusion matrix:
     0    1
0  204    7
1   62  149
better model found
persisted
after epoch: 7,now: 2024-07-26 01:43:19.614470,epoch time: 0:01:46.807988,used: 0:12:46.611307,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97959846, 'precision': 0.9799583, 'recall': 0.97940266, 'specificity': 0.97940266, 'f1': 0.9795815, 'auroc': 0.9984273, 'binary_precision': 0.97069824, 'binary_recall': 0.98982835, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.98016995}
confusion matrix:
      0     1
0  1468    47
1    16  1557
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.8282547, 'recall': 0.82818747, 'specificity': 0.82818747, 'f1': 0.82821304, 'auroc': 0.89168346, 'binary_precision': 0.82802546, 'binary_recall': 0.8227848, 'binary_specificity': 0.83359015, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  541  108
1  112  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8530806, 'precision': 0.8556689, 'recall': 0.8530806, 'specificity': 0.8530806, 'f1': 0.85281277, 'auroc': 0.9059545, 'binary_precision': 0.8253275, 'binary_recall': 0.8957346, 'binary_specificity': 0.81042653, 'binary_f1_score': 0.8590909}
confusion matrix:
     0    1
0  171   40
1   22  189
early stop counter: 1
val acc:0.8282591700553894, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8364928960800171 / 0.8886256217956543
after epoch: 8,now: 2024-07-26 01:45:06.148113,epoch time: 0:01:46.533643,used: 0:14:33.144950,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.98764795, 'recall': 0.98775434, 'specificity': 0.98775434, 'f1': 0.9876908, 'auroc': 0.99841714, 'binary_precision': 0.9910543, 'binary_recall': 0.9847619, 'binary_specificity': 0.99074686, 'binary_f1_score': 0.98789805}
confusion matrix:
      0     1
0  1499    14
1    24  1551
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.8024194, 'recall': 0.7919438, 'specificity': 0.7919438, 'f1': 0.7910441, 'auroc': 0.8741735, 'binary_precision': 0.8522073, 'binary_recall': 0.70253164, 'binary_specificity': 0.88135594, 'binary_f1_score': 0.7701648}
confusion matrix:
     0    1
0  572   77
1  188  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.8641775, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.84667444, 'auroc': 0.9201051, 'binary_precision': 0.94011974, 'binary_recall': 0.74407583, 'binary_specificity': 0.9526066, 'binary_f1_score': 0.8306879}
confusion matrix:
     0    1
0  201   10
1   54  157
early stop counter: 2
val acc:0.7931303381919861, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8364928960800171 / 0.8886256217956543
after epoch: 9,now: 2024-07-26 01:46:54.438311,epoch time: 0:01:48.290198,used: 0:16:21.435148,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97603625, 'precision': 0.97665, 'recall': 0.9757699, 'specificity': 0.9757699, 'f1': 0.97601116, 'auroc': 0.9984449, 'binary_precision': 0.9634901, 'binary_recall': 0.990458, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.976788}
confusion matrix:
      0     1
0  1457    59
1    15  1557
---- Validation: 
scalar performance:
{'acc': 0.8087432, 'precision': 0.81080896, 'recall': 0.80818105, 'specificity': 0.80818105, 'f1': 0.80820274, 'auroc': 0.88137543, 'binary_precision': 0.8330465, 'binary_recall': 0.76582277, 'binary_specificity': 0.85053927, 'binary_f1_score': 0.79802144}
confusion matrix:
     0    1
0  552   97
1  148  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744076, 'precision': 0.88500094, 'recall': 0.8744076, 'specificity': 0.8744076, 'f1': 0.87353766, 'auroc': 0.94079196, 'binary_precision': 0.9488636, 'binary_recall': 0.7914692, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.8630491}
confusion matrix:
     0    1
0  202    9
1   44  167
early stop counter: 3
val acc:0.8087431788444519, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8364928960800171 / 0.8886256217956543
after epoch: 10,now: 2024-07-26 01:48:40.977728,epoch time: 0:01:46.539417,used: 0:18:07.974565,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98898965, 'precision': 0.9889436, 'recall': 0.98905027, 'specificity': 0.98905027, 'f1': 0.98898655, 'auroc': 0.9987524, 'binary_precision': 0.9923323, 'binary_recall': 0.9860318, 'binary_specificity': 0.9920687, 'binary_f1_score': 0.98917204}
confusion matrix:
      0     1
0  1501    12
1    22  1553
---- Validation: 
scalar performance:
{'acc': 0.74160814, 'precision': 0.7810029, 'recall': 0.73908615, 'specificity': 0.73908615, 'f1': 0.73085934, 'auroc': 0.86398745, 'binary_precision': 0.8829517, 'binary_recall': 0.5490506, 'binary_specificity': 0.92912173, 'binary_f1_score': 0.6770732}
confusion matrix:
     0    1
0  603   46
1  285  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6919431, 'precision': 0.7535381, 'recall': 0.69194317, 'specificity': 0.69194317, 'f1': 0.67202336, 'auroc': 0.8715887, 'binary_precision': 0.8785047, 'binary_recall': 0.44549763, 'binary_specificity': 0.93838865, 'binary_f1_score': 0.591195}
confusion matrix:
     0   1
0  198  13
1  117  94
early stop counter: 4
val acc:0.7416081428527832, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8364928960800171 / 0.8886256217956543
after epoch: 11,now: 2024-07-26 01:50:28.196613,epoch time: 0:01:47.218885,used: 0:19:55.193450,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98704666, 'precision': 0.9870094, 'recall': 0.9870993, 'specificity': 0.9870993, 'f1': 0.987044, 'auroc': 0.99845254, 'binary_precision': 0.9903908, 'binary_recall': 0.9840866, 'binary_specificity': 0.99011207, 'binary_f1_score': 0.98722863}
confusion matrix:
      0     1
0  1502    15
1    25  1546
---- Validation: 
scalar performance:
{'acc': 0.74863386, 'precision': 0.7850472, 'recall': 0.74622715, 'specificity': 0.74622715, 'f1': 0.73909, 'auroc': 0.8681656, 'binary_precision': 0.88366336, 'binary_recall': 0.5648734, 'binary_specificity': 0.9275809, 'binary_f1_score': 0.6891892}
confusion matrix:
     0    1
0  602   47
1  275  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84123224, 'precision': 0.8546218, 'recall': 0.84123224, 'specificity': 0.84123224, 'f1': 0.8397193, 'auroc': 0.9043597, 'binary_precision': 0.9235294, 'binary_recall': 0.74407583, 'binary_specificity': 0.93838865, 'binary_f1_score': 0.824147}
confusion matrix:
     0    1
0  198   13
1   54  157
early stop counter: 5
val acc:0.748633861541748, best validation acc: 0.8446525931358337, corresponding to test acc:                         0.8364928960800171 / 0.8886256217956543
after epoch: 12,now: 2024-07-26 01:52:15.248126,epoch time: 0:01:47.051513,used: 0:21:42.244963,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_30_32_seed_4_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:21:42.244963 at 2024-07-26 01:52:15.248126
persisted model performance metric: 

scalar performance:
{'acc': 0.8364929, 'precision': 0.8610227, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8336675, 'auroc': 0.91793203, 'binary_precision': 0.9551282, 'binary_recall': 0.70616114, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.8119891}
confusion matrix:
     0    1
0  204    7
1   62  149
oracle model performance metric: 

scalar performance:
{'acc': 0.8886256, 'precision': 0.8983699, 'recall': 0.8886256, 'specificity': 0.8886256, 'f1': 0.8879403, 'auroc': 0.9400283, 'binary_precision': 0.96067417, 'binary_recall': 0.81042653, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.87917733}
confusion matrix:
     0    1
0  204    7
1   40  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1251 MiB |   8001 MiB | 351602 GiB | 351601 GiB |
|       from large pool |   1163 MiB |   7928 MiB | 348551 GiB | 348550 GiB |
|       from small pool |     88 MiB |    128 MiB |   3051 GiB |   3050 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1251 MiB |   8001 MiB | 351602 GiB | 351601 GiB |
|       from large pool |   1163 MiB |   7928 MiB | 348551 GiB | 348550 GiB |
|       from small pool |     88 MiB |    128 MiB |   3051 GiB |   3050 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 351115 GiB | 351114 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 348068 GiB | 348067 GiB |
|       from small pool |     88 MiB |    128 MiB |   3046 GiB |   3046 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8702 MiB |   8946 MiB |  34772 MiB |  26070 MiB |
|       from large pool |   8568 MiB |   8812 MiB |  34488 MiB |  25920 MiB |
|       from small pool |    134 MiB |    138 MiB |    284 MiB |    150 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1072 MiB |   1271 MiB | 250796 GiB | 250795 GiB |
|       from large pool |   1062 MiB |   1244 MiB | 247659 GiB | 247658 GiB |
|       from small pool |      9 MiB |     53 MiB |   3136 GiB |   3136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   49576 K  |   49573 K  |
|       from large pool |     382    |     808    |   25223 K  |   25222 K  |
|       from small pool |    2062    |    2766    |   24353 K  |   24351 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   49576 K  |   49573 K  |
|       from large pool |     382    |     808    |   25223 K  |   25222 K  |
|       from small pool |    2062    |    2766    |   24353 K  |   24351 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     310    |     326    |    1058    |     748    |
|       from large pool |     243    |     259    |     916    |     673    |
|       from small pool |      67    |      69    |     142    |      75    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     155    |     346    |   27123 K  |   27123 K  |
|       from large pool |      72    |     256    |   14644 K  |   14644 K  |
|       from small pool |      83    |     237    |   12478 K  |   12478 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 351602 GiB | 351602 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 348551 GiB | 348551 GiB |
|       from small pool |      0 KiB |    128 MiB |   3051 GiB |   3051 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 351602 GiB | 351602 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 348551 GiB | 348551 GiB |
|       from small pool |      0 KiB |    128 MiB |   3051 GiB |   3051 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 351115 GiB | 351115 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 348068 GiB | 348068 GiB |
|       from small pool |      0 KiB |    128 MiB |   3046 GiB |   3046 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2324 MiB |   8946 MiB |  34772 MiB |  32448 MiB |
|       from large pool |   2226 MiB |   8812 MiB |  34488 MiB |  32262 MiB |
|       from small pool |     98 MiB |    138 MiB |    284 MiB |    186 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 250797 GiB | 250797 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 247660 GiB | 247660 GiB |
|       from small pool |      0 KiB |     53 MiB |   3136 GiB |   3136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   49576 K  |   49576 K  |
|       from large pool |       2    |     808    |   25223 K  |   25223 K  |
|       from small pool |       0    |    2766    |   24353 K  |   24353 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   49576 K  |   49576 K  |
|       from large pool |       2    |     808    |   25223 K  |   25223 K  |
|       from small pool |       0    |    2766    |   24353 K  |   24353 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1058    |     936    |
|       from large pool |      73    |     259    |     916    |     843    |
|       from small pool |      49    |      69    |     142    |      93    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   27123 K  |   27123 K  |
|       from large pool |       3    |     256    |   14644 K  |   14644 K  |
|       from small pool |       0    |     237    |   12479 K  |   12479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 351602 GiB | 351602 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 348551 GiB | 348551 GiB |
|       from small pool |      0 KiB |    128 MiB |   3051 GiB |   3051 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 351602 GiB | 351602 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 348551 GiB | 348551 GiB |
|       from small pool |      0 KiB |    128 MiB |   3051 GiB |   3051 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 351115 GiB | 351115 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 348068 GiB | 348068 GiB |
|       from small pool |      0 KiB |    128 MiB |   3046 GiB |   3046 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2324 MiB |   8946 MiB |  34772 MiB |  32448 MiB |
|       from large pool |   2226 MiB |   8812 MiB |  34488 MiB |  32262 MiB |
|       from small pool |     98 MiB |    138 MiB |    284 MiB |    186 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 250797 GiB | 250797 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 247660 GiB | 247660 GiB |
|       from small pool |      0 KiB |     53 MiB |   3136 GiB |   3136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   49576 K  |   49576 K  |
|       from large pool |       2    |     808    |   25223 K  |   25223 K  |
|       from small pool |       0    |    2766    |   24353 K  |   24353 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   49576 K  |   49576 K  |
|       from large pool |       2    |     808    |   25223 K  |   25223 K  |
|       from small pool |       0    |    2766    |   24353 K  |   24353 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1058    |     936    |
|       from large pool |      73    |     259    |     916    |     843    |
|       from small pool |      49    |      69    |     142    |      93    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   27123 K  |   27123 K  |
|       from large pool |       3    |     256    |   14644 K  |   14644 K  |
|       from small pool |       0    |     237    |   12479 K  |   12479 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693

 Experiment start at: 2024-07-26 01:52:48.706936
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8792539, 'precision': 0.90092486, 'recall': 0.88117623, 'specificity': 0.88117623, 'f1': 0.87795734, 'auroc': 0.9869186, 'binary_precision': 0.9983165, 'binary_recall': 0.7636832, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.86537766}
confusion matrix:
      0     1
0  1501     2
1   367  1186
---- Validation: 
scalar performance:
{'acc': 0.7503888, 'precision': 0.77545756, 'recall': 0.7459885, 'specificity': 0.7459885, 'f1': 0.74221456, 'auroc': 0.8482832, 'binary_precision': 0.8518519, 'binary_recall': 0.5888, 'binary_specificity': 0.903177, 'binary_f1_score': 0.69631034}
confusion matrix:
     0    1
0  597   64
1  257  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7922078, 'precision': 0.8078054, 'recall': 0.79220784, 'specificity': 0.79220784, 'f1': 0.7895416, 'auroc': 0.8692491, 'binary_precision': 0.877095, 'binary_recall': 0.6796537, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.7658537}
confusion matrix:
     0    1
0  209   22
1   74  157
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:54:41.230137,epoch time: 0:01:52.523201,used: 0:01:52.523201,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9518979, 'precision': 0.9550666, 'recall': 0.9526006, 'specificity': 0.9526006, 'f1': 0.95185524, 'auroc': 0.9931313, 'binary_precision': 0.99716914, 'binary_recall': 0.9078608, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9504216}
confusion matrix:
      0     1
0  1500     4
1   143  1409
---- Validation: 
scalar performance:
{'acc': 0.8087092, 'precision': 0.8161657, 'recall': 0.8064678, 'specificity': 0.8064678, 'f1': 0.80667233, 'auroc': 0.8875909, 'binary_precision': 0.8582231, 'binary_recall': 0.7264, 'binary_specificity': 0.8865355, 'binary_f1_score': 0.78682846}
confusion matrix:
     0    1
0  586   75
1  171  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8008658, 'precision': 0.8121925, 'recall': 0.80086577, 'specificity': 0.80086577, 'f1': 0.79904306, 'auroc': 0.87414026, 'binary_precision': 0.8716577, 'binary_recall': 0.7056277, 'binary_specificity': 0.8961039, 'binary_f1_score': 0.77990425}
confusion matrix:
     0    1
0  207   24
1   68  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:56:27.285071,epoch time: 0:01:46.054934,used: 0:03:38.578135,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9620419, 'precision': 0.96248466, 'recall': 0.9618372, 'specificity': 0.9618372, 'f1': 0.9620118, 'auroc': 0.99364626, 'binary_precision': 0.9515723, 'binary_recall': 0.97487116, 'binary_specificity': 0.9488032, 'binary_f1_score': 0.9630809}
confusion matrix:
      0     1
0  1427    77
1    39  1513
---- Validation: 
scalar performance:
{'acc': 0.7760498, 'precision': 0.78579, 'recall': 0.7785319, 'specificity': 0.7785319, 'f1': 0.7750437, 'auroc': 0.8241307, 'binary_precision': 0.72556895, 'binary_recall': 0.8672, 'binary_specificity': 0.68986386, 'binary_f1_score': 0.79008746}
confusion matrix:
     0    1
0  456  205
1   83  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7900433, 'precision': 0.8049054, 'recall': 0.7900433, 'specificity': 0.7900433, 'f1': 0.78745323, 'auroc': 0.8839602, 'binary_precision': 0.73758864, 'binary_recall': 0.9004329, 'binary_specificity': 0.6796537, 'binary_f1_score': 0.8109162}
confusion matrix:
     0    1
0  157   74
1   23  208
early stop counter: 1
val acc:0.776049792766571, best validation acc: 0.8087092041969299, corresponding to test acc:                         0.8008658289909363 / 0.8008658289909363
after epoch: 3,now: 2024-07-26 01:58:13.752419,epoch time: 0:01:46.467348,used: 0:05:25.045483,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94600785, 'precision': 0.9508737, 'recall': 0.9452616, 'specificity': 0.9452616, 'f1': 0.94578713, 'auroc': 0.9981519, 'binary_precision': 0.9076471, 'binary_recall': 0.99484205, 'binary_specificity': 0.8956811, 'binary_f1_score': 0.9492464}
confusion matrix:
      0     1
0  1348   157
1     8  1543
---- Validation: 
scalar performance:
{'acc': 0.7052877, 'precision': 0.7734533, 'recall': 0.71209323, 'specificity': 0.71209323, 'f1': 0.6898399, 'auroc': 0.9075824, 'binary_precision': 0.62974685, 'binary_recall': 0.9552, 'binary_specificity': 0.4689864, 'binary_f1_score': 0.75905913}
confusion matrix:
     0    1
0  310  351
1   28  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6926407, 'precision': 0.7819314, 'recall': 0.69264066, 'specificity': 0.69264066, 'f1': 0.66621214, 'auroc': 0.9414742, 'binary_precision': 0.6232687, 'binary_recall': 0.97402596, 'binary_specificity': 0.41125542, 'binary_f1_score': 0.7601352}
confusion matrix:
    0    1
0  95  136
1   6  225
early stop counter: 2
val acc:0.7052876949310303, best validation acc: 0.8087092041969299, corresponding to test acc:                         0.8008658289909363 / 0.8008658289909363
after epoch: 4,now: 2024-07-26 01:59:58.948589,epoch time: 0:01:45.196170,used: 0:07:10.241653,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.97225225, 'recall': 0.9721254, 'specificity': 0.9721254, 'f1': 0.9721762, 'auroc': 0.9967843, 'binary_precision': 0.96927017, 'binary_recall': 0.97614443, 'binary_specificity': 0.9681063, 'binary_f1_score': 0.9726952}
confusion matrix:
      0     1
0  1457    48
1    37  1514
---- Validation: 
scalar performance:
{'acc': 0.8289269, 'precision': 0.8346907, 'recall': 0.83075345, 'specificity': 0.83075345, 'f1': 0.8286247, 'auroc': 0.9074881, 'binary_precision': 0.7832168, 'binary_recall': 0.896, 'binary_specificity': 0.7655068, 'binary_f1_score': 0.83582085}
confusion matrix:
     0    1
0  506  155
1   65  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83549786, 'precision': 0.8429269, 'recall': 0.83549786, 'specificity': 0.83549786, 'f1': 0.834602, 'auroc': 0.92914295, 'binary_precision': 0.7924528, 'binary_recall': 0.90909094, 'binary_specificity': 0.7619048, 'binary_f1_score': 0.84677416}
confusion matrix:
     0    1
0  176   55
1   21  210
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 02:01:45.247912,epoch time: 0:01:46.299323,used: 0:08:56.540976,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9814959, 'recall': 0.98152006, 'specificity': 0.98152006, 'f1': 0.98134816, 'auroc': 0.9982581, 'binary_precision': 0.9940397, 'binary_recall': 0.96901226, 'binary_specificity': 0.99402785, 'binary_f1_score': 0.98136646}
confusion matrix:
      0     1
0  1498     9
1    48  1501
---- Validation: 
scalar performance:
{'acc': 0.7363919, 'precision': 0.77544403, 'recall': 0.730935, 'specificity': 0.730935, 'f1': 0.7235666, 'auroc': 0.86692405, 'binary_precision': 0.8723958, 'binary_recall': 0.536, 'binary_specificity': 0.9258699, 'binary_f1_score': 0.6640238}
confusion matrix:
     0    1
0  612   49
1  290  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78571427, 'precision': 0.8235569, 'recall': 0.78571427, 'specificity': 0.78571427, 'f1': 0.7792599, 'auroc': 0.91430074, 'binary_precision': 0.93421054, 'binary_recall': 0.6147186, 'binary_specificity': 0.95671, 'binary_f1_score': 0.7415144}
confusion matrix:
     0    1
0  221   10
1   89  142
early stop counter: 1
val acc:0.7363919019699097, best validation acc: 0.8289269208908081, corresponding to test acc:                         0.8354978561401367 / 0.8354978561401367
after epoch: 6,now: 2024-07-26 02:03:32.980791,epoch time: 0:01:47.732879,used: 0:10:44.273855,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9830735, 'recall': 0.98290956, 'specificity': 0.98290956, 'f1': 0.9829764, 'auroc': 0.998116, 'binary_precision': 0.9795788, 'binary_recall': 0.9871383, 'binary_specificity': 0.9786809, 'binary_f1_score': 0.9833441}
confusion matrix:
      0     1
0  1469    32
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.811042, 'precision': 0.8112989, 'recall': 0.81148195, 'specificity': 0.81148195, 'f1': 0.8110327, 'auroc': 0.8941047, 'binary_precision': 0.7929448, 'binary_recall': 0.8272, 'binary_specificity': 0.79576397, 'binary_f1_score': 0.8097102}
confusion matrix:
     0    1
0  526  135
1  108  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8095238, 'precision': 0.8155798, 'recall': 0.8095238, 'specificity': 0.8095238, 'f1': 0.8086056, 'auroc': 0.9070295, 'binary_precision': 0.7718631, 'binary_recall': 0.8787879, 'binary_specificity': 0.74025977, 'binary_f1_score': 0.82186234}
confusion matrix:
     0    1
0  171   60
1   28  203
early stop counter: 2
val acc:0.8110420107841492, best validation acc: 0.8289269208908081, corresponding to test acc:                         0.8354978561401367 / 0.8354978561401367
after epoch: 7,now: 2024-07-26 02:05:19.272142,epoch time: 0:01:46.291351,used: 0:12:30.565206,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9841007, 'recall': 0.98387855, 'specificity': 0.98387855, 'f1': 0.9839591, 'auroc': 0.99939466, 'binary_precision': 0.9789541, 'binary_recall': 0.98968405, 'binary_specificity': 0.97807306, 'binary_f1_score': 0.98428977}
confusion matrix:
      0     1
0  1472    33
1    16  1535
---- Validation: 
scalar performance:
{'acc': 0.85147744, 'precision': 0.85183704, 'recall': 0.850947, 'specificity': 0.850947, 'f1': 0.8512052, 'auroc': 0.90648836, 'binary_precision': 0.8580858, 'binary_recall': 0.832, 'binary_specificity': 0.8698941, 'binary_f1_score': 0.84484154}
confusion matrix:
     0    1
0  575   86
1  105  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8484849, 'precision': 0.8642106, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.84683144, 'auroc': 0.9115646, 'binary_precision': 0.9398907, 'binary_recall': 0.74458873, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.83091784}
confusion matrix:
     0    1
0  220   11
1   59  172
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-26 02:07:07.290253,epoch time: 0:01:48.018111,used: 0:14:18.583317,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.971462, 'recall': 0.9706172, 'specificity': 0.9706172, 'f1': 0.97021544, 'auroc': 0.9985658, 'binary_precision': 0.9993151, 'binary_recall': 0.941898, 'binary_specificity': 0.9993364, 'binary_f1_score': 0.9697574}
confusion matrix:
      0     1
0  1506     1
1    90  1459
---- Validation: 
scalar performance:
{'acc': 0.6407465, 'precision': 0.7545747, 'recall': 0.63109714, 'specificity': 0.63109714, 'f1': 0.58644336, 'auroc': 0.89037454, 'binary_precision': 0.9179487, 'binary_recall': 0.2864, 'binary_specificity': 0.97579426, 'binary_f1_score': 0.43658537}
confusion matrix:
     0    1
0  645   16
1  446  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66883117, 'precision': 0.7737299, 'recall': 0.66883117, 'specificity': 0.66883117, 'f1': 0.63374186, 'auroc': 0.8889451, 'binary_precision': 0.9431818, 'binary_recall': 0.35930735, 'binary_specificity': 0.978355, 'binary_f1_score': 0.52037615}
confusion matrix:
     0   1
0  226   5
1  148  83
early stop counter: 1
val acc:0.6407464742660522, best validation acc: 0.8514774441719055, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 9,now: 2024-07-26 02:08:55.569332,epoch time: 0:01:48.279079,used: 0:16:06.862396,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9715314, 'precision': 0.97150195, 'recall': 0.9715514, 'specificity': 0.9715514, 'f1': 0.9715241, 'auroc': 0.9962354, 'binary_precision': 0.9735484, 'binary_recall': 0.97041804, 'binary_specificity': 0.97268486, 'binary_f1_score': 0.97198075}
confusion matrix:
      0     1
0  1460    41
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.7706065, 'precision': 0.79169405, 'recall': 0.76670134, 'specificity': 0.76670134, 'f1': 0.764505, 'auroc': 0.8787655, 'binary_precision': 0.8634361, 'binary_recall': 0.6272, 'binary_specificity': 0.90620273, 'binary_f1_score': 0.7265987}
confusion matrix:
     0    1
0  599   62
1  233  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8551275, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.82827246, 'auroc': 0.90112627, 'binary_precision': 0.94736844, 'binary_recall': 0.7012987, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.80597025}
confusion matrix:
     0    1
0  222    9
1   69  162
early stop counter: 2
val acc:0.770606517791748, best validation acc: 0.8514774441719055, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 10,now: 2024-07-26 02:10:41.388129,epoch time: 0:01:45.818797,used: 0:17:52.681193,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98916984, 'recall': 0.9893239, 'specificity': 0.9893239, 'f1': 0.9892001, 'auroc': 0.9994036, 'binary_precision': 0.9960912, 'binary_recall': 0.98264784, 'binary_specificity': 0.996, 'binary_f1_score': 0.98932385}
confusion matrix:
      0     1
0  1494     6
1    27  1529
---- Validation: 
scalar performance:
{'acc': 0.714619, 'precision': 0.7833719, 'recall': 0.7075328, 'specificity': 0.7075328, 'f1': 0.691648, 'auroc': 0.8971716, 'binary_precision': 0.91612905, 'binary_recall': 0.4544, 'binary_specificity': 0.96066564, 'binary_f1_score': 0.6074866}
confusion matrix:
     0    1
0  635   26
1  341  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7748918, 'precision': 0.8009726, 'recall': 0.77489173, 'specificity': 0.77489173, 'f1': 0.76990706, 'auroc': 0.867525, 'binary_precision': 0.88957053, 'binary_recall': 0.62770563, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.7360406}
confusion matrix:
     0    1
0  213   18
1   86  145
early stop counter: 3
val acc:0.714618980884552, best validation acc: 0.8514774441719055, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 11,now: 2024-07-26 02:12:27.077031,epoch time: 0:01:45.688902,used: 0:19:38.370095,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98294663, 'recall': 0.982915, 'specificity': 0.982915, 'f1': 0.9826571, 'auroc': 0.9989804, 'binary_precision': 0.9993338, 'binary_recall': 0.96649486, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.98264}
confusion matrix:
      0     1
0  1503     1
1    52  1500
---- Validation: 
scalar performance:
{'acc': 0.64618975, 'precision': 0.7599217, 'recall': 0.63665354, 'specificity': 0.63665354, 'f1': 0.59401923, 'auroc': 0.9095552, 'binary_precision': 0.925, 'binary_recall': 0.296, 'binary_specificity': 0.9773071, 'binary_f1_score': 0.4484849}
confusion matrix:
     0    1
0  646   15
1  440  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64935064, 'precision': 0.7745736, 'recall': 0.64935064, 'specificity': 0.64935064, 'f1': 0.6042262, 'auroc': 0.90166974, 'binary_precision': 0.96, 'binary_recall': 0.3116883, 'binary_specificity': 0.987013, 'binary_f1_score': 0.47058827}
confusion matrix:
     0   1
0  228   3
1  159  72
early stop counter: 4
val acc:0.6461897492408752, best validation acc: 0.8514774441719055, corresponding to test acc:                         0.8484848737716675 / 0.8484848737716675
after epoch: 12,now: 2024-07-26 02:14:13.312231,epoch time: 0:01:46.235200,used: 0:21:24.605295,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9924675, 'recall': 0.99247706, 'specificity': 0.99247706, 'f1': 0.9924722, 'auroc': 0.999332, 'binary_precision': 0.99290323, 'binary_recall': 0.9922631, 'binary_specificity': 0.99269104, 'binary_f1_score': 0.99258304}
confusion matrix:
      0     1
0  1494    11
1    12  1539
---- Validation: 
scalar performance:
{'acc': 0.8164852, 'precision': 0.8278048, 'recall': 0.8138142, 'specificity': 0.8138142, 'f1': 0.81388515, 'auroc': 0.90570164, 'binary_precision': 0.8821218, 'binary_recall': 0.7184, 'binary_specificity': 0.90922844, 'binary_f1_score': 0.7918871}
confusion matrix:
     0    1
0  601   60
1  176  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85930735, 'precision': 0.8667929, 'recall': 0.8593074, 'specificity': 0.8593074, 'f1': 0.8585859, 'auroc': 0.9181612, 'binary_precision': 0.9191919, 'binary_recall': 0.7878788, 'binary_specificity': 0.93073595, 'binary_f1_score': 0.8484849}
confusion matrix:
     0    1
0  215   16
1   49  182
new oracle model saved
early stop counter: 5
val acc:0.8164852261543274, best validation acc: 0.8514774441719055, corresponding to test acc:                         0.8484848737716675 / 0.8593073487281799
after epoch: 13,now: 2024-07-26 02:15:59.463902,epoch time: 0:01:46.151671,used: 0:23:10.756966,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_52_48_seed_5_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:23:10.756966 at 2024-07-26 02:15:59.463902
persisted model performance metric: 

scalar performance:
{'acc': 0.8484849, 'precision': 0.8642106, 'recall': 0.8484849, 'specificity': 0.8484849, 'f1': 0.84683144, 'auroc': 0.9115646, 'binary_precision': 0.9398907, 'binary_recall': 0.74458873, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.83091784}
confusion matrix:
     0    1
0  220   11
1   59  172
oracle model performance metric: 

scalar performance:
{'acc': 0.85930735, 'precision': 0.8667929, 'recall': 0.8593074, 'specificity': 0.8593074, 'f1': 0.8585859, 'auroc': 0.9181612, 'binary_precision': 0.9191919, 'binary_recall': 0.7878788, 'binary_specificity': 0.93073595, 'binary_f1_score': 0.8484849}
confusion matrix:
     0    1
0  215   16
1   49  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1249 MiB |   8001 MiB | 437512 GiB | 437511 GiB |
|       from large pool |   1160 MiB |   7928 MiB | 433716 GiB | 433715 GiB |
|       from small pool |     88 MiB |    128 MiB |   3795 GiB |   3795 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1249 MiB |   8001 MiB | 437512 GiB | 437511 GiB |
|       from large pool |   1160 MiB |   7928 MiB | 433716 GiB | 433715 GiB |
|       from small pool |     88 MiB |    128 MiB |   3795 GiB |   3795 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 436860 GiB | 436859 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 433070 GiB | 433069 GiB |
|       from small pool |     88 MiB |    128 MiB |   3789 GiB |   3789 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8892 MiB |   8946 MiB |  41340 MiB |  32448 MiB |
|       from large pool |   8758 MiB |   8812 MiB |  41020 MiB |  32262 MiB |
|       from small pool |    134 MiB |    138 MiB |    320 MiB |    186 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    786 MiB |   1271 MiB | 310307 GiB | 310306 GiB |
|       from large pool |    777 MiB |   1244 MiB | 306403 GiB | 306402 GiB |
|       from small pool |      9 MiB |     53 MiB |   3903 GiB |   3903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   61688 K  |   61685 K  |
|       from large pool |     382    |     808    |   31384 K  |   31384 K  |
|       from small pool |    2074    |    2766    |   30303 K  |   30301 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   61688 K  |   61685 K  |
|       from large pool |     382    |     808    |   31384 K  |   31384 K  |
|       from small pool |    2074    |    2766    |   30303 K  |   30301 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     303    |     326    |    1239    |     936    |
|       from large pool |     236    |     259    |    1079    |     843    |
|       from small pool |      67    |      69    |     160    |      93    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     157    |     346    |   34067 K  |   34067 K  |
|       from large pool |      79    |     256    |   18466 K  |   18466 K  |
|       from small pool |      78    |     237    |   15600 K  |   15600 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 437512 GiB | 437512 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 433716 GiB | 433716 GiB |
|       from small pool |      0 KiB |    128 MiB |   3795 GiB |   3795 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 437512 GiB | 437512 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 433716 GiB | 433716 GiB |
|       from small pool |      0 KiB |    128 MiB |   3795 GiB |   3795 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 436860 GiB | 436860 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 433070 GiB | 433070 GiB |
|       from small pool |      0 KiB |    128 MiB |   3789 GiB |   3789 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2036 MiB |   8946 MiB |  41340 MiB |  39304 MiB |
|       from large pool |   1938 MiB |   8812 MiB |  41020 MiB |  39082 MiB |
|       from small pool |     98 MiB |    138 MiB |    320 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 310307 GiB | 310307 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 306404 GiB | 306404 GiB |
|       from small pool |      0 KiB |     53 MiB |   3903 GiB |   3903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   61688 K  |   61688 K  |
|       from large pool |       2    |     808    |   31384 K  |   31384 K  |
|       from small pool |       0    |    2766    |   30303 K  |   30303 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   61688 K  |   61688 K  |
|       from large pool |       2    |     808    |   31384 K  |   31384 K  |
|       from small pool |       0    |    2766    |   30303 K  |   30303 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     326    |    1239    |    1119    |
|       from large pool |      71    |     259    |    1079    |    1008    |
|       from small pool |      49    |      69    |     160    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   34067 K  |   34067 K  |
|       from large pool |       3    |     256    |   18466 K  |   18466 K  |
|       from small pool |       0    |     237    |   15601 K  |   15601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 437512 GiB | 437512 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 433716 GiB | 433716 GiB |
|       from small pool |      0 KiB |    128 MiB |   3795 GiB |   3795 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 437512 GiB | 437512 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 433716 GiB | 433716 GiB |
|       from small pool |      0 KiB |    128 MiB |   3795 GiB |   3795 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 436860 GiB | 436860 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 433070 GiB | 433070 GiB |
|       from small pool |      0 KiB |    128 MiB |   3789 GiB |   3789 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2036 MiB |   8946 MiB |  41340 MiB |  39304 MiB |
|       from large pool |   1938 MiB |   8812 MiB |  41020 MiB |  39082 MiB |
|       from small pool |     98 MiB |    138 MiB |    320 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 310307 GiB | 310307 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 306404 GiB | 306404 GiB |
|       from small pool |      0 KiB |     53 MiB |   3903 GiB |   3903 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   61688 K  |   61688 K  |
|       from large pool |       2    |     808    |   31384 K  |   31384 K  |
|       from small pool |       0    |    2766    |   30303 K  |   30303 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   61688 K  |   61688 K  |
|       from large pool |       2    |     808    |   31384 K  |   31384 K  |
|       from small pool |       0    |    2766    |   30303 K  |   30303 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     120    |     326    |    1239    |    1119    |
|       from large pool |      71    |     259    |    1079    |    1008    |
|       from small pool |      49    |      69    |     160    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   34067 K  |   34067 K  |
|       from large pool |       3    |     256    |   18466 K  |   18466 K  |
|       from small pool |       0    |     237    |   15601 K  |   15601 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693

 Experiment start at: 2024-07-26 02:16:31.197387
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95703125, 'precision': 0.95727116, 'recall': 0.95694554, 'specificity': 0.95694554, 'f1': 0.95701694, 'auroc': 0.9909284, 'binary_precision': 0.94870174, 'binary_recall': 0.9670755, 'binary_specificity': 0.9468155, 'binary_f1_score': 0.95780057}
confusion matrix:
      0     1
0  1442    81
1    51  1498
---- Validation: 
scalar performance:
{'acc': 0.74241245, 'precision': 0.7617763, 'recall': 0.7433537, 'specificity': 0.7433537, 'f1': 0.7380408, 'auroc': 0.8699229, 'binary_precision': 0.6888069, 'binary_recall': 0.87774295, 'binary_specificity': 0.60896444, 'binary_f1_score': 0.77188146}
confusion matrix:
     0    1
0  394  253
1   78  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7995495, 'precision': 0.81623936, 'recall': 0.7995496, 'specificity': 0.7995496, 'f1': 0.7968694, 'auroc': 0.9285569, 'binary_precision': 0.74358976, 'binary_recall': 0.9144144, 'binary_specificity': 0.6846847, 'binary_f1_score': 0.820202}
confusion matrix:
     0    1
0  152   70
1   19  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:18:23.860753,epoch time: 0:01:52.663366,used: 0:01:52.663366,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.97170866, 'recall': 0.9712665, 'specificity': 0.9712665, 'f1': 0.97102535, 'auroc': 0.9973887, 'binary_precision': 0.9925976, 'binary_recall': 0.9497746, 'binary_specificity': 0.9927584, 'binary_f1_score': 0.9707141}
confusion matrix:
      0     1
0  1508    11
1    78  1475
---- Validation: 
scalar performance:
{'acc': 0.81322956, 'precision': 0.8218156, 'recall': 0.81265354, 'specificity': 0.81265354, 'f1': 0.81177396, 'auroc': 0.9004012, 'binary_precision': 0.87265915, 'binary_recall': 0.73040754, 'binary_specificity': 0.89489955, 'binary_f1_score': 0.7952218}
confusion matrix:
     0    1
0  579   68
1  172  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8439865, 'recall': 0.83108103, 'specificity': 0.83108103, 'f1': 0.8294817, 'auroc': 0.9075968, 'binary_precision': 0.91061455, 'binary_recall': 0.7342342, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.81296754}
confusion matrix:
     0    1
0  206   16
1   59  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:20:12.484653,epoch time: 0:01:48.623900,used: 0:03:41.287266,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97365046, 'recall': 0.9737053, 'specificity': 0.9737053, 'f1': 0.97363234, 'auroc': 0.99754894, 'binary_precision': 0.9804177, 'binary_recall': 0.96716034, 'binary_specificity': 0.9802502, 'binary_f1_score': 0.9737439}
confusion matrix:
      0     1
0  1489    30
1    51  1502
---- Validation: 
scalar performance:
{'acc': 0.75953305, 'precision': 0.76439667, 'recall': 0.75904703, 'specificity': 0.75904703, 'f1': 0.7581835, 'auroc': 0.8563323, 'binary_precision': 0.7985481, 'binary_recall': 0.6896552, 'binary_specificity': 0.82843894, 'binary_f1_score': 0.7401177}
confusion matrix:
     0    1
0  536  111
1  198  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7702703, 'precision': 0.7859596, 'recall': 0.7702703, 'specificity': 0.7702703, 'f1': 0.7670754, 'auroc': 0.898953, 'binary_precision': 0.7189781, 'binary_recall': 0.8873874, 'binary_specificity': 0.6531532, 'binary_f1_score': 0.79435486}
confusion matrix:
     0    1
0  145   77
1   25  197
early stop counter: 1
val acc:0.7595330476760864, best validation acc: 0.8132295608520508, corresponding to test acc:                         0.8310810923576355 / 0.8310810923576355
after epoch: 3,now: 2024-07-26 02:22:00.570886,epoch time: 0:01:48.086233,used: 0:05:29.373499,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.953125, 'precision': 0.9563931, 'recall': 0.9536165, 'specificity': 0.9536165, 'f1': 0.95307124, 'auroc': 0.99692965, 'binary_precision': 0.99787986, 'binary_recall': 0.909208, 'binary_specificity': 0.998025, 'binary_f1_score': 0.9514825}
confusion matrix:
      0     1
0  1516     3
1   141  1412
---- Validation: 
scalar performance:
{'acc': 0.7151751, 'precision': 0.7952948, 'recall': 0.7133405, 'specificity': 0.7133405, 'f1': 0.69332457, 'auroc': 0.90049326, 'binary_precision': 0.94736844, 'binary_recall': 0.45141065, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.6114649}
confusion matrix:
     0    1
0  631   16
1  350  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7972973, 'precision': 0.8497899, 'recall': 0.7972973, 'specificity': 0.7972973, 'f1': 0.78939605, 'auroc': 0.89769495, 'binary_precision': 0.9852941, 'binary_recall': 0.6036036, 'binary_specificity': 0.990991, 'binary_f1_score': 0.7486034}
confusion matrix:
     0    1
0  220    2
1   88  134
early stop counter: 2
val acc:0.7151750922203064, best validation acc: 0.8132295608520508, corresponding to test acc:                         0.8310810923576355 / 0.8310810923576355
after epoch: 4,now: 2024-07-26 02:23:47.873225,epoch time: 0:01:47.302339,used: 0:07:16.675838,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9717822, 'recall': 0.97099495, 'specificity': 0.97099495, 'f1': 0.970696, 'auroc': 0.99794364, 'binary_precision': 0.9972808, 'binary_recall': 0.9446233, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.9702381}
confusion matrix:
      0     1
0  1515     4
1    86  1467
---- Validation: 
scalar performance:
{'acc': 0.81245136, 'precision': 0.82947505, 'recall': 0.8116518, 'specificity': 0.8116518, 'f1': 0.80971843, 'auroc': 0.9095633, 'binary_precision': 0.90263695, 'binary_recall': 0.6974922, 'binary_specificity': 0.9258114, 'binary_f1_score': 0.7869143}
confusion matrix:
     0    1
0  599   48
1  193  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7905405, 'precision': 0.790688, 'recall': 0.7905406, 'specificity': 0.7905406, 'f1': 0.790514, 'auroc': 0.8783784, 'binary_precision': 0.797235, 'binary_recall': 0.7792793, 'binary_specificity': 0.8018018, 'binary_f1_score': 0.78815496}
confusion matrix:
     0    1
0  178   44
1   49  173
early stop counter: 3
val acc:0.8124513626098633, best validation acc: 0.8132295608520508, corresponding to test acc:                         0.8310810923576355 / 0.8310810923576355
after epoch: 5,now: 2024-07-26 02:25:35.573901,epoch time: 0:01:47.700676,used: 0:09:04.376514,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9815484, 'recall': 0.9815687, 'specificity': 0.9815687, 'f1': 0.9814453, 'auroc': 0.9990734, 'binary_precision': 0.99211043, 'binary_recall': 0.97104245, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.9814634}
confusion matrix:
      0     1
0  1506    12
1    45  1509
---- Validation: 
scalar performance:
{'acc': 0.74396884, 'precision': 0.7856904, 'recall': 0.7426208, 'specificity': 0.7426208, 'f1': 0.7335586, 'auroc': 0.8960793, 'binary_precision': 0.89312977, 'binary_recall': 0.5501567, 'binary_specificity': 0.935085, 'binary_f1_score': 0.68089235}
confusion matrix:
     0    1
0  605   42
1  287  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.83490086, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82549214, 'auroc': 0.88440466, 'binary_precision': 0.88770056, 'binary_recall': 0.7477477, 'binary_specificity': 0.9054054, 'binary_f1_score': 0.8117359}
confusion matrix:
     0    1
0  201   21
1   56  166
early stop counter: 4
val acc:0.7439688444137573, best validation acc: 0.8132295608520508, corresponding to test acc:                         0.8310810923576355 / 0.8310810923576355
after epoch: 6,now: 2024-07-26 02:27:22.545343,epoch time: 0:01:46.971442,used: 0:10:51.347956,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.979992, 'recall': 0.9799757, 'specificity': 0.9799757, 'f1': 0.9798176, 'auroc': 0.99754465, 'binary_precision': 0.99273926, 'binary_recall': 0.96720254, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9798045}
confusion matrix:
      0     1
0  1506    11
1    51  1504
---- Validation: 
scalar performance:
{'acc': 0.8381323, 'precision': 0.8501948, 'recall': 0.83748114, 'specificity': 0.83748114, 'f1': 0.8365356, 'auroc': 0.9250847, 'binary_precision': 0.91346157, 'binary_recall': 0.7445141, 'binary_specificity': 0.93044823, 'binary_f1_score': 0.82038}
confusion matrix:
     0    1
0  602   45
1  163  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8040541, 'precision': 0.815906, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.8021988, 'auroc': 0.8773638, 'binary_precision': 0.877095, 'binary_recall': 0.7072072, 'binary_specificity': 0.9009009, 'binary_f1_score': 0.78304243}
confusion matrix:
     0    1
0  200   22
1   65  157
better model found
persisted
after epoch: 7,now: 2024-07-26 02:29:10.093961,epoch time: 0:01:47.548618,used: 0:12:38.896574,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9814345, 'recall': 0.98146456, 'specificity': 0.98146456, 'f1': 0.9814445, 'auroc': 0.9988326, 'binary_precision': 0.9837978, 'binary_recall': 0.97935486, 'binary_specificity': 0.9835743, 'binary_f1_score': 0.9815713}
confusion matrix:
      0     1
0  1497    25
1    32  1518
---- Validation: 
scalar performance:
{'acc': 0.8381323, 'precision': 0.83925956, 'recall': 0.8379282, 'specificity': 0.8379282, 'f1': 0.83793354, 'auroc': 0.91463614, 'binary_precision': 0.85714287, 'binary_recall': 0.80877745, 'binary_specificity': 0.86707884, 'binary_f1_score': 0.8322581}
confusion matrix:
     0    1
0  561   86
1  122  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6824324, 'precision': 0.7798929, 'recall': 0.6824324, 'specificity': 0.6824324, 'f1': 0.6521517, 'auroc': 0.9005965, 'binary_precision': 0.94505495, 'binary_recall': 0.3873874, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.5495208}
confusion matrix:
     0   1
0  217   5
1  136  86
early stop counter: 1
val acc:0.8381323218345642, best validation acc: 0.8381323218345642, corresponding to test acc:                         0.8040540814399719 / 0.8310810923576355
after epoch: 8,now: 2024-07-26 02:30:56.848642,epoch time: 0:01:46.754681,used: 0:14:25.651255,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.981125, 'recall': 0.9811103, 'specificity': 0.9811103, 'f1': 0.98111725, 'auroc': 0.9974892, 'binary_precision': 0.9807074, 'binary_recall': 0.98197037, 'binary_specificity': 0.9802502, 'binary_f1_score': 0.9813385}
confusion matrix:
      0     1
0  1489    30
1    28  1525
---- Validation: 
scalar performance:
{'acc': 0.8326848, 'precision': 0.8469356, 'recall': 0.83197343, 'specificity': 0.83197343, 'f1': 0.8307326, 'auroc': 0.92499256, 'binary_precision': 0.9155206, 'binary_recall': 0.73040754, 'binary_specificity': 0.9335394, 'binary_f1_score': 0.8125545}
confusion matrix:
     0    1
0  604   43
1  172  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8626126, 'precision': 0.8863248, 'recall': 0.8626126, 'specificity': 0.8626126, 'f1': 0.8604716, 'auroc': 0.9142927, 'binary_precision': 0.98203593, 'binary_recall': 0.7387387, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.8431877}
confusion matrix:
     0    1
0  219    3
1   58  164
new oracle model saved
early stop counter: 2
val acc:0.8326848149299622, best validation acc: 0.8381323218345642, corresponding to test acc:                         0.8040540814399719 / 0.8626126050949097
after epoch: 9,now: 2024-07-26 02:32:44.536014,epoch time: 0:01:47.687372,used: 0:16:13.338627,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9817746, 'recall': 0.98183346, 'specificity': 0.98183346, 'f1': 0.98177034, 'auroc': 0.998195, 'binary_precision': 0.98762214, 'binary_recall': 0.9761751, 'binary_specificity': 0.9874918, 'binary_f1_score': 0.9818653}
confusion matrix:
      0     1
0  1500    19
1    37  1516
---- Validation: 
scalar performance:
{'acc': 0.80544746, 'precision': 0.8275872, 'recall': 0.8045331, 'specificity': 0.8045331, 'f1': 0.8017709, 'auroc': 0.9086888, 'binary_precision': 0.91101694, 'binary_recall': 0.6739812, 'binary_specificity': 0.935085, 'binary_f1_score': 0.7747748}
confusion matrix:
     0    1
0  605   42
1  208  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8018018, 'precision': 0.8494831, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.7948028, 'auroc': 0.8944688, 'binary_precision': 0.9785714, 'binary_recall': 0.6171171, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.75690603}
confusion matrix:
     0    1
0  219    3
1   85  137
early stop counter: 3
val acc:0.8054474592208862, best validation acc: 0.8381323218345642, corresponding to test acc:                         0.8040540814399719 / 0.8626126050949097
after epoch: 10,now: 2024-07-26 02:34:31.497309,epoch time: 0:01:46.961295,used: 0:18:00.299922,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.9690941, 'recall': 0.968135, 'specificity': 0.968135, 'f1': 0.96776384, 'auroc': 0.9981979, 'binary_precision': 0.9972678, 'binary_recall': 0.9389067, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9672077}
confusion matrix:
      0     1
0  1513     4
1    95  1460
---- Validation: 
scalar performance:
{'acc': 0.8015564, 'precision': 0.83323395, 'recall': 0.80047286, 'specificity': 0.80047286, 'f1': 0.7963219, 'auroc': 0.9239933, 'binary_precision': 0.93424034, 'binary_recall': 0.64576805, 'binary_specificity': 0.9551777, 'binary_f1_score': 0.76367}
confusion matrix:
     0    1
0  618   29
1  226  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747748, 'precision': 0.8447205, 'recall': 0.7747748, 'specificity': 0.7747748, 'f1': 0.76273936, 'auroc': 0.9143485, 'binary_precision': 1.0, 'binary_recall': 0.5495495, 'binary_specificity': 1.0, 'binary_f1_score': 0.70930225}
confusion matrix:
     0    1
0  222    0
1  100  122
early stop counter: 4
val acc:0.801556408405304, best validation acc: 0.8381323218345642, corresponding to test acc:                         0.8040540814399719 / 0.8626126050949097
after epoch: 11,now: 2024-07-26 02:36:17.892465,epoch time: 0:01:46.395156,used: 0:19:46.695078,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9857074, 'recall': 0.98576665, 'specificity': 0.98576665, 'f1': 0.9856769, 'auroc': 0.9993018, 'binary_precision': 0.99346405, 'binary_recall': 0.978121, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.9857328}
confusion matrix:
      0     1
0  1508    10
1    34  1520
---- Validation: 
scalar performance:
{'acc': 0.73463035, 'precision': 0.80333006, 'recall': 0.73295486, 'specificity': 0.73295486, 'f1': 0.7177787, 'auroc': 0.9020848, 'binary_precision': 0.9459459, 'binary_recall': 0.4937304, 'binary_specificity': 0.9721793, 'binary_f1_score': 0.6488157}
confusion matrix:
     0    1
0  629   18
1  323  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5315315, 'precision': 0.63341343, 'recall': 0.5315316, 'specificity': 0.5315316, 'f1': 0.4209906, 'auroc': 0.8526906, 'binary_precision': 0.75, 'binary_recall': 0.0945946, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.168}
confusion matrix:
     0   1
0  215   7
1  201  21
early stop counter: 5
val acc:0.7346303462982178, best validation acc: 0.8381323218345642, corresponding to test acc:                         0.8040540814399719 / 0.8626126050949097
after epoch: 12,now: 2024-07-26 02:38:03.711983,epoch time: 0:01:45.819518,used: 0:21:32.514596,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_16_31_seed_6_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:21:32.514596 at 2024-07-26 02:38:03.711983
persisted model performance metric: 

scalar performance:
{'acc': 0.8040541, 'precision': 0.815906, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.8021988, 'auroc': 0.8773638, 'binary_precision': 0.877095, 'binary_recall': 0.7072072, 'binary_specificity': 0.9009009, 'binary_f1_score': 0.78304243}
confusion matrix:
     0    1
0  200   22
1   65  157
oracle model performance metric: 

scalar performance:
{'acc': 0.8626126, 'precision': 0.8863248, 'recall': 0.8626126, 'specificity': 0.8626126, 'f1': 0.8604716, 'auroc': 0.9142927, 'binary_precision': 0.98203593, 'binary_recall': 0.7387387, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.8431877}
confusion matrix:
     0    1
0  219    3
1   58  164
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1248 MiB |   8001 MiB | 517097 GiB | 517095 GiB |
|       from large pool |   1159 MiB |   7928 MiB | 512611 GiB | 512610 GiB |
|       from small pool |     88 MiB |    128 MiB |   4485 GiB |   4485 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1248 MiB |   8001 MiB | 517097 GiB | 517095 GiB |
|       from large pool |   1159 MiB |   7928 MiB | 512611 GiB | 512610 GiB |
|       from small pool |     88 MiB |    128 MiB |   4485 GiB |   4485 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 516377 GiB | 516376 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 511898 GiB | 511897 GiB |
|       from small pool |     88 MiB |    128 MiB |   4478 GiB |   4478 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8912 MiB |   8946 MiB |  48216 MiB |  39304 MiB |
|       from large pool |   8778 MiB |   8812 MiB |  47860 MiB |  39082 MiB |
|       from small pool |    134 MiB |    138 MiB |    356 MiB |    222 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    873 MiB |   1271 MiB | 364855 GiB | 364854 GiB |
|       from large pool |    864 MiB |   1244 MiB | 360241 GiB | 360240 GiB |
|       from small pool |      9 MiB |     53 MiB |   4614 GiB |   4614 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2450    |    3301    |   72913 K  |   72911 K  |
|       from large pool |     382    |     808    |   37098 K  |   37097 K  |
|       from small pool |    2068    |    2766    |   35815 K  |   35813 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2450    |    3301    |   72913 K  |   72911 K  |
|       from large pool |     382    |     808    |   37098 K  |   37097 K  |
|       from small pool |    2068    |    2766    |   35815 K  |   35813 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     314    |     326    |    1433    |    1119    |
|       from large pool |     247    |     259    |    1255    |    1008    |
|       from small pool |      67    |      69    |     178    |     111    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     160    |     346    |   40487 K  |   40487 K  |
|       from large pool |      81    |     256    |   21991 K  |   21991 K  |
|       from small pool |      79    |     237    |   18495 K  |   18495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 517097 GiB | 517097 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 512611 GiB | 512611 GiB |
|       from small pool |      0 KiB |    128 MiB |   4485 GiB |   4485 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 517097 GiB | 517097 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 512611 GiB | 512611 GiB |
|       from small pool |      0 KiB |    128 MiB |   4485 GiB |   4485 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 516377 GiB | 516377 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 511898 GiB | 511898 GiB |
|       from small pool |      0 KiB |    128 MiB |   4478 GiB |   4478 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2122 MiB |   8946 MiB |  48216 MiB |  46094 MiB |
|       from large pool |   2024 MiB |   8812 MiB |  47860 MiB |  45836 MiB |
|       from small pool |     98 MiB |    138 MiB |    356 MiB |    258 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 364856 GiB | 364856 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 360242 GiB | 360241 GiB |
|       from small pool |      0 KiB |     53 MiB |   4614 GiB |   4614 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   72913 K  |   72913 K  |
|       from large pool |       2    |     808    |   37098 K  |   37098 K  |
|       from small pool |       0    |    2766    |   35815 K  |   35815 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   72913 K  |   72913 K  |
|       from large pool |       2    |     808    |   37098 K  |   37098 K  |
|       from small pool |       0    |    2766    |   35815 K  |   35815 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1433    |    1309    |
|       from large pool |      75    |     259    |    1255    |    1180    |
|       from small pool |      49    |      69    |     178    |     129    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   40487 K  |   40487 K  |
|       from large pool |       3    |     256    |   21992 K  |   21992 K  |
|       from small pool |       0    |     237    |   18495 K  |   18495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 517097 GiB | 517097 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 512611 GiB | 512611 GiB |
|       from small pool |      0 KiB |    128 MiB |   4485 GiB |   4485 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 517097 GiB | 517097 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 512611 GiB | 512611 GiB |
|       from small pool |      0 KiB |    128 MiB |   4485 GiB |   4485 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 516377 GiB | 516377 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 511898 GiB | 511898 GiB |
|       from small pool |      0 KiB |    128 MiB |   4478 GiB |   4478 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2122 MiB |   8946 MiB |  48216 MiB |  46094 MiB |
|       from large pool |   2024 MiB |   8812 MiB |  47860 MiB |  45836 MiB |
|       from small pool |     98 MiB |    138 MiB |    356 MiB |    258 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 364856 GiB | 364856 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 360242 GiB | 360241 GiB |
|       from small pool |      0 KiB |     53 MiB |   4614 GiB |   4614 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   72913 K  |   72913 K  |
|       from large pool |       2    |     808    |   37098 K  |   37098 K  |
|       from small pool |       0    |    2766    |   35815 K  |   35815 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   72913 K  |   72913 K  |
|       from large pool |       2    |     808    |   37098 K  |   37098 K  |
|       from small pool |       0    |    2766    |   35815 K  |   35815 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1433    |    1309    |
|       from large pool |      75    |     259    |    1255    |    1180    |
|       from small pool |      49    |      69    |     178    |     129    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   40487 K  |   40487 K  |
|       from large pool |       3    |     256    |   21992 K  |   21992 K  |
|       from small pool |       0    |     237    |   18495 K  |   18495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693

 Experiment start at: 2024-07-26 02:38:35.446405
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89941406, 'precision': 0.91493905, 'recall': 0.9009514, 'specificity': 0.9009514, 'f1': 0.898694, 'auroc': 0.9888452, 'binary_precision': 0.9992019, 'binary_recall': 0.8025641, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.8901529}
confusion matrix:
      0     1
0  1511     1
1   308  1252
---- Validation: 
scalar performance:
{'acc': 0.6046154, 'precision': 0.75032437, 'recall': 0.5986506, 'specificity': 0.5986506, 'f1': 0.5306741, 'auroc': 0.82827175, 'binary_precision': 0.9375, 'binary_recall': 0.2109375, 'binary_specificity': 0.98636365, 'binary_f1_score': 0.34438777}
confusion matrix:
     0    1
0  651    9
1  505  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55458516, 'precision': 0.730086, 'recall': 0.55458516, 'specificity': 0.55458516, 'f1': 0.44963598, 'auroc': 0.87746227, 'binary_precision': 0.9310345, 'binary_recall': 0.11790393, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.20930234}
confusion matrix:
     0   1
0  227   2
1  202  27
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:40:25.095488,epoch time: 0:01:49.649083,used: 0:01:49.649083,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.96943873, 'recall': 0.9695462, 'specificity': 0.9695462, 'f1': 0.96940005, 'auroc': 0.99605167, 'binary_precision': 0.97908497, 'binary_recall': 0.9602564, 'binary_specificity': 0.978836, 'binary_f1_score': 0.96957934}
confusion matrix:
      0     1
0  1480    32
1    62  1498
---- Validation: 
scalar performance:
{'acc': 0.84307694, 'precision': 0.84413314, 'recall': 0.8426373, 'specificity': 0.8426373, 'f1': 0.84280574, 'auroc': 0.8949242, 'binary_precision': 0.85973597, 'binary_recall': 0.8140625, 'binary_specificity': 0.8712121, 'binary_f1_score': 0.8362761}
confusion matrix:
     0    1
0  575   85
1  119  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.8461628, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.83996975, 'auroc': 0.91739285, 'binary_precision': 0.89, 'binary_recall': 0.77729255, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.8298368}
confusion matrix:
     0    1
0  207   22
1   51  178
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:42:11.675000,epoch time: 0:01:46.579512,used: 0:03:36.228595,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97848976, 'recall': 0.9785409, 'specificity': 0.9785409, 'f1': 0.9785116, 'auroc': 0.99788785, 'binary_precision': 0.980695, 'binary_recall': 0.97692305, 'binary_specificity': 0.98015875, 'binary_f1_score': 0.9788054}
confusion matrix:
      0     1
0  1482    30
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.8076923, 'precision': 0.8099397, 'recall': 0.80700755, 'specificity': 0.80700755, 'f1': 0.80706716, 'auroc': 0.86464965, 'binary_precision': 0.8327645, 'binary_recall': 0.7625, 'binary_specificity': 0.8515152, 'binary_f1_score': 0.7960849}
confusion matrix:
     0    1
0  562   98
1  152  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122271, 'precision': 0.8210679, 'recall': 0.8122271, 'specificity': 0.8122271, 'f1': 0.8109255, 'auroc': 0.9234378, 'binary_precision': 0.76779026, 'binary_recall': 0.8951965, 'binary_specificity': 0.72925764, 'binary_f1_score': 0.8266129}
confusion matrix:
     0    1
0  167   62
1   24  205
early stop counter: 1
val acc:0.807692289352417, best validation acc: 0.8430769443511963, corresponding to test acc:                         0.8406113386154175 / 0.8406113386154175
after epoch: 3,now: 2024-07-26 02:43:58.313164,epoch time: 0:01:46.638164,used: 0:05:22.866759,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9729186, 'recall': 0.9724054, 'specificity': 0.9724054, 'f1': 0.97200215, 'auroc': 0.99762416, 'binary_precision': 0.99797297, 'binary_recall': 0.94679487, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9717105}
confusion matrix:
      0     1
0  1509     3
1    83  1477
---- Validation: 
scalar performance:
{'acc': 0.61615384, 'precision': 0.7227366, 'recall': 0.61072445, 'specificity': 0.61072445, 'f1': 0.5581541, 'auroc': 0.82678324, 'binary_precision': 0.8730159, 'binary_recall': 0.2578125, 'binary_specificity': 0.96363634, 'binary_f1_score': 0.39806998}
confusion matrix:
     0    1
0  636   24
1  475  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69650656, 'precision': 0.7627754, 'recall': 0.69650656, 'specificity': 0.69650656, 'f1': 0.67608464, 'auroc': 0.8832021, 'binary_precision': 0.8947368, 'binary_recall': 0.44541484, 'binary_specificity': 0.9475983, 'binary_f1_score': 0.5947522}
confusion matrix:
     0    1
0  217   12
1  127  102
early stop counter: 2
val acc:0.6161538362503052, best validation acc: 0.8430769443511963, corresponding to test acc:                         0.8406113386154175 / 0.8406113386154175
after epoch: 4,now: 2024-07-26 02:45:45.022170,epoch time: 0:01:46.709006,used: 0:07:09.575765,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9277344, 'precision': 0.93598616, 'recall': 0.9288461, 'specificity': 0.9288461, 'f1': 0.9275018, 'auroc': 0.997781, 'binary_precision': 1.0, 'binary_recall': 0.8576923, 'binary_specificity': 1.0, 'binary_f1_score': 0.92339545}
confusion matrix:
      0     1
0  1512     0
1   222  1338
---- Validation: 
scalar performance:
{'acc': 0.6069231, 'precision': 0.7306144, 'recall': 0.6011837, 'specificity': 0.6011837, 'f1': 0.5396368, 'auroc': 0.88464963, 'binary_precision': 0.8957055, 'binary_recall': 0.228125, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.36363637}
confusion matrix:
     0    1
0  643   17
1  494  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77074236, 'precision': 0.82421446, 'recall': 0.77074236, 'specificity': 0.77074236, 'f1': 0.7608831, 'auroc': 0.8993726, 'binary_precision': 0.9558824, 'binary_recall': 0.5676856, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.71232885}
confusion matrix:
     0    1
0  223    6
1   99  130
early stop counter: 3
val acc:0.6069231033325195, best validation acc: 0.8430769443511963, corresponding to test acc:                         0.8406113386154175 / 0.8406113386154175
after epoch: 5,now: 2024-07-26 02:47:31.854850,epoch time: 0:01:46.832680,used: 0:08:56.408445,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98377776, 'recall': 0.9838828, 'specificity': 0.9838828, 'f1': 0.9837235, 'auroc': 0.99879384, 'binary_precision': 0.9941099, 'binary_recall': 0.9737179, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.9838083}
confusion matrix:
      0     1
0  1503     9
1    41  1519
---- Validation: 
scalar performance:
{'acc': 0.6330769, 'precision': 0.7221529, 'recall': 0.62810135, 'specificity': 0.62810135, 'f1': 0.5872908, 'auroc': 0.8338139, 'binary_precision': 0.85903084, 'binary_recall': 0.3046875, 'binary_specificity': 0.95151514, 'binary_f1_score': 0.44982696}
confusion matrix:
     0    1
0  628   32
1  445  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75982535, 'precision': 0.78660524, 'recall': 0.75982535, 'specificity': 0.75982535, 'f1': 0.7540807, 'auroc': 0.86684084, 'binary_precision': 0.8742138, 'binary_recall': 0.6069869, 'binary_specificity': 0.91266376, 'binary_f1_score': 0.7164948}
confusion matrix:
     0    1
0  209   20
1   90  139
early stop counter: 4
val acc:0.6330769062042236, best validation acc: 0.8430769443511963, corresponding to test acc:                         0.8406113386154175 / 0.8406113386154175
after epoch: 6,now: 2024-07-26 02:49:20.008977,epoch time: 0:01:48.154127,used: 0:10:44.562572,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.9698726, 'recall': 0.9676638, 'specificity': 0.9676638, 'f1': 0.96803993, 'auroc': 0.99900115, 'binary_precision': 0.9446472, 'binary_recall': 0.99551284, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.9694132}
confusion matrix:
      0     1
0  1421    91
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.81153846, 'precision': 0.82187986, 'recall': 0.81290245, 'specificity': 0.81290245, 'f1': 0.8104391, 'auroc': 0.89016986, 'binary_precision': 0.7602108, 'binary_recall': 0.9015625, 'binary_specificity': 0.72424245, 'binary_f1_score': 0.82487494}
confusion matrix:
     0    1
0  478  182
1   63  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8318777, 'precision': 0.83728683, 'recall': 0.8318777, 'specificity': 0.8318777, 'f1': 0.83120096, 'auroc': 0.91691613, 'binary_precision': 0.79457366, 'binary_recall': 0.8951965, 'binary_specificity': 0.768559, 'binary_f1_score': 0.8418891}
confusion matrix:
     0    1
0  176   53
1   24  205
early stop counter: 5
val acc:0.8115384578704834, best validation acc: 0.8430769443511963, corresponding to test acc:                         0.8406113386154175 / 0.8406113386154175
after epoch: 7,now: 2024-07-26 02:51:06.781419,epoch time: 0:01:46.772442,used: 0:12:31.335014,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_38_35_seed_7_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:12:31.335014 at 2024-07-26 02:51:06.781419
persisted model performance metric: 

scalar performance:
{'acc': 0.84061134, 'precision': 0.8461628, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.83996975, 'auroc': 0.91739285, 'binary_precision': 0.89, 'binary_recall': 0.77729255, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.8298368}
confusion matrix:
     0    1
0  207   22
1   51  178
oracle model performance metric: 

scalar performance:
{'acc': 0.84061134, 'precision': 0.8461628, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.83996975, 'auroc': 0.91739285, 'binary_precision': 0.89, 'binary_recall': 0.77729255, 'binary_specificity': 0.9039301, 'binary_f1_score': 0.8298368}
confusion matrix:
     0    1
0  207   22
1   51  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1246 MiB |   8001 MiB | 563614 GiB | 563613 GiB |
|       from large pool |   1158 MiB |   7928 MiB | 558724 GiB | 558723 GiB |
|       from small pool |     88 MiB |    128 MiB |   4890 GiB |   4889 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1246 MiB |   8001 MiB | 563614 GiB | 563613 GiB |
|       from large pool |   1158 MiB |   7928 MiB | 558724 GiB | 558723 GiB |
|       from small pool |     88 MiB |    128 MiB |   4890 GiB |   4889 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 562853 GiB | 562852 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 557971 GiB | 557970 GiB |
|       from small pool |     88 MiB |    128 MiB |   4882 GiB |   4882 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8716 MiB |   8946 MiB |  54810 MiB |  46094 MiB |
|       from large pool |   8582 MiB |   8812 MiB |  54418 MiB |  45836 MiB |
|       from small pool |    134 MiB |    138 MiB |    392 MiB |    258 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1033 MiB |   1271 MiB | 397250 GiB | 397249 GiB |
|       from large pool |   1023 MiB |   1244 MiB | 392220 GiB | 392219 GiB |
|       from small pool |      9 MiB |     53 MiB |   5030 GiB |   5030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   79489 K  |   79487 K  |
|       from large pool |     382    |     808    |   40440 K  |   40439 K  |
|       from small pool |    2074    |    2766    |   39049 K  |   39047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   79489 K  |   79487 K  |
|       from large pool |     382    |     808    |   40440 K  |   40439 K  |
|       from small pool |    2074    |    2766    |   39049 K  |   39047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     314    |     326    |    1623    |    1309    |
|       from large pool |     247    |     259    |    1427    |    1180    |
|       from small pool |      67    |      69    |     196    |     129    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     155    |     346    |   44114 K  |   44114 K  |
|       from large pool |      79    |     256    |   23947 K  |   23947 K  |
|       from small pool |      76    |     237    |   20167 K  |   20166 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 563614 GiB | 563614 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 558724 GiB | 558724 GiB |
|       from small pool |      0 KiB |    128 MiB |   4890 GiB |   4890 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 563614 GiB | 563614 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 558724 GiB | 558724 GiB |
|       from small pool |      0 KiB |    128 MiB |   4890 GiB |   4890 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 562853 GiB | 562853 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 557971 GiB | 557971 GiB |
|       from small pool |      0 KiB |    128 MiB |   4882 GiB |   4882 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2280 MiB |   8946 MiB |  54810 MiB |  52530 MiB |
|       from large pool |   2182 MiB |   8812 MiB |  54418 MiB |  52236 MiB |
|       from small pool |     98 MiB |    138 MiB |    392 MiB |    294 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 397251 GiB | 397251 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 392221 GiB | 392221 GiB |
|       from small pool |      0 KiB |     53 MiB |   5030 GiB |   5030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   79489 K  |   79489 K  |
|       from large pool |       2    |     808    |   40440 K  |   40440 K  |
|       from small pool |       0    |    2766    |   39049 K  |   39049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   79489 K  |   79489 K  |
|       from large pool |       2    |     808    |   40440 K  |   40440 K  |
|       from small pool |       0    |    2766    |   39049 K  |   39049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1623    |    1499    |
|       from large pool |      75    |     259    |    1427    |    1352    |
|       from small pool |      49    |      69    |     196    |     147    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   44114 K  |   44114 K  |
|       from large pool |       3    |     256    |   23947 K  |   23947 K  |
|       from small pool |       0    |     237    |   20167 K  |   20167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 563614 GiB | 563614 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 558724 GiB | 558724 GiB |
|       from small pool |      0 KiB |    128 MiB |   4890 GiB |   4890 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 563614 GiB | 563614 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 558724 GiB | 558724 GiB |
|       from small pool |      0 KiB |    128 MiB |   4890 GiB |   4890 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 562853 GiB | 562853 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 557971 GiB | 557971 GiB |
|       from small pool |      0 KiB |    128 MiB |   4882 GiB |   4882 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2280 MiB |   8946 MiB |  54810 MiB |  52530 MiB |
|       from large pool |   2182 MiB |   8812 MiB |  54418 MiB |  52236 MiB |
|       from small pool |     98 MiB |    138 MiB |    392 MiB |    294 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 397251 GiB | 397251 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 392221 GiB | 392221 GiB |
|       from small pool |      0 KiB |     53 MiB |   5030 GiB |   5030 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   79489 K  |   79489 K  |
|       from large pool |       2    |     808    |   40440 K  |   40440 K  |
|       from small pool |       0    |    2766    |   39049 K  |   39049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   79489 K  |   79489 K  |
|       from large pool |       2    |     808    |   40440 K  |   40440 K  |
|       from small pool |       0    |    2766    |   39049 K  |   39049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1623    |    1499    |
|       from large pool |      75    |     259    |    1427    |    1352    |
|       from small pool |      49    |      69    |     196    |     147    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   44114 K  |   44114 K  |
|       from large pool |       3    |     256    |   23947 K  |   23947 K  |
|       from small pool |       0    |     237    |   20167 K  |   20167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693

 Experiment start at: 2024-07-26 02:51:38.727574
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.90789473, 'precision': 0.9212761, 'recall': 0.9089061, 'specificity': 0.9089061, 'f1': 0.90729755, 'auroc': 0.99306965, 'binary_precision': 0.9992057, 'binary_recall': 0.8184776, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.899857}
confusion matrix:
      0     1
0  1502     1
1   279  1258
---- Validation: 
scalar performance:
{'acc': 0.7316319, 'precision': 0.74541277, 'recall': 0.7275567, 'specificity': 0.7275567, 'f1': 0.7253202, 'auroc': 0.8405286, 'binary_precision': 0.79617834, 'binary_recall': 0.5990415, 'binary_specificity': 0.85607195, 'binary_f1_score': 0.6836828}
confusion matrix:
     0    1
0  571   96
1  251  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8004587, 'precision': 0.8126218, 'recall': 0.80045867, 'specificity': 0.80045867, 'f1': 0.79849875, 'auroc': 0.88184917, 'binary_precision': 0.8742857, 'binary_recall': 0.70183486, 'binary_specificity': 0.89908254, 'binary_f1_score': 0.7786259}
confusion matrix:
     0    1
0  196   22
1   65  153
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:53:27.099513,epoch time: 0:01:48.371939,used: 0:01:48.371939,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95986843, 'precision': 0.9606215, 'recall': 0.9596524, 'specificity': 0.9596524, 'f1': 0.95983315, 'auroc': 0.9949539, 'binary_precision': 0.9447236, 'binary_recall': 0.97789335, 'binary_specificity': 0.94141144, 'binary_f1_score': 0.9610223}
confusion matrix:
      0     1
0  1414    88
1    34  1504
---- Validation: 
scalar performance:
{'acc': 0.8290797, 'precision': 0.83042073, 'recall': 0.83011055, 'specificity': 0.83011055, 'f1': 0.8290731, 'auroc': 0.91215014, 'binary_precision': 0.8, 'binary_recall': 0.8626198, 'binary_specificity': 0.7976012, 'binary_f1_score': 0.83013064}
confusion matrix:
     0    1
0  532  135
1   86  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8353139, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8348068, 'auroc': 0.91240215, 'binary_precision': 0.84761906, 'binary_recall': 0.8165138, 'binary_specificity': 0.853211, 'binary_f1_score': 0.8317757}
confusion matrix:
     0    1
0  186   32
1   40  178
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:55:13.231887,epoch time: 0:01:46.132374,used: 0:03:34.504313,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9677632, 'precision': 0.96828425, 'recall': 0.9679924, 'specificity': 0.9679924, 'f1': 0.96776116, 'auroc': 0.9967984, 'binary_precision': 0.98714477, 'binary_recall': 0.94863456, 'binary_specificity': 0.9873502, 'binary_f1_score': 0.9675066}
confusion matrix:
      0     1
0  1483    19
1    79  1459
---- Validation: 
scalar performance:
{'acc': 0.78190255, 'precision': 0.82710195, 'recall': 0.77588964, 'specificity': 0.77588964, 'f1': 0.7714116, 'auroc': 0.91043115, 'binary_precision': 0.9410256, 'binary_recall': 0.586262, 'binary_specificity': 0.9655172, 'binary_f1_score': 0.72244096}
confusion matrix:
     0    1
0  644   23
1  259  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78669727, 'precision': 0.8353021, 'recall': 0.78669727, 'specificity': 0.78669727, 'f1': 0.7786765, 'auroc': 0.9116446, 'binary_precision': 0.962963, 'binary_recall': 0.5963303, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.7365439}
confusion matrix:
     0    1
0  213    5
1   88  130
early stop counter: 1
val acc:0.781902551651001, best validation acc: 0.8290796875953674, corresponding to test acc:                         0.8348624110221863 / 0.8348624110221863
after epoch: 3,now: 2024-07-26 02:56:59.126898,epoch time: 0:01:45.895011,used: 0:05:20.399324,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9802632, 'precision': 0.9802476, 'recall': 0.98029745, 'specificity': 0.98029745, 'f1': 0.9802619, 'auroc': 0.9974469, 'binary_precision': 0.98362803, 'binary_recall': 0.97722834, 'binary_specificity': 0.9833666, 'binary_f1_score': 0.9804177}
confusion matrix:
      0     1
0  1478    25
1    35  1502
---- Validation: 
scalar performance:
{'acc': 0.85150814, 'precision': 0.85895765, 'recall': 0.8491984, 'specificity': 0.8491984, 'f1': 0.8500152, 'auroc': 0.9198092, 'binary_precision': 0.9033457, 'binary_recall': 0.7763578, 'binary_specificity': 0.922039, 'binary_f1_score': 0.8350516}
confusion matrix:
     0    1
0  615   52
1  140  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8362492, 'recall': 0.8348624, 'specificity': 0.8348624, 'f1': 0.834692, 'auroc': 0.8962419, 'binary_precision': 0.85784316, 'binary_recall': 0.8027523, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.82938397}
confusion matrix:
     0    1
0  189   29
1   43  175
better model found
persisted
after epoch: 4,now: 2024-07-26 02:58:45.212955,epoch time: 0:01:46.086057,used: 0:07:06.485381,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97335523, 'precision': 0.9741646, 'recall': 0.97313726, 'specificity': 0.97313726, 'f1': 0.9733314, 'auroc': 0.998539, 'binary_precision': 0.95731324, 'binary_recall': 0.99154747, 'binary_specificity': 0.95472705, 'binary_f1_score': 0.9741297}
confusion matrix:
      0     1
0  1434    68
1    13  1525
---- Validation: 
scalar performance:
{'acc': 0.8128384, 'precision': 0.8260784, 'recall': 0.81598854, 'specificity': 0.81598854, 'f1': 0.81182253, 'auroc': 0.90540826, 'binary_precision': 0.7519685, 'binary_recall': 0.9153355, 'binary_specificity': 0.71664166, 'binary_f1_score': 0.8256484}
confusion matrix:
     0    1
0  478  189
1   53  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7729358, 'precision': 0.7874587, 'recall': 0.77293575, 'specificity': 0.77293575, 'f1': 0.77003115, 'auroc': 0.8975886, 'binary_precision': 0.72284645, 'binary_recall': 0.8853211, 'binary_specificity': 0.6605505, 'binary_f1_score': 0.79587626}
confusion matrix:
     0    1
0  144   74
1   25  193
early stop counter: 1
val acc:0.8128383755683899, best validation acc: 0.8515081405639648, corresponding to test acc:                         0.8348624110221863 / 0.8348624110221863
after epoch: 5,now: 2024-07-26 03:00:31.607756,epoch time: 0:01:46.394801,used: 0:08:52.880182,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9782895, 'precision': 0.97833735, 'recall': 0.9784069, 'specificity': 0.9784069, 'f1': 0.9782891, 'auroc': 0.99761254, 'binary_precision': 0.98743385, 'binary_recall': 0.9694805, 'binary_specificity': 0.98733336, 'binary_f1_score': 0.9783748}
confusion matrix:
      0     1
0  1481    19
1    47  1493
---- Validation: 
scalar performance:
{'acc': 0.82830626, 'precision': 0.83508337, 'recall': 0.82597315, 'specificity': 0.82597315, 'f1': 0.8265801, 'auroc': 0.8865887, 'binary_precision': 0.8754647, 'binary_recall': 0.75239617, 'binary_specificity': 0.8995502, 'binary_f1_score': 0.8092784}
confusion matrix:
     0    1
0  600   67
1  155  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.8128746, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.811784, 'auroc': 0.8668041, 'binary_precision': 0.8300971, 'binary_recall': 0.7844037, 'binary_specificity': 0.8394495, 'binary_f1_score': 0.8066038}
confusion matrix:
     0    1
0  183   35
1   47  171
early stop counter: 2
val acc:0.828306257724762, best validation acc: 0.8515081405639648, corresponding to test acc:                         0.8348624110221863 / 0.8348624110221863
after epoch: 6,now: 2024-07-26 03:02:19.770148,epoch time: 0:01:48.162392,used: 0:10:41.042574,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.9787673, 'recall': 0.9787595, 'specificity': 0.9787595, 'f1': 0.9786184, 'auroc': 0.99907446, 'binary_precision': 0.9906729, 'binary_recall': 0.96684, 'binary_specificity': 0.9906791, 'binary_f1_score': 0.9786114}
confusion matrix:
      0     1
0  1488    14
1    51  1487
---- Validation: 
scalar performance:
{'acc': 0.7757154, 'precision': 0.82814085, 'recall': 0.7692543, 'specificity': 0.7692543, 'f1': 0.7633996, 'auroc': 0.9373165, 'binary_precision': 0.9516129, 'binary_recall': 0.5654952, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.7094188}
confusion matrix:
     0    1
0  649   18
1  272  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.853211, 'precision': 0.88216007, 'recall': 0.85321105, 'specificity': 0.85321105, 'f1': 0.8503775, 'auroc': 0.9272789, 'binary_precision': 0.98734176, 'binary_recall': 0.7155963, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.82978725}
confusion matrix:
     0    1
0  216    2
1   62  156
new oracle model saved
early stop counter: 3
val acc:0.7757154107093811, best validation acc: 0.8515081405639648, corresponding to test acc:                         0.8348624110221863 / 0.853210985660553
after epoch: 7,now: 2024-07-26 03:04:05.406703,epoch time: 0:01:45.636555,used: 0:12:26.679129,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.9845009, 'recall': 0.9840982, 'specificity': 0.9840982, 'f1': 0.9842035, 'auroc': 0.99944806, 'binary_precision': 0.97511166, 'binary_recall': 0.99414444, 'binary_specificity': 0.9740519, 'binary_f1_score': 0.98453605}
confusion matrix:
      0     1
0  1464    39
1     9  1528
---- Validation: 
scalar performance:
{'acc': 0.8221191, 'precision': 0.82366, 'recall': 0.82321656, 'specificity': 0.82321656, 'f1': 0.82210624, 'auroc': 0.88446915, 'binary_precision': 0.7920354, 'binary_recall': 0.8578275, 'binary_specificity': 0.7886057, 'binary_f1_score': 0.8236196}
confusion matrix:
     0    1
0  526  141
1   89  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.828172, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.820132, 'auroc': 0.9131596, 'binary_precision': 0.78, 'binary_recall': 0.8944954, 'binary_specificity': 0.7477064, 'binary_f1_score': 0.8333333}
confusion matrix:
     0    1
0  163   55
1   23  195
early stop counter: 4
val acc:0.8221191167831421, best validation acc: 0.8515081405639648, corresponding to test acc:                         0.8348624110221863 / 0.853210985660553
after epoch: 8,now: 2024-07-26 03:05:51.050209,epoch time: 0:01:45.643506,used: 0:14:12.322635,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8835526, 'precision': 0.9040457, 'recall': 0.88230175, 'specificity': 0.88230175, 'f1': 0.8818017, 'auroc': 0.9935886, 'binary_precision': 0.8158035, 'binary_recall': 0.99414444, 'binary_specificity': 0.77045906, 'binary_f1_score': 0.89618766}
confusion matrix:
      0     1
0  1158   345
1     9  1528
---- Validation: 
scalar performance:
{'acc': 0.7927301, 'precision': 0.8147528, 'recall': 0.796842, 'specificity': 0.796842, 'f1': 0.7904457, 'auroc': 0.92106664, 'binary_precision': 0.72319204, 'binary_recall': 0.92651755, 'binary_specificity': 0.6671664, 'binary_f1_score': 0.8123249}
confusion matrix:
     0    1
0  445  222
1   46  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86238533, 'precision': 0.8693806, 'recall': 0.8623853, 'specificity': 0.8623853, 'f1': 0.8617307, 'auroc': 0.92664754, 'binary_precision': 0.92021275, 'binary_recall': 0.79357797, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.8522167}
confusion matrix:
     0    1
0  203   15
1   45  173
new oracle model saved
early stop counter: 5
val acc:0.7927300930023193, best validation acc: 0.8515081405639648, corresponding to test acc:                         0.8348624110221863 / 0.8623853325843811
after epoch: 9,now: 2024-07-26 03:07:36.784229,epoch time: 0:01:45.734020,used: 0:15:58.056655,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_51_38_seed_8_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:15:58.056655 at 2024-07-26 03:07:36.784229
persisted model performance metric: 

scalar performance:
{'acc': 0.8348624, 'precision': 0.8362492, 'recall': 0.8348624, 'specificity': 0.8348624, 'f1': 0.834692, 'auroc': 0.8962419, 'binary_precision': 0.85784316, 'binary_recall': 0.8027523, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.82938397}
confusion matrix:
     0    1
0  189   29
1   43  175
oracle model performance metric: 

scalar performance:
{'acc': 0.86238533, 'precision': 0.8693806, 'recall': 0.8623853, 'specificity': 0.8623853, 'f1': 0.8617307, 'auroc': 0.92664754, 'binary_precision': 0.92021275, 'binary_recall': 0.79357797, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.8522167}
confusion matrix:
     0    1
0  203   15
1   45  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1248 MiB |   8001 MiB | 622755 GiB | 622754 GiB |
|       from large pool |   1160 MiB |   7928 MiB | 617351 GiB | 617350 GiB |
|       from small pool |     88 MiB |    128 MiB |   5403 GiB |   5403 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1248 MiB |   8001 MiB | 622755 GiB | 622754 GiB |
|       from large pool |   1160 MiB |   7928 MiB | 617351 GiB | 617350 GiB |
|       from small pool |     88 MiB |    128 MiB |   5403 GiB |   5403 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 621927 GiB | 621926 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 616532 GiB | 616531 GiB |
|       from small pool |     88 MiB |    128 MiB |   5395 GiB |   5395 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8704 MiB |   8946 MiB |  61234 MiB |  52530 MiB |
|       from large pool |   8570 MiB |   8812 MiB |  60806 MiB |  52236 MiB |
|       from small pool |    134 MiB |    138 MiB |    428 MiB |    294 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    861 MiB |   1271 MiB | 438413 GiB | 438412 GiB |
|       from large pool |    851 MiB |   1244 MiB | 432853 GiB | 432852 GiB |
|       from small pool |      9 MiB |     53 MiB |   5559 GiB |   5559 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2450    |    3301    |   87840 K  |   87837 K  |
|       from large pool |     382    |     808    |   44686 K  |   44686 K  |
|       from small pool |    2068    |    2766    |   43153 K  |   43151 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2450    |    3301    |   87840 K  |   87837 K  |
|       from large pool |     382    |     808    |   44686 K  |   44686 K  |
|       from small pool |    2068    |    2766    |   43153 K  |   43151 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     307    |     326    |    1806    |    1499    |
|       from large pool |     240    |     259    |    1592    |    1352    |
|       from small pool |      67    |      69    |     214    |     147    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     158    |     346    |   48969 K  |   48969 K  |
|       from large pool |      82    |     256    |   26647 K  |   26647 K  |
|       from small pool |      76    |     237    |   22321 K  |   22321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 622755 GiB | 622755 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 617351 GiB | 617351 GiB |
|       from small pool |      0 KiB |    128 MiB |   5403 GiB |   5403 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 622755 GiB | 622755 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 617351 GiB | 617351 GiB |
|       from small pool |      0 KiB |    128 MiB |   5403 GiB |   5403 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 621927 GiB | 621927 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 616532 GiB | 616532 GiB |
|       from small pool |      0 KiB |    128 MiB |   5395 GiB |   5395 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2110 MiB |   8946 MiB |  61234 MiB |  59124 MiB |
|       from large pool |   2012 MiB |   8812 MiB |  60806 MiB |  58794 MiB |
|       from small pool |     98 MiB |    138 MiB |    428 MiB |    330 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 438413 GiB | 438413 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 432854 GiB | 432854 GiB |
|       from small pool |      0 KiB |     53 MiB |   5559 GiB |   5559 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   87840 K  |   87840 K  |
|       from large pool |       2    |     808    |   44686 K  |   44686 K  |
|       from small pool |       0    |    2766    |   43153 K  |   43153 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   87840 K  |   87840 K  |
|       from large pool |       2    |     808    |   44686 K  |   44686 K  |
|       from small pool |       0    |    2766    |   43153 K  |   43153 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1806    |    1682    |
|       from large pool |      75    |     259    |    1592    |    1517    |
|       from small pool |      49    |      69    |     214    |     165    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   48969 K  |   48969 K  |
|       from large pool |       3    |     256    |   26648 K  |   26648 K  |
|       from small pool |       0    |     237    |   22321 K  |   22321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 622755 GiB | 622755 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 617351 GiB | 617351 GiB |
|       from small pool |      0 KiB |    128 MiB |   5403 GiB |   5403 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 622755 GiB | 622755 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 617351 GiB | 617351 GiB |
|       from small pool |      0 KiB |    128 MiB |   5403 GiB |   5403 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 621927 GiB | 621927 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 616532 GiB | 616532 GiB |
|       from small pool |      0 KiB |    128 MiB |   5395 GiB |   5395 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2110 MiB |   8946 MiB |  61234 MiB |  59124 MiB |
|       from large pool |   2012 MiB |   8812 MiB |  60806 MiB |  58794 MiB |
|       from small pool |     98 MiB |    138 MiB |    428 MiB |    330 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 438413 GiB | 438413 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 432854 GiB | 432854 GiB |
|       from small pool |      0 KiB |     53 MiB |   5559 GiB |   5559 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   87840 K  |   87840 K  |
|       from large pool |       2    |     808    |   44686 K  |   44686 K  |
|       from small pool |       0    |    2766    |   43153 K  |   43153 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   87840 K  |   87840 K  |
|       from large pool |       2    |     808    |   44686 K  |   44686 K  |
|       from small pool |       0    |    2766    |   43153 K  |   43153 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1806    |    1682    |
|       from large pool |      75    |     259    |    1592    |    1517    |
|       from small pool |      49    |      69    |     214    |     165    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   48969 K  |   48969 K  |
|       from large pool |       3    |     256    |   26648 K  |   26648 K  |
|       from small pool |       0    |     237    |   22321 K  |   22321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693

 Experiment start at: 2024-07-26 03:08:07.804212
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9456806, 'precision': 0.9491861, 'recall': 0.9460076, 'specificity': 0.9460076, 'f1': 0.94559956, 'auroc': 0.9886229, 'binary_precision': 0.99070764, 'binary_recall': 0.9005848, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.94349897}
confusion matrix:
      0     1
0  1504    13
1   153  1386
---- Validation: 
scalar performance:
{'acc': 0.80772203, 'precision': 0.8169104, 'recall': 0.8068576, 'specificity': 0.8068576, 'f1': 0.80600023, 'auroc': 0.88363934, 'binary_precision': 0.8684211, 'binary_recall': 0.72074884, 'binary_specificity': 0.8929664, 'binary_f1_score': 0.7877238}
confusion matrix:
     0    1
0  584   70
1  179  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108696, 'precision': 0.81300557, 'recall': 0.8108696, 'specificity': 0.8108696, 'f1': 0.81054634, 'auroc': 0.87444234, 'binary_precision': 0.83886254, 'binary_recall': 0.7695652, 'binary_specificity': 0.8521739, 'binary_f1_score': 0.8027211}
confusion matrix:
     0    1
0  196   34
1   53  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:09:56.351632,epoch time: 0:01:48.547420,used: 0:01:48.547420,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96138746, 'precision': 0.9614251, 'recall': 0.9613619, 'specificity': 0.9613619, 'f1': 0.9613832, 'auroc': 0.99323976, 'binary_precision': 0.958683, 'binary_recall': 0.9649123, 'binary_specificity': 0.9578115, 'binary_f1_score': 0.9617876}
confusion matrix:
      0     1
0  1453    64
1    54  1485
---- Validation: 
scalar performance:
{'acc': 0.8710425, 'precision': 0.8730029, 'recall': 0.87068063, 'specificity': 0.87068063, 'f1': 0.8707833, 'auroc': 0.9209378, 'binary_precision': 0.897651, 'binary_recall': 0.8346334, 'binary_specificity': 0.90672785, 'binary_f1_score': 0.86499596}
confusion matrix:
     0    1
0  593   61
1  106  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84130436, 'precision': 0.8575318, 'recall': 0.84130436, 'specificity': 0.84130436, 'f1': 0.839483, 'auroc': 0.89257085, 'binary_precision': 0.93370163, 'binary_recall': 0.73478264, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.8223845}
confusion matrix:
     0    1
0  218   12
1   61  169
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:11:42.212347,epoch time: 0:01:45.860715,used: 0:03:34.408135,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.9648978, 'recall': 0.9645872, 'specificity': 0.9645872, 'f1': 0.96464944, 'auroc': 0.99681544, 'binary_precision': 0.9560229, 'binary_recall': 0.97465885, 'binary_specificity': 0.9545155, 'binary_f1_score': 0.96525097}
confusion matrix:
      0     1
0  1448    69
1    39  1500
---- Validation: 
scalar performance:
{'acc': 0.8030888, 'precision': 0.8031384, 'recall': 0.80315423, 'specificity': 0.80315423, 'f1': 0.8030883, 'auroc': 0.8647564, 'binary_precision': 0.7960123, 'binary_recall': 0.8096724, 'binary_specificity': 0.7966361, 'binary_f1_score': 0.8027842}
confusion matrix:
     0    1
0  521  133
1  122  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8021662, 'recall': 0.79347825, 'specificity': 0.79347825, 'f1': 0.791983, 'auroc': 0.9002646, 'binary_precision': 0.75092936, 'binary_recall': 0.87826085, 'binary_specificity': 0.70869565, 'binary_f1_score': 0.80961925}
confusion matrix:
     0    1
0  163   67
1   28  202
early stop counter: 1
val acc:0.8030887842178345, best validation acc: 0.8710424900054932, corresponding to test acc:                         0.841304361820221 / 0.841304361820221
after epoch: 3,now: 2024-07-26 03:13:28.304301,epoch time: 0:01:46.091954,used: 0:05:20.500089,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.972268, 'recall': 0.97196454, 'specificity': 0.97196454, 'f1': 0.9718559, 'auroc': 0.9964762, 'binary_precision': 0.98790324, 'binary_recall': 0.95578676, 'binary_specificity': 0.9881423, 'binary_f1_score': 0.9715796}
confusion matrix:
      0     1
0  1500    18
1    68  1470
---- Validation: 
scalar performance:
{'acc': 0.8100386, 'precision': 0.8365104, 'recall': 0.808624, 'specificity': 0.808624, 'f1': 0.8057234, 'auroc': 0.9078728, 'binary_precision': 0.9284165, 'binary_recall': 0.6677067, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.7767695}
confusion matrix:
     0    1
0  621   33
1  213  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326087, 'precision': 0.86147916, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.82919824, 'auroc': 0.919863, 'binary_precision': 0.96363634, 'binary_recall': 0.6913043, 'binary_specificity': 0.973913, 'binary_f1_score': 0.80506325}
confusion matrix:
     0    1
0  224    6
1   71  159
early stop counter: 2
val acc:0.8100386261940002, best validation acc: 0.8710424900054932, corresponding to test acc:                         0.841304361820221 / 0.841304361820221
after epoch: 4,now: 2024-07-26 03:15:14.182908,epoch time: 0:01:45.878607,used: 0:07:06.378696,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.9805832, 'recall': 0.9801725, 'specificity': 0.9801725, 'f1': 0.9800366, 'auroc': 0.99855566, 'binary_precision': 0.9986505, 'binary_recall': 0.9616634, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97980803}
confusion matrix:
      0     1
0  1515     2
1    59  1480
---- Validation: 
scalar performance:
{'acc': 0.57915056, 'precision': 0.7080059, 'recall': 0.57514656, 'specificity': 0.57514656, 'f1': 0.49675533, 'auroc': 0.80837893, 'binary_precision': 0.86923075, 'binary_recall': 0.17628706, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.2931258}
confusion matrix:
     0    1
0  637   17
1  528  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5282609, 'precision': 0.63747126, 'recall': 0.5282608, 'specificity': 0.5282608, 'f1': 0.4113519, 'auroc': 0.87240076, 'binary_precision': 0.76, 'binary_recall': 0.08260869, 'binary_specificity': 0.973913, 'binary_f1_score': 0.14901961}
confusion matrix:
     0   1
0  224   6
1  211  19
early stop counter: 3
val acc:0.5791505575180054, best validation acc: 0.8710424900054932, corresponding to test acc:                         0.841304361820221 / 0.841304361820221
after epoch: 5,now: 2024-07-26 03:17:00.267512,epoch time: 0:01:46.084604,used: 0:08:52.463300,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.9826327, 'recall': 0.9824326, 'specificity': 0.9824326, 'f1': 0.98232895, 'auroc': 0.9989184, 'binary_precision': 0.9966555, 'binary_recall': 0.96816117, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98220176}
confusion matrix:
      0     1
0  1512     5
1    49  1490
---- Validation: 
scalar performance:
{'acc': 0.75752896, 'precision': 0.79735744, 'recall': 0.7556749, 'specificity': 0.7556749, 'f1': 0.74822044, 'auroc': 0.90326416, 'binary_precision': 0.9037037, 'binary_recall': 0.5709828, 'binary_specificity': 0.940367, 'binary_f1_score': 0.6998088}
confusion matrix:
     0    1
0  615   39
1  275  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8086957, 'precision': 0.8382633, 'recall': 0.8086957, 'specificity': 0.8086957, 'f1': 0.8044218, 'auroc': 0.88916826, 'binary_precision': 0.9382716, 'binary_recall': 0.66086954, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.7755102}
confusion matrix:
     0    1
0  220   10
1   78  152
early stop counter: 4
val acc:0.7575289607048035, best validation acc: 0.8710424900054932, corresponding to test acc:                         0.841304361820221 / 0.841304361820221
after epoch: 6,now: 2024-07-26 03:18:46.193367,epoch time: 0:01:45.925855,used: 0:10:38.389155,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885688, 'recall': 0.98858654, 'specificity': 0.98858654, 'f1': 0.9885471, 'auroc': 0.99928343, 'binary_precision': 0.99408674, 'binary_recall': 0.9831059, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9885658}
confusion matrix:
      0     1
0  1508     9
1    26  1513
---- Validation: 
scalar performance:
{'acc': 0.8023166, 'precision': 0.83335096, 'recall': 0.8007772, 'specificity': 0.8007772, 'f1': 0.7970299, 'auroc': 0.9108814, 'binary_precision': 0.9325843, 'binary_recall': 0.6474259, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.7642726}
confusion matrix:
     0    1
0  624   30
1  226  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326087, 'precision': 0.85958797, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.8294089, 'auroc': 0.900983, 'binary_precision': 0.9580838, 'binary_recall': 0.6956522, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.80604535}
confusion matrix:
     0    1
0  223    7
1   70  160
early stop counter: 5
val acc:0.8023166060447693, best validation acc: 0.8710424900054932, corresponding to test acc:                         0.841304361820221 / 0.841304361820221
after epoch: 7,now: 2024-07-26 03:20:31.574689,epoch time: 0:01:45.381322,used: 0:12:23.770477,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_08_07_seed_9_23064693
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:12:23.770477 at 2024-07-26 03:20:31.574689
persisted model performance metric: 

scalar performance:
{'acc': 0.84130436, 'precision': 0.8575318, 'recall': 0.84130436, 'specificity': 0.84130436, 'f1': 0.839483, 'auroc': 0.89257085, 'binary_precision': 0.93370163, 'binary_recall': 0.73478264, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.8223845}
confusion matrix:
     0    1
0  218   12
1   61  169
oracle model performance metric: 

scalar performance:
{'acc': 0.84130436, 'precision': 0.8575318, 'recall': 0.84130436, 'specificity': 0.84130436, 'f1': 0.839483, 'auroc': 0.89257085, 'binary_precision': 0.93370163, 'binary_recall': 0.73478264, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.8223845}
confusion matrix:
     0    1
0  218   12
1   61  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1250 MiB |   8001 MiB | 669104 GiB | 669103 GiB |
|       from large pool |   1162 MiB |   7928 MiB | 663299 GiB | 663298 GiB |
|       from small pool |     88 MiB |    128 MiB |   5805 GiB |   5805 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1250 MiB |   8001 MiB | 669104 GiB | 669103 GiB |
|       from large pool |   1162 MiB |   7928 MiB | 663299 GiB | 663298 GiB |
|       from small pool |     88 MiB |    128 MiB |   5805 GiB |   5805 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1234 MiB |   7988 MiB | 668169 GiB | 668168 GiB |
|       from large pool |   1146 MiB |   7915 MiB | 662372 GiB | 662371 GiB |
|       from small pool |     88 MiB |    128 MiB |   5796 GiB |   5796 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8914 MiB |   8946 MiB |  68038 MiB |  59124 MiB |
|       from large pool |   8780 MiB |   8812 MiB |  67574 MiB |  58794 MiB |
|       from small pool |    134 MiB |    138 MiB |    464 MiB |    330 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    799 MiB |   1271 MiB | 470681 GiB | 470680 GiB |
|       from large pool |    789 MiB |   1244 MiB | 464707 GiB | 464707 GiB |
|       from small pool |      9 MiB |     53 MiB |   5973 GiB |   5973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   94380 K  |   94377 K  |
|       from large pool |     382    |     808    |   48010 K  |   48010 K  |
|       from small pool |    2074    |    2766    |   46369 K  |   46367 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   94380 K  |   94377 K  |
|       from large pool |     382    |     808    |   48010 K  |   48010 K  |
|       from small pool |    2074    |    2766    |   46369 K  |   46367 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     315    |     326    |    1997    |    1682    |
|       from large pool |     248    |     259    |    1765    |    1517    |
|       from small pool |      67    |      69    |     232    |     165    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |     346    |   52754 K  |   52754 K  |
|       from large pool |      74    |     256    |   28772 K  |   28772 K  |
|       from small pool |      76    |     237    |   23982 K  |   23982 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8001 MiB | 669104 GiB | 669104 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 663299 GiB | 663299 GiB |
|       from small pool |      0 KiB |    128 MiB |   5805 GiB |   5805 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8001 MiB | 669104 GiB | 669104 GiB |
|       from large pool |  16640 KiB |   7928 MiB | 663299 GiB | 663299 GiB |
|       from small pool |      0 KiB |    128 MiB |   5805 GiB |   5805 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7988 MiB | 668169 GiB | 668169 GiB |
|       from large pool |  16640 KiB |   7915 MiB | 662372 GiB | 662372 GiB |
|       from small pool |      0 KiB |    128 MiB |   5796 GiB |   5796 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2050 MiB |   8946 MiB |  68038 MiB |  65988 MiB |
|       from large pool |   1952 MiB |   8812 MiB |  67574 MiB |  65622 MiB |
|       from small pool |     98 MiB |    138 MiB |    464 MiB |    366 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1271 MiB | 470682 GiB | 470682 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 464708 GiB | 464708 GiB |
|       from small pool |      0 KiB |     53 MiB |   5973 GiB |   5973 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   94380 K  |   94380 K  |
|       from large pool |       2    |     808    |   48010 K  |   48010 K  |
|       from small pool |       0    |    2766    |   46369 K  |   46369 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   94380 K  |   94380 K  |
|       from large pool |       2    |     808    |   48010 K  |   48010 K  |
|       from small pool |       0    |    2766    |   46369 K  |   46369 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     326    |    1997    |    1876    |
|       from large pool |      72    |     259    |    1765    |    1693    |
|       from small pool |      49    |      69    |     232    |     183    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     346    |   52755 K  |   52755 K  |
|       from large pool |       3    |     256    |   28772 K  |   28772 K  |
|       from small pool |       0    |     237    |   23982 K  |   23982 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 03:20:39 2024]
Finished job 0.
1 of 1 steps (100%) done
