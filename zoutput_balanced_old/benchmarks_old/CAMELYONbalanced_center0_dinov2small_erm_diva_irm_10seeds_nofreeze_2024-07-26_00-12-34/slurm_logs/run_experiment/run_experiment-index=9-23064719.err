Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:17:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719

 Experiment start at: 2024-07-26 00:17:46.708594
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9453125, 'precision': 0.9461746, 'recall': 0.9450625, 'specificity': 0.9450625, 'f1': 0.9452568, 'auroc': 0.98896587, 'binary_precision': 0.92941177, 'binary_recall': 0.9652733, 'binary_specificity': 0.92485166, 'binary_f1_score': 0.9470032}
confusion matrix:
      0     1
0  1403   114
1    54  1501
---- Validation: 
scalar performance:
{'acc': 0.72282606, 'precision': 0.7299515, 'recall': 0.7239983, 'specificity': 0.7239983, 'f1': 0.72130996, 'auroc': 0.8326633, 'binary_precision': 0.68582886, 'binary_recall': 0.807874, 'binary_specificity': 0.64012253, 'binary_f1_score': 0.7418655}
confusion matrix:
     0    1
0  418  235
1  122  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.7919355, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7904756, 'auroc': 0.87997836, 'binary_precision': 0.77292573, 'binary_recall': 0.82325584, 'binary_specificity': 0.75813955, 'binary_f1_score': 0.7972973}
confusion matrix:
     0    1
0  163   52
1   38  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:20:31.910206,epoch time: 0:02:45.201612,used: 0:02:45.201612,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.96850085, 'recall': 0.968364, 'specificity': 0.968364, 'f1': 0.9684151, 'auroc': 0.99455297, 'binary_precision': 0.96494585, 'binary_recall': 0.97300774, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.96896}
confusion matrix:
      0     1
0  1461    55
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.8074534, 'precision': 0.8092989, 'recall': 0.8079801, 'specificity': 0.8079801, 'f1': 0.8073191, 'auroc': 0.8862139, 'binary_precision': 0.78165936, 'binary_recall': 0.84566927, 'binary_specificity': 0.770291, 'binary_f1_score': 0.8124054}
confusion matrix:
     0    1
0  503  150
1   98  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.8475013, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84381354, 'auroc': 0.9144186, 'binary_precision': 0.8814433, 'binary_recall': 0.7953488, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8361859}
confusion matrix:
     0    1
0  192   23
1   44  171
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:23:14.706379,epoch time: 0:02:42.796173,used: 0:05:27.997785,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.9669795, 'recall': 0.9655868, 'specificity': 0.9655868, 'f1': 0.96515274, 'auroc': 0.99594057, 'binary_precision': 0.9993104, 'binary_recall': 0.9318328, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9643927}
confusion matrix:
      0     1
0  1516     1
1   106  1449
---- Validation: 
scalar performance:
{'acc': 0.6925466, 'precision': 0.7647974, 'recall': 0.6888401, 'specificity': 0.6888401, 'f1': 0.6674239, 'auroc': 0.82708275, 'binary_precision': 0.89966553, 'binary_recall': 0.42362204, 'binary_specificity': 0.9540582, 'binary_f1_score': 0.5760171}
confusion matrix:
     0    1
0  623   30
1  366  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59302324, 'precision': 0.7187627, 'recall': 0.5930233, 'specificity': 0.5930233, 'f1': 0.52472985, 'auroc': 0.87134665, 'binary_precision': 0.88461536, 'binary_recall': 0.2139535, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.34456927}
confusion matrix:
     0   1
0  209   6
1  169  46
early stop counter: 1
val acc:0.6925466060638428, best validation acc: 0.8074533939361572, corresponding to test acc:                         0.8441860675811768 / 0.8441860675811768
after epoch: 3,now: 2024-07-26 00:25:57.453211,epoch time: 0:02:42.746832,used: 0:08:10.744617,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97604644, 'recall': 0.975844, 'specificity': 0.975844, 'f1': 0.9755852, 'auroc': 0.9964267, 'binary_precision': 0.99465954, 'binary_recall': 0.95696855, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9754501}
confusion matrix:
      0     1
0  1507     8
1    67  1490
---- Validation: 
scalar performance:
{'acc': 0.81909937, 'precision': 0.82648546, 'recall': 0.8180331, 'specificity': 0.8180331, 'f1': 0.8176962, 'auroc': 0.8921224, 'binary_precision': 0.87222224, 'binary_recall': 0.7417323, 'binary_specificity': 0.89433384, 'binary_f1_score': 0.80170214}
confusion matrix:
     0    1
0  584   69
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.87090284, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8307753, 'auroc': 0.92882645, 'binary_precision': 0.9864865, 'binary_recall': 0.67906976, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8044077}
confusion matrix:
     0    1
0  213    2
1   69  146
better model found
persisted
after epoch: 4,now: 2024-07-26 00:28:43.268326,epoch time: 0:02:45.815115,used: 0:10:56.559732,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.97315097, 'recall': 0.9731592, 'specificity': 0.9731592, 'f1': 0.97298175, 'auroc': 0.9962444, 'binary_precision': 0.98614776, 'binary_recall': 0.9601798, 'binary_specificity': 0.98613864, 'binary_f1_score': 0.9729905}
confusion matrix:
      0     1
0  1494    21
1    62  1495
---- Validation: 
scalar performance:
{'acc': 0.8090062, 'precision': 0.815712, 'recall': 0.81001073, 'specificity': 0.81001073, 'f1': 0.80830324, 'auroc': 0.9008573, 'binary_precision': 0.7660739, 'binary_recall': 0.88188976, 'binary_specificity': 0.7381317, 'binary_f1_score': 0.8199122}
confusion matrix:
     0    1
0  482  171
1   75  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84260166, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84177494, 'auroc': 0.9269443, 'binary_precision': 0.8585366, 'binary_recall': 0.81860465, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.8380953}
confusion matrix:
     0    1
0  186   29
1   39  176
early stop counter: 1
val acc:0.8090062141418457, best validation acc: 0.8190993666648865, corresponding to test acc:                         0.8348837494850159 / 0.8441860675811768
after epoch: 5,now: 2024-07-26 00:31:27.904503,epoch time: 0:02:44.636177,used: 0:13:41.195909,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9788615, 'recall': 0.9783548, 'specificity': 0.9783548, 'f1': 0.9785018, 'auroc': 0.9987688, 'binary_precision': 0.96920174, 'binary_recall': 0.98909557, 'binary_specificity': 0.967614, 'binary_f1_score': 0.9790476}
confusion matrix:
      0     1
0  1464    49
1    17  1542
---- Validation: 
scalar performance:
{'acc': 0.8136646, 'precision': 0.8278507, 'recall': 0.81219566, 'specificity': 0.81219566, 'f1': 0.8111026, 'auroc': 0.90458333, 'binary_precision': 0.8926441, 'binary_recall': 0.7070866, 'binary_specificity': 0.91730475, 'binary_f1_score': 0.7891037}
confusion matrix:
     0    1
0  599   54
1  186  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.808759, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7875914, 'auroc': 0.89533806, 'binary_precision': 0.8834356, 'binary_recall': 0.66976744, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.7619047}
confusion matrix:
     0    1
0  196   19
1   71  144
early stop counter: 2
val acc:0.8136646151542664, best validation acc: 0.8190993666648865, corresponding to test acc:                         0.8348837494850159 / 0.8441860675811768
after epoch: 6,now: 2024-07-26 00:34:12.417076,epoch time: 0:02:44.512573,used: 0:16:25.708482,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911895, 'recall': 0.99124044, 'specificity': 0.99124044, 'f1': 0.9912098, 'auroc': 0.9996214, 'binary_precision': 0.9935484, 'binary_recall': 0.98908156, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.99130994}
confusion matrix:
      0     1
0  1505    10
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.8082298, 'precision': 0.8111464, 'recall': 0.8075304, 'specificity': 0.8075304, 'f1': 0.8075057, 'auroc': 0.8839891, 'binary_precision': 0.8379791, 'binary_recall': 0.7574803, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.79569894}
confusion matrix:
     0    1
0  560   93
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.7685807, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.7671951, 'auroc': 0.8308059, 'binary_precision': 0.78606963, 'binary_recall': 0.7348837, 'binary_specificity': 0.8, 'binary_f1_score': 0.75961536}
confusion matrix:
     0    1
0  172   43
1   57  158
early stop counter: 3
val acc:0.8082298040390015, best validation acc: 0.8190993666648865, corresponding to test acc:                         0.8348837494850159 / 0.8441860675811768
after epoch: 7,now: 2024-07-26 00:36:55.141759,epoch time: 0:02:42.724683,used: 0:19:08.433165,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856559, 'recall': 0.9857086, 'specificity': 0.9857086, 'f1': 0.9856756, 'auroc': 0.99787354, 'binary_precision': 0.9883721, 'binary_recall': 0.9832905, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.98582476}
confusion matrix:
      0     1
0  1498    18
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.6754658, 'precision': 0.73975635, 'recall': 0.6717777, 'specificity': 0.6717777, 'f1': 0.64927036, 'auroc': 0.7931558, 'binary_precision': 0.8604651, 'binary_recall': 0.40787402, 'binary_specificity': 0.93568146, 'binary_f1_score': 0.55341876}
confusion matrix:
     0    1
0  611   42
1  376  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5976744, 'precision': 0.6834173, 'recall': 0.5976744, 'specificity': 0.5976744, 'f1': 0.54443294, 'auroc': 0.8144727, 'binary_precision': 0.8088235, 'binary_recall': 0.25581396, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.3886926}
confusion matrix:
     0   1
0  202  13
1  160  55
early stop counter: 4
val acc:0.6754658222198486, best validation acc: 0.8190993666648865, corresponding to test acc:                         0.8348837494850159 / 0.8441860675811768
after epoch: 8,now: 2024-07-26 00:39:38.350922,epoch time: 0:02:43.209163,used: 0:21:51.642328,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9831654, 'recall': 0.98322105, 'specificity': 0.98322105, 'f1': 0.9830728, 'auroc': 0.9990652, 'binary_precision': 0.9940906, 'binary_recall': 0.9723828, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.9831169}
confusion matrix:
      0     1
0  1506     9
1    43  1514
---- Validation: 
scalar performance:
{'acc': 0.6195652, 'precision': 0.7370875, 'recall': 0.61456394, 'specificity': 0.61456394, 'f1': 0.5605504, 'auroc': 0.8756605, 'binary_precision': 0.9005525, 'binary_recall': 0.25669292, 'binary_specificity': 0.97243494, 'binary_f1_score': 0.39950982}
confusion matrix:
     0    1
0  635   18
1  472  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.7737063, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.6385456, 'auroc': 0.9089886, 'binary_precision': 0.9404762, 'binary_recall': 0.36744186, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.5284281}
confusion matrix:
     0   1
0  210   5
1  136  79
early stop counter: 5
val acc:0.6195651888847351, best validation acc: 0.8190993666648865, corresponding to test acc:                         0.8348837494850159 / 0.8441860675811768
after epoch: 9,now: 2024-07-26 00:42:20.890431,epoch time: 0:02:42.539509,used: 0:24:34.181837,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_17_46_seed_0_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:24:34.181837 at 2024-07-26 00:42:20.890431
persisted model performance metric: 

scalar performance:
{'acc': 0.83488375, 'precision': 0.87090284, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.8307753, 'auroc': 0.92882645, 'binary_precision': 0.9864865, 'binary_recall': 0.67906976, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8044077}
confusion matrix:
     0    1
0  213    2
1   69  146
oracle model performance metric: 

scalar performance:
{'acc': 0.84418607, 'precision': 0.8475013, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84381354, 'auroc': 0.9144186, 'binary_precision': 0.8814433, 'binary_recall': 0.7953488, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8361859}
confusion matrix:
     0    1
0  192   23
1   44  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1618 MiB |   8293 MiB |  59575 GiB |  59574 GiB |
|       from large pool |   1529 MiB |   8218 MiB |  59056 GiB |  59054 GiB |
|       from small pool |     89 MiB |    126 MiB |    519 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1618 MiB |   8293 MiB |  59575 GiB |  59574 GiB |
|       from large pool |   1529 MiB |   8218 MiB |  59056 GiB |  59054 GiB |
|       from small pool |     89 MiB |    126 MiB |    519 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB |  59493 GiB |  59492 GiB |
|       from large pool |   1513 MiB |   8209 MiB |  58974 GiB |  58973 GiB |
|       from small pool |     89 MiB |    126 MiB |    518 GiB |    518 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9090 MiB |   9090 MiB |   9090 MiB |      0 B   |
|       from large pool |   8956 MiB |   8956 MiB |   8956 MiB |      0 B   |
|       from small pool |    134 MiB |    134 MiB |    134 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1001 MiB |   1022 MiB |  39611 GiB |  39610 GiB |
|       from large pool |    992 MiB |   1017 MiB |  39077 GiB |  39076 GiB |
|       from small pool |      8 MiB |     24 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3289    |    8422 K  |    8420 K  |
|       from large pool |     382    |     808    |    4285 K  |    4285 K  |
|       from small pool |    2062    |    2754    |    4136 K  |    4134 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3289    |    8422 K  |    8420 K  |
|       from large pool |     382    |     808    |    4285 K  |    4285 K  |
|       from small pool |    2062    |    2754    |    4136 K  |    4134 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     326    |     326    |     326    |       0    |
|       from large pool |     259    |     259    |     259    |       0    |
|       from small pool |      67    |      67    |      67    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     155    |     329    |    4635 K  |    4634 K  |
|       from large pool |      75    |     249    |    2757 K  |    2757 K  |
|       from small pool |      80    |     234    |    1877 K  |    1877 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8293 MiB |  59575 GiB |  59575 GiB |
|       from large pool |  16640 KiB |   8218 MiB |  59056 GiB |  59056 GiB |
|       from small pool |      0 KiB |    126 MiB |    519 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8293 MiB |  59575 GiB |  59575 GiB |
|       from large pool |  16640 KiB |   8218 MiB |  59056 GiB |  59056 GiB |
|       from small pool |      0 KiB |    126 MiB |    519 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB |  59493 GiB |  59493 GiB |
|       from large pool |  16640 KiB |   8209 MiB |  58974 GiB |  58974 GiB |
|       from small pool |      0 KiB |    126 MiB |    518 GiB |    518 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2620 MiB |   9090 MiB |   9090 MiB |   6470 MiB |
|       from large pool |   2522 MiB |   8956 MiB |   8956 MiB |   6434 MiB |
|       from small pool |     98 MiB |    134 MiB |    134 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1102 MiB |  39612 GiB |  39612 GiB |
|       from large pool |  24320 KiB |   1082 MiB |  39078 GiB |  39078 GiB |
|       from small pool |      0 KiB |     44 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    8422 K  |    8422 K  |
|       from large pool |       2    |     808    |    4285 K  |    4285 K  |
|       from small pool |       0    |    2754    |    4136 K  |    4136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    8422 K  |    8422 K  |
|       from large pool |       2    |     808    |    4285 K  |    4285 K  |
|       from small pool |       0    |    2754    |    4136 K  |    4136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     326    |     326    |     203    |
|       from large pool |      74    |     259    |     259    |     185    |
|       from small pool |      49    |      67    |      67    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |    4635 K  |    4635 K  |
|       from large pool |       3    |     249    |    2757 K  |    2757 K  |
|       from small pool |       0    |     234    |    1877 K  |    1877 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8293 MiB |  59575 GiB |  59575 GiB |
|       from large pool |  16640 KiB |   8218 MiB |  59056 GiB |  59056 GiB |
|       from small pool |      0 KiB |    126 MiB |    519 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8293 MiB |  59575 GiB |  59575 GiB |
|       from large pool |  16640 KiB |   8218 MiB |  59056 GiB |  59056 GiB |
|       from small pool |      0 KiB |    126 MiB |    519 GiB |    519 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB |  59493 GiB |  59493 GiB |
|       from large pool |  16640 KiB |   8209 MiB |  58974 GiB |  58974 GiB |
|       from small pool |      0 KiB |    126 MiB |    518 GiB |    518 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2620 MiB |   9090 MiB |   9090 MiB |   6470 MiB |
|       from large pool |   2522 MiB |   8956 MiB |   8956 MiB |   6434 MiB |
|       from small pool |     98 MiB |    134 MiB |    134 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1102 MiB |  39612 GiB |  39612 GiB |
|       from large pool |  24320 KiB |   1082 MiB |  39078 GiB |  39078 GiB |
|       from small pool |      0 KiB |     44 MiB |    533 GiB |    533 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3289    |    8422 K  |    8422 K  |
|       from large pool |       2    |     808    |    4285 K  |    4285 K  |
|       from small pool |       0    |    2754    |    4136 K  |    4136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3289    |    8422 K  |    8422 K  |
|       from large pool |       2    |     808    |    4285 K  |    4285 K  |
|       from small pool |       0    |    2754    |    4136 K  |    4136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     123    |     326    |     326    |     203    |
|       from large pool |      74    |     259    |     259    |     185    |
|       from small pool |      49    |      67    |      67    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |    4635 K  |    4635 K  |
|       from large pool |       3    |     249    |    2757 K  |    2757 K  |
|       from small pool |       0    |     234    |    1877 K  |    1877 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719

 Experiment start at: 2024-07-26 00:42:55.828071
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95214844, 'precision': 0.9521296, 'recall': 0.9521762, 'specificity': 0.9521762, 'f1': 0.95214474, 'auroc': 0.9891571, 'binary_precision': 0.9553398, 'binary_recall': 0.9498069, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.9525653}
confusion matrix:
      0     1
0  1449    69
1    78  1476
---- Validation: 
scalar performance:
{'acc': 0.6088993, 'precision': 0.74961615, 'recall': 0.6149514, 'specificity': 0.6149514, 'f1': 0.5510015, 'auroc': 0.9062127, 'binary_precision': 0.5580558, 'binary_recall': 0.984127, 'binary_specificity': 0.24577573, 'binary_f1_score': 0.7122344}
confusion matrix:
     0    1
0  160  491
1   10  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.7598152, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.41219324, 'auroc': 0.88677526, 'binary_precision': 0.5196305, 'binary_recall': 1.0, 'binary_specificity': 0.075555556, 'binary_f1_score': 0.6838906}
confusion matrix:
    0    1
0  17  208
1   0  225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:45:40.435620,epoch time: 0:02:44.607549,used: 0:02:44.607549,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96191406, 'precision': 0.96298265, 'recall': 0.9616176, 'specificity': 0.9616176, 'f1': 0.9618678, 'auroc': 0.9958154, 'binary_precision': 0.9438964, 'binary_recall': 0.9833012, 'binary_specificity': 0.939934, 'binary_f1_score': 0.9631959}
confusion matrix:
      0     1
0  1424    91
1    26  1531
---- Validation: 
scalar performance:
{'acc': 0.79547226, 'precision': 0.79671264, 'recall': 0.7959806, 'specificity': 0.7959806, 'f1': 0.79540634, 'auroc': 0.865314, 'binary_precision': 0.772997, 'binary_recall': 0.8269841, 'binary_specificity': 0.764977, 'binary_f1_score': 0.7990798}
confusion matrix:
     0    1
0  498  153
1  109  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8135563, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.81330013, 'auroc': 0.8844889, 'binary_precision': 0.8051948, 'binary_recall': 0.82666665, 'binary_specificity': 0.8, 'binary_f1_score': 0.8157894}
confusion matrix:
     0    1
0  180   45
1   39  186
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:48:24.006994,epoch time: 0:02:43.571374,used: 0:05:28.178923,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853471, 'recall': 0.98544645, 'specificity': 0.98544645, 'f1': 0.9853507, 'auroc': 0.99871373, 'binary_precision': 0.99219257, 'binary_recall': 0.978819, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.98546034}
confusion matrix:
      0     1
0  1502    12
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.7876659, 'precision': 0.8083178, 'recall': 0.78550947, 'specificity': 0.78550947, 'f1': 0.7831429, 'auroc': 0.88282007, 'binary_precision': 0.88412017, 'binary_recall': 0.6539683, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.7518248}
confusion matrix:
     0    1
0  597   54
1  218  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8818089, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8530291, 'auroc': 0.9202173, 'binary_precision': 0.9819277, 'binary_recall': 0.72444445, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.83375955}
confusion matrix:
     0    1
0  222    3
1   62  163
new oracle model saved
early stop counter: 1
val acc:0.7876659035682678, best validation acc: 0.795472264289856, corresponding to test acc:                         0.8133333325386047 / 0.855555534362793
after epoch: 3,now: 2024-07-26 00:51:07.347684,epoch time: 0:02:43.340690,used: 0:08:11.519613,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.96517193, 'recall': 0.96374905, 'specificity': 0.96374905, 'f1': 0.9631996, 'auroc': 0.9968983, 'binary_precision': 0.9993094, 'binary_recall': 0.92815906, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.96242094}
confusion matrix:
      0     1
0  1512     1
1   112  1447
---- Validation: 
scalar performance:
{'acc': 0.67837626, 'precision': 0.7809788, 'recall': 0.67334867, 'specificity': 0.67334867, 'f1': 0.6422641, 'auroc': 0.86893785, 'binary_precision': 0.9467213, 'binary_recall': 0.36666667, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.52860415}
confusion matrix:
     0    1
0  638   13
1  399  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73333335, 'precision': 0.81392014, 'recall': 0.73333335, 'specificity': 0.73333335, 'f1': 0.7150456, 'auroc': 0.8974222, 'binary_precision': 0.972973, 'binary_recall': 0.48, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.64285713}
confusion matrix:
     0    1
0  222    3
1  117  108
early stop counter: 2
val acc:0.6783762574195862, best validation acc: 0.795472264289856, corresponding to test acc:                         0.8133333325386047 / 0.855555534362793
after epoch: 4,now: 2024-07-26 00:53:51.509919,epoch time: 0:02:44.162235,used: 0:10:55.681848,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863421, 'recall': 0.9864146, 'specificity': 0.9864146, 'f1': 0.98632777, 'auroc': 0.9988707, 'binary_precision': 0.99347687, 'binary_recall': 0.9794212, 'binary_specificity': 0.993408, 'binary_f1_score': 0.986399}
confusion matrix:
      0     1
0  1507    10
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.8504462, 'recall': 0.84984636, 'specificity': 0.84984636, 'f1': 0.8499781, 'auroc': 0.90310395, 'binary_precision': 0.85784316, 'binary_recall': 0.8333333, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.84541065}
confusion matrix:
     0    1
0  564   87
1  105  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.83858705, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8376808, 'auroc': 0.9230025, 'binary_precision': 0.8220339, 'binary_recall': 0.8622222, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.8416486}
confusion matrix:
     0    1
0  183   42
1   31  194
better model found
persisted
after epoch: 5,now: 2024-07-26 00:56:34.174207,epoch time: 0:02:42.664288,used: 0:13:38.346136,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9837434, 'recall': 0.983263, 'specificity': 0.983263, 'f1': 0.9833895, 'auroc': 0.9993174, 'binary_precision': 0.97355163, 'binary_recall': 0.9942122, 'binary_specificity': 0.97231376, 'binary_f1_score': 0.9837734}
confusion matrix:
      0     1
0  1475    42
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.7837627, 'precision': 0.7968256, 'recall': 0.78200203, 'specificity': 0.78200203, 'f1': 0.78059167, 'auroc': 0.8687569, 'binary_precision': 0.8551308, 'binary_recall': 0.67460316, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.75421476}
confusion matrix:
     0    1
0  579   72
1  205  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8388486, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.8301414, 'auroc': 0.89368886, 'binary_precision': 0.8900524, 'binary_recall': 0.75555557, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8173077}
confusion matrix:
     0    1
0  204   21
1   55  170
early stop counter: 1
val acc:0.7837626934051514, best validation acc: 0.8501170873641968, corresponding to test acc:                         0.8377777934074402 / 0.855555534362793
after epoch: 6,now: 2024-07-26 00:59:16.226066,epoch time: 0:02:42.051859,used: 0:16:20.397995,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9817116, 'recall': 0.98133856, 'specificity': 0.98133856, 'f1': 0.98143744, 'auroc': 0.9989326, 'binary_precision': 0.9728192, 'binary_recall': 0.9909852, 'binary_specificity': 0.9716919, 'binary_f1_score': 0.98181814}
confusion matrix:
      0     1
0  1476    43
1    14  1539
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86376, 'recall': 0.8636713, 'specificity': 0.8636713, 'f1': 0.86338663, 'auroc': 0.923712, 'binary_precision': 0.84732825, 'binary_recall': 0.88095236, 'binary_specificity': 0.8463902, 'binary_f1_score': 0.8638132}
confusion matrix:
     0    1
0  551  100
1   75  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.8622508, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8622195, 'auroc': 0.93568397, 'binary_precision': 0.85903084, 'binary_recall': 0.8666667, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8628319}
confusion matrix:
     0    1
0  193   32
1   30  195
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 01:02:01.786529,epoch time: 0:02:45.560463,used: 0:19:05.958458,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866537, 'recall': 0.98672813, 'specificity': 0.98672813, 'f1': 0.9866531, 'auroc': 0.9988512, 'binary_precision': 0.99283856, 'binary_recall': 0.9807074, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.98673564}
confusion matrix:
      0     1
0  1506    11
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8015304, 'recall': 0.7977471, 'specificity': 0.7977471, 'f1': 0.79774576, 'auroc': 0.87326455, 'binary_precision': 0.82746476, 'binary_recall': 0.74603176, 'binary_specificity': 0.8494624, 'binary_f1_score': 0.784641}
confusion matrix:
     0    1
0  553   98
1  160  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.7814501, 'recall': 0.74222225, 'specificity': 0.74222225, 'f1': 0.7329158, 'auroc': 0.89967406, 'binary_precision': 0.6763754, 'binary_recall': 0.9288889, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.7827715}
confusion matrix:
     0    1
0  125  100
1   16  209
early stop counter: 1
val acc:0.7985948324203491, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8622221946716309 / 0.8622221946716309
after epoch: 8,now: 2024-07-26 01:04:47.459145,epoch time: 0:02:45.672616,used: 0:21:51.631074,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870547, 'recall': 0.98709184, 'specificity': 0.98709184, 'f1': 0.9869791, 'auroc': 0.99881077, 'binary_precision': 0.9967192, 'binary_recall': 0.9774775, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9870046}
confusion matrix:
      0     1
0  1513     5
1    35  1519
---- Validation: 
scalar performance:
{'acc': 0.74473065, 'precision': 0.7959622, 'recall': 0.7412698, 'specificity': 0.7412698, 'f1': 0.7313389, 'auroc': 0.88301575, 'binary_precision': 0.9150685, 'binary_recall': 0.53015876, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.6713568}
confusion matrix:
     0    1
0  620   31
1  296  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.77375567, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.7678572, 'auroc': 0.8496247, 'binary_precision': 0.8102564, 'binary_recall': 0.7022222, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.752381}
confusion matrix:
     0    1
0  188   37
1   67  158
early stop counter: 2
val acc:0.7447306513786316, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8622221946716309 / 0.8622221946716309
after epoch: 9,now: 2024-07-26 01:07:31.942732,epoch time: 0:02:44.483587,used: 0:24:36.114661,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883738, 'recall': 0.9882231, 'specificity': 0.9882231, 'f1': 0.9882779, 'auroc': 0.9992336, 'binary_precision': 0.9840663, 'binary_recall': 0.99292606, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.98847634}
confusion matrix:
      0     1
0  1492    25
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.81740206, 'recall': 0.8056836, 'specificity': 0.8056836, 'f1': 0.8050487, 'auroc': 0.8810103, 'binary_precision': 0.8704062, 'binary_recall': 0.71428573, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.78465563}
confusion matrix:
     0    1
0  584   67
1  180  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.83458006, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7867614, 'auroc': 0.89040995, 'binary_precision': 0.9520548, 'binary_recall': 0.61777776, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.74932617}
confusion matrix:
     0    1
0  218    7
1   86  139
early stop counter: 3
val acc:0.8071818947792053, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8622221946716309 / 0.8622221946716309
after epoch: 10,now: 2024-07-26 01:10:16.438059,epoch time: 0:02:44.495327,used: 0:27:20.609988,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928206, 'recall': 0.9928967, 'specificity': 0.9928967, 'f1': 0.992838, 'auroc': 0.99930525, 'binary_precision': 0.99740595, 'binary_recall': 0.9884319, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9928986}
confusion matrix:
      0     1
0  1512     4
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.7259953, 'precision': 0.78537005, 'recall': 0.7221966, 'specificity': 0.7221966, 'f1': 0.7087159, 'auroc': 0.88081825, 'binary_precision': 0.91150445, 'binary_recall': 0.4904762, 'binary_specificity': 0.953917, 'binary_f1_score': 0.6377709}
confusion matrix:
     0    1
0  621   30
1  321  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.71622384, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6787353, 'auroc': 0.81848884, 'binary_precision': 0.79310346, 'binary_recall': 0.51111114, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.6216216}
confusion matrix:
     0    1
0  195   30
1  110  115
early stop counter: 4
val acc:0.7259953022003174, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8622221946716309 / 0.8622221946716309
after epoch: 11,now: 2024-07-26 01:13:00.234361,epoch time: 0:02:43.796302,used: 0:30:04.406290,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9828025, 'recall': 0.9826478, 'specificity': 0.9826478, 'f1': 0.9824215, 'auroc': 0.9989041, 'binary_precision': 1.0, 'binary_recall': 0.9652956, 'binary_specificity': 1.0, 'binary_f1_score': 0.9823414}
confusion matrix:
      0     1
0  1516     0
1    54  1502
---- Validation: 
scalar performance:
{'acc': 0.56284153, 'precision': 0.73769253, 'recall': 0.55568355, 'specificity': 0.55568355, 'f1': 0.4544459, 'auroc': 0.88683045, 'binary_precision': 0.9375, 'binary_recall': 0.11904762, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.2112676}
confusion matrix:
     0   1
0  646   5
1  555  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5288889, 'precision': 0.7574371, 'recall': 0.5288889, 'specificity': 0.5288889, 'f1': 0.394501, 'auroc': 0.90747654, 'binary_precision': 1.0, 'binary_recall': 0.057777777, 'binary_specificity': 1.0, 'binary_f1_score': 0.1092437}
confusion matrix:
     0   1
0  225   0
1  212  13
early stop counter: 5
val acc:0.562841534614563, best validation acc: 0.8633880019187927, corresponding to test acc:                         0.8622221946716309 / 0.8622221946716309
after epoch: 12,now: 2024-07-26 01:15:46.781415,epoch time: 0:02:46.547054,used: 0:32:50.953344,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_42_55_seed_1_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:32:50.953344 at 2024-07-26 01:15:46.781415
persisted model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.8622508, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8622195, 'auroc': 0.93568397, 'binary_precision': 0.85903084, 'binary_recall': 0.8666667, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8628319}
confusion matrix:
     0    1
0  193   32
1   30  195
oracle model performance metric: 

scalar performance:
{'acc': 0.8622222, 'precision': 0.8622508, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8622195, 'auroc': 0.93568397, 'binary_precision': 0.85903084, 'binary_recall': 0.8666667, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8628319}
confusion matrix:
     0    1
0  193   32
1   30  195
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1623 MiB |   8295 MiB | 139006 GiB | 139005 GiB |
|       from large pool |   1534 MiB |   8221 MiB | 137791 GiB | 137790 GiB |
|       from small pool |     89 MiB |    130 MiB |   1215 GiB |   1215 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1623 MiB |   8295 MiB | 139006 GiB | 139005 GiB |
|       from large pool |   1534 MiB |   8221 MiB | 137791 GiB | 137790 GiB |
|       from small pool |     89 MiB |    130 MiB |   1215 GiB |   1215 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 138805 GiB | 138803 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 137591 GiB | 137590 GiB |
|       from small pool |     89 MiB |    130 MiB |   1213 GiB |   1213 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9050 MiB |   9090 MiB |  15520 MiB |   6470 MiB |
|       from large pool |   8910 MiB |   8956 MiB |  15344 MiB |   6434 MiB |
|       from small pool |    140 MiB |    140 MiB |    176 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1364 MiB |   1404 MiB |  95618 GiB |  95617 GiB |
|       from large pool |   1355 MiB |   1396 MiB |  94367 GiB |  94365 GiB |
|       from small pool |      8 MiB |     44 MiB |   1251 GiB |   1251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   19658 K  |   19656 K  |
|       from large pool |     382    |     808    |    9998 K  |    9997 K  |
|       from small pool |    2074    |    2766    |    9660 K  |    9658 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   19658 K  |   19656 K  |
|       from large pool |     382    |     808    |    9998 K  |    9997 K  |
|       from small pool |    2074    |    2766    |    9660 K  |    9658 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     301    |     326    |     504    |     203    |
|       from large pool |     231    |     259    |     416    |     185    |
|       from small pool |      70    |      70    |      88    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     160    |     329    |   11122 K  |   11121 K  |
|       from large pool |      78    |     249    |    6425 K  |    6425 K  |
|       from small pool |      82    |     239    |    4696 K  |    4696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8295 MiB | 139006 GiB | 139006 GiB |
|       from large pool |  16640 KiB |   8221 MiB | 137791 GiB | 137791 GiB |
|       from small pool |      0 KiB |    130 MiB |   1215 GiB |   1215 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8295 MiB | 139006 GiB | 139006 GiB |
|       from large pool |  16640 KiB |   8221 MiB | 137791 GiB | 137791 GiB |
|       from small pool |      0 KiB |    130 MiB |   1215 GiB |   1215 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 138805 GiB | 138805 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 137591 GiB | 137591 GiB |
|       from small pool |      0 KiB |    130 MiB |   1213 GiB |   1213 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2988 MiB |   9090 MiB |  15520 MiB |  12532 MiB |
|       from large pool |   2890 MiB |   8956 MiB |  15344 MiB |  12454 MiB |
|       from small pool |     98 MiB |    140 MiB |    176 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB |  95619 GiB |  95619 GiB |
|       from large pool |  24320 KiB |   1426 MiB |  94368 GiB |  94368 GiB |
|       from small pool |      0 KiB |     45 MiB |   1251 GiB |   1251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   19658 K  |   19658 K  |
|       from large pool |       2    |     808    |    9998 K  |    9998 K  |
|       from small pool |       0    |    2766    |    9660 K  |    9660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   19658 K  |   19658 K  |
|       from large pool |       2    |     808    |    9998 K  |    9998 K  |
|       from small pool |       0    |    2766    |    9660 K  |    9660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     326    |     504    |     379    |
|       from large pool |      76    |     259    |     416    |     340    |
|       from small pool |      49    |      70    |      88    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   11122 K  |   11122 K  |
|       from large pool |       3    |     249    |    6425 K  |    6425 K  |
|       from small pool |       0    |     239    |    4696 K  |    4696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8295 MiB | 139006 GiB | 139006 GiB |
|       from large pool |  16640 KiB |   8221 MiB | 137791 GiB | 137791 GiB |
|       from small pool |      0 KiB |    130 MiB |   1215 GiB |   1215 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8295 MiB | 139006 GiB | 139006 GiB |
|       from large pool |  16640 KiB |   8221 MiB | 137791 GiB | 137791 GiB |
|       from small pool |      0 KiB |    130 MiB |   1215 GiB |   1215 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 138805 GiB | 138805 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 137591 GiB | 137591 GiB |
|       from small pool |      0 KiB |    130 MiB |   1213 GiB |   1213 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2988 MiB |   9090 MiB |  15520 MiB |  12532 MiB |
|       from large pool |   2890 MiB |   8956 MiB |  15344 MiB |  12454 MiB |
|       from small pool |     98 MiB |    140 MiB |    176 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB |  95619 GiB |  95619 GiB |
|       from large pool |  24320 KiB |   1426 MiB |  94368 GiB |  94368 GiB |
|       from small pool |      0 KiB |     45 MiB |   1251 GiB |   1251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   19658 K  |   19658 K  |
|       from large pool |       2    |     808    |    9998 K  |    9998 K  |
|       from small pool |       0    |    2766    |    9660 K  |    9660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   19658 K  |   19658 K  |
|       from large pool |       2    |     808    |    9998 K  |    9998 K  |
|       from small pool |       0    |    2766    |    9660 K  |    9660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     326    |     504    |     379    |
|       from large pool |      76    |     259    |     416    |     340    |
|       from small pool |      49    |      70    |      88    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   11122 K  |   11122 K  |
|       from large pool |       3    |     249    |    6425 K  |    6425 K  |
|       from small pool |       0    |     239    |    4696 K  |    4696 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719

 Experiment start at: 2024-07-26 01:16:29.333933
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95418847, 'precision': 0.9575202, 'recall': 0.9545351, 'specificity': 0.9545351, 'f1': 0.95412683, 'auroc': 0.9959891, 'binary_precision': 0.9985755, 'binary_recall': 0.9103896, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9524457}
confusion matrix:
      0     1
0  1514     2
1   138  1402
---- Validation: 
scalar performance:
{'acc': 0.8544601, 'precision': 0.8576076, 'recall': 0.8531904, 'specificity': 0.8531904, 'f1': 0.85373473, 'auroc': 0.91061485, 'binary_precision': 0.885159, 'binary_recall': 0.80546623, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.8434344}
confusion matrix:
     0    1
0  591   65
1  121  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.82231885, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82168186, 'auroc': 0.90380657, 'binary_precision': 0.8357488, 'binary_recall': 0.8009259, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.81796694}
confusion matrix:
     0    1
0  182   34
1   43  173
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:19:14.162820,epoch time: 0:02:44.828887,used: 0:02:44.828887,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9698953, 'precision': 0.97021544, 'recall': 0.97001165, 'specificity': 0.97001165, 'f1': 0.9698937, 'auroc': 0.99591374, 'binary_precision': 0.9846051, 'binary_recall': 0.95519483, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.969677}
confusion matrix:
      0     1
0  1493    23
1    69  1471
---- Validation: 
scalar performance:
{'acc': 0.68701094, 'precision': 0.78261626, 'recall': 0.67908156, 'specificity': 0.67908156, 'f1': 0.652261, 'auroc': 0.8823744, 'binary_precision': 0.9404762, 'binary_recall': 0.38102895, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.54233414}
confusion matrix:
     0    1
0  641   15
1  385  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5671296, 'precision': 0.72540486, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.47496152, 'auroc': 0.8763021, 'binary_precision': 0.9142857, 'binary_recall': 0.14814815, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.2549801}
confusion matrix:
     0   1
0  213   3
1  184  32
early stop counter: 1
val acc:0.6870109438896179, best validation acc: 0.8544601202011108, corresponding to test acc:                         0.8217592835426331 / 0.8217592835426331
after epoch: 2,now: 2024-07-26 01:21:57.693147,epoch time: 0:02:43.530327,used: 0:05:28.359214,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.9760293, 'recall': 0.9756082, 'specificity': 0.9756082, 'f1': 0.9754549, 'auroc': 0.9970668, 'binary_precision': 0.99459827, 'binary_recall': 0.9564935, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.97517383}
confusion matrix:
      0     1
0  1508     8
1    67  1473
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.80720466, 'recall': 0.8049761, 'specificity': 0.8049761, 'f1': 0.80529404, 'auroc': 0.88265383, 'binary_precision': 0.8213059, 'binary_recall': 0.76848876, 'binary_specificity': 0.8414634, 'binary_f1_score': 0.79401994}
confusion matrix:
     0    1
0  552  104
1  144  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8439795, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83203375, 'auroc': 0.9144162, 'binary_precision': 0.9044944, 'binary_recall': 0.7453704, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.81725895}
confusion matrix:
     0    1
0  199   17
1   55  161
new oracle model saved
early stop counter: 2
val acc:0.8059467673301697, best validation acc: 0.8544601202011108, corresponding to test acc:                         0.8217592835426331 / 0.8333333134651184
after epoch: 3,now: 2024-07-26 01:24:42.512213,epoch time: 0:02:44.819066,used: 0:08:13.178280,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98396873, 'recall': 0.9839984, 'specificity': 0.9839984, 'f1': 0.98396575, 'auroc': 0.9983822, 'binary_precision': 0.98821217, 'binary_recall': 0.97987014, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.98402345}
confusion matrix:
      0     1
0  1498    18
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.829421, 'precision': 0.8372879, 'recall': 0.8273419, 'specificity': 0.8273419, 'f1': 0.8276925, 'auroc': 0.89517665, 'binary_precision': 0.88257575, 'binary_recall': 0.7491961, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.8104348}
confusion matrix:
     0    1
0  594   62
1  156  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.849537, 'precision': 0.87569976, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84687114, 'auroc': 0.9028635, 'binary_precision': 0.9748428, 'binary_recall': 0.7175926, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.82666665}
confusion matrix:
     0    1
0  212    4
1   61  155
new oracle model saved
early stop counter: 3
val acc:0.8294209837913513, best validation acc: 0.8544601202011108, corresponding to test acc:                         0.8217592835426331 / 0.8495370149612427
after epoch: 4,now: 2024-07-26 01:27:30.315189,epoch time: 0:02:47.802976,used: 0:11:00.981256,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9799167, 'recall': 0.97953004, 'specificity': 0.97953004, 'f1': 0.9793824, 'auroc': 0.9987831, 'binary_precision': 0.9979771, 'binary_recall': 0.96103895, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9791597}
confusion matrix:
      0     1
0  1513     3
1    60  1480
---- Validation: 
scalar performance:
{'acc': 0.69405323, 'precision': 0.7435292, 'recall': 0.68781614, 'specificity': 0.68781614, 'f1': 0.67317677, 'auroc': 0.8503959, 'binary_precision': 0.8468468, 'binary_recall': 0.4533762, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.59057593}
confusion matrix:
     0    1
0  605   51
1  340  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.8185841, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.69016004, 'auroc': 0.904171, 'binary_precision': 1.0, 'binary_recall': 0.43055555, 'binary_specificity': 1.0, 'binary_f1_score': 0.6019417}
confusion matrix:
     0   1
0  216   0
1  123  93
early stop counter: 4
val acc:0.6940532326698303, best validation acc: 0.8544601202011108, corresponding to test acc:                         0.8217592835426331 / 0.8495370149612427
after epoch: 5,now: 2024-07-26 01:30:15.628951,epoch time: 0:02:45.313762,used: 0:13:46.295018,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879209, 'recall': 0.9879408, 'specificity': 0.9879408, 'f1': 0.9878926, 'auroc': 0.999298, 'binary_precision': 0.99408287, 'binary_recall': 0.9818182, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9879124}
confusion matrix:
      0     1
0  1507     9
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.7902973, 'precision': 0.815017, 'recall': 0.78648245, 'specificity': 0.78648245, 'f1': 0.78447807, 'auroc': 0.892457, 'binary_precision': 0.89686096, 'binary_recall': 0.6430868, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.7490637}
confusion matrix:
     0    1
0  610   46
1  222  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7685185, 'precision': 0.82492995, 'recall': 0.76851857, 'specificity': 0.76851857, 'f1': 0.75801575, 'auroc': 0.89553326, 'binary_precision': 0.96031743, 'binary_recall': 0.5601852, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.7076023}
confusion matrix:
     0    1
0  211    5
1   95  121
early stop counter: 5
val acc:0.7902973294258118, best validation acc: 0.8544601202011108, corresponding to test acc:                         0.8217592835426331 / 0.8495370149612427
after epoch: 6,now: 2024-07-26 01:32:59.519097,epoch time: 0:02:43.890146,used: 0:16:30.185164,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_16_29_seed_2_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:16:30.185164 at 2024-07-26 01:32:59.519097
persisted model performance metric: 

scalar performance:
{'acc': 0.8217593, 'precision': 0.82231885, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82168186, 'auroc': 0.90380657, 'binary_precision': 0.8357488, 'binary_recall': 0.8009259, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.81796694}
confusion matrix:
     0    1
0  182   34
1   43  173
oracle model performance metric: 

scalar performance:
{'acc': 0.849537, 'precision': 0.87569976, 'recall': 0.849537, 'specificity': 0.849537, 'f1': 0.84687114, 'auroc': 0.9028635, 'binary_precision': 0.9748428, 'binary_recall': 0.7175926, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.82666665}
confusion matrix:
     0    1
0  212    4
1   61  155
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1620 MiB |   8296 MiB | 178565 GiB | 178564 GiB |
|       from large pool |   1531 MiB |   8222 MiB | 177005 GiB | 177003 GiB |
|       from small pool |     89 MiB |    130 MiB |   1560 GiB |   1560 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1620 MiB |   8296 MiB | 178565 GiB | 178564 GiB |
|       from large pool |   1531 MiB |   8222 MiB | 177005 GiB | 177003 GiB |
|       from small pool |     89 MiB |    130 MiB |   1560 GiB |   1560 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 178307 GiB | 178305 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 176748 GiB | 176747 GiB |
|       from small pool |     89 MiB |    130 MiB |   1558 GiB |   1558 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9422 MiB |   9422 MiB |  21954 MiB |  12532 MiB |
|       from large pool |   9286 MiB |   9286 MiB |  21740 MiB |  12454 MiB |
|       from small pool |    136 MiB |    140 MiB |    214 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1037 MiB |   1447 MiB | 125319 GiB | 125318 GiB |
|       from large pool |   1028 MiB |   1426 MiB | 123711 GiB | 123710 GiB |
|       from small pool |      8 MiB |     45 MiB |   1608 GiB |   1608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   25256 K  |   25253 K  |
|       from large pool |     382    |     808    |   12844 K  |   12843 K  |
|       from small pool |    2062    |    2766    |   12412 K  |   12410 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   25256 K  |   25253 K  |
|       from large pool |     382    |     808    |   12844 K  |   12843 K  |
|       from small pool |    2062    |    2766    |   12412 K  |   12410 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     326    |     665    |     379    |
|       from large pool |     218    |     259    |     558    |     340    |
|       from small pool |      68    |      70    |     107    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     148    |     329    |   14165 K  |   14165 K  |
|       from large pool |      70    |     249    |    8077 K  |    8077 K  |
|       from small pool |      78    |     239    |    6087 K  |    6087 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 178565 GiB | 178565 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 177005 GiB | 177005 GiB |
|       from small pool |      0 KiB |    130 MiB |   1560 GiB |   1560 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 178565 GiB | 178565 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 177005 GiB | 177005 GiB |
|       from small pool |      0 KiB |    130 MiB |   1560 GiB |   1560 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 178307 GiB | 178307 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 176748 GiB | 176748 GiB |
|       from small pool |      0 KiB |    130 MiB |   1558 GiB |   1558 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2658 MiB |   9422 MiB |  21954 MiB |  19296 MiB |
|       from large pool |   2560 MiB |   9286 MiB |  21740 MiB |  19180 MiB |
|       from small pool |     98 MiB |    140 MiB |    214 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 125320 GiB | 125319 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 123711 GiB | 123711 GiB |
|       from small pool |      0 KiB |     47 MiB |   1608 GiB |   1608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   25256 K  |   25256 K  |
|       from large pool |       2    |     808    |   12844 K  |   12844 K  |
|       from small pool |       0    |    2766    |   12412 K  |   12412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   25256 K  |   25256 K  |
|       from large pool |       2    |     808    |   12844 K  |   12844 K  |
|       from small pool |       0    |    2766    |   12412 K  |   12412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |     665    |     541    |
|       from large pool |      75    |     259    |     558    |     483    |
|       from small pool |      49    |      70    |     107    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   14165 K  |   14165 K  |
|       from large pool |       3    |     249    |    8077 K  |    8077 K  |
|       from small pool |       0    |     239    |    6088 K  |    6088 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 178565 GiB | 178565 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 177005 GiB | 177005 GiB |
|       from small pool |      0 KiB |    130 MiB |   1560 GiB |   1560 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 178565 GiB | 178565 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 177005 GiB | 177005 GiB |
|       from small pool |      0 KiB |    130 MiB |   1560 GiB |   1560 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 178307 GiB | 178307 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 176748 GiB | 176748 GiB |
|       from small pool |      0 KiB |    130 MiB |   1558 GiB |   1558 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2658 MiB |   9422 MiB |  21954 MiB |  19296 MiB |
|       from large pool |   2560 MiB |   9286 MiB |  21740 MiB |  19180 MiB |
|       from small pool |     98 MiB |    140 MiB |    214 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 125320 GiB | 125319 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 123711 GiB | 123711 GiB |
|       from small pool |      0 KiB |     47 MiB |   1608 GiB |   1608 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   25256 K  |   25256 K  |
|       from large pool |       2    |     808    |   12844 K  |   12844 K  |
|       from small pool |       0    |    2766    |   12412 K  |   12412 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   25256 K  |   25256 K  |
|       from large pool |       2    |     808    |   12844 K  |   12844 K  |
|       from small pool |       0    |    2766    |   12412 K  |   12412 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |     665    |     541    |
|       from large pool |      75    |     259    |     558    |     483    |
|       from small pool |      49    |      70    |     107    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   14165 K  |   14165 K  |
|       from large pool |       3    |     249    |    8077 K  |    8077 K  |
|       from small pool |       0    |     239    |    6088 K  |    6088 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719

 Experiment start at: 2024-07-26 01:33:37.480883
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9514974, 'precision': 0.95261097, 'recall': 0.95189315, 'specificity': 0.95189315, 'f1': 0.9514879, 'auroc': 0.98758185, 'binary_precision': 0.9789259, 'binary_recall': 0.92426187, 'binary_specificity': 0.97952443, 'binary_f1_score': 0.9508088}
confusion matrix:
      0     1
0  1483    31
1   118  1440
---- Validation: 
scalar performance:
{'acc': 0.771629, 'precision': 0.7973634, 'recall': 0.77444416, 'specificity': 0.77444416, 'f1': 0.76774096, 'auroc': 0.90055573, 'binary_precision': 0.70487803, 'binary_recall': 0.9189189, 'binary_specificity': 0.6299694, 'binary_f1_score': 0.7977916}
confusion matrix:
     0    1
0  412  242
1   51  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74222225, 'precision': 0.7859658, 'recall': 0.7422222, 'specificity': 0.7422222, 'f1': 0.73197234, 'auroc': 0.90143204, 'binary_precision': 0.6741214, 'binary_recall': 0.93777776, 'binary_specificity': 0.5466667, 'binary_f1_score': 0.7843866}
confusion matrix:
     0    1
0  123  102
1   14  211
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:36:27.139273,epoch time: 0:02:49.658390,used: 0:02:49.658390,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93359375, 'precision': 0.93428814, 'recall': 0.93335354, 'specificity': 0.93335354, 'f1': 0.9335315, 'auroc': 0.9840921, 'binary_precision': 0.9198758, 'binary_recall': 0.9517995, 'binary_specificity': 0.91490763, 'binary_f1_score': 0.9355654}
confusion matrix:
      0     1
0  1387   129
1    75  1481
---- Validation: 
scalar performance:
{'acc': 0.7186282, 'precision': 0.7826763, 'recall': 0.72318566, 'specificity': 0.72318566, 'f1': 0.70434487, 'auroc': 0.9014236, 'binary_precision': 0.64316237, 'binary_recall': 0.9570747, 'binary_specificity': 0.48929664, 'binary_f1_score': 0.7693291}
confusion matrix:
     0    1
0  320  334
1   27  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70444447, 'precision': 0.76419234, 'recall': 0.70444447, 'specificity': 0.70444447, 'f1': 0.6867329, 'auroc': 0.9111506, 'binary_precision': 0.6385542, 'binary_recall': 0.94222224, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.7612208}
confusion matrix:
     0    1
0  105  120
1   13  212
early stop counter: 1
val acc:0.7186282277107239, best validation acc: 0.7716289758682251, corresponding to test acc:                         0.742222249507904 / 0.742222249507904
after epoch: 2,now: 2024-07-26 01:39:10.829950,epoch time: 0:02:43.690677,used: 0:05:33.349067,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.9741155, 'recall': 0.9741315, 'specificity': 0.9741315, 'f1': 0.9739584, 'auroc': 0.9969014, 'binary_precision': 0.9868161, 'binary_recall': 0.96146435, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.9739753}
confusion matrix:
      0     1
0  1495    20
1    60  1497
---- Validation: 
scalar performance:
{'acc': 0.8028059, 'precision': 0.8028555, 'recall': 0.8025639, 'specificity': 0.8025639, 'f1': 0.8026506, 'auroc': 0.8683411, 'binary_precision': 0.80420715, 'binary_recall': 0.7901431, 'binary_specificity': 0.81498474, 'binary_f1_score': 0.79711306}
confusion matrix:
     0    1
0  533  121
1  132  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.82708013, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8266119, 'auroc': 0.91024196, 'binary_precision': 0.81545067, 'binary_recall': 0.84444445, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.82969433}
confusion matrix:
     0    1
0  182   43
1   35  190
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 01:41:55.791571,epoch time: 0:02:44.961621,used: 0:08:18.310688,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.9612337, 'recall': 0.9595262, 'specificity': 0.9595262, 'f1': 0.95896053, 'auroc': 0.9936999, 'binary_precision': 0.99722224, 'binary_recall': 0.92169446, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.957972}
confusion matrix:
      0     1
0  1510     4
1   122  1436
---- Validation: 
scalar performance:
{'acc': 0.82385033, 'precision': 0.8323635, 'recall': 0.8222641, 'specificity': 0.8222641, 'f1': 0.8221623, 'auroc': 0.8785875, 'binary_precision': 0.88090736, 'binary_recall': 0.7408585, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.8048359}
confusion matrix:
     0    1
0  591   63
1  163  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8466945, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82158184, 'auroc': 0.8972642, 'binary_precision': 0.9345238, 'binary_recall': 0.69777775, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.7989822}
confusion matrix:
     0    1
0  214   11
1   68  157
better model found
persisted
after epoch: 4,now: 2024-07-26 01:44:40.088988,epoch time: 0:02:44.297417,used: 0:11:02.608105,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.97116566, 'recall': 0.9712045, 'specificity': 0.9712045, 'f1': 0.97102857, 'auroc': 0.99701416, 'binary_precision': 0.9835418, 'binary_recall': 0.9589217, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.9710758}
confusion matrix:
      0     1
0  1489    25
1    64  1494
---- Validation: 
scalar performance:
{'acc': 0.8394388, 'precision': 0.83937025, 'recall': 0.8394082, 'specificity': 0.8394082, 'f1': 0.8393872, 'auroc': 0.89794976, 'binary_precision': 0.83518225, 'binary_recall': 0.8378378, 'binary_specificity': 0.8409786, 'binary_f1_score': 0.8365079}
confusion matrix:
     0    1
0  550  104
1  102  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8279363, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8264987, 'auroc': 0.91109145, 'binary_precision': 0.8483412, 'binary_recall': 0.79555553, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8211009}
confusion matrix:
     0    1
0  193   32
1   46  179
better model found
persisted
after epoch: 5,now: 2024-07-26 01:47:23.885782,epoch time: 0:02:43.796794,used: 0:13:46.404899,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.97042173, 'recall': 0.9695165, 'specificity': 0.9695165, 'f1': 0.9697012, 'auroc': 0.9959842, 'binary_precision': 0.9551681, 'binary_recall': 0.9864952, 'binary_specificity': 0.9525379, 'binary_f1_score': 0.97057897}
confusion matrix:
      0     1
0  1445    72
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.77708495, 'precision': 0.7958888, 'recall': 0.779492, 'specificity': 0.779492, 'f1': 0.7744374, 'auroc': 0.83263564, 'binary_precision': 0.71626735, 'binary_recall': 0.9030207, 'binary_specificity': 0.6559633, 'binary_f1_score': 0.79887486}
confusion matrix:
     0    1
0  429  225
1   61  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.8012663, 'recall': 0.76222223, 'specificity': 0.76222223, 'f1': 0.75426024, 'auroc': 0.9256494, 'binary_precision': 0.6928105, 'binary_recall': 0.94222224, 'binary_specificity': 0.5822222, 'binary_f1_score': 0.79849344}
confusion matrix:
     0    1
0  131   94
1   13  212
early stop counter: 1
val acc:0.7770849466323853, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 6,now: 2024-07-26 01:50:06.801601,epoch time: 0:02:42.915819,used: 0:16:29.320718,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9736377, 'recall': 0.9737347, 'specificity': 0.9737347, 'f1': 0.9736316, 'auroc': 0.9964041, 'binary_precision': 0.9811075, 'binary_recall': 0.9666239, 'binary_specificity': 0.98084545, 'binary_f1_score': 0.97381186}
confusion matrix:
      0     1
0  1485    29
1    52  1506
---- Validation: 
scalar performance:
{'acc': 0.78409976, 'precision': 0.80420226, 'recall': 0.7815412, 'specificity': 0.7815412, 'f1': 0.7793623, 'auroc': 0.86662674, 'binary_precision': 0.8776824, 'binary_recall': 0.65023845, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.747032}
confusion matrix:
     0    1
0  597   57
1  220  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8066667, 'precision': 0.84734654, 'recall': 0.8066667, 'specificity': 0.8066667, 'f1': 0.8008353, 'auroc': 0.8949926, 'binary_precision': 0.9662162, 'binary_recall': 0.63555557, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.766756}
confusion matrix:
     0    1
0  220    5
1   82  143
early stop counter: 2
val acc:0.7840997576713562, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 7,now: 2024-07-26 01:52:50.835799,epoch time: 0:02:44.034198,used: 0:19:13.354916,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9872876, 'recall': 0.98732376, 'specificity': 0.98732376, 'f1': 0.987303, 'auroc': 0.9984946, 'binary_precision': 0.9890393, 'binary_recall': 0.9858612, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9874477}
confusion matrix:
      0     1
0  1499    17
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.79423225, 'precision': 0.82544494, 'recall': 0.7911762, 'specificity': 0.7911762, 'f1': 0.78794026, 'auroc': 0.8933553, 'binary_precision': 0.92147803, 'binary_recall': 0.6343402, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.7514124}
confusion matrix:
     0    1
0  620   34
1  230  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8603238, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8199626, 'auroc': 0.90374315, 'binary_precision': 0.97402596, 'binary_recall': 0.6666667, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7915567}
confusion matrix:
     0    1
0  221    4
1   75  150
early stop counter: 3
val acc:0.7942322492599487, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 8,now: 2024-07-26 01:55:35.037152,epoch time: 0:02:44.201353,used: 0:21:57.556269,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97116846, 'recall': 0.970447, 'specificity': 0.970447, 'f1': 0.97004646, 'auroc': 0.9970489, 'binary_precision': 0.99796194, 'binary_recall': 0.9428755, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.969637}
confusion matrix:
      0     1
0  1511     3
1    89  1469
---- Validation: 
scalar performance:
{'acc': 0.8168355, 'precision': 0.8439733, 'recall': 0.8140768, 'specificity': 0.8140768, 'f1': 0.8121798, 'auroc': 0.89637446, 'binary_precision': 0.9358407, 'binary_recall': 0.672496, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.78260875}
confusion matrix:
     0    1
0  625   29
1  206  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8611841, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81213343, 'auroc': 0.8900938, 'binary_precision': 0.9863946, 'binary_recall': 0.64444447, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.77956986}
confusion matrix:
     0    1
0  223    2
1   80  145
early stop counter: 4
val acc:0.8168355226516724, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 9,now: 2024-07-26 01:58:19.293553,epoch time: 0:02:44.256401,used: 0:24:41.812670,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9816333, 'recall': 0.981642, 'specificity': 0.981642, 'f1': 0.9814453, 'auroc': 0.9987163, 'binary_precision': 0.99537957, 'binary_recall': 0.96790755, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9814514}
confusion matrix:
      0     1
0  1507     7
1    50  1508
---- Validation: 
scalar performance:
{'acc': 0.8098207, 'precision': 0.81821954, 'recall': 0.8081988, 'specificity': 0.8081988, 'f1': 0.8079389, 'auroc': 0.8534766, 'binary_precision': 0.86527514, 'binary_recall': 0.72496027, 'binary_specificity': 0.8914373, 'binary_f1_score': 0.7889274}
confusion matrix:
     0    1
0  583   71
1  173  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7605146, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7598814, 'auroc': 0.85331357, 'binary_precision': 0.772093, 'binary_recall': 0.73777777, 'binary_specificity': 0.7822222, 'binary_f1_score': 0.75454545}
confusion matrix:
     0    1
0  176   49
1   59  166
early stop counter: 5
val acc:0.8098207116127014, best validation acc: 0.839438796043396, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 10,now: 2024-07-26 02:01:03.799156,epoch time: 0:02:44.505603,used: 0:27:26.318273,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_33_37_seed_3_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:27:26.318273 at 2024-07-26 02:01:03.799156
persisted model performance metric: 

scalar performance:
{'acc': 0.82666665, 'precision': 0.8279363, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8264987, 'auroc': 0.91109145, 'binary_precision': 0.8483412, 'binary_recall': 0.79555553, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8211009}
confusion matrix:
     0    1
0  193   32
1   46  179
oracle model performance metric: 

scalar performance:
{'acc': 0.82666665, 'precision': 0.82708013, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8266119, 'auroc': 0.91024196, 'binary_precision': 0.81545067, 'binary_recall': 0.84444445, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.82969433}
confusion matrix:
     0    1
0  182   43
1   35  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1619 MiB |   8296 MiB | 244770 GiB | 244769 GiB |
|       from large pool |   1529 MiB |   8222 MiB | 242630 GiB | 242628 GiB |
|       from small pool |     89 MiB |    130 MiB |   2140 GiB |   2140 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1619 MiB |   8296 MiB | 244770 GiB | 244769 GiB |
|       from large pool |   1529 MiB |   8222 MiB | 242630 GiB | 242628 GiB |
|       from small pool |     89 MiB |    130 MiB |   2140 GiB |   2140 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 244426 GiB | 244424 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 242288 GiB | 242287 GiB |
|       from small pool |     89 MiB |    130 MiB |   2137 GiB |   2137 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9042 MiB |   9422 MiB |  28338 MiB |  19296 MiB |
|       from large pool |   8902 MiB |   9286 MiB |  28082 MiB |  19180 MiB |
|       from small pool |    140 MiB |    140 MiB |    256 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    842 MiB |   1447 MiB | 174627 GiB | 174626 GiB |
|       from large pool |    834 MiB |   1426 MiB | 172418 GiB | 172417 GiB |
|       from small pool |      8 MiB |     47 MiB |   2208 GiB |   2208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   34626 K  |   34623 K  |
|       from large pool |     382    |     808    |   17608 K  |   17608 K  |
|       from small pool |    2074    |    2766    |   17018 K  |   17015 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   34626 K  |   34623 K  |
|       from large pool |     382    |     808    |   17608 K  |   17608 K  |
|       from small pool |    2074    |    2766    |   17018 K  |   17015 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     300    |     326    |     841    |     541    |
|       from large pool |     230    |     259    |     713    |     483    |
|       from small pool |      70    |      70    |     128    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     160    |     329    |   19303 K  |   19303 K  |
|       from large pool |      78    |     249    |   10874 K  |   10874 K  |
|       from small pool |      82    |     240    |    8428 K  |    8428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 244770 GiB | 244770 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 242630 GiB | 242630 GiB |
|       from small pool |      0 KiB |    130 MiB |   2140 GiB |   2140 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 244770 GiB | 244770 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 242630 GiB | 242630 GiB |
|       from small pool |      0 KiB |    130 MiB |   2140 GiB |   2140 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 244426 GiB | 244426 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 242288 GiB | 242288 GiB |
|       from small pool |      0 KiB |    130 MiB |   2137 GiB |   2137 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2462 MiB |   9422 MiB |  28338 MiB |  25876 MiB |
|       from large pool |   2364 MiB |   9286 MiB |  28082 MiB |  25718 MiB |
|       from small pool |     98 MiB |    140 MiB |    256 MiB |    158 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 174628 GiB | 174628 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 172419 GiB | 172419 GiB |
|       from small pool |      0 KiB |     50 MiB |   2208 GiB |   2208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   34626 K  |   34626 K  |
|       from large pool |       2    |     808    |   17608 K  |   17608 K  |
|       from small pool |       0    |    2766    |   17018 K  |   17018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   34626 K  |   34626 K  |
|       from large pool |       2    |     808    |   17608 K  |   17608 K  |
|       from small pool |       0    |    2766    |   17018 K  |   17018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     326    |     841    |     720    |
|       from large pool |      72    |     259    |     713    |     641    |
|       from small pool |      49    |      70    |     128    |      79    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   19303 K  |   19303 K  |
|       from large pool |       3    |     249    |   10874 K  |   10874 K  |
|       from small pool |       0    |     240    |    8428 K  |    8428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 244770 GiB | 244770 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 242630 GiB | 242630 GiB |
|       from small pool |      0 KiB |    130 MiB |   2140 GiB |   2140 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 244770 GiB | 244770 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 242630 GiB | 242630 GiB |
|       from small pool |      0 KiB |    130 MiB |   2140 GiB |   2140 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 244426 GiB | 244426 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 242288 GiB | 242288 GiB |
|       from small pool |      0 KiB |    130 MiB |   2137 GiB |   2137 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2462 MiB |   9422 MiB |  28338 MiB |  25876 MiB |
|       from large pool |   2364 MiB |   9286 MiB |  28082 MiB |  25718 MiB |
|       from small pool |     98 MiB |    140 MiB |    256 MiB |    158 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 174628 GiB | 174628 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 172419 GiB | 172419 GiB |
|       from small pool |      0 KiB |     50 MiB |   2208 GiB |   2208 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   34626 K  |   34626 K  |
|       from large pool |       2    |     808    |   17608 K  |   17608 K  |
|       from small pool |       0    |    2766    |   17018 K  |   17018 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   34626 K  |   34626 K  |
|       from large pool |       2    |     808    |   17608 K  |   17608 K  |
|       from small pool |       0    |    2766    |   17018 K  |   17018 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     326    |     841    |     720    |
|       from large pool |      72    |     259    |     713    |     641    |
|       from small pool |      49    |      70    |     128    |      79    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   19303 K  |   19303 K  |
|       from large pool |       3    |     249    |   10874 K  |   10874 K  |
|       from small pool |       0    |     240    |    8428 K  |    8428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719

 Experiment start at: 2024-07-26 02:01:38.040685
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96891195, 'precision': 0.9688661, 'recall': 0.9689983, 'specificity': 0.9689983, 'f1': 0.96890616, 'auroc': 0.9946238, 'binary_precision': 0.97430956, 'binary_recall': 0.9643992, 'binary_specificity': 0.97359735, 'binary_f1_score': 0.96932906}
confusion matrix:
      0     1
0  1475    40
1    56  1517
---- Validation: 
scalar performance:
{'acc': 0.7259953, 'precision': 0.7262615, 'recall': 0.7261854, 'specificity': 0.7261854, 'f1': 0.72598934, 'auroc': 0.81118715, 'binary_precision': 0.7145038, 'binary_recall': 0.74050635, 'binary_specificity': 0.7118644, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  462  187
1  164  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8151659, 'precision': 0.8152792, 'recall': 0.8151659, 'specificity': 0.8151659, 'f1': 0.8151493, 'auroc': 0.8671638, 'binary_precision': 0.82125604, 'binary_recall': 0.8056872, 'binary_specificity': 0.82464457, 'binary_f1_score': 0.8133971}
confusion matrix:
     0    1
0  174   37
1   41  170
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:04:22.992205,epoch time: 0:02:44.951520,used: 0:02:44.951520,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9695596, 'precision': 0.9699733, 'recall': 0.9693628, 'specificity': 0.9693628, 'f1': 0.96953595, 'auroc': 0.99639404, 'binary_precision': 0.95950156, 'binary_recall': 0.9815169, 'binary_specificity': 0.9572087, 'binary_f1_score': 0.97038436}
confusion matrix:
      0     1
0  1454    65
1    29  1540
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8102787, 'recall': 0.8020726, 'specificity': 0.8020726, 'f1': 0.79981244, 'auroc': 0.8830699, 'binary_precision': 0.7530201, 'binary_recall': 0.88765824, 'binary_specificity': 0.71648693, 'binary_f1_score': 0.81481475}
confusion matrix:
     0    1
0  465  184
1   71  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.84862316, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.8483106, 'auroc': 0.89919364, 'binary_precision': 0.8585366, 'binary_recall': 0.8341232, 'binary_specificity': 0.86255926, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  182   29
1   35  176
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:07:08.380570,epoch time: 0:02:45.388365,used: 0:05:30.339885,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9319948, 'precision': 0.93909514, 'recall': 0.93329096, 'specificity': 0.93329096, 'f1': 0.931834, 'auroc': 0.99349236, 'binary_precision': 1.0, 'binary_recall': 0.866582, 'binary_specificity': 1.0, 'binary_f1_score': 0.9285228}
confusion matrix:
      0     1
0  1514     0
1   210  1364
---- Validation: 
scalar performance:
{'acc': 0.65495706, 'precision': 0.74457574, 'recall': 0.650876, 'specificity': 0.650876, 'f1': 0.6166374, 'auroc': 0.8580655, 'binary_precision': 0.8893443, 'binary_recall': 0.34335443, 'binary_specificity': 0.9583975, 'binary_f1_score': 0.49543378}
confusion matrix:
     0    1
0  622   27
1  415  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6161137, 'precision': 0.7643299, 'recall': 0.6161137, 'specificity': 0.6161137, 'f1': 0.55352664, 'auroc': 0.88219047, 'binary_precision': 0.9622642, 'binary_recall': 0.24170616, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.38636366}
confusion matrix:
     0   1
0  209   2
1  160  51
early stop counter: 1
val acc:0.6549570560455322, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 3,now: 2024-07-26 02:09:52.707066,epoch time: 0:02:44.326496,used: 0:08:14.666381,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.929728, 'precision': 0.9372833, 'recall': 0.9311111, 'specificity': 0.9311111, 'f1': 0.92955047, 'auroc': 0.99341536, 'binary_precision': 1.0, 'binary_recall': 0.8622222, 'binary_specificity': 1.0, 'binary_f1_score': 0.9260143}
confusion matrix:
      0     1
0  1513     0
1   217  1358
---- Validation: 
scalar performance:
{'acc': 0.5120999, 'precision': 0.6991614, 'recall': 0.50555867, 'specificity': 0.50555867, 'f1': 0.34980485, 'auroc': 0.8587408, 'binary_precision': 0.8888889, 'binary_recall': 0.012658228, 'binary_specificity': 0.99845916, 'binary_f1_score': 0.024961}
confusion matrix:
     0  1
0  648  1
1  624  8
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8587633, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  211  0
1  211  0
early stop counter: 2
val acc:0.5120999217033386, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 4,now: 2024-07-26 02:12:39.008364,epoch time: 0:02:46.301298,used: 0:11:00.967679,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97117877, 'precision': 0.9715266, 'recall': 0.97149277, 'specificity': 0.97149277, 'f1': 0.97117865, 'auroc': 0.99702036, 'binary_precision': 0.989432, 'binary_recall': 0.95353276, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9711507}
confusion matrix:
      0     1
0  1501    16
1    73  1498
---- Validation: 
scalar performance:
{'acc': 0.7064793, 'precision': 0.72523427, 'recall': 0.7045003, 'specificity': 0.7045003, 'f1': 0.69891834, 'auroc': 0.8239478, 'binary_precision': 0.78699553, 'binary_recall': 0.55537975, 'binary_specificity': 0.85362095, 'binary_f1_score': 0.6512059}
confusion matrix:
     0    1
0  554   95
1  281  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7322275, 'precision': 0.7700888, 'recall': 0.73222744, 'specificity': 0.73222744, 'f1': 0.7225025, 'auroc': 0.85901034, 'binary_precision': 0.8712121, 'binary_recall': 0.5450237, 'binary_specificity': 0.91943127, 'binary_f1_score': 0.6705539}
confusion matrix:
     0    1
0  194   17
1   96  115
early stop counter: 3
val acc:0.7064793109893799, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 5,now: 2024-07-26 02:15:23.459627,epoch time: 0:02:44.451263,used: 0:13:45.418942,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98542744, 'precision': 0.9854064, 'recall': 0.9855744, 'specificity': 0.9855744, 'f1': 0.9854258, 'auroc': 0.9983605, 'binary_precision': 0.99354005, 'binary_recall': 0.9777495, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9855815}
confusion matrix:
      0     1
0  1505    10
1    35  1538
---- Validation: 
scalar performance:
{'acc': 0.7174083, 'precision': 0.7680782, 'recall': 0.71447796, 'specificity': 0.71447796, 'f1': 0.70158225, 'auroc': 0.87203777, 'binary_precision': 0.88135594, 'binary_recall': 0.49367088, 'binary_specificity': 0.93528503, 'binary_f1_score': 0.63286}
confusion matrix:
     0    1
0  607   42
1  320  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70379144, 'precision': 0.76436484, 'recall': 0.7037915, 'specificity': 0.7037915, 'f1': 0.68579304, 'auroc': 0.8926574, 'binary_precision': 0.8909091, 'binary_recall': 0.46445498, 'binary_specificity': 0.943128, 'binary_f1_score': 0.6105919}
confusion matrix:
     0   1
0  199  12
1  113  98
early stop counter: 4
val acc:0.717408299446106, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 6,now: 2024-07-26 02:18:08.130998,epoch time: 0:02:44.671371,used: 0:16:30.090313,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98542744, 'precision': 0.9854064, 'recall': 0.9855744, 'specificity': 0.9855744, 'f1': 0.9854258, 'auroc': 0.9984646, 'binary_precision': 0.99354005, 'binary_recall': 0.9777495, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9855815}
confusion matrix:
      0     1
0  1505    10
1    35  1538
---- Validation: 
scalar performance:
{'acc': 0.61358315, 'precision': 0.69978976, 'recall': 0.6091321, 'specificity': 0.6091321, 'f1': 0.5618958, 'auroc': 0.8101071, 'binary_precision': 0.8277512, 'binary_recall': 0.27373418, 'binary_specificity': 0.94453007, 'binary_f1_score': 0.411415}
confusion matrix:
     0    1
0  613   36
1  459  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57109004, 'precision': 0.63470376, 'recall': 0.57109004, 'specificity': 0.57109004, 'f1': 0.5136732, 'auroc': 0.8195908, 'binary_precision': 0.72727275, 'binary_recall': 0.22748815, 'binary_specificity': 0.9146919, 'binary_f1_score': 0.34657037}
confusion matrix:
     0   1
0  193  18
1  163  48
early stop counter: 5
val acc:0.6135831475257874, best validation acc: 0.800936758518219, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 7,now: 2024-07-26 02:20:54.305613,epoch time: 0:02:46.174615,used: 0:19:16.264928,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_01_37_seed_4_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:16.264928 at 2024-07-26 02:20:54.305613
persisted model performance metric: 

scalar performance:
{'acc': 0.8483412, 'precision': 0.84862316, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.8483106, 'auroc': 0.89919364, 'binary_precision': 0.8585366, 'binary_recall': 0.8341232, 'binary_specificity': 0.86255926, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  182   29
1   35  176
oracle model performance metric: 

scalar performance:
{'acc': 0.8483412, 'precision': 0.84862316, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.8483106, 'auroc': 0.89919364, 'binary_precision': 0.8585366, 'binary_recall': 0.8341232, 'binary_specificity': 0.86255926, 'binary_f1_score': 0.84615386}
confusion matrix:
     0    1
0  182   29
1   35  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1622 MiB |   8296 MiB | 291399 GiB | 291398 GiB |
|       from large pool |   1533 MiB |   8222 MiB | 288852 GiB | 288850 GiB |
|       from small pool |     89 MiB |    130 MiB |   2547 GiB |   2547 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1622 MiB |   8296 MiB | 291399 GiB | 291398 GiB |
|       from large pool |   1533 MiB |   8222 MiB | 288852 GiB | 288850 GiB |
|       from small pool |     89 MiB |    130 MiB |   2547 GiB |   2547 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 290941 GiB | 290939 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 288397 GiB | 288396 GiB |
|       from small pool |     89 MiB |    130 MiB |   2543 GiB |   2543 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9052 MiB |   9422 MiB |  34928 MiB |  25876 MiB |
|       from large pool |   8916 MiB |   9286 MiB |  34634 MiB |  25718 MiB |
|       from small pool |    136 MiB |    140 MiB |    294 MiB |    158 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    933 MiB |   1447 MiB | 208183 GiB | 208182 GiB |
|       from large pool |    924 MiB |   1426 MiB | 205552 GiB | 205551 GiB |
|       from small pool |      8 MiB |     50 MiB |   2630 GiB |   2630 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2444    |    3301    |   41217 K  |   41214 K  |
|       from large pool |     382    |     808    |   20959 K  |   20959 K  |
|       from small pool |    2062    |    2766    |   20257 K  |   20255 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2444    |    3301    |   41217 K  |   41214 K  |
|       from large pool |     382    |     808    |   20959 K  |   20959 K  |
|       from small pool |    2062    |    2766    |   20257 K  |   20255 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     304    |     326    |    1024    |     720    |
|       from large pool |     236    |     259    |     877    |     641    |
|       from small pool |      68    |      70    |     147    |      79    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     152    |     329    |   23052 K  |   23052 K  |
|       from large pool |      72    |     249    |   12975 K  |   12975 K  |
|       from small pool |      80    |     240    |   10077 K  |   10076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 291399 GiB | 291399 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 288852 GiB | 288852 GiB |
|       from small pool |      0 KiB |    130 MiB |   2547 GiB |   2547 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 291399 GiB | 291399 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 288852 GiB | 288852 GiB |
|       from small pool |      0 KiB |    130 MiB |   2547 GiB |   2547 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 290941 GiB | 290941 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 288397 GiB | 288397 GiB |
|       from small pool |      0 KiB |    130 MiB |   2543 GiB |   2543 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2556 MiB |   9422 MiB |  34928 MiB |  32372 MiB |
|       from large pool |   2458 MiB |   9286 MiB |  34634 MiB |  32176 MiB |
|       from small pool |     98 MiB |    140 MiB |    294 MiB |    196 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 208183 GiB | 208183 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 205553 GiB | 205553 GiB |
|       from small pool |      0 KiB |     50 MiB |   2630 GiB |   2630 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   41217 K  |   41217 K  |
|       from large pool |       2    |     808    |   20959 K  |   20959 K  |
|       from small pool |       0    |    2766    |   20257 K  |   20257 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   41217 K  |   41217 K  |
|       from large pool |       2    |     808    |   20959 K  |   20959 K  |
|       from small pool |       0    |    2766    |   20257 K  |   20257 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1024    |     900    |
|       from large pool |      75    |     259    |     877    |     802    |
|       from small pool |      49    |      70    |     147    |      98    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   23053 K  |   23053 K  |
|       from large pool |       3    |     249    |   12975 K  |   12975 K  |
|       from small pool |       0    |     240    |   10077 K  |   10077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 291399 GiB | 291399 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 288852 GiB | 288852 GiB |
|       from small pool |      0 KiB |    130 MiB |   2547 GiB |   2547 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 291399 GiB | 291399 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 288852 GiB | 288852 GiB |
|       from small pool |      0 KiB |    130 MiB |   2547 GiB |   2547 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 290941 GiB | 290941 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 288397 GiB | 288397 GiB |
|       from small pool |      0 KiB |    130 MiB |   2543 GiB |   2543 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2556 MiB |   9422 MiB |  34928 MiB |  32372 MiB |
|       from large pool |   2458 MiB |   9286 MiB |  34634 MiB |  32176 MiB |
|       from small pool |     98 MiB |    140 MiB |    294 MiB |    196 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 208183 GiB | 208183 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 205553 GiB | 205553 GiB |
|       from small pool |      0 KiB |     50 MiB |   2630 GiB |   2630 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   41217 K  |   41217 K  |
|       from large pool |       2    |     808    |   20959 K  |   20959 K  |
|       from small pool |       0    |    2766    |   20257 K  |   20257 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   41217 K  |   41217 K  |
|       from large pool |       2    |     808    |   20959 K  |   20959 K  |
|       from small pool |       0    |    2766    |   20257 K  |   20257 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     326    |    1024    |     900    |
|       from large pool |      75    |     259    |     877    |     802    |
|       from small pool |      49    |      70    |     147    |      98    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   23053 K  |   23053 K  |
|       from large pool |       3    |     249    |   12975 K  |   12975 K  |
|       from small pool |       0    |     240    |   10077 K  |   10077 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719

 Experiment start at: 2024-07-26 02:21:30.366705
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9181937, 'precision': 0.92299783, 'recall': 0.91741645, 'specificity': 0.91741645, 'f1': 0.9178418, 'auroc': 0.98697615, 'binary_precision': 0.8815249, 'binary_recall': 0.9690522, 'binary_specificity': 0.8657807, 'binary_f1_score': 0.9232186}
confusion matrix:
      0     1
0  1303   202
1    48  1503
---- Validation: 
scalar performance:
{'acc': 0.777605, 'precision': 0.787387, 'recall': 0.7800883, 'specificity': 0.7800883, 'f1': 0.7766059, 'auroc': 0.83031344, 'binary_precision': 0.7269076, 'binary_recall': 0.8688, 'binary_specificity': 0.6913767, 'binary_f1_score': 0.79154515}
confusion matrix:
     0    1
0  457  204
1   82  543
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8246753, 'precision': 0.82605016, 'recall': 0.8246753, 'specificity': 0.8246753, 'f1': 0.8244903, 'auroc': 0.8835666, 'binary_precision': 0.80487806, 'binary_recall': 0.85714287, 'binary_specificity': 0.7922078, 'binary_f1_score': 0.8301887}
confusion matrix:
     0    1
0  183   48
1   33  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:24:18.066300,epoch time: 0:02:47.699595,used: 0:02:47.699595,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93390054, 'precision': 0.93994224, 'recall': 0.93308574, 'specificity': 0.93308574, 'f1': 0.9335748, 'auroc': 0.9943961, 'binary_precision': 0.8918605, 'binary_recall': 0.9896774, 'binary_specificity': 0.87649405, 'binary_f1_score': 0.93822634}
confusion matrix:
      0     1
0  1320   186
1    16  1534
---- Validation: 
scalar performance:
{'acc': 0.7045101, 'precision': 0.7666576, 'recall': 0.7110753, 'specificity': 0.7110753, 'f1': 0.6902423, 'auroc': 0.8360841, 'binary_precision': 0.6307364, 'binary_recall': 0.9456, 'binary_specificity': 0.47655067, 'binary_f1_score': 0.75672215}
confusion matrix:
     0    1
0  315  346
1   34  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7164502, 'precision': 0.7676089, 'recall': 0.7164502, 'specificity': 0.7164502, 'f1': 0.70221853, 'auroc': 0.88755834, 'binary_precision': 0.6506024, 'binary_recall': 0.9350649, 'binary_specificity': 0.4978355, 'binary_f1_score': 0.7673179}
confusion matrix:
     0    1
0  115  116
1   15  216
early stop counter: 1
val acc:0.7045100927352905, best validation acc: 0.7776049971580505, corresponding to test acc:                         0.8246753215789795 / 0.8246753215789795
after epoch: 2,now: 2024-07-26 02:27:01.793196,epoch time: 0:02:43.726896,used: 0:05:31.426491,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9810209, 'recall': 0.98113966, 'specificity': 0.98113966, 'f1': 0.98101974, 'auroc': 0.9969793, 'binary_precision': 0.9888743, 'binary_recall': 0.97358245, 'binary_specificity': 0.9886968, 'binary_f1_score': 0.9811688}
confusion matrix:
      0     1
0  1487    17
1    41  1511
---- Validation: 
scalar performance:
{'acc': 0.65163296, 'precision': 0.7345669, 'recall': 0.6429943, 'specificity': 0.6429943, 'f1': 0.6100383, 'auroc': 0.82265174, 'binary_precision': 0.8672199, 'binary_recall': 0.3344, 'binary_specificity': 0.9515885, 'binary_f1_score': 0.48267904}
confusion matrix:
     0    1
0  629   32
1  416  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74025977, 'precision': 0.7956689, 'recall': 0.74025977, 'specificity': 0.74025977, 'f1': 0.7274926, 'auroc': 0.89882123, 'binary_precision': 0.9236641, 'binary_recall': 0.52380955, 'binary_specificity': 0.95671, 'binary_f1_score': 0.6685083}
confusion matrix:
     0    1
0  221   10
1  110  121
early stop counter: 2
val acc:0.6516329646110535, best validation acc: 0.7776049971580505, corresponding to test acc:                         0.8246753215789795 / 0.8246753215789795
after epoch: 3,now: 2024-07-26 02:29:45.764727,epoch time: 0:02:43.971531,used: 0:08:15.398022,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.97497797, 'recall': 0.97477615, 'specificity': 0.97477615, 'f1': 0.97447574, 'auroc': 0.9973562, 'binary_precision': 0.99462724, 'binary_recall': 0.95486784, 'binary_specificity': 0.9946844, 'binary_f1_score': 0.9743421}
confusion matrix:
      0     1
0  1497     8
1    70  1481
---- Validation: 
scalar performance:
{'acc': 0.82192844, 'precision': 0.83920884, 'recall': 0.8187171, 'specificity': 0.8187171, 'f1': 0.81848997, 'auroc': 0.87206054, 'binary_precision': 0.90909094, 'binary_recall': 0.704, 'binary_specificity': 0.9334342, 'binary_f1_score': 0.7935077}
confusion matrix:
     0    1
0  617   44
1  185  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82251084, 'precision': 0.84584314, 'recall': 0.82251084, 'specificity': 0.82251084, 'f1': 0.8194659, 'auroc': 0.8995334, 'binary_precision': 0.9356725, 'binary_recall': 0.6926407, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.79601985}
confusion matrix:
     0    1
0  220   11
1   71  160
better model found
persisted
after epoch: 4,now: 2024-07-26 02:32:31.067688,epoch time: 0:02:45.302961,used: 0:11:00.700983,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96400523, 'precision': 0.9658655, 'recall': 0.96452916, 'specificity': 0.96452916, 'f1': 0.96399045, 'auroc': 0.9980649, 'binary_precision': 0.999307, 'binary_recall': 0.9297228, 'binary_specificity': 0.9993355, 'binary_f1_score': 0.9632599}
confusion matrix:
      0     1
0  1504     1
1   109  1442
---- Validation: 
scalar performance:
{'acc': 0.7068429, 'precision': 0.7631371, 'recall': 0.7001428, 'specificity': 0.7001428, 'f1': 0.68577373, 'auroc': 0.85852885, 'binary_precision': 0.8780488, 'binary_recall': 0.4608, 'binary_specificity': 0.9394856, 'binary_f1_score': 0.60440713}
confusion matrix:
     0    1
0  621   40
1  337  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.85202545, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.84085727, 'auroc': 0.9106651, 'binary_precision': 0.9114583, 'binary_recall': 0.75757575, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.82742316}
confusion matrix:
     0    1
0  214   17
1   56  175
new oracle model saved
early stop counter: 1
val acc:0.7068428993225098, best validation acc: 0.8219284415245056, corresponding to test acc:                         0.822510838508606 / 0.8419913649559021
after epoch: 5,now: 2024-07-26 02:35:15.386961,epoch time: 0:02:44.319273,used: 0:13:45.020256,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.984003, 'recall': 0.9841052, 'specificity': 0.9841052, 'f1': 0.9839655, 'auroc': 0.99859655, 'binary_precision': 0.9934297, 'binary_recall': 0.97485495, 'binary_specificity': 0.99335545, 'binary_f1_score': 0.98405474}
confusion matrix:
      0     1
0  1495    10
1    39  1512
---- Validation: 
scalar performance:
{'acc': 0.66174185, 'precision': 0.71563554, 'recall': 0.65439636, 'specificity': 0.65439636, 'f1': 0.6328066, 'auroc': 0.8152877, 'binary_precision': 0.81666666, 'binary_recall': 0.392, 'binary_specificity': 0.91679275, 'binary_f1_score': 0.5297297}
confusion matrix:
     0    1
0  606   55
1  380  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6147186, 'precision': 0.71090436, 'recall': 0.6147186, 'specificity': 0.6147186, 'f1': 0.5651373, 'auroc': 0.84353745, 'binary_precision': 0.85333335, 'binary_recall': 0.27705628, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.41830063}
confusion matrix:
     0   1
0  220  11
1  167  64
early stop counter: 2
val acc:0.6617418527603149, best validation acc: 0.8219284415245056, corresponding to test acc:                         0.822510838508606 / 0.8419913649559021
after epoch: 6,now: 2024-07-26 02:37:58.918896,epoch time: 0:02:43.531935,used: 0:16:28.552191,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.9686457, 'recall': 0.96615213, 'specificity': 0.96615213, 'f1': 0.9665548, 'auroc': 0.9985845, 'binary_precision': 0.9415347, 'binary_recall': 0.99613404, 'binary_specificity': 0.9361702, 'binary_f1_score': 0.9680651}
confusion matrix:
      0     1
0  1408    96
1     6  1546
---- Validation: 
scalar performance:
{'acc': 0.7309487, 'precision': 0.7846855, 'recall': 0.73688114, 'specificity': 0.73688114, 'f1': 0.7207296, 'auroc': 0.8725277, 'binary_precision': 0.65380377, 'binary_recall': 0.9488, 'binary_specificity': 0.5249622, 'binary_f1_score': 0.77415144}
confusion matrix:
     0    1
0  347  314
1   32  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75541127, 'precision': 0.78924024, 'recall': 0.75541127, 'specificity': 0.75541127, 'f1': 0.74804413, 'auroc': 0.902082, 'binary_precision': 0.6903226, 'binary_recall': 0.9264069, 'binary_specificity': 0.58441556, 'binary_f1_score': 0.79112756}
confusion matrix:
     0    1
0  135   96
1   17  214
early stop counter: 3
val acc:0.7309486865997314, best validation acc: 0.8219284415245056, corresponding to test acc:                         0.822510838508606 / 0.8419913649559021
after epoch: 7,now: 2024-07-26 02:40:41.537139,epoch time: 0:02:42.618243,used: 0:19:11.170434,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98415065, 'recall': 0.9838589, 'specificity': 0.9838589, 'f1': 0.98395824, 'auroc': 0.9991441, 'binary_precision': 0.97773534, 'binary_recall': 0.9909736, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.98431}
confusion matrix:
      0     1
0  1470    35
1    14  1537
---- Validation: 
scalar performance:
{'acc': 0.83281493, 'precision': 0.8328607, 'recall': 0.8324442, 'specificity': 0.8324442, 'f1': 0.8325913, 'auroc': 0.8848968, 'binary_precision': 0.8338762, 'binary_recall': 0.8192, 'binary_specificity': 0.84568834, 'binary_f1_score': 0.82647294}
confusion matrix:
     0    1
0  559  102
1  113  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268398, 'precision': 0.8288365, 'recall': 0.8268398, 'specificity': 0.8268398, 'f1': 0.8265766, 'auroc': 0.90611124, 'binary_precision': 0.8032129, 'binary_recall': 0.86580086, 'binary_specificity': 0.7878788, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  182   49
1   31  200
better model found
persisted
after epoch: 8,now: 2024-07-26 02:43:25.639416,epoch time: 0:02:44.102277,used: 0:21:55.272711,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98526394, 'recall': 0.98527575, 'specificity': 0.98527575, 'f1': 0.9852698, 'auroc': 0.9990758, 'binary_precision': 0.9858612, 'binary_recall': 0.985228, 'binary_specificity': 0.98532355, 'binary_f1_score': 0.9855445}
confusion matrix:
      0     1
0  1477    22
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.7410575, 'precision': 0.74911803, 'recall': 0.7434033, 'specificity': 0.7434033, 'f1': 0.7400261, 'auroc': 0.8002082, 'binary_precision': 0.6967655, 'binary_recall': 0.8272, 'binary_specificity': 0.65960664, 'binary_f1_score': 0.7564009}
confusion matrix:
     0    1
0  436  225
1  108  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85064936, 'precision': 0.8514463, 'recall': 0.85064936, 'specificity': 0.85064936, 'f1': 0.8505646, 'auroc': 0.89327407, 'binary_precision': 0.8681818, 'binary_recall': 0.8268398, 'binary_specificity': 0.87445885, 'binary_f1_score': 0.8470066}
confusion matrix:
     0    1
0  202   29
1   40  191
new oracle model saved
early stop counter: 1
val acc:0.7410575151443481, best validation acc: 0.8328149318695068, corresponding to test acc:                         0.826839804649353 / 0.850649356842041
after epoch: 9,now: 2024-07-26 02:46:09.009922,epoch time: 0:02:43.370506,used: 0:24:38.643217,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.9767481, 'recall': 0.97677684, 'specificity': 0.97677684, 'f1': 0.9767615, 'auroc': 0.9974372, 'binary_precision': 0.97806454, 'binary_recall': 0.9761751, 'binary_specificity': 0.97737855, 'binary_f1_score': 0.97711897}
confusion matrix:
      0     1
0  1469    34
1    37  1516
---- Validation: 
scalar performance:
{'acc': 0.83437014, 'precision': 0.83804065, 'recall': 0.83583057, 'specificity': 0.83583057, 'f1': 0.8342329, 'auroc': 0.9048811, 'binary_precision': 0.79512894, 'binary_recall': 0.888, 'binary_specificity': 0.7836611, 'binary_f1_score': 0.8390023}
confusion matrix:
     0    1
0  518  143
1   70  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203463, 'precision': 0.82064074, 'recall': 0.82034636, 'specificity': 0.82034636, 'f1': 0.8203051, 'auroc': 0.8905755, 'binary_precision': 0.81092435, 'binary_recall': 0.83549786, 'binary_specificity': 0.8051948, 'binary_f1_score': 0.8230278}
confusion matrix:
     0    1
0  186   45
1   38  193
better model found
persisted
after epoch: 10,now: 2024-07-26 02:48:52.800924,epoch time: 0:02:43.791002,used: 0:27:22.434219,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97349477, 'precision': 0.9746094, 'recall': 0.9731362, 'specificity': 0.9731362, 'f1': 0.9734572, 'auroc': 0.998124, 'binary_precision': 0.9554731, 'binary_recall': 0.9942085, 'binary_specificity': 0.9520639, 'binary_f1_score': 0.974456}
confusion matrix:
      0     1
0  1430    72
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8087092, 'precision': 0.8085592, 'recall': 0.8085592, 'specificity': 0.8085592, 'f1': 0.8085592, 'auroc': 0.85342693, 'binary_precision': 0.8032, 'binary_recall': 0.8032, 'binary_specificity': 0.8139183, 'binary_f1_score': 0.80320007}
confusion matrix:
     0    1
0  538  123
1  123  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8008658, 'precision': 0.80270374, 'recall': 0.80086577, 'specificity': 0.80086577, 'f1': 0.8005631, 'auroc': 0.87487113, 'binary_precision': 0.8262911, 'binary_recall': 0.7619048, 'binary_specificity': 0.8398268, 'binary_f1_score': 0.7927928}
confusion matrix:
     0    1
0  194   37
1   55  176
early stop counter: 1
val acc:0.8087092041969299, best validation acc: 0.8343701362609863, corresponding to test acc:                         0.8203462958335876 / 0.850649356842041
after epoch: 11,now: 2024-07-26 02:51:35.103608,epoch time: 0:02:42.302684,used: 0:30:04.736903,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98762333, 'recall': 0.98775125, 'specificity': 0.98775125, 'f1': 0.98756504, 'auroc': 0.998937, 'binary_precision': 0.9986842, 'binary_recall': 0.976834, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.98763824}
confusion matrix:
      0     1
0  1500     2
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.65007776, 'precision': 0.7545603, 'recall': 0.64082783, 'specificity': 0.64082783, 'f1': 0.6017458, 'auroc': 0.80244356, 'binary_precision': 0.91079813, 'binary_recall': 0.3104, 'binary_specificity': 0.97125566, 'binary_f1_score': 0.46300718}
confusion matrix:
     0    1
0  642   19
1  431  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66233766, 'precision': 0.7753759, 'recall': 0.66233766, 'specificity': 0.66233766, 'f1': 0.6237235, 'auroc': 0.9048556, 'binary_precision': 0.9518072, 'binary_recall': 0.34199134, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.5031847}
confusion matrix:
     0   1
0  227   4
1  152  79
early stop counter: 2
val acc:0.650077760219574, best validation acc: 0.8343701362609863, corresponding to test acc:                         0.8203462958335876 / 0.850649356842041
after epoch: 12,now: 2024-07-26 02:54:18.137500,epoch time: 0:02:43.033892,used: 0:32:47.770795,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879557, 'recall': 0.9881182, 'specificity': 0.9881182, 'f1': 0.98789215, 'auroc': 0.9990296, 'binary_precision': 1.0, 'binary_recall': 0.97623634, 'binary_specificity': 1.0, 'binary_f1_score': 0.9879753}
confusion matrix:
      0     1
0  1499     0
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.63919127, 'precision': 0.71951795, 'recall': 0.63036853, 'specificity': 0.63036853, 'f1': 0.5942478, 'auroc': 0.83114314, 'binary_precision': 0.84549356, 'binary_recall': 0.3152, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.45920748}
confusion matrix:
     0    1
0  625   36
1  428  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77272725, 'precision': 0.7931708, 'recall': 0.77272725, 'specificity': 0.77272725, 'f1': 0.76869494, 'auroc': 0.8728659, 'binary_precision': 0.87058824, 'binary_recall': 0.64069265, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.73815465}
confusion matrix:
     0    1
0  209   22
1   83  148
early stop counter: 3
val acc:0.6391912698745728, best validation acc: 0.8343701362609863, corresponding to test acc:                         0.8203462958335876 / 0.850649356842041
after epoch: 13,now: 2024-07-26 02:57:01.241526,epoch time: 0:02:43.104026,used: 0:35:30.874821,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901438, 'recall': 0.99024963, 'specificity': 0.99024963, 'f1': 0.99018145, 'auroc': 0.9992528, 'binary_precision': 0.9941672, 'binary_recall': 0.9864952, 'binary_specificity': 0.994004, 'binary_f1_score': 0.9903164}
confusion matrix:
      0     1
0  1492     9
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.7947123, 'precision': 0.83141935, 'recall': 0.7899764, 'specificity': 0.7899764, 'f1': 0.78691506, 'auroc': 0.9076508, 'binary_precision': 0.93493974, 'binary_recall': 0.6208, 'binary_specificity': 0.9591528, 'binary_f1_score': 0.74615383}
confusion matrix:
     0    1
0  634   27
1  237  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67748916, 'precision': 0.7877674, 'recall': 0.67748916, 'specificity': 0.67748916, 'f1': 0.6433172, 'auroc': 0.8869774, 'binary_precision': 0.96590906, 'binary_recall': 0.36796537, 'binary_specificity': 0.987013, 'binary_f1_score': 0.53291535}
confusion matrix:
     0   1
0  228   3
1  146  85
early stop counter: 4
val acc:0.7947123050689697, best validation acc: 0.8343701362609863, corresponding to test acc:                         0.8203462958335876 / 0.850649356842041
after epoch: 14,now: 2024-07-26 02:59:45.024450,epoch time: 0:02:43.782924,used: 0:38:14.657745,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98281145, 'recall': 0.98289156, 'specificity': 0.98289156, 'f1': 0.98265696, 'auroc': 0.9980743, 'binary_precision': 0.9966909, 'binary_recall': 0.969112, 'binary_specificity': 0.9966711, 'binary_f1_score': 0.98270804}
confusion matrix:
      0     1
0  1497     5
1    48  1506
---- Validation: 
scalar performance:
{'acc': 0.5435459, 'precision': 0.65092814, 'recall': 0.5310971, 'specificity': 0.5310971, 'f1': 0.42133132, 'auroc': 0.81728774, 'binary_precision': 0.7714286, 'binary_recall': 0.0864, 'binary_specificity': 0.97579426, 'binary_f1_score': 0.15539569}
confusion matrix:
     0   1
0  645  16
1  571  54
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.482684, 'precision': 0.35267857, 'recall': 0.482684, 'specificity': 0.482684, 'f1': 0.3362508, 'auroc': 0.8456363, 'binary_precision': 0.21428572, 'binary_recall': 0.012987013, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.024489796}
confusion matrix:
     0   1
0  220  11
1  228   3
early stop counter: 5
val acc:0.5435459017753601, best validation acc: 0.8343701362609863, corresponding to test acc:                         0.8203462958335876 / 0.850649356842041
after epoch: 15,now: 2024-07-26 03:02:28.229741,epoch time: 0:02:43.205291,used: 0:40:57.863036,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_21_30_seed_5_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:40:57.863036 at 2024-07-26 03:02:28.229741
persisted model performance metric: 

scalar performance:
{'acc': 0.8203463, 'precision': 0.82064074, 'recall': 0.82034636, 'specificity': 0.82034636, 'f1': 0.8203051, 'auroc': 0.8905755, 'binary_precision': 0.81092435, 'binary_recall': 0.83549786, 'binary_specificity': 0.8051948, 'binary_f1_score': 0.8230278}
confusion matrix:
     0    1
0  186   45
1   38  193
oracle model performance metric: 

scalar performance:
{'acc': 0.85064936, 'precision': 0.8514463, 'recall': 0.85064936, 'specificity': 0.85064936, 'f1': 0.8505646, 'auroc': 0.89327407, 'binary_precision': 0.8681818, 'binary_recall': 0.8268398, 'binary_specificity': 0.87445885, 'binary_f1_score': 0.8470066}
confusion matrix:
     0    1
0  202   29
1   40  191
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1621 MiB |   8296 MiB | 390170 GiB | 390168 GiB |
|       from large pool |   1531 MiB |   8222 MiB | 386761 GiB | 386759 GiB |
|       from small pool |     89 MiB |    130 MiB |   3409 GiB |   3409 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1621 MiB |   8296 MiB | 390170 GiB | 390168 GiB |
|       from large pool |   1531 MiB |   8222 MiB | 386761 GiB | 386759 GiB |
|       from small pool |     89 MiB |    130 MiB |   3409 GiB |   3409 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 389592 GiB | 389590 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 386187 GiB | 386186 GiB |
|       from small pool |     89 MiB |    130 MiB |   3404 GiB |   3404 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9054 MiB |   9422 MiB |  41426 MiB |  32372 MiB |
|       from large pool |   8918 MiB |   9286 MiB |  41094 MiB |  32176 MiB |
|       from small pool |    136 MiB |    140 MiB |    332 MiB |    196 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    982 MiB |   1447 MiB | 280211 GiB | 280210 GiB |
|       from large pool |    974 MiB |   1426 MiB | 276688 GiB | 276687 GiB |
|       from small pool |      8 MiB |     50 MiB |   3523 GiB |   3523 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   55182 K  |   55180 K  |
|       from large pool |     382    |     808    |   28066 K  |   28066 K  |
|       from small pool |    2074    |    2766    |   27115 K  |   27113 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   55182 K  |   55180 K  |
|       from large pool |     382    |     808    |   28066 K  |   28066 K  |
|       from small pool |    2074    |    2766    |   27115 K  |   27113 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     303    |     326    |    1203    |     900    |
|       from large pool |     235    |     259    |    1037    |     802    |
|       from small pool |      68    |      70    |     166    |      98    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     152    |     329    |   30967 K  |   30967 K  |
|       from large pool |      70    |     249    |   17417 K  |   17417 K  |
|       from small pool |      82    |     240    |   13549 K  |   13549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 390170 GiB | 390170 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 386761 GiB | 386761 GiB |
|       from small pool |      0 KiB |    130 MiB |   3409 GiB |   3409 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 390170 GiB | 390170 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 386761 GiB | 386761 GiB |
|       from small pool |      0 KiB |    130 MiB |   3409 GiB |   3409 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 389592 GiB | 389591 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 386187 GiB | 386187 GiB |
|       from small pool |      0 KiB |    130 MiB |   3404 GiB |   3404 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2604 MiB |   9422 MiB |  41426 MiB |  38822 MiB |
|       from large pool |   2506 MiB |   9286 MiB |  41094 MiB |  38588 MiB |
|       from small pool |     98 MiB |    140 MiB |    332 MiB |    234 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 280212 GiB | 280212 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 276688 GiB | 276688 GiB |
|       from small pool |      0 KiB |     50 MiB |   3523 GiB |   3523 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   55182 K  |   55182 K  |
|       from large pool |       2    |     808    |   28066 K  |   28066 K  |
|       from small pool |       0    |    2766    |   27115 K  |   27115 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   55182 K  |   55182 K  |
|       from large pool |       2    |     808    |   28066 K  |   28066 K  |
|       from small pool |       0    |    2766    |   27115 K  |   27115 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1203    |    1081    |
|       from large pool |      73    |     259    |    1037    |     964    |
|       from small pool |      49    |      70    |     166    |     117    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   30967 K  |   30967 K  |
|       from large pool |       3    |     249    |   17417 K  |   17417 K  |
|       from small pool |       0    |     240    |   13550 K  |   13550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8296 MiB | 390170 GiB | 390170 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 386761 GiB | 386761 GiB |
|       from small pool |      0 KiB |    130 MiB |   3409 GiB |   3409 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8296 MiB | 390170 GiB | 390170 GiB |
|       from large pool |  16640 KiB |   8222 MiB | 386761 GiB | 386761 GiB |
|       from small pool |      0 KiB |    130 MiB |   3409 GiB |   3409 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 389592 GiB | 389591 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 386187 GiB | 386187 GiB |
|       from small pool |      0 KiB |    130 MiB |   3404 GiB |   3404 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2604 MiB |   9422 MiB |  41426 MiB |  38822 MiB |
|       from large pool |   2506 MiB |   9286 MiB |  41094 MiB |  38588 MiB |
|       from small pool |     98 MiB |    140 MiB |    332 MiB |    234 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 280212 GiB | 280212 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 276688 GiB | 276688 GiB |
|       from small pool |      0 KiB |     50 MiB |   3523 GiB |   3523 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   55182 K  |   55182 K  |
|       from large pool |       2    |     808    |   28066 K  |   28066 K  |
|       from small pool |       0    |    2766    |   27115 K  |   27115 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   55182 K  |   55182 K  |
|       from large pool |       2    |     808    |   28066 K  |   28066 K  |
|       from small pool |       0    |    2766    |   27115 K  |   27115 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1203    |    1081    |
|       from large pool |      73    |     259    |    1037    |     964    |
|       from small pool |      49    |      70    |     166    |     117    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   30967 K  |   30967 K  |
|       from large pool |       3    |     249    |   17417 K  |   17417 K  |
|       from small pool |       0    |     240    |   13550 K  |   13550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719

 Experiment start at: 2024-07-26 03:03:02.447149
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95247394, 'precision': 0.9553455, 'recall': 0.95293653, 'specificity': 0.95293653, 'f1': 0.9524275, 'auroc': 0.9949008, 'binary_precision': 0.9943781, 'binary_recall': 0.9111397, 'binary_specificity': 0.9947334, 'binary_f1_score': 0.95094085}
confusion matrix:
      0     1
0  1511     8
1   138  1415
---- Validation: 
scalar performance:
{'acc': 0.644358, 'precision': 0.7626621, 'recall': 0.64199126, 'specificity': 0.64199126, 'f1': 0.5971221, 'auroc': 0.9052197, 'binary_precision': 0.93719804, 'binary_recall': 0.30407524, 'binary_specificity': 0.9799073, 'binary_f1_score': 0.4591716}
confusion matrix:
     0    1
0  634   13
1  444  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5563063, 'precision': 0.7649165, 'recall': 0.5563063, 'specificity': 0.5563063, 'f1': 0.44754845, 'auroc': 0.91544926, 'binary_precision': 1.0, 'binary_recall': 0.11261261, 'binary_specificity': 1.0, 'binary_f1_score': 0.20242915}
confusion matrix:
     0   1
0  222   0
1  197  25
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:05:48.642583,epoch time: 0:02:46.195434,used: 0:02:46.195434,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.96234417, 'recall': 0.9612263, 'specificity': 0.9612263, 'f1': 0.9609215, 'auroc': 0.9953448, 'binary_precision': 0.99040437, 'binary_recall': 0.931657, 'binary_specificity': 0.99079555, 'binary_f1_score': 0.96013284}
confusion matrix:
      0     1
0  1507    14
1   106  1445
---- Validation: 
scalar performance:
{'acc': 0.75719845, 'precision': 0.8051919, 'recall': 0.75580204, 'specificity': 0.75580204, 'f1': 0.746583, 'auroc': 0.87614167, 'binary_precision': 0.9244792, 'binary_recall': 0.55642635, 'binary_specificity': 0.9551777, 'binary_f1_score': 0.6947163}
confusion matrix:
     0    1
0  618   29
1  283  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5563063, 'precision': 0.7464695, 'recall': 0.5563063, 'specificity': 0.5563063, 'f1': 0.4502706, 'auroc': 0.890431, 'binary_precision': 0.962963, 'binary_recall': 0.117117114, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.20883533}
confusion matrix:
     0   1
0  221   1
1  196  26
better model found
persisted
after epoch: 2,now: 2024-07-26 03:08:32.353707,epoch time: 0:02:43.711124,used: 0:05:29.906558,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97329426, 'recall': 0.97334725, 'specificity': 0.97334725, 'f1': 0.97330594, 'auroc': 0.996323, 'binary_precision': 0.9772875, 'binary_recall': 0.969736, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.9734971}
confusion matrix:
      0     1
0  1484    35
1    47  1506
---- Validation: 
scalar performance:
{'acc': 0.8233463, 'precision': 0.82353806, 'recall': 0.8232559, 'specificity': 0.8232559, 'f1': 0.8232846, 'auroc': 0.88165295, 'binary_precision': 0.82985556, 'binary_recall': 0.8103448, 'binary_specificity': 0.8361669, 'binary_f1_score': 0.81998414}
confusion matrix:
     0    1
0  541  106
1  121  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8828829, 'precision': 0.8828829, 'recall': 0.8828829, 'specificity': 0.8828829, 'f1': 0.8828829, 'auroc': 0.9414617, 'binary_precision': 0.8828829, 'binary_recall': 0.8828829, 'binary_specificity': 0.8828829, 'binary_f1_score': 0.8828829}
confusion matrix:
     0    1
0  196   26
1   26  196
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 03:11:17.072627,epoch time: 0:02:44.718920,used: 0:08:14.625478,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9793472, 'recall': 0.9792855, 'specificity': 0.9792855, 'f1': 0.9791665, 'auroc': 0.99865496, 'binary_precision': 0.9914078, 'binary_recall': 0.96711797, 'binary_specificity': 0.991453, 'binary_f1_score': 0.97911227}
confusion matrix:
      0     1
0  1508    13
1    51  1500
---- Validation: 
scalar performance:
{'acc': 0.72762644, 'precision': 0.7691203, 'recall': 0.7262395, 'specificity': 0.7262395, 'f1': 0.7159062, 'auroc': 0.8727089, 'binary_precision': 0.873057, 'binary_recall': 0.52821314, 'binary_specificity': 0.92426586, 'binary_f1_score': 0.6582031}
confusion matrix:
     0    1
0  598   49
1  301  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6644144, 'precision': 0.78674054, 'recall': 0.6644144, 'specificity': 0.6644144, 'f1': 0.6243506, 'auroc': 0.9091592, 'binary_precision': 0.97402596, 'binary_recall': 0.33783785, 'binary_specificity': 0.990991, 'binary_f1_score': 0.50167227}
confusion matrix:
     0   1
0  220   2
1  147  75
early stop counter: 1
val acc:0.7276264429092407, best validation acc: 0.8233463168144226, corresponding to test acc:                         0.8828828930854797 / 0.8828828930854797
after epoch: 4,now: 2024-07-26 03:14:01.406319,epoch time: 0:02:44.333692,used: 0:10:58.959170,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9807817, 'recall': 0.98080915, 'specificity': 0.98080915, 'f1': 0.98079276, 'auroc': 0.9986639, 'binary_precision': 0.98254687, 'binary_recall': 0.97938144, 'binary_specificity': 0.98223686, 'binary_f1_score': 0.98096156}
confusion matrix:
      0     1
0  1493    27
1    32  1520
---- Validation: 
scalar performance:
{'acc': 0.74863815, 'precision': 0.8058064, 'recall': 0.74711597, 'specificity': 0.74711597, 'f1': 0.7355376, 'auroc': 0.9054055, 'binary_precision': 0.9362881, 'binary_recall': 0.52978057, 'binary_specificity': 0.9644513, 'binary_f1_score': 0.6766767}
confusion matrix:
     0    1
0  624   23
1  300  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8018018, 'precision': 0.8522308, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.79444444, 'auroc': 0.9328991, 'binary_precision': 0.98550725, 'binary_recall': 0.6126126, 'binary_specificity': 0.990991, 'binary_f1_score': 0.7555555}
confusion matrix:
     0    1
0  220    2
1   86  136
early stop counter: 2
val acc:0.7486381530761719, best validation acc: 0.8233463168144226, corresponding to test acc:                         0.8828828930854797 / 0.8828828930854797
after epoch: 5,now: 2024-07-26 03:16:45.387207,epoch time: 0:02:43.980888,used: 0:13:42.940058,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98486435, 'recall': 0.9846183, 'specificity': 0.9846183, 'f1': 0.9846952, 'auroc': 0.9991497, 'binary_precision': 0.9784127, 'binary_recall': 0.9916345, 'binary_specificity': 0.9776021, 'binary_f1_score': 0.9849792}
confusion matrix:
      0     1
0  1484    34
1    13  1541
---- Validation: 
scalar performance:
{'acc': 0.8404669, 'precision': 0.848614, 'recall': 0.8399304, 'specificity': 0.8399304, 'f1': 0.83937395, 'auroc': 0.91280466, 'binary_precision': 0.90018487, 'binary_recall': 0.7633229, 'binary_specificity': 0.9165379, 'binary_f1_score': 0.82612383}
confusion matrix:
     0    1
0  593   54
1  151  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8606361, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.8403173, 'auroc': 0.8976747, 'binary_precision': 0.94186044, 'binary_recall': 0.7297297, 'binary_specificity': 0.954955, 'binary_f1_score': 0.822335}
confusion matrix:
     0    1
0  212   10
1   60  162
better model found
persisted
after epoch: 6,now: 2024-07-26 03:19:29.208996,epoch time: 0:02:43.821789,used: 0:16:26.761847,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98609936, 'recall': 0.98613334, 'specificity': 0.98613334, 'f1': 0.98600256, 'auroc': 0.99917376, 'binary_precision': 0.99671483, 'binary_recall': 0.9755627, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.98602533}
confusion matrix:
      0     1
0  1512     5
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.79533076, 'precision': 0.81927216, 'recall': 0.79436684, 'specificity': 0.79436684, 'f1': 0.79104644, 'auroc': 0.89722335, 'binary_precision': 0.9049676, 'binary_recall': 0.65673983, 'binary_specificity': 0.93199384, 'binary_f1_score': 0.7611262}
confusion matrix:
     0    1
0  603   44
1  219  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.8551804, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82301325, 'auroc': 0.9103968, 'binary_precision': 0.9559748, 'binary_recall': 0.6846847, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.7979002}
confusion matrix:
     0    1
0  215    7
1   70  152
early stop counter: 1
val acc:0.7953307628631592, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.8423423171043396 / 0.8828828930854797
after epoch: 7,now: 2024-07-26 03:22:13.293522,epoch time: 0:02:44.084526,used: 0:19:10.846373,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97683036, 'recall': 0.97646105, 'specificity': 0.97646105, 'f1': 0.97623485, 'auroc': 0.998972, 'binary_precision': 0.9966443, 'binary_recall': 0.9562138, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.9760105}
confusion matrix:
      0     1
0  1514     5
1    68  1485
---- Validation: 
scalar performance:
{'acc': 0.8412451, 'precision': 0.85518706, 'recall': 0.84055054, 'specificity': 0.84055054, 'f1': 0.83947337, 'auroc': 0.92351484, 'binary_precision': 0.9238281, 'binary_recall': 0.7413793, 'binary_specificity': 0.93972176, 'binary_f1_score': 0.82260877}
confusion matrix:
     0    1
0  608   39
1  165  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8626126, 'precision': 0.8811829, 'recall': 0.8626126, 'specificity': 0.8626126, 'f1': 0.8609187, 'auroc': 0.93308175, 'binary_precision': 0.9653179, 'binary_recall': 0.7522523, 'binary_specificity': 0.972973, 'binary_f1_score': 0.8455697}
confusion matrix:
     0    1
0  216    6
1   55  167
better model found
persisted
after epoch: 8,now: 2024-07-26 03:24:58.261889,epoch time: 0:02:44.968367,used: 0:21:55.814740,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98120165, 'recall': 0.9810703, 'specificity': 0.9810703, 'f1': 0.9811156, 'auroc': 0.99815094, 'binary_precision': 0.9770115, 'binary_recall': 0.98582476, 'binary_specificity': 0.9763158, 'binary_f1_score': 0.98139834}
confusion matrix:
      0     1
0  1484    36
1    22  1530
---- Validation: 
scalar performance:
{'acc': 0.78210115, 'precision': 0.80354047, 'recall': 0.7811638, 'specificity': 0.7811638, 'f1': 0.7777893, 'auroc': 0.88308716, 'binary_precision': 0.88247865, 'binary_recall': 0.6473354, 'binary_specificity': 0.9149923, 'binary_f1_score': 0.7468355}
confusion matrix:
     0    1
0  592   55
1  225  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.795045, 'precision': 0.81914055, 'recall': 0.795045, 'specificity': 0.795045, 'f1': 0.79110205, 'auroc': 0.88734674, 'binary_precision': 0.9068323, 'binary_recall': 0.6576577, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.7624021}
confusion matrix:
     0    1
0  207   15
1   76  146
early stop counter: 1
val acc:0.7821011543273926, best validation acc: 0.8412451148033142, corresponding to test acc:                         0.8626126050949097 / 0.8828828930854797
after epoch: 9,now: 2024-07-26 03:27:44.342200,epoch time: 0:02:46.080311,used: 0:24:41.895051,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.9834178, 'recall': 0.9834885, 'specificity': 0.9834885, 'f1': 0.983398, 'auroc': 0.998418, 'binary_precision': 0.9908616, 'binary_recall': 0.97620577, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9834791}
confusion matrix:
      0     1
0  1503    14
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.8326848, 'precision': 0.8360257, 'recall': 0.8323332, 'specificity': 0.8323332, 'f1': 0.83215785, 'auroc': 0.9007785, 'binary_precision': 0.8678261, 'binary_recall': 0.7821317, 'binary_specificity': 0.8825348, 'binary_f1_score': 0.8227535}
confusion matrix:
     0    1
0  571   76
1  139  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8542961, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83083105, 'auroc': 0.88994396, 'binary_precision': 0.9404762, 'binary_recall': 0.7117117, 'binary_specificity': 0.954955, 'binary_f1_score': 0.8102564}
confusion matrix:
     0    1
0  212   10
1   64  158
early stop counter: 2
val acc:0.8326848149299622, best validation acc: 0.8412451148033142, corresponding to test acc:                         0.8626126050949097 / 0.8828828930854797
after epoch: 10,now: 2024-07-26 03:30:30.049520,epoch time: 0:02:45.707320,used: 0:27:27.602371,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873623, 'recall': 0.9873778, 'specificity': 0.9873778, 'f1': 0.9873047, 'auroc': 0.99951804, 'binary_precision': 0.99540985, 'binary_recall': 0.97935486, 'binary_specificity': 0.9954008, 'binary_f1_score': 0.9873171}
confusion matrix:
      0     1
0  1515     7
1    32  1518
---- Validation: 
scalar performance:
{'acc': 0.7774319, 'precision': 0.81462085, 'recall': 0.7762218, 'specificity': 0.7762218, 'f1': 0.7701316, 'auroc': 0.90289944, 'binary_precision': 0.92105263, 'binary_recall': 0.6034483, 'binary_specificity': 0.94899535, 'binary_f1_score': 0.72916675}
confusion matrix:
     0    1
0  614   33
1  253  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7725225, 'precision': 0.7877065, 'recall': 0.77252257, 'specificity': 0.77252257, 'f1': 0.76948106, 'auroc': 0.8471309, 'binary_precision': 0.8538012, 'binary_recall': 0.6576577, 'binary_specificity': 0.8873874, 'binary_f1_score': 0.74300253}
confusion matrix:
     0    1
0  197   25
1   76  146
early stop counter: 3
val acc:0.7774319052696228, best validation acc: 0.8412451148033142, corresponding to test acc:                         0.8626126050949097 / 0.8828828930854797
after epoch: 11,now: 2024-07-26 03:33:14.885576,epoch time: 0:02:44.836056,used: 0:30:12.438427,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880804, 'recall': 0.98808765, 'specificity': 0.98808765, 'f1': 0.98795575, 'auroc': 0.9995062, 'binary_precision': 0.99934167, 'binary_recall': 0.976834, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9879597}
confusion matrix:
      0     1
0  1517     1
1    36  1518
---- Validation: 
scalar performance:
{'acc': 0.7400778, 'precision': 0.80520207, 'recall': 0.7384516, 'specificity': 0.7384516, 'f1': 0.7245604, 'auroc': 0.91199255, 'binary_precision': 0.9444444, 'binary_recall': 0.5062696, 'binary_specificity': 0.9706337, 'binary_f1_score': 0.6591837}
confusion matrix:
     0    1
0  628   19
1  315  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5585586, 'precision': 0.7189017, 'recall': 0.5585586, 'specificity': 0.5585586, 'f1': 0.4595991, 'auroc': 0.8901875, 'binary_precision': 0.90625, 'binary_recall': 0.13063063, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.22834645}
confusion matrix:
     0   1
0  219   3
1  193  29
early stop counter: 4
val acc:0.740077793598175, best validation acc: 0.8412451148033142, corresponding to test acc:                         0.8626126050949097 / 0.8828828930854797
after epoch: 12,now: 2024-07-26 03:35:59.839665,epoch time: 0:02:44.954089,used: 0:32:57.392516,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99024963, 'recall': 0.9903394, 'specificity': 0.9903394, 'f1': 0.990234, 'auroc': 0.9997592, 'binary_precision': 0.99804306, 'binary_recall': 0.982659, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.99029124}
confusion matrix:
      0     1
0  1512     3
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.7937743, 'precision': 0.8219182, 'recall': 0.792734, 'specificity': 0.792734, 'f1': 0.788759, 'auroc': 0.89553726, 'binary_precision': 0.9153675, 'binary_recall': 0.6442006, 'binary_specificity': 0.9412674, 'binary_f1_score': 0.75620973}
confusion matrix:
     0    1
0  609   38
1  227  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7657658, 'precision': 0.812691, 'recall': 0.7657658, 'specificity': 0.7657658, 'f1': 0.7566354, 'auroc': 0.8932514, 'binary_precision': 0.9338235, 'binary_recall': 0.5720721, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.7094972}
confusion matrix:
     0    1
0  213    9
1   95  127
early stop counter: 5
val acc:0.7937743067741394, best validation acc: 0.8412451148033142, corresponding to test acc:                         0.8626126050949097 / 0.8828828930854797
after epoch: 13,now: 2024-07-26 03:38:45.090608,epoch time: 0:02:45.250943,used: 0:35:42.643459,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_03_02_seed_6_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:35:42.643459 at 2024-07-26 03:38:45.090608
persisted model performance metric: 

scalar performance:
{'acc': 0.8626126, 'precision': 0.8811829, 'recall': 0.8626126, 'specificity': 0.8626126, 'f1': 0.8609187, 'auroc': 0.93308175, 'binary_precision': 0.9653179, 'binary_recall': 0.7522523, 'binary_specificity': 0.972973, 'binary_f1_score': 0.8455697}
confusion matrix:
     0    1
0  216    6
1   55  167
oracle model performance metric: 

scalar performance:
{'acc': 0.8828829, 'precision': 0.8828829, 'recall': 0.8828829, 'specificity': 0.8828829, 'f1': 0.8828829, 'auroc': 0.9414617, 'binary_precision': 0.8828829, 'binary_recall': 0.8828829, 'binary_specificity': 0.8828829, 'binary_f1_score': 0.8828829}
confusion matrix:
     0    1
0  196   26
1   26  196
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1622 MiB |   8297 MiB | 476243 GiB | 476241 GiB |
|       from large pool |   1533 MiB |   8223 MiB | 472084 GiB | 472082 GiB |
|       from small pool |     89 MiB |    130 MiB |   4159 GiB |   4159 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1622 MiB |   8297 MiB | 476243 GiB | 476241 GiB |
|       from large pool |   1533 MiB |   8223 MiB | 472084 GiB | 472082 GiB |
|       from small pool |     89 MiB |    130 MiB |   4159 GiB |   4159 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 475494 GiB | 475493 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 471341 GiB | 471340 GiB |
|       from small pool |     89 MiB |    130 MiB |   4153 GiB |   4152 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9444 MiB |   9444 MiB |  48266 MiB |  38822 MiB |
|       from large pool |   9308 MiB |   9308 MiB |  47896 MiB |  38588 MiB |
|       from small pool |    136 MiB |    140 MiB |    370 MiB |    234 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    975 MiB |   1447 MiB | 341733 GiB | 341732 GiB |
|       from large pool |    966 MiB |   1426 MiB | 337432 GiB | 337431 GiB |
|       from small pool |      8 MiB |     50 MiB |   4300 GiB |   4300 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2450    |    3301    |   67341 K  |   67338 K  |
|       from large pool |     382    |     808    |   34255 K  |   34254 K  |
|       from small pool |    2068    |    2766    |   33085 K  |   33083 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2450    |    3301    |   67341 K  |   67338 K  |
|       from large pool |     382    |     808    |   34255 K  |   34254 K  |
|       from small pool |    2068    |    2766    |   33085 K  |   33083 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     300    |     326    |    1381    |    1081    |
|       from large pool |     232    |     259    |    1196    |     964    |
|       from small pool |      68    |      70    |     185    |     117    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |     329    |   37746 K  |   37746 K  |
|       from large pool |      65    |     249    |   21149 K  |   21149 K  |
|       from small pool |      82    |     240    |   16596 K  |   16596 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 476243 GiB | 476243 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 472084 GiB | 472084 GiB |
|       from small pool |      0 KiB |    130 MiB |   4159 GiB |   4159 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 476243 GiB | 476243 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 472084 GiB | 472084 GiB |
|       from small pool |      0 KiB |    130 MiB |   4159 GiB |   4159 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 475494 GiB | 475494 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 471341 GiB | 471341 GiB |
|       from small pool |      0 KiB |    130 MiB |   4153 GiB |   4153 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2598 MiB |   9444 MiB |  48266 MiB |  45668 MiB |
|       from large pool |   2500 MiB |   9308 MiB |  47896 MiB |  45396 MiB |
|       from small pool |     98 MiB |    140 MiB |    370 MiB |    272 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 341734 GiB | 341734 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 337433 GiB | 337433 GiB |
|       from small pool |      0 KiB |     50 MiB |   4300 GiB |   4300 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   67341 K  |   67341 K  |
|       from large pool |       2    |     808    |   34255 K  |   34255 K  |
|       from small pool |       0    |    2766    |   33085 K  |   33085 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   67341 K  |   67341 K  |
|       from large pool |       2    |     808    |   34255 K  |   34255 K  |
|       from small pool |       0    |    2766    |   33085 K  |   33085 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1381    |    1259    |
|       from large pool |      73    |     259    |    1196    |    1123    |
|       from small pool |      49    |      70    |     185    |     136    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   37746 K  |   37746 K  |
|       from large pool |       3    |     249    |   21149 K  |   21149 K  |
|       from small pool |       0    |     240    |   16596 K  |   16596 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 476243 GiB | 476243 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 472084 GiB | 472084 GiB |
|       from small pool |      0 KiB |    130 MiB |   4159 GiB |   4159 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 476243 GiB | 476243 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 472084 GiB | 472084 GiB |
|       from small pool |      0 KiB |    130 MiB |   4159 GiB |   4159 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 475494 GiB | 475494 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 471341 GiB | 471341 GiB |
|       from small pool |      0 KiB |    130 MiB |   4153 GiB |   4153 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2598 MiB |   9444 MiB |  48266 MiB |  45668 MiB |
|       from large pool |   2500 MiB |   9308 MiB |  47896 MiB |  45396 MiB |
|       from small pool |     98 MiB |    140 MiB |    370 MiB |    272 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 341734 GiB | 341734 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 337433 GiB | 337433 GiB |
|       from small pool |      0 KiB |     50 MiB |   4300 GiB |   4300 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   67341 K  |   67341 K  |
|       from large pool |       2    |     808    |   34255 K  |   34255 K  |
|       from small pool |       0    |    2766    |   33085 K  |   33085 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   67341 K  |   67341 K  |
|       from large pool |       2    |     808    |   34255 K  |   34255 K  |
|       from small pool |       0    |    2766    |   33085 K  |   33085 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1381    |    1259    |
|       from large pool |      73    |     259    |    1196    |    1123    |
|       from small pool |      49    |      70    |     185    |     136    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   37746 K  |   37746 K  |
|       from large pool |       3    |     249    |   21149 K  |   21149 K  |
|       from small pool |       0    |     240    |   16596 K  |   16596 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719

 Experiment start at: 2024-07-26 03:39:21.025522
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.94470644, 'recall': 0.94459707, 'specificity': 0.94459707, 'f1': 0.9446417, 'auroc': 0.98690224, 'binary_precision': 0.9426752, 'binary_recall': 0.94871795, 'binary_specificity': 0.9404762, 'binary_f1_score': 0.94568694}
confusion matrix:
      0     1
0  1422    90
1    80  1480
---- Validation: 
scalar performance:
{'acc': 0.78384614, 'precision': 0.78417504, 'recall': 0.7840909, 'specificity': 0.7840909, 'f1': 0.783843, 'auroc': 0.8554628, 'binary_precision': 0.7699248, 'binary_recall': 0.8, 'binary_specificity': 0.7681818, 'binary_f1_score': 0.78467435}
confusion matrix:
     0    1
0  507  153
1  128  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.82452524, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.8204677, 'auroc': 0.9243006, 'binary_precision': 0.7905138, 'binary_recall': 0.8733624, 'binary_specificity': 0.768559, 'binary_f1_score': 0.82987547}
confusion matrix:
     0    1
0  176   53
1   29  200
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:42:07.521688,epoch time: 0:02:46.496166,used: 0:02:46.496166,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.9667648, 'recall': 0.9651302, 'specificity': 0.9651302, 'f1': 0.96544385, 'auroc': 0.9976131, 'binary_precision': 0.94601226, 'binary_recall': 0.98846155, 'binary_specificity': 0.9417989, 'binary_f1_score': 0.9667712}
confusion matrix:
      0     1
0  1424    88
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.80923074, 'precision': 0.8093685, 'recall': 0.8090199, 'specificity': 0.8090199, 'f1': 0.80910015, 'auroc': 0.88389915, 'binary_precision': 0.813099, 'binary_recall': 0.7953125, 'binary_specificity': 0.82272726, 'binary_f1_score': 0.8041074}
confusion matrix:
     0    1
0  543  117
1  131  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.84297234, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.84033656, 'auroc': 0.91068053, 'binary_precision': 0.87142855, 'binary_recall': 0.7991266, 'binary_specificity': 0.88209605, 'binary_f1_score': 0.833713}
confusion matrix:
     0    1
0  202   27
1   46  183
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:44:54.890683,epoch time: 0:02:47.368995,used: 0:05:33.865161,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9788867, 'recall': 0.97899365, 'specificity': 0.97899365, 'f1': 0.9788405, 'auroc': 0.9979094, 'binary_precision': 0.98888165, 'binary_recall': 0.9692308, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.9789576}
confusion matrix:
      0     1
0  1495    17
1    48  1512
---- Validation: 
scalar performance:
{'acc': 0.8138462, 'precision': 0.8139884, 'recall': 0.81401515, 'specificity': 0.81401515, 'f1': 0.81384563, 'auroc': 0.8771142, 'binary_precision': 0.8024316, 'binary_recall': 0.825, 'binary_specificity': 0.8030303, 'binary_f1_score': 0.81355923}
confusion matrix:
     0    1
0  530  130
1  112  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81877726, 'precision': 0.82148075, 'recall': 0.81877726, 'specificity': 0.81877726, 'f1': 0.8183955, 'auroc': 0.9147232, 'binary_precision': 0.792, 'binary_recall': 0.8646288, 'binary_specificity': 0.77292573, 'binary_f1_score': 0.8267223}
confusion matrix:
     0    1
0  177   52
1   31  198
better model found
persisted
after epoch: 3,now: 2024-07-26 03:47:41.367046,epoch time: 0:02:46.476363,used: 0:08:20.341524,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9345703, 'precision': 0.941331, 'recall': 0.9355769, 'specificity': 0.9355769, 'f1': 0.9344076, 'auroc': 0.9968077, 'binary_precision': 1.0, 'binary_recall': 0.87115383, 'binary_specificity': 1.0, 'binary_f1_score': 0.9311408}
confusion matrix:
      0     1
0  1512     0
1   201  1359
---- Validation: 
scalar performance:
{'acc': 0.5769231, 'precision': 0.735296, 'recall': 0.5705019, 'specificity': 0.5705019, 'f1': 0.48303935, 'auroc': 0.8489003, 'binary_precision': 0.9245283, 'binary_recall': 0.153125, 'binary_specificity': 0.9878788, 'binary_f1_score': 0.2627346}
confusion matrix:
     0   1
0  652   8
1  542  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5786026, 'precision': 0.7359203, 'recall': 0.5786026, 'specificity': 0.5786026, 'f1': 0.49429902, 'auroc': 0.87953603, 'binary_precision': 0.9285714, 'binary_recall': 0.17030568, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.2878229}
confusion matrix:
     0   1
0  226   3
1  190  39
early stop counter: 1
val acc:0.5769230723381042, best validation acc: 0.8138461709022522, corresponding to test acc:                         0.8187772631645203 / 0.8406113386154175
after epoch: 4,now: 2024-07-26 03:50:28.678041,epoch time: 0:02:47.310995,used: 0:11:07.652519,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97754437, 'recall': 0.9776608, 'specificity': 0.9776608, 'f1': 0.9775378, 'auroc': 0.99772584, 'binary_precision': 0.98566777, 'binary_recall': 0.9698718, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.97770596}
confusion matrix:
      0     1
0  1490    22
1    47  1513
---- Validation: 
scalar performance:
{'acc': 0.6876923, 'precision': 0.73237896, 'recall': 0.68423295, 'specificity': 0.68423295, 'f1': 0.66937363, 'auroc': 0.8242732, 'binary_precision': 0.8305085, 'binary_recall': 0.459375, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.5915493}
confusion matrix:
     0    1
0  600   60
1  346  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62445414, 'precision': 0.7022028, 'recall': 0.62445414, 'specificity': 0.62445414, 'f1': 0.5845148, 'auroc': 0.8508228, 'binary_precision': 0.82758623, 'binary_recall': 0.31441048, 'binary_specificity': 0.93449783, 'binary_f1_score': 0.4556962}
confusion matrix:
     0   1
0  214  15
1  157  72
early stop counter: 2
val acc:0.6876922845840454, best validation acc: 0.8138461709022522, corresponding to test acc:                         0.8187772631645203 / 0.8406113386154175
after epoch: 5,now: 2024-07-26 03:53:15.478374,epoch time: 0:02:46.800333,used: 0:13:54.452852,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9713217, 'recall': 0.9705128, 'specificity': 0.9705128, 'f1': 0.9700459, 'auroc': 0.99897575, 'binary_precision': 1.0, 'binary_recall': 0.9410256, 'binary_specificity': 1.0, 'binary_f1_score': 0.9696169}
confusion matrix:
      0     1
0  1512     0
1    92  1468
---- Validation: 
scalar performance:
{'acc': 0.6269231, 'precision': 0.7679725, 'recall': 0.62125945, 'specificity': 0.62125945, 'f1': 0.56484807, 'auroc': 0.8934511, 'binary_precision': 0.9585799, 'binary_recall': 0.253125, 'binary_specificity': 0.98939395, 'binary_f1_score': 0.40049446}
confusion matrix:
     0    1
0  653    7
1  478  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56113535, 'precision': 0.7351819, 'recall': 0.56113535, 'specificity': 0.56113535, 'f1': 0.4615074, 'auroc': 0.8927556, 'binary_precision': 0.9375, 'binary_recall': 0.13100436, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.22988506}
confusion matrix:
     0   1
0  227   2
1  199  30
early stop counter: 3
val acc:0.6269230842590332, best validation acc: 0.8138461709022522, corresponding to test acc:                         0.8187772631645203 / 0.8406113386154175
after epoch: 6,now: 2024-07-26 03:56:01.504961,epoch time: 0:02:46.026587,used: 0:16:40.479439,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95442706, 'precision': 0.9574288, 'recall': 0.95510787, 'specificity': 0.95510787, 'f1': 0.9543897, 'auroc': 0.99723697, 'binary_precision': 0.9985955, 'binary_recall': 0.9115385, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.95308316}
confusion matrix:
      0     1
0  1510     2
1   138  1422
---- Validation: 
scalar performance:
{'acc': 0.62846154, 'precision': 0.75874746, 'recall': 0.6229167, 'specificity': 0.6229167, 'f1': 0.56953025, 'auroc': 0.87018824, 'binary_precision': 0.9385475, 'binary_recall': 0.2625, 'binary_specificity': 0.98333335, 'binary_f1_score': 0.41025642}
confusion matrix:
     0    1
0  649   11
1  472  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6419214, 'precision': 0.74372077, 'recall': 0.6419214, 'specificity': 0.6419214, 'f1': 0.6001704, 'auroc': 0.8674511, 'binary_precision': 0.90123457, 'binary_recall': 0.3187773, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.47096774}
confusion matrix:
     0   1
0  221   8
1  156  73
early stop counter: 4
val acc:0.6284615397453308, best validation acc: 0.8138461709022522, corresponding to test acc:                         0.8187772631645203 / 0.8406113386154175
after epoch: 7,now: 2024-07-26 03:58:46.723110,epoch time: 0:02:45.218149,used: 0:19:25.697588,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99022305, 'recall': 0.9902421, 'specificity': 0.9902421, 'f1': 0.9902322, 'auroc': 0.99924874, 'binary_precision': 0.9910141, 'binary_recall': 0.9897436, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.99037844}
confusion matrix:
      0     1
0  1498    14
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.84615386, 'precision': 0.8482402, 'recall': 0.8455492, 'specificity': 0.8455492, 'f1': 0.84573174, 'auroc': 0.8959706, 'binary_precision': 0.8716216, 'binary_recall': 0.80625, 'binary_specificity': 0.8848485, 'binary_f1_score': 0.83766234}
confusion matrix:
     0    1
0  584   76
1  124  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.8356999, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.8338584, 'auroc': 0.9055891, 'binary_precision': 0.85915494, 'binary_recall': 0.7991266, 'binary_specificity': 0.8689956, 'binary_f1_score': 0.82805425}
confusion matrix:
     0    1
0  199   30
1   46  183
better model found
persisted
after epoch: 8,now: 2024-07-26 04:01:32.250052,epoch time: 0:02:45.526942,used: 0:22:11.224530,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98890483, 'recall': 0.989011, 'specificity': 0.989011, 'f1': 0.98893106, 'auroc': 0.99926656, 'binary_precision': 0.99417096, 'binary_recall': 0.98397434, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.98904634}
confusion matrix:
      0     1
0  1503     9
1    25  1535
---- Validation: 
scalar performance:
{'acc': 0.80153847, 'precision': 0.82850564, 'recall': 0.7993134, 'specificity': 0.7993134, 'f1': 0.79652804, 'auroc': 0.9093969, 'binary_precision': 0.91885966, 'binary_recall': 0.6546875, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.7645986}
confusion matrix:
     0    1
0  623   37
1  221  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.86157644, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.8258555, 'auroc': 0.91809845, 'binary_precision': 0.9689441, 'binary_recall': 0.68122274, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  224    5
1   73  156
early stop counter: 1
val acc:0.8015384674072266, best validation acc: 0.8461538553237915, corresponding to test acc:                         0.8340611457824707 / 0.8406113386154175
after epoch: 9,now: 2024-07-26 04:04:16.962442,epoch time: 0:02:44.712390,used: 0:24:55.936920,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97537434, 'recall': 0.9747405, 'specificity': 0.9747405, 'f1': 0.9749157, 'auroc': 0.99702346, 'binary_precision': 0.9643081, 'binary_recall': 0.98717946, 'binary_specificity': 0.9623016, 'binary_f1_score': 0.9756097}
confusion matrix:
      0     1
0  1455    57
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.8038462, 'precision': 0.81327003, 'recall': 0.8024858, 'specificity': 0.8024858, 'f1': 0.80183387, 'auroc': 0.8770999, 'binary_precision': 0.86389416, 'binary_recall': 0.7140625, 'binary_specificity': 0.8909091, 'binary_f1_score': 0.7818649}
confusion matrix:
     0    1
0  588   72
1  183  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.8522227, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.83189416, 'auroc': 0.9232662, 'binary_precision': 0.9322034, 'binary_recall': 0.720524, 'binary_specificity': 0.9475983, 'binary_f1_score': 0.8128079}
confusion matrix:
     0    1
0  217   12
1   64  165
early stop counter: 2
val acc:0.8038461804389954, best validation acc: 0.8461538553237915, corresponding to test acc:                         0.8340611457824707 / 0.8406113386154175
after epoch: 10,now: 2024-07-26 04:07:01.342599,epoch time: 0:02:44.380157,used: 0:27:40.317077,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9885849, 'recall': 0.9886294, 'specificity': 0.9886294, 'f1': 0.98860455, 'auroc': 0.9989257, 'binary_precision': 0.9903537, 'binary_recall': 0.98717946, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.98876405}
confusion matrix:
      0     1
0  1497    15
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.8415385, 'precision': 0.85689074, 'recall': 0.8399384, 'specificity': 0.8399384, 'f1': 0.8393421, 'auroc': 0.9112879, 'binary_precision': 0.9271653, 'binary_recall': 0.7359375, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.8205575}
confusion matrix:
     0    1
0  623   37
1  169  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.87373066, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.8517262, 'auroc': 0.9269846, 'binary_precision': 0.96022725, 'binary_recall': 0.7379913, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.83456784}
confusion matrix:
     0    1
0  222    7
1   60  169
new oracle model saved
early stop counter: 3
val acc:0.8415384888648987, best validation acc: 0.8461538553237915, corresponding to test acc:                         0.8340611457824707 / 0.8537117838859558
after epoch: 11,now: 2024-07-26 04:09:45.449851,epoch time: 0:02:44.107252,used: 0:30:24.424329,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9884583, 'recall': 0.98817664, 'specificity': 0.98817664, 'f1': 0.9882755, 'auroc': 0.9994832, 'binary_precision': 0.98227847, 'binary_recall': 0.9948718, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.98853505}
confusion matrix:
      0     1
0  1484    28
1     8  1552
---- Validation: 
scalar performance:
{'acc': 0.8553846, 'precision': 0.86904186, 'recall': 0.8539063, 'specificity': 0.8539063, 'f1': 0.85363835, 'auroc': 0.91859853, 'binary_precision': 0.9362934, 'binary_recall': 0.7578125, 'binary_specificity': 0.95, 'binary_f1_score': 0.8376512}
confusion matrix:
     0    1
0  627   33
1  155  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8799127, 'precision': 0.8937974, 'recall': 0.8799126, 'specificity': 0.8799126, 'f1': 0.87884474, 'auroc': 0.9318663, 'binary_precision': 0.9677419, 'binary_recall': 0.7860262, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86746985}
confusion matrix:
     0    1
0  223    6
1   49  180
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-26 04:12:30.284551,epoch time: 0:02:44.834700,used: 0:33:09.259029,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97338426, 'recall': 0.9732397, 'specificity': 0.9732397, 'f1': 0.9732971, 'auroc': 0.9975419, 'binary_precision': 0.9701018, 'binary_recall': 0.9775641, 'binary_specificity': 0.96891534, 'binary_f1_score': 0.9738186}
confusion matrix:
      0     1
0  1465    47
1    35  1525
---- Validation: 
scalar performance:
{'acc': 0.8030769, 'precision': 0.8156726, 'recall': 0.8015151, 'specificity': 0.8015151, 'f1': 0.8004911, 'auroc': 0.88129973, 'binary_precision': 0.875, 'binary_recall': 0.7, 'binary_specificity': 0.9030303, 'binary_f1_score': 0.7777778}
confusion matrix:
     0    1
0  596   64
1  192  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.8756918, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.86122215, 'auroc': 0.9280906, 'binary_precision': 0.94623655, 'binary_recall': 0.768559, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.84819275}
confusion matrix:
     0    1
0  219   10
1   53  176
early stop counter: 1
val acc:0.8030769228935242, best validation acc: 0.8553845882415771, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 13,now: 2024-07-26 04:15:14.751131,epoch time: 0:02:44.466580,used: 0:35:53.725609,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98801315, 'recall': 0.987907, 'specificity': 0.987907, 'f1': 0.9879516, 'auroc': 0.9987188, 'binary_precision': 0.98534095, 'binary_recall': 0.9910256, 'binary_specificity': 0.98478836, 'binary_f1_score': 0.98817515}
confusion matrix:
      0     1
0  1489    23
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.72615385, 'precision': 0.78589326, 'recall': 0.7225852, 'specificity': 0.7225852, 'f1': 0.7089572, 'auroc': 0.8935487, 'binary_precision': 0.9127907, 'binary_recall': 0.490625, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.6382114}
confusion matrix:
     0    1
0  630   30
1  326  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6855895, 'precision': 0.77383864, 'recall': 0.6855895, 'specificity': 0.6855895, 'f1': 0.6580388, 'auroc': 0.89000976, 'binary_precision': 0.9292929, 'binary_recall': 0.40174672, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.56097555}
confusion matrix:
     0   1
0  222   7
1  137  92
early stop counter: 2
val acc:0.7261538505554199, best validation acc: 0.8553845882415771, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 14,now: 2024-07-26 04:18:00.098935,epoch time: 0:02:45.347804,used: 0:38:39.073413,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99413013, 'recall': 0.9941494, 'specificity': 0.9941494, 'f1': 0.9941393, 'auroc': 0.9995192, 'binary_precision': 0.99486524, 'binary_recall': 0.99358976, 'binary_specificity': 0.994709, 'binary_f1_score': 0.99422705}
confusion matrix:
      0     1
0  1504     8
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.78846157, 'precision': 0.82703125, 'recall': 0.78579545, 'specificity': 0.78579545, 'f1': 0.7809328, 'auroc': 0.9071644, 'binary_precision': 0.9355609, 'binary_recall': 0.6125, 'binary_specificity': 0.9590909, 'binary_f1_score': 0.7403211}
confusion matrix:
     0    1
0  633   27
1  248  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7991266, 'precision': 0.8482406, 'recall': 0.7991266, 'specificity': 0.7991266, 'f1': 0.79178524, 'auroc': 0.9251921, 'binary_precision': 0.97902095, 'binary_recall': 0.6113537, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.7526881}
confusion matrix:
     0    1
0  226    3
1   89  140
early stop counter: 3
val acc:0.7884615659713745, best validation acc: 0.8553845882415771, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 15,now: 2024-07-26 04:20:44.620362,epoch time: 0:02:44.521427,used: 0:41:23.594840,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921572, 'recall': 0.9922365, 'specificity': 0.9922365, 'f1': 0.9921863, 'auroc': 0.9997952, 'binary_precision': 0.9954839, 'binary_recall': 0.98910254, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.9922829}
confusion matrix:
      0     1
0  1505     7
1    17  1543
---- Validation: 
scalar performance:
{'acc': 0.80615383, 'precision': 0.8362362, 'recall': 0.8038352, 'specificity': 0.8038352, 'f1': 0.80085784, 'auroc': 0.9076657, 'binary_precision': 0.93303573, 'binary_recall': 0.653125, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.7683824}
confusion matrix:
     0    1
0  630   30
1  222  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8100437, 'precision': 0.85192645, 'recall': 0.8100437, 'specificity': 0.8100437, 'f1': 0.80421865, 'auroc': 0.9223508, 'binary_precision': 0.97333336, 'binary_recall': 0.6375546, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.7704485}
confusion matrix:
     0    1
0  225    4
1   83  146
early stop counter: 4
val acc:0.8061538338661194, best validation acc: 0.8553845882415771, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 16,now: 2024-07-26 04:23:28.901657,epoch time: 0:02:44.281295,used: 0:44:07.876135,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9855869, 'recall': 0.9848087, 'specificity': 0.9848087, 'f1': 0.9850132, 'auroc': 0.9997227, 'binary_precision': 0.97253436, 'binary_recall': 0.99871796, 'binary_specificity': 0.97089946, 'binary_f1_score': 0.9854523}
confusion matrix:
      0     1
0  1468    44
1     2  1558
---- Validation: 
scalar performance:
{'acc': 0.8353846, 'precision': 0.8360299, 'recall': 0.8357245, 'specificity': 0.8357245, 'f1': 0.8353706, 'auroc': 0.8884996, 'binary_precision': 0.81696427, 'binary_recall': 0.8578125, 'binary_specificity': 0.81363636, 'binary_f1_score': 0.8368903}
confusion matrix:
     0    1
0  537  123
1   91  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.81814694, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.8163698, 'auroc': 0.8848611, 'binary_precision': 0.79591835, 'binary_recall': 0.8515284, 'binary_specificity': 0.78165936, 'binary_f1_score': 0.8227848}
confusion matrix:
     0    1
0  179   50
1   34  195
early stop counter: 5
val acc:0.8353846073150635, best validation acc: 0.8553845882415771, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 17,now: 2024-07-26 04:26:12.868909,epoch time: 0:02:43.967252,used: 0:46:51.843387,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_39_20_seed_7_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 0:46:51.843387 at 2024-07-26 04:26:12.868909
persisted model performance metric: 

scalar performance:
{'acc': 0.8799127, 'precision': 0.8937974, 'recall': 0.8799126, 'specificity': 0.8799126, 'f1': 0.87884474, 'auroc': 0.9318663, 'binary_precision': 0.9677419, 'binary_recall': 0.7860262, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86746985}
confusion matrix:
     0    1
0  223    6
1   49  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8799127, 'precision': 0.8937974, 'recall': 0.8799126, 'specificity': 0.8799126, 'f1': 0.87884474, 'auroc': 0.9318663, 'binary_precision': 0.9677419, 'binary_recall': 0.7860262, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.86746985}
confusion matrix:
     0    1
0  223    6
1   49  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1620 MiB |   8297 MiB | 588749 GiB | 588747 GiB |
|       from large pool |   1530 MiB |   8223 MiB | 583608 GiB | 583606 GiB |
|       from small pool |     89 MiB |    130 MiB |   5140 GiB |   5140 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1620 MiB |   8297 MiB | 588749 GiB | 588747 GiB |
|       from large pool |   1530 MiB |   8223 MiB | 583608 GiB | 583606 GiB |
|       from small pool |     89 MiB |    130 MiB |   5140 GiB |   5140 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 587866 GiB | 587864 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 582733 GiB | 582731 GiB |
|       from small pool |     89 MiB |    130 MiB |   5133 GiB |   5133 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9050 MiB |   9444 MiB |  54718 MiB |  45668 MiB |
|       from large pool |   8914 MiB |   9308 MiB |  54310 MiB |  45396 MiB |
|       from small pool |    136 MiB |    140 MiB |    408 MiB |    272 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    801 MiB |   1447 MiB | 422796 GiB | 422796 GiB |
|       from large pool |    793 MiB |   1426 MiB | 417479 GiB | 417478 GiB |
|       from small pool |      8 MiB |     50 MiB |   5317 GiB |   5317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   83251 K  |   83249 K  |
|       from large pool |     382    |     808    |   42352 K  |   42351 K  |
|       from small pool |    2074    |    2766    |   40899 K  |   40897 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   83251 K  |   83249 K  |
|       from large pool |     382    |     808    |   42352 K  |   42351 K  |
|       from small pool |    2074    |    2766    |   40899 K  |   40897 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     299    |     326    |    1558    |    1259    |
|       from large pool |     231    |     259    |    1354    |    1123    |
|       from small pool |      68    |      70    |     204    |     136    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     156    |     329    |   46789 K  |   46789 K  |
|       from large pool |      73    |     249    |   26150 K  |   26150 K  |
|       from small pool |      83    |     240    |   20638 K  |   20638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 588749 GiB | 588749 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 583608 GiB | 583608 GiB |
|       from small pool |      0 KiB |    130 MiB |   5140 GiB |   5140 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 588749 GiB | 588749 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 583608 GiB | 583608 GiB |
|       from small pool |      0 KiB |    130 MiB |   5140 GiB |   5140 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 587866 GiB | 587866 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 582733 GiB | 582733 GiB |
|       from small pool |      0 KiB |    130 MiB |   5133 GiB |   5133 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2422 MiB |   9444 MiB |  54718 MiB |  52296 MiB |
|       from large pool |   2324 MiB |   9308 MiB |  54310 MiB |  51986 MiB |
|       from small pool |     98 MiB |    140 MiB |    408 MiB |    310 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 422797 GiB | 422797 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 417480 GiB | 417480 GiB |
|       from small pool |      0 KiB |     50 MiB |   5317 GiB |   5317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   83251 K  |   83251 K  |
|       from large pool |       2    |     808    |   42352 K  |   42352 K  |
|       from small pool |       0    |    2766    |   40899 K  |   40899 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   83251 K  |   83251 K  |
|       from large pool |       2    |     808    |   42352 K  |   42352 K  |
|       from small pool |       0    |    2766    |   40899 K  |   40899 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1558    |    1436    |
|       from large pool |      73    |     259    |    1354    |    1281    |
|       from small pool |      49    |      70    |     204    |     155    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   46789 K  |   46789 K  |
|       from large pool |       3    |     249    |   26150 K  |   26150 K  |
|       from small pool |       0    |     240    |   20638 K  |   20638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 588749 GiB | 588749 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 583608 GiB | 583608 GiB |
|       from small pool |      0 KiB |    130 MiB |   5140 GiB |   5140 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 588749 GiB | 588749 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 583608 GiB | 583608 GiB |
|       from small pool |      0 KiB |    130 MiB |   5140 GiB |   5140 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 587866 GiB | 587866 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 582733 GiB | 582733 GiB |
|       from small pool |      0 KiB |    130 MiB |   5133 GiB |   5133 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2422 MiB |   9444 MiB |  54718 MiB |  52296 MiB |
|       from large pool |   2324 MiB |   9308 MiB |  54310 MiB |  51986 MiB |
|       from small pool |     98 MiB |    140 MiB |    408 MiB |    310 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 422797 GiB | 422797 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 417480 GiB | 417480 GiB |
|       from small pool |      0 KiB |     50 MiB |   5317 GiB |   5317 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   83251 K  |   83251 K  |
|       from large pool |       2    |     808    |   42352 K  |   42352 K  |
|       from small pool |       0    |    2766    |   40899 K  |   40899 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   83251 K  |   83251 K  |
|       from large pool |       2    |     808    |   42352 K  |   42352 K  |
|       from small pool |       0    |    2766    |   40899 K  |   40899 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     122    |     326    |    1558    |    1436    |
|       from large pool |      73    |     259    |    1354    |    1281    |
|       from small pool |      49    |      70    |     204    |     155    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   46789 K  |   46789 K  |
|       from large pool |       3    |     249    |   26150 K  |   26150 K  |
|       from small pool |       0    |     240    |   20638 K  |   20638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719

 Experiment start at: 2024-07-26 04:26:46.657597
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9299342, 'precision': 0.935091, 'recall': 0.930562, 'specificity': 0.930562, 'f1': 0.9297874, 'auroc': 0.99034464, 'binary_precision': 0.98533726, 'binary_recall': 0.8744307, 'binary_specificity': 0.98669326, 'binary_f1_score': 0.9265771}
confusion matrix:
      0     1
0  1483    20
1   193  1344
---- Validation: 
scalar performance:
{'acc': 0.8561485, 'precision': 0.86552286, 'recall': 0.853598, 'specificity': 0.853598, 'f1': 0.8544666, 'auroc': 0.9291568, 'binary_precision': 0.9166667, 'binary_recall': 0.77316296, 'binary_specificity': 0.934033, 'binary_f1_score': 0.83882153}
confusion matrix:
     0    1
0  623   44
1  142  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.848966, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.83834743, 'auroc': 0.92163956, 'binary_precision': 0.9065934, 'binary_recall': 0.75688076, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  201   17
1   53  165
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:29:30.195705,epoch time: 0:02:43.538108,used: 0:02:43.538108,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9305921, 'precision': 0.93841213, 'recall': 0.9314044, 'specificity': 0.9314044, 'f1': 0.9303613, 'auroc': 0.9954971, 'binary_precision': 1.0, 'binary_recall': 0.8628088, 'binary_specificity': 1.0, 'binary_f1_score': 0.9263525}
confusion matrix:
      0     1
0  1502     0
1   211  1327
---- Validation: 
scalar performance:
{'acc': 0.57772624, 'precision': 0.73360485, 'recall': 0.5642905, 'specificity': 0.5642905, 'f1': 0.4754244, 'auroc': 0.7577393, 'binary_precision': 0.9166667, 'binary_recall': 0.14057508, 'binary_specificity': 0.988006, 'binary_f1_score': 0.24376729}
confusion matrix:
     0   1
0  659   8
1  538  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5045872, 'precision': 0.56366825, 'recall': 0.5045872, 'specificity': 0.5045872, 'f1': 0.35494125, 'auroc': 0.86238, 'binary_precision': 0.625, 'binary_recall': 0.02293578, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.044247784}
confusion matrix:
     0  1
0  215  3
1  213  5
early stop counter: 1
val acc:0.5777262449264526, best validation acc: 0.8561484813690186, corresponding to test acc:                         0.8394495248794556 / 0.8394495248794556
after epoch: 2,now: 2024-07-26 04:32:12.244102,epoch time: 0:02:42.048397,used: 0:05:25.586505,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95986843, 'precision': 0.9623705, 'recall': 0.960305, 'specificity': 0.960305, 'f1': 0.95983624, 'auroc': 0.9955673, 'binary_precision': 0.9992943, 'binary_recall': 0.9212752, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.95870006}
confusion matrix:
      0     1
0  1502     1
1   121  1416
---- Validation: 
scalar performance:
{'acc': 0.6697602, 'precision': 0.7810833, 'recall': 0.65948576, 'specificity': 0.65948576, 'f1': 0.62516224, 'auroc': 0.87669504, 'binary_precision': 0.95022625, 'binary_recall': 0.33546326, 'binary_specificity': 0.9835082, 'binary_f1_score': 0.4958678}
confusion matrix:
     0    1
0  656   11
1  416  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6215596, 'precision': 0.775686, 'recall': 0.6215596, 'specificity': 0.6215596, 'f1': 0.56007266, 'auroc': 0.8865837, 'binary_precision': 0.9818182, 'binary_recall': 0.24770643, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.39560443}
confusion matrix:
     0   1
0  217   1
1  164  54
early stop counter: 2
val acc:0.6697602272033691, best validation acc: 0.8561484813690186, corresponding to test acc:                         0.8394495248794556 / 0.8394495248794556
after epoch: 3,now: 2024-07-26 04:34:55.849664,epoch time: 0:02:43.605562,used: 0:08:09.192067,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97960526, 'precision': 0.97967315, 'recall': 0.9795586, 'specificity': 0.9795586, 'f1': 0.97960055, 'auroc': 0.99802387, 'binary_precision': 0.9761136, 'binary_recall': 0.98373455, 'binary_specificity': 0.97538257, 'binary_f1_score': 0.97990924}
confusion matrix:
      0     1
0  1466    37
1    25  1512
---- Validation: 
scalar performance:
{'acc': 0.75328696, 'precision': 0.7853791, 'recall': 0.7477607, 'specificity': 0.7477607, 'f1': 0.7432213, 'auroc': 0.88530016, 'binary_precision': 0.8734793, 'binary_recall': 0.57348245, 'binary_specificity': 0.922039, 'binary_f1_score': 0.6923819}
confusion matrix:
     0    1
0  615   52
1  267  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80504584, 'precision': 0.8368653, 'recall': 0.80504584, 'specificity': 0.80504584, 'f1': 0.80033076, 'auroc': 0.888288, 'binary_precision': 0.9403973, 'binary_recall': 0.6513761, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.7696476}
confusion matrix:
     0    1
0  209    9
1   76  142
early stop counter: 3
val acc:0.7532869577407837, best validation acc: 0.8561484813690186, corresponding to test acc:                         0.8394495248794556 / 0.8394495248794556
after epoch: 4,now: 2024-07-26 04:37:40.011417,epoch time: 0:02:44.161753,used: 0:10:53.353820,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9838816, 'precision': 0.98386705, 'recall': 0.98392004, 'specificity': 0.98392004, 'f1': 0.98388064, 'auroc': 0.9988204, 'binary_precision': 0.9875491, 'binary_recall': 0.98048145, 'binary_specificity': 0.9873586, 'binary_f1_score': 0.9840026}
confusion matrix:
      0     1
0  1484    19
1    30  1507
---- Validation: 
scalar performance:
{'acc': 0.8321732, 'precision': 0.8448063, 'recall': 0.8290831, 'specificity': 0.8290831, 'f1': 0.82956344, 'auroc': 0.89528716, 'binary_precision': 0.90335304, 'binary_recall': 0.7316294, 'binary_specificity': 0.92653674, 'binary_f1_score': 0.80847305}
confusion matrix:
     0    1
0  618   49
1  168  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80733943, 'precision': 0.8524614, 'recall': 0.80733943, 'specificity': 0.80733943, 'f1': 0.8009695, 'auroc': 0.8804814, 'binary_precision': 0.9785714, 'binary_recall': 0.6284404, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.7653631}
confusion matrix:
     0    1
0  215    3
1   81  137
early stop counter: 4
val acc:0.832173228263855, best validation acc: 0.8561484813690186, corresponding to test acc:                         0.8394495248794556 / 0.8394495248794556
after epoch: 5,now: 2024-07-26 04:40:23.336943,epoch time: 0:02:43.325526,used: 0:13:36.679346,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9467105, 'precision': 0.9497617, 'recall': 0.9462697, 'specificity': 0.9462697, 'f1': 0.94657695, 'auroc': 0.99601185, 'binary_precision': 0.91540784, 'binary_recall': 0.9856864, 'binary_specificity': 0.90685296, 'binary_f1_score': 0.94924814}
confusion matrix:
      0     1
0  1363   140
1    22  1515
---- Validation: 
scalar performance:
{'acc': 0.82675946, 'precision': 0.8289422, 'recall': 0.8253577, 'specificity': 0.8253577, 'f1': 0.8258971, 'auroc': 0.9062083, 'binary_precision': 0.8489583, 'binary_recall': 0.78115016, 'binary_specificity': 0.8695652, 'binary_f1_score': 0.8136439}
confusion matrix:
     0    1
0  580   87
1  137  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7614679, 'precision': 0.76585364, 'recall': 0.7614679, 'specificity': 0.7614679, 'f1': 0.76048005, 'auroc': 0.80260503, 'binary_precision': 0.8, 'binary_recall': 0.6972477, 'binary_specificity': 0.82568806, 'binary_f1_score': 0.745098}
confusion matrix:
     0    1
0  180   38
1   66  152
early stop counter: 5
val acc:0.8267594575881958, best validation acc: 0.8561484813690186, corresponding to test acc:                         0.8394495248794556 / 0.8394495248794556
after epoch: 6,now: 2024-07-26 04:43:06.131504,epoch time: 0:02:42.794561,used: 0:16:19.473907,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_26_46_seed_8_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:16:19.473907 at 2024-07-26 04:43:06.131504
persisted model performance metric: 

scalar performance:
{'acc': 0.8394495, 'precision': 0.848966, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.83834743, 'auroc': 0.92163956, 'binary_precision': 0.9065934, 'binary_recall': 0.75688076, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  201   17
1   53  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8394495, 'precision': 0.848966, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.83834743, 'auroc': 0.92163956, 'binary_precision': 0.9065934, 'binary_recall': 0.75688076, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.82500005}
confusion matrix:
     0    1
0  201   17
1   53  165
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1620 MiB |   8297 MiB | 628167 GiB | 628166 GiB |
|       from large pool |   1530 MiB |   8223 MiB | 622682 GiB | 622680 GiB |
|       from small pool |     89 MiB |    130 MiB |   5485 GiB |   5485 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1620 MiB |   8297 MiB | 628167 GiB | 628166 GiB |
|       from large pool |   1530 MiB |   8223 MiB | 622682 GiB | 622680 GiB |
|       from small pool |     89 MiB |    130 MiB |   5485 GiB |   5485 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 627188 GiB | 627186 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 621711 GiB | 621709 GiB |
|       from small pool |     89 MiB |    130 MiB |   5477 GiB |   5477 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9058 MiB |   9444 MiB |  61354 MiB |  52296 MiB |
|       from large pool |   8922 MiB |   9308 MiB |  60908 MiB |  51986 MiB |
|       from small pool |    136 MiB |    140 MiB |    446 MiB |    310 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 769493 KiB |   1447 MiB | 450867 GiB | 450866 GiB |
|       from large pool | 759109 KiB |   1426 MiB | 445192 GiB | 445192 GiB |
|       from small pool |  10384 KiB |     50 MiB |   5674 GiB |   5674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2450    |    3301    |   88829 K  |   88827 K  |
|       from large pool |     382    |     808    |   45187 K  |   45186 K  |
|       from small pool |    2068    |    2766    |   43642 K  |   43640 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2450    |    3301    |   88829 K  |   88827 K  |
|       from large pool |     382    |     808    |   45187 K  |   45186 K  |
|       from small pool |    2068    |    2766    |   43642 K  |   43640 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     307    |     326    |    1743    |    1436    |
|       from large pool |     239    |     259    |    1520    |    1281    |
|       from small pool |      68    |      70    |     223    |     155    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     163    |     329    |   49959 K  |   49958 K  |
|       from large pool |      75    |     249    |   27944 K  |   27944 K  |
|       from small pool |      88    |     240    |   22014 K  |   22014 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 628167 GiB | 628167 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 622682 GiB | 622682 GiB |
|       from small pool |      0 KiB |    130 MiB |   5485 GiB |   5485 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 628167 GiB | 628167 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 622682 GiB | 622682 GiB |
|       from small pool |      0 KiB |    130 MiB |   5485 GiB |   5485 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 627188 GiB | 627188 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 621711 GiB | 621711 GiB |
|       from small pool |      0 KiB |    130 MiB |   5477 GiB |   5477 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   9444 MiB |  61354 MiB |  58982 MiB |
|       from large pool |   2272 MiB |   9308 MiB |  60908 MiB |  58636 MiB |
|       from small pool |    100 MiB |    140 MiB |    446 MiB |    346 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 450868 GiB | 450868 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 445193 GiB | 445193 GiB |
|       from small pool |      0 KiB |     50 MiB |   5674 GiB |   5674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   88829 K  |   88829 K  |
|       from large pool |       2    |     808    |   45187 K  |   45187 K  |
|       from small pool |       0    |    2766    |   43642 K  |   43642 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   88829 K  |   88829 K  |
|       from large pool |       2    |     808    |   45187 K  |   45187 K  |
|       from small pool |       0    |    2766    |   43642 K  |   43642 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     326    |    1743    |    1622    |
|       from large pool |      71    |     259    |    1520    |    1449    |
|       from small pool |      50    |      70    |     223    |     173    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   49959 K  |   49959 K  |
|       from large pool |       3    |     249    |   27944 K  |   27944 K  |
|       from small pool |       0    |     240    |   22014 K  |   22014 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 628167 GiB | 628167 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 622682 GiB | 622682 GiB |
|       from small pool |      0 KiB |    130 MiB |   5485 GiB |   5485 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 628167 GiB | 628167 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 622682 GiB | 622682 GiB |
|       from small pool |      0 KiB |    130 MiB |   5485 GiB |   5485 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 627188 GiB | 627188 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 621711 GiB | 621711 GiB |
|       from small pool |      0 KiB |    130 MiB |   5477 GiB |   5477 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2372 MiB |   9444 MiB |  61354 MiB |  58982 MiB |
|       from large pool |   2272 MiB |   9308 MiB |  60908 MiB |  58636 MiB |
|       from small pool |    100 MiB |    140 MiB |    446 MiB |    346 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 450868 GiB | 450868 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 445193 GiB | 445193 GiB |
|       from small pool |      0 KiB |     50 MiB |   5674 GiB |   5674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   88829 K  |   88829 K  |
|       from large pool |       2    |     808    |   45187 K  |   45187 K  |
|       from small pool |       0    |    2766    |   43642 K  |   43642 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   88829 K  |   88829 K  |
|       from large pool |       2    |     808    |   45187 K  |   45187 K  |
|       from small pool |       0    |    2766    |   43642 K  |   43642 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     326    |    1743    |    1622    |
|       from large pool |      71    |     259    |    1520    |    1449    |
|       from small pool |      50    |      70    |     223    |     173    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   49959 K  |   49959 K  |
|       from large pool |       3    |     249    |   27944 K  |   27944 K  |
|       from small pool |       0    |     240    |   22014 K  |   22014 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/init.py:452: UserWarning: Initializing zero-element tensors is a no-op
  warnings.warn("Initializing zero-element tensors is a no-op")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719

 Experiment start at: 2024-07-26 04:43:40.847085
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.9676053, 'recall': 0.9676007, 'specificity': 0.9676007, 'f1': 0.96760285, 'auroc': 0.9964179, 'binary_precision': 0.96753246, 'binary_recall': 0.96816117, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.9678467}
confusion matrix:
      0     1
0  1467    50
1    49  1490
---- Validation: 
scalar performance:
{'acc': 0.7945946, 'precision': 0.8188313, 'recall': 0.79596937, 'specificity': 0.79596937, 'f1': 0.7911209, 'auroc': 0.90661335, 'binary_precision': 0.72838, 'binary_recall': 0.9329173, 'binary_specificity': 0.6590214, 'binary_f1_score': 0.8180575}
confusion matrix:
     0    1
0  431  223
1   43  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.81384015, 'recall': 0.8043479, 'specificity': 0.8043479, 'f1': 0.80285716, 'auroc': 0.9053308, 'binary_precision': 0.7592593, 'binary_recall': 0.8913044, 'binary_specificity': 0.7173913, 'binary_f1_score': 0.82}
confusion matrix:
     0    1
0  165   65
1   25  205
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:46:25.371987,epoch time: 0:02:44.524902,used: 0:02:44.524902,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.9728109, 'recall': 0.97243905, 'specificity': 0.97243905, 'f1': 0.9725045, 'auroc': 0.9965353, 'binary_precision': 0.9624682, 'binary_recall': 0.9837451, 'binary_specificity': 0.96113306, 'binary_f1_score': 0.97299033}
confusion matrix:
      0     1
0  1459    59
1    25  1513
---- Validation: 
scalar performance:
{'acc': 0.8332046, 'precision': 0.83461773, 'recall': 0.83352894, 'specificity': 0.83352894, 'f1': 0.833109, 'auroc': 0.8930737, 'binary_precision': 0.810219, 'binary_recall': 0.86583465, 'binary_specificity': 0.8012232, 'binary_f1_score': 0.8371041}
confusion matrix:
     0    1
0  524  130
1   86  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85, 'precision': 0.8511217, 'recall': 0.85, 'specificity': 0.85, 'f1': 0.8498801, 'auroc': 0.9320415, 'binary_precision': 0.87096775, 'binary_recall': 0.82173914, 'binary_specificity': 0.87826085, 'binary_f1_score': 0.84563756}
confusion matrix:
     0    1
0  202   28
1   41  189
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:49:09.582853,epoch time: 0:02:44.210866,used: 0:05:28.735768,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9712289, 'recall': 0.97078824, 'specificity': 0.97078824, 'f1': 0.9708661, 'auroc': 0.99562776, 'binary_precision': 0.96002537, 'binary_recall': 0.9831059, 'binary_specificity': 0.95847064, 'binary_f1_score': 0.9714286}
confusion matrix:
      0     1
0  1454    63
1    26  1513
---- Validation: 
scalar performance:
{'acc': 0.7853282, 'precision': 0.793633, 'recall': 0.78615934, 'specificity': 0.78615934, 'f1': 0.784117, 'auroc': 0.83995044, 'binary_precision': 0.74167776, 'binary_recall': 0.8689548, 'binary_specificity': 0.7033639, 'binary_f1_score': 0.8002874}
confusion matrix:
     0    1
0  460  194
1   84  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84565216, 'precision': 0.84802717, 'recall': 0.84565216, 'specificity': 0.84565216, 'f1': 0.8453884, 'auroc': 0.91306233, 'binary_precision': 0.8192771, 'binary_recall': 0.8869565, 'binary_specificity': 0.8043478, 'binary_f1_score': 0.8517745}
confusion matrix:
     0    1
0  185   45
1   26  204
early stop counter: 1
val acc:0.785328209400177, best validation acc: 0.8332046270370483, corresponding to test acc:                         0.8500000238418579 / 0.8500000238418579
after epoch: 3,now: 2024-07-26 04:51:52.768017,epoch time: 0:02:43.185164,used: 0:08:11.920932,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.98645306, 'recall': 0.986333, 'specificity': 0.986333, 'f1': 0.9862562, 'auroc': 0.99847984, 'binary_precision': 0.99800265, 'binary_recall': 0.9746424, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.98618424}
confusion matrix:
      0     1
0  1515     3
1    39  1499
---- Validation: 
scalar performance:
{'acc': 0.85405403, 'precision': 0.8546492, 'recall': 0.85384554, 'specificity': 0.85384554, 'f1': 0.8539283, 'auroc': 0.9302528, 'binary_precision': 0.8668831, 'binary_recall': 0.8330733, 'binary_specificity': 0.87461776, 'binary_f1_score': 0.84964204}
confusion matrix:
     0    1
0  572   82
1  107  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8173913, 'precision': 0.8283401, 'recall': 0.8173913, 'specificity': 0.8173913, 'f1': 0.8158562, 'auroc': 0.9041588, 'binary_precision': 0.88829786, 'binary_recall': 0.726087, 'binary_specificity': 0.90869564, 'binary_f1_score': 0.79904306}
confusion matrix:
     0    1
0  209   21
1   63  167
better model found
persisted
after epoch: 4,now: 2024-07-26 04:54:36.795973,epoch time: 0:02:44.027956,used: 0:10:55.948888,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9843994, 'recall': 0.98424995, 'specificity': 0.98424995, 'f1': 0.98429054, 'auroc': 0.9989729, 'binary_precision': 0.9788054, 'binary_recall': 0.9902534, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9844962}
confusion matrix:
      0     1
0  1484    33
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.85096526, 'precision': 0.8523679, 'recall': 0.85128355, 'specificity': 0.85128355, 'f1': 0.8508852, 'auroc': 0.9125959, 'binary_precision': 0.8274854, 'binary_recall': 0.8829953, 'binary_specificity': 0.81957185, 'binary_f1_score': 0.8543396}
confusion matrix:
     0    1
0  536  118
1   75  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87173915, 'precision': 0.8720838, 'recall': 0.87173915, 'specificity': 0.87173915, 'f1': 0.87170947, 'auroc': 0.93378067, 'binary_precision': 0.8607595, 'binary_recall': 0.8869565, 'binary_specificity': 0.8565217, 'binary_f1_score': 0.8736617}
confusion matrix:
     0    1
0  197   33
1   26  204
new oracle model saved
early stop counter: 1
val acc:0.8509652614593506, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.8173912763595581 / 0.8717391490936279
after epoch: 5,now: 2024-07-26 04:57:20.079647,epoch time: 0:02:43.283674,used: 0:13:39.232562,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98150355, 'recall': 0.98114717, 'specificity': 0.98114717, 'f1': 0.9810188, 'auroc': 0.9991112, 'binary_precision': 0.9986532, 'binary_recall': 0.96361274, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98082006}
confusion matrix:
      0     1
0  1515     2
1    56  1483
---- Validation: 
scalar performance:
{'acc': 0.5822394, 'precision': 0.63013387, 'recall': 0.57910395, 'specificity': 0.57910395, 'f1': 0.53519285, 'auroc': 0.7777817, 'binary_precision': 0.7066116, 'binary_recall': 0.26677066, 'binary_specificity': 0.8914373, 'binary_f1_score': 0.38731596}
confusion matrix:
     0    1
0  583   71
1  470  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6043478, 'precision': 0.73, 'recall': 0.6043478, 'specificity': 0.6043478, 'f1': 0.5417624, 'auroc': 0.87805295, 'binary_precision': 0.9, 'binary_recall': 0.2347826, 'binary_specificity': 0.973913, 'binary_f1_score': 0.37241378}
confusion matrix:
     0   1
0  224   6
1  176  54
early stop counter: 2
val acc:0.5822393894195557, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.8173912763595581 / 0.8717391490936279
after epoch: 6,now: 2024-07-26 05:00:03.427700,epoch time: 0:02:43.348053,used: 0:16:22.580615,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.963678, 'precision': 0.96459335, 'recall': 0.9635277, 'specificity': 0.9635277, 'f1': 0.9636499, 'auroc': 0.9960034, 'binary_precision': 0.9456929, 'binary_recall': 0.98440546, 'binary_specificity': 0.94264996, 'binary_f1_score': 0.964661}
confusion matrix:
      0     1
0  1430    87
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.7876448, 'precision': 0.78808236, 'recall': 0.7874296, 'specificity': 0.7874296, 'f1': 0.78746176, 'auroc': 0.84050155, 'binary_precision': 0.7970779, 'binary_recall': 0.7659906, 'binary_specificity': 0.8088685, 'binary_f1_score': 0.7812251}
confusion matrix:
     0    1
0  529  125
1  150  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76521736, 'precision': 0.76571965, 'recall': 0.7652174, 'specificity': 0.7652174, 'f1': 0.7651063, 'auroc': 0.8023866, 'binary_precision': 0.7772727, 'binary_recall': 0.74347824, 'binary_specificity': 0.78695655, 'binary_f1_score': 0.75999993}
confusion matrix:
     0    1
0  181   49
1   59  171
early stop counter: 3
val acc:0.7876448035240173, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.8173912763595581 / 0.8717391490936279
after epoch: 7,now: 2024-07-26 05:02:46.845416,epoch time: 0:02:43.417716,used: 0:19:05.998331,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9787304, 'precision': 0.97872365, 'recall': 0.97874105, 'specificity': 0.97874105, 'f1': 0.9787297, 'auroc': 0.99827987, 'binary_precision': 0.9804433, 'binary_recall': 0.97725797, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9788481}
confusion matrix:
      0     1
0  1487    30
1    35  1504
---- Validation: 
scalar performance:
{'acc': 0.788417, 'precision': 0.80410355, 'recall': 0.78726375, 'specificity': 0.78726375, 'f1': 0.78517854, 'auroc': 0.8828927, 'binary_precision': 0.8707071, 'binary_recall': 0.6723869, 'binary_specificity': 0.9021407, 'binary_f1_score': 0.75880283}
confusion matrix:
     0    1
0  590   64
1  210  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7673913, 'precision': 0.78908056, 'recall': 0.7673913, 'specificity': 0.7673913, 'f1': 0.76294494, 'auroc': 0.85952747, 'binary_precision': 0.8682635, 'binary_recall': 0.6304348, 'binary_specificity': 0.90434784, 'binary_f1_score': 0.73047864}
confusion matrix:
     0    1
0  208   22
1   85  145
early stop counter: 4
val acc:0.7884169816970825, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.8173912763595581 / 0.8717391490936279
after epoch: 8,now: 2024-07-26 05:05:29.695118,epoch time: 0:02:42.849702,used: 0:21:48.848033,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.98828083, 'recall': 0.98828083, 'specificity': 0.98828083, 'f1': 0.9882199, 'auroc': 0.9993849, 'binary_precision': 0.9960422, 'binary_recall': 0.9805195, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9882199}
confusion matrix:
      0     1
0  1510     6
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.642471, 'precision': 0.7223687, 'recall': 0.63941926, 'specificity': 0.63941926, 'f1': 0.60434425, 'auroc': 0.871209, 'binary_precision': 0.8531746, 'binary_recall': 0.33541343, 'binary_specificity': 0.94342506, 'binary_f1_score': 0.48152298}
confusion matrix:
     0    1
0  617   37
1  426  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6695652, 'precision': 0.7788832, 'recall': 0.6695652, 'specificity': 0.6695652, 'f1': 0.63366586, 'auroc': 0.88688564, 'binary_precision': 0.95348835, 'binary_recall': 0.35652173, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.51898736}
confusion matrix:
     0   1
0  226   4
1  148  82
early stop counter: 5
val acc:0.6424710154533386, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.8173912763595581 / 0.8717391490936279
after epoch: 9,now: 2024-07-26 05:08:12.795298,epoch time: 0:02:43.100180,used: 0:24:31.948213,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_43_40_seed_9_23064719
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:24:31.948213 at 2024-07-26 05:08:12.795298
persisted model performance metric: 

scalar performance:
{'acc': 0.8173913, 'precision': 0.8283401, 'recall': 0.8173913, 'specificity': 0.8173913, 'f1': 0.8158562, 'auroc': 0.9041588, 'binary_precision': 0.88829786, 'binary_recall': 0.726087, 'binary_specificity': 0.90869564, 'binary_f1_score': 0.79904306}
confusion matrix:
     0    1
0  209   21
1   63  167
oracle model performance metric: 

scalar performance:
{'acc': 0.87173915, 'precision': 0.8720838, 'recall': 0.87173915, 'specificity': 0.87173915, 'f1': 0.87170947, 'auroc': 0.93378067, 'binary_precision': 0.8607595, 'binary_recall': 0.8869565, 'binary_specificity': 0.8565217, 'binary_f1_score': 0.8736617}
confusion matrix:
     0    1
0  197   33
1   26  204
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1621 MiB |   8297 MiB | 687539 GiB | 687538 GiB |
|       from large pool |   1531 MiB |   8223 MiB | 681535 GiB | 681534 GiB |
|       from small pool |     89 MiB |    130 MiB |   6003 GiB |   6003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   1621 MiB |   8297 MiB | 687539 GiB | 687538 GiB |
|       from large pool |   1531 MiB |   8223 MiB | 681535 GiB | 681534 GiB |
|       from small pool |     89 MiB |    130 MiB |   6003 GiB |   6003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1603 MiB |   8284 MiB | 686444 GiB | 686443 GiB |
|       from large pool |   1513 MiB |   8209 MiB | 680449 GiB | 680448 GiB |
|       from small pool |     89 MiB |    130 MiB |   5994 GiB |   5994 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9058 MiB |   9444 MiB |  68040 MiB |  58982 MiB |
|       from large pool |   8922 MiB |   9308 MiB |  67558 MiB |  58636 MiB |
|       from small pool |    136 MiB |    140 MiB |    482 MiB |    346 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    774 MiB |   1447 MiB | 493875 GiB | 493874 GiB |
|       from large pool |    766 MiB |   1426 MiB | 487663 GiB | 487663 GiB |
|       from small pool |      8 MiB |     50 MiB |   6211 GiB |   6211 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2456    |    3301    |   97227 K  |   97224 K  |
|       from large pool |     382    |     808    |   49457 K  |   49456 K  |
|       from small pool |    2074    |    2766    |   47770 K  |   47768 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2456    |    3301    |   97227 K  |   97224 K  |
|       from large pool |     382    |     808    |   49457 K  |   49456 K  |
|       from small pool |    2074    |    2766    |   47770 K  |   47768 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     307    |     326    |    1929    |    1622    |
|       from large pool |     239    |     259    |    1688    |    1449    |
|       from small pool |      68    |      70    |     241    |     173    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     156    |     329    |   54792 K  |   54792 K  |
|       from large pool |      69    |     249    |   30662 K  |   30662 K  |
|       from small pool |      87    |     240    |   24129 K  |   24129 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8297 MiB | 687539 GiB | 687539 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 681535 GiB | 681535 GiB |
|       from small pool |      0 KiB |    130 MiB |   6003 GiB |   6003 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8297 MiB | 687539 GiB | 687539 GiB |
|       from large pool |  16640 KiB |   8223 MiB | 681535 GiB | 681535 GiB |
|       from small pool |      0 KiB |    130 MiB |   6003 GiB |   6003 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8284 MiB | 686444 GiB | 686444 GiB |
|       from large pool |  16640 KiB |   8209 MiB | 680449 GiB | 680449 GiB |
|       from small pool |      0 KiB |    130 MiB |   5994 GiB |   5994 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2396 MiB |   9444 MiB |  68040 MiB |  65644 MiB |
|       from large pool |   2298 MiB |   9308 MiB |  67558 MiB |  65260 MiB |
|       from small pool |     98 MiB |    140 MiB |    482 MiB |    384 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1447 MiB | 493876 GiB | 493875 GiB |
|       from large pool |  24320 KiB |   1426 MiB | 487664 GiB | 487664 GiB |
|       from small pool |      0 KiB |     50 MiB |   6211 GiB |   6211 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3301    |   97227 K  |   97227 K  |
|       from large pool |       2    |     808    |   49457 K  |   49457 K  |
|       from small pool |       0    |    2766    |   47770 K  |   47770 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3301    |   97227 K  |   97227 K  |
|       from large pool |       2    |     808    |   49457 K  |   49457 K  |
|       from small pool |       0    |    2766    |   47770 K  |   47770 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     121    |     326    |    1929    |    1808    |
|       from large pool |      72    |     259    |    1688    |    1616    |
|       from small pool |      49    |      70    |     241    |     192    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     329    |   54792 K  |   54792 K  |
|       from large pool |       3    |     249    |   30662 K  |   30662 K  |
|       from small pool |       0    |     240    |   24130 K  |   24130 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 05:08:26 2024]
Finished job 0.
1 of 1 steps (100%) done
