Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 02:21:06 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734

 Experiment start at: 2024-07-26 02:23:25.176172
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554036, 'precision': 0.9562217, 'recall': 0.955714, 'specificity': 0.955714, 'f1': 0.95539784, 'auroc': 0.9912251, 'binary_precision': 0.9790682, 'binary_recall': 0.9318766, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.95488966}
confusion matrix:
      0     1
0  1485    31
1   106  1450
---- Validation: 
scalar performance:
{'acc': 0.6576087, 'precision': 0.7030742, 'recall': 0.6542101, 'specificity': 0.6542101, 'f1': 0.6343262, 'auroc': 0.8238077, 'binary_precision': 0.7957317, 'binary_recall': 0.41102362, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.5420561}
confusion matrix:
     0    1
0  586   67
1  374  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.71485674, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6480231, 'auroc': 0.8437642, 'binary_precision': 0.81578946, 'binary_recall': 0.43255815, 'binary_specificity': 0.9023256, 'binary_f1_score': 0.5653495}
confusion matrix:
     0   1
0  194  21
1  122  93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:25:35.853518,epoch time: 0:02:10.677346,used: 0:02:10.677346,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.96146834, 'recall': 0.96115047, 'specificity': 0.96115047, 'f1': 0.96124566, 'auroc': 0.9951295, 'binary_precision': 0.9544592, 'binary_recall': 0.96979433, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.9620657}
confusion matrix:
      0     1
0  1444    72
1    47  1509
---- Validation: 
scalar performance:
{'acc': 0.7173913, 'precision': 0.72195125, 'recall': 0.716316, 'specificity': 0.716316, 'f1': 0.7152381, 'auroc': 0.7964983, 'binary_precision': 0.7504621, 'binary_recall': 0.6393701, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.6904762}
confusion matrix:
     0    1
0  518  135
1  229  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74418604, 'precision': 0.75590014, 'recall': 0.74418604, 'specificity': 0.74418604, 'f1': 0.7412246, 'auroc': 0.869205, 'binary_precision': 0.7011494, 'binary_recall': 0.8511628, 'binary_specificity': 0.6372093, 'binary_f1_score': 0.76890755}
confusion matrix:
     0    1
0  137   78
1   32  183
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:27:26.041419,epoch time: 0:01:50.187901,used: 0:04:00.865247,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.9662217, 'recall': 0.9652556, 'specificity': 0.9652556, 'f1': 0.9648337, 'auroc': 0.99642885, 'binary_precision': 0.9952153, 'binary_recall': 0.93513167, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9642384}
confusion matrix:
      0     1
0  1508     7
1   101  1456
---- Validation: 
scalar performance:
{'acc': 0.57841617, 'precision': 0.75314814, 'recall': 0.57252777, 'specificity': 0.57252777, 'f1': 0.48313805, 'auroc': 0.89079356, 'binary_precision': 0.96, 'binary_recall': 0.1511811, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.2612245}
confusion matrix:
     0   1
0  649   4
1  539  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5232558, 'precision': 0.75595236, 'recall': 0.5232558, 'specificity': 0.5232558, 'f1': 0.38302714, 'auroc': 0.91307735, 'binary_precision': 1.0, 'binary_recall': 0.046511628, 'binary_specificity': 1.0, 'binary_f1_score': 0.08888888}
confusion matrix:
     0   1
0  215   0
1  205  10
early stop counter: 1
val acc:0.5784161686897278, best validation acc: 0.717391312122345, corresponding to test acc:                         0.7441860437393188 / 0.7441860437393188
after epoch: 3,now: 2024-07-26 02:29:12.936658,epoch time: 0:01:46.895239,used: 0:05:47.760486,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97966015, 'recall': 0.9793997, 'specificity': 0.9793997, 'f1': 0.9794841, 'auroc': 0.99801433, 'binary_precision': 0.97336715, 'binary_recall': 0.98650384, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9798914}
confusion matrix:
      0     1
0  1474    42
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.70962733, 'precision': 0.7150214, 'recall': 0.708442, 'specificity': 0.708442, 'f1': 0.7069986, 'auroc': 0.8091763, 'binary_precision': 0.7457627, 'binary_recall': 0.62362206, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.6792453}
confusion matrix:
     0    1
0  518  135
1  239  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.80240136, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.783114, 'auroc': 0.89393187, 'binary_precision': 0.73207545, 'binary_recall': 0.9023256, 'binary_specificity': 0.66976744, 'binary_f1_score': 0.8083333}
confusion matrix:
     0    1
0  144   71
1   21  194
new oracle model saved
early stop counter: 2
val acc:0.7096273303031921, best validation acc: 0.717391312122345, corresponding to test acc:                         0.7441860437393188 / 0.7860465049743652
after epoch: 4,now: 2024-07-26 02:31:00.810857,epoch time: 0:01:47.874199,used: 0:07:35.634685,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.966455, 'recall': 0.96525353, 'specificity': 0.96525353, 'f1': 0.96545964, 'auroc': 0.997184, 'binary_precision': 0.9480198, 'binary_recall': 0.985843, 'binary_specificity': 0.94466406, 'binary_f1_score': 0.9665615}
confusion matrix:
      0     1
0  1434    84
1    22  1532
---- Validation: 
scalar performance:
{'acc': 0.7919255, 'precision': 0.794056, 'recall': 0.79129875, 'specificity': 0.79129875, 'f1': 0.79127324, 'auroc': 0.883127, 'binary_precision': 0.81583476, 'binary_recall': 0.7464567, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.77960527}
confusion matrix:
     0    1
0  546  107
1  161  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.80680156, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8043082, 'auroc': 0.8744186, 'binary_precision': 0.8324873, 'binary_recall': 0.7627907, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7961164}
confusion matrix:
     0    1
0  182   33
1   51  164
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 02:32:49.578572,epoch time: 0:01:48.767715,used: 0:09:24.402400,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97988975, 'recall': 0.9797219, 'specificity': 0.9797219, 'f1': 0.9794917, 'auroc': 0.9986634, 'binary_precision': 0.99733514, 'binary_recall': 0.96208227, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9793916}
confusion matrix:
      0     1
0  1512     4
1    59  1497
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7388892, 'recall': 0.7079271, 'specificity': 0.7079271, 'f1': 0.6998968, 'auroc': 0.841051, 'binary_precision': 0.81796116, 'binary_recall': 0.5307087, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.64374405}
confusion matrix:
     0    1
0  578   75
1  298  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.8023321, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80232453, 'auroc': 0.8737047, 'binary_precision': 0.8037383, 'binary_recall': 0.8, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8018648}
confusion matrix:
     0    1
0  173   42
1   43  172
early stop counter: 1
val acc:0.7104037404060364, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.804651141166687 / 0.804651141166687
after epoch: 6,now: 2024-07-26 02:34:36.414092,epoch time: 0:01:46.835520,used: 0:11:11.237920,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9807791, 'recall': 0.9808107, 'specificity': 0.9808107, 'f1': 0.9807923, 'auroc': 0.99837303, 'binary_precision': 0.9825694, 'binary_recall': 0.97940797, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.9809861}
confusion matrix:
      0     1
0  1491    27
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.7855197, 'recall': 0.7563553, 'specificity': 0.7563553, 'f1': 0.75161946, 'auroc': 0.8763598, 'binary_precision': 0.86986303, 'binary_recall': 0.6, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.7101584}
confusion matrix:
     0    1
0  596   57
1  254  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.84089833, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.8074956, 'auroc': 0.9136615, 'binary_precision': 0.94078946, 'binary_recall': 0.66511625, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.77929145}
confusion matrix:
     0    1
0  206    9
1   72  143
new oracle model saved
early stop counter: 2
val acc:0.7585403919219971, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.804651141166687 / 0.8116279244422913
after epoch: 7,now: 2024-07-26 02:36:24.213176,epoch time: 0:01:47.799084,used: 0:12:59.037004,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9796078, 'recall': 0.9796605, 'specificity': 0.9796605, 'f1': 0.97949207, 'auroc': 0.99827075, 'binary_precision': 0.991453, 'binary_recall': 0.96790755, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9795388}
confusion matrix:
      0     1
0  1501    13
1    50  1508
---- Validation: 
scalar performance:
{'acc': 0.65217394, 'precision': 0.6726081, 'recall': 0.6496533, 'specificity': 0.6496533, 'f1': 0.6392265, 'auroc': 0.7815075, 'binary_precision': 0.72860634, 'binary_recall': 0.46929133, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.5708812}
confusion matrix:
     0    1
0  542  111
1  337  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8217725, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82081294, 'auroc': 0.87203896, 'binary_precision': 0.8053097, 'binary_recall': 0.8465116, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  171   44
1   33  182
new oracle model saved
early stop counter: 3
val acc:0.6521739363670349, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.804651141166687 / 0.8209302425384521
after epoch: 8,now: 2024-07-26 02:38:11.475403,epoch time: 0:01:47.262227,used: 0:14:46.299231,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98320055, 'recall': 0.98321533, 'specificity': 0.98321533, 'f1': 0.9830729, 'auroc': 0.99884903, 'binary_precision': 0.9947334, 'binary_recall': 0.9717042, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9830839}
confusion matrix:
      0     1
0  1509     8
1    44  1511
---- Validation: 
scalar performance:
{'acc': 0.6335404, 'precision': 0.7590134, 'recall': 0.6286069, 'specificity': 0.6286069, 'f1': 0.57834584, 'auroc': 0.85444224, 'binary_precision': 0.93582886, 'binary_recall': 0.27559054, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.42579076}
confusion matrix:
     0    1
0  641   12
1  460  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7209302, 'precision': 0.8073369, 'recall': 0.7209302, 'specificity': 0.7209302, 'f1': 0.69983244, 'auroc': 0.8998593, 'binary_precision': 0.97029704, 'binary_recall': 0.45581394, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.62025315}
confusion matrix:
     0   1
0  212   3
1  117  98
early stop counter: 4
val acc:0.6335403919219971, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.804651141166687 / 0.8209302425384521
after epoch: 9,now: 2024-07-26 02:39:57.619444,epoch time: 0:01:46.144041,used: 0:16:32.443272,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9804463, 'recall': 0.9804927, 'specificity': 0.9804927, 'f1': 0.98046577, 'auroc': 0.9984725, 'binary_precision': 0.9826031, 'binary_recall': 0.978819, 'binary_specificity': 0.98216647, 'binary_f1_score': 0.9807074}
confusion matrix:
      0     1
0  1487    27
1    33  1525
---- Validation: 
scalar performance:
{'acc': 0.7748447, 'precision': 0.7947078, 'recall': 0.7729993, 'specificity': 0.7729993, 'f1': 0.770154, 'auroc': 0.87522876, 'binary_precision': 0.8678038, 'binary_recall': 0.6409449, 'binary_specificity': 0.9050536, 'binary_f1_score': 0.7373189}
confusion matrix:
     0    1
0  591   62
1  228  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.82832515, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.78173196, 'auroc': 0.8967009, 'binary_precision': 0.94285715, 'binary_recall': 0.6139535, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.74366194}
confusion matrix:
     0    1
0  207    8
1   83  132
early stop counter: 5
val acc:0.7748447060585022, best validation acc: 0.7919254899024963, corresponding to test acc:                         0.804651141166687 / 0.8209302425384521
after epoch: 10,now: 2024-07-26 02:41:45.063369,epoch time: 0:01:47.443925,used: 0:18:19.887197,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_23_25_seed_0_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:18:19.887197 at 2024-07-26 02:41:45.063369
persisted model performance metric: 

scalar performance:
{'acc': 0.80465114, 'precision': 0.80680156, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.8043082, 'auroc': 0.8744186, 'binary_precision': 0.8324873, 'binary_recall': 0.7627907, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7961164}
confusion matrix:
     0    1
0  182   33
1   51  164
oracle model performance metric: 

scalar performance:
{'acc': 0.82093024, 'precision': 0.8217725, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82081294, 'auroc': 0.87203896, 'binary_precision': 0.8053097, 'binary_recall': 0.8465116, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  171   44
1   33  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2827 MiB |   9259 MiB |  67516 GiB |  67514 GiB |
|       from large pool |   2737 MiB |   9185 MiB |  66935 GiB |  66932 GiB |
|       from small pool |     89 MiB |    126 MiB |    581 GiB |    581 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2827 MiB |   9259 MiB |  67516 GiB |  67514 GiB |
|       from large pool |   2737 MiB |   9185 MiB |  66935 GiB |  66932 GiB |
|       from small pool |     89 MiB |    126 MiB |    581 GiB |    581 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB |  67463 GiB |  67460 GiB |
|       from large pool |   2723 MiB |   9177 MiB |  66883 GiB |  66880 GiB |
|       from small pool |     89 MiB |    126 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10324 MiB |  10324 MiB |  10324 MiB |      0 B   |
|       from large pool |  10188 MiB |  10188 MiB |  10188 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1114 MiB |   1273 MiB |  43655 GiB |  43654 GiB |
|       from large pool |   1104 MiB |   1259 MiB |  43055 GiB |  43054 GiB |
|       from small pool |     10 MiB |     24 MiB |    599 GiB |    599 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |    9495 K  |    9492 K  |
|       from large pool |     392    |     816    |    4768 K  |    4768 K  |
|       from small pool |    2072    |    2768    |    4726 K  |    4724 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |    9495 K  |    9492 K  |
|       from large pool |     392    |     816    |    4768 K  |    4768 K  |
|       from small pool |    2072    |    2768    |    4726 K  |    4724 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     335    |     335    |     335    |       0    |
|       from large pool |     267    |     267    |     267    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     167    |     340    |    5493 K  |    5493 K  |
|       from large pool |      84    |     257    |    3067 K  |    3067 K  |
|       from small pool |      83    |     239    |    2426 K  |    2426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9259 MiB |  67516 GiB |  67516 GiB |
|       from large pool |  16640 KiB |   9185 MiB |  66935 GiB |  66935 GiB |
|       from small pool |      0 KiB |    126 MiB |    581 GiB |    581 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9259 MiB |  67516 GiB |  67516 GiB |
|       from large pool |  16640 KiB |   9185 MiB |  66935 GiB |  66935 GiB |
|       from small pool |      0 KiB |    126 MiB |    581 GiB |    581 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB |  67463 GiB |  67463 GiB |
|       from large pool |  16640 KiB |   9177 MiB |  66883 GiB |  66883 GiB |
|       from small pool |      0 KiB |    126 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3942 MiB |  10324 MiB |  10324 MiB |   6382 MiB |
|       from large pool |   3842 MiB |  10188 MiB |  10188 MiB |   6346 MiB |
|       from small pool |    100 MiB |    136 MiB |    136 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1273 MiB |  43656 GiB |  43656 GiB |
|       from large pool |  24320 KiB |   1259 MiB |  43056 GiB |  43056 GiB |
|       from small pool |      0 KiB |     50 MiB |    599 GiB |    599 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    9495 K  |    9495 K  |
|       from large pool |       2    |     816    |    4768 K  |    4768 K  |
|       from small pool |       0    |    2768    |    4726 K  |    4726 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    9495 K  |    9495 K  |
|       from large pool |       2    |     816    |    4768 K  |    4768 K  |
|       from small pool |       0    |    2768    |    4726 K  |    4726 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     335    |     335    |     201    |
|       from large pool |      84    |     267    |     267    |     183    |
|       from small pool |      50    |      68    |      68    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |    5494 K  |    5494 K  |
|       from large pool |       3    |     257    |    3067 K  |    3067 K  |
|       from small pool |       0    |     239    |    2426 K  |    2426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9259 MiB |  67516 GiB |  67516 GiB |
|       from large pool |  16640 KiB |   9185 MiB |  66935 GiB |  66935 GiB |
|       from small pool |      0 KiB |    126 MiB |    581 GiB |    581 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9259 MiB |  67516 GiB |  67516 GiB |
|       from large pool |  16640 KiB |   9185 MiB |  66935 GiB |  66935 GiB |
|       from small pool |      0 KiB |    126 MiB |    581 GiB |    581 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB |  67463 GiB |  67463 GiB |
|       from large pool |  16640 KiB |   9177 MiB |  66883 GiB |  66883 GiB |
|       from small pool |      0 KiB |    126 MiB |    580 GiB |    580 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3942 MiB |  10324 MiB |  10324 MiB |   6382 MiB |
|       from large pool |   3842 MiB |  10188 MiB |  10188 MiB |   6346 MiB |
|       from small pool |    100 MiB |    136 MiB |    136 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1273 MiB |  43656 GiB |  43656 GiB |
|       from large pool |  24320 KiB |   1259 MiB |  43056 GiB |  43056 GiB |
|       from small pool |      0 KiB |     50 MiB |    599 GiB |    599 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |    9495 K  |    9495 K  |
|       from large pool |       2    |     816    |    4768 K  |    4768 K  |
|       from small pool |       0    |    2768    |    4726 K  |    4726 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |    9495 K  |    9495 K  |
|       from large pool |       2    |     816    |    4768 K  |    4768 K  |
|       from small pool |       0    |    2768    |    4726 K  |    4726 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     335    |     335    |     201    |
|       from large pool |      84    |     267    |     267    |     183    |
|       from small pool |      50    |      68    |      68    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |    5494 K  |    5494 K  |
|       from large pool |       3    |     257    |    3067 K  |    3067 K  |
|       from small pool |       0    |     239    |    2426 K  |    2426 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734

 Experiment start at: 2024-07-26 02:42:18.791469
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8909505, 'precision': 0.9097035, 'recall': 0.8920747, 'specificity': 0.8920747, 'f1': 0.8898792, 'auroc': 0.9870477, 'binary_precision': 1.0, 'binary_recall': 0.78414947, 'binary_specificity': 1.0, 'binary_f1_score': 0.8790177}
confusion matrix:
      0     1
0  1520     0
1   335  1217
---- Validation: 
scalar performance:
{'acc': 0.5729899, 'precision': 0.7450038, 'recall': 0.56600106, 'specificity': 0.56600106, 'f1': 0.4729929, 'auroc': 0.8645356, 'binary_precision': 0.94623655, 'binary_recall': 0.13968255, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.24343015}
confusion matrix:
     0   1
0  646   5
1  542  88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6288889, 'precision': 0.74530077, 'recall': 0.6288889, 'specificity': 0.6288889, 'f1': 0.57893264, 'auroc': 0.86635065, 'binary_precision': 0.9142857, 'binary_recall': 0.28444445, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.4338983}
confusion matrix:
     0   1
0  219   6
1  161  64
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:44:09.820839,epoch time: 0:01:51.029370,used: 0:01:51.029370,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9580078, 'precision': 0.95985186, 'recall': 0.9584543, 'specificity': 0.9584543, 'f1': 0.9579879, 'auroc': 0.99508625, 'binary_precision': 0.9924086, 'binary_recall': 0.92416453, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9570716}
confusion matrix:
      0     1
0  1505    11
1   118  1438
---- Validation: 
scalar performance:
{'acc': 0.74160814, 'precision': 0.7649605, 'recall': 0.7439836, 'specificity': 0.7439836, 'f1': 0.73697585, 'auroc': 0.8030307, 'binary_precision': 0.682095, 'binary_recall': 0.8888889, 'binary_specificity': 0.59907836, 'binary_f1_score': 0.77188146}
confusion matrix:
     0    1
0  390  261
1   70  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7088889, 'precision': 0.76993567, 'recall': 0.7088889, 'specificity': 0.7088889, 'f1': 0.6914436, 'auroc': 0.84452343, 'binary_precision': 0.6415663, 'binary_recall': 0.94666666, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.76481146}
confusion matrix:
     0    1
0  106  119
1   12  213
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:45:57.871076,epoch time: 0:01:48.050237,used: 0:03:39.079607,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.96212816, 'recall': 0.96012056, 'specificity': 0.96012056, 'f1': 0.9596052, 'auroc': 0.9975163, 'binary_precision': 0.99930215, 'binary_recall': 0.92090034, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9585007}
confusion matrix:
      0     1
0  1516     1
1   123  1432
---- Validation: 
scalar performance:
{'acc': 0.54332554, 'precision': 0.7340028, 'recall': 0.5357911, 'specificity': 0.5357911, 'f1': 0.4149822, 'auroc': 0.8955867, 'binary_precision': 0.9411765, 'binary_recall': 0.07619048, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.14096916}
confusion matrix:
     0   1
0  648   3
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50666666, 'precision': 0.65168536, 'recall': 0.50666666, 'specificity': 0.50666666, 'f1': 0.35171962, 'auroc': 0.8764641, 'binary_precision': 0.8, 'binary_recall': 0.017777778, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.034782607}
confusion matrix:
     0  1
0  224  1
1  221  4
early stop counter: 1
val acc:0.5433255434036255, best validation acc: 0.7416081428527832, corresponding to test acc:                         0.7088888883590698 / 0.7088888883590698
after epoch: 3,now: 2024-07-26 02:47:43.977674,epoch time: 0:01:46.106598,used: 0:05:25.186205,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9580078, 'precision': 0.9606514, 'recall': 0.9584789, 'specificity': 0.9584789, 'f1': 0.9579725, 'auroc': 0.99678504, 'binary_precision': 0.9986004, 'binary_recall': 0.9182754, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9567549}
confusion matrix:
      0     1
0  1516     2
1   127  1427
---- Validation: 
scalar performance:
{'acc': 0.51444185, 'precision': 0.70570415, 'recall': 0.50637484, 'specificity': 0.50637484, 'f1': 0.35225186, 'auroc': 0.8393973, 'binary_precision': 0.9, 'binary_recall': 0.014285714, 'binary_specificity': 0.9984639, 'binary_f1_score': 0.028125}
confusion matrix:
     0  1
0  650  1
1  621  9
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.48666668, 'precision': 0.3465909, 'recall': 0.48666668, 'specificity': 0.48666668, 'f1': 0.3348264, 'auroc': 0.80521476, 'binary_precision': 0.2, 'binary_recall': 0.008888889, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.017021276}
confusion matrix:
     0  1
0  217  8
1  223  2
early stop counter: 2
val acc:0.5144418478012085, best validation acc: 0.7416081428527832, corresponding to test acc:                         0.7088888883590698 / 0.7088888883590698
after epoch: 4,now: 2024-07-26 02:49:30.099142,epoch time: 0:01:46.121468,used: 0:07:11.307673,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9758625, 'recall': 0.97545886, 'specificity': 0.97545886, 'f1': 0.9755736, 'auroc': 0.99853146, 'binary_precision': 0.9671924, 'binary_recall': 0.9852185, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.97612226}
confusion matrix:
      0     1
0  1464    52
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.785324, 'precision': 0.80771035, 'recall': 0.7830773, 'specificity': 0.7830773, 'f1': 0.78039044, 'auroc': 0.8771658, 'binary_precision': 0.8867102, 'binary_recall': 0.64603174, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.74747473}
confusion matrix:
     0    1
0  599   52
1  223  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.85297644, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8284545, 'auroc': 0.9020246, 'binary_precision': 0.9408284, 'binary_recall': 0.70666665, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.80710655}
confusion matrix:
     0    1
0  215   10
1   66  159
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 02:51:18.207489,epoch time: 0:01:48.108347,used: 0:08:59.416020,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.96931183, 'recall': 0.96822846, 'specificity': 0.96822846, 'f1': 0.9677631, 'auroc': 0.9982246, 'binary_precision': 1.0, 'binary_recall': 0.936457, 'binary_specificity': 1.0, 'binary_f1_score': 0.967186}
confusion matrix:
      0     1
0  1514     0
1    99  1459
---- Validation: 
scalar performance:
{'acc': 0.7298985, 'precision': 0.79881185, 'recall': 0.7259089, 'specificity': 0.7259089, 'f1': 0.7110712, 'auroc': 0.90615845, 'binary_precision': 0.9382716, 'binary_recall': 0.48253968, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.6373165}
confusion matrix:
     0    1
0  631   20
1  326  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8188776, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.78380597, 'auroc': 0.8714074, 'binary_precision': 0.9166667, 'binary_recall': 0.63555557, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.7506562}
confusion matrix:
     0    1
0  212   13
1   82  143
early stop counter: 1
val acc:0.7298985123634338, best validation acc: 0.785323977470398, corresponding to test acc:                         0.8311111330986023 / 0.8311111330986023
after epoch: 6,now: 2024-07-26 02:53:04.415860,epoch time: 0:01:46.208371,used: 0:10:45.624391,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.96332514, 'recall': 0.9614396, 'specificity': 0.9614396, 'f1': 0.960911, 'auroc': 0.9983492, 'binary_precision': 1.0, 'binary_recall': 0.92287916, 'binary_specificity': 1.0, 'binary_f1_score': 0.959893}
confusion matrix:
      0     1
0  1516     0
1   120  1436
---- Validation: 
scalar performance:
{'acc': 0.54722875, 'precision': 0.75482726, 'recall': 0.53970814, 'specificity': 0.53970814, 'f1': 0.42052472, 'auroc': 0.8878844, 'binary_precision': 0.9807692, 'binary_recall': 0.08095238, 'binary_specificity': 0.9984639, 'binary_f1_score': 0.14956012}
confusion matrix:
     0   1
0  650   1
1  579  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4977778, 'precision': 0.4161074, 'recall': 0.49777776, 'specificity': 0.49777776, 'f1': 0.33623123, 'auroc': 0.87632596, 'binary_precision': 0.33333334, 'binary_recall': 0.0044444446, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.00877193}
confusion matrix:
     0  1
0  223  2
1  224  1
early stop counter: 2
val acc:0.5472287535667419, best validation acc: 0.785323977470398, corresponding to test acc:                         0.8311111330986023 / 0.8311111330986023
after epoch: 7,now: 2024-07-26 02:54:50.511411,epoch time: 0:01:46.095551,used: 0:12:31.719942,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889285, 'recall': 0.98900306, 'specificity': 0.98900306, 'f1': 0.9889319, 'auroc': 0.9993789, 'binary_precision': 0.9947951, 'binary_recall': 0.98327976, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.98900396}
confusion matrix:
      0     1
0  1509     8
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8259648, 'recall': 0.7856375, 'specificity': 0.7856375, 'f1': 0.7810139, 'auroc': 0.91096973, 'binary_precision': 0.9325301, 'binary_recall': 0.6142857, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.74066985}
confusion matrix:
     0    1
0  623   28
1  243  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.83070815, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7926152, 'auroc': 0.8954469, 'binary_precision': 0.9350649, 'binary_recall': 0.64, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.75989443}
confusion matrix:
     0    1
0  215   10
1   81  144
better model found
persisted
after epoch: 8,now: 2024-07-26 02:56:37.440624,epoch time: 0:01:46.929213,used: 0:14:18.649155,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9775592, 'recall': 0.97667634, 'specificity': 0.97667634, 'f1': 0.9768686, 'auroc': 0.99920213, 'binary_precision': 0.9626168, 'binary_recall': 0.9929306, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.97753876}
confusion matrix:
      0     1
0  1456    60
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.8563622, 'precision': 0.85650706, 'recall': 0.85655403, 'specificity': 0.85655403, 'f1': 0.85636145, 'auroc': 0.90811694, 'binary_precision': 0.8441358, 'binary_recall': 0.86825395, 'binary_specificity': 0.84485406, 'binary_f1_score': 0.8560251}
confusion matrix:
     0    1
0  550  101
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8111664, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8111027, 'auroc': 0.8873482, 'binary_precision': 0.80701756, 'binary_recall': 0.81777775, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.812362}
confusion matrix:
     0    1
0  181   44
1   41  184
better model found
persisted
after epoch: 9,now: 2024-07-26 02:58:24.402492,epoch time: 0:01:46.961868,used: 0:16:05.611023,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895686, 'recall': 0.9895985, 'specificity': 0.9895985, 'f1': 0.9895819, 'auroc': 0.99955094, 'binary_precision': 0.9909794, 'binary_recall': 0.9884319, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.989704}
confusion matrix:
      0     1
0  1502    14
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.82184505, 'recall': 0.79636455, 'specificity': 0.79636455, 'f1': 0.7940155, 'auroc': 0.90220845, 'binary_precision': 0.90434784, 'binary_recall': 0.6603175, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.7633028}
confusion matrix:
     0    1
0  607   44
1  214  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8257923, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.8115314, 'auroc': 0.8973037, 'binary_precision': 0.88950276, 'binary_recall': 0.71555555, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.7931034}
confusion matrix:
     0    1
0  205   20
1   64  161
early stop counter: 1
val acc:0.7985948324203491, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8111110925674438 / 0.8311111330986023
after epoch: 10,now: 2024-07-26 03:00:10.792877,epoch time: 0:01:46.390385,used: 0:17:52.001408,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98858726, 'recall': 0.98864126, 'specificity': 0.98864126, 'f1': 0.98860574, 'auroc': 0.99914324, 'binary_precision': 0.9915912, 'binary_recall': 0.98585206, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9887133}
confusion matrix:
      0     1
0  1504    13
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.7470726, 'precision': 0.79035586, 'recall': 0.7438556, 'specificity': 0.7438556, 'f1': 0.73558545, 'auroc': 0.8824385, 'binary_precision': 0.8984375, 'binary_recall': 0.54761904, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.6804733}
confusion matrix:
     0    1
0  612   39
1  285  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8423997, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8118682, 'auroc': 0.90892345, 'binary_precision': 0.9382716, 'binary_recall': 0.6755555, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.78552973}
confusion matrix:
     0    1
0  215   10
1   73  152
early stop counter: 2
val acc:0.7470725774765015, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8111110925674438 / 0.8311111330986023
after epoch: 11,now: 2024-07-26 03:01:56.833250,epoch time: 0:01:46.040373,used: 0:19:38.041781,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915458, 'recall': 0.9916283, 'specificity': 0.9916283, 'f1': 0.9915361, 'auroc': 0.99970454, 'binary_precision': 0.9986962, 'binary_recall': 0.9845758, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9915857}
confusion matrix:
      0     1
0  1514     2
1    24  1532
---- Validation: 
scalar performance:
{'acc': 0.83918816, 'precision': 0.8559345, 'recall': 0.837404, 'specificity': 0.837404, 'f1': 0.8367357, 'auroc': 0.9277235, 'binary_precision': 0.9291498, 'binary_recall': 0.7285714, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.81672597}
confusion matrix:
     0    1
0  616   35
1  171  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8607571, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8401693, 'auroc': 0.92266667, 'binary_precision': 0.9425287, 'binary_recall': 0.72888887, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.82205516}
confusion matrix:
     0    1
0  215   10
1   61  164
new oracle model saved
early stop counter: 3
val acc:0.8391881585121155, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8111110925674438 / 0.8422222137451172
after epoch: 12,now: 2024-07-26 03:03:43.786834,epoch time: 0:01:46.953584,used: 0:21:24.995365,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98162436, 'recall': 0.981616, 'specificity': 0.981616, 'f1': 0.9814453, 'auroc': 0.99854434, 'binary_precision': 0.99471945, 'binary_recall': 0.968509, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9814393}
confusion matrix:
      0     1
0  1508     8
1    49  1507
---- Validation: 
scalar performance:
{'acc': 0.6455894, 'precision': 0.74994785, 'recall': 0.6401946, 'specificity': 0.6401946, 'f1': 0.5993941, 'auroc': 0.88440496, 'binary_precision': 0.9074074, 'binary_recall': 0.31111112, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.46335697}
confusion matrix:
     0    1
0  631   20
1  434  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.74010324, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.47536057, 'auroc': 0.9183012, 'binary_precision': 0.94285715, 'binary_recall': 0.14666666, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.25384614}
confusion matrix:
     0   1
0  223   2
1  192  33
early stop counter: 4
val acc:0.6455894112586975, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8111110925674438 / 0.8422222137451172
after epoch: 13,now: 2024-07-26 03:05:30.085386,epoch time: 0:01:46.298552,used: 0:23:11.293917,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.98257595, 'recall': 0.98233867, 'specificity': 0.98233867, 'f1': 0.9824157, 'auroc': 0.9985511, 'binary_precision': 0.97650796, 'binary_recall': 0.9890675, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9827476}
confusion matrix:
      0     1
0  1480    37
1    17  1538
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.8147619, 'recall': 0.77547365, 'specificity': 0.77547365, 'f1': 0.7704405, 'auroc': 0.9040231, 'binary_precision': 0.9178744, 'binary_recall': 0.6031746, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.72796935}
confusion matrix:
     0    1
0  617   34
1  250  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8316395, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8158536, 'auroc': 0.89355063, 'binary_precision': 0.89944136, 'binary_recall': 0.71555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.79702973}
confusion matrix:
     0    1
0  207   18
1   64  161
early stop counter: 5
val acc:0.7782981991767883, best validation acc: 0.8563622236251831, corresponding to test acc:                         0.8111110925674438 / 0.8422222137451172
after epoch: 14,now: 2024-07-26 03:07:17.425071,epoch time: 0:01:47.339685,used: 0:24:58.633602,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_42_18_seed_1_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:24:58.633602 at 2024-07-26 03:07:17.425071
persisted model performance metric: 

scalar performance:
{'acc': 0.8111111, 'precision': 0.8111664, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8111027, 'auroc': 0.8873482, 'binary_precision': 0.80701756, 'binary_recall': 0.81777775, 'binary_specificity': 0.80444443, 'binary_f1_score': 0.812362}
confusion matrix:
     0    1
0  181   44
1   41  184
oracle model performance metric: 

scalar performance:
{'acc': 0.8422222, 'precision': 0.8607571, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8401693, 'auroc': 0.92266667, 'binary_precision': 0.9425287, 'binary_recall': 0.72888887, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.82205516}
confusion matrix:
     0    1
0  215   10
1   61  164
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2825 MiB |   9259 MiB | 162155 GiB | 162153 GiB |
|       from large pool |   2735 MiB |   9185 MiB | 160757 GiB | 160754 GiB |
|       from small pool |     89 MiB |    130 MiB |   1398 GiB |   1398 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2825 MiB |   9259 MiB | 162155 GiB | 162153 GiB |
|       from large pool |   2735 MiB |   9185 MiB | 160757 GiB | 160754 GiB |
|       from small pool |     89 MiB |    130 MiB |   1398 GiB |   1398 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 161891 GiB | 161889 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 160495 GiB | 160492 GiB |
|       from small pool |     89 MiB |    130 MiB |   1396 GiB |   1396 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10102 MiB |  10324 MiB |  16484 MiB |   6382 MiB |
|       from large pool |   9962 MiB |  10188 MiB |  16308 MiB |   6346 MiB |
|       from small pool |    140 MiB |    140 MiB |    176 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1248 MiB |   1708 MiB | 120903 GiB | 120902 GiB |
|       from large pool |   1240 MiB |   1702 MiB | 119465 GiB | 119464 GiB |
|       from small pool |      8 MiB |     50 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   22790 K  |   22788 K  |
|       from large pool |     392    |     816    |   11441 K  |   11440 K  |
|       from small pool |    2084    |    2780    |   11349 K  |   11347 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   22790 K  |   22788 K  |
|       from large pool |     392    |     816    |   11441 K  |   11440 K  |
|       from small pool |    2084    |    2780    |   11349 K  |   11347 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     277    |     335    |     478    |     201    |
|       from large pool |     207    |     267    |     390    |     183    |
|       from small pool |      70    |      70    |      88    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     165    |     340    |   12650 K  |   12650 K  |
|       from large pool |      87    |     257    |    6979 K  |    6979 K  |
|       from small pool |      78    |     239    |    5670 K  |    5670 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9259 MiB | 162155 GiB | 162155 GiB |
|       from large pool |  16640 KiB |   9185 MiB | 160757 GiB | 160757 GiB |
|       from small pool |      0 KiB |    130 MiB |   1398 GiB |   1398 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9259 MiB | 162155 GiB | 162155 GiB |
|       from large pool |  16640 KiB |   9185 MiB | 160757 GiB | 160757 GiB |
|       from small pool |      0 KiB |    130 MiB |   1398 GiB |   1398 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 161891 GiB | 161891 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 160495 GiB | 160495 GiB |
|       from small pool |      0 KiB |    130 MiB |   1396 GiB |   1396 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4074 MiB |  10324 MiB |  16484 MiB |  12410 MiB |
|       from large pool |   3976 MiB |  10188 MiB |  16308 MiB |  12332 MiB |
|       from small pool |     98 MiB |    140 MiB |    176 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1708 MiB | 120904 GiB | 120904 GiB |
|       from large pool |  24320 KiB |   1702 MiB | 119466 GiB | 119466 GiB |
|       from small pool |      0 KiB |     50 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   22790 K  |   22790 K  |
|       from large pool |       2    |     816    |   11441 K  |   11441 K  |
|       from small pool |       0    |    2780    |   11349 K  |   11349 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   22790 K  |   22790 K  |
|       from large pool |       2    |     816    |   11441 K  |   11441 K  |
|       from small pool |       0    |    2780    |   11349 K  |   11349 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     335    |     478    |     348    |
|       from large pool |      81    |     267    |     390    |     309    |
|       from small pool |      49    |      70    |      88    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   12650 K  |   12650 K  |
|       from large pool |       3    |     257    |    6979 K  |    6979 K  |
|       from small pool |       0    |     239    |    5671 K  |    5671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9259 MiB | 162155 GiB | 162155 GiB |
|       from large pool |  16640 KiB |   9185 MiB | 160757 GiB | 160757 GiB |
|       from small pool |      0 KiB |    130 MiB |   1398 GiB |   1398 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9259 MiB | 162155 GiB | 162155 GiB |
|       from large pool |  16640 KiB |   9185 MiB | 160757 GiB | 160757 GiB |
|       from small pool |      0 KiB |    130 MiB |   1398 GiB |   1398 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 161891 GiB | 161891 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 160495 GiB | 160495 GiB |
|       from small pool |      0 KiB |    130 MiB |   1396 GiB |   1396 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4074 MiB |  10324 MiB |  16484 MiB |  12410 MiB |
|       from large pool |   3976 MiB |  10188 MiB |  16308 MiB |  12332 MiB |
|       from small pool |     98 MiB |    140 MiB |    176 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1708 MiB | 120904 GiB | 120904 GiB |
|       from large pool |  24320 KiB |   1702 MiB | 119466 GiB | 119466 GiB |
|       from small pool |      0 KiB |     50 MiB |   1438 GiB |   1438 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   22790 K  |   22790 K  |
|       from large pool |       2    |     816    |   11441 K  |   11441 K  |
|       from small pool |       0    |    2780    |   11349 K  |   11349 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   22790 K  |   22790 K  |
|       from large pool |       2    |     816    |   11441 K  |   11441 K  |
|       from small pool |       0    |    2780    |   11349 K  |   11349 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     335    |     478    |     348    |
|       from large pool |      81    |     267    |     390    |     309    |
|       from small pool |      49    |      70    |      88    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   12650 K  |   12650 K  |
|       from large pool |       3    |     257    |    6979 K  |    6979 K  |
|       from small pool |       0    |     239    |    5671 K  |    5671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734

 Experiment start at: 2024-07-26 03:07:48.296894
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94731677, 'precision': 0.9506891, 'recall': 0.94698715, 'specificity': 0.94698715, 'f1': 0.9471878, 'auroc': 0.99624693, 'binary_precision': 0.91361725, 'binary_recall': 0.98896104, 'binary_specificity': 0.9050132, 'binary_f1_score': 0.9497973}
confusion matrix:
      0     1
0  1372   144
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.62441313, 'precision': 0.7284355, 'recall': 0.6331048, 'specificity': 0.6331048, 'f1': 0.584522, 'auroc': 0.822036, 'binary_precision': 0.5674905, 'binary_recall': 0.9598071, 'binary_specificity': 0.30640244, 'binary_f1_score': 0.71326166}
confusion matrix:
     0    1
0  201  455
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5763889, 'precision': 0.74385905, 'recall': 0.5763889, 'specificity': 0.5763889, 'f1': 0.48858535, 'auroc': 0.9252615, 'binary_precision': 0.5417721, 'binary_recall': 0.9907407, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.7004909}
confusion matrix:
    0    1
0  35  181
1   2  214
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:09:37.507522,epoch time: 0:01:49.210628,used: 0:01:49.210628,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.9726569, 'recall': 0.9720737, 'specificity': 0.9720737, 'f1': 0.9721725, 'auroc': 0.9975362, 'binary_precision': 0.9595704, 'binary_recall': 0.98636365, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.97278255}
confusion matrix:
      0     1
0  1452    64
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.7636933, 'precision': 0.773933, 'recall': 0.7661507, 'specificity': 0.7661507, 'f1': 0.76246226, 'auroc': 0.8575529, 'binary_precision': 0.7139037, 'binary_recall': 0.8585209, 'binary_specificity': 0.6737805, 'binary_f1_score': 0.779562}
confusion matrix:
     0    1
0  442  214
1   88  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.8019481, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.78437495, 'auroc': 0.9027992, 'binary_precision': 0.7348485, 'binary_recall': 0.8981481, 'binary_specificity': 0.6759259, 'binary_f1_score': 0.80833334}
confusion matrix:
     0    1
0  146   70
1   22  194
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:11:24.565560,epoch time: 0:01:47.058038,used: 0:03:36.268666,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96007854, 'precision': 0.9620296, 'recall': 0.95983446, 'specificity': 0.95983446, 'f1': 0.9600189, 'auroc': 0.99748397, 'binary_precision': 0.9339045, 'binary_recall': 0.9909091, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.9615627}
confusion matrix:
      0     1
0  1408   108
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.7769953, 'precision': 0.8049391, 'recall': 0.7809412, 'specificity': 0.7809412, 'f1': 0.7733077, 'auroc': 0.9040419, 'binary_precision': 0.7057387, 'binary_recall': 0.92926043, 'binary_specificity': 0.63262194, 'binary_f1_score': 0.8022207}
confusion matrix:
     0    1
0  415  241
1   44  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.79978156, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.7792084, 'auroc': 0.91109395, 'binary_precision': 0.72761196, 'binary_recall': 0.9027778, 'binary_specificity': 0.662037, 'binary_f1_score': 0.8057852}
confusion matrix:
     0    1
0  143   73
1   21  195
better model found
persisted
after epoch: 3,now: 2024-07-26 03:13:11.126167,epoch time: 0:01:46.560607,used: 0:05:22.829273,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9768584, 'recall': 0.9763355, 'specificity': 0.9763355, 'f1': 0.97642946, 'auroc': 0.9982228, 'binary_precision': 0.96455693, 'binary_recall': 0.9896104, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.97692305}
confusion matrix:
      0     1
0  1460    56
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.81611896, 'precision': 0.8160652, 'recall': 0.81584287, 'specificity': 0.81584287, 'f1': 0.8159295, 'auroc': 0.8873397, 'binary_precision': 0.81463414, 'binary_recall': 0.80546623, 'binary_specificity': 0.8262195, 'binary_f1_score': 0.81002426}
confusion matrix:
     0    1
0  542  114
1  121  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8726852, 'precision': 0.87307703, 'recall': 0.8726852, 'specificity': 0.8726852, 'f1': 0.87265176, 'auroc': 0.92858374, 'binary_precision': 0.8851675, 'binary_recall': 0.8564815, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.87058824}
confusion matrix:
     0    1
0  192   24
1   31  185
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 03:14:58.594369,epoch time: 0:01:47.468202,used: 0:07:10.297475,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98534054, 'recall': 0.9852406, 'specificity': 0.9852406, 'f1': 0.9852727, 'auroc': 0.9992384, 'binary_precision': 0.98132646, 'binary_recall': 0.9896104, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.98545104}
confusion matrix:
      0     1
0  1487    29
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.82571334, 'recall': 0.807743, 'specificity': 0.807743, 'f1': 0.80220735, 'auroc': 0.91437197, 'binary_precision': 0.73544306, 'binary_recall': 0.9340836, 'binary_specificity': 0.68140244, 'binary_f1_score': 0.8229462}
confusion matrix:
     0    1
0  447  209
1   41  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402778, 'precision': 0.84567904, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.8396514, 'auroc': 0.9124657, 'binary_precision': 0.80246913, 'binary_recall': 0.9027778, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8496732}
confusion matrix:
     0    1
0  168   48
1   21  195
early stop counter: 1
val acc:0.8043818473815918, best validation acc: 0.8161189556121826, corresponding to test acc:                         0.8726851940155029 / 0.8726851940155029
after epoch: 5,now: 2024-07-26 03:16:44.181464,epoch time: 0:01:45.587095,used: 0:08:55.884570,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.974262, 'recall': 0.9729911, 'specificity': 0.9729911, 'f1': 0.9731432, 'auroc': 0.9986876, 'binary_precision': 0.95335823, 'binary_recall': 0.99545455, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.97395176}
confusion matrix:
      0     1
0  1441    75
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.8380282, 'precision': 0.8379216, 'recall': 0.8378926, 'specificity': 0.8378926, 'f1': 0.8379066, 'auroc': 0.905478, 'binary_precision': 0.8341385, 'binary_recall': 0.8327974, 'binary_specificity': 0.8429878, 'binary_f1_score': 0.8334674}
confusion matrix:
     0    1
0  553  103
1  104  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657407, 'precision': 0.8672837, 'recall': 0.8657407, 'specificity': 0.8657407, 'f1': 0.8655995, 'auroc': 0.91752404, 'binary_precision': 0.8910891, 'binary_recall': 0.8333333, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.86124396}
confusion matrix:
     0    1
0  194   22
1   36  180
better model found
persisted
after epoch: 6,now: 2024-07-26 03:18:30.834344,epoch time: 0:01:46.652880,used: 0:10:42.537450,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.977563, 'recall': 0.9772316, 'specificity': 0.9772316, 'f1': 0.977092, 'auroc': 0.9983826, 'binary_precision': 0.99461645, 'binary_recall': 0.9597403, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9768672}
confusion matrix:
      0     1
0  1508     8
1    62  1478
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.7904508, 'recall': 0.7774905, 'specificity': 0.7774905, 'f1': 0.776928, 'auroc': 0.86344206, 'binary_precision': 0.8389662, 'binary_recall': 0.6784566, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.7502222}
confusion matrix:
     0    1
0  575   81
1  200  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.837963, 'precision': 0.84150565, 'recall': 0.837963, 'specificity': 0.837963, 'f1': 0.8375416, 'auroc': 0.9114584, 'binary_precision': 0.87628865, 'binary_recall': 0.787037, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.8292682}
confusion matrix:
     0    1
0  192   24
1   46  170
early stop counter: 1
val acc:0.7801252007484436, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8657407164573669 / 0.8726851940155029
after epoch: 7,now: 2024-07-26 03:20:16.573996,epoch time: 0:01:45.739652,used: 0:12:28.277102,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98580956, 'recall': 0.9856989, 'specificity': 0.9856989, 'f1': 0.9856018, 'auroc': 0.99925166, 'binary_precision': 0.99800265, 'binary_recall': 0.97337663, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9855358}
confusion matrix:
      0     1
0  1513     3
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.7880194, 'recall': 0.6724424, 'specificity': 0.6724424, 'f1': 0.64168227, 'auroc': 0.89259666, 'binary_precision': 0.95726496, 'binary_recall': 0.3601286, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.5233645}
confusion matrix:
     0    1
0  646   10
1  398  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.712963, 'precision': 0.81272817, 'recall': 0.712963, 'specificity': 0.712963, 'f1': 0.6880866, 'auroc': 0.90620714, 'binary_precision': 0.9893617, 'binary_recall': 0.43055555, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6}
confusion matrix:
     0   1
0  215   1
1  123  93
early stop counter: 2
val acc:0.6807511448860168, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8657407164573669 / 0.8726851940155029
after epoch: 8,now: 2024-07-26 03:22:02.920421,epoch time: 0:01:46.346425,used: 0:14:14.623527,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9854691, 'recall': 0.9853691, 'specificity': 0.9853691, 'f1': 0.9852746, 'auroc': 0.99851084, 'binary_precision': 0.99733865, 'binary_recall': 0.97337663, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.98521197}
confusion matrix:
      0     1
0  1512     4
1    41  1499
---- Validation: 
scalar performance:
{'acc': 0.7754304, 'precision': 0.8226591, 'recall': 0.77025086, 'specificity': 0.77025086, 'f1': 0.7645274, 'auroc': 0.9097228, 'binary_precision': 0.93963253, 'binary_recall': 0.5755627, 'binary_specificity': 0.964939, 'binary_f1_score': 0.7138584}
confusion matrix:
     0    1
0  633   23
1  264  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.84618855, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7886826, 'auroc': 0.93167007, 'binary_precision': 0.97761196, 'binary_recall': 0.6064815, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.74857146}
confusion matrix:
     0    1
0  213    3
1   85  131
early stop counter: 3
val acc:0.7754303812980652, best validation acc: 0.8380281925201416, corresponding to test acc:                         0.8657407164573669 / 0.8726851940155029
after epoch: 9,now: 2024-07-26 03:23:48.647578,epoch time: 0:01:45.727157,used: 0:16:00.350684,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98726475, 'recall': 0.98721945, 'specificity': 0.98721945, 'f1': 0.98723686, 'auroc': 0.9993733, 'binary_precision': 0.9851325, 'binary_recall': 0.9896104, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9873664}
confusion matrix:
      0     1
0  1493    23
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.85758996, 'precision': 0.8581121, 'recall': 0.8570308, 'specificity': 0.8570308, 'f1': 0.857316, 'auroc': 0.92118025, 'binary_precision': 0.8666667, 'binary_recall': 0.83601284, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.85106385}
confusion matrix:
     0    1
0  576   80
1  102  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8541667, 'precision': 0.8547826, 'recall': 0.8541666, 'specificity': 0.8541666, 'f1': 0.8541033, 'auroc': 0.9232253, 'binary_precision': 0.8695652, 'binary_recall': 0.8333333, 'binary_specificity': 0.875, 'binary_f1_score': 0.8510638}
confusion matrix:
     0    1
0  189   27
1   36  180
better model found
persisted
after epoch: 10,now: 2024-07-26 03:25:36.110699,epoch time: 0:01:47.463121,used: 0:17:47.813805,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9754185, 'recall': 0.97466505, 'specificity': 0.97466505, 'f1': 0.97446966, 'auroc': 0.9984901, 'binary_precision': 0.99863577, 'binary_recall': 0.9506493, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.97405195}
confusion matrix:
      0     1
0  1514     2
1    76  1464
---- Validation: 
scalar performance:
{'acc': 0.5938967, 'precision': 0.74958587, 'recall': 0.58308905, 'specificity': 0.58308905, 'f1': 0.506032, 'auroc': 0.8599669, 'binary_precision': 0.94017094, 'binary_recall': 0.17684887, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.2976996}
confusion matrix:
     0    1
0  649    7
1  512  110
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.73774767, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.42729092, 'auroc': 0.90558565, 'binary_precision': 0.95238096, 'binary_recall': 0.09259259, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.16877638}
confusion matrix:
     0   1
0  215   1
1  196  20
early stop counter: 1
val acc:0.5938966870307922, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 11,now: 2024-07-26 03:27:21.642612,epoch time: 0:01:45.531913,used: 0:19:33.345718,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99247146, 'recall': 0.9925016, 'specificity': 0.9925016, 'f1': 0.99247366, 'auroc': 0.99941146, 'binary_precision': 0.99607587, 'binary_recall': 0.98896104, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9925057}
confusion matrix:
      0     1
0  1510     6
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.831955, 'recall': 0.79964805, 'specificity': 0.79964805, 'f1': 0.79776895, 'auroc': 0.9076513, 'binary_precision': 0.9225513, 'binary_recall': 0.65112543, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7634308}
confusion matrix:
     0    1
0  622   34
1  217  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.8140214, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77398765, 'auroc': 0.89681923, 'binary_precision': 0.9172414, 'binary_recall': 0.6157407, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7368421}
confusion matrix:
     0    1
0  204   12
1   83  133
early stop counter: 2
val acc:0.8035993576049805, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 12,now: 2024-07-26 03:29:07.586642,epoch time: 0:01:45.944030,used: 0:21:19.289748,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9856629, 'recall': 0.9856629, 'specificity': 0.9856629, 'f1': 0.9856021, 'auroc': 0.998724, 'binary_precision': 0.9934037, 'binary_recall': 0.9779221, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9856021}
confusion matrix:
      0     1
0  1506    10
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.7785602, 'precision': 0.8193217, 'recall': 0.7737163, 'specificity': 0.7737163, 'f1': 0.76907593, 'auroc': 0.89121866, 'binary_precision': 0.9269521, 'binary_recall': 0.5916399, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.72227675}
confusion matrix:
     0    1
0  627   29
1  254  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.82901955, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78280544, 'auroc': 0.89891976, 'binary_precision': 0.9432624, 'binary_recall': 0.6157407, 'binary_specificity': 0.962963, 'binary_f1_score': 0.745098}
confusion matrix:
     0    1
0  208    8
1   83  133
early stop counter: 3
val acc:0.778560221195221, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 13,now: 2024-07-26 03:30:54.704075,epoch time: 0:01:47.117433,used: 0:23:06.407181,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96924084, 'precision': 0.9703245, 'recall': 0.9690642, 'specificity': 0.9690642, 'f1': 0.96921295, 'auroc': 0.99845755, 'binary_precision': 0.94962686, 'binary_recall': 0.99155843, 'binary_specificity': 0.9465699, 'binary_f1_score': 0.9701398}
confusion matrix:
      0     1
0  1435    81
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7699531, 'precision': 0.7705237, 'recall': 0.7691235, 'specificity': 0.7691235, 'f1': 0.7693379, 'auroc': 0.84850204, 'binary_precision': 0.7779661, 'binary_recall': 0.7379421, 'binary_specificity': 0.8003049, 'binary_f1_score': 0.7574257}
confusion matrix:
     0    1
0  525  131
1  163  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.80376816, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.80315524, 'auroc': 0.8473079, 'binary_precision': 0.7911111, 'binary_recall': 0.8240741, 'binary_specificity': 0.7824074, 'binary_f1_score': 0.80725616}
confusion matrix:
     0    1
0  169   47
1   38  178
early stop counter: 4
val acc:0.7699530720710754, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 14,now: 2024-07-26 03:32:40.323686,epoch time: 0:01:45.619611,used: 0:24:52.026792,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921423, 'recall': 0.9921718, 'specificity': 0.9921718, 'f1': 0.9921464, 'auroc': 0.9996693, 'binary_precision': 0.9954248, 'binary_recall': 0.98896104, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9921824}
confusion matrix:
      0     1
0  1509     7
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.713615, 'precision': 0.7567538, 'recall': 0.7079543, 'specificity': 0.7079543, 'f1': 0.6973813, 'auroc': 0.86296904, 'binary_precision': 0.85555553, 'binary_recall': 0.49517685, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.62729126}
confusion matrix:
     0    1
0  604   52
1  314  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921296, 'precision': 0.7335896, 'recall': 0.6921296, 'specificity': 0.6921296, 'f1': 0.6778343, 'auroc': 0.82323813, 'binary_precision': 0.832, 'binary_recall': 0.4814815, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.6099706}
confusion matrix:
     0    1
0  195   21
1  112  104
early stop counter: 5
val acc:0.7136150002479553, best validation acc: 0.8575899600982666, corresponding to test acc:                         0.8541666865348816 / 0.8726851940155029
after epoch: 15,now: 2024-07-26 03:34:26.095634,epoch time: 0:01:45.771948,used: 0:26:37.798740,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_48_seed_2_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:26:37.798740 at 2024-07-26 03:34:26.095634
persisted model performance metric: 

scalar performance:
{'acc': 0.8541667, 'precision': 0.8547826, 'recall': 0.8541666, 'specificity': 0.8541666, 'f1': 0.8541033, 'auroc': 0.9232253, 'binary_precision': 0.8695652, 'binary_recall': 0.8333333, 'binary_specificity': 0.875, 'binary_f1_score': 0.8510638}
confusion matrix:
     0    1
0  189   27
1   36  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8726852, 'precision': 0.87307703, 'recall': 0.8726852, 'specificity': 0.8726852, 'f1': 0.87265176, 'auroc': 0.92858374, 'binary_precision': 0.8851675, 'binary_recall': 0.8564815, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.87058824}
confusion matrix:
     0    1
0  192   24
1   31  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2830 MiB |   9264 MiB | 262901 GiB | 262898 GiB |
|       from large pool |   2740 MiB |   9189 MiB | 260636 GiB | 260634 GiB |
|       from small pool |     89 MiB |    130 MiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2830 MiB |   9264 MiB | 262901 GiB | 262898 GiB |
|       from large pool |   2740 MiB |   9189 MiB | 260636 GiB | 260634 GiB |
|       from small pool |     89 MiB |    130 MiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 262494 GiB | 262491 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 260233 GiB | 260230 GiB |
|       from small pool |     89 MiB |    130 MiB |   2260 GiB |   2260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10080 MiB |  10324 MiB |  22490 MiB |  12410 MiB |
|       from large pool |   9946 MiB |  10188 MiB |  22278 MiB |  12332 MiB |
|       from small pool |    134 MiB |    140 MiB |    212 MiB |     78 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1419 MiB |   2024 MiB | 200650 GiB | 200649 GiB |
|       from large pool |   1409 MiB |   2018 MiB | 198324 GiB | 198323 GiB |
|       from small pool |     10 MiB |     50 MiB |   2325 GiB |   2325 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   36932 K  |   36930 K  |
|       from large pool |     392    |     816    |   18548 K  |   18548 K  |
|       from small pool |    2072    |    2780    |   18384 K  |   18382 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   36932 K  |   36930 K  |
|       from large pool |     392    |     816    |   18548 K  |   18548 K  |
|       from small pool |    2072    |    2780    |   18384 K  |   18382 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     335    |     613    |     348    |
|       from large pool |     198    |     267    |     507    |     309    |
|       from small pool |      67    |      70    |     106    |      39    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     159    |     340    |   20319 K  |   20319 K  |
|       from large pool |      84    |     257    |   11220 K  |   11220 K  |
|       from small pool |      75    |     239    |    9099 K  |    9099 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 262901 GiB | 262901 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 260636 GiB | 260636 GiB |
|       from small pool |      0 KiB |    130 MiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 262901 GiB | 262901 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 260636 GiB | 260636 GiB |
|       from small pool |      0 KiB |    130 MiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 262494 GiB | 262494 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 260233 GiB | 260233 GiB |
|       from small pool |      0 KiB |    130 MiB |   2260 GiB |   2260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4250 MiB |  10324 MiB |  22490 MiB |  18240 MiB |
|       from large pool |   4150 MiB |  10188 MiB |  22278 MiB |  18128 MiB |
|       from small pool |    100 MiB |    140 MiB |    212 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2024 MiB | 200651 GiB | 200651 GiB |
|       from large pool |  24320 KiB |   2018 MiB | 198325 GiB | 198325 GiB |
|       from small pool |      0 KiB |     50 MiB |   2325 GiB |   2325 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   36932 K  |   36932 K  |
|       from large pool |       2    |     816    |   18548 K  |   18548 K  |
|       from small pool |       0    |    2780    |   18384 K  |   18384 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   36932 K  |   36932 K  |
|       from large pool |       2    |     816    |   18548 K  |   18548 K  |
|       from small pool |       0    |    2780    |   18384 K  |   18384 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     335    |     613    |     483    |
|       from large pool |      80    |     267    |     507    |     427    |
|       from small pool |      50    |      70    |     106    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   20320 K  |   20320 K  |
|       from large pool |       3    |     257    |   11220 K  |   11220 K  |
|       from small pool |       0    |     239    |    9099 K  |    9099 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 262901 GiB | 262901 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 260636 GiB | 260636 GiB |
|       from small pool |      0 KiB |    130 MiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 262901 GiB | 262901 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 260636 GiB | 260636 GiB |
|       from small pool |      0 KiB |    130 MiB |   2264 GiB |   2264 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 262494 GiB | 262494 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 260233 GiB | 260233 GiB |
|       from small pool |      0 KiB |    130 MiB |   2260 GiB |   2260 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4250 MiB |  10324 MiB |  22490 MiB |  18240 MiB |
|       from large pool |   4150 MiB |  10188 MiB |  22278 MiB |  18128 MiB |
|       from small pool |    100 MiB |    140 MiB |    212 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2024 MiB | 200651 GiB | 200651 GiB |
|       from large pool |  24320 KiB |   2018 MiB | 198325 GiB | 198325 GiB |
|       from small pool |      0 KiB |     50 MiB |   2325 GiB |   2325 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   36932 K  |   36932 K  |
|       from large pool |       2    |     816    |   18548 K  |   18548 K  |
|       from small pool |       0    |    2780    |   18384 K  |   18384 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   36932 K  |   36932 K  |
|       from large pool |       2    |     816    |   18548 K  |   18548 K  |
|       from small pool |       0    |    2780    |   18384 K  |   18384 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     335    |     613    |     483    |
|       from large pool |      80    |     267    |     507    |     427    |
|       from small pool |      50    |      70    |     106    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   20320 K  |   20320 K  |
|       from large pool |       3    |     257    |   11220 K  |   11220 K  |
|       from small pool |       0    |     239    |    9099 K  |    9099 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734

 Experiment start at: 2024-07-26 03:34:59.255498
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92122394, 'precision': 0.92995393, 'recall': 0.92222416, 'specificity': 0.92222416, 'f1': 0.9209341, 'auroc': 0.9846536, 'binary_precision': 0.99473286, 'binary_recall': 0.8490687, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9161469}
confusion matrix:
      0     1
0  1508     7
1   235  1322
---- Validation: 
scalar performance:
{'acc': 0.766173, 'precision': 0.7661134, 'recall': 0.76599306, 'specificity': 0.76599306, 'f1': 0.7660364, 'auroc': 0.8222459, 'binary_precision': 0.76404494, 'binary_recall': 0.7567568, 'binary_specificity': 0.77522933, 'binary_f1_score': 0.76038337}
confusion matrix:
     0    1
0  507  147
1  153  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.792789, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.76950425, 'auroc': 0.8981136, 'binary_precision': 0.7173145, 'binary_recall': 0.9022222, 'binary_specificity': 0.64444447, 'binary_f1_score': 0.7992126}
confusion matrix:
     0    1
0  145   80
1   22  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:36:51.092114,epoch time: 0:01:51.836616,used: 0:01:51.836616,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.9683224, 'recall': 0.967749, 'specificity': 0.967749, 'f1': 0.96744287, 'auroc': 0.9957591, 'binary_precision': 0.99188644, 'binary_recall': 0.94340837, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9670402}
confusion matrix:
      0     1
0  1505    12
1    88  1467
---- Validation: 
scalar performance:
{'acc': 0.83008575, 'precision': 0.844018, 'recall': 0.8281069, 'specificity': 0.8281069, 'f1': 0.8276991, 'auroc': 0.8884959, 'binary_precision': 0.9085487, 'binary_recall': 0.7265501, 'binary_specificity': 0.9296636, 'binary_f1_score': 0.80742055}
confusion matrix:
     0    1
0  608   46
1  172  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8622222, 'precision': 0.86455536, 'recall': 0.8622222, 'specificity': 0.8622222, 'f1': 0.8620014, 'auroc': 0.9151802, 'binary_precision': 0.8937198, 'binary_recall': 0.82222223, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8564815}
confusion matrix:
     0    1
0  203   22
1   40  185
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:38:39.961767,epoch time: 0:01:48.869653,used: 0:03:40.706269,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98345053, 'recall': 0.9835459, 'specificity': 0.9835459, 'f1': 0.9833981, 'auroc': 0.99860644, 'binary_precision': 0.99345547, 'binary_recall': 0.9737011, 'binary_specificity': 0.9933906, 'binary_f1_score': 0.9834791}
confusion matrix:
      0     1
0  1503    10
1    41  1518
---- Validation: 
scalar performance:
{'acc': 0.81137955, 'precision': 0.8370335, 'recall': 0.8086643, 'specificity': 0.8086643, 'f1': 0.8067299, 'auroc': 0.88053215, 'binary_precision': 0.9252747, 'binary_recall': 0.66931635, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.7767527}
confusion matrix:
     0    1
0  620   34
1  208  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8544897, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83333004, 'auroc': 0.9236346, 'binary_precision': 0.9364162, 'binary_recall': 0.72, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.81407034}
confusion matrix:
     0    1
0  214   11
1   63  162
early stop counter: 1
val acc:0.8113795518875122, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8622221946716309 / 0.8622221946716309
after epoch: 3,now: 2024-07-26 03:40:26.488608,epoch time: 0:01:46.526841,used: 0:05:27.233110,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9776218, 'recall': 0.97747695, 'specificity': 0.97747695, 'f1': 0.97753185, 'auroc': 0.9982275, 'binary_precision': 0.97388536, 'binary_recall': 0.9820167, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.97793406}
confusion matrix:
      0     1
0  1474    41
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.8090413, 'precision': 0.82533765, 'recall': 0.80682653, 'specificity': 0.80682653, 'f1': 0.8057902, 'auroc': 0.8794067, 'binary_precision': 0.89344263, 'binary_recall': 0.69316375, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.7806625}
confusion matrix:
     0    1
0  602   52
1  193  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8844444, 'precision': 0.8914027, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.88392854, 'auroc': 0.934242, 'binary_precision': 0.94358975, 'binary_recall': 0.81777775, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8761904}
confusion matrix:
     0    1
0  214   11
1   41  184
new oracle model saved
early stop counter: 2
val acc:0.8090413212776184, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8622221946716309 / 0.8844444155693054
after epoch: 4,now: 2024-07-26 03:42:14.125946,epoch time: 0:01:47.637338,used: 0:07:14.870448,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.9745871, 'recall': 0.97464746, 'specificity': 0.97464746, 'f1': 0.9746069, 'auroc': 0.9975836, 'binary_precision': 0.97800773, 'binary_recall': 0.97172236, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9748549}
confusion matrix:
      0     1
0  1482    34
1    44  1512
---- Validation: 
scalar performance:
{'acc': 0.7630553, 'precision': 0.76624954, 'recall': 0.7640593, 'specificity': 0.7640593, 'f1': 0.762737, 'auroc': 0.8446615, 'binary_precision': 0.7318117, 'binary_recall': 0.8155803, 'binary_specificity': 0.71253824, 'binary_f1_score': 0.7714286}
confusion matrix:
     0    1
0  466  188
1  116  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.79508346, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.78513443, 'auroc': 0.8596741, 'binary_precision': 0.7452471, 'binary_recall': 0.8711111, 'binary_specificity': 0.7022222, 'binary_f1_score': 0.8032786}
confusion matrix:
     0    1
0  158   67
1   29  196
early stop counter: 3
val acc:0.7630553245544434, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8622221946716309 / 0.8844444155693054
after epoch: 5,now: 2024-07-26 03:44:00.957550,epoch time: 0:01:46.831604,used: 0:09:01.702052,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9708729, 'recall': 0.97012603, 'specificity': 0.97012603, 'f1': 0.96972066, 'auroc': 0.9971044, 'binary_precision': 0.99796057, 'binary_recall': 0.9422336, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.9692969}
confusion matrix:
      0     1
0  1511     3
1    90  1468
---- Validation: 
scalar performance:
{'acc': 0.6804365, 'precision': 0.7857197, 'recall': 0.6744201, 'specificity': 0.6744201, 'f1': 0.6434952, 'auroc': 0.87199235, 'binary_precision': 0.95435685, 'binary_recall': 0.36565977, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.52873564}
confusion matrix:
     0    1
0  643   11
1  399  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.83300173, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7599578, 'auroc': 0.89577776, 'binary_precision': 0.9765625, 'binary_recall': 0.5555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.70821536}
confusion matrix:
     0    1
0  222    3
1  100  125
early stop counter: 4
val acc:0.6804364919662476, best validation acc: 0.8300857543945312, corresponding to test acc:                         0.8622221946716309 / 0.8844444155693054
after epoch: 6,now: 2024-07-26 03:45:47.453043,epoch time: 0:01:46.495493,used: 0:10:48.197545,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9847392, 'recall': 0.984663, 'specificity': 0.984663, 'f1': 0.984696, 'auroc': 0.999058, 'binary_precision': 0.98275864, 'binary_recall': 0.9871713, 'binary_specificity': 0.98215467, 'binary_f1_score': 0.98496}
confusion matrix:
      0     1
0  1486    27
1    20  1539
---- Validation: 
scalar performance:
{'acc': 0.8316446, 'precision': 0.84611344, 'recall': 0.8296359, 'specificity': 0.8296359, 'f1': 0.8292159, 'auroc': 0.89045525, 'binary_precision': 0.91217566, 'binary_recall': 0.7265501, 'binary_specificity': 0.93272173, 'binary_f1_score': 0.8088496}
confusion matrix:
     0    1
0  610   44
1  172  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87333333, 'precision': 0.88154066, 'recall': 0.87333333, 'specificity': 0.87333333, 'f1': 0.8726485, 'auroc': 0.93139756, 'binary_precision': 0.9375, 'binary_recall': 0.8, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  213   12
1   45  180
better model found
persisted
after epoch: 7,now: 2024-07-26 03:47:34.923491,epoch time: 0:01:47.470448,used: 0:12:35.667993,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863063, 'recall': 0.9863533, 'specificity': 0.9863533, 'f1': 0.98632604, 'auroc': 0.99898934, 'binary_precision': 0.98840207, 'binary_recall': 0.98459566, 'binary_specificity': 0.98811096, 'binary_f1_score': 0.9864952}
confusion matrix:
      0     1
0  1496    18
1    24  1534
---- Validation: 
scalar performance:
{'acc': 0.8144973, 'precision': 0.83855975, 'recall': 0.8118744, 'specificity': 0.8118744, 'f1': 0.8102024, 'auroc': 0.8914519, 'binary_precision': 0.9240781, 'binary_recall': 0.6772655, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.78165144}
confusion matrix:
     0    1
0  619   35
1  203  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.85318905, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.83598864, 'auroc': 0.91932833, 'binary_precision': 0.9269663, 'binary_recall': 0.73333335, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.81885856}
confusion matrix:
     0    1
0  212   13
1   60  165
early stop counter: 1
val acc:0.8144972920417786, best validation acc: 0.831644594669342, corresponding to test acc:                         0.8733333349227905 / 0.8844444155693054
after epoch: 8,now: 2024-07-26 03:49:21.264971,epoch time: 0:01:46.341480,used: 0:14:22.009473,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.96924746, 'recall': 0.96742463, 'specificity': 0.96742463, 'f1': 0.967725, 'auroc': 0.99824834, 'binary_precision': 0.9461444, 'binary_recall': 0.9929351, 'binary_specificity': 0.9419142, 'binary_f1_score': 0.9689752}
confusion matrix:
      0     1
0  1427    88
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.8082619, 'precision': 0.8112392, 'recall': 0.8091918, 'specificity': 0.8091918, 'f1': 0.8080659, 'auroc': 0.88989365, 'binary_precision': 0.7755396, 'binary_recall': 0.8569157, 'binary_specificity': 0.7614679, 'binary_f1_score': 0.8141994}
confusion matrix:
     0    1
0  498  156
1   90  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.86669564, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.86666405, 'auroc': 0.9380543, 'binary_precision': 0.8634361, 'binary_recall': 0.8711111, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.86725664}
confusion matrix:
     0    1
0  194   31
1   29  196
early stop counter: 2
val acc:0.8082618713378906, best validation acc: 0.831644594669342, corresponding to test acc:                         0.8733333349227905 / 0.8844444155693054
after epoch: 9,now: 2024-07-26 03:51:07.684275,epoch time: 0:01:46.419304,used: 0:16:08.428777,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97868156, 'recall': 0.97868156, 'specificity': 0.97868156, 'f1': 0.9785156, 'auroc': 0.9978045, 'binary_precision': 0.9914248, 'binary_recall': 0.9659383, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9785156}
confusion matrix:
      0     1
0  1503    13
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.84099764, 'precision': 0.84899914, 'recall': 0.8395091, 'specificity': 0.8395091, 'f1': 0.8396179, 'auroc': 0.8847158, 'binary_precision': 0.89719623, 'binary_recall': 0.76311606, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.82474226}
confusion matrix:
     0    1
0  599   55
1  149  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8355821, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83555233, 'auroc': 0.9195259, 'binary_precision': 0.83856505, 'binary_recall': 0.83111113, 'binary_specificity': 0.84, 'binary_f1_score': 0.83482146}
confusion matrix:
     0    1
0  189   36
1   38  187
better model found
persisted
after epoch: 10,now: 2024-07-26 03:52:55.273992,epoch time: 0:01:47.589717,used: 0:17:56.018494,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9837005, 'recall': 0.9837743, 'specificity': 0.9837743, 'f1': 0.98372245, 'auroc': 0.99916744, 'binary_precision': 0.98770225, 'binary_recall': 0.9800899, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.98388135}
confusion matrix:
      0     1
0  1496    19
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.77708495, 'precision': 0.8189847, 'recall': 0.7735058, 'specificity': 0.7735058, 'f1': 0.76791704, 'auroc': 0.89192104, 'binary_precision': 0.9298246, 'binary_recall': 0.5898251, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.7217899}
confusion matrix:
     0    1
0  626   28
1  258  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.84656084, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78240746, 'auroc': 0.93378764, 'binary_precision': 0.9851852, 'binary_recall': 0.5911111, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.7388889}
confusion matrix:
     0    1
0  223    2
1   92  133
early stop counter: 1
val acc:0.7770849466323853, best validation acc: 0.8409976363182068, corresponding to test acc:                         0.8355555534362793 / 0.8844444155693054
after epoch: 11,now: 2024-07-26 03:54:41.685286,epoch time: 0:01:46.411294,used: 0:19:42.429788,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9829823, 'recall': 0.9829727, 'specificity': 0.9829727, 'f1': 0.98274744, 'auroc': 0.99902236, 'binary_precision': 0.9980159, 'binary_recall': 0.9679282, 'binary_specificity': 0.9980172, 'binary_f1_score': 0.98274183}
confusion matrix:
      0     1
0  1510     3
1    50  1509
---- Validation: 
scalar performance:
{'acc': 0.72564304, 'precision': 0.7930421, 'recall': 0.7208897, 'specificity': 0.7208897, 'f1': 0.7060802, 'auroc': 0.85947675, 'binary_precision': 0.9287926, 'binary_recall': 0.47694755, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.6302521}
confusion matrix:
     0    1
0  631   23
1  329  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.82142854, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.7672513, 'auroc': 0.8697679, 'binary_precision': 0.94285715, 'binary_recall': 0.58666664, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.72328764}
confusion matrix:
     0    1
0  217    8
1   93  132
early stop counter: 2
val acc:0.7256430387496948, best validation acc: 0.8409976363182068, corresponding to test acc:                         0.8355555534362793 / 0.8844444155693054
after epoch: 12,now: 2024-07-26 03:56:28.338114,epoch time: 0:01:46.652828,used: 0:21:29.082616,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902326, 'recall': 0.9902326, 'specificity': 0.9902326, 'f1': 0.9902326, 'auroc': 0.9996367, 'binary_precision': 0.9903661, 'binary_recall': 0.9903661, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9903661}
confusion matrix:
      0     1
0  1500    15
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.78721744, 'precision': 0.8207904, 'recall': 0.784022, 'specificity': 0.784022, 'f1': 0.7801523, 'auroc': 0.8831916, 'binary_precision': 0.9198113, 'binary_recall': 0.6200318, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.7407408}
confusion matrix:
     0    1
0  620   34
1  239  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8905597, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86704457, 'auroc': 0.95326424, 'binary_precision': 0.98255813, 'binary_recall': 0.7511111, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8513853}
confusion matrix:
     0    1
0  222    3
1   56  169
early stop counter: 3
val acc:0.7872174382209778, best validation acc: 0.8409976363182068, corresponding to test acc:                         0.8355555534362793 / 0.8844444155693054
after epoch: 13,now: 2024-07-26 03:58:14.937902,epoch time: 0:01:46.599788,used: 0:23:15.682404,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97431076, 'recall': 0.9736842, 'specificity': 0.9736842, 'f1': 0.9733032, 'auroc': 0.9998025, 'binary_precision': 1.0, 'binary_recall': 0.94736844, 'binary_specificity': 1.0, 'binary_f1_score': 0.972973}
confusion matrix:
      0     1
0  1514     0
1    82  1476
---- Validation: 
scalar performance:
{'acc': 0.52766955, 'precision': 0.7395389, 'recall': 0.5183134, 'specificity': 0.5183134, 'f1': 0.37822443, 'auroc': 0.88625336, 'binary_precision': 0.96, 'binary_recall': 0.0381558, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.07339449}
confusion matrix:
     0   1
0  653   1
1  605  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50222224, 'precision': 0.7505568, 'recall': 0.50222224, 'specificity': 0.50222224, 'f1': 0.33825266, 'auroc': 0.94054323, 'binary_precision': 1.0, 'binary_recall': 0.0044444446, 'binary_specificity': 1.0, 'binary_f1_score': 0.0088495575}
confusion matrix:
     0  1
0  225  0
1  224  1
early stop counter: 4
val acc:0.5276695489883423, best validation acc: 0.8409976363182068, corresponding to test acc:                         0.8355555534362793 / 0.8844444155693054
after epoch: 14,now: 2024-07-26 04:00:01.502104,epoch time: 0:01:46.564202,used: 0:25:02.246606,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896305, 'recall': 0.98970026, 'specificity': 0.98970026, 'f1': 0.98958313, 'auroc': 0.9996748, 'binary_precision': 0.9986911, 'binary_recall': 0.9807198, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98962384}
confusion matrix:
      0     1
0  1514     2
1    30  1526
---- Validation: 
scalar performance:
{'acc': 0.609509, 'precision': 0.76203597, 'recall': 0.60193115, 'specificity': 0.60193115, 'f1': 0.5348533, 'auroc': 0.88148993, 'binary_precision': 0.95714283, 'binary_recall': 0.21303657, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.34850454}
confusion matrix:
     0    1
0  648    6
1  495  134
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75777775, 'precision': 0.8331121, 'recall': 0.7577778, 'specificity': 0.7577778, 'f1': 0.74326223, 'auroc': 0.9529679, 'binary_precision': 0.9915254, 'binary_recall': 0.52, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.6822157}
confusion matrix:
     0    1
0  224    1
1  108  117
early stop counter: 5
val acc:0.6095089912414551, best validation acc: 0.8409976363182068, corresponding to test acc:                         0.8355555534362793 / 0.8844444155693054
after epoch: 15,now: 2024-07-26 04:01:48.128550,epoch time: 0:01:46.626446,used: 0:26:48.873052,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_3_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:26:48.873052 at 2024-07-26 04:01:48.128550
persisted model performance metric: 

scalar performance:
{'acc': 0.83555555, 'precision': 0.8355821, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83555233, 'auroc': 0.9195259, 'binary_precision': 0.83856505, 'binary_recall': 0.83111113, 'binary_specificity': 0.84, 'binary_f1_score': 0.83482146}
confusion matrix:
     0    1
0  189   36
1   38  187
oracle model performance metric: 

scalar performance:
{'acc': 0.8844444, 'precision': 0.8914027, 'recall': 0.8844445, 'specificity': 0.8844445, 'f1': 0.88392854, 'auroc': 0.934242, 'binary_precision': 0.94358975, 'binary_recall': 0.81777775, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8761904}
confusion matrix:
     0    1
0  214   11
1   41  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2828 MiB |   9264 MiB | 364173 GiB | 364170 GiB |
|       from large pool |   2739 MiB |   9189 MiB | 361034 GiB | 361032 GiB |
|       from small pool |     89 MiB |    130 MiB |   3138 GiB |   3138 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2828 MiB |   9264 MiB | 364173 GiB | 364170 GiB |
|       from large pool |   2739 MiB |   9189 MiB | 361034 GiB | 361032 GiB |
|       from small pool |     89 MiB |    130 MiB |   3138 GiB |   3138 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 363660 GiB | 363658 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 360526 GiB | 360524 GiB |
|       from small pool |     89 MiB |    130 MiB |   3134 GiB |   3134 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10070 MiB |  10324 MiB |  28310 MiB |  18240 MiB |
|       from large pool |   9930 MiB |  10188 MiB |  28058 MiB |  18128 MiB |
|       from small pool |    140 MiB |    140 MiB |    252 MiB |    112 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1339 MiB |   2246 MiB | 285587 GiB | 285585 GiB |
|       from large pool |   1330 MiB |   2238 MiB | 282364 GiB | 282363 GiB |
|       from small pool |      8 MiB |     50 MiB |   3222 GiB |   3222 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   51173 K  |   51170 K  |
|       from large pool |     392    |     816    |   25699 K  |   25699 K  |
|       from small pool |    2084    |    2780    |   25473 K  |   25471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   51173 K  |   51170 K  |
|       from large pool |     392    |     816    |   25699 K  |   25699 K  |
|       from small pool |    2084    |    2780    |   25473 K  |   25471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     259    |     335    |     742    |     483    |
|       from large pool |     189    |     267    |     616    |     427    |
|       from small pool |      70    |      70    |     126    |      56    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     163    |     340    |   27661 K  |   27660 K  |
|       from large pool |      85    |     257    |   15147 K  |   15147 K  |
|       from small pool |      78    |     239    |   12513 K  |   12513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 364173 GiB | 364173 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 361034 GiB | 361034 GiB |
|       from small pool |      0 KiB |    130 MiB |   3138 GiB |   3138 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 364173 GiB | 364173 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 361034 GiB | 361034 GiB |
|       from small pool |      0 KiB |    130 MiB |   3138 GiB |   3138 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 363660 GiB | 363660 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 360526 GiB | 360526 GiB |
|       from small pool |      0 KiB |    130 MiB |   3134 GiB |   3134 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4168 MiB |  10324 MiB |  28310 MiB |  24142 MiB |
|       from large pool |   4070 MiB |  10188 MiB |  28058 MiB |  23988 MiB |
|       from small pool |     98 MiB |    140 MiB |    252 MiB |    154 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 285588 GiB | 285588 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 282365 GiB | 282365 GiB |
|       from small pool |      0 KiB |     50 MiB |   3222 GiB |   3222 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   51173 K  |   51173 K  |
|       from large pool |       2    |     816    |   25699 K  |   25699 K  |
|       from small pool |       0    |    2780    |   25473 K  |   25473 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   51173 K  |   51173 K  |
|       from large pool |       2    |     816    |   25699 K  |   25699 K  |
|       from small pool |       0    |    2780    |   25473 K  |   25473 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     335    |     742    |     611    |
|       from large pool |      82    |     267    |     616    |     534    |
|       from small pool |      49    |      70    |     126    |      77    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   27661 K  |   27661 K  |
|       from large pool |       3    |     257    |   15147 K  |   15147 K  |
|       from small pool |       0    |     239    |   12513 K  |   12513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 364173 GiB | 364173 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 361034 GiB | 361034 GiB |
|       from small pool |      0 KiB |    130 MiB |   3138 GiB |   3138 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 364173 GiB | 364173 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 361034 GiB | 361034 GiB |
|       from small pool |      0 KiB |    130 MiB |   3138 GiB |   3138 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 363660 GiB | 363660 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 360526 GiB | 360526 GiB |
|       from small pool |      0 KiB |    130 MiB |   3134 GiB |   3134 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4168 MiB |  10324 MiB |  28310 MiB |  24142 MiB |
|       from large pool |   4070 MiB |  10188 MiB |  28058 MiB |  23988 MiB |
|       from small pool |     98 MiB |    140 MiB |    252 MiB |    154 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 285588 GiB | 285588 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 282365 GiB | 282365 GiB |
|       from small pool |      0 KiB |     50 MiB |   3222 GiB |   3222 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   51173 K  |   51173 K  |
|       from large pool |       2    |     816    |   25699 K  |   25699 K  |
|       from small pool |       0    |    2780    |   25473 K  |   25473 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   51173 K  |   51173 K  |
|       from large pool |       2    |     816    |   25699 K  |   25699 K  |
|       from small pool |       0    |    2780    |   25473 K  |   25473 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     335    |     742    |     611    |
|       from large pool |      82    |     267    |     616    |     534    |
|       from small pool |      49    |      70    |     126    |      77    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   27661 K  |   27661 K  |
|       from large pool |       3    |     257    |   15147 K  |   15147 K  |
|       from small pool |       0    |     239    |   12513 K  |   12513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734

 Experiment start at: 2024-07-26 04:02:20.583819
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9397668, 'precision': 0.9397497, 'recall': 0.9397497, 'specificity': 0.9397497, 'f1': 0.9397497, 'auroc': 0.98616266, 'binary_precision': 0.9407643, 'binary_recall': 0.9407643, 'binary_specificity': 0.9387352, 'binary_f1_score': 0.9407643}
confusion matrix:
      0     1
0  1425    93
1    93  1477
---- Validation: 
scalar performance:
{'acc': 0.82825917, 'precision': 0.82823825, 'recall': 0.82829106, 'specificity': 0.82829106, 'f1': 0.82824653, 'auroc': 0.8943969, 'binary_precision': 0.822884, 'binary_recall': 0.8306962, 'binary_specificity': 0.82588595, 'binary_f1_score': 0.8267717}
confusion matrix:
     0    1
0  536  113
1  107  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87914693, 'precision': 0.8822464, 'recall': 0.87914693, 'specificity': 0.87914693, 'f1': 0.8789014, 'auroc': 0.9340536, 'binary_precision': 0.9166667, 'binary_recall': 0.8341232, 'binary_specificity': 0.9241706, 'binary_f1_score': 0.87344915}
confusion matrix:
     0    1
0  195   16
1   35  176
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:04:10.681286,epoch time: 0:01:50.097467,used: 0:01:50.097467,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9779793, 'precision': 0.97808677, 'recall': 0.9781991, 'specificity': 0.9781991, 'f1': 0.9779788, 'auroc': 0.9975558, 'binary_precision': 0.99085563, 'binary_recall': 0.965627, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.97807866}
confusion matrix:
      0     1
0  1503    14
1    54  1517
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.8358345, 'recall': 0.8331866, 'specificity': 0.8331866, 'f1': 0.83328104, 'auroc': 0.89588654, 'binary_precision': 0.8593482, 'binary_recall': 0.7927215, 'binary_specificity': 0.87365174, 'binary_f1_score': 0.82469136}
confusion matrix:
     0    1
0  567   82
1  131  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.8306728, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.801946, 'auroc': 0.9155904, 'binary_precision': 0.92156863, 'binary_recall': 0.66824645, 'binary_specificity': 0.943128, 'binary_f1_score': 0.77472526}
confusion matrix:
     0    1
0  199   12
1   70  141
better model found
persisted
after epoch: 2,now: 2024-07-26 04:05:58.254961,epoch time: 0:01:47.573675,used: 0:03:37.671142,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96243525, 'precision': 0.96431667, 'recall': 0.9631616, 'specificity': 0.9631616, 'f1': 0.9624246, 'auroc': 0.9977025, 'binary_precision': 0.99931556, 'binary_recall': 0.92698413, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.9617918}
confusion matrix:
      0     1
0  1512     1
1   115  1460
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.82511187, 'recall': 0.80398035, 'specificity': 0.80398035, 'f1': 0.80205196, 'auroc': 0.88193864, 'binary_precision': 0.9014675, 'binary_recall': 0.68037975, 'binary_specificity': 0.9275809, 'binary_f1_score': 0.7754735}
confusion matrix:
     0    1
0  602   47
1  202  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66824645, 'precision': 0.7940103, 'recall': 0.66824645, 'specificity': 0.66824645, 'f1': 0.6285212, 'auroc': 0.9299656, 'binary_precision': 0.98630136, 'binary_recall': 0.34123224, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.5070423}
confusion matrix:
     0   1
0  210   1
1  139  72
early stop counter: 1
val acc:0.8056206107139587, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.8056871891021729 / 0.879146933555603
after epoch: 3,now: 2024-07-26 04:07:45.030474,epoch time: 0:01:46.775513,used: 0:05:24.446655,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97215027, 'precision': 0.97276044, 'recall': 0.97253823, 'specificity': 0.97253823, 'f1': 0.9721495, 'auroc': 0.9977585, 'binary_precision': 0.9946702, 'binary_recall': 0.9503501, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.97200525}
confusion matrix:
      0     1
0  1509     8
1    78  1493
---- Validation: 
scalar performance:
{'acc': 0.8235753, 'precision': 0.83232164, 'recall': 0.82248735, 'specificity': 0.82248735, 'f1': 0.8220396, 'auroc': 0.8972263, 'binary_precision': 0.88301885, 'binary_recall': 0.74050635, 'binary_specificity': 0.9044684, 'binary_f1_score': 0.8055078}
confusion matrix:
     0    1
0  587   62
1  164  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8439164, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.83560574, 'auroc': 0.9276072, 'binary_precision': 0.89444447, 'binary_recall': 0.76303315, 'binary_specificity': 0.9099526, 'binary_f1_score': 0.82352936}
confusion matrix:
     0    1
0  192   19
1   50  161
early stop counter: 2
val acc:0.8235753178596497, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.8056871891021729 / 0.879146933555603
after epoch: 4,now: 2024-07-26 04:09:31.808879,epoch time: 0:01:46.778405,used: 0:07:11.225060,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9799223, 'precision': 0.9802924, 'recall': 0.9802924, 'specificity': 0.9802924, 'f1': 0.9799223, 'auroc': 0.997844, 'binary_precision': 0.9993395, 'binary_recall': 0.96124524, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9799223}
confusion matrix:
      0     1
0  1513     1
1    61  1513
---- Validation: 
scalar performance:
{'acc': 0.81342703, 'precision': 0.828892, 'recall': 0.81197464, 'specificity': 0.81197464, 'f1': 0.810691, 'auroc': 0.9050267, 'binary_precision': 0.8969697, 'binary_recall': 0.70253164, 'binary_specificity': 0.9214176, 'binary_f1_score': 0.7879326}
confusion matrix:
     0    1
0  598   51
1  188  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82227486, 'precision': 0.842271, 'recall': 0.8222749, 'specificity': 0.8222749, 'f1': 0.81964064, 'auroc': 0.9263942, 'binary_precision': 0.925, 'binary_recall': 0.7014218, 'binary_specificity': 0.943128, 'binary_f1_score': 0.79784364}
confusion matrix:
     0    1
0  199   12
1   63  148
early stop counter: 3
val acc:0.8134270310401917, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.8056871891021729 / 0.879146933555603
after epoch: 5,now: 2024-07-26 04:11:19.016122,epoch time: 0:01:47.207243,used: 0:08:58.432303,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96340674, 'precision': 0.9653587, 'recall': 0.96401274, 'specificity': 0.96401274, 'f1': 0.9633925, 'auroc': 0.9984567, 'binary_precision': 1.0, 'binary_recall': 0.9280255, 'binary_specificity': 1.0, 'binary_f1_score': 0.9626693}
confusion matrix:
      0     1
0  1518     0
1   113  1457
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.77005196, 'recall': 0.649774, 'specificity': 0.649774, 'f1': 0.6088658, 'auroc': 0.9004414, 'binary_precision': 0.943662, 'binary_recall': 0.318038, 'binary_specificity': 0.98151004, 'binary_f1_score': 0.4757397}
confusion matrix:
     0    1
0  637   12
1  431  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5521327, 'precision': 0.76374996, 'recall': 0.5521327, 'specificity': 0.5521327, 'f1': 0.4397561, 'auroc': 0.94470024, 'binary_precision': 1.0, 'binary_recall': 0.1042654, 'binary_specificity': 1.0, 'binary_f1_score': 0.1888412}
confusion matrix:
     0   1
0  211   0
1  189  22
early stop counter: 4
val acc:0.6541764140129089, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.8056871891021729 / 0.879146933555603
after epoch: 6,now: 2024-07-26 04:13:05.983420,epoch time: 0:01:46.967298,used: 0:10:45.399601,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.98312294, 'recall': 0.9832121, 'specificity': 0.9832121, 'f1': 0.9831572, 'auroc': 0.9988549, 'binary_precision': 0.9865471, 'binary_recall': 0.98026735, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.9833972}
confusion matrix:
      0     1
0  1496    21
1    31  1540
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.82609916, 'recall': 0.82125735, 'specificity': 0.82125735, 'f1': 0.8211893, 'auroc': 0.9049511, 'binary_precision': 0.8594306, 'binary_recall': 0.7642405, 'binary_specificity': 0.87827426, 'binary_f1_score': 0.8090452}
confusion matrix:
     0    1
0  570   79
1  149  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.85089487, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.8480648, 'auroc': 0.92275554, 'binary_precision': 0.88082904, 'binary_recall': 0.8056872, 'binary_specificity': 0.89099526, 'binary_f1_score': 0.84158415}
confusion matrix:
     0    1
0  188   23
1   41  170
early stop counter: 5
val acc:0.8220140337944031, best validation acc: 0.8337236642837524, corresponding to test acc:                         0.8056871891021729 / 0.879146933555603
after epoch: 7,now: 2024-07-26 04:14:52.921476,epoch time: 0:01:46.938056,used: 0:12:32.337657,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_02_20_seed_4_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:12:32.337657 at 2024-07-26 04:14:52.921476
persisted model performance metric: 

scalar performance:
{'acc': 0.8056872, 'precision': 0.8306728, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.801946, 'auroc': 0.9155904, 'binary_precision': 0.92156863, 'binary_recall': 0.66824645, 'binary_specificity': 0.943128, 'binary_f1_score': 0.77472526}
confusion matrix:
     0    1
0  199   12
1   70  141
oracle model performance metric: 

scalar performance:
{'acc': 0.87914693, 'precision': 0.8822464, 'recall': 0.87914693, 'specificity': 0.87914693, 'f1': 0.8789014, 'auroc': 0.9340536, 'binary_precision': 0.9166667, 'binary_recall': 0.8341232, 'binary_specificity': 0.9241706, 'binary_f1_score': 0.87344915}
confusion matrix:
     0    1
0  195   16
1   35  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2827 MiB |   9264 MiB | 411717 GiB | 411714 GiB |
|       from large pool |   2737 MiB |   9189 MiB | 408168 GiB | 408165 GiB |
|       from small pool |     89 MiB |    130 MiB |   3548 GiB |   3548 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2827 MiB |   9264 MiB | 411717 GiB | 411714 GiB |
|       from large pool |   2737 MiB |   9189 MiB | 408168 GiB | 408165 GiB |
|       from small pool |     89 MiB |    130 MiB |   3548 GiB |   3548 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 411141 GiB | 411138 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 407597 GiB | 407595 GiB |
|       from small pool |     89 MiB |    130 MiB |   3543 GiB |   3543 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10076 MiB |  10324 MiB |  34218 MiB |  24142 MiB |
|       from large pool |   9942 MiB |  10188 MiB |  33930 MiB |  23988 MiB |
|       from small pool |    134 MiB |    140 MiB |    288 MiB |    154 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1188 MiB |   2246 MiB | 324762 GiB | 324761 GiB |
|       from large pool |   1180 MiB |   2238 MiB | 321118 GiB | 321117 GiB |
|       from small pool |      8 MiB |     50 MiB |   3644 GiB |   3644 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   57860 K  |   57858 K  |
|       from large pool |     392    |     816    |   29056 K  |   29056 K  |
|       from small pool |    2072    |    2780    |   28804 K  |   28802 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   57860 K  |   57858 K  |
|       from large pool |     392    |     816    |   29056 K  |   29056 K  |
|       from small pool |    2072    |    2780    |   28804 K  |   28802 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     262    |     335    |     873    |     611    |
|       from large pool |     195    |     267    |     729    |     534    |
|       from small pool |      67    |      70    |     144    |      77    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     166    |     340    |   31159 K  |   31159 K  |
|       from large pool |      83    |     257    |   17054 K  |   17054 K  |
|       from small pool |      83    |     239    |   14104 K  |   14104 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 411717 GiB | 411717 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 408168 GiB | 408168 GiB |
|       from small pool |      0 KiB |    130 MiB |   3548 GiB |   3548 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 411717 GiB | 411717 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 408168 GiB | 408168 GiB |
|       from small pool |      0 KiB |    130 MiB |   3548 GiB |   3548 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 411141 GiB | 411141 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 407597 GiB | 407597 GiB |
|       from small pool |      0 KiB |    130 MiB |   3543 GiB |   3543 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |  10324 MiB |  34218 MiB |  30202 MiB |
|       from large pool |   3918 MiB |  10188 MiB |  33930 MiB |  30012 MiB |
|       from small pool |     98 MiB |    140 MiB |    288 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 324763 GiB | 324763 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 321119 GiB | 321119 GiB |
|       from small pool |      0 KiB |     50 MiB |   3644 GiB |   3644 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   57860 K  |   57860 K  |
|       from large pool |       2    |     816    |   29056 K  |   29056 K  |
|       from small pool |       0    |    2780    |   28804 K  |   28804 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   57860 K  |   57860 K  |
|       from large pool |       2    |     816    |   29056 K  |   29056 K  |
|       from small pool |       0    |    2780    |   28804 K  |   28804 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     335    |     873    |     744    |
|       from large pool |      80    |     267    |     729    |     649    |
|       from small pool |      49    |      70    |     144    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   31159 K  |   31159 K  |
|       from large pool |       3    |     257    |   17054 K  |   17054 K  |
|       from small pool |       0    |     239    |   14104 K  |   14104 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 411717 GiB | 411717 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 408168 GiB | 408168 GiB |
|       from small pool |      0 KiB |    130 MiB |   3548 GiB |   3548 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 411717 GiB | 411717 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 408168 GiB | 408168 GiB |
|       from small pool |      0 KiB |    130 MiB |   3548 GiB |   3548 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 411141 GiB | 411141 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 407597 GiB | 407597 GiB |
|       from small pool |      0 KiB |    130 MiB |   3543 GiB |   3543 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |  10324 MiB |  34218 MiB |  30202 MiB |
|       from large pool |   3918 MiB |  10188 MiB |  33930 MiB |  30012 MiB |
|       from small pool |     98 MiB |    140 MiB |    288 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 324763 GiB | 324763 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 321119 GiB | 321119 GiB |
|       from small pool |      0 KiB |     50 MiB |   3644 GiB |   3644 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   57860 K  |   57860 K  |
|       from large pool |       2    |     816    |   29056 K  |   29056 K  |
|       from small pool |       0    |    2780    |   28804 K  |   28804 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   57860 K  |   57860 K  |
|       from large pool |       2    |     816    |   29056 K  |   29056 K  |
|       from small pool |       0    |    2780    |   28804 K  |   28804 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     335    |     873    |     744    |
|       from large pool |      80    |     267    |     729    |     649    |
|       from small pool |      49    |      70    |     144    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   31159 K  |   31159 K  |
|       from large pool |       3    |     257    |   17054 K  |   17054 K  |
|       from small pool |       0    |     239    |   14104 K  |   14104 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734

 Experiment start at: 2024-07-26 04:15:24.331862
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.87663615, 'precision': 0.8999469, 'recall': 0.8783086, 'specificity': 0.8783086, 'f1': 0.87513566, 'auroc': 0.99538064, 'binary_precision': 1.0, 'binary_recall': 0.7566172, 'binary_specificity': 1.0, 'binary_f1_score': 0.861448}
confusion matrix:
      0     1
0  1507     0
1   377  1172
---- Validation: 
scalar performance:
{'acc': 0.5443235, 'precision': 0.75286514, 'recall': 0.53124356, 'specificity': 0.53124356, 'f1': 0.40633497, 'auroc': 0.8883679, 'binary_precision': 0.9756098, 'binary_recall': 0.064, 'binary_specificity': 0.9984871, 'binary_f1_score': 0.12012012}
confusion matrix:
     0   1
0  660   1
1  585  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5151515, 'precision': 0.75384617, 'recall': 0.5151515, 'specificity': 0.5151515, 'f1': 0.36614648, 'auroc': 0.89374256, 'binary_precision': 1.0, 'binary_recall': 0.030303031, 'binary_specificity': 1.0, 'binary_f1_score': 0.058823533}
confusion matrix:
     0  1
0  231  0
1  224  7
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:17:13.927469,epoch time: 0:01:49.595607,used: 0:01:49.595607,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9739644, 'recall': 0.9740131, 'specificity': 0.9740131, 'f1': 0.9738219, 'auroc': 0.9970993, 'binary_precision': 0.9867637, 'binary_recall': 0.9613153, 'binary_specificity': 0.98671097, 'binary_f1_score': 0.9738733}
confusion matrix:
      0     1
0  1485    20
1    60  1491
---- Validation: 
scalar performance:
{'acc': 0.7838258, 'precision': 0.81675065, 'recall': 0.7792121, 'specificity': 0.7792121, 'f1': 0.776025, 'auroc': 0.8927419, 'binary_precision': 0.912114, 'binary_recall': 0.6144, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.73422563}
confusion matrix:
     0    1
0  624   37
1  241  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7012987, 'precision': 0.7661092, 'recall': 0.7012987, 'specificity': 0.7012987, 'f1': 0.68193245, 'auroc': 0.89381766, 'binary_precision': 0.8974359, 'binary_recall': 0.45454547, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.6034483}
confusion matrix:
     0    1
0  219   12
1  126  105
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:19:01.900864,epoch time: 0:01:47.973395,used: 0:03:37.569002,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.9663836, 'recall': 0.9652398, 'specificity': 0.9652398, 'f1': 0.96464866, 'auroc': 0.9981214, 'binary_precision': 0.9993094, 'binary_recall': 0.9311454, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.964024}
confusion matrix:
      0     1
0  1501     1
1   107  1447
---- Validation: 
scalar performance:
{'acc': 0.5287714, 'precision': 0.67473185, 'recall': 0.5154179, 'specificity': 0.5154179, 'f1': 0.37872016, 'auroc': 0.7965386, 'binary_precision': 0.82758623, 'binary_recall': 0.0384, 'binary_specificity': 0.9924357, 'binary_f1_score': 0.0733945}
confusion matrix:
     0   1
0  656   5
1  601  24
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5367965, 'precision': 0.71201813, 'recall': 0.53679657, 'specificity': 0.53679657, 'f1': 0.41617066, 'auroc': 0.8509398, 'binary_precision': 0.9047619, 'binary_recall': 0.08225108, 'binary_specificity': 0.991342, 'binary_f1_score': 0.15079364}
confusion matrix:
     0   1
0  229   2
1  212  19
early stop counter: 1
val acc:0.5287714004516602, best validation acc: 0.7838258147239685, corresponding to test acc:                         0.701298713684082 / 0.701298713684082
after epoch: 3,now: 2024-07-26 04:20:47.838256,epoch time: 0:01:45.937392,used: 0:05:23.506394,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9739642, 'recall': 0.973723, 'specificity': 0.973723, 'f1': 0.9738098, 'auroc': 0.99775684, 'binary_precision': 0.9687898, 'binary_recall': 0.98002577, 'binary_specificity': 0.9674202, 'binary_f1_score': 0.9743754}
confusion matrix:
      0     1
0  1455    49
1    31  1521
---- Validation: 
scalar performance:
{'acc': 0.83359253, 'precision': 0.8334459, 'recall': 0.83354914, 'specificity': 0.83354914, 'f1': 0.8334894, 'auroc': 0.89470255, 'binary_precision': 0.8267091, 'binary_recall': 0.832, 'binary_specificity': 0.8350983, 'binary_f1_score': 0.8293462}
confusion matrix:
     0    1
0  552  109
1  105  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8160173, 'precision': 0.8234426, 'recall': 0.8160173, 'specificity': 0.8160173, 'f1': 0.8149553, 'auroc': 0.9024756, 'binary_precision': 0.872449, 'binary_recall': 0.74025977, 'binary_specificity': 0.8917749, 'binary_f1_score': 0.8009367}
confusion matrix:
     0    1
0  206   25
1   60  171
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 04:22:35.389277,epoch time: 0:01:47.551021,used: 0:07:11.057415,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.9802019, 'recall': 0.9799322, 'specificity': 0.9799322, 'f1': 0.9800291, 'auroc': 0.9976094, 'binary_precision': 0.9745547, 'binary_recall': 0.9864778, 'binary_specificity': 0.9733866, 'binary_f1_score': 0.98048}
confusion matrix:
      0     1
0  1463    40
1    21  1532
---- Validation: 
scalar performance:
{'acc': 0.7566096, 'precision': 0.7569977, 'recall': 0.7570941, 'specificity': 0.7570941, 'f1': 0.756606, 'auroc': 0.83401394, 'binary_precision': 0.7378049, 'binary_recall': 0.7744, 'binary_specificity': 0.7397882, 'binary_f1_score': 0.75565964}
confusion matrix:
     0    1
0  489  172
1  141  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7683983, 'precision': 0.78215134, 'recall': 0.7683983, 'specificity': 0.7683983, 'f1': 0.7655412, 'auroc': 0.82751447, 'binary_precision': 0.71985817, 'binary_recall': 0.8787879, 'binary_specificity': 0.65800864, 'binary_f1_score': 0.791423}
confusion matrix:
     0    1
0  152   79
1   28  203
early stop counter: 1
val acc:0.7566096186637878, best validation acc: 0.8335925340652466, corresponding to test acc:                         0.8160173296928406 / 0.8160173296928406
after epoch: 5,now: 2024-07-26 04:24:21.102132,epoch time: 0:01:45.712855,used: 0:08:56.770270,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97391677, 'recall': 0.9728813, 'specificity': 0.9728813, 'f1': 0.9731376, 'auroc': 0.9979444, 'binary_precision': 0.9588529, 'binary_recall': 0.989704, 'binary_specificity': 0.95605856, 'binary_f1_score': 0.97403425}
confusion matrix:
      0     1
0  1436    66
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.81959563, 'precision': 0.8218832, 'recall': 0.82076126, 'specificity': 0.82076126, 'f1': 0.8195328, 'auroc': 0.8729416, 'binary_precision': 0.7868613, 'binary_recall': 0.8624, 'binary_specificity': 0.77912253, 'binary_f1_score': 0.8229008}
confusion matrix:
     0    1
0  515  146
1   86  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.83996224, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.8373873, 'auroc': 0.8964787, 'binary_precision': 0.8679245, 'binary_recall': 0.7965368, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.83069974}
confusion matrix:
     0    1
0  203   28
1   47  184
new oracle model saved
early stop counter: 2
val acc:0.8195956349372864, best validation acc: 0.8335925340652466, corresponding to test acc:                         0.8160173296928406 / 0.8376623392105103
after epoch: 6,now: 2024-07-26 04:26:08.180792,epoch time: 0:01:47.078660,used: 0:10:43.848930,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9769982, 'recall': 0.97620857, 'specificity': 0.97620857, 'f1': 0.9764184, 'auroc': 0.9989028, 'binary_precision': 0.9642633, 'binary_recall': 0.99034125, 'binary_specificity': 0.9620758, 'binary_f1_score': 0.97712827}
confusion matrix:
      0     1
0  1446    57
1    15  1538
---- Validation: 
scalar performance:
{'acc': 0.8125972, 'precision': 0.8239378, 'recall': 0.80990136, 'specificity': 0.80990136, 'f1': 0.8099065, 'auroc': 0.8909628, 'binary_precision': 0.87795275, 'binary_recall': 0.7136, 'binary_specificity': 0.90620273, 'binary_f1_score': 0.78729033}
confusion matrix:
     0    1
0  599   62
1  179  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77922076, 'precision': 0.78698695, 'recall': 0.77922076, 'specificity': 0.77922076, 'f1': 0.777717, 'auroc': 0.86731887, 'binary_precision': 0.83419687, 'binary_recall': 0.6969697, 'binary_specificity': 0.86147183, 'binary_f1_score': 0.7594339}
confusion matrix:
     0    1
0  199   32
1   70  161
early stop counter: 3
val acc:0.8125972151756287, best validation acc: 0.8335925340652466, corresponding to test acc:                         0.8160173296928406 / 0.8376623392105103
after epoch: 7,now: 2024-07-26 04:27:54.018038,epoch time: 0:01:45.837246,used: 0:12:29.686176,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.97544706, 'recall': 0.975466, 'specificity': 0.975466, 'f1': 0.9754555, 'auroc': 0.99629986, 'binary_precision': 0.9766537, 'binary_recall': 0.97475725, 'binary_specificity': 0.9761747, 'binary_f1_score': 0.9757045}
confusion matrix:
      0     1
0  1475    36
1    39  1506
---- Validation: 
scalar performance:
{'acc': 0.7161742, 'precision': 0.71857107, 'recall': 0.7143613, 'specificity': 0.7143613, 'f1': 0.7141204, 'auroc': 0.78812945, 'binary_precision': 0.73550725, 'binary_recall': 0.6496, 'binary_specificity': 0.77912253, 'binary_f1_score': 0.68988955}
confusion matrix:
     0    1
0  515  146
1  219  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8008658, 'precision': 0.8016799, 'recall': 0.80086577, 'specificity': 0.80086577, 'f1': 0.8007313, 'auroc': 0.84488666, 'binary_precision': 0.78600824, 'binary_recall': 0.8268398, 'binary_specificity': 0.7748918, 'binary_f1_score': 0.80590713}
confusion matrix:
     0    1
0  179   52
1   40  191
early stop counter: 4
val acc:0.7161741852760315, best validation acc: 0.8335925340652466, corresponding to test acc:                         0.8160173296928406 / 0.8376623392105103
after epoch: 8,now: 2024-07-26 04:29:39.960844,epoch time: 0:01:45.942806,used: 0:14:15.628982,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.97630596, 'recall': 0.9747386, 'specificity': 0.9747386, 'f1': 0.9750924, 'auroc': 0.9990673, 'binary_precision': 0.95679015, 'binary_recall': 0.99614394, 'binary_specificity': 0.9533333, 'binary_f1_score': 0.9760705}
confusion matrix:
      0     1
0  1430    70
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.7534992, 'precision': 0.77470016, 'recall': 0.757249, 'specificity': 0.757249, 'f1': 0.7503251, 'auroc': 0.83804417, 'binary_precision': 0.691067, 'binary_recall': 0.8912, 'binary_specificity': 0.62329805, 'binary_f1_score': 0.77847654}
confusion matrix:
     0    1
0  412  249
1   68  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7965368, 'precision': 0.8150523, 'recall': 0.7965368, 'specificity': 0.7965368, 'f1': 0.7935029, 'auroc': 0.82802045, 'binary_precision': 0.73867595, 'binary_recall': 0.9177489, 'binary_specificity': 0.6753247, 'binary_f1_score': 0.8185328}
confusion matrix:
     0    1
0  156   75
1   19  212
early stop counter: 5
val acc:0.7534992098808289, best validation acc: 0.8335925340652466, corresponding to test acc:                         0.8160173296928406 / 0.8376623392105103
after epoch: 9,now: 2024-07-26 04:31:25.850353,epoch time: 0:01:45.889509,used: 0:16:01.518491,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_15_24_seed_5_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:16:01.518491 at 2024-07-26 04:31:25.850353
persisted model performance metric: 

scalar performance:
{'acc': 0.8160173, 'precision': 0.8234426, 'recall': 0.8160173, 'specificity': 0.8160173, 'f1': 0.8149553, 'auroc': 0.9024756, 'binary_precision': 0.872449, 'binary_recall': 0.74025977, 'binary_specificity': 0.8917749, 'binary_f1_score': 0.8009367}
confusion matrix:
     0    1
0  206   25
1   60  171
oracle model performance metric: 

scalar performance:
{'acc': 0.83766234, 'precision': 0.83996224, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.8373873, 'auroc': 0.8964787, 'binary_precision': 0.8679245, 'binary_recall': 0.7965368, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.83069974}
confusion matrix:
     0    1
0  203   28
1   47  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2826 MiB |   9264 MiB | 472252 GiB | 472249 GiB |
|       from large pool |   2736 MiB |   9189 MiB | 468181 GiB | 468178 GiB |
|       from small pool |     89 MiB |    130 MiB |   4071 GiB |   4071 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2826 MiB |   9264 MiB | 472252 GiB | 472249 GiB |
|       from large pool |   2736 MiB |   9189 MiB | 468181 GiB | 468178 GiB |
|       from small pool |     89 MiB |    130 MiB |   4071 GiB |   4071 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 471618 GiB | 471615 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 467553 GiB | 467550 GiB |
|       from small pool |     89 MiB |    130 MiB |   4065 GiB |   4065 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10094 MiB |  10324 MiB |  40296 MiB |  30202 MiB |
|       from large pool |   9960 MiB |  10188 MiB |  39972 MiB |  30012 MiB |
|       from small pool |    134 MiB |    140 MiB |    324 MiB |    190 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1355 MiB |   2246 MiB | 374204 GiB | 374203 GiB |
|       from large pool |   1345 MiB |   2238 MiB | 370024 GiB | 370022 GiB |
|       from small pool |     10 MiB |     50 MiB |   4180 GiB |   4180 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   66382 K  |   66380 K  |
|       from large pool |     392    |     816    |   33333 K  |   33332 K  |
|       from small pool |    2084    |    2780    |   33049 K  |   33047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   66382 K  |   66380 K  |
|       from large pool |     392    |     816    |   33333 K  |   33332 K  |
|       from small pool |    2084    |    2780    |   33049 K  |   33047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     267    |     335    |    1011    |     744    |
|       from large pool |     200    |     267    |     849    |     649    |
|       from small pool |      67    |      70    |     162    |      95    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     172    |     340    |   35536 K  |   35536 K  |
|       from large pool |      88    |     257    |   19365 K  |   19365 K  |
|       from small pool |      84    |     239    |   16170 K  |   16170 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 472252 GiB | 472252 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 468181 GiB | 468181 GiB |
|       from small pool |      0 KiB |    130 MiB |   4071 GiB |   4071 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 472252 GiB | 472252 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 468181 GiB | 468181 GiB |
|       from small pool |      0 KiB |    130 MiB |   4071 GiB |   4071 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 471618 GiB | 471618 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 467553 GiB | 467553 GiB |
|       from small pool |      0 KiB |    130 MiB |   4065 GiB |   4065 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4182 MiB |  10324 MiB |  40296 MiB |  36114 MiB |
|       from large pool |   4082 MiB |  10188 MiB |  39972 MiB |  35890 MiB |
|       from small pool |    100 MiB |    140 MiB |    324 MiB |    224 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 374205 GiB | 374205 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 370025 GiB | 370025 GiB |
|       from small pool |      0 KiB |     50 MiB |   4180 GiB |   4180 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   66382 K  |   66382 K  |
|       from large pool |       2    |     816    |   33333 K  |   33333 K  |
|       from small pool |       0    |    2780    |   33049 K  |   33049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   66382 K  |   66382 K  |
|       from large pool |       2    |     816    |   33333 K  |   33333 K  |
|       from small pool |       0    |    2780    |   33049 K  |   33049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     335    |    1011    |     876    |
|       from large pool |      85    |     267    |     849    |     764    |
|       from small pool |      50    |      70    |     162    |     112    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   35537 K  |   35537 K  |
|       from large pool |       3    |     257    |   19365 K  |   19365 K  |
|       from small pool |       0    |     239    |   16171 K  |   16171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9264 MiB | 472252 GiB | 472252 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 468181 GiB | 468181 GiB |
|       from small pool |      0 KiB |    130 MiB |   4071 GiB |   4071 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9264 MiB | 472252 GiB | 472252 GiB |
|       from large pool |  16640 KiB |   9189 MiB | 468181 GiB | 468181 GiB |
|       from small pool |      0 KiB |    130 MiB |   4071 GiB |   4071 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 471618 GiB | 471618 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 467553 GiB | 467553 GiB |
|       from small pool |      0 KiB |    130 MiB |   4065 GiB |   4065 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4182 MiB |  10324 MiB |  40296 MiB |  36114 MiB |
|       from large pool |   4082 MiB |  10188 MiB |  39972 MiB |  35890 MiB |
|       from small pool |    100 MiB |    140 MiB |    324 MiB |    224 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 374205 GiB | 374205 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 370025 GiB | 370025 GiB |
|       from small pool |      0 KiB |     50 MiB |   4180 GiB |   4180 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   66382 K  |   66382 K  |
|       from large pool |       2    |     816    |   33333 K  |   33333 K  |
|       from small pool |       0    |    2780    |   33049 K  |   33049 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   66382 K  |   66382 K  |
|       from large pool |       2    |     816    |   33333 K  |   33333 K  |
|       from small pool |       0    |    2780    |   33049 K  |   33049 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     335    |    1011    |     876    |
|       from large pool |      85    |     267    |     849    |     764    |
|       from small pool |      50    |      70    |     162    |     112    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   35537 K  |   35537 K  |
|       from large pool |       3    |     257    |   19365 K  |   19365 K  |
|       from small pool |       0    |     239    |   16171 K  |   16171 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734

 Experiment start at: 2024-07-26 04:31:56.530215
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9589844, 'precision': 0.96111107, 'recall': 0.95935977, 'specificity': 0.95935977, 'f1': 0.9589565, 'auroc': 0.99247825, 'binary_precision': 0.9951389, 'binary_recall': 0.92332476, 'binary_specificity': 0.99539477, 'binary_f1_score': 0.95788765}
confusion matrix:
      0     1
0  1513     7
1   119  1433
---- Validation: 
scalar performance:
{'acc': 0.74163425, 'precision': 0.78833234, 'recall': 0.7402153, 'specificity': 0.7402153, 'f1': 0.7299764, 'auroc': 0.8755045, 'binary_precision': 0.9026316, 'binary_recall': 0.53761756, 'binary_specificity': 0.942813, 'binary_f1_score': 0.6738703}
confusion matrix:
     0    1
0  610   37
1  295  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7342342, 'precision': 0.7540493, 'recall': 0.7342342, 'specificity': 0.7342342, 'f1': 0.728949, 'auroc': 0.8558153, 'binary_precision': 0.825, 'binary_recall': 0.5945946, 'binary_specificity': 0.8738739, 'binary_f1_score': 0.6910995}
confusion matrix:
     0    1
0  194   28
1   90  132
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:33:44.898946,epoch time: 0:01:48.368731,used: 0:01:48.368731,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96158856, 'precision': 0.9637876, 'recall': 0.9619946, 'specificity': 0.9619946, 'f1': 0.9615625, 'auroc': 0.99584913, 'binary_precision': 0.99861014, 'binary_recall': 0.92530584, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9605615}
confusion matrix:
      0     1
0  1517     2
1   116  1437
---- Validation: 
scalar performance:
{'acc': 0.7081712, 'precision': 0.7668338, 'recall': 0.7065162, 'specificity': 0.7065162, 'f1': 0.6901374, 'auroc': 0.8625729, 'binary_precision': 0.8902077, 'binary_recall': 0.47021943, 'binary_specificity': 0.942813, 'binary_f1_score': 0.6153846}
confusion matrix:
     0    1
0  610   37
1  338  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7927928, 'precision': 0.8142421, 'recall': 0.7927928, 'specificity': 0.7927928, 'f1': 0.78919554, 'auroc': 0.87699866, 'binary_precision': 0.89634144, 'binary_recall': 0.6621622, 'binary_specificity': 0.9234234, 'binary_f1_score': 0.761658}
confusion matrix:
     0    1
0  205   17
1   75  147
new oracle model saved
early stop counter: 1
val acc:0.7081711888313293, best validation acc: 0.7416342496871948, corresponding to test acc:                         0.7342342138290405 / 0.792792797088623
after epoch: 2,now: 2024-07-26 04:35:32.051049,epoch time: 0:01:47.152103,used: 0:03:35.520834,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9498698, 'precision': 0.95380783, 'recall': 0.95047426, 'specificity': 0.95047426, 'f1': 0.9498007, 'auroc': 0.9954593, 'binary_precision': 0.99928725, 'binary_recall': 0.9016077, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.94793785}
confusion matrix:
      0     1
0  1516     1
1   153  1402
---- Validation: 
scalar performance:
{'acc': 0.67937744, 'precision': 0.78107953, 'recall': 0.6772577, 'specificity': 0.6772577, 'f1': 0.6459203, 'auroc': 0.8797052, 'binary_precision': 0.9484127, 'binary_recall': 0.37460816, 'binary_specificity': 0.9799073, 'binary_f1_score': 0.5370786}
confusion matrix:
     0    1
0  634   13
1  399  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7635135, 'precision': 0.8196013, 'recall': 0.76351357, 'specificity': 0.76351357, 'f1': 0.75266206, 'auroc': 0.89688337, 'binary_precision': 0.95348835, 'binary_recall': 0.5540541, 'binary_specificity': 0.972973, 'binary_f1_score': 0.7008548}
confusion matrix:
     0    1
0  216    6
1   99  123
early stop counter: 2
val acc:0.6793774366378784, best validation acc: 0.7416342496871948, corresponding to test acc:                         0.7342342138290405 / 0.792792797088623
after epoch: 3,now: 2024-07-26 04:37:18.670948,epoch time: 0:01:46.619899,used: 0:05:22.140733,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.960612, 'precision': 0.9629562, 'recall': 0.9610045, 'specificity': 0.9610045, 'f1': 0.9605818, 'auroc': 0.9978899, 'binary_precision': 0.99860626, 'binary_recall': 0.92332476, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.95949113}
confusion matrix:
      0     1
0  1518     2
1   119  1433
---- Validation: 
scalar performance:
{'acc': 0.7922179, 'precision': 0.81956303, 'recall': 0.7911884, 'specificity': 0.7911884, 'f1': 0.7872687, 'auroc': 0.9008784, 'binary_precision': 0.9113082, 'binary_recall': 0.6442006, 'binary_specificity': 0.9381762, 'binary_f1_score': 0.75482094}
confusion matrix:
     0    1
0  607   40
1  227  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7905405, 'precision': 0.81598806, 'recall': 0.7905405, 'specificity': 0.7905405, 'f1': 0.78623676, 'auroc': 0.89089763, 'binary_precision': 0.9056604, 'binary_recall': 0.6486486, 'binary_specificity': 0.9324324, 'binary_f1_score': 0.7559055}
confusion matrix:
     0    1
0  207   15
1   78  144
better model found
persisted
after epoch: 4,now: 2024-07-26 04:39:05.587786,epoch time: 0:01:46.916838,used: 0:07:09.057571,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97734046, 'recall': 0.977355, 'specificity': 0.977355, 'f1': 0.97721356, 'auroc': 0.9982102, 'binary_precision': 0.98880845, 'binary_recall': 0.9659164, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9772284}
confusion matrix:
      0     1
0  1500    17
1    53  1502
---- Validation: 
scalar performance:
{'acc': 0.79066145, 'precision': 0.7941098, 'recall': 0.7902751, 'specificity': 0.7902751, 'f1': 0.7898873, 'auroc': 0.8545057, 'binary_precision': 0.8242531, 'binary_recall': 0.73510975, 'binary_specificity': 0.8454405, 'binary_f1_score': 0.7771334}
confusion matrix:
     0    1
0  547  100
1  169  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108108, 'precision': 0.8429915, 'recall': 0.8108108, 'specificity': 0.8108108, 'f1': 0.80626667, 'auroc': 0.9003328, 'binary_precision': 0.9480519, 'binary_recall': 0.6576577, 'binary_specificity': 0.963964, 'binary_f1_score': 0.7765958}
confusion matrix:
     0    1
0  214    8
1   76  146
new oracle model saved
early stop counter: 1
val acc:0.7906614542007446, best validation acc: 0.7922179102897644, corresponding to test acc:                         0.7905405163764954 / 0.8108108043670654
after epoch: 5,now: 2024-07-26 04:40:53.036486,epoch time: 0:01:47.448700,used: 0:08:56.506271,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.9498673, 'recall': 0.9494201, 'specificity': 0.9494201, 'f1': 0.9495203, 'auroc': 0.9929658, 'binary_precision': 0.94013864, 'binary_recall': 0.9613402, 'binary_specificity': 0.9375, 'binary_f1_score': 0.95062125}
confusion matrix:
      0     1
0  1425    95
1    60  1492
---- Validation: 
scalar performance:
{'acc': 0.6319066, 'precision': 0.63381016, 'recall': 0.6314471, 'specificity': 0.6314471, 'f1': 0.630092, 'auroc': 0.679369, 'binary_precision': 0.6481149, 'binary_recall': 0.5658307, 'binary_specificity': 0.6970634, 'binary_f1_score': 0.6041841}
confusion matrix:
     0    1
0  451  196
1  277  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162162, 'precision': 0.7449205, 'recall': 0.7162162, 'specificity': 0.7162162, 'f1': 0.7076504, 'auroc': 0.786381, 'binary_precision': 0.6610738, 'binary_recall': 0.8873874, 'binary_specificity': 0.545045, 'binary_f1_score': 0.7576923}
confusion matrix:
     0    1
0  121  101
1   25  197
early stop counter: 2
val acc:0.6319066286087036, best validation acc: 0.7922179102897644, corresponding to test acc:                         0.7905405163764954 / 0.8108108043670654
after epoch: 6,now: 2024-07-26 04:42:39.216557,epoch time: 0:01:46.180071,used: 0:10:42.686342,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9781803, 'recall': 0.97819793, 'specificity': 0.97819793, 'f1': 0.97818816, 'auroc': 0.997886, 'binary_precision': 0.9793415, 'binary_recall': 0.97744846, 'binary_specificity': 0.97894734, 'binary_f1_score': 0.97839403}
confusion matrix:
      0     1
0  1488    32
1    35  1517
---- Validation: 
scalar performance:
{'acc': 0.8326848, 'precision': 0.848346, 'recall': 0.83194077, 'specificity': 0.83194077, 'f1': 0.830557, 'auroc': 0.9147694, 'binary_precision': 0.92047715, 'binary_recall': 0.7257053, 'binary_specificity': 0.9381762, 'binary_f1_score': 0.81156874}
confusion matrix:
     0    1
0  607   40
1  175  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7072072, 'precision': 0.8103951, 'recall': 0.7072072, 'specificity': 0.7072072, 'f1': 0.68066746, 'auroc': 0.91098535, 'binary_precision': 0.9893617, 'binary_recall': 0.4189189, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5886076}
confusion matrix:
     0   1
0  221   1
1  129  93
better model found
persisted
after epoch: 7,now: 2024-07-26 04:44:25.973970,epoch time: 0:01:46.757413,used: 0:12:29.443755,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9822132, 'recall': 0.982029, 'specificity': 0.982029, 'f1': 0.982091, 'auroc': 0.9986329, 'binary_precision': 0.97708464, 'binary_recall': 0.9877735, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.98240006}
confusion matrix:
      0     1
0  1482    36
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.76575875, 'precision': 0.792302, 'recall': 0.7646953, 'specificity': 0.7646953, 'f1': 0.7598237, 'auroc': 0.8457821, 'binary_precision': 0.8786517, 'binary_recall': 0.6128527, 'binary_specificity': 0.9165379, 'binary_f1_score': 0.7220683}
confusion matrix:
     0    1
0  593   54
1  247  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7454955, 'precision': 0.79003954, 'recall': 0.74549544, 'specificity': 0.74549544, 'f1': 0.7353337, 'auroc': 0.8351595, 'binary_precision': 0.9037037, 'binary_recall': 0.5495495, 'binary_specificity': 0.9414414, 'binary_f1_score': 0.68347335}
confusion matrix:
     0    1
0  209   13
1  100  122
early stop counter: 1
val acc:0.765758752822876, best validation acc: 0.8326848149299622, corresponding to test acc:                         0.707207202911377 / 0.8108108043670654
after epoch: 8,now: 2024-07-26 04:46:11.965544,epoch time: 0:01:45.991574,used: 0:14:15.435329,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893258, 'recall': 0.98934263, 'specificity': 0.98934263, 'f1': 0.9892578, 'auroc': 0.9995698, 'binary_precision': 0.9980315, 'binary_recall': 0.98065764, 'binary_specificity': 0.9980276, 'binary_f1_score': 0.9892683}
confusion matrix:
      0     1
0  1518     3
1    30  1521
---- Validation: 
scalar performance:
{'acc': 0.67003894, 'precision': 0.7816772, 'recall': 0.6678206, 'specificity': 0.6678206, 'f1': 0.632028, 'auroc': 0.9020606, 'binary_precision': 0.95726496, 'binary_recall': 0.35109717, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.51376146}
confusion matrix:
     0    1
0  637   10
1  414  224
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6576577, 'precision': 0.7778175, 'recall': 0.6576577, 'specificity': 0.6576577, 'f1': 0.6161529, 'auroc': 0.8851352, 'binary_precision': 0.9605263, 'binary_recall': 0.32882884, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.48993286}
confusion matrix:
     0   1
0  219   3
1  149  73
early stop counter: 2
val acc:0.6700389385223389, best validation acc: 0.8326848149299622, corresponding to test acc:                         0.707207202911377 / 0.8108108043670654
after epoch: 9,now: 2024-07-26 04:47:58.286746,epoch time: 0:01:46.321202,used: 0:16:01.756531,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98827785, 'recall': 0.98833746, 'specificity': 0.98833746, 'f1': 0.98828083, 'auroc': 0.9992595, 'binary_precision': 0.9934938, 'binary_recall': 0.9832582, 'binary_specificity': 0.9934167, 'binary_f1_score': 0.98834944}
confusion matrix:
      0     1
0  1509    10
1    26  1527
---- Validation: 
scalar performance:
{'acc': 0.70350194, 'precision': 0.7785129, 'recall': 0.7016723, 'specificity': 0.7016723, 'f1': 0.6808985, 'auroc': 0.87541246, 'binary_precision': 0.9213115, 'binary_recall': 0.44043887, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.5959703}
confusion matrix:
     0    1
0  623   24
1  357  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.704955, 'precision': 0.80009806, 'recall': 0.704955, 'specificity': 0.704955, 'f1': 0.6795566, 'auroc': 0.908733, 'binary_precision': 0.96907216, 'binary_recall': 0.4234234, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.5893417}
confusion matrix:
     0   1
0  219   3
1  128  94
early stop counter: 3
val acc:0.7035019397735596, best validation acc: 0.8326848149299622, corresponding to test acc:                         0.707207202911377 / 0.8108108043670654
after epoch: 10,now: 2024-07-26 04:49:44.757848,epoch time: 0:01:46.471102,used: 0:17:48.227633,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97786164, 'recall': 0.977907, 'specificity': 0.977907, 'f1': 0.977864, 'auroc': 0.9980844, 'binary_precision': 0.9824333, 'binary_recall': 0.97356546, 'binary_specificity': 0.98224854, 'binary_f1_score': 0.9779793}
confusion matrix:
      0     1
0  1494    27
1    41  1510
---- Validation: 
scalar performance:
{'acc': 0.8178988, 'precision': 0.81959796, 'recall': 0.8176391, 'specificity': 0.8176391, 'f1': 0.8175646, 'auroc': 0.874722, 'binary_precision': 0.8412162, 'binary_recall': 0.78056425, 'binary_specificity': 0.85471404, 'binary_f1_score': 0.8097561}
confusion matrix:
     0    1
0  553   94
1  140  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.83077127, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82602495, 'auroc': 0.88953817, 'binary_precision': 0.8680203, 'binary_recall': 0.7702703, 'binary_specificity': 0.8828829, 'binary_f1_score': 0.81622905}
confusion matrix:
     0    1
0  196   26
1   51  171
new oracle model saved
early stop counter: 4
val acc:0.8178988099098206, best validation acc: 0.8326848149299622, corresponding to test acc:                         0.707207202911377 / 0.8265765905380249
after epoch: 11,now: 2024-07-26 04:51:32.206006,epoch time: 0:01:47.448158,used: 0:19:35.675791,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98513293, 'recall': 0.98513293, 'specificity': 0.98513293, 'f1': 0.9850261, 'auroc': 0.99897414, 'binary_precision': 0.99539477, 'binary_recall': 0.97487116, 'binary_specificity': 0.99539477, 'binary_f1_score': 0.9850261}
confusion matrix:
      0     1
0  1513     7
1    39  1513
---- Validation: 
scalar performance:
{'acc': 0.82101166, 'precision': 0.8449354, 'recall': 0.8200872, 'specificity': 0.8200872, 'f1': 0.81754994, 'auroc': 0.91378343, 'binary_precision': 0.9340426, 'binary_recall': 0.68808776, 'binary_specificity': 0.95208657, 'binary_f1_score': 0.7924187}
confusion matrix:
     0    1
0  616   31
1  199  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.8818327, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.84579414, 'auroc': 0.9414009, 'binary_precision': 0.9936306, 'binary_recall': 0.7027027, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.82321894}
confusion matrix:
     0    1
0  221    1
1   66  156
new oracle model saved
early stop counter: 5
val acc:0.8210116624832153, best validation acc: 0.8326848149299622, corresponding to test acc:                         0.707207202911377 / 0.8490990996360779
after epoch: 12,now: 2024-07-26 04:53:19.603253,epoch time: 0:01:47.397247,used: 0:21:23.073038,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_31_56_seed_6_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:21:23.073038 at 2024-07-26 04:53:19.603253
persisted model performance metric: 

scalar performance:
{'acc': 0.7072072, 'precision': 0.8103951, 'recall': 0.7072072, 'specificity': 0.7072072, 'f1': 0.68066746, 'auroc': 0.91098535, 'binary_precision': 0.9893617, 'binary_recall': 0.4189189, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5886076}
confusion matrix:
     0   1
0  221   1
1  129  93
oracle model performance metric: 

scalar performance:
{'acc': 0.8490991, 'precision': 0.8818327, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.84579414, 'auroc': 0.9414009, 'binary_precision': 0.9936306, 'binary_recall': 0.7027027, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.82321894}
confusion matrix:
     0    1
0  221    1
1   66  156
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2830 MiB |   9265 MiB | 553349 GiB | 553346 GiB |
|       from large pool |   2740 MiB |   9191 MiB | 548580 GiB | 548577 GiB |
|       from small pool |     89 MiB |    130 MiB |   4769 GiB |   4768 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2830 MiB |   9265 MiB | 553349 GiB | 553346 GiB |
|       from large pool |   2740 MiB |   9191 MiB | 548580 GiB | 548577 GiB |
|       from small pool |     89 MiB |    130 MiB |   4769 GiB |   4768 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 552571 GiB | 552568 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 547809 GiB | 547806 GiB |
|       from small pool |     89 MiB |    130 MiB |   4761 GiB |   4761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10088 MiB |  10324 MiB |  46202 MiB |  36114 MiB |
|       from large pool |   9954 MiB |  10188 MiB |  45844 MiB |  35890 MiB |
|       from small pool |    134 MiB |    140 MiB |    358 MiB |    224 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1197 MiB |   2246 MiB | 440813 GiB | 440811 GiB |
|       from large pool |   1189 MiB |   2238 MiB | 435915 GiB | 435914 GiB |
|       from small pool |      8 MiB |     50 MiB |   4897 GiB |   4897 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   77776 K  |   77773 K  |
|       from large pool |     392    |     816    |   39056 K  |   39055 K  |
|       from small pool |    2078    |    2780    |   38719 K  |   38717 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   77776 K  |   77773 K  |
|       from large pool |     392    |     816    |   39056 K  |   39055 K  |
|       from small pool |    2078    |    2780    |   38719 K  |   38717 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     335    |    1141    |     876    |
|       from large pool |     198    |     267    |     962    |     764    |
|       from small pool |      67    |      70    |     179    |     112    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     156    |     340    |   41402 K  |   41402 K  |
|       from large pool |      81    |     257    |   22466 K  |   22466 K  |
|       from small pool |      75    |     239    |   18936 K  |   18936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 553349 GiB | 553349 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 548580 GiB | 548580 GiB |
|       from small pool |      0 KiB |    130 MiB |   4769 GiB |   4769 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 553349 GiB | 553349 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 548580 GiB | 548580 GiB |
|       from small pool |      0 KiB |    130 MiB |   4769 GiB |   4769 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 552571 GiB | 552571 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 547809 GiB | 547809 GiB |
|       from small pool |      0 KiB |    130 MiB |   4761 GiB |   4761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4028 MiB |  10324 MiB |  46202 MiB |  42174 MiB |
|       from large pool |   3930 MiB |  10188 MiB |  45844 MiB |  41914 MiB |
|       from small pool |     98 MiB |    140 MiB |    358 MiB |    260 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 440814 GiB | 440814 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 435916 GiB | 435916 GiB |
|       from small pool |      0 KiB |     50 MiB |   4897 GiB |   4897 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   77776 K  |   77776 K  |
|       from large pool |       2    |     816    |   39056 K  |   39056 K  |
|       from small pool |       0    |    2780    |   38719 K  |   38719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   77776 K  |   77776 K  |
|       from large pool |       2    |     816    |   39056 K  |   39056 K  |
|       from small pool |       0    |    2780    |   38719 K  |   38719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     335    |    1141    |    1013    |
|       from large pool |      79    |     267    |     962    |     883    |
|       from small pool |      49    |      70    |     179    |     130    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   41403 K  |   41403 K  |
|       from large pool |       3    |     257    |   22466 K  |   22466 K  |
|       from small pool |       0    |     239    |   18936 K  |   18936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 553349 GiB | 553349 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 548580 GiB | 548580 GiB |
|       from small pool |      0 KiB |    130 MiB |   4769 GiB |   4769 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 553349 GiB | 553349 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 548580 GiB | 548580 GiB |
|       from small pool |      0 KiB |    130 MiB |   4769 GiB |   4769 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 552571 GiB | 552571 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 547809 GiB | 547809 GiB |
|       from small pool |      0 KiB |    130 MiB |   4761 GiB |   4761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4028 MiB |  10324 MiB |  46202 MiB |  42174 MiB |
|       from large pool |   3930 MiB |  10188 MiB |  45844 MiB |  41914 MiB |
|       from small pool |     98 MiB |    140 MiB |    358 MiB |    260 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 440814 GiB | 440814 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 435916 GiB | 435916 GiB |
|       from small pool |      0 KiB |     50 MiB |   4897 GiB |   4897 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   77776 K  |   77776 K  |
|       from large pool |       2    |     816    |   39056 K  |   39056 K  |
|       from small pool |       0    |    2780    |   38719 K  |   38719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   77776 K  |   77776 K  |
|       from large pool |       2    |     816    |   39056 K  |   39056 K  |
|       from small pool |       0    |    2780    |   38719 K  |   38719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     335    |    1141    |    1013    |
|       from large pool |      79    |     267    |     962    |     883    |
|       from small pool |      49    |      70    |     179    |     130    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   41403 K  |   41403 K  |
|       from large pool |       3    |     257    |   22466 K  |   22466 K  |
|       from small pool |       0    |     239    |   18936 K  |   18936 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734

 Experiment start at: 2024-07-26 04:53:49.673041
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.9544211, 'recall': 0.9538614, 'specificity': 0.9538614, 'f1': 0.9534445, 'auroc': 0.991977, 'binary_precision': 0.9796886, 'binary_recall': 0.9275641, 'binary_specificity': 0.98015875, 'binary_f1_score': 0.95291406}
confusion matrix:
      0     1
0  1482    30
1   113  1447
---- Validation: 
scalar performance:
{'acc': 0.81153846, 'precision': 0.815915, 'recall': 0.81242895, 'specificity': 0.81242895, 'f1': 0.8111495, 'auroc': 0.89400506, 'binary_precision': 0.77468705, 'binary_recall': 0.8703125, 'binary_specificity': 0.75454545, 'binary_f1_score': 0.81972045}
confusion matrix:
     0    1
0  498  162
1   83  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7947598, 'precision': 0.79620576, 'recall': 0.79475987, 'specificity': 0.79475987, 'f1': 0.79450905, 'auroc': 0.8968936, 'binary_precision': 0.7755102, 'binary_recall': 0.82969433, 'binary_specificity': 0.75982535, 'binary_f1_score': 0.8016878}
confusion matrix:
     0    1
0  174   55
1   39  190
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:55:39.232103,epoch time: 0:01:49.559062,used: 0:01:49.559062,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.961263, 'precision': 0.96343493, 'recall': 0.9618488, 'specificity': 0.9618488, 'f1': 0.9612434, 'auroc': 0.9976865, 'binary_precision': 0.999307, 'binary_recall': 0.92435896, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.96037287}
confusion matrix:
      0     1
0  1511     1
1   118  1442
---- Validation: 
scalar performance:
{'acc': 0.5846154, 'precision': 0.7179487, 'recall': 0.5784801, 'specificity': 0.5784801, 'f1': 0.50180966, 'auroc': 0.85697913, 'binary_precision': 0.88461536, 'binary_recall': 0.1796875, 'binary_specificity': 0.97727275, 'binary_f1_score': 0.2987013}
confusion matrix:
     0    1
0  645   15
1  525  115
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6834061, 'precision': 0.7856379, 'recall': 0.6834061, 'specificity': 0.6834061, 'f1': 0.6522945, 'auroc': 0.90282416, 'binary_precision': 0.95652175, 'binary_recall': 0.3842795, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.5482866}
confusion matrix:
     0   1
0  225   4
1  141  88
early stop counter: 1
val acc:0.5846154093742371, best validation acc: 0.8115384578704834, corresponding to test acc:                         0.7947598099708557 / 0.7947598099708557
after epoch: 2,now: 2024-07-26 04:57:25.731718,epoch time: 0:01:46.499615,used: 0:03:36.058677,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.97404826, 'recall': 0.97413516, 'specificity': 0.97413516, 'f1': 0.9739579, 'auroc': 0.99705005, 'binary_precision': 0.9855643, 'binary_recall': 0.96282053, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.9740597}
confusion matrix:
      0     1
0  1490    22
1    58  1502
---- Validation: 
scalar performance:
{'acc': 0.82384616, 'precision': 0.84351945, 'recall': 0.82199335, 'specificity': 0.82199335, 'f1': 0.82067037, 'auroc': 0.89844227, 'binary_precision': 0.92197126, 'binary_recall': 0.7015625, 'binary_specificity': 0.94242424, 'binary_f1_score': 0.79680574}
confusion matrix:
     0    1
0  622   38
1  191  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860262, 'precision': 0.8257857, 'recall': 0.7860262, 'specificity': 0.7860262, 'f1': 0.7792923, 'auroc': 0.90949833, 'binary_precision': 0.9395973, 'binary_recall': 0.6113537, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.7407407}
confusion matrix:
     0    1
0  220    9
1   89  140
better model found
persisted
after epoch: 3,now: 2024-07-26 04:59:13.268577,epoch time: 0:01:47.536859,used: 0:05:23.595536,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97621214, 'recall': 0.9761702, 'specificity': 0.9761702, 'f1': 0.9759114, 'auroc': 0.99789035, 'binary_precision': 0.9927056, 'binary_recall': 0.9596154, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.97588}
confusion matrix:
      0     1
0  1501    11
1    63  1497
---- Validation: 
scalar performance:
{'acc': 0.75769234, 'precision': 0.76115227, 'recall': 0.7567471, 'specificity': 0.7567471, 'f1': 0.7563914, 'auroc': 0.83019114, 'binary_precision': 0.7876106, 'binary_recall': 0.6953125, 'binary_specificity': 0.8181818, 'binary_f1_score': 0.7385892}
confusion matrix:
     0    1
0  540  120
1  195  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77074236, 'precision': 0.79608774, 'recall': 0.77074236, 'specificity': 0.77074236, 'f1': 0.7657289, 'auroc': 0.90387297, 'binary_precision': 0.7094595, 'binary_recall': 0.9170306, 'binary_specificity': 0.62445414, 'binary_f1_score': 0.79999995}
confusion matrix:
     0    1
0  143   86
1   19  210
early stop counter: 1
val acc:0.7576923370361328, best validation acc: 0.823846161365509, corresponding to test acc:                         0.7860261797904968 / 0.7947598099708557
after epoch: 4,now: 2024-07-26 05:00:59.460326,epoch time: 0:01:46.191749,used: 0:07:09.787285,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.96898264, 'recall': 0.9679487, 'specificity': 0.9679487, 'f1': 0.9674386, 'auroc': 0.99735755, 'binary_precision': 1.0, 'binary_recall': 0.9358974, 'binary_specificity': 1.0, 'binary_f1_score': 0.9668874}
confusion matrix:
      0     1
0  1512     0
1   100  1460
---- Validation: 
scalar performance:
{'acc': 0.66615385, 'precision': 0.76295495, 'recall': 0.661411, 'specificity': 0.661411, 'f1': 0.6284746, 'auroc': 0.86011124, 'binary_precision': 0.9186992, 'binary_recall': 0.353125, 'binary_specificity': 0.969697, 'binary_f1_score': 0.510158}
confusion matrix:
     0    1
0  640   20
1  414  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6528384, 'precision': 0.75053144, 'recall': 0.6528384, 'specificity': 0.6528384, 'f1': 0.6153395, 'auroc': 0.8743731, 'binary_precision': 0.90697676, 'binary_recall': 0.34061137, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.4952381}
confusion matrix:
     0   1
0  221   8
1  151  78
early stop counter: 2
val acc:0.6661538481712341, best validation acc: 0.823846161365509, corresponding to test acc:                         0.7860261797904968 / 0.7947598099708557
after epoch: 5,now: 2024-07-26 05:02:45.853283,epoch time: 0:01:46.392957,used: 0:08:56.180242,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9701055, 'recall': 0.9702076, 'specificity': 0.9702076, 'f1': 0.9700513, 'auroc': 0.9954594, 'binary_precision': 0.98036647, 'binary_recall': 0.9602564, 'binary_specificity': 0.98015875, 'binary_f1_score': 0.9702072}
confusion matrix:
      0     1
0  1482    30
1    62  1498
---- Validation: 
scalar performance:
{'acc': 0.77153844, 'precision': 0.7801132, 'recall': 0.7701468, 'specificity': 0.7701468, 'f1': 0.7691219, 'auroc': 0.8639749, 'binary_precision': 0.82542694, 'binary_recall': 0.6796875, 'binary_specificity': 0.8606061, 'binary_f1_score': 0.7455013}
confusion matrix:
     0    1
0  568   92
1  205  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.82452524, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.8204677, 'auroc': 0.899487, 'binary_precision': 0.8585366, 'binary_recall': 0.768559, 'binary_specificity': 0.8733624, 'binary_f1_score': 0.8110599}
confusion matrix:
     0    1
0  200   29
1   53  176
new oracle model saved
early stop counter: 3
val acc:0.7715384364128113, best validation acc: 0.823846161365509, corresponding to test acc:                         0.7860261797904968 / 0.8209607005119324
after epoch: 6,now: 2024-07-26 05:04:32.782309,epoch time: 0:01:46.929026,used: 0:10:43.109268,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.972155, 'recall': 0.9695767, 'specificity': 0.9695767, 'f1': 0.9699898, 'auroc': 0.99973166, 'binary_precision': 0.94430995, 'binary_recall': 1.0, 'binary_specificity': 0.93915343, 'binary_f1_score': 0.9713574}
confusion matrix:
      0     1
0  1420    92
1     0  1560
---- Validation: 
scalar performance:
{'acc': 0.81076926, 'precision': 0.81678116, 'recall': 0.8118135, 'specificity': 0.8118135, 'f1': 0.810187, 'auroc': 0.88758755, 'binary_precision': 0.7691257, 'binary_recall': 0.8796875, 'binary_specificity': 0.7439394, 'binary_f1_score': 0.8206997}
confusion matrix:
     0    1
0  491  169
1   77  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231441, 'precision': 0.8299969, 'recall': 0.8231441, 'specificity': 0.8231441, 'f1': 0.8222211, 'auroc': 0.9186133, 'binary_precision': 0.78244275, 'binary_recall': 0.8951965, 'binary_specificity': 0.7510917, 'binary_f1_score': 0.8350305}
confusion matrix:
     0    1
0  172   57
1   24  205
new oracle model saved
early stop counter: 4
val acc:0.810769259929657, best validation acc: 0.823846161365509, corresponding to test acc:                         0.7860261797904968 / 0.8231440782546997
after epoch: 7,now: 2024-07-26 05:06:20.095878,epoch time: 0:01:47.313569,used: 0:12:30.422837,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9780228, 'recall': 0.9773352, 'specificity': 0.9773352, 'f1': 0.97752106, 'auroc': 0.99862, 'binary_precision': 0.9662289, 'binary_recall': 0.99038464, 'binary_specificity': 0.96428573, 'binary_f1_score': 0.97815764}
confusion matrix:
      0     1
0  1458    54
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.83153844, 'precision': 0.8506378, 'recall': 0.8297348, 'specificity': 0.8297348, 'f1': 0.8286425, 'auroc': 0.9040412, 'binary_precision': 0.9287169, 'binary_recall': 0.7125, 'binary_specificity': 0.9469697, 'binary_f1_score': 0.80636597}
confusion matrix:
     0    1
0  625   35
1  184  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8209607, 'precision': 0.8583839, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.8161615, 'auroc': 0.9100132, 'binary_precision': 0.9741936, 'binary_recall': 0.65938866, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.7864584}
confusion matrix:
     0    1
0  225    4
1   78  151
better model found
persisted
after epoch: 8,now: 2024-07-26 05:08:07.012656,epoch time: 0:01:46.916778,used: 0:14:17.339615,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98445797, 'recall': 0.98431015, 'specificity': 0.98431015, 'f1': 0.98436904, 'auroc': 0.99836266, 'binary_precision': 0.980916, 'binary_recall': 0.98846155, 'binary_specificity': 0.98015875, 'binary_f1_score': 0.98467433}
confusion matrix:
      0     1
0  1482    30
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.76692307, 'precision': 0.7790958, 'recall': 0.7652699, 'specificity': 0.7652699, 'f1': 0.76356184, 'auroc': 0.8520395, 'binary_precision': 0.83366334, 'binary_recall': 0.6578125, 'binary_specificity': 0.8727273, 'binary_f1_score': 0.7353712}
confusion matrix:
     0    1
0  576   84
1  219  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.84337515, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.83539, 'auroc': 0.9060277, 'binary_precision': 0.89285713, 'binary_recall': 0.76419216, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.82352936}
confusion matrix:
     0    1
0  208   21
1   54  175
new oracle model saved
early stop counter: 1
val acc:0.7669230699539185, best validation acc: 0.8315384387969971, corresponding to test acc:                         0.8209607005119324 / 0.836244523525238
after epoch: 9,now: 2024-07-26 05:09:54.305446,epoch time: 0:01:47.292790,used: 0:16:04.632405,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98890215, 'recall': 0.9890008, 'specificity': 0.9890008, 'f1': 0.98893094, 'auroc': 0.9993106, 'binary_precision': 0.9935317, 'binary_recall': 0.9846154, 'binary_specificity': 0.99338627, 'binary_f1_score': 0.9890535}
confusion matrix:
      0     1
0  1502    10
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.8076923, 'precision': 0.8339803, 'recall': 0.8055161, 'specificity': 0.8055161, 'f1': 0.8030303, 'auroc': 0.90808475, 'binary_precision': 0.92391306, 'binary_recall': 0.6640625, 'binary_specificity': 0.9469697, 'binary_f1_score': 0.7727273}
confusion matrix:
     0    1
0  625   35
1  215  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8799127, 'precision': 0.8889995, 'recall': 0.8799126, 'specificity': 0.8799126, 'f1': 0.87920725, 'auroc': 0.93587077, 'binary_precision': 0.9484536, 'binary_recall': 0.80349344, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.86997634}
confusion matrix:
     0    1
0  219   10
1   45  184
new oracle model saved
early stop counter: 2
val acc:0.807692289352417, best validation acc: 0.8315384387969971, corresponding to test acc:                         0.8209607005119324 / 0.8799126744270325
after epoch: 10,now: 2024-07-26 05:11:41.746639,epoch time: 0:01:47.441193,used: 0:17:52.073598,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9791595, 'recall': 0.9791056, 'specificity': 0.9791056, 'f1': 0.97884107, 'auroc': 0.99811804, 'binary_precision': 0.9960186, 'binary_recall': 0.9621795, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.9788066}
confusion matrix:
      0     1
0  1506     6
1    59  1501
---- Validation: 
scalar performance:
{'acc': 0.8069231, 'precision': 0.8179183, 'recall': 0.80546874, 'specificity': 0.80546874, 'f1': 0.8046901, 'auroc': 0.8807428, 'binary_precision': 0.8733205, 'binary_recall': 0.7109375, 'binary_specificity': 0.9, 'binary_f1_score': 0.78380704}
confusion matrix:
     0    1
0  594   66
1  185  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81877726, 'precision': 0.82933414, 'recall': 0.8187773, 'specificity': 0.8187773, 'f1': 0.8173133, 'auroc': 0.89878154, 'binary_precision': 0.88829786, 'binary_recall': 0.72925764, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.8009592}
confusion matrix:
     0    1
0  208   21
1   62  167
early stop counter: 3
val acc:0.8069230914115906, best validation acc: 0.8315384387969971, corresponding to test acc:                         0.8209607005119324 / 0.8799126744270325
after epoch: 11,now: 2024-07-26 05:13:27.987377,epoch time: 0:01:46.240738,used: 0:19:38.314336,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98742056, 'recall': 0.9872253, 'specificity': 0.9872253, 'f1': 0.9872993, 'auroc': 0.9993908, 'binary_precision': 0.98285717, 'binary_recall': 0.99230766, 'binary_specificity': 0.98214287, 'binary_f1_score': 0.98755974}
confusion matrix:
      0     1
0  1485    27
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.72692305, 'precision': 0.7611215, 'recall': 0.72407675, 'specificity': 0.72407675, 'f1': 0.7159956, 'auroc': 0.84389913, 'binary_precision': 0.8518519, 'binary_recall': 0.5390625, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.660287}
confusion matrix:
     0    1
0  600   60
1  295  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88646287, 'precision': 0.8864924, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8864608, 'auroc': 0.9463968, 'binary_precision': 0.88986784, 'binary_recall': 0.88209605, 'binary_specificity': 0.8908297, 'binary_f1_score': 0.88596493}
confusion matrix:
     0    1
0  204   25
1   27  202
new oracle model saved
early stop counter: 4
val acc:0.7269230484962463, best validation acc: 0.8315384387969971, corresponding to test acc:                         0.8209607005119324 / 0.8864628672599792
after epoch: 12,now: 2024-07-26 05:15:15.956644,epoch time: 0:01:47.969267,used: 0:21:26.283603,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870908, 'recall': 0.9871693, 'specificity': 0.9871693, 'f1': 0.986979, 'auroc': 0.9997363, 'binary_precision': 0.999343, 'binary_recall': 0.975, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.98702145}
confusion matrix:
      0     1
0  1511     1
1    39  1521
---- Validation: 
scalar performance:
{'acc': 0.75461537, 'precision': 0.8071108, 'recall': 0.7513968, 'specificity': 0.7513968, 'f1': 0.74204284, 'auroc': 0.89687026, 'binary_precision': 0.93029493, 'binary_recall': 0.5421875, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.6850938}
confusion matrix:
     0    1
0  634   26
1  293  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122271, 'precision': 0.84242004, 'recall': 0.8122271, 'specificity': 0.8122271, 'f1': 0.80799454, 'auroc': 0.9071337, 'binary_precision': 0.94409937, 'binary_recall': 0.6637555, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.7794872}
confusion matrix:
     0    1
0  220    9
1   77  152
early stop counter: 5
val acc:0.7546153664588928, best validation acc: 0.8315384387969971, corresponding to test acc:                         0.8209607005119324 / 0.8864628672599792
after epoch: 13,now: 2024-07-26 05:17:02.152488,epoch time: 0:01:46.195844,used: 0:23:12.479447,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_49_seed_7_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:23:12.479447 at 2024-07-26 05:17:02.152488
persisted model performance metric: 

scalar performance:
{'acc': 0.8209607, 'precision': 0.8583839, 'recall': 0.8209607, 'specificity': 0.8209607, 'f1': 0.8161615, 'auroc': 0.9100132, 'binary_precision': 0.9741936, 'binary_recall': 0.65938866, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.7864584}
confusion matrix:
     0    1
0  225    4
1   78  151
oracle model performance metric: 

scalar performance:
{'acc': 0.88646287, 'precision': 0.8864924, 'recall': 0.88646287, 'specificity': 0.88646287, 'f1': 0.8864608, 'auroc': 0.9463968, 'binary_precision': 0.88986784, 'binary_recall': 0.88209605, 'binary_specificity': 0.8908297, 'binary_f1_score': 0.88596493}
confusion matrix:
     0    1
0  204   25
1   27  202
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2830 MiB |   9265 MiB | 641182 GiB | 641180 GiB |
|       from large pool |   2740 MiB |   9191 MiB | 635656 GiB | 635654 GiB |
|       from small pool |     89 MiB |    130 MiB |   5526 GiB |   5526 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2830 MiB |   9265 MiB | 641182 GiB | 641180 GiB |
|       from large pool |   2740 MiB |   9191 MiB | 635656 GiB | 635654 GiB |
|       from small pool |     89 MiB |    130 MiB |   5526 GiB |   5526 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 640320 GiB | 640317 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 634802 GiB | 634799 GiB |
|       from small pool |     89 MiB |    130 MiB |   5517 GiB |   5517 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10080 MiB |  10324 MiB |  52254 MiB |  42174 MiB |
|       from large pool |   9946 MiB |  10188 MiB |  51860 MiB |  41914 MiB |
|       from small pool |    134 MiB |    140 MiB |    394 MiB |    260 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1067 MiB |   2246 MiB | 510524 GiB | 510523 GiB |
|       from large pool |   1059 MiB |   2238 MiB | 504850 GiB | 504849 GiB |
|       from small pool |      8 MiB |     50 MiB |   5674 GiB |   5674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   90134 K  |   90131 K  |
|       from large pool |     392    |     816    |   45261 K  |   45260 K  |
|       from small pool |    2084    |    2780    |   44872 K  |   44870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   90134 K  |   90131 K  |
|       from large pool |     392    |     816    |   45261 K  |   45260 K  |
|       from small pool |    2084    |    2780    |   44872 K  |   44870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     265    |     335    |    1278    |    1013    |
|       from large pool |     198    |     267    |    1081    |     883    |
|       from small pool |      67    |      70    |     197    |     130    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     154    |     340    |   47899 K  |   47899 K  |
|       from large pool |      78    |     257    |   25952 K  |   25952 K  |
|       from small pool |      76    |     239    |   21947 K  |   21947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 641182 GiB | 641182 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 635656 GiB | 635656 GiB |
|       from small pool |      0 KiB |    130 MiB |   5526 GiB |   5526 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 641182 GiB | 641182 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 635656 GiB | 635656 GiB |
|       from small pool |      0 KiB |    130 MiB |   5526 GiB |   5526 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 640320 GiB | 640320 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 634802 GiB | 634802 GiB |
|       from small pool |      0 KiB |    130 MiB |   5517 GiB |   5517 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3898 MiB |  10324 MiB |  52254 MiB |  48356 MiB |
|       from large pool |   3800 MiB |  10188 MiB |  51860 MiB |  48060 MiB |
|       from small pool |     98 MiB |    140 MiB |    394 MiB |    296 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 510525 GiB | 510525 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 504851 GiB | 504851 GiB |
|       from small pool |      0 KiB |     50 MiB |   5674 GiB |   5674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   90134 K  |   90134 K  |
|       from large pool |       2    |     816    |   45261 K  |   45261 K  |
|       from small pool |       0    |    2780    |   44872 K  |   44872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   90134 K  |   90134 K  |
|       from large pool |       2    |     816    |   45261 K  |   45261 K  |
|       from small pool |       0    |    2780    |   44872 K  |   44872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     335    |    1278    |    1152    |
|       from large pool |      77    |     267    |    1081    |    1004    |
|       from small pool |      49    |      70    |     197    |     148    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   47900 K  |   47900 K  |
|       from large pool |       3    |     257    |   25952 K  |   25952 K  |
|       from small pool |       0    |     239    |   21947 K  |   21947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 641182 GiB | 641182 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 635656 GiB | 635656 GiB |
|       from small pool |      0 KiB |    130 MiB |   5526 GiB |   5526 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 641182 GiB | 641182 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 635656 GiB | 635656 GiB |
|       from small pool |      0 KiB |    130 MiB |   5526 GiB |   5526 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 640320 GiB | 640320 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 634802 GiB | 634802 GiB |
|       from small pool |      0 KiB |    130 MiB |   5517 GiB |   5517 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3898 MiB |  10324 MiB |  52254 MiB |  48356 MiB |
|       from large pool |   3800 MiB |  10188 MiB |  51860 MiB |  48060 MiB |
|       from small pool |     98 MiB |    140 MiB |    394 MiB |    296 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 510525 GiB | 510525 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 504851 GiB | 504851 GiB |
|       from small pool |      0 KiB |     50 MiB |   5674 GiB |   5674 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   90134 K  |   90134 K  |
|       from large pool |       2    |     816    |   45261 K  |   45261 K  |
|       from small pool |       0    |    2780    |   44872 K  |   44872 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   90134 K  |   90134 K  |
|       from large pool |       2    |     816    |   45261 K  |   45261 K  |
|       from small pool |       0    |    2780    |   44872 K  |   44872 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     335    |    1278    |    1152    |
|       from large pool |      77    |     267    |    1081    |    1004    |
|       from small pool |      49    |      70    |     197    |     148    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   47900 K  |   47900 K  |
|       from large pool |       3    |     257    |   25952 K  |   25952 K  |
|       from small pool |       0    |     239    |   21947 K  |   21947 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734

 Experiment start at: 2024-07-26 05:17:31.868367
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94276315, 'precision': 0.9470128, 'recall': 0.94333005, 'specificity': 0.94333005, 'f1': 0.9426708, 'auroc': 0.9931691, 'binary_precision': 0.993483, 'binary_recall': 0.89264804, 'binary_specificity': 0.994012, 'binary_f1_score': 0.94037014}
confusion matrix:
      0     1
0  1494     9
1   165  1372
---- Validation: 
scalar performance:
{'acc': 0.78344935, 'precision': 0.78445673, 'recall': 0.78224945, 'specificity': 0.78224945, 'f1': 0.7825961, 'auroc': 0.86484236, 'binary_precision': 0.79522187, 'binary_recall': 0.74440897, 'binary_specificity': 0.82008994, 'binary_f1_score': 0.76897687}
confusion matrix:
     0    1
0  547  120
1  160  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.8253871, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.8178867, 'auroc': 0.89138126, 'binary_precision': 0.8716577, 'binary_recall': 0.7477064, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.80493826}
confusion matrix:
     0    1
0  194   24
1   55  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:19:19.131648,epoch time: 0:01:47.263281,used: 0:01:47.263281,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.93980265, 'precision': 0.944085, 'recall': 0.9403728, 'specificity': 0.9403728, 'f1': 0.93970394, 'auroc': 0.99413455, 'binary_precision': 0.9905797, 'binary_recall': 0.88939494, 'binary_specificity': 0.99135065, 'binary_f1_score': 0.9372644}
confusion matrix:
      0     1
0  1490    13
1   170  1367
---- Validation: 
scalar performance:
{'acc': 0.8306264, 'precision': 0.84496576, 'recall': 0.82733834, 'specificity': 0.82733834, 'f1': 0.827718, 'auroc': 0.9226712, 'binary_precision': 0.90781564, 'binary_recall': 0.7236422, 'binary_specificity': 0.9310345, 'binary_f1_score': 0.8053333}
confusion matrix:
     0    1
0  621   46
1  173  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.85526776, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.8376423, 'auroc': 0.91465366, 'binary_precision': 0.9302326, 'binary_recall': 0.73394495, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.82051283}
confusion matrix:
     0    1
0  206   12
1   58  160
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 05:21:06.083217,epoch time: 0:01:46.951569,used: 0:03:34.214850,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95888156, 'precision': 0.96142435, 'recall': 0.9593216, 'specificity': 0.9593216, 'f1': 0.9588479, 'auroc': 0.9963157, 'binary_precision': 0.99858755, 'binary_recall': 0.91997397, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.95767015}
confusion matrix:
      0     1
0  1501     2
1   123  1414
---- Validation: 
scalar performance:
{'acc': 0.8352668, 'precision': 0.84805095, 'recall': 0.8321798, 'specificity': 0.8321798, 'f1': 0.83270514, 'auroc': 0.9154384, 'binary_precision': 0.90729785, 'binary_recall': 0.7348243, 'binary_specificity': 0.9295352, 'binary_f1_score': 0.8120036}
confusion matrix:
     0    1
0  620   47
1  166  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78899086, 'precision': 0.80371517, 'recall': 0.78899086, 'specificity': 0.78899086, 'f1': 0.786402, 'auroc': 0.887278, 'binary_precision': 0.87058824, 'binary_recall': 0.6788991, 'binary_specificity': 0.89908254, 'binary_f1_score': 0.7628866}
confusion matrix:
     0    1
0  196   22
1   70  148
better model found
persisted
after epoch: 3,now: 2024-07-26 05:22:52.179360,epoch time: 0:01:46.096143,used: 0:05:20.310993,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9486842, 'precision': 0.9517915, 'recall': 0.9491708, 'specificity': 0.9491708, 'f1': 0.94862866, 'auroc': 0.99496645, 'binary_precision': 0.99215966, 'binary_recall': 0.9056604, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.9469388}
confusion matrix:
      0     1
0  1492    11
1   145  1392
---- Validation: 
scalar performance:
{'acc': 0.75328696, 'precision': 0.77836275, 'recall': 0.7578746, 'specificity': 0.7578746, 'f1': 0.7496426, 'auroc': 0.8521538, 'binary_precision': 0.68651277, 'binary_recall': 0.9025559, 'binary_specificity': 0.6131934, 'binary_f1_score': 0.77984816}
confusion matrix:
     0    1
0  409  258
1   61  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.8403139, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.83677727, 'auroc': 0.8890245, 'binary_precision': 0.80753136, 'binary_recall': 0.8853211, 'binary_specificity': 0.78899086, 'binary_f1_score': 0.8446389}
confusion matrix:
     0    1
0  172   46
1   25  193
early stop counter: 1
val acc:0.7532869577407837, best validation acc: 0.8352668285369873, corresponding to test acc:                         0.78899085521698 / 0.8394495248794556
after epoch: 4,now: 2024-07-26 05:24:37.300021,epoch time: 0:01:45.120661,used: 0:07:05.431654,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91611844, 'precision': 0.92743313, 'recall': 0.91710013, 'specificity': 0.91710013, 'f1': 0.9156808, 'auroc': 0.99737453, 'binary_precision': 1.0, 'binary_recall': 0.83420026, 'binary_specificity': 1.0, 'binary_f1_score': 0.9096065}
confusion matrix:
      0     1
0  1502     0
1   255  1283
---- Validation: 
scalar performance:
{'acc': 0.55607116, 'precision': 0.76873493, 'recall': 0.5415335, 'specificity': 0.5415335, 'f1': 0.42627686, 'auroc': 0.91493547, 'binary_precision': 1.0, 'binary_recall': 0.08306709, 'binary_specificity': 1.0, 'binary_f1_score': 0.15339233}
confusion matrix:
     0   1
0  667   0
1  574  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5114679, 'precision': 0.75290024, 'recall': 0.5114679, 'specificity': 0.5114679, 'f1': 0.35832295, 'auroc': 0.9073731, 'binary_precision': 1.0, 'binary_recall': 0.02293578, 'binary_specificity': 1.0, 'binary_f1_score': 0.04484305}
confusion matrix:
     0  1
0  218  0
1  213  5
early stop counter: 2
val acc:0.5560711622238159, best validation acc: 0.8352668285369873, corresponding to test acc:                         0.78899085521698 / 0.8394495248794556
after epoch: 5,now: 2024-07-26 05:26:22.565060,epoch time: 0:01:45.265039,used: 0:08:50.696693,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.9753828, 'recall': 0.97490025, 'specificity': 0.97490025, 'f1': 0.9746677, 'auroc': 0.99824166, 'binary_precision': 0.99659634, 'binary_recall': 0.953125, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.9743761}
confusion matrix:
      0     1
0  1499     5
1    72  1464
---- Validation: 
scalar performance:
{'acc': 0.77726215, 'precision': 0.8126453, 'recall': 0.77178466, 'specificity': 0.77178466, 'f1': 0.76824844, 'auroc': 0.9028864, 'binary_precision': 0.91019416, 'binary_recall': 0.5990415, 'binary_specificity': 0.94452775, 'binary_f1_score': 0.72254336}
confusion matrix:
     0    1
0  630   37
1  251  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.83893037, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.8187169, 'auroc': 0.89228594, 'binary_precision': 0.9166667, 'binary_recall': 0.70642203, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.7979275}
confusion matrix:
     0    1
0  204   14
1   64  154
early stop counter: 3
val acc:0.7772621512413025, best validation acc: 0.8352668285369873, corresponding to test acc:                         0.78899085521698 / 0.8394495248794556
after epoch: 6,now: 2024-07-26 05:28:07.913263,epoch time: 0:01:45.348203,used: 0:10:36.044896,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9855263, 'precision': 0.9857789, 'recall': 0.9856864, 'specificity': 0.9856864, 'f1': 0.98552614, 'auroc': 0.99950784, 'binary_precision': 1.0, 'binary_recall': 0.9713728, 'binary_specificity': 1.0, 'binary_f1_score': 0.9854785}
confusion matrix:
      0     1
0  1503     0
1    44  1493
---- Validation: 
scalar performance:
{'acc': 0.7107502, 'precision': 0.8081664, 'recall': 0.70162165, 'specificity': 0.70162165, 'f1': 0.67996913, 'auroc': 0.9204583, 'binary_precision': 0.9736842, 'binary_recall': 0.413738, 'binary_specificity': 0.98950523, 'binary_f1_score': 0.58071744}
confusion matrix:
     0    1
0  660    7
1  367  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7224771, 'precision': 0.81690794, 'recall': 0.7224771, 'specificity': 0.7224771, 'f1': 0.7001393, 'auroc': 0.9148851, 'binary_precision': 0.989899, 'binary_recall': 0.44954127, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.6182965}
confusion matrix:
     0   1
0  217   1
1  120  98
early stop counter: 4
val acc:0.7107502222061157, best validation acc: 0.8352668285369873, corresponding to test acc:                         0.78899085521698 / 0.8394495248794556
after epoch: 7,now: 2024-07-26 05:29:53.318256,epoch time: 0:01:45.404993,used: 0:12:21.449889,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98618424, 'precision': 0.98622376, 'recall': 0.986153, 'specificity': 0.986153, 'f1': 0.98618156, 'auroc': 0.9990213, 'binary_precision': 0.98381877, 'binary_recall': 0.98893946, 'binary_specificity': 0.9833666, 'binary_f1_score': 0.9863725}
confusion matrix:
      0     1
0  1478    25
1    17  1520
---- Validation: 
scalar performance:
{'acc': 0.774942, 'precision': 0.8158679, 'recall': 0.7690939, 'specificity': 0.7690939, 'f1': 0.764681, 'auroc': 0.9078225, 'binary_precision': 0.92191434, 'binary_recall': 0.5846645, 'binary_specificity': 0.9535232, 'binary_f1_score': 0.71554244}
confusion matrix:
     0    1
0  636   31
1  260  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76376146, 'precision': 0.81104994, 'recall': 0.7637615, 'specificity': 0.7637615, 'f1': 0.754428, 'auroc': 0.898788, 'binary_precision': 0.93233085, 'binary_recall': 0.56880736, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.70655274}
confusion matrix:
     0    1
0  209    9
1   94  124
early stop counter: 5
val acc:0.7749419808387756, best validation acc: 0.8352668285369873, corresponding to test acc:                         0.78899085521698 / 0.8394495248794556
after epoch: 8,now: 2024-07-26 05:31:38.535945,epoch time: 0:01:45.217689,used: 0:14:06.667578,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_17_31_seed_8_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:14:06.667578 at 2024-07-26 05:31:38.535945
persisted model performance metric: 

scalar performance:
{'acc': 0.78899086, 'precision': 0.80371517, 'recall': 0.78899086, 'specificity': 0.78899086, 'f1': 0.786402, 'auroc': 0.887278, 'binary_precision': 0.87058824, 'binary_recall': 0.6788991, 'binary_specificity': 0.89908254, 'binary_f1_score': 0.7628866}
confusion matrix:
     0    1
0  196   22
1   70  148
oracle model performance metric: 

scalar performance:
{'acc': 0.8394495, 'precision': 0.85526776, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.8376423, 'auroc': 0.91465366, 'binary_precision': 0.9302326, 'binary_recall': 0.73394495, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.82051283}
confusion matrix:
     0    1
0  206   12
1   58  160
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2831 MiB |   9265 MiB | 694751 GiB | 694749 GiB |
|       from large pool |   2741 MiB |   9191 MiB | 688763 GiB | 688761 GiB |
|       from small pool |     89 MiB |    130 MiB |   5988 GiB |   5988 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2831 MiB |   9265 MiB | 694751 GiB | 694749 GiB |
|       from large pool |   2741 MiB |   9191 MiB | 688763 GiB | 688761 GiB |
|       from small pool |     89 MiB |    130 MiB |   5988 GiB |   5988 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 693792 GiB | 693789 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 687813 GiB | 687810 GiB |
|       from small pool |     89 MiB |    130 MiB |   5979 GiB |   5979 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10074 MiB |  10324 MiB |  58430 MiB |  48356 MiB |
|       from large pool |   9940 MiB |  10188 MiB |  58000 MiB |  48060 MiB |
|       from small pool |    134 MiB |    140 MiB |    430 MiB |    296 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1180 MiB |   2246 MiB | 553104 GiB | 553103 GiB |
|       from large pool |   1172 MiB |   2238 MiB | 546955 GiB | 546954 GiB |
|       from small pool |      8 MiB |     50 MiB |   6148 GiB |   6148 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   97669 K  |   97667 K  |
|       from large pool |     392    |     816    |   49043 K  |   49042 K  |
|       from small pool |    2078    |    2780    |   48626 K  |   48624 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   97669 K  |   97667 K  |
|       from large pool |     392    |     816    |   49043 K  |   49042 K  |
|       from small pool |    2078    |    2780    |   48626 K  |   48624 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     268    |     335    |    1420    |    1152    |
|       from large pool |     201    |     267    |    1205    |    1004    |
|       from small pool |      67    |      70    |     215    |     148    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     149    |     340    |   51709 K  |   51709 K  |
|       from large pool |      72    |     257    |   27949 K  |   27949 K  |
|       from small pool |      77    |     239    |   23759 K  |   23759 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 694751 GiB | 694751 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 688763 GiB | 688763 GiB |
|       from small pool |      0 KiB |    130 MiB |   5988 GiB |   5988 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 694751 GiB | 694751 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 688763 GiB | 688763 GiB |
|       from small pool |      0 KiB |    130 MiB |   5988 GiB |   5988 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 693792 GiB | 693792 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 687813 GiB | 687813 GiB |
|       from small pool |      0 KiB |    130 MiB |   5979 GiB |   5979 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4012 MiB |  10324 MiB |  58430 MiB |  54418 MiB |
|       from large pool |   3914 MiB |  10188 MiB |  58000 MiB |  54086 MiB |
|       from small pool |     98 MiB |    140 MiB |    430 MiB |    332 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 553105 GiB | 553105 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 546957 GiB | 546956 GiB |
|       from small pool |      0 KiB |     50 MiB |   6148 GiB |   6148 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   97669 K  |   97669 K  |
|       from large pool |       2    |     816    |   49043 K  |   49043 K  |
|       from small pool |       0    |    2780    |   48626 K  |   48626 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   97669 K  |   97669 K  |
|       from large pool |       2    |     816    |   49043 K  |   49043 K  |
|       from small pool |       0    |    2780    |   48626 K  |   48626 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     335    |    1420    |    1294    |
|       from large pool |      77    |     267    |    1205    |    1128    |
|       from small pool |      49    |      70    |     215    |     166    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   51709 K  |   51709 K  |
|       from large pool |       3    |     257    |   27949 K  |   27949 K  |
|       from small pool |       0    |     239    |   23760 K  |   23760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 694751 GiB | 694751 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 688763 GiB | 688763 GiB |
|       from small pool |      0 KiB |    130 MiB |   5988 GiB |   5988 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 694751 GiB | 694751 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 688763 GiB | 688763 GiB |
|       from small pool |      0 KiB |    130 MiB |   5988 GiB |   5988 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 693792 GiB | 693792 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 687813 GiB | 687813 GiB |
|       from small pool |      0 KiB |    130 MiB |   5979 GiB |   5979 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4012 MiB |  10324 MiB |  58430 MiB |  54418 MiB |
|       from large pool |   3914 MiB |  10188 MiB |  58000 MiB |  54086 MiB |
|       from small pool |     98 MiB |    140 MiB |    430 MiB |    332 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 553105 GiB | 553105 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 546957 GiB | 546956 GiB |
|       from small pool |      0 KiB |     50 MiB |   6148 GiB |   6148 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   97669 K  |   97669 K  |
|       from large pool |       2    |     816    |   49043 K  |   49043 K  |
|       from small pool |       0    |    2780    |   48626 K  |   48626 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   97669 K  |   97669 K  |
|       from large pool |       2    |     816    |   49043 K  |   49043 K  |
|       from small pool |       0    |    2780    |   48626 K  |   48626 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     335    |    1420    |    1294    |
|       from large pool |      77    |     267    |    1205    |    1128    |
|       from small pool |      49    |      70    |     215    |     166    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   51709 K  |   51709 K  |
|       from large pool |       3    |     257    |   27949 K  |   27949 K  |
|       from small pool |       0    |     239    |   23760 K  |   23760 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734

 Experiment start at: 2024-07-26 05:32:09.837737
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9414267, 'precision': 0.9460789, 'recall': 0.941803, 'specificity': 0.941803, 'f1': 0.9413053, 'auroc': 0.9918982, 'binary_precision': 0.9934688, 'binary_recall': 0.88953865, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9386356}
confusion matrix:
      0     1
0  1508     9
1   170  1369
---- Validation: 
scalar performance:
{'acc': 0.6301158, 'precision': 0.7549467, 'recall': 0.62656665, 'specificity': 0.62656665, 'f1': 0.5750954, 'auroc': 0.90922296, 'binary_precision': 0.93085104, 'binary_recall': 0.2730109, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.42219537}
confusion matrix:
     0    1
0  641   13
1  466  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7021739, 'precision': 0.8133515, 'recall': 0.70217395, 'specificity': 0.70217395, 'f1': 0.67318535, 'auroc': 0.91529304, 'binary_precision': 1.0, 'binary_recall': 0.40434784, 'binary_specificity': 1.0, 'binary_f1_score': 0.5758514}
confusion matrix:
     0   1
0  230   0
1  137  93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:33:58.508601,epoch time: 0:01:48.670864,used: 0:01:48.670864,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.974008, 'recall': 0.9737652, 'specificity': 0.9737652, 'f1': 0.97381604, 'auroc': 0.9971833, 'binary_precision': 0.96611255, 'binary_recall': 0.98244476, 'binary_specificity': 0.9650856, 'binary_f1_score': 0.9742102}
confusion matrix:
      0     1
0  1465    53
1    27  1511
---- Validation: 
scalar performance:
{'acc': 0.8563706, 'precision': 0.85816365, 'recall': 0.8567283, 'specificity': 0.8567283, 'f1': 0.85626566, 'auroc': 0.9284613, 'binary_precision': 0.8301887, 'binary_recall': 0.8923557, 'binary_specificity': 0.8211009, 'binary_f1_score': 0.86015034}
confusion matrix:
     0    1
0  537  117
1   69  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8521739, 'precision': 0.8526005, 'recall': 0.8521739, 'specificity': 0.8521739, 'f1': 0.8521292, 'auroc': 0.9317391, 'binary_precision': 0.84033614, 'binary_recall': 0.8695652, 'binary_specificity': 0.8347826, 'binary_f1_score': 0.85470086}
confusion matrix:
     0    1
0  192   38
1   30  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 05:35:46.031735,epoch time: 0:01:47.523134,used: 0:03:36.193998,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9659686, 'precision': 0.9659821, 'recall': 0.9660076, 'specificity': 0.9660076, 'f1': 0.9659684, 'auroc': 0.99536324, 'binary_precision': 0.9711286, 'binary_recall': 0.96103895, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9660574}
confusion matrix:
      0     1
0  1472    44
1    60  1480
---- Validation: 
scalar performance:
{'acc': 0.84015447, 'precision': 0.84050345, 'recall': 0.84031665, 'specificity': 0.84031665, 'f1': 0.84014493, 'auroc': 0.9124719, 'binary_precision': 0.8268072, 'binary_recall': 0.8564743, 'binary_specificity': 0.824159, 'binary_f1_score': 0.84137934}
confusion matrix:
     0    1
0  539  115
1   92  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8304348, 'precision': 0.83695734, 'recall': 0.8304348, 'specificity': 0.8304348, 'f1': 0.8296102, 'auroc': 0.91680527, 'binary_precision': 0.88383836, 'binary_recall': 0.76086956, 'binary_specificity': 0.9, 'binary_f1_score': 0.817757}
confusion matrix:
     0    1
0  207   23
1   55  175
early stop counter: 1
val acc:0.8401544690132141, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.852173924446106 / 0.852173924446106
after epoch: 3,now: 2024-07-26 05:37:31.609775,epoch time: 0:01:45.578040,used: 0:05:21.772038,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97801846, 'recall': 0.9778465, 'specificity': 0.9778465, 'f1': 0.97774774, 'auroc': 0.9986396, 'binary_precision': 0.99131596, 'binary_recall': 0.9642625, 'binary_specificity': 0.99143046, 'binary_f1_score': 0.9776021}
confusion matrix:
      0     1
0  1504    13
1    55  1484
---- Validation: 
scalar performance:
{'acc': 0.85559845, 'precision': 0.8589822, 'recall': 0.8560878, 'specificity': 0.8560878, 'f1': 0.8553653, 'auroc': 0.9278531, 'binary_precision': 0.82152975, 'binary_recall': 0.9048362, 'binary_specificity': 0.80733943, 'binary_f1_score': 0.861173}
confusion matrix:
     0    1
0  528  126
1   61  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8369565, 'precision': 0.83701384, 'recall': 0.8369565, 'specificity': 0.8369565, 'f1': 0.8369496, 'auroc': 0.92245746, 'binary_precision': 0.8414097, 'binary_recall': 0.8304348, 'binary_specificity': 0.84347826, 'binary_f1_score': 0.83588624}
confusion matrix:
     0    1
0  194   36
1   39  191
early stop counter: 2
val acc:0.8555984497070312, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.852173924446106 / 0.852173924446106
after epoch: 4,now: 2024-07-26 05:39:17.267212,epoch time: 0:01:45.657437,used: 0:07:07.429475,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.9798249, 'recall': 0.9797879, 'specificity': 0.9797879, 'f1': 0.97971195, 'auroc': 0.99842584, 'binary_precision': 0.98940396, 'binary_recall': 0.97012985, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.97967213}
confusion matrix:
      0     1
0  1500    16
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.84247106, 'precision': 0.84338665, 'recall': 0.8422071, 'specificity': 0.8422071, 'f1': 0.8422806, 'auroc': 0.9054874, 'binary_precision': 0.8587849, 'binary_recall': 0.81591266, 'binary_specificity': 0.86850154, 'binary_f1_score': 0.8368}
confusion matrix:
     0    1
0  568   86
1  118  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84347826, 'precision': 0.8437122, 'recall': 0.84347826, 'specificity': 0.84347826, 'f1': 0.8434516, 'auroc': 0.9085444, 'binary_precision': 0.8526786, 'binary_recall': 0.8304348, 'binary_specificity': 0.8565217, 'binary_f1_score': 0.84140974}
confusion matrix:
     0    1
0  197   33
1   39  191
early stop counter: 3
val acc:0.8424710631370544, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.852173924446106 / 0.852173924446106
after epoch: 5,now: 2024-07-26 05:41:03.626743,epoch time: 0:01:46.359531,used: 0:08:53.789006,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98473006, 'recall': 0.9846879, 'specificity': 0.9846879, 'f1': 0.98462033, 'auroc': 0.99920416, 'binary_precision': 0.9940397, 'binary_recall': 0.97530866, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.98458505}
confusion matrix:
      0     1
0  1508     9
1    38  1501
---- Validation: 
scalar performance:
{'acc': 0.83088803, 'precision': 0.8423865, 'recall': 0.8299639, 'specificity': 0.8299639, 'f1': 0.8291665, 'auroc': 0.9164842, 'binary_precision': 0.90267175, 'binary_recall': 0.7379095, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.81201714}
confusion matrix:
     0    1
0  603   51
1  168  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84347826, 'precision': 0.8472594, 'recall': 0.84347826, 'specificity': 0.84347826, 'f1': 0.8430511, 'auroc': 0.9000378, 'binary_precision': 0.88349515, 'binary_recall': 0.79130435, 'binary_specificity': 0.8956522, 'binary_f1_score': 0.8348624}
confusion matrix:
     0    1
0  206   24
1   48  182
early stop counter: 4
val acc:0.830888032913208, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.852173924446106 / 0.852173924446106
after epoch: 6,now: 2024-07-26 05:42:49.473681,epoch time: 0:01:45.846938,used: 0:10:39.635944,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.97433937, 'recall': 0.97395253, 'specificity': 0.97395253, 'f1': 0.97381866, 'auroc': 0.9978742, 'binary_precision': 0.9919083, 'binary_recall': 0.9558155, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.97352743}
confusion matrix:
      0     1
0  1505    12
1    68  1471
---- Validation: 
scalar performance:
{'acc': 0.53513515, 'precision': 0.6944293, 'recall': 0.53052974, 'specificity': 0.53052974, 'f1': 0.40752715, 'auroc': 0.87894964, 'binary_precision': 0.8679245, 'binary_recall': 0.07176287, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.13256484}
confusion matrix:
     0   1
0  647   7
1  595  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54347825, 'precision': 0.7613636, 'recall': 0.54347825, 'specificity': 0.54347825, 'f1': 0.42328358, 'auroc': 0.9074244, 'binary_precision': 1.0, 'binary_recall': 0.08695652, 'binary_specificity': 1.0, 'binary_f1_score': 0.16000001}
confusion matrix:
     0   1
0  230   0
1  210  20
early stop counter: 5
val acc:0.5351351499557495, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.852173924446106 / 0.852173924446106
after epoch: 7,now: 2024-07-26 05:44:35.241171,epoch time: 0:01:45.767490,used: 0:12:25.403434,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_32_09_seed_9_23064734
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:12:25.403434 at 2024-07-26 05:44:35.241171
persisted model performance metric: 

scalar performance:
{'acc': 0.8521739, 'precision': 0.8526005, 'recall': 0.8521739, 'specificity': 0.8521739, 'f1': 0.8521292, 'auroc': 0.9317391, 'binary_precision': 0.84033614, 'binary_recall': 0.8695652, 'binary_specificity': 0.8347826, 'binary_f1_score': 0.85470086}
confusion matrix:
     0    1
0  192   38
1   30  200
oracle model performance metric: 

scalar performance:
{'acc': 0.8521739, 'precision': 0.8526005, 'recall': 0.8521739, 'specificity': 0.8521739, 'f1': 0.8521292, 'auroc': 0.9317391, 'binary_precision': 0.84033614, 'binary_recall': 0.8695652, 'binary_specificity': 0.8347826, 'binary_f1_score': 0.85470086}
confusion matrix:
     0    1
0  192   38
1   30  200
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2830 MiB |   9265 MiB | 741946 GiB | 741943 GiB |
|       from large pool |   2740 MiB |   9191 MiB | 735551 GiB | 735548 GiB |
|       from small pool |     89 MiB |    130 MiB |   6395 GiB |   6394 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2830 MiB |   9265 MiB | 741946 GiB | 741943 GiB |
|       from large pool |   2740 MiB |   9191 MiB | 735551 GiB | 735548 GiB |
|       from small pool |     89 MiB |    130 MiB |   6395 GiB |   6394 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2813 MiB |   9251 MiB | 740868 GiB | 740865 GiB |
|       from large pool |   2723 MiB |   9177 MiB | 734482 GiB | 734480 GiB |
|       from small pool |     89 MiB |    130 MiB |   6385 GiB |   6385 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10070 MiB |  10324 MiB |  64488 MiB |  54418 MiB |
|       from large pool |   9936 MiB |  10188 MiB |  64022 MiB |  54086 MiB |
|       from small pool |    134 MiB |    140 MiB |    466 MiB |    332 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1637 MiB |   2246 MiB | 592357 GiB | 592356 GiB |
|       from large pool |   1629 MiB |   2238 MiB | 585791 GiB | 585789 GiB |
|       from small pool |      8 MiB |     50 MiB |   6566 GiB |   6566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |  104306 K  |  104303 K  |
|       from large pool |     392    |     816    |   52372 K  |   52372 K  |
|       from small pool |    2084    |    2780    |   51933 K  |   51931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |  104306 K  |  104303 K  |
|       from large pool |     392    |     816    |   52372 K  |   52372 K  |
|       from small pool |    2084    |    2780    |   51933 K  |   51931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     263    |     335    |    1557    |    1294    |
|       from large pool |     196    |     267    |    1324    |    1128    |
|       from small pool |      67    |      70    |     233    |     166    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     167    |     340    |   55297 K  |   55296 K  |
|       from large pool |      84    |     257    |   29929 K  |   29929 K  |
|       from small pool |      83    |     239    |   25367 K  |   25367 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9265 MiB | 741946 GiB | 741946 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 735551 GiB | 735551 GiB |
|       from small pool |      0 KiB |    130 MiB |   6395 GiB |   6395 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9265 MiB | 741946 GiB | 741946 GiB |
|       from large pool |  16640 KiB |   9191 MiB | 735551 GiB | 735551 GiB |
|       from small pool |      0 KiB |    130 MiB |   6395 GiB |   6395 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9251 MiB | 740868 GiB | 740868 GiB |
|       from large pool |  16640 KiB |   9177 MiB | 734482 GiB | 734482 GiB |
|       from small pool |      0 KiB |    130 MiB |   6385 GiB |   6385 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4468 MiB |  10324 MiB |  64488 MiB |  60020 MiB |
|       from large pool |   4370 MiB |  10188 MiB |  64022 MiB |  59652 MiB |
|       from small pool |     98 MiB |    140 MiB |    466 MiB |    368 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2246 MiB | 592358 GiB | 592358 GiB |
|       from large pool |  24320 KiB |   2238 MiB | 585792 GiB | 585792 GiB |
|       from small pool |      0 KiB |     50 MiB |   6566 GiB |   6566 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  104306 K  |  104306 K  |
|       from large pool |       2    |     816    |   52372 K  |   52372 K  |
|       from small pool |       0    |    2780    |   51933 K  |   51933 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  104306 K  |  104306 K  |
|       from large pool |       2    |     816    |   52372 K  |   52372 K  |
|       from small pool |       0    |    2780    |   51933 K  |   51933 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     335    |    1557    |    1426    |
|       from large pool |      82    |     267    |    1324    |    1242    |
|       from small pool |      49    |      70    |     233    |     184    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     340    |   55297 K  |   55297 K  |
|       from large pool |       3    |     257    |   29929 K  |   29929 K  |
|       from small pool |       0    |     239    |   25367 K  |   25367 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 05:44:44 2024]
Finished job 0.
1 of 1 steps (100%) done
