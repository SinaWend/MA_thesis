Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:14:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697

 Experiment start at: 2024-07-26 00:14:46.923642
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83528644, 'precision': 0.87445617, 'recall': 0.8330745, 'specificity': 0.8330745, 'f1': 0.830194, 'auroc': 0.9887899, 'binary_precision': 0.75671715, 'binary_recall': 0.9948619, 'binary_specificity': 0.6712871, 'binary_f1_score': 0.8596005}
confusion matrix:
      0     1
0  1017   498
1     8  1549
---- Validation: 
scalar performance:
{'acc': 0.6537267, 'precision': 0.75817823, 'recall': 0.65810853, 'specificity': 0.65810853, 'f1': 0.6183779, 'auroc': 0.84744906, 'binary_precision': 0.5904306, 'binary_recall': 0.9716535, 'binary_specificity': 0.34456354, 'binary_f1_score': 0.7345238}
confusion matrix:
     0    1
0  225  428
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.76448417, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.5985355, 'auroc': 0.83504593, 'binary_precision': 0.5861111, 'binary_recall': 0.98139536, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.73391306}
confusion matrix:
    0    1
0  66  149
1   4  211
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:17:39.088812,epoch time: 0:02:52.165170,used: 0:02:52.165170,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95703125, 'precision': 0.9590887, 'recall': 0.9574757, 'specificity': 0.9574757, 'f1': 0.95700634, 'auroc': 0.99412704, 'binary_precision': 0.99307, 'binary_recall': 0.9215434, 'binary_specificity': 0.993408, 'binary_f1_score': 0.95597064}
confusion matrix:
      0     1
0  1507    10
1   122  1433
---- Validation: 
scalar performance:
{'acc': 0.79813665, 'precision': 0.8060236, 'recall': 0.7969903, 'specificity': 0.7969903, 'f1': 0.7963691, 'auroc': 0.8809854, 'binary_precision': 0.8517824, 'binary_recall': 0.71496063, 'binary_specificity': 0.8790199, 'binary_f1_score': 0.7773972}
confusion matrix:
     0    1
0  574   79
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8280205, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82789207, 'auroc': 0.90769064, 'binary_precision': 0.82191783, 'binary_recall': 0.8372093, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8294931}
confusion matrix:
     0    1
0  176   39
1   35  180
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:20:29.213508,epoch time: 0:02:50.124696,used: 0:05:42.289866,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9654948, 'precision': 0.965791, 'recall': 0.9653408, 'specificity': 0.9653408, 'f1': 0.96547365, 'auroc': 0.9960187, 'binary_precision': 0.9572058, 'binary_recall': 0.9756254, 'binary_specificity': 0.9550562, 'binary_f1_score': 0.9663278}
confusion matrix:
      0     1
0  1445    68
1    38  1521
---- Validation: 
scalar performance:
{'acc': 0.76397514, 'precision': 0.78546774, 'recall': 0.7658608, 'specificity': 0.7658608, 'f1': 0.76027584, 'auroc': 0.88689387, 'binary_precision': 0.703567, 'binary_recall': 0.9007874, 'binary_specificity': 0.6309342, 'binary_f1_score': 0.7900553}
confusion matrix:
     0    1
0  412  241
1   63  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.7962348, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.7383721, 'auroc': 0.9067172, 'binary_precision': 0.6777409, 'binary_recall': 0.9488372, 'binary_specificity': 0.5488372, 'binary_f1_score': 0.7906977}
confusion matrix:
     0    1
0  118   97
1   11  204
early stop counter: 1
val acc:0.7639751434326172, best validation acc: 0.7981366515159607, corresponding to test acc:                         0.8279069662094116 / 0.8279069662094116
after epoch: 3,now: 2024-07-26 00:23:17.965190,epoch time: 0:02:48.751682,used: 0:08:31.041548,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97694373, 'recall': 0.97651124, 'specificity': 0.97651124, 'f1': 0.97623456, 'auroc': 0.99754596, 'binary_precision': 0.9986541, 'binary_recall': 0.9543408, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.97599477}
confusion matrix:
      0     1
0  1515     2
1    71  1484
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7853354, 'recall': 0.70677674, 'specificity': 0.70677674, 'f1': 0.6877394, 'auroc': 0.90716136, 'binary_precision': 0.9281046, 'binary_recall': 0.4472441, 'binary_specificity': 0.96630937, 'binary_f1_score': 0.6036132}
confusion matrix:
     0    1
0  631   22
1  351  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.74455637, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.58129966, 'auroc': 0.89702547, 'binary_precision': 0.9117647, 'binary_recall': 0.2883721, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.43816257}
confusion matrix:
     0   1
0  209   6
1  153  62
early stop counter: 2
val acc:0.7104037404060364, best validation acc: 0.7981366515159607, corresponding to test acc:                         0.8279069662094116 / 0.8279069662094116
after epoch: 4,now: 2024-07-26 00:26:06.832425,epoch time: 0:02:48.867235,used: 0:11:19.908783,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.9494926, 'recall': 0.9450066, 'specificity': 0.9450066, 'f1': 0.945457, 'auroc': 0.99645114, 'binary_precision': 0.9112951, 'binary_recall': 0.9890886, 'binary_specificity': 0.9009247, 'binary_f1_score': 0.94859964}
confusion matrix:
      0     1
0  1364   150
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.8152174, 'precision': 0.81895334, 'recall': 0.8159627, 'specificity': 0.8159627, 'f1': 0.81489205, 'auroc': 0.89553237, 'binary_precision': 0.7807638, 'binary_recall': 0.86929137, 'binary_specificity': 0.762634, 'binary_f1_score': 0.82265276}
confusion matrix:
     0    1
0  498  155
1   83  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.81102484, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8090379, 'auroc': 0.87457, 'binary_precision': 0.8341709, 'binary_recall': 0.772093, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8019324}
confusion matrix:
     0    1
0  182   33
1   49  166
better model found
persisted
after epoch: 5,now: 2024-07-26 00:28:56.777732,epoch time: 0:02:49.945307,used: 0:14:09.854090,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9781865, 'recall': 0.97825193, 'specificity': 0.97825193, 'f1': 0.97818923, 'auroc': 0.99834085, 'binary_precision': 0.98373455, 'binary_recall': 0.972973, 'binary_specificity': 0.98353094, 'binary_f1_score': 0.9783242}
confusion matrix:
      0     1
0  1493    25
1    42  1512
---- Validation: 
scalar performance:
{'acc': 0.86102486, 'precision': 0.86316323, 'recall': 0.86048764, 'specificity': 0.86048764, 'f1': 0.86067, 'auroc': 0.9160217, 'binary_precision': 0.8877551, 'binary_recall': 0.82204723, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.8536385}
confusion matrix:
     0    1
0  587   66
1  113  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.86304307, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84213614, 'auroc': 0.9183991, 'binary_precision': 0.94578314, 'binary_recall': 0.73023254, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.82414705}
confusion matrix:
     0    1
0  206    9
1   58  157
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 00:31:47.065264,epoch time: 0:02:50.287532,used: 0:17:00.141622,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9802191, 'recall': 0.98029304, 'specificity': 0.98029304, 'f1': 0.98014295, 'auroc': 0.99778193, 'binary_precision': 0.9908197, 'binary_recall': 0.96983314, 'binary_specificity': 0.990753, 'binary_f1_score': 0.98021406}
confusion matrix:
      0     1
0  1500    14
1    47  1511
---- Validation: 
scalar performance:
{'acc': 0.6956522, 'precision': 0.7898698, 'recall': 0.6916207, 'specificity': 0.6916207, 'f1': 0.665961, 'auroc': 0.9036187, 'binary_precision': 0.95167285, 'binary_recall': 0.4031496, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.56637174}
confusion matrix:
     0    1
0  640   13
1  379  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.8222852, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.7366327, 'auroc': 0.8977123, 'binary_precision': 0.9736842, 'binary_recall': 0.51627904, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.674772}
confusion matrix:
     0    1
0  212    3
1  104  111
early stop counter: 1
val acc:0.695652186870575, best validation acc: 0.8610248565673828, corresponding to test acc:                         0.8441860675811768 / 0.8441860675811768
after epoch: 7,now: 2024-07-26 00:34:35.620717,epoch time: 0:02:48.555453,used: 0:19:48.697075,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.97972524, 'recall': 0.97967947, 'specificity': 0.97967947, 'f1': 0.9794922, 'auroc': 0.9965496, 'binary_precision': 0.9940437, 'binary_recall': 0.9652956, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.97945875}
confusion matrix:
      0     1
0  1507     9
1    54  1502
---- Validation: 
scalar performance:
{'acc': 0.78881985, 'precision': 0.82619584, 'recall': 0.78643453, 'specificity': 0.78643453, 'f1': 0.7816116, 'auroc': 0.90201074, 'binary_precision': 0.93317425, 'binary_recall': 0.61574805, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.7419355}
confusion matrix:
     0    1
0  625   28
1  244  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7093023, 'precision': 0.7931818, 'recall': 0.7093023, 'specificity': 0.7093023, 'f1': 0.68690836, 'auroc': 0.8985181, 'binary_precision': 0.95, 'binary_recall': 0.44186047, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.60317457}
confusion matrix:
     0   1
0  210   5
1  120  95
early stop counter: 2
val acc:0.7888198494911194, best validation acc: 0.8610248565673828, corresponding to test acc:                         0.8441860675811768 / 0.8441860675811768
after epoch: 8,now: 2024-07-26 00:37:24.677588,epoch time: 0:02:49.056871,used: 0:22:37.753946,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97390133, 'recall': 0.97360957, 'specificity': 0.97360957, 'f1': 0.97330594, 'auroc': 0.9973012, 'binary_precision': 0.9946381, 'binary_recall': 0.9525032, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9731148}
confusion matrix:
      0     1
0  1506     8
1    74  1484
---- Validation: 
scalar performance:
{'acc': 0.636646, 'precision': 0.70499575, 'recall': 0.6325162, 'specificity': 0.6325162, 'f1': 0.5995536, 'auroc': 0.8102284, 'binary_precision': 0.8199234, 'binary_recall': 0.33700788, 'binary_specificity': 0.92802453, 'binary_f1_score': 0.47767857}
confusion matrix:
     0    1
0  606   47
1  421  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7425641, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.65659726, 'auroc': 0.8715197, 'binary_precision': 0.8666667, 'binary_recall': 0.4232558, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.56875}
confusion matrix:
     0   1
0  201  14
1  124  91
early stop counter: 3
val acc:0.6366459727287292, best validation acc: 0.8610248565673828, corresponding to test acc:                         0.8441860675811768 / 0.8441860675811768
after epoch: 9,now: 2024-07-26 00:40:13.916010,epoch time: 0:02:49.238422,used: 0:25:26.992368,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9818511, 'recall': 0.98190343, 'specificity': 0.98190343, 'f1': 0.98177075, 'auroc': 0.9960468, 'binary_precision': 0.992126, 'binary_recall': 0.97172236, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9818182}
confusion matrix:
      0     1
0  1504    12
1    44  1512
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.80482745, 'recall': 0.78964317, 'specificity': 0.78964317, 'f1': 0.78815985, 'auroc': 0.8790585, 'binary_precision': 0.866, 'binary_recall': 0.6818898, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.76299566}
confusion matrix:
     0    1
0  586   67
1  202  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.80563176, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.7599428, 'auroc': 0.8848243, 'binary_precision': 0.91366905, 'binary_recall': 0.59069765, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.71751416}
confusion matrix:
     0    1
0  203   12
1   88  127
early stop counter: 4
val acc:0.7911490797996521, best validation acc: 0.8610248565673828, corresponding to test acc:                         0.8441860675811768 / 0.8441860675811768
after epoch: 10,now: 2024-07-26 00:43:02.920617,epoch time: 0:02:49.004607,used: 0:28:15.996975,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.980006, 'recall': 0.9792968, 'specificity': 0.9792968, 'f1': 0.97947645, 'auroc': 0.99878705, 'binary_precision': 0.96747965, 'binary_recall': 0.99293965, 'binary_specificity': 0.9656539, 'binary_f1_score': 0.9800443}
confusion matrix:
      0     1
0  1462    52
1    11  1547
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.84703135, 'recall': 0.8470958, 'specificity': 0.8470958, 'f1': 0.8470385, 'auroc': 0.91277087, 'binary_precision': 0.8411215, 'binary_recall': 0.8503937, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.84573215}
confusion matrix:
     0    1
0  551  102
1   95  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.809393, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80659914, 'auroc': 0.86433744, 'binary_precision': 0.8367347, 'binary_recall': 0.7627907, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.7980535}
confusion matrix:
     0    1
0  183   32
1   51  164
early stop counter: 5
val acc:0.8470497131347656, best validation acc: 0.8610248565673828, corresponding to test acc:                         0.8441860675811768 / 0.8441860675811768
after epoch: 11,now: 2024-07-26 00:45:51.772918,epoch time: 0:02:48.852301,used: 0:31:04.849276,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_46_seed_0_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:31:04.849276 at 2024-07-26 00:45:51.772918
persisted model performance metric: 

scalar performance:
{'acc': 0.84418607, 'precision': 0.86304307, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84213614, 'auroc': 0.9183991, 'binary_precision': 0.94578314, 'binary_recall': 0.73023254, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.82414705}
confusion matrix:
     0    1
0  206    9
1   58  157
oracle model performance metric: 

scalar performance:
{'acc': 0.84418607, 'precision': 0.86304307, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84213614, 'auroc': 0.9183991, 'binary_precision': 0.94578314, 'binary_recall': 0.73023254, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.82414705}
confusion matrix:
     0    1
0  206    9
1   58  157
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2796 MiB |   9235 MiB |  73794 GiB |  73791 GiB |
|       from large pool |   2704 MiB |   9159 MiB |  73152 GiB |  73150 GiB |
|       from small pool |     91 MiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2796 MiB |   9235 MiB |  73794 GiB |  73791 GiB |
|       from large pool |   2704 MiB |   9159 MiB |  73152 GiB |  73150 GiB |
|       from small pool |     91 MiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB |  73666 GiB |  73664 GiB |
|       from large pool |   2687 MiB |   9148 MiB |  73026 GiB |  73023 GiB |
|       from small pool |     91 MiB |    128 MiB |    640 GiB |    640 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10180 MiB |  10180 MiB |  10180 MiB |      0 B   |
|       from large pool |  10044 MiB |  10044 MiB |  10044 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |    923 MiB |   1114 MiB |  49674 GiB |  49673 GiB |
|       from large pool |    913 MiB |   1107 MiB |  49014 GiB |  49013 GiB |
|       from small pool |     10 MiB |     22 MiB |    659 GiB |    659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   10438 K  |   10436 K  |
|       from large pool |     392    |     816    |    5243 K  |    5243 K  |
|       from small pool |    2072    |    2768    |    5194 K  |    5192 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   10438 K  |   10436 K  |
|       from large pool |     392    |     816    |    5243 K  |    5243 K  |
|       from small pool |    2072    |    2768    |    5194 K  |    5192 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     334    |     334    |     334    |       0    |
|       from large pool |     266    |     266    |     266    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     147    |     321    |    6067 K  |    6067 K  |
|       from large pool |      73    |     251    |    3440 K  |    3440 K  |
|       from small pool |      74    |     229    |    2626 K  |    2626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9235 MiB |  73794 GiB |  73794 GiB |
|       from large pool |  16640 KiB |   9159 MiB |  73152 GiB |  73152 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9235 MiB |  73794 GiB |  73794 GiB |
|       from large pool |  16640 KiB |   9159 MiB |  73152 GiB |  73152 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB |  73666 GiB |  73666 GiB |
|       from large pool |  16640 KiB |   9148 MiB |  73026 GiB |  73026 GiB |
|       from small pool |      0 KiB |    128 MiB |    640 GiB |    640 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3720 MiB |  10180 MiB |  10180 MiB |   6460 MiB |
|       from large pool |   3618 MiB |  10044 MiB |  10044 MiB |   6426 MiB |
|       from small pool |    102 MiB |    136 MiB |    136 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1364 MiB |  49675 GiB |  49675 GiB |
|       from large pool |  24320 KiB |   1337 MiB |  49015 GiB |  49015 GiB |
|       from small pool |      0 KiB |     56 MiB |    659 GiB |    659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   10438 K  |   10438 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5194 K  |    5194 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   10438 K  |   10438 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5194 K  |    5194 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |     334    |     200    |
|       from large pool |      83    |     266    |     266    |     183    |
|       from small pool |      51    |      68    |      68    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |    6067 K  |    6067 K  |
|       from large pool |       3    |     251    |    3440 K  |    3440 K  |
|       from small pool |       0    |     229    |    2626 K  |    2626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9235 MiB |  73794 GiB |  73794 GiB |
|       from large pool |  16640 KiB |   9159 MiB |  73152 GiB |  73152 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9235 MiB |  73794 GiB |  73794 GiB |
|       from large pool |  16640 KiB |   9159 MiB |  73152 GiB |  73152 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB |  73666 GiB |  73666 GiB |
|       from large pool |  16640 KiB |   9148 MiB |  73026 GiB |  73026 GiB |
|       from small pool |      0 KiB |    128 MiB |    640 GiB |    640 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3720 MiB |  10180 MiB |  10180 MiB |   6460 MiB |
|       from large pool |   3618 MiB |  10044 MiB |  10044 MiB |   6426 MiB |
|       from small pool |    102 MiB |    136 MiB |    136 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1364 MiB |  49675 GiB |  49675 GiB |
|       from large pool |  24320 KiB |   1337 MiB |  49015 GiB |  49015 GiB |
|       from small pool |      0 KiB |     56 MiB |    659 GiB |    659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   10438 K  |   10438 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5194 K  |    5194 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   10438 K  |   10438 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5194 K  |    5194 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |     334    |     200    |
|       from large pool |      83    |     266    |     266    |     183    |
|       from small pool |      51    |      68    |      68    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |    6067 K  |    6067 K  |
|       from large pool |       3    |     251    |    3440 K  |    3440 K  |
|       from small pool |       0    |     229    |    2626 K  |    2626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697

 Experiment start at: 2024-07-26 00:46:25.926738
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9326172, 'precision': 0.9395783, 'recall': 0.93182147, 'specificity': 0.93182147, 'f1': 0.9322537, 'auroc': 0.9955725, 'binary_precision': 0.887421, 'binary_recall': 0.9929306, 'binary_specificity': 0.8707124, 'binary_f1_score': 0.9372156}
confusion matrix:
      0     1
0  1320   196
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.6775956, 'precision': 0.7652972, 'recall': 0.6822325, 'specificity': 0.6822325, 'f1': 0.6519061, 'auroc': 0.89870584, 'binary_precision': 0.6086086, 'binary_recall': 0.96507937, 'binary_specificity': 0.39938557, 'binary_f1_score': 0.7464702}
confusion matrix:
     0    1
0  260  391
1   22  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64666665, 'precision': 0.7558933, 'recall': 0.64666665, 'specificity': 0.64666665, 'f1': 0.6044579, 'auroc': 0.881837, 'binary_precision': 0.58870965, 'binary_recall': 0.97333336, 'binary_specificity': 0.32, 'binary_f1_score': 0.7336683}
confusion matrix:
    0    1
0  72  153
1   6  219
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:49:16.791321,epoch time: 0:02:50.864583,used: 0:02:50.864583,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9766547, 'recall': 0.9764435, 'specificity': 0.9764435, 'f1': 0.97623605, 'auroc': 0.9969766, 'binary_precision': 0.993996, 'binary_recall': 0.95881593, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.97608906}
confusion matrix:
      0     1
0  1509     9
1    64  1490
---- Validation: 
scalar performance:
{'acc': 0.7338017, 'precision': 0.76754916, 'recall': 0.73082435, 'specificity': 0.73082435, 'f1': 0.723436, 'auroc': 0.86099285, 'binary_precision': 0.8585608, 'binary_recall': 0.5492064, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.66989356}
confusion matrix:
     0    1
0  594   57
1  284  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.7960224, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.78496766, 'auroc': 0.87016296, 'binary_precision': 0.84864867, 'binary_recall': 0.69777775, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.76585364}
confusion matrix:
     0    1
0  197   28
1   68  157
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:52:07.511913,epoch time: 0:02:50.720592,used: 0:05:41.585175,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.97043025, 'recall': 0.9697435, 'specificity': 0.9697435, 'f1': 0.9693953, 'auroc': 0.99621516, 'binary_precision': 0.9959294, 'binary_recall': 0.9434447, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.96897686}
confusion matrix:
      0     1
0  1510     6
1    88  1468
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.7895893, 'recall': 0.7601383, 'specificity': 0.7601383, 'f1': 0.7558066, 'auroc': 0.873225, 'binary_precision': 0.8738532, 'binary_recall': 0.6047619, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.7148218}
confusion matrix:
     0    1
0  596   55
1  249  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78, 'precision': 0.7840909, 'recall': 0.78, 'specificity': 0.78, 'f1': 0.7792052, 'auroc': 0.8300197, 'binary_precision': 0.8181818, 'binary_recall': 0.72, 'binary_specificity': 0.84, 'binary_f1_score': 0.76595753}
confusion matrix:
     0    1
0  189   36
1   63  162
better model found
persisted
after epoch: 3,now: 2024-07-26 00:54:57.321197,epoch time: 0:02:49.809284,used: 0:08:31.394459,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.9798074, 'recall': 0.97985625, 'specificity': 0.97985625, 'f1': 0.97981685, 'auroc': 0.99807763, 'binary_precision': 0.98376626, 'binary_recall': 0.9761598, 'binary_specificity': 0.98355263, 'binary_f1_score': 0.9799482}
confusion matrix:
      0     1
0  1495    25
1    37  1515
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.8414242, 'recall': 0.82086533, 'specificity': 0.82086533, 'f1': 0.81969345, 'auroc': 0.91028214, 'binary_precision': 0.9171843, 'binary_recall': 0.7031746, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.7960467}
confusion matrix:
     0    1
0  611   40
1  187  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.80995476, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.80357146, 'auroc': 0.8847407, 'binary_precision': 0.85128206, 'binary_recall': 0.73777777, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.7904762}
confusion matrix:
     0    1
0  196   29
1   59  166
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 00:57:47.645081,epoch time: 0:02:50.323884,used: 0:11:21.718343,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9404297, 'precision': 0.94652456, 'recall': 0.93969464, 'specificity': 0.93969464, 'f1': 0.9401473, 'auroc': 0.99726355, 'binary_precision': 0.8975101, 'binary_recall': 0.99614394, 'binary_specificity': 0.8832454, 'binary_f1_score': 0.9442582}
confusion matrix:
      0     1
0  1339   177
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.83536756, 'recall': 0.8301587, 'specificity': 0.8301587, 'f1': 0.8285278, 'auroc': 0.90858996, 'binary_precision': 0.7850208, 'binary_recall': 0.8984127, 'binary_specificity': 0.7619048, 'binary_f1_score': 0.83789784}
confusion matrix:
     0    1
0  496  155
1   64  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.7961565, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.7607098, 'auroc': 0.9018469, 'binary_precision': 0.7027027, 'binary_recall': 0.92444444, 'binary_specificity': 0.60888886, 'binary_f1_score': 0.7984645}
confusion matrix:
     0    1
0  137   88
1   17  208
better model found
persisted
after epoch: 5,now: 2024-07-26 01:00:38.079422,epoch time: 0:02:50.434341,used: 0:14:12.152684,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915229, 'recall': 0.9915513, 'specificity': 0.9915513, 'f1': 0.9915354, 'auroc': 0.99954426, 'binary_precision': 0.9929078, 'binary_recall': 0.9903537, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9916291}
confusion matrix:
      0     1
0  1506    11
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.84933645, 'precision': 0.85734296, 'recall': 0.84810543, 'specificity': 0.84810543, 'f1': 0.8481337, 'auroc': 0.91737926, 'binary_precision': 0.90689015, 'binary_recall': 0.77301586, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.8346186}
confusion matrix:
     0    1
0  601   50
1  143  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.87364686, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85870993, 'auroc': 0.91901237, 'binary_precision': 0.94505495, 'binary_recall': 0.7644445, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8452089}
confusion matrix:
     0    1
0  215   10
1   53  172
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 01:03:28.753656,epoch time: 0:02:50.674234,used: 0:17:02.826918,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911895, 'recall': 0.99124044, 'specificity': 0.99124044, 'f1': 0.9912098, 'auroc': 0.9996278, 'binary_precision': 0.9935484, 'binary_recall': 0.98908156, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.99130994}
confusion matrix:
      0     1
0  1505    10
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.84153, 'precision': 0.8463684, 'recall': 0.8424987, 'specificity': 0.8424987, 'f1': 0.8412045, 'auroc': 0.9153513, 'binary_precision': 0.8011283, 'binary_recall': 0.9015873, 'binary_specificity': 0.78341013, 'binary_f1_score': 0.8483943}
confusion matrix:
     0    1
0  510  141
1   62  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.80807024, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.8012791, 'auroc': 0.90004444, 'binary_precision': 0.765625, 'binary_recall': 0.8711111, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.81496876}
confusion matrix:
     0    1
0  165   60
1   29  196
early stop counter: 1
val acc:0.8415300250053406, best validation acc: 0.8493364453315735, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 7,now: 2024-07-26 01:06:17.442850,epoch time: 0:02:48.689194,used: 0:19:51.516112,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97797453, 'recall': 0.977793, 'specificity': 0.977793, 'f1': 0.97785723, 'auroc': 0.9982152, 'binary_precision': 0.97328246, 'binary_recall': 0.9832905, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9782609}
confusion matrix:
      0     1
0  1474    42
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.8360656, 'precision': 0.85813606, 'recall': 0.83402455, 'specificity': 0.83402455, 'f1': 0.83287483, 'auroc': 0.9253993, 'binary_precision': 0.943038, 'binary_recall': 0.7095238, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.8097826}
confusion matrix:
     0    1
0  624   27
1  183  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8706433, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8341001, 'auroc': 0.9286173, 'binary_precision': 0.98101264, 'binary_recall': 0.6888889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8093995}
confusion matrix:
     0    1
0  222    3
1   70  155
early stop counter: 2
val acc:0.8360655903816223, best validation acc: 0.8493364453315735, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 8,now: 2024-07-26 01:09:06.050185,epoch time: 0:02:48.607335,used: 0:22:40.123447,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.97275555, 'recall': 0.9725953, 'specificity': 0.9725953, 'f1': 0.972649, 'auroc': 0.99615645, 'binary_precision': 0.96813256, 'binary_recall': 0.9781069, 'binary_specificity': 0.96708363, 'binary_f1_score': 0.97309417}
confusion matrix:
      0     1
0  1469    50
1    34  1519
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8532131, 'recall': 0.8533026, 'specificity': 0.8533026, 'f1': 0.8532245, 'auroc': 0.916129, 'binary_precision': 0.84639496, 'binary_recall': 0.85714287, 'binary_specificity': 0.8494624, 'binary_f1_score': 0.851735}
confusion matrix:
     0    1
0  553   98
1   90  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8633721, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8547746, 'auroc': 0.9138963, 'binary_precision': 0.9166667, 'binary_recall': 0.7822222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  209   16
1   49  176
better model found
persisted
after epoch: 9,now: 2024-07-26 01:11:55.376452,epoch time: 0:02:49.326267,used: 0:25:29.449714,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874152, 'recall': 0.987422, 'specificity': 0.987422, 'f1': 0.9873047, 'auroc': 0.9980098, 'binary_precision': 0.9980263, 'binary_recall': 0.97681904, 'binary_specificity': 0.998025, 'binary_f1_score': 0.9873088}
confusion matrix:
      0     1
0  1516     3
1    36  1517
---- Validation: 
scalar performance:
{'acc': 0.7798595, 'precision': 0.8197143, 'recall': 0.77693295, 'specificity': 0.77693295, 'f1': 0.7715012, 'auroc': 0.8989899, 'binary_precision': 0.9285714, 'binary_recall': 0.5984127, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.7277992}
confusion matrix:
     0    1
0  622   29
1  253  377
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7861351, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7543916, 'auroc': 0.85607904, 'binary_precision': 0.87261146, 'binary_recall': 0.60888886, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.7172774}
confusion matrix:
     0    1
0  205   20
1   88  137
early stop counter: 1
val acc:0.7798594832420349, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.855555534362793 / 0.8600000143051147
after epoch: 10,now: 2024-07-26 01:14:44.233717,epoch time: 0:02:48.857265,used: 0:28:18.306979,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.96648216, 'recall': 0.96495175, 'specificity': 0.96495175, 'f1': 0.96449924, 'auroc': 0.99934375, 'binary_precision': 1.0, 'binary_recall': 0.9299035, 'binary_specificity': 1.0, 'binary_f1_score': 0.9636788}
confusion matrix:
      0     1
0  1517     0
1   109  1446
---- Validation: 
scalar performance:
{'acc': 0.5698673, 'precision': 0.7380414, 'recall': 0.562852, 'specificity': 0.562852, 'f1': 0.46824485, 'auroc': 0.88313705, 'binary_precision': 0.93406594, 'binary_recall': 0.13492064, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.23578367}
confusion matrix:
     0   1
0  645   6
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5222222, 'precision': 0.68430537, 'recall': 0.5222222, 'specificity': 0.5222222, 'f1': 0.38757682, 'auroc': 0.892563, 'binary_precision': 0.85714287, 'binary_recall': 0.053333335, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.10041842}
confusion matrix:
     0   1
0  223   2
1  213  12
early stop counter: 2
val acc:0.5698673129081726, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.855555534362793 / 0.8600000143051147
after epoch: 11,now: 2024-07-26 01:17:32.980215,epoch time: 0:02:48.746498,used: 0:31:07.053477,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98671454, 'recall': 0.98676836, 'specificity': 0.98676836, 'f1': 0.98665357, 'auroc': 0.99908376, 'binary_precision': 0.9960682, 'binary_recall': 0.977492, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9866927}
confusion matrix:
      0     1
0  1511     6
1    35  1520
---- Validation: 
scalar performance:
{'acc': 0.78298205, 'precision': 0.8185796, 'recall': 0.7802099, 'specificity': 0.7802099, 'f1': 0.7755566, 'auroc': 0.90032184, 'binary_precision': 0.92105263, 'binary_recall': 0.6111111, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.7347328}
confusion matrix:
     0    1
0  618   33
1  245  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8499185, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8237385, 'auroc': 0.90688396, 'binary_precision': 0.94011974, 'binary_recall': 0.69777775, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8010204}
confusion matrix:
     0    1
0  215   10
1   68  157
early stop counter: 3
val acc:0.7829820513725281, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.855555534362793 / 0.8600000143051147
after epoch: 12,now: 2024-07-26 01:20:21.669037,epoch time: 0:02:48.688822,used: 0:33:55.742299,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9825117, 'recall': 0.9823628, 'specificity': 0.9823628, 'f1': 0.98241687, 'auroc': 0.99889016, 'binary_precision': 0.97833014, 'binary_recall': 0.9871383, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9827145}
confusion matrix:
      0     1
0  1483    34
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.86416864, 'precision': 0.86647713, 'recall': 0.86351764, 'specificity': 0.86351764, 'f1': 0.86377335, 'auroc': 0.92589426, 'binary_precision': 0.8917526, 'binary_recall': 0.8238095, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.85643566}
confusion matrix:
     0    1
0  588   63
1  111  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.87081337, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.841629, 'auroc': 0.9288099, 'binary_precision': 0.969697, 'binary_recall': 0.7111111, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8205129}
confusion matrix:
     0    1
0  220    5
1   65  160
better model found
persisted
after epoch: 13,now: 2024-07-26 01:23:10.875553,epoch time: 0:02:49.206516,used: 0:36:44.948815,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9832653, 'recall': 0.9832481, 'specificity': 0.9832481, 'f1': 0.9830729, 'auroc': 0.99919283, 'binary_precision': 0.9966975, 'binary_recall': 0.96979433, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9830619}
confusion matrix:
      0     1
0  1511     5
1    47  1509
---- Validation: 
scalar performance:
{'acc': 0.71975017, 'precision': 0.7918669, 'recall': 0.715617, 'specificity': 0.715617, 'f1': 0.6987791, 'auroc': 0.9046552, 'binary_precision': 0.93290734, 'binary_recall': 0.46349207, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.6193001}
confusion matrix:
     0    1
0  630   21
1  338  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62, 'precision': 0.75253576, 'recall': 0.62, 'specificity': 0.62, 'f1': 0.56261265, 'auroc': 0.8772938, 'binary_precision': 0.9354839, 'binary_recall': 0.25777778, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.40418118}
confusion matrix:
     0   1
0  221   4
1  167  58
early stop counter: 1
val acc:0.719750165939331, best validation acc: 0.864168643951416, corresponding to test acc:                         0.8444444537162781 / 0.8600000143051147
after epoch: 14,now: 2024-07-26 01:25:59.467264,epoch time: 0:02:48.591711,used: 0:39:33.540526,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902158, 'recall': 0.99025816, 'specificity': 0.99025816, 'f1': 0.9902332, 'auroc': 0.9990381, 'binary_precision': 0.9922581, 'binary_recall': 0.9884319, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.99034125}
confusion matrix:
      0     1
0  1504    12
1    18  1538
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.8712168, 'recall': 0.8690988, 'specificity': 0.8690988, 'f1': 0.8693465, 'auroc': 0.9270036, 'binary_precision': 0.89170897, 'binary_recall': 0.8365079, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.86322683}
confusion matrix:
     0    1
0  587   64
1  103  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.82967687, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8287866, 'auroc': 0.89864695, 'binary_precision': 0.8457944, 'binary_recall': 0.80444443, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8246014}
confusion matrix:
     0    1
0  192   33
1   44  181
better model found
persisted
after epoch: 15,now: 2024-07-26 01:28:48.836880,epoch time: 0:02:49.369616,used: 0:42:22.910142,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9926319, 'recall': 0.99245083, 'specificity': 0.99245083, 'f1': 0.99251103, 'auroc': 0.9997698, 'binary_precision': 0.9872612, 'binary_recall': 0.9980683, 'binary_specificity': 0.98683345, 'binary_f1_score': 0.99263537}
confusion matrix:
      0     1
0  1499    20
1     3  1550
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.8250989, 'recall': 0.8077061, 'specificity': 0.8077061, 'f1': 0.80654335, 'auroc': 0.9030405, 'binary_precision': 0.8922764, 'binary_recall': 0.6968254, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.7825312}
confusion matrix:
     0    1
0  598   53
1  191  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.7515528, 'recall': 0.68, 'specificity': 0.68, 'f1': 0.65550244, 'auroc': 0.8845235, 'binary_precision': 0.8857143, 'binary_recall': 0.41333333, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.56363636}
confusion matrix:
     0   1
0  213  12
1  132  93
early stop counter: 1
val acc:0.8095238208770752, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8288888931274414 / 0.8600000143051147
after epoch: 16,now: 2024-07-26 01:31:37.359989,epoch time: 0:02:48.523109,used: 0:45:11.433251,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99024284, 'recall': 0.99030936, 'specificity': 0.99030936, 'f1': 0.990234, 'auroc': 0.9980906, 'binary_precision': 0.9967405, 'binary_recall': 0.98391247, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9902849}
confusion matrix:
      0     1
0  1513     5
1    25  1529
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.8579444, 'recall': 0.84974396, 'specificity': 0.84974396, 'f1': 0.8498303, 'auroc': 0.9309578, 'binary_precision': 0.9042357, 'binary_recall': 0.77936506, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.83716965}
confusion matrix:
     0    1
0  599   52
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8214012, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7939923, 'auroc': 0.8841877, 'binary_precision': 0.9085366, 'binary_recall': 0.6622222, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.7660668}
confusion matrix:
     0    1
0  210   15
1   76  149
early stop counter: 2
val acc:0.8508977293968201, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8288888931274414 / 0.8600000143051147
after epoch: 17,now: 2024-07-26 01:34:25.769179,epoch time: 0:02:48.409190,used: 0:47:59.842441,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9779319, 'recall': 0.9775064, 'specificity': 0.9775064, 'f1': 0.97721136, 'auroc': 0.9972948, 'binary_precision': 1.0, 'binary_recall': 0.95501286, 'binary_specificity': 1.0, 'binary_f1_score': 0.97698885}
confusion matrix:
      0     1
0  1516     0
1    70  1486
---- Validation: 
scalar performance:
{'acc': 0.7572209, 'precision': 0.8093264, 'recall': 0.7538147, 'specificity': 0.7538147, 'f1': 0.74485624, 'auroc': 0.9171726, 'binary_precision': 0.9322493, 'binary_recall': 0.5460318, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.6886887}
confusion matrix:
     0    1
0  626   25
1  286  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.7742947, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.63697016, 'auroc': 0.8971654, 'binary_precision': 0.9425287, 'binary_recall': 0.36444443, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.525641}
confusion matrix:
     0   1
0  220   5
1  143  82
early stop counter: 3
val acc:0.7572209239006042, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8288888931274414 / 0.8600000143051147
after epoch: 18,now: 2024-07-26 01:37:13.482396,epoch time: 0:02:47.713217,used: 0:50:47.555658,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9852564, 'recall': 0.9849248, 'specificity': 0.9849248, 'f1': 0.9850199, 'auroc': 0.99913013, 'binary_precision': 0.9772152, 'binary_recall': 0.993565, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.9853223}
confusion matrix:
      0     1
0  1482    36
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.85870415, 'precision': 0.86529195, 'recall': 0.85760367, 'specificity': 0.85760367, 'f1': 0.8577666, 'auroc': 0.93351865, 'binary_precision': 0.9104205, 'binary_recall': 0.7904762, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.8462192}
confusion matrix:
     0    1
0  602   49
1  132  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8292731, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.7901843, 'auroc': 0.9017284, 'binary_precision': 0.9346405, 'binary_recall': 0.63555557, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.7566138}
confusion matrix:
     0    1
0  215   10
1   82  143
early stop counter: 4
val acc:0.858704149723053, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8288888931274414 / 0.8600000143051147
after epoch: 19,now: 2024-07-26 01:40:01.636784,epoch time: 0:02:48.154388,used: 0:53:35.710046,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98770624, 'recall': 0.9875772, 'specificity': 0.9875772, 'f1': 0.9876267, 'auroc': 0.9991712, 'binary_precision': 0.9840561, 'binary_recall': 0.9916452, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.9878361}
confusion matrix:
      0     1
0  1491    25
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.863388, 'precision': 0.86559856, 'recall': 0.8627496, 'specificity': 0.8627496, 'f1': 0.86300194, 'auroc': 0.9176334, 'binary_precision': 0.89022297, 'binary_recall': 0.8238095, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.8557296}
confusion matrix:
     0    1
0  587   64
1  111  519
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.82453763, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7987629, 'auroc': 0.87071604, 'binary_precision': 0.9096386, 'binary_recall': 0.6711111, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.7723785}
confusion matrix:
     0    1
0  210   15
1   74  151
early stop counter: 5
val acc:0.8633880019187927, best validation acc: 0.8696330785751343, corresponding to test acc:                         0.8288888931274414 / 0.8600000143051147
after epoch: 20,now: 2024-07-26 01:42:49.634270,epoch time: 0:02:47.997486,used: 0:56:23.707532,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_46_25_seed_1_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 20 with time: 0:56:23.707532 at 2024-07-26 01:42:49.634270
persisted model performance metric: 

scalar performance:
{'acc': 0.8288889, 'precision': 0.82967687, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8287866, 'auroc': 0.89864695, 'binary_precision': 0.8457944, 'binary_recall': 0.80444443, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8246014}
confusion matrix:
     0    1
0  192   33
1   44  181
oracle model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.87364686, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85870993, 'auroc': 0.91901237, 'binary_precision': 0.94505495, 'binary_recall': 0.7644445, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8452089}
confusion matrix:
     0    1
0  215   10
1   53  172
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2796 MiB |   9236 MiB | 207782 GiB | 207779 GiB |
|       from large pool |   2704 MiB |   9160 MiB | 205970 GiB | 205967 GiB |
|       from small pool |     91 MiB |    132 MiB |   1812 GiB |   1812 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2796 MiB |   9236 MiB | 207782 GiB | 207779 GiB |
|       from large pool |   2704 MiB |   9160 MiB | 205970 GiB | 205967 GiB |
|       from small pool |     91 MiB |    132 MiB |   1812 GiB |   1812 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 207543 GiB | 207541 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 205734 GiB | 205731 GiB |
|       from small pool |     91 MiB |    132 MiB |   1809 GiB |   1809 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10088 MiB |  10180 MiB |  16548 MiB |   6460 MiB |
|       from large pool |   9948 MiB |  10044 MiB |  16374 MiB |   6426 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1183 MiB |   1841 MiB | 151438 GiB | 151436 GiB |
|       from large pool |   1173 MiB |   1835 MiB | 149573 GiB | 149572 GiB |
|       from small pool |     10 MiB |     56 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   29414 K  |   29412 K  |
|       from large pool |     392    |     816    |   14770 K  |   14770 K  |
|       from small pool |    2084    |    2780    |   14643 K  |   14641 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   29414 K  |   29412 K  |
|       from large pool |     392    |     816    |   14770 K  |   14770 K  |
|       from small pool |    2084    |    2780    |   14643 K  |   14641 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     334    |     485    |     200    |
|       from large pool |     215    |     266    |     398    |     183    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     153    |     321    |   16324 K  |   16324 K  |
|       from large pool |      83    |     251    |    8799 K  |    8799 K  |
|       from small pool |      70    |     229    |    7524 K  |    7524 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9236 MiB | 207782 GiB | 207782 GiB |
|       from large pool |  16640 KiB |   9160 MiB | 205970 GiB | 205970 GiB |
|       from small pool |      0 KiB |    132 MiB |   1812 GiB |   1812 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9236 MiB | 207782 GiB | 207782 GiB |
|       from large pool |  16640 KiB |   9160 MiB | 205970 GiB | 205970 GiB |
|       from small pool |      0 KiB |    132 MiB |   1812 GiB |   1812 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 207543 GiB | 207543 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 205734 GiB | 205734 GiB |
|       from small pool |      0 KiB |    132 MiB |   1809 GiB |   1809 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3980 MiB |  10180 MiB |  16548 MiB |  12568 MiB |
|       from large pool |   3878 MiB |  10044 MiB |  16374 MiB |  12496 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1841 MiB | 151439 GiB | 151439 GiB |
|       from large pool |  24320 KiB |   1835 MiB | 149574 GiB | 149574 GiB |
|       from small pool |      0 KiB |     56 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   29414 K  |   29414 K  |
|       from large pool |       2    |     816    |   14770 K  |   14770 K  |
|       from small pool |       0    |    2780    |   14643 K  |   14643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   29414 K  |   29414 K  |
|       from large pool |       2    |     816    |   14770 K  |   14770 K  |
|       from small pool |       0    |    2780    |   14643 K  |   14643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     334    |     485    |     350    |
|       from large pool |      84    |     266    |     398    |     314    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   16325 K  |   16325 K  |
|       from large pool |       3    |     251    |    8800 K  |    8800 K  |
|       from small pool |       0    |     229    |    7525 K  |    7525 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9236 MiB | 207782 GiB | 207782 GiB |
|       from large pool |  16640 KiB |   9160 MiB | 205970 GiB | 205970 GiB |
|       from small pool |      0 KiB |    132 MiB |   1812 GiB |   1812 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9236 MiB | 207782 GiB | 207782 GiB |
|       from large pool |  16640 KiB |   9160 MiB | 205970 GiB | 205970 GiB |
|       from small pool |      0 KiB |    132 MiB |   1812 GiB |   1812 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 207543 GiB | 207543 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 205734 GiB | 205734 GiB |
|       from small pool |      0 KiB |    132 MiB |   1809 GiB |   1809 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3980 MiB |  10180 MiB |  16548 MiB |  12568 MiB |
|       from large pool |   3878 MiB |  10044 MiB |  16374 MiB |  12496 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1841 MiB | 151439 GiB | 151439 GiB |
|       from large pool |  24320 KiB |   1835 MiB | 149574 GiB | 149574 GiB |
|       from small pool |      0 KiB |     56 MiB |   1864 GiB |   1864 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   29414 K  |   29414 K  |
|       from large pool |       2    |     816    |   14770 K  |   14770 K  |
|       from small pool |       0    |    2780    |   14643 K  |   14643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   29414 K  |   29414 K  |
|       from large pool |       2    |     816    |   14770 K  |   14770 K  |
|       from small pool |       0    |    2780    |   14643 K  |   14643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     334    |     485    |     350    |
|       from large pool |      84    |     266    |     398    |     314    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   16325 K  |   16325 K  |
|       from large pool |       3    |     251    |    8800 K  |    8800 K  |
|       from small pool |       0    |     229    |    7525 K  |    7525 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697

 Experiment start at: 2024-07-26 01:43:23.192074
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9548429, 'precision': 0.95550406, 'recall': 0.95500463, 'specificity': 0.95500463, 'f1': 0.9548352, 'auroc': 0.9877107, 'binary_precision': 0.97493225, 'binary_recall': 0.9344156, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.9542441}
confusion matrix:
      0     1
0  1479    37
1   101  1439
---- Validation: 
scalar performance:
{'acc': 0.7339593, 'precision': 0.7520773, 'recall': 0.73018783, 'specificity': 0.73018783, 'f1': 0.72686267, 'auroc': 0.8243054, 'binary_precision': 0.81333333, 'binary_recall': 0.58842444, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.6828359}
confusion matrix:
     0    1
0  572   84
1  256  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.82281315, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8136606, 'auroc': 0.8791367, 'binary_precision': 0.87362635, 'binary_recall': 0.7361111, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.798995}
confusion matrix:
     0    1
0  193   23
1   57  159
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:46:11.803053,epoch time: 0:02:48.610979,used: 0:02:48.610979,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96695024, 'precision': 0.96747136, 'recall': 0.9670947, 'specificity': 0.9670947, 'f1': 0.9669465, 'auroc': 0.9944993, 'binary_precision': 0.9851652, 'binary_recall': 0.9487013, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9665895}
confusion matrix:
      0     1
0  1494    22
1    79  1461
---- Validation: 
scalar performance:
{'acc': 0.7809077, 'precision': 0.8110329, 'recall': 0.7766695, 'specificity': 0.7766695, 'f1': 0.773574, 'auroc': 0.8823744, 'binary_precision': 0.90140843, 'binary_recall': 0.61736333, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.7328244}
confusion matrix:
     0    1
0  614   42
1  238  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.80958647, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.77752453, 'auroc': 0.89587617, 'binary_precision': 0.9013158, 'binary_recall': 0.6342593, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.7445652}
confusion matrix:
     0    1
0  201   15
1   79  137
better model found
persisted
after epoch: 2,now: 2024-07-26 01:49:00.251953,epoch time: 0:02:48.448900,used: 0:05:37.059879,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9679319, 'precision': 0.96792376, 'recall': 0.9679454, 'specificity': 0.9679454, 'f1': 0.9679308, 'auroc': 0.9945829, 'binary_precision': 0.970013, 'binary_recall': 0.9662338, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9681197}
confusion matrix:
      0     1
0  1470    46
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.7668232, 'precision': 0.79239655, 'recall': 0.77065766, 'specificity': 0.77065766, 'f1': 0.76320386, 'auroc': 0.90439725, 'binary_precision': 0.6990172, 'binary_recall': 0.914791, 'binary_specificity': 0.6265244, 'binary_f1_score': 0.79247916}
confusion matrix:
     0    1
0  411  245
1   53  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7708333, 'precision': 0.7820095, 'recall': 0.7708334, 'specificity': 0.7708334, 'f1': 0.76854, 'auroc': 0.8880744, 'binary_precision': 0.7258687, 'binary_recall': 0.8703704, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.7915789}
confusion matrix:
     0    1
0  145   71
1   28  188
early stop counter: 1
val acc:0.7668231725692749, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.7824074029922485 / 0.8148148059844971
after epoch: 3,now: 2024-07-26 01:51:47.625044,epoch time: 0:02:47.373091,used: 0:08:24.432970,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9766005, 'recall': 0.97625244, 'specificity': 0.97625244, 'f1': 0.9761101, 'auroc': 0.997126, 'binary_precision': 0.9939394, 'binary_recall': 0.95844156, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9758678}
confusion matrix:
      0     1
0  1507     9
1    64  1476
---- Validation: 
scalar performance:
{'acc': 0.7402191, 'precision': 0.802871, 'recall': 0.73403555, 'specificity': 0.73403555, 'f1': 0.7226099, 'auroc': 0.8898689, 'binary_precision': 0.93413174, 'binary_recall': 0.5016077, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.6527197}
confusion matrix:
     0    1
0  634   22
1  310  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.650463, 'precision': 0.7802731, 'recall': 0.650463, 'specificity': 0.650463, 'f1': 0.60469043, 'auroc': 0.89774096, 'binary_precision': 0.9710145, 'binary_recall': 0.3101852, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.47017545}
confusion matrix:
     0   1
0  214   2
1  149  67
early stop counter: 2
val acc:0.7402191162109375, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.7824074029922485 / 0.8148148059844971
after epoch: 4,now: 2024-07-26 01:54:35.207293,epoch time: 0:02:47.582249,used: 0:11:12.015219,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.96847963, 'recall': 0.9668831, 'specificity': 0.9668831, 'f1': 0.96660125, 'auroc': 0.99797225, 'binary_precision': 1.0, 'binary_recall': 0.93376625, 'binary_specificity': 1.0, 'binary_f1_score': 0.96574885}
confusion matrix:
      0     1
0  1516     0
1   102  1438
---- Validation: 
scalar performance:
{'acc': 0.6025039, 'precision': 0.7450292, 'recall': 0.5920565, 'specificity': 0.5920565, 'f1': 0.52291006, 'auroc': 0.87505877, 'binary_precision': 0.92537314, 'binary_recall': 0.19935691, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.32804233}
confusion matrix:
     0    1
0  646   10
1  498  124
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.662037, 'precision': 0.78536916, 'recall': 0.662037, 'specificity': 0.662037, 'f1': 0.62109816, 'auroc': 0.88629544, 'binary_precision': 0.972973, 'binary_recall': 0.33333334, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.49655172}
confusion matrix:
     0   1
0  214   2
1  144  72
early stop counter: 3
val acc:0.6025038957595825, best validation acc: 0.7809076905250549, corresponding to test acc:                         0.7824074029922485 / 0.8148148059844971
after epoch: 5,now: 2024-07-26 01:57:23.013981,epoch time: 0:02:47.806688,used: 0:13:59.821907,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9633508, 'precision': 0.96508574, 'recall': 0.96312237, 'specificity': 0.96312237, 'f1': 0.9633014, 'auroc': 0.997905, 'binary_precision': 0.9385749, 'binary_recall': 0.99220777, 'binary_specificity': 0.9340369, 'binary_f1_score': 0.9646464}
confusion matrix:
      0     1
0  1416   100
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.7992219, 'recall': 0.79056054, 'specificity': 0.79056054, 'f1': 0.7905767, 'auroc': 0.87259823, 'binary_precision': 0.8374291, 'binary_recall': 0.71221864, 'binary_specificity': 0.86890244, 'binary_f1_score': 0.7697654}
confusion matrix:
     0    1
0  570   86
1  179  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.80105746, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.77619624, 'auroc': 0.86668384, 'binary_precision': 0.8805031, 'binary_recall': 0.6481481, 'binary_specificity': 0.912037, 'binary_f1_score': 0.7466666}
confusion matrix:
     0    1
0  197   19
1   76  140
better model found
persisted
after epoch: 6,now: 2024-07-26 02:00:11.335609,epoch time: 0:02:48.321628,used: 0:16:48.143535,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98266506, 'recall': 0.9826483, 'specificity': 0.9826483, 'f1': 0.98265576, 'auroc': 0.9987129, 'binary_precision': 0.98185354, 'binary_recall': 0.98376626, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98280895}
confusion matrix:
      0     1
0  1488    28
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.8317684, 'precision': 0.83888716, 'recall': 0.82979524, 'specificity': 0.82979524, 'f1': 0.8301955, 'auroc': 0.90622056, 'binary_precision': 0.8818011, 'binary_recall': 0.75562704, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.8138528}
confusion matrix:
     0    1
0  593   63
1  152  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.85137534, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.799003, 'auroc': 0.9248757, 'binary_precision': 0.9782609, 'binary_recall': 0.625, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7627119}
confusion matrix:
     0    1
0  213    3
1   81  135
better model found
persisted
after epoch: 7,now: 2024-07-26 02:02:59.584753,epoch time: 0:02:48.249144,used: 0:19:36.392679,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9892552, 'recall': 0.98926, 'specificity': 0.98926, 'f1': 0.98920155, 'auroc': 0.99878395, 'binary_precision': 0.99670404, 'binary_recall': 0.9818182, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98920506}
confusion matrix:
      0     1
0  1511     5
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.820705, 'recall': 0.7987486, 'specificity': 0.7987486, 'f1': 0.7977973, 'auroc': 0.87560534, 'binary_precision': 0.89171976, 'binary_recall': 0.6752412, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.768527}
confusion matrix:
     0    1
0  605   51
1  202  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.83253676, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.80694103, 'auroc': 0.9036994, 'binary_precision': 0.91875, 'binary_recall': 0.6805556, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.78191483}
confusion matrix:
     0    1
0  203   13
1   69  147
early stop counter: 1
val acc:0.8020344376564026, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8055555820465088 / 0.8148148059844971
after epoch: 8,now: 2024-07-26 02:05:46.849903,epoch time: 0:02:47.265150,used: 0:22:23.657829,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9857367, 'recall': 0.98568344, 'specificity': 0.98568344, 'f1': 0.98560196, 'auroc': 0.998234, 'binary_precision': 0.9960212, 'binary_recall': 0.9753247, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9855643}
confusion matrix:
      0     1
0  1510     6
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.78403753, 'precision': 0.8244505, 'recall': 0.7792599, 'specificity': 0.7792599, 'f1': 0.77500975, 'auroc': 0.8940451, 'binary_precision': 0.9325, 'binary_recall': 0.59967846, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.7299413}
confusion matrix:
     0    1
0  629   27
1  249  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6226852, 'precision': 0.7529274, 'recall': 0.6226852, 'specificity': 0.6226852, 'f1': 0.5669346, 'auroc': 0.88563097, 'binary_precision': 0.93442625, 'binary_recall': 0.2638889, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.41155237}
confusion matrix:
     0   1
0  212   4
1  159  57
early stop counter: 2
val acc:0.7840375304222107, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8055555820465088 / 0.8148148059844971
after epoch: 9,now: 2024-07-26 02:08:34.256117,epoch time: 0:02:47.406214,used: 0:25:11.064043,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9769753, 'recall': 0.97629356, 'specificity': 0.97629356, 'f1': 0.9761069, 'auroc': 0.99837834, 'binary_precision': 0.99931926, 'binary_recall': 0.9532468, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9757395}
confusion matrix:
      0     1
0  1515     1
1    72  1468
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.8009242, 'recall': 0.76892257, 'specificity': 0.76892257, 'f1': 0.7657577, 'auroc': 0.8474752, 'binary_precision': 0.8860465, 'binary_recall': 0.6125402, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.7243346}
confusion matrix:
     0    1
0  607   49
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.7997533, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.7391771, 'auroc': 0.8691487, 'binary_precision': 0.921875, 'binary_recall': 0.5462963, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.68604654}
confusion matrix:
     0    1
0  206   10
1   98  118
early stop counter: 3
val acc:0.773082971572876, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8055555820465088 / 0.8148148059844971
after epoch: 10,now: 2024-07-26 02:11:21.772616,epoch time: 0:02:47.516499,used: 0:27:58.580542,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879614, 'recall': 0.98795617, 'specificity': 0.98795617, 'f1': 0.98789275, 'auroc': 0.99866235, 'binary_precision': 0.9960396, 'binary_recall': 0.97987014, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9878888}
confusion matrix:
      0     1
0  1510     6
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.7574335, 'precision': 0.8182447, 'recall': 0.75151217, 'specificity': 0.75151217, 'f1': 0.742269, 'auroc': 0.8930973, 'binary_precision': 0.95086706, 'binary_recall': 0.5289389, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.67975205}
confusion matrix:
     0    1
0  639   17
1  293  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6759259, 'precision': 0.7914773, 'recall': 0.6759259, 'specificity': 0.6759259, 'f1': 0.64027405, 'auroc': 0.9096579, 'binary_precision': 0.975, 'binary_recall': 0.3611111, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.527027}
confusion matrix:
     0   1
0  214   2
1  138  78
early stop counter: 4
val acc:0.7574334740638733, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8055555820465088 / 0.8148148059844971
after epoch: 11,now: 2024-07-26 02:14:08.756883,epoch time: 0:02:46.984267,used: 0:30:45.564809,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9757853, 'precision': 0.9763226, 'recall': 0.9756656, 'specificity': 0.9756656, 'f1': 0.9757726, 'auroc': 0.99802494, 'binary_precision': 0.962169, 'binary_recall': 0.9909091, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.9763276}
confusion matrix:
      0     1
0  1456    60
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.8208138, 'precision': 0.8208138, 'recall': 0.821041, 'specificity': 0.821041, 'f1': 0.82078207, 'auroc': 0.89277494, 'binary_precision': 0.80751175, 'binary_recall': 0.829582, 'binary_specificity': 0.8125, 'binary_f1_score': 0.81839806}
confusion matrix:
     0    1
0  533  123
1  106  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7708333, 'precision': 0.7708856, 'recall': 0.7708334, 'specificity': 0.7708334, 'f1': 0.7708222, 'auroc': 0.8620971, 'binary_precision': 0.7671233, 'binary_recall': 0.7777778, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.77241373}
confusion matrix:
     0    1
0  165   51
1   48  168
early stop counter: 5
val acc:0.820813775062561, best validation acc: 0.8317683935165405, corresponding to test acc:                         0.8055555820465088 / 0.8148148059844971
after epoch: 12,now: 2024-07-26 02:16:56.022390,epoch time: 0:02:47.265507,used: 0:33:32.830316,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_43_23_seed_2_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:33:32.830316 at 2024-07-26 02:16:56.022390
persisted model performance metric: 

scalar performance:
{'acc': 0.8055556, 'precision': 0.85137534, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.799003, 'auroc': 0.9248757, 'binary_precision': 0.9782609, 'binary_recall': 0.625, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7627119}
confusion matrix:
     0    1
0  213    3
1   81  135
oracle model performance metric: 

scalar performance:
{'acc': 0.8148148, 'precision': 0.82281315, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8136606, 'auroc': 0.8791367, 'binary_precision': 0.87362635, 'binary_recall': 0.7361111, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.798995}
confusion matrix:
     0    1
0  193   23
1   57  159
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2799 MiB |   9240 MiB | 287876 GiB | 287873 GiB |
|       from large pool |   2707 MiB |   9164 MiB | 285368 GiB | 285365 GiB |
|       from small pool |     91 MiB |    132 MiB |   2507 GiB |   2507 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2799 MiB |   9240 MiB | 287876 GiB | 287873 GiB |
|       from large pool |   2707 MiB |   9164 MiB | 285368 GiB | 285365 GiB |
|       from small pool |     91 MiB |    132 MiB |   2507 GiB |   2507 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 287478 GiB | 287475 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 284974 GiB | 284971 GiB |
|       from small pool |     91 MiB |    132 MiB |   2504 GiB |   2504 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10076 MiB |  10180 MiB |  22644 MiB |  12568 MiB |
|       from large pool |   9940 MiB |  10044 MiB |  22436 MiB |  12496 MiB |
|       from small pool |    136 MiB |    140 MiB |    208 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1068 MiB |   1841 MiB | 215294 GiB | 215293 GiB |
|       from large pool |   1056 MiB |   1835 MiB | 212715 GiB | 212714 GiB |
|       from small pool |     12 MiB |     56 MiB |   2579 GiB |   2579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   40734 K  |   40731 K  |
|       from large pool |     392    |     816    |   20458 K  |   20458 K  |
|       from small pool |    2072    |    2780    |   20275 K  |   20273 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   40734 K  |   40731 K  |
|       from large pool |     392    |     816    |   20458 K  |   20458 K  |
|       from small pool |    2072    |    2780    |   20275 K  |   20273 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     273    |     334    |     623    |     350    |
|       from large pool |     205    |     266    |     519    |     314    |
|       from small pool |      68    |      70    |     104    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     154    |     321    |   22602 K  |   22601 K  |
|       from large pool |      75    |     251    |   12150 K  |   12149 K  |
|       from small pool |      79    |     230    |   10452 K  |   10452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9240 MiB | 287876 GiB | 287876 GiB |
|       from large pool |  16640 KiB |   9164 MiB | 285368 GiB | 285368 GiB |
|       from small pool |      0 KiB |    132 MiB |   2507 GiB |   2507 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9240 MiB | 287876 GiB | 287876 GiB |
|       from large pool |  16640 KiB |   9164 MiB | 285368 GiB | 285368 GiB |
|       from small pool |      0 KiB |    132 MiB |   2507 GiB |   2507 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 287478 GiB | 287478 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 284974 GiB | 284974 GiB |
|       from small pool |      0 KiB |    132 MiB |   2504 GiB |   2504 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3868 MiB |  10180 MiB |  22644 MiB |  18776 MiB |
|       from large pool |   3764 MiB |  10044 MiB |  22436 MiB |  18672 MiB |
|       from small pool |    104 MiB |    140 MiB |    208 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1841 MiB | 215295 GiB | 215295 GiB |
|       from large pool |  24320 KiB |   1835 MiB | 212716 GiB | 212716 GiB |
|       from small pool |      0 KiB |     56 MiB |   2579 GiB |   2579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   40734 K  |   40734 K  |
|       from large pool |       2    |     816    |   20458 K  |   20458 K  |
|       from small pool |       0    |    2780    |   20275 K  |   20275 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   40734 K  |   40734 K  |
|       from large pool |       2    |     816    |   20458 K  |   20458 K  |
|       from small pool |       0    |    2780    |   20275 K  |   20275 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |     623    |     489    |
|       from large pool |      82    |     266    |     519    |     437    |
|       from small pool |      52    |      70    |     104    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   22602 K  |   22602 K  |
|       from large pool |       3    |     251    |   12150 K  |   12150 K  |
|       from small pool |       0    |     230    |   10452 K  |   10452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9240 MiB | 287876 GiB | 287876 GiB |
|       from large pool |  16640 KiB |   9164 MiB | 285368 GiB | 285368 GiB |
|       from small pool |      0 KiB |    132 MiB |   2507 GiB |   2507 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9240 MiB | 287876 GiB | 287876 GiB |
|       from large pool |  16640 KiB |   9164 MiB | 285368 GiB | 285368 GiB |
|       from small pool |      0 KiB |    132 MiB |   2507 GiB |   2507 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 287478 GiB | 287478 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 284974 GiB | 284974 GiB |
|       from small pool |      0 KiB |    132 MiB |   2504 GiB |   2504 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3868 MiB |  10180 MiB |  22644 MiB |  18776 MiB |
|       from large pool |   3764 MiB |  10044 MiB |  22436 MiB |  18672 MiB |
|       from small pool |    104 MiB |    140 MiB |    208 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1841 MiB | 215295 GiB | 215295 GiB |
|       from large pool |  24320 KiB |   1835 MiB | 212716 GiB | 212716 GiB |
|       from small pool |      0 KiB |     56 MiB |   2579 GiB |   2579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   40734 K  |   40734 K  |
|       from large pool |       2    |     816    |   20458 K  |   20458 K  |
|       from small pool |       0    |    2780    |   20275 K  |   20275 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   40734 K  |   40734 K  |
|       from large pool |       2    |     816    |   20458 K  |   20458 K  |
|       from small pool |       0    |    2780    |   20275 K  |   20275 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |     623    |     489    |
|       from large pool |      82    |     266    |     519    |     437    |
|       from small pool |      52    |      70    |     104    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   22602 K  |   22602 K  |
|       from large pool |       3    |     251    |   12150 K  |   12150 K  |
|       from small pool |       0    |     230    |   10452 K  |   10452 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697

 Experiment start at: 2024-07-26 02:17:29.287376
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.6770833, 'precision': 0.80285114, 'recall': 0.6722037, 'specificity': 0.6722037, 'f1': 0.63600504, 'auroc': 0.9892286, 'binary_precision': 0.6113949, 'binary_recall': 0.99807566, 'binary_specificity': 0.3463318, 'binary_f1_score': 0.75828457}
confusion matrix:
     0     1
0  524   989
1    3  1556
---- Validation: 
scalar performance:
{'acc': 0.50584567, 'precision': 0.7073405, 'recall': 0.51522976, 'specificity': 0.51522976, 'f1': 0.36454582, 'auroc': 0.8771926, 'binary_precision': 0.4980143, 'binary_recall': 0.99682033, 'binary_specificity': 0.033639144, 'binary_f1_score': 0.6641949}
confusion matrix:
    0    1
0  22  632
1   2  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.9108148, 'binary_precision': 0.5, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.6666667}
confusion matrix:
   0    1
0  0  225
1  0  225
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:20:19.492642,epoch time: 0:02:50.205266,used: 0:02:50.205266,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9738843, 'recall': 0.97383714, 'specificity': 0.97383714, 'f1': 0.9736327, 'auroc': 0.9969608, 'binary_precision': 0.9887417, 'binary_recall': 0.9588953, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.9735898}
confusion matrix:
      0     1
0  1498    17
1    64  1493
---- Validation: 
scalar performance:
{'acc': 0.79657054, 'precision': 0.80406296, 'recall': 0.7949891, 'specificity': 0.7949891, 'f1': 0.7946524, 'auroc': 0.8680129, 'binary_precision': 0.8471698, 'binary_recall': 0.7138315, 'binary_specificity': 0.8761468, 'binary_f1_score': 0.7748059}
confusion matrix:
     0    1
0  573   81
1  180  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8245021, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82443655, 'auroc': 0.90064204, 'binary_precision': 0.8288288, 'binary_recall': 0.81777775, 'binary_specificity': 0.83111113, 'binary_f1_score': 0.82326615}
confusion matrix:
     0    1
0  187   38
1   41  184
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:23:10.553679,epoch time: 0:02:51.061037,used: 0:05:41.266303,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9809109, 'recall': 0.98093224, 'specificity': 0.98093224, 'f1': 0.98079425, 'auroc': 0.99841416, 'binary_precision': 0.99210525, 'binary_recall': 0.9697749, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.98081297}
confusion matrix:
      0     1
0  1505    12
1    47  1508
---- Validation: 
scalar performance:
{'acc': 0.8144973, 'precision': 0.83039665, 'recall': 0.8123301, 'specificity': 0.8123301, 'f1': 0.81145406, 'auroc': 0.8934672, 'binary_precision': 0.898167, 'binary_recall': 0.70111287, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.7875}
confusion matrix:
     0    1
0  604   50
1  188  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.85783625, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8404821, 'auroc': 0.9190518, 'binary_precision': 0.9325843, 'binary_recall': 0.73777777, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.82382137}
confusion matrix:
     0    1
0  213   12
1   59  166
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 02:26:02.723994,epoch time: 0:02:52.170315,used: 0:08:33.436618,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9746902, 'recall': 0.9733336, 'specificity': 0.9733336, 'f1': 0.9736008, 'auroc': 0.9983233, 'binary_precision': 0.955583, 'binary_recall': 0.99422336, 'binary_specificity': 0.95244384, 'binary_f1_score': 0.9745203}
confusion matrix:
      0     1
0  1442    72
1     9  1549
---- Validation: 
scalar performance:
{'acc': 0.83787996, 'precision': 0.83848894, 'recall': 0.8383046, 'specificity': 0.8383046, 'f1': 0.8378751, 'auroc': 0.9048463, 'binary_precision': 0.8184569, 'binary_recall': 0.8600954, 'binary_specificity': 0.8165138, 'binary_f1_score': 0.8387597}
confusion matrix:
     0    1
0  534  120
1   88  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82445085, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8244436, 'auroc': 0.90672594, 'binary_precision': 0.82300884, 'binary_recall': 0.82666665, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.8248337}
confusion matrix:
     0    1
0  185   40
1   39  186
better model found
persisted
after epoch: 4,now: 2024-07-26 02:28:52.460343,epoch time: 0:02:49.736349,used: 0:11:23.172967,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97573364, 'recall': 0.97529495, 'specificity': 0.97529495, 'f1': 0.9749327, 'auroc': 0.9983313, 'binary_precision': 0.99932617, 'binary_recall': 0.9512508, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.974696}
confusion matrix:
      0     1
0  1512     1
1    76  1483
---- Validation: 
scalar performance:
{'acc': 0.59547937, 'precision': 0.74742424, 'recall': 0.58768344, 'specificity': 0.58768344, 'f1': 0.51300037, 'auroc': 0.8645258, 'binary_precision': 0.93650794, 'binary_recall': 0.18759936, 'binary_specificity': 0.9877676, 'binary_f1_score': 0.31258276}
confusion matrix:
     0    1
0  646    8
1  511  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7822945, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.62863934, 'auroc': 0.88609874, 'binary_precision': 0.962963, 'binary_recall': 0.34666666, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.5098039}
confusion matrix:
     0   1
0  222   3
1  147  78
early stop counter: 1
val acc:0.5954793691635132, best validation acc: 0.8378799557685852, corresponding to test acc:                         0.8244444727897644 / 0.8422222137451172
after epoch: 5,now: 2024-07-26 02:31:41.578833,epoch time: 0:02:49.118490,used: 0:14:12.291457,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.9495549, 'recall': 0.94540787, 'specificity': 0.94540787, 'f1': 0.9445652, 'auroc': 0.997027, 'binary_precision': 1.0, 'binary_recall': 0.8908157, 'binary_specificity': 1.0, 'binary_f1_score': 0.9422554}
confusion matrix:
      0     1
0  1515     0
1   170  1387
---- Validation: 
scalar performance:
{'acc': 0.52065474, 'precision': 0.7576832, 'recall': 0.5111288, 'specificity': 0.5111288, 'f1': 0.36186656, 'auroc': 0.87622523, 'binary_precision': 1.0, 'binary_recall': 0.022257552, 'binary_specificity': 1.0, 'binary_f1_score': 0.04354588}
confusion matrix:
     0   1
0  654   0
1  615  14
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.7777778, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.52380955, 'auroc': 0.913916, 'binary_precision': 1.0, 'binary_recall': 0.2, 'binary_specificity': 1.0, 'binary_f1_score': 0.3333333}
confusion matrix:
     0   1
0  225   0
1  180  45
early stop counter: 2
val acc:0.5206547379493713, best validation acc: 0.8378799557685852, corresponding to test acc:                         0.8244444727897644 / 0.8422222137451172
after epoch: 6,now: 2024-07-26 02:34:30.684572,epoch time: 0:02:49.105739,used: 0:17:01.397196,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98044336, 'recall': 0.980502, 'specificity': 0.980502, 'f1': 0.98046607, 'auroc': 0.99745804, 'binary_precision': 0.9832258, 'binary_recall': 0.97817713, 'binary_specificity': 0.98282695, 'binary_f1_score': 0.98069495}
confusion matrix:
      0     1
0  1488    26
1    34  1524
---- Validation: 
scalar performance:
{'acc': 0.78643805, 'precision': 0.7990095, 'recall': 0.7883928, 'specificity': 0.7883928, 'f1': 0.7848854, 'auroc': 0.88410807, 'binary_precision': 0.73263437, 'binary_recall': 0.8887122, 'binary_specificity': 0.6880734, 'binary_f1_score': 0.8031609}
confusion matrix:
     0    1
0  450  204
1   70  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.81447965, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80803573, 'auroc': 0.88086915, 'binary_precision': 0.77254903, 'binary_recall': 0.8755556, 'binary_specificity': 0.74222225, 'binary_f1_score': 0.8208333}
confusion matrix:
     0    1
0  167   58
1   28  197
early stop counter: 3
val acc:0.7864380478858948, best validation acc: 0.8378799557685852, corresponding to test acc:                         0.8244444727897644 / 0.8422222137451172
after epoch: 7,now: 2024-07-26 02:37:19.382014,epoch time: 0:02:48.697442,used: 0:19:50.094638,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98379624, 'recall': 0.9836731, 'specificity': 0.9836731, 'f1': 0.98371965, 'auroc': 0.9985354, 'binary_precision': 0.980217, 'binary_recall': 0.98778135, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.98398465}
confusion matrix:
      0     1
0  1486    31
1    19  1536
---- Validation: 
scalar performance:
{'acc': 0.8456742, 'precision': 0.84592414, 'recall': 0.8453725, 'specificity': 0.8453725, 'f1': 0.84551644, 'auroc': 0.88860774, 'binary_precision': 0.85154974, 'binary_recall': 0.8298887, 'binary_specificity': 0.8608563, 'binary_f1_score': 0.8405797}
confusion matrix:
     0    1
0  563   91
1  107  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8721305, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86860275, 'auroc': 0.9307457, 'binary_precision': 0.90686274, 'binary_recall': 0.82222223, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.86247087}
confusion matrix:
     0    1
0  206   19
1   40  185
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-26 02:40:09.983715,epoch time: 0:02:50.601701,used: 0:22:40.696339,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895748, 'recall': 0.98967445, 'specificity': 0.98967445, 'f1': 0.98958266, 'auroc': 0.9989177, 'binary_precision': 0.9960988, 'binary_recall': 0.98331195, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9896641}
confusion matrix:
      0     1
0  1508     6
1    26  1532
---- Validation: 
scalar performance:
{'acc': 0.8433359, 'precision': 0.84349144, 'recall': 0.8430789, 'specificity': 0.8430789, 'f1': 0.84319836, 'auroc': 0.8900007, 'binary_precision': 0.8474026, 'binary_recall': 0.8298887, 'binary_specificity': 0.8562691, 'binary_f1_score': 0.8385542}
confusion matrix:
     0    1
0  560   94
1  107  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82031, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8199564, 'auroc': 0.8960593, 'binary_precision': 0.83027524, 'binary_recall': 0.80444443, 'binary_specificity': 0.83555555, 'binary_f1_score': 0.8171558}
confusion matrix:
     0    1
0  188   37
1   44  181
early stop counter: 1
val acc:0.8433359265327454, best validation acc: 0.8456742167472839, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 9,now: 2024-07-26 02:42:58.726444,epoch time: 0:02:48.742729,used: 0:25:29.439068,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.98032504, 'recall': 0.9800563, 'specificity': 0.9800563, 'f1': 0.9798167, 'auroc': 0.9988054, 'binary_precision': 0.9993311, 'binary_recall': 0.9607717, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.97967213}
confusion matrix:
      0     1
0  1516     1
1    61  1494
---- Validation: 
scalar performance:
{'acc': 0.751364, 'precision': 0.79583186, 'recall': 0.7475168, 'specificity': 0.7475168, 'f1': 0.73966306, 'auroc': 0.85088706, 'binary_precision': 0.90575916, 'binary_recall': 0.55007946, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.6844708}
confusion matrix:
     0    1
0  618   36
1  283  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8679378, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.836904, 'auroc': 0.934716, 'binary_precision': 0.9693251, 'binary_recall': 0.7022222, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.814433}
confusion matrix:
     0    1
0  220    5
1   67  158
early stop counter: 2
val acc:0.75136399269104, best validation acc: 0.8456742167472839, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 10,now: 2024-07-26 02:45:47.318574,epoch time: 0:02:48.592130,used: 0:28:18.031198,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9580078, 'precision': 0.95980036, 'recall': 0.9576127, 'specificity': 0.9576127, 'f1': 0.95793366, 'auroc': 0.9943104, 'binary_precision': 0.93430656, 'binary_recall': 0.98651254, 'binary_specificity': 0.92871284, 'binary_f1_score': 0.9597001}
confusion matrix:
      0     1
0  1407   108
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.7802026, 'precision': 0.78335243, 'recall': 0.7811827, 'specificity': 0.7811827, 'f1': 0.7799319, 'auroc': 0.8611407, 'binary_precision': 0.74821174, 'binary_recall': 0.83147854, 'binary_specificity': 0.7308869, 'binary_f1_score': 0.78765064}
confusion matrix:
     0    1
0  478  176
1  106  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.760181, 'recall': 0.75555557, 'specificity': 0.75555557, 'f1': 0.75446427, 'auroc': 0.8701432, 'binary_precision': 0.7254902, 'binary_recall': 0.82222223, 'binary_specificity': 0.6888889, 'binary_f1_score': 0.7708333}
confusion matrix:
     0    1
0  155   70
1   40  185
early stop counter: 3
val acc:0.7802026271820068, best validation acc: 0.8456742167472839, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 11,now: 2024-07-26 02:48:36.232634,epoch time: 0:02:48.914060,used: 0:31:06.945258,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9782299, 'recall': 0.97730595, 'specificity': 0.97730595, 'f1': 0.97751844, 'auroc': 0.9987494, 'binary_precision': 0.9632856, 'binary_recall': 0.99358153, 'binary_specificity': 0.96103036, 'binary_f1_score': 0.97819906}
confusion matrix:
      0     1
0  1455    59
1    10  1548
---- Validation: 
scalar performance:
{'acc': 0.7981294, 'precision': 0.7985775, 'recall': 0.79849327, 'specificity': 0.79849327, 'f1': 0.7981274, 'auroc': 0.85948527, 'binary_precision': 0.781155, 'binary_recall': 0.8171701, 'binary_specificity': 0.7798165, 'binary_f1_score': 0.7987568}
confusion matrix:
     0    1
0  510  144
1  115  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.83631945, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8304547, 'auroc': 0.9326222, 'binary_precision': 0.7944664, 'binary_recall': 0.8933333, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.8410042}
confusion matrix:
     0    1
0  173   52
1   24  201
early stop counter: 4
val acc:0.7981293797492981, best validation acc: 0.8456742167472839, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 12,now: 2024-07-26 02:51:25.004692,epoch time: 0:02:48.772058,used: 0:33:55.717316,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889281, 'recall': 0.9890193, 'specificity': 0.9890193, 'f1': 0.9889318, 'auroc': 0.9986265, 'binary_precision': 0.99544567, 'binary_recall': 0.982659, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.98901105}
confusion matrix:
      0     1
0  1508     7
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.66173035, 'precision': 0.7723773, 'recall': 0.65540296, 'specificity': 0.65540296, 'f1': 0.618249, 'auroc': 0.8825207, 'binary_precision': 0.9411765, 'binary_recall': 0.33068362, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.48941174}
confusion matrix:
     0    1
0  641   13
1  421  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.8055556, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.6654457, 'auroc': 0.89412344, 'binary_precision': 0.98888886, 'binary_recall': 0.39555556, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.56507933}
confusion matrix:
     0   1
0  224   1
1  136  89
early stop counter: 5
val acc:0.6617303490638733, best validation acc: 0.8456742167472839, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 13,now: 2024-07-26 02:54:14.309113,epoch time: 0:02:49.304421,used: 0:36:45.021737,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_17_29_seed_3_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 0:36:45.021737 at 2024-07-26 02:54:14.309113
persisted model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.8721305, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86860275, 'auroc': 0.9307457, 'binary_precision': 0.90686274, 'binary_recall': 0.82222223, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.86247087}
confusion matrix:
     0    1
0  206   19
1   40  185
oracle model performance metric: 

scalar performance:
{'acc': 0.8688889, 'precision': 0.8721305, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86860275, 'auroc': 0.9307457, 'binary_precision': 0.90686274, 'binary_recall': 0.82222223, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.86247087}
confusion matrix:
     0    1
0  206   19
1   40  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2799 MiB |   9241 MiB | 375138 GiB | 375135 GiB |
|       from large pool |   2707 MiB |   9165 MiB | 371869 GiB | 371866 GiB |
|       from small pool |     91 MiB |    132 MiB |   3269 GiB |   3269 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2799 MiB |   9241 MiB | 375138 GiB | 375135 GiB |
|       from large pool |   2707 MiB |   9165 MiB | 371869 GiB | 371866 GiB |
|       from small pool |     91 MiB |    132 MiB |   3269 GiB |   3269 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 374551 GiB | 374548 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 371287 GiB | 371284 GiB |
|       from small pool |     91 MiB |    132 MiB |   3264 GiB |   3264 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10070 MiB |  10180 MiB |  28846 MiB |  18776 MiB |
|       from large pool |   9930 MiB |  10044 MiB |  28602 MiB |  18672 MiB |
|       from small pool |    140 MiB |    140 MiB |    244 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1456 MiB |   1841 MiB | 284909 GiB | 284907 GiB |
|       from large pool |   1444 MiB |   1835 MiB | 281546 GiB | 281544 GiB |
|       from small pool |     12 MiB |     56 MiB |   3362 GiB |   3362 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   53083 K  |   53081 K  |
|       from large pool |     392    |     816    |   26658 K  |   26657 K  |
|       from small pool |    2084    |    2780    |   26425 K  |   26423 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   53083 K  |   53081 K  |
|       from large pool |     392    |     816    |   26658 K  |   26657 K  |
|       from small pool |    2084    |    2780    |   26425 K  |   26423 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     277    |     334    |     766    |     489    |
|       from large pool |     207    |     266    |     644    |     437    |
|       from small pool |      70    |      70    |     122    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |     321    |   29251 K  |   29250 K  |
|       from large pool |      73    |     251    |   15650 K  |   15650 K  |
|       from small pool |      73    |     230    |   13600 K  |   13600 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 375138 GiB | 375138 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 371869 GiB | 371869 GiB |
|       from small pool |      0 KiB |    132 MiB |   3269 GiB |   3269 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 375138 GiB | 375138 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 371869 GiB | 371869 GiB |
|       from small pool |      0 KiB |    132 MiB |   3269 GiB |   3269 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 374551 GiB | 374551 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 371287 GiB | 371287 GiB |
|       from small pool |      0 KiB |    132 MiB |   3264 GiB |   3264 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4256 MiB |  10180 MiB |  28846 MiB |  24590 MiB |
|       from large pool |   4152 MiB |  10044 MiB |  28602 MiB |  24450 MiB |
|       from small pool |    104 MiB |    140 MiB |    244 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1881 MiB | 284910 GiB | 284910 GiB |
|       from large pool |  24320 KiB |   1851 MiB | 281547 GiB | 281547 GiB |
|       from small pool |      0 KiB |     56 MiB |   3363 GiB |   3363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   53083 K  |   53083 K  |
|       from large pool |       2    |     816    |   26658 K  |   26658 K  |
|       from small pool |       0    |    2780    |   26425 K  |   26425 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   53083 K  |   53083 K  |
|       from large pool |       2    |     816    |   26658 K  |   26658 K  |
|       from small pool |       0    |    2780    |   26425 K  |   26425 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |     766    |     632    |
|       from large pool |      82    |     266    |     644    |     562    |
|       from small pool |      52    |      70    |     122    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   29251 K  |   29251 K  |
|       from large pool |       3    |     251    |   15650 K  |   15650 K  |
|       from small pool |       0    |     230    |   13600 K  |   13600 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 375138 GiB | 375138 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 371869 GiB | 371869 GiB |
|       from small pool |      0 KiB |    132 MiB |   3269 GiB |   3269 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 375138 GiB | 375138 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 371869 GiB | 371869 GiB |
|       from small pool |      0 KiB |    132 MiB |   3269 GiB |   3269 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 374551 GiB | 374551 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 371287 GiB | 371287 GiB |
|       from small pool |      0 KiB |    132 MiB |   3264 GiB |   3264 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4256 MiB |  10180 MiB |  28846 MiB |  24590 MiB |
|       from large pool |   4152 MiB |  10044 MiB |  28602 MiB |  24450 MiB |
|       from small pool |    104 MiB |    140 MiB |    244 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1881 MiB | 284910 GiB | 284910 GiB |
|       from large pool |  24320 KiB |   1851 MiB | 281547 GiB | 281547 GiB |
|       from small pool |      0 KiB |     56 MiB |   3363 GiB |   3363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   53083 K  |   53083 K  |
|       from large pool |       2    |     816    |   26658 K  |   26658 K  |
|       from small pool |       0    |    2780    |   26425 K  |   26425 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   53083 K  |   53083 K  |
|       from large pool |       2    |     816    |   26658 K  |   26658 K  |
|       from small pool |       0    |    2780    |   26425 K  |   26425 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |     766    |     632    |
|       from large pool |      82    |     266    |     644    |     562    |
|       from small pool |      52    |      70    |     122    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   29251 K  |   29251 K  |
|       from large pool |       3    |     251    |   15650 K  |   15650 K  |
|       from small pool |       0    |     230    |   13600 K  |   13600 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697

 Experiment start at: 2024-07-26 02:54:47.623112
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.939443, 'precision': 0.944582, 'recall': 0.9404746, 'specificity': 0.9404746, 'f1': 0.93934673, 'auroc': 0.9937469, 'binary_precision': 0.9971285, 'binary_recall': 0.8835878, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9369308}
confusion matrix:
      0     1
0  1512     4
1   183  1389
---- Validation: 
scalar performance:
{'acc': 0.82201403, 'precision': 0.824456, 'recall': 0.8214232, 'specificity': 0.8214232, 'f1': 0.8214656, 'auroc': 0.8868415, 'binary_precision': 0.849481, 'binary_recall': 0.77689874, 'binary_specificity': 0.8659476, 'binary_f1_score': 0.8115702}
confusion matrix:
     0    1
0  562   87
1  141  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.85492814, 'recall': 0.8507109, 'specificity': 0.8507109, 'f1': 0.85026616, 'auroc': 0.92659646, 'binary_precision': 0.89361703, 'binary_recall': 0.79620856, 'binary_specificity': 0.9052133, 'binary_f1_score': 0.8421053}
confusion matrix:
     0    1
0  191   20
1   43  168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:57:39.388071,epoch time: 0:02:51.764959,used: 0:02:51.764959,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9553109, 'precision': 0.9553654, 'recall': 0.95522785, 'specificity': 0.95522785, 'f1': 0.9552866, 'auroc': 0.99341166, 'binary_precision': 0.9533123, 'binary_recall': 0.95936507, 'binary_specificity': 0.9510906, 'binary_f1_score': 0.9563291}
confusion matrix:
      0     1
0  1439    74
1    64  1511
---- Validation: 
scalar performance:
{'acc': 0.7509758, 'precision': 0.7693825, 'recall': 0.74920154, 'specificity': 0.74920154, 'f1': 0.7457297, 'auroc': 0.8370936, 'binary_precision': 0.8365591, 'binary_recall': 0.61550635, 'binary_specificity': 0.8828968, 'binary_f1_score': 0.7092069}
confusion matrix:
     0    1
0  573   76
1  243  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84123224, 'precision': 0.8425325, 'recall': 0.8412322, 'specificity': 0.8412322, 'f1': 0.84108144, 'auroc': 0.9215876, 'binary_precision': 0.8636364, 'binary_recall': 0.81042653, 'binary_specificity': 0.8720379, 'binary_f1_score': 0.8361858}
confusion matrix:
     0    1
0  184   27
1   40  171
early stop counter: 1
val acc:0.7509757876396179, best validation acc: 0.8220140337944031, corresponding to test acc:                         0.850710928440094 / 0.850710928440094
after epoch: 2,now: 2024-07-26 03:00:28.579798,epoch time: 0:02:49.191727,used: 0:05:40.956686,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97409326, 'precision': 0.9740532, 'recall': 0.9741328, 'specificity': 0.9741328, 'f1': 0.97408646, 'auroc': 0.99485415, 'binary_precision': 0.9769968, 'binary_recall': 0.97202796, 'binary_specificity': 0.9762376, 'binary_f1_score': 0.974506}
confusion matrix:
      0     1
0  1479    36
1    44  1529
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.85562927, 'recall': 0.8554836, 'specificity': 0.8554836, 'f1': 0.85553086, 'auroc': 0.9124749, 'binary_precision': 0.8576, 'binary_recall': 0.84810126, 'binary_specificity': 0.8628659, 'binary_f1_score': 0.8528242}
confusion matrix:
     0    1
0  560   89
1   96  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.8513501, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.8506429, 'auroc': 0.93279576, 'binary_precision': 0.86633664, 'binary_recall': 0.8293839, 'binary_specificity': 0.8720379, 'binary_f1_score': 0.8474576}
confusion matrix:
     0    1
0  184   27
1   36  175
better model found
persisted
after epoch: 3,now: 2024-07-26 03:03:18.399146,epoch time: 0:02:49.819348,used: 0:08:30.776034,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96664506, 'precision': 0.9674133, 'recall': 0.966323, 'specificity': 0.966323, 'f1': 0.9666035, 'auroc': 0.9971298, 'binary_precision': 0.95258623, 'binary_recall': 0.9834711, 'binary_specificity': 0.94917494, 'binary_f1_score': 0.9677823}
confusion matrix:
      0     1
0  1438    77
1    26  1547
---- Validation: 
scalar performance:
{'acc': 0.76346606, 'precision': 0.8046005, 'recall': 0.7658801, 'specificity': 0.7658801, 'f1': 0.75627744, 'auroc': 0.9049804, 'binary_precision': 0.68929803, 'binary_recall': 0.9477848, 'binary_specificity': 0.5839754, 'binary_f1_score': 0.79813457}
confusion matrix:
     0    1
0  379  270
1   33  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.83257985, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.80167806, 'auroc': 0.9170055, 'binary_precision': 0.73800737, 'binary_recall': 0.9478673, 'binary_specificity': 0.6635071, 'binary_f1_score': 0.82987547}
confusion matrix:
     0    1
0  140   71
1   11  200
early stop counter: 1
val acc:0.7634660601615906, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.850710928440094 / 0.850710928440094
after epoch: 4,now: 2024-07-26 03:06:07.437217,epoch time: 0:02:49.038071,used: 0:11:19.814105,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9715026, 'precision': 0.97151685, 'recall': 0.97171867, 'specificity': 0.97171867, 'f1': 0.9714999, 'auroc': 0.99699986, 'binary_precision': 0.9824903, 'binary_recall': 0.9612944, 'binary_specificity': 0.98214287, 'binary_f1_score': 0.9717768}
confusion matrix:
      0     1
0  1485    27
1    61  1515
---- Validation: 
scalar performance:
{'acc': 0.76971114, 'precision': 0.8023194, 'recall': 0.76750505, 'specificity': 0.76750505, 'f1': 0.762313, 'auroc': 0.89871895, 'binary_precision': 0.8983452, 'binary_recall': 0.60126585, 'binary_specificity': 0.9337442, 'binary_f1_score': 0.7203792}
confusion matrix:
     0    1
0  606   43
1  252  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8650341, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8332331, 'auroc': 0.92828107, 'binary_precision': 0.96710527, 'binary_recall': 0.69668245, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.80991733}
confusion matrix:
     0    1
0  206    5
1   64  147
early stop counter: 2
val acc:0.7697111368179321, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.850710928440094 / 0.850710928440094
after epoch: 5,now: 2024-07-26 03:08:56.898545,epoch time: 0:02:49.461328,used: 0:14:09.275433,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9838083, 'precision': 0.98376596, 'recall': 0.9838635, 'specificity': 0.9838635, 'f1': 0.98380435, 'auroc': 0.99767315, 'binary_precision': 0.9872041, 'binary_recall': 0.9809282, 'binary_specificity': 0.9867987, 'binary_f1_score': 0.9840561}
confusion matrix:
      0     1
0  1495    20
1    30  1543
---- Validation: 
scalar performance:
{'acc': 0.68227947, 'precision': 0.73543555, 'recall': 0.6790632, 'specificity': 0.6790632, 'f1': 0.66085035, 'auroc': 0.84827197, 'binary_precision': 0.8440367, 'binary_recall': 0.43670887, 'binary_specificity': 0.9214176, 'binary_f1_score': 0.5755996}
confusion matrix:
     0    1
0  598   51
1  356  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.549763, 'precision': 0.67258704, 'recall': 0.549763, 'specificity': 0.549763, 'f1': 0.45232236, 'auroc': 0.88614357, 'binary_precision': 0.8181818, 'binary_recall': 0.12796208, 'binary_specificity': 0.971564, 'binary_f1_score': 0.22131148}
confusion matrix:
     0   1
0  205   6
1  184  27
early stop counter: 3
val acc:0.6822794675827026, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.850710928440094 / 0.850710928440094
after epoch: 6,now: 2024-07-26 03:11:45.840558,epoch time: 0:02:48.942013,used: 0:16:58.217446,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9776554, 'precision': 0.9781554, 'recall': 0.9774277, 'specificity': 0.9774277, 'f1': 0.97763515, 'auroc': 0.9987366, 'binary_precision': 0.96645963, 'binary_recall': 0.99045193, 'binary_specificity': 0.96440345, 'binary_f1_score': 0.97830874}
confusion matrix:
      0     1
0  1463    54
1    15  1556
---- Validation: 
scalar performance:
{'acc': 0.79547226, 'precision': 0.7959486, 'recall': 0.7957264, 'specificity': 0.7957264, 'f1': 0.7954571, 'auroc': 0.8701508, 'binary_precision': 0.780303, 'binary_recall': 0.8148734, 'binary_specificity': 0.7765794, 'binary_f1_score': 0.79721355}
confusion matrix:
     0    1
0  504  145
1  117  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.8057147, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.8056829, 'auroc': 0.8966555, 'binary_precision': 0.80861247, 'binary_recall': 0.80094784, 'binary_specificity': 0.81042653, 'binary_f1_score': 0.80476195}
confusion matrix:
     0    1
0  171   40
1   42  169
early stop counter: 4
val acc:0.795472264289856, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.850710928440094 / 0.850710928440094
after epoch: 7,now: 2024-07-26 03:14:35.053704,epoch time: 0:02:49.213146,used: 0:19:47.430592,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9766839, 'precision': 0.97707677, 'recall': 0.9770287, 'specificity': 0.9770287, 'f1': 0.9766839, 'auroc': 0.99774027, 'binary_precision': 0.99603176, 'binary_recall': 0.95801526, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9766537}
confusion matrix:
      0     1
0  1510     6
1    66  1506
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.7898295, 'recall': 0.78109574, 'specificity': 0.78109574, 'f1': 0.7802733, 'auroc': 0.8767992, 'binary_precision': 0.8336484, 'binary_recall': 0.6977848, 'binary_specificity': 0.86440676, 'binary_f1_score': 0.75969}
confusion matrix:
     0    1
0  561   88
1  191  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8420944, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8358208, 'auroc': 0.9101099, 'binary_precision': 0.88586956, 'binary_recall': 0.77251184, 'binary_specificity': 0.90047395, 'binary_f1_score': 0.8253164}
confusion matrix:
     0    1
0  190   21
1   48  163
early stop counter: 5
val acc:0.7822014093399048, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.850710928440094 / 0.850710928440094
after epoch: 8,now: 2024-07-26 03:17:24.228644,epoch time: 0:02:49.174940,used: 0:22:36.605532,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_54_47_seed_4_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:22:36.605532 at 2024-07-26 03:17:24.228644
persisted model performance metric: 

scalar performance:
{'acc': 0.8507109, 'precision': 0.8513501, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.8506429, 'auroc': 0.93279576, 'binary_precision': 0.86633664, 'binary_recall': 0.8293839, 'binary_specificity': 0.8720379, 'binary_f1_score': 0.8474576}
confusion matrix:
     0    1
0  184   27
1   36  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8507109, 'precision': 0.85492814, 'recall': 0.8507109, 'specificity': 0.8507109, 'f1': 0.85026616, 'auroc': 0.92659646, 'binary_precision': 0.89361703, 'binary_recall': 0.79620856, 'binary_specificity': 0.9052133, 'binary_f1_score': 0.8421053}
confusion matrix:
     0    1
0  191   20
1   43  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2800 MiB |   9241 MiB | 429053 GiB | 429051 GiB |
|       from large pool |   2708 MiB |   9165 MiB | 425314 GiB | 425312 GiB |
|       from small pool |     91 MiB |    132 MiB |   3739 GiB |   3739 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2800 MiB |   9241 MiB | 429053 GiB | 429051 GiB |
|       from large pool |   2708 MiB |   9165 MiB | 425314 GiB | 425312 GiB |
|       from small pool |     91 MiB |    132 MiB |   3739 GiB |   3739 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 428410 GiB | 428407 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 424676 GiB | 424673 GiB |
|       from small pool |     91 MiB |    132 MiB |   3733 GiB |   3733 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10042 MiB |  10180 MiB |  34632 MiB |  24590 MiB |
|       from large pool |   9906 MiB |  10044 MiB |  34356 MiB |  24450 MiB |
|       from small pool |    136 MiB |    140 MiB |    276 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1051 MiB |   2362 MiB | 330534 GiB | 330533 GiB |
|       from large pool |   1039 MiB |   2356 MiB | 326688 GiB | 326687 GiB |
|       from small pool |     12 MiB |     56 MiB |   3846 GiB |   3846 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   60720 K  |   60717 K  |
|       from large pool |     392    |     816    |   30492 K  |   30492 K  |
|       from small pool |    2072    |    2780    |   30227 K  |   30225 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   60720 K  |   60717 K  |
|       from large pool |     392    |     816    |   30492 K  |   30492 K  |
|       from small pool |    2072    |    2780    |   30227 K  |   30225 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     258    |     334    |     890    |     632    |
|       from large pool |     190    |     266    |     752    |     562    |
|       from small pool |      68    |      70    |     138    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     145    |     321    |   33277 K  |   33277 K  |
|       from large pool |      68    |     251    |   17725 K  |   17725 K  |
|       from small pool |      77    |     230    |   15552 K  |   15552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 429053 GiB | 429053 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 425314 GiB | 425314 GiB |
|       from small pool |      0 KiB |    132 MiB |   3739 GiB |   3739 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 429053 GiB | 429053 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 425314 GiB | 425314 GiB |
|       from small pool |      0 KiB |    132 MiB |   3739 GiB |   3739 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 428410 GiB | 428410 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 424676 GiB | 424676 GiB |
|       from small pool |      0 KiB |    132 MiB |   3733 GiB |   3733 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3852 MiB |  10180 MiB |  34632 MiB |  30780 MiB |
|       from large pool |   3748 MiB |  10044 MiB |  34356 MiB |  30608 MiB |
|       from small pool |    104 MiB |    140 MiB |    276 MiB |    172 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 330535 GiB | 330535 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 326689 GiB | 326689 GiB |
|       from small pool |      0 KiB |     56 MiB |   3846 GiB |   3846 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   60720 K  |   60720 K  |
|       from large pool |       2    |     816    |   30492 K  |   30492 K  |
|       from small pool |       0    |    2780    |   30227 K  |   30227 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   60720 K  |   60720 K  |
|       from large pool |       2    |     816    |   30492 K  |   30492 K  |
|       from small pool |       0    |    2780    |   30227 K  |   30227 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     334    |     890    |     758    |
|       from large pool |      80    |     266    |     752    |     672    |
|       from small pool |      52    |      70    |     138    |      86    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   33278 K  |   33278 K  |
|       from large pool |       3    |     251    |   17725 K  |   17725 K  |
|       from small pool |       0    |     230    |   15552 K  |   15552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 429053 GiB | 429053 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 425314 GiB | 425314 GiB |
|       from small pool |      0 KiB |    132 MiB |   3739 GiB |   3739 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 429053 GiB | 429053 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 425314 GiB | 425314 GiB |
|       from small pool |      0 KiB |    132 MiB |   3739 GiB |   3739 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 428410 GiB | 428410 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 424676 GiB | 424676 GiB |
|       from small pool |      0 KiB |    132 MiB |   3733 GiB |   3733 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3852 MiB |  10180 MiB |  34632 MiB |  30780 MiB |
|       from large pool |   3748 MiB |  10044 MiB |  34356 MiB |  30608 MiB |
|       from small pool |    104 MiB |    140 MiB |    276 MiB |    172 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 330535 GiB | 330535 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 326689 GiB | 326689 GiB |
|       from small pool |      0 KiB |     56 MiB |   3846 GiB |   3846 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   60720 K  |   60720 K  |
|       from large pool |       2    |     816    |   30492 K  |   30492 K  |
|       from small pool |       0    |    2780    |   30227 K  |   30227 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   60720 K  |   60720 K  |
|       from large pool |       2    |     816    |   30492 K  |   30492 K  |
|       from small pool |       0    |    2780    |   30227 K  |   30227 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     132    |     334    |     890    |     758    |
|       from large pool |      80    |     266    |     752    |     672    |
|       from small pool |      52    |      70    |     138    |      86    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   33278 K  |   33278 K  |
|       from large pool |       3    |     251    |   17725 K  |   17725 K  |
|       from small pool |       0    |     230    |   15552 K  |   15552 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697

 Experiment start at: 2024-07-26 03:17:57.667601
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9231021, 'precision': 0.9323019, 'recall': 0.9242326, 'specificity': 0.9242326, 'f1': 0.92281306, 'auroc': 0.98990726, 'binary_precision': 0.9992413, 'binary_recall': 0.8491296, 'binary_specificity': 0.9993355, 'binary_f1_score': 0.9180899}
confusion matrix:
      0     1
0  1504     1
1   234  1317
---- Validation: 
scalar performance:
{'acc': 0.7371695, 'precision': 0.80842733, 'recall': 0.73029715, 'specificity': 0.73029715, 'f1': 0.71716624, 'auroc': 0.90173674, 'binary_precision': 0.9498433, 'binary_recall': 0.4848, 'binary_specificity': 0.97579426, 'binary_f1_score': 0.6419492}
confusion matrix:
     0    1
0  645   16
1  322  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73376626, 'precision': 0.80072325, 'recall': 0.73376626, 'specificity': 0.73376626, 'f1': 0.71807325, 'auroc': 0.88690245, 'binary_precision': 0.94262296, 'binary_recall': 0.4978355, 'binary_specificity': 0.969697, 'binary_f1_score': 0.65155804}
confusion matrix:
     0    1
0  224    7
1  116  115
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:20:47.023453,epoch time: 0:02:49.355852,used: 0:02:49.355852,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.96716255, 'recall': 0.9663892, 'specificity': 0.9663892, 'f1': 0.9665928, 'auroc': 0.9956995, 'binary_precision': 0.95485896, 'binary_recall': 0.98068255, 'binary_specificity': 0.9520958, 'binary_f1_score': 0.9675985}
confusion matrix:
      0     1
0  1431    72
1    30  1523
---- Validation: 
scalar performance:
{'acc': 0.8265941, 'precision': 0.8299898, 'recall': 0.82800484, 'specificity': 0.82800484, 'f1': 0.82646555, 'auroc': 0.89611864, 'binary_precision': 0.7887931, 'binary_recall': 0.8784, 'binary_specificity': 0.7776097, 'binary_f1_score': 0.83118844}
confusion matrix:
     0    1
0  514  147
1   76  549
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8051948, 'precision': 0.82148564, 'recall': 0.80519485, 'specificity': 0.80519485, 'f1': 0.8026953, 'auroc': 0.8974719, 'binary_precision': 0.89385474, 'binary_recall': 0.6926407, 'binary_specificity': 0.9177489, 'binary_f1_score': 0.78048784}
confusion matrix:
     0    1
0  212   19
1   71  160
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:23:36.752278,epoch time: 0:02:49.728825,used: 0:05:39.084677,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.97705996, 'recall': 0.9771416, 'specificity': 0.9771416, 'f1': 0.97709036, 'auroc': 0.99759567, 'binary_precision': 0.9805574, 'binary_recall': 0.9742434, 'binary_specificity': 0.9800399, 'binary_f1_score': 0.97739017}
confusion matrix:
      0     1
0  1473    30
1    40  1513
---- Validation: 
scalar performance:
{'acc': 0.82270604, 'precision': 0.82420564, 'recall': 0.82365626, 'specificity': 0.82365626, 'f1': 0.82268506, 'auroc': 0.9011606, 'binary_precision': 0.79407406, 'binary_recall': 0.8576, 'binary_specificity': 0.78971255, 'binary_f1_score': 0.82461536}
confusion matrix:
     0    1
0  522  139
1   89  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.83909214, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.83749104, 'auroc': 0.923371, 'binary_precision': 0.81707317, 'binary_recall': 0.8701299, 'binary_specificity': 0.8051948, 'binary_f1_score': 0.8427673}
confusion matrix:
     0    1
0  186   45
1   30  201
new oracle model saved
early stop counter: 1
val acc:0.8227060437202454, best validation acc: 0.8265941143035889, corresponding to test acc:                         0.8051947951316833 / 0.8376623392105103
after epoch: 3,now: 2024-07-26 03:26:25.814712,epoch time: 0:02:49.062434,used: 0:08:28.147111,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9750692, 'recall': 0.9748478, 'specificity': 0.9748478, 'f1': 0.97447574, 'auroc': 0.99683696, 'binary_precision': 0.99663526, 'binary_recall': 0.95302445, 'binary_specificity': 0.9966711, 'binary_f1_score': 0.9743421}
confusion matrix:
      0     1
0  1497     5
1    73  1481
---- Validation: 
scalar performance:
{'acc': 0.8102644, 'precision': 0.81379104, 'recall': 0.8086778, 'specificity': 0.8086778, 'f1': 0.8090632, 'auroc': 0.8882687, 'binary_precision': 0.8407871, 'binary_recall': 0.752, 'binary_specificity': 0.86535555, 'binary_f1_score': 0.7939189}
confusion matrix:
     0    1
0  572   89
1  155  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.8127747, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.79641116, 'auroc': 0.8858342, 'binary_precision': 0.8791209, 'binary_recall': 0.6926407, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.7748184}
confusion matrix:
     0    1
0  209   22
1   71  160
early stop counter: 2
val acc:0.8102644085884094, best validation acc: 0.8265941143035889, corresponding to test acc:                         0.8051947951316833 / 0.8376623392105103
after epoch: 4,now: 2024-07-26 03:29:13.795910,epoch time: 0:02:47.981198,used: 0:11:16.128309,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9737873, 'recall': 0.9738685, 'specificity': 0.9738685, 'f1': 0.9738175, 'auroc': 0.99509764, 'binary_precision': 0.9773169, 'binary_recall': 0.9710238, 'binary_specificity': 0.97671324, 'binary_f1_score': 0.9741602}
confusion matrix:
      0     1
0  1468    35
1    45  1508
---- Validation: 
scalar performance:
{'acc': 0.8102644, 'precision': 0.8205367, 'recall': 0.80767566, 'specificity': 0.80767566, 'f1': 0.8077177, 'auroc': 0.8967601, 'binary_precision': 0.87134504, 'binary_recall': 0.7152, 'binary_specificity': 0.9001513, 'binary_f1_score': 0.7855888}
confusion matrix:
     0    1
0  595   66
1  178  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6904762, 'precision': 0.75039417, 'recall': 0.6904762, 'specificity': 0.6904762, 'f1': 0.67078114, 'auroc': 0.8775135, 'binary_precision': 0.87288135, 'binary_recall': 0.44588745, 'binary_specificity': 0.9350649, 'binary_f1_score': 0.5902579}
confusion matrix:
     0    1
0  216   15
1  128  103
early stop counter: 3
val acc:0.8102644085884094, best validation acc: 0.8265941143035889, corresponding to test acc:                         0.8051947951316833 / 0.8376623392105103
after epoch: 5,now: 2024-07-26 03:32:02.403204,epoch time: 0:02:48.607294,used: 0:14:04.735603,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98205864, 'recall': 0.9821745, 'specificity': 0.9821745, 'f1': 0.9820021, 'auroc': 0.99826026, 'binary_precision': 0.99276316, 'binary_recall': 0.97166777, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.9821022}
confusion matrix:
      0     1
0  1492    11
1    44  1509
---- Validation: 
scalar performance:
{'acc': 0.7970451, 'precision': 0.8263626, 'recall': 0.79276854, 'specificity': 0.79276854, 'f1': 0.7906362, 'auroc': 0.9026402, 'binary_precision': 0.9174312, 'binary_recall': 0.64, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.7540056}
confusion matrix:
     0    1
0  625   36
1  225  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7835498, 'precision': 0.84578466, 'recall': 0.7835498, 'specificity': 0.7835498, 'f1': 0.77335167, 'auroc': 0.90601754, 'binary_precision': 0.99248123, 'binary_recall': 0.5714286, 'binary_specificity': 0.995671, 'binary_f1_score': 0.7252748}
confusion matrix:
     0    1
0  230    1
1   99  132
early stop counter: 4
val acc:0.797045111656189, best validation acc: 0.8265941143035889, corresponding to test acc:                         0.8051947951316833 / 0.8376623392105103
after epoch: 6,now: 2024-07-26 03:34:50.672757,epoch time: 0:02:48.269553,used: 0:16:53.005156,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878632, 'recall': 0.9879805, 'specificity': 0.9879805, 'f1': 0.98789126, 'auroc': 0.9989315, 'binary_precision': 0.99348956, 'binary_recall': 0.9826143, 'binary_specificity': 0.99334663, 'binary_f1_score': 0.988022}
confusion matrix:
      0     1
0  1493    10
1    27  1526
---- Validation: 
scalar performance:
{'acc': 0.86625195, 'precision': 0.87215936, 'recall': 0.86449134, 'specificity': 0.86449134, 'f1': 0.8652297, 'auroc': 0.9234445, 'binary_precision': 0.91256833, 'binary_recall': 0.8016, 'binary_specificity': 0.92738277, 'binary_f1_score': 0.8534923}
confusion matrix:
     0    1
0  613   48
1  124  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8095238, 'precision': 0.84935594, 'recall': 0.8095238, 'specificity': 0.8095238, 'f1': 0.80393517, 'auroc': 0.918536, 'binary_precision': 0.96732026, 'binary_recall': 0.64069265, 'binary_specificity': 0.978355, 'binary_f1_score': 0.7708333}
confusion matrix:
     0    1
0  226    5
1   83  148
better model found
persisted
after epoch: 7,now: 2024-07-26 03:37:39.186750,epoch time: 0:02:48.513993,used: 0:19:41.519149,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.9807793, 'recall': 0.98065984, 'specificity': 0.98065984, 'f1': 0.98036623, 'auroc': 0.9989405, 'binary_precision': 0.99933064, 'binary_recall': 0.9619845, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.98030204}
confusion matrix:
      0     1
0  1503     1
1    59  1493
---- Validation: 
scalar performance:
{'acc': 0.6842924, 'precision': 0.76904255, 'recall': 0.6762021, 'specificity': 0.6762021, 'f1': 0.65122044, 'auroc': 0.85249746, 'binary_precision': 0.91320753, 'binary_recall': 0.3872, 'binary_specificity': 0.96520424, 'binary_f1_score': 0.5438202}
confusion matrix:
     0    1
0  638   23
1  383  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6991342, 'precision': 0.7647499, 'recall': 0.6991342, 'specificity': 0.6991342, 'f1': 0.6792612, 'auroc': 0.8731657, 'binary_precision': 0.8965517, 'binary_recall': 0.45021644, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.59942365}
confusion matrix:
     0    1
0  219   12
1  127  104
early stop counter: 1
val acc:0.6842923760414124, best validation acc: 0.8662519454956055, corresponding to test acc:                         0.8095238208770752 / 0.8376623392105103
after epoch: 8,now: 2024-07-26 03:40:27.070830,epoch time: 0:02:47.884080,used: 0:22:29.403229,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.940445, 'precision': 0.9466758, 'recall': 0.9395187, 'specificity': 0.9395187, 'f1': 0.94013476, 'auroc': 0.99777174, 'binary_precision': 0.8978526, 'binary_recall': 0.9961365, 'binary_specificity': 0.8829009, 'binary_f1_score': 0.9444444}
confusion matrix:
      0     1
0  1327   176
1     6  1547
---- Validation: 
scalar performance:
{'acc': 0.7550544, 'precision': 0.7784716, 'recall': 0.75897974, 'specificity': 0.75897974, 'f1': 0.75153756, 'auroc': 0.8518124, 'binary_precision': 0.6904177, 'binary_recall': 0.8992, 'binary_specificity': 0.61875945, 'binary_f1_score': 0.781098}
confusion matrix:
     0    1
0  409  252
1   63  562
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.8231088, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.8049828, 'auroc': 0.90403104, 'binary_precision': 0.75177306, 'binary_recall': 0.9177489, 'binary_specificity': 0.6969697, 'binary_f1_score': 0.82651067}
confusion matrix:
     0    1
0  161   70
1   19  212
early stop counter: 2
val acc:0.7550544142723083, best validation acc: 0.8662519454956055, corresponding to test acc:                         0.8095238208770752 / 0.8376623392105103
after epoch: 9,now: 2024-07-26 03:43:14.856466,epoch time: 0:02:47.785636,used: 0:25:17.188865,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.98590934, 'recall': 0.98595, 'specificity': 0.98595, 'f1': 0.98592705, 'auroc': 0.9986073, 'binary_precision': 0.98770225, 'binary_recall': 0.98451614, 'binary_specificity': 0.9873838, 'binary_f1_score': 0.98610663}
confusion matrix:
      0     1
0  1487    19
1    24  1526
---- Validation: 
scalar performance:
{'acc': 0.83903575, 'precision': 0.8418529, 'recall': 0.83771133, 'specificity': 0.83771133, 'f1': 0.8382257, 'auroc': 0.90869594, 'binary_precision': 0.8666667, 'binary_recall': 0.7904, 'binary_specificity': 0.8850227, 'binary_f1_score': 0.82677823}
confusion matrix:
     0    1
0  585   76
1  131  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.83378786, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.80346906, 'auroc': 0.8920372, 'binary_precision': 0.92771083, 'binary_recall': 0.6666667, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.77581865}
confusion matrix:
     0    1
0  219   12
1   77  154
early stop counter: 3
val acc:0.8390357494354248, best validation acc: 0.8662519454956055, corresponding to test acc:                         0.8095238208770752 / 0.8376623392105103
after epoch: 10,now: 2024-07-26 03:46:02.695132,epoch time: 0:02:47.838666,used: 0:28:05.027531,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.98589504, 'recall': 0.9859952, 'specificity': 0.9859952, 'f1': 0.9859272, 'auroc': 0.99875414, 'binary_precision': 0.99025977, 'binary_recall': 0.98197037, 'binary_specificity': 0.99002, 'binary_f1_score': 0.9860976}
confusion matrix:
      0     1
0  1488    15
1    28  1525
---- Validation: 
scalar performance:
{'acc': 0.8312597, 'precision': 0.8426296, 'recall': 0.8286656, 'specificity': 0.8286656, 'f1': 0.82896364, 'auroc': 0.8956974, 'binary_precision': 0.8984375, 'binary_recall': 0.736, 'binary_specificity': 0.9213313, 'binary_f1_score': 0.8091468}
confusion matrix:
     0    1
0  609   52
1  165  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268398, 'precision': 0.85784924, 'recall': 0.8268398, 'specificity': 0.8268398, 'f1': 0.82300544, 'auroc': 0.9064486, 'binary_precision': 0.9631902, 'binary_recall': 0.6796537, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.79695433}
confusion matrix:
     0    1
0  225    6
1   74  157
early stop counter: 4
val acc:0.8312597274780273, best validation acc: 0.8662519454956055, corresponding to test acc:                         0.8095238208770752 / 0.8376623392105103
after epoch: 11,now: 2024-07-26 03:48:51.195049,epoch time: 0:02:48.499917,used: 0:30:53.527448,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879359, 'recall': 0.98802686, 'specificity': 0.98802686, 'f1': 0.9878924, 'auroc': 0.9990927, 'binary_precision': 0.9973701, 'binary_recall': 0.9787097, 'binary_specificity': 0.99734396, 'binary_f1_score': 0.98795176}
confusion matrix:
      0     1
0  1502     4
1    33  1517
---- Validation: 
scalar performance:
{'acc': 0.7153966, 'precision': 0.7850331, 'recall': 0.70828927, 'specificity': 0.70828927, 'f1': 0.69234693, 'auroc': 0.8834729, 'binary_precision': 0.91909385, 'binary_recall': 0.4544, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.608137}
confusion matrix:
     0    1
0  636   25
1  341  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72077924, 'precision': 0.8042613, 'recall': 0.7207792, 'specificity': 0.7207792, 'f1': 0.7002158, 'auroc': 0.8938691, 'binary_precision': 0.96363634, 'binary_recall': 0.45887446, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.6217009}
confusion matrix:
     0    1
0  227    4
1  125  106
early stop counter: 5
val acc:0.7153965830802917, best validation acc: 0.8662519454956055, corresponding to test acc:                         0.8095238208770752 / 0.8376623392105103
after epoch: 12,now: 2024-07-26 03:51:39.270351,epoch time: 0:02:48.075302,used: 0:33:41.602750,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_57_seed_5_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:33:41.602750 at 2024-07-26 03:51:39.270351
persisted model performance metric: 

scalar performance:
{'acc': 0.8095238, 'precision': 0.84935594, 'recall': 0.8095238, 'specificity': 0.8095238, 'f1': 0.80393517, 'auroc': 0.918536, 'binary_precision': 0.96732026, 'binary_recall': 0.64069265, 'binary_specificity': 0.978355, 'binary_f1_score': 0.7708333}
confusion matrix:
     0    1
0  226    5
1   83  148
oracle model performance metric: 

scalar performance:
{'acc': 0.83766234, 'precision': 0.83909214, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.83749104, 'auroc': 0.923371, 'binary_precision': 0.81707317, 'binary_recall': 0.8701299, 'binary_specificity': 0.8051948, 'binary_f1_score': 0.8427673}
confusion matrix:
     0    1
0  186   45
1   30  201
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2798 MiB |   9241 MiB | 509228 GiB | 509225 GiB |
|       from large pool |   2706 MiB |   9165 MiB | 504791 GiB | 504788 GiB |
|       from small pool |     91 MiB |    132 MiB |   4437 GiB |   4437 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2798 MiB |   9241 MiB | 509228 GiB | 509225 GiB |
|       from large pool |   2706 MiB |   9165 MiB | 504791 GiB | 504788 GiB |
|       from small pool |     91 MiB |    132 MiB |   4437 GiB |   4437 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 508423 GiB | 508420 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 503992 GiB | 503990 GiB |
|       from small pool |     91 MiB |    132 MiB |   4430 GiB |   4430 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10070 MiB |  10180 MiB |  40850 MiB |  30780 MiB |
|       from large pool |   9934 MiB |  10044 MiB |  40542 MiB |  30608 MiB |
|       from small pool |    136 MiB |    140 MiB |    308 MiB |    172 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1217 MiB |   2362 MiB | 392877 GiB | 392876 GiB |
|       from large pool |   1211 MiB |   2356 MiB | 388313 GiB | 388312 GiB |
|       from small pool |      6 MiB |     56 MiB |   4564 GiB |   4564 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   72066 K  |   72064 K  |
|       from large pool |     392    |     816    |   36190 K  |   36190 K  |
|       from small pool |    2084    |    2780    |   35876 K  |   35874 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   72066 K  |   72064 K  |
|       from large pool |     392    |     816    |   36190 K  |   36190 K  |
|       from small pool |    2084    |    2780    |   35876 K  |   35874 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     274    |     334    |    1032    |     758    |
|       from large pool |     206    |     266    |     878    |     672    |
|       from small pool |      68    |      70    |     154    |      86    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     151    |     321    |   39319 K  |   39318 K  |
|       from large pool |      76    |     251    |   20879 K  |   20879 K  |
|       from small pool |      75    |     230    |   18439 K  |   18439 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 509228 GiB | 509228 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 504791 GiB | 504791 GiB |
|       from small pool |      0 KiB |    132 MiB |   4437 GiB |   4437 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 509228 GiB | 509228 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 504791 GiB | 504791 GiB |
|       from small pool |      0 KiB |    132 MiB |   4437 GiB |   4437 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 508423 GiB | 508423 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 503992 GiB | 503992 GiB |
|       from small pool |      0 KiB |    132 MiB |   4430 GiB |   4430 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |  10180 MiB |  40850 MiB |  36834 MiB |
|       from large pool |   3918 MiB |  10044 MiB |  40542 MiB |  36624 MiB |
|       from small pool |     98 MiB |    140 MiB |    308 MiB |    210 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 392878 GiB | 392878 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 388314 GiB | 388314 GiB |
|       from small pool |      0 KiB |     56 MiB |   4564 GiB |   4564 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   72066 K  |   72066 K  |
|       from large pool |       2    |     816    |   36190 K  |   36190 K  |
|       from small pool |       0    |    2780    |   35876 K  |   35876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   72066 K  |   72066 K  |
|       from large pool |       2    |     816    |   36190 K  |   36190 K  |
|       from small pool |       0    |    2780    |   35876 K  |   35876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     334    |    1032    |     899    |
|       from large pool |      84    |     266    |     878    |     794    |
|       from small pool |      49    |      70    |     154    |     105    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   39319 K  |   39319 K  |
|       from large pool |       3    |     251    |   20879 K  |   20879 K  |
|       from small pool |       0    |     230    |   18439 K  |   18439 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 509228 GiB | 509228 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 504791 GiB | 504791 GiB |
|       from small pool |      0 KiB |    132 MiB |   4437 GiB |   4437 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 509228 GiB | 509228 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 504791 GiB | 504791 GiB |
|       from small pool |      0 KiB |    132 MiB |   4437 GiB |   4437 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 508423 GiB | 508423 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 503992 GiB | 503992 GiB |
|       from small pool |      0 KiB |    132 MiB |   4430 GiB |   4430 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4016 MiB |  10180 MiB |  40850 MiB |  36834 MiB |
|       from large pool |   3918 MiB |  10044 MiB |  40542 MiB |  36624 MiB |
|       from small pool |     98 MiB |    140 MiB |    308 MiB |    210 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 392878 GiB | 392878 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 388314 GiB | 388314 GiB |
|       from small pool |      0 KiB |     56 MiB |   4564 GiB |   4564 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   72066 K  |   72066 K  |
|       from large pool |       2    |     816    |   36190 K  |   36190 K  |
|       from small pool |       0    |    2780    |   35876 K  |   35876 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   72066 K  |   72066 K  |
|       from large pool |       2    |     816    |   36190 K  |   36190 K  |
|       from small pool |       0    |    2780    |   35876 K  |   35876 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     334    |    1032    |     899    |
|       from large pool |      84    |     266    |     878    |     794    |
|       from small pool |      49    |      70    |     154    |     105    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   39319 K  |   39319 K  |
|       from large pool |       3    |     251    |   20879 K  |   20879 K  |
|       from small pool |       0    |     230    |   18439 K  |   18439 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697

 Experiment start at: 2024-07-26 03:52:15.817668
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9554036, 'precision': 0.9571653, 'recall': 0.9557481, 'specificity': 0.9557481, 'f1': 0.9553798, 'auroc': 0.99202347, 'binary_precision': 0.9882678, 'binary_recall': 0.92268044, 'binary_specificity': 0.9888158, 'binary_f1_score': 0.9543485}
confusion matrix:
      0     1
0  1503    17
1   120  1432
---- Validation: 
scalar performance:
{'acc': 0.6046693, 'precision': 0.68997276, 'recall': 0.60229516, 'specificity': 0.60229516, 'f1': 0.5518911, 'auroc': 0.7982926, 'binary_precision': 0.815534, 'binary_recall': 0.2633229, 'binary_specificity': 0.9412674, 'binary_f1_score': 0.39810425}
confusion matrix:
     0    1
0  609   38
1  470  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108108, 'precision': 0.8223485, 'recall': 0.8108108, 'specificity': 0.8108108, 'f1': 0.80910265, 'auroc': 0.8765117, 'binary_precision': 0.8833333, 'binary_recall': 0.7162162, 'binary_specificity': 0.9054054, 'binary_f1_score': 0.7910448}
confusion matrix:
     0    1
0  201   21
1   63  159
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:55:06.749653,epoch time: 0:02:50.931985,used: 0:02:50.931985,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95451826, 'recall': 0.95106244, 'specificity': 0.95106244, 'f1': 0.95044774, 'auroc': 0.99759346, 'binary_precision': 1.0, 'binary_recall': 0.90212494, 'binary_specificity': 1.0, 'binary_f1_score': 0.9485444}
confusion matrix:
      0     1
0  1519     0
1   152  1401
---- Validation: 
scalar performance:
{'acc': 0.51906615, 'precision': 0.73301303, 'recall': 0.5156849, 'specificity': 0.5156849, 'f1': 0.3700381, 'auroc': 0.8442365, 'binary_precision': 0.95454544, 'binary_recall': 0.03291536, 'binary_specificity': 0.9984544, 'binary_f1_score': 0.06363636}
confusion matrix:
     0   1
0  646   1
1  617  21
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49774775, 'precision': 0.24943566, 'recall': 0.49774775, 'specificity': 0.49774775, 'f1': 0.33233082, 'auroc': 0.8703433, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  221  1
1  222  0
early stop counter: 1
val acc:0.5190661549568176, best validation acc: 0.6046692728996277, corresponding to test acc:                         0.8108108043670654 / 0.8108108043670654
after epoch: 2,now: 2024-07-26 03:57:54.693957,epoch time: 0:02:47.944304,used: 0:05:38.876289,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97524357, 'recall': 0.9748713, 'specificity': 0.9748713, 'f1': 0.9746072, 'auroc': 0.9965845, 'binary_precision': 0.9959704, 'binary_recall': 0.95369774, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9743758}
confusion matrix:
      0     1
0  1511     6
1    72  1483
---- Validation: 
scalar performance:
{'acc': 0.7089494, 'precision': 0.7854003, 'recall': 0.7071255, 'specificity': 0.7071255, 'f1': 0.6869006, 'auroc': 0.87355673, 'binary_precision': 0.9313725, 'binary_recall': 0.44670847, 'binary_specificity': 0.9675425, 'binary_f1_score': 0.6038135}
confusion matrix:
     0    1
0  626   21
1  353  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8243243, 'precision': 0.8579042, 'recall': 0.82432437, 'specificity': 0.82432437, 'f1': 0.8201048, 'auroc': 0.9164232, 'binary_precision': 0.96753246, 'binary_recall': 0.6711712, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.79255325}
confusion matrix:
     0    1
0  217    5
1   73  149
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 04:00:44.789518,epoch time: 0:02:50.095561,used: 0:08:28.971850,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98151284, 'recall': 0.98152936, 'specificity': 0.98152936, 'f1': 0.9814453, 'auroc': 0.9988228, 'binary_precision': 0.9901575, 'binary_recall': 0.9729207, 'binary_specificity': 0.99013805, 'binary_f1_score': 0.98146343}
confusion matrix:
      0     1
0  1506    15
1    42  1509
---- Validation: 
scalar performance:
{'acc': 0.7836576, 'precision': 0.8052208, 'recall': 0.7827203, 'specificity': 0.7827203, 'f1': 0.7793765, 'auroc': 0.88748896, 'binary_precision': 0.88461536, 'binary_recall': 0.64890283, 'binary_specificity': 0.9165379, 'binary_f1_score': 0.7486437}
confusion matrix:
     0    1
0  593   54
1  224  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8368288, 'recall': 0.8310811, 'specificity': 0.8310811, 'f1': 0.83035743, 'auroc': 0.8922368, 'binary_precision': 0.88082904, 'binary_recall': 0.7657658, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.81927717}
confusion matrix:
     0    1
0  199   23
1   52  170
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 04:03:35.408537,epoch time: 0:02:50.619019,used: 0:11:19.590869,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9801872, 'recall': 0.9801084, 'specificity': 0.9801084, 'f1': 0.9801394, 'auroc': 0.99831283, 'binary_precision': 0.9775928, 'binary_recall': 0.9832582, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.9804174}
confusion matrix:
      0     1
0  1484    35
1    26  1527
---- Validation: 
scalar performance:
{'acc': 0.83501947, 'precision': 0.8356872, 'recall': 0.8351749, 'specificity': 0.8351749, 'f1': 0.83497536, 'auroc': 0.9166106, 'binary_precision': 0.81886226, 'binary_recall': 0.8573668, 'binary_specificity': 0.812983, 'binary_f1_score': 0.8376723}
confusion matrix:
     0    1
0  526  121
1   91  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8018018, 'precision': 0.8033776, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.8015441, 'auroc': 0.876045, 'binary_precision': 0.8252427, 'binary_recall': 0.7657658, 'binary_specificity': 0.8378378, 'binary_f1_score': 0.7943926}
confusion matrix:
     0    1
0  186   36
1   52  170
better model found
persisted
after epoch: 5,now: 2024-07-26 04:06:25.293948,epoch time: 0:02:49.885411,used: 0:14:09.476280,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96940106, 'precision': 0.97077596, 'recall': 0.96974784, 'specificity': 0.96974784, 'f1': 0.96939087, 'auroc': 0.9984566, 'binary_precision': 0.999316, 'binary_recall': 0.94015443, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9688329}
confusion matrix:
      0     1
0  1517     1
1    93  1461
---- Validation: 
scalar performance:
{'acc': 0.7237354, 'precision': 0.7925613, 'recall': 0.7220267, 'specificity': 0.7220267, 'f1': 0.7054703, 'auroc': 0.9046867, 'binary_precision': 0.93272173, 'binary_recall': 0.47805643, 'binary_specificity': 0.9659969, 'binary_f1_score': 0.63212436}
confusion matrix:
     0    1
0  625   22
1  333  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6306306, 'precision': 0.77942705, 'recall': 0.6306306, 'specificity': 0.6306306, 'f1': 0.5739063, 'auroc': 0.8984052, 'binary_precision': 0.98333335, 'binary_recall': 0.26576576, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.4184397}
confusion matrix:
     0   1
0  221   1
1  163  59
early stop counter: 1
val acc:0.7237353920936584, best validation acc: 0.8350194692611694, corresponding to test acc:                         0.8018018007278442 / 0.8310810923576355
after epoch: 6,now: 2024-07-26 04:09:13.819789,epoch time: 0:02:48.525841,used: 0:16:58.002121,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.9761281, 'recall': 0.97575897, 'specificity': 0.97575897, 'f1': 0.97558343, 'auroc': 0.9979967, 'binary_precision': 0.99463445, 'binary_recall': 0.9567742, 'binary_specificity': 0.99474376, 'binary_f1_score': 0.975337}
confusion matrix:
      0     1
0  1514     8
1    67  1483
---- Validation: 
scalar performance:
{'acc': 0.7945525, 'precision': 0.81755465, 'recall': 0.7936049, 'specificity': 0.7936049, 'f1': 0.7903938, 'auroc': 0.89287186, 'binary_precision': 0.90128756, 'binary_recall': 0.6583072, 'binary_specificity': 0.9289026, 'binary_f1_score': 0.76086956}
confusion matrix:
     0    1
0  601   46
1  218  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378378, 'precision': 0.8625871, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.83502257, 'auroc': 0.8998052, 'binary_precision': 0.95731705, 'binary_recall': 0.7072072, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.81347144}
confusion matrix:
     0    1
0  215    7
1   65  157
new oracle model saved
early stop counter: 2
val acc:0.7945525050163269, best validation acc: 0.8350194692611694, corresponding to test acc:                         0.8018018007278442 / 0.837837815284729
after epoch: 7,now: 2024-07-26 04:12:03.101253,epoch time: 0:02:49.281464,used: 0:19:47.283585,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9831555, 'recall': 0.98302364, 'specificity': 0.98302364, 'f1': 0.9830691, 'auroc': 0.9988903, 'binary_precision': 0.9789272, 'binary_recall': 0.98775774, 'binary_specificity': 0.9782895, 'binary_f1_score': 0.9833226}
confusion matrix:
      0     1
0  1487    33
1    19  1533
---- Validation: 
scalar performance:
{'acc': 0.82178986, 'precision': 0.83384335, 'recall': 0.8211216, 'specificity': 0.8211216, 'f1': 0.8199471, 'auroc': 0.89765644, 'binary_precision': 0.89555126, 'binary_recall': 0.7257053, 'binary_specificity': 0.9165379, 'binary_f1_score': 0.80173165}
confusion matrix:
     0    1
0  593   54
1  175  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445946, 'precision': 0.8483335, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.8441764, 'auroc': 0.9071301, 'binary_precision': 0.8844221, 'binary_recall': 0.7927928, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.8361045}
confusion matrix:
     0    1
0  199   23
1   46  176
new oracle model saved
early stop counter: 3
val acc:0.8217898607254028, best validation acc: 0.8350194692611694, corresponding to test acc:                         0.8018018007278442 / 0.8445945978164673
after epoch: 8,now: 2024-07-26 04:14:52.768071,epoch time: 0:02:49.666818,used: 0:22:36.950403,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9792341, 'recall': 0.97902954, 'specificity': 0.97902954, 'f1': 0.97884035, 'auroc': 0.9979037, 'binary_precision': 0.996, 'binary_recall': 0.962009, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.9787095}
confusion matrix:
      0     1
0  1513     6
1    59  1494
---- Validation: 
scalar performance:
{'acc': 0.7992218, 'precision': 0.8296001, 'recall': 0.7981545, 'specificity': 0.7981545, 'f1': 0.79408276, 'auroc': 0.90915394, 'binary_precision': 0.9279279, 'binary_recall': 0.64576805, 'binary_specificity': 0.95054096, 'binary_f1_score': 0.7615527}
confusion matrix:
     0    1
0  615   32
1  226  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8089906, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73746985, 'auroc': 0.8906339, 'binary_precision': 0.944, 'binary_recall': 0.5315315, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.6801152}
confusion matrix:
     0    1
0  215    7
1  104  118
early stop counter: 4
val acc:0.7992218136787415, best validation acc: 0.8350194692611694, corresponding to test acc:                         0.8018018007278442 / 0.8445945978164673
after epoch: 9,now: 2024-07-26 04:17:41.356600,epoch time: 0:02:48.588529,used: 0:25:25.538932,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.9611651, 'recall': 0.9587629, 'specificity': 0.9587629, 'f1': 0.9582926, 'auroc': 0.9934989, 'binary_precision': 1.0, 'binary_recall': 0.91752577, 'binary_specificity': 1.0, 'binary_f1_score': 0.9569892}
confusion matrix:
      0     1
0  1520     0
1   128  1424
---- Validation: 
scalar performance:
{'acc': 0.57276267, 'precision': 0.73266745, 'recall': 0.56983644, 'specificity': 0.56983644, 'f1': 0.48030552, 'auroc': 0.68862617, 'binary_precision': 0.9238095, 'binary_recall': 0.15203762, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.26110363}
confusion matrix:
     0   1
0  639   8
1  541  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.545045, 'precision': 0.7617924, 'recall': 0.545045, 'specificity': 0.545045, 'f1': 0.4262979, 'auroc': 0.84329605, 'binary_precision': 1.0, 'binary_recall': 0.09009009, 'binary_specificity': 1.0, 'binary_f1_score': 0.16528927}
confusion matrix:
     0   1
0  222   0
1  202  20
early stop counter: 5
val acc:0.572762668132782, best validation acc: 0.8350194692611694, corresponding to test acc:                         0.8018018007278442 / 0.8445945978164673
after epoch: 10,now: 2024-07-26 04:20:29.279516,epoch time: 0:02:47.922916,used: 0:28:13.461848,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_15_seed_6_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:28:13.461848 at 2024-07-26 04:20:29.279516
persisted model performance metric: 

scalar performance:
{'acc': 0.8018018, 'precision': 0.8033776, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.8015441, 'auroc': 0.876045, 'binary_precision': 0.8252427, 'binary_recall': 0.7657658, 'binary_specificity': 0.8378378, 'binary_f1_score': 0.7943926}
confusion matrix:
     0    1
0  186   36
1   52  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8445946, 'precision': 0.8483335, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.8441764, 'auroc': 0.9071301, 'binary_precision': 0.8844221, 'binary_recall': 0.7927928, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.8361045}
confusion matrix:
     0    1
0  199   23
1   46  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2798 MiB |   9241 MiB | 576302 GiB | 576299 GiB |
|       from large pool |   2707 MiB |   9165 MiB | 571280 GiB | 571277 GiB |
|       from small pool |     91 MiB |    132 MiB |   5021 GiB |   5021 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2798 MiB |   9241 MiB | 576302 GiB | 576299 GiB |
|       from large pool |   2707 MiB |   9165 MiB | 571280 GiB | 571277 GiB |
|       from small pool |     91 MiB |    132 MiB |   5021 GiB |   5021 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 575427 GiB | 575425 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 570413 GiB | 570411 GiB |
|       from small pool |     91 MiB |    132 MiB |   5014 GiB |   5014 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10070 MiB |  10180 MiB |  46904 MiB |  36834 MiB |
|       from large pool |   9934 MiB |  10044 MiB |  46558 MiB |  36624 MiB |
|       from small pool |    136 MiB |    140 MiB |    346 MiB |    210 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1193 MiB |   2362 MiB | 445175 GiB | 445174 GiB |
|       from large pool |   1182 MiB |   2356 MiB | 440010 GiB | 440009 GiB |
|       from small pool |     10 MiB |     56 MiB |   5165 GiB |   5165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   81569 K  |   81567 K  |
|       from large pool |     392    |     816    |   40962 K  |   40961 K  |
|       from small pool |    2078    |    2780    |   40607 K  |   40605 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   81569 K  |   81567 K  |
|       from large pool |     392    |     816    |   40962 K  |   40961 K  |
|       from small pool |    2078    |    2780    |   40607 K  |   40605 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     271    |     334    |    1170    |     899    |
|       from large pool |     203    |     266    |     997    |     794    |
|       from small pool |      68    |      70    |     173    |     105    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     154    |     321    |   44009 K  |   44008 K  |
|       from large pool |      76    |     251    |   23154 K  |   23154 K  |
|       from small pool |      78    |     230    |   20854 K  |   20854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 576302 GiB | 576302 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 571280 GiB | 571280 GiB |
|       from small pool |      0 KiB |    132 MiB |   5021 GiB |   5021 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 576302 GiB | 576302 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 571280 GiB | 571280 GiB |
|       from small pool |      0 KiB |    132 MiB |   5021 GiB |   5021 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 575427 GiB | 575427 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 570413 GiB | 570413 GiB |
|       from small pool |      0 KiB |    132 MiB |   5014 GiB |   5014 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3992 MiB |  10180 MiB |  46904 MiB |  42912 MiB |
|       from large pool |   3890 MiB |  10044 MiB |  46558 MiB |  42668 MiB |
|       from small pool |    102 MiB |    140 MiB |    346 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 445176 GiB | 445176 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 440011 GiB | 440011 GiB |
|       from small pool |      0 KiB |     56 MiB |   5165 GiB |   5165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   81569 K  |   81569 K  |
|       from large pool |       2    |     816    |   40962 K  |   40962 K  |
|       from small pool |       0    |    2780    |   40607 K  |   40607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   81569 K  |   81569 K  |
|       from large pool |       2    |     816    |   40962 K  |   40962 K  |
|       from small pool |       0    |    2780    |   40607 K  |   40607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     334    |    1170    |    1035    |
|       from large pool |      84    |     266    |     997    |     913    |
|       from small pool |      51    |      70    |     173    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   44009 K  |   44009 K  |
|       from large pool |       3    |     251    |   23154 K  |   23154 K  |
|       from small pool |       0    |     230    |   20854 K  |   20854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9241 MiB | 576302 GiB | 576302 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 571280 GiB | 571280 GiB |
|       from small pool |      0 KiB |    132 MiB |   5021 GiB |   5021 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9241 MiB | 576302 GiB | 576302 GiB |
|       from large pool |  16640 KiB |   9165 MiB | 571280 GiB | 571280 GiB |
|       from small pool |      0 KiB |    132 MiB |   5021 GiB |   5021 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 575427 GiB | 575427 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 570413 GiB | 570413 GiB |
|       from small pool |      0 KiB |    132 MiB |   5014 GiB |   5014 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3992 MiB |  10180 MiB |  46904 MiB |  42912 MiB |
|       from large pool |   3890 MiB |  10044 MiB |  46558 MiB |  42668 MiB |
|       from small pool |    102 MiB |    140 MiB |    346 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 445176 GiB | 445176 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 440011 GiB | 440011 GiB |
|       from small pool |      0 KiB |     56 MiB |   5165 GiB |   5165 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   81569 K  |   81569 K  |
|       from large pool |       2    |     816    |   40962 K  |   40962 K  |
|       from small pool |       0    |    2780    |   40607 K  |   40607 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   81569 K  |   81569 K  |
|       from large pool |       2    |     816    |   40962 K  |   40962 K  |
|       from small pool |       0    |    2780    |   40607 K  |   40607 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     334    |    1170    |    1035    |
|       from large pool |      84    |     266    |     997    |     913    |
|       from small pool |      51    |      70    |     173    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   44009 K  |   44009 K  |
|       from large pool |       3    |     251    |   23154 K  |   23154 K  |
|       from small pool |       0    |     230    |   20854 K  |   20854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697

 Experiment start at: 2024-07-26 04:21:03.155816
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9547526, 'precision': 0.9568189, 'recall': 0.9553266, 'specificity': 0.9553266, 'f1': 0.9547311, 'auroc': 0.9947946, 'binary_precision': 0.9916955, 'binary_recall': 0.9185898, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9537438}
confusion matrix:
      0     1
0  1500    12
1   127  1433
---- Validation: 
scalar performance:
{'acc': 0.7853846, 'precision': 0.8242978, 'recall': 0.7826941, 'specificity': 0.7826941, 'f1': 0.7776144, 'auroc': 0.8989536, 'binary_precision': 0.9328537, 'binary_recall': 0.6078125, 'binary_specificity': 0.95757574, 'binary_f1_score': 0.7360454}
confusion matrix:
     0    1
0  632   28
1  251  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.8581444, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.8111155, 'auroc': 0.91666824, 'binary_precision': 0.98013246, 'binary_recall': 0.6462882, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.77894735}
confusion matrix:
     0    1
0  226    3
1   81  148
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:23:53.738526,epoch time: 0:02:50.582710,used: 0:02:50.582710,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.96502036, 'recall': 0.964301, 'specificity': 0.964301, 'f1': 0.9644884, 'auroc': 0.99547553, 'binary_precision': 0.95315427, 'binary_recall': 0.97820514, 'binary_specificity': 0.95039684, 'binary_f1_score': 0.9655172}
confusion matrix:
      0     1
0  1437    75
1    34  1526
---- Validation: 
scalar performance:
{'acc': 0.8230769, 'precision': 0.82305634, 'recall': 0.8231298, 'specificity': 0.8231298, 'f1': 0.8230618, 'auroc': 0.888402, 'binary_precision': 0.81635803, 'binary_recall': 0.8265625, 'binary_specificity': 0.81969696, 'binary_f1_score': 0.8214286}
confusion matrix:
     0    1
0  541  119
1  111  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8470036, 'recall': 0.83842796, 'specificity': 0.83842796, 'f1': 0.8374235, 'auroc': 0.90934575, 'binary_precision': 0.9015544, 'binary_recall': 0.75982535, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.82464457}
confusion matrix:
     0    1
0  210   19
1   55  174
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:26:44.424737,epoch time: 0:02:50.686211,used: 0:05:41.268921,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.9686613, 'recall': 0.967094, 'specificity': 0.967094, 'f1': 0.9674014, 'auroc': 0.9979353, 'binary_precision': 0.94840294, 'binary_recall': 0.9897436, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.96863234}
confusion matrix:
      0     1
0  1428    84
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.77, 'precision': 0.7703861, 'recall': 0.77026516, 'specificity': 0.77026516, 'f1': 0.7699933, 'auroc': 0.8335843, 'binary_precision': 0.7556222, 'binary_recall': 0.7875, 'binary_specificity': 0.7530303, 'binary_f1_score': 0.7712318}
confusion matrix:
     0    1
0  497  163
1  136  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76637554, 'precision': 0.8003311, 'recall': 0.76637554, 'specificity': 0.76637554, 'f1': 0.75958, 'auroc': 0.9219122, 'binary_precision': 0.6993464, 'binary_recall': 0.93449783, 'binary_specificity': 0.59825325, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  137   92
1   15  214
early stop counter: 1
val acc:0.7699999809265137, best validation acc: 0.8230769038200378, corresponding to test acc:                         0.8384279608726501 / 0.8384279608726501
after epoch: 3,now: 2024-07-26 04:29:33.234907,epoch time: 0:02:48.810170,used: 0:08:30.079091,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9774367, 'recall': 0.977213, 'specificity': 0.977213, 'f1': 0.97688735, 'auroc': 0.9990618, 'binary_precision': 0.9979933, 'binary_recall': 0.9564102, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.97675943}
confusion matrix:
      0     1
0  1509     3
1    68  1492
---- Validation: 
scalar performance:
{'acc': 0.6430769, 'precision': 0.76454544, 'recall': 0.6377841, 'specificity': 0.6377841, 'f1': 0.5919913, 'auroc': 0.86503845, 'binary_precision': 0.94, 'binary_recall': 0.29375, 'binary_specificity': 0.9818182, 'binary_f1_score': 0.44761902}
confusion matrix:
     0    1
0  648   12
1  452  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6200873, 'precision': 0.7530641, 'recall': 0.6200873, 'specificity': 0.6200873, 'f1': 0.5626317, 'auroc': 0.9056845, 'binary_precision': 0.93650794, 'binary_recall': 0.2576419, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.4041096}
confusion matrix:
     0   1
0  225   4
1  170  59
early stop counter: 2
val acc:0.6430768966674805, best validation acc: 0.8230769038200378, corresponding to test acc:                         0.8384279608726501 / 0.8384279608726501
after epoch: 4,now: 2024-07-26 04:32:21.735875,epoch time: 0:02:48.500968,used: 0:11:18.580059,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.9785266, 'recall': 0.97864264, 'specificity': 0.97864264, 'f1': 0.97851455, 'auroc': 0.9985471, 'binary_precision': 0.9869622, 'binary_recall': 0.9705128, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9786684}
confusion matrix:
      0     1
0  1492    20
1    46  1514
---- Validation: 
scalar performance:
{'acc': 0.8038462, 'precision': 0.82480747, 'recall': 0.8018702, 'specificity': 0.8018702, 'f1': 0.7998806, 'auroc': 0.87938213, 'binary_precision': 0.9035639, 'binary_recall': 0.6734375, 'binary_specificity': 0.93030304, 'binary_f1_score': 0.7717099}
confusion matrix:
     0    1
0  614   46
1  209  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76637554, 'precision': 0.8137691, 'recall': 0.76637554, 'specificity': 0.76637554, 'f1': 0.75720733, 'auroc': 0.90835416, 'binary_precision': 0.9357143, 'binary_recall': 0.5720524, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.7100271}
confusion matrix:
     0    1
0  220    9
1   98  131
early stop counter: 3
val acc:0.8038461804389954, best validation acc: 0.8230769038200378, corresponding to test acc:                         0.8384279608726501 / 0.8384279608726501
after epoch: 5,now: 2024-07-26 04:35:10.683480,epoch time: 0:02:48.947605,used: 0:14:07.527664,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.98011005, 'recall': 0.97925824, 'specificity': 0.97925824, 'f1': 0.9794734, 'auroc': 0.99919236, 'binary_precision': 0.96635514, 'binary_recall': 0.99423075, 'binary_specificity': 0.96428573, 'binary_f1_score': 0.98009485}
confusion matrix:
      0     1
0  1458    54
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.8646154, 'precision': 0.8709581, 'recall': 0.86361265, 'specificity': 0.86361265, 'f1': 0.86377674, 'auroc': 0.9112879, 'binary_precision': 0.9157706, 'binary_recall': 0.7984375, 'binary_specificity': 0.9287879, 'binary_f1_score': 0.85308844}
confusion matrix:
     0    1
0  613   47
1  129  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8799127, 'precision': 0.88114095, 'recall': 0.8799127, 'specificity': 0.8799127, 'f1': 0.8798158, 'auroc': 0.93280065, 'binary_precision': 0.9027778, 'binary_recall': 0.8515284, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.8764045}
confusion matrix:
     0    1
0  208   21
1   34  195
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 04:38:02.685573,epoch time: 0:02:52.002093,used: 0:16:59.529757,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98695064, 'recall': 0.9870167, 'specificity': 0.9870167, 'f1': 0.986977, 'auroc': 0.9990529, 'binary_precision': 0.9896907, 'binary_recall': 0.9846154, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.98714656}
confusion matrix:
      0     1
0  1496    16
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.8253846, 'precision': 0.847988, 'recall': 0.82341385, 'specificity': 0.82341385, 'f1': 0.8218545, 'auroc': 0.89526045, 'binary_precision': 0.932914, 'binary_recall': 0.6953125, 'binary_specificity': 0.95151514, 'binary_f1_score': 0.79677707}
confusion matrix:
     0    1
0  628   32
1  195  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77292573, 'precision': 0.8372328, 'recall': 0.77292573, 'specificity': 0.77292573, 'f1': 0.76155865, 'auroc': 0.8953681, 'binary_precision': 0.9844961, 'binary_recall': 0.55458516, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.7094972}
confusion matrix:
     0    1
0  227    2
1  102  127
early stop counter: 1
val acc:0.8253846168518066, best validation acc: 0.8646153807640076, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 7,now: 2024-07-26 04:40:53.580142,epoch time: 0:02:50.894569,used: 0:19:50.424326,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876377, 'recall': 0.987617, 'specificity': 0.987617, 'f1': 0.9876269, 'auroc': 0.9992029, 'binary_precision': 0.9871959, 'binary_recall': 0.98846155, 'binary_specificity': 0.9867725, 'binary_f1_score': 0.9878284}
confusion matrix:
      0     1
0  1492    20
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.77153844, 'precision': 0.7920416, 'recall': 0.7694602, 'specificity': 0.7694602, 'f1': 0.76649797, 'auroc': 0.85067654, 'binary_precision': 0.86567163, 'binary_recall': 0.634375, 'binary_specificity': 0.9045454, 'binary_f1_score': 0.73219115}
confusion matrix:
     0    1
0  597   63
1  234  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275109, 'precision': 0.8460469, 'recall': 0.82751095, 'specificity': 0.82751095, 'f1': 0.8251697, 'auroc': 0.8986099, 'binary_precision': 0.9261364, 'binary_recall': 0.7117904, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.80493826}
confusion matrix:
     0    1
0  216   13
1   66  163
early stop counter: 2
val acc:0.7715384364128113, best validation acc: 0.8646153807640076, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 8,now: 2024-07-26 04:43:44.792442,epoch time: 0:02:51.212300,used: 0:22:41.636626,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9808581, 'recall': 0.9798891, 'specificity': 0.9798891, 'f1': 0.9801234, 'auroc': 0.9989532, 'binary_precision': 0.9658173, 'binary_recall': 0.99615383, 'binary_specificity': 0.96362436, 'binary_f1_score': 0.98075104}
confusion matrix:
      0     1
0  1457    55
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.8223077, 'precision': 0.8227296, 'recall': 0.8225852, 'specificity': 0.8225852, 'f1': 0.82230246, 'auroc': 0.8787831, 'binary_precision': 0.8065967, 'binary_recall': 0.840625, 'binary_specificity': 0.80454546, 'binary_f1_score': 0.82325935}
confusion matrix:
     0    1
0  531  129
1  102  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8253275, 'precision': 0.83026505, 'recall': 0.8253275, 'specificity': 0.8253275, 'f1': 0.8246722, 'auroc': 0.92111135, 'binary_precision': 0.78988326, 'binary_recall': 0.88646287, 'binary_specificity': 0.76419216, 'binary_f1_score': 0.8353909}
confusion matrix:
     0    1
0  175   54
1   26  203
early stop counter: 3
val acc:0.8223077058792114, best validation acc: 0.8646153807640076, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 9,now: 2024-07-26 04:46:35.658358,epoch time: 0:02:50.865916,used: 0:25:32.502542,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98955506, 'recall': 0.98962146, 'specificity': 0.98962146, 'f1': 0.9895815, 'auroc': 0.9991232, 'binary_precision': 0.992268, 'binary_recall': 0.98717946, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9897172}
confusion matrix:
      0     1
0  1500    12
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.8323077, 'precision': 0.85013944, 'recall': 0.8305634, 'specificity': 0.8305634, 'f1': 0.82959574, 'auroc': 0.89321023, 'binary_precision': 0.92540324, 'binary_recall': 0.7171875, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.8080986}
confusion matrix:
     0    1
0  623   37
1  181  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.8779502, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.8464394, 'auroc': 0.9329294, 'binary_precision': 0.9819277, 'binary_recall': 0.7117904, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8253164}
confusion matrix:
     0    1
0  226    3
1   66  163
early stop counter: 4
val acc:0.8323076963424683, best validation acc: 0.8646153807640076, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 10,now: 2024-07-26 04:49:24.984100,epoch time: 0:02:49.325742,used: 0:28:21.828284,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9853687, 'recall': 0.9854853, 'specificity': 0.9854853, 'f1': 0.98535085, 'auroc': 0.998592, 'binary_precision': 0.9941292, 'binary_recall': 0.97692305, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.98545104}
confusion matrix:
      0     1
0  1503     9
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.8, 'precision': 0.8301005, 'recall': 0.79765624, 'specificity': 0.79765624, 'f1': 0.79442936, 'auroc': 0.8978528, 'binary_precision': 0.92600894, 'binary_recall': 0.6453125, 'binary_specificity': 0.95, 'binary_f1_score': 0.76058924}
confusion matrix:
     0    1
0  627   33
1  227  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80131006, 'precision': 0.8578125, 'recall': 0.80131006, 'specificity': 0.80131006, 'f1': 0.7931438, 'auroc': 0.93144673, 'binary_precision': 1.0, 'binary_recall': 0.60262007, 'binary_specificity': 1.0, 'binary_f1_score': 0.75204355}
confusion matrix:
     0    1
0  229    0
1   91  138
early stop counter: 5
val acc:0.800000011920929, best validation acc: 0.8646153807640076, corresponding to test acc:                         0.8799126744270325 / 0.8799126744270325
after epoch: 11,now: 2024-07-26 04:52:14.952391,epoch time: 0:02:49.968291,used: 0:31:11.796575,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_21_03_seed_7_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:31:11.796575 at 2024-07-26 04:52:14.952391
persisted model performance metric: 

scalar performance:
{'acc': 0.8799127, 'precision': 0.88114095, 'recall': 0.8799127, 'specificity': 0.8799127, 'f1': 0.8798158, 'auroc': 0.93280065, 'binary_precision': 0.9027778, 'binary_recall': 0.8515284, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.8764045}
confusion matrix:
     0    1
0  208   21
1   34  195
oracle model performance metric: 

scalar performance:
{'acc': 0.8799127, 'precision': 0.88114095, 'recall': 0.8799127, 'specificity': 0.8799127, 'f1': 0.8798158, 'auroc': 0.93280065, 'binary_precision': 0.9027778, 'binary_recall': 0.8515284, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.8764045}
confusion matrix:
     0    1
0  208   21
1   34  195
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2800 MiB |   9243 MiB | 650237 GiB | 650234 GiB |
|       from large pool |   2708 MiB |   9167 MiB | 644571 GiB | 644569 GiB |
|       from small pool |     91 MiB |    132 MiB |   5665 GiB |   5665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2800 MiB |   9243 MiB | 650237 GiB | 650234 GiB |
|       from large pool |   2708 MiB |   9167 MiB | 644571 GiB | 644569 GiB |
|       from small pool |     91 MiB |    132 MiB |   5665 GiB |   5665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 649169 GiB | 649166 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 643512 GiB | 643510 GiB |
|       from small pool |     91 MiB |    132 MiB |   5656 GiB |   5656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10068 MiB |  10180 MiB |  52980 MiB |  42912 MiB |
|       from large pool |   9932 MiB |  10044 MiB |  52600 MiB |  42668 MiB |
|       from small pool |    136 MiB |    140 MiB |    380 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1129 MiB |   2362 MiB | 505213 GiB | 505212 GiB |
|       from large pool |   1117 MiB |   2356 MiB | 499386 GiB | 499385 GiB |
|       from small pool |     12 MiB |     56 MiB |   5826 GiB |   5826 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   92031 K  |   92029 K  |
|       from large pool |     392    |     816    |   46214 K  |   46214 K  |
|       from small pool |    2084    |    2780    |   45817 K  |   45815 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   92031 K  |   92029 K  |
|       from large pool |     392    |     816    |   46214 K  |   46214 K  |
|       from small pool |    2084    |    2780    |   45817 K  |   45815 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     272    |     334    |    1307    |    1035    |
|       from large pool |     204    |     266    |    1117    |     913    |
|       from small pool |      68    |      70    |     190    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     151    |     321    |   49588 K  |   49588 K  |
|       from large pool |      74    |     251    |   26053 K  |   26053 K  |
|       from small pool |      77    |     230    |   23534 K  |   23534 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9243 MiB | 650237 GiB | 650237 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 644571 GiB | 644571 GiB |
|       from small pool |      0 KiB |    132 MiB |   5665 GiB |   5665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9243 MiB | 650237 GiB | 650237 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 644571 GiB | 644571 GiB |
|       from small pool |      0 KiB |    132 MiB |   5665 GiB |   5665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 649169 GiB | 649169 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 643512 GiB | 643512 GiB |
|       from small pool |      0 KiB |    132 MiB |   5656 GiB |   5656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3930 MiB |  10180 MiB |  52980 MiB |  49050 MiB |
|       from large pool |   3826 MiB |  10044 MiB |  52600 MiB |  48774 MiB |
|       from small pool |    104 MiB |    140 MiB |    380 MiB |    276 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 505214 GiB | 505214 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 499387 GiB | 499387 GiB |
|       from small pool |      0 KiB |     56 MiB |   5827 GiB |   5827 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   92031 K  |   92031 K  |
|       from large pool |       2    |     816    |   46214 K  |   46214 K  |
|       from small pool |       0    |    2780    |   45817 K  |   45817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   92031 K  |   92031 K  |
|       from large pool |       2    |     816    |   46214 K  |   46214 K  |
|       from small pool |       0    |    2780    |   45817 K  |   45817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |    1307    |    1173    |
|       from large pool |      82    |     266    |    1117    |    1035    |
|       from small pool |      52    |      70    |     190    |     138    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   49588 K  |   49588 K  |
|       from large pool |       3    |     251    |   26053 K  |   26053 K  |
|       from small pool |       0    |     230    |   23535 K  |   23535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9243 MiB | 650237 GiB | 650237 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 644571 GiB | 644571 GiB |
|       from small pool |      0 KiB |    132 MiB |   5665 GiB |   5665 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9243 MiB | 650237 GiB | 650237 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 644571 GiB | 644571 GiB |
|       from small pool |      0 KiB |    132 MiB |   5665 GiB |   5665 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 649169 GiB | 649169 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 643512 GiB | 643512 GiB |
|       from small pool |      0 KiB |    132 MiB |   5656 GiB |   5656 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3930 MiB |  10180 MiB |  52980 MiB |  49050 MiB |
|       from large pool |   3826 MiB |  10044 MiB |  52600 MiB |  48774 MiB |
|       from small pool |    104 MiB |    140 MiB |    380 MiB |    276 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 505214 GiB | 505214 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 499387 GiB | 499387 GiB |
|       from small pool |      0 KiB |     56 MiB |   5827 GiB |   5827 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   92031 K  |   92031 K  |
|       from large pool |       2    |     816    |   46214 K  |   46214 K  |
|       from small pool |       0    |    2780    |   45817 K  |   45817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   92031 K  |   92031 K  |
|       from large pool |       2    |     816    |   46214 K  |   46214 K  |
|       from small pool |       0    |    2780    |   45817 K  |   45817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |    1307    |    1173    |
|       from large pool |      82    |     266    |    1117    |    1035    |
|       from small pool |      52    |      70    |     190    |     138    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   49588 K  |   49588 K  |
|       from large pool |       3    |     251    |   26053 K  |   26053 K  |
|       from small pool |       0    |     230    |   23535 K  |   23535 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697

 Experiment start at: 2024-07-26 04:52:48.550138
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9625, 'precision': 0.962806, 'recall': 0.96237004, 'specificity': 0.96237004, 'f1': 0.96248126, 'auroc': 0.9917635, 'binary_precision': 0.9535032, 'binary_recall': 0.973342, 'binary_specificity': 0.95139813, 'binary_f1_score': 0.9633205}
confusion matrix:
      0     1
0  1429    73
1    41  1497
---- Validation: 
scalar performance:
{'acc': 0.81051815, 'precision': 0.8398127, 'recall': 0.805786, 'specificity': 0.805786, 'f1': 0.80454695, 'auroc': 0.9210619, 'binary_precision': 0.9319728, 'binary_recall': 0.6565495, 'binary_specificity': 0.9550225, 'binary_f1_score': 0.7703842}
confusion matrix:
     0    1
0  637   30
1  215  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8585203, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8320924, 'auroc': 0.91208655, 'binary_precision': 0.9506173, 'binary_recall': 0.70642203, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.8105263}
confusion matrix:
     0    1
0  210    8
1   64  154
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:55:38.925886,epoch time: 0:02:50.375748,used: 0:02:50.375748,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96842104, 'precision': 0.96898544, 'recall': 0.96865815, 'specificity': 0.96865815, 'f1': 0.9684188, 'auroc': 0.9969075, 'binary_precision': 0.98848236, 'binary_recall': 0.94863456, 'binary_specificity': 0.98868173, 'binary_f1_score': 0.96814865}
confusion matrix:
      0     1
0  1485    17
1    79  1459
---- Validation: 
scalar performance:
{'acc': 0.83372, 'precision': 0.8370782, 'recall': 0.8320552, 'specificity': 0.8320552, 'f1': 0.8326788, 'auroc': 0.90920675, 'binary_precision': 0.86371684, 'binary_recall': 0.7795527, 'binary_specificity': 0.8845577, 'binary_f1_score': 0.8194794}
confusion matrix:
     0    1
0  590   77
1  138  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8437722, 'recall': 0.82568806, 'specificity': 0.82568806, 'f1': 0.82336515, 'auroc': 0.9061527, 'binary_precision': 0.92261904, 'binary_recall': 0.71100914, 'binary_specificity': 0.940367, 'binary_f1_score': 0.8031089}
confusion matrix:
     0    1
0  205   13
1   63  155
better model found
persisted
after epoch: 2,now: 2024-07-26 04:58:28.550502,epoch time: 0:02:49.624616,used: 0:05:40.000364,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9430921, 'precision': 0.94517684, 'recall': 0.94272804, 'specificity': 0.94272804, 'f1': 0.94298625, 'auroc': 0.9928726, 'binary_precision': 0.9173807, 'binary_recall': 0.9752765, 'binary_specificity': 0.9101796, 'binary_f1_score': 0.9454431}
confusion matrix:
      0     1
0  1368   135
1    38  1499
---- Validation: 
scalar performance:
{'acc': 0.8368136, 'precision': 0.8426168, 'recall': 0.8388833, 'specificity': 0.8388833, 'f1': 0.8365692, 'auroc': 0.9309716, 'binary_precision': 0.7894003, 'binary_recall': 0.90415335, 'binary_specificity': 0.7736132, 'binary_f1_score': 0.842889}
confusion matrix:
     0    1
0  516  151
1   60  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8325758, 'recall': 0.8325688, 'specificity': 0.8325688, 'f1': 0.83256793, 'auroc': 0.90747833, 'binary_precision': 0.8310502, 'binary_recall': 0.8348624, 'binary_specificity': 0.83027524, 'binary_f1_score': 0.83295196}
confusion matrix:
     0    1
0  181   37
1   36  182
better model found
persisted
after epoch: 3,now: 2024-07-26 05:01:18.174861,epoch time: 0:02:49.624359,used: 0:08:29.624723,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9792763, 'precision': 0.9797214, 'recall': 0.9791302, 'specificity': 0.9791302, 'f1': 0.9792643, 'auroc': 0.9989416, 'binary_precision': 0.96763957, 'binary_recall': 0.99219257, 'binary_specificity': 0.96606785, 'binary_f1_score': 0.97976226}
confusion matrix:
      0     1
0  1452    51
1    12  1525
---- Validation: 
scalar performance:
{'acc': 0.8739366, 'precision': 0.87582934, 'recall': 0.8728032, 'specificity': 0.8728032, 'f1': 0.8734275, 'auroc': 0.934536, 'binary_precision': 0.8957265, 'binary_recall': 0.8370607, 'binary_specificity': 0.90854573, 'binary_f1_score': 0.8654005}
confusion matrix:
     0    1
0  606   61
1  102  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.8388349, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.81608975, 'auroc': 0.91036105, 'binary_precision': 0.92121214, 'binary_recall': 0.6972477, 'binary_specificity': 0.940367, 'binary_f1_score': 0.79373366}
confusion matrix:
     0    1
0  205   13
1   66  152
better model found
persisted
after epoch: 4,now: 2024-07-26 05:04:07.791659,epoch time: 0:02:49.616798,used: 0:11:19.241521,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98421055, 'precision': 0.9842086, 'recall': 0.9842086, 'specificity': 0.9842086, 'f1': 0.9842086, 'auroc': 0.9981235, 'binary_precision': 0.9843852, 'binary_recall': 0.9843852, 'binary_specificity': 0.9840319, 'binary_f1_score': 0.9843852}
confusion matrix:
      0     1
0  1479    24
1    24  1513
---- Validation: 
scalar performance:
{'acc': 0.78499615, 'precision': 0.8281139, 'recall': 0.77913356, 'specificity': 0.77913356, 'f1': 0.7751175, 'auroc': 0.9230281, 'binary_precision': 0.93939394, 'binary_recall': 0.5942492, 'binary_specificity': 0.964018, 'binary_f1_score': 0.72798437}
confusion matrix:
     0    1
0  643   24
1  254  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73394495, 'precision': 0.7995151, 'recall': 0.73394495, 'specificity': 0.73394495, 'f1': 0.71854067, 'auroc': 0.89906156, 'binary_precision': 0.9396552, 'binary_recall': 0.5, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.65269464}
confusion matrix:
     0    1
0  211    7
1  109  109
early stop counter: 1
val acc:0.7849961519241333, best validation acc: 0.8739365935325623, corresponding to test acc:                         0.8188073635101318 / 0.8348624110221863
after epoch: 5,now: 2024-07-26 05:06:56.866028,epoch time: 0:02:49.074369,used: 0:14:08.315890,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.97473085, 'recall': 0.97462463, 'specificity': 0.97462463, 'f1': 0.97466505, 'auroc': 0.9966439, 'binary_precision': 0.9715946, 'binary_recall': 0.9785436, 'binary_specificity': 0.97070575, 'binary_f1_score': 0.9750567}
confusion matrix:
      0     1
0  1458    44
1    33  1505
---- Validation: 
scalar performance:
{'acc': 0.82521266, 'precision': 0.8335116, 'recall': 0.822631, 'specificity': 0.822631, 'f1': 0.8231691, 'auroc': 0.8811952, 'binary_precision': 0.8787879, 'binary_recall': 0.74121404, 'binary_specificity': 0.90404797, 'binary_f1_score': 0.80415946}
confusion matrix:
     0    1
0  603   64
1  162  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165138, 'precision': 0.83408844, 'recall': 0.8165138, 'specificity': 0.8165138, 'f1': 0.81406856, 'auroc': 0.88782513, 'binary_precision': 0.91071427, 'binary_recall': 0.70183486, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.7927461}
confusion matrix:
     0    1
0  203   15
1   65  153
early stop counter: 2
val acc:0.8252126574516296, best validation acc: 0.8739365935325623, corresponding to test acc:                         0.8188073635101318 / 0.8348624110221863
after epoch: 6,now: 2024-07-26 05:09:44.887547,epoch time: 0:02:48.021519,used: 0:16:56.337409,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9782895, 'precision': 0.9788431, 'recall': 0.9784949, 'specificity': 0.9784949, 'f1': 0.97828764, 'auroc': 0.999323, 'binary_precision': 0.9979675, 'binary_recall': 0.9589844, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.97808766}
confusion matrix:
      0     1
0  1501     3
1    63  1473
---- Validation: 
scalar performance:
{'acc': 0.7293117, 'precision': 0.805784, 'recall': 0.7211837, 'specificity': 0.7211837, 'f1': 0.70642763, 'auroc': 0.9037917, 'binary_precision': 0.95098037, 'binary_recall': 0.46485624, 'binary_specificity': 0.9775112, 'binary_f1_score': 0.6244635}
confusion matrix:
     0    1
0  652   15
1  335  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63073397, 'precision': 0.7793238, 'recall': 0.63073397, 'specificity': 0.63073397, 'f1': 0.57409215, 'auroc': 0.88929796, 'binary_precision': 0.9830508, 'binary_recall': 0.26605505, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.41877255}
confusion matrix:
     0   1
0  217   1
1  160  58
early stop counter: 3
val acc:0.7293117046356201, best validation acc: 0.8739365935325623, corresponding to test acc:                         0.8188073635101318 / 0.8348624110221863
after epoch: 7,now: 2024-07-26 05:12:33.360696,epoch time: 0:02:48.473149,used: 0:19:44.810558,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97203946, 'precision': 0.97309756, 'recall': 0.97235113, 'specificity': 0.97235113, 'f1': 0.9720333, 'auroc': 0.9980667, 'binary_precision': 0.9986273, 'binary_recall': 0.94603384, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.97161937}
confusion matrix:
      0     1
0  1500     2
1    83  1455
---- Validation: 
scalar performance:
{'acc': 0.6682135, 'precision': 0.7490667, 'recall': 0.65882117, 'specificity': 0.65882117, 'f1': 0.631124, 'auroc': 0.8968774, 'binary_precision': 0.8832685, 'binary_recall': 0.36261982, 'binary_specificity': 0.9550225, 'binary_f1_score': 0.51415634}
confusion matrix:
     0    1
0  637   30
1  399  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66972476, 'precision': 0.7679734, 'recall': 0.66972476, 'specificity': 0.66972476, 'f1': 0.63639736, 'auroc': 0.88064444, 'binary_precision': 0.9302326, 'binary_recall': 0.36697248, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.52631575}
confusion matrix:
     0   1
0  212   6
1  138  80
early stop counter: 4
val acc:0.6682134866714478, best validation acc: 0.8739365935325623, corresponding to test acc:                         0.8188073635101318 / 0.8348624110221863
after epoch: 8,now: 2024-07-26 05:15:21.725844,epoch time: 0:02:48.365148,used: 0:22:33.175706,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.98203444, 'recall': 0.9820417, 'specificity': 0.9820417, 'f1': 0.98190784, 'auroc': 0.9978126, 'binary_precision': 0.99334663, 'binary_recall': 0.9707412, 'binary_specificity': 0.9933422, 'binary_f1_score': 0.9819138}
confusion matrix:
      0     1
0  1492    10
1    45  1493
---- Validation: 
scalar performance:
{'acc': 0.6349575, 'precision': 0.73527783, 'recall': 0.6241815, 'specificity': 0.6241815, 'f1': 0.5807324, 'auroc': 0.8832519, 'binary_precision': 0.8811881, 'binary_recall': 0.28434506, 'binary_specificity': 0.964018, 'binary_f1_score': 0.42995167}
confusion matrix:
     0    1
0  643   24
1  448  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6995413, 'precision': 0.80205446, 'recall': 0.69954133, 'specificity': 0.69954133, 'f1': 0.67168486, 'auroc': 0.89859855, 'binary_precision': 0.978022, 'binary_recall': 0.4082569, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.5760518}
confusion matrix:
     0   1
0  216   2
1  129  89
early stop counter: 5
val acc:0.634957492351532, best validation acc: 0.8739365935325623, corresponding to test acc:                         0.8188073635101318 / 0.8348624110221863
after epoch: 9,now: 2024-07-26 05:18:10.457959,epoch time: 0:02:48.732115,used: 0:25:21.907821,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_52_48_seed_8_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:25:21.907821 at 2024-07-26 05:18:10.457959
persisted model performance metric: 

scalar performance:
{'acc': 0.81880736, 'precision': 0.8388349, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.81608975, 'auroc': 0.91036105, 'binary_precision': 0.92121214, 'binary_recall': 0.6972477, 'binary_specificity': 0.940367, 'binary_f1_score': 0.79373366}
confusion matrix:
     0    1
0  205   13
1   66  152
oracle model performance metric: 

scalar performance:
{'acc': 0.8348624, 'precision': 0.8585203, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8320924, 'auroc': 0.91208655, 'binary_precision': 0.9506173, 'binary_recall': 0.70642203, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.8105263}
confusion matrix:
     0    1
0  210    8
1   64  154
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2800 MiB |   9243 MiB | 710048 GiB | 710046 GiB |
|       from large pool |   2708 MiB |   9167 MiB | 703862 GiB | 703859 GiB |
|       from small pool |     91 MiB |    132 MiB |   6186 GiB |   6186 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2800 MiB |   9243 MiB | 710048 GiB | 710046 GiB |
|       from large pool |   2708 MiB |   9167 MiB | 703862 GiB | 703859 GiB |
|       from small pool |     91 MiB |    132 MiB |   6186 GiB |   6186 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 708880 GiB | 708878 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 702703 GiB | 702701 GiB |
|       from small pool |     91 MiB |    132 MiB |   6177 GiB |   6177 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10076 MiB |  10180 MiB |  59126 MiB |  49050 MiB |
|       from large pool |   9940 MiB |  10044 MiB |  58714 MiB |  48774 MiB |
|       from small pool |    136 MiB |    140 MiB |    412 MiB |    276 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1157 MiB |   2362 MiB | 553267 GiB | 553266 GiB |
|       from large pool |   1151 MiB |   2356 MiB | 546904 GiB | 546903 GiB |
|       from small pool |      6 MiB |     56 MiB |   6362 GiB |   6362 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |  100503 K  |  100501 K  |
|       from large pool |     392    |     816    |   50467 K  |   50467 K  |
|       from small pool |    2078    |    2780    |   50036 K  |   50034 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |  100503 K  |  100501 K  |
|       from large pool |     392    |     816    |   50467 K  |   50467 K  |
|       from small pool |    2078    |    2780    |   50036 K  |   50034 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     273    |     334    |    1446    |    1173    |
|       from large pool |     205    |     266    |    1240    |    1035    |
|       from small pool |      68    |      70    |     206    |     138    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     155    |     321    |   54112 K  |   54112 K  |
|       from large pool |      80    |     251    |   28404 K  |   28404 K  |
|       from small pool |      75    |     230    |   25708 K  |   25708 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9243 MiB | 710048 GiB | 710048 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 703862 GiB | 703862 GiB |
|       from small pool |      0 KiB |    132 MiB |   6186 GiB |   6186 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9243 MiB | 710048 GiB | 710048 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 703862 GiB | 703862 GiB |
|       from small pool |      0 KiB |    132 MiB |   6186 GiB |   6186 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 708880 GiB | 708880 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 702703 GiB | 702703 GiB |
|       from small pool |      0 KiB |    132 MiB |   6177 GiB |   6177 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3958 MiB |  10180 MiB |  59126 MiB |  55168 MiB |
|       from large pool |   3860 MiB |  10044 MiB |  58714 MiB |  54854 MiB |
|       from small pool |     98 MiB |    140 MiB |    412 MiB |    314 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 553268 GiB | 553268 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 546905 GiB | 546905 GiB |
|       from small pool |      0 KiB |     56 MiB |   6363 GiB |   6363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  100503 K  |  100503 K  |
|       from large pool |       2    |     816    |   50467 K  |   50467 K  |
|       from small pool |       0    |    2780    |   50036 K  |   50036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  100503 K  |  100503 K  |
|       from large pool |       2    |     816    |   50467 K  |   50467 K  |
|       from small pool |       0    |    2780    |   50036 K  |   50036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |    1446    |    1312    |
|       from large pool |      85    |     266    |    1240    |    1155    |
|       from small pool |      49    |      70    |     206    |     157    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   54113 K  |   54113 K  |
|       from large pool |       3    |     251    |   28404 K  |   28404 K  |
|       from small pool |       0    |     230    |   25708 K  |   25708 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9243 MiB | 710048 GiB | 710048 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 703862 GiB | 703862 GiB |
|       from small pool |      0 KiB |    132 MiB |   6186 GiB |   6186 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9243 MiB | 710048 GiB | 710048 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 703862 GiB | 703862 GiB |
|       from small pool |      0 KiB |    132 MiB |   6186 GiB |   6186 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 708880 GiB | 708880 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 702703 GiB | 702703 GiB |
|       from small pool |      0 KiB |    132 MiB |   6177 GiB |   6177 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3958 MiB |  10180 MiB |  59126 MiB |  55168 MiB |
|       from large pool |   3860 MiB |  10044 MiB |  58714 MiB |  54854 MiB |
|       from small pool |     98 MiB |    140 MiB |    412 MiB |    314 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 553268 GiB | 553268 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 546905 GiB | 546905 GiB |
|       from small pool |      0 KiB |     56 MiB |   6363 GiB |   6363 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  100503 K  |  100503 K  |
|       from large pool |       2    |     816    |   50467 K  |   50467 K  |
|       from small pool |       0    |    2780    |   50036 K  |   50036 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  100503 K  |  100503 K  |
|       from large pool |       2    |     816    |   50467 K  |   50467 K  |
|       from small pool |       0    |    2780    |   50036 K  |   50036 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |    1446    |    1312    |
|       from large pool |      85    |     266    |    1240    |    1155    |
|       from small pool |      49    |      70    |     206    |     157    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   54113 K  |   54113 K  |
|       from large pool |       3    |     251    |   28404 K  |   28404 K  |
|       from small pool |       0    |     230    |   25708 K  |   25708 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697

 Experiment start at: 2024-07-26 05:18:44.223134
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97349477, 'precision': 0.9736492, 'recall': 0.9734392, 'specificity': 0.9734392, 'f1': 0.97348905, 'auroc': 0.99627745, 'binary_precision': 0.9667094, 'binary_recall': 0.9811566, 'binary_specificity': 0.96572185, 'binary_f1_score': 0.9738794}
confusion matrix:
      0     1
0  1465    52
1    29  1510
---- Validation: 
scalar performance:
{'acc': 0.8092664, 'precision': 0.8183689, 'recall': 0.8101077, 'specificity': 0.8101077, 'f1': 0.8081678, 'auroc': 0.9113102, 'binary_precision': 0.7619681, 'binary_recall': 0.8939158, 'binary_specificity': 0.7262997, 'binary_f1_score': 0.8226849}
confusion matrix:
     0    1
0  475  179
1   68  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83913046, 'precision': 0.84171426, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.8388258, 'auroc': 0.9228922, 'binary_precision': 0.812, 'binary_recall': 0.8826087, 'binary_specificity': 0.79565215, 'binary_f1_score': 0.84583336}
confusion matrix:
     0    1
0  183   47
1   27  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:21:35.327173,epoch time: 0:02:51.104039,used: 0:02:51.104039,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9496073, 'precision': 0.95356923, 'recall': 0.9492796, 'specificity': 0.9492796, 'f1': 0.9494688, 'auroc': 0.9981158, 'binary_precision': 0.9129398, 'binary_recall': 0.9948018, 'binary_specificity': 0.9037574, 'binary_f1_score': 0.95211446}
confusion matrix:
      0     1
0  1371   146
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.82625484, 'precision': 0.84112287, 'recall': 0.8272994, 'specificity': 0.8272994, 'f1': 0.82464707, 'auroc': 0.9300882, 'binary_precision': 0.76735216, 'binary_recall': 0.93135726, 'binary_specificity': 0.72324157, 'binary_f1_score': 0.8414376}
confusion matrix:
     0    1
0  473  181
1   44  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8369565, 'precision': 0.8371159, 'recall': 0.8369565, 'specificity': 0.8369565, 'f1': 0.83693725, 'auroc': 0.91482043, 'binary_precision': 0.82978725, 'binary_recall': 0.84782606, 'binary_specificity': 0.82608694, 'binary_f1_score': 0.8387097}
confusion matrix:
     0    1
0  190   40
1   35  195
better model found
persisted
after epoch: 2,now: 2024-07-26 05:24:25.880663,epoch time: 0:02:50.553490,used: 0:05:41.657529,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.97188807, 'recall': 0.9718363, 'specificity': 0.9718363, 'f1': 0.9718555, 'auroc': 0.9964543, 'binary_precision': 0.9696382, 'binary_recall': 0.9746753, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9721502}
confusion matrix:
      0     1
0  1469    47
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.8648649, 'precision': 0.87222165, 'recall': 0.86416125, 'specificity': 0.86416125, 'f1': 0.8640213, 'auroc': 0.9309255, 'binary_precision': 0.92210144, 'binary_recall': 0.79407173, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.85331094}
confusion matrix:
     0    1
0  611   43
1  132  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130435, 'precision': 0.85612905, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.8072125, 'auroc': 0.9309452, 'binary_precision': 0.98, 'binary_recall': 0.6391304, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.77368426}
confusion matrix:
     0    1
0  227    3
1   83  147
better model found
persisted
after epoch: 3,now: 2024-07-26 05:27:16.286411,epoch time: 0:02:50.405748,used: 0:08:32.063277,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.9769188, 'recall': 0.97671676, 'specificity': 0.97671676, 'f1': 0.9767624, 'auroc': 0.99775517, 'binary_precision': 0.9698911, 'binary_recall': 0.9843953, 'binary_specificity': 0.9690382, 'binary_f1_score': 0.9770894}
confusion matrix:
      0     1
0  1471    47
1    24  1514
---- Validation: 
scalar performance:
{'acc': 0.8023166, 'precision': 0.8024201, 'recall': 0.80220366, 'specificity': 0.80220366, 'f1': 0.8022429, 'auroc': 0.88603914, 'binary_precision': 0.80604136, 'binary_recall': 0.7909516, 'binary_specificity': 0.81345564, 'binary_f1_score': 0.79842514}
confusion matrix:
     0    1
0  532  122
1  134  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130435, 'precision': 0.8131382, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.81302935, 'auroc': 0.88120985, 'binary_precision': 0.8185841, 'binary_recall': 0.8043478, 'binary_specificity': 0.82173914, 'binary_f1_score': 0.8114035}
confusion matrix:
     0    1
0  189   41
1   45  185
early stop counter: 1
val acc:0.8023166060447693, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.813043475151062 / 0.8391304612159729
after epoch: 4,now: 2024-07-26 05:30:05.696384,epoch time: 0:02:49.409973,used: 0:11:21.473250,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9528796, 'precision': 0.95612496, 'recall': 0.95319283, 'specificity': 0.95319283, 'f1': 0.95281625, 'auroc': 0.99646246, 'binary_precision': 0.9964413, 'binary_recall': 0.9096816, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.95108694}
confusion matrix:
      0     1
0  1512     5
1   139  1400
---- Validation: 
scalar performance:
{'acc': 0.5953668, 'precision': 0.7478938, 'recall': 0.5913877, 'specificity': 0.5913877, 'f1': 0.51722556, 'auroc': 0.8503109, 'binary_precision': 0.9398496, 'binary_recall': 0.1950078, 'binary_specificity': 0.9877676, 'binary_f1_score': 0.32299742}
confusion matrix:
     0    1
0  646    8
1  516  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75869566, 'precision': 0.8204993, 'recall': 0.75869566, 'specificity': 0.75869566, 'f1': 0.74647343, 'auroc': 0.8913232, 'binary_precision': 0.9612403, 'binary_recall': 0.53913045, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.69080776}
confusion matrix:
     0    1
0  225    5
1  106  124
early stop counter: 2
val acc:0.5953667759895325, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.813043475151062 / 0.8391304612159729
after epoch: 5,now: 2024-07-26 05:32:55.482482,epoch time: 0:02:49.786098,used: 0:14:11.259348,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98706853, 'recall': 0.9869976, 'specificity': 0.9869976, 'f1': 0.9869109, 'auroc': 0.9994363, 'binary_precision': 0.99800795, 'binary_recall': 0.975974, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.986868}
confusion matrix:
      0     1
0  1513     3
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7861004, 'precision': 0.8267875, 'recall': 0.784319, 'specificity': 0.784319, 'f1': 0.77849233, 'auroc': 0.9279938, 'binary_precision': 0.9396135, 'binary_recall': 0.6068643, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.7374407}
confusion matrix:
     0    1
0  629   25
1  252  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78695655, 'precision': 0.8416149, 'recall': 0.78695655, 'specificity': 0.78695655, 'f1': 0.7780797, 'auroc': 0.90625715, 'binary_precision': 0.9782609, 'binary_recall': 0.5869565, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.7336956}
confusion matrix:
     0    1
0  227    3
1   95  135
early stop counter: 3
val acc:0.7861003875732422, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.813043475151062 / 0.8391304612159729
after epoch: 6,now: 2024-07-26 05:35:43.869748,epoch time: 0:02:48.387266,used: 0:16:59.646614,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.9737664, 'recall': 0.97270954, 'specificity': 0.97270954, 'f1': 0.97250175, 'auroc': 0.999501, 'binary_precision': 1.0, 'binary_recall': 0.94541913, 'binary_specificity': 1.0, 'binary_f1_score': 0.9719439}
confusion matrix:
      0     1
0  1517     0
1    84  1455
---- Validation: 
scalar performance:
{'acc': 0.76061773, 'precision': 0.82347715, 'recall': 0.75839186, 'specificity': 0.75839186, 'f1': 0.74732757, 'auroc': 0.93373966, 'binary_precision': 0.96358544, 'binary_recall': 0.53666145, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.68937874}
confusion matrix:
     0    1
0  641   13
1  297  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6695652, 'precision': 0.79506576, 'recall': 0.6695652, 'specificity': 0.6695652, 'f1': 0.63024855, 'auroc': 0.9136106, 'binary_precision': 0.9875, 'binary_recall': 0.34347826, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.5096774}
confusion matrix:
     0   1
0  229   1
1  151  79
early stop counter: 4
val acc:0.760617733001709, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.813043475151062 / 0.8391304612159729
after epoch: 7,now: 2024-07-26 05:38:32.832515,epoch time: 0:02:48.962767,used: 0:19:48.609381,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9862544, 'recall': 0.98627937, 'specificity': 0.98627937, 'f1': 0.98625636, 'auroc': 0.9987385, 'binary_precision': 0.9895356, 'binary_recall': 0.9831059, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9863103}
confusion matrix:
      0     1
0  1501    16
1    26  1513
---- Validation: 
scalar performance:
{'acc': 0.76833975, 'precision': 0.82660216, 'recall': 0.7662077, 'specificity': 0.7662077, 'f1': 0.7565484, 'auroc': 0.9190414, 'binary_precision': 0.9620596, 'binary_recall': 0.55382216, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.70297027}
confusion matrix:
     0    1
0  640   14
1  286  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7717391, 'precision': 0.8432836, 'recall': 0.7717391, 'specificity': 0.7717391, 'f1': 0.75919235, 'auroc': 0.91413987, 'binary_precision': 1.0, 'binary_recall': 0.54347825, 'binary_specificity': 1.0, 'binary_f1_score': 0.70422536}
confusion matrix:
     0    1
0  230    0
1  105  125
early stop counter: 5
val acc:0.7683397531509399, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.813043475151062 / 0.8391304612159729
after epoch: 8,now: 2024-07-26 05:41:21.312762,epoch time: 0:02:48.480247,used: 0:22:37.089628,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_18_44_seed_9_23064697
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:22:37.089628 at 2024-07-26 05:41:21.312762
persisted model performance metric: 

scalar performance:
{'acc': 0.8130435, 'precision': 0.85612905, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.8072125, 'auroc': 0.9309452, 'binary_precision': 0.98, 'binary_recall': 0.6391304, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.77368426}
confusion matrix:
     0    1
0  227    3
1   83  147
oracle model performance metric: 

scalar performance:
{'acc': 0.83913046, 'precision': 0.84171426, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.8388258, 'auroc': 0.9228922, 'binary_precision': 0.812, 'binary_recall': 0.8826087, 'binary_specificity': 0.79565215, 'binary_f1_score': 0.84583336}
confusion matrix:
     0    1
0  183   47
1   27  203
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2797 MiB |   9243 MiB | 763583 GiB | 763580 GiB |
|       from large pool |   2705 MiB |   9167 MiB | 756930 GiB | 756928 GiB |
|       from small pool |     91 MiB |    132 MiB |   6652 GiB |   6652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2797 MiB |   9243 MiB | 763583 GiB | 763580 GiB |
|       from large pool |   2705 MiB |   9167 MiB | 756930 GiB | 756928 GiB |
|       from small pool |     91 MiB |    132 MiB |   6652 GiB |   6652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2779 MiB |   9224 MiB | 762278 GiB | 762275 GiB |
|       from large pool |   2687 MiB |   9148 MiB | 755635 GiB | 755633 GiB |
|       from small pool |     91 MiB |    132 MiB |   6642 GiB |   6642 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10064 MiB |  10180 MiB |  65232 MiB |  55168 MiB |
|       from large pool |   9928 MiB |  10044 MiB |  64782 MiB |  54854 MiB |
|       from small pool |    136 MiB |    140 MiB |    450 MiB |    314 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1186 MiB |   2362 MiB | 595958 GiB | 595957 GiB |
|       from large pool |   1180 MiB |   2356 MiB | 589115 GiB | 589114 GiB |
|       from small pool |      6 MiB |     56 MiB |   6842 GiB |   6842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |  108081 K  |  108079 K  |
|       from large pool |     392    |     816    |   54270 K  |   54270 K  |
|       from small pool |    2084    |    2780    |   53811 K  |   53808 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |  108081 K  |  108079 K  |
|       from large pool |     392    |     816    |   54270 K  |   54270 K  |
|       from small pool |    2084    |    2780    |   53811 K  |   53808 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     274    |     334    |    1586    |    1312    |
|       from large pool |     206    |     266    |    1361    |    1155    |
|       from small pool |      68    |      70    |     225    |     157    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     153    |     321    |   58118 K  |   58118 K  |
|       from large pool |      80    |     251    |   30501 K  |   30501 K  |
|       from small pool |      73    |     230    |   27617 K  |   27617 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   9243 MiB | 763583 GiB | 763583 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 756930 GiB | 756930 GiB |
|       from small pool |      0 KiB |    132 MiB |   6652 GiB |   6652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   9243 MiB | 763583 GiB | 763583 GiB |
|       from large pool |  16640 KiB |   9167 MiB | 756930 GiB | 756930 GiB |
|       from small pool |      0 KiB |    132 MiB |   6652 GiB |   6652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   9224 MiB | 762278 GiB | 762278 GiB |
|       from large pool |  16640 KiB |   9148 MiB | 755635 GiB | 755635 GiB |
|       from small pool |      0 KiB |    132 MiB |   6642 GiB |   6642 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3984 MiB |  10180 MiB |  65232 MiB |  61248 MiB |
|       from large pool |   3886 MiB |  10044 MiB |  64782 MiB |  60896 MiB |
|       from small pool |     98 MiB |    140 MiB |    450 MiB |    352 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   2362 MiB | 595959 GiB | 595959 GiB |
|       from large pool |  24320 KiB |   2356 MiB | 589116 GiB | 589116 GiB |
|       from small pool |      0 KiB |     56 MiB |   6842 GiB |   6842 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  108081 K  |  108081 K  |
|       from large pool |       2    |     816    |   54270 K  |   54270 K  |
|       from small pool |       0    |    2780    |   53811 K  |   53811 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  108081 K  |  108081 K  |
|       from large pool |       2    |     816    |   54270 K  |   54270 K  |
|       from small pool |       0    |    2780    |   53811 K  |   53811 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     334    |    1586    |    1452    |
|       from large pool |      85    |     266    |    1361    |    1276    |
|       from small pool |      49    |      70    |     225    |     176    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     321    |   58119 K  |   58119 K  |
|       from large pool |       3    |     251    |   30501 K  |   30501 K  |
|       from small pool |       0    |     230    |   27617 K  |   27617 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 05:41:32 2024]
Finished job 0.
1 of 1 steps (100%) done
