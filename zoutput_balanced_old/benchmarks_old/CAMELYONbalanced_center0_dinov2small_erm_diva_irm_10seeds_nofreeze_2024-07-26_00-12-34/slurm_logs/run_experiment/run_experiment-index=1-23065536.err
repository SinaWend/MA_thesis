Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 04:38:57 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536

 Experiment start at: 2024-07-26 04:39:27.505978
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.93547046, 'recall': 0.9319775, 'specificity': 0.9319775, 'f1': 0.9312118, 'auroc': 0.9851197, 'binary_precision': 0.9813887, 'binary_recall': 0.8811054, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9285472}
confusion matrix:
      0     1
0  1490    26
1   185  1371
---- Validation: 
scalar performance:
{'acc': 0.8385093, 'precision': 0.84411585, 'recall': 0.8376096, 'specificity': 0.8376096, 'f1': 0.837569, 'auroc': 0.91235363, 'binary_precision': 0.8846847, 'binary_recall': 0.77322835, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8252101}
confusion matrix:
     0    1
0  589   64
1  144  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8454778, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84144545, 'auroc': 0.90857756, 'binary_precision': 0.88082904, 'binary_recall': 0.7906977, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8333334}
confusion matrix:
     0    1
0  192   23
1   45  170
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:40:35.522620,epoch time: 0:01:08.016642,used: 0:01:08.016642,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.96454734, 'recall': 0.96448255, 'specificity': 0.96448255, 'f1': 0.96450996, 'auroc': 0.9950502, 'binary_precision': 0.9628919, 'binary_recall': 0.96722364, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.96505296}
confusion matrix:
      0     1
0  1458    58
1    51  1505
---- Validation: 
scalar performance:
{'acc': 0.6754658, 'precision': 0.72611237, 'recall': 0.6787016, 'specificity': 0.6787016, 'f1': 0.6586344, 'auroc': 0.825233, 'binary_precision': 0.61554843, 'binary_recall': 0.91023624, 'binary_specificity': 0.44716692, 'binary_f1_score': 0.73443455}
confusion matrix:
     0    1
0  292  361
1   57  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.8032521, 'recall': 0.7465116, 'specificity': 0.7465116, 'f1': 0.73407245, 'auroc': 0.92878306, 'binary_precision': 0.6720779, 'binary_recall': 0.96279067, 'binary_specificity': 0.53023255, 'binary_f1_score': 0.791587}
confusion matrix:
     0    1
0  114  101
1    8  207
early stop counter: 1
val acc:0.6754658222198486, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 2,now: 2024-07-26 04:41:37.698034,epoch time: 0:01:02.175414,used: 0:02:10.192056,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9671224, 'precision': 0.9678544, 'recall': 0.96741784, 'specificity': 0.96741784, 'f1': 0.9671191, 'auroc': 0.993285, 'binary_precision': 0.989899, 'binary_recall': 0.9447301, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9667872}
confusion matrix:
      0     1
0  1501    15
1    86  1470
---- Validation: 
scalar performance:
{'acc': 0.79270184, 'precision': 0.79266024, 'recall': 0.7926722, 'specificity': 0.7926722, 'f1': 0.7926657, 'auroc': 0.86545205, 'binary_precision': 0.7893082, 'binary_recall': 0.7905512, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.78992915}
confusion matrix:
     0    1
0  519  134
1  133  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79114974, 'recall': 0.78837204, 'specificity': 0.78837204, 'f1': 0.7878661, 'auroc': 0.8811898, 'binary_precision': 0.7627119, 'binary_recall': 0.8372093, 'binary_specificity': 0.73953485, 'binary_f1_score': 0.7982261}
confusion matrix:
     0    1
0  159   56
1   35  180
early stop counter: 2
val acc:0.7927018404006958, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 3,now: 2024-07-26 04:42:39.876127,epoch time: 0:01:02.178093,used: 0:03:12.370149,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9730954, 'recall': 0.97290933, 'specificity': 0.97290933, 'f1': 0.97265553, 'auroc': 0.997481, 'binary_precision': 0.9913275, 'binary_recall': 0.95439947, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.9725131}
confusion matrix:
      0     1
0  1502    13
1    71  1486
---- Validation: 
scalar performance:
{'acc': 0.6560559, 'precision': 0.7566124, 'recall': 0.6516152, 'specificity': 0.6516152, 'f1': 0.6149134, 'auroc': 0.83720684, 'binary_precision': 0.9137931, 'binary_recall': 0.33385828, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.48904273}
confusion matrix:
     0    1
0  633   20
1  423  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.8663385, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83126163, 'auroc': 0.9097891, 'binary_precision': 0.9736842, 'binary_recall': 0.6883721, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.80653954}
confusion matrix:
     0    1
0  211    4
1   67  148
early stop counter: 3
val acc:0.6560559272766113, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 4,now: 2024-07-26 04:43:41.993676,epoch time: 0:01:02.117549,used: 0:04:14.487698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9508464, 'precision': 0.9546547, 'recall': 0.95154047, 'specificity': 0.95154047, 'f1': 0.9507866, 'auroc': 0.99740803, 'binary_precision': 1.0, 'binary_recall': 0.9030809, 'binary_specificity': 1.0, 'binary_f1_score': 0.9490725}
confusion matrix:
      0     1
0  1514     0
1   151  1407
---- Validation: 
scalar performance:
{'acc': 0.621118, 'precision': 0.75945926, 'recall': 0.6159434, 'specificity': 0.6159434, 'f1': 0.55761254, 'auroc': 0.8571271, 'binary_precision': 0.94545454, 'binary_recall': 0.24566929, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.39}
confusion matrix:
     0    1
0  644    9
1  479  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.805271, 'recall': 0.7069768, 'specificity': 0.7069768, 'f1': 0.6813241, 'auroc': 0.90542454, 'binary_precision': 0.97849464, 'binary_recall': 0.4232558, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.5909091}
confusion matrix:
     0   1
0  213   2
1  124  91
early stop counter: 4
val acc:0.6211180090904236, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8418604731559753
after epoch: 5,now: 2024-07-26 04:44:44.628661,epoch time: 0:01:02.634985,used: 0:05:17.122683,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9796461, 'recall': 0.9793949, 'specificity': 0.9793949, 'f1': 0.979483, 'auroc': 0.9983059, 'binary_precision': 0.97401774, 'binary_recall': 0.98588836, 'binary_specificity': 0.9729015, 'binary_f1_score': 0.97991705}
confusion matrix:
      0     1
0  1472    41
1    22  1537
---- Validation: 
scalar performance:
{'acc': 0.8291925, 'precision': 0.83335173, 'recall': 0.82839954, 'specificity': 0.82839954, 'f1': 0.8283915, 'auroc': 0.90232605, 'binary_precision': 0.86725664, 'binary_recall': 0.77165353, 'binary_specificity': 0.8851455, 'binary_f1_score': 0.81666666}
confusion matrix:
     0    1
0  578   75
1  145  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.8637428, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8627008, 'auroc': 0.9239589, 'binary_precision': 0.88235295, 'binary_recall': 0.8372093, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.85918856}
confusion matrix:
     0    1
0  191   24
1   35  180
new oracle model saved
early stop counter: 5
val acc:0.8291925191879272, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8627907037734985
after epoch: 6,now: 2024-07-26 04:45:46.789894,epoch time: 0:01:02.161233,used: 0:06:19.283916,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.96907854, 'recall': 0.9678457, 'specificity': 0.9678457, 'f1': 0.96743464, 'auroc': 0.99921364, 'binary_precision': 1.0, 'binary_recall': 0.9356913, 'binary_specificity': 1.0, 'binary_f1_score': 0.9667774}
confusion matrix:
      0     1
0  1517     0
1   100  1455
---- Validation: 
scalar performance:
{'acc': 0.5799689, 'precision': 0.7496102, 'recall': 0.5741243, 'specificity': 0.5741243, 'f1': 0.48671386, 'auroc': 0.89082, 'binary_precision': 0.9519231, 'binary_recall': 0.15590551, 'binary_specificity': 0.992343, 'binary_f1_score': 0.2679296}
confusion matrix:
     0   1
0  648   5
1  536  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.8214861, 'recall': 0.74186045, 'specificity': 0.74186045, 'f1': 0.72482145, 'auroc': 0.9167334, 'binary_precision': 0.9814815, 'binary_recall': 0.49302325, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.65634674}
confusion matrix:
     0    1
0  213    2
1  109  106
early stop counter: 6
val acc:0.5799689292907715, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8627907037734985
after epoch: 7,now: 2024-07-26 04:46:48.884326,epoch time: 0:01:02.094432,used: 0:07:21.378348,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98541236, 'recall': 0.9854661, 'specificity': 0.9854661, 'f1': 0.98535144, 'auroc': 0.9986774, 'binary_precision': 0.99475753, 'binary_recall': 0.97620577, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.98539436}
confusion matrix:
      0     1
0  1509     8
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.7049689, 'precision': 0.7404778, 'recall': 0.70221996, 'specificity': 0.70221996, 'f1': 0.6918249, 'auroc': 0.8482522, 'binary_precision': 0.82945734, 'binary_recall': 0.5055118, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.62818}
confusion matrix:
     0    1
0  587   66
1  314  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.8538635, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.8534495, 'auroc': 0.91694975, 'binary_precision': 0.86538464, 'binary_recall': 0.8372093, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.85106385}
confusion matrix:
     0    1
0  187   28
1   35  180
early stop counter: 7
val acc:0.7049689292907715, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8627907037734985
after epoch: 8,now: 2024-07-26 04:47:51.032386,epoch time: 0:01:02.148060,used: 0:08:23.526408,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98370206, 'recall': 0.9837636, 'specificity': 0.9837636, 'f1': 0.98372245, 'auroc': 0.9989588, 'binary_precision': 0.9870634, 'binary_recall': 0.9807198, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9838814}
confusion matrix:
      0     1
0  1496    20
1    30  1526
---- Validation: 
scalar performance:
{'acc': 0.80279505, 'precision': 0.82268184, 'recall': 0.80104184, 'specificity': 0.80104184, 'f1': 0.7990427, 'auroc': 0.9007946, 'binary_precision': 0.8993711, 'binary_recall': 0.6755906, 'binary_specificity': 0.9264931, 'binary_f1_score': 0.7715828}
confusion matrix:
     0    1
0  605   48
1  206  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8612466, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.8603896, 'auroc': 0.92380744, 'binary_precision': 0.8780488, 'binary_recall': 0.8372093, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  190   25
1   35  180
early stop counter: 8
val acc:0.8027950525283813, best validation acc: 0.8385093212127686, corresponding to test acc:                         0.8418604731559753 / 0.8627907037734985
after epoch: 9,now: 2024-07-26 04:48:52.868778,epoch time: 0:01:01.836392,used: 0:09:25.362800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98387885, 'recall': 0.9836409, 'specificity': 0.9836409, 'f1': 0.98371816, 'auroc': 0.9989402, 'binary_precision': 0.9777778, 'binary_recall': 0.9903537, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.98402554}
confusion matrix:
      0     1
0  1482    35
1    15  1540
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8625622, 'recall': 0.85797346, 'specificity': 0.85797346, 'f1': 0.85812056, 'auroc': 0.9081043, 'binary_precision': 0.8966725, 'binary_recall': 0.8062992, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.8490879}
confusion matrix:
     0    1
0  594   59
1  123  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87906975, 'precision': 0.8802543, 'recall': 0.8790698, 'specificity': 0.8790698, 'f1': 0.8789755, 'auroc': 0.9456787, 'binary_precision': 0.9014778, 'binary_recall': 0.8511628, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8755981}
confusion matrix:
     0    1
0  195   20
1   32  183
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-26 04:49:55.439737,epoch time: 0:01:02.570959,used: 0:10:27.933759,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905839, 'recall': 0.9905371, 'specificity': 0.9905371, 'f1': 0.9905579, 'auroc': 0.9993386, 'binary_precision': 0.9891095, 'binary_recall': 0.99228793, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9906962}
confusion matrix:
      0     1
0  1499    17
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.867236, 'precision': 0.86960465, 'recall': 0.86667836, 'specificity': 0.86667836, 'f1': 0.86687577, 'auroc': 0.9206159, 'binary_precision': 0.8959044, 'binary_recall': 0.8267717, 'binary_specificity': 0.906585, 'binary_f1_score': 0.8599509}
confusion matrix:
     0    1
0  592   61
1  110  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.8852189, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8735322, 'auroc': 0.93646294, 'binary_precision': 0.9497207, 'binary_recall': 0.7906977, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8629441}
confusion matrix:
     0    1
0  206    9
1   45  170
better model found
persisted
after epoch: 11,now: 2024-07-26 04:50:57.711184,epoch time: 0:01:02.271447,used: 0:11:30.205206,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886556, 'recall': 0.98873377, 'specificity': 0.98873377, 'f1': 0.9886066, 'auroc': 0.99931157, 'binary_precision': 0.9980366, 'binary_recall': 0.97944766, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.9886548}
confusion matrix:
      0     1
0  1512     3
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.78493786, 'precision': 0.82139015, 'recall': 0.7825626, 'specificity': 0.7825626, 'f1': 0.7776618, 'auroc': 0.89854693, 'binary_precision': 0.9261905, 'binary_recall': 0.6125984, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.7374407}
confusion matrix:
     0    1
0  622   31
1  246  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.872093, 'precision': 0.890767, 'recall': 0.872093, 'specificity': 0.872093, 'f1': 0.87054646, 'auroc': 0.9366144, 'binary_precision': 0.97619045, 'binary_recall': 0.7627907, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.85639685}
confusion matrix:
     0    1
0  211    4
1   51  164
early stop counter: 1
val acc:0.784937858581543, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8790697455406189
after epoch: 12,now: 2024-07-26 04:51:59.493658,epoch time: 0:01:01.782474,used: 0:12:31.987680,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.97884697, 'recall': 0.9775802, 'specificity': 0.9775802, 'f1': 0.9778392, 'auroc': 0.99961245, 'binary_precision': 0.960445, 'binary_recall': 0.9974326, 'binary_specificity': 0.95772785, 'binary_f1_score': 0.9785894}
confusion matrix:
      0     1
0  1450    64
1     4  1554
---- Validation: 
scalar performance:
{'acc': 0.85248446, 'precision': 0.8565805, 'recall': 0.85323703, 'specificity': 0.85323703, 'f1': 0.8522247, 'auroc': 0.92349064, 'binary_precision': 0.81471, 'binary_recall': 0.9070866, 'binary_specificity': 0.79938745, 'binary_f1_score': 0.85842025}
confusion matrix:
     0    1
0  522  131
1   59  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.82553756, 'recall': 0.82325584, 'specificity': 0.82325584, 'f1': 0.8229456, 'auroc': 0.92047596, 'binary_precision': 0.7982833, 'binary_recall': 0.8651163, 'binary_specificity': 0.7813954, 'binary_f1_score': 0.83035713}
confusion matrix:
     0    1
0  168   47
1   29  186
early stop counter: 2
val acc:0.8524844646453857, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8790697455406189
after epoch: 13,now: 2024-07-26 04:53:01.499841,epoch time: 0:01:02.006183,used: 0:13:33.993863,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9884191, 'recall': 0.9882029, 'specificity': 0.9882029, 'f1': 0.9882771, 'auroc': 0.9995142, 'binary_precision': 0.98284626, 'binary_recall': 0.99421597, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.98849845}
confusion matrix:
      0     1
0  1489    27
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8416149, 'precision': 0.8448247, 'recall': 0.84093285, 'specificity': 0.84093285, 'f1': 0.8410319, 'auroc': 0.89884365, 'binary_precision': 0.8747826, 'binary_recall': 0.792126, 'binary_specificity': 0.8897397, 'binary_f1_score': 0.8314049}
confusion matrix:
     0    1
0  581   72
1  132  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88837206, 'precision': 0.8971704, 'recall': 0.88837206, 'specificity': 0.88837206, 'f1': 0.8877504, 'auroc': 0.93605196, 'binary_precision': 0.95628417, 'binary_recall': 0.81395346, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.8793969}
confusion matrix:
     0    1
0  207    8
1   40  175
new oracle model saved
early stop counter: 3
val acc:0.8416149020195007, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8883720636367798
after epoch: 14,now: 2024-07-26 04:54:03.879354,epoch time: 0:01:02.379513,used: 0:14:36.373376,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98445344, 'recall': 0.98453724, 'specificity': 0.98453724, 'f1': 0.98437476, 'auroc': 0.99890494, 'binary_precision': 0.99540985, 'binary_recall': 0.9737011, 'binary_specificity': 0.9953734, 'binary_f1_score': 0.9844358}
confusion matrix:
      0     1
0  1506     7
1    41  1518
---- Validation: 
scalar performance:
{'acc': 0.6583851, 'precision': 0.77840817, 'recall': 0.6537386, 'specificity': 0.6537386, 'f1': 0.6132512, 'auroc': 0.83947074, 'binary_precision': 0.9577465, 'binary_recall': 0.32125986, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.4811321}
confusion matrix:
     0    1
0  644    9
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.7961433, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.60956097, 'auroc': 0.89564085, 'binary_precision': 1.0, 'binary_recall': 0.3116279, 'binary_specificity': 1.0, 'binary_f1_score': 0.4751773}
confusion matrix:
     0   1
0  215   0
1  148  67
early stop counter: 4
val acc:0.6583850979804993, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8883720636367798
after epoch: 15,now: 2024-07-26 04:55:06.126144,epoch time: 0:01:02.246790,used: 0:15:38.620166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869957, 'recall': 0.98696107, 'specificity': 0.98696107, 'f1': 0.98697674, 'auroc': 0.9989385, 'binary_precision': 0.98588836, 'binary_recall': 0.9884244, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.9871548}
confusion matrix:
      0     1
0  1495    22
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.83928573, 'precision': 0.859756, 'recall': 0.8376156, 'specificity': 0.8376156, 'f1': 0.8364703, 'auroc': 0.92651725, 'binary_precision': 0.94214875, 'binary_recall': 0.71811026, 'binary_specificity': 0.95712095, 'binary_f1_score': 0.8150134}
confusion matrix:
     0    1
0  625   28
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.85360956, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.7976471, 'auroc': 0.91506755, 'binary_precision': 0.9851852, 'binary_recall': 0.61860466, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.76000005}
confusion matrix:
     0    1
0  213    2
1   82  133
early stop counter: 5
val acc:0.8392857313156128, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8883720636367798
after epoch: 16,now: 2024-07-26 04:56:08.114508,epoch time: 0:01:01.988364,used: 0:16:40.608530,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9798177, 'precision': 0.980261, 'recall': 0.98007214, 'specificity': 0.98007214, 'f1': 0.97981715, 'auroc': 0.99943316, 'binary_precision': 0.99866575, 'binary_recall': 0.96146435, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.97971207}
confusion matrix:
      0     1
0  1513     2
1    60  1497
---- Validation: 
scalar performance:
{'acc': 0.55590063, 'precision': 0.7324201, 'recall': 0.5497148, 'specificity': 0.5497148, 'f1': 0.44294026, 'auroc': 0.8670907, 'binary_precision': 0.9315069, 'binary_recall': 0.107086614, 'binary_specificity': 0.992343, 'binary_f1_score': 0.19209039}
confusion matrix:
     0   1
0  648   5
1  567  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62093025, 'precision': 0.7843915, 'recall': 0.62093025, 'specificity': 0.62093025, 'f1': 0.55731976, 'auroc': 0.91971874, 'binary_precision': 1.0, 'binary_recall': 0.24186046, 'binary_specificity': 1.0, 'binary_f1_score': 0.3895131}
confusion matrix:
     0   1
0  215   0
1  163  52
early stop counter: 6
val acc:0.5559006333351135, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8883720636367798
after epoch: 17,now: 2024-07-26 04:57:10.049336,epoch time: 0:01:01.934828,used: 0:17:42.543358,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.987381, 'recall': 0.98745596, 'specificity': 0.98745596, 'f1': 0.98730457, 'auroc': 0.99951416, 'binary_precision': 0.9980328, 'binary_recall': 0.9768934, 'binary_specificity': 0.9980185, 'binary_f1_score': 0.98735}
confusion matrix:
      0     1
0  1511     3
1    36  1522
---- Validation: 
scalar performance:
{'acc': 0.6568323, 'precision': 0.7716033, 'recall': 0.65222895, 'specificity': 0.65222895, 'f1': 0.6124201, 'auroc': 0.9070517, 'binary_precision': 0.9447005, 'binary_recall': 0.32283464, 'binary_specificity': 0.9816233, 'binary_f1_score': 0.48122066}
confusion matrix:
     0    1
0  641   12
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.8444692, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.7709085, 'auroc': 0.91104376, 'binary_precision': 0.9918699, 'binary_recall': 0.5674419, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.7218935}
confusion matrix:
     0    1
0  214    1
1   93  122
early stop counter: 7
val acc:0.6568322777748108, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8883720636367798
after epoch: 18,now: 2024-07-26 04:58:12.047450,epoch time: 0:01:01.998114,used: 0:18:44.541472,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96744794, 'precision': 0.9696348, 'recall': 0.9670354, 'specificity': 0.9670354, 'f1': 0.967384, 'auroc': 0.9994514, 'binary_precision': 0.94067794, 'binary_recall': 0.9987146, 'binary_specificity': 0.9353562, 'binary_f1_score': 0.9688279}
confusion matrix:
      0     1
0  1418    98
1     2  1554
---- Validation: 
scalar performance:
{'acc': 0.8486025, 'precision': 0.84867954, 'recall': 0.8484752, 'specificity': 0.8484752, 'f1': 0.8485359, 'auroc': 0.9032304, 'binary_precision': 0.8514377, 'binary_recall': 0.8393701, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.8453608}
confusion matrix:
     0    1
0  560   93
1  102  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89302325, 'precision': 0.89469683, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.89290977, 'auroc': 0.9471282, 'binary_precision': 0.920398, 'binary_recall': 0.8604651, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.88942313}
confusion matrix:
     0    1
0  199   16
1   30  185
new oracle model saved
early stop counter: 8
val acc:0.8486024737358093, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 19,now: 2024-07-26 04:59:14.345352,epoch time: 0:01:02.297902,used: 0:19:46.839374,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.98618245, 'recall': 0.98617405, 'specificity': 0.98617405, 'f1': 0.98600256, 'auroc': 0.9995786, 'binary_precision': 0.99933994, 'binary_recall': 0.97300774, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98599803}
confusion matrix:
      0     1
0  1515     1
1    42  1514
---- Validation: 
scalar performance:
{'acc': 0.63975155, 'precision': 0.7646533, 'recall': 0.6348844, 'specificity': 0.6348844, 'f1': 0.58708364, 'auroc': 0.8687149, 'binary_precision': 0.9430052, 'binary_recall': 0.28661418, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.43961352}
confusion matrix:
     0    1
0  642   11
1  453  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68372095, 'precision': 0.8062678, 'recall': 0.68372095, 'specificity': 0.68372095, 'f1': 0.6485661, 'auroc': 0.90433747, 'binary_precision': 1.0, 'binary_recall': 0.36744186, 'binary_specificity': 1.0, 'binary_f1_score': 0.53741497}
confusion matrix:
     0   1
0  215   0
1  136  79
early stop counter: 9
val acc:0.6397515535354614, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 20,now: 2024-07-26 05:00:16.358244,epoch time: 0:01:02.012892,used: 0:20:48.852266,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895587, 'recall': 0.9896185, 'specificity': 0.9896185, 'f1': 0.9895818, 'auroc': 0.9995964, 'binary_precision': 0.9922581, 'binary_recall': 0.987163, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.98970395}
confusion matrix:
      0     1
0  1502    12
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.7507764, 'precision': 0.7838854, 'recall': 0.74835104, 'specificity': 0.74835104, 'f1': 0.7420424, 'auroc': 0.87976205, 'binary_precision': 0.87740386, 'binary_recall': 0.5748032, 'binary_specificity': 0.9218989, 'binary_f1_score': 0.69457656}
confusion matrix:
     0    1
0  602   51
1  270  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8658148, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.85995305, 'auroc': 0.93092483, 'binary_precision': 0.9100529, 'binary_recall': 0.8, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.8514851}
confusion matrix:
     0    1
0  198   17
1   43  172
early stop counter: 10
val acc:0.7507764101028442, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 21,now: 2024-07-26 05:01:18.174747,epoch time: 0:01:01.816503,used: 0:21:50.668769,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9775592, 'recall': 0.97667634, 'specificity': 0.97667634, 'f1': 0.9768686, 'auroc': 0.9986375, 'binary_precision': 0.9626168, 'binary_recall': 0.9929306, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.97753876}
confusion matrix:
      0     1
0  1456    60
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.80667704, 'precision': 0.8120471, 'recall': 0.8057385, 'specificity': 0.8057385, 'f1': 0.8054809, 'auroc': 0.8912059, 'binary_precision': 0.8496377, 'binary_recall': 0.7385827, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.7902274}
confusion matrix:
     0    1
0  570   83
1  166  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.82037896, 'recall': 0.8186047, 'specificity': 0.8186047, 'f1': 0.8183532, 'auroc': 0.89144397, 'binary_precision': 0.8442211, 'binary_recall': 0.7813954, 'binary_specificity': 0.855814, 'binary_f1_score': 0.8115942}
confusion matrix:
     0    1
0  184   31
1   47  168
early stop counter: 11
val acc:0.8066770434379578, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 22,now: 2024-07-26 05:02:19.887473,epoch time: 0:01:01.712726,used: 0:22:52.381495,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9832314, 'recall': 0.9832478, 'specificity': 0.9832478, 'f1': 0.98307294, 'auroc': 0.99946666, 'binary_precision': 0.9960448, 'binary_recall': 0.970456, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9830839}
confusion matrix:
      0     1
0  1509     6
1    46  1511
---- Validation: 
scalar performance:
{'acc': 0.65217394, 'precision': 0.775371, 'recall': 0.6474394, 'specificity': 0.6474394, 'f1': 0.6043011, 'auroc': 0.91872823, 'binary_precision': 0.95609754, 'binary_recall': 0.30866143, 'binary_specificity': 0.98621744, 'binary_f1_score': 0.4666667}
confusion matrix:
     0    1
0  644    9
1  439  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.8101397, 'recall': 0.7069767, 'specificity': 0.7069767, 'f1': 0.68039924, 'auroc': 0.92971337, 'binary_precision': 0.989011, 'binary_recall': 0.41860464, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.58823526}
confusion matrix:
     0   1
0  214   1
1  125  90
early stop counter: 12
val acc:0.6521739363670349, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 23,now: 2024-07-26 05:03:21.761436,epoch time: 0:01:01.873963,used: 0:23:54.255458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9823407, 'recall': 0.98231184, 'specificity': 0.98231184, 'f1': 0.9820963, 'auroc': 0.9996083, 'binary_precision': 0.9973527, 'binary_recall': 0.9672657, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.98207885}
confusion matrix:
      0     1
0  1510     4
1    51  1507
---- Validation: 
scalar performance:
{'acc': 0.66770184, 'precision': 0.7790987, 'recall': 0.6632309, 'specificity': 0.6632309, 'f1': 0.6273148, 'auroc': 0.8909298, 'binary_precision': 0.9519651, 'binary_recall': 0.34330708, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.5046296}
confusion matrix:
     0    1
0  642   11
1  417  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.83091867, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.73817235, 'auroc': 0.9380638, 'binary_precision': 0.990991, 'binary_recall': 0.5116279, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6748466}
confusion matrix:
     0    1
0  214    1
1  105  110
early stop counter: 13
val acc:0.6677018404006958, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 24,now: 2024-07-26 05:04:23.921978,epoch time: 0:01:02.160542,used: 0:24:56.416000,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9980469, 'precision': 0.9980558, 'recall': 0.99803805, 'specificity': 0.99803805, 'f1': 0.9980465, 'auroc': 0.99998426, 'binary_precision': 0.9974326, 'binary_recall': 0.9987146, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9980732}
confusion matrix:
      0     1
0  1512     4
1     2  1554
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.8438667, 'recall': 0.8188265, 'specificity': 0.8188265, 'f1': 0.8169571, 'auroc': 0.9259819, 'binary_precision': 0.9297872, 'binary_recall': 0.68818897, 'binary_specificity': 0.949464, 'binary_f1_score': 0.79095024}
confusion matrix:
     0    1
0  620   33
1  198  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511628, 'precision': 0.8808211, 'recall': 0.8511628, 'specificity': 0.8511628, 'f1': 0.84820735, 'auroc': 0.9426717, 'binary_precision': 0.9870968, 'binary_recall': 0.7116279, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.827027}
confusion matrix:
     0    1
0  213    2
1   62  153
early stop counter: 14
val acc:0.820652186870575, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 25,now: 2024-07-26 05:05:26.698162,epoch time: 0:01:02.776184,used: 0:25:59.192184,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.9951079, 'recall': 0.99512744, 'specificity': 0.99512744, 'f1': 0.9951167, 'auroc': 0.9998906, 'binary_precision': 0.99612904, 'binary_recall': 0.99420476, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.99516594}
confusion matrix:
      0     1
0  1513     6
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.7663044, 'precision': 0.81954217, 'recall': 0.76342624, 'specificity': 0.76342624, 'f1': 0.754799, 'auroc': 0.90551007, 'binary_precision': 0.9465241, 'binary_recall': 0.55748034, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.7016848}
confusion matrix:
     0    1
0  633   20
1  281  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74883723, 'precision': 0.8287462, 'recall': 0.74883723, 'specificity': 0.74883723, 'f1': 0.7325871, 'auroc': 0.92147106, 'binary_precision': 0.9908257, 'binary_recall': 0.5023256, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  214    1
1  107  108
early stop counter: 15
val acc:0.7663043737411499, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 26,now: 2024-07-26 05:06:28.395527,epoch time: 0:01:01.697365,used: 0:27:00.889549,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98926026, 'recall': 0.98925173, 'specificity': 0.98925173, 'f1': 0.9892559, 'auroc': 0.99967355, 'binary_precision': 0.98908156, 'binary_recall': 0.98971725, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.9893993}
confusion matrix:
      0     1
0  1499    17
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.8416149, 'precision': 0.8452591, 'recall': 0.84088945, 'specificity': 0.84088945, 'f1': 0.84097034, 'auroc': 0.9107523, 'binary_precision': 0.877408, 'binary_recall': 0.7889764, 'binary_specificity': 0.8928025, 'binary_f1_score': 0.8308457}
confusion matrix:
     0    1
0  583   70
1  134  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.80930233, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8093024, 'auroc': 0.898583, 'binary_precision': 0.80930233, 'binary_recall': 0.80930233, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8093024}
confusion matrix:
     0    1
0  174   41
1   41  174
early stop counter: 16
val acc:0.8416149020195007, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 27,now: 2024-07-26 05:07:30.348457,epoch time: 0:01:01.952930,used: 0:28:02.842479,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941223, 'recall': 0.99416506, 'specificity': 0.99416506, 'f1': 0.9941399, 'auroc': 0.9998732, 'binary_precision': 0.99612904, 'binary_recall': 0.99228793, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9942048}
confusion matrix:
      0     1
0  1510     6
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.80590063, 'precision': 0.8331311, 'recall': 0.80388755, 'specificity': 0.80388755, 'f1': 0.8011049, 'auroc': 0.9115505, 'binary_precision': 0.9249448, 'binary_recall': 0.6598425, 'binary_specificity': 0.9479326, 'binary_f1_score': 0.7702205}
confusion matrix:
     0    1
0  619   34
1  216  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.88626313, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.860674, 'auroc': 0.9327637, 'binary_precision': 0.9814815, 'binary_recall': 0.73953485, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8435013}
confusion matrix:
     0    1
0  212    3
1   56  159
early stop counter: 17
val acc:0.8059006333351135, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 28,now: 2024-07-26 05:08:32.431232,epoch time: 0:01:02.082775,used: 0:29:04.925254,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99512064, 'recall': 0.9951124, 'specificity': 0.9951124, 'f1': 0.9951165, 'auroc': 0.9998105, 'binary_precision': 0.9948586, 'binary_recall': 0.9954984, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9951784}
confusion matrix:
      0     1
0  1509     8
1     7  1548
---- Validation: 
scalar performance:
{'acc': 0.79347825, 'precision': 0.82549214, 'recall': 0.79126745, 'specificity': 0.79126745, 'f1': 0.7873875, 'auroc': 0.9070697, 'binary_precision': 0.92413795, 'binary_recall': 0.6330709, 'binary_specificity': 0.949464, 'binary_f1_score': 0.7514019}
confusion matrix:
     0    1
0  620   33
1  233  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8697674, 'precision': 0.88443804, 'recall': 0.8697674, 'specificity': 0.8697674, 'f1': 0.868513, 'auroc': 0.9205625, 'binary_precision': 0.95953757, 'binary_recall': 0.772093, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8556701}
confusion matrix:
     0    1
0  208    7
1   49  166
early stop counter: 18
val acc:0.79347825050354, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 29,now: 2024-07-26 05:09:35.056201,epoch time: 0:01:02.624969,used: 0:30:07.550223,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9935069, 'recall': 0.9934734, 'specificity': 0.9934734, 'f1': 0.99348843, 'auroc': 0.9997902, 'binary_precision': 0.9922978, 'binary_recall': 0.994852, 'binary_specificity': 0.9920949, 'binary_f1_score': 0.99357325}
confusion matrix:
      0     1
0  1506    12
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.82686335, 'precision': 0.84290326, 'recall': 0.8253428, 'specificity': 0.8253428, 'f1': 0.8243191, 'auroc': 0.9206376, 'binary_precision': 0.9136546, 'binary_recall': 0.71653545, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.8031774}
confusion matrix:
     0    1
0  610   43
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8277439, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.8199946, 'auroc': 0.89395344, 'binary_precision': 0.875, 'binary_recall': 0.74883723, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.8070175}
confusion matrix:
     0    1
0  192   23
1   54  161
early stop counter: 19
val acc:0.8268633484840393, best validation acc: 0.8672360181808472, corresponding to test acc:                         0.8744186162948608 / 0.8930232524871826
after epoch: 30,now: 2024-07-26 05:10:36.895213,epoch time: 0:01:01.839012,used: 0:31:09.389235,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_27_seed_0_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:09.389235 at 2024-07-26 05:10:36.895213
persisted model performance metric: 

scalar performance:
{'acc': 0.8744186, 'precision': 0.8852189, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8735322, 'auroc': 0.93646294, 'binary_precision': 0.9497207, 'binary_recall': 0.7906977, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8629441}
confusion matrix:
     0    1
0  206    9
1   45  170
oracle model performance metric: 

scalar performance:
{'acc': 0.89302325, 'precision': 0.89469683, 'recall': 0.89302325, 'specificity': 0.89302325, 'f1': 0.89290977, 'auroc': 0.9471282, 'binary_precision': 0.920398, 'binary_recall': 0.8604651, 'binary_specificity': 0.9255814, 'binary_f1_score': 0.88942313}
confusion matrix:
     0    1
0  199   16
1   30  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  73963 GiB |  73963 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73096 GiB |  73096 GiB |
|       from small pool |  40592 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  73963 GiB |  73963 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  73096 GiB |  73096 GiB |
|       from small pool |  40592 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73486 GiB |  73486 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72621 GiB |  72621 GiB |
|       from small pool |  40405 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445666 KiB |   1252 MiB |  52646 GiB |  52646 GiB |
|       from large pool | 435058 KiB |   1243 MiB |  51776 GiB |  51775 GiB |
|       from small pool |  10607 KiB |     17 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12909 K  |   12908 K  |
|       from large pool |     187    |    1413    |    6569 K  |    6569 K  |
|       from small pool |    1111    |    1407    |    6340 K  |    6339 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12909 K  |   12908 K  |
|       from large pool |     187    |    1413    |    6569 K  |    6569 K  |
|       from small pool |    1111    |    1407    |    6340 K  |    6339 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      93    |     646    |    8513 K  |    8513 K  |
|       from large pool |      37    |     600    |    4908 K  |    4908 K  |
|       from small pool |      56    |     236    |    3604 K  |    3604 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73963 GiB |  73963 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73096 GiB |  73096 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73963 GiB |  73963 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73096 GiB |  73096 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73486 GiB |  73486 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72621 GiB |  72621 GiB |
|       from small pool |      0 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  14480 MiB |  13600 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  52646 GiB |  52646 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  51776 GiB |  51776 GiB |
|       from small pool |      0 KiB |     41 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6340 K  |    6340 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6340 K  |    6340 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     646    |    8513 K  |    8513 K  |
|       from large pool |       4    |     600    |    4908 K  |    4908 K  |
|       from small pool |       0    |     236    |    3605 K  |    3605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73963 GiB |  73963 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73096 GiB |  73096 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73963 GiB |  73963 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  73096 GiB |  73096 GiB |
|       from small pool |      0 KiB |     56 MiB |    866 GiB |    866 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73486 GiB |  73486 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72621 GiB |  72621 GiB |
|       from small pool |      0 KiB |     56 MiB |    864 GiB |    864 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  14480 MiB |  13600 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  52646 GiB |  52646 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  51776 GiB |  51776 GiB |
|       from small pool |      0 KiB |     41 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6340 K  |    6340 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12909 K  |   12909 K  |
|       from large pool |       2    |    1413    |    6569 K  |    6569 K  |
|       from small pool |       0    |    1407    |    6340 K  |    6340 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     646    |    8513 K  |    8513 K  |
|       from large pool |       4    |     600    |    4908 K  |    4908 K  |
|       from small pool |       0    |     236    |    3605 K  |    3605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536

 Experiment start at: 2024-07-26 05:11:03.246581
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.95180297, 'recall': 0.9518397, 'specificity': 0.9518397, 'f1': 0.95181763, 'auroc': 0.9911524, 'binary_precision': 0.95416397, 'binary_recall': 0.9504823, 'binary_specificity': 0.9531971, 'binary_f1_score': 0.95231956}
confusion matrix:
      0     1
0  1446    71
1    77  1478
---- Validation: 
scalar performance:
{'acc': 0.83372366, 'precision': 0.83609015, 'recall': 0.83440864, 'specificity': 0.83440864, 'f1': 0.83359224, 'auroc': 0.90069735, 'binary_precision': 0.80349344, 'binary_recall': 0.8761905, 'binary_specificity': 0.79262674, 'binary_f1_score': 0.83826876}
confusion matrix:
     0    1
0  516  135
1   78  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.82889396, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8187748, 'auroc': 0.92740744, 'binary_precision': 0.7748092, 'binary_recall': 0.9022222, 'binary_specificity': 0.73777777, 'binary_f1_score': 0.83367556}
confusion matrix:
     0    1
0  166   59
1   22  203
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:12:08.973649,epoch time: 0:01:05.727068,used: 0:01:05.727068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96451825, 'precision': 0.9645182, 'recall': 0.96458936, 'specificity': 0.96458936, 'f1': 0.9645169, 'auroc': 0.99426943, 'binary_precision': 0.9707031, 'binary_recall': 0.95884246, 'binary_specificity': 0.9703362, 'binary_f1_score': 0.96473634}
confusion matrix:
      0     1
0  1472    45
1    64  1491
---- Validation: 
scalar performance:
{'acc': 0.8657299, 'precision': 0.8672148, 'recall': 0.8652074, 'specificity': 0.8652074, 'f1': 0.8654444, 'auroc': 0.91524637, 'binary_precision': 0.8868243, 'binary_recall': 0.8333333, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.8592471}
confusion matrix:
     0    1
0  584   67
1  105  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.85113615, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84864676, 'auroc': 0.9332938, 'binary_precision': 0.82304525, 'binary_recall': 0.8888889, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8547009}
confusion matrix:
     0    1
0  182   43
1   25  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 05:13:12.059501,epoch time: 0:01:03.085852,used: 0:02:08.812920,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97622085, 'recall': 0.97629654, 'specificity': 0.97629654, 'f1': 0.97623545, 'auroc': 0.99756277, 'binary_precision': 0.981181, 'binary_recall': 0.97172236, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9764288}
confusion matrix:
      0     1
0  1487    29
1    44  1512
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.811641, 'recall': 0.80617, 'specificity': 0.80617, 'f1': 0.80609286, 'auroc': 0.8846878, 'binary_precision': 0.84504503, 'binary_recall': 0.74444443, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.7915611}
confusion matrix:
     0    1
0  565   86
1  161  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8379447, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8377577, 'auroc': 0.91049874, 'binary_precision': 0.8454546, 'binary_recall': 0.82666665, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.835955}
confusion matrix:
     0    1
0  191   34
1   39  186
early stop counter: 1
val acc:0.8071818947792053, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 3,now: 2024-07-26 05:14:15.278562,epoch time: 0:01:03.219061,used: 0:03:12.031981,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848248, 'recall': 0.9848319, 'specificity': 0.9848319, 'f1': 0.98470056, 'auroc': 0.99831533, 'binary_precision': 0.99605006, 'binary_recall': 0.9736165, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9847055}
confusion matrix:
      0     1
0  1512     6
1    41  1513
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.82713145, 'recall': 0.81505376, 'specificity': 0.81505376, 'f1': 0.81452, 'auroc': 0.8852217, 'binary_precision': 0.8820116, 'binary_recall': 0.72380954, 'binary_specificity': 0.906298, 'binary_f1_score': 0.79511774}
confusion matrix:
     0    1
0  590   61
1  174  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.85931015, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8551772, 'auroc': 0.920316, 'binary_precision': 0.8960396, 'binary_recall': 0.80444443, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.84777516}
confusion matrix:
     0    1
0  204   21
1   44  181
new oracle model saved
early stop counter: 2
val acc:0.8165495991706848, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.855555534362793
after epoch: 4,now: 2024-07-26 05:15:18.466928,epoch time: 0:01:03.188366,used: 0:04:15.220347,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.9814764, 'recall': 0.9814178, 'specificity': 0.9814178, 'f1': 0.981442, 'auroc': 0.9977276, 'binary_precision': 0.9794872, 'binary_recall': 0.9839021, 'binary_specificity': 0.9789335, 'binary_f1_score': 0.9816897}
confusion matrix:
      0     1
0  1487    32
1    25  1528
---- Validation: 
scalar performance:
{'acc': 0.8594848, 'precision': 0.86657083, 'recall': 0.8583461, 'specificity': 0.8583461, 'f1': 0.8584975, 'auroc': 0.9157096, 'binary_precision': 0.91360295, 'binary_recall': 0.7888889, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.846678}
confusion matrix:
     0    1
0  604   47
1  133  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.866966, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.85933244, 'auroc': 0.9246024, 'binary_precision': 0.91752577, 'binary_recall': 0.7911111, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.849642}
confusion matrix:
     0    1
0  209   16
1   47  178
new oracle model saved
early stop counter: 3
val acc:0.8594847917556763, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 5,now: 2024-07-26 05:16:22.164529,epoch time: 0:01:03.697601,used: 0:05:18.917948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9737891, 'recall': 0.9723574, 'specificity': 0.9723574, 'f1': 0.9726224, 'auroc': 0.99905676, 'binary_precision': 0.9537893, 'binary_recall': 0.99421966, 'binary_specificity': 0.95049506, 'binary_f1_score': 0.9735849}
confusion matrix:
      0     1
0  1440    75
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.832943, 'precision': 0.8403476, 'recall': 0.8317204, 'specificity': 0.8317204, 'f1': 0.83163285, 'auroc': 0.8923731, 'binary_precision': 0.8866171, 'binary_recall': 0.75714284, 'binary_specificity': 0.906298, 'binary_f1_score': 0.81678087}
confusion matrix:
     0    1
0  590   61
1  153  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84391296, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8395436, 'auroc': 0.907279, 'binary_precision': 0.880597, 'binary_recall': 0.7866667, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8309859}
confusion matrix:
     0    1
0  201   24
1   48  177
early stop counter: 4
val acc:0.8329430222511292, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 6,now: 2024-07-26 05:17:25.211984,epoch time: 0:01:03.047455,used: 0:06:21.965403,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856771, 'recall': 0.98575944, 'specificity': 0.98575944, 'f1': 0.98567647, 'auroc': 0.9990194, 'binary_precision': 0.9921875, 'binary_recall': 0.97943443, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9857697}
confusion matrix:
      0     1
0  1504    12
1    32  1524
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.82822645, 'recall': 0.80017924, 'specificity': 0.80017924, 'f1': 0.79766405, 'auroc': 0.9124278, 'binary_precision': 0.9161148, 'binary_recall': 0.65873015, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.76638967}
confusion matrix:
     0    1
0  613   38
1  215  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8511358, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8159193, 'auroc': 0.916721, 'binary_precision': 0.9556962, 'binary_recall': 0.6711111, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.78851175}
confusion matrix:
     0    1
0  218    7
1   74  151
early stop counter: 5
val acc:0.8024980425834656, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 7,now: 2024-07-26 05:18:28.252185,epoch time: 0:01:03.040201,used: 0:07:25.005604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9869691, 'recall': 0.9869857, 'specificity': 0.9869857, 'f1': 0.986977, 'auroc': 0.99905753, 'binary_precision': 0.98778135, 'binary_recall': 0.98651254, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.9871465}
confusion matrix:
      0     1
0  1496    19
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.85691464, 'recall': 0.85327697, 'specificity': 0.85327697, 'f1': 0.85350466, 'auroc': 0.9116329, 'binary_precision': 0.88521737, 'binary_recall': 0.8079365, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.8448132}
confusion matrix:
     0    1
0  585   66
1  121  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.8070015, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.79624736, 'auroc': 0.9035456, 'binary_precision': 0.86021507, 'binary_recall': 0.7111111, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.77858883}
confusion matrix:
     0    1
0  199   26
1   65  160
early stop counter: 6
val acc:0.8540202975273132, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 8,now: 2024-07-26 05:19:31.420611,epoch time: 0:01:03.168426,used: 0:08:28.174030,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9800885, 'recall': 0.97971666, 'specificity': 0.97971666, 'f1': 0.9794904, 'auroc': 0.9993477, 'binary_precision': 1.0, 'binary_recall': 0.9594334, 'binary_specificity': 1.0, 'binary_f1_score': 0.9792968}
confusion matrix:
      0     1
0  1519     0
1    63  1490
---- Validation: 
scalar performance:
{'acc': 0.6939891, 'precision': 0.7939144, 'recall': 0.6891449, 'specificity': 0.6891449, 'f1': 0.6621945, 'auroc': 0.9124473, 'binary_precision': 0.9612403, 'binary_recall': 0.3936508, 'binary_specificity': 0.984639, 'binary_f1_score': 0.5585586}
confusion matrix:
     0    1
0  641   10
1  382  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70444447, 'precision': 0.8142458, 'recall': 0.7044444, 'specificity': 0.7044444, 'f1': 0.6761557, 'auroc': 0.9097284, 'binary_precision': 1.0, 'binary_recall': 0.40888888, 'binary_specificity': 1.0, 'binary_f1_score': 0.58044165}
confusion matrix:
     0   1
0  225   0
1  133  92
early stop counter: 7
val acc:0.693989098072052, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 9,now: 2024-07-26 05:20:34.570689,epoch time: 0:01:03.150078,used: 0:09:31.324108,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9870578, 'recall': 0.987142, 'specificity': 0.987142, 'f1': 0.986979, 'auroc': 0.9995896, 'binary_precision': 0.9980328, 'binary_recall': 0.97626686, 'binary_specificity': 0.9980172, 'binary_f1_score': 0.98702985}
confusion matrix:
      0     1
0  1510     3
1    37  1522
---- Validation: 
scalar performance:
{'acc': 0.7759563, 'precision': 0.8164238, 'recall': 0.7729902, 'specificity': 0.7729902, 'f1': 0.76723206, 'auroc': 0.9096707, 'binary_precision': 0.9255583, 'binary_recall': 0.5920635, 'binary_specificity': 0.953917, 'binary_f1_score': 0.7221685}
confusion matrix:
     0    1
0  621   30
1  257  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.83124506, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.8004073, 'auroc': 0.91595066, 'binary_precision': 0.9254658, 'binary_recall': 0.6622222, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.77202076}
confusion matrix:
     0    1
0  213   12
1   76  149
early stop counter: 8
val acc:0.7759562730789185, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 10,now: 2024-07-26 05:21:38.356590,epoch time: 0:01:03.785901,used: 0:10:35.110009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.9746243, 'recall': 0.9741396, 'specificity': 0.9741396, 'f1': 0.97426933, 'auroc': 0.99742126, 'binary_precision': 0.9647577, 'binary_recall': 0.9852185, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.97488075}
confusion matrix:
      0     1
0  1460    56
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8113822, 'recall': 0.7969022, 'specificity': 0.7969022, 'f1': 0.79583263, 'auroc': 0.8823123, 'binary_precision': 0.8705179, 'binary_recall': 0.6936508, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.7720848}
confusion matrix:
     0    1
0  586   65
1  193  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7824231, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7821835, 'auroc': 0.8362864, 'binary_precision': 0.7748918, 'binary_recall': 0.79555553, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.7850877}
confusion matrix:
     0    1
0  173   52
1   46  179
early stop counter: 9
val acc:0.7985948324203491, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 11,now: 2024-07-26 05:22:41.596347,epoch time: 0:01:03.239757,used: 0:11:38.349766,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863869, 'recall': 0.9864331, 'specificity': 0.9864331, 'f1': 0.986328, 'auroc': 0.99946415, 'binary_precision': 0.9954128, 'binary_recall': 0.9774775, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9863636}
confusion matrix:
      0     1
0  1511     7
1    35  1519
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.77896386, 'recall': 0.70384026, 'specificity': 0.70384026, 'f1': 0.6854919, 'auroc': 0.9055251, 'binary_precision': 0.91558444, 'binary_recall': 0.44761905, 'binary_specificity': 0.96006143, 'binary_f1_score': 0.6012793}
confusion matrix:
     0    1
0  625   26
1  348  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.7720641, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.68180096, 'auroc': 0.8978963, 'binary_precision': 0.9099099, 'binary_recall': 0.4488889, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.6011905}
confusion matrix:
     0    1
0  215   10
1  124  101
early stop counter: 10
val acc:0.7080405950546265, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 12,now: 2024-07-26 05:23:44.674844,epoch time: 0:01:03.078497,used: 0:12:41.428263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98765767, 'recall': 0.9877436, 'specificity': 0.9877436, 'f1': 0.9876299, 'auroc': 0.9993874, 'binary_precision': 0.996081, 'binary_recall': 0.97944766, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.98769426}
confusion matrix:
      0     1
0  1509     6
1    32  1525
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.83351815, 'recall': 0.78379416, 'specificity': 0.78379416, 'f1': 0.77787495, 'auroc': 0.92544067, 'binary_precision': 0.9541985, 'binary_recall': 0.5952381, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.73313785}
confusion matrix:
     0    1
0  633   18
1  255  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73777777, 'precision': 0.81989956, 'recall': 0.73777777, 'specificity': 0.73777777, 'f1': 0.71979487, 'auroc': 0.94234073, 'binary_precision': 0.981982, 'binary_recall': 0.48444444, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.64880955}
confusion matrix:
     0    1
0  223    2
1  116  109
early stop counter: 11
val acc:0.7868852615356445, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 13,now: 2024-07-26 05:24:47.770644,epoch time: 0:01:03.095800,used: 0:13:44.524063,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.992816, 'recall': 0.99287283, 'specificity': 0.99287283, 'f1': 0.99283767, 'auroc': 0.9997715, 'binary_precision': 0.99548095, 'binary_recall': 0.9903661, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99291694}
confusion matrix:
      0     1
0  1508     7
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.86458254, 'recall': 0.8493087, 'specificity': 0.8493087, 'f1': 0.8490428, 'auroc': 0.92829525, 'binary_precision': 0.9312377, 'binary_recall': 0.75238097, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.832309}
confusion matrix:
     0    1
0  616   35
1  156  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.83965576, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.8249935, 'auroc': 0.89769876, 'binary_precision': 0.9060773, 'binary_recall': 0.72888887, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8078818}
confusion matrix:
     0    1
0  208   17
1   61  164
early stop counter: 12
val acc:0.8508977293968201, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 14,now: 2024-07-26 05:25:50.815511,epoch time: 0:01:03.044867,used: 0:14:47.568930,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98531294, 'recall': 0.9851804, 'specificity': 0.9851804, 'f1': 0.98502576, 'auroc': 0.9996257, 'binary_precision': 1.0, 'binary_recall': 0.9703608, 'binary_specificity': 1.0, 'binary_f1_score': 0.9849575}
confusion matrix:
      0     1
0  1520     0
1    46  1506
---- Validation: 
scalar performance:
{'acc': 0.56128025, 'precision': 0.7481639, 'recall': 0.5540451, 'specificity': 0.5540451, 'f1': 0.44961444, 'auroc': 0.8793791, 'binary_precision': 0.9594595, 'binary_recall': 0.11269841, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.20170455}
confusion matrix:
     0   1
0  648   3
1  559  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.69375455, 'recall': 0.5844444, 'specificity': 0.5844444, 'f1': 0.5162097, 'auroc': 0.8588592, 'binary_precision': 0.83928573, 'binary_recall': 0.20888889, 'binary_specificity': 0.96, 'binary_f1_score': 0.33451957}
confusion matrix:
     0   1
0  216   9
1  178  47
early stop counter: 13
val acc:0.5612802505493164, best validation acc: 0.8657299280166626, corresponding to test acc:                         0.8488888740539551 / 0.8600000143051147
after epoch: 15,now: 2024-07-26 05:26:54.615153,epoch time: 0:01:03.799642,used: 0:15:51.368572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9869623, 'recall': 0.9865335, 'specificity': 0.9865335, 'f1': 0.98664725, 'auroc': 0.9997189, 'binary_precision': 0.97728705, 'binary_recall': 0.9967825, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.9869385}
confusion matrix:
      0     1
0  1482    36
1     5  1549
---- Validation: 
scalar performance:
{'acc': 0.88212335, 'precision': 0.88601875, 'recall': 0.8813108, 'specificity': 0.8813108, 'f1': 0.88163835, 'auroc': 0.92625755, 'binary_precision': 0.9209139, 'binary_recall': 0.83174604, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.8740617}
confusion matrix:
     0    1
0  606   45
1  106  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8671307, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.849469, 'auroc': 0.9275259, 'binary_precision': 0.94382024, 'binary_recall': 0.74666667, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8337469}
confusion matrix:
     0    1
0  215   10
1   57  168
better model found
persisted
after epoch: 16,now: 2024-07-26 05:27:57.696808,epoch time: 0:01:03.081655,used: 0:16:54.450227,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97975963, 'recall': 0.97942126, 'specificity': 0.97942126, 'f1': 0.9791652, 'auroc': 0.9995091, 'binary_precision': 1.0, 'binary_recall': 0.95884246, 'binary_specificity': 1.0, 'binary_f1_score': 0.9789888}
confusion matrix:
      0     1
0  1517     0
1    64  1491
---- Validation: 
scalar performance:
{'acc': 0.5932865, 'precision': 0.76082695, 'recall': 0.5866103, 'specificity': 0.5866103, 'f1': 0.50774556, 'auroc': 0.8781295, 'binary_precision': 0.96581197, 'binary_recall': 0.17936508, 'binary_specificity': 0.9938556, 'binary_f1_score': 0.30254352}
confusion matrix:
     0    1
0  647    4
1  517  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.74431527, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.48696065, 'auroc': 0.91527903, 'binary_precision': 0.94736844, 'binary_recall': 0.16, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.27376425}
confusion matrix:
     0   1
0  223   2
1  189  36
early stop counter: 1
val acc:0.5932865142822266, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8600000143051147
after epoch: 17,now: 2024-07-26 05:29:00.696146,epoch time: 0:01:02.999338,used: 0:17:57.449565,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934706, 'recall': 0.9935208, 'specificity': 0.9935208, 'f1': 0.99348897, 'auroc': 0.9997495, 'binary_precision': 0.9961215, 'binary_recall': 0.9909968, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.99355257}
confusion matrix:
      0     1
0  1511     6
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.8696331, 'precision': 0.8818177, 'recall': 0.8681772, 'specificity': 0.8681772, 'f1': 0.8682339, 'auroc': 0.92851233, 'binary_precision': 0.9460501, 'binary_recall': 0.77936506, 'binary_specificity': 0.9569892, 'binary_f1_score': 0.85465616}
confusion matrix:
     0    1
0  623   28
1  139  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88666666, 'precision': 0.89994687, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.885718, 'auroc': 0.9402864, 'binary_precision': 0.97282606, 'binary_recall': 0.79555553, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8753056}
confusion matrix:
     0    1
0  220    5
1   46  179
new oracle model saved
early stop counter: 2
val acc:0.8696330785751343, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 18,now: 2024-07-26 05:30:03.603413,epoch time: 0:01:02.907267,used: 0:19:00.356832,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98498404, 'recall': 0.9848777, 'specificity': 0.9848777, 'f1': 0.9847003, 'auroc': 0.9997969, 'binary_precision': 1.0, 'binary_recall': 0.9697555, 'binary_specificity': 1.0, 'binary_f1_score': 0.98464555}
confusion matrix:
      0     1
0  1518     0
1    47  1507
---- Validation: 
scalar performance:
{'acc': 0.56284153, 'precision': 0.73769253, 'recall': 0.55568355, 'specificity': 0.55568355, 'f1': 0.4544459, 'auroc': 0.9085052, 'binary_precision': 0.9375, 'binary_recall': 0.11904762, 'binary_specificity': 0.9923195, 'binary_f1_score': 0.2112676}
confusion matrix:
     0   1
0  646   5
1  555  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6022222, 'precision': 0.7784654, 'recall': 0.6022222, 'specificity': 0.6022222, 'f1': 0.52745235, 'auroc': 0.9139753, 'binary_precision': 1.0, 'binary_recall': 0.20444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.33948338}
confusion matrix:
     0   1
0  225   0
1  179  46
early stop counter: 3
val acc:0.562841534614563, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 19,now: 2024-07-26 05:31:06.960829,epoch time: 0:01:03.357416,used: 0:20:03.714248,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98767734, 'recall': 0.98774683, 'specificity': 0.98774683, 'f1': 0.98763, 'auroc': 0.99950564, 'binary_precision': 0.99672776, 'binary_recall': 0.9787918, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98767835}
confusion matrix:
      0     1
0  1511     5
1    33  1523
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8514621, 'recall': 0.82206863, 'specificity': 0.82206863, 'f1': 0.8201455, 'auroc': 0.9256016, 'binary_precision': 0.94505495, 'binary_recall': 0.6825397, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.79262674}
confusion matrix:
     0    1
0  626   25
1  200  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8626148, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.81969965, 'auroc': 0.93210864, 'binary_precision': 0.9802632, 'binary_recall': 0.6622222, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.79045093}
confusion matrix:
     0    1
0  222    3
1   76  149
early stop counter: 4
val acc:0.824355959892273, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 20,now: 2024-07-26 05:32:10.698149,epoch time: 0:01:03.737320,used: 0:21:07.451568,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.9734707, 'recall': 0.97266877, 'specificity': 0.97266877, 'f1': 0.97232425, 'auroc': 0.99926996, 'binary_precision': 1.0, 'binary_recall': 0.9453376, 'binary_specificity': 1.0, 'binary_f1_score': 0.9719008}
confusion matrix:
      0     1
0  1517     0
1    85  1470
---- Validation: 
scalar performance:
{'acc': 0.65261513, 'precision': 0.78000915, 'recall': 0.6470046, 'specificity': 0.6470046, 'f1': 0.60321426, 'auroc': 0.9264727, 'binary_precision': 0.96482414, 'binary_recall': 0.30476192, 'binary_specificity': 0.9892473, 'binary_f1_score': 0.4632087}
confusion matrix:
     0    1
0  644    7
1  438  192
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.7888514, 'recall': 0.66888887, 'specificity': 0.66888887, 'f1': 0.6305276, 'auroc': 0.8919902, 'binary_precision': 0.975, 'binary_recall': 0.34666666, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.5114754}
confusion matrix:
     0   1
0  223   2
1  147  78
early stop counter: 5
val acc:0.6526151299476624, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 21,now: 2024-07-26 05:33:13.767294,epoch time: 0:01:03.069145,used: 0:22:10.520713,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931427, 'recall': 0.993201, 'specificity': 0.993201, 'f1': 0.99316335, 'auroc': 0.9998364, 'binary_precision': 0.9961215, 'binary_recall': 0.9903599, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99323237}
confusion matrix:
      0     1
0  1510     6
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.76971114, 'precision': 0.82059985, 'recall': 0.76641065, 'specificity': 0.76641065, 'f1': 0.7586701, 'auroc': 0.9251286, 'binary_precision': 0.9442971, 'binary_recall': 0.5650794, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.7070507}
confusion matrix:
     0    1
0  630   21
1  274  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6911111, 'precision': 0.7937515, 'recall': 0.6911111, 'specificity': 0.6911111, 'f1': 0.6615461, 'auroc': 0.93661726, 'binary_precision': 0.9673913, 'binary_recall': 0.39555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.5615142}
confusion matrix:
     0   1
0  222   3
1  136  89
early stop counter: 6
val acc:0.7697111368179321, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 22,now: 2024-07-26 05:34:16.829952,epoch time: 0:01:03.062658,used: 0:23:13.583371,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.988322, 'recall': 0.9882491, 'specificity': 0.9882491, 'f1': 0.98827887, 'auroc': 0.99959767, 'binary_precision': 0.9859155, 'binary_recall': 0.990991, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.9884467}
confusion matrix:
      0     1
0  1496    22
1    14  1540
---- Validation: 
scalar performance:
{'acc': 0.8579235, 'precision': 0.863163, 'recall': 0.85693806, 'specificity': 0.85693806, 'f1': 0.8571378, 'auroc': 0.9141077, 'binary_precision': 0.9028777, 'binary_recall': 0.7968254, 'binary_specificity': 0.9170507, 'binary_f1_score': 0.846543}
confusion matrix:
     0    1
0  597   54
1  128  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.80227596, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.80221343, 'auroc': 0.8865185, 'binary_precision': 0.8063063, 'binary_recall': 0.79555553, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.80089486}
confusion matrix:
     0    1
0  182   43
1   46  179
early stop counter: 7
val acc:0.8579235076904297, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 23,now: 2024-07-26 05:35:19.894380,epoch time: 0:01:03.064428,used: 0:24:16.647799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874518, 'recall': 0.9874441, 'specificity': 0.9874441, 'f1': 0.9873047, 'auroc': 0.9999267, 'binary_precision': 0.99934083, 'binary_recall': 0.97554696, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9873005}
confusion matrix:
      0     1
0  1517     1
1    38  1516
---- Validation: 
scalar performance:
{'acc': 0.58079624, 'precision': 0.7456633, 'recall': 0.5739631, 'specificity': 0.5739631, 'f1': 0.48773164, 'auroc': 0.91900796, 'binary_precision': 0.94285715, 'binary_recall': 0.15714286, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.26938775}
confusion matrix:
     0   1
0  645   6
1  531  99
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.7604166, 'recall': 0.54, 'specificity': 0.54, 'f1': 0.41653982, 'auroc': 0.92385185, 'binary_precision': 1.0, 'binary_recall': 0.08, 'binary_specificity': 1.0, 'binary_f1_score': 0.14814813}
confusion matrix:
     0   1
0  225   0
1  207  18
early stop counter: 8
val acc:0.5807962417602539, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8866666555404663
after epoch: 24,now: 2024-07-26 05:36:23.181892,epoch time: 0:01:03.287512,used: 0:25:19.935311,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98393726, 'recall': 0.9832227, 'specificity': 0.9832227, 'f1': 0.9833869, 'auroc': 0.99974346, 'binary_precision': 0.9705882, 'binary_recall': 0.99742764, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.98382485}
confusion matrix:
      0     1
0  1470    47
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.8969555, 'precision': 0.89878833, 'recall': 0.89641577, 'specificity': 0.89641577, 'f1': 0.89672136, 'auroc': 0.93850976, 'binary_precision': 0.9220339, 'binary_recall': 0.8634921, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.89180326}
confusion matrix:
     0    1
0  605   46
1   86  544
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8491372, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.848862, 'auroc': 0.9108148, 'binary_precision': 0.8584475, 'binary_recall': 0.83555555, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8468468}
confusion matrix:
     0    1
0  194   31
1   37  188
better model found
persisted
after epoch: 25,now: 2024-07-26 05:37:26.541492,epoch time: 0:01:03.359600,used: 0:26:23.294911,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938035, 'recall': 0.99382675, 'specificity': 0.99382675, 'f1': 0.99381423, 'auroc': 0.9998156, 'binary_precision': 0.99484867, 'binary_recall': 0.9929306, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.99388874}
confusion matrix:
      0     1
0  1508     8
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.8345043, 'precision': 0.8615195, 'recall': 0.8322581, 'specificity': 0.8322581, 'f1': 0.8306604, 'auroc': 0.931818, 'binary_precision': 0.95633185, 'binary_recall': 0.6952381, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.8051471}
confusion matrix:
     0    1
0  631   20
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.86393344, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8221128, 'auroc': 0.9285531, 'binary_precision': 0.98039216, 'binary_recall': 0.6666667, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7936508}
confusion matrix:
     0    1
0  222    3
1   75  150
early stop counter: 1
val acc:0.8345043063163757, best validation acc: 0.8969554901123047, corresponding to test acc:                         0.8488888740539551 / 0.8866666555404663
after epoch: 26,now: 2024-07-26 05:38:29.790885,epoch time: 0:01:03.249393,used: 0:27:26.544304,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893754, 'recall': 0.98936856, 'specificity': 0.98936856, 'f1': 0.9892578, 'auroc': 0.9999114, 'binary_precision': 1.0, 'binary_recall': 0.9787371, 'binary_specificity': 1.0, 'binary_f1_score': 0.9892543}
confusion matrix:
      0     1
0  1520     0
1    33  1519
---- Validation: 
scalar performance:
{'acc': 0.5971897, 'precision': 0.75541127, 'recall': 0.5906298, 'specificity': 0.5906298, 'f1': 0.515873, 'auroc': 0.92220634, 'binary_precision': 0.95238096, 'binary_recall': 0.1904762, 'binary_specificity': 0.9907834, 'binary_f1_score': 0.31746033}
confusion matrix:
     0    1
0  645    6
1  510  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.75343364, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.47294068, 'auroc': 0.93033576, 'binary_precision': 0.969697, 'binary_recall': 0.14222223, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.24806204}
confusion matrix:
     0   1
0  224   1
1  193  32
early stop counter: 2
val acc:0.597189724445343, best validation acc: 0.8969554901123047, corresponding to test acc:                         0.8488888740539551 / 0.8866666555404663
after epoch: 27,now: 2024-07-26 05:39:32.631152,epoch time: 0:01:02.840267,used: 0:28:29.384571,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98912, 'recall': 0.9888371, 'specificity': 0.9888371, 'f1': 0.9889277, 'auroc': 0.99979144, 'binary_precision': 0.982256, 'binary_recall': 0.99614394, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.9891512}
confusion matrix:
      0     1
0  1488    28
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.75565964, 'precision': 0.80368567, 'recall': 0.75235534, 'specificity': 0.75235534, 'f1': 0.74394476, 'auroc': 0.8884701, 'binary_precision': 0.9204244, 'binary_recall': 0.55079365, 'binary_specificity': 0.953917, 'binary_f1_score': 0.6891757}
confusion matrix:
     0    1
0  621   30
1  283  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7733333, 'precision': 0.8200976, 'recall': 0.7733333, 'specificity': 0.7733333, 'f1': 0.7647409, 'auroc': 0.9153383, 'binary_precision': 0.94244605, 'binary_recall': 0.5822222, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.71978027}
confusion matrix:
     0    1
0  217    8
1   94  131
early stop counter: 3
val acc:0.7556596398353577, best validation acc: 0.8969554901123047, corresponding to test acc:                         0.8488888740539551 / 0.8866666555404663
after epoch: 28,now: 2024-07-26 05:40:35.623430,epoch time: 0:01:02.992278,used: 0:29:32.376849,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.974914, 'recall': 0.9733274, 'specificity': 0.9733274, 'f1': 0.97359836, 'auroc': 0.9993887, 'binary_precision': 0.95328826, 'binary_recall': 0.99678665, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.9745523}
confusion matrix:
      0     1
0  1440    76
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.83684623, 'precision': 0.85174656, 'recall': 0.8351511, 'specificity': 0.8351511, 'f1': 0.83457804, 'auroc': 0.90659976, 'binary_precision': 0.9201597, 'binary_recall': 0.731746, 'binary_specificity': 0.9385561, 'binary_f1_score': 0.8152078}
confusion matrix:
     0    1
0  611   40
1  169  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85704243, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8504901, 'auroc': 0.91733336, 'binary_precision': 0.9030612, 'binary_recall': 0.7866667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.84085506}
confusion matrix:
     0    1
0  206   19
1   48  177
early stop counter: 4
val acc:0.8368462324142456, best validation acc: 0.8969554901123047, corresponding to test acc:                         0.8488888740539551 / 0.8866666555404663
after epoch: 29,now: 2024-07-26 05:41:38.918969,epoch time: 0:01:03.295539,used: 0:30:35.672388,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98932487, 'recall': 0.989367, 'specificity': 0.989367, 'f1': 0.9892578, 'auroc': 0.99973804, 'binary_precision': 0.9986885, 'binary_recall': 0.98005146, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.98928225}
confusion matrix:
      0     1
0  1516     2
1    31  1523
---- Validation: 
scalar performance:
{'acc': 0.76971114, 'precision': 0.82766616, 'recall': 0.7662314, 'specificity': 0.7662314, 'f1': 0.7574513, 'auroc': 0.92370164, 'binary_precision': 0.9614325, 'binary_recall': 0.55396825, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.70292044}
confusion matrix:
     0    1
0  637   14
1  281  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.82754266, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.7552967, 'auroc': 0.92963946, 'binary_precision': 0.96875, 'binary_recall': 0.5511111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7025496}
confusion matrix:
     0    1
0  221    4
1  101  124
early stop counter: 5
val acc:0.7697111368179321, best validation acc: 0.8969554901123047, corresponding to test acc:                         0.8488888740539551 / 0.8866666555404663
after epoch: 30,now: 2024-07-26 05:42:42.020424,epoch time: 0:01:03.101455,used: 0:31:38.773843,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_11_03_seed_1_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:38.773843 at 2024-07-26 05:42:42.020424
persisted model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.8491372, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.848862, 'auroc': 0.9108148, 'binary_precision': 0.8584475, 'binary_recall': 0.83555555, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8468468}
confusion matrix:
     0    1
0  194   31
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.88666666, 'precision': 0.89994687, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.885718, 'auroc': 0.9402864, 'binary_precision': 0.97282606, 'binary_recall': 0.79555553, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8753056}
confusion matrix:
     0    1
0  220    5
1   46  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 149350 GiB | 149349 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 147593 GiB | 147592 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 149350 GiB | 149349 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 147593 GiB | 147592 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 148822 GiB | 148821 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 147069 GiB | 147068 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14480 MiB |  28078 MiB |  13600 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 106351 GiB | 106350 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 104583 GiB | 104583 GiB |
|       from small pool |  10601 KiB |     41 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26106 K  |   26104 K  |
|       from large pool |     187    |    1413    |   13296 K  |   13296 K  |
|       from small pool |    1123    |    1419    |   12809 K  |   12808 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26106 K  |   26104 K  |
|       from large pool |     187    |    1413    |   13296 K  |   13296 K  |
|       from small pool |    1123    |    1419    |   12809 K  |   12808 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1208    |     572    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     648    |   17257 K  |   17257 K  |
|       from large pool |      40    |     604    |    9636 K  |    9636 K  |
|       from small pool |      57    |     236    |    7621 K  |    7621 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149350 GiB | 149350 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147593 GiB | 147593 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149350 GiB | 149350 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147593 GiB | 147593 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148822 GiB | 148822 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147069 GiB | 147069 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 106351 GiB | 106351 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 104584 GiB | 104584 GiB |
|       from small pool |      0 KiB |     41 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26106 K  |   26106 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12809 K  |   12809 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26106 K  |   26106 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12809 K  |   12809 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     648    |   17257 K  |   17257 K  |
|       from large pool |       4    |     604    |    9636 K  |    9636 K  |
|       from small pool |       0    |     236    |    7621 K  |    7621 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149350 GiB | 149350 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147593 GiB | 147593 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149350 GiB | 149350 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147593 GiB | 147593 GiB |
|       from small pool |      0 KiB |     60 MiB |   1756 GiB |   1756 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148822 GiB | 148822 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 147069 GiB | 147069 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 106351 GiB | 106351 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 104584 GiB | 104584 GiB |
|       from small pool |      0 KiB |     41 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26106 K  |   26106 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12809 K  |   12809 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26106 K  |   26106 K  |
|       from large pool |       2    |    1413    |   13296 K  |   13296 K  |
|       from small pool |       0    |    1419    |   12809 K  |   12809 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     648    |   17257 K  |   17257 K  |
|       from large pool |       4    |     604    |    9636 K  |    9636 K  |
|       from small pool |       0    |     236    |    7621 K  |    7621 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536

 Experiment start at: 2024-07-26 05:43:08.291449
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95615184, 'precision': 0.9566047, 'recall': 0.95628786, 'specificity': 0.95628786, 'f1': 0.9561477, 'auroc': 0.98758304, 'binary_precision': 0.9730821, 'binary_recall': 0.938961, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9557172}
confusion matrix:
      0     1
0  1476    40
1    94  1446
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.8175449, 'recall': 0.81761724, 'specificity': 0.81761724, 'f1': 0.8175765, 'auroc': 0.8815068, 'binary_precision': 0.8112, 'binary_recall': 0.81511253, 'binary_specificity': 0.82012194, 'binary_f1_score': 0.8131516}
confusion matrix:
     0    1
0  538  118
1  115  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8055556, 'precision': 0.8107778, 'recall': 0.8055556, 'specificity': 0.8055556, 'f1': 0.80473524, 'auroc': 0.9138589, 'binary_precision': 0.7704918, 'binary_recall': 0.8703704, 'binary_specificity': 0.7407407, 'binary_f1_score': 0.8173913}
confusion matrix:
     0    1
0  160   56
1   28  188
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:44:12.415484,epoch time: 0:01:04.124035,used: 0:01:04.124035,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.960733, 'precision': 0.96179324, 'recall': 0.9605558, 'specificity': 0.9605558, 'f1': 0.96069735, 'auroc': 0.99602556, 'binary_precision': 0.94154227, 'binary_recall': 0.98311687, 'binary_specificity': 0.9379947, 'binary_f1_score': 0.9618805}
confusion matrix:
      0     1
0  1422    94
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.7918623, 'precision': 0.7995255, 'recall': 0.793923, 'specificity': 0.793923, 'f1': 0.79119956, 'auroc': 0.8869623, 'binary_precision': 0.74450547, 'binary_recall': 0.87138265, 'binary_specificity': 0.7164634, 'binary_f1_score': 0.80296296}
confusion matrix:
     0    1
0  470  186
1   80  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.76116765, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.69594425, 'auroc': 0.89810526, 'binary_precision': 0.6463022, 'binary_recall': 0.9305556, 'binary_specificity': 0.49074075, 'binary_f1_score': 0.7628084}
confusion matrix:
     0    1
0  106  110
1   15  201
early stop counter: 1
val acc:0.7918623089790344, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8055555820465088 / 0.8055555820465088
after epoch: 2,now: 2024-07-26 05:45:13.820193,epoch time: 0:01:01.404709,used: 0:02:05.528744,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96531415, 'precision': 0.96587825, 'recall': 0.9651886, 'specificity': 0.9651886, 'f1': 0.96529484, 'auroc': 0.9958216, 'binary_precision': 0.9515113, 'binary_recall': 0.9811688, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.9661125}
confusion matrix:
      0     1
0  1439    77
1    29  1511
---- Validation: 
scalar performance:
{'acc': 0.69092333, 'precision': 0.78159225, 'recall': 0.68318415, 'specificity': 0.68318415, 'f1': 0.6582793, 'auroc': 0.87219876, 'binary_precision': 0.9348659, 'binary_recall': 0.39228296, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.55266136}
confusion matrix:
     0    1
0  639   17
1  378  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6550926, 'precision': 0.77610946, 'recall': 0.6550926, 'specificity': 0.6550926, 'f1': 0.6126493, 'auroc': 0.8525163, 'binary_precision': 0.9589041, 'binary_recall': 0.32407406, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.48442903}
confusion matrix:
     0   1
0  213   3
1  146  70
early stop counter: 2
val acc:0.6909233331680298, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8055555820465088 / 0.8055555820465088
after epoch: 3,now: 2024-07-26 05:46:15.411577,epoch time: 0:01:01.591384,used: 0:03:07.120128,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97809714, 'recall': 0.9776548, 'specificity': 0.9776548, 'f1': 0.9777401, 'auroc': 0.99840784, 'binary_precision': 0.9670051, 'binary_recall': 0.9896104, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.97817713}
confusion matrix:
      0     1
0  1464    52
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.827856, 'precision': 0.8367086, 'recall': 0.82565093, 'specificity': 0.82565093, 'f1': 0.8259425, 'auroc': 0.8932216, 'binary_precision': 0.88505745, 'binary_recall': 0.74276525, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.80769235}
confusion matrix:
     0    1
0  596   60
1  160  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.80329925, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.80323124, 'auroc': 0.8855238, 'binary_precision': 0.80751175, 'binary_recall': 0.7962963, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8018648}
confusion matrix:
     0    1
0  175   41
1   44  172
better model found
persisted
after epoch: 4,now: 2024-07-26 05:47:16.949337,epoch time: 0:01:01.537760,used: 0:04:08.657888,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.973822, 'precision': 0.9741665, 'recall': 0.9737278, 'specificity': 0.9737278, 'f1': 0.9738119, 'auroc': 0.9980635, 'binary_precision': 0.96319795, 'binary_recall': 0.98571426, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9743261}
confusion matrix:
      0     1
0  1458    58
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.7910798, 'precision': 0.8047501, 'recall': 0.7881612, 'specificity': 0.7881612, 'f1': 0.78745043, 'auroc': 0.8635107, 'binary_precision': 0.8629857, 'binary_recall': 0.6784566, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.759676}
confusion matrix:
     0    1
0  589   67
1  200  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8125067, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.81249905, 'auroc': 0.89705503, 'binary_precision': 0.81395346, 'binary_recall': 0.8101852, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.812065}
confusion matrix:
     0    1
0  176   40
1   41  175
new oracle model saved
early stop counter: 1
val acc:0.7910798192024231, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8125
after epoch: 5,now: 2024-07-26 05:48:18.876866,epoch time: 0:01:01.927529,used: 0:05:10.585417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9587696, 'precision': 0.96149015, 'recall': 0.9584793, 'specificity': 0.9584793, 'f1': 0.9586878, 'auroc': 0.99819285, 'binary_precision': 0.9279661, 'binary_recall': 0.99545455, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.9605263}
confusion matrix:
      0     1
0  1397   119
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.78403753, 'precision': 0.7856231, 'recall': 0.78496784, 'specificity': 0.78496784, 'f1': 0.7839948, 'auroc': 0.8606187, 'binary_precision': 0.75667655, 'binary_recall': 0.8199357, 'binary_specificity': 0.75, 'binary_f1_score': 0.7870371}
confusion matrix:
     0    1
0  492  164
1  112  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597222, 'precision': 0.7327659, 'recall': 0.6597222, 'specificity': 0.6597222, 'f1': 0.63075423, 'auroc': 0.85898924, 'binary_precision': 0.6023739, 'binary_recall': 0.9398148, 'binary_specificity': 0.37962964, 'binary_f1_score': 0.73417723}
confusion matrix:
    0    1
0  82  134
1  13  203
early stop counter: 2
val acc:0.7840375304222107, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8125
after epoch: 6,now: 2024-07-26 05:49:20.378797,epoch time: 0:01:01.501931,used: 0:06:12.087348,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9769484, 'recall': 0.9765823, 'specificity': 0.9765823, 'f1': 0.9764372, 'auroc': 0.99788964, 'binary_precision': 0.9946092, 'binary_recall': 0.95844156, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9761905}
confusion matrix:
      0     1
0  1508     8
1    64  1476
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.75629157, 'recall': 0.67001855, 'specificity': 0.67001855, 'f1': 0.64488983, 'auroc': 0.83287096, 'binary_precision': 0.89179105, 'binary_recall': 0.38424438, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.5370787}
confusion matrix:
     0    1
0  627   29
1  383  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5740741, 'precision': 0.7308309, 'recall': 0.5740741, 'specificity': 0.5740741, 'f1': 0.48697558, 'auroc': 0.7803712, 'binary_precision': 0.92105263, 'binary_recall': 0.16203703, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.27559054}
confusion matrix:
     0   1
0  213   3
1  181  35
early stop counter: 3
val acc:0.6776213049888611, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8125
after epoch: 7,now: 2024-07-26 05:50:21.678147,epoch time: 0:01:01.299350,used: 0:07:13.386698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9867078, 'recall': 0.9866626, 'specificity': 0.9866626, 'f1': 0.9865837, 'auroc': 0.99846566, 'binary_precision': 0.9966865, 'binary_recall': 0.97662336, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.98655295}
confusion matrix:
      0     1
0  1511     5
1    36  1504
---- Validation: 
scalar performance:
{'acc': 0.76212835, 'precision': 0.80720603, 'recall': 0.75691855, 'specificity': 0.75691855, 'f1': 0.75049126, 'auroc': 0.8808991, 'binary_precision': 0.91842103, 'binary_recall': 0.5610933, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.6966068}
confusion matrix:
     0    1
0  625   31
1  273  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6712963, 'precision': 0.773399, 'recall': 0.6712963, 'specificity': 0.6712963, 'f1': 0.63744676, 'auroc': 0.8683771, 'binary_precision': 0.9404762, 'binary_recall': 0.36574075, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.52666664}
confusion matrix:
     0   1
0  211   5
1  137  79
early stop counter: 4
val acc:0.7621283531188965, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8125
after epoch: 8,now: 2024-07-26 05:51:22.909988,epoch time: 0:01:01.231841,used: 0:08:14.618539,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9843699, 'recall': 0.984359, 'specificity': 0.984359, 'f1': 0.9842932, 'auroc': 0.9989797, 'binary_precision': 0.9927345, 'binary_recall': 0.975974, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9842829}
confusion matrix:
      0     1
0  1505    11
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7816901, 'precision': 0.80892956, 'recall': 0.77764, 'specificity': 0.77764, 'f1': 0.77496064, 'auroc': 0.87794036, 'binary_precision': 0.8942529, 'binary_recall': 0.6254019, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.7360454}
confusion matrix:
     0    1
0  610   46
1  233  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.81861436, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.78162634, 'auroc': 0.8864883, 'binary_precision': 0.9189189, 'binary_recall': 0.6296296, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7472527}
confusion matrix:
     0    1
0  204   12
1   80  136
early stop counter: 5
val acc:0.7816901206970215, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8125
after epoch: 9,now: 2024-07-26 05:52:24.289977,epoch time: 0:01:01.379989,used: 0:09:15.998528,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98934793, 'recall': 0.9892857, 'specificity': 0.9892857, 'f1': 0.9892015, 'auroc': 0.99914503, 'binary_precision': 1.0, 'binary_recall': 0.9785714, 'binary_specificity': 1.0, 'binary_f1_score': 0.98916966}
confusion matrix:
      0     1
0  1516     0
1    33  1507
---- Validation: 
scalar performance:
{'acc': 0.69874805, 'precision': 0.78892297, 'recall': 0.69113946, 'specificity': 0.69113946, 'f1': 0.6679877, 'auroc': 0.8879843, 'binary_precision': 0.94382024, 'binary_recall': 0.4051447, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.56692916}
confusion matrix:
     0    1
0  641   15
1  370  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5671296, 'precision': 0.73786736, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.47246546, 'auroc': 0.86346877, 'binary_precision': 0.93939394, 'binary_recall': 0.14351852, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.24899599}
confusion matrix:
     0   1
0  214   2
1  185  31
early stop counter: 6
val acc:0.6987480521202087, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8125
after epoch: 10,now: 2024-07-26 05:53:26.010018,epoch time: 0:01:01.720041,used: 0:10:17.718569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9882127, 'recall': 0.98822945, 'specificity': 0.98822945, 'f1': 0.9882194, 'auroc': 0.9991374, 'binary_precision': 0.9895833, 'binary_recall': 0.987013, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.98829645}
confusion matrix:
      0     1
0  1500    16
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.7793427, 'precision': 0.81981784, 'recall': 0.77452016, 'specificity': 0.77452016, 'f1': 0.76996785, 'auroc': 0.91286224, 'binary_precision': 0.9271357, 'binary_recall': 0.5932476, 'binary_specificity': 0.95579267, 'binary_f1_score': 0.72352946}
confusion matrix:
     0    1
0  627   29
1  253  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.85972595, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.8196044, 'auroc': 0.92652607, 'binary_precision': 0.972973, 'binary_recall': 0.6666667, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.79120886}
confusion matrix:
     0    1
0  212    4
1   72  144
new oracle model saved
early stop counter: 7
val acc:0.7793427109718323, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8240740895271301
after epoch: 11,now: 2024-07-26 05:54:28.173434,epoch time: 0:01:02.163416,used: 0:11:19.881985,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9859979, 'recall': 0.98599267, 'specificity': 0.98599267, 'f1': 0.9859293, 'auroc': 0.9992744, 'binary_precision': 0.9940594, 'binary_recall': 0.9779221, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.98592466}
confusion matrix:
      0     1
0  1507     9
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.7308294, 'precision': 0.80737114, 'recall': 0.72405595, 'specificity': 0.72405595, 'f1': 0.70900404, 'auroc': 0.9189868, 'binary_precision': 0.95424837, 'binary_recall': 0.46945336, 'binary_specificity': 0.97865856, 'binary_f1_score': 0.6293103}
confusion matrix:
     0    1
0  642   14
1  330  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.826284, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.7134931, 'auroc': 0.9396862, 'binary_precision': 1.0, 'binary_recall': 0.4675926, 'binary_specificity': 1.0, 'binary_f1_score': 0.63722396}
confusion matrix:
     0    1
0  216    0
1  115  101
early stop counter: 8
val acc:0.7308294177055359, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8240740895271301
after epoch: 12,now: 2024-07-26 05:55:29.992665,epoch time: 0:01:01.819231,used: 0:12:21.701216,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9857594, 'recall': 0.98568857, 'specificity': 0.98568857, 'f1': 0.98560196, 'auroc': 0.99883705, 'binary_precision': 0.99667996, 'binary_recall': 0.9746753, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9855549}
confusion matrix:
      0     1
0  1511     5
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.80907667, 'precision': 0.82497084, 'recall': 0.8060667, 'specificity': 0.8060667, 'f1': 0.8055546, 'auroc': 0.903363, 'binary_precision': 0.8904959, 'binary_recall': 0.69292605, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.77938515}
confusion matrix:
     0    1
0  603   53
1  191  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310185, 'precision': 0.8399441, 'recall': 0.8310185, 'specificity': 0.8310185, 'f1': 0.829902, 'auroc': 0.9174168, 'binary_precision': 0.89502764, 'binary_recall': 0.75, 'binary_specificity': 0.912037, 'binary_f1_score': 0.8161209}
confusion matrix:
     0    1
0  197   19
1   54  162
new oracle model saved
early stop counter: 9
val acc:0.8090766668319702, best validation acc: 0.8278560042381287, corresponding to test acc:                         0.8032407164573669 / 0.8310185074806213
after epoch: 13,now: 2024-07-26 05:56:31.742630,epoch time: 0:01:01.749965,used: 0:13:23.451181,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9899396, 'recall': 0.98981684, 'specificity': 0.98981684, 'f1': 0.9898544, 'auroc': 0.99962866, 'binary_precision': 0.985209, 'binary_recall': 0.9948052, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.98998386}
confusion matrix:
      0     1
0  1493    23
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.84428793, 'precision': 0.8514321, 'recall': 0.8423653, 'specificity': 0.8423653, 'f1': 0.84287953, 'auroc': 0.904233, 'binary_precision': 0.8953271, 'binary_recall': 0.7700965, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.8280034}
confusion matrix:
     0    1
0  600   56
1  143  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.80329925, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.80323124, 'auroc': 0.8831662, 'binary_precision': 0.80751175, 'binary_recall': 0.7962963, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.8018648}
confusion matrix:
     0    1
0  175   41
1   44  172
better model found
persisted
after epoch: 14,now: 2024-07-26 05:57:33.483965,epoch time: 0:01:01.741335,used: 0:14:25.192516,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.9827182, 'recall': 0.98223114, 'specificity': 0.98223114, 'f1': 0.9823226, 'auroc': 0.9992572, 'binary_precision': 0.97084916, 'binary_recall': 0.9948052, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9826812}
confusion matrix:
      0     1
0  1470    46
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.8372457, 'precision': 0.84229326, 'recall': 0.8355889, 'specificity': 0.8355889, 'f1': 0.83607507, 'auroc': 0.90627205, 'binary_precision': 0.8777372, 'binary_recall': 0.7733119, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.82222223}
confusion matrix:
     0    1
0  589   67
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.8425926, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.8425926, 'auroc': 0.9176526, 'binary_precision': 0.8425926, 'binary_recall': 0.8425926, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.8425926}
confusion matrix:
     0    1
0  182   34
1   34  182
new oracle model saved
early stop counter: 1
val acc:0.8372457027435303, best validation acc: 0.8442879319190979, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 15,now: 2024-07-26 05:58:35.643638,epoch time: 0:01:02.159673,used: 0:15:27.352189,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.98808753, 'recall': 0.98798704, 'specificity': 0.98798704, 'f1': 0.98789245, 'auroc': 0.99968517, 'binary_precision': 1.0, 'binary_recall': 0.975974, 'binary_specificity': 1.0, 'binary_f1_score': 0.9878409}
confusion matrix:
      0     1
0  1516     0
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.8090046, 'recall': 0.72972465, 'specificity': 0.72972465, 'f1': 0.71609414, 'auroc': 0.9099066, 'binary_precision': 0.95238096, 'binary_recall': 0.48231512, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.6403415}
confusion matrix:
     0    1
0  641   15
1  322  300
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.802521, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.738657, 'auroc': 0.90674293, 'binary_precision': 0.9285714, 'binary_recall': 0.5416667, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.68421054}
confusion matrix:
     0    1
0  207    9
1   99  117
early stop counter: 2
val acc:0.7363067269325256, best validation acc: 0.8442879319190979, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 16,now: 2024-07-26 05:59:37.349412,epoch time: 0:01:01.705774,used: 0:16:29.057963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98544395, 'recall': 0.9853639, 'specificity': 0.9853639, 'f1': 0.9852747, 'auroc': 0.9986032, 'binary_precision': 0.99667776, 'binary_recall': 0.97402596, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9852217}
confusion matrix:
      0     1
0  1511     5
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.7777778, 'precision': 0.82979953, 'recall': 0.7724125, 'specificity': 0.7724125, 'f1': 0.76623374, 'auroc': 0.91537917, 'binary_precision': 0.95430106, 'binary_recall': 0.57073957, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.7142857}
confusion matrix:
     0    1
0  639   17
1  267  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7013889, 'precision': 0.80779314, 'recall': 0.7013889, 'specificity': 0.7013889, 'f1': 0.6731399, 'auroc': 0.91422325, 'binary_precision': 0.98876405, 'binary_recall': 0.4074074, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.5770492}
confusion matrix:
     0   1
0  215   1
1  128  88
early stop counter: 3
val acc:0.7777777910232544, best validation acc: 0.8442879319190979, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 17,now: 2024-07-26 06:00:38.978984,epoch time: 0:01:01.629572,used: 0:17:30.687535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98866856, 'recall': 0.9884976, 'specificity': 0.9884976, 'f1': 0.9885448, 'auroc': 0.99925435, 'binary_precision': 0.9826812, 'binary_recall': 0.9948052, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.98870605}
confusion matrix:
      0     1
0  1489    27
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.85524255, 'precision': 0.86140114, 'recall': 0.85349435, 'specificity': 0.85349435, 'f1': 0.85410196, 'auroc': 0.9041154, 'binary_precision': 0.9023941, 'binary_recall': 0.78778136, 'binary_specificity': 0.91920733, 'binary_f1_score': 0.8412017}
confusion matrix:
     0    1
0  603   53
1  132  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8148148, 'precision': 0.8201953, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8140335, 'auroc': 0.87862223, 'binary_precision': 0.86170214, 'binary_recall': 0.75, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.80198014}
confusion matrix:
     0    1
0  190   26
1   54  162
better model found
persisted
after epoch: 18,now: 2024-07-26 06:01:40.893831,epoch time: 0:01:01.914847,used: 0:18:32.602382,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99541885, 'precision': 0.9954413, 'recall': 0.9954032, 'specificity': 0.9954032, 'f1': 0.9954184, 'auroc': 0.99991393, 'binary_precision': 0.9935317, 'binary_recall': 0.9974026, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9954634}
confusion matrix:
      0     1
0  1506    10
1     4  1536
---- Validation: 
scalar performance:
{'acc': 0.7801252, 'precision': 0.81949204, 'recall': 0.77536565, 'specificity': 0.77536565, 'f1': 0.7710085, 'auroc': 0.9057231, 'binary_precision': 0.92518705, 'binary_recall': 0.596463, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.7253177}
confusion matrix:
     0    1
0  626   30
1  251  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6921296, 'precision': 0.7799938, 'recall': 0.6921296, 'specificity': 0.6921296, 'f1': 0.6659205, 'auroc': 0.89611197, 'binary_precision': 0.9368421, 'binary_recall': 0.41203704, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.5723473}
confusion matrix:
     0   1
0  210   6
1  127  89
early stop counter: 1
val acc:0.7801252007484436, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 19,now: 2024-07-26 06:02:42.596525,epoch time: 0:01:01.702694,used: 0:19:34.305076,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.98535705, 'recall': 0.98523545, 'specificity': 0.98523545, 'f1': 0.9852725, 'auroc': 0.9993677, 'binary_precision': 0.9807074, 'binary_recall': 0.99025977, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.98546046}
confusion matrix:
      0     1
0  1486    30
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83956784, 'recall': 0.8314862, 'specificity': 0.8314862, 'f1': 0.8319246, 'auroc': 0.9079337, 'binary_precision': 0.87940633, 'binary_recall': 0.7620579, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.8165375}
confusion matrix:
     0    1
0  591   65
1  148  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8240741, 'precision': 0.82883865, 'recall': 0.8240741, 'specificity': 0.8240741, 'f1': 0.82343453, 'auroc': 0.8942687, 'binary_precision': 0.8684211, 'binary_recall': 0.7638889, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.8128079}
confusion matrix:
     0    1
0  191   25
1   51  165
early stop counter: 2
val acc:0.8333333134651184, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 20,now: 2024-07-26 06:03:44.619456,epoch time: 0:01:02.022931,used: 0:20:36.328007,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99115884, 'recall': 0.9911721, 'specificity': 0.9911721, 'f1': 0.99116445, 'auroc': 0.9996625, 'binary_precision': 0.99219257, 'binary_recall': 0.99025977, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.9912252}
confusion matrix:
      0     1
0  1504    12
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.7222222, 'precision': 0.790046, 'recall': 0.7156301, 'specificity': 0.7156301, 'f1': 0.70093, 'auroc': 0.89797854, 'binary_precision': 0.9238095, 'binary_recall': 0.46784565, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.62113124}
confusion matrix:
     0    1
0  632   24
1  331  291
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.83344966, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.7537906, 'auroc': 0.9382287, 'binary_precision': 0.9831933, 'binary_recall': 0.5416667, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.6985075}
confusion matrix:
     0    1
0  214    2
1   99  117
early stop counter: 3
val acc:0.7222222089767456, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 21,now: 2024-07-26 06:04:46.394708,epoch time: 0:01:01.775252,used: 0:21:38.103259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9842149, 'recall': 0.98407036, 'specificity': 0.98407036, 'f1': 0.98396546, 'auroc': 0.99920154, 'binary_precision': 0.99733156, 'binary_recall': 0.97077924, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9838763}
confusion matrix:
      0     1
0  1512     4
1    45  1495
---- Validation: 
scalar performance:
{'acc': 0.7832551, 'precision': 0.81688094, 'recall': 0.77883106, 'specificity': 0.77883106, 'f1': 0.77540016, 'auroc': 0.883821, 'binary_precision': 0.91366905, 'binary_recall': 0.6125402, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.7333975}
confusion matrix:
     0    1
0  620   36
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8423428, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.79745716, 'auroc': 0.90845764, 'binary_precision': 0.95804197, 'binary_recall': 0.6342593, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.7632312}
confusion matrix:
     0    1
0  210    6
1   79  137
early stop counter: 4
val acc:0.7832551002502441, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 22,now: 2024-07-26 06:05:48.047424,epoch time: 0:01:01.652716,used: 0:22:39.755975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.98675317, 'recall': 0.9866729, 'specificity': 0.9866729, 'f1': 0.9865836, 'auroc': 0.99965775, 'binary_precision': 0.99800664, 'binary_recall': 0.9753247, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9865353}
confusion matrix:
      0     1
0  1513     3
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.6040689, 'precision': 0.77014434, 'recall': 0.5933726, 'specificity': 0.5933726, 'f1': 0.5203215, 'auroc': 0.9012198, 'binary_precision': 0.97540987, 'binary_recall': 0.19131833, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.31989247}
confusion matrix:
     0    1
0  653    3
1  503  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5902778, 'precision': 0.76274097, 'recall': 0.5902778, 'specificity': 0.5902778, 'f1': 0.509843, 'auroc': 0.90738595, 'binary_precision': 0.9756098, 'binary_recall': 0.18518518, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.31128404}
confusion matrix:
     0   1
0  215   1
1  176  40
early stop counter: 5
val acc:0.6040688753128052, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 23,now: 2024-07-26 06:06:49.934202,epoch time: 0:01:01.886778,used: 0:23:41.642753,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9877735, 'recall': 0.9876623, 'specificity': 0.9876623, 'f1': 0.98756516, 'auroc': 0.9999255, 'binary_precision': 1.0, 'binary_recall': 0.9753247, 'binary_specificity': 1.0, 'binary_f1_score': 0.98750824}
confusion matrix:
      0     1
0  1516     0
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.60172147, 'precision': 0.75097656, 'recall': 0.59116936, 'specificity': 0.59116936, 'f1': 0.5201213, 'auroc': 0.90980303, 'binary_precision': 0.93798447, 'binary_recall': 0.19453377, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.322237}
confusion matrix:
     0    1
0  648    8
1  501  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.76277375, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.43310517, 'auroc': 0.8680556, 'binary_precision': 1.0, 'binary_recall': 0.097222224, 'binary_specificity': 1.0, 'binary_f1_score': 0.17721519}
confusion matrix:
     0   1
0  216   0
1  195  21
early stop counter: 6
val acc:0.601721465587616, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 24,now: 2024-07-26 06:07:51.746081,epoch time: 0:01:01.811879,used: 0:24:43.454632,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99281394, 'recall': 0.99279034, 'specificity': 0.99279034, 'f1': 0.9928005, 'auroc': 0.9995935, 'binary_precision': 0.9915803, 'binary_recall': 0.9941558, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9928664}
confusion matrix:
      0     1
0  1503    13
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.8169014, 'precision': 0.83137834, 'recall': 0.8140636, 'specificity': 0.8140636, 'f1': 0.81383574, 'auroc': 0.8960253, 'binary_precision': 0.8943089, 'binary_recall': 0.7073955, 'binary_specificity': 0.9207317, 'binary_f1_score': 0.78994614}
confusion matrix:
     0    1
0  604   52
1  182  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75, 'precision': 0.8054043, 'recall': 0.75, 'specificity': 0.75, 'f1': 0.73812306, 'auroc': 0.86792696, 'binary_precision': 0.9354839, 'binary_recall': 0.537037, 'binary_specificity': 0.962963, 'binary_f1_score': 0.68235296}
confusion matrix:
     0    1
0  208    8
1  100  116
early stop counter: 7
val acc:0.8169013857841492, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 25,now: 2024-07-26 06:08:53.649375,epoch time: 0:01:01.903294,used: 0:25:45.357926,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99280643, 'recall': 0.99279547, 'specificity': 0.99279547, 'f1': 0.99280053, 'auroc': 0.9993999, 'binary_precision': 0.9922179, 'binary_recall': 0.9935065, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.99286175}
confusion matrix:
      0     1
0  1504    12
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.8094883, 'recall': 0.76343274, 'specificity': 0.76343274, 'f1': 0.75806415, 'auroc': 0.87844026, 'binary_precision': 0.9158163, 'binary_recall': 0.57717043, 'binary_specificity': 0.9496951, 'binary_f1_score': 0.70808685}
confusion matrix:
     0    1
0  623   33
1  263  359
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7824074, 'precision': 0.8077642, 'recall': 0.7824074, 'specificity': 0.7824074, 'f1': 0.77783126, 'auroc': 0.89176095, 'binary_precision': 0.8961039, 'binary_recall': 0.6388889, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.74594593}
confusion matrix:
     0    1
0  200   16
1   78  138
early stop counter: 8
val acc:0.7683880925178528, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 26,now: 2024-07-26 06:09:55.096317,epoch time: 0:01:01.446942,used: 0:26:46.804868,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.99445474, 'recall': 0.994424, 'specificity': 0.994424, 'f1': 0.9944367, 'auroc': 0.9996629, 'binary_precision': 0.9928803, 'binary_recall': 0.9961039, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9944895}
confusion matrix:
      0     1
0  1505    11
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.75508606, 'precision': 0.79750717, 'recall': 0.74993384, 'specificity': 0.74993384, 'f1': 0.74337596, 'auroc': 0.87352216, 'binary_precision': 0.9033943, 'binary_recall': 0.5562701, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.68855727}
confusion matrix:
     0    1
0  619   37
1  276  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.80007577, 'recall': 0.7291666, 'specificity': 0.7291666, 'f1': 0.7121624, 'auroc': 0.8855238, 'binary_precision': 0.9459459, 'binary_recall': 0.4861111, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.64220184}
confusion matrix:
     0    1
0  210    6
1  111  105
early stop counter: 9
val acc:0.7550860643386841, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 27,now: 2024-07-26 06:10:56.840976,epoch time: 0:01:01.744659,used: 0:27:48.549527,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.997055, 'precision': 0.9970525, 'recall': 0.9970574, 'specificity': 0.9970574, 'f1': 0.9970548, 'auroc': 0.999907, 'binary_precision': 0.99740094, 'binary_recall': 0.9967533, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99707705}
confusion matrix:
      0     1
0  1512     4
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.75117373, 'precision': 0.8136147, 'recall': 0.7451229, 'specificity': 0.7451229, 'f1': 0.7349702, 'auroc': 0.909822, 'binary_precision': 0.9470588, 'binary_recall': 0.5176849, 'binary_specificity': 0.972561, 'binary_f1_score': 0.66943866}
confusion matrix:
     0    1
0  638   18
1  300  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6157407, 'precision': 0.756459, 'recall': 0.6157407, 'specificity': 0.6157407, 'f1': 0.55465025, 'auroc': 0.89319706, 'binary_precision': 0.9464286, 'binary_recall': 0.24537037, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.3897059}
confusion matrix:
     0   1
0  213   3
1  163  53
early stop counter: 10
val acc:0.751173734664917, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 28,now: 2024-07-26 06:11:58.384862,epoch time: 0:01:01.543886,used: 0:28:50.093413,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99672776, 'precision': 0.9967276, 'recall': 0.9967276, 'specificity': 0.9967276, 'f1': 0.9967276, 'auroc': 0.9997742, 'binary_precision': 0.9967533, 'binary_recall': 0.9967533, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9967533}
confusion matrix:
      0     1
0  1511     5
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.8416072, 'recall': 0.81411755, 'specificity': 0.81411755, 'f1': 0.8131535, 'auroc': 0.9042796, 'binary_precision': 0.9256017, 'binary_recall': 0.6800643, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7840593}
confusion matrix:
     0    1
0  622   34
1  199  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7430556, 'precision': 0.79275846, 'recall': 0.7430556, 'specificity': 0.7430556, 'f1': 0.73166656, 'auroc': 0.8890389, 'binary_precision': 0.9133858, 'binary_recall': 0.537037, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.67638487}
confusion matrix:
     0    1
0  205   11
1  100  116
early stop counter: 11
val acc:0.8176838755607605, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8425925970077515
after epoch: 29,now: 2024-07-26 06:13:00.022890,epoch time: 0:01:01.638028,used: 0:29:51.731441,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9924662, 'recall': 0.99248624, 'specificity': 0.99248624, 'f1': 0.99247354, 'auroc': 0.99967015, 'binary_precision': 0.9941368, 'binary_recall': 0.9909091, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.99252033}
confusion matrix:
      0     1
0  1507     9
1    14  1526
---- Validation: 
scalar performance:
{'acc': 0.8356807, 'precision': 0.8532381, 'recall': 0.8326896, 'specificity': 0.8326896, 'f1': 0.83264947, 'auroc': 0.9044199, 'binary_precision': 0.92561984, 'binary_recall': 0.7202572, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.81012654}
confusion matrix:
     0    1
0  620   36
1  174  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8657407, 'precision': 0.8739481, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86499995, 'auroc': 0.92161775, 'binary_precision': 0.9293478, 'binary_recall': 0.7916667, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.85499996}
confusion matrix:
     0    1
0  203   13
1   45  171
new oracle model saved
early stop counter: 12
val acc:0.8356807231903076, best validation acc: 0.8552425503730774, corresponding to test acc:                         0.8148148059844971 / 0.8657407164573669
after epoch: 30,now: 2024-07-26 06:14:02.022634,epoch time: 0:01:01.999744,used: 0:30:53.731185,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_43_08_seed_2_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:30:53.731185 at 2024-07-26 06:14:02.022634
persisted model performance metric: 

scalar performance:
{'acc': 0.8148148, 'precision': 0.8201953, 'recall': 0.8148148, 'specificity': 0.8148148, 'f1': 0.8140335, 'auroc': 0.87862223, 'binary_precision': 0.86170214, 'binary_recall': 0.75, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.80198014}
confusion matrix:
     0    1
0  190   26
1   54  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8657407, 'precision': 0.8739481, 'recall': 0.8657408, 'specificity': 0.8657408, 'f1': 0.86499995, 'auroc': 0.92161775, 'binary_precision': 0.9293478, 'binary_recall': 0.7916667, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.85499996}
confusion matrix:
     0    1
0  203   13
1   45  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455124 KiB |  13219 MiB | 222778 GiB | 222778 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 220158 GiB | 220157 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455124 KiB |  13219 MiB | 222778 GiB | 222778 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 220158 GiB | 220157 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 222200 GiB | 222199 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 219585 GiB | 219584 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41672 MiB |  27198 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448044 KiB |   1252 MiB | 158761 GiB | 158760 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 156125 GiB | 156124 GiB |
|       from small pool |  12655 KiB |     41 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38979 K  |   38977 K  |
|       from large pool |     187    |    1413    |   19852 K  |   19851 K  |
|       from small pool |    1111    |    1419    |   19126 K  |   19125 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38979 K  |   38977 K  |
|       from large pool |     187    |    1413    |   19852 K  |   19851 K  |
|       from small pool |    1111    |    1419    |   19126 K  |   19125 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1780    |    1146    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     651    |   25498 K  |   25497 K  |
|       from large pool |      40    |     604    |   14238 K  |   14238 K  |
|       from small pool |      61    |     236    |   11259 K  |   11259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222778 GiB | 222778 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220158 GiB | 220158 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222778 GiB | 222778 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220158 GiB | 220158 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 222200 GiB | 222200 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219585 GiB | 219585 GiB |
|       from small pool |      0 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41672 MiB |  40790 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 158761 GiB | 158761 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 156125 GiB | 156125 GiB |
|       from small pool |      0 KiB |     44 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1780    |    1717    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   25498 K  |   25498 K  |
|       from large pool |       4    |     604    |   14238 K  |   14238 K  |
|       from small pool |       0    |     236    |   11259 K  |   11259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222778 GiB | 222778 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220158 GiB | 220158 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222778 GiB | 222778 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 220158 GiB | 220158 GiB |
|       from small pool |      0 KiB |     60 MiB |   2620 GiB |   2620 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 222200 GiB | 222200 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219585 GiB | 219585 GiB |
|       from small pool |      0 KiB |     60 MiB |   2615 GiB |   2615 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  41672 MiB |  40790 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     52 MiB |     70 MiB |    102 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 158761 GiB | 158761 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 156125 GiB | 156125 GiB |
|       from small pool |      0 KiB |     44 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38979 K  |   38979 K  |
|       from large pool |       2    |    1413    |   19852 K  |   19852 K  |
|       from small pool |       0    |    1419    |   19126 K  |   19126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    1780    |    1717    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      26    |      35    |      51    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   25498 K  |   25498 K  |
|       from large pool |       4    |     604    |   14238 K  |   14238 K  |
|       from small pool |       0    |     236    |   11259 K  |   11259 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536

 Experiment start at: 2024-07-26 06:14:28.451616
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95182294, 'precision': 0.9544816, 'recall': 0.9524099, 'specificity': 0.9524099, 'f1': 0.9517869, 'auroc': 0.98981524, 'binary_precision': 0.993007, 'binary_recall': 0.9114249, 'binary_specificity': 0.993395, 'binary_f1_score': 0.95046854}
confusion matrix:
      0     1
0  1504    10
1   138  1420
---- Validation: 
scalar performance:
{'acc': 0.82774746, 'precision': 0.83398175, 'recall': 0.8263906, 'specificity': 0.8263906, 'f1': 0.8264719, 'auroc': 0.8970163, 'binary_precision': 0.875, 'binary_recall': 0.7567568, 'binary_specificity': 0.89602447, 'binary_f1_score': 0.8115942}
confusion matrix:
     0    1
0  586   68
1  153  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8190129, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8176012, 'auroc': 0.8956642, 'binary_precision': 0.83886254, 'binary_recall': 0.7866667, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.81192654}
confusion matrix:
     0    1
0  191   34
1   48  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 06:15:33.528301,epoch time: 0:01:05.076685,used: 0:01:05.076685,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96875, 'precision': 0.96875, 'recall': 0.9688295, 'specificity': 0.9688295, 'f1': 0.9687487, 'auroc': 0.9911692, 'binary_precision': 0.97526044, 'binary_recall': 0.9627249, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.96895206}
confusion matrix:
      0     1
0  1478    38
1    58  1498
---- Validation: 
scalar performance:
{'acc': 0.8293063, 'precision': 0.8292631, 'recall': 0.8291959, 'specificity': 0.8291959, 'f1': 0.82922494, 'auroc': 0.89541185, 'binary_precision': 0.827476, 'binary_recall': 0.8235294, 'binary_specificity': 0.8348624, 'binary_f1_score': 0.825498}
confusion matrix:
     0    1
0  546  108
1  111  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.81008947, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.8087038, 'auroc': 0.90016794, 'binary_precision': 0.79079497, 'binary_recall': 0.84, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.8146552}
confusion matrix:
     0    1
0  175   50
1   36  189
better model found
persisted
after epoch: 2,now: 2024-07-26 06:16:35.637050,epoch time: 0:01:02.108749,used: 0:02:07.185434,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9763013, 'recall': 0.97618353, 'specificity': 0.97618353, 'f1': 0.9762299, 'auroc': 0.99749374, 'binary_precision': 0.97321427, 'binary_recall': 0.9800899, 'binary_specificity': 0.9722772, 'binary_f1_score': 0.97664}
confusion matrix:
      0     1
0  1473    42
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.79423225, 'precision': 0.79416233, 'recall': 0.7941237, 'specificity': 0.7941237, 'f1': 0.7941411, 'auroc': 0.85876566, 'binary_precision': 0.79106855, 'binary_recall': 0.78855324, 'binary_specificity': 0.7996942, 'binary_f1_score': 0.7898089}
confusion matrix:
     0    1
0  523  131
1  133  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.7680234, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.7636555, 'auroc': 0.86785185, 'binary_precision': 0.7370518, 'binary_recall': 0.82222223, 'binary_specificity': 0.70666665, 'binary_f1_score': 0.77731097}
confusion matrix:
     0    1
0  159   66
1   40  185
early stop counter: 1
val acc:0.7942322492599487, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 3,now: 2024-07-26 06:17:37.625885,epoch time: 0:01:01.988835,used: 0:03:09.174269,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.983413, 'recall': 0.9834931, 'specificity': 0.9834931, 'f1': 0.9833979, 'auroc': 0.9982394, 'binary_precision': 0.99086756, 'binary_recall': 0.9762211, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98348975}
confusion matrix:
      0     1
0  1502    14
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.8222915, 'precision': 0.8269218, 'recall': 0.8210997, 'specificity': 0.8210997, 'f1': 0.8212271, 'auroc': 0.885741, 'binary_precision': 0.86126125, 'binary_recall': 0.7599364, 'binary_specificity': 0.882263, 'binary_f1_score': 0.8074324}
confusion matrix:
     0    1
0  577   77
1  151  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7830273, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.7820673, 'auroc': 0.8618469, 'binary_precision': 0.79812205, 'binary_recall': 0.75555557, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.7762557}
confusion matrix:
     0    1
0  182   43
1   55  170
early stop counter: 2
val acc:0.8222914934158325, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 4,now: 2024-07-26 06:18:39.710656,epoch time: 0:01:02.084771,used: 0:04:11.259040,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.96918476, 'recall': 0.96844965, 'specificity': 0.96844965, 'f1': 0.96809244, 'auroc': 0.99665666, 'binary_precision': 0.99524456, 'binary_recall': 0.9415167, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9676354}
confusion matrix:
      0     1
0  1509     7
1    91  1465
---- Validation: 
scalar performance:
{'acc': 0.5946999, 'precision': 0.7577717, 'recall': 0.5867974, 'specificity': 0.5867974, 'f1': 0.50939214, 'auroc': 0.8849206, 'binary_precision': 0.9579832, 'binary_recall': 0.18124007, 'binary_specificity': 0.99235475, 'binary_f1_score': 0.30481285}
confusion matrix:
     0    1
0  649    5
1  515  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5733333, 'precision': 0.7697842, 'recall': 0.5733333, 'specificity': 0.5733333, 'f1': 0.47837427, 'auroc': 0.89538765, 'binary_precision': 1.0, 'binary_recall': 0.14666666, 'binary_specificity': 1.0, 'binary_f1_score': 0.25581396}
confusion matrix:
     0   1
0  225   0
1  192  33
early stop counter: 3
val acc:0.5946999192237854, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 5,now: 2024-07-26 06:19:42.022266,epoch time: 0:01:02.311610,used: 0:05:13.570650,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9776627, 'recall': 0.97703165, 'specificity': 0.97703165, 'f1': 0.9771973, 'auroc': 0.99810493, 'binary_precision': 0.9661654, 'binary_recall': 0.9897304, 'binary_specificity': 0.9643329, 'binary_f1_score': 0.977806}
confusion matrix:
      0     1
0  1460    54
1    16  1542
---- Validation: 
scalar performance:
{'acc': 0.81060016, 'precision': 0.8151342, 'recall': 0.80938876, 'specificity': 0.80938876, 'f1': 0.8094425, 'auroc': 0.8552919, 'binary_precision': 0.84837544, 'binary_recall': 0.74721783, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.79459006}
confusion matrix:
     0    1
0  570   84
1  159  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8009259, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.78675646, 'auroc': 0.8781629, 'binary_precision': 0.7407407, 'binary_recall': 0.8888889, 'binary_specificity': 0.6888889, 'binary_f1_score': 0.8080808}
confusion matrix:
     0    1
0  155   70
1   25  200
early stop counter: 4
val acc:0.8106001615524292, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 6,now: 2024-07-26 06:20:43.932211,epoch time: 0:01:01.909945,used: 0:06:15.480595,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98067, 'recall': 0.98067, 'specificity': 0.98067, 'f1': 0.98046875, 'auroc': 0.9984967, 'binary_precision': 0.994716, 'binary_recall': 0.9666239, 'binary_specificity': 0.994716, 'binary_f1_score': 0.98046875}
confusion matrix:
      0     1
0  1506     8
1    52  1506
---- Validation: 
scalar performance:
{'acc': 0.74512863, 'precision': 0.793594, 'recall': 0.74109674, 'specificity': 0.74109674, 'f1': 0.7319969, 'auroc': 0.86436164, 'binary_precision': 0.9081081, 'binary_recall': 0.53418124, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.6726727}
confusion matrix:
     0    1
0  620   34
1  293  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.7857946, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7681329, 'auroc': 0.85112095, 'binary_precision': 0.85057473, 'binary_recall': 0.6577778, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.74185467}
confusion matrix:
     0    1
0  199   26
1   77  148
early stop counter: 5
val acc:0.7451286315917969, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 7,now: 2024-07-26 06:21:45.958123,epoch time: 0:01:02.025912,used: 0:07:17.506507,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.99124956, 'recall': 0.99117815, 'specificity': 0.99117815, 'f1': 0.9912087, 'auroc': 0.9996774, 'binary_precision': 0.98913044, 'binary_recall': 0.9935774, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.9913489}
confusion matrix:
      0     1
0  1498    17
1    10  1547
---- Validation: 
scalar performance:
{'acc': 0.69602495, 'precision': 0.7611275, 'recall': 0.69104767, 'specificity': 0.69104767, 'f1': 0.67233205, 'auroc': 0.82796526, 'binary_precision': 0.8867314, 'binary_recall': 0.43561208, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.5842218}
confusion matrix:
     0    1
0  619   35
1  355  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.7832142, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.7740279, 'auroc': 0.8511013, 'binary_precision': 0.82978725, 'binary_recall': 0.6933333, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.7554479}
confusion matrix:
     0    1
0  193   32
1   69  156
early stop counter: 6
val acc:0.6960249543190002, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 8,now: 2024-07-26 06:22:47.816975,epoch time: 0:01:01.858852,used: 0:08:19.365359,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9760406, 'recall': 0.9755466, 'specificity': 0.9755466, 'f1': 0.9752574, 'auroc': 0.9989948, 'binary_precision': 0.9986514, 'binary_recall': 0.9524116, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9749836}
confusion matrix:
      0     1
0  1515     2
1    74  1481
---- Validation: 
scalar performance:
{'acc': 0.75214344, 'precision': 0.8074829, 'recall': 0.7479471, 'specificity': 0.7479471, 'f1': 0.73830837, 'auroc': 0.88952905, 'binary_precision': 0.9331476, 'binary_recall': 0.5325914, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.6781376}
confusion matrix:
     0    1
0  630   24
1  294  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7488889, 'precision': 0.8181818, 'recall': 0.74888885, 'specificity': 0.74888885, 'f1': 0.7344301, 'auroc': 0.86785185, 'binary_precision': 0.96666664, 'binary_recall': 0.51555556, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.6724638}
confusion matrix:
     0    1
0  221    4
1  109  116
early stop counter: 7
val acc:0.7521434426307678, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 9,now: 2024-07-26 06:23:49.760647,epoch time: 0:01:01.943672,used: 0:09:21.309031,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9814352, 'recall': 0.98058146, 'specificity': 0.98058146, 'f1': 0.98077816, 'auroc': 0.99942136, 'binary_precision': 0.9669576, 'binary_recall': 0.99614644, 'binary_specificity': 0.9650165, 'binary_f1_score': 0.98133504}
confusion matrix:
      0     1
0  1462    53
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.81060016, 'precision': 0.814535, 'recall': 0.8116677, 'specificity': 0.8116677, 'f1': 0.81031203, 'auroc': 0.8913765, 'binary_precision': 0.77414775, 'binary_recall': 0.86645466, 'binary_specificity': 0.75688076, 'binary_f1_score': 0.81770444}
confusion matrix:
     0    1
0  495  159
1   84  545
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.79749, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76592207, 'auroc': 0.8985086, 'binary_precision': 0.7089041, 'binary_recall': 0.92, 'binary_specificity': 0.62222224, 'binary_f1_score': 0.8007737}
confusion matrix:
     0    1
0  140   85
1   18  207
early stop counter: 8
val acc:0.8106001615524292, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 10,now: 2024-07-26 06:24:52.450769,epoch time: 0:01:02.690122,used: 0:10:23.999153,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886677, 'recall': 0.98872185, 'specificity': 0.98872185, 'f1': 0.9886067, 'auroc': 0.9992403, 'binary_precision': 0.99803406, 'binary_recall': 0.9794212, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98864007}
confusion matrix:
      0     1
0  1514     3
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.78409976, 'precision': 0.82259524, 'recall': 0.78069043, 'specificity': 0.78069043, 'f1': 0.775998, 'auroc': 0.90065295, 'binary_precision': 0.9292683, 'binary_recall': 0.6057234, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.7333975}
confusion matrix:
     0    1
0  625   29
1  248  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.83571213, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7785796, 'auroc': 0.8838519, 'binary_precision': 0.9640288, 'binary_recall': 0.59555554, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7362637}
confusion matrix:
     0    1
0  220    5
1   91  134
early stop counter: 9
val acc:0.7840997576713562, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 11,now: 2024-07-26 06:25:54.609361,epoch time: 0:01:02.158592,used: 0:11:26.157745,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899926, 'recall': 0.98985493, 'specificity': 0.98985493, 'f1': 0.9899061, 'auroc': 0.99962866, 'binary_precision': 0.98596936, 'binary_recall': 0.9942122, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.9900736}
confusion matrix:
      0     1
0  1495    22
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.8215121, 'precision': 0.82486534, 'recall': 0.8204871, 'specificity': 0.8204871, 'f1': 0.82066846, 'auroc': 0.8738569, 'binary_precision': 0.8533569, 'binary_recall': 0.7678855, 'binary_specificity': 0.87308866, 'binary_f1_score': 0.8083682}
confusion matrix:
     0    1
0  571   83
1  146  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.78812367, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7863966, 'auroc': 0.84835553, 'binary_precision': 0.80861247, 'binary_recall': 0.7511111, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.7788018}
confusion matrix:
     0    1
0  185   40
1   56  169
early stop counter: 10
val acc:0.8215121030807495, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 12,now: 2024-07-26 06:26:56.686414,epoch time: 0:01:02.077053,used: 0:12:28.234798,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889226, 'recall': 0.98893917, 'specificity': 0.98893917, 'f1': 0.98893046, 'auroc': 0.99935484, 'binary_precision': 0.9897106, 'binary_recall': 0.9884393, 'binary_specificity': 0.98943895, 'binary_f1_score': 0.9890746}
confusion matrix:
      0     1
0  1499    16
1    18  1539
---- Validation: 
scalar performance:
{'acc': 0.7778644, 'precision': 0.80488515, 'recall': 0.7749085, 'specificity': 0.7749085, 'f1': 0.77150744, 'auroc': 0.850726, 'binary_precision': 0.8909091, 'binary_recall': 0.62321144, 'binary_specificity': 0.9266055, 'binary_f1_score': 0.73339564}
confusion matrix:
     0    1
0  606   48
1  237  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5222222, 'precision': 0.54133594, 'recall': 0.5222222, 'specificity': 0.5222222, 'f1': 0.45977184, 'auroc': 0.6570667, 'binary_precision': 0.5694444, 'binary_recall': 0.18222222, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.27609426}
confusion matrix:
     0   1
0  194  31
1  184  41
early stop counter: 11
val acc:0.777864396572113, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 13,now: 2024-07-26 06:27:58.735036,epoch time: 0:01:02.048622,used: 0:13:30.283420,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883486, 'recall': 0.98842806, 'specificity': 0.98842806, 'f1': 0.9882811, 'auroc': 0.9995867, 'binary_precision': 0.9986894, 'binary_recall': 0.97817713, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9883269}
confusion matrix:
      0     1
0  1512     2
1    34  1524
---- Validation: 
scalar performance:
{'acc': 0.7248636, 'precision': 0.8079395, 'recall': 0.71973014, 'specificity': 0.71973014, 'f1': 0.70191324, 'auroc': 0.8761419, 'binary_precision': 0.96308726, 'binary_recall': 0.4562798, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.6192017}
confusion matrix:
     0    1
0  643   11
1  342  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7355555, 'precision': 0.8188503, 'recall': 0.7355555, 'specificity': 0.7355555, 'f1': 0.7170783, 'auroc': 0.89560497, 'binary_precision': 0.9818182, 'binary_recall': 0.48, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.6447761}
confusion matrix:
     0    1
0  223    2
1  117  108
early stop counter: 12
val acc:0.724863588809967, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 14,now: 2024-07-26 06:29:00.940804,epoch time: 0:01:02.205768,used: 0:14:32.489188,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99191785, 'recall': 0.9918183, 'specificity': 0.9918183, 'f1': 0.99185956, 'auroc': 0.99977314, 'binary_precision': 0.98915124, 'binary_recall': 0.99486524, 'binary_specificity': 0.98877144, 'binary_f1_score': 0.99200004}
confusion matrix:
      0     1
0  1497    17
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.8152767, 'precision': 0.8361721, 'recall': 0.8128212, 'specificity': 0.8128212, 'f1': 0.81148326, 'auroc': 0.8782325, 'binary_precision': 0.91525424, 'binary_recall': 0.6868045, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.7847412}
confusion matrix:
     0    1
0  614   40
1  197  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74666667, 'precision': 0.81703013, 'recall': 0.74666667, 'specificity': 0.74666667, 'f1': 0.73178434, 'auroc': 0.90095806, 'binary_precision': 0.96638656, 'binary_recall': 0.51111114, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.6686047}
confusion matrix:
     0    1
0  221    4
1  110  115
early stop counter: 13
val acc:0.8152766823768616, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 15,now: 2024-07-26 06:30:03.197825,epoch time: 0:01:02.257021,used: 0:15:34.746209,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9924971, 'recall': 0.99257535, 'specificity': 0.99257535, 'f1': 0.9925126, 'auroc': 0.9999249, 'binary_precision': 0.9974043, 'binary_recall': 0.9877892, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9925735}
confusion matrix:
      0     1
0  1512     4
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.6952455, 'precision': 0.798149, 'recall': 0.68943226, 'specificity': 0.68943226, 'f1': 0.6624341, 'auroc': 0.8673396, 'binary_precision': 0.96850395, 'binary_recall': 0.39109698, 'binary_specificity': 0.9877676, 'binary_f1_score': 0.5571914}
confusion matrix:
     0    1
0  646    8
1  383  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.80058295, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.666416, 'auroc': 0.9000493, 'binary_precision': 0.9782609, 'binary_recall': 0.4, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.56782335}
confusion matrix:
     0   1
0  223   2
1  135  90
early stop counter: 14
val acc:0.6952455043792725, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 16,now: 2024-07-26 06:31:05.004393,epoch time: 0:01:01.806568,used: 0:16:36.552777,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99379635, 'recall': 0.9938371, 'specificity': 0.9938371, 'f1': 0.9938141, 'auroc': 0.9996787, 'binary_precision': 0.9954926, 'binary_recall': 0.9922978, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9938926}
confusion matrix:
      0     1
0  1507     7
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.8144973, 'precision': 0.83676577, 'recall': 0.81196547, 'specificity': 0.81196547, 'f1': 0.81047094, 'auroc': 0.87950146, 'binary_precision': 0.9186295, 'binary_recall': 0.68203497, 'binary_specificity': 0.941896, 'binary_f1_score': 0.7828467}
confusion matrix:
     0    1
0  616   38
1  200  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8423997, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.8118682, 'auroc': 0.8988247, 'binary_precision': 0.9382716, 'binary_recall': 0.6755555, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.78552973}
confusion matrix:
     0    1
0  215   10
1   73  152
early stop counter: 15
val acc:0.8144972920417786, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 17,now: 2024-07-26 06:32:07.043182,epoch time: 0:01:02.038789,used: 0:17:38.591566,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.989106, 'recall': 0.9888323, 'specificity': 0.9888323, 'f1': 0.9889272, 'auroc': 0.9996346, 'binary_precision': 0.98290056, 'binary_recall': 0.9955099, 'binary_specificity': 0.98215467, 'binary_f1_score': 0.98916507}
confusion matrix:
      0     1
0  1486    27
1     7  1552
---- Validation: 
scalar performance:
{'acc': 0.7349961, 'precision': 0.77354026, 'recall': 0.7312491, 'specificity': 0.7312491, 'f1': 0.72318673, 'auroc': 0.84038305, 'binary_precision': 0.8714653, 'binary_recall': 0.53895074, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.6660118}
confusion matrix:
     0    1
0  604   50
1  290  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8343927, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.781454, 'auroc': 0.9084445, 'binary_precision': 0.9577465, 'binary_recall': 0.60444444, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7411444}
confusion matrix:
     0    1
0  219    6
1   89  136
early stop counter: 16
val acc:0.7349960803985596, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 18,now: 2024-07-26 06:33:08.830545,epoch time: 0:01:01.787363,used: 0:18:40.378929,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898896, 'recall': 0.9899737, 'specificity': 0.9899737, 'f1': 0.9899081, 'auroc': 0.9993844, 'binary_precision': 0.99481195, 'binary_recall': 0.985228, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9899968}
confusion matrix:
      0     1
0  1507     8
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.8051442, 'precision': 0.83412075, 'recall': 0.8022442, 'specificity': 0.8022442, 'f1': 0.79972756, 'auroc': 0.8949913, 'binary_precision': 0.92776525, 'binary_recall': 0.6534181, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.76679105}
confusion matrix:
     0    1
0  622   32
1  218  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8359264, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.78922284, 'auroc': 0.89645433, 'binary_precision': 0.95238096, 'binary_recall': 0.62222224, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.75268817}
confusion matrix:
     0    1
0  218    7
1   85  140
early stop counter: 17
val acc:0.805144190788269, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 19,now: 2024-07-26 06:34:11.753032,epoch time: 0:01:02.922487,used: 0:19:43.301416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.9856634, 'recall': 0.98574245, 'specificity': 0.98574245, 'f1': 0.9856762, 'auroc': 0.99931496, 'binary_precision': 0.9909091, 'binary_recall': 0.9807198, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98578817}
confusion matrix:
      0     1
0  1502    14
1    30  1526
---- Validation: 
scalar performance:
{'acc': 0.7388932, 'precision': 0.7985936, 'recall': 0.73446393, 'specificity': 0.73446393, 'f1': 0.7227045, 'auroc': 0.8759134, 'binary_precision': 0.9273256, 'binary_recall': 0.5071542, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.655704}
confusion matrix:
     0    1
0  629   25
1  310  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.7912352, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.6987841, 'auroc': 0.8699852, 'binary_precision': 0.9375, 'binary_recall': 0.46666667, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.6231454}
confusion matrix:
     0    1
0  218    7
1  120  105
early stop counter: 18
val acc:0.7388932108879089, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 20,now: 2024-07-26 06:35:14.278838,epoch time: 0:01:02.525806,used: 0:20:45.827222,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941202, 'recall': 0.99421406, 'specificity': 0.99421406, 'f1': 0.99414015, 'auroc': 0.99987155, 'binary_precision': 0.9993515, 'binary_recall': 0.9890886, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9941936}
confusion matrix:
      0     1
0  1513     1
1    17  1541
---- Validation: 
scalar performance:
{'acc': 0.8028059, 'precision': 0.83466995, 'recall': 0.7997683, 'specificity': 0.7997683, 'f1': 0.7968322, 'auroc': 0.90741575, 'binary_precision': 0.93317974, 'binary_recall': 0.6438792, 'binary_specificity': 0.9556575, 'binary_f1_score': 0.76199436}
confusion matrix:
     0    1
0  625   29
1  224  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.8257436, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.75834435, 'auroc': 0.9160099, 'binary_precision': 0.96183205, 'binary_recall': 0.56, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7078652}
confusion matrix:
     0    1
0  220    5
1   99  126
early stop counter: 19
val acc:0.8028059005737305, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 21,now: 2024-07-26 06:36:16.519751,epoch time: 0:01:02.240913,used: 0:21:48.068135,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941199, 'recall': 0.9941735, 'specificity': 0.9941735, 'f1': 0.99413997, 'auroc': 0.999897, 'binary_precision': 0.99677, 'binary_recall': 0.9916452, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.994201}
confusion matrix:
      0     1
0  1511     5
1    13  1543
---- Validation: 
scalar performance:
{'acc': 0.74279034, 'precision': 0.8121093, 'recall': 0.7381346, 'specificity': 0.7381346, 'f1': 0.7251542, 'auroc': 0.88349485, 'binary_precision': 0.9544073, 'binary_recall': 0.49920508, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.65553236}
confusion matrix:
     0    1
0  639   15
1  315  314
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.83300173, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7599578, 'auroc': 0.9141136, 'binary_precision': 0.9765625, 'binary_recall': 0.5555556, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.70821536}
confusion matrix:
     0    1
0  222    3
1  100  125
early stop counter: 20
val acc:0.7427903413772583, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 22,now: 2024-07-26 06:37:18.637235,epoch time: 0:01:02.117484,used: 0:22:50.185619,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.989943, 'recall': 0.9900272, 'specificity': 0.9900272, 'f1': 0.9899086, 'auroc': 0.99928653, 'binary_precision': 0.9986928, 'binary_recall': 0.98137444, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98995787}
confusion matrix:
      0     1
0  1513     2
1    29  1528
---- Validation: 
scalar performance:
{'acc': 0.6827747, 'precision': 0.78865683, 'recall': 0.67677444, 'specificity': 0.67677444, 'f1': 0.6463015, 'auroc': 0.9022318, 'binary_precision': 0.9586777, 'binary_recall': 0.3688394, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.532721}
confusion matrix:
     0    1
0  644   10
1  397  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.73895496, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.4280524, 'auroc': 0.900879, 'binary_precision': 0.95454544, 'binary_recall': 0.093333334, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.17004049}
confusion matrix:
     0   1
0  224   1
1  204  21
early stop counter: 21
val acc:0.6827747225761414, best validation acc: 0.8293063044548035, corresponding to test acc:                         0.8088889122009277 / 0.8177777528762817
after epoch: 23,now: 2024-07-26 06:38:21.109996,epoch time: 0:01:02.472761,used: 0:23:52.658380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9907713, 'recall': 0.99045074, 'specificity': 0.99045074, 'f1': 0.9905554, 'auroc': 0.9998317, 'binary_precision': 0.9835547, 'binary_recall': 0.9980745, 'binary_specificity': 0.98282695, 'binary_f1_score': 0.9907614}
confusion matrix:
      0     1
0  1488    26
1     3  1555
---- Validation: 
scalar performance:
{'acc': 0.8386594, 'precision': 0.85232043, 'recall': 0.8367293, 'specificity': 0.8367293, 'f1': 0.8364835, 'auroc': 0.8898815, 'binary_precision': 0.91699606, 'binary_recall': 0.7376788, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.8176211}
confusion matrix:
     0    1
0  612   42
1  165  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8466667, 'precision': 0.8585731, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84538317, 'auroc': 0.9228444, 'binary_precision': 0.92391306, 'binary_recall': 0.75555557, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83129585}
confusion matrix:
     0    1
0  211   14
1   55  170
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-26 06:39:23.592396,epoch time: 0:01:02.482400,used: 0:24:55.140780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99315196, 'recall': 0.99325126, 'specificity': 0.99325126, 'f1': 0.99316365, 'auroc': 0.9999207, 'binary_precision': 0.99935025, 'binary_recall': 0.987163, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.99321926}
confusion matrix:
      0     1
0  1513     1
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.6780982, 'precision': 0.79200006, 'recall': 0.6719138, 'specificity': 0.6719138, 'f1': 0.6386317, 'auroc': 0.8969543, 'binary_precision': 0.9695652, 'binary_recall': 0.354531, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.5192084}
confusion matrix:
     0    1
0  647    7
1  406  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5888889, 'precision': 0.7626051, 'recall': 0.5888889, 'specificity': 0.5888889, 'f1': 0.5074285, 'auroc': 0.90012836, 'binary_precision': 0.97619045, 'binary_recall': 0.18222222, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.3071161}
confusion matrix:
     0   1
0  224   1
1  184  41
early stop counter: 1
val acc:0.678098201751709, best validation acc: 0.838659405708313, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 25,now: 2024-07-26 06:40:25.880869,epoch time: 0:01:02.288473,used: 0:25:57.429253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99346906, 'recall': 0.99353933, 'specificity': 0.99353933, 'f1': 0.993489, 'auroc': 0.9995595, 'binary_precision': 0.99740934, 'binary_recall': 0.98971725, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9935484}
confusion matrix:
      0     1
0  1512     4
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.71551055, 'precision': 0.80177975, 'recall': 0.7102215, 'specificity': 0.7102215, 'f1': 0.69030833, 'auroc': 0.8964292, 'binary_precision': 0.9583333, 'binary_recall': 0.43879172, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.6019629}
confusion matrix:
     0    1
0  642   12
1  353  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.8323328, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.76554155, 'auroc': 0.87577283, 'binary_precision': 0.969697, 'binary_recall': 0.5688889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.71708685}
confusion matrix:
     0    1
0  221    4
1   97  128
early stop counter: 2
val acc:0.7155105471611023, best validation acc: 0.838659405708313, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 26,now: 2024-07-26 06:41:27.802411,epoch time: 0:01:01.921542,used: 0:26:59.350795,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928372, 'recall': 0.9928372, 'specificity': 0.9928372, 'f1': 0.9928372, 'auroc': 0.9995464, 'binary_precision': 0.9929351, 'binary_recall': 0.9929351, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9929351}
confusion matrix:
      0     1
0  1504    11
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.8215121, 'precision': 0.8390738, 'recall': 0.8192717, 'specificity': 0.8192717, 'f1': 0.81839836, 'auroc': 0.8921277, 'binary_precision': 0.9115226, 'binary_recall': 0.70429254, 'binary_specificity': 0.9342508, 'binary_f1_score': 0.7946188}
confusion matrix:
     0    1
0  611   43
1  186  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8236171, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80668944, 'auroc': 0.8960395, 'binary_precision': 0.8926554, 'binary_recall': 0.7022222, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.78606963}
confusion matrix:
     0    1
0  206   19
1   67  158
early stop counter: 3
val acc:0.8215121030807495, best validation acc: 0.838659405708313, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 27,now: 2024-07-26 06:42:29.994363,epoch time: 0:01:02.191952,used: 0:28:01.542747,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98900163, 'recall': 0.9890514, 'specificity': 0.9890514, 'f1': 0.98893225, 'auroc': 0.999532, 'binary_precision': 0.9986885, 'binary_recall': 0.9794212, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98896104}
confusion matrix:
      0     1
0  1515     2
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.5845674, 'precision': 0.7655706, 'recall': 0.5763724, 'specificity': 0.5763724, 'f1': 0.48935723, 'auroc': 0.8517051, 'binary_precision': 0.98, 'binary_recall': 0.15580286, 'binary_specificity': 0.9969419, 'binary_f1_score': 0.26886144}
confusion matrix:
     0   1
0  652   2
1  531  98
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33724332, 'auroc': 0.8617481, 'binary_precision': 0.5, 'binary_recall': 0.0044444446, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.008810573}
confusion matrix:
     0  1
0  224  1
1  224  1
early stop counter: 4
val acc:0.5845674276351929, best validation acc: 0.838659405708313, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 28,now: 2024-07-26 06:43:32.024571,epoch time: 0:01:02.030208,used: 0:29:03.572955,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98778135, 'recall': 0.98778135, 'specificity': 0.98778135, 'f1': 0.9876302, 'auroc': 0.9998987, 'binary_precision': 1.0, 'binary_recall': 0.9755627, 'binary_specificity': 1.0, 'binary_f1_score': 0.9876302}
confusion matrix:
      0     1
0  1517     0
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.62275916, 'precision': 0.768636, 'recall': 0.61544466, 'specificity': 0.61544466, 'f1': 0.5561569, 'auroc': 0.87366354, 'binary_precision': 0.96178347, 'binary_recall': 0.2400636, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.38422394}
confusion matrix:
     0    1
0  648    6
1  478  151
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63555557, 'precision': 0.78146917, 'recall': 0.63555557, 'specificity': 0.63555557, 'f1': 0.58129084, 'auroc': 0.89827156, 'binary_precision': 0.984127, 'binary_recall': 0.27555555, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.43055552}
confusion matrix:
     0   1
0  224   1
1  163  62
early stop counter: 5
val acc:0.6227591633796692, best validation acc: 0.838659405708313, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 29,now: 2024-07-26 06:44:34.154534,epoch time: 0:01:02.129963,used: 0:30:05.702918,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921665, 'recall': 0.99224836, 'specificity': 0.99224836, 'f1': 0.99218684, 'auroc': 0.99976385, 'binary_precision': 0.99675953, 'binary_recall': 0.987797, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.992258}
confusion matrix:
      0     1
0  1510     5
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.6126267, 'precision': 0.7463654, 'recall': 0.6052931, 'specificity': 0.6052931, 'f1': 0.5439111, 'auroc': 0.8464069, 'binary_precision': 0.9230769, 'binary_recall': 0.22893482, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.366879}
confusion matrix:
     0    1
0  642   12
1  485  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6844444, 'precision': 0.800967, 'recall': 0.6844444, 'specificity': 0.6844444, 'f1': 0.6506288, 'auroc': 0.91804445, 'binary_precision': 0.9882353, 'binary_recall': 0.37333333, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.5419355}
confusion matrix:
     0   1
0  224   1
1  141  84
early stop counter: 6
val acc:0.6126266717910767, best validation acc: 0.838659405708313, corresponding to test acc:                         0.846666693687439 / 0.846666693687439
after epoch: 30,now: 2024-07-26 06:45:36.673245,epoch time: 0:01:02.518711,used: 0:31:08.221629,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_14_28_seed_3_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:08.221629 at 2024-07-26 06:45:36.673245
persisted model performance metric: 

scalar performance:
{'acc': 0.8466667, 'precision': 0.8585731, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84538317, 'auroc': 0.9228444, 'binary_precision': 0.92391306, 'binary_recall': 0.75555557, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83129585}
confusion matrix:
     0    1
0  211   14
1   55  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8466667, 'precision': 0.8585731, 'recall': 0.8466667, 'specificity': 0.8466667, 'f1': 0.84538317, 'auroc': 0.9228444, 'binary_precision': 0.92391306, 'binary_recall': 0.75555557, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83129585}
confusion matrix:
     0    1
0  211   14
1   55  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 296394 GiB | 296394 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 292899 GiB | 292899 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 296394 GiB | 296394 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 292899 GiB | 292899 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 295765 GiB | 295764 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 292277 GiB | 292277 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14480 MiB |  55268 MiB |  40790 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  55148 MiB |  40740 MiB |
|       from small pool |     70 MiB |     70 MiB |    120 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 211345 GiB | 211345 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 207829 GiB | 207829 GiB |
|       from small pool |  10601 KiB |     44 MiB |   3515 GiB |   3515 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51929 K  |   51927 K  |
|       from large pool |     187    |    1413    |   26431 K  |   26430 K  |
|       from small pool |    1123    |    1419    |   25498 K  |   25496 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51929 K  |   51927 K  |
|       from large pool |     187    |    1413    |   26431 K  |   26430 K  |
|       from small pool |    1123    |    1419    |   25498 K  |   25496 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    2353    |    1717    |
|       from large pool |     601    |     601    |    2293    |    1692    |
|       from small pool |      35    |      35    |      60    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     103    |     651    |   33710 K  |   33710 K  |
|       from large pool |      40    |     604    |   18855 K  |   18855 K  |
|       from small pool |      63    |     236    |   14854 K  |   14854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 296394 GiB | 296394 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292899 GiB | 292899 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 296394 GiB | 296394 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292899 GiB | 292899 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295765 GiB | 295765 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 292277 GiB | 292277 GiB |
|       from small pool |      0 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  55268 MiB |  54388 MiB |
|       from large pool |    830 MiB |  14414 MiB |  55148 MiB |  54318 MiB |
|       from small pool |     50 MiB |     70 MiB |    120 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 211345 GiB | 211345 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 207829 GiB | 207829 GiB |
|       from small pool |      0 KiB |     44 MiB |   3515 GiB |   3515 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51929 K  |   51929 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25498 K  |   25498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51929 K  |   51929 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25498 K  |   25498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    2353    |    2291    |
|       from large pool |      37    |     601    |    2293    |    2256    |
|       from small pool |      25    |      35    |      60    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   33710 K  |   33710 K  |
|       from large pool |       4    |     604    |   18855 K  |   18855 K  |
|       from small pool |       0    |     236    |   14855 K  |   14855 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 296394 GiB | 296394 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292899 GiB | 292899 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 296394 GiB | 296394 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292899 GiB | 292899 GiB |
|       from small pool |      0 KiB |     60 MiB |   3494 GiB |   3494 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295765 GiB | 295765 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 292277 GiB | 292277 GiB |
|       from small pool |      0 KiB |     60 MiB |   3487 GiB |   3487 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  55268 MiB |  54388 MiB |
|       from large pool |    830 MiB |  14414 MiB |  55148 MiB |  54318 MiB |
|       from small pool |     50 MiB |     70 MiB |    120 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 211345 GiB | 211345 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 207829 GiB | 207829 GiB |
|       from small pool |      0 KiB |     44 MiB |   3515 GiB |   3515 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51929 K  |   51929 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25498 K  |   25498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51929 K  |   51929 K  |
|       from large pool |       2    |    1413    |   26431 K  |   26431 K  |
|       from small pool |       0    |    1419    |   25498 K  |   25498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    2353    |    2291    |
|       from large pool |      37    |     601    |    2293    |    2256    |
|       from small pool |      25    |      35    |      60    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   33710 K  |   33710 K  |
|       from large pool |       4    |     604    |   18855 K  |   18855 K  |
|       from small pool |       0    |     236    |   14855 K  |   14855 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536

 Experiment start at: 2024-07-26 06:46:07.675634
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9478627, 'precision': 0.94789004, 'recall': 0.94804513, 'specificity': 0.94804513, 'f1': 0.9478593, 'auroc': 0.98717177, 'binary_precision': 0.95844156, 'binary_recall': 0.9383344, 'binary_specificity': 0.9577558, 'binary_f1_score': 0.9482814}
confusion matrix:
      0     1
0  1451    64
1    97  1476
---- Validation: 
scalar performance:
{'acc': 0.7822014, 'precision': 0.79274297, 'recall': 0.7834375, 'specificity': 0.7834375, 'f1': 0.7806998, 'auroc': 0.865126, 'binary_precision': 0.73377484, 'binary_recall': 0.87658226, 'binary_specificity': 0.6902928, 'binary_f1_score': 0.7988464}
confusion matrix:
     0    1
0  448  201
1   78  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.8416626, 'recall': 0.82938385, 'specificity': 0.82938385, 'f1': 0.8278371, 'auroc': 0.9097055, 'binary_precision': 0.7768924, 'binary_recall': 0.9241706, 'binary_specificity': 0.73459715, 'binary_f1_score': 0.84415585}
confusion matrix:
     0    1
0  155   56
1   16  195
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 06:47:11.984853,epoch time: 0:01:04.309219,used: 0:01:04.309219,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.92551816, 'precision': 0.9341352, 'recall': 0.9268448, 'specificity': 0.9268448, 'f1': 0.9252809, 'auroc': 0.9915924, 'binary_precision': 1.0, 'binary_recall': 0.85368955, 'binary_specificity': 1.0, 'binary_f1_score': 0.9210707}
confusion matrix:
      0     1
0  1516     0
1   230  1342
---- Validation: 
scalar performance:
{'acc': 0.67447305, 'precision': 0.7201257, 'recall': 0.6713798, 'specificity': 0.6713798, 'f1': 0.65422326, 'auroc': 0.8216413, 'binary_precision': 0.81710917, 'binary_recall': 0.43829113, 'binary_specificity': 0.9044684, 'binary_f1_score': 0.57054585}
confusion matrix:
     0    1
0  587   62
1  355  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8270142, 'precision': 0.83984596, 'recall': 0.8270142, 'specificity': 0.8270142, 'f1': 0.8253658, 'auroc': 0.91635406, 'binary_precision': 0.90588236, 'binary_recall': 0.7298578, 'binary_specificity': 0.9241706, 'binary_f1_score': 0.8083989}
confusion matrix:
     0    1
0  195   16
1   57  154
early stop counter: 1
val acc:0.6744730472564697, best validation acc: 0.7822014093399048, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 2,now: 2024-07-26 06:48:13.002593,epoch time: 0:01:01.017740,used: 0:02:05.326959,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96243525, 'precision': 0.96257216, 'recall': 0.96265364, 'specificity': 0.96265364, 'f1': 0.9624349, 'auroc': 0.9927033, 'binary_precision': 0.9757853, 'binary_recall': 0.9496815, 'binary_specificity': 0.9756258, 'binary_f1_score': 0.9625565}
confusion matrix:
      0     1
0  1481    37
1    79  1491
---- Validation: 
scalar performance:
{'acc': 0.7915691, 'precision': 0.7931608, 'recall': 0.7920401, 'specificity': 0.7920401, 'f1': 0.79143894, 'auroc': 0.8821337, 'binary_precision': 0.76798826, 'binary_recall': 0.82753164, 'binary_specificity': 0.7565485, 'binary_f1_score': 0.7966489}
confusion matrix:
     0    1
0  491  158
1  109  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8483412, 'precision': 0.84947157, 'recall': 0.8483412, 'specificity': 0.8483412, 'f1': 0.84821844, 'auroc': 0.92172235, 'binary_precision': 0.8295964, 'binary_recall': 0.87677723, 'binary_specificity': 0.8199052, 'binary_f1_score': 0.8525345}
confusion matrix:
     0    1
0  173   38
1   26  185
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 06:49:14.488732,epoch time: 0:01:01.486139,used: 0:03:06.813098,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9724741, 'precision': 0.9729917, 'recall': 0.972872, 'specificity': 0.972872, 'f1': 0.97247386, 'auroc': 0.99717677, 'binary_precision': 0.9940239, 'binary_recall': 0.95168465, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.97239363}
confusion matrix:
      0     1
0  1506     9
1    76  1497
---- Validation: 
scalar performance:
{'acc': 0.6487119, 'precision': 0.75019217, 'recall': 0.64442253, 'specificity': 0.64442253, 'f1': 0.60526204, 'auroc': 0.86210287, 'binary_precision': 0.90625, 'binary_recall': 0.32120255, 'binary_specificity': 0.96764255, 'binary_f1_score': 0.47429907}
confusion matrix:
     0    1
0  628   21
1  429  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7227488, 'precision': 0.81687754, 'recall': 0.7227488, 'specificity': 0.7227488, 'f1': 0.7005077, 'auroc': 0.92064416, 'binary_precision': 0.9895833, 'binary_recall': 0.45023698, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.6188925}
confusion matrix:
     0   1
0  210   1
1  116  95
early stop counter: 1
val acc:0.6487119197845459, best validation acc: 0.7915691137313843, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 4,now: 2024-07-26 06:50:15.484237,epoch time: 0:01:00.995505,used: 0:04:07.808603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9737694, 'precision': 0.97413087, 'recall': 0.9741192, 'specificity': 0.9741192, 'f1': 0.9737694, 'auroc': 0.99754643, 'binary_precision': 0.9927345, 'binary_recall': 0.95549905, 'binary_specificity': 0.99273926, 'binary_f1_score': 0.9737609}
confusion matrix:
      0     1
0  1504    11
1    70  1503
---- Validation: 
scalar performance:
{'acc': 0.735363, 'precision': 0.80767787, 'recall': 0.7321147, 'specificity': 0.7321147, 'f1': 0.717037, 'auroc': 0.90325546, 'binary_precision': 0.95356035, 'binary_recall': 0.48734176, 'binary_specificity': 0.9768875, 'binary_f1_score': 0.64502615}
confusion matrix:
     0    1
0  634   15
1  324  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75592417, 'precision': 0.831993, 'recall': 0.75592417, 'specificity': 0.75592417, 'f1': 0.7410935, 'auroc': 0.9285281, 'binary_precision': 0.9909091, 'binary_recall': 0.5165877, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.6791277}
confusion matrix:
     0    1
0  210    1
1  102  109
early stop counter: 2
val acc:0.7353630065917969, best validation acc: 0.7915691137313843, corresponding to test acc:                         0.8483412265777588 / 0.8483412265777588
after epoch: 5,now: 2024-07-26 06:51:17.002963,epoch time: 0:01:01.518726,used: 0:05:09.327329,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9724741, 'precision': 0.9735465, 'recall': 0.97207975, 'specificity': 0.97207975, 'f1': 0.9724318, 'auroc': 0.9988607, 'binary_precision': 0.9553517, 'binary_recall': 0.9923761, 'binary_specificity': 0.95178336, 'binary_f1_score': 0.973512}
confusion matrix:
      0     1
0  1441    73
1    12  1562
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.80871606, 'recall': 0.808281, 'specificity': 0.808281, 'f1': 0.8079287, 'auroc': 0.8853811, 'binary_precision': 0.7897898, 'binary_recall': 0.8322785, 'binary_specificity': 0.7842835, 'binary_f1_score': 0.8104776}
confusion matrix:
     0    1
0  509  140
1  106  526
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.8389844, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.8388481, 'auroc': 0.9166012, 'binary_precision': 0.84541065, 'binary_recall': 0.8293839, 'binary_specificity': 0.8483412, 'binary_f1_score': 0.83732057}
confusion matrix:
     0    1
0  179   32
1   36  175
better model found
persisted
after epoch: 6,now: 2024-07-26 06:52:18.234261,epoch time: 0:01:01.231298,used: 0:06:10.558627,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9802461, 'precision': 0.98050714, 'recall': 0.9806069, 'specificity': 0.9806069, 'f1': 0.98024595, 'auroc': 0.99900126, 'binary_precision': 0.9980276, 'binary_recall': 0.96319795, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9803035}
confusion matrix:
      0     1
0  1509     3
1    58  1518
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.82899237, 'recall': 0.80545896, 'specificity': 0.80545896, 'f1': 0.8032981, 'auroc': 0.9112461, 'binary_precision': 0.9104478, 'binary_recall': 0.6756329, 'binary_specificity': 0.93528503, 'binary_f1_score': 0.7756585}
confusion matrix:
     0    1
0  607   42
1  205  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8459716, 'precision': 0.85954714, 'recall': 0.8459716, 'specificity': 0.8459716, 'f1': 0.8445038, 'auroc': 0.91583747, 'binary_precision': 0.92941177, 'binary_recall': 0.7488152, 'binary_specificity': 0.943128, 'binary_f1_score': 0.82939637}
confusion matrix:
     0    1
0  199   12
1   53  158
early stop counter: 1
val acc:0.8071818947792053, best validation acc: 0.8079625368118286, corresponding to test acc:                         0.8388625383377075 / 0.8483412265777588
after epoch: 7,now: 2024-07-26 06:53:19.341401,epoch time: 0:01:01.107140,used: 0:07:11.665767,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9773316, 'precision': 0.9778737, 'recall': 0.97773737, 'specificity': 0.97773737, 'f1': 0.9773314, 'auroc': 0.99919724, 'binary_precision': 0.9993355, 'binary_recall': 0.9561348, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.97725797}
confusion matrix:
      0     1
0  1514     1
1    69  1504
---- Validation: 
scalar performance:
{'acc': 0.64949256, 'precision': 0.7761102, 'recall': 0.64494425, 'specificity': 0.64494425, 'f1': 0.60014975, 'auroc': 0.9019036, 'binary_precision': 0.959799, 'binary_recall': 0.3022152, 'binary_specificity': 0.98767334, 'binary_f1_score': 0.4596871}
confusion matrix:
     0    1
0  641    8
1  441  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255924, 'precision': 0.78590786, 'recall': 0.6255924, 'specificity': 0.6255924, 'f1': 0.56455064, 'auroc': 0.91235596, 'binary_precision': 1.0, 'binary_recall': 0.25118482, 'binary_specificity': 1.0, 'binary_f1_score': 0.40151513}
confusion matrix:
     0   1
0  211   0
1  158  53
early stop counter: 2
val acc:0.6494925618171692, best validation acc: 0.8079625368118286, corresponding to test acc:                         0.8388625383377075 / 0.8483412265777588
after epoch: 8,now: 2024-07-26 06:54:20.362239,epoch time: 0:01:01.020838,used: 0:08:12.686605,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9779793, 'precision': 0.97803754, 'recall': 0.9782462, 'specificity': 0.9782462, 'f1': 0.97797775, 'auroc': 0.9968021, 'binary_precision': 0.99089134, 'binary_recall': 0.9657578, 'binary_specificity': 0.99073464, 'binary_f1_score': 0.9781632}
confusion matrix:
      0     1
0  1497    14
1    54  1523
---- Validation: 
scalar performance:
{'acc': 0.8126464, 'precision': 0.8159897, 'recall': 0.81331795, 'specificity': 0.81331795, 'f1': 0.81234896, 'auroc': 0.8979388, 'binary_precision': 0.78, 'binary_recall': 0.863924, 'binary_specificity': 0.7627119, 'binary_f1_score': 0.8198198}
confusion matrix:
     0    1
0  495  154
1   86  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8080569, 'precision': 0.81113887, 'recall': 0.8080569, 'specificity': 0.8080569, 'f1': 0.8075804, 'auroc': 0.8858292, 'binary_precision': 0.7801724, 'binary_recall': 0.8578199, 'binary_specificity': 0.75829387, 'binary_f1_score': 0.8171558}
confusion matrix:
     0    1
0  160   51
1   30  181
better model found
persisted
after epoch: 9,now: 2024-07-26 06:55:21.542053,epoch time: 0:01:01.179814,used: 0:09:13.866419,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9724741, 'precision': 0.9731831, 'recall': 0.9728497, 'specificity': 0.9728497, 'f1': 0.97247255, 'auroc': 0.9968048, 'binary_precision': 0.9959893, 'binary_recall': 0.94964945, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.97226757}
confusion matrix:
      0     1
0  1513     6
1    79  1490
---- Validation: 
scalar performance:
{'acc': 0.61514443, 'precision': 0.7560351, 'recall': 0.61015487, 'specificity': 0.61015487, 'f1': 0.54854935, 'auroc': 0.86224544, 'binary_precision': 0.9426752, 'binary_recall': 0.23417722, 'binary_specificity': 0.9861325, 'binary_f1_score': 0.37515843}
confusion matrix:
     0    1
0  640    9
1  484  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70616114, 'precision': 0.804721, 'recall': 0.70616114, 'specificity': 0.70616114, 'f1': 0.68031085, 'auroc': 0.8934436, 'binary_precision': 0.978022, 'binary_recall': 0.42180094, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.589404}
confusion matrix:
     0   1
0  209   2
1  122  89
early stop counter: 1
val acc:0.6151444315910339, best validation acc: 0.8126463890075684, corresponding to test acc:                         0.8080568909645081 / 0.8483412265777588
after epoch: 10,now: 2024-07-26 06:56:23.130222,epoch time: 0:01:01.588169,used: 0:10:15.454588,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9873705, 'precision': 0.9873297, 'recall': 0.98743093, 'specificity': 0.98743093, 'f1': 0.9873678, 'auroc': 0.9993282, 'binary_precision': 0.9910314, 'binary_recall': 0.9840967, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98755187}
confusion matrix:
      0     1
0  1502    14
1    25  1547
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.833444, 'recall': 0.8036902, 'specificity': 0.8036902, 'f1': 0.8007641, 'auroc': 0.912804, 'binary_precision': 0.92650336, 'binary_recall': 0.65822786, 'binary_specificity': 0.9491525, 'binary_f1_score': 0.7696578}
confusion matrix:
     0    1
0  616   33
1  216  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.8645403, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.8359741, 'auroc': 0.91734236, 'binary_precision': 0.9612903, 'binary_recall': 0.70616114, 'binary_specificity': 0.971564, 'binary_f1_score': 0.8142077}
confusion matrix:
     0    1
0  205    6
1   62  149
early stop counter: 2
val acc:0.8056206107139587, best validation acc: 0.8126463890075684, corresponding to test acc:                         0.8080568909645081 / 0.8483412265777588
after epoch: 11,now: 2024-07-26 06:57:24.575076,epoch time: 0:01:01.444854,used: 0:11:16.899442,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97830313, 'precision': 0.9788109, 'recall': 0.9787166, 'specificity': 0.9787166, 'f1': 0.97830296, 'auroc': 0.999496, 'binary_precision': 1.0, 'binary_recall': 0.9574333, 'binary_specificity': 1.0, 'binary_f1_score': 0.97825384}
confusion matrix:
      0     1
0  1514     0
1    67  1507
---- Validation: 
scalar performance:
{'acc': 0.6533958, 'precision': 0.784696, 'recall': 0.6488378, 'specificity': 0.6488378, 'f1': 0.6043546, 'auroc': 0.90466166, 'binary_precision': 0.9747475, 'binary_recall': 0.30537975, 'binary_specificity': 0.99229586, 'binary_f1_score': 0.4650602}
confusion matrix:
     0    1
0  644    5
1  439  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556872, 'precision': 0.7459207, 'recall': 0.556872, 'specificity': 0.556872, 'f1': 0.45144895, 'auroc': 0.8950664, 'binary_precision': 0.96153843, 'binary_recall': 0.11848341, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.21097046}
confusion matrix:
     0   1
0  210   1
1  186  25
early stop counter: 3
val acc:0.6533957719802856, best validation acc: 0.8126463890075684, corresponding to test acc:                         0.8080568909645081 / 0.8483412265777588
after epoch: 12,now: 2024-07-26 06:58:25.738927,epoch time: 0:01:01.163851,used: 0:12:18.063293,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9873705, 'precision': 0.9873986, 'recall': 0.9873383, 'specificity': 0.9873383, 'f1': 0.98736584, 'auroc': 0.9994411, 'binary_precision': 0.9860406, 'binary_recall': 0.9891789, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.98760724}
confusion matrix:
      0     1
0  1495    22
1    17  1554
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.84983265, 'recall': 0.845534, 'specificity': 0.845534, 'f1': 0.84561175, 'auroc': 0.9134599, 'binary_precision': 0.88224953, 'binary_recall': 0.7943038, 'binary_specificity': 0.8967643, 'binary_f1_score': 0.83597004}
confusion matrix:
     0    1
0  582   67
1  130  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.8429731, 'recall': 0.82938385, 'specificity': 0.82938385, 'f1': 0.8276769, 'auroc': 0.91103077, 'binary_precision': 0.9112426, 'binary_recall': 0.7298578, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.8105263}
confusion matrix:
     0    1
0  196   15
1   57  154
better model found
persisted
after epoch: 13,now: 2024-07-26 06:59:26.950805,epoch time: 0:01:01.211878,used: 0:13:19.275171,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98251295, 'precision': 0.98246455, 'recall': 0.98260707, 'specificity': 0.98260707, 'f1': 0.9825094, 'auroc': 0.99882925, 'binary_precision': 0.9878049, 'binary_recall': 0.97776365, 'binary_specificity': 0.9874505, 'binary_f1_score': 0.98275864}
confusion matrix:
      0     1
0  1495    19
1    35  1539
---- Validation: 
scalar performance:
{'acc': 0.82982045, 'precision': 0.8501443, 'recall': 0.8282155, 'specificity': 0.8282155, 'f1': 0.82680595, 'auroc': 0.9198085, 'binary_precision': 0.93125, 'binary_recall': 0.7072785, 'binary_specificity': 0.9491525, 'binary_f1_score': 0.8039568}
confusion matrix:
     0    1
0  616   33
1  185  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79620856, 'precision': 0.83775127, 'recall': 0.7962085, 'specificity': 0.7962085, 'f1': 0.7897432, 'auroc': 0.92515886, 'binary_precision': 0.95620435, 'binary_recall': 0.62085307, 'binary_specificity': 0.971564, 'binary_f1_score': 0.75287354}
confusion matrix:
     0    1
0  205    6
1   80  131
early stop counter: 1
val acc:0.829820454120636, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.829383909702301 / 0.8483412265777588
after epoch: 14,now: 2024-07-26 07:00:27.995859,epoch time: 0:01:01.045054,used: 0:14:20.320225,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9857513, 'precision': 0.985726, 'recall': 0.9858923, 'specificity': 0.9858923, 'f1': 0.98574954, 'auroc': 0.99876714, 'binary_precision': 0.9935442, 'binary_recall': 0.97838527, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9859064}
confusion matrix:
      0     1
0  1505    10
1    34  1539
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.8462375, 'recall': 0.84245235, 'specificity': 0.84245235, 'f1': 0.8425371, 'auroc': 0.908738, 'binary_precision': 0.87609076, 'binary_recall': 0.7943038, 'binary_specificity': 0.8906009, 'binary_f1_score': 0.83319503}
confusion matrix:
     0    1
0  578   71
1  130  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.8170825, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.8039256, 'auroc': 0.8885695, 'binary_precision': 0.877193, 'binary_recall': 0.7109005, 'binary_specificity': 0.90047395, 'binary_f1_score': 0.7853403}
confusion matrix:
     0    1
0  190   21
1   61  150
early stop counter: 2
val acc:0.8430913090705872, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.829383909702301 / 0.8483412265777588
after epoch: 15,now: 2024-07-26 07:01:29.600626,epoch time: 0:01:01.604767,used: 0:15:21.924992,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9847798, 'precision': 0.984877, 'recall': 0.9849961, 'specificity': 0.9849961, 'f1': 0.9847794, 'auroc': 0.9992347, 'binary_precision': 0.997389, 'binary_recall': 0.9726289, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9848533}
confusion matrix:
      0     1
0  1513     4
1    43  1528
---- Validation: 
scalar performance:
{'acc': 0.7665886, 'precision': 0.812991, 'recall': 0.7640089, 'specificity': 0.7640089, 'f1': 0.7563984, 'auroc': 0.9108518, 'binary_precision': 0.9302326, 'binary_recall': 0.56962025, 'binary_specificity': 0.9583975, 'binary_f1_score': 0.7065751}
confusion matrix:
     0    1
0  622   27
1  272  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6919431, 'precision': 0.7792921, 'recall': 0.69194317, 'specificity': 0.69194317, 'f1': 0.6658138, 'auroc': 0.88603127, 'binary_precision': 0.9354839, 'binary_recall': 0.41232228, 'binary_specificity': 0.971564, 'binary_f1_score': 0.5723684}
confusion matrix:
     0   1
0  205   6
1  124  87
early stop counter: 3
val acc:0.7665886282920837, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.829383909702301 / 0.8483412265777588
after epoch: 16,now: 2024-07-26 07:02:30.998122,epoch time: 0:01:01.397496,used: 0:16:23.322488,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98639894, 'precision': 0.9864115, 'recall': 0.9865707, 'specificity': 0.9865707, 'f1': 0.986398, 'auroc': 0.9994645, 'binary_precision': 0.99610895, 'binary_recall': 0.97709924, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98651254}
confusion matrix:
      0     1
0  1510     6
1    36  1536
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.7851021, 'recall': 0.6997608, 'specificity': 0.6997608, 'f1': 0.6780726, 'auroc': 0.91709554, 'binary_precision': 0.93448275, 'binary_recall': 0.42879745, 'binary_specificity': 0.97072417, 'binary_f1_score': 0.5878525}
confusion matrix:
     0    1
0  630   19
1  361  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5663507, 'precision': 0.73669875, 'recall': 0.5663507, 'specificity': 0.5663507, 'f1': 0.47121054, 'auroc': 0.8847735, 'binary_precision': 0.9375, 'binary_recall': 0.1421801, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.24691358}
confusion matrix:
     0   1
0  209   2
1  181  30
early stop counter: 4
val acc:0.7033567428588867, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.829383909702301 / 0.8483412265777588
after epoch: 17,now: 2024-07-26 07:03:32.080091,epoch time: 0:01:01.081969,used: 0:17:24.404457,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99093264, 'precision': 0.99089575, 'recall': 0.9909781, 'specificity': 0.9909781, 'f1': 0.9909303, 'auroc': 0.99947125, 'binary_precision': 0.9936102, 'binary_recall': 0.9885569, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9910771}
confusion matrix:
      0     1
0  1505    10
1    18  1555
---- Validation: 
scalar performance:
{'acc': 0.84777516, 'precision': 0.8534653, 'recall': 0.8469298, 'specificity': 0.8469298, 'f1': 0.84691536, 'auroc': 0.92427737, 'binary_precision': 0.8951175, 'binary_recall': 0.78322786, 'binary_specificity': 0.9106317, 'binary_f1_score': 0.835443}
confusion matrix:
     0    1
0  591   58
1  137  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84123224, 'precision': 0.8520578, 'recall': 0.84123224, 'specificity': 0.84123224, 'f1': 0.8400023, 'auroc': 0.92473215, 'binary_precision': 0.9137931, 'binary_recall': 0.7535545, 'binary_specificity': 0.92890996, 'binary_f1_score': 0.825974}
confusion matrix:
     0    1
0  196   15
1   52  159
better model found
persisted
after epoch: 18,now: 2024-07-26 07:04:33.436703,epoch time: 0:01:01.356612,used: 0:18:25.761069,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.98329747, 'recall': 0.9834224, 'specificity': 0.9834224, 'f1': 0.98316026, 'auroc': 0.99936676, 'binary_precision': 0.9973839, 'binary_recall': 0.96948504, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9832366}
confusion matrix:
      0     1
0  1511     4
1    48  1525
---- Validation: 
scalar performance:
{'acc': 0.74863386, 'precision': 0.81716275, 'recall': 0.7455226, 'specificity': 0.7455226, 'f1': 0.732674, 'auroc': 0.92611325, 'binary_precision': 0.96130955, 'binary_recall': 0.511076, 'binary_specificity': 0.9799692, 'binary_f1_score': 0.6673554}
confusion matrix:
     0    1
0  636   13
1  309  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70616114, 'precision': 0.804721, 'recall': 0.70616114, 'specificity': 0.70616114, 'f1': 0.68031085, 'auroc': 0.9248669, 'binary_precision': 0.978022, 'binary_recall': 0.42180094, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.589404}
confusion matrix:
     0   1
0  209   2
1  122  89
early stop counter: 1
val acc:0.748633861541748, best validation acc: 0.8477751612663269, corresponding to test acc:                         0.8412322402000427 / 0.8483412265777588
after epoch: 19,now: 2024-07-26 07:05:34.433643,epoch time: 0:01:00.996940,used: 0:19:26.758009,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9828368, 'precision': 0.9828908, 'recall': 0.9830632, 'specificity': 0.9830632, 'f1': 0.9828358, 'auroc': 0.9987978, 'binary_precision': 0.9947951, 'binary_recall': 0.9714104, 'binary_specificity': 0.994716, 'binary_f1_score': 0.9829637}
confusion matrix:
      0     1
0  1506     8
1    45  1529
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.8276906, 'recall': 0.7949877, 'specificity': 0.7949877, 'f1': 0.7913733, 'auroc': 0.9094993, 'binary_precision': 0.9246575, 'binary_recall': 0.64082277, 'binary_specificity': 0.9491525, 'binary_f1_score': 0.7570093}
confusion matrix:
     0    1
0  616   33
1  227  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7985782, 'precision': 0.8258088, 'recall': 0.7985782, 'specificity': 0.7985782, 'f1': 0.7942797, 'auroc': 0.87857413, 'binary_precision': 0.92, 'binary_recall': 0.6540284, 'binary_specificity': 0.943128, 'binary_f1_score': 0.7645429}
confusion matrix:
     0    1
0  199   12
1   73  138
early stop counter: 2
val acc:0.7970335483551025, best validation acc: 0.8477751612663269, corresponding to test acc:                         0.8412322402000427 / 0.8483412265777588
after epoch: 20,now: 2024-07-26 07:06:36.521036,epoch time: 0:01:02.087393,used: 0:20:28.845402,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.988342, 'precision': 0.9882952, 'recall': 0.98846734, 'specificity': 0.98846734, 'f1': 0.9883398, 'auroc': 0.9993038, 'binary_precision': 0.9948553, 'binary_recall': 0.9822222, 'binary_specificity': 0.9947125, 'binary_f1_score': 0.98849833}
confusion matrix:
      0     1
0  1505     8
1    28  1547
---- Validation: 
scalar performance:
{'acc': 0.81576896, 'precision': 0.82496786, 'recall': 0.81463814, 'specificity': 0.81463814, 'f1': 0.8140546, 'auroc': 0.8820849, 'binary_precision': 0.87642586, 'binary_recall': 0.7294304, 'binary_specificity': 0.8998459, 'binary_f1_score': 0.7962004}
confusion matrix:
     0    1
0  584   65
1  171  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8459716, 'precision': 0.86245763, 'recall': 0.8459716, 'specificity': 0.8459716, 'f1': 0.8441999, 'auroc': 0.90916646, 'binary_precision': 0.939759, 'binary_recall': 0.7393365, 'binary_specificity': 0.9526066, 'binary_f1_score': 0.8275862}
confusion matrix:
     0    1
0  201   10
1   55  156
early stop counter: 3
val acc:0.8157689571380615, best validation acc: 0.8477751612663269, corresponding to test acc:                         0.8412322402000427 / 0.8483412265777588
after epoch: 21,now: 2024-07-26 07:07:37.730163,epoch time: 0:01:01.209127,used: 0:21:30.054529,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.9887743, 'recall': 0.9885797, 'specificity': 0.9885797, 'f1': 0.98865944, 'auroc': 0.99919724, 'binary_precision': 0.9848771, 'binary_recall': 0.9930114, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.9889275}
confusion matrix:
      0     1
0  1490    24
1    11  1563
---- Validation: 
scalar performance:
{'acc': 0.8508977, 'precision': 0.8533305, 'recall': 0.850343, 'specificity': 0.850343, 'f1': 0.8504764, 'auroc': 0.9130283, 'binary_precision': 0.8795181, 'binary_recall': 0.8085443, 'binary_specificity': 0.89214176, 'binary_f1_score': 0.84253913}
confusion matrix:
     0    1
0  579   70
1  121  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81042653, 'precision': 0.8339495, 'recall': 0.8104266, 'specificity': 0.8104266, 'f1': 0.8070284, 'auroc': 0.91736484, 'binary_precision': 0.92258066, 'binary_recall': 0.67772514, 'binary_specificity': 0.943128, 'binary_f1_score': 0.7814208}
confusion matrix:
     0    1
0  199   12
1   68  143
better model found
persisted
after epoch: 22,now: 2024-07-26 07:08:38.947114,epoch time: 0:01:01.216951,used: 0:22:31.271480,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9818653, 'precision': 0.9821218, 'recall': 0.9822092, 'specificity': 0.9822092, 'f1': 0.98186517, 'auroc': 0.9996286, 'binary_precision': 0.99934256, 'binary_recall': 0.96507937, 'binary_specificity': 0.99933904, 'binary_f1_score': 0.98191214}
confusion matrix:
      0     1
0  1512     1
1    55  1520
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.7991215, 'recall': 0.70752716, 'specificity': 0.70752716, 'f1': 0.68594456, 'auroc': 0.92051554, 'binary_precision': 0.95804197, 'binary_recall': 0.4335443, 'binary_specificity': 0.98151004, 'binary_f1_score': 0.5969499}
confusion matrix:
     0    1
0  637   12
1  358  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6161137, 'precision': 0.7828418, 'recall': 0.6161137, 'specificity': 0.6161137, 'f1': 0.54976296, 'auroc': 0.9351766, 'binary_precision': 1.0, 'binary_recall': 0.23222749, 'binary_specificity': 1.0, 'binary_f1_score': 0.37692308}
confusion matrix:
     0   1
0  211   0
1  162  49
early stop counter: 1
val acc:0.7111631631851196, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8483412265777588
after epoch: 23,now: 2024-07-26 07:09:40.134899,epoch time: 0:01:01.187785,used: 0:23:32.459265,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9776554, 'precision': 0.978199, 'recall': 0.9779773, 'specificity': 0.9779773, 'f1': 0.97765476, 'auroc': 0.9993321, 'binary_precision': 0.9986693, 'binary_recall': 0.9572704, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.97753173}
confusion matrix:
      0     1
0  1518     2
1    67  1501
---- Validation: 
scalar performance:
{'acc': 0.7103825, 'precision': 0.7930404, 'recall': 0.70681894, 'specificity': 0.70681894, 'f1': 0.6861424, 'auroc': 0.91869426, 'binary_precision': 0.9453925, 'binary_recall': 0.43829113, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.5989189}
confusion matrix:
     0    1
0  633   16
1  355  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6943128, 'precision': 0.81029415, 'recall': 0.6943128, 'specificity': 0.6943128, 'f1': 0.66280353, 'auroc': 0.9379338, 'binary_precision': 1.0, 'binary_recall': 0.3886256, 'binary_specificity': 1.0, 'binary_f1_score': 0.55972695}
confusion matrix:
     0   1
0  211   0
1  129  82
early stop counter: 2
val acc:0.7103825211524963, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8483412265777588
after epoch: 24,now: 2024-07-26 07:10:41.195599,epoch time: 0:01:01.060700,used: 0:24:33.519965,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9896373, 'precision': 0.9896026, 'recall': 0.9896889, 'specificity': 0.9896889, 'f1': 0.98963535, 'auroc': 0.99946165, 'binary_precision': 0.9929487, 'binary_recall': 0.9866242, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9897763}
confusion matrix:
      0     1
0  1507    11
1    21  1549
---- Validation: 
scalar performance:
{'acc': 0.8501171, 'precision': 0.86125493, 'recall': 0.8489509, 'specificity': 0.8489509, 'f1': 0.84862924, 'auroc': 0.92713773, 'binary_precision': 0.9214559, 'binary_recall': 0.761076, 'binary_specificity': 0.9368259, 'binary_f1_score': 0.8336222}
confusion matrix:
     0    1
0  608   41
1  151  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8573712, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.83406943, 'auroc': 0.92259836, 'binary_precision': 0.94375, 'binary_recall': 0.7156398, 'binary_specificity': 0.95734596, 'binary_f1_score': 0.8140162}
confusion matrix:
     0    1
0  202    9
1   60  151
early stop counter: 3
val acc:0.8501170873641968, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8483412265777588
after epoch: 25,now: 2024-07-26 07:11:43.009106,epoch time: 0:01:01.813507,used: 0:25:35.333472,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9896373, 'precision': 0.9896029, 'recall': 0.9897361, 'specificity': 0.9897361, 'f1': 0.9896358, 'auroc': 0.9997214, 'binary_precision': 0.9954926, 'binary_recall': 0.9840866, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.98975664}
confusion matrix:
      0     1
0  1510     7
1    25  1546
---- Validation: 
scalar performance:
{'acc': 0.6721311, 'precision': 0.78117573, 'recall': 0.66794944, 'specificity': 0.66794944, 'f1': 0.633685, 'auroc': 0.9085637, 'binary_precision': 0.9529914, 'binary_recall': 0.3528481, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.51501155}
confusion matrix:
     0    1
0  638   11
1  409  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69668245, 'precision': 0.7861882, 'recall': 0.69668245, 'specificity': 0.69668245, 'f1': 0.6709552, 'auroc': 0.9121987, 'binary_precision': 0.94623655, 'binary_recall': 0.4170616, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.57894737}
confusion matrix:
     0   1
0  206   5
1  123  88
early stop counter: 4
val acc:0.6721311211585999, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8483412265777588
after epoch: 26,now: 2024-07-26 07:12:44.112273,epoch time: 0:01:01.103167,used: 0:26:36.436639,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.97830313, 'precision': 0.978851, 'recall': 0.97867596, 'specificity': 0.97867596, 'f1': 0.9783027, 'auroc': 0.9992347, 'binary_precision': 1.0, 'binary_recall': 0.957352, 'binary_specificity': 1.0, 'binary_f1_score': 0.9782114}
confusion matrix:
      0     1
0  1517     0
1    67  1504
---- Validation: 
scalar performance:
{'acc': 0.6830601, 'precision': 0.7956404, 'recall': 0.6789218, 'specificity': 0.6789218, 'f1': 0.6466903, 'auroc': 0.91924167, 'binary_precision': 0.9747899, 'binary_recall': 0.36708862, 'binary_specificity': 0.990755, 'binary_f1_score': 0.53333336}
confusion matrix:
     0    1
0  643    6
1  400  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5189573, 'precision': 0.75483096, 'recall': 0.5189574, 'specificity': 0.5189574, 'f1': 0.37412968, 'auroc': 0.9222895, 'binary_precision': 1.0, 'binary_recall': 0.037914693, 'binary_specificity': 1.0, 'binary_f1_score': 0.07305936}
confusion matrix:
     0  1
0  211  0
1  203  8
early stop counter: 5
val acc:0.6830601096153259, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8483412265777588
after epoch: 27,now: 2024-07-26 07:13:45.148324,epoch time: 0:01:01.036051,used: 0:27:37.472690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.98639894, 'precision': 0.9867395, 'recall': 0.9862249, 'specificity': 0.9862249, 'f1': 0.9863888, 'auroc': 0.9997361, 'binary_precision': 0.977514, 'binary_recall': 0.9961808, 'binary_specificity': 0.97626895, 'binary_f1_score': 0.9867591}
confusion matrix:
      0     1
0  1481    36
1     6  1565
---- Validation: 
scalar performance:
{'acc': 0.8469945, 'precision': 0.8498744, 'recall': 0.8463873, 'specificity': 0.8463873, 'f1': 0.84649605, 'auroc': 0.90924454, 'binary_precision': 0.8784722, 'binary_recall': 0.8006329, 'binary_specificity': 0.89214176, 'binary_f1_score': 0.83774835}
confusion matrix:
     0    1
0  579   70
1  126  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86018956, 'precision': 0.86379313, 'recall': 0.86018956, 'specificity': 0.86018956, 'f1': 0.8598425, 'auroc': 0.9241257, 'binary_precision': 0.9, 'binary_recall': 0.81042653, 'binary_specificity': 0.9099526, 'binary_f1_score': 0.85286784}
confusion matrix:
     0    1
0  192   19
1   40  171
new oracle model saved
early stop counter: 6
val acc:0.8469945192337036, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8601895570755005
after epoch: 28,now: 2024-07-26 07:14:46.535173,epoch time: 0:01:01.386849,used: 0:28:38.859539,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9935233, 'precision': 0.99348915, 'recall': 0.9936233, 'specificity': 0.9936233, 'f1': 0.9935224, 'auroc': 0.99985313, 'binary_precision': 0.9993561, 'binary_recall': 0.9879058, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.993598}
confusion matrix:
      0     1
0  1516     1
1    19  1552
---- Validation: 
scalar performance:
{'acc': 0.72521466, 'precision': 0.7901969, 'recall': 0.7220371, 'specificity': 0.7220371, 'f1': 0.7070478, 'auroc': 0.9106122, 'binary_precision': 0.92424244, 'binary_recall': 0.48259494, 'binary_specificity': 0.9614792, 'binary_f1_score': 0.63409567}
confusion matrix:
     0    1
0  624   25
1  327  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72748816, 'precision': 0.79865533, 'recall': 0.72748816, 'specificity': 0.72748816, 'f1': 0.71022546, 'auroc': 0.9076166, 'binary_precision': 0.9444444, 'binary_recall': 0.48341233, 'binary_specificity': 0.971564, 'binary_f1_score': 0.6394985}
confusion matrix:
     0    1
0  205    6
1  109  102
early stop counter: 7
val acc:0.7252146601676941, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8601895570755005
after epoch: 29,now: 2024-07-26 07:15:47.720624,epoch time: 0:01:01.185451,used: 0:29:40.044990,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9906088, 'precision': 0.9905975, 'recall': 0.99076974, 'specificity': 0.99076974, 'f1': 0.99060786, 'auroc': 0.99990225, 'binary_precision': 0.9993532, 'binary_recall': 0.9821996, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9907021}
confusion matrix:
      0     1
0  1514     1
1    28  1545
---- Validation: 
scalar performance:
{'acc': 0.6252927, 'precision': 0.7751896, 'recall': 0.62033606, 'specificity': 0.62033606, 'f1': 0.56137645, 'auroc': 0.9115923, 'binary_precision': 0.975, 'binary_recall': 0.24683544, 'binary_specificity': 0.9938367, 'binary_f1_score': 0.39393938}
confusion matrix:
     0    1
0  645    4
1  476  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54028434, 'precision': 0.7604938, 'recall': 0.54028434, 'specificity': 0.54028434, 'f1': 0.41709387, 'auroc': 0.900648, 'binary_precision': 1.0, 'binary_recall': 0.08056872, 'binary_specificity': 1.0, 'binary_f1_score': 0.14912282}
confusion matrix:
     0   1
0  211   0
1  194  17
early stop counter: 8
val acc:0.6252927184104919, best validation acc: 0.8508977293968201, corresponding to test acc:                         0.8104265332221985 / 0.8601895570755005
after epoch: 30,now: 2024-07-26 07:16:49.411876,epoch time: 0:01:01.691252,used: 0:30:41.736242,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_46_07_seed_4_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:30:41.736242 at 2024-07-26 07:16:49.411876
persisted model performance metric: 

scalar performance:
{'acc': 0.81042653, 'precision': 0.8339495, 'recall': 0.8104266, 'specificity': 0.8104266, 'f1': 0.8070284, 'auroc': 0.91736484, 'binary_precision': 0.92258066, 'binary_recall': 0.67772514, 'binary_specificity': 0.943128, 'binary_f1_score': 0.7814208}
confusion matrix:
     0    1
0  199   12
1   68  143
oracle model performance metric: 

scalar performance:
{'acc': 0.86018956, 'precision': 0.86379313, 'recall': 0.86018956, 'specificity': 0.86018956, 'f1': 0.8598425, 'auroc': 0.9241257, 'binary_precision': 0.9, 'binary_recall': 0.81042653, 'binary_specificity': 0.9099526, 'binary_f1_score': 0.85286784}
confusion matrix:
     0    1
0  192   19
1   40  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455124 KiB |  13219 MiB | 368152 GiB | 368151 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 363802 GiB | 363801 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455124 KiB |  13219 MiB | 368152 GiB | 368151 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 363802 GiB | 363801 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 367474 GiB | 367473 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 363133 GiB | 363132 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  68862 MiB |  54388 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  68726 MiB |  54318 MiB |
|       from small pool |     66 MiB |     70 MiB |    136 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445996 KiB |   1252 MiB | 262746 GiB | 262745 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 258368 GiB | 258368 GiB |
|       from small pool |  10607 KiB |     44 MiB |   4377 GiB |   4377 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64611 K  |   64610 K  |
|       from large pool |     187    |    1413    |   32848 K  |   32848 K  |
|       from small pool |    1111    |    1419    |   31762 K  |   31761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64611 K  |   64610 K  |
|       from large pool |     187    |    1413    |   32848 K  |   32848 K  |
|       from small pool |    1111    |    1419    |   31762 K  |   31761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    2925    |    2291    |
|       from large pool |     601    |     601    |    2857    |    2256    |
|       from small pool |      33    |      35    |      68    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     100    |     651    |   42035 K  |   42035 K  |
|       from large pool |      40    |     604    |   23348 K  |   23348 K  |
|       from small pool |      60    |     236    |   18686 K  |   18686 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 368152 GiB | 368152 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363802 GiB | 363801 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 368152 GiB | 368152 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363802 GiB | 363801 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 367474 GiB | 367474 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 363133 GiB | 363133 GiB |
|       from small pool |      0 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  68862 MiB |  67982 MiB |
|       from large pool |    830 MiB |  14414 MiB |  68726 MiB |  67896 MiB |
|       from small pool |     50 MiB |     70 MiB |    136 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 262746 GiB | 262746 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 258368 GiB | 258368 GiB |
|       from small pool |      0 KiB |     44 MiB |   4377 GiB |   4377 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64611 K  |   64611 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31762 K  |   31762 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64611 K  |   64611 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31762 K  |   31762 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    2925    |    2863    |
|       from large pool |      37    |     601    |    2857    |    2820    |
|       from small pool |      25    |      35    |      68    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   42035 K  |   42035 K  |
|       from large pool |       4    |     604    |   23348 K  |   23348 K  |
|       from small pool |       0    |     236    |   18687 K  |   18687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 368152 GiB | 368152 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363802 GiB | 363801 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 368152 GiB | 368152 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363802 GiB | 363801 GiB |
|       from small pool |      0 KiB |     60 MiB |   4350 GiB |   4350 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 367474 GiB | 367474 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 363133 GiB | 363133 GiB |
|       from small pool |      0 KiB |     60 MiB |   4341 GiB |   4341 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  68862 MiB |  67982 MiB |
|       from large pool |    830 MiB |  14414 MiB |  68726 MiB |  67896 MiB |
|       from small pool |     50 MiB |     70 MiB |    136 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 262746 GiB | 262746 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 258368 GiB | 258368 GiB |
|       from small pool |      0 KiB |     44 MiB |   4377 GiB |   4377 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64611 K  |   64611 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31762 K  |   31762 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64611 K  |   64611 K  |
|       from large pool |       2    |    1413    |   32848 K  |   32848 K  |
|       from small pool |       0    |    1419    |   31762 K  |   31762 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    2925    |    2863    |
|       from large pool |      37    |     601    |    2857    |    2820    |
|       from small pool |      25    |      35    |      68    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   42035 K  |   42035 K  |
|       from large pool |       4    |     604    |   23348 K  |   23348 K  |
|       from small pool |       0    |     236    |   18687 K  |   18687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536

 Experiment start at: 2024-07-26 07:17:14.902175
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9492801, 'precision': 0.9492487, 'recall': 0.9493228, 'specificity': 0.9493228, 'f1': 0.94927347, 'auroc': 0.9891233, 'binary_precision': 0.9532468, 'binary_recall': 0.9464861, 'binary_specificity': 0.95215946, 'binary_f1_score': 0.94985443}
confusion matrix:
      0     1
0  1433    72
1    83  1468
---- Validation: 
scalar performance:
{'acc': 0.80559874, 'precision': 0.81688964, 'recall': 0.8081912, 'specificity': 0.8081912, 'f1': 0.8046419, 'auroc': 0.8973217, 'binary_precision': 0.7496671, 'binary_recall': 0.9008, 'binary_specificity': 0.71558243, 'binary_f1_score': 0.8183139}
confusion matrix:
     0    1
0  473  188
1   62  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7943723, 'precision': 0.80128896, 'recall': 0.7943723, 'specificity': 0.7943723, 'f1': 0.79318535, 'auroc': 0.9144132, 'binary_precision': 0.7556391, 'binary_recall': 0.8701299, 'binary_specificity': 0.7186147, 'binary_f1_score': 0.80885315}
confusion matrix:
     0    1
0  166   65
1   30  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:18:19.920470,epoch time: 0:01:05.018295,used: 0:01:05.018295,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9623691, 'precision': 0.96376574, 'recall': 0.9628985, 'specificity': 0.9628985, 'f1': 0.962361, 'auroc': 0.99598646, 'binary_precision': 0.99382293, 'binary_recall': 0.9317889, 'binary_specificity': 0.994008, 'binary_f1_score': 0.9618067}
confusion matrix:
      0     1
0  1493     9
1   106  1448
---- Validation: 
scalar performance:
{'acc': 0.7877138, 'precision': 0.8092895, 'recall': 0.7839092, 'specificity': 0.7839092, 'f1': 0.78228897, 'auroc': 0.88908684, 'binary_precision': 0.8842795, 'binary_recall': 0.648, 'binary_specificity': 0.91981846, 'binary_f1_score': 0.7479225}
confusion matrix:
     0    1
0  608   53
1  220  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83549786, 'precision': 0.8534062, 'recall': 0.83549786, 'specificity': 0.83549786, 'f1': 0.83338714, 'auroc': 0.90980303, 'binary_precision': 0.93296087, 'binary_recall': 0.7229437, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.8146342}
confusion matrix:
     0    1
0  219   12
1   64  167
new oracle model saved
early stop counter: 1
val acc:0.7877138257026672, best validation acc: 0.8055987358093262, corresponding to test acc:                         0.7943723201751709 / 0.8354978561401367
after epoch: 2,now: 2024-07-26 07:19:22.015310,epoch time: 0:01:02.094840,used: 0:02:07.113135,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93815446, 'precision': 0.94447285, 'recall': 0.93714607, 'specificity': 0.93714607, 'f1': 0.9378174, 'auroc': 0.9964731, 'binary_precision': 0.8957126, 'binary_recall': 0.9942122, 'binary_specificity': 0.8800799, 'binary_f1_score': 0.9423956}
confusion matrix:
      0     1
0  1321   180
1     9  1546
---- Validation: 
scalar performance:
{'acc': 0.8017107, 'precision': 0.8196753, 'recall': 0.8049755, 'specificity': 0.8049755, 'f1': 0.7999396, 'auroc': 0.89617187, 'binary_precision': 0.73657286, 'binary_recall': 0.9216, 'binary_specificity': 0.688351, 'binary_f1_score': 0.8187633}
confusion matrix:
     0    1
0  455  206
1   49  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82900435, 'precision': 0.831746, 'recall': 0.8290043, 'specificity': 0.8290043, 'f1': 0.8286503, 'auroc': 0.882967, 'binary_precision': 0.8015873, 'binary_recall': 0.87445885, 'binary_specificity': 0.7835498, 'binary_f1_score': 0.8364389}
confusion matrix:
     0    1
0  181   50
1   29  202
early stop counter: 2
val acc:0.8017107248306274, best validation acc: 0.8055987358093262, corresponding to test acc:                         0.7943723201751709 / 0.8354978561401367
after epoch: 3,now: 2024-07-26 07:20:23.921368,epoch time: 0:01:01.906058,used: 0:03:09.019193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.97658217, 'recall': 0.9764203, 'specificity': 0.9764203, 'f1': 0.9761121, 'auroc': 0.99882233, 'binary_precision': 0.99597585, 'binary_recall': 0.9568299, 'binary_specificity': 0.99601066, 'binary_f1_score': 0.97601056}
confusion matrix:
      0     1
0  1498     6
1    67  1485
---- Validation: 
scalar performance:
{'acc': 0.8304821, 'precision': 0.847543, 'recall': 0.8273428, 'specificity': 0.8273428, 'f1': 0.82732093, 'auroc': 0.90379906, 'binary_precision': 0.9178645, 'binary_recall': 0.7152, 'binary_specificity': 0.9394856, 'binary_f1_score': 0.80395687}
confusion matrix:
     0    1
0  621   40
1  178  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8398268, 'precision': 0.8448942, 'recall': 0.8398268, 'specificity': 0.8398268, 'f1': 0.83923626, 'auroc': 0.90652347, 'binary_precision': 0.8866995, 'binary_recall': 0.77922076, 'binary_specificity': 0.9004329, 'binary_f1_score': 0.82949305}
confusion matrix:
     0    1
0  208   23
1   51  180
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 07:21:26.001080,epoch time: 0:01:02.079712,used: 0:04:11.098905,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9708591, 'recall': 0.97088516, 'specificity': 0.97088516, 'f1': 0.9708712, 'auroc': 0.9970608, 'binary_precision': 0.9722222, 'binary_recall': 0.97034174, 'binary_specificity': 0.9714286, 'binary_f1_score': 0.97128105}
confusion matrix:
      0     1
0  1462    43
1    46  1505
---- Validation: 
scalar performance:
{'acc': 0.8265941, 'precision': 0.83066237, 'recall': 0.82813555, 'specificity': 0.82813555, 'f1': 0.8264176, 'auroc': 0.9006064, 'binary_precision': 0.7863248, 'binary_recall': 0.8832, 'binary_specificity': 0.7730711, 'binary_f1_score': 0.83195174}
confusion matrix:
     0    1
0  511  150
1   73  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7878788, 'precision': 0.8045198, 'recall': 0.78787875, 'specificity': 0.78787875, 'f1': 0.7849407, 'auroc': 0.912408, 'binary_precision': 0.73333335, 'binary_recall': 0.9047619, 'binary_specificity': 0.67099565, 'binary_f1_score': 0.81007755}
confusion matrix:
     0    1
0  155   76
1   22  209
early stop counter: 1
val acc:0.8265941143035889, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8398268222808838 / 0.8398268222808838
after epoch: 5,now: 2024-07-26 07:22:28.246466,epoch time: 0:01:02.245386,used: 0:05:13.344291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97611254, 'precision': 0.9763335, 'recall': 0.97597206, 'specificity': 0.97597206, 'f1': 0.9760974, 'auroc': 0.99808276, 'binary_precision': 0.9695817, 'binary_recall': 0.98392284, 'binary_specificity': 0.96802133, 'binary_f1_score': 0.97669965}
confusion matrix:
      0     1
0  1453    48
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.82348365, 'precision': 0.82825303, 'recall': 0.8251534, 'specificity': 0.8251534, 'f1': 0.82324755, 'auroc': 0.8996599, 'binary_precision': 0.78107345, 'binary_recall': 0.8848, 'binary_specificity': 0.7655068, 'binary_f1_score': 0.8297074}
confusion matrix:
     0    1
0  506  155
1   72  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8073593, 'precision': 0.8074112, 'recall': 0.80735934, 'specificity': 0.80735934, 'f1': 0.8073511, 'auroc': 0.8670752, 'binary_precision': 0.8034188, 'binary_recall': 0.8138528, 'binary_specificity': 0.8008658, 'binary_f1_score': 0.8086021}
confusion matrix:
     0    1
0  185   46
1   43  188
early stop counter: 2
val acc:0.8234836459159851, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8398268222808838 / 0.8398268222808838
after epoch: 6,now: 2024-07-26 07:23:30.156087,epoch time: 0:01:01.909621,used: 0:06:15.253912,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97883856, 'recall': 0.97867197, 'specificity': 0.97867197, 'f1': 0.9784027, 'auroc': 0.9988425, 'binary_precision': 0.99731904, 'binary_recall': 0.96, 'binary_specificity': 0.99734396, 'binary_f1_score': 0.97830373}
confusion matrix:
      0     1
0  1502     4
1    62  1488
---- Validation: 
scalar performance:
{'acc': 0.7550544, 'precision': 0.8171166, 'recall': 0.7487407, 'specificity': 0.7487407, 'f1': 0.739208, 'auroc': 0.9004587, 'binary_precision': 0.9505814, 'binary_recall': 0.5232, 'binary_specificity': 0.9742814, 'binary_f1_score': 0.6749225}
confusion matrix:
     0    1
0  644   17
1  298  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186147, 'precision': 0.8031811, 'recall': 0.7186147, 'specificity': 0.7186147, 'f1': 0.69752216, 'auroc': 0.90517414, 'binary_precision': 0.96330273, 'binary_recall': 0.45454547, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.61764705}
confusion matrix:
     0    1
0  227    4
1  126  105
early stop counter: 3
val acc:0.7550544142723083, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8398268222808838 / 0.8398268222808838
after epoch: 7,now: 2024-07-26 07:24:31.841100,epoch time: 0:01:01.685013,used: 0:07:16.938925,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.983989, 'recall': 0.98409534, 'specificity': 0.98409534, 'f1': 0.9839654, 'auroc': 0.99865603, 'binary_precision': 0.9927822, 'binary_recall': 0.9754997, 'binary_specificity': 0.99269104, 'binary_f1_score': 0.98406506}
confusion matrix:
      0     1
0  1494    11
1    38  1513
---- Validation: 
scalar performance:
{'acc': 0.7674961, 'precision': 0.81620586, 'recall': 0.7618893, 'specificity': 0.7618893, 'f1': 0.7554871, 'auroc': 0.90101063, 'binary_precision': 0.93351066, 'binary_recall': 0.5616, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.7012987}
confusion matrix:
     0    1
0  636   25
1  274  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6796537, 'precision': 0.77935135, 'recall': 0.6796537, 'specificity': 0.6796537, 'f1': 0.64827156, 'auroc': 0.90637356, 'binary_precision': 0.94623655, 'binary_recall': 0.3809524, 'binary_specificity': 0.978355, 'binary_f1_score': 0.54320985}
confusion matrix:
     0   1
0  226   5
1  143  88
early stop counter: 4
val acc:0.7674961090087891, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8398268222808838 / 0.8398268222808838
after epoch: 8,now: 2024-07-26 07:25:33.423971,epoch time: 0:01:01.582871,used: 0:08:18.521796,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9659686, 'precision': 0.9672538, 'recall': 0.9656003, 'specificity': 0.9656003, 'f1': 0.96591777, 'auroc': 0.99749637, 'binary_precision': 0.9463625, 'binary_recall': 0.9890464, 'binary_specificity': 0.9421542, 'binary_f1_score': 0.9672338}
confusion matrix:
      0     1
0  1417    87
1    17  1535
---- Validation: 
scalar performance:
{'acc': 0.8141524, 'precision': 0.81808174, 'recall': 0.81250346, 'specificity': 0.81250346, 'f1': 0.8129052, 'auroc': 0.8748635, 'binary_precision': 0.8471223, 'binary_recall': 0.7536, 'binary_specificity': 0.871407, 'binary_f1_score': 0.7976291}
confusion matrix:
     0    1
0  576   85
1  154  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8246753, 'precision': 0.82738096, 'recall': 0.8246753, 'specificity': 0.8246753, 'f1': 0.8243123, 'auroc': 0.9048181, 'binary_precision': 0.85714287, 'binary_recall': 0.77922076, 'binary_specificity': 0.8701299, 'binary_f1_score': 0.81632656}
confusion matrix:
     0    1
0  201   30
1   51  180
early stop counter: 5
val acc:0.8141524195671082, best validation acc: 0.8304821252822876, corresponding to test acc:                         0.8398268222808838 / 0.8398268222808838
after epoch: 9,now: 2024-07-26 07:26:35.287394,epoch time: 0:01:01.863423,used: 0:09:20.385219,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9862374, 'recall': 0.98627985, 'specificity': 0.98627985, 'f1': 0.9862548, 'auroc': 0.99874735, 'binary_precision': 0.98832685, 'binary_recall': 0.9844961, 'binary_specificity': 0.98806363, 'binary_f1_score': 0.98640776}
confusion matrix:
      0     1
0  1490    18
1    24  1524
---- Validation: 
scalar performance:
{'acc': 0.86391914, 'precision': 0.8638232, 'recall': 0.86379063, 'specificity': 0.86379063, 'f1': 0.8638064, 'auroc': 0.916921, 'binary_precision': 0.8605769, 'binary_recall': 0.8592, 'binary_specificity': 0.86838126, 'binary_f1_score': 0.85988796}
confusion matrix:
     0    1
0  574   87
1   88  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8852814, 'precision': 0.89234734, 'recall': 0.8852814, 'specificity': 0.8852814, 'f1': 0.8847625, 'auroc': 0.9470587, 'binary_precision': 0.945, 'binary_recall': 0.8181818, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.87703013}
confusion matrix:
     0    1
0  220   11
1   42  189
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-26 07:27:37.888732,epoch time: 0:01:02.601338,used: 0:10:22.986557,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9869063, 'recall': 0.98701644, 'specificity': 0.98701644, 'f1': 0.9869102, 'auroc': 0.9993535, 'binary_precision': 0.9941138, 'binary_recall': 0.9800129, 'binary_specificity': 0.9940199, 'binary_f1_score': 0.987013}
confusion matrix:
      0     1
0  1496     9
1    31  1520
---- Validation: 
scalar performance:
{'acc': 0.7846034, 'precision': 0.83021975, 'recall': 0.779315, 'specificity': 0.779315, 'f1': 0.77459365, 'auroc': 0.92737067, 'binary_precision': 0.9461538, 'binary_recall': 0.5904, 'binary_specificity': 0.96822995, 'binary_f1_score': 0.7270935}
confusion matrix:
     0    1
0  640   21
1  256  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103896, 'precision': 0.7810219, 'recall': 0.6103896, 'specificity': 0.6103896, 'f1': 0.5406642, 'auroc': 0.9258635, 'binary_precision': 1.0, 'binary_recall': 0.22077923, 'binary_specificity': 1.0, 'binary_f1_score': 0.36170214}
confusion matrix:
     0   1
0  231   0
1  180  51
early stop counter: 1
val acc:0.7846034169197083, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 11,now: 2024-07-26 07:28:40.271015,epoch time: 0:01:02.382283,used: 0:11:25.368840,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98352015, 'recall': 0.98352945, 'specificity': 0.98352945, 'f1': 0.98331153, 'auroc': 0.9990957, 'binary_precision': 0.99800795, 'binary_recall': 0.9690522, 'binary_specificity': 0.99800664, 'binary_f1_score': 0.98331696}
confusion matrix:
      0     1
0  1502     3
1    48  1503
---- Validation: 
scalar performance:
{'acc': 0.5660964, 'precision': 0.73883104, 'recall': 0.55381787, 'specificity': 0.55381787, 'f1': 0.45336622, 'auroc': 0.91265965, 'binary_precision': 0.9350649, 'binary_recall': 0.1152, 'binary_specificity': 0.9924357, 'binary_f1_score': 0.2051282}
confusion matrix:
     0   1
0  656   5
1  553  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54329, 'precision': 0.6900922, 'recall': 0.54329, 'specificity': 0.54329, 'f1': 0.4340175, 'auroc': 0.8948343, 'binary_precision': 0.85714287, 'binary_recall': 0.103896104, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.18532819}
confusion matrix:
     0   1
0  227   4
1  207  24
early stop counter: 2
val acc:0.5660964250564575, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 12,now: 2024-07-26 07:29:42.312028,epoch time: 0:01:02.041013,used: 0:12:27.409853,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.98993313, 'recall': 0.989797, 'specificity': 0.989797, 'f1': 0.9898522, 'auroc': 0.9996881, 'binary_precision': 0.9865643, 'binary_recall': 0.9935567, 'binary_specificity': 0.98603725, 'binary_f1_score': 0.9900481}
confusion matrix:
      0     1
0  1483    21
1    10  1542
---- Validation: 
scalar performance:
{'acc': 0.7247278, 'precision': 0.79292774, 'recall': 0.7178021, 'specificity': 0.7178021, 'f1': 0.70351297, 'auroc': 0.89947116, 'binary_precision': 0.9274448, 'binary_recall': 0.4704, 'binary_specificity': 0.96520424, 'binary_f1_score': 0.62420386}
confusion matrix:
     0    1
0  638   23
1  331  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63852817, 'precision': 0.72859967, 'recall': 0.6385281, 'specificity': 0.6385281, 'f1': 0.5990313, 'auroc': 0.8839602, 'binary_precision': 0.872093, 'binary_recall': 0.32467532, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.47318617}
confusion matrix:
     0   1
0  220  11
1  156  75
early stop counter: 3
val acc:0.7247278094291687, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 13,now: 2024-07-26 07:30:44.256608,epoch time: 0:01:01.944580,used: 0:13:29.354433,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99112916, 'recall': 0.99124587, 'specificity': 0.99124587, 'f1': 0.9911636, 'auroc': 0.9994203, 'binary_precision': 0.9961014, 'binary_recall': 0.9864865, 'binary_specificity': 0.9960053, 'binary_f1_score': 0.99127066}
confusion matrix:
      0     1
0  1496     6
1    21  1533
---- Validation: 
scalar performance:
{'acc': 0.8437014, 'precision': 0.8623998, 'recall': 0.84050715, 'specificity': 0.84050715, 'f1': 0.84068334, 'auroc': 0.93402183, 'binary_precision': 0.93801653, 'binary_recall': 0.7264, 'binary_specificity': 0.9546142, 'binary_f1_score': 0.8187556}
confusion matrix:
     0    1
0  631   30
1  171  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77922076, 'precision': 0.8405055, 'recall': 0.7792208, 'specificity': 0.7792208, 'f1': 0.7688187, 'auroc': 0.936939, 'binary_precision': 0.9849624, 'binary_recall': 0.5670996, 'binary_specificity': 0.991342, 'binary_f1_score': 0.7197802}
confusion matrix:
     0    1
0  229    2
1  100  131
early stop counter: 4
val acc:0.8437014222145081, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 14,now: 2024-07-26 07:31:46.513243,epoch time: 0:01:02.256635,used: 0:14:31.611068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9881984, 'recall': 0.9883238, 'specificity': 0.9883238, 'f1': 0.9882188, 'auroc': 0.99950767, 'binary_precision': 0.9947815, 'binary_recall': 0.98197037, 'binary_specificity': 0.9946773, 'binary_f1_score': 0.9883345}
confusion matrix:
      0     1
0  1495     8
1    28  1525
---- Validation: 
scalar performance:
{'acc': 0.7993779, 'precision': 0.8314307, 'recall': 0.79495066, 'specificity': 0.79495066, 'f1': 0.7926289, 'auroc': 0.90397096, 'binary_precision': 0.9277389, 'binary_recall': 0.6368, 'binary_specificity': 0.95310134, 'binary_f1_score': 0.7552182}
confusion matrix:
     0    1
0  630   31
1  227  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7532467, 'precision': 0.8009889, 'recall': 0.7532468, 'specificity': 0.7532468, 'f1': 0.74305785, 'auroc': 0.90642977, 'binary_precision': 0.92086333, 'binary_recall': 0.55411255, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.69189197}
confusion matrix:
     0    1
0  220   11
1  103  128
early stop counter: 5
val acc:0.7993779182434082, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 15,now: 2024-07-26 07:32:48.793471,epoch time: 0:01:02.280228,used: 0:15:33.891296,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.9875834, 'recall': 0.9877121, 'specificity': 0.9877121, 'f1': 0.9875648, 'auroc': 0.9994426, 'binary_precision': 0.9967213, 'binary_recall': 0.9787508, 'binary_specificity': 0.99667335, 'binary_f1_score': 0.9876543}
confusion matrix:
      0     1
0  1498     5
1    33  1520
---- Validation: 
scalar performance:
{'acc': 0.80793154, 'precision': 0.84142375, 'recall': 0.80348927, 'specificity': 0.80348927, 'f1': 0.8014125, 'auroc': 0.9076599, 'binary_precision': 0.94158876, 'binary_recall': 0.6448, 'binary_specificity': 0.9621785, 'binary_f1_score': 0.76543206}
confusion matrix:
     0    1
0  636   25
1  222  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.87288904, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.8337356, 'auroc': 0.93111074, 'binary_precision': 0.9875, 'binary_recall': 0.6839827, 'binary_specificity': 0.991342, 'binary_f1_score': 0.80818415}
confusion matrix:
     0    1
0  229    2
1   73  158
early stop counter: 6
val acc:0.8079315423965454, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 16,now: 2024-07-26 07:33:50.840214,epoch time: 0:01:02.046743,used: 0:16:35.938039,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931051, 'recall': 0.99315983, 'specificity': 0.99315983, 'f1': 0.9931272, 'auroc': 0.9997477, 'binary_precision': 0.9954634, 'binary_recall': 0.99096775, 'binary_specificity': 0.9953519, 'binary_f1_score': 0.99321043}
confusion matrix:
      0     1
0  1499     7
1    14  1536
---- Validation: 
scalar performance:
{'acc': 0.81804043, 'precision': 0.8290335, 'recall': 0.8154142, 'specificity': 0.8154142, 'f1': 0.81553066, 'auroc': 0.90192616, 'binary_precision': 0.88258314, 'binary_recall': 0.7216, 'binary_specificity': 0.90922844, 'binary_f1_score': 0.79401404}
confusion matrix:
     0    1
0  601   60
1  174  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.847447, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.82916796, 'auroc': 0.91265154, 'binary_precision': 0.92265195, 'binary_recall': 0.7229437, 'binary_specificity': 0.93939394, 'binary_f1_score': 0.8106796}
confusion matrix:
     0    1
0  217   14
1   64  167
early stop counter: 7
val acc:0.8180404305458069, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 17,now: 2024-07-26 07:34:52.750054,epoch time: 0:01:01.909840,used: 0:17:37.847879,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9840809, 'recall': 0.98388493, 'specificity': 0.98388493, 'f1': 0.98395914, 'auroc': 0.99886346, 'binary_precision': 0.9795788, 'binary_recall': 0.9890464, 'binary_specificity': 0.9787234, 'binary_f1_score': 0.9842898}
confusion matrix:
      0     1
0  1472    32
1    17  1535
---- Validation: 
scalar performance:
{'acc': 0.86314154, 'precision': 0.86439276, 'recall': 0.8622935, 'specificity': 0.8622935, 'f1': 0.8627348, 'auroc': 0.920685, 'binary_precision': 0.87986463, 'binary_recall': 0.832, 'binary_specificity': 0.892587, 'binary_f1_score': 0.8552631}
confusion matrix:
     0    1
0  590   71
1  105  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8636364, 'precision': 0.87430555, 'recall': 0.8636364, 'specificity': 0.8636364, 'f1': 0.86265767, 'auroc': 0.92355835, 'binary_precision': 0.9375, 'binary_recall': 0.77922076, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.8510638}
confusion matrix:
     0    1
0  219   12
1   51  180
early stop counter: 8
val acc:0.8631415367126465, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 18,now: 2024-07-26 07:35:54.520493,epoch time: 0:01:01.770439,used: 0:18:39.618318,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9849822, 'recall': 0.9849099, 'specificity': 0.9849099, 'f1': 0.98494226, 'auroc': 0.99892676, 'binary_precision': 0.98333335, 'binary_recall': 0.98713, 'binary_specificity': 0.98268974, 'binary_f1_score': 0.98522806}
confusion matrix:
      0     1
0  1476    26
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.70917577, 'precision': 0.7687792, 'recall': 0.70236856, 'specificity': 0.70236856, 'f1': 0.68759483, 'auroc': 0.8852962, 'binary_precision': 0.8885449, 'binary_recall': 0.4592, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.6054852}
confusion matrix:
     0    1
0  625   36
1  338  287
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5865801, 'precision': 0.703202, 'recall': 0.5865801, 'specificity': 0.5865801, 'f1': 0.5173259, 'auroc': 0.8998332, 'binary_precision': 0.85714287, 'binary_recall': 0.20779221, 'binary_specificity': 0.965368, 'binary_f1_score': 0.33449477}
confusion matrix:
     0   1
0  223   8
1  183  48
early stop counter: 9
val acc:0.7091757655143738, best validation acc: 0.8639191389083862, corresponding to test acc:                         0.8852813839912415 / 0.8852813839912415
after epoch: 19,now: 2024-07-26 07:36:57.028932,epoch time: 0:01:02.508439,used: 0:19:42.126757,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.9828403, 'recall': 0.98212874, 'specificity': 0.98212874, 'f1': 0.9823158, 'auroc': 0.99923825, 'binary_precision': 0.9704588, 'binary_recall': 0.9954868, 'binary_specificity': 0.96877074, 'binary_f1_score': 0.9828135}
confusion matrix:
      0     1
0  1458    47
1     7  1544
---- Validation: 
scalar performance:
{'acc': 0.86936235, 'precision': 0.8694004, 'recall': 0.86908567, 'specificity': 0.86908567, 'f1': 0.86920923, 'auroc': 0.92100215, 'binary_precision': 0.87034035, 'binary_recall': 0.8592, 'binary_specificity': 0.8789713, 'binary_f1_score': 0.8647343}
confusion matrix:
     0    1
0  581   80
1   88  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85714287, 'precision': 0.8571696, 'recall': 0.8571428, 'specificity': 0.8571428, 'f1': 0.8571402, 'auroc': 0.9221529, 'binary_precision': 0.86026204, 'binary_recall': 0.85281384, 'binary_specificity': 0.86147183, 'binary_f1_score': 0.8565217}
confusion matrix:
     0    1
0  199   32
1   34  197
better model found
persisted
after epoch: 20,now: 2024-07-26 07:37:59.513259,epoch time: 0:01:02.484327,used: 0:20:44.611084,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.991158, 'recall': 0.9911679, 'specificity': 0.9911679, 'f1': 0.99116284, 'auroc': 0.9995605, 'binary_precision': 0.99161834, 'binary_recall': 0.9909794, 'binary_specificity': 0.9913564, 'binary_f1_score': 0.99129874}
confusion matrix:
      0     1
0  1491    13
1    14  1538
---- Validation: 
scalar performance:
{'acc': 0.7822706, 'precision': 0.8171884, 'recall': 0.77752495, 'specificity': 0.77752495, 'f1': 0.7740008, 'auroc': 0.88665175, 'binary_precision': 0.91566265, 'binary_recall': 0.608, 'binary_specificity': 0.9470499, 'binary_f1_score': 0.7307693}
confusion matrix:
     0    1
0  626   35
1  245  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8181818, 'precision': 0.86154467, 'recall': 0.8181818, 'specificity': 0.8181818, 'f1': 0.8125616, 'auroc': 0.91975415, 'binary_precision': 0.98675495, 'binary_recall': 0.6450216, 'binary_specificity': 0.991342, 'binary_f1_score': 0.7801047}
confusion matrix:
     0    1
0  229    2
1   82  149
early stop counter: 1
val acc:0.782270610332489, best validation acc: 0.8693623542785645, corresponding to test acc:                         0.8571428656578064 / 0.8852813839912415
after epoch: 21,now: 2024-07-26 07:39:01.479520,epoch time: 0:01:01.966261,used: 0:21:46.577345,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.99149215, 'precision': 0.99149, 'recall': 0.99149, 'specificity': 0.99149, 'f1': 0.99149, 'auroc': 0.99930644, 'binary_precision': 0.9916237, 'binary_recall': 0.9916237, 'binary_specificity': 0.9913564, 'binary_f1_score': 0.9916237}
confusion matrix:
      0     1
0  1491    13
1    13  1539
---- Validation: 
scalar performance:
{'acc': 0.87791604, 'precision': 0.8787917, 'recall': 0.8772321, 'specificity': 0.8772321, 'f1': 0.87762237, 'auroc': 0.93262815, 'binary_precision': 0.8913044, 'binary_recall': 0.8528, 'binary_specificity': 0.90166414, 'binary_f1_score': 0.87162715}
confusion matrix:
     0    1
0  596   65
1   92  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8636364, 'precision': 0.8694593, 'recall': 0.8636364, 'specificity': 0.8636364, 'f1': 0.86309695, 'auroc': 0.92070985, 'binary_precision': 0.9158416, 'binary_recall': 0.8008658, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.85450345}
confusion matrix:
     0    1
0  214   17
1   46  185
better model found
persisted
after epoch: 22,now: 2024-07-26 07:40:03.564707,epoch time: 0:01:02.085187,used: 0:22:48.662532,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98567677, 'recall': 0.9857433, 'specificity': 0.9857433, 'f1': 0.98560196, 'auroc': 0.9992559, 'binary_precision': 0.9960448, 'binary_recall': 0.97546804, 'binary_specificity': 0.9960186, 'binary_f1_score': 0.9856491}
confusion matrix:
      0     1
0  1501     6
1    38  1511
---- Validation: 
scalar performance:
{'acc': 0.7045101, 'precision': 0.8015603, 'recall': 0.6963921, 'specificity': 0.6963921, 'f1': 0.6732094, 'auroc': 0.90502393, 'binary_precision': 0.9657795, 'binary_recall': 0.4064, 'binary_specificity': 0.9863843, 'binary_f1_score': 0.572072}
confusion matrix:
     0    1
0  652    9
1  371  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55627704, 'precision': 0.73171294, 'recall': 0.55627704, 'specificity': 0.55627704, 'f1': 0.4526794, 'auroc': 0.91679317, 'binary_precision': 0.93333334, 'binary_recall': 0.121212125, 'binary_specificity': 0.991342, 'binary_f1_score': 0.2145594}
confusion matrix:
     0   1
0  229   2
1  203  28
early stop counter: 1
val acc:0.7045100927352905, best validation acc: 0.8779160380363464, corresponding to test acc:                         0.8636363744735718 / 0.8852813839912415
after epoch: 23,now: 2024-07-26 07:41:05.411960,epoch time: 0:01:01.847253,used: 0:23:50.509785,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98889995, 'recall': 0.9890382, 'specificity': 0.9890382, 'f1': 0.9888737, 'auroc': 0.99952227, 'binary_precision': 0.9986877, 'binary_recall': 0.97940797, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.9889538}
confusion matrix:
      0     1
0  1500     2
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.83825815, 'precision': 0.86341155, 'recall': 0.8345586, 'specificity': 0.8345586, 'f1': 0.8342492, 'auroc': 0.93698514, 'binary_precision': 0.95227766, 'binary_recall': 0.7024, 'binary_specificity': 0.9667171, 'binary_f1_score': 0.8084715}
confusion matrix:
     0    1
0  639   22
1  186  439
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7467533, 'precision': 0.8208333, 'recall': 0.7467532, 'specificity': 0.7467532, 'f1': 0.73123914, 'auroc': 0.9149941, 'binary_precision': 0.975, 'binary_recall': 0.5064935, 'binary_specificity': 0.987013, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  228    3
1  114  117
early stop counter: 2
val acc:0.8382581472396851, best validation acc: 0.8779160380363464, corresponding to test acc:                         0.8636363744735718 / 0.8852813839912415
after epoch: 24,now: 2024-07-26 07:42:08.089657,epoch time: 0:01:02.677697,used: 0:24:53.187482,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.99408734, 'recall': 0.9941382, 'specificity': 0.9941382, 'f1': 0.9941089, 'auroc': 0.9997057, 'binary_precision': 0.9961165, 'binary_recall': 0.9922631, 'binary_specificity': 0.9960133, 'binary_f1_score': 0.99418604}
confusion matrix:
      0     1
0  1499     6
1    12  1539
---- Validation: 
scalar performance:
{'acc': 0.8102644, 'precision': 0.8347919, 'recall': 0.8064121, 'specificity': 0.8064121, 'f1': 0.8052676, 'auroc': 0.90377486, 'binary_precision': 0.9186813, 'binary_recall': 0.6688, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.7740741}
confusion matrix:
     0    1
0  624   37
1  207  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7683983, 'precision': 0.8287879, 'recall': 0.7683983, 'specificity': 0.7683983, 'f1': 0.7572517, 'auroc': 0.92320234, 'binary_precision': 0.969697, 'binary_recall': 0.55411255, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.70523417}
confusion matrix:
     0    1
0  227    4
1  103  128
early stop counter: 3
val acc:0.8102644085884094, best validation acc: 0.8779160380363464, corresponding to test acc:                         0.8636363744735718 / 0.8852813839912415
after epoch: 25,now: 2024-07-26 07:43:10.419825,epoch time: 0:01:02.330168,used: 0:25:55.517650,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99640054, 'precision': 0.9963785, 'recall': 0.99642634, 'specificity': 0.99642634, 'f1': 0.99639976, 'auroc': 0.99982476, 'binary_precision': 0.998062, 'binary_recall': 0.99484867, 'binary_specificity': 0.998004, 'binary_f1_score': 0.99645275}
confusion matrix:
      0     1
0  1500     3
1     8  1545
---- Validation: 
scalar performance:
{'acc': 0.88258165, 'precision': 0.88722694, 'recall': 0.88107353, 'specificity': 0.88107353, 'f1': 0.8818529, 'auroc': 0.930043, 'binary_precision': 0.92321426, 'binary_recall': 0.8272, 'binary_specificity': 0.9349471, 'binary_f1_score': 0.87257385}
confusion matrix:
     0    1
0  618   43
1  108  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85930735, 'precision': 0.8809004, 'recall': 0.8593074, 'specificity': 0.8593074, 'f1': 0.8572848, 'auroc': 0.9377682, 'binary_precision': 0.97159094, 'binary_recall': 0.74025977, 'binary_specificity': 0.978355, 'binary_f1_score': 0.8402949}
confusion matrix:
     0    1
0  226    5
1   60  171
better model found
persisted
after epoch: 26,now: 2024-07-26 07:44:12.524048,epoch time: 0:01:02.104223,used: 0:26:57.621873,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98856163, 'recall': 0.9885271, 'specificity': 0.9885271, 'f1': 0.9885434, 'auroc': 0.9995185, 'binary_precision': 0.987797, 'binary_recall': 0.989704, 'binary_specificity': 0.9873502, 'binary_f1_score': 0.9887496}
confusion matrix:
      0     1
0  1483    19
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.88413686, 'precision': 0.8902767, 'recall': 0.8824121, 'specificity': 0.8824121, 'f1': 0.88326716, 'auroc': 0.9329065, 'binary_precision': 0.9327273, 'binary_recall': 0.8208, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.8731915}
confusion matrix:
     0    1
0  624   37
1  112  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86147183, 'precision': 0.88579315, 'recall': 0.8614719, 'specificity': 0.8614719, 'f1': 0.85925364, 'auroc': 0.9351773, 'binary_precision': 0.982659, 'binary_recall': 0.73593074, 'binary_specificity': 0.987013, 'binary_f1_score': 0.84158415}
confusion matrix:
     0    1
0  228    3
1   61  170
better model found
persisted
after epoch: 27,now: 2024-07-26 07:45:14.535978,epoch time: 0:01:02.011930,used: 0:27:59.633803,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.99089146, 'recall': 0.9907905, 'specificity': 0.9907905, 'f1': 0.9908342, 'auroc': 0.9997219, 'binary_precision': 0.98847634, 'binary_recall': 0.993565, 'binary_specificity': 0.98801595, 'binary_f1_score': 0.9910141}
confusion matrix:
      0     1
0  1484    18
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.87713844, 'precision': 0.8815588, 'recall': 0.8756478, 'specificity': 0.8756478, 'f1': 0.87639093, 'auroc': 0.9290457, 'binary_precision': 0.916221, 'binary_recall': 0.8224, 'binary_specificity': 0.9288956, 'binary_f1_score': 0.8667791}
confusion matrix:
     0    1
0  614   47
1  111  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701299, 'precision': 0.88541317, 'recall': 0.8701299, 'specificity': 0.8701299, 'f1': 0.8688295, 'auroc': 0.9307734, 'binary_precision': 0.96216214, 'binary_recall': 0.77056277, 'binary_specificity': 0.969697, 'binary_f1_score': 0.8557692}
confusion matrix:
     0    1
0  224    7
1   53  178
early stop counter: 1
val acc:0.8771384358406067, best validation acc: 0.8841368556022644, corresponding to test acc:                         0.8614718317985535 / 0.8852813839912415
after epoch: 28,now: 2024-07-26 07:46:16.807870,epoch time: 0:01:02.271892,used: 0:29:01.905695,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98758465, 'recall': 0.9877351, 'specificity': 0.9877351, 'f1': 0.9875647, 'auroc': 0.9993248, 'binary_precision': 0.99737704, 'binary_recall': 0.97813505, 'binary_specificity': 0.99733514, 'binary_f1_score': 0.9876624}
confusion matrix:
      0     1
0  1497     4
1    34  1521
---- Validation: 
scalar performance:
{'acc': 0.7939347, 'precision': 0.8367381, 'recall': 0.7888714, 'specificity': 0.7888714, 'f1': 0.78508204, 'auroc': 0.93516916, 'binary_precision': 0.95, 'binary_recall': 0.608, 'binary_specificity': 0.96974283, 'binary_f1_score': 0.7414634}
confusion matrix:
     0    1
0  641   20
1  245  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5735931, 'precision': 0.7698598, 'recall': 0.5735931, 'specificity': 0.5735931, 'f1': 0.47883302, 'auroc': 0.9210097, 'binary_precision': 1.0, 'binary_recall': 0.14718615, 'binary_specificity': 1.0, 'binary_f1_score': 0.25660378}
confusion matrix:
     0   1
0  231   0
1  197  34
early stop counter: 2
val acc:0.79393470287323, best validation acc: 0.8841368556022644, corresponding to test acc:                         0.8614718317985535 / 0.8852813839912415
after epoch: 29,now: 2024-07-26 07:47:18.920933,epoch time: 0:01:02.113063,used: 0:30:04.018758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99075335, 'recall': 0.99039066, 'specificity': 0.99039066, 'f1': 0.9905056, 'auroc': 0.99981487, 'binary_precision': 0.98285717, 'binary_recall': 0.9987097, 'binary_specificity': 0.9820717, 'binary_f1_score': 0.99072}
confusion matrix:
      0     1
0  1479    27
1     2  1548
---- Validation: 
scalar performance:
{'acc': 0.87869364, 'precision': 0.88147986, 'recall': 0.87750924, 'specificity': 0.87750924, 'f1': 0.8781487, 'auroc': 0.93003094, 'binary_precision': 0.90782607, 'binary_recall': 0.8352, 'binary_specificity': 0.91981846, 'binary_f1_score': 0.87}
confusion matrix:
     0    1
0  608   53
1  103  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.8640499, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.84199727, 'auroc': 0.9219842, 'binary_precision': 0.9491525, 'binary_recall': 0.72727275, 'binary_specificity': 0.96103895, 'binary_f1_score': 0.8235295}
confusion matrix:
     0    1
0  222    9
1   63  168
early stop counter: 3
val acc:0.8786936402320862, best validation acc: 0.8841368556022644, corresponding to test acc:                         0.8614718317985535 / 0.8852813839912415
after epoch: 30,now: 2024-07-26 07:48:21.175196,epoch time: 0:01:02.254263,used: 0:31:06.273021,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_17_14_seed_5_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:06.273021 at 2024-07-26 07:48:21.175196
persisted model performance metric: 

scalar performance:
{'acc': 0.86147183, 'precision': 0.88579315, 'recall': 0.8614719, 'specificity': 0.8614719, 'f1': 0.85925364, 'auroc': 0.9351773, 'binary_precision': 0.982659, 'binary_recall': 0.73593074, 'binary_specificity': 0.987013, 'binary_f1_score': 0.84158415}
confusion matrix:
     0    1
0  228    3
1   61  170
oracle model performance metric: 

scalar performance:
{'acc': 0.8852814, 'precision': 0.89234734, 'recall': 0.8852814, 'specificity': 0.8852814, 'f1': 0.8847625, 'auroc': 0.9470587, 'binary_precision': 0.945, 'binary_recall': 0.8181818, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.87703013}
confusion matrix:
     0    1
0  220   11
1   42  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 441767 GiB | 441767 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 436549 GiB | 436548 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 441767 GiB | 441767 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 436549 GiB | 436548 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 441039 GiB | 441038 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 435831 GiB | 435830 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  82456 MiB |  67982 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  82304 MiB |  67896 MiB |
|       from small pool |     66 MiB |     70 MiB |    152 MiB |     86 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 315331 GiB | 315330 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 310079 GiB | 310078 GiB |
|       from small pool |  10601 KiB |     44 MiB |   5251 GiB |   5251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77544 K  |   77543 K  |
|       from large pool |     187    |    1413    |   39426 K  |   39426 K  |
|       from small pool |    1123    |    1419    |   38118 K  |   38116 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77544 K  |   77543 K  |
|       from large pool |     187    |    1413    |   39426 K  |   39426 K  |
|       from small pool |    1123    |    1419    |   38118 K  |   38116 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    3497    |    2863    |
|       from large pool |     601    |     601    |    3421    |    2820    |
|       from small pool |      33    |      35    |      76    |      43    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     652    |   50244 K  |   50244 K  |
|       from large pool |      40    |     604    |   27962 K  |   27962 K  |
|       from small pool |      59    |     236    |   22282 K  |   22282 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 441767 GiB | 441767 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 436549 GiB | 436549 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 441767 GiB | 441767 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 436549 GiB | 436549 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 441039 GiB | 441039 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 435831 GiB | 435831 GiB |
|       from small pool |      0 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  82456 MiB |  81576 MiB |
|       from large pool |    830 MiB |  14414 MiB |  82304 MiB |  81474 MiB |
|       from small pool |     50 MiB |     70 MiB |    152 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 315331 GiB | 315331 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 310079 GiB | 310079 GiB |
|       from small pool |      0 KiB |     44 MiB |   5251 GiB |   5251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    3497    |    3435    |
|       from large pool |      37    |     601    |    3421    |    3384    |
|       from small pool |      25    |      35    |      76    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   50245 K  |   50245 K  |
|       from large pool |       4    |     604    |   27962 K  |   27962 K  |
|       from small pool |       0    |     236    |   22282 K  |   22282 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 441767 GiB | 441767 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 436549 GiB | 436549 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 441767 GiB | 441767 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 436549 GiB | 436549 GiB |
|       from small pool |      0 KiB |     60 MiB |   5218 GiB |   5218 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 441039 GiB | 441039 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 435831 GiB | 435831 GiB |
|       from small pool |      0 KiB |     60 MiB |   5207 GiB |   5207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  82456 MiB |  81576 MiB |
|       from large pool |    830 MiB |  14414 MiB |  82304 MiB |  81474 MiB |
|       from small pool |     50 MiB |     70 MiB |    152 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 315331 GiB | 315331 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 310079 GiB | 310079 GiB |
|       from small pool |      0 KiB |     44 MiB |   5251 GiB |   5251 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77544 K  |   77544 K  |
|       from large pool |       2    |    1413    |   39426 K  |   39426 K  |
|       from small pool |       0    |    1419    |   38118 K  |   38118 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    3497    |    3435    |
|       from large pool |      37    |     601    |    3421    |    3384    |
|       from small pool |      25    |      35    |      76    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   50245 K  |   50245 K  |
|       from large pool |       4    |     604    |   27962 K  |   27962 K  |
|       from small pool |       0    |     236    |   22282 K  |   22282 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536

 Experiment start at: 2024-07-26 07:48:47.479158
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94108075, 'precision': 0.9411013, 'recall': 0.94105285, 'specificity': 0.94105285, 'f1': 0.9410722, 'auroc': 0.98310214, 'binary_precision': 0.9396662, 'binary_recall': 0.94390714, 'binary_specificity': 0.93819857, 'binary_f1_score': 0.94178194}
confusion matrix:
      0     1
0  1427    94
1    87  1464
---- Validation: 
scalar performance:
{'acc': 0.78132296, 'precision': 0.81868863, 'recall': 0.78251684, 'specificity': 0.78251684, 'f1': 0.7752044, 'auroc': 0.92582595, 'binary_precision': 0.7077998, 'binary_recall': 0.9529781, 'binary_specificity': 0.61205566, 'binary_f1_score': 0.8122913}
confusion matrix:
     0    1
0  396  251
1   30  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378378, 'precision': 0.8450062, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.8369911, 'auroc': 0.93900657, 'binary_precision': 0.79527557, 'binary_recall': 0.9099099, 'binary_specificity': 0.7657658, 'binary_f1_score': 0.8487395}
confusion matrix:
     0    1
0  170   52
1   20  202
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:49:51.984547,epoch time: 0:01:04.505389,used: 0:01:04.505389,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9715036, 'recall': 0.9712188, 'specificity': 0.9712188, 'f1': 0.9710268, 'auroc': 0.9962379, 'binary_precision': 0.9892977, 'binary_recall': 0.9529639, 'binary_specificity': 0.9894737, 'binary_f1_score': 0.970791}
confusion matrix:
      0     1
0  1504    16
1    73  1479
---- Validation: 
scalar performance:
{'acc': 0.81089497, 'precision': 0.8126228, 'recall': 0.8106295, 'specificity': 0.8106295, 'f1': 0.8105351, 'auroc': 0.8762264, 'binary_precision': 0.83417934, 'binary_recall': 0.77272725, 'binary_specificity': 0.84853166, 'binary_f1_score': 0.8022782}
confusion matrix:
     0    1
0  549   98
1  145  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8400901, 'precision': 0.84259963, 'recall': 0.8400901, 'specificity': 0.8400901, 'f1': 0.8397967, 'auroc': 0.940224, 'binary_precision': 0.813278, 'binary_recall': 0.8828829, 'binary_specificity': 0.7972973, 'binary_f1_score': 0.84665227}
confusion matrix:
     0    1
0  177   45
1   26  196
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 07:50:54.269783,epoch time: 0:01:02.285236,used: 0:02:06.790625,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97786456, 'precision': 0.9785621, 'recall': 0.97769713, 'specificity': 0.97769713, 'f1': 0.97784877, 'auroc': 0.99875927, 'binary_precision': 0.9625702, 'binary_recall': 0.99484205, 'binary_specificity': 0.9605523, 'binary_f1_score': 0.9784401}
confusion matrix:
      0     1
0  1461    60
1     8  1543
---- Validation: 
scalar performance:
{'acc': 0.755642, 'precision': 0.7860223, 'recall': 0.75677466, 'specificity': 0.75677466, 'f1': 0.74951327, 'auroc': 0.8885088, 'binary_precision': 0.6910377, 'binary_recall': 0.9184953, 'binary_specificity': 0.5950541, 'binary_f1_score': 0.78869444}
confusion matrix:
     0    1
0  385  262
1   52  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.713964, 'precision': 0.8002306, 'recall': 0.713964, 'specificity': 0.713964, 'f1': 0.69182676, 'auroc': 0.92462057, 'binary_precision': 0.6392962, 'binary_recall': 0.981982, 'binary_specificity': 0.44594595, 'binary_f1_score': 0.77442276}
confusion matrix:
    0    1
0  99  123
1   4  218
early stop counter: 1
val acc:0.7556419968605042, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.8400900959968567 / 0.8400900959968567
after epoch: 3,now: 2024-07-26 07:51:56.453381,epoch time: 0:01:02.183598,used: 0:03:08.974223,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9625651, 'precision': 0.96409416, 'recall': 0.96293, 'specificity': 0.96293, 'f1': 0.96255034, 'auroc': 0.9966405, 'binary_precision': 0.99382293, 'binary_recall': 0.9317889, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9618067}
confusion matrix:
      0     1
0  1509     9
1   106  1448
---- Validation: 
scalar performance:
{'acc': 0.644358, 'precision': 0.7733535, 'recall': 0.6419368, 'specificity': 0.6419368, 'f1': 0.59464705, 'auroc': 0.87152183, 'binary_precision': 0.9593909, 'binary_recall': 0.29623824, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.45269462}
confusion matrix:
     0    1
0  639    8
1  449  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7477477, 'precision': 0.8245614, 'recall': 0.7477478, 'specificity': 0.7477478, 'f1': 0.73188406, 'auroc': 0.90877366, 'binary_precision': 0.98245615, 'binary_recall': 0.5045045, 'binary_specificity': 0.990991, 'binary_f1_score': 0.6666666}
confusion matrix:
     0    1
0  220    2
1  110  112
early stop counter: 2
val acc:0.6443579792976379, best validation acc: 0.8108949661254883, corresponding to test acc:                         0.8400900959968567 / 0.8400900959968567
after epoch: 4,now: 2024-07-26 07:52:58.481124,epoch time: 0:01:02.027743,used: 0:04:11.001966,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.97069716, 'recall': 0.9707475, 'specificity': 0.9707475, 'f1': 0.9707021, 'auroc': 0.9954824, 'binary_precision': 0.97529256, 'binary_recall': 0.96649486, 'binary_specificity': 0.975, 'binary_f1_score': 0.9708738}
confusion matrix:
      0     1
0  1482    38
1    52  1500
---- Validation: 
scalar performance:
{'acc': 0.82645917, 'precision': 0.84428465, 'recall': 0.8256602, 'specificity': 0.8256602, 'f1': 0.82393026, 'auroc': 0.9025476, 'binary_precision': 0.9208925, 'binary_recall': 0.71159875, 'binary_specificity': 0.93972176, 'binary_f1_score': 0.8028293}
confusion matrix:
     0    1
0  608   39
1  184  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355856, 'precision': 0.8592701, 'recall': 0.8355856, 'specificity': 0.8355856, 'f1': 0.8328304, 'auroc': 0.9190812, 'binary_precision': 0.95151514, 'binary_recall': 0.7072072, 'binary_specificity': 0.963964, 'binary_f1_score': 0.8113695}
confusion matrix:
     0    1
0  214    8
1   65  157
better model found
persisted
after epoch: 5,now: 2024-07-26 07:54:01.234708,epoch time: 0:01:02.753584,used: 0:05:13.755550,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97892016, 'recall': 0.9787856, 'specificity': 0.9787856, 'f1': 0.97883534, 'auroc': 0.99783456, 'binary_precision': 0.9751276, 'binary_recall': 0.98327976, 'binary_specificity': 0.9742914, 'binary_f1_score': 0.97918665}
confusion matrix:
      0     1
0  1478    39
1    26  1529
---- Validation: 
scalar performance:
{'acc': 0.833463, 'precision': 0.83908796, 'recall': 0.83391273, 'specificity': 0.83391273, 'f1': 0.8328938, 'auroc': 0.91479117, 'binary_precision': 0.7936288, 'binary_recall': 0.89811915, 'binary_specificity': 0.7697063, 'binary_f1_score': 0.84264714}
confusion matrix:
     0    1
0  498  149
1   65  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7972973, 'precision': 0.813184, 'recall': 0.7972973, 'specificity': 0.7972973, 'f1': 0.7946937, 'auroc': 0.9151448, 'binary_precision': 0.74264705, 'binary_recall': 0.9099099, 'binary_specificity': 0.6846847, 'binary_f1_score': 0.8178138}
confusion matrix:
     0    1
0  152   70
1   20  202
better model found
persisted
after epoch: 6,now: 2024-07-26 07:55:03.282708,epoch time: 0:01:02.048000,used: 0:06:15.803550,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9860806, 'recall': 0.9861253, 'specificity': 0.9861253, 'f1': 0.98600256, 'auroc': 0.9993514, 'binary_precision': 0.996063, 'binary_recall': 0.97620577, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9860344}
confusion matrix:
      0     1
0  1511     6
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.81089497, 'precision': 0.84006095, 'recall': 0.80986637, 'specificity': 0.80986637, 'f1': 0.8063906, 'auroc': 0.9057847, 'binary_precision': 0.93791574, 'binary_recall': 0.6630094, 'binary_specificity': 0.95672333, 'binary_f1_score': 0.7768595}
confusion matrix:
     0    1
0  619   28
1  215  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8468468, 'precision': 0.8686594, 'recall': 0.8468468, 'specificity': 0.8468468, 'f1': 0.8445475, 'auroc': 0.9165043, 'binary_precision': 0.9583333, 'binary_recall': 0.7252252, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.8256411}
confusion matrix:
     0    1
0  215    7
1   61  161
new oracle model saved
early stop counter: 1
val acc:0.8108949661254883, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8468468189239502
after epoch: 7,now: 2024-07-26 07:56:05.150561,epoch time: 0:01:01.867853,used: 0:07:17.671403,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98476136, 'recall': 0.984815, 'specificity': 0.984815, 'f1': 0.98470044, 'auroc': 0.998247, 'binary_precision': 0.99410224, 'binary_recall': 0.9755627, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9847452}
confusion matrix:
      0     1
0  1508     9
1    38  1517
---- Validation: 
scalar performance:
{'acc': 0.770428, 'precision': 0.807776, 'recall': 0.7692013, 'specificity': 0.7692013, 'f1': 0.7626927, 'auroc': 0.87926435, 'binary_precision': 0.913253, 'binary_recall': 0.5940439, 'binary_specificity': 0.9443586, 'binary_f1_score': 0.7198481}
confusion matrix:
     0    1
0  611   36
1  259  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.786036, 'precision': 0.78604186, 'recall': 0.786036, 'specificity': 0.786036, 'f1': 0.786035, 'auroc': 0.8631402, 'binary_precision': 0.7873303, 'binary_recall': 0.7837838, 'binary_specificity': 0.7882883, 'binary_f1_score': 0.7855531}
confusion matrix:
     0    1
0  175   47
1   48  174
early stop counter: 2
val acc:0.7704280018806458, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8468468189239502
after epoch: 8,now: 2024-07-26 07:57:07.131347,epoch time: 0:01:01.980786,used: 0:08:19.652189,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96516925, 'precision': 0.9666871, 'recall': 0.9649085, 'specificity': 0.9649085, 'f1': 0.9651237, 'auroc': 0.99821496, 'binary_precision': 0.94240195, 'binary_recall': 0.99161834, 'binary_specificity': 0.93819857, 'binary_f1_score': 0.9663839}
confusion matrix:
      0     1
0  1427    94
1    13  1538
---- Validation: 
scalar performance:
{'acc': 0.82879376, 'precision': 0.8396299, 'recall': 0.8294177, 'specificity': 0.8294177, 'f1': 0.82759845, 'auroc': 0.9200021, 'binary_precision': 0.7771883, 'binary_recall': 0.9184953, 'binary_specificity': 0.74034005, 'binary_f1_score': 0.84195405}
confusion matrix:
     0    1
0  479  168
1   52  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8085586, 'precision': 0.8205861, 'recall': 0.8085586, 'specificity': 0.8085586, 'f1': 0.806746, 'auroc': 0.92494524, 'binary_precision': 0.75849056, 'binary_recall': 0.9054054, 'binary_specificity': 0.7117117, 'binary_f1_score': 0.82546204}
confusion matrix:
     0    1
0  158   64
1   21  201
early stop counter: 3
val acc:0.8287937641143799, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8468468189239502
after epoch: 9,now: 2024-07-26 07:58:09.115995,epoch time: 0:01:01.984648,used: 0:09:21.636837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99184525, 'recall': 0.99188757, 'specificity': 0.99188757, 'f1': 0.9918612, 'auroc': 0.9997109, 'binary_precision': 0.9941823, 'binary_recall': 0.989704, 'binary_specificity': 0.9940711, 'binary_f1_score': 0.9919381}
confusion matrix:
      0     1
0  1509     9
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.81945527, 'precision': 0.8229595, 'recall': 0.8190867, 'specificity': 0.8190867, 'f1': 0.8188381, 'auroc': 0.88381386, 'binary_precision': 0.8548951, 'binary_recall': 0.7664577, 'binary_specificity': 0.8717156, 'binary_f1_score': 0.8082645}
confusion matrix:
     0    1
0  564   83
1  149  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8513514, 'precision': 0.8570309, 'recall': 0.8513514, 'specificity': 0.8513514, 'f1': 0.85075784, 'auroc': 0.91346073, 'binary_precision': 0.9020619, 'binary_recall': 0.7882883, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.8413462}
confusion matrix:
     0    1
0  203   19
1   47  175
new oracle model saved
early stop counter: 4
val acc:0.8194552659988403, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 10,now: 2024-07-26 07:59:12.131432,epoch time: 0:01:03.015437,used: 0:10:24.652274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9882611, 'recall': 0.9883058, 'specificity': 0.9883058, 'f1': 0.9882796, 'auroc': 0.9994137, 'binary_precision': 0.99032885, 'binary_recall': 0.98651254, 'binary_specificity': 0.990099, 'binary_f1_score': 0.98841697}
confusion matrix:
      0     1
0  1500    15
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.7143969, 'precision': 0.775923, 'recall': 0.7127313, 'specificity': 0.7127313, 'f1': 0.69650507, 'auroc': 0.84258187, 'binary_precision': 0.9044776, 'binary_recall': 0.47492164, 'binary_specificity': 0.95054096, 'binary_f1_score': 0.622816}
confusion matrix:
     0    1
0  615   32
1  335  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.87337345, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.838997, 'auroc': 0.91664636, 'binary_precision': 0.98101264, 'binary_recall': 0.6981982, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.8157894}
confusion matrix:
     0    1
0  219    3
1   67  155
early stop counter: 5
val acc:0.7143968939781189, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 11,now: 2024-07-26 08:00:13.952166,epoch time: 0:01:01.820734,used: 0:11:26.473008,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848979, 'recall': 0.98488903, 'specificity': 0.98488903, 'f1': 0.98470056, 'auroc': 0.9990288, 'binary_precision': 0.998679, 'binary_recall': 0.97109824, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98469555}
confusion matrix:
      0     1
0  1513     2
1    45  1512
---- Validation: 
scalar performance:
{'acc': 0.70428014, 'precision': 0.78148055, 'recall': 0.7024342, 'specificity': 0.7024342, 'f1': 0.6813079, 'auroc': 0.90016866, 'binary_precision': 0.92715234, 'binary_recall': 0.43887147, 'binary_specificity': 0.9659969, 'binary_f1_score': 0.59574467}
confusion matrix:
     0    1
0  625   22
1  358  280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6081081, 'precision': 0.780303, 'recall': 0.6081081, 'specificity': 0.6081081, 'f1': 0.5370011, 'auroc': 0.8884121, 'binary_precision': 1.0, 'binary_recall': 0.21621622, 'binary_specificity': 1.0, 'binary_f1_score': 0.35555556}
confusion matrix:
     0   1
0  222   0
1  174  48
early stop counter: 6
val acc:0.7042801380157471, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 12,now: 2024-07-26 08:01:15.925497,epoch time: 0:01:01.973331,used: 0:12:28.446339,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899249, 'recall': 0.9899683, 'specificity': 0.9899683, 'f1': 0.9899087, 'auroc': 0.9995345, 'binary_precision': 0.99608356, 'binary_recall': 0.98388135, 'binary_specificity': 0.99605525, 'binary_f1_score': 0.9899448}
confusion matrix:
      0     1
0  1515     6
1    25  1526
---- Validation: 
scalar performance:
{'acc': 0.7307393, 'precision': 0.7954378, 'recall': 0.72909087, 'specificity': 0.72909087, 'f1': 0.71421385, 'auroc': 0.87730694, 'binary_precision': 0.93195266, 'binary_recall': 0.4937304, 'binary_specificity': 0.9644513, 'binary_f1_score': 0.6454918}
confusion matrix:
     0    1
0  624   23
1  323  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6576577, 'precision': 0.79679143, 'recall': 0.6576576, 'specificity': 0.6576576, 'f1': 0.61220926, 'auroc': 0.88274086, 'binary_precision': 1.0, 'binary_recall': 0.3153153, 'binary_specificity': 1.0, 'binary_f1_score': 0.47945207}
confusion matrix:
     0   1
0  222   0
1  152  70
early stop counter: 7
val acc:0.7307392954826355, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 13,now: 2024-07-26 08:02:17.680036,epoch time: 0:01:01.754539,used: 0:13:30.200878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9847655, 'recall': 0.9848356, 'specificity': 0.9848356, 'f1': 0.9847003, 'auroc': 0.998698, 'binary_precision': 0.99475753, 'binary_recall': 0.9749518, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.98475504}
confusion matrix:
      0     1
0  1507     8
1    39  1518
---- Validation: 
scalar performance:
{'acc': 0.7470817, 'precision': 0.79531646, 'recall': 0.74565756, 'specificity': 0.74565756, 'f1': 0.73558015, 'auroc': 0.89518535, 'binary_precision': 0.91292876, 'binary_recall': 0.5423198, 'binary_specificity': 0.94899535, 'binary_f1_score': 0.6804326}
confusion matrix:
     0    1
0  614   33
1  292  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6238739, 'precision': 0.7767578, 'recall': 0.6238739, 'specificity': 0.6238739, 'f1': 0.5636068, 'auroc': 0.89862835, 'binary_precision': 0.98245615, 'binary_recall': 0.25225225, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.40143368}
confusion matrix:
     0   1
0  221   1
1  166  56
early stop counter: 8
val acc:0.7470816969871521, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 14,now: 2024-07-26 08:03:19.422924,epoch time: 0:01:01.742888,used: 0:14:31.943766,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899048, 'recall': 0.9899877, 'specificity': 0.9899877, 'f1': 0.98990834, 'auroc': 0.9995434, 'binary_precision': 0.9960963, 'binary_recall': 0.98393315, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98997736}
confusion matrix:
      0     1
0  1510     6
1    25  1531
---- Validation: 
scalar performance:
{'acc': 0.79844356, 'precision': 0.82510924, 'recall': 0.79743624, 'specificity': 0.79743624, 'f1': 0.79384106, 'auroc': 0.89868665, 'binary_precision': 0.9164835, 'binary_recall': 0.65360504, 'binary_specificity': 0.9412674, 'binary_f1_score': 0.76303756}
confusion matrix:
     0    1
0  609   38
1  221  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.86405766, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.847533, 'auroc': 0.918574, 'binary_precision': 0.9378531, 'binary_recall': 0.7477477, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.8320802}
confusion matrix:
     0    1
0  211   11
1   56  166
early stop counter: 9
val acc:0.7984435558319092, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 15,now: 2024-07-26 08:04:22.683738,epoch time: 0:01:03.260814,used: 0:15:35.204580,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905804, 'recall': 0.99054193, 'specificity': 0.99054193, 'f1': 0.9905585, 'auroc': 0.9996723, 'binary_precision': 0.98908156, 'binary_recall': 0.992268, 'binary_specificity': 0.9888158, 'binary_f1_score': 0.99067223}
confusion matrix:
      0     1
0  1503    17
1    12  1540
---- Validation: 
scalar performance:
{'acc': 0.82801557, 'precision': 0.8429741, 'recall': 0.8272822, 'specificity': 0.8272822, 'f1': 0.82588947, 'auroc': 0.8973826, 'binary_precision': 0.9128713, 'binary_recall': 0.72257054, 'binary_specificity': 0.93199384, 'binary_f1_score': 0.8066492}
confusion matrix:
     0    1
0  603   44
1  177  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.8579974, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.8481555, 'auroc': 0.9003125, 'binary_precision': 0.9144385, 'binary_recall': 0.7702703, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.83618575}
confusion matrix:
     0    1
0  206   16
1   51  171
early stop counter: 10
val acc:0.8280155658721924, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 16,now: 2024-07-26 08:05:24.687759,epoch time: 0:01:02.004021,used: 0:16:37.208601,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98798, 'recall': 0.9880419, 'specificity': 0.9880419, 'f1': 0.9879556, 'auroc': 0.99962056, 'binary_precision': 0.99542785, 'binary_recall': 0.980695, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.98800653}
confusion matrix:
      0     1
0  1511     7
1    30  1524
---- Validation: 
scalar performance:
{'acc': 0.8101167, 'precision': 0.8395476, 'recall': 0.8090826, 'specificity': 0.8090826, 'f1': 0.80554646, 'auroc': 0.91470885, 'binary_precision': 0.93777776, 'binary_recall': 0.661442, 'binary_specificity': 0.95672333, 'binary_f1_score': 0.77573526}
confusion matrix:
     0    1
0  619   28
1  216  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130631, 'precision': 0.84443575, 'recall': 0.8130631, 'specificity': 0.8130631, 'f1': 0.8087071, 'auroc': 0.8993994, 'binary_precision': 0.9483871, 'binary_recall': 0.6621622, 'binary_specificity': 0.963964, 'binary_f1_score': 0.7798409}
confusion matrix:
     0    1
0  214    8
1   75  147
early stop counter: 11
val acc:0.810116708278656, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 17,now: 2024-07-26 08:06:26.664614,epoch time: 0:01:01.976855,used: 0:17:39.185456,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.9902874, 'recall': 0.99034566, 'specificity': 0.99034566, 'f1': 0.9902343, 'auroc': 0.99975705, 'binary_precision': 0.9993451, 'binary_recall': 0.9813505, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9902661}
confusion matrix:
      0     1
0  1516     1
1    29  1526
---- Validation: 
scalar performance:
{'acc': 0.7688716, 'precision': 0.8195915, 'recall': 0.76747036, 'specificity': 0.76747036, 'f1': 0.75868607, 'auroc': 0.9028449, 'binary_precision': 0.9451697, 'binary_recall': 0.56739813, 'binary_specificity': 0.9675425, 'binary_f1_score': 0.7091087}
confusion matrix:
     0    1
0  626   21
1  276  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355856, 'precision': 0.8670521, 'recall': 0.8355856, 'specificity': 0.8355856, 'f1': 0.8319847, 'auroc': 0.89749205, 'binary_precision': 0.9745223, 'binary_recall': 0.6891892, 'binary_specificity': 0.981982, 'binary_f1_score': 0.8073879}
confusion matrix:
     0    1
0  218    4
1   69  153
early stop counter: 12
val acc:0.7688716053962708, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.8513513803482056
after epoch: 18,now: 2024-07-26 08:07:28.480390,epoch time: 0:01:01.815776,used: 0:18:41.001232,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98817426, 'recall': 0.98785865, 'specificity': 0.98785865, 'f1': 0.98795104, 'auroc': 0.9995769, 'binary_precision': 0.9803673, 'binary_recall': 0.996139, 'binary_specificity': 0.9795784, 'binary_f1_score': 0.9881903}
confusion matrix:
      0     1
0  1487    31
1     6  1548
---- Validation: 
scalar performance:
{'acc': 0.833463, 'precision': 0.84228724, 'recall': 0.83289886, 'specificity': 0.83289886, 'f1': 0.8322111, 'auroc': 0.9094761, 'binary_precision': 0.8955224, 'binary_recall': 0.7523511, 'binary_specificity': 0.91344666, 'binary_f1_score': 0.81771725}
confusion matrix:
     0    1
0  591   56
1  158  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8806306, 'precision': 0.8840673, 'recall': 0.8806306, 'specificity': 0.8806306, 'f1': 0.880363, 'auroc': 0.9294903, 'binary_precision': 0.920398, 'binary_recall': 0.8333333, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.8747045}
confusion matrix:
     0    1
0  206   16
1   37  185
new oracle model saved
early stop counter: 13
val acc:0.8334630131721497, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.880630612373352
after epoch: 19,now: 2024-07-26 08:08:30.546516,epoch time: 0:01:02.066126,used: 0:19:43.067358,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98811054, 'recall': 0.98808753, 'specificity': 0.98808753, 'f1': 0.98795575, 'auroc': 0.9998088, 'binary_precision': 1.0, 'binary_recall': 0.9761751, 'binary_specificity': 1.0, 'binary_f1_score': 0.987944}
confusion matrix:
      0     1
0  1519     0
1    37  1516
---- Validation: 
scalar performance:
{'acc': 0.6583658, 'precision': 0.7759495, 'recall': 0.6560651, 'specificity': 0.6560651, 'f1': 0.61573625, 'auroc': 0.8995224, 'binary_precision': 0.9543379, 'binary_recall': 0.3275862, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.48774797}
confusion matrix:
     0    1
0  637   10
1  429  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7972973, 'precision': 0.85272026, 'recall': 0.7972973, 'specificity': 0.7972973, 'f1': 0.78900903, 'auroc': 0.9376066, 'binary_precision': 0.9925373, 'binary_recall': 0.5990991, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.747191}
confusion matrix:
     0    1
0  221    1
1   89  133
early stop counter: 14
val acc:0.658365786075592, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.880630612373352
after epoch: 20,now: 2024-07-26 08:09:33.536192,epoch time: 0:01:02.989676,used: 0:20:46.057034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898993, 'recall': 0.9899647, 'specificity': 0.9899647, 'f1': 0.98990846, 'auroc': 0.99964267, 'binary_precision': 0.9948018, 'binary_recall': 0.9851995, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.9899774}
confusion matrix:
      0     1
0  1510     8
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.7929961, 'precision': 0.8220482, 'recall': 0.7919394, 'specificity': 0.7919394, 'f1': 0.78780425, 'auroc': 0.88776755, 'binary_precision': 0.91704035, 'binary_recall': 0.64106584, 'binary_specificity': 0.942813, 'binary_f1_score': 0.75461257}
confusion matrix:
     0    1
0  610   37
1  229  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8671171, 'precision': 0.88008106, 'recall': 0.86711717, 'specificity': 0.86711717, 'f1': 0.8659743, 'auroc': 0.9176812, 'binary_precision': 0.95027626, 'binary_recall': 0.7747748, 'binary_specificity': 0.9594595, 'binary_f1_score': 0.85359806}
confusion matrix:
     0    1
0  213    9
1   50  172
early stop counter: 15
val acc:0.7929961085319519, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.880630612373352
after epoch: 21,now: 2024-07-26 08:10:35.415894,epoch time: 0:01:01.879702,used: 0:21:47.936736,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99184275, 'recall': 0.99192727, 'specificity': 0.99192727, 'f1': 0.99186134, 'auroc': 0.99972916, 'binary_precision': 0.99675745, 'binary_recall': 0.9871548, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.99193287}
confusion matrix:
      0     1
0  1510     5
1    20  1537
---- Validation: 
scalar performance:
{'acc': 0.7844358, 'precision': 0.81102216, 'recall': 0.7834059, 'specificity': 0.7834059, 'f1': 0.77930117, 'auroc': 0.8735156, 'binary_precision': 0.9002217, 'binary_recall': 0.6363636, 'binary_specificity': 0.93044823, 'binary_f1_score': 0.7456382}
confusion matrix:
     0    1
0  602   45
1  232  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8355856, 'precision': 0.84413946, 'recall': 0.8355856, 'specificity': 0.8355856, 'f1': 0.83455753, 'auroc': 0.9006371, 'binary_precision': 0.8983957, 'binary_recall': 0.7567568, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.82151586}
confusion matrix:
     0    1
0  203   19
1   54  168
early stop counter: 16
val acc:0.7844358086585999, best validation acc: 0.8334630131721497, corresponding to test acc:                         0.7972972989082336 / 0.880630612373352
after epoch: 22,now: 2024-07-26 08:11:37.425504,epoch time: 0:01:02.009610,used: 0:22:49.946346,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99413323, 'recall': 0.9941475, 'specificity': 0.9941475, 'f1': 0.9941399, 'auroc': 0.99971724, 'binary_precision': 0.9948454, 'binary_recall': 0.993565, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.99420476}
confusion matrix:
      0     1
0  1510     8
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.859144, 'precision': 0.86278015, 'recall': 0.8587937, 'specificity': 0.8587937, 'f1': 0.85870034, 'auroc': 0.92894566, 'binary_precision': 0.8973913, 'binary_recall': 0.80877745, 'binary_specificity': 0.9088099, 'binary_f1_score': 0.85078317}
confusion matrix:
     0    1
0  588   59
1  122  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.8701991, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.84691787, 'auroc': 0.94261825, 'binary_precision': 0.9585799, 'binary_recall': 0.7297297, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.8286445}
confusion matrix:
     0    1
0  215    7
1   60  162
better model found
persisted
after epoch: 23,now: 2024-07-26 08:12:39.469634,epoch time: 0:01:02.044130,used: 0:23:51.990476,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928557, 'recall': 0.9928223, 'specificity': 0.9928223, 'f1': 0.99283737, 'auroc': 0.99979055, 'binary_precision': 0.99165595, 'binary_recall': 0.9942085, 'binary_specificity': 0.9914361, 'binary_f1_score': 0.99293065}
confusion matrix:
      0     1
0  1505    13
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.8241245, 'precision': 0.83486974, 'recall': 0.8234945, 'specificity': 0.8234945, 'f1': 0.8224982, 'auroc': 0.8716066, 'binary_precision': 0.89312977, 'binary_recall': 0.7335423, 'binary_specificity': 0.91344666, 'binary_f1_score': 0.8055078}
confusion matrix:
     0    1
0  591   56
1  170  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8243243, 'precision': 0.8363636, 'recall': 0.8243243, 'specificity': 0.8243243, 'f1': 0.8227382, 'auroc': 0.90226036, 'binary_precision': 0.9, 'binary_recall': 0.7297297, 'binary_specificity': 0.9189189, 'binary_f1_score': 0.8059701}
confusion matrix:
     0    1
0  204   18
1   60  162
early stop counter: 1
val acc:0.8241245150566101, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 24,now: 2024-07-26 08:13:41.406715,epoch time: 0:01:01.937081,used: 0:24:53.927557,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9937957, 'recall': 0.9938692, 'specificity': 0.9938692, 'f1': 0.99381465, 'auroc': 0.999702, 'binary_precision': 0.99805576, 'binary_recall': 0.98971725, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.993869}
confusion matrix:
      0     1
0  1513     3
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.7610895, 'precision': 0.8150516, 'recall': 0.7596333, 'specificity': 0.7596333, 'f1': 0.7497096, 'auroc': 0.9142443, 'binary_precision': 0.9436997, 'binary_recall': 0.55172414, 'binary_specificity': 0.9675425, 'binary_f1_score': 0.69634026}
confusion matrix:
     0    1
0  626   21
1  286  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6981982, 'precision': 0.79238504, 'recall': 0.6981982, 'specificity': 0.6981982, 'f1': 0.6717643, 'auroc': 0.8885237, 'binary_precision': 0.9583333, 'binary_recall': 0.4144144, 'binary_specificity': 0.981982, 'binary_f1_score': 0.5786163}
confusion matrix:
     0   1
0  218   4
1  130  92
early stop counter: 2
val acc:0.7610895037651062, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 25,now: 2024-07-26 08:14:43.543889,epoch time: 0:01:02.137174,used: 0:25:56.064731,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9925373, 'recall': 0.9925997, 'specificity': 0.9925997, 'f1': 0.99251294, 'auroc': 0.9998779, 'binary_precision': 1.0, 'binary_recall': 0.9851995, 'binary_specificity': 1.0, 'binary_f1_score': 0.9925446}
confusion matrix:
      0     1
0  1518     0
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.72529185, 'precision': 0.80325305, 'recall': 0.72350687, 'specificity': 0.72350687, 'f1': 0.70538795, 'auroc': 0.91702545, 'binary_precision': 0.95527154, 'binary_recall': 0.46865204, 'binary_specificity': 0.97836167, 'binary_f1_score': 0.6288118}
confusion matrix:
     0    1
0  633   14
1  339  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6756757, 'precision': 0.8032787, 'recall': 0.6756757, 'specificity': 0.6756757, 'f1': 0.637551, 'auroc': 0.9397776, 'binary_precision': 1.0, 'binary_recall': 0.35135135, 'binary_specificity': 1.0, 'binary_f1_score': 0.52}
confusion matrix:
     0   1
0  222   0
1  144  78
early stop counter: 3
val acc:0.7252918481826782, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 26,now: 2024-07-26 08:15:45.599784,epoch time: 0:01:02.055895,used: 0:26:58.120626,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98838115, 'recall': 0.98842335, 'specificity': 0.98842335, 'f1': 0.98828125, 'auroc': 0.9998419, 'binary_precision': 0.999343, 'binary_recall': 0.9775064, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98830414}
confusion matrix:
      0     1
0  1515     1
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.65603113, 'precision': 0.7768245, 'recall': 0.6537031, 'specificity': 0.6537031, 'f1': 0.6119724, 'auroc': 0.8986024, 'binary_precision': 0.9579439, 'binary_recall': 0.3213166, 'binary_specificity': 0.98608965, 'binary_f1_score': 0.48122063}
confusion matrix:
     0    1
0  638    9
1  433  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7072072, 'precision': 0.8153409, 'recall': 0.7072072, 'specificity': 0.7072072, 'f1': 0.6797532, 'auroc': 0.8999067, 'binary_precision': 1.0, 'binary_recall': 0.4144144, 'binary_specificity': 1.0, 'binary_f1_score': 0.58598727}
confusion matrix:
     0   1
0  222   0
1  130  92
early stop counter: 4
val acc:0.6560311317443848, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 27,now: 2024-07-26 08:16:47.735681,epoch time: 0:01:02.135897,used: 0:28:00.256523,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906125, 'recall': 0.9906385, 'specificity': 0.9906385, 'f1': 0.9905598, 'auroc': 0.99984956, 'binary_precision': 0.9986894, 'binary_recall': 0.98259187, 'binary_specificity': 0.99868506, 'binary_f1_score': 0.99057525}
confusion matrix:
      0     1
0  1519     2
1    27  1524
---- Validation: 
scalar performance:
{'acc': 0.6264591, 'precision': 0.76459026, 'recall': 0.6239117, 'specificity': 0.6239117, 'f1': 0.5679147, 'auroc': 0.90391934, 'binary_precision': 0.954023, 'binary_recall': 0.26018807, 'binary_specificity': 0.98763525, 'binary_f1_score': 0.40886697}
confusion matrix:
     0    1
0  639    8
1  472  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5382883, 'precision': 0.75995314, 'recall': 0.5382883, 'specificity': 0.5382883, 'f1': 0.41319445, 'auroc': 0.9011799, 'binary_precision': 1.0, 'binary_recall': 0.076576576, 'binary_specificity': 1.0, 'binary_f1_score': 0.1422594}
confusion matrix:
     0   1
0  222   0
1  205  17
early stop counter: 5
val acc:0.6264591217041016, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 28,now: 2024-07-26 08:17:49.917453,epoch time: 0:01:02.181772,used: 0:29:02.438295,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99576825, 'precision': 0.9957495, 'recall': 0.99581194, 'specificity': 0.99581194, 'f1': 0.99576795, 'auroc': 0.99996394, 'binary_precision': 0.99935234, 'binary_recall': 0.992283, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.99580514}
confusion matrix:
      0     1
0  1516     1
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.72529185, 'precision': 0.8086065, 'recall': 0.72346324, 'specificity': 0.72346324, 'f1': 0.7043495, 'auroc': 0.90877414, 'binary_precision': 0.9672131, 'binary_recall': 0.46238244, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.6256628}
confusion matrix:
     0    1
0  637   10
1  343  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5945946, 'precision': 0.7761194, 'recall': 0.5945946, 'specificity': 0.5945946, 'f1': 0.51486015, 'auroc': 0.9042083, 'binary_precision': 1.0, 'binary_recall': 0.1891892, 'binary_specificity': 1.0, 'binary_f1_score': 0.3181818}
confusion matrix:
     0   1
0  222   0
1  180  42
early stop counter: 6
val acc:0.7252918481826782, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 29,now: 2024-07-26 08:18:52.015944,epoch time: 0:01:02.098491,used: 0:30:04.536786,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918753, 'recall': 0.991941, 'specificity': 0.991941, 'f1': 0.9918618, 'auroc': 0.9999165, 'binary_precision': 0.9986954, 'binary_recall': 0.9851995, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9919016}
confusion matrix:
      0     1
0  1516     2
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.6108949, 'precision': 0.7537048, 'recall': 0.6082486, 'specificity': 0.6082486, 'f1': 0.54437274, 'auroc': 0.86127496, 'binary_precision': 0.9423077, 'binary_recall': 0.23040752, 'binary_specificity': 0.98608965, 'binary_f1_score': 0.37027708}
confusion matrix:
     0    1
0  638    9
1  491  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810811, 'precision': 0.77205884, 'recall': 0.5810811, 'specificity': 0.5810811, 'f1': 0.49191582, 'auroc': 0.8833293, 'binary_precision': 1.0, 'binary_recall': 0.16216215, 'binary_specificity': 1.0, 'binary_f1_score': 0.27906975}
confusion matrix:
     0   1
0  222   0
1  186  36
early stop counter: 7
val acc:0.6108949184417725, best validation acc: 0.8591439723968506, corresponding to test acc:                         0.8490990996360779 / 0.880630612373352
after epoch: 30,now: 2024-07-26 08:19:54.286821,epoch time: 0:01:02.270877,used: 0:31:06.807663,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_48_47_seed_6_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:06.807663 at 2024-07-26 08:19:54.286821
persisted model performance metric: 

scalar performance:
{'acc': 0.8490991, 'precision': 0.8701991, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.84691787, 'auroc': 0.94261825, 'binary_precision': 0.9585799, 'binary_recall': 0.7297297, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.8286445}
confusion matrix:
     0    1
0  215    7
1   60  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8806306, 'precision': 0.8840673, 'recall': 0.8806306, 'specificity': 0.8806306, 'f1': 0.880363, 'auroc': 0.9294903, 'binary_precision': 0.920398, 'binary_recall': 0.8333333, 'binary_specificity': 0.9279279, 'binary_f1_score': 0.8747045}
confusion matrix:
     0    1
0  206   16
1   37  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455127 KiB |  13219 MiB | 515362 GiB | 515361 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 509275 GiB | 509274 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455127 KiB |  13219 MiB | 515362 GiB | 515361 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 509275 GiB | 509274 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 514582 GiB | 514582 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 508508 GiB | 508507 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  96050 MiB |  81576 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  95882 MiB |  81474 MiB |
|       from small pool |     66 MiB |     70 MiB |    168 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448041 KiB |   1252 MiB | 367874 GiB | 367874 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 361749 GiB | 361749 GiB |
|       from small pool |  12652 KiB |     44 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90475 K  |   90474 K  |
|       from large pool |     187    |    1413    |   46003 K  |   46003 K  |
|       from small pool |    1117    |    1419    |   44472 K  |   44471 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90475 K  |   90474 K  |
|       from large pool |     187    |    1413    |   46003 K  |   46003 K  |
|       from small pool |    1117    |    1419    |   44472 K  |   44471 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    4069    |    3435    |
|       from large pool |     601    |     601    |    3985    |    3384    |
|       from small pool |      33    |      35    |      84    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |   58428 K  |   58428 K  |
|       from large pool |      40    |     604    |   32576 K  |   32576 K  |
|       from small pool |      57    |     237    |   25851 K  |   25851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 515362 GiB | 515362 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 509275 GiB | 509275 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 515362 GiB | 515362 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 509275 GiB | 509275 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 514582 GiB | 514582 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 508508 GiB | 508508 GiB |
|       from small pool |      0 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  96050 MiB |  95168 MiB |
|       from large pool |    830 MiB |  14414 MiB |  95882 MiB |  95052 MiB |
|       from small pool |     52 MiB |     70 MiB |    168 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 367875 GiB | 367875 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 361750 GiB | 361750 GiB |
|       from small pool |      0 KiB |     45 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44472 K  |   44472 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44472 K  |   44472 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    4069    |    4006    |
|       from large pool |      37    |     601    |    3985    |    3948    |
|       from small pool |      26    |      35    |      84    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   58428 K  |   58428 K  |
|       from large pool |       4    |     604    |   32576 K  |   32576 K  |
|       from small pool |       0    |     237    |   25851 K  |   25851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 515362 GiB | 515362 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 509275 GiB | 509275 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 515362 GiB | 515362 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 509275 GiB | 509275 GiB |
|       from small pool |      0 KiB |     60 MiB |   6087 GiB |   6087 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 514582 GiB | 514582 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 508508 GiB | 508508 GiB |
|       from small pool |      0 KiB |     60 MiB |   6074 GiB |   6074 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  96050 MiB |  95168 MiB |
|       from large pool |    830 MiB |  14414 MiB |  95882 MiB |  95052 MiB |
|       from small pool |     52 MiB |     70 MiB |    168 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 367875 GiB | 367875 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 361750 GiB | 361750 GiB |
|       from small pool |      0 KiB |     45 MiB |   6125 GiB |   6125 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44472 K  |   44472 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90475 K  |   90475 K  |
|       from large pool |       2    |    1413    |   46003 K  |   46003 K  |
|       from small pool |       0    |    1419    |   44472 K  |   44472 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    4069    |    4006    |
|       from large pool |      37    |     601    |    3985    |    3948    |
|       from small pool |      26    |      35    |      84    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   58428 K  |   58428 K  |
|       from large pool |       4    |     604    |   32576 K  |   32576 K  |
|       from small pool |       0    |     237    |   25851 K  |   25851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536

 Experiment start at: 2024-07-26 08:20:21.124366
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.9467288, 'recall': 0.9434371, 'specificity': 0.9434371, 'f1': 0.94386196, 'auroc': 0.9927287, 'binary_precision': 0.9155689, 'binary_recall': 0.9801282, 'binary_specificity': 0.90674603, 'binary_f1_score': 0.94674927}
confusion matrix:
      0     1
0  1371   141
1    31  1529
---- Validation: 
scalar performance:
{'acc': 0.8007692, 'precision': 0.8183262, 'recall': 0.8025568, 'specificity': 0.8025568, 'f1': 0.79859734, 'auroc': 0.9075142, 'binary_precision': 0.73962265, 'binary_recall': 0.91875, 'binary_specificity': 0.68636364, 'binary_f1_score': 0.8195122}
confusion matrix:
     0    1
0  453  207
1   52  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7423581, 'precision': 0.78434795, 'recall': 0.7423581, 'specificity': 0.7423581, 'f1': 0.73248196, 'auroc': 0.9192235, 'binary_precision': 0.67507887, 'binary_recall': 0.93449783, 'binary_specificity': 0.55021834, 'binary_f1_score': 0.7838828}
confusion matrix:
     0    1
0  126  103
1   15  214
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 08:21:29.328963,epoch time: 0:01:08.204597,used: 0:01:08.204597,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96777344, 'precision': 0.96876514, 'recall': 0.9681878, 'specificity': 0.9681878, 'f1': 0.9677693, 'auroc': 0.9950049, 'binary_precision': 0.9945836, 'binary_recall': 0.94166666, 'binary_specificity': 0.994709, 'binary_f1_score': 0.9674021}
confusion matrix:
      0     1
0  1504     8
1    91  1469
---- Validation: 
scalar performance:
{'acc': 0.8223077, 'precision': 0.8351679, 'recall': 0.820786, 'specificity': 0.820786, 'f1': 0.8200692, 'auroc': 0.8912263, 'binary_precision': 0.8970874, 'binary_recall': 0.721875, 'binary_specificity': 0.919697, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  607   53
1  178  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87117904, 'precision': 0.878108, 'recall': 0.87117904, 'specificity': 0.87117904, 'f1': 0.87058616, 'auroc': 0.9386548, 'binary_precision': 0.9292929, 'binary_recall': 0.80349344, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.8618266}
confusion matrix:
     0    1
0  215   14
1   45  184
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 08:22:31.571744,epoch time: 0:01:02.242781,used: 0:02:10.447378,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.9747083, 'recall': 0.9745778, 'specificity': 0.9745778, 'f1': 0.9742835, 'auroc': 0.9973388, 'binary_precision': 0.99333775, 'binary_recall': 0.95576924, 'binary_specificity': 0.99338627, 'binary_f1_score': 0.9741915}
confusion matrix:
      0     1
0  1502    10
1    69  1491
---- Validation: 
scalar performance:
{'acc': 0.80153847, 'precision': 0.8170788, 'recall': 0.79981065, 'specificity': 0.79981065, 'f1': 0.7984079, 'auroc': 0.87555397, 'binary_precision': 0.88353413, 'binary_recall': 0.6875, 'binary_specificity': 0.91212124, 'binary_f1_score': 0.77328646}
confusion matrix:
     0    1
0  602   58
1  200  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8580786, 'precision': 0.85814005, 'recall': 0.8580786, 'specificity': 0.8580786, 'f1': 0.8580725, 'auroc': 0.93041706, 'binary_precision': 0.86283183, 'binary_recall': 0.8515284, 'binary_specificity': 0.8646288, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  198   31
1   34  195
early stop counter: 1
val acc:0.8015384674072266, best validation acc: 0.8223077058792114, corresponding to test acc:                         0.8711790442466736 / 0.8711790442466736
after epoch: 3,now: 2024-07-26 08:23:33.561167,epoch time: 0:01:01.989423,used: 0:03:12.436801,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98377776, 'recall': 0.9838828, 'specificity': 0.9838828, 'f1': 0.9837235, 'auroc': 0.9987531, 'binary_precision': 0.9941099, 'binary_recall': 0.9737179, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.9838083}
confusion matrix:
      0     1
0  1503     9
1    41  1519
---- Validation: 
scalar performance:
{'acc': 0.77384615, 'precision': 0.8232671, 'recall': 0.77080965, 'specificity': 0.77080965, 'f1': 0.76349247, 'auroc': 0.87869316, 'binary_precision': 0.9458763, 'binary_recall': 0.5734375, 'binary_specificity': 0.9681818, 'binary_f1_score': 0.7140078}
confusion matrix:
     0    1
0  639   21
1  273  367
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82969433, 'precision': 0.8658612, 'recall': 0.82969433, 'specificity': 0.82969433, 'f1': 0.82537884, 'auroc': 0.93760604, 'binary_precision': 0.9808917, 'binary_recall': 0.6724891, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.79792744}
confusion matrix:
     0    1
0  226    3
1   75  154
early stop counter: 2
val acc:0.7738461494445801, best validation acc: 0.8223077058792114, corresponding to test acc:                         0.8711790442466736 / 0.8711790442466736
after epoch: 4,now: 2024-07-26 08:24:35.652417,epoch time: 0:01:02.091250,used: 0:04:14.528051,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9795555, 'recall': 0.97898865, 'specificity': 0.97898865, 'f1': 0.97915184, 'auroc': 0.99854875, 'binary_precision': 0.96925974, 'binary_recall': 0.99038464, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.9797084}
confusion matrix:
      0     1
0  1463    49
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.85, 'precision': 0.8506985, 'recall': 0.8496449, 'specificity': 0.8496449, 'f1': 0.8498037, 'auroc': 0.9036387, 'binary_precision': 0.862969, 'binary_recall': 0.8265625, 'binary_specificity': 0.8727273, 'binary_f1_score': 0.8443735}
confusion matrix:
     0    1
0  576   84
1  111  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.8768405, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.8730696, 'auroc': 0.93699586, 'binary_precision': 0.9130435, 'binary_recall': 0.8253275, 'binary_specificity': 0.9213974, 'binary_f1_score': 0.8669725}
confusion matrix:
     0    1
0  211   18
1   40  189
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 08:25:38.428765,epoch time: 0:01:02.776348,used: 0:05:17.304399,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98538214, 'recall': 0.98549557, 'specificity': 0.98549557, 'f1': 0.98535097, 'auroc': 0.9993781, 'binary_precision': 0.99477464, 'binary_recall': 0.97628206, 'binary_specificity': 0.994709, 'binary_f1_score': 0.98544157}
confusion matrix:
      0     1
0  1504     8
1    37  1523
---- Validation: 
scalar performance:
{'acc': 0.73307693, 'precision': 0.8032314, 'recall': 0.7293324, 'specificity': 0.7293324, 'f1': 0.71457297, 'auroc': 0.878544, 'binary_precision': 0.9452888, 'binary_recall': 0.4859375, 'binary_specificity': 0.9727273, 'binary_f1_score': 0.6418989}
confusion matrix:
     0    1
0  642   18
1  329  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7532751, 'precision': 0.82746553, 'recall': 0.7532751, 'specificity': 0.7532751, 'f1': 0.7384616, 'auroc': 0.92851007, 'binary_precision': 0.98333335, 'binary_recall': 0.5152838, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.67621773}
confusion matrix:
     0    1
0  227    2
1  111  118
early stop counter: 1
val acc:0.7330769300460815, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 6,now: 2024-07-26 08:26:40.534182,epoch time: 0:01:02.105417,used: 0:06:19.409816,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98669934, 'recall': 0.98680806, 'specificity': 0.98680806, 'f1': 0.9866532, 'auroc': 0.9992682, 'binary_precision': 0.9967299, 'binary_recall': 0.97692305, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.98672706}
confusion matrix:
      0     1
0  1507     5
1    36  1524
---- Validation: 
scalar performance:
{'acc': 0.7723077, 'precision': 0.81871563, 'recall': 0.7693418, 'specificity': 0.7693418, 'f1': 0.7623583, 'auroc': 0.85473895, 'binary_precision': 0.93654823, 'binary_recall': 0.5765625, 'binary_specificity': 0.9621212, 'binary_f1_score': 0.71373314}
confusion matrix:
     0    1
0  635   25
1  271  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8568269, 'recall': 0.83842796, 'specificity': 0.83842796, 'f1': 0.83631796, 'auroc': 0.9289678, 'binary_precision': 0.9378531, 'binary_recall': 0.7248908, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.817734}
confusion matrix:
     0    1
0  218   11
1   63  166
early stop counter: 2
val acc:0.7723076939582825, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 7,now: 2024-07-26 08:27:42.478595,epoch time: 0:01:01.944413,used: 0:07:21.354229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840617, 'recall': 0.98403037, 'specificity': 0.98403037, 'f1': 0.984045, 'auroc': 0.9987595, 'binary_precision': 0.9833653, 'binary_recall': 0.98525643, 'binary_specificity': 0.98280424, 'binary_f1_score': 0.98431}
confusion matrix:
      0     1
0  1486    26
1    23  1537
---- Validation: 
scalar performance:
{'acc': 0.81846154, 'precision': 0.821756, 'recall': 0.817661, 'specificity': 0.817661, 'f1': 0.8177004, 'auroc': 0.87625, 'binary_precision': 0.8506944, 'binary_recall': 0.765625, 'binary_specificity': 0.869697, 'binary_f1_score': 0.805921}
confusion matrix:
     0    1
0  574   86
1  150  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8381078, 'recall': 0.8362445, 'specificity': 0.8362445, 'f1': 0.83601856, 'auroc': 0.92158806, 'binary_precision': 0.8130081, 'binary_recall': 0.8733624, 'binary_specificity': 0.7991266, 'binary_f1_score': 0.8421052}
confusion matrix:
     0    1
0  183   46
1   29  200
early stop counter: 3
val acc:0.818461537361145, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 8,now: 2024-07-26 08:28:44.381072,epoch time: 0:01:01.902477,used: 0:08:23.256706,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912386, 'recall': 0.99118334, 'specificity': 0.99118334, 'f1': 0.9912083, 'auroc': 0.9996859, 'binary_precision': 0.9897764, 'binary_recall': 0.9929487, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.99135995}
confusion matrix:
      0     1
0  1496    16
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.84384614, 'precision': 0.86004734, 'recall': 0.8422111, 'specificity': 0.8422111, 'f1': 0.8415942, 'auroc': 0.9126373, 'binary_precision': 0.9326733, 'binary_recall': 0.7359375, 'binary_specificity': 0.94848484, 'binary_f1_score': 0.82270736}
confusion matrix:
     0    1
0  626   34
1  169  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86026204, 'precision': 0.87407184, 'recall': 0.86026204, 'specificity': 0.86026204, 'f1': 0.8589603, 'auroc': 0.9354131, 'binary_precision': 0.9459459, 'binary_recall': 0.76419216, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.84541065}
confusion matrix:
     0    1
0  219   10
1   54  175
early stop counter: 4
val acc:0.8438461422920227, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 9,now: 2024-07-26 08:29:46.549030,epoch time: 0:01:02.167958,used: 0:09:25.424664,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98482305, 'recall': 0.9848952, 'specificity': 0.9848952, 'f1': 0.98470044, 'auroc': 0.9991733, 'binary_precision': 0.9973701, 'binary_recall': 0.9724359, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9847452}
confusion matrix:
      0     1
0  1508     4
1    43  1517
---- Validation: 
scalar performance:
{'acc': 0.6861538, 'precision': 0.7759799, 'recall': 0.6816998, 'specificity': 0.6816998, 'f1': 0.65511405, 'auroc': 0.8752581, 'binary_precision': 0.9296296, 'binary_recall': 0.3921875, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.5516483}
confusion matrix:
     0    1
0  641   19
1  389  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69213974, 'precision': 0.804227, 'recall': 0.69213974, 'specificity': 0.69213974, 'f1': 0.66090643, 'auroc': 0.95404357, 'binary_precision': 0.98888886, 'binary_recall': 0.38864627, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.5579937}
confusion matrix:
     0   1
0  228   1
1  140  89
early stop counter: 5
val acc:0.6861538290977478, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 10,now: 2024-07-26 08:30:49.805384,epoch time: 0:01:03.256354,used: 0:10:28.681018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.98955506, 'recall': 0.98962146, 'specificity': 0.98962146, 'f1': 0.9895815, 'auroc': 0.99949634, 'binary_precision': 0.992268, 'binary_recall': 0.98717946, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9897172}
confusion matrix:
      0     1
0  1500    12
1    20  1540
---- Validation: 
scalar performance:
{'acc': 0.8230769, 'precision': 0.8514713, 'recall': 0.82088065, 'specificity': 0.82088065, 'f1': 0.8186995, 'auroc': 0.9156084, 'binary_precision': 0.9475983, 'binary_recall': 0.678125, 'binary_specificity': 0.96363634, 'binary_f1_score': 0.79052824}
confusion matrix:
     0    1
0  636   24
1  206  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.8604852, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.83096343, 'auroc': 0.9336445, 'binary_precision': 0.9580838, 'binary_recall': 0.69868994, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.80808073}
confusion matrix:
     0    1
0  222    7
1   69  160
early stop counter: 6
val acc:0.8230769038200378, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 11,now: 2024-07-26 08:31:52.019704,epoch time: 0:01:02.214320,used: 0:11:30.895338,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99183124, 'recall': 0.99192613, 'specificity': 0.99192613, 'f1': 0.9918609, 'auroc': 0.9996846, 'binary_precision': 0.9961215, 'binary_recall': 0.9878205, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.9919537}
confusion matrix:
      0     1
0  1506     6
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.80615383, 'precision': 0.83293056, 'recall': 0.8039536, 'specificity': 0.8039536, 'f1': 0.80135775, 'auroc': 0.89181226, 'binary_precision': 0.92358077, 'binary_recall': 0.6609375, 'binary_specificity': 0.9469697, 'binary_f1_score': 0.77049184}
confusion matrix:
     0    1
0  625   35
1  217  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8537118, 'precision': 0.8692666, 'recall': 0.8537118, 'specificity': 0.8537118, 'f1': 0.85215485, 'auroc': 0.9234759, 'binary_precision': 0.94505495, 'binary_recall': 0.7510917, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.83698297}
confusion matrix:
     0    1
0  219   10
1   57  172
early stop counter: 7
val acc:0.8061538338661194, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 12,now: 2024-07-26 08:32:54.272557,epoch time: 0:01:02.252853,used: 0:12:33.148191,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98892957, 'recall': 0.98892957, 'specificity': 0.98892957, 'f1': 0.98892957, 'auroc': 0.99949884, 'binary_precision': 0.98910254, 'binary_recall': 0.98910254, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.98910254}
confusion matrix:
      0     1
0  1495    17
1    17  1543
---- Validation: 
scalar performance:
{'acc': 0.8253846, 'precision': 0.8410902, 'recall': 0.8237216, 'specificity': 0.8237216, 'f1': 0.82280004, 'auroc': 0.89682055, 'binary_precision': 0.91053677, 'binary_recall': 0.715625, 'binary_specificity': 0.9318182, 'binary_f1_score': 0.80139977}
confusion matrix:
     0    1
0  615   45
1  182  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.8768405, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.8730696, 'auroc': 0.9279952, 'binary_precision': 0.9130435, 'binary_recall': 0.8253275, 'binary_specificity': 0.9213974, 'binary_f1_score': 0.8669725}
confusion matrix:
     0    1
0  211   18
1   40  189
early stop counter: 8
val acc:0.8253846168518066, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 13,now: 2024-07-26 08:33:56.470919,epoch time: 0:01:02.198362,used: 0:13:35.346553,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9862793, 'recall': 0.98586184, 'specificity': 0.98586184, 'f1': 0.9859942, 'auroc': 0.99925685, 'binary_precision': 0.9779458, 'binary_recall': 0.9948718, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.9863361}
confusion matrix:
      0     1
0  1477    35
1     8  1552
---- Validation: 
scalar performance:
{'acc': 0.8384615, 'precision': 0.8454546, 'recall': 0.837358, 'specificity': 0.837358, 'f1': 0.8372966, 'auroc': 0.9074509, 'binary_precision': 0.8909091, 'binary_recall': 0.765625, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.8235294}
confusion matrix:
     0    1
0  600   60
1  150  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.8542698, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.84881955, 'auroc': 0.9221792, 'binary_precision': 0.8960396, 'binary_recall': 0.790393, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.83990717}
confusion matrix:
     0    1
0  208   21
1   48  181
early stop counter: 9
val acc:0.8384615182876587, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 14,now: 2024-07-26 08:34:58.681411,epoch time: 0:01:02.210492,used: 0:14:37.557045,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99514616, 'recall': 0.9950906, 'specificity': 0.9950906, 'f1': 0.99511576, 'auroc': 0.9998516, 'binary_precision': 0.9936102, 'binary_recall': 0.9967949, 'binary_specificity': 0.99338627, 'binary_f1_score': 0.99520004}
confusion matrix:
      0     1
0  1502    10
1     5  1555
---- Validation: 
scalar performance:
{'acc': 0.79923075, 'precision': 0.83462465, 'recall': 0.7967093, 'specificity': 0.7967093, 'f1': 0.7928014, 'auroc': 0.9083049, 'binary_precision': 0.93967515, 'binary_recall': 0.6328125, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.75630254}
confusion matrix:
     0    1
0  634   26
1  235  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8253275, 'precision': 0.8610153, 'recall': 0.8253275, 'specificity': 0.8253275, 'f1': 0.82090133, 'auroc': 0.9452146, 'binary_precision': 0.9745223, 'binary_recall': 0.6681223, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.79274607}
confusion matrix:
     0    1
0  225    4
1   76  153
early stop counter: 10
val acc:0.7992307543754578, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 15,now: 2024-07-26 08:36:02.145204,epoch time: 0:01:03.463793,used: 0:15:41.020838,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.99345934, 'recall': 0.99353886, 'specificity': 0.99353886, 'f1': 0.9934886, 'auroc': 0.99965835, 'binary_precision': 0.9967742, 'binary_recall': 0.99038464, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.99356914}
confusion matrix:
      0     1
0  1507     5
1    15  1545
---- Validation: 
scalar performance:
{'acc': 0.7223077, 'precision': 0.7973169, 'recall': 0.7183949, 'specificity': 0.7183949, 'f1': 0.7012683, 'auroc': 0.8971112, 'binary_precision': 0.94285715, 'binary_recall': 0.4640625, 'binary_specificity': 0.9727273, 'binary_f1_score': 0.6219895}
confusion matrix:
     0    1
0  642   18
1  343  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68122274, 'precision': 0.8053334, 'recall': 0.6812227, 'specificity': 0.6812227, 'f1': 0.6451647, 'auroc': 0.94132453, 'binary_precision': 1.0, 'binary_recall': 0.3624454, 'binary_specificity': 1.0, 'binary_f1_score': 0.5320513}
confusion matrix:
     0   1
0  229   0
1  146  83
early stop counter: 11
val acc:0.7223076820373535, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 16,now: 2024-07-26 08:37:04.431736,epoch time: 0:01:02.286532,used: 0:16:43.307370,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9893036, 'recall': 0.9894129, 'specificity': 0.9894129, 'f1': 0.98925745, 'auroc': 0.99949956, 'binary_precision': 0.99934596, 'binary_recall': 0.9794872, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9893169}
confusion matrix:
      0     1
0  1511     1
1    32  1528
---- Validation: 
scalar performance:
{'acc': 0.6969231, 'precision': 0.7939156, 'recall': 0.6924479, 'specificity': 0.6924479, 'f1': 0.6666094, 'auroc': 0.91308236, 'binary_precision': 0.9589552, 'binary_recall': 0.4015625, 'binary_specificity': 0.98333335, 'binary_f1_score': 0.56607926}
confusion matrix:
     0    1
0  649   11
1  383  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5633188, 'precision': 0.76689976, 'recall': 0.5633188, 'specificity': 0.5633188, 'f1': 0.4604274, 'auroc': 0.9464731, 'binary_precision': 1.0, 'binary_recall': 0.12663755, 'binary_specificity': 1.0, 'binary_f1_score': 0.22480619}
confusion matrix:
     0   1
0  229   0
1  200  29
early stop counter: 12
val acc:0.6969230771064758, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 17,now: 2024-07-26 08:38:06.449345,epoch time: 0:01:02.017609,used: 0:17:45.324979,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99236774, 'recall': 0.99208385, 'specificity': 0.99208385, 'f1': 0.9921837, 'auroc': 0.9998715, 'binary_precision': 0.98607594, 'binary_recall': 0.99871796, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.99235666}
confusion matrix:
      0     1
0  1490    22
1     2  1558
---- Validation: 
scalar performance:
{'acc': 0.8130769, 'precision': 0.8364758, 'recall': 0.8110322, 'specificity': 0.8110322, 'f1': 0.80904067, 'auroc': 0.9054711, 'binary_precision': 0.92144376, 'binary_recall': 0.678125, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.78127813}
confusion matrix:
     0    1
0  623   37
1  206  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8580786, 'precision': 0.87525976, 'recall': 0.8580786, 'specificity': 0.8580786, 'f1': 0.8564353, 'auroc': 0.94569135, 'binary_precision': 0.95555556, 'binary_recall': 0.7510917, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.8410758}
confusion matrix:
     0    1
0  221    8
1   57  172
early stop counter: 13
val acc:0.813076913356781, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 18,now: 2024-07-26 08:39:08.554498,epoch time: 0:01:02.105153,used: 0:18:47.430132,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9909357, 'recall': 0.99084246, 'specificity': 0.99084246, 'f1': 0.9908824, 'auroc': 0.9996786, 'binary_precision': 0.9885204, 'binary_recall': 0.99358976, 'binary_specificity': 0.9880952, 'binary_f1_score': 0.99104863}
confusion matrix:
      0     1
0  1494    18
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.7438462, 'precision': 0.79674864, 'recall': 0.740554, 'specificity': 0.740554, 'f1': 0.7301376, 'auroc': 0.86376184, 'binary_precision': 0.9182561, 'binary_recall': 0.5265625, 'binary_specificity': 0.95454544, 'binary_f1_score': 0.6693148}
confusion matrix:
     0    1
0  630   30
1  303  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.87045795, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.837335, 'auroc': 0.9465685, 'binary_precision': 0.9756098, 'binary_recall': 0.69868994, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.81424934}
confusion matrix:
     0    1
0  225    4
1   69  160
early stop counter: 14
val acc:0.7438461780548096, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 19,now: 2024-07-26 08:40:10.877536,epoch time: 0:01:02.323038,used: 0:19:49.753170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98427504, 'recall': 0.9842847, 'specificity': 0.9842847, 'f1': 0.98404944, 'auroc': 0.999599, 'binary_precision': 0.99933904, 'binary_recall': 0.9692308, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9840547}
confusion matrix:
      0     1
0  1511     1
1    48  1512
---- Validation: 
scalar performance:
{'acc': 0.5376923, 'precision': 0.74952054, 'recall': 0.5304924, 'specificity': 0.5304924, 'f1': 0.40214518, 'auroc': 0.9008008, 'binary_precision': 0.9756098, 'binary_recall': 0.0625, 'binary_specificity': 0.99848485, 'binary_f1_score': 0.1174743}
confusion matrix:
     0   1
0  659   1
1  600  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.93879783, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  229  0
1  229  0
early stop counter: 15
val acc:0.5376923084259033, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 20,now: 2024-07-26 08:41:14.362523,epoch time: 0:01:03.484987,used: 0:20:53.238157,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9824158, 'recall': 0.9823616, 'specificity': 0.9823616, 'f1': 0.9820963, 'auroc': 0.99937725, 'binary_precision': 0.9993364, 'binary_recall': 0.9653846, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.98206717}
confusion matrix:
      0     1
0  1511     1
1    54  1506
---- Validation: 
scalar performance:
{'acc': 0.78923076, 'precision': 0.829931, 'recall': 0.7865057, 'specificity': 0.7865057, 'f1': 0.7814032, 'auroc': 0.9105036, 'binary_precision': 0.942029, 'binary_recall': 0.609375, 'binary_specificity': 0.96363634, 'binary_f1_score': 0.740038}
confusion matrix:
     0    1
0  636   24
1  250  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8144105, 'precision': 0.8521873, 'recall': 0.81441045, 'specificity': 0.81441045, 'f1': 0.8092966, 'auroc': 0.9401422, 'binary_precision': 0.96753246, 'binary_recall': 0.65065503, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.7780679}
confusion matrix:
     0    1
0  224    5
1   80  149
early stop counter: 16
val acc:0.7892307639122009, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 21,now: 2024-07-26 08:42:16.624399,epoch time: 0:01:02.261876,used: 0:21:55.500033,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98874646, 'recall': 0.9885175, 'specificity': 0.9885175, 'f1': 0.9886017, 'auroc': 0.99948025, 'binary_precision': 0.983513, 'binary_recall': 0.99423075, 'binary_specificity': 0.98280424, 'binary_f1_score': 0.98884284}
confusion matrix:
      0     1
0  1486    26
1     9  1551
---- Validation: 
scalar performance:
{'acc': 0.8076923, 'precision': 0.83461607, 'recall': 0.8054924, 'specificity': 0.8054924, 'f1': 0.8029343, 'auroc': 0.90279293, 'binary_precision': 0.9257642, 'binary_recall': 0.6625, 'binary_specificity': 0.94848484, 'binary_f1_score': 0.7723133}
confusion matrix:
     0    1
0  626   34
1  216  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8711546, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.834786, 'auroc': 0.93327737, 'binary_precision': 0.98136646, 'binary_recall': 0.6899563, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8102564}
confusion matrix:
     0    1
0  226    3
1   71  158
early stop counter: 17
val acc:0.807692289352417, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 22,now: 2024-07-26 08:43:18.769640,epoch time: 0:01:02.145241,used: 0:22:57.645274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9902344, 'precision': 0.99028444, 'recall': 0.9901913, 'specificity': 0.9901913, 'f1': 0.99023116, 'auroc': 0.99961543, 'binary_precision': 0.9878827, 'binary_recall': 0.9929487, 'binary_specificity': 0.98743385, 'binary_f1_score': 0.9904092}
confusion matrix:
      0     1
0  1493    19
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.8484615, 'precision': 0.85794216, 'recall': 0.8472065, 'specificity': 0.8472065, 'f1': 0.84709275, 'auroc': 0.91658145, 'binary_precision': 0.9124767, 'binary_recall': 0.765625, 'binary_specificity': 0.9287879, 'binary_f1_score': 0.8326253}
confusion matrix:
     0    1
0  613   47
1  150  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8806082, 'recall': 0.8689956, 'specificity': 0.8689956, 'f1': 0.8679887, 'auroc': 0.9364047, 'binary_precision': 0.94708997, 'binary_recall': 0.78165936, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.8564593}
confusion matrix:
     0    1
0  219   10
1   50  179
early stop counter: 18
val acc:0.8484615087509155, best validation acc: 0.8500000238418579, corresponding to test acc:                         0.8733624219894409 / 0.8733624219894409
after epoch: 23,now: 2024-07-26 08:44:21.275957,epoch time: 0:01:02.506317,used: 0:24:00.151591,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.992004, 'recall': 0.9917735, 'specificity': 0.9917735, 'f1': 0.9918583, 'auroc': 0.9997592, 'binary_precision': 0.98668355, 'binary_recall': 0.99743587, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.99203056}
confusion matrix:
      0     1
0  1491    21
1     4  1556
---- Validation: 
scalar performance:
{'acc': 0.8676923, 'precision': 0.8677195, 'recall': 0.86780304, 'specificity': 0.86780304, 'f1': 0.8676873, 'auroc': 0.91628075, 'binary_precision': 0.8588957, 'binary_recall': 0.875, 'binary_specificity': 0.8606061, 'binary_f1_score': 0.866873}
confusion matrix:
     0    1
0  568   92
1   80  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90174675, 'precision': 0.90267587, 'recall': 0.90174675, 'specificity': 0.90174675, 'f1': 0.90169, 'auroc': 0.956103, 'binary_precision': 0.92201835, 'binary_recall': 0.87772924, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8993289}
confusion matrix:
     0    1
0  212   17
1   28  201
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-26 08:45:24.773572,epoch time: 0:01:03.497615,used: 0:25:03.649206,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918326, 'recall': 0.9919058, 'specificity': 0.9919058, 'f1': 0.9918606, 'auroc': 0.9997957, 'binary_precision': 0.99484205, 'binary_recall': 0.98910254, 'binary_specificity': 0.994709, 'binary_f1_score': 0.991964}
confusion matrix:
      0     1
0  1504     8
1    17  1543
---- Validation: 
scalar performance:
{'acc': 0.6207692, 'precision': 0.74255085, 'recall': 0.6152226, 'specificity': 0.6152226, 'f1': 0.56061786, 'auroc': 0.843215, 'binary_precision': 0.91061455, 'binary_recall': 0.2546875, 'binary_specificity': 0.9757576, 'binary_f1_score': 0.3980464}
confusion matrix:
     0    1
0  644   16
1  477  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66157204, 'precision': 0.7918503, 'recall': 0.66157204, 'specificity': 0.66157204, 'f1': 0.6190604, 'auroc': 0.94513834, 'binary_precision': 0.9868421, 'binary_recall': 0.32751092, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.4918033}
confusion matrix:
     0   1
0  228   1
1  154  75
early stop counter: 1
val acc:0.620769202709198, best validation acc: 0.8676922917366028, corresponding to test acc:                         0.9017467498779297 / 0.9017467498779297
after epoch: 25,now: 2024-07-26 08:46:27.494945,epoch time: 0:01:02.721373,used: 0:26:06.370579,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9843739, 'recall': 0.98348594, 'specificity': 0.98348594, 'f1': 0.98370874, 'auroc': 0.99976134, 'binary_precision': 0.9701121, 'binary_recall': 0.99871796, 'binary_specificity': 0.96825397, 'binary_f1_score': 0.9842072}
confusion matrix:
      0     1
0  1464    48
1     2  1558
---- Validation: 
scalar performance:
{'acc': 0.8607692, 'precision': 0.8618327, 'recall': 0.86119795, 'specificity': 0.86119795, 'f1': 0.86073947, 'auroc': 0.9187784, 'binary_precision': 0.8379971, 'binary_recall': 0.8890625, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.86277485}
confusion matrix:
     0    1
0  550  110
1   71  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8580786, 'precision': 0.8600629, 'recall': 0.8580786, 'specificity': 0.8580786, 'f1': 0.8578828, 'auroc': 0.93636656, 'binary_precision': 0.8333333, 'binary_recall': 0.8951965, 'binary_specificity': 0.8209607, 'binary_f1_score': 0.86315787}
confusion matrix:
     0    1
0  188   41
1   24  205
early stop counter: 2
val acc:0.8607692122459412, best validation acc: 0.8676922917366028, corresponding to test acc:                         0.9017467498779297 / 0.9017467498779297
after epoch: 26,now: 2024-07-26 08:47:29.908903,epoch time: 0:01:02.413958,used: 0:27:08.784537,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886525, 'recall': 0.98876166, 'specificity': 0.98876166, 'f1': 0.9886064, 'auroc': 0.9996847, 'binary_precision': 0.998692, 'binary_recall': 0.97884613, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.98866946}
confusion matrix:
      0     1
0  1510     2
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.79, 'precision': 0.8320662, 'recall': 0.78723955, 'specificity': 0.78723955, 'f1': 0.78200233, 'auroc': 0.91610086, 'binary_precision': 0.94647205, 'binary_recall': 0.6078125, 'binary_specificity': 0.96666664, 'binary_f1_score': 0.7402474}
confusion matrix:
     0    1
0  638   22
1  251  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8275109, 'precision': 0.86686176, 'recall': 0.82751095, 'specificity': 0.82751095, 'f1': 0.82275796, 'auroc': 0.9415343, 'binary_precision': 0.987013, 'binary_recall': 0.6637555, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.79373366}
confusion matrix:
     0    1
0  227    2
1   77  152
early stop counter: 3
val acc:0.7900000214576721, best validation acc: 0.8676922917366028, corresponding to test acc:                         0.9017467498779297 / 0.9017467498779297
after epoch: 27,now: 2024-07-26 08:48:32.305279,epoch time: 0:01:02.396376,used: 0:28:11.180913,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9951172, 'precision': 0.99508667, 'recall': 0.99518216, 'specificity': 0.99518216, 'f1': 0.99511653, 'auroc': 0.99994445, 'binary_precision': 0.9993536, 'binary_recall': 0.9910256, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.99517214}
confusion matrix:
      0     1
0  1511     1
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.7023077, 'precision': 0.79972136, 'recall': 0.6978693, 'specificity': 0.6978693, 'f1': 0.6730312, 'auroc': 0.9157724, 'binary_precision': 0.96678966, 'binary_recall': 0.409375, 'binary_specificity': 0.98636365, 'binary_f1_score': 0.5751921}
confusion matrix:
     0    1
0  651    9
1  378  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5786026, 'precision': 0.771327, 'recall': 0.5786026, 'specificity': 0.5786026, 'f1': 0.4876156, 'auroc': 0.94414675, 'binary_precision': 1.0, 'binary_recall': 0.15720524, 'binary_specificity': 1.0, 'binary_f1_score': 0.27169812}
confusion matrix:
     0   1
0  229   0
1  193  36
early stop counter: 4
val acc:0.7023077011108398, best validation acc: 0.8676922917366028, corresponding to test acc:                         0.9017467498779297 / 0.9017467498779297
after epoch: 28,now: 2024-07-26 08:49:34.674252,epoch time: 0:01:02.368973,used: 0:29:13.549886,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.986655, 'recall': 0.98617214, 'specificity': 0.98617214, 'f1': 0.9863193, 'auroc': 0.999735, 'binary_precision': 0.9773585, 'binary_recall': 0.99615383, 'binary_specificity': 0.97619045, 'binary_f1_score': 0.9866666}
confusion matrix:
      0     1
0  1476    36
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.85615385, 'precision': 0.85823405, 'recall': 0.8555634, 'specificity': 0.8555634, 'f1': 0.8557707, 'auroc': 0.90670455, 'binary_precision': 0.88195616, 'binary_recall': 0.8171875, 'binary_specificity': 0.8939394, 'binary_f1_score': 0.84833735}
confusion matrix:
     0    1
0  590   70
1  117  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87117904, 'precision': 0.8749615, 'recall': 0.87117904, 'specificity': 0.87117904, 'f1': 0.8708534, 'auroc': 0.9410957, 'binary_precision': 0.9126214, 'binary_recall': 0.8209607, 'binary_specificity': 0.9213974, 'binary_f1_score': 0.86436784}
confusion matrix:
     0    1
0  211   18
1   41  188
early stop counter: 5
val acc:0.8561538457870483, best validation acc: 0.8676922917366028, corresponding to test acc:                         0.9017467498779297 / 0.9017467498779297
after epoch: 29,now: 2024-07-26 08:50:37.189669,epoch time: 0:01:02.515417,used: 0:30:16.065303,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9970703, 'precision': 0.99704975, 'recall': 0.99709505, 'specificity': 0.99709505, 'f1': 0.9970697, 'auroc': 0.99994487, 'binary_precision': 0.99871385, 'binary_recall': 0.99551284, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.9971108}
confusion matrix:
      0     1
0  1510     2
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.7076923, 'precision': 0.79777086, 'recall': 0.7034091, 'specificity': 0.7034091, 'f1': 0.68100715, 'auroc': 0.90028405, 'binary_precision': 0.9577465, 'binary_recall': 0.425, 'binary_specificity': 0.9818182, 'binary_f1_score': 0.58874464}
confusion matrix:
     0    1
0  648   12
1  368  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6528384, 'precision': 0.7883923, 'recall': 0.6528384, 'specificity': 0.6528384, 'f1': 0.6066121, 'auroc': 0.93373024, 'binary_precision': 0.9861111, 'binary_recall': 0.31004366, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.4717608}
confusion matrix:
     0   1
0  228   1
1  158  71
early stop counter: 6
val acc:0.7076923251152039, best validation acc: 0.8676922917366028, corresponding to test acc:                         0.9017467498779297 / 0.9017467498779297
after epoch: 30,now: 2024-07-26 08:51:39.712104,epoch time: 0:01:02.522435,used: 0:31:18.587738,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_20_21_seed_7_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:18.587738 at 2024-07-26 08:51:39.712104
persisted model performance metric: 

scalar performance:
{'acc': 0.90174675, 'precision': 0.90267587, 'recall': 0.90174675, 'specificity': 0.90174675, 'f1': 0.90169, 'auroc': 0.956103, 'binary_precision': 0.92201835, 'binary_recall': 0.87772924, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8993289}
confusion matrix:
     0    1
0  212   17
1   28  201
oracle model performance metric: 

scalar performance:
{'acc': 0.90174675, 'precision': 0.90267587, 'recall': 0.90174675, 'specificity': 0.90174675, 'f1': 0.90169, 'auroc': 0.956103, 'binary_precision': 0.92201835, 'binary_recall': 0.87772924, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8993289}
confusion matrix:
     0    1
0  212   17
1   28  201
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 589094 GiB | 589093 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 582135 GiB | 582135 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 589094 GiB | 589093 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 582135 GiB | 582135 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 588264 GiB | 588263 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 581319 GiB | 581319 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB | 109642 MiB |  95168 MiB |
|       from large pool |  14408 MiB |  14414 MiB | 109460 MiB |  95052 MiB |
|       from small pool |     66 MiB |     70 MiB |    182 MiB |    116 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448038 KiB |   1252 MiB | 420568 GiB | 420568 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 413566 GiB | 413566 GiB |
|       from small pool |  12649 KiB |     45 MiB |   7001 GiB |   7001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103445 K  |  103444 K  |
|       from large pool |     187    |    1413    |   52595 K  |   52595 K  |
|       from small pool |    1123    |    1419    |   50850 K  |   50849 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103445 K  |  103444 K  |
|       from large pool |     187    |    1413    |   52595 K  |   52595 K  |
|       from small pool |    1123    |    1419    |   50850 K  |   50849 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    4640    |    4006    |
|       from large pool |     601    |     601    |    4549    |    3948    |
|       from small pool |      33    |      35    |      91    |      58    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      98    |     652    |   66739 K  |   66739 K  |
|       from large pool |      40    |     604    |   37201 K  |   37201 K  |
|       from small pool |      58    |     237    |   29537 K  |   29537 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 589094 GiB | 589094 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 582135 GiB | 582135 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 589094 GiB | 589094 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 582135 GiB | 582135 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 588264 GiB | 588264 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 581319 GiB | 581319 GiB |
|       from small pool |      0 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 109642 MiB | 108760 MiB |
|       from large pool |    830 MiB |  14414 MiB | 109460 MiB | 108630 MiB |
|       from small pool |     52 MiB |     70 MiB |    182 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 420568 GiB | 420568 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 413566 GiB | 413566 GiB |
|       from small pool |      0 KiB |     45 MiB |   7001 GiB |   7001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50850 K  |   50850 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50850 K  |   50850 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    4640    |    4577    |
|       from large pool |      37    |     601    |    4549    |    4512    |
|       from small pool |      26    |      35    |      91    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   66739 K  |   66739 K  |
|       from large pool |       4    |     604    |   37201 K  |   37201 K  |
|       from small pool |       0    |     237    |   29537 K  |   29537 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 589094 GiB | 589094 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 582135 GiB | 582135 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 589094 GiB | 589094 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 582135 GiB | 582135 GiB |
|       from small pool |      0 KiB |     60 MiB |   6958 GiB |   6958 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 588264 GiB | 588264 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 581319 GiB | 581319 GiB |
|       from small pool |      0 KiB |     60 MiB |   6944 GiB |   6944 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 109642 MiB | 108760 MiB |
|       from large pool |    830 MiB |  14414 MiB | 109460 MiB | 108630 MiB |
|       from small pool |     52 MiB |     70 MiB |    182 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 420568 GiB | 420568 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 413566 GiB | 413566 GiB |
|       from small pool |      0 KiB |     45 MiB |   7001 GiB |   7001 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50850 K  |   50850 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52595 K  |   52595 K  |
|       from small pool |       0    |    1419    |   50850 K  |   50850 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    4640    |    4577    |
|       from large pool |      37    |     601    |    4549    |    4512    |
|       from small pool |      26    |      35    |      91    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   66739 K  |   66739 K  |
|       from large pool |       4    |     604    |   37201 K  |   37201 K  |
|       from small pool |       0    |     237    |   29537 K  |   29537 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536

 Experiment start at: 2024-07-26 08:52:08.176307
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9167763, 'precision': 0.9263859, 'recall': 0.91758084, 'specificity': 0.91758084, 'f1': 0.91640353, 'auroc': 0.98776436, 'binary_precision': 0.9930822, 'binary_recall': 0.8411458, 'binary_specificity': 0.99401593, 'binary_f1_score': 0.91082126}
confusion matrix:
      0     1
0  1495     9
1   244  1292
---- Validation: 
scalar performance:
{'acc': 0.8128384, 'precision': 0.8173003, 'recall': 0.8108334, 'specificity': 0.8108334, 'f1': 0.811346, 'auroc': 0.89418554, 'binary_precision': 0.84782606, 'binary_recall': 0.74760383, 'binary_specificity': 0.87406296, 'binary_f1_score': 0.79456705}
confusion matrix:
     0    1
0  583   84
1  158  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.8198809, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.8133946, 'auroc': 0.87488425, 'binary_precision': 0.86243385, 'binary_recall': 0.7477064, 'binary_specificity': 0.88073397, 'binary_f1_score': 0.8009828}
confusion matrix:
     0    1
0  192   26
1   55  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 08:53:17.969977,epoch time: 0:01:09.793670,used: 0:01:09.793670,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9592105, 'precision': 0.9610213, 'recall': 0.95961, 'specificity': 0.95961, 'f1': 0.95919013, 'auroc': 0.99590755, 'binary_precision': 0.9930265, 'binary_recall': 0.92587775, 'binary_specificity': 0.9933422, 'binary_f1_score': 0.9582772}
confusion matrix:
      0     1
0  1492    10
1   114  1424
---- Validation: 
scalar performance:
{'acc': 0.8228925, 'precision': 0.84015894, 'recall': 0.8192529, 'specificity': 0.8192529, 'f1': 0.8193126, 'auroc': 0.90064955, 'binary_precision': 0.90927833, 'binary_recall': 0.70447284, 'binary_specificity': 0.934033, 'binary_f1_score': 0.7938794}
confusion matrix:
     0    1
0  623   44
1  185  441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8585203, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8320924, 'auroc': 0.9122338, 'binary_precision': 0.9506173, 'binary_recall': 0.70642203, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.8105263}
confusion matrix:
     0    1
0  210    8
1   64  154
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 08:54:20.080905,epoch time: 0:01:02.110928,used: 0:02:11.904598,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.9772885, 'recall': 0.9773313, 'specificity': 0.9773313, 'f1': 0.97730136, 'auroc': 0.99721444, 'binary_precision': 0.98035365, 'binary_recall': 0.9746094, 'binary_specificity': 0.9800532, 'binary_f1_score': 0.9774731}
confusion matrix:
      0     1
0  1474    30
1    39  1497
---- Validation: 
scalar performance:
{'acc': 0.8538283, 'precision': 0.8539572, 'recall': 0.8533621, 'specificity': 0.8533621, 'f1': 0.85357296, 'auroc': 0.9259548, 'binary_precision': 0.8564437, 'binary_recall': 0.83865815, 'binary_specificity': 0.86806595, 'binary_f1_score': 0.84745765}
confusion matrix:
     0    1
0  579   88
1  101  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83027524, 'precision': 0.832064, 'recall': 0.83027524, 'specificity': 0.83027524, 'f1': 0.83004636, 'auroc': 0.91263366, 'binary_precision': 0.85643566, 'binary_recall': 0.79357797, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.8238095}
confusion matrix:
     0    1
0  189   29
1   45  173
better model found
persisted
after epoch: 3,now: 2024-07-26 08:55:22.064358,epoch time: 0:01:01.983453,used: 0:03:13.888051,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95855266, 'precision': 0.9613497, 'recall': 0.9589844, 'specificity': 0.9589844, 'f1': 0.95851296, 'auroc': 0.9974448, 'binary_precision': 1.0, 'binary_recall': 0.91796875, 'binary_specificity': 1.0, 'binary_f1_score': 0.95723015}
confusion matrix:
      0     1
0  1504     0
1   126  1410
---- Validation: 
scalar performance:
{'acc': 0.71384376, 'precision': 0.7933539, 'recall': 0.7053566, 'specificity': 0.7053566, 'f1': 0.68756366, 'auroc': 0.9019931, 'binary_precision': 0.93835616, 'binary_recall': 0.43769968, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.5969499}
confusion matrix:
     0    1
0  649   18
1  352  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76376146, 'precision': 0.83956385, 'recall': 0.76376146, 'specificity': 0.76376146, 'f1': 0.74979806, 'auroc': 0.91825175, 'binary_precision': 1.0, 'binary_recall': 0.5275229, 'binary_specificity': 1.0, 'binary_f1_score': 0.6906907}
confusion matrix:
     0    1
0  218    0
1  103  115
early stop counter: 1
val acc:0.7138437628746033, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8348624110221863
after epoch: 4,now: 2024-07-26 08:56:23.795559,epoch time: 0:01:01.731201,used: 0:04:15.619252,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9674342, 'precision': 0.96750593, 'recall': 0.9673823, 'specificity': 0.9673823, 'f1': 0.9674264, 'auroc': 0.9951297, 'binary_precision': 0.96387094, 'binary_recall': 0.9720234, 'binary_specificity': 0.9627412, 'binary_f1_score': 0.96793}
confusion matrix:
      0     1
0  1447    56
1    43  1494
---- Validation: 
scalar performance:
{'acc': 0.8538283, 'precision': 0.85409796, 'recall': 0.8543931, 'specificity': 0.8543931, 'f1': 0.85381573, 'auroc': 0.9232556, 'binary_precision': 0.83358777, 'binary_recall': 0.8722045, 'binary_specificity': 0.8365817, 'binary_f1_score': 0.8524591}
confusion matrix:
     0    1
0  558  109
1   80  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.82648695, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.82036006, 'auroc': 0.93035096, 'binary_precision': 0.7845529, 'binary_recall': 0.8853211, 'binary_specificity': 0.75688076, 'binary_f1_score': 0.8318966}
confusion matrix:
     0    1
0  165   53
1   25  193
early stop counter: 2
val acc:0.8538283109664917, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8348624110221863
after epoch: 5,now: 2024-07-26 08:57:26.080786,epoch time: 0:01:02.285227,used: 0:05:17.904479,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97203946, 'precision': 0.972543, 'recall': 0.9722654, 'specificity': 0.9722654, 'f1': 0.9720379, 'auroc': 0.9978546, 'binary_precision': 0.9912103, 'binary_recall': 0.953186, 'binary_specificity': 0.99134487, 'binary_f1_score': 0.9718264}
confusion matrix:
      0     1
0  1489    13
1    72  1466
---- Validation: 
scalar performance:
{'acc': 0.81206495, 'precision': 0.8395014, 'recall': 0.80748165, 'specificity': 0.80748165, 'f1': 0.80646205, 'auroc': 0.9193183, 'binary_precision': 0.92841166, 'binary_recall': 0.6629393, 'binary_specificity': 0.952024, 'binary_f1_score': 0.77353215}
confusion matrix:
     0    1
0  635   32
1  211  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8027523, 'precision': 0.83130693, 'recall': 0.80275226, 'specificity': 0.80275226, 'f1': 0.7984086, 'auroc': 0.9160634, 'binary_precision': 0.9285714, 'binary_recall': 0.6559633, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.7688172}
confusion matrix:
     0    1
0  207   11
1   75  143
early stop counter: 3
val acc:0.8120649456977844, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8348624110221863
after epoch: 6,now: 2024-07-26 08:58:28.053604,epoch time: 0:01:01.972818,used: 0:06:19.877297,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98059213, 'precision': 0.9808433, 'recall': 0.98047805, 'specificity': 0.98047805, 'f1': 0.9805832, 'auroc': 0.99889827, 'binary_precision': 0.9725415, 'binary_recall': 0.98960364, 'binary_specificity': 0.97135246, 'binary_f1_score': 0.9809984}
confusion matrix:
      0     1
0  1458    43
1    16  1523
---- Validation: 
scalar performance:
{'acc': 0.82830626, 'precision': 0.83930933, 'recall': 0.825384, 'specificity': 0.825384, 'f1': 0.82586807, 'auroc': 0.9071016, 'binary_precision': 0.89299613, 'binary_recall': 0.73322684, 'binary_specificity': 0.9175412, 'binary_f1_score': 0.80526316}
confusion matrix:
     0    1
0  612   55
1  167  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.83665955, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.8268659, 'auroc': 0.9126757, 'binary_precision': 0.89071035, 'binary_recall': 0.7477064, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.81296754}
confusion matrix:
     0    1
0  198   20
1   55  163
early stop counter: 4
val acc:0.828306257724762, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8348624110221863
after epoch: 7,now: 2024-07-26 08:59:29.594361,epoch time: 0:01:01.540757,used: 0:07:21.418054,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98223686, 'precision': 0.9824419, 'recall': 0.9824068, 'specificity': 0.9824068, 'f1': 0.98223674, 'auroc': 0.9989588, 'binary_precision': 0.995992, 'binary_recall': 0.9688109, 'binary_specificity': 0.9960027, 'binary_f1_score': 0.9822134}
confusion matrix:
      0     1
0  1495     6
1    48  1491
---- Validation: 
scalar performance:
{'acc': 0.8368136, 'precision': 0.8453394, 'recall': 0.8342682, 'specificity': 0.8342682, 'f1': 0.8349334, 'auroc': 0.92455125, 'binary_precision': 0.8922495, 'binary_recall': 0.75399363, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.81731606}
confusion matrix:
     0    1
0  610   57
1  154  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8463303, 'precision': 0.8534781, 'recall': 0.8463303, 'specificity': 0.8463303, 'f1': 0.84554946, 'auroc': 0.9149693, 'binary_precision': 0.9037433, 'binary_recall': 0.77522933, 'binary_specificity': 0.9174312, 'binary_f1_score': 0.83456784}
confusion matrix:
     0    1
0  200   18
1   49  169
new oracle model saved
early stop counter: 5
val acc:0.8368136286735535, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 8,now: 2024-07-26 09:00:31.426632,epoch time: 0:01:01.832271,used: 0:08:23.250325,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.98320615, 'recall': 0.9832486, 'specificity': 0.9832486, 'f1': 0.9832222, 'auroc': 0.9985235, 'binary_precision': 0.98563033, 'binary_recall': 0.98114437, 'binary_specificity': 0.9853529, 'binary_f1_score': 0.9833822}
confusion matrix:
      0     1
0  1480    22
1    29  1509
---- Validation: 
scalar performance:
{'acc': 0.79891723, 'precision': 0.8321475, 'recall': 0.7938052, 'specificity': 0.7938052, 'f1': 0.7916801, 'auroc': 0.9124687, 'binary_precision': 0.92957747, 'binary_recall': 0.63258785, 'binary_specificity': 0.9550225, 'binary_f1_score': 0.7528517}
confusion matrix:
     0    1
0  637   30
1  230  396
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809633, 'precision': 0.82610863, 'recall': 0.809633, 'specificity': 0.809633, 'f1': 0.80719787, 'auroc': 0.89005554, 'binary_precision': 0.8994083, 'binary_recall': 0.6972477, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.78552973}
confusion matrix:
     0    1
0  201   17
1   66  152
early stop counter: 6
val acc:0.7989172339439392, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 9,now: 2024-07-26 09:01:33.094246,epoch time: 0:01:01.667614,used: 0:09:24.917939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9876776, 'recall': 0.98741746, 'specificity': 0.98741746, 'f1': 0.9874958, 'auroc': 0.9994602, 'binary_precision': 0.9807569, 'binary_recall': 0.9947951, 'binary_specificity': 0.9800399, 'binary_f1_score': 0.9877261}
confusion matrix:
      0     1
0  1473    30
1     8  1529
---- Validation: 
scalar performance:
{'acc': 0.8205723, 'precision': 0.82219756, 'recall': 0.8193116, 'specificity': 0.8193116, 'f1': 0.8197936, 'auroc': 0.9004388, 'binary_precision': 0.838488, 'binary_recall': 0.7795527, 'binary_specificity': 0.8590705, 'binary_f1_score': 0.80794704}
confusion matrix:
     0    1
0  573   94
1  138  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.81886774, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.8187988, 'auroc': 0.8898872, 'binary_precision': 0.82325584, 'binary_recall': 0.8119266, 'binary_specificity': 0.82568806, 'binary_f1_score': 0.817552}
confusion matrix:
     0    1
0  180   38
1   41  177
early stop counter: 7
val acc:0.8205723166465759, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 10,now: 2024-07-26 09:02:35.594206,epoch time: 0:01:02.499960,used: 0:10:27.417899,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.98880565, 'recall': 0.9888277, 'specificity': 0.9888277, 'f1': 0.98881495, 'auroc': 0.9995507, 'binary_precision': 0.9902025, 'binary_recall': 0.98762214, 'binary_specificity': 0.9900332, 'binary_f1_score': 0.9889106}
confusion matrix:
      0     1
0  1490    15
1    19  1516
---- Validation: 
scalar performance:
{'acc': 0.76179427, 'precision': 0.80491114, 'recall': 0.7556629, 'specificity': 0.7556629, 'f1': 0.7499862, 'auroc': 0.89819944, 'binary_precision': 0.9119171, 'binary_recall': 0.5623003, 'binary_specificity': 0.9490255, 'binary_f1_score': 0.6956521}
confusion matrix:
     0    1
0  633   34
1  274  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8460318, 'recall': 0.83256876, 'specificity': 0.83256876, 'f1': 0.8309243, 'auroc': 0.91341215, 'binary_precision': 0.9142857, 'binary_recall': 0.73394495, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.8142494}
confusion matrix:
     0    1
0  203   15
1   58  160
early stop counter: 8
val acc:0.7617942690849304, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 11,now: 2024-07-26 09:03:37.838608,epoch time: 0:01:02.244402,used: 0:11:29.662301,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.9881382, 'recall': 0.988189, 'specificity': 0.988189, 'f1': 0.98815674, 'auroc': 0.999197, 'binary_precision': 0.99085563, 'binary_recall': 0.985705, 'binary_specificity': 0.9906729, 'binary_f1_score': 0.9882736}
confusion matrix:
      0     1
0  1487    14
1    22  1517
---- Validation: 
scalar performance:
{'acc': 0.8159319, 'precision': 0.8157368, 'recall': 0.8157958, 'specificity': 0.8157958, 'f1': 0.8157643, 'auroc': 0.89482975, 'binary_precision': 0.8089172, 'binary_recall': 0.8115016, 'binary_specificity': 0.82008994, 'binary_f1_score': 0.81020737}
confusion matrix:
     0    1
0  547  120
1  118  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.81840765, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.81360734, 'auroc': 0.8946637, 'binary_precision': 0.8549223, 'binary_recall': 0.75688076, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.8029197}
confusion matrix:
     0    1
0  190   28
1   53  165
early stop counter: 9
val acc:0.8159319162368774, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 12,now: 2024-07-26 09:04:39.655670,epoch time: 0:01:01.817062,used: 0:12:31.479363,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9799342, 'precision': 0.9803101, 'recall': 0.9801086, 'specificity': 0.9801086, 'f1': 0.97993344, 'auroc': 0.99887586, 'binary_precision': 0.996633, 'binary_recall': 0.9635417, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.979808}
confusion matrix:
      0     1
0  1499     5
1    56  1480
---- Validation: 
scalar performance:
{'acc': 0.81825215, 'precision': 0.84912884, 'recall': 0.81347865, 'specificity': 0.81347865, 'f1': 0.81241953, 'auroc': 0.9148158, 'binary_precision': 0.9453303, 'binary_recall': 0.6629393, 'binary_specificity': 0.964018, 'binary_f1_score': 0.7793427}
confusion matrix:
     0    1
0  643   24
1  211  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70183486, 'precision': 0.75039154, 'recall': 0.70183486, 'specificity': 0.70183486, 'f1': 0.68664306, 'auroc': 0.8573773, 'binary_precision': 0.8606557, 'binary_recall': 0.48165137, 'binary_specificity': 0.92201835, 'binary_f1_score': 0.61764705}
confusion matrix:
     0    1
0  201   17
1  113  105
early stop counter: 10
val acc:0.8182521462440491, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 13,now: 2024-07-26 09:05:41.094536,epoch time: 0:01:01.438866,used: 0:13:32.918229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.9888158, 'recall': 0.9888843, 'specificity': 0.9888843, 'f1': 0.9888154, 'auroc': 0.9991503, 'binary_precision': 0.99473685, 'binary_recall': 0.98309493, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.9888816}
confusion matrix:
      0     1
0  1494     8
1    26  1512
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.854517, 'recall': 0.8462981, 'specificity': 0.8462981, 'f1': 0.84707534, 'auroc': 0.9152229, 'binary_precision': 0.8937729, 'binary_recall': 0.7795527, 'binary_specificity': 0.9130435, 'binary_f1_score': 0.8327645}
confusion matrix:
     0    1
0  609   58
1  138  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.8409512, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.8367015, 'auroc': 0.89060265, 'binary_precision': 0.8769231, 'binary_recall': 0.7844037, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.82808715}
confusion matrix:
     0    1
0  194   24
1   47  171
early stop counter: 11
val acc:0.8484145402908325, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 14,now: 2024-07-26 09:06:42.882400,epoch time: 0:01:01.787864,used: 0:14:34.706093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9875, 'precision': 0.9876298, 'recall': 0.9874322, 'specificity': 0.9874322, 'f1': 0.9874964, 'auroc': 0.9993087, 'binary_precision': 0.98199356, 'binary_recall': 0.9934938, 'binary_specificity': 0.98137057, 'binary_f1_score': 0.98771024}
confusion matrix:
      0     1
0  1475    28
1    10  1527
---- Validation: 
scalar performance:
{'acc': 0.82985306, 'precision': 0.83636934, 'recall': 0.8275706, 'specificity': 0.8275706, 'f1': 0.8281956, 'auroc': 0.9087259, 'binary_precision': 0.8759259, 'binary_recall': 0.75559103, 'binary_specificity': 0.8995502, 'binary_f1_score': 0.8113207}
confusion matrix:
     0    1
0  600   67
1  153  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8279238, 'recall': 0.8256881, 'specificity': 0.8256881, 'f1': 0.82539046, 'auroc': 0.889277, 'binary_precision': 0.855, 'binary_recall': 0.7844037, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  189   29
1   47  171
early stop counter: 12
val acc:0.8298530578613281, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 15,now: 2024-07-26 09:07:44.899371,epoch time: 0:01:02.016971,used: 0:15:36.723064,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97894734, 'precision': 0.9794893, 'recall': 0.9791655, 'specificity': 0.9791655, 'f1': 0.97894585, 'auroc': 0.9993663, 'binary_precision': 0.9986459, 'binary_recall': 0.95966166, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.9787657}
confusion matrix:
      0     1
0  1501     2
1    62  1475
---- Validation: 
scalar performance:
{'acc': 0.804331, 'precision': 0.8425803, 'recall': 0.79895437, 'specificity': 0.79895437, 'f1': 0.7966052, 'auroc': 0.92297304, 'binary_precision': 0.94939756, 'binary_recall': 0.629393, 'binary_specificity': 0.96851575, 'binary_f1_score': 0.75696445}
confusion matrix:
     0    1
0  646   21
1  232  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7545872, 'precision': 0.82775295, 'recall': 0.7545872, 'specificity': 0.7545872, 'f1': 0.7400814, 'auroc': 0.9101138, 'binary_precision': 0.9826087, 'binary_recall': 0.51834863, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.6786787}
confusion matrix:
     0    1
0  216    2
1  105  113
early stop counter: 13
val acc:0.8043310046195984, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 16,now: 2024-07-26 09:08:47.211297,epoch time: 0:01:02.311926,used: 0:16:39.034990,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9907895, 'precision': 0.99077654, 'recall': 0.9908038, 'specificity': 0.9908038, 'f1': 0.99078846, 'auroc': 0.9996152, 'binary_precision': 0.9921773, 'binary_recall': 0.9895969, 'binary_specificity': 0.99201065, 'binary_f1_score': 0.9908854}
confusion matrix:
      0     1
0  1490    12
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.8275329, 'precision': 0.8609798, 'recall': 0.8226705, 'specificity': 0.8226705, 'f1': 0.8217957, 'auroc': 0.9314626, 'binary_precision': 0.9632184, 'binary_recall': 0.66932905, 'binary_specificity': 0.976012, 'binary_f1_score': 0.78982097}
confusion matrix:
     0    1
0  651   16
1  207  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78669727, 'precision': 0.84100866, 'recall': 0.78669727, 'specificity': 0.78669727, 'f1': 0.77785194, 'auroc': 0.9041064, 'binary_precision': 0.97709924, 'binary_recall': 0.58715594, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.73352426}
confusion matrix:
     0    1
0  215    3
1   90  128
early stop counter: 14
val acc:0.8275328874588013, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 17,now: 2024-07-26 09:09:48.798016,epoch time: 0:01:01.586719,used: 0:17:40.621709,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9888158, 'precision': 0.98887074, 'recall': 0.9887776, 'specificity': 0.9887776, 'f1': 0.9888134, 'auroc': 0.9994948, 'binary_precision': 0.9857789, 'binary_recall': 0.99219257, 'binary_specificity': 0.9853626, 'binary_f1_score': 0.98897535}
confusion matrix:
      0     1
0  1481    22
1    12  1525
---- Validation: 
scalar performance:
{'acc': 0.8213457, 'precision': 0.82135814, 'recall': 0.8216814, 'specificity': 0.8216814, 'f1': 0.8213029, 'auroc': 0.8944082, 'binary_precision': 0.805255, 'binary_recall': 0.83226836, 'binary_specificity': 0.81109446, 'binary_f1_score': 0.81853884}
confusion matrix:
     0    1
0  541  126
1  105  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8004587, 'precision': 0.802297, 'recall': 0.80045867, 'specificity': 0.80045867, 'f1': 0.8001549, 'auroc': 0.8720226, 'binary_precision': 0.7787234, 'binary_recall': 0.8394495, 'binary_specificity': 0.7614679, 'binary_f1_score': 0.80794704}
confusion matrix:
     0    1
0  166   52
1   35  183
early stop counter: 15
val acc:0.8213456869125366, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 18,now: 2024-07-26 09:10:50.261399,epoch time: 0:01:01.463383,used: 0:18:42.085092,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97894734, 'precision': 0.9795332, 'recall': 0.9791729, 'specificity': 0.9791729, 'f1': 0.9789456, 'auroc': 0.99911654, 'binary_precision': 0.99932206, 'binary_recall': 0.9590111, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.97875166}
confusion matrix:
      0     1
0  1502     1
1    63  1474
---- Validation: 
scalar performance:
{'acc': 0.8538283, 'precision': 0.8657349, 'recall': 0.8509563, 'specificity': 0.8509563, 'f1': 0.85178, 'auroc': 0.9281198, 'binary_precision': 0.9242718, 'binary_recall': 0.76038337, 'binary_specificity': 0.9415292, 'binary_f1_score': 0.83435583}
confusion matrix:
     0    1
0  628   39
1  150  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7408257, 'precision': 0.7864472, 'recall': 0.74082565, 'specificity': 0.74082565, 'f1': 0.7300783, 'auroc': 0.87515783, 'binary_precision': 0.90076333, 'binary_recall': 0.5412844, 'binary_specificity': 0.940367, 'binary_f1_score': 0.67621773}
confusion matrix:
     0    1
0  205   13
1  100  118
early stop counter: 16
val acc:0.8538283109664917, best validation acc: 0.8538283109664917, corresponding to test acc:                         0.8302752375602722 / 0.8463302850723267
after epoch: 19,now: 2024-07-26 09:11:52.021396,epoch time: 0:01:01.759997,used: 0:19:43.845089,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9904605, 'precision': 0.99051183, 'recall': 0.990422, 'specificity': 0.990422, 'f1': 0.99045825, 'auroc': 0.99970996, 'binary_precision': 0.9877261, 'binary_recall': 0.99350226, 'binary_specificity': 0.98734176, 'binary_f1_score': 0.9906058}
confusion matrix:
      0     1
0  1482    19
1    10  1529
---- Validation: 
scalar performance:
{'acc': 0.86001545, 'precision': 0.8689592, 'recall': 0.85754246, 'specificity': 0.85754246, 'f1': 0.85844946, 'auroc': 0.9338174, 'binary_precision': 0.9190207, 'binary_recall': 0.7795527, 'binary_specificity': 0.9355322, 'binary_f1_score': 0.84356093}
confusion matrix:
     0    1
0  624   43
1  138  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.83049756, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.81719077, 'auroc': 0.89571583, 'binary_precision': 0.8926554, 'binary_recall': 0.72477067, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.8000001}
confusion matrix:
     0    1
0  199   19
1   60  158
better model found
persisted
after epoch: 20,now: 2024-07-26 09:12:55.088290,epoch time: 0:01:03.066894,used: 0:20:46.911983,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9894737, 'precision': 0.989726, 'recall': 0.98938173, 'specificity': 0.98938173, 'f1': 0.9894699, 'auroc': 0.9998702, 'binary_precision': 0.9808061, 'binary_recall': 0.99869704, 'binary_specificity': 0.9800664, 'binary_f1_score': 0.98967075}
confusion matrix:
      0     1
0  1475    30
1     2  1533
---- Validation: 
scalar performance:
{'acc': 0.83294666, 'precision': 0.84909487, 'recall': 0.829489, 'specificity': 0.829489, 'f1': 0.82982945, 'auroc': 0.91623837, 'binary_precision': 0.9166667, 'binary_recall': 0.7204473, 'binary_specificity': 0.93853074, 'binary_f1_score': 0.80679786}
confusion matrix:
     0    1
0  626   41
1  175  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7454128, 'precision': 0.7634218, 'recall': 0.7454128, 'specificity': 0.7454128, 'f1': 0.74098593, 'auroc': 0.8497181, 'binary_precision': 0.83229816, 'binary_recall': 0.6146789, 'binary_specificity': 0.8761468, 'binary_f1_score': 0.707124}
confusion matrix:
     0    1
0  191   27
1   84  134
early stop counter: 1
val acc:0.8329466581344604, best validation acc: 0.8600154519081116, corresponding to test acc:                         0.8188073635101318 / 0.8463302850723267
after epoch: 21,now: 2024-07-26 09:13:56.758820,epoch time: 0:01:01.670530,used: 0:21:48.582513,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9934211, 'precision': 0.99340343, 'recall': 0.9934513, 'specificity': 0.9934513, 'f1': 0.9934205, 'auroc': 0.9997914, 'binary_precision': 0.99607843, 'binary_recall': 0.9908973, 'binary_specificity': 0.9960053, 'binary_f1_score': 0.99348116}
confusion matrix:
      0     1
0  1496     6
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.8360402, 'precision': 0.8518796, 'recall': 0.8326348, 'specificity': 0.8326348, 'f1': 0.83305156, 'auroc': 0.9162432, 'binary_precision': 0.91902834, 'binary_recall': 0.72523963, 'binary_specificity': 0.94003, 'binary_f1_score': 0.81071424}
confusion matrix:
     0    1
0  627   40
1  172  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7545872, 'precision': 0.8142679, 'recall': 0.7545872, 'specificity': 0.7545872, 'f1': 0.7423552, 'auroc': 0.90819377, 'binary_precision': 0.9512195, 'binary_recall': 0.53669727, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.686217}
confusion matrix:
     0    1
0  212    6
1  101  117
early stop counter: 2
val acc:0.836040198802948, best validation acc: 0.8600154519081116, corresponding to test acc:                         0.8188073635101318 / 0.8463302850723267
after epoch: 22,now: 2024-07-26 09:14:58.662292,epoch time: 0:01:01.903472,used: 0:22:50.485985,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98980266, 'precision': 0.98984563, 'recall': 0.9898933, 'specificity': 0.9898933, 'f1': 0.9898026, 'auroc': 0.9997312, 'binary_precision': 0.9980159, 'binary_recall': 0.9817827, 'binary_specificity': 0.998004, 'binary_f1_score': 0.9898327}
confusion matrix:
      0     1
0  1500     3
1    28  1509
---- Validation: 
scalar performance:
{'acc': 0.80201083, 'precision': 0.8454194, 'recall': 0.7963127, 'specificity': 0.7963127, 'f1': 0.79332983, 'auroc': 0.9195818, 'binary_precision': 0.960199, 'binary_recall': 0.61661345, 'binary_specificity': 0.976012, 'binary_f1_score': 0.75097275}
confusion matrix:
     0    1
0  651   16
1  240  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57798165, 'precision': 0.72395456, 'recall': 0.57798165, 'specificity': 0.57798165, 'f1': 0.49582702, 'auroc': 0.8750737, 'binary_precision': 0.9047619, 'binary_recall': 0.17431192, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.2923077}
confusion matrix:
     0   1
0  214   4
1  180  38
early stop counter: 3
val acc:0.8020108342170715, best validation acc: 0.8600154519081116, corresponding to test acc:                         0.8188073635101318 / 0.8463302850723267
after epoch: 23,now: 2024-07-26 09:16:00.149840,epoch time: 0:01:01.487548,used: 0:23:51.973533,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.9869584, 'recall': 0.9869727, 'specificity': 0.9869727, 'f1': 0.98684204, 'auroc': 0.99940264, 'binary_precision': 0.99800533, 'binary_recall': 0.9759428, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.98685074}
confusion matrix:
      0     1
0  1499     3
1    37  1501
---- Validation: 
scalar performance:
{'acc': 0.69760245, 'precision': 0.7720123, 'recall': 0.6890253, 'specificity': 0.6890253, 'f1': 0.669343, 'auroc': 0.88621986, 'binary_precision': 0.90657437, 'binary_recall': 0.41853034, 'binary_specificity': 0.9595202, 'binary_f1_score': 0.5726776}
confusion matrix:
     0    1
0  640   27
1  364  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66284406, 'precision': 0.7548826, 'recall': 0.66284406, 'specificity': 0.66284406, 'f1': 0.6293868, 'auroc': 0.88530004, 'binary_precision': 0.90804595, 'binary_recall': 0.36238533, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.5180328}
confusion matrix:
     0   1
0  210   8
1  139  79
early stop counter: 4
val acc:0.6976024508476257, best validation acc: 0.8600154519081116, corresponding to test acc:                         0.8188073635101318 / 0.8463302850723267
after epoch: 24,now: 2024-07-26 09:17:01.868386,epoch time: 0:01:01.718546,used: 0:24:53.692079,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99407893, 'precision': 0.99406064, 'recall': 0.9941274, 'specificity': 0.9941274, 'f1': 0.9940785, 'auroc': 0.99984896, 'binary_precision': 0.9980354, 'binary_recall': 0.9902534, 'binary_specificity': 0.99800134, 'binary_f1_score': 0.9941291}
confusion matrix:
      0     1
0  1498     3
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.8692962, 'precision': 0.8729867, 'recall': 0.8677163, 'specificity': 0.8677163, 'f1': 0.86850965, 'auroc': 0.922621, 'binary_precision': 0.9029982, 'binary_recall': 0.81789136, 'binary_specificity': 0.9175412, 'binary_f1_score': 0.85834026}
confusion matrix:
     0    1
0  612   55
1  114  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78669727, 'precision': 0.7942828, 'recall': 0.78669727, 'specificity': 0.78669727, 'f1': 0.7853138, 'auroc': 0.8493813, 'binary_precision': 0.84153, 'binary_recall': 0.70642203, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.76807976}
confusion matrix:
     0    1
0  189   29
1   64  154
better model found
persisted
after epoch: 25,now: 2024-07-26 09:18:04.713811,epoch time: 0:01:02.845425,used: 0:25:56.537504,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.9866787, 'recall': 0.9866398, 'specificity': 0.9866398, 'f1': 0.9865131, 'auroc': 0.9998251, 'binary_precision': 0.99866575, 'binary_recall': 0.9746094, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.98649085}
confusion matrix:
      0     1
0  1502     2
1    39  1497
---- Validation: 
scalar performance:
{'acc': 0.8607889, 'precision': 0.8707125, 'recall': 0.8581939, 'specificity': 0.8581939, 'f1': 0.85911345, 'auroc': 0.92711633, 'binary_precision': 0.92395437, 'binary_recall': 0.7763578, 'binary_specificity': 0.94003, 'binary_f1_score': 0.84375}
confusion matrix:
     0    1
0  627   40
1  140  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7798165, 'precision': 0.798108, 'recall': 0.7798165, 'specificity': 0.7798165, 'f1': 0.7763864, 'auroc': 0.8588766, 'binary_precision': 0.8719512, 'binary_recall': 0.6559633, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.74869114}
confusion matrix:
     0    1
0  197   21
1   75  143
early stop counter: 1
val acc:0.860788881778717, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.786697268486023 / 0.8463302850723267
after epoch: 26,now: 2024-07-26 09:19:06.330053,epoch time: 0:01:01.616242,used: 0:26:58.153746,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.99210525, 'recall': 0.99215984, 'specificity': 0.99215984, 'f1': 0.992105, 'auroc': 0.99961174, 'binary_precision': 0.9973684, 'binary_recall': 0.9869792, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.9921466}
confusion matrix:
      0     1
0  1500     4
1    20  1516
---- Validation: 
scalar performance:
{'acc': 0.79969066, 'precision': 0.83725744, 'recall': 0.7943093, 'specificity': 0.7943093, 'f1': 0.79178166, 'auroc': 0.93486345, 'binary_precision': 0.94216865, 'binary_recall': 0.62460065, 'binary_specificity': 0.964018, 'binary_f1_score': 0.75120074}
confusion matrix:
     0    1
0  643   24
1  235  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77522933, 'precision': 0.8048951, 'recall': 0.77522933, 'specificity': 0.77522933, 'f1': 0.7696256, 'auroc': 0.88254356, 'binary_precision': 0.9, 'binary_recall': 0.61926603, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.7336956}
confusion matrix:
     0    1
0  203   15
1   83  135
early stop counter: 2
val acc:0.7996906638145447, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.786697268486023 / 0.8463302850723267
after epoch: 27,now: 2024-07-26 09:20:08.045729,epoch time: 0:01:01.715676,used: 0:27:59.869422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9902214, 'recall': 0.9900788, 'specificity': 0.9900788, 'f1': 0.9901291, 'auroc': 0.99969876, 'binary_precision': 0.9858156, 'binary_recall': 0.9947951, 'binary_specificity': 0.9853626, 'binary_f1_score': 0.99028504}
confusion matrix:
      0     1
0  1481    22
1     8  1529
---- Validation: 
scalar performance:
{'acc': 0.866976, 'precision': 0.8729181, 'recall': 0.86497647, 'specificity': 0.86497647, 'f1': 0.86587787, 'auroc': 0.93168354, 'binary_precision': 0.9127273, 'binary_recall': 0.80191696, 'binary_specificity': 0.928036, 'binary_f1_score': 0.8537416}
confusion matrix:
     0    1
0  619   48
1  124  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.8474183, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.8176476, 'auroc': 0.9103401, 'binary_precision': 0.943038, 'binary_recall': 0.6834862, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.7925532}
confusion matrix:
     0    1
0  209    9
1   69  149
early stop counter: 3
val acc:0.8669760227203369, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.786697268486023 / 0.8463302850723267
after epoch: 28,now: 2024-07-26 09:21:09.487175,epoch time: 0:01:01.441446,used: 0:29:01.310868,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9930921, 'precision': 0.9931425, 'recall': 0.99305606, 'specificity': 0.99305606, 'f1': 0.99309057, 'auroc': 0.9998965, 'binary_precision': 0.9903038, 'binary_recall': 0.9960988, 'binary_specificity': 0.9900133, 'binary_f1_score': 0.9931929}
confusion matrix:
      0     1
0  1487    15
1     6  1532
---- Validation: 
scalar performance:
{'acc': 0.84764117, 'precision': 0.8719092, 'recall': 0.8435846, 'specificity': 0.8435846, 'f1': 0.8439065, 'auroc': 0.9392271, 'binary_precision': 0.95931476, 'binary_recall': 0.71565497, 'binary_specificity': 0.9715142, 'binary_f1_score': 0.8197622}
confusion matrix:
     0    1
0  648   19
1  178  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.85312, 'recall': 0.79816514, 'specificity': 0.79816514, 'f1': 0.7899945, 'auroc': 0.92913055, 'binary_precision': 0.99242425, 'binary_recall': 0.60091746, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.7485714}
confusion matrix:
     0    1
0  217    1
1   87  131
early stop counter: 4
val acc:0.8476411700248718, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.786697268486023 / 0.8463302850723267
after epoch: 29,now: 2024-07-26 09:22:12.122642,epoch time: 0:01:02.635467,used: 0:30:03.946335,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9950658, 'precision': 0.9950466, 'recall': 0.9951103, 'specificity': 0.9951103, 'f1': 0.99506533, 'auroc': 0.9997926, 'binary_precision': 0.9986911, 'binary_recall': 0.99155295, 'binary_specificity': 0.99866754, 'binary_f1_score': 0.9951092}
confusion matrix:
      0     1
0  1499     2
1    13  1526
---- Validation: 
scalar performance:
{'acc': 0.7880897, 'precision': 0.8363034, 'recall': 0.7819848, 'specificity': 0.7819848, 'f1': 0.7775851, 'auroc': 0.93254936, 'binary_precision': 0.95595855, 'binary_recall': 0.58945686, 'binary_specificity': 0.97451276, 'binary_f1_score': 0.72924894}
confusion matrix:
     0    1
0  650   17
1  257  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.646789, 'precision': 0.7856675, 'recall': 0.64678895, 'specificity': 0.64678895, 'f1': 0.5979209, 'auroc': 0.9052899, 'binary_precision': 0.9848485, 'binary_recall': 0.29816514, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.4577465}
confusion matrix:
     0   1
0  217   1
1  153  65
early stop counter: 5
val acc:0.7880896925926208, best validation acc: 0.8692961931228638, corresponding to test acc:                         0.786697268486023 / 0.8463302850723267
after epoch: 30,now: 2024-07-26 09:23:14.726953,epoch time: 0:01:02.604311,used: 0:31:06.550646,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_52_08_seed_8_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:31:06.550646 at 2024-07-26 09:23:14.726953
persisted model performance metric: 

scalar performance:
{'acc': 0.78669727, 'precision': 0.7942828, 'recall': 0.78669727, 'specificity': 0.78669727, 'f1': 0.7853138, 'auroc': 0.8493813, 'binary_precision': 0.84153, 'binary_recall': 0.70642203, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.76807976}
confusion matrix:
     0    1
0  189   29
1   64  154
oracle model performance metric: 

scalar performance:
{'acc': 0.8463303, 'precision': 0.8534781, 'recall': 0.8463303, 'specificity': 0.8463303, 'f1': 0.84554946, 'auroc': 0.9149693, 'binary_precision': 0.9037433, 'binary_recall': 0.77522933, 'binary_specificity': 0.9174312, 'binary_f1_score': 0.83456784}
confusion matrix:
     0    1
0  200   18
1   49  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455127 KiB |  13219 MiB | 662539 GiB | 662539 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 654715 GiB | 654715 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455127 KiB |  13219 MiB | 662539 GiB | 662539 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 654715 GiB | 654715 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 661659 GiB | 661658 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 653851 GiB | 653851 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB | 123234 MiB | 108760 MiB |
|       from large pool |  14408 MiB |  14414 MiB | 123038 MiB | 108630 MiB |
|       from small pool |     66 MiB |     70 MiB |    196 MiB |    130 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448041 KiB |   1252 MiB | 472972 GiB | 472972 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 465099 GiB | 465099 GiB |
|       from small pool |  12652 KiB |     45 MiB |   7872 GiB |   7872 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116338 K  |  116337 K  |
|       from large pool |     187    |    1413    |   59158 K  |   59158 K  |
|       from small pool |    1117    |    1419    |   57179 K  |   57178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116338 K  |  116337 K  |
|       from large pool |     187    |    1413    |   59158 K  |   59158 K  |
|       from small pool |    1117    |    1419    |   57179 K  |   57178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    5211    |    4577    |
|       from large pool |     601    |     601    |    5113    |    4512    |
|       from small pool |      33    |      35    |      98    |      65    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     104    |     652    |   75001 K  |   75001 K  |
|       from large pool |      40    |     604    |   41808 K  |   41808 K  |
|       from small pool |      64    |     237    |   33193 K  |   33193 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 662539 GiB | 662539 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654715 GiB | 654715 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 662539 GiB | 662539 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654715 GiB | 654715 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 661659 GiB | 661659 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 653851 GiB | 653851 GiB |
|       from small pool |      0 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 123234 MiB | 122352 MiB |
|       from large pool |    830 MiB |  14414 MiB | 123038 MiB | 122208 MiB |
|       from small pool |     52 MiB |     70 MiB |    196 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 472972 GiB | 472972 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 465100 GiB | 465100 GiB |
|       from small pool |      0 KiB |     45 MiB |   7872 GiB |   7872 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116338 K  |  116338 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57179 K  |   57179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116338 K  |  116338 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57179 K  |   57179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    5211    |    5148    |
|       from large pool |      37    |     601    |    5113    |    5076    |
|       from small pool |      26    |      35    |      98    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   75002 K  |   75002 K  |
|       from large pool |       4    |     604    |   41808 K  |   41808 K  |
|       from small pool |       0    |     237    |   33193 K  |   33193 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 662539 GiB | 662539 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654715 GiB | 654715 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 662539 GiB | 662539 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 654715 GiB | 654715 GiB |
|       from small pool |      0 KiB |     60 MiB |   7824 GiB |   7824 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 661659 GiB | 661659 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 653851 GiB | 653851 GiB |
|       from small pool |      0 KiB |     60 MiB |   7807 GiB |   7807 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 123234 MiB | 122352 MiB |
|       from large pool |    830 MiB |  14414 MiB | 123038 MiB | 122208 MiB |
|       from small pool |     52 MiB |     70 MiB |    196 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 472972 GiB | 472972 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 465100 GiB | 465100 GiB |
|       from small pool |      0 KiB |     45 MiB |   7872 GiB |   7872 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116338 K  |  116338 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57179 K  |   57179 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116338 K  |  116338 K  |
|       from large pool |       2    |    1413    |   59158 K  |   59158 K  |
|       from small pool |       0    |    1419    |   57179 K  |   57179 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    5211    |    5148    |
|       from large pool |      37    |     601    |    5113    |    5076    |
|       from small pool |      26    |      35    |      98    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   75002 K  |   75002 K  |
|       from large pool |       4    |     604    |   41808 K  |   41808 K  |
|       from small pool |       0    |     237    |   33193 K  |   33193 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536

 Experiment start at: 2024-07-26 09:23:43.822773
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9247382, 'precision': 0.9338339, 'recall': 0.92526674, 'specificity': 0.92526674, 'f1': 0.9244013, 'auroc': 0.99409294, 'binary_precision': 0.99847674, 'binary_recall': 0.8518519, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.9193548}
confusion matrix:
      0     1
0  1515     2
1   228  1311
---- Validation: 
scalar performance:
{'acc': 0.73281854, 'precision': 0.8088062, 'recall': 0.7303108, 'specificity': 0.7303108, 'f1': 0.7139009, 'auroc': 0.9131971, 'binary_precision': 0.95950156, 'binary_recall': 0.4804992, 'binary_specificity': 0.9801223, 'binary_f1_score': 0.64033264}
confusion matrix:
     0    1
0  641   13
1  333  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8086957, 'precision': 0.8616352, 'recall': 0.8086957, 'specificity': 0.8086957, 'f1': 0.80142844, 'auroc': 0.9272212, 'binary_precision': 1.0, 'binary_recall': 0.6173913, 'binary_specificity': 1.0, 'binary_f1_score': 0.76344085}
confusion matrix:
     0    1
0  230    0
1   88  142
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 09:24:54.105650,epoch time: 0:01:10.282877,used: 0:01:10.282877,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9676047, 'precision': 0.9678278, 'recall': 0.9676949, 'specificity': 0.9676949, 'f1': 0.96760374, 'auroc': 0.99654424, 'binary_precision': 0.98, 'binary_recall': 0.9551657, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.96742356}
confusion matrix:
      0     1
0  1487    30
1    69  1470
---- Validation: 
scalar performance:
{'acc': 0.84710425, 'precision': 0.8539101, 'recall': 0.8464066, 'specificity': 0.8464066, 'f1': 0.8461685, 'auroc': 0.9180323, 'binary_precision': 0.9005425, 'binary_recall': 0.7769111, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.83417094}
confusion matrix:
     0    1
0  599   55
1  143  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8565217, 'precision': 0.8578476, 'recall': 0.8565217, 'specificity': 0.8565217, 'f1': 0.8563887, 'auroc': 0.9151796, 'binary_precision': 0.8796296, 'binary_recall': 0.82608694, 'binary_specificity': 0.8869565, 'binary_f1_score': 0.8520179}
confusion matrix:
     0    1
0  204   26
1   40  190
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 09:25:58.211319,epoch time: 0:01:04.105669,used: 0:02:14.388546,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.97985864, 'recall': 0.9797797, 'specificity': 0.9797797, 'f1': 0.9797118, 'auroc': 0.9980516, 'binary_precision': 0.9900398, 'binary_recall': 0.9694408, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9796321}
confusion matrix:
      0     1
0  1503    15
1    47  1491
---- Validation: 
scalar performance:
{'acc': 0.6239382, 'precision': 0.7635817, 'recall': 0.62024885, 'specificity': 0.62024885, 'f1': 0.5628787, 'auroc': 0.91393423, 'binary_precision': 0.9529412, 'binary_recall': 0.2527301, 'binary_specificity': 0.9877676, 'binary_f1_score': 0.39950675}
confusion matrix:
     0    1
0  646    8
1  479  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6826087, 'precision': 0.8058511, 'recall': 0.6826087, 'specificity': 0.6826087, 'f1': 0.64705384, 'auroc': 0.93158793, 'binary_precision': 1.0, 'binary_recall': 0.3652174, 'binary_specificity': 1.0, 'binary_f1_score': 0.5350318}
confusion matrix:
     0   1
0  230   0
1  146  84
early stop counter: 1
val acc:0.6239382028579712, best validation acc: 0.8471042513847351, corresponding to test acc:                         0.856521725654602 / 0.856521725654602
after epoch: 3,now: 2024-07-26 09:27:02.094083,epoch time: 0:01:03.882764,used: 0:03:18.271310,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94895285, 'precision': 0.95316017, 'recall': 0.9485848, 'specificity': 0.9485848, 'f1': 0.9488018, 'auroc': 0.9981204, 'binary_precision': 0.911415, 'binary_recall': 0.99545455, 'binary_specificity': 0.90171504, 'binary_f1_score': 0.95158285}
confusion matrix:
      0     1
0  1367   149
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.86177605, 'precision': 0.8625908, 'recall': 0.86153734, 'specificity': 0.86153734, 'f1': 0.86163056, 'auroc': 0.9203652, 'binary_precision': 0.877451, 'binary_recall': 0.83775353, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.8571429}
confusion matrix:
     0    1
0  579   75
1  104  537
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8673913, 'precision': 0.8834014, 'recall': 0.8673913, 'specificity': 0.8673913, 'f1': 0.8659923, 'auroc': 0.9360113, 'binary_precision': 0.96174866, 'binary_recall': 0.76521736, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.8523002}
confusion matrix:
     0    1
0  223    7
1   54  176
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 09:28:06.415805,epoch time: 0:01:04.321722,used: 0:04:22.593032,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9860031, 'recall': 0.9859875, 'specificity': 0.9859875, 'f1': 0.98592925, 'auroc': 0.9987159, 'binary_precision': 0.9940555, 'binary_recall': 0.9779077, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.9859155}
confusion matrix:
      0     1
0  1508     9
1    34  1505
---- Validation: 
scalar performance:
{'acc': 0.72664094, 'precision': 0.8005223, 'recall': 0.72413254, 'specificity': 0.72413254, 'f1': 0.70728594, 'auroc': 0.92162, 'binary_precision': 0.9470405, 'binary_recall': 0.47425896, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.6320166}
confusion matrix:
     0    1
0  637   17
1  337  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6173913, 'precision': 0.76634073, 'recall': 0.6173913, 'specificity': 0.6173913, 'f1': 0.5552039, 'auroc': 0.89415884, 'binary_precision': 0.9655172, 'binary_recall': 0.24347825, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.3888889}
confusion matrix:
     0   1
0  228   2
1  174  56
early stop counter: 1
val acc:0.7266409397125244, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8673912882804871 / 0.8673912882804871
after epoch: 5,now: 2024-07-26 09:29:11.012421,epoch time: 0:01:04.596616,used: 0:05:27.189648,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98477584, 'recall': 0.9845705, 'specificity': 0.9845705, 'f1': 0.98461735, 'auroc': 0.998847, 'binary_precision': 0.97757846, 'binary_recall': 0.99219763, 'binary_specificity': 0.9769434, 'binary_f1_score': 0.9848338}
confusion matrix:
      0     1
0  1483    35
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.77220076, 'precision': 0.8100374, 'recall': 0.7704335, 'specificity': 0.7704335, 'f1': 0.76423764, 'auroc': 0.9016826, 'binary_precision': 0.91586536, 'binary_recall': 0.5943838, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.7209083}
confusion matrix:
     0    1
0  619   35
1  260  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82608694, 'precision': 0.8573204, 'recall': 0.82608694, 'specificity': 0.82608694, 'f1': 0.8222016, 'auroc': 0.9299433, 'binary_precision': 0.962963, 'binary_recall': 0.67826086, 'binary_specificity': 0.973913, 'binary_f1_score': 0.79591835}
confusion matrix:
     0    1
0  224    6
1   74  156
early stop counter: 2
val acc:0.7722007632255554, best validation acc: 0.8617760539054871, corresponding to test acc:                         0.8673912882804871 / 0.8673912882804871
after epoch: 6,now: 2024-07-26 09:30:15.239365,epoch time: 0:01:04.226944,used: 0:06:31.416592,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9860059, 'recall': 0.9858966, 'specificity': 0.9858966, 'f1': 0.98592746, 'auroc': 0.9991074, 'binary_precision': 0.98132646, 'binary_recall': 0.9908973, 'binary_specificity': 0.98089594, 'binary_f1_score': 0.9860887}
confusion matrix:
      0     1
0  1489    29
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.87027025, 'precision': 0.8772522, 'recall': 0.86959046, 'specificity': 0.86959046, 'f1': 0.8695076, 'auroc': 0.93250704, 'binary_precision': 0.9261261, 'binary_recall': 0.8018721, 'binary_specificity': 0.93730885, 'binary_f1_score': 0.8595317}
confusion matrix:
     0    1
0  613   41
1  127  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83913046, 'precision': 0.87161326, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.8355365, 'auroc': 0.9208318, 'binary_precision': 0.9814815, 'binary_recall': 0.6913043, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.81122446}
confusion matrix:
     0    1
0  227    3
1   71  159
better model found
persisted
after epoch: 7,now: 2024-07-26 09:31:19.159919,epoch time: 0:01:03.920554,used: 0:07:35.337146,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.989195, 'recall': 0.98921275, 'specificity': 0.98921275, 'f1': 0.9892012, 'auroc': 0.9993648, 'binary_precision': 0.9908735, 'binary_recall': 0.9876543, 'binary_specificity': 0.99077123, 'binary_f1_score': 0.9892613}
confusion matrix:
      0     1
0  1503    14
1    19  1520
---- Validation: 
scalar performance:
{'acc': 0.8332046, 'precision': 0.8584722, 'recall': 0.8318699, 'specificity': 0.8318699, 'f1': 0.82980597, 'auroc': 0.9327909, 'binary_precision': 0.9511677, 'binary_recall': 0.698908, 'binary_specificity': 0.9648318, 'binary_f1_score': 0.80575544}
confusion matrix:
     0    1
0  631   23
1  193  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74130434, 'precision': 0.8295129, 'recall': 0.74130434, 'specificity': 0.74130434, 'f1': 0.7227498, 'auroc': 0.94311917, 'binary_precision': 1.0, 'binary_recall': 0.4826087, 'binary_specificity': 1.0, 'binary_f1_score': 0.6510264}
confusion matrix:
     0    1
0  230    0
1  119  111
early stop counter: 1
val acc:0.8332046270370483, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 8,now: 2024-07-26 09:32:23.318023,epoch time: 0:01:04.158104,used: 0:08:39.495250,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9818143, 'recall': 0.9812553, 'specificity': 0.9812553, 'f1': 0.9813403, 'auroc': 0.99935573, 'binary_precision': 0.96837443, 'binary_recall': 0.99544865, 'binary_specificity': 0.96706194, 'binary_f1_score': 0.9817249}
confusion matrix:
      0     1
0  1468    50
1     7  1531
---- Validation: 
scalar performance:
{'acc': 0.7822394, 'precision': 0.82036483, 'recall': 0.78049636, 'specificity': 0.78049636, 'f1': 0.7748243, 'auroc': 0.90717864, 'binary_precision': 0.92840093, 'binary_recall': 0.6068643, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.7339623}
confusion matrix:
     0    1
0  624   30
1  252  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8152174, 'precision': 0.8624133, 'recall': 0.8152174, 'specificity': 0.8152174, 'f1': 0.80899906, 'auroc': 0.94451797, 'binary_precision': 0.99319726, 'binary_recall': 0.6347826, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.77453583}
confusion matrix:
     0    1
0  229    1
1   84  146
early stop counter: 2
val acc:0.7822393774986267, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 9,now: 2024-07-26 09:33:27.363755,epoch time: 0:01:04.045732,used: 0:09:43.540982,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.970871, 'recall': 0.96937346, 'specificity': 0.96937346, 'f1': 0.96953607, 'auroc': 0.9988289, 'binary_precision': 0.9479876, 'binary_recall': 0.9941558, 'binary_specificity': 0.94459105, 'binary_f1_score': 0.970523}
confusion matrix:
      0     1
0  1432    84
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.87027025, 'precision': 0.8751309, 'recall': 0.8708464, 'specificity': 0.8708464, 'f1': 0.8699626, 'auroc': 0.9399662, 'binary_precision': 0.82984656, 'binary_recall': 0.92823714, 'binary_specificity': 0.81345564, 'binary_f1_score': 0.8762887}
confusion matrix:
     0    1
0  532  122
1   46  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8521739, 'precision': 0.8528409, 'recall': 0.8521739, 'specificity': 0.8521739, 'f1': 0.85210407, 'auroc': 0.91098297, 'binary_precision': 0.8375, 'binary_recall': 0.87391305, 'binary_specificity': 0.8304348, 'binary_f1_score': 0.85531914}
confusion matrix:
     0    1
0  191   39
1   29  201
early stop counter: 3
val acc:0.8702702522277832, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 10,now: 2024-07-26 09:34:32.737588,epoch time: 0:01:05.373833,used: 0:10:48.914815,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98276347, 'recall': 0.9824624, 'specificity': 0.9824624, 'f1': 0.9823283, 'auroc': 0.9995147, 'binary_precision': 0.99932796, 'binary_recall': 0.9655844, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9821664}
confusion matrix:
      0     1
0  1515     1
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.5907336, 'precision': 0.76349527, 'recall': 0.58663, 'specificity': 0.58663, 'f1': 0.50574505, 'auroc': 0.9231341, 'binary_precision': 0.974359, 'binary_recall': 0.17784712, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.30079156}
confusion matrix:
     0    1
0  651    3
1  527  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55, 'precision': 0.7631579, 'recall': 0.55, 'specificity': 0.55, 'f1': 0.4357367, 'auroc': 0.9484688, 'binary_precision': 1.0, 'binary_recall': 0.1, 'binary_specificity': 1.0, 'binary_f1_score': 0.18181819}
confusion matrix:
     0   1
0  230   0
1  207  23
early stop counter: 4
val acc:0.5907335877418518, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 11,now: 2024-07-26 09:35:37.029911,epoch time: 0:01:04.292323,used: 0:11:53.207138,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9831319, 'recall': 0.9829316, 'specificity': 0.9829316, 'f1': 0.9829808, 'auroc': 0.9993819, 'binary_precision': 0.97629726, 'binary_recall': 0.9902534, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9832258}
confusion matrix:
      0     1
0  1480    37
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.82857144, 'precision': 0.8375454, 'recall': 0.8277479, 'specificity': 0.8277479, 'f1': 0.8271606, 'auroc': 0.90919197, 'binary_precision': 0.89013034, 'binary_recall': 0.74570984, 'binary_specificity': 0.9097859, 'binary_f1_score': 0.811545}
confusion matrix:
     0    1
0  595   59
1  163  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8630435, 'precision': 0.8697607, 'recall': 0.8630434, 'specificity': 0.8630434, 'f1': 0.86241865, 'auroc': 0.9230246, 'binary_precision': 0.919598, 'binary_recall': 0.79565215, 'binary_specificity': 0.93043476, 'binary_f1_score': 0.8531468}
confusion matrix:
     0    1
0  214   16
1   47  183
early stop counter: 5
val acc:0.8285714387893677, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 12,now: 2024-07-26 09:36:40.810961,epoch time: 0:01:03.781050,used: 0:12:56.988188,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.98431957, 'recall': 0.9840759, 'specificity': 0.9840759, 'f1': 0.9839649, 'auroc': 0.9996805, 'binary_precision': 0.99932975, 'binary_recall': 0.9688109, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.98383373}
confusion matrix:
      0     1
0  1516     1
1    48  1491
---- Validation: 
scalar performance:
{'acc': 0.596139, 'precision': 0.7658708, 'recall': 0.5920902, 'specificity': 0.5920902, 'f1': 0.51488227, 'auroc': 0.9269985, 'binary_precision': 0.9758065, 'binary_recall': 0.18876755, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.31633988}
confusion matrix:
     0    1
0  651    3
1  520  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50652176, 'precision': 0.75164115, 'recall': 0.50652176, 'specificity': 0.50652176, 'f1': 0.34766445, 'auroc': 0.9306238, 'binary_precision': 1.0, 'binary_recall': 0.013043478, 'binary_specificity': 1.0, 'binary_f1_score': 0.025751071}
confusion matrix:
     0  1
0  230  0
1  227  3
early stop counter: 6
val acc:0.5961390137672424, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 13,now: 2024-07-26 09:37:44.943885,epoch time: 0:01:04.132924,used: 0:14:01.121112,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98920333, 'recall': 0.989199, 'specificity': 0.989199, 'f1': 0.98920107, 'auroc': 0.99953353, 'binary_precision': 0.9889539, 'binary_recall': 0.9895969, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.9892753}
confusion matrix:
      0     1
0  1501    17
1    16  1522
---- Validation: 
scalar performance:
{'acc': 0.73513514, 'precision': 0.80053127, 'recall': 0.7327749, 'specificity': 0.7327749, 'f1': 0.71859044, 'auroc': 0.9115249, 'binary_precision': 0.9382353, 'binary_recall': 0.4976599, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.65035677}
confusion matrix:
     0    1
0  633   21
1  322  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7543478, 'precision': 0.8280187, 'recall': 0.7543478, 'specificity': 0.7543478, 'f1': 0.73973435, 'auroc': 0.9376937, 'binary_precision': 0.9834711, 'binary_recall': 0.5173913, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.67806274}
confusion matrix:
     0    1
0  228    2
1  111  119
early stop counter: 7
val acc:0.7351351380348206, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 14,now: 2024-07-26 09:38:49.366901,epoch time: 0:01:04.423016,used: 0:15:05.544128,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9896493, 'recall': 0.98959893, 'specificity': 0.98959893, 'f1': 0.9895288, 'auroc': 0.9998535, 'binary_precision': 0.9993373, 'binary_recall': 0.979857, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9895013}
confusion matrix:
      0     1
0  1516     1
1    31  1508
---- Validation: 
scalar performance:
{'acc': 0.6108108, 'precision': 0.77884233, 'recall': 0.6068798, 'specificity': 0.6068798, 'f1': 0.53769654, 'auroc': 0.9290297, 'binary_precision': 0.9928058, 'binary_recall': 0.21528861, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.35384616}
confusion matrix:
     0    1
0  653    1
1  503  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5478261, 'precision': 0.7625571, 'recall': 0.5478261, 'specificity': 0.5478261, 'f1': 0.43161297, 'auroc': 0.93249524, 'binary_precision': 1.0, 'binary_recall': 0.09565217, 'binary_specificity': 1.0, 'binary_f1_score': 0.17460316}
confusion matrix:
     0   1
0  230   0
1  208  22
early stop counter: 8
val acc:0.6108108162879944, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 15,now: 2024-07-26 09:39:54.140054,epoch time: 0:01:04.773153,used: 0:16:10.317281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.98481447, 'recall': 0.98471457, 'specificity': 0.98471457, 'f1': 0.9846201, 'auroc': 0.9992221, 'binary_precision': 0.99667335, 'binary_recall': 0.9727273, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9845547}
confusion matrix:
      0     1
0  1511     5
1    42  1498
---- Validation: 
scalar performance:
{'acc': 0.84478766, 'precision': 0.85370374, 'recall': 0.843989, 'specificity': 0.843989, 'f1': 0.84357536, 'auroc': 0.9317287, 'binary_precision': 0.9074074, 'binary_recall': 0.7644306, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.8298052}
confusion matrix:
     0    1
0  604   50
1  151  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8608696, 'precision': 0.87590575, 'recall': 0.8608695, 'specificity': 0.8608695, 'f1': 0.85946417, 'auroc': 0.9132183, 'binary_precision': 0.95108694, 'binary_recall': 0.76086956, 'binary_specificity': 0.96086955, 'binary_f1_score': 0.8454106}
confusion matrix:
     0    1
0  221    9
1   55  175
early stop counter: 9
val acc:0.8447876572608948, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 16,now: 2024-07-26 09:40:58.160482,epoch time: 0:01:04.020428,used: 0:17:14.337709,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.98074543, 'recall': 0.980276, 'specificity': 0.980276, 'f1': 0.98035896, 'auroc': 0.99925303, 'binary_precision': 0.96892834, 'binary_recall': 0.9928525, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.9807446}
confusion matrix:
      0     1
0  1468    49
1    11  1528
---- Validation: 
scalar performance:
{'acc': 0.8694981, 'precision': 0.87144864, 'recall': 0.86913604, 'specificity': 0.86913604, 'f1': 0.86923575, 'auroc': 0.9239625, 'binary_precision': 0.89597315, 'binary_recall': 0.8330733, 'binary_specificity': 0.90519875, 'binary_f1_score': 0.8633791}
confusion matrix:
     0    1
0  592   62
1  107  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8152174, 'precision': 0.859848, 'recall': 0.8152174, 'specificity': 0.8152174, 'f1': 0.80930454, 'auroc': 0.92508507, 'binary_precision': 0.98657715, 'binary_recall': 0.6391304, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.77572554}
confusion matrix:
     0    1
0  228    2
1   83  147
early stop counter: 10
val acc:0.869498074054718, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 17,now: 2024-07-26 09:42:01.936397,epoch time: 0:01:03.775915,used: 0:18:18.113624,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927974, 'recall': 0.992805, 'specificity': 0.992805, 'f1': 0.9928008, 'auroc': 0.9996295, 'binary_precision': 0.99348956, 'binary_recall': 0.99219763, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.99284315}
confusion matrix:
      0     1
0  1508    10
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.8440154, 'precision': 0.8629672, 'recall': 0.84286785, 'specificity': 0.84286785, 'f1': 0.841628, 'auroc': 0.93113065, 'binary_precision': 0.94343436, 'binary_recall': 0.7285491, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.82218313}
confusion matrix:
     0    1
0  626   28
1  174  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8173913, 'precision': 0.85863805, 'recall': 0.8173913, 'specificity': 0.8173913, 'f1': 0.8119855, 'auroc': 0.9413233, 'binary_precision': 0.9802632, 'binary_recall': 0.6478261, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.78010476}
confusion matrix:
     0    1
0  227    3
1   81  149
early stop counter: 11
val acc:0.8440154194831848, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 18,now: 2024-07-26 09:43:05.909380,epoch time: 0:01:03.972983,used: 0:19:22.086607,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9874679, 'recall': 0.9873294, 'specificity': 0.9873294, 'f1': 0.9872378, 'auroc': 0.9993905, 'binary_precision': 1.0, 'binary_recall': 0.97465885, 'binary_specificity': 1.0, 'binary_f1_score': 0.9871668}
confusion matrix:
      0     1
0  1517     0
1    39  1500
---- Validation: 
scalar performance:
{'acc': 0.7335907, 'precision': 0.81308424, 'recall': 0.7310443, 'specificity': 0.7310443, 'f1': 0.71411544, 'auroc': 0.91362166, 'binary_precision': 0.9683544, 'binary_recall': 0.47737908, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.6394984}
confusion matrix:
     0    1
0  644   10
1  335  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67826086, 'precision': 0.80423284, 'recall': 0.67826086, 'specificity': 0.67826086, 'f1': 0.64110994, 'auroc': 0.94289225, 'binary_precision': 1.0, 'binary_recall': 0.35652173, 'binary_specificity': 1.0, 'binary_f1_score': 0.525641}
confusion matrix:
     0   1
0  230   0
1  148  82
early stop counter: 12
val acc:0.7335907220840454, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 19,now: 2024-07-26 09:44:09.934638,epoch time: 0:01:04.025258,used: 0:20:26.111865,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9751309, 'precision': 0.97608864, 'recall': 0.97530395, 'specificity': 0.97530395, 'f1': 0.9751237, 'auroc': 0.9991802, 'binary_precision': 0.9993174, 'binary_recall': 0.95126706, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.97470045}
confusion matrix:
      0     1
0  1516     1
1    75  1464
---- Validation: 
scalar performance:
{'acc': 0.63243246, 'precision': 0.7808188, 'recall': 0.62875164, 'specificity': 0.62875164, 'f1': 0.5730383, 'auroc': 0.9365002, 'binary_precision': 0.98245615, 'binary_recall': 0.26209047, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.4137931}
confusion matrix:
     0    1
0  651    3
1  473  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5478261, 'precision': 0.7625571, 'recall': 0.5478261, 'specificity': 0.5478261, 'f1': 0.43161297, 'auroc': 0.934466, 'binary_precision': 1.0, 'binary_recall': 0.09565217, 'binary_specificity': 1.0, 'binary_f1_score': 0.17460316}
confusion matrix:
     0   1
0  230   0
1  208  22
early stop counter: 13
val acc:0.6324324607849121, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 20,now: 2024-07-26 09:45:14.628053,epoch time: 0:01:04.693415,used: 0:21:30.805280,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98869336, 'recall': 0.98863125, 'specificity': 0.98863125, 'f1': 0.988547, 'auroc': 0.99971986, 'binary_precision': 0.9993364, 'binary_recall': 0.9779221, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98851335}
confusion matrix:
      0     1
0  1515     1
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.6988417, 'precision': 0.8008701, 'recall': 0.6958964, 'specificity': 0.6958964, 'f1': 0.6689725, 'auroc': 0.9391217, 'binary_precision': 0.9735849, 'binary_recall': 0.4024961, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.56953645}
confusion matrix:
     0    1
0  647    7
1  383  258
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54565215, 'precision': 0.76195896, 'recall': 0.54565215, 'specificity': 0.54565215, 'f1': 0.42746207, 'auroc': 0.9303355, 'binary_precision': 1.0, 'binary_recall': 0.09130435, 'binary_specificity': 1.0, 'binary_f1_score': 0.16733068}
confusion matrix:
     0   1
0  230   0
1  209  21
early stop counter: 14
val acc:0.6988416910171509, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 21,now: 2024-07-26 09:46:18.514875,epoch time: 0:01:03.886822,used: 0:22:34.692102,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9950916, 'precision': 0.9950893, 'recall': 0.9950937, 'specificity': 0.9950937, 'f1': 0.9950914, 'auroc': 0.9999131, 'binary_precision': 0.99544865, 'binary_recall': 0.9948018, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.9951251}
confusion matrix:
      0     1
0  1510     7
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.8123552, 'precision': 0.8486006, 'recall': 0.81073153, 'specificity': 0.81073153, 'f1': 0.8067787, 'auroc': 0.9418602, 'binary_precision': 0.95852536, 'binary_recall': 0.648986, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.77395356}
confusion matrix:
     0    1
0  636   18
1  225  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76304346, 'precision': 0.83923304, 'recall': 0.7630435, 'specificity': 0.7630435, 'f1': 0.74894726, 'auroc': 0.9342344, 'binary_precision': 1.0, 'binary_recall': 0.526087, 'binary_specificity': 1.0, 'binary_f1_score': 0.68945867}
confusion matrix:
     0    1
0  230    0
1  109  121
early stop counter: 15
val acc:0.8123552203178406, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 22,now: 2024-07-26 09:47:22.818422,epoch time: 0:01:04.303547,used: 0:23:38.995649,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9881029, 'recall': 0.9879714, 'specificity': 0.9879714, 'f1': 0.98789227, 'auroc': 0.9997709, 'binary_precision': 1.0, 'binary_recall': 0.9759428, 'binary_specificity': 1.0, 'binary_f1_score': 0.9878249}
confusion matrix:
      0     1
0  1518     0
1    37  1501
---- Validation: 
scalar performance:
{'acc': 0.68108106, 'precision': 0.78914297, 'recall': 0.6779867, 'specificity': 0.6779867, 'f1': 0.6459362, 'auroc': 0.9090697, 'binary_precision': 0.9634146, 'binary_recall': 0.3697348, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.53438556}
confusion matrix:
     0    1
0  645    9
1  404  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53913045, 'precision': 0.760181, 'recall': 0.53913045, 'specificity': 0.53913045, 'f1': 0.41484255, 'auroc': 0.94391304, 'binary_precision': 1.0, 'binary_recall': 0.07826087, 'binary_specificity': 1.0, 'binary_f1_score': 0.14516129}
confusion matrix:
     0   1
0  230   0
1  212  18
early stop counter: 16
val acc:0.6810810565948486, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 23,now: 2024-07-26 09:48:26.738813,epoch time: 0:01:03.920391,used: 0:24:42.916040,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908308, 'recall': 0.9908577, 'specificity': 0.9908577, 'f1': 0.99083745, 'auroc': 0.9996295, 'binary_precision': 0.9934726, 'binary_recall': 0.9883117, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9908854}
confusion matrix:
      0     1
0  1506    10
1    18  1522
---- Validation: 
scalar performance:
{'acc': 0.8563706, 'precision': 0.86861473, 'recall': 0.8554569, 'specificity': 0.8554569, 'f1': 0.8549311, 'auroc': 0.9390031, 'binary_precision': 0.93333334, 'binary_recall': 0.7644306, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.84048027}
confusion matrix:
     0    1
0  619   35
1  151  490
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8652174, 'precision': 0.8865237, 'recall': 0.8652174, 'specificity': 0.8652174, 'f1': 0.86333406, 'auroc': 0.9288705, 'binary_precision': 0.97727275, 'binary_recall': 0.7478261, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.84729064}
confusion matrix:
     0    1
0  226    4
1   58  172
early stop counter: 17
val acc:0.8563706278800964, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 24,now: 2024-07-26 09:49:31.169181,epoch time: 0:01:04.430368,used: 0:25:47.346408,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.9937788, 'recall': 0.9938036, 'specificity': 0.9938036, 'f1': 0.99378264, 'auroc': 0.99986637, 'binary_precision': 0.996732, 'binary_recall': 0.9909032, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.9938091}
confusion matrix:
      0     1
0  1512     5
1    14  1525
---- Validation: 
scalar performance:
{'acc': 0.71196914, 'precision': 0.80540115, 'recall': 0.70917237, 'specificity': 0.70917237, 'f1': 0.6863663, 'auroc': 0.9391892, 'binary_precision': 0.97183096, 'binary_recall': 0.43057722, 'binary_specificity': 0.9877676, 'binary_f1_score': 0.59675676}
confusion matrix:
     0    1
0  646    8
1  365  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70869565, 'precision': 0.8111963, 'recall': 0.70869565, 'specificity': 0.70869565, 'f1': 0.68255603, 'auroc': 0.93459356, 'binary_precision': 0.9897959, 'binary_recall': 0.42173913, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.59146345}
confusion matrix:
     0   1
0  229   1
1  133  97
early stop counter: 18
val acc:0.7119691371917725, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 25,now: 2024-07-26 09:50:35.752374,epoch time: 0:01:04.583193,used: 0:26:51.929601,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99672776, 'precision': 0.9967238, 'recall': 0.9967323, 'specificity': 0.9967323, 'f1': 0.99672765, 'auroc': 0.9998822, 'binary_precision': 0.99739754, 'binary_recall': 0.9961014, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.99674904}
confusion matrix:
      0     1
0  1513     4
1     6  1533
---- Validation: 
scalar performance:
{'acc': 0.7984556, 'precision': 0.8463408, 'recall': 0.7965824, 'specificity': 0.7965824, 'f1': 0.79052335, 'auroc': 0.94358015, 'binary_precision': 0.9726368, 'binary_recall': 0.6099844, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.7497603}
confusion matrix:
     0    1
0  643   11
1  250  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7521739, 'precision': 0.8343023, 'recall': 0.7521739, 'specificity': 0.7521739, 'f1': 0.73595697, 'auroc': 0.9466777, 'binary_precision': 1.0, 'binary_recall': 0.5043478, 'binary_specificity': 1.0, 'binary_f1_score': 0.6705202}
confusion matrix:
     0    1
0  230    0
1  114  116
early stop counter: 19
val acc:0.7984555959701538, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8673912882804871
after epoch: 26,now: 2024-07-26 09:51:39.708866,epoch time: 0:01:03.956492,used: 0:27:55.886093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.98421216, 'recall': 0.9835353, 'specificity': 0.9835353, 'f1': 0.98363066, 'auroc': 0.9998492, 'binary_precision': 0.96910465, 'binary_recall': 0.99934983, 'binary_specificity': 0.9677207, 'binary_f1_score': 0.9839949}
confusion matrix:
      0     1
0  1469    49
1     1  1537
---- Validation: 
scalar performance:
{'acc': 0.83861005, 'precision': 0.8439444, 'recall': 0.83798134, 'specificity': 0.83798134, 'f1': 0.8377914, 'auroc': 0.9212997, 'binary_precision': 0.88434166, 'binary_recall': 0.775351, 'binary_specificity': 0.90061164, 'binary_f1_score': 0.8262677}
confusion matrix:
     0    1
0  589   65
1  144  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8913044, 'precision': 0.8980769, 'recall': 0.8913044, 'specificity': 0.8913044, 'f1': 0.89084005, 'auroc': 0.93665403, 'binary_precision': 0.95, 'binary_recall': 0.82608694, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.88372093}
confusion matrix:
     0    1
0  220   10
1   40  190
new oracle model saved
early stop counter: 20
val acc:0.838610053062439, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8913043737411499
after epoch: 27,now: 2024-07-26 09:52:44.040747,epoch time: 0:01:04.331881,used: 0:29:00.217974,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.993476, 'recall': 0.9934895, 'specificity': 0.9934895, 'f1': 0.9934555, 'auroc': 0.9999448, 'binary_precision': 0.99868596, 'binary_recall': 0.9882965, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.99346405}
confusion matrix:
      0     1
0  1516     2
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.65173745, 'precision': 0.78616154, 'recall': 0.648268, 'specificity': 0.648268, 'f1': 0.6024441, 'auroc': 0.9350654, 'binary_precision': 0.97979796, 'binary_recall': 0.30265212, 'binary_specificity': 0.9938838, 'binary_f1_score': 0.46245533}
confusion matrix:
     0    1
0  650    4
1  447  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6130435, 'precision': 0.78186274, 'recall': 0.6130435, 'specificity': 0.6130435, 'f1': 0.54489875, 'auroc': 0.937656, 'binary_precision': 1.0, 'binary_recall': 0.22608696, 'binary_specificity': 1.0, 'binary_f1_score': 0.36879432}
confusion matrix:
     0   1
0  230   0
1  178  52
early stop counter: 21
val acc:0.6517374515533447, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8913043737411499
after epoch: 28,now: 2024-07-26 09:53:48.086866,epoch time: 0:01:04.046119,used: 0:30:04.264093,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98775494, 'recall': 0.9876496, 'specificity': 0.9876496, 'f1': 0.98756516, 'auroc': 0.9998269, 'binary_precision': 0.9993347, 'binary_recall': 0.9759584, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9875082}
confusion matrix:
      0     1
0  1516     1
1    37  1502
---- Validation: 
scalar performance:
{'acc': 0.646332, 'precision': 0.7863673, 'recall': 0.6427922, 'specificity': 0.6427922, 'f1': 0.5939828, 'auroc': 0.91542864, 'binary_precision': 0.984127, 'binary_recall': 0.2901716, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.44819278}
confusion matrix:
     0    1
0  651    3
1  455  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6043478, 'precision': 0.7791262, 'recall': 0.6043478, 'specificity': 0.6043478, 'f1': 0.53091735, 'auroc': 0.9259263, 'binary_precision': 1.0, 'binary_recall': 0.20869565, 'binary_specificity': 1.0, 'binary_f1_score': 0.34532374}
confusion matrix:
     0   1
0  230   0
1  182  48
early stop counter: 22
val acc:0.6463320255279541, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8913043737411499
after epoch: 29,now: 2024-07-26 09:54:52.320387,epoch time: 0:01:04.233521,used: 0:31:08.497614,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9903836, 'recall': 0.9901215, 'specificity': 0.9901215, 'f1': 0.99018085, 'auroc': 0.9998903, 'binary_precision': 0.98210865, 'binary_recall': 0.99870044, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.99033505}
confusion matrix:
      0     1
0  1489    28
1     2  1537
---- Validation: 
scalar performance:
{'acc': 0.8293436, 'precision': 0.85099113, 'recall': 0.82809377, 'specificity': 0.82809377, 'f1': 0.82627904, 'auroc': 0.92416286, 'binary_precision': 0.9356846, 'binary_recall': 0.7035881, 'binary_specificity': 0.9525994, 'binary_f1_score': 0.80320567}
confusion matrix:
     0    1
0  623   31
1  190  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8326087, 'precision': 0.87218404, 'recall': 0.8326087, 'specificity': 0.8326087, 'f1': 0.8280374, 'auroc': 0.94512284, 'binary_precision': 0.9935484, 'binary_recall': 0.6695652, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.79999995}
confusion matrix:
     0    1
0  229    1
1   76  154
early stop counter: 23
val acc:0.8293436169624329, best validation acc: 0.8702702522277832, corresponding to test acc:                         0.8391304612159729 / 0.8913043737411499
after epoch: 30,now: 2024-07-26 09:55:57.222801,epoch time: 0:01:04.902414,used: 0:32:13.400028,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_23_43_seed_9_23065536
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:32:13.400028 at 2024-07-26 09:55:57.222801
persisted model performance metric: 

scalar performance:
{'acc': 0.83913046, 'precision': 0.87161326, 'recall': 0.8391304, 'specificity': 0.8391304, 'f1': 0.8355365, 'auroc': 0.9208318, 'binary_precision': 0.9814815, 'binary_recall': 0.6913043, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.81122446}
confusion matrix:
     0    1
0  227    3
1   71  159
oracle model performance metric: 

scalar performance:
{'acc': 0.8913044, 'precision': 0.8980769, 'recall': 0.8913044, 'specificity': 0.8913044, 'f1': 0.89084005, 'auroc': 0.93665403, 'binary_precision': 0.95, 'binary_recall': 0.82608694, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.88372093}
confusion matrix:
     0    1
0  220   10
1   40  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 739746 GiB | 739746 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 731025 GiB | 731024 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 739746 GiB | 739746 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 731025 GiB | 731024 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 738813 GiB | 738813 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 730110 GiB | 730110 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8703 GiB |   8703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB | 136826 MiB | 122352 MiB |
|       from large pool |  14408 MiB |  14414 MiB | 136616 MiB | 122208 MiB |
|       from small pool |     66 MiB |     70 MiB |    210 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 527792 GiB | 527791 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 519016 GiB | 519016 GiB |
|       from small pool |  10601 KiB |     45 MiB |   8775 GiB |   8775 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129762 K  |  129761 K  |
|       from large pool |     187    |    1413    |   66043 K  |   66042 K  |
|       from small pool |    1123    |    1419    |   63719 K  |   63718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129762 K  |  129761 K  |
|       from large pool |     187    |    1413    |   66043 K  |   66042 K  |
|       from small pool |    1123    |    1419    |   63719 K  |   63718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    5782    |    5148    |
|       from large pool |     601    |     601    |    5677    |    5076    |
|       from small pool |      33    |      35    |     105    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      97    |     652    |   83816 K  |   83816 K  |
|       from large pool |      40    |     604    |   46655 K  |   46655 K  |
|       from small pool |      57    |     237    |   37161 K  |   37161 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 739746 GiB | 739746 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 731025 GiB | 731025 GiB |
|       from small pool |      0 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 739746 GiB | 739746 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 731025 GiB | 731025 GiB |
|       from small pool |      0 KiB |     60 MiB |   8721 GiB |   8721 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 738813 GiB | 738813 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 730110 GiB | 730110 GiB |
|       from small pool |      0 KiB |     60 MiB |   8703 GiB |   8703 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB | 136826 MiB | 135946 MiB |
|       from large pool |    830 MiB |  14414 MiB | 136616 MiB | 135786 MiB |
|       from small pool |     50 MiB |     70 MiB |    210 MiB |    160 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 527792 GiB | 527792 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 519017 GiB | 519017 GiB |
|       from small pool |      0 KiB |     45 MiB |   8775 GiB |   8775 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129762 K  |  129762 K  |
|       from large pool |       2    |    1413    |   66043 K  |   66043 K  |
|       from small pool |       0    |    1419    |   63719 K  |   63719 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129762 K  |  129762 K  |
|       from large pool |       2    |    1413    |   66043 K  |   66043 K  |
|       from small pool |       0    |    1419    |   63719 K  |   63719 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    5782    |    5720    |
|       from large pool |      37    |     601    |    5677    |    5640    |
|       from small pool |      25    |      35    |     105    |      80    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   83816 K  |   83816 K  |
|       from large pool |       4    |     604    |   46655 K  |   46655 K  |
|       from small pool |       0    |     237    |   37161 K  |   37161 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 09:56:02 2024]
Finished job 0.
1 of 1 steps (100%) done
