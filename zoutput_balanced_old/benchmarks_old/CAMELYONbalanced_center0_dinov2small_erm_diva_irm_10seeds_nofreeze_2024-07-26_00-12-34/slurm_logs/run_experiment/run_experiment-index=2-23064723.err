Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:18:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723

 Experiment start at: 2024-07-26 00:18:44.643852
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9202474, 'precision': 0.9299536, 'recall': 0.9211977, 'specificity': 0.9211977, 'f1': 0.9199045, 'auroc': 0.9902023, 'binary_precision': 0.99772036, 'binary_recall': 0.844373, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.91466385}
confusion matrix:
      0     1
0  1514     3
1   242  1313
---- Validation: 
scalar performance:
{'acc': 0.73136646, 'precision': 0.79292226, 'recall': 0.72812337, 'specificity': 0.72812337, 'f1': 0.7146208, 'auroc': 0.8499837, 'binary_precision': 0.9237537, 'binary_recall': 0.496063, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.6454918}
confusion matrix:
     0    1
0  627   26
1  320  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86744183, 'precision': 0.8858824, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.865839, 'auroc': 0.9282206, 'binary_precision': 0.9702381, 'binary_recall': 0.75813955, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.85117495}
confusion matrix:
     0    1
0  210    5
1   52  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:21:30.788266,epoch time: 0:02:46.144414,used: 0:02:46.144414,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.9659033, 'recall': 0.9659339, 'specificity': 0.9659339, 'f1': 0.96582025, 'auroc': 0.9945965, 'binary_precision': 0.97570586, 'binary_recall': 0.95624197, 'binary_specificity': 0.9756258, 'binary_f1_score': 0.96587586}
confusion matrix:
      0     1
0  1481    37
1    68  1486
---- Validation: 
scalar performance:
{'acc': 0.7670807, 'precision': 0.7883813, 'recall': 0.7651469, 'specificity': 0.7651469, 'f1': 0.7617873, 'auroc': 0.86682665, 'binary_precision': 0.86334056, 'binary_recall': 0.6267716, 'binary_specificity': 0.9035222, 'binary_f1_score': 0.72627735}
confusion matrix:
     0    1
0  590   63
1  237  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.85411763, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8404801, 'auroc': 0.9200865, 'binary_precision': 0.92, 'binary_recall': 0.74883723, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.82564104}
confusion matrix:
     0    1
0  201   14
1   54  161
better model found
persisted
after epoch: 2,now: 2024-07-26 00:24:16.123549,epoch time: 0:02:45.335283,used: 0:05:31.479697,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.96646714, 'recall': 0.9652411, 'specificity': 0.9652411, 'f1': 0.96482944, 'auroc': 0.99658453, 'binary_precision': 0.99725085, 'binary_recall': 0.933119, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9641196}
confusion matrix:
      0     1
0  1513     4
1   104  1451
---- Validation: 
scalar performance:
{'acc': 0.6273292, 'precision': 0.7578554, 'recall': 0.62228596, 'specificity': 0.62228596, 'f1': 0.56837904, 'auroc': 0.8804356, 'binary_precision': 0.9378531, 'binary_recall': 0.26141733, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.408867}
confusion matrix:
     0    1
0  642   11
1  469  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67209303, 'precision': 0.8019663, 'recall': 0.67209303, 'specificity': 0.67209303, 'f1': 0.63258773, 'auroc': 0.9028015, 'binary_precision': 1.0, 'binary_recall': 0.34418604, 'binary_specificity': 1.0, 'binary_f1_score': 0.5121107}
confusion matrix:
     0   1
0  215   0
1  141  74
early stop counter: 1
val acc:0.6273291707038879, best validation acc: 0.7670807242393494, corresponding to test acc:                         0.8418604731559753 / 0.8674418330192566
after epoch: 3,now: 2024-07-26 00:27:00.331733,epoch time: 0:02:44.208184,used: 0:08:15.687881,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.9739853, 'recall': 0.973925, 'specificity': 0.973925, 'f1': 0.9739514, 'auroc': 0.9967891, 'binary_precision': 0.9725064, 'binary_recall': 0.9762516, 'binary_specificity': 0.9715984, 'binary_f1_score': 0.97437537}
confusion matrix:
      0     1
0  1471    43
1    37  1521
---- Validation: 
scalar performance:
{'acc': 0.7709627, 'precision': 0.77605546, 'recall': 0.7699739, 'specificity': 0.7699739, 'f1': 0.7694304, 'auroc': 0.8541944, 'binary_precision': 0.810219, 'binary_recall': 0.6992126, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.75063396}
confusion matrix:
     0    1
0  549  104
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8326733, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325436, 'auroc': 0.91664684, 'binary_precision': 0.826484, 'binary_recall': 0.8418605, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8341014}
confusion matrix:
     0    1
0  177   38
1   34  181
better model found
persisted
after epoch: 4,now: 2024-07-26 00:29:45.671586,epoch time: 0:02:45.339853,used: 0:11:01.027734,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9609375, 'precision': 0.96319443, 'recall': 0.9614798, 'specificity': 0.9614798, 'f1': 0.96091485, 'auroc': 0.9962121, 'binary_precision': 0.99930555, 'binary_recall': 0.92362005, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.95997334}
confusion matrix:
      0     1
0  1513     1
1   119  1439
---- Validation: 
scalar performance:
{'acc': 0.5659938, 'precision': 0.74570876, 'recall': 0.5599294, 'specificity': 0.5599294, 'f1': 0.46075404, 'auroc': 0.8639761, 'binary_precision': 0.95238096, 'binary_recall': 0.12598425, 'binary_specificity': 0.99387443, 'binary_f1_score': 0.22253129}
confusion matrix:
     0   1
0  649   4
1  555  80
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6627907, 'precision': 0.79193825, 'recall': 0.66279066, 'specificity': 0.66279066, 'f1': 0.62085974, 'auroc': 0.8931747, 'binary_precision': 0.9861111, 'binary_recall': 0.33023256, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.4947735}
confusion matrix:
     0   1
0  214   1
1  144  71
early stop counter: 1
val acc:0.5659937858581543, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.8325581550598145 / 0.8674418330192566
after epoch: 5,now: 2024-07-26 00:32:29.877690,epoch time: 0:02:44.206104,used: 0:13:45.233838,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9746094, 'precision': 0.97553325, 'recall': 0.97493577, 'specificity': 0.97493577, 'f1': 0.97460544, 'auroc': 0.9973712, 'binary_precision': 1.0, 'binary_recall': 0.9498715, 'binary_specificity': 1.0, 'binary_f1_score': 0.9742913}
confusion matrix:
      0     1
0  1516     0
1    78  1478
---- Validation: 
scalar performance:
{'acc': 0.67391306, 'precision': 0.76873076, 'recall': 0.6697037, 'specificity': 0.6697037, 'f1': 0.639106, 'auroc': 0.85786736, 'binary_precision': 0.9249012, 'binary_recall': 0.36850393, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.5270271}
confusion matrix:
     0    1
0  634   19
1  401  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.797784, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.61622167, 'auroc': 0.8951217, 'binary_precision': 1.0, 'binary_recall': 0.32093024, 'binary_specificity': 1.0, 'binary_f1_score': 0.4859155}
confusion matrix:
     0   1
0  215   0
1  146  69
early stop counter: 2
val acc:0.6739130616188049, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.8325581550598145 / 0.8674418330192566
after epoch: 6,now: 2024-07-26 00:35:13.710775,epoch time: 0:02:43.833085,used: 0:16:29.066923,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9850567, 'recall': 0.984995, 'specificity': 0.984995, 'f1': 0.98502207, 'auroc': 0.9986391, 'binary_precision': 0.98337597, 'binary_recall': 0.987163, 'binary_specificity': 0.98282695, 'binary_f1_score': 0.98526585}
confusion matrix:
      0     1
0  1488    26
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.70962733, 'precision': 0.7519393, 'recall': 0.7067056, 'specificity': 0.7067056, 'f1': 0.695007, 'auroc': 0.8550819, 'binary_precision': 0.85175204, 'binary_recall': 0.4976378, 'binary_specificity': 0.91577333, 'binary_f1_score': 0.62823063}
confusion matrix:
     0    1
0  598   55
1  319  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.7582719, 'recall': 0.63255817, 'specificity': 0.63255817, 'f1': 0.58165026, 'auroc': 0.89414823, 'binary_precision': 0.93846154, 'binary_recall': 0.28372094, 'binary_specificity': 0.98139536, 'binary_f1_score': 0.43571427}
confusion matrix:
     0   1
0  211   4
1  154  61
early stop counter: 3
val acc:0.7096273303031921, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.8325581550598145 / 0.8674418330192566
after epoch: 7,now: 2024-07-26 00:37:57.553495,epoch time: 0:02:43.842720,used: 0:19:12.909643,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.9680972, 'recall': 0.96691465, 'specificity': 0.96691465, 'f1': 0.96645904, 'auroc': 0.9979189, 'binary_precision': 0.9993132, 'binary_recall': 0.9344894, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9658148}
confusion matrix:
      0     1
0  1514     1
1   102  1455
---- Validation: 
scalar performance:
{'acc': 0.5659938, 'precision': 0.74048096, 'recall': 0.559951, 'specificity': 0.559951, 'f1': 0.46167007, 'auroc': 0.87730527, 'binary_precision': 0.94186044, 'binary_recall': 0.12755905, 'binary_specificity': 0.992343, 'binary_f1_score': 0.22468792}
confusion matrix:
     0   1
0  648   5
1  554  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5232558, 'precision': 0.75595236, 'recall': 0.5232558, 'specificity': 0.5232558, 'f1': 0.38302714, 'auroc': 0.9267496, 'binary_precision': 1.0, 'binary_recall': 0.046511628, 'binary_specificity': 1.0, 'binary_f1_score': 0.08888888}
confusion matrix:
     0   1
0  215   0
1  205  10
early stop counter: 4
val acc:0.5659937858581543, best validation acc: 0.7709627151489258, corresponding to test acc:                         0.8325581550598145 / 0.8674418330192566
after epoch: 8,now: 2024-07-26 00:40:41.822012,epoch time: 0:02:44.268517,used: 0:21:57.178160,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98405075, 'recall': 0.9840416, 'specificity': 0.9840416, 'f1': 0.98404604, 'auroc': 0.998651, 'binary_precision': 0.9839641, 'binary_recall': 0.98459566, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.98427975}
confusion matrix:
      0     1
0  1489    25
1    24  1534
---- Validation: 
scalar performance:
{'acc': 0.80279505, 'precision': 0.8173076, 'recall': 0.8012806, 'specificity': 0.8012806, 'f1': 0.799935, 'auroc': 0.89282656, 'binary_precision': 0.8817635, 'binary_recall': 0.6929134, 'binary_specificity': 0.90964776, 'binary_f1_score': 0.7760141}
confusion matrix:
     0    1
0  594   59
1  195  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.856182, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.802814, 'auroc': 0.9272256, 'binary_precision': 0.98540145, 'binary_recall': 0.627907, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.76704544}
confusion matrix:
     0    1
0  213    2
1   80  135
better model found
persisted
after epoch: 9,now: 2024-07-26 00:43:26.596001,epoch time: 0:02:44.773989,used: 0:24:41.952149,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9806216, 'recall': 0.9803852, 'specificity': 0.9803852, 'f1': 0.9804618, 'auroc': 0.9988232, 'binary_precision': 0.9746032, 'binary_recall': 0.9871383, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.98083067}
confusion matrix:
      0     1
0  1477    40
1    20  1535
---- Validation: 
scalar performance:
{'acc': 0.871118, 'precision': 0.8711282, 'recall': 0.8710494, 'specificity': 0.8710494, 'f1': 0.8710804, 'auroc': 0.9230975, 'binary_precision': 0.87163234, 'binary_recall': 0.86614174, 'binary_specificity': 0.87595713, 'binary_f1_score': 0.8688783}
confusion matrix:
     0    1
0  572   81
1   85  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116279, 'precision': 0.8351871, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.80825865, 'auroc': 0.9091617, 'binary_precision': 0.9240506, 'binary_recall': 0.67906976, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.7828418}
confusion matrix:
     0    1
0  203   12
1   69  146
better model found
persisted
after epoch: 10,now: 2024-07-26 00:46:11.541436,epoch time: 0:02:44.945435,used: 0:27:26.897584,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9877251, 'recall': 0.98756874, 'specificity': 0.98756874, 'f1': 0.98762643, 'auroc': 0.9991648, 'binary_precision': 0.9834395, 'binary_recall': 0.99228793, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.98784393}
confusion matrix:
      0     1
0  1490    26
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.7873237, 'recall': 0.78621507, 'specificity': 0.78621507, 'f1': 0.78558195, 'auroc': 0.8603176, 'binary_precision': 0.7620438, 'binary_recall': 0.82204723, 'binary_specificity': 0.75038284, 'binary_f1_score': 0.7909091}
confusion matrix:
     0    1
0  490  163
1  113  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8553014, 'recall': 0.84883726, 'specificity': 0.84883726, 'f1': 0.84814656, 'auroc': 0.9216658, 'binary_precision': 0.9032258, 'binary_recall': 0.7813954, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.8379053}
confusion matrix:
     0    1
0  197   18
1   47  168
early stop counter: 1
val acc:0.7857142686843872, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8116279244422913 / 0.8674418330192566
after epoch: 11,now: 2024-07-26 00:48:55.731889,epoch time: 0:02:44.190453,used: 0:30:11.088037,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899033, 'recall': 0.98991144, 'specificity': 0.98991144, 'f1': 0.9899072, 'auroc': 0.9995591, 'binary_precision': 0.9903537, 'binary_recall': 0.98971725, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.99003536}
confusion matrix:
      0     1
0  1501    15
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.81832296, 'precision': 0.826828, 'recall': 0.8171805, 'specificity': 0.8171805, 'f1': 0.81673217, 'auroc': 0.88565433, 'binary_precision': 0.8761726, 'binary_recall': 0.73543304, 'binary_specificity': 0.89892805, 'binary_f1_score': 0.79965746}
confusion matrix:
     0    1
0  587   66
1  168  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8554238, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8403373, 'auroc': 0.91335857, 'binary_precision': 0.9248555, 'binary_recall': 0.74418604, 'binary_specificity': 0.9395349, 'binary_f1_score': 0.82474226}
confusion matrix:
     0    1
0  202   13
1   55  160
early stop counter: 2
val acc:0.8183229565620422, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8116279244422913 / 0.8674418330192566
after epoch: 12,now: 2024-07-26 00:51:39.539318,epoch time: 0:02:43.807429,used: 0:32:54.895466,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889475, 'recall': 0.98903704, 'specificity': 0.98903704, 'f1': 0.9889319, 'auroc': 0.99956965, 'binary_precision': 0.99673843, 'binary_recall': 0.98137444, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.98899674}
confusion matrix:
      0     1
0  1510     5
1    29  1528
---- Validation: 
scalar performance:
{'acc': 0.6708075, 'precision': 0.7607815, 'recall': 0.66664094, 'specificity': 0.66664094, 'f1': 0.63644105, 'auroc': 0.8795246, 'binary_precision': 0.91050583, 'binary_recall': 0.36850393, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.5246636}
confusion matrix:
     0    1
0  630   23
1  401  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60697675, 'precision': 0.76968807, 'recall': 0.60697675, 'specificity': 0.60697675, 'f1': 0.53716624, 'auroc': 0.9228556, 'binary_precision': 0.9791667, 'binary_recall': 0.21860465, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.35741445}
confusion matrix:
     0   1
0  214   1
1  168  47
early stop counter: 3
val acc:0.6708074808120728, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8116279244422913 / 0.8674418330192566
after epoch: 13,now: 2024-07-26 00:54:23.668199,epoch time: 0:02:44.128881,used: 0:35:39.024347,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.989904, 'recall': 0.9899113, 'specificity': 0.9899113, 'f1': 0.9899075, 'auroc': 0.9995172, 'binary_precision': 0.99034125, 'binary_recall': 0.989704, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.9900225}
confusion matrix:
      0     1
0  1503    15
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.82686335, 'precision': 0.8315934, 'recall': 0.8260156, 'specificity': 0.8260156, 'f1': 0.825956, 'auroc': 0.90704805, 'binary_precision': 0.86785716, 'binary_recall': 0.76535434, 'binary_specificity': 0.88667685, 'binary_f1_score': 0.8133891}
confusion matrix:
     0    1
0  579   74
1  149  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.8516543, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8459484, 'auroc': 0.90087616, 'binary_precision': 0.8941799, 'binary_recall': 0.7860465, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.8366337}
confusion matrix:
     0    1
0  195   20
1   46  169
early stop counter: 4
val acc:0.8268633484840393, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8116279244422913 / 0.8674418330192566
after epoch: 14,now: 2024-07-26 00:57:07.534168,epoch time: 0:02:43.865969,used: 0:38:22.890316,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98858523, 'recall': 0.988643, 'specificity': 0.988643, 'f1': 0.9886056, 'auroc': 0.9990568, 'binary_precision': 0.99159664, 'binary_recall': 0.9858612, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9887206}
confusion matrix:
      0     1
0  1503    13
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.63509315, 'precision': 0.7555114, 'recall': 0.6302251, 'specificity': 0.6302251, 'f1': 0.58174425, 'auroc': 0.8886744, 'binary_precision': 0.92746115, 'binary_recall': 0.28188977, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.43236712}
confusion matrix:
     0    1
0  639   14
1  456  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54418606, 'precision': 0.7615572, 'recall': 0.54418606, 'specificity': 0.54418606, 'f1': 0.42464706, 'auroc': 0.9065008, 'binary_precision': 1.0, 'binary_recall': 0.0883721, 'binary_specificity': 1.0, 'binary_f1_score': 0.16239317}
confusion matrix:
     0   1
0  215   0
1  196  19
early stop counter: 5
val acc:0.6350931525230408, best validation acc: 0.8711180090904236, corresponding to test acc:                         0.8116279244422913 / 0.8674418330192566
after epoch: 15,now: 2024-07-26 00:59:51.925894,epoch time: 0:02:44.391726,used: 0:41:07.282042,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_18_44_seed_0_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 0:41:07.282042 at 2024-07-26 00:59:51.925894
persisted model performance metric: 

scalar performance:
{'acc': 0.8116279, 'precision': 0.8351871, 'recall': 0.81162786, 'specificity': 0.81162786, 'f1': 0.80825865, 'auroc': 0.9091617, 'binary_precision': 0.9240506, 'binary_recall': 0.67906976, 'binary_specificity': 0.94418603, 'binary_f1_score': 0.7828418}
confusion matrix:
     0    1
0  203   12
1   69  146
oracle model performance metric: 

scalar performance:
{'acc': 0.86744183, 'precision': 0.8858824, 'recall': 0.8674419, 'specificity': 0.8674419, 'f1': 0.865839, 'auroc': 0.9282206, 'binary_precision': 0.9702381, 'binary_recall': 0.75813955, 'binary_specificity': 0.9767442, 'binary_f1_score': 0.85117495}
confusion matrix:
     0    1
0  210    5
1   52  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2389 MiB |   8910 MiB | 100135 GiB | 100133 GiB |
|       from large pool |   2297 MiB |   8834 MiB |  99261 GiB |  99259 GiB |
|       from small pool |     91 MiB |    129 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2389 MiB |   8910 MiB | 100135 GiB | 100133 GiB |
|       from large pool |   2297 MiB |   8834 MiB |  99261 GiB |  99259 GiB |
|       from small pool |     91 MiB |    129 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB |  99948 GiB |  99946 GiB |
|       from large pool |   2284 MiB |   8826 MiB |  99076 GiB |  99073 GiB |
|       from small pool |     91 MiB |    128 MiB |    872 GiB |    872 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9824 MiB |   9824 MiB |   9824 MiB |      0 B   |
|       from large pool |   9688 MiB |   9688 MiB |   9688 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1058 MiB |   1215 MiB |  61966 GiB |  61965 GiB |
|       from large pool |   1048 MiB |   1200 MiB |  61068 GiB |  61067 GiB |
|       from small pool |     10 MiB |     22 MiB |    898 GiB |    898 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   14217 K  |   14215 K  |
|       from large pool |     392    |     816    |    7145 K  |    7145 K  |
|       from small pool |    2072    |    2768    |    7071 K  |    7069 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   14217 K  |   14215 K  |
|       from large pool |     392    |     816    |    7145 K  |    7145 K  |
|       from small pool |    2072    |    2768    |    7071 K  |    7069 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     333    |     333    |     333    |       0    |
|       from large pool |     265    |     265    |     265    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |     320    |    8263 K  |    8263 K  |
|       from large pool |      82    |     255    |    4643 K  |    4643 K  |
|       from small pool |      68    |     226    |    3620 K  |    3620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8910 MiB | 100135 GiB | 100135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  99261 GiB |  99261 GiB |
|       from small pool |      0 KiB |    129 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8910 MiB | 100135 GiB | 100135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  99261 GiB |  99261 GiB |
|       from small pool |      0 KiB |    129 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |  99948 GiB |  99948 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  99076 GiB |  99076 GiB |
|       from small pool |      0 KiB |    128 MiB |    872 GiB |    872 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3448 MiB |   9824 MiB |   9824 MiB |   6376 MiB |
|       from large pool |   3346 MiB |   9688 MiB |   9688 MiB |   6342 MiB |
|       from small pool |    102 MiB |    136 MiB |    136 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1215 MiB |  61967 GiB |  61967 GiB |
|       from large pool |  24320 KiB |   1200 MiB |  61069 GiB |  61069 GiB |
|       from small pool |      0 KiB |     60 MiB |    898 GiB |    898 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   14217 K  |   14217 K  |
|       from large pool |       2    |     816    |    7145 K  |    7145 K  |
|       from small pool |       0    |    2768    |    7071 K  |    7071 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   14217 K  |   14217 K  |
|       from large pool |       2    |     816    |    7145 K  |    7145 K  |
|       from small pool |       0    |    2768    |    7071 K  |    7071 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     333    |     199    |
|       from large pool |      83    |     265    |     265    |     182    |
|       from small pool |      51    |      68    |      68    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |    8264 K  |    8264 K  |
|       from large pool |       3    |     255    |    4643 K  |    4643 K  |
|       from small pool |       0    |     226    |    3620 K  |    3620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8910 MiB | 100135 GiB | 100135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  99261 GiB |  99261 GiB |
|       from small pool |      0 KiB |    129 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8910 MiB | 100135 GiB | 100135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  99261 GiB |  99261 GiB |
|       from small pool |      0 KiB |    129 MiB |    873 GiB |    873 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |  99948 GiB |  99948 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  99076 GiB |  99076 GiB |
|       from small pool |      0 KiB |    128 MiB |    872 GiB |    872 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3448 MiB |   9824 MiB |   9824 MiB |   6376 MiB |
|       from large pool |   3346 MiB |   9688 MiB |   9688 MiB |   6342 MiB |
|       from small pool |    102 MiB |    136 MiB |    136 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1215 MiB |  61967 GiB |  61967 GiB |
|       from large pool |  24320 KiB |   1200 MiB |  61069 GiB |  61069 GiB |
|       from small pool |      0 KiB |     60 MiB |    898 GiB |    898 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   14217 K  |   14217 K  |
|       from large pool |       2    |     816    |    7145 K  |    7145 K  |
|       from small pool |       0    |    2768    |    7071 K  |    7071 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   14217 K  |   14217 K  |
|       from large pool |       2    |     816    |    7145 K  |    7145 K  |
|       from small pool |       0    |    2768    |    7071 K  |    7071 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     333    |     199    |
|       from large pool |      83    |     265    |     265    |     182    |
|       from small pool |      51    |      68    |      68    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |    8264 K  |    8264 K  |
|       from large pool |       3    |     255    |    4643 K  |    4643 K  |
|       from small pool |       0    |     226    |    3620 K  |    3620 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723

 Experiment start at: 2024-07-26 01:00:26.807735
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.95153797, 'recall': 0.94942296, 'specificity': 0.94942296, 'f1': 0.94885224, 'auroc': 0.99221414, 'binary_precision': 0.98950315, 'binary_recall': 0.90874034, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9474037}
confusion matrix:
      0     1
0  1501    15
1   142  1414
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8387891, 'recall': 0.79575014, 'specificity': 0.79575014, 'f1': 0.79133123, 'auroc': 0.91843563, 'binary_precision': 0.9514563, 'binary_recall': 0.62222224, 'binary_specificity': 0.96927804, 'binary_f1_score': 0.75239927}
confusion matrix:
     0    1
0  631   20
1  238  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.87751675, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.8333934, 'auroc': 0.9287901, 'binary_precision': 1.0, 'binary_recall': 0.6755555, 'binary_specificity': 1.0, 'binary_f1_score': 0.8063661}
confusion matrix:
     0    1
0  225    0
1   73  152
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:03:12.384919,epoch time: 0:02:45.577184,used: 0:02:45.577184,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.9737469, 'recall': 0.97356045, 'specificity': 0.97356045, 'f1': 0.9733066, 'auroc': 0.99661577, 'binary_precision': 0.9919947, 'binary_recall': 0.95504177, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.97316754}
confusion matrix:
      0     1
0  1503    12
1    70  1487
---- Validation: 
scalar performance:
{'acc': 0.7096019, 'precision': 0.7835631, 'recall': 0.70535076, 'specificity': 0.70535076, 'f1': 0.68660593, 'auroc': 0.85941774, 'binary_precision': 0.9243421, 'binary_recall': 0.44603175, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.60171306}
confusion matrix:
     0    1
0  628   23
1  349  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8152658, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80791754, 'auroc': 0.88981724, 'binary_precision': 0.8601036, 'binary_recall': 0.73777777, 'binary_specificity': 0.88, 'binary_f1_score': 0.79425836}
confusion matrix:
     0    1
0  198   27
1   59  166
early stop counter: 1
val acc:0.709601879119873, best validation acc: 0.7985948324203491, corresponding to test acc:                         0.8377777934074402 / 0.8377777934074402
after epoch: 2,now: 2024-07-26 01:05:56.625831,epoch time: 0:02:44.240912,used: 0:05:29.818096,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9782224, 'recall': 0.9781586, 'specificity': 0.9781586, 'f1': 0.9781854, 'auroc': 0.9976472, 'binary_precision': 0.9763124, 'binary_recall': 0.9807074, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.97850496}
confusion matrix:
      0     1
0  1480    37
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.8570808, 'recall': 0.85504353, 'specificity': 0.85504353, 'f1': 0.85526407, 'auroc': 0.9131714, 'binary_precision': 0.8764805, 'binary_recall': 0.82222223, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.8484848}
confusion matrix:
     0    1
0  578   73
1  112  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8763, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.8658079, 'auroc': 0.9240494, 'binary_precision': 0.93650794, 'binary_recall': 0.7866667, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.8550725}
confusion matrix:
     0    1
0  213   12
1   48  177
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 01:08:42.338027,epoch time: 0:02:45.712196,used: 0:08:15.530292,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.953125, 'precision': 0.95644474, 'recall': 0.95368165, 'specificity': 0.95368165, 'f1': 0.95307326, 'auroc': 0.9979367, 'binary_precision': 0.9985866, 'binary_recall': 0.9086817, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.95151514}
confusion matrix:
      0     1
0  1515     2
1   142  1413
---- Validation: 
scalar performance:
{'acc': 0.6112412, 'precision': 0.7567329, 'recall': 0.6049667, 'specificity': 0.6049667, 'f1': 0.5403746, 'auroc': 0.8728452, 'binary_precision': 0.9459459, 'binary_recall': 0.22222222, 'binary_specificity': 0.9877112, 'binary_f1_score': 0.35989717}
confusion matrix:
     0    1
0  643    8
1  490  140
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.84829724, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.77137935, 'auroc': 0.9233581, 'binary_precision': 1.0, 'binary_recall': 0.5644444, 'binary_specificity': 1.0, 'binary_f1_score': 0.7215909}
confusion matrix:
     0    1
0  225    0
1   98  127
early stop counter: 1
val acc:0.6112412214279175, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 4,now: 2024-07-26 01:11:26.499902,epoch time: 0:02:44.161875,used: 0:10:59.692167,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.97747135, 'recall': 0.9770973, 'specificity': 0.9770973, 'f1': 0.977203, 'auroc': 0.9983845, 'binary_precision': 0.9690461, 'binary_recall': 0.9864952, 'binary_specificity': 0.9676994, 'binary_f1_score': 0.9776928}
confusion matrix:
      0     1
0  1468    49
1    21  1534
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.85216916, 'recall': 0.85135686, 'specificity': 0.85135686, 'f1': 0.85151106, 'auroc': 0.9030899, 'binary_precision': 0.8618421, 'binary_recall': 0.83174604, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.8465267}
confusion matrix:
     0    1
0  567   84
1  106  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8608625, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599163, 'auroc': 0.9106568, 'binary_precision': 0.8785047, 'binary_recall': 0.83555555, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85649204}
confusion matrix:
     0    1
0  199   26
1   37  188
early stop counter: 2
val acc:0.8516783714294434, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 5,now: 2024-07-26 01:14:11.090028,epoch time: 0:02:44.590126,used: 0:13:44.282293,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.9831141, 'recall': 0.98319435, 'specificity': 0.98319435, 'f1': 0.9830725, 'auroc': 0.9984127, 'binary_precision': 0.99215174, 'binary_recall': 0.97430956, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.9831497}
confusion matrix:
      0     1
0  1503    12
1    40  1517
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.86447287, 'recall': 0.8543011, 'specificity': 0.8543011, 'f1': 0.8543457, 'auroc': 0.9101114, 'binary_precision': 0.9174484, 'binary_recall': 0.77619046, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.8409287}
confusion matrix:
     0    1
0  607   44
1  141  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8755981, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.84615386, 'auroc': 0.91697776, 'binary_precision': 0.9757576, 'binary_recall': 0.71555555, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.82564104}
confusion matrix:
     0    1
0  221    4
1   64  161
early stop counter: 3
val acc:0.8555815815925598, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8666666746139526 / 0.8666666746139526
after epoch: 6,now: 2024-07-26 01:16:55.122641,epoch time: 0:02:44.032613,used: 0:16:28.314906,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.9764386, 'recall': 0.97498274, 'specificity': 0.97498274, 'f1': 0.97523093, 'auroc': 0.9992615, 'binary_precision': 0.9556377, 'binary_recall': 0.99742764, 'binary_specificity': 0.9525379, 'binary_f1_score': 0.9760856}
confusion matrix:
      0     1
0  1445    72
1     4  1551
---- Validation: 
scalar performance:
{'acc': 0.8750976, 'precision': 0.87564886, 'recall': 0.8747824, 'specificity': 0.8747824, 'f1': 0.8749566, 'auroc': 0.9188239, 'binary_precision': 0.8865132, 'binary_recall': 0.85555553, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.87075925}
confusion matrix:
     0    1
0  582   69
1   91  539
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89111114, 'precision': 0.8933567, 'recall': 0.89111114, 'specificity': 0.89111114, 'f1': 0.89095545, 'auroc': 0.9272691, 'binary_precision': 0.9230769, 'binary_recall': 0.85333335, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.886836}
confusion matrix:
     0    1
0  209   16
1   33  192
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 01:19:40.787065,epoch time: 0:02:45.664424,used: 0:19:13.979330,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.9863911, 'recall': 0.98645294, 'specificity': 0.98645294, 'f1': 0.986328, 'auroc': 0.9991479, 'binary_precision': 0.9960682, 'binary_recall': 0.97686374, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.98637253}
confusion matrix:
      0     1
0  1510     6
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.754879, 'precision': 0.81620836, 'recall': 0.75122887, 'specificity': 0.75122887, 'f1': 0.74055445, 'auroc': 0.92321277, 'binary_precision': 0.9514286, 'binary_recall': 0.5285714, 'binary_specificity': 0.9738863, 'binary_f1_score': 0.67959183}
confusion matrix:
     0    1
0  634   17
1  297  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.86793566, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.82932043, 'auroc': 0.9219556, 'binary_precision': 0.9807692, 'binary_recall': 0.68, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8031496}
confusion matrix:
     0    1
0  222    3
1   72  153
early stop counter: 1
val acc:0.7548789978027344, best validation acc: 0.8750975728034973, corresponding to test acc:                         0.8911111354827881 / 0.8911111354827881
after epoch: 8,now: 2024-07-26 01:22:24.998056,epoch time: 0:02:44.210991,used: 0:21:58.190321,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97418666, 'recall': 0.97389543, 'specificity': 0.97389543, 'f1': 0.9736314, 'auroc': 0.9958426, 'binary_precision': 0.9939719, 'binary_recall': 0.9537275, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.973434}
confusion matrix:
      0     1
0  1507     9
1    72  1484
---- Validation: 
scalar performance:
{'acc': 0.7533177, 'precision': 0.7928651, 'recall': 0.750256, 'specificity': 0.750256, 'f1': 0.74313927, 'auroc': 0.8322581, 'binary_precision': 0.89646465, 'binary_recall': 0.56349206, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.69200784}
confusion matrix:
     0    1
0  610   41
1  275  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.8109091, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.793, 'auroc': 0.87192094, 'binary_precision': 0.88, 'binary_recall': 0.6844444, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.77}
confusion matrix:
     0    1
0  204   21
1   71  154
early stop counter: 2
val acc:0.7533177137374878, best validation acc: 0.8750975728034973, corresponding to test acc:                         0.8911111354827881 / 0.8911111354827881
after epoch: 9,now: 2024-07-26 01:25:09.631944,epoch time: 0:02:44.633888,used: 0:24:42.824209,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905599, 'recall': 0.9906516, 'specificity': 0.9906516, 'f1': 0.99055946, 'auroc': 0.9992454, 'binary_precision': 0.9973958, 'binary_recall': 0.98394346, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.990624}
confusion matrix:
      0     1
0  1511     4
1    25  1532
---- Validation: 
scalar performance:
{'acc': 0.8540203, 'precision': 0.86520356, 'recall': 0.8525858, 'specificity': 0.8525858, 'f1': 0.85250115, 'auroc': 0.9077244, 'binary_precision': 0.92514396, 'binary_recall': 0.7650794, 'binary_specificity': 0.94009215, 'binary_f1_score': 0.8375326}
confusion matrix:
     0    1
0  612   39
1  148  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.831683, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82094544, 'auroc': 0.87377775, 'binary_precision': 0.88770056, 'binary_recall': 0.73777777, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.8058253}
confusion matrix:
     0    1
0  204   21
1   59  166
early stop counter: 3
val acc:0.8540202975273132, best validation acc: 0.8750975728034973, corresponding to test acc:                         0.8911111354827881 / 0.8911111354827881
after epoch: 10,now: 2024-07-26 01:27:54.996546,epoch time: 0:02:45.364602,used: 0:27:28.188811,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.98078334, 'recall': 0.9808631, 'specificity': 0.9808631, 'f1': 0.98079324, 'auroc': 0.9987138, 'binary_precision': 0.98635477, 'binary_recall': 0.9755784, 'binary_specificity': 0.98614776, 'binary_f1_score': 0.98093706}
confusion matrix:
      0     1
0  1495    21
1    38  1518
---- Validation: 
scalar performance:
{'acc': 0.86026543, 'precision': 0.860653, 'recall': 0.85998464, 'specificity': 0.85998464, 'f1': 0.860129, 'auroc': 0.9025315, 'binary_precision': 0.86906713, 'binary_recall': 0.8428571, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.85576147}
confusion matrix:
     0    1
0  571   80
1   99  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8471658, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.8366736, 'auroc': 0.907121, 'binary_precision': 0.90425533, 'binary_recall': 0.75555557, 'binary_specificity': 0.92, 'binary_f1_score': 0.8232446}
confusion matrix:
     0    1
0  207   18
1   55  170
early stop counter: 4
val acc:0.8602654337882996, best validation acc: 0.8750975728034973, corresponding to test acc:                         0.8911111354827881 / 0.8911111354827881
after epoch: 11,now: 2024-07-26 01:30:39.725730,epoch time: 0:02:44.729184,used: 0:30:12.917995,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9628906, 'precision': 0.9650521, 'recall': 0.96334404, 'specificity': 0.96334404, 'f1': 0.96286786, 'auroc': 0.9985434, 'binary_precision': 1.0, 'binary_recall': 0.9266881, 'binary_specificity': 1.0, 'binary_f1_score': 0.9619492}
confusion matrix:
      0     1
0  1517     0
1   114  1441
---- Validation: 
scalar performance:
{'acc': 0.71975017, 'precision': 0.80230147, 'recall': 0.7154122, 'specificity': 0.7154122, 'f1': 0.69657874, 'auroc': 0.8800386, 'binary_precision': 0.956229, 'binary_recall': 0.45079365, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.61272925}
confusion matrix:
     0    1
0  638   13
1  346  284
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8665938, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.82692313, 'auroc': 0.8980938, 'binary_precision': 0.9806452, 'binary_recall': 0.6755555, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.8000001}
confusion matrix:
     0    1
0  222    3
1   73  152
early stop counter: 5
val acc:0.719750165939331, best validation acc: 0.8750975728034973, corresponding to test acc:                         0.8911111354827881 / 0.8911111354827881
after epoch: 12,now: 2024-07-26 01:33:23.911450,epoch time: 0:02:44.185720,used: 0:32:57.103715,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_00_26_seed_1_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:32:57.103715 at 2024-07-26 01:33:23.911450
persisted model performance metric: 

scalar performance:
{'acc': 0.89111114, 'precision': 0.8933567, 'recall': 0.89111114, 'specificity': 0.89111114, 'f1': 0.89095545, 'auroc': 0.9272691, 'binary_precision': 0.9230769, 'binary_recall': 0.85333335, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.886836}
confusion matrix:
     0    1
0  209   16
1   33  192
oracle model performance metric: 

scalar performance:
{'acc': 0.89111114, 'precision': 0.8933567, 'recall': 0.89111114, 'specificity': 0.89111114, 'f1': 0.89095545, 'auroc': 0.9272691, 'binary_precision': 0.9230769, 'binary_recall': 0.85333335, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.886836}
confusion matrix:
     0    1
0  209   16
1   33  192
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2390 MiB |   8912 MiB | 180225 GiB | 180223 GiB |
|       from large pool |   2298 MiB |   8836 MiB | 178648 GiB | 178646 GiB |
|       from small pool |     91 MiB |    132 MiB |   1576 GiB |   1576 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2390 MiB |   8912 MiB | 180225 GiB | 180223 GiB |
|       from large pool |   2298 MiB |   8836 MiB | 178648 GiB | 178646 GiB |
|       from small pool |     91 MiB |    132 MiB |   1576 GiB |   1576 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 179964 GiB | 179962 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 178389 GiB | 178387 GiB |
|       from small pool |     91 MiB |    132 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  16120 MiB |   6376 MiB |
|       from large pool |   9604 MiB |   9688 MiB |  15946 MiB |   6342 MiB |
|       from small pool |    140 MiB |    140 MiB |    174 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1133 MiB |   1825 MiB | 121875 GiB | 121874 GiB |
|       from large pool |   1123 MiB |   1820 MiB | 120253 GiB | 120252 GiB |
|       from small pool |     10 MiB |     60 MiB |   1622 GiB |   1622 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   25618 K  |   25615 K  |
|       from large pool |     392    |     816    |   12867 K  |   12866 K  |
|       from small pool |    2084    |    2780    |   12750 K  |   12748 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   25618 K  |   25615 K  |
|       from large pool |     392    |     816    |   12867 K  |   12866 K  |
|       from small pool |    2084    |    2780    |   12750 K  |   12748 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     289    |     333    |     488    |     199    |
|       from large pool |     219    |     265    |     401    |     182    |
|       from small pool |      70    |      70    |      87    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |     320    |   14682 K  |   14681 K  |
|       from large pool |      81    |     255    |    8122 K  |    8122 K  |
|       from small pool |      69    |     226    |    6559 K  |    6559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8912 MiB | 180225 GiB | 180225 GiB |
|       from large pool |  16640 KiB |   8836 MiB | 178648 GiB | 178648 GiB |
|       from small pool |      0 KiB |    132 MiB |   1576 GiB |   1576 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8912 MiB | 180225 GiB | 180225 GiB |
|       from large pool |  16640 KiB |   8836 MiB | 178648 GiB | 178648 GiB |
|       from small pool |      0 KiB |    132 MiB |   1576 GiB |   1576 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 179964 GiB | 179964 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 178389 GiB | 178389 GiB |
|       from small pool |      0 KiB |    132 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3524 MiB |   9824 MiB |  16120 MiB |  12596 MiB |
|       from large pool |   3422 MiB |   9688 MiB |  15946 MiB |  12524 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 121876 GiB | 121876 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 120253 GiB | 120253 GiB |
|       from small pool |      0 KiB |     60 MiB |   1622 GiB |   1622 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   25618 K  |   25618 K  |
|       from large pool |       2    |     816    |   12867 K  |   12867 K  |
|       from small pool |       0    |    2780    |   12750 K  |   12750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   25618 K  |   25618 K  |
|       from large pool |       2    |     816    |   12867 K  |   12867 K  |
|       from small pool |       0    |    2780    |   12750 K  |   12750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     333    |     488    |     355    |
|       from large pool |      82    |     265    |     401    |     319    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   14682 K  |   14682 K  |
|       from large pool |       3    |     255    |    8122 K  |    8122 K  |
|       from small pool |       0    |     226    |    6559 K  |    6559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8912 MiB | 180225 GiB | 180225 GiB |
|       from large pool |  16640 KiB |   8836 MiB | 178648 GiB | 178648 GiB |
|       from small pool |      0 KiB |    132 MiB |   1576 GiB |   1576 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8912 MiB | 180225 GiB | 180225 GiB |
|       from large pool |  16640 KiB |   8836 MiB | 178648 GiB | 178648 GiB |
|       from small pool |      0 KiB |    132 MiB |   1576 GiB |   1576 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 179964 GiB | 179964 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 178389 GiB | 178389 GiB |
|       from small pool |      0 KiB |    132 MiB |   1574 GiB |   1574 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3524 MiB |   9824 MiB |  16120 MiB |  12596 MiB |
|       from large pool |   3422 MiB |   9688 MiB |  15946 MiB |  12524 MiB |
|       from small pool |    102 MiB |    140 MiB |    174 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 121876 GiB | 121876 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 120253 GiB | 120253 GiB |
|       from small pool |      0 KiB |     60 MiB |   1622 GiB |   1622 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   25618 K  |   25618 K  |
|       from large pool |       2    |     816    |   12867 K  |   12867 K  |
|       from small pool |       0    |    2780    |   12750 K  |   12750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   25618 K  |   25618 K  |
|       from large pool |       2    |     816    |   12867 K  |   12867 K  |
|       from small pool |       0    |    2780    |   12750 K  |   12750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     333    |     488    |     355    |
|       from large pool |      82    |     265    |     401    |     319    |
|       from small pool |      51    |      70    |      87    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   14682 K  |   14682 K  |
|       from large pool |       3    |     255    |    8122 K  |    8122 K  |
|       from small pool |       0    |     226    |    6559 K  |    6559 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723

 Experiment start at: 2024-07-26 01:34:01.377793
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96040577, 'precision': 0.96088123, 'recall': 0.9605447, 'specificity': 0.9605447, 'f1': 0.96040165, 'auroc': 0.9923731, 'binary_precision': 0.9777778, 'binary_recall': 0.94285715, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9599999}
confusion matrix:
      0     1
0  1483    33
1    88  1452
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.7688114, 'recall': 0.6598723, 'specificity': 0.6598723, 'f1': 0.62719715, 'auroc': 0.8929398, 'binary_precision': 0.92672414, 'binary_recall': 0.34565917, 'binary_specificity': 0.9740854, 'binary_f1_score': 0.50351286}
confusion matrix:
     0    1
0  639   17
1  407  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7222222, 'precision': 0.80393994, 'recall': 0.7222222, 'specificity': 0.7222222, 'f1': 0.7022059, 'auroc': 0.9082433, 'binary_precision': 0.96153843, 'binary_recall': 0.46296296, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.62499994}
confusion matrix:
     0    1
0  212    4
1  116  100
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:36:46.226471,epoch time: 0:02:44.848678,used: 0:02:44.848678,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.97456956, 'recall': 0.9745468, 'specificity': 0.9745468, 'f1': 0.97447646, 'auroc': 0.99625635, 'binary_precision': 0.9834656, 'binary_recall': 0.9655844, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.974443}
confusion matrix:
      0     1
0  1491    25
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.829421, 'precision': 0.83223736, 'recall': 0.8281336, 'specificity': 0.8281336, 'f1': 0.8285708, 'auroc': 0.8954886, 'binary_precision': 0.85689044, 'binary_recall': 0.7797428, 'binary_specificity': 0.8765244, 'binary_f1_score': 0.81649834}
confusion matrix:
     0    1
0  575   81
1  137  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8356481, 'precision': 0.84579456, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8344336, 'auroc': 0.9282193, 'binary_precision': 0.9050279, 'binary_recall': 0.75, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8202532}
confusion matrix:
     0    1
0  199   17
1   54  162
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:39:31.146336,epoch time: 0:02:44.919865,used: 0:05:29.768543,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9597513, 'precision': 0.96166146, 'recall': 0.95950985, 'specificity': 0.95950985, 'f1': 0.95969224, 'auroc': 0.99685514, 'binary_precision': 0.93386406, 'binary_recall': 0.99025977, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.9612355}
confusion matrix:
      0     1
0  1408   108
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.82472616, 'precision': 0.82540935, 'recall': 0.82535195, 'specificity': 0.82535195, 'f1': 0.82472575, 'auroc': 0.8865677, 'binary_precision': 0.8024316, 'binary_recall': 0.84887457, 'binary_specificity': 0.8018293, 'binary_f1_score': 0.825}
confusion matrix:
     0    1
0  526  130
1   94  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7731481, 'precision': 0.8072916, 'recall': 0.7731482, 'specificity': 0.7731482, 'f1': 0.76666665, 'auroc': 0.926376, 'binary_precision': 0.7048611, 'binary_recall': 0.9398148, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.8055555}
confusion matrix:
     0    1
0  131   85
1   13  203
early stop counter: 1
val acc:0.8247261643409729, best validation acc: 0.8294209837913513, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 3,now: 2024-07-26 01:42:14.532597,epoch time: 0:02:43.386261,used: 0:08:13.154804,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.96765363, 'recall': 0.9660958, 'specificity': 0.9660958, 'f1': 0.966259, 'auroc': 0.9981371, 'binary_precision': 0.94434136, 'binary_recall': 0.99155843, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.96737415}
confusion matrix:
      0     1
0  1426    90
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.7856025, 'precision': 0.7914372, 'recall': 0.7874088, 'specificity': 0.7874088, 'f1': 0.78512895, 'auroc': 0.8778846, 'binary_precision': 0.7430168, 'binary_recall': 0.8553055, 'binary_specificity': 0.7195122, 'binary_f1_score': 0.79521674}
confusion matrix:
     0    1
0  472  184
1   90  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.8048911, 'recall': 0.79861116, 'specificity': 0.79861116, 'f1': 0.7975687, 'auroc': 0.8996271, 'binary_precision': 0.7611336, 'binary_recall': 0.8703704, 'binary_specificity': 0.7268519, 'binary_f1_score': 0.812095}
confusion matrix:
     0    1
0  157   59
1   28  188
early stop counter: 2
val acc:0.7856025099754333, best validation acc: 0.8294209837913513, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 4,now: 2024-07-26 01:44:57.910106,epoch time: 0:02:43.377509,used: 0:10:56.532313,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98331094, 'recall': 0.9831015, 'specificity': 0.9831015, 'f1': 0.9829834, 'auroc': 0.9985707, 'binary_precision': 0.997992, 'binary_recall': 0.9681818, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9828609}
confusion matrix:
      0     1
0  1513     3
1    49  1491
---- Validation: 
scalar performance:
{'acc': 0.71283257, 'precision': 0.7844986, 'recall': 0.7059838, 'specificity': 0.7059838, 'f1': 0.689114, 'auroc': 0.84990144, 'binary_precision': 0.9207921, 'binary_recall': 0.44855306, 'binary_specificity': 0.9634146, 'binary_f1_score': 0.60324323}
confusion matrix:
     0    1
0  632   24
1  343  279
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.8185841, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.69016004, 'auroc': 0.9068073, 'binary_precision': 1.0, 'binary_recall': 0.43055555, 'binary_specificity': 1.0, 'binary_f1_score': 0.6019417}
confusion matrix:
     0   1
0  216   0
1  123  93
early stop counter: 3
val acc:0.7128325700759888, best validation acc: 0.8294209837913513, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 5,now: 2024-07-26 01:47:41.399103,epoch time: 0:02:43.488997,used: 0:13:40.021310,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.9787276, 'recall': 0.97852004, 'specificity': 0.97852004, 'f1': 0.978402, 'auroc': 0.99789774, 'binary_precision': 0.9933066, 'binary_recall': 0.96363634, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.97824657}
confusion matrix:
      0     1
0  1506    10
1    56  1484
---- Validation: 
scalar performance:
{'acc': 0.5978091, 'precision': 0.7267926, 'recall': 0.5874417, 'specificity': 0.5874417, 'f1': 0.5187463, 'auroc': 0.8235022, 'binary_precision': 0.8913044, 'binary_recall': 0.1977492, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.3236842}
confusion matrix:
     0    1
0  641   15
1  499  123
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.73946786, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.43168578, 'auroc': 0.81340015, 'binary_precision': 0.95454544, 'binary_recall': 0.097222224, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.17647058}
confusion matrix:
     0   1
0  215   1
1  195  21
early stop counter: 4
val acc:0.5978090763092041, best validation acc: 0.8294209837913513, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 6,now: 2024-07-26 01:50:24.898056,epoch time: 0:02:43.498953,used: 0:16:23.520263,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.982196, 'recall': 0.98209655, 'specificity': 0.98209655, 'f1': 0.98200226, 'auroc': 0.99803436, 'binary_precision': 0.994012, 'binary_recall': 0.97012985, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9819257}
confusion matrix:
      0     1
0  1507     9
1    46  1494
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.7245408, 'recall': 0.60622203, 'specificity': 0.60622203, 'f1': 0.55240196, 'auroc': 0.8130655, 'binary_precision': 0.8742857, 'binary_recall': 0.24598071, 'binary_specificity': 0.9664634, 'binary_f1_score': 0.38393977}
confusion matrix:
     0    1
0  634   22
1  469  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175926, 'precision': 0.81473213, 'recall': 0.7175926, 'specificity': 0.7175926, 'f1': 0.69398, 'auroc': 0.9100437, 'binary_precision': 0.9895833, 'binary_recall': 0.4398148, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.60897434}
confusion matrix:
     0   1
0  215   1
1  121  95
early stop counter: 5
val acc:0.6158059239387512, best validation acc: 0.8294209837913513, corresponding to test acc:                         0.8356481194496155 / 0.8356481194496155
after epoch: 7,now: 2024-07-26 01:53:08.318766,epoch time: 0:02:43.420710,used: 0:19:06.940973,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_34_01_seed_2_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:06.940973 at 2024-07-26 01:53:08.318766
persisted model performance metric: 

scalar performance:
{'acc': 0.8356481, 'precision': 0.84579456, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8344336, 'auroc': 0.9282193, 'binary_precision': 0.9050279, 'binary_recall': 0.75, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8202532}
confusion matrix:
     0    1
0  199   17
1   54  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8356481, 'precision': 0.84579456, 'recall': 0.8356482, 'specificity': 0.8356482, 'f1': 0.8344336, 'auroc': 0.9282193, 'binary_precision': 0.9050279, 'binary_recall': 0.75, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.8202532}
confusion matrix:
     0    1
0  199   17
1   54  162
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2396 MiB |   8915 MiB | 226737 GiB | 226735 GiB |
|       from large pool |   2304 MiB |   8839 MiB | 224754 GiB | 224751 GiB |
|       from small pool |     91 MiB |    132 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2396 MiB |   8915 MiB | 226737 GiB | 226735 GiB |
|       from large pool |   2304 MiB |   8839 MiB | 224754 GiB | 224751 GiB |
|       from small pool |     91 MiB |    132 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 226437 GiB | 226434 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 224456 GiB | 224453 GiB |
|       from small pool |     91 MiB |    132 MiB |   1980 GiB |   1980 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9738 MiB |   9824 MiB |  22334 MiB |  12596 MiB |
|       from large pool |   9602 MiB |   9688 MiB |  22126 MiB |  12524 MiB |
|       from small pool |    136 MiB |    140 MiB |    208 MiB |     72 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    991 MiB |   1825 MiB | 155921 GiB | 155920 GiB |
|       from large pool |    981 MiB |   1820 MiB | 153880 GiB | 153879 GiB |
|       from small pool |     10 MiB |     60 MiB |   2040 GiB |   2040 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   32238 K  |   32235 K  |
|       from large pool |     392    |     816    |   16190 K  |   16190 K  |
|       from small pool |    2072    |    2780    |   16047 K  |   16045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   32238 K  |   32235 K  |
|       from large pool |     392    |     816    |   16190 K  |   16190 K  |
|       from small pool |    2072    |    2780    |   16047 K  |   16045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     283    |     333    |     638    |     355    |
|       from large pool |     215    |     265    |     534    |     319    |
|       from small pool |      68    |      70    |     104    |      36    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     320    |   18351 K  |   18351 K  |
|       from large pool |      74    |     255    |   10109 K  |   10109 K  |
|       from small pool |      68    |     226    |    8242 K  |    8242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 226737 GiB | 226737 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 224754 GiB | 224753 GiB |
|       from small pool |      0 KiB |    132 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 226737 GiB | 226737 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 224754 GiB | 224753 GiB |
|       from small pool |      0 KiB |    132 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 226437 GiB | 226437 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 224456 GiB | 224456 GiB |
|       from small pool |      0 KiB |    132 MiB |   1980 GiB |   1980 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3388 MiB |   9824 MiB |  22334 MiB |  18946 MiB |
|       from large pool |   3286 MiB |   9688 MiB |  22126 MiB |  18840 MiB |
|       from small pool |    102 MiB |    140 MiB |    208 MiB |    106 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 155922 GiB | 155922 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 153881 GiB | 153881 GiB |
|       from small pool |      0 KiB |     60 MiB |   2040 GiB |   2040 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   32238 K  |   32238 K  |
|       from large pool |       2    |     816    |   16190 K  |   16190 K  |
|       from small pool |       0    |    2780    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   32238 K  |   32238 K  |
|       from large pool |       2    |     816    |   16190 K  |   16190 K  |
|       from small pool |       0    |    2780    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |     638    |     509    |
|       from large pool |      78    |     265    |     534    |     456    |
|       from small pool |      51    |      70    |     104    |      53    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   18352 K  |   18352 K  |
|       from large pool |       3    |     255    |   10109 K  |   10109 K  |
|       from small pool |       0    |     226    |    8242 K  |    8242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 226737 GiB | 226737 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 224754 GiB | 224753 GiB |
|       from small pool |      0 KiB |    132 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 226737 GiB | 226737 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 224754 GiB | 224753 GiB |
|       from small pool |      0 KiB |    132 MiB |   1983 GiB |   1983 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 226437 GiB | 226437 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 224456 GiB | 224456 GiB |
|       from small pool |      0 KiB |    132 MiB |   1980 GiB |   1980 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3388 MiB |   9824 MiB |  22334 MiB |  18946 MiB |
|       from large pool |   3286 MiB |   9688 MiB |  22126 MiB |  18840 MiB |
|       from small pool |    102 MiB |    140 MiB |    208 MiB |    106 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 155922 GiB | 155922 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 153881 GiB | 153881 GiB |
|       from small pool |      0 KiB |     60 MiB |   2040 GiB |   2040 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   32238 K  |   32238 K  |
|       from large pool |       2    |     816    |   16190 K  |   16190 K  |
|       from small pool |       0    |    2780    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   32238 K  |   32238 K  |
|       from large pool |       2    |     816    |   16190 K  |   16190 K  |
|       from small pool |       0    |    2780    |   16047 K  |   16047 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |     638    |     509    |
|       from large pool |      78    |     265    |     534    |     456    |
|       from small pool |      51    |      70    |     104    |      53    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   18352 K  |   18352 K  |
|       from large pool |       3    |     255    |   10109 K  |   10109 K  |
|       from small pool |       0    |     226    |    8242 K  |    8242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723

 Experiment start at: 2024-07-26 01:53:42.856639
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.959954, 'recall': 0.95880044, 'specificity': 0.95880044, 'f1': 0.9583185, 'auroc': 0.99397886, 'binary_precision': 0.9910714, 'binary_recall': 0.9261874, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9575315}
confusion matrix:
      0     1
0  1501    13
1   115  1443
---- Validation: 
scalar performance:
{'acc': 0.7950117, 'precision': 0.7950165, 'recall': 0.79479706, 'specificity': 0.79479706, 'f1': 0.79486763, 'auroc': 0.877722, 'binary_precision': 0.7951613, 'binary_recall': 0.7837838, 'binary_specificity': 0.8058104, 'binary_f1_score': 0.7894316}
confusion matrix:
     0    1
0  527  127
1  136  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.79849124, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7976568, 'auroc': 0.90068144, 'binary_precision': 0.8130841, 'binary_recall': 0.7733333, 'binary_specificity': 0.82222223, 'binary_f1_score': 0.79271066}
confusion matrix:
     0    1
0  185   40
1   51  174
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:56:28.795213,epoch time: 0:02:45.938574,used: 0:02:45.938574,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9812622, 'recall': 0.9812777, 'specificity': 0.9812777, 'f1': 0.98111975, 'auroc': 0.9983314, 'binary_precision': 0.9934124, 'binary_recall': 0.9691517, 'binary_specificity': 0.9934037, 'binary_f1_score': 0.9811321}
confusion matrix:
      0     1
0  1506    10
1    48  1508
---- Validation: 
scalar performance:
{'acc': 0.7786438, 'precision': 0.7785659, 'recall': 0.77852935, 'specificity': 0.77852935, 'f1': 0.77854574, 'auroc': 0.8418853, 'binary_precision': 0.7751196, 'binary_recall': 0.772655, 'binary_specificity': 0.7844037, 'binary_f1_score': 0.77388537}
confusion matrix:
     0    1
0  513  141
1  143  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.92244935, 'binary_precision': 0.8200837, 'binary_recall': 0.8711111, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.8448276}
confusion matrix:
     0    1
0  182   43
1   29  196
new oracle model saved
early stop counter: 1
val acc:0.778643786907196, best validation acc: 0.7950116991996765, corresponding to test acc:                         0.7977777719497681 / 0.8399999737739563
after epoch: 2,now: 2024-07-26 01:59:14.354057,epoch time: 0:02:45.558844,used: 0:05:31.497418,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9794667, 'recall': 0.9795486, 'specificity': 0.9795486, 'f1': 0.9794901, 'auroc': 0.9981868, 'binary_precision': 0.98381877, 'binary_recall': 0.9756098, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.97969705}
confusion matrix:
      0     1
0  1489    25
1    38  1520
---- Validation: 
scalar performance:
{'acc': 0.7981294, 'precision': 0.8029021, 'recall': 0.79685247, 'specificity': 0.79685247, 'f1': 0.7967942, 'auroc': 0.85397434, 'binary_precision': 0.8363636, 'binary_recall': 0.73131955, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.78032225}
confusion matrix:
     0    1
0  564   90
1  169  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.83625793, 'recall': 0.8266667, 'specificity': 0.8266667, 'f1': 0.8254218, 'auroc': 0.9118617, 'binary_precision': 0.8930481, 'binary_recall': 0.74222225, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.8106796}
confusion matrix:
     0    1
0  205   20
1   58  167
better model found
persisted
after epoch: 3,now: 2024-07-26 02:01:59.844341,epoch time: 0:02:45.490284,used: 0:08:16.987702,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9792933, 'recall': 0.9793396, 'specificity': 0.9793396, 'f1': 0.9791666, 'auroc': 0.99827117, 'binary_precision': 0.9914474, 'binary_recall': 0.9672657, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.97920734}
confusion matrix:
      0     1
0  1501    13
1    51  1507
---- Validation: 
scalar performance:
{'acc': 0.7996882, 'precision': 0.8284215, 'recall': 0.79677105, 'specificity': 0.79677105, 'f1': 0.7940655, 'auroc': 0.8829607, 'binary_precision': 0.92081445, 'binary_recall': 0.64705884, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.76003736}
confusion matrix:
     0    1
0  619   35
1  222  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85555553, 'precision': 0.8717779, 'recall': 0.85555553, 'specificity': 0.85555553, 'f1': 0.8539624, 'auroc': 0.93475556, 'binary_precision': 0.9494382, 'binary_recall': 0.7511111, 'binary_specificity': 0.96, 'binary_f1_score': 0.83870965}
confusion matrix:
     0    1
0  216    9
1   56  169
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 02:04:46.101215,epoch time: 0:02:46.256874,used: 0:11:03.244576,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.9744259, 'recall': 0.9742328, 'specificity': 0.9742328, 'f1': 0.97395766, 'auroc': 0.99712944, 'binary_precision': 0.99332446, 'binary_recall': 0.9550706, 'binary_specificity': 0.993395, 'binary_f1_score': 0.97382206}
confusion matrix:
      0     1
0  1504    10
1    70  1488
---- Validation: 
scalar performance:
{'acc': 0.57911146, 'precision': 0.7360983, 'recall': 0.5709903, 'specificity': 0.5709903, 'f1': 0.48477268, 'auroc': 0.8816553, 'binary_precision': 0.9238095, 'binary_recall': 0.15421304, 'binary_specificity': 0.9877676, 'binary_f1_score': 0.26430517}
confusion matrix:
     0   1
0  646   8
1  532  97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54888886, 'precision': 0.74207747, 'recall': 0.5488889, 'specificity': 0.5488889, 'f1': 0.4364555, 'auroc': 0.90721977, 'binary_precision': 0.9583333, 'binary_recall': 0.10222222, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.18473895}
confusion matrix:
     0   1
0  224   1
1  202  23
early stop counter: 1
val acc:0.5791114568710327, best validation acc: 0.7996882200241089, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 5,now: 2024-07-26 02:07:31.020787,epoch time: 0:02:44.919572,used: 0:13:48.164148,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9798536, 'recall': 0.9797134, 'specificity': 0.9797134, 'f1': 0.97949183, 'auroc': 0.99861586, 'binary_precision': 0.99667335, 'binary_recall': 0.9627249, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.97940505}
confusion matrix:
      0     1
0  1511     5
1    58  1498
---- Validation: 
scalar performance:
{'acc': 0.75759935, 'precision': 0.801555, 'recall': 0.7538153, 'specificity': 0.7538153, 'f1': 0.7465402, 'auroc': 0.8701011, 'binary_precision': 0.9119171, 'binary_recall': 0.5596184, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.69359607}
confusion matrix:
     0    1
0  620   34
1  277  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8343003, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82567143, 'auroc': 0.91269135, 'binary_precision': 0.88481677, 'binary_recall': 0.7511111, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.81249994}
confusion matrix:
     0    1
0  203   22
1   56  169
early stop counter: 2
val acc:0.7575993537902832, best validation acc: 0.7996882200241089, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 6,now: 2024-07-26 02:10:15.655186,epoch time: 0:02:44.634399,used: 0:16:32.798547,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9828303, 'recall': 0.9828911, 'specificity': 0.9828911, 'f1': 0.98274726, 'auroc': 0.99861884, 'binary_precision': 0.9934383, 'binary_recall': 0.9723828, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9827978}
confusion matrix:
      0     1
0  1505    10
1    43  1514
---- Validation: 
scalar performance:
{'acc': 0.731099, 'precision': 0.7985124, 'recall': 0.7263933, 'specificity': 0.7263933, 'f1': 0.7122954, 'auroc': 0.9136001, 'binary_precision': 0.9355828, 'binary_recall': 0.48489666, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.63874346}
confusion matrix:
     0    1
0  633   21
1  324  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7088889, 'precision': 0.8111758, 'recall': 0.7088889, 'specificity': 0.7088889, 'f1': 0.6828241, 'auroc': 0.93254316, 'binary_precision': 0.9895833, 'binary_recall': 0.42222223, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.5919003}
confusion matrix:
     0   1
0  224   1
1  130  95
early stop counter: 3
val acc:0.731099009513855, best validation acc: 0.7996882200241089, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 7,now: 2024-07-26 02:13:00.309853,epoch time: 0:02:44.654667,used: 0:19:17.453214,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.9514107, 'recall': 0.94802415, 'specificity': 0.94802415, 'f1': 0.9471954, 'auroc': 0.9948571, 'binary_precision': 0.99857247, 'binary_recall': 0.8973701, 'binary_specificity': 0.99867815, 'binary_f1_score': 0.9452703}
confusion matrix:
      0     1
0  1511     2
1   160  1399
---- Validation: 
scalar performance:
{'acc': 0.52299297, 'precision': 0.69311595, 'recall': 0.51360464, 'specificity': 0.51360464, 'f1': 0.37080023, 'auroc': 0.7954905, 'binary_precision': 0.8695652, 'binary_recall': 0.031796504, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.061349694}
confusion matrix:
     0   1
0  651   3
1  609  20
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50666666, 'precision': 0.7516779, 'recall': 0.50666666, 'specificity': 0.50666666, 'f1': 0.3479793, 'auroc': 0.9300939, 'binary_precision': 1.0, 'binary_recall': 0.013333334, 'binary_specificity': 1.0, 'binary_f1_score': 0.02631579}
confusion matrix:
     0  1
0  225  0
1  222  3
early stop counter: 4
val acc:0.5229929685592651, best validation acc: 0.7996882200241089, corresponding to test acc:                         0.855555534362793 / 0.855555534362793
after epoch: 8,now: 2024-07-26 02:15:44.735619,epoch time: 0:02:44.425766,used: 0:22:01.878980,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9827714, 'recall': 0.9827191, 'specificity': 0.9827191, 'f1': 0.98274267, 'auroc': 0.9989176, 'binary_precision': 0.9814578, 'binary_recall': 0.9846055, 'binary_specificity': 0.98083276, 'binary_f1_score': 0.9830292}
confusion matrix:
      0     1
0  1484    29
1    24  1535
---- Validation: 
scalar performance:
{'acc': 0.8339828, 'precision': 0.8478768, 'recall': 0.83202064, 'specificity': 0.83202064, 'f1': 0.83168215, 'auroc': 0.9014454, 'binary_precision': 0.9126984, 'binary_recall': 0.73131955, 'binary_specificity': 0.93272173, 'binary_f1_score': 0.8120035}
confusion matrix:
     0    1
0  610   44
1  169  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.8253057, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8090279, 'auroc': 0.9066074, 'binary_precision': 0.89325845, 'binary_recall': 0.70666665, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.78908193}
confusion matrix:
     0    1
0  206   19
1   66  159
better model found
persisted
after epoch: 9,now: 2024-07-26 02:18:30.040184,epoch time: 0:02:45.304565,used: 0:24:47.183545,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.97876585, 'recall': 0.9784888, 'specificity': 0.9784888, 'f1': 0.9781891, 'auroc': 0.99907315, 'binary_precision': 0.9993302, 'binary_recall': 0.957638, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.97804}
confusion matrix:
      0     1
0  1513     1
1    66  1492
---- Validation: 
scalar performance:
{'acc': 0.69914263, 'precision': 0.78737736, 'recall': 0.69364995, 'specificity': 0.69364995, 'f1': 0.6703793, 'auroc': 0.8523699, 'binary_precision': 0.9418182, 'binary_recall': 0.4117647, 'binary_specificity': 0.97553515, 'binary_f1_score': 0.57300884}
confusion matrix:
     0    1
0  638   16
1  370  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.86439425, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8271645, 'auroc': 0.93779755, 'binary_precision': 0.9745223, 'binary_recall': 0.68, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.8010471}
confusion matrix:
     0    1
0  221    4
1   72  153
early stop counter: 1
val acc:0.6991426348686218, best validation acc: 0.8339828252792358, corresponding to test acc:                         0.8111110925674438 / 0.855555534362793
after epoch: 10,now: 2024-07-26 02:21:14.595920,epoch time: 0:02:44.555736,used: 0:27:31.739281,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9855237, 'recall': 0.98526007, 'specificity': 0.98526007, 'f1': 0.9853458, 'auroc': 0.9991802, 'binary_precision': 0.9790742, 'binary_recall': 0.99228793, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.9856368}
confusion matrix:
      0     1
0  1483    33
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.7802026, 'precision': 0.78887606, 'recall': 0.77844787, 'specificity': 0.77844787, 'f1': 0.7777418, 'auroc': 0.8516333, 'binary_precision': 0.8342967, 'binary_recall': 0.68839425, 'binary_specificity': 0.86850154, 'binary_f1_score': 0.7543553}
confusion matrix:
     0    1
0  568   86
1  196  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.821435, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.817258, 'auroc': 0.91411364, 'binary_precision': 0.7871486, 'binary_recall': 0.8711111, 'binary_specificity': 0.7644445, 'binary_f1_score': 0.82700425}
confusion matrix:
     0    1
0  172   53
1   29  196
early stop counter: 2
val acc:0.7802026271820068, best validation acc: 0.8339828252792358, corresponding to test acc:                         0.8111110925674438 / 0.855555534362793
after epoch: 11,now: 2024-07-26 02:23:59.925261,epoch time: 0:02:45.329341,used: 0:30:17.068622,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97298175, 'precision': 0.9742607, 'recall': 0.97267616, 'specificity': 0.97267616, 'f1': 0.9729464, 'auroc': 0.99931705, 'binary_precision': 0.9526736, 'binary_recall': 0.99614394, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.973924}
confusion matrix:
      0     1
0  1439    77
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.8285269, 'precision': 0.82845545, 'recall': 0.82852256, 'specificity': 0.82852256, 'f1': 0.82848096, 'auroc': 0.8880389, 'binary_precision': 0.82306474, 'binary_recall': 0.82829887, 'binary_specificity': 0.8287462, 'binary_f1_score': 0.8256735}
confusion matrix:
     0    1
0  542  112
1  108  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8601779, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599827, 'auroc': 0.93803453, 'binary_precision': 0.8521739, 'binary_recall': 0.8711111, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8615385}
confusion matrix:
     0    1
0  191   34
1   29  196
new oracle model saved
early stop counter: 3
val acc:0.8285269141197205, best validation acc: 0.8339828252792358, corresponding to test acc:                         0.8111110925674438 / 0.8600000143051147
after epoch: 12,now: 2024-07-26 02:26:46.050804,epoch time: 0:02:46.125543,used: 0:33:03.194165,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9872974, 'recall': 0.9873067, 'specificity': 0.9873067, 'f1': 0.98730195, 'auroc': 0.99906486, 'binary_precision': 0.9878049, 'binary_recall': 0.9871713, 'binary_specificity': 0.9874422, 'binary_f1_score': 0.98748803}
confusion matrix:
      0     1
0  1494    19
1    20  1539
---- Validation: 
scalar performance:
{'acc': 0.7802026, 'precision': 0.8077978, 'recall': 0.7772324, 'specificity': 0.7772324, 'f1': 0.77385205, 'auroc': 0.8681879, 'binary_precision': 0.8952164, 'binary_recall': 0.6248013, 'binary_specificity': 0.9296636, 'binary_f1_score': 0.7359551}
confusion matrix:
     0    1
0  608   46
1  236  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8367435, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82282674, 'auroc': 0.89967406, 'binary_precision': 0.9010989, 'binary_recall': 0.72888887, 'binary_specificity': 0.92, 'binary_f1_score': 0.8058969}
confusion matrix:
     0    1
0  207   18
1   61  164
early stop counter: 4
val acc:0.7802026271820068, best validation acc: 0.8339828252792358, corresponding to test acc:                         0.8111110925674438 / 0.8600000143051147
after epoch: 13,now: 2024-07-26 02:29:30.862456,epoch time: 0:02:44.811652,used: 0:35:48.005817,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896305, 'recall': 0.98970026, 'specificity': 0.98970026, 'f1': 0.98958313, 'auroc': 0.9998363, 'binary_precision': 0.9986911, 'binary_recall': 0.9807198, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98962384}
confusion matrix:
      0     1
0  1514     2
1    30  1526
---- Validation: 
scalar performance:
{'acc': 0.76227593, 'precision': 0.81746763, 'recall': 0.7581594, 'specificity': 0.7581594, 'f1': 0.74947643, 'auroc': 0.9025217, 'binary_precision': 0.94505495, 'binary_recall': 0.54689986, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.69284993}
confusion matrix:
     0    1
0  634   20
1  285  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8504673, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7764947, 'auroc': 0.94674563, 'binary_precision': 1.0, 'binary_recall': 0.5733333, 'binary_specificity': 1.0, 'binary_f1_score': 0.7288136}
confusion matrix:
     0    1
0  225    0
1   96  129
early stop counter: 5
val acc:0.7622759342193604, best validation acc: 0.8339828252792358, corresponding to test acc:                         0.8111110925674438 / 0.8600000143051147
after epoch: 14,now: 2024-07-26 02:32:15.496347,epoch time: 0:02:44.633891,used: 0:38:32.639708,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_53_42_seed_3_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:38:32.639708 at 2024-07-26 02:32:15.496347
persisted model performance metric: 

scalar performance:
{'acc': 0.8111111, 'precision': 0.8253057, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8090279, 'auroc': 0.9066074, 'binary_precision': 0.89325845, 'binary_recall': 0.70666665, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.78908193}
confusion matrix:
     0    1
0  206   19
1   66  159
oracle model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.8601779, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599827, 'auroc': 0.93803453, 'binary_precision': 0.8521739, 'binary_recall': 0.8711111, 'binary_specificity': 0.8488889, 'binary_f1_score': 0.8615385}
confusion matrix:
     0    1
0  191   34
1   29  196
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8915 MiB | 320165 GiB | 320162 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 317362 GiB | 317359 GiB |
|       from small pool |     91 MiB |    132 MiB |   2803 GiB |   2803 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8915 MiB | 320165 GiB | 320162 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 317362 GiB | 317359 GiB |
|       from small pool |     91 MiB |    132 MiB |   2803 GiB |   2803 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 319770 GiB | 319768 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 316971 GiB | 316969 GiB |
|       from small pool |     91 MiB |    132 MiB |   2799 GiB |   2798 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9750 MiB |   9824 MiB |  28696 MiB |  18946 MiB |
|       from large pool |   9610 MiB |   9688 MiB |  28450 MiB |  18840 MiB |
|       from small pool |    140 MiB |    140 MiB |    246 MiB |    106 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1316 MiB |   1825 MiB | 225012 GiB | 225011 GiB |
|       from large pool |   1305 MiB |   1820 MiB | 222128 GiB | 222127 GiB |
|       from small pool |     10 MiB |     60 MiB |   2883 GiB |   2883 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   45533 K  |   45530 K  |
|       from large pool |     392    |     816    |   22865 K  |   22865 K  |
|       from small pool |    2084    |    2780    |   22667 K  |   22665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   45533 K  |   45530 K  |
|       from large pool |     392    |     816    |   22865 K  |   22865 K  |
|       from small pool |    2084    |    2780    |   22667 K  |   22665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     287    |     333    |     796    |     509    |
|       from large pool |     217    |     265    |     673    |     456    |
|       from small pool |      70    |      70    |     123    |      53    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     157    |     320    |   25312 K  |   25312 K  |
|       from large pool |      81    |     255    |   13644 K  |   13644 K  |
|       from small pool |      76    |     226    |   11667 K  |   11667 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 320165 GiB | 320165 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 317362 GiB | 317362 GiB |
|       from small pool |      0 KiB |    132 MiB |   2803 GiB |   2803 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 320165 GiB | 320165 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 317362 GiB | 317362 GiB |
|       from small pool |      0 KiB |    132 MiB |   2803 GiB |   2803 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 319770 GiB | 319770 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 316971 GiB | 316971 GiB |
|       from small pool |      0 KiB |    132 MiB |   2799 GiB |   2799 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3710 MiB |   9824 MiB |  28696 MiB |  24986 MiB |
|       from large pool |   3608 MiB |   9688 MiB |  28450 MiB |  24842 MiB |
|       from small pool |    102 MiB |    140 MiB |    246 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 225013 GiB | 225013 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 222129 GiB | 222129 GiB |
|       from small pool |      0 KiB |     60 MiB |   2883 GiB |   2883 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   45533 K  |   45533 K  |
|       from large pool |       2    |     816    |   22865 K  |   22865 K  |
|       from small pool |       0    |    2780    |   22667 K  |   22667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   45533 K  |   45533 K  |
|       from large pool |       2    |     816    |   22865 K  |   22865 K  |
|       from small pool |       0    |    2780    |   22667 K  |   22667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     796    |     662    |
|       from large pool |      83    |     265    |     673    |     590    |
|       from small pool |      51    |      70    |     123    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   25312 K  |   25312 K  |
|       from large pool |       3    |     255    |   13645 K  |   13645 K  |
|       from small pool |       0    |     226    |   11667 K  |   11667 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 320165 GiB | 320165 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 317362 GiB | 317362 GiB |
|       from small pool |      0 KiB |    132 MiB |   2803 GiB |   2803 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 320165 GiB | 320165 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 317362 GiB | 317362 GiB |
|       from small pool |      0 KiB |    132 MiB |   2803 GiB |   2803 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 319770 GiB | 319770 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 316971 GiB | 316971 GiB |
|       from small pool |      0 KiB |    132 MiB |   2799 GiB |   2799 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3710 MiB |   9824 MiB |  28696 MiB |  24986 MiB |
|       from large pool |   3608 MiB |   9688 MiB |  28450 MiB |  24842 MiB |
|       from small pool |    102 MiB |    140 MiB |    246 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 225013 GiB | 225013 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 222129 GiB | 222129 GiB |
|       from small pool |      0 KiB |     60 MiB |   2883 GiB |   2883 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   45533 K  |   45533 K  |
|       from large pool |       2    |     816    |   22865 K  |   22865 K  |
|       from small pool |       0    |    2780    |   22667 K  |   22667 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   45533 K  |   45533 K  |
|       from large pool |       2    |     816    |   22865 K  |   22865 K  |
|       from small pool |       0    |    2780    |   22667 K  |   22667 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     796    |     662    |
|       from large pool |      83    |     265    |     673    |     590    |
|       from small pool |      51    |      70    |     123    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   25312 K  |   25312 K  |
|       from large pool |       3    |     255    |   13645 K  |   13645 K  |
|       from small pool |       0    |     226    |   11667 K  |   11667 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723

 Experiment start at: 2024-07-26 02:32:49.495436
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96243525, 'precision': 0.96240604, 'recall': 0.96244633, 'specificity': 0.96244633, 'f1': 0.9624246, 'auroc': 0.99137783, 'binary_precision': 0.96428573, 'binary_recall': 0.96183205, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.96305734}
confusion matrix:
      0     1
0  1460    56
1    60  1512
---- Validation: 
scalar performance:
{'acc': 0.668228, 'precision': 0.7401637, 'recall': 0.6645326, 'specificity': 0.6645326, 'f1': 0.6383848, 'auroc': 0.8527603, 'binary_precision': 0.8683274, 'binary_recall': 0.38607594, 'binary_specificity': 0.94298923, 'binary_f1_score': 0.5345016}
confusion matrix:
     0    1
0  612   37
1  388  244
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7180095, 'precision': 0.7678256, 'recall': 0.7180095, 'specificity': 0.7180095, 'f1': 0.7042573, 'auroc': 0.8806406, 'binary_precision': 0.8833333, 'binary_recall': 0.50236964, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.6404834}
confusion matrix:
     0    1
0  197   14
1  105  106
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:35:36.649347,epoch time: 0:02:47.153911,used: 0:02:47.153911,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9705311, 'precision': 0.97090787, 'recall': 0.97032756, 'specificity': 0.97032756, 'f1': 0.9705066, 'auroc': 0.99646896, 'binary_precision': 0.9613707, 'binary_recall': 0.9815522, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.9713567}
confusion matrix:
      0     1
0  1454    62
1    29  1543
---- Validation: 
scalar performance:
{'acc': 0.8610461, 'precision': 0.8662681, 'recall': 0.8602548, 'specificity': 0.8602548, 'f1': 0.8603413, 'auroc': 0.91903806, 'binary_precision': 0.90681005, 'binary_recall': 0.8006329, 'binary_specificity': 0.91987675, 'binary_f1_score': 0.8504201}
confusion matrix:
     0    1
0  597   52
1  126  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8364929, 'precision': 0.8650341, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8332331, 'auroc': 0.94285846, 'binary_precision': 0.96710527, 'binary_recall': 0.69668245, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.80991733}
confusion matrix:
     0    1
0  206    5
1   64  147
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:38:23.716902,epoch time: 0:02:47.067555,used: 0:05:34.221466,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9070596, 'precision': 0.92155254, 'recall': 0.90535355, 'specificity': 0.90535355, 'f1': 0.9059661, 'auroc': 0.9960476, 'binary_precision': 0.8479437, 'binary_recall': 0.99618566, 'binary_specificity': 0.81452143, 'binary_f1_score': 0.91610646}
confusion matrix:
      0     1
0  1234   281
1     6  1567
---- Validation: 
scalar performance:
{'acc': 0.7806401, 'precision': 0.8141382, 'recall': 0.7827878, 'specificity': 0.7827878, 'f1': 0.7754909, 'auroc': 0.91555655, 'binary_precision': 0.7081851, 'binary_recall': 0.94462025, 'binary_specificity': 0.6209553, 'binary_f1_score': 0.8094915}
confusion matrix:
     0    1
0  403  246
1   35  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8341232, 'precision': 0.83850265, 'recall': 0.83412325, 'specificity': 0.83412325, 'f1': 0.83358496, 'auroc': 0.918982, 'binary_precision': 0.8, 'binary_recall': 0.89099526, 'binary_specificity': 0.7772512, 'binary_f1_score': 0.84304935}
confusion matrix:
     0    1
0  164   47
1   23  188
early stop counter: 1
val acc:0.7806401252746582, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8364928960800171 / 0.8364928960800171
after epoch: 3,now: 2024-07-26 02:41:09.094311,epoch time: 0:02:45.377409,used: 0:08:19.598875,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97700775, 'precision': 0.9771346, 'recall': 0.9772249, 'specificity': 0.9772249, 'f1': 0.97700745, 'auroc': 0.99774635, 'binary_precision': 0.9901897, 'binary_recall': 0.9643312, 'binary_specificity': 0.99011856, 'binary_f1_score': 0.97708935}
confusion matrix:
      0     1
0  1503    15
1    56  1514
---- Validation: 
scalar performance:
{'acc': 0.78688526, 'precision': 0.7980878, 'recall': 0.78557324, 'specificity': 0.78557324, 'f1': 0.78430897, 'auroc': 0.86409473, 'binary_precision': 0.85265225, 'binary_recall': 0.68670887, 'binary_specificity': 0.8844376, 'binary_f1_score': 0.76073617}
confusion matrix:
     0    1
0  574   75
1  198  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.85320497, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.82102656, 'auroc': 0.94553137, 'binary_precision': 0.95364237, 'binary_recall': 0.6824645, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.79558015}
confusion matrix:
     0    1
0  204    7
1   67  144
early stop counter: 2
val acc:0.7868852615356445, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8364928960800171 / 0.8364928960800171
after epoch: 4,now: 2024-07-26 02:43:54.113010,epoch time: 0:02:45.018699,used: 0:11:04.617574,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.98354894, 'recall': 0.9834193, 'specificity': 0.9834193, 'f1': 0.9834757, 'auroc': 0.998995, 'binary_precision': 0.9810606, 'binary_recall': 0.9866667, 'binary_specificity': 0.98017186, 'binary_f1_score': 0.98385566}
confusion matrix:
      0     1
0  1483    30
1    21  1554
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.82552737, 'recall': 0.82394165, 'specificity': 0.82394165, 'f1': 0.8240433, 'auroc': 0.88414264, 'binary_precision': 0.8420168, 'binary_recall': 0.7927215, 'binary_specificity': 0.8551618, 'binary_f1_score': 0.8166259}
confusion matrix:
     0    1
0  555   94
1  131  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87677723, 'precision': 0.8769127, 'recall': 0.8767773, 'specificity': 0.8767773, 'f1': 0.8767662, 'auroc': 0.9320545, 'binary_precision': 0.884058, 'binary_recall': 0.8672986, 'binary_specificity': 0.8862559, 'binary_f1_score': 0.87559813}
confusion matrix:
     0    1
0  187   24
1   28  183
new oracle model saved
early stop counter: 3
val acc:0.824355959892273, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8364928960800171 / 0.8767772316932678
after epoch: 5,now: 2024-07-26 02:46:40.194062,epoch time: 0:02:46.081052,used: 0:13:50.698626,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9362047, 'precision': 0.94243133, 'recall': 0.9374206, 'specificity': 0.9374206, 'f1': 0.9360788, 'auroc': 0.9976915, 'binary_precision': 1.0, 'binary_recall': 0.87484115, 'binary_specificity': 1.0, 'binary_f1_score': 0.9332429}
confusion matrix:
      0     1
0  1514     0
1   197  1377
---- Validation: 
scalar performance:
{'acc': 0.57377046, 'precision': 0.74115443, 'recall': 0.5681623, 'specificity': 0.5681623, 'f1': 0.47700995, 'auroc': 0.8887017, 'binary_precision': 0.93877554, 'binary_recall': 0.14556962, 'binary_specificity': 0.990755, 'binary_f1_score': 0.25205484}
confusion matrix:
     0   1
0  643   6
1  540  92
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.528436, 'precision': 0.75731707, 'recall': 0.528436, 'specificity': 0.528436, 'f1': 0.39358622, 'auroc': 0.9402754, 'binary_precision': 1.0, 'binary_recall': 0.056872036, 'binary_specificity': 1.0, 'binary_f1_score': 0.10762332}
confusion matrix:
     0   1
0  211   0
1  199  12
early stop counter: 4
val acc:0.5737704634666443, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8364928960800171 / 0.8767772316932678
after epoch: 6,now: 2024-07-26 02:49:25.689960,epoch time: 0:02:45.495898,used: 0:16:36.194524,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9867228, 'precision': 0.98667943, 'recall': 0.98678505, 'specificity': 0.98678505, 'f1': 0.9867197, 'auroc': 0.99779487, 'binary_precision': 0.9903969, 'binary_recall': 0.9834711, 'binary_specificity': 0.990099, 'binary_f1_score': 0.98692185}
confusion matrix:
      0     1
0  1500    15
1    26  1547
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8202168, 'recall': 0.8158231, 'specificity': 0.8158231, 'f1': 0.8157573, 'auroc': 0.87884474, 'binary_precision': 0.8513274, 'binary_recall': 0.761076, 'binary_specificity': 0.8705701, 'binary_f1_score': 0.80367583}
confusion matrix:
     0    1
0  565   84
1  151  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.8507818, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.85070336, 'auroc': 0.9212955, 'binary_precision': 0.8457944, 'binary_recall': 0.8578199, 'binary_specificity': 0.8436019, 'binary_f1_score': 0.85176474}
confusion matrix:
     0    1
0  178   33
1   30  181
early stop counter: 5
val acc:0.8165495991706848, best validation acc: 0.8610460758209229, corresponding to test acc:                         0.8364928960800171 / 0.8767772316932678
after epoch: 7,now: 2024-07-26 02:52:10.874066,epoch time: 0:02:45.184106,used: 0:19:21.378630,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_32_49_seed_4_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:21.378630 at 2024-07-26 02:52:10.874066
persisted model performance metric: 

scalar performance:
{'acc': 0.8364929, 'precision': 0.8650341, 'recall': 0.8364929, 'specificity': 0.8364929, 'f1': 0.8332331, 'auroc': 0.94285846, 'binary_precision': 0.96710527, 'binary_recall': 0.69668245, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.80991733}
confusion matrix:
     0    1
0  206    5
1   64  147
oracle model performance metric: 

scalar performance:
{'acc': 0.87677723, 'precision': 0.8769127, 'recall': 0.8767773, 'specificity': 0.8767773, 'f1': 0.8767662, 'auroc': 0.9320545, 'binary_precision': 0.884058, 'binary_recall': 0.8672986, 'binary_specificity': 0.8862559, 'binary_f1_score': 0.87559813}
confusion matrix:
     0    1
0  187   24
1   28  183
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2395 MiB |   8915 MiB | 367146 GiB | 367144 GiB |
|       from large pool |   2303 MiB |   8839 MiB | 363932 GiB | 363929 GiB |
|       from small pool |     91 MiB |    132 MiB |   3214 GiB |   3214 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2395 MiB |   8915 MiB | 367146 GiB | 367144 GiB |
|       from large pool |   2303 MiB |   8839 MiB | 363932 GiB | 363929 GiB |
|       from small pool |     91 MiB |    132 MiB |   3214 GiB |   3214 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 366700 GiB | 366697 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 363490 GiB | 363487 GiB |
|       from small pool |     91 MiB |    132 MiB |   3210 GiB |   3209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9734 MiB |   9824 MiB |  34720 MiB |  24986 MiB |
|       from large pool |   9598 MiB |   9688 MiB |  34440 MiB |  24842 MiB |
|       from small pool |    136 MiB |    140 MiB |    280 MiB |    144 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1122 MiB |   1825 MiB | 261163 GiB | 261162 GiB |
|       from large pool |   1112 MiB |   1820 MiB | 257856 GiB | 257855 GiB |
|       from small pool |     10 MiB |     60 MiB |   3306 GiB |   3306 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   52221 K  |   52219 K  |
|       from large pool |     392    |     816    |   26222 K  |   26222 K  |
|       from small pool |    2072    |    2780    |   25998 K  |   25996 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   52221 K  |   52219 K  |
|       from large pool |     392    |     816    |   26222 K  |   26222 K  |
|       from small pool |    2072    |    2780    |   25998 K  |   25996 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     276    |     333    |     938    |     662    |
|       from large pool |     208    |     265    |     798    |     590    |
|       from small pool |      68    |      70    |     140    |      72    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     138    |     320    |   28865 K  |   28865 K  |
|       from large pool |      71    |     255    |   15491 K  |   15491 K  |
|       from small pool |      67    |     226    |   13373 K  |   13373 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 367146 GiB | 367146 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 363932 GiB | 363932 GiB |
|       from small pool |      0 KiB |    132 MiB |   3214 GiB |   3214 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 367146 GiB | 367146 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 363932 GiB | 363932 GiB |
|       from small pool |      0 KiB |    132 MiB |   3214 GiB |   3214 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 366700 GiB | 366700 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 363490 GiB | 363490 GiB |
|       from small pool |      0 KiB |    132 MiB |   3210 GiB |   3210 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   9824 MiB |  34720 MiB |  31202 MiB |
|       from large pool |   3416 MiB |   9688 MiB |  34440 MiB |  31024 MiB |
|       from small pool |    102 MiB |    140 MiB |    280 MiB |    178 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 261164 GiB | 261164 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 257857 GiB | 257857 GiB |
|       from small pool |      0 KiB |     60 MiB |   3306 GiB |   3306 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   52221 K  |   52221 K  |
|       from large pool |       2    |     816    |   26222 K  |   26222 K  |
|       from small pool |       0    |    2780    |   25998 K  |   25998 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   52221 K  |   52221 K  |
|       from large pool |       2    |     816    |   26222 K  |   26222 K  |
|       from small pool |       0    |    2780    |   25998 K  |   25998 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |     938    |     808    |
|       from large pool |      79    |     265    |     798    |     719    |
|       from small pool |      51    |      70    |     140    |      89    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   28866 K  |   28866 K  |
|       from large pool |       3    |     255    |   15492 K  |   15492 K  |
|       from small pool |       0    |     226    |   13374 K  |   13374 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 367146 GiB | 367146 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 363932 GiB | 363932 GiB |
|       from small pool |      0 KiB |    132 MiB |   3214 GiB |   3214 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 367146 GiB | 367146 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 363932 GiB | 363932 GiB |
|       from small pool |      0 KiB |    132 MiB |   3214 GiB |   3214 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 366700 GiB | 366700 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 363490 GiB | 363490 GiB |
|       from small pool |      0 KiB |    132 MiB |   3210 GiB |   3210 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3518 MiB |   9824 MiB |  34720 MiB |  31202 MiB |
|       from large pool |   3416 MiB |   9688 MiB |  34440 MiB |  31024 MiB |
|       from small pool |    102 MiB |    140 MiB |    280 MiB |    178 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 261164 GiB | 261164 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 257857 GiB | 257857 GiB |
|       from small pool |      0 KiB |     60 MiB |   3306 GiB |   3306 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   52221 K  |   52221 K  |
|       from large pool |       2    |     816    |   26222 K  |   26222 K  |
|       from small pool |       0    |    2780    |   25998 K  |   25998 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   52221 K  |   52221 K  |
|       from large pool |       2    |     816    |   26222 K  |   26222 K  |
|       from small pool |       0    |    2780    |   25998 K  |   25998 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |     938    |     808    |
|       from large pool |      79    |     265    |     798    |     719    |
|       from small pool |      51    |      70    |     140    |      89    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   28866 K  |   28866 K  |
|       from large pool |       3    |     255    |   15492 K  |   15492 K  |
|       from small pool |       0    |     226    |   13374 K  |   13374 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723

 Experiment start at: 2024-07-26 02:52:47.375787
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9548429, 'precision': 0.9576845, 'recall': 0.9555104, 'specificity': 0.9555104, 'f1': 0.9548088, 'auroc': 0.99358284, 'binary_precision': 0.9978873, 'binary_recall': 0.9130155, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.9535667}
confusion matrix:
      0     1
0  1501     3
1   135  1417
---- Validation: 
scalar performance:
{'acc': 0.55365473, 'precision': 0.74948674, 'recall': 0.5408871, 'specificity': 0.5408871, 'f1': 0.42624986, 'auroc': 0.8691268, 'binary_precision': 0.96363634, 'binary_recall': 0.0848, 'binary_specificity': 0.9969743, 'binary_f1_score': 0.15588236}
confusion matrix:
     0   1
0  659   2
1  572  53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5021645, 'precision': 0.7505423, 'recall': 0.5021645, 'specificity': 0.5021645, 'f1': 0.3381254, 'auroc': 0.88103676, 'binary_precision': 1.0, 'binary_recall': 0.0043290043, 'binary_specificity': 1.0, 'binary_f1_score': 0.00862069}
confusion matrix:
     0  1
0  231  0
1  230  1
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:55:33.006738,epoch time: 0:02:45.630951,used: 0:02:45.630951,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94077224, 'precision': 0.9443556, 'recall': 0.94007623, 'specificity': 0.94007623, 'f1': 0.940573, 'auroc': 0.99497724, 'binary_precision': 0.90833336, 'binary_recall': 0.9826143, 'binary_specificity': 0.89753824, 'binary_f1_score': 0.9440149}
confusion matrix:
      0     1
0  1349   154
1    27  1526
---- Validation: 
scalar performance:
{'acc': 0.7239502, 'precision': 0.726506, 'recall': 0.7221434, 'specificity': 0.7221434, 'f1': 0.72195274, 'auroc': 0.8010167, 'binary_precision': 0.7445652, 'binary_recall': 0.6576, 'binary_specificity': 0.78668684, 'binary_f1_score': 0.6983857}
confusion matrix:
     0    1
0  520  141
1  214  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203463, 'precision': 0.82301587, 'recall': 0.82034636, 'specificity': 0.82034636, 'f1': 0.81997436, 'auroc': 0.89559793, 'binary_precision': 0.7936508, 'binary_recall': 0.86580086, 'binary_specificity': 0.7748918, 'binary_f1_score': 0.82815737}
confusion matrix:
     0    1
0  179   52
1   31  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:58:18.400126,epoch time: 0:02:45.393388,used: 0:05:31.024339,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.92506546, 'precision': 0.9331083, 'recall': 0.9259822, 'specificity': 0.9259822, 'f1': 0.9248133, 'auroc': 0.98750335, 'binary_precision': 0.9954921, 'binary_recall': 0.85594314, 'binary_specificity': 0.9960212, 'binary_f1_score': 0.9204585}
confusion matrix:
      0     1
0  1502     6
1   223  1325
---- Validation: 
scalar performance:
{'acc': 0.61819595, 'precision': 0.7133274, 'recall': 0.6084635, 'specificity': 0.6084635, 'f1': 0.5596243, 'auroc': 0.7958149, 'binary_precision': 0.8489583, 'binary_recall': 0.2608, 'binary_specificity': 0.9561271, 'binary_f1_score': 0.3990208}
confusion matrix:
     0    1
0  632   29
1  462  163
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56277055, 'precision': 0.7365967, 'recall': 0.56277055, 'specificity': 0.56277055, 'f1': 0.46439397, 'auroc': 0.8580049, 'binary_precision': 0.93939394, 'binary_recall': 0.13419913, 'binary_specificity': 0.991342, 'binary_f1_score': 0.23484848}
confusion matrix:
     0   1
0  229   2
1  200  31
early stop counter: 1
val acc:0.6181959509849548, best validation acc: 0.723950207233429, corresponding to test acc:                         0.8203462958335876 / 0.8203462958335876
after epoch: 3,now: 2024-07-26 03:01:01.865423,epoch time: 0:02:43.465297,used: 0:08:14.489636,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.985942, 'recall': 0.98591137, 'specificity': 0.98591137, 'f1': 0.9859257, 'auroc': 0.99868226, 'binary_precision': 0.9851995, 'binary_recall': 0.9871051, 'binary_specificity': 0.9847176, 'binary_f1_score': 0.9861514}
confusion matrix:
      0     1
0  1482    23
1    20  1531
---- Validation: 
scalar performance:
{'acc': 0.85069984, 'precision': 0.8508005, 'recall': 0.85106206, 'specificity': 0.85106206, 'f1': 0.85068214, 'auroc': 0.9162699, 'binary_precision': 0.8346213, 'binary_recall': 0.864, 'binary_specificity': 0.83812404, 'binary_f1_score': 0.84905666}
confusion matrix:
     0    1
0  554  107
1   85  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8313924, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.8311403, 'auroc': 0.91428196, 'binary_precision': 0.84, 'binary_recall': 0.8181818, 'binary_specificity': 0.84415585, 'binary_f1_score': 0.82894737}
confusion matrix:
     0    1
0  195   36
1   42  189
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 03:03:47.045512,epoch time: 0:02:45.180089,used: 0:10:59.669725,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.9749329, 'recall': 0.9750247, 'specificity': 0.9750247, 'f1': 0.9748033, 'auroc': 0.99823105, 'binary_precision': 0.9881031, 'binary_recall': 0.96203345, 'binary_specificity': 0.98801595, 'binary_f1_score': 0.97489405}
confusion matrix:
      0     1
0  1484    18
1    59  1495
---- Validation: 
scalar performance:
{'acc': 0.82192844, 'precision': 0.8269366, 'recall': 0.8236406, 'specificity': 0.8236406, 'f1': 0.8216696, 'auroc': 0.9064714, 'binary_precision': 0.77887326, 'binary_recall': 0.8848, 'binary_specificity': 0.7624811, 'binary_f1_score': 0.8284644}
confusion matrix:
     0    1
0  504  157
1   72  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7878788, 'precision': 0.79425347, 'recall': 0.78787875, 'specificity': 0.78787875, 'f1': 0.78672373, 'auroc': 0.8672439, 'binary_precision': 0.7509434, 'binary_recall': 0.86147183, 'binary_specificity': 0.71428573, 'binary_f1_score': 0.80241936}
confusion matrix:
     0    1
0  165   66
1   32  199
early stop counter: 1
val acc:0.8219284415245056, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 5,now: 2024-07-26 03:06:30.953587,epoch time: 0:02:43.908075,used: 0:13:43.577800,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.97164595, 'recall': 0.9705845, 'specificity': 0.9705845, 'f1': 0.9708438, 'auroc': 0.9968455, 'binary_precision': 0.95638627, 'binary_recall': 0.9877735, 'binary_specificity': 0.9533955, 'binary_f1_score': 0.9718265}
confusion matrix:
      0     1
0  1432    70
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.83281493, 'precision': 0.8331519, 'recall': 0.8333156, 'specificity': 0.8333156, 'f1': 0.8328099, 'auroc': 0.89512134, 'binary_precision': 0.81345564, 'binary_recall': 0.8512, 'binary_specificity': 0.8154312, 'binary_f1_score': 0.8318999}
confusion matrix:
     0    1
0  539  122
1   93  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8246753, 'precision': 0.8247301, 'recall': 0.8246753, 'specificity': 0.8246753, 'f1': 0.82466793, 'auroc': 0.8886453, 'binary_precision': 0.82894737, 'binary_recall': 0.8181818, 'binary_specificity': 0.83116883, 'binary_f1_score': 0.82352936}
confusion matrix:
     0    1
0  192   39
1   42  189
early stop counter: 2
val acc:0.8328149318695068, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 6,now: 2024-07-26 03:09:14.516937,epoch time: 0:02:43.563350,used: 0:16:27.141150,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.950589, 'precision': 0.95546424, 'recall': 0.94975597, 'specificity': 0.94975597, 'f1': 0.95037854, 'auroc': 0.9991354, 'binary_precision': 0.9124045, 'binary_recall': 0.998713, 'binary_specificity': 0.9007989, 'binary_f1_score': 0.95360976}
confusion matrix:
      0     1
0  1353   149
1     2  1552
---- Validation: 
scalar performance:
{'acc': 0.70995337, 'precision': 0.77199733, 'recall': 0.7164575, 'specificity': 0.7164575, 'f1': 0.69626546, 'auroc': 0.9099425, 'binary_precision': 0.63490367, 'binary_recall': 0.9488, 'binary_specificity': 0.48411497, 'binary_f1_score': 0.76074404}
confusion matrix:
     0    1
0  320  341
1   32  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6861472, 'precision': 0.7705065, 'recall': 0.6861472, 'specificity': 0.6861472, 'f1': 0.65960884, 'auroc': 0.90298164, 'binary_precision': 0.61944443, 'binary_recall': 0.965368, 'binary_specificity': 0.4069264, 'binary_f1_score': 0.75465316}
confusion matrix:
    0    1
0  94  137
1   8  223
early stop counter: 3
val acc:0.7099533677101135, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 7,now: 2024-07-26 03:11:57.827618,epoch time: 0:02:43.310681,used: 0:19:10.451831,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9846204, 'precision': 0.9847938, 'recall': 0.9845057, 'specificity': 0.9845057, 'f1': 0.98461163, 'auroc': 0.9992622, 'binary_precision': 0.9790343, 'binary_recall': 0.9909968, 'binary_specificity': 0.97801465, 'binary_f1_score': 0.9849793}
confusion matrix:
      0     1
0  1468    33
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.83903575, 'precision': 0.8389778, 'recall': 0.8392363, 'specificity': 0.8392363, 'f1': 0.83899283, 'auroc': 0.9039298, 'binary_precision': 0.8265625, 'binary_recall': 0.8464, 'binary_specificity': 0.8320726, 'binary_f1_score': 0.8363637}
confusion matrix:
     0    1
0  550  111
1   96  529
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7748918, 'precision': 0.7789908, 'recall': 0.7748918, 'specificity': 0.7748918, 'f1': 0.7740619, 'auroc': 0.8692678, 'binary_precision': 0.74517375, 'binary_recall': 0.83549786, 'binary_specificity': 0.71428573, 'binary_f1_score': 0.78775513}
confusion matrix:
     0    1
0  165   66
1   38  193
early stop counter: 4
val acc:0.8390357494354248, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 8,now: 2024-07-26 03:14:41.220726,epoch time: 0:02:43.393108,used: 0:21:53.844939,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9904841, 'recall': 0.99056035, 'specificity': 0.99056035, 'f1': 0.9905094, 'auroc': 0.9996028, 'binary_precision': 0.99415207, 'binary_recall': 0.9870968, 'binary_specificity': 0.9940239, 'binary_f1_score': 0.99061185}
confusion matrix:
      0     1
0  1497     9
1    20  1530
---- Validation: 
scalar performance:
{'acc': 0.7970451, 'precision': 0.80766857, 'recall': 0.79433703, 'specificity': 0.79433703, 'f1': 0.7941311, 'auroc': 0.87327564, 'binary_precision': 0.8582677, 'binary_recall': 0.6976, 'binary_specificity': 0.8910741, 'binary_f1_score': 0.7696382}
confusion matrix:
     0    1
0  589   72
1  189  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7922078, 'precision': 0.809099, 'recall': 0.79220784, 'specificity': 0.79220784, 'f1': 0.7893297, 'auroc': 0.86518246, 'binary_precision': 0.88135594, 'binary_recall': 0.6753247, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.7647059}
confusion matrix:
     0    1
0  210   21
1   75  156
early stop counter: 5
val acc:0.797045111656189, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 9,now: 2024-07-26 03:17:24.360765,epoch time: 0:02:43.140039,used: 0:24:36.984978,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_52_47_seed_5_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:24:36.984978 at 2024-07-26 03:17:24.360765
persisted model performance metric: 

scalar performance:
{'acc': 0.83116883, 'precision': 0.8313924, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.8311403, 'auroc': 0.91428196, 'binary_precision': 0.84, 'binary_recall': 0.8181818, 'binary_specificity': 0.84415585, 'binary_f1_score': 0.82894737}
confusion matrix:
     0    1
0  195   36
1   42  189
oracle model performance metric: 

scalar performance:
{'acc': 0.83116883, 'precision': 0.8313924, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.8311403, 'auroc': 0.91428196, 'binary_precision': 0.84, 'binary_recall': 0.8181818, 'binary_specificity': 0.84415585, 'binary_f1_score': 0.82894737}
confusion matrix:
     0    1
0  195   36
1   42  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8915 MiB | 426985 GiB | 426983 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 423246 GiB | 423244 GiB |
|       from small pool |     91 MiB |    132 MiB |   3738 GiB |   3738 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8915 MiB | 426985 GiB | 426983 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 423246 GiB | 423244 GiB |
|       from small pool |     91 MiB |    132 MiB |   3738 GiB |   3738 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 426474 GiB | 426471 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 422740 GiB | 422738 GiB |
|       from small pool |     91 MiB |    132 MiB |   3733 GiB |   3733 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9738 MiB |   9824 MiB |  40940 MiB |  31202 MiB |
|       from large pool |   9602 MiB |   9688 MiB |  40626 MiB |  31024 MiB |
|       from small pool |    136 MiB |    140 MiB |    314 MiB |    178 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1062 MiB |   1825 MiB | 308007 GiB | 308006 GiB |
|       from large pool |   1051 MiB |   1820 MiB | 304161 GiB | 304160 GiB |
|       from small pool |     10 MiB |     60 MiB |   3845 GiB |   3845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   60743 K  |   60740 K  |
|       from large pool |     392    |     816    |   30499 K  |   30499 K  |
|       from small pool |    2084    |    2780    |   30243 K  |   30241 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   60743 K  |   60740 K  |
|       from large pool |     392    |     816    |   30499 K  |   30499 K  |
|       from small pool |    2084    |    2780    |   30243 K  |   30241 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     280    |     333    |    1088    |     808    |
|       from large pool |     212    |     265    |     931    |     719    |
|       from small pool |      68    |      70    |     157    |      89    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |     320    |   33407 K  |   33406 K  |
|       from large pool |      76    |     255    |   17827 K  |   17827 K  |
|       from small pool |      70    |     226    |   15579 K  |   15579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 426985 GiB | 426985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 423246 GiB | 423246 GiB |
|       from small pool |      0 KiB |    132 MiB |   3738 GiB |   3738 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 426985 GiB | 426985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 423246 GiB | 423246 GiB |
|       from small pool |      0 KiB |    132 MiB |   3738 GiB |   3738 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 426474 GiB | 426474 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 422740 GiB | 422740 GiB |
|       from small pool |      0 KiB |    132 MiB |   3733 GiB |   3733 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3456 MiB |   9824 MiB |  40940 MiB |  37484 MiB |
|       from large pool |   3354 MiB |   9688 MiB |  40626 MiB |  37272 MiB |
|       from small pool |    102 MiB |    140 MiB |    314 MiB |    212 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 308008 GiB | 308008 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 304162 GiB | 304162 GiB |
|       from small pool |      0 KiB |     60 MiB |   3845 GiB |   3845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   60743 K  |   60743 K  |
|       from large pool |       2    |     816    |   30499 K  |   30499 K  |
|       from small pool |       0    |    2780    |   30243 K  |   30243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   60743 K  |   60743 K  |
|       from large pool |       2    |     816    |   30499 K  |   30499 K  |
|       from small pool |       0    |    2780    |   30243 K  |   30243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1088    |     957    |
|       from large pool |      80    |     265    |     931    |     851    |
|       from small pool |      51    |      70    |     157    |     106    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   33407 K  |   33407 K  |
|       from large pool |       3    |     255    |   17827 K  |   17827 K  |
|       from small pool |       0    |     226    |   15579 K  |   15579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 426985 GiB | 426985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 423246 GiB | 423246 GiB |
|       from small pool |      0 KiB |    132 MiB |   3738 GiB |   3738 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 426985 GiB | 426985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 423246 GiB | 423246 GiB |
|       from small pool |      0 KiB |    132 MiB |   3738 GiB |   3738 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 426474 GiB | 426474 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 422740 GiB | 422740 GiB |
|       from small pool |      0 KiB |    132 MiB |   3733 GiB |   3733 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3456 MiB |   9824 MiB |  40940 MiB |  37484 MiB |
|       from large pool |   3354 MiB |   9688 MiB |  40626 MiB |  37272 MiB |
|       from small pool |    102 MiB |    140 MiB |    314 MiB |    212 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 308008 GiB | 308008 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 304162 GiB | 304162 GiB |
|       from small pool |      0 KiB |     60 MiB |   3845 GiB |   3845 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   60743 K  |   60743 K  |
|       from large pool |       2    |     816    |   30499 K  |   30499 K  |
|       from small pool |       0    |    2780    |   30243 K  |   30243 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   60743 K  |   60743 K  |
|       from large pool |       2    |     816    |   30499 K  |   30499 K  |
|       from small pool |       0    |    2780    |   30243 K  |   30243 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1088    |     957    |
|       from large pool |      80    |     265    |     931    |     851    |
|       from small pool |      51    |      70    |     157    |     106    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   33407 K  |   33407 K  |
|       from large pool |       3    |     255    |   17827 K  |   17827 K  |
|       from small pool |       0    |     226    |   15579 K  |   15579 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723

 Experiment start at: 2024-07-26 03:17:58.190268
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9514974, 'precision': 0.95480615, 'recall': 0.9519923, 'specificity': 0.9519923, 'f1': 0.9514407, 'auroc': 0.995106, 'binary_precision': 0.99646395, 'binary_recall': 0.9072762, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.94978094}
confusion matrix:
      0     1
0  1514     5
1   144  1409
---- Validation: 
scalar performance:
{'acc': 0.81400776, 'precision': 0.8141091, 'recall': 0.8140695, 'specificity': 0.8140695, 'f1': 0.814006, 'auroc': 0.88547087, 'binary_precision': 0.8064516, 'binary_recall': 0.822884, 'binary_specificity': 0.805255, 'binary_f1_score': 0.814585}
confusion matrix:
     0    1
0  521  126
1  113  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8265766, 'precision': 0.83307123, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82572705, 'auroc': 0.8876512, 'binary_precision': 0.87958115, 'binary_recall': 0.7567568, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.81355935}
confusion matrix:
     0    1
0  199   23
1   54  168
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:20:43.909947,epoch time: 0:02:45.719679,used: 0:02:45.719679,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9707031, 'precision': 0.9713137, 'recall': 0.9709301, 'specificity': 0.9709301, 'f1': 0.9707003, 'auroc': 0.9961581, 'binary_precision': 0.9912693, 'binary_recall': 0.95041853, 'binary_specificity': 0.9914417, 'binary_f1_score': 0.9704142}
confusion matrix:
      0     1
0  1506    13
1    77  1476
---- Validation: 
scalar performance:
{'acc': 0.8101167, 'precision': 0.82442343, 'recall': 0.8108487, 'specificity': 0.8108487, 'f1': 0.80824363, 'auroc': 0.9029255, 'binary_precision': 0.75452197, 'binary_recall': 0.9153605, 'binary_specificity': 0.7063369, 'binary_f1_score': 0.8271954}
confusion matrix:
     0    1
0  457  190
1   54  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.777027, 'precision': 0.79002655, 'recall': 0.777027, 'specificity': 0.777027, 'f1': 0.77450025, 'auroc': 0.8971877, 'binary_precision': 0.7286245, 'binary_recall': 0.8828829, 'binary_specificity': 0.6711712, 'binary_f1_score': 0.79837066}
confusion matrix:
     0    1
0  149   73
1   26  196
early stop counter: 1
val acc:0.810116708278656, best validation acc: 0.8140077590942383, corresponding to test acc:                         0.8265765905380249 / 0.8265765905380249
after epoch: 2,now: 2024-07-26 03:23:27.987552,epoch time: 0:02:44.077605,used: 0:05:29.797284,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.96775436, 'recall': 0.96707386, 'specificity': 0.96707386, 'f1': 0.9667901, 'auroc': 0.9942467, 'binary_precision': 0.9918644, 'binary_recall': 0.94204766, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.9663144}
confusion matrix:
      0     1
0  1507    12
1    90  1463
---- Validation: 
scalar performance:
{'acc': 0.7712062, 'precision': 0.7750858, 'recall': 0.77078074, 'specificity': 0.77078074, 'f1': 0.7702007, 'auroc': 0.8537475, 'binary_precision': 0.8060498, 'binary_recall': 0.71003133, 'binary_specificity': 0.83153015, 'binary_f1_score': 0.75500005}
confusion matrix:
     0    1
0  538  109
1  185  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8063063, 'precision': 0.8176768, 'recall': 0.8063063, 'specificity': 0.8063063, 'f1': 0.80455744, 'auroc': 0.864946, 'binary_precision': 0.87777776, 'binary_recall': 0.7117117, 'binary_specificity': 0.9009009, 'binary_f1_score': 0.78606963}
confusion matrix:
     0    1
0  200   22
1   64  158
early stop counter: 2
val acc:0.7712062001228333, best validation acc: 0.8140077590942383, corresponding to test acc:                         0.8265765905380249 / 0.8265765905380249
after epoch: 3,now: 2024-07-26 03:26:12.103087,epoch time: 0:02:44.115535,used: 0:08:13.912819,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9632161, 'precision': 0.9651574, 'recall': 0.963575, 'specificity': 0.963575, 'f1': 0.96319425, 'auroc': 0.9959674, 'binary_precision': 0.99792385, 'binary_recall': 0.9291237, 'binary_specificity': 0.9980263, 'binary_f1_score': 0.96229565}
confusion matrix:
      0     1
0  1517     3
1   110  1442
---- Validation: 
scalar performance:
{'acc': 0.73540854, 'precision': 0.7970538, 'recall': 0.733804, 'specificity': 0.733804, 'f1': 0.7200479, 'auroc': 0.8991729, 'binary_precision': 0.9306358, 'binary_recall': 0.5047022, 'binary_specificity': 0.9629057, 'binary_f1_score': 0.6544716}
confusion matrix:
     0    1
0  623   24
1  316  322
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.768018, 'precision': 0.82214713, 'recall': 0.768018, 'specificity': 0.768018, 'f1': 0.757846, 'auroc': 0.89682245, 'binary_precision': 0.9541985, 'binary_recall': 0.5630631, 'binary_specificity': 0.972973, 'binary_f1_score': 0.70821536}
confusion matrix:
     0    1
0  216    6
1   97  125
early stop counter: 3
val acc:0.7354085445404053, best validation acc: 0.8140077590942383, corresponding to test acc:                         0.8265765905380249 / 0.8265765905380249
after epoch: 4,now: 2024-07-26 03:28:56.272328,epoch time: 0:02:44.169241,used: 0:10:58.082060,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.95936954, 'recall': 0.9568505, 'specificity': 0.9568505, 'f1': 0.9563358, 'auroc': 0.99581623, 'binary_precision': 0.99929625, 'binary_recall': 0.91435933, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9549429}
confusion matrix:
      0     1
0  1518     1
1   133  1420
---- Validation: 
scalar performance:
{'acc': 0.73540854, 'precision': 0.78433233, 'recall': 0.73394567, 'specificity': 0.73394567, 'f1': 0.7227088, 'auroc': 0.86834335, 'binary_precision': 0.9005376, 'binary_recall': 0.52507836, 'binary_specificity': 0.942813, 'binary_f1_score': 0.66336626}
confusion matrix:
     0    1
0  610   37
1  303  335
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837838, 'precision': 0.8077905, 'recall': 0.7837838, 'specificity': 0.7837838, 'f1': 0.77948385, 'auroc': 0.8549428, 'binary_precision': 0.89375, 'binary_recall': 0.6441441, 'binary_specificity': 0.9234234, 'binary_f1_score': 0.7486911}
confusion matrix:
     0    1
0  205   17
1   79  143
early stop counter: 4
val acc:0.7354085445404053, best validation acc: 0.8140077590942383, corresponding to test acc:                         0.8265765905380249 / 0.8265765905380249
after epoch: 5,now: 2024-07-26 03:31:40.778185,epoch time: 0:02:44.505857,used: 0:13:42.587917,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97423625, 'recall': 0.9738436, 'specificity': 0.9738436, 'f1': 0.97363013, 'auroc': 0.99767363, 'binary_precision': 0.9939557, 'binary_recall': 0.9536083, 'binary_specificity': 0.99407893, 'binary_f1_score': 0.97336406}
confusion matrix:
      0     1
0  1511     9
1    72  1480
---- Validation: 
scalar performance:
{'acc': 0.8093385, 'precision': 0.8112047, 'recall': 0.80906206, 'specificity': 0.80906206, 'f1': 0.8089493, 'auroc': 0.88873655, 'binary_precision': 0.8336163, 'binary_recall': 0.76959246, 'binary_specificity': 0.84853166, 'binary_f1_score': 0.800326}
confusion matrix:
     0    1
0  549   98
1  147  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8490991, 'precision': 0.8491062, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.8490984, 'auroc': 0.92606115, 'binary_precision': 0.85067874, 'binary_recall': 0.8468468, 'binary_specificity': 0.8513514, 'binary_f1_score': 0.8487585}
confusion matrix:
     0    1
0  189   33
1   34  188
new oracle model saved
early stop counter: 5
val acc:0.8093385100364685, best validation acc: 0.8140077590942383, corresponding to test acc:                         0.8265765905380249 / 0.8490990996360779
after epoch: 6,now: 2024-07-26 03:34:25.516326,epoch time: 0:02:44.738141,used: 0:16:27.326058,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_17_58_seed_6_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:16:27.326058 at 2024-07-26 03:34:25.516326
persisted model performance metric: 

scalar performance:
{'acc': 0.8265766, 'precision': 0.83307123, 'recall': 0.8265766, 'specificity': 0.8265766, 'f1': 0.82572705, 'auroc': 0.8876512, 'binary_precision': 0.87958115, 'binary_recall': 0.7567568, 'binary_specificity': 0.8963964, 'binary_f1_score': 0.81355935}
confusion matrix:
     0    1
0  199   23
1   54  168
oracle model performance metric: 

scalar performance:
{'acc': 0.8490991, 'precision': 0.8491062, 'recall': 0.8490991, 'specificity': 0.8490991, 'f1': 0.8490984, 'auroc': 0.92606115, 'binary_precision': 0.85067874, 'binary_recall': 0.8468468, 'binary_specificity': 0.8513514, 'binary_f1_score': 0.8487585}
confusion matrix:
     0    1
0  189   33
1   34  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2395 MiB |   8915 MiB | 467100 GiB | 467098 GiB |
|       from large pool |   2304 MiB |   8839 MiB | 463010 GiB | 463008 GiB |
|       from small pool |     91 MiB |    132 MiB |   4090 GiB |   4090 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2395 MiB |   8915 MiB | 467100 GiB | 467098 GiB |
|       from large pool |   2304 MiB |   8839 MiB | 463010 GiB | 463008 GiB |
|       from small pool |     91 MiB |    132 MiB |   4090 GiB |   4090 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 466547 GiB | 466545 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 462463 GiB | 462461 GiB |
|       from small pool |     91 MiB |    132 MiB |   4084 GiB |   4084 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9742 MiB |   9824 MiB |  47226 MiB |  37484 MiB |
|       from large pool |   9606 MiB |   9688 MiB |  46878 MiB |  37272 MiB |
|       from small pool |    136 MiB |    140 MiB |    348 MiB |    212 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1016 MiB |   1825 MiB | 336898 GiB | 336897 GiB |
|       from large pool |   1005 MiB |   1820 MiB | 332690 GiB | 332689 GiB |
|       from small pool |     10 MiB |     60 MiB |   4207 GiB |   4207 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   66458 K  |   66456 K  |
|       from large pool |     392    |     816    |   33367 K  |   33367 K  |
|       from small pool |    2078    |    2780    |   33090 K  |   33088 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   66458 K  |   66456 K  |
|       from large pool |     392    |     816    |   33367 K  |   33367 K  |
|       from small pool |    2078    |    2780    |   33090 K  |   33088 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     333    |    1241    |     957    |
|       from large pool |     216    |     265    |    1067    |     851    |
|       from small pool |      68    |      70    |     174    |     106    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     320    |   36551 K  |   36551 K  |
|       from large pool |      75    |     255    |   19519 K  |   19519 K  |
|       from small pool |      67    |     226    |   17032 K  |   17032 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 467100 GiB | 467100 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 463010 GiB | 463010 GiB |
|       from small pool |      0 KiB |    132 MiB |   4090 GiB |   4090 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 467100 GiB | 467100 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 463010 GiB | 463010 GiB |
|       from small pool |      0 KiB |    132 MiB |   4090 GiB |   4090 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 466547 GiB | 466547 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 462463 GiB | 462463 GiB |
|       from small pool |      0 KiB |    132 MiB |   4084 GiB |   4084 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3412 MiB |   9824 MiB |  47226 MiB |  43814 MiB |
|       from large pool |   3310 MiB |   9688 MiB |  46878 MiB |  43568 MiB |
|       from small pool |    102 MiB |    140 MiB |    348 MiB |    246 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 336899 GiB | 336899 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 332691 GiB | 332691 GiB |
|       from small pool |      0 KiB |     60 MiB |   4207 GiB |   4207 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   66458 K  |   66458 K  |
|       from large pool |       2    |     816    |   33367 K  |   33367 K  |
|       from small pool |       0    |    2780    |   33090 K  |   33090 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   66458 K  |   66458 K  |
|       from large pool |       2    |     816    |   33367 K  |   33367 K  |
|       from small pool |       0    |    2780    |   33090 K  |   33090 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1241    |    1110    |
|       from large pool |      80    |     265    |    1067    |     987    |
|       from small pool |      51    |      70    |     174    |     123    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   36552 K  |   36552 K  |
|       from large pool |       3    |     255    |   19519 K  |   19519 K  |
|       from small pool |       0    |     226    |   17032 K  |   17032 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 467100 GiB | 467100 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 463010 GiB | 463010 GiB |
|       from small pool |      0 KiB |    132 MiB |   4090 GiB |   4090 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 467100 GiB | 467100 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 463010 GiB | 463010 GiB |
|       from small pool |      0 KiB |    132 MiB |   4090 GiB |   4090 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 466547 GiB | 466547 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 462463 GiB | 462463 GiB |
|       from small pool |      0 KiB |    132 MiB |   4084 GiB |   4084 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3412 MiB |   9824 MiB |  47226 MiB |  43814 MiB |
|       from large pool |   3310 MiB |   9688 MiB |  46878 MiB |  43568 MiB |
|       from small pool |    102 MiB |    140 MiB |    348 MiB |    246 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 336899 GiB | 336899 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 332691 GiB | 332691 GiB |
|       from small pool |      0 KiB |     60 MiB |   4207 GiB |   4207 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   66458 K  |   66458 K  |
|       from large pool |       2    |     816    |   33367 K  |   33367 K  |
|       from small pool |       0    |    2780    |   33090 K  |   33090 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   66458 K  |   66458 K  |
|       from large pool |       2    |     816    |   33367 K  |   33367 K  |
|       from small pool |       0    |    2780    |   33090 K  |   33090 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1241    |    1110    |
|       from large pool |      80    |     265    |    1067    |     987    |
|       from small pool |      51    |      70    |     174    |     123    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   36552 K  |   36552 K  |
|       from large pool |       3    |     255    |   19519 K  |   19519 K  |
|       from small pool |       0    |     226    |   17032 K  |   17032 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723

 Experiment start at: 2024-07-26 03:34:59.076230
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95703125, 'precision': 0.95890725, 'recall': 0.9575804, 'specificity': 0.9575804, 'f1': 0.9570137, 'auroc': 0.9961852, 'binary_precision': 0.9924138, 'binary_recall': 0.9224359, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.9561462}
confusion matrix:
      0     1
0  1501    11
1   121  1439
---- Validation: 
scalar performance:
{'acc': 0.80538464, 'precision': 0.8209165, 'recall': 0.8036695, 'specificity': 0.8036695, 'f1': 0.80235314, 'auroc': 0.8747514, 'binary_precision': 0.88777554, 'binary_recall': 0.6921875, 'binary_specificity': 0.91515154, 'binary_f1_score': 0.77787536}
confusion matrix:
     0    1
0  604   56
1  197  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8473798, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.8349216, 'auroc': 0.91283536, 'binary_precision': 0.90957445, 'binary_recall': 0.7467249, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8201439}
confusion matrix:
     0    1
0  212   17
1   58  171
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:37:47.486458,epoch time: 0:02:48.410228,used: 0:02:48.410228,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8938802, 'precision': 0.9106353, 'recall': 0.8954823, 'specificity': 0.8954823, 'f1': 0.89304173, 'auroc': 0.9897293, 'binary_precision': 0.99758065, 'binary_recall': 0.7929487, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.88357145}
confusion matrix:
      0     1
0  1509     3
1   323  1237
---- Validation: 
scalar performance:
{'acc': 0.6876923, 'precision': 0.76716876, 'recall': 0.68342805, 'specificity': 0.68342805, 'f1': 0.659511, 'auroc': 0.80048776, 'binary_precision': 0.90909094, 'binary_recall': 0.40625, 'binary_specificity': 0.96060604, 'binary_f1_score': 0.561555}
confusion matrix:
     0    1
0  634   26
1  380  260
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83842796, 'precision': 0.8616256, 'recall': 0.8384279, 'specificity': 0.8384279, 'f1': 0.83579457, 'auroc': 0.8988577, 'binary_precision': 0.9532164, 'binary_recall': 0.7117904, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.81499994}
confusion matrix:
     0    1
0  221    8
1   66  163
new oracle model saved
early stop counter: 1
val acc:0.6876922845840454, best validation acc: 0.805384635925293, corresponding to test acc:                         0.836244523525238 / 0.8384279608726501
after epoch: 2,now: 2024-07-26 03:40:32.662800,epoch time: 0:02:45.176342,used: 0:05:33.586570,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.944987, 'precision': 0.94949186, 'recall': 0.945813, 'specificity': 0.945813, 'f1': 0.94490707, 'auroc': 0.99529207, 'binary_precision': 0.9985663, 'binary_recall': 0.89294875, 'binary_specificity': 0.99867725, 'binary_f1_score': 0.94280887}
confusion matrix:
      0     1
0  1510     2
1   167  1393
---- Validation: 
scalar performance:
{'acc': 0.55923074, 'precision': 0.70616263, 'recall': 0.5526042, 'specificity': 0.5526042, 'f1': 0.45386922, 'auroc': 0.7768856, 'binary_precision': 0.8764045, 'binary_recall': 0.121875, 'binary_specificity': 0.98333335, 'binary_f1_score': 0.21399178}
confusion matrix:
     0   1
0  649  11
1  562  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6834061, 'precision': 0.76124513, 'recall': 0.6834061, 'specificity': 0.6834061, 'f1': 0.6579255, 'auroc': 0.89328957, 'binary_precision': 0.90384614, 'binary_recall': 0.41048035, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.5645645}
confusion matrix:
     0   1
0  219  10
1  135  94
early stop counter: 2
val acc:0.5592307448387146, best validation acc: 0.805384635925293, corresponding to test acc:                         0.836244523525238 / 0.8384279608726501
after epoch: 3,now: 2024-07-26 03:43:17.002376,epoch time: 0:02:44.339576,used: 0:08:17.926146,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98547417, 'recall': 0.9855464, 'specificity': 0.9855464, 'f1': 0.98535144, 'auroc': 0.99912834, 'binary_precision': 0.9980276, 'binary_recall': 0.97307694, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.98539436}
confusion matrix:
      0     1
0  1509     3
1    42  1518
---- Validation: 
scalar performance:
{'acc': 0.75153846, 'precision': 0.80723023, 'recall': 0.7482244, 'specificity': 0.7482244, 'f1': 0.7380495, 'auroc': 0.8895632, 'binary_precision': 0.9342466, 'binary_recall': 0.5328125, 'binary_specificity': 0.96363634, 'binary_f1_score': 0.6786069}
confusion matrix:
     0    1
0  636   24
1  299  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7947598, 'precision': 0.8381127, 'recall': 0.7947598, 'specificity': 0.7947598, 'f1': 0.7879629, 'auroc': 0.92145455, 'binary_precision': 0.9591837, 'binary_recall': 0.6157205, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.74999994}
confusion matrix:
     0    1
0  223    6
1   88  141
early stop counter: 3
val acc:0.7515384554862976, best validation acc: 0.805384635925293, corresponding to test acc:                         0.836244523525238 / 0.8384279608726501
after epoch: 4,now: 2024-07-26 03:46:01.080802,epoch time: 0:02:44.078426,used: 0:11:02.004572,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.9543269, 'recall': 0.951282, 'specificity': 0.951282, 'f1': 0.95046407, 'auroc': 0.99767756, 'binary_precision': 1.0, 'binary_recall': 0.9025641, 'binary_specificity': 1.0, 'binary_f1_score': 0.9487871}
confusion matrix:
      0     1
0  1512     0
1   152  1408
---- Validation: 
scalar performance:
{'acc': 0.5538462, 'precision': 0.736822, 'recall': 0.5469697, 'specificity': 0.5469697, 'f1': 0.43711853, 'auroc': 0.89589787, 'binary_precision': 0.9411765, 'binary_recall': 0.1, 'binary_specificity': 0.9939394, 'binary_f1_score': 0.18079098}
confusion matrix:
     0   1
0  656   4
1  576  64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52401745, 'precision': 0.75615215, 'recall': 0.52401745, 'specificity': 0.52401745, 'f1': 0.38459074, 'auroc': 0.92921567, 'binary_precision': 1.0, 'binary_recall': 0.048034936, 'binary_specificity': 1.0, 'binary_f1_score': 0.09166667}
confusion matrix:
     0   1
0  229   0
1  218  11
early stop counter: 4
val acc:0.5538461804389954, best validation acc: 0.805384635925293, corresponding to test acc:                         0.836244523525238 / 0.8384279608726501
after epoch: 5,now: 2024-07-26 03:48:45.821327,epoch time: 0:02:44.740525,used: 0:13:46.745097,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9898824, 'recall': 0.98994195, 'specificity': 0.98994195, 'f1': 0.9899071, 'auroc': 0.999253, 'binary_precision': 0.99227303, 'binary_recall': 0.9878205, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9900418}
confusion matrix:
      0     1
0  1500    12
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.7792308, 'precision': 0.78441674, 'recall': 0.77814865, 'specificity': 0.77814865, 'f1': 0.777725, 'auroc': 0.86561316, 'binary_precision': 0.81916815, 'binary_recall': 0.7078125, 'binary_specificity': 0.8484849, 'binary_f1_score': 0.75943005}
confusion matrix:
     0    1
0  560  100
1  187  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.8501529, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.84925795, 'auroc': 0.9188278, 'binary_precision': 0.8669725, 'binary_recall': 0.8253275, 'binary_specificity': 0.8733624, 'binary_f1_score': 0.84563756}
confusion matrix:
     0    1
0  200   29
1   40  189
new oracle model saved
early stop counter: 5
val acc:0.7792307734489441, best validation acc: 0.805384635925293, corresponding to test acc:                         0.836244523525238 / 0.8493449687957764
after epoch: 6,now: 2024-07-26 03:51:31.167842,epoch time: 0:02:45.346515,used: 0:16:32.091612,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_34_59_seed_7_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:16:32.091612 at 2024-07-26 03:51:31.167842
persisted model performance metric: 

scalar performance:
{'acc': 0.8362445, 'precision': 0.8473798, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.8349216, 'auroc': 0.91283536, 'binary_precision': 0.90957445, 'binary_recall': 0.7467249, 'binary_specificity': 0.9257642, 'binary_f1_score': 0.8201439}
confusion matrix:
     0    1
0  212   17
1   58  171
oracle model performance metric: 

scalar performance:
{'acc': 0.84934497, 'precision': 0.8501529, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.84925795, 'auroc': 0.9188278, 'binary_precision': 0.8669725, 'binary_recall': 0.8253275, 'binary_specificity': 0.8733624, 'binary_f1_score': 0.84563756}
confusion matrix:
     0    1
0  200   29
1   40  189
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2397 MiB |   8915 MiB | 507307 GiB | 507305 GiB |
|       from large pool |   2305 MiB |   8839 MiB | 502864 GiB | 502862 GiB |
|       from small pool |     91 MiB |    132 MiB |   4442 GiB |   4442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2397 MiB |   8915 MiB | 507307 GiB | 507305 GiB |
|       from large pool |   2305 MiB |   8839 MiB | 502864 GiB | 502862 GiB |
|       from small pool |     91 MiB |    132 MiB |   4442 GiB |   4442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 506652 GiB | 506650 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 502216 GiB | 502213 GiB |
|       from small pool |     91 MiB |    132 MiB |   4436 GiB |   4436 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  53558 MiB |  43814 MiB |
|       from large pool |   9608 MiB |   9688 MiB |  53176 MiB |  43568 MiB |
|       from small pool |    136 MiB |    140 MiB |    382 MiB |    246 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    968 MiB |   1825 MiB | 367316 GiB | 367315 GiB |
|       from large pool |    958 MiB |   1820 MiB | 362746 GiB | 362745 GiB |
|       from small pool |     10 MiB |     60 MiB |   4569 GiB |   4569 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   72184 K  |   72181 K  |
|       from large pool |     392    |     816    |   36239 K  |   36238 K  |
|       from small pool |    2084    |    2780    |   35945 K  |   35943 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   72184 K  |   72181 K  |
|       from large pool |     392    |     816    |   36239 K  |   36238 K  |
|       from small pool |    2084    |    2780    |   35945 K  |   35943 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |    1396    |    1110    |
|       from large pool |     218    |     265    |    1205    |     987    |
|       from small pool |      68    |      70    |     191    |     123    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     320    |   39709 K  |   39709 K  |
|       from large pool |      70    |     255    |   21214 K  |   21214 K  |
|       from small pool |      70    |     226    |   18494 K  |   18494 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 507307 GiB | 507307 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 502864 GiB | 502864 GiB |
|       from small pool |      0 KiB |    132 MiB |   4442 GiB |   4442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 507307 GiB | 507307 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 502864 GiB | 502864 GiB |
|       from small pool |      0 KiB |    132 MiB |   4442 GiB |   4442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 506652 GiB | 506652 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 502216 GiB | 502216 GiB |
|       from small pool |      0 KiB |    132 MiB |   4436 GiB |   4436 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3366 MiB |   9824 MiB |  53558 MiB |  50192 MiB |
|       from large pool |   3264 MiB |   9688 MiB |  53176 MiB |  49912 MiB |
|       from small pool |    102 MiB |    140 MiB |    382 MiB |    280 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 367317 GiB | 367317 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 362747 GiB | 362747 GiB |
|       from small pool |      0 KiB |     60 MiB |   4569 GiB |   4569 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   72184 K  |   72184 K  |
|       from large pool |       2    |     816    |   36239 K  |   36239 K  |
|       from small pool |       0    |    2780    |   35945 K  |   35945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   72184 K  |   72184 K  |
|       from large pool |       2    |     816    |   36239 K  |   36239 K  |
|       from small pool |       0    |    2780    |   35945 K  |   35945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1396    |    1267    |
|       from large pool |      78    |     265    |    1205    |    1127    |
|       from small pool |      51    |      70    |     191    |     140    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   39709 K  |   39709 K  |
|       from large pool |       3    |     255    |   21214 K  |   21214 K  |
|       from small pool |       0    |     226    |   18495 K  |   18495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 507307 GiB | 507307 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 502864 GiB | 502864 GiB |
|       from small pool |      0 KiB |    132 MiB |   4442 GiB |   4442 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 507307 GiB | 507307 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 502864 GiB | 502864 GiB |
|       from small pool |      0 KiB |    132 MiB |   4442 GiB |   4442 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 506652 GiB | 506652 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 502216 GiB | 502216 GiB |
|       from small pool |      0 KiB |    132 MiB |   4436 GiB |   4436 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3366 MiB |   9824 MiB |  53558 MiB |  50192 MiB |
|       from large pool |   3264 MiB |   9688 MiB |  53176 MiB |  49912 MiB |
|       from small pool |    102 MiB |    140 MiB |    382 MiB |    280 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 367317 GiB | 367317 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 362747 GiB | 362747 GiB |
|       from small pool |      0 KiB |     60 MiB |   4569 GiB |   4569 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   72184 K  |   72184 K  |
|       from large pool |       2    |     816    |   36239 K  |   36239 K  |
|       from small pool |       0    |    2780    |   35945 K  |   35945 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   72184 K  |   72184 K  |
|       from large pool |       2    |     816    |   36239 K  |   36239 K  |
|       from small pool |       0    |    2780    |   35945 K  |   35945 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1396    |    1267    |
|       from large pool |      78    |     265    |    1205    |    1127    |
|       from small pool |      51    |      70    |     191    |     140    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   39709 K  |   39709 K  |
|       from large pool |       3    |     255    |   21214 K  |   21214 K  |
|       from small pool |       0    |     226    |   18495 K  |   18495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723

 Experiment start at: 2024-07-26 03:52:06.358410
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.83092105, 'precision': 0.87251985, 'recall': 0.83289987, 'specificity': 0.83289987, 'f1': 0.8266349, 'auroc': 0.9841634, 'binary_precision': 1.0, 'binary_recall': 0.66579974, 'binary_specificity': 1.0, 'binary_f1_score': 0.7993755}
confusion matrix:
      0     1
0  1502     0
1   514  1024
---- Validation: 
scalar performance:
{'acc': 0.5815932, 'precision': 0.74997807, 'recall': 0.5681369, 'specificity': 0.5681369, 'f1': 0.4797864, 'auroc': 0.9049556, 'binary_precision': 0.94736844, 'binary_recall': 0.14376996, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.24965326}
confusion matrix:
     0   1
0  662   5
1  536  90
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6788991, 'precision': 0.78754056, 'recall': 0.67889905, 'specificity': 0.67889905, 'f1': 0.6454049, 'auroc': 0.89022386, 'binary_precision': 0.96428573, 'binary_recall': 0.37155962, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.5364238}
confusion matrix:
     0   1
0  215   3
1  137  81
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:54:51.762275,epoch time: 0:02:45.403865,used: 0:02:45.403865,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9536184, 'precision': 0.95402867, 'recall': 0.9534691, 'specificity': 0.9534691, 'f1': 0.95359164, 'auroc': 0.99364316, 'binary_precision': 0.9428934, 'binary_recall': 0.96681845, 'binary_specificity': 0.94011974, 'binary_f1_score': 0.9547061}
confusion matrix:
      0     1
0  1413    90
1    51  1486
---- Validation: 
scalar performance:
{'acc': 0.76334107, 'precision': 0.8094321, 'recall': 0.7693382, 'specificity': 0.7693382, 'f1': 0.7567397, 'auroc': 0.89365625, 'binary_precision': 0.6818182, 'binary_recall': 0.9584665, 'binary_specificity': 0.5802099, 'binary_f1_score': 0.7968127}
confusion matrix:
     0    1
0  387  280
1   26  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7454128, 'precision': 0.7783599, 'recall': 0.7454128, 'specificity': 0.7454128, 'f1': 0.73764986, 'auroc': 0.860744, 'binary_precision': 0.6825939, 'binary_recall': 0.9174312, 'binary_specificity': 0.5733945, 'binary_f1_score': 0.7827789}
confusion matrix:
     0    1
0  125   93
1   18  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:57:36.640178,epoch time: 0:02:44.877903,used: 0:05:30.281768,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.9774512, 'recall': 0.9774436, 'specificity': 0.9774436, 'f1': 0.9773027, 'auroc': 0.99793816, 'binary_precision': 0.9893404, 'binary_recall': 0.96553963, 'binary_specificity': 0.9893475, 'binary_f1_score': 0.97729516}
confusion matrix:
      0     1
0  1486    16
1    53  1485
---- Validation: 
scalar performance:
{'acc': 0.82675946, 'precision': 0.83232564, 'recall': 0.8246212, 'specificity': 0.8246212, 'f1': 0.8252289, 'auroc': 0.8968128, 'binary_precision': 0.8681319, 'binary_recall': 0.7571885, 'binary_specificity': 0.89205396, 'binary_f1_score': 0.80887365}
confusion matrix:
     0    1
0  595   72
1  152  474
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646789, 'precision': 0.8680947, 'recall': 0.8646789, 'specificity': 0.8646789, 'f1': 0.86436427, 'auroc': 0.91172886, 'binary_precision': 0.9035533, 'binary_recall': 0.8165138, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.85783136}
confusion matrix:
     0    1
0  199   19
1   40  178
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 04:00:21.140771,epoch time: 0:02:44.500593,used: 0:08:14.782361,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.9749664, 'recall': 0.9748408, 'specificity': 0.9748408, 'f1': 0.9746706, 'auroc': 0.9971352, 'binary_precision': 0.9899329, 'binary_recall': 0.95966166, 'binary_specificity': 0.99002, 'binary_f1_score': 0.9745623}
confusion matrix:
      0     1
0  1488    15
1    62  1475
---- Validation: 
scalar performance:
{'acc': 0.81825215, 'precision': 0.81890774, 'recall': 0.8173573, 'specificity': 0.8173573, 'f1': 0.8177179, 'auroc': 0.8763957, 'binary_precision': 0.82747066, 'binary_recall': 0.78913736, 'binary_specificity': 0.84557724, 'binary_f1_score': 0.8078495}
confusion matrix:
     0    1
0  564  103
1  132  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8555046, 'precision': 0.8555121, 'recall': 0.8555046, 'specificity': 0.8555046, 'f1': 0.8555038, 'auroc': 0.9105715, 'binary_precision': 0.8538813, 'binary_recall': 0.85779816, 'binary_specificity': 0.853211, 'binary_f1_score': 0.85583526}
confusion matrix:
     0    1
0  186   32
1   31  187
early stop counter: 1
val acc:0.8182521462440491, best validation acc: 0.8267594575881958, corresponding to test acc:                         0.8646789193153381 / 0.8646789193153381
after epoch: 4,now: 2024-07-26 04:03:03.989098,epoch time: 0:02:42.848327,used: 0:10:57.630688,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.9845411, 'recall': 0.98453295, 'specificity': 0.98453295, 'f1': 0.98453695, 'auroc': 0.9986398, 'binary_precision': 0.9844156, 'binary_recall': 0.9850552, 'binary_specificity': 0.98401064, 'binary_f1_score': 0.98473537}
confusion matrix:
      0     1
0  1477    24
1    23  1516
---- Validation: 
scalar performance:
{'acc': 0.84996134, 'precision': 0.851133, 'recall': 0.8509395, 'specificity': 0.8509395, 'f1': 0.84995914, 'auroc': 0.9219576, 'binary_precision': 0.8214286, 'binary_recall': 0.88178915, 'binary_specificity': 0.82008994, 'binary_f1_score': 0.8505393}
confusion matrix:
     0    1
0  547  120
1   74  552
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8440367, 'precision': 0.8442975, 'recall': 0.8440367, 'specificity': 0.8440367, 'f1': 0.84400713, 'auroc': 0.9111396, 'binary_precision': 0.8537736, 'binary_recall': 0.83027524, 'binary_specificity': 0.85779816, 'binary_f1_score': 0.8418605}
confusion matrix:
     0    1
0  187   31
1   37  181
better model found
persisted
after epoch: 5,now: 2024-07-26 04:05:47.636337,epoch time: 0:02:43.647239,used: 0:13:41.277927,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95032895, 'precision': 0.95359755, 'recall': 0.9508268, 'specificity': 0.9508268, 'f1': 0.95027184, 'auroc': 0.9968603, 'binary_precision': 0.995, 'binary_recall': 0.906311, 'binary_specificity': 0.9953427, 'binary_f1_score': 0.948587}
confusion matrix:
      0     1
0  1496     7
1   144  1393
---- Validation: 
scalar performance:
{'acc': 0.73549885, 'precision': 0.8143463, 'recall': 0.7273771, 'specificity': 0.7273771, 'f1': 0.71313787, 'auroc': 0.9109359, 'binary_precision': 0.96405226, 'binary_recall': 0.471246, 'binary_specificity': 0.9835082, 'binary_f1_score': 0.6330472}
confusion matrix:
     0    1
0  656   11
1  331  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73623854, 'precision': 0.8189217, 'recall': 0.73623854, 'specificity': 0.73623854, 'f1': 0.7179581, 'auroc': 0.89230704, 'binary_precision': 0.9813084, 'binary_recall': 0.48165137, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.6461538}
confusion matrix:
     0    1
0  216    2
1  113  105
early stop counter: 1
val acc:0.73549884557724, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.8440366983413696 / 0.8646789193153381
after epoch: 6,now: 2024-07-26 04:08:30.594681,epoch time: 0:02:42.958344,used: 0:16:24.236271,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.975, 'precision': 0.97560245, 'recall': 0.9748069, 'specificity': 0.9748069, 'f1': 0.9749809, 'auroc': 0.9985749, 'binary_precision': 0.9615142, 'binary_recall': 0.9902534, 'binary_specificity': 0.9593604, 'binary_f1_score': 0.9756722}
confusion matrix:
      0     1
0  1440    61
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.8290797, 'precision': 0.8337314, 'recall': 0.83094513, 'specificity': 0.83094513, 'f1': 0.82889915, 'auroc': 0.9287856, 'binary_precision': 0.78561354, 'binary_recall': 0.88977635, 'binary_specificity': 0.7721139, 'binary_f1_score': 0.8344569}
confusion matrix:
     0    1
0  515  152
1   69  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.83835924, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.83701104, 'auroc': 0.9180834, 'binary_precision': 0.8181818, 'binary_recall': 0.8669725, 'binary_specificity': 0.80733943, 'binary_f1_score': 0.8418708}
confusion matrix:
     0    1
0  176   42
1   29  189
early stop counter: 2
val acc:0.8290796875953674, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.8440366983413696 / 0.8646789193153381
after epoch: 7,now: 2024-07-26 04:11:13.406821,epoch time: 0:02:42.812140,used: 0:19:07.048411,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98157895, 'precision': 0.9818212, 'recall': 0.98174775, 'specificity': 0.98174775, 'f1': 0.9815788, 'auroc': 0.9982892, 'binary_precision': 0.99598396, 'binary_recall': 0.96749026, 'binary_specificity': 0.9960053, 'binary_f1_score': 0.9815303}
confusion matrix:
      0     1
0  1496     6
1    50  1488
---- Validation: 
scalar performance:
{'acc': 0.78499615, 'precision': 0.8335482, 'recall': 0.778839, 'specificity': 0.778839, 'f1': 0.77417827, 'auroc': 0.9125956, 'binary_precision': 0.953125, 'binary_recall': 0.5846645, 'binary_specificity': 0.9730135, 'binary_f1_score': 0.7247524}
confusion matrix:
     0    1
0  649   18
1  260  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63990825, 'precision': 0.7757205, 'recall': 0.63990825, 'specificity': 0.63990825, 'f1': 0.58933806, 'auroc': 0.8846109, 'binary_precision': 0.9692308, 'binary_recall': 0.28899083, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.44522965}
confusion matrix:
     0   1
0  216   2
1  155  63
early stop counter: 3
val acc:0.7849961519241333, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.8440366983413696 / 0.8646789193153381
after epoch: 8,now: 2024-07-26 04:13:56.376498,epoch time: 0:02:42.969677,used: 0:21:50.018088,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9838816, 'precision': 0.9841099, 'recall': 0.9840468, 'specificity': 0.9840468, 'f1': 0.9838815, 'auroc': 0.9993195, 'binary_precision': 0.9979933, 'binary_recall': 0.97009104, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.9838444}
confusion matrix:
      0     1
0  1499     3
1    46  1492
---- Validation: 
scalar performance:
{'acc': 0.7316319, 'precision': 0.80199873, 'recall': 0.7237763, 'specificity': 0.7237763, 'f1': 0.7104132, 'auroc': 0.89546025, 'binary_precision': 0.9400631, 'binary_recall': 0.47603834, 'binary_specificity': 0.9715142, 'binary_f1_score': 0.6320254}
confusion matrix:
     0    1
0  648   19
1  328  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49311927, 'precision': 0.2482679, 'recall': 0.49311927, 'specificity': 0.49311927, 'f1': 0.33026114, 'auroc': 0.845215, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  215  3
1  218  0
early stop counter: 4
val acc:0.731631875038147, best validation acc: 0.8499613404273987, corresponding to test acc:                         0.8440366983413696 / 0.8646789193153381
after epoch: 9,now: 2024-07-26 04:16:39.654940,epoch time: 0:02:43.278442,used: 0:24:33.296530,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.98376673, 'recall': 0.983714, 'specificity': 0.983714, 'f1': 0.9835526, 'auroc': 0.9977066, 'binary_precision': 0.9973262, 'binary_recall': 0.97009104, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.98352015}
confusion matrix:
      0     1
0  1498     4
1    46  1492
---- Validation: 
scalar performance:
{'acc': 0.85846865, 'precision': 0.8719202, 'recall': 0.8554541, 'specificity': 0.8554541, 'f1': 0.85632324, 'auroc': 0.9271188, 'binary_precision': 0.935167, 'binary_recall': 0.76038337, 'binary_specificity': 0.95052475, 'binary_f1_score': 0.83876646}
confusion matrix:
     0    1
0  634   33
1  150  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8027523, 'precision': 0.8375563, 'recall': 0.80275226, 'specificity': 0.80275226, 'f1': 0.79753345, 'auroc': 0.90040827, 'binary_precision': 0.9459459, 'binary_recall': 0.64220184, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.76502734}
confusion matrix:
     0    1
0  210    8
1   78  140
better model found
persisted
after epoch: 10,now: 2024-07-26 04:19:23.329326,epoch time: 0:02:43.674386,used: 0:27:16.970916,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9848684, 'precision': 0.98527765, 'recall': 0.98471797, 'specificity': 0.98471797, 'f1': 0.98485947, 'auroc': 0.99952257, 'binary_precision': 0.97396827, 'binary_recall': 0.9967511, 'binary_specificity': 0.97268486, 'binary_f1_score': 0.98522806}
confusion matrix:
      0     1
0  1460    41
1     5  1534
---- Validation: 
scalar performance:
{'acc': 0.88012373, 'precision': 0.8842312, 'recall': 0.8785056, 'specificity': 0.8785056, 'f1': 0.8793731, 'auroc': 0.9339252, 'binary_precision': 0.91681415, 'binary_recall': 0.827476, 'binary_specificity': 0.9295352, 'binary_f1_score': 0.86985725}
confusion matrix:
     0    1
0  620   47
1  108  518
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8555046, 'precision': 0.876088, 'recall': 0.85550463, 'specificity': 0.85550463, 'f1': 0.8535001, 'auroc': 0.91410655, 'binary_precision': 0.96407187, 'binary_recall': 0.7385321, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  212    6
1   57  161
better model found
persisted
after epoch: 11,now: 2024-07-26 04:22:07.671624,epoch time: 0:02:44.342298,used: 0:30:01.313214,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9838816, 'precision': 0.9839191, 'recall': 0.9839767, 'specificity': 0.9839767, 'f1': 0.98388135, 'auroc': 0.99915284, 'binary_precision': 0.9920687, 'binary_recall': 0.9759428, 'binary_specificity': 0.99201065, 'binary_f1_score': 0.98393965}
confusion matrix:
      0     1
0  1490    12
1    37  1501
---- Validation: 
scalar performance:
{'acc': 0.8128384, 'precision': 0.8494744, 'recall': 0.8076421, 'specificity': 0.8076421, 'f1': 0.8058684, 'auroc': 0.9265487, 'binary_precision': 0.9549763, 'binary_recall': 0.64377, 'binary_specificity': 0.9715142, 'binary_f1_score': 0.769084}
confusion matrix:
     0    1
0  648   19
1  223  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.8664456, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8312258, 'auroc': 0.9236596, 'binary_precision': 0.97402596, 'binary_recall': 0.6880734, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.8064516}
confusion matrix:
     0    1
0  214    4
1   68  150
early stop counter: 1
val acc:0.8128383755683899, best validation acc: 0.8801237344741821, corresponding to test acc:                         0.85550457239151 / 0.8646789193153381
after epoch: 12,now: 2024-07-26 04:24:50.527858,epoch time: 0:02:42.856234,used: 0:32:44.169448,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9828947, 'precision': 0.98328733, 'recall': 0.9827602, 'specificity': 0.9827602, 'f1': 0.98288566, 'auroc': 0.9993035, 'binary_precision': 0.97202796, 'binary_recall': 0.9947951, 'binary_specificity': 0.97072524, 'binary_f1_score': 0.98327976}
confusion matrix:
      0     1
0  1459    44
1     8  1529
---- Validation: 
scalar performance:
{'acc': 0.8221191, 'precision': 0.8568258, 'recall': 0.81712854, 'specificity': 0.81712854, 'f1': 0.81593513, 'auroc': 0.94038206, 'binary_precision': 0.96046513, 'binary_recall': 0.6597444, 'binary_specificity': 0.97451276, 'binary_f1_score': 0.78219694}
confusion matrix:
     0    1
0  650   17
1  213  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6215596, 'precision': 0.7674166, 'recall': 0.6215596, 'specificity': 0.6215596, 'f1': 0.56180906, 'auroc': 0.911329, 'binary_precision': 0.9649123, 'binary_recall': 0.2522936, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.4}
confusion matrix:
     0   1
0  216   2
1  163  55
early stop counter: 2
val acc:0.8221191167831421, best validation acc: 0.8801237344741821, corresponding to test acc:                         0.85550457239151 / 0.8646789193153381
after epoch: 13,now: 2024-07-26 04:27:33.502685,epoch time: 0:02:42.974827,used: 0:35:27.144275,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9858553, 'precision': 0.9859918, 'recall': 0.98578787, 'specificity': 0.98578787, 'f1': 0.9858513, 'auroc': 0.9993136, 'binary_precision': 0.98006433, 'binary_recall': 0.9921875, 'binary_specificity': 0.9793883, 'binary_f1_score': 0.98608863}
confusion matrix:
      0     1
0  1473    31
1    12  1524
---- Validation: 
scalar performance:
{'acc': 0.82830626, 'precision': 0.85006976, 'recall': 0.82430387, 'specificity': 0.82430387, 'f1': 0.82422596, 'auroc': 0.92749655, 'binary_precision': 0.9297872, 'binary_recall': 0.69808304, 'binary_specificity': 0.95052475, 'binary_f1_score': 0.79744524}
confusion matrix:
     0    1
0  634   33
1  189  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73623854, 'precision': 0.80080646, 'recall': 0.73623854, 'specificity': 0.73623854, 'f1': 0.7212819, 'auroc': 0.8802289, 'binary_precision': 0.94017094, 'binary_recall': 0.5045872, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.6567164}
confusion matrix:
     0    1
0  211    7
1  108  110
early stop counter: 3
val acc:0.828306257724762, best validation acc: 0.8801237344741821, corresponding to test acc:                         0.85550457239151 / 0.8646789193153381
after epoch: 14,now: 2024-07-26 04:30:16.471912,epoch time: 0:02:42.969227,used: 0:38:10.113502,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.97335523, 'precision': 0.97442204, 'recall': 0.97312725, 'specificity': 0.97312725, 'f1': 0.9733281, 'auroc': 0.99911785, 'binary_precision': 0.9544035, 'binary_recall': 0.9947917, 'binary_specificity': 0.95146275, 'binary_f1_score': 0.9741792}
confusion matrix:
      0     1
0  1431    73
1     8  1528
---- Validation: 
scalar performance:
{'acc': 0.76411444, 'precision': 0.7877968, 'recall': 0.76851666, 'specificity': 0.76851666, 'f1': 0.76098293, 'auroc': 0.88136995, 'binary_precision': 0.6969325, 'binary_recall': 0.9073482, 'binary_specificity': 0.62968516, 'binary_f1_score': 0.7883414}
confusion matrix:
     0    1
0  420  247
1   58  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77522933, 'precision': 0.7994505, 'recall': 0.77522933, 'specificity': 0.77522933, 'f1': 0.7705903, 'auroc': 0.91467464, 'binary_precision': 0.71428573, 'binary_recall': 0.9174312, 'binary_specificity': 0.6330275, 'binary_f1_score': 0.8032128}
confusion matrix:
     0    1
0  138   80
1   18  200
early stop counter: 4
val acc:0.7641144394874573, best validation acc: 0.8801237344741821, corresponding to test acc:                         0.85550457239151 / 0.8646789193153381
after epoch: 15,now: 2024-07-26 04:32:59.750657,epoch time: 0:02:43.278745,used: 0:40:53.392247,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.99209917, 'recall': 0.99215287, 'specificity': 0.99215287, 'f1': 0.992105, 'auroc': 0.99983335, 'binary_precision': 0.99671483, 'binary_recall': 0.9876302, 'binary_specificity': 0.99667555, 'binary_f1_score': 0.99215174}
confusion matrix:
      0     1
0  1499     5
1    19  1517
---- Validation: 
scalar performance:
{'acc': 0.8422274, 'precision': 0.8633155, 'recall': 0.8383863, 'specificity': 0.8383863, 'f1': 0.83870786, 'auroc': 0.94044256, 'binary_precision': 0.9432773, 'binary_recall': 0.7172524, 'binary_specificity': 0.9595202, 'binary_f1_score': 0.814882}
confusion matrix:
     0    1
0  640   27
1  177  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8417431, 'precision': 0.866821, 'recall': 0.8417431, 'specificity': 0.8417431, 'f1': 0.8389913, 'auroc': 0.9152849, 'binary_precision': 0.9627329, 'binary_recall': 0.71100914, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.8179419}
confusion matrix:
     0    1
0  212    6
1   63  155
early stop counter: 5
val acc:0.8422273993492126, best validation acc: 0.8801237344741821, corresponding to test acc:                         0.85550457239151 / 0.8646789193153381
after epoch: 16,now: 2024-07-26 04:35:42.602890,epoch time: 0:02:42.852233,used: 0:43:36.244480,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_52_06_seed_8_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:43:36.244480 at 2024-07-26 04:35:42.602890
persisted model performance metric: 

scalar performance:
{'acc': 0.8555046, 'precision': 0.876088, 'recall': 0.85550463, 'specificity': 0.85550463, 'f1': 0.8535001, 'auroc': 0.91410655, 'binary_precision': 0.96407187, 'binary_recall': 0.7385321, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  212    6
1   57  161
oracle model performance metric: 

scalar performance:
{'acc': 0.8646789, 'precision': 0.8680947, 'recall': 0.8646789, 'specificity': 0.8646789, 'f1': 0.86436427, 'auroc': 0.91172886, 'binary_precision': 0.9035533, 'binary_recall': 0.8165138, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.85783136}
confusion matrix:
     0    1
0  199   19
1   40  178
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2392 MiB |   8915 MiB | 613050 GiB | 613048 GiB |
|       from large pool |   2300 MiB |   8839 MiB | 607683 GiB | 607681 GiB |
|       from small pool |     91 MiB |    132 MiB |   5366 GiB |   5366 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2392 MiB |   8915 MiB | 613050 GiB | 613048 GiB |
|       from large pool |   2300 MiB |   8839 MiB | 607683 GiB | 607681 GiB |
|       from small pool |     91 MiB |    132 MiB |   5366 GiB |   5366 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 612219 GiB | 612217 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 606860 GiB | 606858 GiB |
|       from small pool |     91 MiB |    132 MiB |   5358 GiB |   5358 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9750 MiB |   9824 MiB |  59942 MiB |  50192 MiB |
|       from large pool |   9614 MiB |   9688 MiB |  59526 MiB |  49912 MiB |
|       from small pool |    136 MiB |    140 MiB |    416 MiB |    280 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1005 MiB |   1825 MiB | 447013 GiB | 447012 GiB |
|       from large pool |    997 MiB |   1820 MiB | 441494 GiB | 441493 GiB |
|       from small pool |      8 MiB |     60 MiB |   5519 GiB |   5519 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   87215 K  |   87213 K  |
|       from large pool |     392    |     816    |   43789 K  |   43789 K  |
|       from small pool |    2078    |    2780    |   43425 K  |   43423 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   87215 K  |   87213 K  |
|       from large pool |     392    |     816    |   43789 K  |   43789 K  |
|       from small pool |    2078    |    2780    |   43425 K  |   43423 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |    1553    |    1267    |
|       from large pool |     218    |     265    |    1345    |    1127    |
|       from small pool |      68    |      70    |     208    |     140    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     144    |     320    |   47978 K  |   47977 K  |
|       from large pool |      75    |     255    |   25620 K  |   25620 K  |
|       from small pool |      69    |     226    |   22357 K  |   22357 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 613050 GiB | 613050 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 607683 GiB | 607683 GiB |
|       from small pool |      0 KiB |    132 MiB |   5366 GiB |   5366 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 613050 GiB | 613050 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 607683 GiB | 607683 GiB |
|       from small pool |      0 KiB |    132 MiB |   5366 GiB |   5366 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 612219 GiB | 612219 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 606860 GiB | 606860 GiB |
|       from small pool |      0 KiB |    132 MiB |   5358 GiB |   5358 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3398 MiB |   9824 MiB |  59942 MiB |  56544 MiB |
|       from large pool |   3298 MiB |   9688 MiB |  59526 MiB |  56228 MiB |
|       from small pool |    100 MiB |    140 MiB |    416 MiB |    316 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 447014 GiB | 447014 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 441494 GiB | 441494 GiB |
|       from small pool |      0 KiB |     60 MiB |   5519 GiB |   5519 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   87215 K  |   87215 K  |
|       from large pool |       2    |     816    |   43789 K  |   43789 K  |
|       from small pool |       0    |    2780    |   43425 K  |   43425 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   87215 K  |   87215 K  |
|       from large pool |       2    |     816    |   43789 K  |   43789 K  |
|       from small pool |       0    |    2780    |   43425 K  |   43425 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1553    |    1424    |
|       from large pool |      79    |     265    |    1345    |    1266    |
|       from small pool |      50    |      70    |     208    |     158    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   47978 K  |   47978 K  |
|       from large pool |       3    |     255    |   25620 K  |   25620 K  |
|       from small pool |       0    |     226    |   22357 K  |   22357 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 613050 GiB | 613050 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 607683 GiB | 607683 GiB |
|       from small pool |      0 KiB |    132 MiB |   5366 GiB |   5366 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 613050 GiB | 613050 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 607683 GiB | 607683 GiB |
|       from small pool |      0 KiB |    132 MiB |   5366 GiB |   5366 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 612219 GiB | 612219 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 606860 GiB | 606860 GiB |
|       from small pool |      0 KiB |    132 MiB |   5358 GiB |   5358 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3398 MiB |   9824 MiB |  59942 MiB |  56544 MiB |
|       from large pool |   3298 MiB |   9688 MiB |  59526 MiB |  56228 MiB |
|       from small pool |    100 MiB |    140 MiB |    416 MiB |    316 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 447014 GiB | 447014 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 441494 GiB | 441494 GiB |
|       from small pool |      0 KiB |     60 MiB |   5519 GiB |   5519 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   87215 K  |   87215 K  |
|       from large pool |       2    |     816    |   43789 K  |   43789 K  |
|       from small pool |       0    |    2780    |   43425 K  |   43425 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   87215 K  |   87215 K  |
|       from large pool |       2    |     816    |   43789 K  |   43789 K  |
|       from small pool |       0    |    2780    |   43425 K  |   43425 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1553    |    1424    |
|       from large pool |      79    |     265    |    1345    |    1266    |
|       from small pool |      50    |      70    |     208    |     158    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   47978 K  |   47978 K  |
|       from large pool |       3    |     255    |   25620 K  |   25620 K  |
|       from small pool |       0    |     226    |   22357 K  |   22357 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723

 Experiment start at: 2024-07-26 04:36:16.684330
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9181937, 'precision': 0.92903614, 'recall': 0.917577, 'specificity': 0.917577, 'f1': 0.91758794, 'auroc': 0.9965236, 'binary_precision': 0.86276716, 'binary_recall': 0.9961039, 'binary_specificity': 0.8390501, 'binary_f1_score': 0.9246534}
confusion matrix:
      0     1
0  1272   244
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.7104247, 'precision': 0.77858627, 'recall': 0.71288407, 'specificity': 0.71288407, 'f1': 0.6930622, 'auroc': 0.9085813, 'binary_precision': 0.6382536, 'binary_recall': 0.9578783, 'binary_specificity': 0.4678899, 'binary_f1_score': 0.76606363}
confusion matrix:
     0    1
0  306  348
1   27  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59782606, 'precision': 0.7569641, 'recall': 0.59782606, 'specificity': 0.59782606, 'f1': 0.524153, 'auroc': 0.90465033, 'binary_precision': 0.55474454, 'binary_recall': 0.99130434, 'binary_specificity': 0.20434782, 'binary_f1_score': 0.71138847}
confusion matrix:
    0    1
0  47  183
1   2  228
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:39:03.399207,epoch time: 0:02:46.714877,used: 0:02:46.714877,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.980419, 'recall': 0.98033994, 'specificity': 0.98033994, 'f1': 0.9803643, 'auroc': 0.9977937, 'binary_precision': 0.9767742, 'binary_recall': 0.9843953, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.98057}
confusion matrix:
      0     1
0  1482    36
1    24  1514
---- Validation: 
scalar performance:
{'acc': 0.85405403, 'precision': 0.85507834, 'recall': 0.8543262, 'specificity': 0.8543262, 'f1': 0.8540039, 'auroc': 0.92428684, 'binary_precision': 0.8333333, 'binary_recall': 0.8814353, 'binary_specificity': 0.8272171, 'binary_f1_score': 0.8567096}
confusion matrix:
     0    1
0  541  113
1   76  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8652174, 'precision': 0.8662143, 'recall': 0.86521745, 'specificity': 0.86521745, 'f1': 0.8651256, 'auroc': 0.9335161, 'binary_precision': 0.8471074, 'binary_recall': 0.8913044, 'binary_specificity': 0.83913046, 'binary_f1_score': 0.86864406}
confusion matrix:
     0    1
0  193   37
1   25  205
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:41:50.476048,epoch time: 0:02:47.076841,used: 0:05:33.791718,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.98207116, 'recall': 0.98180276, 'specificity': 0.98180276, 'f1': 0.9816741, 'auroc': 0.9982331, 'binary_precision': 0.99798656, 'binary_recall': 0.9655844, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.98151815}
confusion matrix:
      0     1
0  1513     3
1    53  1487
---- Validation: 
scalar performance:
{'acc': 0.8023166, 'precision': 0.80927217, 'recall': 0.8015524, 'specificity': 0.8015524, 'f1': 0.8009061, 'auroc': 0.8768219, 'binary_precision': 0.853211, 'binary_recall': 0.725429, 'binary_specificity': 0.87767583, 'binary_f1_score': 0.7841484}
confusion matrix:
     0    1
0  574   80
1  176  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84347826, 'precision': 0.8441288, 'recall': 0.84347826, 'specificity': 0.84347826, 'f1': 0.8434043, 'auroc': 0.9070133, 'binary_precision': 0.8590909, 'binary_recall': 0.82173914, 'binary_specificity': 0.8652174, 'binary_f1_score': 0.84000003}
confusion matrix:
     0    1
0  199   31
1   41  189
early stop counter: 1
val acc:0.8023166060447693, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.865217387676239 / 0.865217387676239
after epoch: 3,now: 2024-07-26 04:44:35.827582,epoch time: 0:02:45.351534,used: 0:08:19.143252,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9749944, 'recall': 0.97460705, 'specificity': 0.97460705, 'f1': 0.97447336, 'auroc': 0.9980426, 'binary_precision': 0.9925826, 'binary_recall': 0.95646524, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.97418934}
confusion matrix:
      0     1
0  1506    11
1    67  1472
---- Validation: 
scalar performance:
{'acc': 0.7104247, 'precision': 0.794482, 'recall': 0.7077209, 'specificity': 0.7077209, 'f1': 0.6864631, 'auroc': 0.91560817, 'binary_precision': 0.9493243, 'binary_recall': 0.43837753, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.5997865}
confusion matrix:
     0    1
0  639   15
1  360  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5304348, 'precision': 0.68295455, 'recall': 0.5304348, 'specificity': 0.5304348, 'f1': 0.406806, 'auroc': 0.9174716, 'binary_precision': 0.85, 'binary_recall': 0.073913045, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.136}
confusion matrix:
     0   1
0  227   3
1  213  17
early stop counter: 2
val acc:0.7104247212409973, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.865217387676239 / 0.865217387676239
after epoch: 4,now: 2024-07-26 04:47:21.506070,epoch time: 0:02:45.678488,used: 0:11:04.821740,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.9773042, 'recall': 0.9765887, 'specificity': 0.9765887, 'f1': 0.9764335, 'auroc': 0.9986242, 'binary_precision': 0.9993188, 'binary_recall': 0.95383614, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.97604793}
confusion matrix:
      0     1
0  1517     1
1    71  1467
---- Validation: 
scalar performance:
{'acc': 0.75752896, 'precision': 0.81434685, 'recall': 0.7553803, 'specificity': 0.7553803, 'f1': 0.74500453, 'auroc': 0.91347855, 'binary_precision': 0.94550407, 'binary_recall': 0.54134166, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.68849206}
confusion matrix:
     0    1
0  634   20
1  294  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82173914, 'precision': 0.86117476, 'recall': 0.82173914, 'specificity': 0.82173914, 'f1': 0.81673664, 'auroc': 0.9258412, 'binary_precision': 0.9805195, 'binary_recall': 0.65652174, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.7864584}
confusion matrix:
     0    1
0  227    3
1   79  151
early stop counter: 3
val acc:0.7575289607048035, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.865217387676239 / 0.865217387676239
after epoch: 5,now: 2024-07-26 04:50:07.467426,epoch time: 0:02:45.961356,used: 0:13:50.783096,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9869161, 'recall': 0.9869361, 'specificity': 0.9869361, 'f1': 0.98691094, 'auroc': 0.9993143, 'binary_precision': 0.9908257, 'binary_recall': 0.98309493, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.9869452}
confusion matrix:
      0     1
0  1504    14
1    26  1512
---- Validation: 
scalar performance:
{'acc': 0.7297297, 'precision': 0.782894, 'recall': 0.7275318, 'specificity': 0.7275318, 'f1': 0.71514773, 'auroc': 0.8846508, 'binary_precision': 0.9030471, 'binary_recall': 0.5085803, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.65069854}
confusion matrix:
     0    1
0  619   35
1  315  326
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76086956, 'precision': 0.83465904, 'recall': 0.7608696, 'specificity': 0.7608696, 'f1': 0.74691904, 'auroc': 0.9170321, 'binary_precision': 0.9918033, 'binary_recall': 0.526087, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.68750006}
confusion matrix:
     0    1
0  229    1
1  109  121
early stop counter: 4
val acc:0.7297297120094299, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.865217387676239 / 0.865217387676239
after epoch: 6,now: 2024-07-26 04:52:53.538402,epoch time: 0:02:46.070976,used: 0:16:36.854072,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.9781896, 'recall': 0.97803, 'specificity': 0.97803, 'f1': 0.9780719, 'auroc': 0.9976759, 'binary_precision': 0.9724005, 'binary_recall': 0.98440546, 'binary_specificity': 0.9716546, 'binary_f1_score': 0.97836614}
confusion matrix:
      0     1
0  1474    43
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.7984556, 'precision': 0.8217944, 'recall': 0.7970941, 'specificity': 0.7970941, 'f1': 0.7942103, 'auroc': 0.90677315, 'binary_precision': 0.9059829, 'binary_recall': 0.6614665, 'binary_specificity': 0.93272173, 'binary_f1_score': 0.76465285}
confusion matrix:
     0    1
0  610   44
1  217  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82391304, 'precision': 0.8484211, 'recall': 0.82391304, 'specificity': 0.82391304, 'f1': 0.8207611, 'auroc': 0.90279776, 'binary_precision': 0.9408284, 'binary_recall': 0.6913043, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.7969924}
confusion matrix:
     0    1
0  220   10
1   71  159
early stop counter: 5
val acc:0.7984555959701538, best validation acc: 0.8540540337562561, corresponding to test acc:                         0.865217387676239 / 0.865217387676239
after epoch: 7,now: 2024-07-26 04:55:38.674545,epoch time: 0:02:45.136143,used: 0:19:21.990215,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_36_16_seed_9_23064723
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:21.990215 at 2024-07-26 04:55:38.674545
persisted model performance metric: 

scalar performance:
{'acc': 0.8652174, 'precision': 0.8662143, 'recall': 0.86521745, 'specificity': 0.86521745, 'f1': 0.8651256, 'auroc': 0.9335161, 'binary_precision': 0.8471074, 'binary_recall': 0.8913044, 'binary_specificity': 0.83913046, 'binary_f1_score': 0.86864406}
confusion matrix:
     0    1
0  193   37
1   25  205
oracle model performance metric: 

scalar performance:
{'acc': 0.8652174, 'precision': 0.8662143, 'recall': 0.86521745, 'specificity': 0.86521745, 'f1': 0.8651256, 'auroc': 0.9335161, 'binary_precision': 0.8471074, 'binary_recall': 0.8913044, 'binary_specificity': 0.83913046, 'binary_f1_score': 0.86864406}
confusion matrix:
     0    1
0  193   37
1   25  205
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8916 MiB | 659622 GiB | 659620 GiB |
|       from large pool |   2302 MiB |   8840 MiB | 653847 GiB | 653845 GiB |
|       from small pool |     91 MiB |    132 MiB |   5775 GiB |   5775 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8916 MiB | 659622 GiB | 659620 GiB |
|       from large pool |   2302 MiB |   8840 MiB | 653847 GiB | 653845 GiB |
|       from small pool |     91 MiB |    132 MiB |   5775 GiB |   5775 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 658748 GiB | 658746 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 652981 GiB | 652979 GiB |
|       from small pool |     91 MiB |    132 MiB |   5766 GiB |   5766 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9738 MiB |   9824 MiB |  66282 MiB |  56544 MiB |
|       from large pool |   9602 MiB |   9688 MiB |  65830 MiB |  56228 MiB |
|       from small pool |    136 MiB |    140 MiB |    452 MiB |    316 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    971 MiB |   1825 MiB | 481006 GiB | 481005 GiB |
|       from large pool |    963 MiB |   1820 MiB | 475066 GiB | 475066 GiB |
|       from small pool |      8 MiB |     60 MiB |   5939 GiB |   5939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   93851 K  |   93849 K  |
|       from large pool |     392    |     816    |   47119 K  |   47119 K  |
|       from small pool |    2084    |    2780    |   46732 K  |   46730 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   93851 K  |   93849 K  |
|       from large pool |     392    |     816    |   47119 K  |   47119 K  |
|       from small pool |    2084    |    2780    |   46732 K  |   46730 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     333    |    1709    |    1424    |
|       from large pool |     217    |     265    |    1483    |    1266    |
|       from small pool |      68    |      70    |     226    |     158    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     137    |     320    |   51671 K  |   51670 K  |
|       from large pool |      69    |     255    |   27603 K  |   27603 K  |
|       from small pool |      68    |     226    |   24067 K  |   24066 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8916 MiB | 659622 GiB | 659622 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 653847 GiB | 653847 GiB |
|       from small pool |      0 KiB |    132 MiB |   5775 GiB |   5775 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8916 MiB | 659622 GiB | 659622 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 653847 GiB | 653847 GiB |
|       from small pool |      0 KiB |    132 MiB |   5775 GiB |   5775 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 658748 GiB | 658748 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 652981 GiB | 652981 GiB |
|       from small pool |      0 KiB |    132 MiB |   5766 GiB |   5766 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3366 MiB |   9824 MiB |  66282 MiB |  62916 MiB |
|       from large pool |   3266 MiB |   9688 MiB |  65830 MiB |  62564 MiB |
|       from small pool |    100 MiB |    140 MiB |    452 MiB |    352 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1825 MiB | 481007 GiB | 481007 GiB |
|       from large pool |  24320 KiB |   1820 MiB | 475067 GiB | 475067 GiB |
|       from small pool |      0 KiB |     60 MiB |   5939 GiB |   5939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   93851 K  |   93851 K  |
|       from large pool |       2    |     816    |   47119 K  |   47119 K  |
|       from small pool |       0    |    2780    |   46732 K  |   46732 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   93851 K  |   93851 K  |
|       from large pool |       2    |     816    |   47119 K  |   47119 K  |
|       from small pool |       0    |    2780    |   46732 K  |   46732 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     333    |    1709    |    1581    |
|       from large pool |      78    |     265    |    1483    |    1405    |
|       from small pool |      50    |      70    |     226    |     176    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     320    |   51671 K  |   51671 K  |
|       from large pool |       3    |     255    |   27604 K  |   27604 K  |
|       from small pool |       0    |     226    |   24067 K  |   24067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 04:55:50 2024]
Finished job 0.
1 of 1 steps (100%) done
