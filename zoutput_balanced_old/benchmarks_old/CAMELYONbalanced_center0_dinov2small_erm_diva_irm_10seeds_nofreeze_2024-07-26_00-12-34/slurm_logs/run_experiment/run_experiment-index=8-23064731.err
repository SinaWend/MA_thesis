Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:23:14 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731

 Experiment start at: 2024-07-26 00:23:46.544240
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9280599, 'precision': 0.93230647, 'recall': 0.9274968, 'specificity': 0.9274968, 'f1': 0.9278093, 'auroc': 0.99099016, 'binary_precision': 0.8922896, 'binary_recall': 0.97554696, 'binary_specificity': 0.8794466, 'binary_f1_score': 0.93206275}
confusion matrix:
      0     1
0  1335   183
1    38  1516
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.7946073, 'recall': 0.7443935, 'specificity': 0.7443935, 'f1': 0.73073936, 'auroc': 0.9111599, 'binary_precision': 0.6659341, 'binary_recall': 0.9543307, 'binary_specificity': 0.5344564, 'binary_f1_score': 0.784466}
confusion matrix:
     0    1
0  349  304
1   29  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7627907, 'precision': 0.78834057, 'recall': 0.7627907, 'specificity': 0.7627907, 'f1': 0.75741684, 'auroc': 0.90321255, 'binary_precision': 0.702509, 'binary_recall': 0.9116279, 'binary_specificity': 0.6139535, 'binary_f1_score': 0.79352224}
confusion matrix:
     0    1
0  132   83
1   19  196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:26:36.165940,epoch time: 0:02:49.621700,used: 0:02:49.621700,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9511719, 'precision': 0.9513781, 'recall': 0.9510597, 'specificity': 0.9510597, 'f1': 0.95115066, 'auroc': 0.9929091, 'binary_precision': 0.94433904, 'binary_recall': 0.9601286, 'binary_specificity': 0.9419908, 'binary_f1_score': 0.9521684}
confusion matrix:
      0     1
0  1429    88
1    62  1493
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.78814065, 'recall': 0.7412222, 'specificity': 0.7412222, 'f1': 0.7280253, 'auroc': 0.8465495, 'binary_precision': 0.664823, 'binary_recall': 0.9464567, 'binary_specificity': 0.53598773, 'binary_f1_score': 0.7810266}
confusion matrix:
     0    1
0  350  303
1   34  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.7803651, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.7145548, 'auroc': 0.8557707, 'binary_precision': 0.65909094, 'binary_recall': 0.94418603, 'binary_specificity': 0.5116279, 'binary_f1_score': 0.7762906}
confusion matrix:
     0    1
0  110  105
1   12  203
early stop counter: 1
val acc:0.7383540272712708, best validation acc: 0.7414596080780029, corresponding to test acc:                         0.7627906799316406 / 0.7627906799316406
after epoch: 2,now: 2024-07-26 00:29:23.959060,epoch time: 0:02:47.793120,used: 0:05:37.414820,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.97162414, 'recall': 0.9712993, 'specificity': 0.9712993, 'f1': 0.9710268, 'auroc': 0.9956527, 'binary_precision': 0.9919517, 'binary_recall': 0.95051414, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.970791}
confusion matrix:
      0     1
0  1504    12
1    77  1479
---- Validation: 
scalar performance:
{'acc': 0.70574534, 'precision': 0.70568657, 'recall': 0.70565534, 'specificity': 0.70565534, 'f1': 0.7056671, 'auroc': 0.773238, 'binary_precision': 0.70253164, 'binary_recall': 0.6992126, 'binary_specificity': 0.712098, 'binary_f1_score': 0.7008682}
confusion matrix:
     0    1
0  465  188
1  191  444
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.754038, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.75335497, 'auroc': 0.83348835, 'binary_precision': 0.76585364, 'binary_recall': 0.73023254, 'binary_specificity': 0.7767442, 'binary_f1_score': 0.74761903}
confusion matrix:
     0    1
0  167   48
1   58  157
early stop counter: 2
val acc:0.7057453393936157, best validation acc: 0.7414596080780029, corresponding to test acc:                         0.7627906799316406 / 0.7627906799316406
after epoch: 3,now: 2024-07-26 00:32:11.502518,epoch time: 0:02:47.543458,used: 0:08:24.958278,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95377606, 'precision': 0.95485234, 'recall': 0.9541073, 'specificity': 0.9541073, 'f1': 0.95376563, 'auroc': 0.99417496, 'binary_precision': 0.9802855, 'binary_recall': 0.9273312, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.9530733}
confusion matrix:
      0     1
0  1488    29
1   113  1442
---- Validation: 
scalar performance:
{'acc': 0.78493786, 'precision': 0.78754556, 'recall': 0.78557956, 'specificity': 0.78557956, 'f1': 0.784675, 'auroc': 0.8490987, 'binary_precision': 0.756447, 'binary_recall': 0.83149606, 'binary_specificity': 0.73966306, 'binary_f1_score': 0.79219806}
confusion matrix:
     0    1
0  483  170
1  107  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.81542265, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.79478765, 'auroc': 0.9085127, 'binary_precision': 0.7406015, 'binary_recall': 0.9162791, 'binary_specificity': 0.67906976, 'binary_f1_score': 0.8191268}
confusion matrix:
     0    1
0  146   69
1   18  197
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 00:35:00.370853,epoch time: 0:02:48.868335,used: 0:11:13.826613,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97442234, 'recall': 0.9739378, 'specificity': 0.9739378, 'f1': 0.9736298, 'auroc': 0.9977642, 'binary_precision': 0.9973028, 'binary_recall': 0.95051414, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.97334653}
confusion matrix:
      0     1
0  1512     4
1    77  1479
---- Validation: 
scalar performance:
{'acc': 0.8253106, 'precision': 0.84710956, 'recall': 0.82355094, 'specificity': 0.82355094, 'f1': 0.8219481, 'auroc': 0.9167428, 'binary_precision': 0.9306723, 'binary_recall': 0.6976378, 'binary_specificity': 0.949464, 'binary_f1_score': 0.79747975}
confusion matrix:
     0    1
0  620   33
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.85519826, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.82719606, 'auroc': 0.9126879, 'binary_precision': 0.9493671, 'binary_recall': 0.6976744, 'binary_specificity': 0.96279067, 'binary_f1_score': 0.80428946}
confusion matrix:
     0    1
0  207    8
1   65  150
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 00:37:48.333764,epoch time: 0:02:47.962911,used: 0:14:01.789524,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9770367, 'recall': 0.9767947, 'specificity': 0.9767947, 'f1': 0.9768783, 'auroc': 0.9971185, 'binary_precision': 0.9714648, 'binary_recall': 0.98331195, 'binary_specificity': 0.9702774, 'binary_f1_score': 0.97735244}
confusion matrix:
      0     1
0  1469    45
1    26  1532
---- Validation: 
scalar performance:
{'acc': 0.85481364, 'precision': 0.8597566, 'recall': 0.85399306, 'specificity': 0.85399306, 'f1': 0.8540853, 'auroc': 0.92605424, 'binary_precision': 0.8985765, 'binary_recall': 0.79527557, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.8437761}
confusion matrix:
     0    1
0  596   57
1  130  505
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8455132, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81500274, 'auroc': 0.91042185, 'binary_precision': 0.9419355, 'binary_recall': 0.67906976, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.78918916}
confusion matrix:
     0    1
0  206    9
1   69  146
better model found
persisted
after epoch: 6,now: 2024-07-26 00:40:35.963965,epoch time: 0:02:47.630201,used: 0:16:49.419725,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9667969, 'precision': 0.9678513, 'recall': 0.96650577, 'specificity': 0.96650577, 'f1': 0.9667573, 'auroc': 0.9961257, 'binary_precision': 0.94879705, 'binary_recall': 0.987797, 'binary_specificity': 0.9452145, 'binary_f1_score': 0.9679044}
confusion matrix:
      0     1
0  1432    83
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.78493786, 'precision': 0.8020462, 'recall': 0.786578, 'specificity': 0.786578, 'f1': 0.7824768, 'auroc': 0.8910998, 'binary_precision': 0.7265823, 'binary_recall': 0.903937, 'binary_specificity': 0.669219, 'binary_f1_score': 0.805614}
confusion matrix:
     0    1
0  437  216
1   61  574
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.8103069, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.74166274, 'auroc': 0.92718226, 'binary_precision': 0.67752445, 'binary_recall': 0.96744186, 'binary_specificity': 0.53953487, 'binary_f1_score': 0.79693484}
confusion matrix:
     0    1
0  116   99
1    7  208
early stop counter: 1
val acc:0.784937858581543, best validation acc: 0.8548136353492737, corresponding to test acc:                         0.8186046481132507 / 0.830232560634613
after epoch: 7,now: 2024-07-26 00:43:22.204186,epoch time: 0:02:46.240221,used: 0:19:35.659946,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.984705, 'recall': 0.984787, 'specificity': 0.984787, 'f1': 0.98469996, 'auroc': 0.9989011, 'binary_precision': 0.99153095, 'binary_recall': 0.9781491, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9847946}
confusion matrix:
      0     1
0  1503    13
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.5993789, 'precision': 0.7438373, 'recall': 0.59391785, 'specificity': 0.59391785, 'f1': 0.5234924, 'auroc': 0.873109, 'binary_precision': 0.92805755, 'binary_recall': 0.2031496, 'binary_specificity': 0.9846861, 'binary_f1_score': 0.33333334}
confusion matrix:
     0    1
0  643   10
1  506  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5093023, 'precision': 0.62736964, 'recall': 0.5093023, 'specificity': 0.5093023, 'f1': 0.36128575, 'auroc': 0.9030827, 'binary_precision': 0.75, 'binary_recall': 0.027906977, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.053811662}
confusion matrix:
     0  1
0  213  2
1  209  6
early stop counter: 2
val acc:0.5993788838386536, best validation acc: 0.8548136353492737, corresponding to test acc:                         0.8186046481132507 / 0.830232560634613
after epoch: 8,now: 2024-07-26 00:46:08.564714,epoch time: 0:02:46.360528,used: 0:22:22.020474,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.98534524, 'recall': 0.98535335, 'specificity': 0.98535335, 'f1': 0.9853492, 'auroc': 0.9992323, 'binary_precision': 0.98585206, 'binary_recall': 0.9852185, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.98553526}
confusion matrix:
      0     1
0  1494    22
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.8206522, 'precision': 0.8293999, 'recall': 0.8194994, 'specificity': 0.8194994, 'f1': 0.8190553, 'auroc': 0.9039081, 'binary_precision': 0.87969923, 'binary_recall': 0.73700786, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.80205655}
confusion matrix:
     0    1
0  589   64
1  167  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8728676, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.838503, 'auroc': 0.93250406, 'binary_precision': 0.98039216, 'binary_recall': 0.6976744, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.81521744}
confusion matrix:
     0    1
0  212    3
1   65  150
new oracle model saved
early stop counter: 3
val acc:0.820652186870575, best validation acc: 0.8548136353492737, corresponding to test acc:                         0.8186046481132507 / 0.8418604731559753
after epoch: 9,now: 2024-07-26 00:48:55.448416,epoch time: 0:02:46.883702,used: 0:25:08.904176,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9785156, 'precision': 0.97895825, 'recall': 0.9787698, 'specificity': 0.9787698, 'f1': 0.978515, 'auroc': 0.99822915, 'binary_precision': 0.99733156, 'binary_recall': 0.9601798, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9784031}
confusion matrix:
      0     1
0  1511     4
1    62  1495
---- Validation: 
scalar performance:
{'acc': 0.8299689, 'precision': 0.82999384, 'recall': 0.8300551, 'specificity': 0.8300551, 'f1': 0.8299639, 'auroc': 0.8795047, 'binary_precision': 0.82198143, 'binary_recall': 0.83622044, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.82903975}
confusion matrix:
     0    1
0  538  115
1  104  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83488375, 'precision': 0.83489096, 'recall': 0.8348837, 'specificity': 0.8348837, 'f1': 0.83488286, 'auroc': 0.9144835, 'binary_precision': 0.8333333, 'binary_recall': 0.8372093, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.8352668}
confusion matrix:
     0    1
0  179   36
1   35  180
early stop counter: 4
val acc:0.8299689292907715, best validation acc: 0.8548136353492737, corresponding to test acc:                         0.8186046481132507 / 0.8418604731559753
after epoch: 10,now: 2024-07-26 00:51:42.079340,epoch time: 0:02:46.630924,used: 0:27:55.535100,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9866536, 'recall': 0.98674464, 'specificity': 0.98674464, 'f1': 0.98665303, 'auroc': 0.99942344, 'binary_precision': 0.99348956, 'binary_recall': 0.9800899, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9867443}
confusion matrix:
      0     1
0  1505    10
1    31  1526
---- Validation: 
scalar performance:
{'acc': 0.8121118, 'precision': 0.81461155, 'recall': 0.8114674, 'specificity': 0.8114674, 'f1': 0.8114896, 'auroc': 0.8924866, 'binary_precision': 0.83937824, 'binary_recall': 0.76535434, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.800659}
confusion matrix:
     0    1
0  560   93
1  149  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.83732605, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8371953, 'auroc': 0.90738773, 'binary_precision': 0.8436019, 'binary_recall': 0.82790697, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8356808}
confusion matrix:
     0    1
0  182   33
1   37  178
early stop counter: 5
val acc:0.8121117949485779, best validation acc: 0.8548136353492737, corresponding to test acc:                         0.8186046481132507 / 0.8418604731559753
after epoch: 11,now: 2024-07-26 00:54:28.532885,epoch time: 0:02:46.453545,used: 0:30:41.988645,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_23_46_seed_0_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:30:41.988645 at 2024-07-26 00:54:28.532885
persisted model performance metric: 

scalar performance:
{'acc': 0.81860465, 'precision': 0.8455132, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81500274, 'auroc': 0.91042185, 'binary_precision': 0.9419355, 'binary_recall': 0.67906976, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.78918916}
confusion matrix:
     0    1
0  206    9
1   69  146
oracle model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.8728676, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.838503, 'auroc': 0.93250406, 'binary_precision': 0.98039216, 'binary_recall': 0.6976744, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.81521744}
confusion matrix:
     0    1
0  212    3
1   65  150
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2389 MiB |   8910 MiB |  73469 GiB |  73467 GiB |
|       from large pool |   2297 MiB |   8834 MiB |  72828 GiB |  72825 GiB |
|       from small pool |     91 MiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2389 MiB |   8910 MiB |  73469 GiB |  73467 GiB |
|       from large pool |   2297 MiB |   8834 MiB |  72828 GiB |  72825 GiB |
|       from small pool |     91 MiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB |  73332 GiB |  73330 GiB |
|       from large pool |   2284 MiB |   8826 MiB |  72691 GiB |  72689 GiB |
|       from small pool |     91 MiB |    128 MiB |    640 GiB |    640 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9824 MiB |   9824 MiB |   9824 MiB |      0 B   |
|       from large pool |   9688 MiB |   9688 MiB |   9688 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1060 MiB |   1215 MiB |  45481 GiB |  45480 GiB |
|       from large pool |   1048 MiB |   1200 MiB |  44821 GiB |  44820 GiB |
|       from small pool |     12 MiB |     22 MiB |    659 GiB |    659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   10439 K  |   10437 K  |
|       from large pool |     392    |     816    |    5243 K  |    5243 K  |
|       from small pool |    2072    |    2768    |    5195 K  |    5193 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   10439 K  |   10437 K  |
|       from large pool |     392    |     816    |    5243 K  |    5243 K  |
|       from small pool |    2072    |    2768    |    5195 K  |    5193 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     333    |     333    |     333    |       0    |
|       from large pool |     265    |     265    |     265    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     151    |     319    |    6048 K  |    6047 K  |
|       from large pool |      82    |     255    |    3407 K  |    3407 K  |
|       from small pool |      69    |     226    |    2640 K  |    2640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8910 MiB |  73469 GiB |  73469 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  72828 GiB |  72828 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8910 MiB |  73469 GiB |  73469 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  72828 GiB |  72828 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |  73332 GiB |  73332 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  72691 GiB |  72691 GiB |
|       from small pool |      0 KiB |    128 MiB |    640 GiB |    640 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3450 MiB |   9824 MiB |   9824 MiB |   6374 MiB |
|       from large pool |   3346 MiB |   9688 MiB |   9688 MiB |   6342 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1215 MiB |  45482 GiB |  45482 GiB |
|       from large pool |  24320 KiB |   1200 MiB |  44822 GiB |  44822 GiB |
|       from small pool |      0 KiB |     62 MiB |    659 GiB |    659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   10439 K  |   10439 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5195 K  |    5195 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   10439 K  |   10439 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5195 K  |    5195 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     333    |     333    |     198    |
|       from large pool |      83    |     265    |     265    |     182    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |    6048 K  |    6048 K  |
|       from large pool |       3    |     255    |    3407 K  |    3407 K  |
|       from small pool |       0    |     226    |    2640 K  |    2640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8910 MiB |  73469 GiB |  73469 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  72828 GiB |  72828 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8910 MiB |  73469 GiB |  73469 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  72828 GiB |  72828 GiB |
|       from small pool |      0 KiB |    129 MiB |    641 GiB |    641 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |  73332 GiB |  73332 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  72691 GiB |  72691 GiB |
|       from small pool |      0 KiB |    128 MiB |    640 GiB |    640 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3450 MiB |   9824 MiB |   9824 MiB |   6374 MiB |
|       from large pool |   3346 MiB |   9688 MiB |   9688 MiB |   6342 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1215 MiB |  45482 GiB |  45482 GiB |
|       from large pool |  24320 KiB |   1200 MiB |  44822 GiB |  44822 GiB |
|       from small pool |      0 KiB |     62 MiB |    659 GiB |    659 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   10439 K  |   10439 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5195 K  |    5195 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   10439 K  |   10439 K  |
|       from large pool |       2    |     816    |    5243 K  |    5243 K  |
|       from small pool |       0    |    2768    |    5195 K  |    5195 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     333    |     333    |     198    |
|       from large pool |      83    |     265    |     265    |     182    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |    6048 K  |    6048 K  |
|       from large pool |       3    |     255    |    3407 K  |    3407 K  |
|       from small pool |       0    |     226    |    2640 K  |    2640 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731

 Experiment start at: 2024-07-26 00:55:03.080341
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.91755843, 'recall': 0.9054853, 'specificity': 0.9054853, 'f1': 0.9057759, 'auroc': 0.99123216, 'binary_precision': 0.8531702, 'binary_recall': 0.985228, 'binary_specificity': 0.8257426, 'binary_f1_score': 0.914456}
confusion matrix:
      0     1
0  1251   264
1    23  1534
---- Validation: 
scalar performance:
{'acc': 0.7494145, 'precision': 0.7956215, 'recall': 0.75261134, 'specificity': 0.75261134, 'f1': 0.74076426, 'auroc': 0.88693345, 'binary_precision': 0.6745763, 'binary_recall': 0.947619, 'binary_specificity': 0.55760366, 'binary_f1_score': 0.78811884}
confusion matrix:
     0    1
0  363  288
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.80753744, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78828406, 'auroc': 0.8971457, 'binary_precision': 0.7364621, 'binary_recall': 0.9066667, 'binary_specificity': 0.6755555, 'binary_f1_score': 0.812749}
confusion matrix:
     0    1
0  152   73
1   21  204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:57:51.099055,epoch time: 0:02:48.018714,used: 0:02:48.018714,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.9639746, 'recall': 0.96379733, 'specificity': 0.96379733, 'f1': 0.96385646, 'auroc': 0.9946604, 'binary_precision': 0.9592616, 'binary_recall': 0.9697555, 'binary_specificity': 0.95783925, 'binary_f1_score': 0.96448}
confusion matrix:
      0     1
0  1454    64
1    47  1507
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8053887, 'recall': 0.8016641, 'specificity': 0.8016641, 'f1': 0.80168545, 'auroc': 0.8837539, 'binary_precision': 0.831283, 'binary_recall': 0.75079364, 'binary_specificity': 0.85253453, 'binary_f1_score': 0.78899086}
confusion matrix:
     0    1
0  555   96
1  157  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.8067168, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.791054, 'auroc': 0.90488887, 'binary_precision': 0.74264705, 'binary_recall': 0.8977778, 'binary_specificity': 0.6888889, 'binary_f1_score': 0.81287724}
confusion matrix:
     0    1
0  155   70
1   23  202
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:00:41.900853,epoch time: 0:02:50.801798,used: 0:05:38.820512,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.973433, 'recall': 0.9732307, 'specificity': 0.9732307, 'f1': 0.97329843, 'auroc': 0.9972589, 'binary_precision': 0.9682136, 'binary_recall': 0.9794212, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.97378516}
confusion matrix:
      0     1
0  1467    50
1    32  1523
---- Validation: 
scalar performance:
{'acc': 0.8376269, 'precision': 0.8558481, 'recall': 0.8357655, 'specificity': 0.8357655, 'f1': 0.8349546, 'auroc': 0.9112574, 'binary_precision': 0.93237704, 'binary_recall': 0.7222222, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.8139535}
confusion matrix:
     0    1
0  618   33
1  175  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.8322445, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.78709984, 'auroc': 0.88213336, 'binary_precision': 0.9459459, 'binary_recall': 0.62222224, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.75067025}
confusion matrix:
     0    1
0  217    8
1   85  140
better model found
persisted
after epoch: 3,now: 2024-07-26 01:03:31.287534,epoch time: 0:02:49.386681,used: 0:08:28.207193,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9550781, 'precision': 0.95820713, 'recall': 0.95574087, 'specificity': 0.95574087, 'f1': 0.95503783, 'auroc': 0.9983694, 'binary_precision': 1.0, 'binary_recall': 0.91148174, 'binary_specificity': 1.0, 'binary_f1_score': 0.9536913}
confusion matrix:
      0     1
0  1513     0
1   138  1421
---- Validation: 
scalar performance:
{'acc': 0.7298985, 'precision': 0.80121946, 'recall': 0.7258577, 'specificity': 0.7258577, 'f1': 0.7105746, 'auroc': 0.91858184, 'binary_precision': 0.94375, 'binary_recall': 0.47936508, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.63578945}
confusion matrix:
     0    1
0  633   18
1  328  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60888886, 'precision': 0.78054863, 'recall': 0.60888886, 'specificity': 0.60888886, 'f1': 0.538257, 'auroc': 0.91478515, 'binary_precision': 1.0, 'binary_recall': 0.21777777, 'binary_specificity': 1.0, 'binary_f1_score': 0.35766423}
confusion matrix:
     0   1
0  225   0
1  176  49
early stop counter: 1
val acc:0.7298985123634338, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.7933333516120911 / 0.7933333516120911
after epoch: 4,now: 2024-07-26 01:06:19.780170,epoch time: 0:02:48.492636,used: 0:11:16.699829,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9825283, 'recall': 0.9825561, 'specificity': 0.9825561, 'f1': 0.9824218, 'auroc': 0.9984895, 'binary_precision': 0.99342537, 'binary_recall': 0.9717042, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9824447}
confusion matrix:
      0     1
0  1507    10
1    44  1511
---- Validation: 
scalar performance:
{'acc': 0.7993755, 'precision': 0.8164978, 'recall': 0.7974398, 'specificity': 0.7974398, 'f1': 0.79586446, 'auroc': 0.88892794, 'binary_precision': 0.88612837, 'binary_recall': 0.6793651, 'binary_specificity': 0.9155146, 'binary_f1_score': 0.76909256}
confusion matrix:
     0    1
0  596   55
1  202  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.7989969, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.77106845, 'auroc': 0.87012345, 'binary_precision': 0.88271606, 'binary_recall': 0.63555557, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.7390181}
confusion matrix:
     0    1
0  206   19
1   82  143
early stop counter: 2
val acc:0.7993754744529724, best validation acc: 0.8376268744468689, corresponding to test acc:                         0.7933333516120911 / 0.7933333516120911
after epoch: 5,now: 2024-07-26 01:09:06.459361,epoch time: 0:02:46.679191,used: 0:14:03.379020,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.9714167, 'recall': 0.9708918, 'specificity': 0.9708918, 'f1': 0.9710132, 'auroc': 0.997908, 'binary_precision': 0.96037734, 'binary_recall': 0.9832582, 'binary_specificity': 0.95852536, 'binary_f1_score': 0.9716831}
confusion matrix:
      0     1
0  1456    63
1    26  1527
---- Validation: 
scalar performance:
{'acc': 0.8399688, 'precision': 0.8527309, 'recall': 0.8384025, 'specificity': 0.8384025, 'f1': 0.8380342, 'auroc': 0.909536, 'binary_precision': 0.9158513, 'binary_recall': 0.74285716, 'binary_specificity': 0.9339478, 'binary_f1_score': 0.820333}
confusion matrix:
     0    1
0  608   43
1  162  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.8466945, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82158184, 'auroc': 0.9130667, 'binary_precision': 0.9345238, 'binary_recall': 0.69777775, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.7989822}
confusion matrix:
     0    1
0  214   11
1   68  157
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 01:11:54.792468,epoch time: 0:02:48.333107,used: 0:16:51.712127,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98307294, 'precision': 0.98307866, 'recall': 0.98306227, 'specificity': 0.98306227, 'f1': 0.98307, 'auroc': 0.99864894, 'binary_precision': 0.982659, 'binary_recall': 0.98392284, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.9832905}
confusion matrix:
      0     1
0  1490    27
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.8289937, 'recall': 0.8290578, 'specificity': 0.8290578, 'f1': 0.8290131, 'auroc': 0.8865311, 'binary_precision': 0.82362205, 'binary_recall': 0.8301587, 'binary_specificity': 0.827957, 'binary_f1_score': 0.82687753}
confusion matrix:
     0    1
0  539  112
1  107  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.81896067, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.8021939, 'auroc': 0.8870716, 'binary_precision': 0.75091577, 'binary_recall': 0.9111111, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.82329315}
confusion matrix:
     0    1
0  157   68
1   20  205
early stop counter: 1
val acc:0.8290398120880127, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 7,now: 2024-07-26 01:14:41.395544,epoch time: 0:02:46.603076,used: 0:19:38.315203,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.981418, 'recall': 0.9809894, 'specificity': 0.9809894, 'f1': 0.98111, 'auroc': 0.9989037, 'binary_precision': 0.97225726, 'binary_recall': 0.99100256, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.98154044}
confusion matrix:
      0     1
0  1472    44
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.80640125, 'precision': 0.81119424, 'recall': 0.80739886, 'specificity': 0.80739886, 'f1': 0.80596125, 'auroc': 0.8838783, 'binary_precision': 0.76825845, 'binary_recall': 0.86825395, 'binary_specificity': 0.74654377, 'binary_f1_score': 0.8152012}
confusion matrix:
     0    1
0  486  165
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.75584793, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.66394967, 'auroc': 0.8765235, 'binary_precision': 0.622807, 'binary_recall': 0.94666666, 'binary_specificity': 0.42666668, 'binary_f1_score': 0.75132275}
confusion matrix:
    0    1
0  96  129
1  12  213
early stop counter: 2
val acc:0.806401252746582, best validation acc: 0.8399688005447388, corresponding to test acc:                         0.8244444727897644 / 0.8244444727897644
after epoch: 8,now: 2024-07-26 01:17:32.865518,epoch time: 0:02:51.469974,used: 0:22:29.785177,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873068, 'recall': 0.9872991, 'specificity': 0.9872991, 'f1': 0.9873029, 'auroc': 0.9991182, 'binary_precision': 0.9871383, 'binary_recall': 0.9877735, 'binary_specificity': 0.98682475, 'binary_f1_score': 0.9874558}
confusion matrix:
      0     1
0  1498    20
1    19  1535
---- Validation: 
scalar performance:
{'acc': 0.86260736, 'precision': 0.87519, 'recall': 0.8611111, 'specificity': 0.8611111, 'f1': 0.86106426, 'auroc': 0.92017835, 'binary_precision': 0.93992245, 'binary_recall': 0.76984125, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.8464223}
confusion matrix:
     0    1
0  620   31
1  145  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.85568583, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8432056, 'auroc': 0.9052642, 'binary_precision': 0.9189189, 'binary_recall': 0.75555557, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  210   15
1   55  170
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-26 01:20:21.718149,epoch time: 0:02:48.852631,used: 0:25:18.637808,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9709866, 'recall': 0.9700804, 'specificity': 0.9700804, 'f1': 0.9697182, 'auroc': 0.998618, 'binary_precision': 0.99863577, 'binary_recall': 0.9414791, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.96921545}
confusion matrix:
      0     1
0  1515     2
1    91  1464
---- Validation: 
scalar performance:
{'acc': 0.65495706, 'precision': 0.76665366, 'recall': 0.6495648, 'specificity': 0.6495648, 'f1': 0.6099828, 'auroc': 0.91271245, 'binary_precision': 0.9351852, 'binary_recall': 0.32063493, 'binary_specificity': 0.97849464, 'binary_f1_score': 0.47754136}
confusion matrix:
     0    1
0  637   14
1  428  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.78362226, 'recall': 0.68, 'specificity': 0.68, 'f1': 0.6478337, 'auroc': 0.88084936, 'binary_precision': 0.9550562, 'binary_recall': 0.37777779, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.54140127}
confusion matrix:
     0   1
0  221   4
1  140  85
early stop counter: 1
val acc:0.6549570560455322, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8444444537162781 / 0.8444444537162781
after epoch: 10,now: 2024-07-26 01:23:10.053549,epoch time: 0:02:48.335400,used: 0:28:06.973208,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98535156, 'precision': 0.9854754, 'recall': 0.98551357, 'specificity': 0.98551357, 'f1': 0.98535156, 'auroc': 0.99922377, 'binary_precision': 0.9973684, 'binary_recall': 0.9736673, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9853754}
confusion matrix:
      0     1
0  1511     4
1    41  1516
---- Validation: 
scalar performance:
{'acc': 0.8516784, 'precision': 0.8680738, 'recall': 0.84994876, 'specificity': 0.84994876, 'f1': 0.8495319, 'auroc': 0.9268104, 'binary_precision': 0.9417671, 'binary_recall': 0.74444443, 'binary_specificity': 0.95545316, 'binary_f1_score': 0.83156025}
confusion matrix:
     0    1
0  622   29
1  161  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.8343927, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.781454, 'auroc': 0.89836544, 'binary_precision': 0.9577465, 'binary_recall': 0.60444444, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.7411444}
confusion matrix:
     0    1
0  219    6
1   89  136
early stop counter: 2
val acc:0.8516783714294434, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8444444537162781 / 0.8444444537162781
after epoch: 11,now: 2024-07-26 01:26:02.594620,epoch time: 0:02:52.541071,used: 0:30:59.514279,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.9845028, 'recall': 0.9845176, 'specificity': 0.9845176, 'f1': 0.984375, 'auroc': 0.9986816, 'binary_precision': 0.99605006, 'binary_recall': 0.97299033, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9843852}
confusion matrix:
      0     1
0  1511     6
1    42  1513
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.7906525, 'recall': 0.6923963, 'specificity': 0.6923963, 'f1': 0.6673778, 'auroc': 0.8878459, 'binary_precision': 0.95149255, 'binary_recall': 0.4047619, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.56792873}
confusion matrix:
     0    1
0  638   13
1  375  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59555554, 'precision': 0.7764128, 'recall': 0.59555554, 'specificity': 0.59555554, 'f1': 0.5164604, 'auroc': 0.89817286, 'binary_precision': 1.0, 'binary_recall': 0.19111112, 'binary_specificity': 1.0, 'binary_f1_score': 0.32089555}
confusion matrix:
     0   1
0  225   0
1  182  43
early stop counter: 3
val acc:0.6971116065979004, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8444444537162781 / 0.8444444537162781
after epoch: 12,now: 2024-07-26 01:28:53.829325,epoch time: 0:02:51.234705,used: 0:33:50.748984,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9593099, 'precision': 0.9618902, 'recall': 0.9598587, 'specificity': 0.9598587, 'f1': 0.9592802, 'auroc': 0.99959254, 'binary_precision': 1.0, 'binary_recall': 0.91971743, 'binary_specificity': 1.0, 'binary_f1_score': 0.95818}
confusion matrix:
      0     1
0  1515     0
1   125  1432
---- Validation: 
scalar performance:
{'acc': 0.51990634, 'precision': 0.72770846, 'recall': 0.5119304, 'specificity': 0.5119304, 'f1': 0.36415514, 'auroc': 0.9099042, 'binary_precision': 0.9411765, 'binary_recall': 0.025396826, 'binary_specificity': 0.9984639, 'binary_f1_score': 0.049459044}
confusion matrix:
     0   1
0  650   1
1  614  16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51111114, 'precision': 0.752809, 'recall': 0.51111114, 'specificity': 0.51111114, 'f1': 0.35756, 'auroc': 0.8625976, 'binary_precision': 1.0, 'binary_recall': 0.022222223, 'binary_specificity': 1.0, 'binary_f1_score': 0.043478258}
confusion matrix:
     0  1
0  225  0
1  220  5
early stop counter: 4
val acc:0.5199063420295715, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8444444537162781 / 0.8444444537162781
after epoch: 13,now: 2024-07-26 01:31:41.733473,epoch time: 0:02:47.904148,used: 0:36:38.653132,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99380004, 'recall': 0.9938396, 'specificity': 0.9938396, 'f1': 0.99381465, 'auroc': 0.9998466, 'binary_precision': 0.996119, 'binary_recall': 0.9916291, 'binary_specificity': 0.99605006, 'binary_f1_score': 0.993869}
confusion matrix:
      0     1
0  1513     6
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.765808, 'precision': 0.8163762, 'recall': 0.7624936, 'specificity': 0.7624936, 'f1': 0.7544936, 'auroc': 0.9135646, 'binary_precision': 0.9388298, 'binary_recall': 0.56031746, 'binary_specificity': 0.96466976, 'binary_f1_score': 0.70178926}
confusion matrix:
     0    1
0  628   23
1  277  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.82697254, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7608988, 'auroc': 0.9124148, 'binary_precision': 0.9621212, 'binary_recall': 0.5644444, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7114846}
confusion matrix:
     0    1
0  220    5
1   98  127
early stop counter: 5
val acc:0.7658079862594604, best validation acc: 0.8626073598861694, corresponding to test acc:                         0.8444444537162781 / 0.8444444537162781
after epoch: 14,now: 2024-07-26 01:34:30.328875,epoch time: 0:02:48.595402,used: 0:39:27.248534,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_55_03_seed_1_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 14 with time: 0:39:27.248534 at 2024-07-26 01:34:30.328875
persisted model performance metric: 

scalar performance:
{'acc': 0.84444445, 'precision': 0.85568583, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8432056, 'auroc': 0.9052642, 'binary_precision': 0.9189189, 'binary_recall': 0.75555557, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  210   15
1   55  170
oracle model performance metric: 

scalar performance:
{'acc': 0.84444445, 'precision': 0.85568583, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.8432056, 'auroc': 0.9052642, 'binary_precision': 0.9189189, 'binary_recall': 0.75555557, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.8292683}
confusion matrix:
     0    1
0  210   15
1   55  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2392 MiB |   8913 MiB | 166991 GiB | 166989 GiB |
|       from large pool |   2301 MiB |   8837 MiB | 165529 GiB | 165527 GiB |
|       from small pool |     91 MiB |    132 MiB |   1461 GiB |   1461 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2392 MiB |   8913 MiB | 166991 GiB | 166989 GiB |
|       from large pool |   2301 MiB |   8837 MiB | 165529 GiB | 165527 GiB |
|       from small pool |     91 MiB |    132 MiB |   1461 GiB |   1461 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 166662 GiB | 166659 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 165202 GiB | 165200 GiB |
|       from small pool |     91 MiB |    132 MiB |   1459 GiB |   1459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  16118 MiB |   6374 MiB |
|       from large pool |   9604 MiB |   9688 MiB |  15946 MiB |   6342 MiB |
|       from small pool |    140 MiB |    140 MiB |    172 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1093 MiB |   1656 MiB | 112006 GiB | 112005 GiB |
|       from large pool |   1082 MiB |   1651 MiB | 110503 GiB | 110502 GiB |
|       from small pool |     10 MiB |     62 MiB |   1503 GiB |   1503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   23734 K  |   23732 K  |
|       from large pool |     392    |     816    |   11916 K  |   11916 K  |
|       from small pool |    2084    |    2780    |   11818 K  |   11815 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   23734 K  |   23732 K  |
|       from large pool |     392    |     816    |   11916 K  |   11916 K  |
|       from small pool |    2084    |    2780    |   11818 K  |   11815 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     289    |     333    |     487    |     198    |
|       from large pool |     219    |     265    |     401    |     182    |
|       from small pool |      70    |      70    |      86    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     319    |   13368 K  |   13368 K  |
|       from large pool |      74    |     255    |    7303 K  |    7303 K  |
|       from small pool |      66    |     226    |    6064 K  |    6064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 166991 GiB | 166991 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 165529 GiB | 165529 GiB |
|       from small pool |      0 KiB |    132 MiB |   1461 GiB |   1461 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 166991 GiB | 166991 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 165529 GiB | 165529 GiB |
|       from small pool |      0 KiB |    132 MiB |   1461 GiB |   1461 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 166662 GiB | 166662 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 165202 GiB | 165202 GiB |
|       from small pool |      0 KiB |    132 MiB |   1459 GiB |   1459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3486 MiB |   9824 MiB |  16118 MiB |  12632 MiB |
|       from large pool |   3384 MiB |   9688 MiB |  15946 MiB |  12562 MiB |
|       from small pool |    102 MiB |    140 MiB |    172 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 112007 GiB | 112007 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 110504 GiB | 110504 GiB |
|       from small pool |      0 KiB |     62 MiB |   1503 GiB |   1503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   23734 K  |   23734 K  |
|       from large pool |       2    |     816    |   11916 K  |   11916 K  |
|       from small pool |       0    |    2780    |   11818 K  |   11818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   23734 K  |   23734 K  |
|       from large pool |       2    |     816    |   11916 K  |   11916 K  |
|       from small pool |       0    |    2780    |   11818 K  |   11818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     487    |     353    |
|       from large pool |      83    |     265    |     401    |     318    |
|       from small pool |      51    |      70    |      86    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   13369 K  |   13369 K  |
|       from large pool |       3    |     255    |    7304 K  |    7304 K  |
|       from small pool |       0    |     226    |    6065 K  |    6065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 166991 GiB | 166991 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 165529 GiB | 165529 GiB |
|       from small pool |      0 KiB |    132 MiB |   1461 GiB |   1461 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 166991 GiB | 166991 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 165529 GiB | 165529 GiB |
|       from small pool |      0 KiB |    132 MiB |   1461 GiB |   1461 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 166662 GiB | 166662 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 165202 GiB | 165202 GiB |
|       from small pool |      0 KiB |    132 MiB |   1459 GiB |   1459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3486 MiB |   9824 MiB |  16118 MiB |  12632 MiB |
|       from large pool |   3384 MiB |   9688 MiB |  15946 MiB |  12562 MiB |
|       from small pool |    102 MiB |    140 MiB |    172 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 112007 GiB | 112007 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 110504 GiB | 110504 GiB |
|       from small pool |      0 KiB |     62 MiB |   1503 GiB |   1503 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   23734 K  |   23734 K  |
|       from large pool |       2    |     816    |   11916 K  |   11916 K  |
|       from small pool |       0    |    2780    |   11818 K  |   11818 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   23734 K  |   23734 K  |
|       from large pool |       2    |     816    |   11916 K  |   11916 K  |
|       from small pool |       0    |    2780    |   11818 K  |   11818 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     487    |     353    |
|       from large pool |      83    |     265    |     401    |     318    |
|       from small pool |      51    |      70    |      86    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   13369 K  |   13369 K  |
|       from large pool |       3    |     255    |    7304 K  |    7304 K  |
|       from small pool |       0    |     226    |    6065 K  |    6065 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731

 Experiment start at: 2024-07-26 01:35:05.768031
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.89365184, 'precision': 0.90838784, 'recall': 0.89440346, 'specificity': 0.89440346, 'f1': 0.8928089, 'auroc': 0.9745476, 'binary_precision': 0.9879518, 'binary_recall': 0.7987013, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.88330346}
confusion matrix:
      0     1
0  1501    15
1   310  1230
---- Validation: 
scalar performance:
{'acc': 0.7683881, 'precision': 0.78661644, 'recall': 0.7716404, 'specificity': 0.7716404, 'f1': 0.76596653, 'auroc': 0.8350277, 'binary_precision': 0.70737916, 'binary_recall': 0.8938907, 'binary_specificity': 0.6493902, 'binary_f1_score': 0.78977275}
confusion matrix:
     0    1
0  426  230
1   66  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.80146056, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7981341, 'auroc': 0.8615184, 'binary_precision': 0.7721519, 'binary_recall': 0.8472222, 'binary_specificity': 0.75, 'binary_f1_score': 0.80794704}
confusion matrix:
     0    1
0  162   54
1   33  183
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:37:54.083857,epoch time: 0:02:48.315826,used: 0:02:48.315826,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95909685, 'precision': 0.9600965, 'recall': 0.95929223, 'specificity': 0.95929223, 'f1': 0.9590845, 'auroc': 0.99276376, 'binary_precision': 0.9835954, 'binary_recall': 0.9344156, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.9583749}
confusion matrix:
      0     1
0  1492    24
1   101  1439
---- Validation: 
scalar performance:
{'acc': 0.5610329, 'precision': 0.70360947, 'recall': 0.5494937, 'specificity': 0.5494937, 'f1': 0.45058793, 'auroc': 0.8246167, 'binary_precision': 0.8674699, 'binary_recall': 0.115755625, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.20425531}
confusion matrix:
     0   1
0  645  11
1  550  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6134259, 'precision': 0.7819843, 'recall': 0.6134259, 'specificity': 0.6134259, 'f1': 0.54550666, 'auroc': 0.863083, 'binary_precision': 1.0, 'binary_recall': 0.22685185, 'binary_specificity': 1.0, 'binary_f1_score': 0.36981133}
confusion matrix:
     0   1
0  216   0
1  167  49
early stop counter: 1
val acc:0.5610328912734985, best validation acc: 0.7683880925178528, corresponding to test acc:                         0.7986111044883728 / 0.7986111044883728
after epoch: 2,now: 2024-07-26 01:40:43.102972,epoch time: 0:02:49.019115,used: 0:05:37.334941,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.97268295, 'recall': 0.9724497, 'specificity': 0.9724497, 'f1': 0.9725063, 'auroc': 0.9971113, 'binary_precision': 0.9654732, 'binary_recall': 0.9805195, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.9729381}
confusion matrix:
      0     1
0  1462    54
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.799687, 'precision': 0.8007703, 'recall': 0.7987535, 'specificity': 0.7987535, 'f1': 0.7990492, 'auroc': 0.8665472, 'binary_precision': 0.81335616, 'binary_recall': 0.7636656, 'binary_specificity': 0.83384144, 'binary_f1_score': 0.787728}
confusion matrix:
     0    1
0  547  109
1  147  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8402778, 'precision': 0.8557169, 'recall': 0.8402778, 'specificity': 0.8402778, 'f1': 0.83852565, 'auroc': 0.90826476, 'binary_precision': 0.9298246, 'binary_recall': 0.7361111, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.8217054}
confusion matrix:
     0    1
0  204   12
1   57  159
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 01:43:31.072081,epoch time: 0:02:47.969109,used: 0:08:25.304050,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9617147, 'precision': 0.9630885, 'recall': 0.961941, 'specificity': 0.961941, 'f1': 0.96169734, 'auroc': 0.9951042, 'binary_precision': 0.9903515, 'binary_recall': 0.9331169, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9608827}
confusion matrix:
      0     1
0  1502    14
1   103  1437
---- Validation: 
scalar performance:
{'acc': 0.7167449, 'precision': 0.71676624, 'recall': 0.71691924, 'specificity': 0.71691924, 'f1': 0.71670055, 'auroc': 0.7623887, 'binary_precision': 0.703125, 'binary_recall': 0.72347265, 'binary_specificity': 0.71036583, 'binary_f1_score': 0.7131538}
confusion matrix:
     0    1
0  466  190
1  172  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7523148, 'precision': 0.77917564, 'recall': 0.7523148, 'specificity': 0.7523148, 'f1': 0.7462102, 'auroc': 0.8372557, 'binary_precision': 0.6925795, 'binary_recall': 0.9074074, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.78557116}
confusion matrix:
     0    1
0  129   87
1   20  196
early stop counter: 1
val acc:0.7167448997497559, best validation acc: 0.7996870279312134, corresponding to test acc:                         0.8402777910232544 / 0.8402777910232544
after epoch: 4,now: 2024-07-26 01:46:16.304623,epoch time: 0:02:45.232542,used: 0:11:10.536592,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9322644, 'precision': 0.93935037, 'recall': 0.9317745, 'specificity': 0.9317745, 'f1': 0.93193376, 'auroc': 0.9956069, 'binary_precision': 0.88548297, 'binary_recall': 0.9941558, 'binary_specificity': 0.8693931, 'binary_f1_score': 0.9366779}
confusion matrix:
      0     1
0  1318   198
1     9  1531
---- Validation: 
scalar performance:
{'acc': 0.8176839, 'precision': 0.817587, 'recall': 0.8177839, 'specificity': 0.8177839, 'f1': 0.81762487, 'auroc': 0.88061476, 'binary_precision': 0.807267, 'binary_recall': 0.8215434, 'binary_specificity': 0.8140244, 'binary_f1_score': 0.8143427}
confusion matrix:
     0    1
0  534  122
1  111  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8287037, 'precision': 0.8305173, 'recall': 0.8287037, 'specificity': 0.8287037, 'f1': 0.82846844, 'auroc': 0.9244256, 'binary_precision': 0.855, 'binary_recall': 0.7916667, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.8221154}
confusion matrix:
     0    1
0  187   29
1   45  171
better model found
persisted
after epoch: 5,now: 2024-07-26 01:49:03.272300,epoch time: 0:02:46.967677,used: 0:13:57.504269,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97709423, 'precision': 0.9773265, 'recall': 0.9771956, 'specificity': 0.9771956, 'f1': 0.97709364, 'auroc': 0.9974737, 'binary_precision': 0.99, 'binary_recall': 0.96428573, 'binary_specificity': 0.99010557, 'binary_f1_score': 0.9769737}
confusion matrix:
      0     1
0  1501    15
1    55  1485
---- Validation: 
scalar performance:
{'acc': 0.79264474, 'precision': 0.80773854, 'recall': 0.7896023, 'specificity': 0.7896023, 'f1': 0.78877413, 'auroc': 0.86499345, 'binary_precision': 0.8695652, 'binary_recall': 0.6752412, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.76018095}
confusion matrix:
     0    1
0  593   63
1  202  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7962963, 'precision': 0.84072757, 'recall': 0.7962963, 'specificity': 0.7962963, 'f1': 0.7894317, 'auroc': 0.9216821, 'binary_precision': 0.9637681, 'binary_recall': 0.6157407, 'binary_specificity': 0.9768519, 'binary_f1_score': 0.75141245}
confusion matrix:
     0    1
0  211    5
1   83  133
early stop counter: 1
val acc:0.792644739151001, best validation acc: 0.8176838755607605, corresponding to test acc:                         0.8287037014961243 / 0.8402777910232544
after epoch: 6,now: 2024-07-26 01:51:49.973933,epoch time: 0:02:46.701633,used: 0:16:44.205902,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9689136, 'precision': 0.9696941, 'recall': 0.9687652, 'specificity': 0.9687652, 'f1': 0.96889174, 'auroc': 0.99732935, 'binary_precision': 0.95241076, 'binary_recall': 0.9876623, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.9697163}
confusion matrix:
      0     1
0  1440    76
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.81924886, 'precision': 0.8214738, 'recall': 0.8180584, 'specificity': 0.8180584, 'f1': 0.8184457, 'auroc': 0.87593865, 'binary_precision': 0.8423818, 'binary_recall': 0.7733119, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.8063705}
confusion matrix:
     0    1
0  566   90
1  141  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.7947459, 'recall': 0.79398143, 'specificity': 0.79398143, 'f1': 0.7938478, 'auroc': 0.8825017, 'binary_precision': 0.8097561, 'binary_recall': 0.7685185, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.78859854}
confusion matrix:
     0    1
0  177   39
1   50  166
better model found
persisted
after epoch: 7,now: 2024-07-26 01:54:36.043087,epoch time: 0:02:46.069154,used: 0:19:30.275056,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9610602, 'precision': 0.96274835, 'recall': 0.9608342, 'specificity': 0.9608342, 'f1': 0.9610088, 'auroc': 0.9975487, 'binary_precision': 0.9366933, 'binary_recall': 0.9896104, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.96242505}
confusion matrix:
      0     1
0  1413   103
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.7090632, 'recall': 0.6082047, 'specificity': 0.6082047, 'f1': 0.5601363, 'auroc': 0.77944136, 'binary_precision': 0.84102565, 'binary_recall': 0.2636656, 'binary_specificity': 0.9527439, 'binary_f1_score': 0.40146875}
confusion matrix:
     0    1
0  625   31
1  458  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.5895523, 'recall': 0.5231481, 'specificity': 0.5231481, 'f1': 0.41463417, 'auroc': 0.82801783, 'binary_precision': 0.6666667, 'binary_recall': 0.09259259, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.16260162}
confusion matrix:
     0   1
0  206  10
1  196  20
early stop counter: 1
val acc:0.6173709034919739, best validation acc: 0.8192488551139832, corresponding to test acc:                         0.7939814925193787 / 0.8402777910232544
after epoch: 8,now: 2024-07-26 01:57:21.311501,epoch time: 0:02:45.268414,used: 0:22:15.543470,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97408926, 'recall': 0.97300655, 'specificity': 0.97300655, 'f1': 0.97314626, 'auroc': 0.99822116, 'binary_precision': 0.9550562, 'binary_recall': 0.9935065, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.973902}
confusion matrix:
      0     1
0  1444    72
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.74099225, 'recall': 0.73709416, 'specificity': 0.73709416, 'f1': 0.73704416, 'auroc': 0.80804944, 'binary_precision': 0.7589928, 'binary_recall': 0.6784566, 'binary_specificity': 0.7957317, 'binary_f1_score': 0.7164686}
confusion matrix:
     0    1
0  522  134
1  200  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7476852, 'precision': 0.747818, 'recall': 0.7476852, 'specificity': 0.7476852, 'f1': 0.74765134, 'auroc': 0.81265, 'binary_precision': 0.7535545, 'binary_recall': 0.7361111, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.74473065}
confusion matrix:
     0    1
0  164   52
1   57  159
early stop counter: 2
val acc:0.7386541366577148, best validation acc: 0.8192488551139832, corresponding to test acc:                         0.7939814925193787 / 0.8402777910232544
after epoch: 9,now: 2024-07-26 02:00:06.822395,epoch time: 0:02:45.510894,used: 0:25:01.054364,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9845278, 'recall': 0.984395, 'specificity': 0.984395, 'f1': 0.98429275, 'auroc': 0.99932027, 'binary_precision': 0.99733335, 'binary_recall': 0.9714286, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9842105}
confusion matrix:
      0     1
0  1512     4
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.7674681, 'recall': 0.6355065, 'specificity': 0.6355065, 'f1': 0.5902828, 'auroc': 0.8908468, 'binary_precision': 0.94210523, 'binary_recall': 0.28778136, 'binary_specificity': 0.9832317, 'binary_f1_score': 0.4408867}
confusion matrix:
     0    1
0  645   11
1  443  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5856481, 'precision': 0.7734177, 'recall': 0.5856482, 'specificity': 0.5856482, 'f1': 0.49976385, 'auroc': 0.86968446, 'binary_precision': 1.0, 'binary_recall': 0.1712963, 'binary_specificity': 1.0, 'binary_f1_score': 0.2924901}
confusion matrix:
     0   1
0  216   0
1  179  37
early stop counter: 3
val acc:0.6447574496269226, best validation acc: 0.8192488551139832, corresponding to test acc:                         0.7939814925193787 / 0.8402777910232544
after epoch: 10,now: 2024-07-26 02:02:51.554972,epoch time: 0:02:44.732577,used: 0:27:45.786941,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98232985, 'precision': 0.98272604, 'recall': 0.9824573, 'specificity': 0.9824573, 'f1': 0.98232853, 'auroc': 0.9994376, 'binary_precision': 0.9986577, 'binary_recall': 0.9662338, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9821782}
confusion matrix:
      0     1
0  1514     2
1    52  1488
---- Validation: 
scalar performance:
{'acc': 0.5618153, 'precision': 0.7351783, 'recall': 0.5500476, 'specificity': 0.5500476, 'f1': 0.44616583, 'auroc': 0.85873234, 'binary_precision': 0.9305556, 'binary_recall': 0.107717045, 'binary_specificity': 0.99237806, 'binary_f1_score': 0.19308358}
confusion matrix:
     0   1
0  651   5
1  555  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.52836883, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.3539906, 'auroc': 0.8044195, 'binary_precision': 0.5555556, 'binary_recall': 0.023148147, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.044444446}
confusion matrix:
     0  1
0  212  4
1  211  5
early stop counter: 4
val acc:0.5618153214454651, best validation acc: 0.8192488551139832, corresponding to test acc:                         0.7939814925193787 / 0.8402777910232544
after epoch: 11,now: 2024-07-26 02:05:36.975456,epoch time: 0:02:45.420484,used: 0:30:31.207425,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.9782716, 'recall': 0.97726846, 'specificity': 0.97726846, 'f1': 0.97740483, 'auroc': 0.9991394, 'binary_precision': 0.959975, 'binary_recall': 0.9967533, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9780185}
confusion matrix:
      0     1
0  1452    64
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83322304, 'recall': 0.83319443, 'specificity': 0.83319443, 'f1': 0.8332082, 'auroc': 0.90362763, 'binary_precision': 0.82930756, 'binary_recall': 0.82797426, 'binary_specificity': 0.8384146, 'binary_f1_score': 0.82864034}
confusion matrix:
     0    1
0  550  106
1  107  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8449074, 'precision': 0.8636199, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8428861, 'auroc': 0.9466735, 'binary_precision': 0.9461078, 'binary_recall': 0.7314815, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8250653}
confusion matrix:
     0    1
0  207    9
1   58  158
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-26 02:08:24.381661,epoch time: 0:02:47.406205,used: 0:33:18.613630,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9838456, 'recall': 0.9837354, 'specificity': 0.9837354, 'f1': 0.9836384, 'auroc': 0.9981273, 'binary_precision': 0.9960053, 'binary_recall': 0.9714286, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9835634}
confusion matrix:
      0     1
0  1510     6
1    44  1496
---- Validation: 
scalar performance:
{'acc': 0.71596247, 'precision': 0.7516086, 'recall': 0.7107408, 'specificity': 0.7107408, 'f1': 0.70217234, 'auroc': 0.8240359, 'binary_precision': 0.839895, 'binary_recall': 0.51446944, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.6380858}
confusion matrix:
     0    1
0  595   61
1  302  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7337963, 'precision': 0.7742978, 'recall': 0.7337963, 'specificity': 0.7337963, 'f1': 0.72359306, 'auroc': 0.8502443, 'binary_precision': 0.87969923, 'binary_recall': 0.5416667, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.6704871}
confusion matrix:
     0    1
0  200   16
1   99  117
early stop counter: 1
val acc:0.7159624695777893, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.8449074029922485 / 0.8449074029922485
after epoch: 13,now: 2024-07-26 02:11:11.886621,epoch time: 0:02:47.504960,used: 0:36:06.118590,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9853786, 'recall': 0.98534846, 'specificity': 0.98534846, 'f1': 0.9852748, 'auroc': 0.9985775, 'binary_precision': 0.9947055, 'binary_recall': 0.975974, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9852507}
confusion matrix:
      0     1
0  1508     8
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.7629108, 'precision': 0.79726624, 'recall': 0.75826406, 'specificity': 0.75826406, 'f1': 0.75355554, 'auroc': 0.87444, 'binary_precision': 0.8918919, 'binary_recall': 0.5836013, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.70553935}
confusion matrix:
     0    1
0  612   44
1  259  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.724537, 'precision': 0.76801753, 'recall': 0.724537, 'specificity': 0.724537, 'f1': 0.71289265, 'auroc': 0.84601665, 'binary_precision': 0.875969, 'binary_recall': 0.5231481, 'binary_specificity': 0.9259259, 'binary_f1_score': 0.65507245}
confusion matrix:
     0    1
0  200   16
1  103  113
early stop counter: 2
val acc:0.762910783290863, best validation acc: 0.8333333134651184, corresponding to test acc:                         0.8449074029922485 / 0.8449074029922485
after epoch: 14,now: 2024-07-26 02:13:57.771897,epoch time: 0:02:45.885276,used: 0:38:52.003866,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98932326, 'recall': 0.9891521, 'specificity': 0.9891521, 'f1': 0.9891994, 'auroc': 0.9996637, 'binary_precision': 0.9833226, 'binary_recall': 0.99545455, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9893514}
confusion matrix:
      0     1
0  1490    26
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.8341158, 'precision': 0.8343205, 'recall': 0.833665, 'specificity': 0.833665, 'f1': 0.83386153, 'auroc': 0.8932339, 'binary_precision': 0.83828384, 'binary_recall': 0.81672025, 'binary_specificity': 0.8506098, 'binary_f1_score': 0.8273616}
confusion matrix:
     0    1
0  558   98
1  114  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7893519, 'precision': 0.7904037, 'recall': 0.7893518, 'specificity': 0.7893518, 'f1': 0.78916097, 'auroc': 0.88916755, 'binary_precision': 0.77292573, 'binary_recall': 0.8194444, 'binary_specificity': 0.7592593, 'binary_f1_score': 0.7955056}
confusion matrix:
     0    1
0  164   52
1   39  177
better model found
persisted
after epoch: 15,now: 2024-07-26 02:16:44.019191,epoch time: 0:02:46.247294,used: 0:41:38.251160,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9874598, 'recall': 0.98733765, 'specificity': 0.98733765, 'f1': 0.98723793, 'auroc': 0.9994273, 'binary_precision': 1.0, 'binary_recall': 0.9746753, 'binary_specificity': 1.0, 'binary_f1_score': 0.9871753}
confusion matrix:
      0     1
0  1516     0
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.79577464, 'precision': 0.8213564, 'recall': 0.7919428, 'specificity': 0.7919428, 'f1': 0.79005176, 'auroc': 0.8899008, 'binary_precision': 0.90561795, 'binary_recall': 0.64790994, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.7553889}
confusion matrix:
     0    1
0  614   42
1  219  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.80244654, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.6868894, 'auroc': 0.88258743, 'binary_precision': 0.96907216, 'binary_recall': 0.4351852, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.60063905}
confusion matrix:
     0   1
0  213   3
1  122  94
early stop counter: 1
val acc:0.7957746386528015, best validation acc: 0.8341158032417297, corresponding to test acc:                         0.7893518805503845 / 0.8449074029922485
after epoch: 16,now: 2024-07-26 02:19:30.238578,epoch time: 0:02:46.219387,used: 0:44:24.470547,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9896213, 'recall': 0.98948705, 'specificity': 0.98948705, 'f1': 0.989527, 'auroc': 0.9996128, 'binary_precision': 0.9845758, 'binary_recall': 0.9948052, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.989664}
confusion matrix:
      0     1
0  1492    24
1     8  1532
---- Validation: 
scalar performance:
{'acc': 0.79499215, 'precision': 0.8220872, 'recall': 0.79105556, 'specificity': 0.79105556, 'f1': 0.7889638, 'auroc': 0.86991644, 'binary_precision': 0.90909094, 'binary_recall': 0.6430868, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.75329566}
confusion matrix:
     0    1
0  616   40
1  222  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.81220007, 'recall': 0.7384259, 'specificity': 0.7384259, 'f1': 0.722003, 'auroc': 0.8695345, 'binary_precision': 0.963964, 'binary_recall': 0.49537036, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.6544342}
confusion matrix:
     0    1
0  212    4
1  109  107
early stop counter: 2
val acc:0.7949921488761902, best validation acc: 0.8341158032417297, corresponding to test acc:                         0.7893518805503845 / 0.8449074029922485
after epoch: 17,now: 2024-07-26 02:22:17.257858,epoch time: 0:02:47.019280,used: 0:47:11.489827,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.9925129, 'recall': 0.99245024, 'specificity': 0.99245024, 'f1': 0.99247295, 'auroc': 0.9997053, 'binary_precision': 0.98967075, 'binary_recall': 0.99545455, 'binary_specificity': 0.9894459, 'binary_f1_score': 0.99255425}
confusion matrix:
      0     1
0  1500    16
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.80594677, 'precision': 0.8098799, 'recall': 0.8043511, 'specificity': 0.8043511, 'f1': 0.80465317, 'auroc': 0.864094, 'binary_precision': 0.8387681, 'binary_recall': 0.74437296, 'binary_specificity': 0.8643293, 'binary_f1_score': 0.7887564}
confusion matrix:
     0    1
0  567   89
1  159  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.79056144, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7780937, 'auroc': 0.863726, 'binary_precision': 0.8457143, 'binary_recall': 0.6851852, 'binary_specificity': 0.875, 'binary_f1_score': 0.75703317}
confusion matrix:
     0    1
0  189   27
1   68  148
early stop counter: 3
val acc:0.8059467673301697, best validation acc: 0.8341158032417297, corresponding to test acc:                         0.7893518805503845 / 0.8449074029922485
after epoch: 18,now: 2024-07-26 02:25:03.000316,epoch time: 0:02:45.742458,used: 0:49:57.232285,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9902172, 'recall': 0.990234, 'specificity': 0.990234, 'f1': 0.99018323, 'auroc': 0.99973404, 'binary_precision': 0.99671054, 'binary_recall': 0.98376626, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99019605}
confusion matrix:
      0     1
0  1511     5
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.74804384, 'precision': 0.7863392, 'recall': 0.74303246, 'specificity': 0.74303246, 'f1': 0.7366345, 'auroc': 0.8509333, 'binary_precision': 0.88461536, 'binary_recall': 0.5546624, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.6818182}
confusion matrix:
     0    1
0  611   45
1  277  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6319444, 'precision': 0.7252058, 'recall': 0.6319444, 'specificity': 0.6319444, 'f1': 0.5894395, 'auroc': 0.82499564, 'binary_precision': 0.8701299, 'binary_recall': 0.3101852, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.4573379}
confusion matrix:
     0   1
0  206  10
1  149  67
early stop counter: 4
val acc:0.7480438351631165, best validation acc: 0.8341158032417297, corresponding to test acc:                         0.7893518805503845 / 0.8449074029922485
after epoch: 19,now: 2024-07-26 02:27:49.388252,epoch time: 0:02:46.387936,used: 0:52:43.620221,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.98162603, 'recall': 0.98145753, 'specificity': 0.98145753, 'f1': 0.98134744, 'auroc': 0.997983, 'binary_precision': 0.99532396, 'binary_recall': 0.96753246, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.98123145}
confusion matrix:
      0     1
0  1509     7
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.85680753, 'precision': 0.85872114, 'recall': 0.8558103, 'specificity': 0.8558103, 'f1': 0.8562858, 'auroc': 0.90858316, 'binary_precision': 0.8791019, 'binary_recall': 0.81832796, 'binary_specificity': 0.89329267, 'binary_f1_score': 0.847627}
confusion matrix:
     0    1
0  586   70
1  113  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.80560535, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.8028594, 'auroc': 0.85851765, 'binary_precision': 0.8324873, 'binary_recall': 0.7592593, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.79418886}
confusion matrix:
     0    1
0  183   33
1   52  164
better model found
persisted
after epoch: 20,now: 2024-07-26 02:30:36.852245,epoch time: 0:02:47.463993,used: 0:55:31.084214,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.9809645, 'recall': 0.9805195, 'specificity': 0.9805195, 'f1': 0.9803638, 'auroc': 0.9983592, 'binary_precision': 1.0, 'binary_recall': 0.96103895, 'binary_specificity': 1.0, 'binary_f1_score': 0.98013246}
confusion matrix:
      0     1
0  1516     0
1    60  1480
---- Validation: 
scalar performance:
{'acc': 0.57511735, 'precision': 0.7317747, 'recall': 0.5638381, 'specificity': 0.5638381, 'f1': 0.47370434, 'auroc': 0.7655294, 'binary_precision': 0.9157895, 'binary_recall': 0.13987139, 'binary_specificity': 0.9878049, 'binary_f1_score': 0.24267785}
confusion matrix:
     0   1
0  648   8
1  535  87
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.73943245, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.4765342, 'auroc': 0.88048697, 'binary_precision': 0.9411765, 'binary_recall': 0.14814815, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.256}
confusion matrix:
     0   1
0  214   2
1  184  32
early stop counter: 1
val acc:0.5751173496246338, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8032407164573669 / 0.8449074029922485
after epoch: 21,now: 2024-07-26 02:33:23.446865,epoch time: 0:02:46.594620,used: 0:58:17.678834,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9892298, 'recall': 0.9892497, 'specificity': 0.9892497, 'f1': 0.98920155, 'auroc': 0.9991005, 'binary_precision': 0.99539775, 'binary_recall': 0.98311687, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9892192}
confusion matrix:
      0     1
0  1509     7
1    26  1514
---- Validation: 
scalar performance:
{'acc': 0.6682316, 'precision': 0.7487232, 'recall': 0.66041386, 'specificity': 0.66041386, 'f1': 0.63259923, 'auroc': 0.8389759, 'binary_precision': 0.88372093, 'binary_recall': 0.36655948, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.5181818}
confusion matrix:
     0    1
0  626   30
1  394  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6296296, 'precision': 0.7443439, 'recall': 0.6296296, 'specificity': 0.6296296, 'f1': 0.58037883, 'auroc': 0.87122774, 'binary_precision': 0.9117647, 'binary_recall': 0.28703704, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.4366197}
confusion matrix:
     0   1
0  210   6
1  154  62
early stop counter: 2
val acc:0.6682316064834595, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8032407164573669 / 0.8449074029922485
after epoch: 22,now: 2024-07-26 02:36:09.698999,epoch time: 0:02:46.252134,used: 1:01:03.930968,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9777487, 'precision': 0.97821796, 'recall': 0.9778861, 'specificity': 0.9778861, 'f1': 0.97774655, 'auroc': 0.99810684, 'binary_precision': 0.9952894, 'binary_recall': 0.9603896, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9775281}
confusion matrix:
      0     1
0  1509     7
1    61  1479
---- Validation: 
scalar performance:
{'acc': 0.7363067, 'precision': 0.76288825, 'recall': 0.73189116, 'specificity': 0.73189116, 'f1': 0.7269153, 'auroc': 0.8248569, 'binary_precision': 0.84009546, 'binary_recall': 0.5659164, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.67627287}
confusion matrix:
     0    1
0  589   67
1  270  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.7514391, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.6984167, 'auroc': 0.81138545, 'binary_precision': 0.85271317, 'binary_recall': 0.5092593, 'binary_specificity': 0.912037, 'binary_f1_score': 0.6376811}
confusion matrix:
     0    1
0  197   19
1  106  110
early stop counter: 3
val acc:0.7363067269325256, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8032407164573669 / 0.8449074029922485
after epoch: 23,now: 2024-07-26 02:38:55.566826,epoch time: 0:02:45.867827,used: 1:03:49.798795,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.9835757, 'recall': 0.98285985, 'specificity': 0.98285985, 'f1': 0.9829749, 'auroc': 0.99960124, 'binary_precision': 0.96851385, 'binary_recall': 0.9987013, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.98337597}
confusion matrix:
      0     1
0  1466    50
1     2  1538
---- Validation: 
scalar performance:
{'acc': 0.7691706, 'precision': 0.77652967, 'recall': 0.77123606, 'specificity': 0.77123606, 'f1': 0.768415, 'auroc': 0.8623024, 'binary_precision': 0.7242798, 'binary_recall': 0.84887457, 'binary_specificity': 0.69359756, 'binary_f1_score': 0.7816432}
confusion matrix:
     0    1
0  455  201
1   94  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.7842981, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.750954, 'auroc': 0.87497854, 'binary_precision': 0.69611305, 'binary_recall': 0.912037, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.78957915}
confusion matrix:
     0    1
0  130   86
1   19  197
early stop counter: 4
val acc:0.7691705822944641, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8032407164573669 / 0.8449074029922485
after epoch: 24,now: 2024-07-26 02:41:41.824137,epoch time: 0:02:46.257311,used: 1:06:36.056106,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9902952, 'recall': 0.9901364, 'specificity': 0.9901364, 'f1': 0.99018145, 'auroc': 0.9997961, 'binary_precision': 0.98459566, 'binary_recall': 0.9961039, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.99031633}
confusion matrix:
      0     1
0  1492    24
1     6  1534
---- Validation: 
scalar performance:
{'acc': 0.80046946, 'precision': 0.8195474, 'recall': 0.79714096, 'specificity': 0.79714096, 'f1': 0.7961041, 'auroc': 0.8925501, 'binary_precision': 0.891258, 'binary_recall': 0.67202574, 'binary_specificity': 0.9222561, 'binary_f1_score': 0.7662695}
confusion matrix:
     0    1
0  605   51
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.787037, 'precision': 0.8229167, 'recall': 0.787037, 'specificity': 0.787037, 'f1': 0.78095233, 'auroc': 0.87620026, 'binary_precision': 0.9305556, 'binary_recall': 0.6203704, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.74444443}
confusion matrix:
     0    1
0  206   10
1   82  134
early stop counter: 5
val acc:0.8004694581031799, best validation acc: 0.8568075299263, corresponding to test acc:                         0.8032407164573669 / 0.8449074029922485
after epoch: 25,now: 2024-07-26 02:44:27.134958,epoch time: 0:02:45.310821,used: 1:09:21.366927,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_35_05_seed_2_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 25 with time: 1:09:21.366927 at 2024-07-26 02:44:27.134958
persisted model performance metric: 

scalar performance:
{'acc': 0.8032407, 'precision': 0.80560535, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.8028594, 'auroc': 0.85851765, 'binary_precision': 0.8324873, 'binary_recall': 0.7592593, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.79418886}
confusion matrix:
     0    1
0  183   33
1   52  164
oracle model performance metric: 

scalar performance:
{'acc': 0.8449074, 'precision': 0.8636199, 'recall': 0.8449074, 'specificity': 0.8449074, 'f1': 0.8428861, 'auroc': 0.9466735, 'binary_precision': 0.9461078, 'binary_recall': 0.7314815, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.8250653}
confusion matrix:
     0    1
0  207    9
1   58  158
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8915 MiB | 332787 GiB | 332784 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 329879 GiB | 329877 GiB |
|       from small pool |     91 MiB |    132 MiB |   2907 GiB |   2907 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8915 MiB | 332787 GiB | 332784 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 329879 GiB | 329877 GiB |
|       from small pool |     91 MiB |    132 MiB |   2907 GiB |   2907 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 332291 GiB | 332289 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 329388 GiB | 329386 GiB |
|       from small pool |     91 MiB |    132 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9746 MiB |   9824 MiB |  22378 MiB |  12632 MiB |
|       from large pool |   9610 MiB |   9688 MiB |  22172 MiB |  12562 MiB |
|       from small pool |    136 MiB |    140 MiB |    206 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1145 MiB |   1656 MiB | 230863 GiB | 230862 GiB |
|       from large pool |   1135 MiB |   1651 MiB | 227872 GiB | 227871 GiB |
|       from small pool |     10 MiB |     62 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   47275 K  |   47272 K  |
|       from large pool |     392    |     816    |   23753 K  |   23752 K  |
|       from small pool |    2072    |    2780    |   23522 K  |   23520 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   47275 K  |   47272 K  |
|       from large pool |     392    |     816    |   23753 K  |   23752 K  |
|       from small pool |    2072    |    2780    |   23522 K  |   23520 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |     639    |     353    |
|       from large pool |     218    |     265    |     536    |     318    |
|       from small pool |      68    |      70    |     103    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     154    |     319    |   26890 K  |   26890 K  |
|       from large pool |      80    |     255    |   14743 K  |   14743 K  |
|       from small pool |      74    |     226    |   12146 K  |   12146 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 332787 GiB | 332787 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 329879 GiB | 329879 GiB |
|       from small pool |      0 KiB |    132 MiB |   2907 GiB |   2907 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 332787 GiB | 332787 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 329879 GiB | 329879 GiB |
|       from small pool |      0 KiB |    132 MiB |   2907 GiB |   2907 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 332291 GiB | 332291 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 329388 GiB | 329388 GiB |
|       from small pool |      0 KiB |    132 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3540 MiB |   9824 MiB |  22378 MiB |  18838 MiB |
|       from large pool |   3438 MiB |   9688 MiB |  22172 MiB |  18734 MiB |
|       from small pool |    102 MiB |    140 MiB |    206 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 230864 GiB | 230864 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 227873 GiB | 227873 GiB |
|       from small pool |      0 KiB |     62 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   47275 K  |   47275 K  |
|       from large pool |       2    |     816    |   23753 K  |   23753 K  |
|       from small pool |       0    |    2780    |   23522 K  |   23522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   47275 K  |   47275 K  |
|       from large pool |       2    |     816    |   23753 K  |   23753 K  |
|       from small pool |       0    |    2780    |   23522 K  |   23522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     639    |     505    |
|       from large pool |      83    |     265    |     536    |     453    |
|       from small pool |      51    |      70    |     103    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   26890 K  |   26890 K  |
|       from large pool |       3    |     255    |   14744 K  |   14744 K  |
|       from small pool |       0    |     226    |   12146 K  |   12146 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 332787 GiB | 332787 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 329879 GiB | 329879 GiB |
|       from small pool |      0 KiB |    132 MiB |   2907 GiB |   2907 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 332787 GiB | 332787 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 329879 GiB | 329879 GiB |
|       from small pool |      0 KiB |    132 MiB |   2907 GiB |   2907 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 332291 GiB | 332291 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 329388 GiB | 329388 GiB |
|       from small pool |      0 KiB |    132 MiB |   2903 GiB |   2903 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3540 MiB |   9824 MiB |  22378 MiB |  18838 MiB |
|       from large pool |   3438 MiB |   9688 MiB |  22172 MiB |  18734 MiB |
|       from small pool |    102 MiB |    140 MiB |    206 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 230864 GiB | 230864 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 227873 GiB | 227873 GiB |
|       from small pool |      0 KiB |     62 MiB |   2990 GiB |   2990 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   47275 K  |   47275 K  |
|       from large pool |       2    |     816    |   23753 K  |   23753 K  |
|       from small pool |       0    |    2780    |   23522 K  |   23522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   47275 K  |   47275 K  |
|       from large pool |       2    |     816    |   23753 K  |   23753 K  |
|       from small pool |       0    |    2780    |   23522 K  |   23522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     639    |     505    |
|       from large pool |      83    |     265    |     536    |     453    |
|       from small pool |      51    |      70    |     103    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   26890 K  |   26890 K  |
|       from large pool |       3    |     255    |   14744 K  |   14744 K  |
|       from small pool |       0    |     226    |   12146 K  |   12146 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731

 Experiment start at: 2024-07-26 02:45:01.593512
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.9184593, 'recall': 0.9099443, 'specificity': 0.9099443, 'f1': 0.9102596, 'auroc': 0.9874378, 'binary_precision': 0.86503416, 'binary_recall': 0.9762211, 'binary_specificity': 0.84366757, 'binary_f1_score': 0.9172706}
confusion matrix:
      0     1
0  1279   237
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.7786438, 'precision': 0.78631735, 'recall': 0.7769796, 'specificity': 0.7769796, 'f1': 0.7763831, 'auroc': 0.8370794, 'binary_precision': 0.82857144, 'binary_recall': 0.6915739, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.7538994}
confusion matrix:
     0    1
0  564   90
1  194  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.8591849, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8378346, 'auroc': 0.93349135, 'binary_precision': 0.94219655, 'binary_recall': 0.72444445, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8190955}
confusion matrix:
     0    1
0  215   10
1   62  163
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:47:51.642081,epoch time: 0:02:50.048569,used: 0:02:50.048569,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.89453125, 'precision': 0.9119086, 'recall': 0.8959538, 'specificity': 0.8959538, 'f1': 0.8936349, 'auroc': 0.994789, 'binary_precision': 1.0, 'binary_recall': 0.7919075, 'binary_specificity': 1.0, 'binary_f1_score': 0.8838709}
confusion matrix:
      0     1
0  1515     0
1   324  1233
---- Validation: 
scalar performance:
{'acc': 0.5097428, 'precision': 0.2548714, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33763555, 'auroc': 0.8571224, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  654  0
1  629  0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8942222, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  225  0
1  225  0
early stop counter: 1
val acc:0.509742796421051, best validation acc: 0.778643786907196, corresponding to test acc:                         0.8399999737739563 / 0.8399999737739563
after epoch: 2,now: 2024-07-26 02:50:38.513594,epoch time: 0:02:46.871513,used: 0:05:36.920082,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.9779025, 'recall': 0.97780216, 'specificity': 0.97780216, 'f1': 0.9775388, 'auroc': 0.99725497, 'binary_precision': 0.9953458, 'binary_recall': 0.96023095, 'binary_specificity': 0.9953734, 'binary_f1_score': 0.9774731}
confusion matrix:
      0     1
0  1506     7
1    62  1497
---- Validation: 
scalar performance:
{'acc': 0.81371784, 'precision': 0.8298119, 'recall': 0.81153524, 'specificity': 0.81153524, 'f1': 0.8106235, 'auroc': 0.8885943, 'binary_precision': 0.8979592, 'binary_recall': 0.69952303, 'binary_specificity': 0.9235474, 'binary_f1_score': 0.7864164}
confusion matrix:
     0    1
0  604   50
1  189  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.8452035, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.83690065, 'auroc': 0.9149827, 'binary_precision': 0.8958333, 'binary_recall': 0.7644445, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.82494}
confusion matrix:
     0    1
0  205   20
1   53  172
better model found
persisted
after epoch: 3,now: 2024-07-26 02:53:26.439220,epoch time: 0:02:47.925626,used: 0:08:24.845708,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.97793555, 'recall': 0.9777684, 'specificity': 0.9777684, 'f1': 0.9775385, 'auroc': 0.9980767, 'binary_precision': 0.9953364, 'binary_recall': 0.96015424, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9774289}
confusion matrix:
      0     1
0  1509     7
1    62  1494
---- Validation: 
scalar performance:
{'acc': 0.6196415, 'precision': 0.76711786, 'recall': 0.612265, 'specificity': 0.612265, 'f1': 0.55120826, 'auroc': 0.8959758, 'binary_precision': 0.9607843, 'binary_recall': 0.2337043, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.3759591}
confusion matrix:
     0    1
0  648    6
1  482  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.7150595, 'recall': 0.54, 'specificity': 0.54, 'f1': 0.42247245, 'auroc': 0.89430124, 'binary_precision': 0.90909094, 'binary_recall': 0.08888889, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.16194333}
confusion matrix:
     0   1
0  223   2
1  205  20
early stop counter: 1
val acc:0.6196414828300476, best validation acc: 0.8137178421020508, corresponding to test acc:                         0.8377777934074402 / 0.8399999737739563
after epoch: 4,now: 2024-07-26 02:56:12.896081,epoch time: 0:02:46.456861,used: 0:11:11.302569,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.97617877, 'recall': 0.9761206, 'specificity': 0.9761206, 'f1': 0.97591144, 'auroc': 0.99747294, 'binary_precision': 0.99138504, 'binary_recall': 0.9608221, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.9758644}
confusion matrix:
      0     1
0  1502    13
1    61  1496
---- Validation: 
scalar performance:
{'acc': 0.80592364, 'precision': 0.80842316, 'recall': 0.8067767, 'specificity': 0.8067767, 'f1': 0.80577064, 'auroc': 0.8778509, 'binary_precision': 0.7753623, 'binary_recall': 0.85055643, 'binary_specificity': 0.762997, 'binary_f1_score': 0.8112206}
confusion matrix:
     0    1
0  499  155
1   94  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8179581, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80751634, 'auroc': 0.8992988, 'binary_precision': 0.76425856, 'binary_recall': 0.8933333, 'binary_specificity': 0.72444445, 'binary_f1_score': 0.8237705}
confusion matrix:
     0    1
0  163   62
1   24  201
early stop counter: 2
val acc:0.8059236407279968, best validation acc: 0.8137178421020508, corresponding to test acc:                         0.8377777934074402 / 0.8399999737739563
after epoch: 5,now: 2024-07-26 02:59:00.244213,epoch time: 0:02:47.348132,used: 0:13:58.650701,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.9798744, 'recall': 0.9793403, 'specificity': 0.9793403, 'f1': 0.97947997, 'auroc': 0.9987151, 'binary_precision': 0.96920174, 'binary_recall': 0.99100256, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9799809}
confusion matrix:
      0     1
0  1467    49
1    14  1542
---- Validation: 
scalar performance:
{'acc': 0.7989088, 'precision': 0.7988559, 'recall': 0.7987716, 'specificity': 0.7987716, 'f1': 0.798806, 'auroc': 0.85757446, 'binary_precision': 0.7968, 'binary_recall': 0.7917329, 'binary_specificity': 0.8058104, 'binary_f1_score': 0.7942584}
confusion matrix:
     0    1
0  527  127
1  131  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76666665, 'precision': 0.7667141, 'recall': 0.76666665, 'specificity': 0.76666665, 'f1': 0.7666563, 'auroc': 0.8434371, 'binary_precision': 0.7631579, 'binary_recall': 0.7733333, 'binary_specificity': 0.76, 'binary_f1_score': 0.76821196}
confusion matrix:
     0    1
0  171   54
1   51  174
early stop counter: 3
val acc:0.7989088296890259, best validation acc: 0.8137178421020508, corresponding to test acc:                         0.8377777934074402 / 0.8399999737739563
after epoch: 6,now: 2024-07-26 03:01:47.138390,epoch time: 0:02:46.894177,used: 0:16:45.544878,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97669756, 'recall': 0.975292, 'specificity': 0.975292, 'f1': 0.97555625, 'auroc': 0.9992666, 'binary_precision': 0.9568434, 'binary_recall': 0.9967887, 'binary_specificity': 0.9537954, 'binary_f1_score': 0.9764076}
confusion matrix:
      0     1
0  1445    70
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.77007014, 'precision': 0.7956737, 'recall': 0.7728847, 'specificity': 0.7728847, 'f1': 0.7661555, 'auroc': 0.88873166, 'binary_precision': 0.7036585, 'binary_recall': 0.9173291, 'binary_specificity': 0.6284404, 'binary_f1_score': 0.7964113}
confusion matrix:
     0    1
0  411  243
1   52  577
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7888889, 'precision': 0.81021976, 'recall': 0.78888893, 'specificity': 0.78888893, 'f1': 0.78519636, 'auroc': 0.90247905, 'binary_precision': 0.72887325, 'binary_recall': 0.92, 'binary_specificity': 0.6577778, 'binary_f1_score': 0.8133595}
confusion matrix:
     0    1
0  148   77
1   18  207
early stop counter: 4
val acc:0.7700701355934143, best validation acc: 0.8137178421020508, corresponding to test acc:                         0.8377777934074402 / 0.8399999737739563
after epoch: 7,now: 2024-07-26 03:04:33.267033,epoch time: 0:02:46.128643,used: 0:19:31.673521,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9839301, 'recall': 0.9836248, 'specificity': 0.9836248, 'f1': 0.9837173, 'auroc': 0.9992174, 'binary_precision': 0.97656745, 'binary_recall': 0.99163985, 'binary_specificity': 0.9756098, 'binary_f1_score': 0.9840459}
confusion matrix:
      0     1
0  1480    37
1    13  1542
---- Validation: 
scalar performance:
{'acc': 0.80670303, 'precision': 0.82358474, 'recall': 0.8044418, 'specificity': 0.8044418, 'f1': 0.80329, 'auroc': 0.88088953, 'binary_precision': 0.8927835, 'binary_recall': 0.68839425, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.77737886}
confusion matrix:
     0    1
0  602   52
1  196  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.824651, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.79613006, 'auroc': 0.9230223, 'binary_precision': 0.9141104, 'binary_recall': 0.6622222, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.76804125}
confusion matrix:
     0    1
0  211   14
1   76  149
early stop counter: 5
val acc:0.8067030310630798, best validation acc: 0.8137178421020508, corresponding to test acc:                         0.8377777934074402 / 0.8399999737739563
after epoch: 8,now: 2024-07-26 03:07:19.262722,epoch time: 0:02:45.995689,used: 0:22:17.669210,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_45_01_seed_3_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 0:22:17.669210 at 2024-07-26 03:07:19.262722
persisted model performance metric: 

scalar performance:
{'acc': 0.8377778, 'precision': 0.8452035, 'recall': 0.8377778, 'specificity': 0.8377778, 'f1': 0.83690065, 'auroc': 0.9149827, 'binary_precision': 0.8958333, 'binary_recall': 0.7644445, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.82494}
confusion matrix:
     0    1
0  205   20
1   53  172
oracle model performance metric: 

scalar performance:
{'acc': 0.84, 'precision': 0.8591849, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.8378346, 'auroc': 0.93349135, 'binary_precision': 0.94219655, 'binary_recall': 0.72444445, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8190955}
confusion matrix:
     0    1
0  215   10
1   62  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8915 MiB | 386221 GiB | 386219 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 382844 GiB | 382842 GiB |
|       from small pool |     91 MiB |    132 MiB |   3377 GiB |   3376 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8915 MiB | 386221 GiB | 386219 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 382844 GiB | 382842 GiB |
|       from small pool |     91 MiB |    132 MiB |   3377 GiB |   3376 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 385683 GiB | 385681 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 382311 GiB | 382309 GiB |
|       from small pool |     91 MiB |    132 MiB |   3372 GiB |   3371 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9738 MiB |   9824 MiB |  28576 MiB |  18838 MiB |
|       from large pool |   9598 MiB |   9688 MiB |  28332 MiB |  18734 MiB |
|       from small pool |    140 MiB |    140 MiB |    244 MiB |    104 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1051 MiB |   1656 MiB | 270225 GiB | 270224 GiB |
|       from large pool |   1041 MiB |   1651 MiB | 266751 GiB | 266750 GiB |
|       from small pool |     10 MiB |     62 MiB |   3473 GiB |   3473 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   54888 K  |   54886 K  |
|       from large pool |     392    |     816    |   27573 K  |   27572 K  |
|       from small pool |    2084    |    2780    |   27315 K  |   27313 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   54888 K  |   54886 K  |
|       from large pool |     392    |     816    |   27573 K  |   27572 K  |
|       from small pool |    2084    |    2780    |   27315 K  |   27313 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     333    |     790    |     505    |
|       from large pool |     215    |     265    |     668    |     453    |
|       from small pool |      70    |      70    |     122    |      52    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     142    |     319    |   30940 K  |   30940 K  |
|       from large pool |      74    |     255    |   16839 K  |   16839 K  |
|       from small pool |      68    |     226    |   14101 K  |   14101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 386221 GiB | 386221 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 382844 GiB | 382844 GiB |
|       from small pool |      0 KiB |    132 MiB |   3377 GiB |   3377 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 386221 GiB | 386221 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 382844 GiB | 382844 GiB |
|       from small pool |      0 KiB |    132 MiB |   3377 GiB |   3377 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 385683 GiB | 385683 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 382311 GiB | 382311 GiB |
|       from small pool |      0 KiB |    132 MiB |   3372 GiB |   3372 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3446 MiB |   9824 MiB |  28576 MiB |  25130 MiB |
|       from large pool |   3344 MiB |   9688 MiB |  28332 MiB |  24988 MiB |
|       from small pool |    102 MiB |    140 MiB |    244 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 270225 GiB | 270225 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 266752 GiB | 266752 GiB |
|       from small pool |      0 KiB |     62 MiB |   3473 GiB |   3473 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   54888 K  |   54888 K  |
|       from large pool |       2    |     816    |   27573 K  |   27573 K  |
|       from small pool |       0    |    2780    |   27315 K  |   27315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   54888 K  |   54888 K  |
|       from large pool |       2    |     816    |   27573 K  |   27573 K  |
|       from small pool |       0    |    2780    |   27315 K  |   27315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |     790    |     660    |
|       from large pool |      79    |     265    |     668    |     589    |
|       from small pool |      51    |      70    |     122    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   30941 K  |   30941 K  |
|       from large pool |       3    |     255    |   16839 K  |   16839 K  |
|       from small pool |       0    |     226    |   14101 K  |   14101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 386221 GiB | 386221 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 382844 GiB | 382844 GiB |
|       from small pool |      0 KiB |    132 MiB |   3377 GiB |   3377 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 386221 GiB | 386221 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 382844 GiB | 382844 GiB |
|       from small pool |      0 KiB |    132 MiB |   3377 GiB |   3377 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 385683 GiB | 385683 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 382311 GiB | 382311 GiB |
|       from small pool |      0 KiB |    132 MiB |   3372 GiB |   3372 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3446 MiB |   9824 MiB |  28576 MiB |  25130 MiB |
|       from large pool |   3344 MiB |   9688 MiB |  28332 MiB |  24988 MiB |
|       from small pool |    102 MiB |    140 MiB |    244 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 270225 GiB | 270225 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 266752 GiB | 266752 GiB |
|       from small pool |      0 KiB |     62 MiB |   3473 GiB |   3473 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   54888 K  |   54888 K  |
|       from large pool |       2    |     816    |   27573 K  |   27573 K  |
|       from small pool |       0    |    2780    |   27315 K  |   27315 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   54888 K  |   54888 K  |
|       from large pool |       2    |     816    |   27573 K  |   27573 K  |
|       from small pool |       0    |    2780    |   27315 K  |   27315 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |     790    |     660    |
|       from large pool |      79    |     265    |     668    |     589    |
|       from small pool |      51    |      70    |     122    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   30941 K  |   30941 K  |
|       from large pool |       3    |     255    |   16839 K  |   16839 K  |
|       from small pool |       0    |     226    |   14101 K  |   14101 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731

 Experiment start at: 2024-07-26 03:07:53.574059
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93393785, 'precision': 0.9393718, 'recall': 0.93294096, 'specificity': 0.93294096, 'f1': 0.933607, 'auroc': 0.99037975, 'binary_precision': 0.8949798, 'binary_recall': 0.986014, 'binary_specificity': 0.879868, 'binary_f1_score': 0.938294}
confusion matrix:
      0     1
0  1333   182
1    22  1551
---- Validation: 
scalar performance:
{'acc': 0.57689303, 'precision': 0.73346364, 'recall': 0.58224803, 'specificity': 0.58224803, 'f1': 0.49830478, 'auroc': 0.9035151, 'binary_precision': 0.5389273, 'binary_recall': 0.9857595, 'binary_specificity': 0.17873652, 'binary_f1_score': 0.696868}
confusion matrix:
     0    1
0  116  533
1    9  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5450237, 'precision': 0.73803586, 'recall': 0.5450237, 'specificity': 0.5450237, 'f1': 0.42934418, 'auroc': 0.92572045, 'binary_precision': 0.52369076, 'binary_recall': 0.99526066, 'binary_specificity': 0.09478673, 'binary_f1_score': 0.6862745}
confusion matrix:
    0    1
0  20  191
1   1  210
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:10:43.063713,epoch time: 0:02:49.489654,used: 0:02:49.489654,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9478627, 'precision': 0.9496954, 'recall': 0.9473149, 'specificity': 0.9473149, 'f1': 0.94774747, 'auroc': 0.9945495, 'binary_precision': 0.9253012, 'binary_recall': 0.97647804, 'binary_specificity': 0.9181518, 'binary_f1_score': 0.9502011}
confusion matrix:
      0     1
0  1391   124
1    37  1536
---- Validation: 
scalar performance:
{'acc': 0.7470726, 'precision': 0.77292633, 'recall': 0.74907964, 'specificity': 0.74907964, 'f1': 0.7419202, 'auroc': 0.8512634, 'binary_precision': 0.68554217, 'binary_recall': 0.9003165, 'binary_specificity': 0.5978428, 'binary_f1_score': 0.7783858}
confusion matrix:
     0    1
0  388  261
1   63  569
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7511848, 'precision': 0.80554646, 'recall': 0.7511848, 'specificity': 0.7511848, 'f1': 0.7396026, 'auroc': 0.88634574, 'binary_precision': 0.6766667, 'binary_recall': 0.9620853, 'binary_specificity': 0.54028434, 'binary_f1_score': 0.79452056}
confusion matrix:
     0    1
0  114   97
1    8  203
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:13:33.631824,epoch time: 0:02:50.568111,used: 0:05:40.057765,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97603625, 'precision': 0.97649926, 'recall': 0.9758307, 'specificity': 0.9758307, 'f1': 0.97601676, 'auroc': 0.99852264, 'binary_precision': 0.96515244, 'binary_recall': 0.9885277, 'binary_specificity': 0.96313363, 'binary_f1_score': 0.97670025}
confusion matrix:
      0     1
0  1463    56
1    18  1551
---- Validation: 
scalar performance:
{'acc': 0.7861046, 'precision': 0.7880295, 'recall': 0.78662646, 'specificity': 0.78662646, 'f1': 0.785926, 'auroc': 0.8585701, 'binary_precision': 0.7609329, 'binary_recall': 0.8259494, 'binary_specificity': 0.74730355, 'binary_f1_score': 0.7921092}
confusion matrix:
     0    1
0  485  164
1  110  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8436019, 'precision': 0.846717, 'recall': 0.84360194, 'specificity': 0.84360194, 'f1': 0.8432498, 'auroc': 0.9077065, 'binary_precision': 0.8138528, 'binary_recall': 0.89099526, 'binary_specificity': 0.79620856, 'binary_f1_score': 0.8506787}
confusion matrix:
     0    1
0  168   43
1   23  188
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 03:16:22.751116,epoch time: 0:02:49.119292,used: 0:08:29.177057,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97312176, 'precision': 0.973683, 'recall': 0.9735321, 'specificity': 0.9735321, 'f1': 0.9731214, 'auroc': 0.9974365, 'binary_precision': 0.9953458, 'binary_recall': 0.95168465, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.9730257}
confusion matrix:
      0     1
0  1508     7
1    76  1497
---- Validation: 
scalar performance:
{'acc': 0.8251366, 'precision': 0.83108366, 'recall': 0.82423544, 'specificity': 0.82423544, 'f1': 0.8240428, 'auroc': 0.893841, 'binary_precision': 0.8722628, 'binary_recall': 0.7563291, 'binary_specificity': 0.89214176, 'binary_f1_score': 0.8101695}
confusion matrix:
     0    1
0  579   70
1  154  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89099526, 'precision': 0.8938616, 'recall': 0.89099526, 'specificity': 0.89099526, 'f1': 0.8907966, 'auroc': 0.95130396, 'binary_precision': 0.92746115, 'binary_recall': 0.8483412, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8861386}
confusion matrix:
     0    1
0  197   14
1   32  179
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 03:19:11.766414,epoch time: 0:02:49.015298,used: 0:11:18.192355,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9766839, 'precision': 0.9773541, 'recall': 0.97639585, 'specificity': 0.97639585, 'f1': 0.97665745, 'auroc': 0.9987428, 'binary_precision': 0.9635578, 'binary_recall': 0.9917355, 'binary_specificity': 0.9610561, 'binary_f1_score': 0.97744364}
confusion matrix:
      0     1
0  1456    59
1    13  1560
---- Validation: 
scalar performance:
{'acc': 0.75565964, 'precision': 0.7745631, 'recall': 0.75736773, 'specificity': 0.75736773, 'f1': 0.7521703, 'auroc': 0.82979167, 'binary_precision': 0.69912606, 'binary_recall': 0.886076, 'binary_specificity': 0.6286595, 'binary_f1_score': 0.78157717}
confusion matrix:
     0    1
0  408  241
1   72  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175355, 'precision': 0.82760936, 'recall': 0.8175355, 'specificity': 0.8175355, 'f1': 0.81612206, 'auroc': 0.883291, 'binary_precision': 0.7701613, 'binary_recall': 0.9052133, 'binary_specificity': 0.7298578, 'binary_f1_score': 0.83224404}
confusion matrix:
     0    1
0  154   57
1   20  191
early stop counter: 1
val acc:0.7556596398353577, best validation acc: 0.8251366019248962, corresponding to test acc:                         0.8909952640533447 / 0.8909952640533447
after epoch: 5,now: 2024-07-26 03:21:59.454942,epoch time: 0:02:47.688528,used: 0:14:05.880883,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9867228, 'precision': 0.98670447, 'recall': 0.9867357, 'specificity': 0.9867357, 'f1': 0.98671913, 'auroc': 0.9981156, 'binary_precision': 0.9878827, 'binary_recall': 0.9859962, 'binary_specificity': 0.9874753, 'binary_f1_score': 0.98693854}
confusion matrix:
      0     1
0  1498    19
1    22  1549
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.79251254, 'recall': 0.79249966, 'specificity': 0.79249966, 'f1': 0.7923496, 'auroc': 0.86281717, 'binary_precision': 0.7815385, 'binary_recall': 0.8037975, 'binary_specificity': 0.78120184, 'binary_f1_score': 0.79251176}
confusion matrix:
     0    1
0  507  142
1  124  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.8296499, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.8239764, 'auroc': 0.8956448, 'binary_precision': 0.87027025, 'binary_recall': 0.76303315, 'binary_specificity': 0.8862559, 'binary_f1_score': 0.8131313}
confusion matrix:
     0    1
0  187   24
1   50  161
early stop counter: 2
val acc:0.7923497557640076, best validation acc: 0.8251366019248962, corresponding to test acc:                         0.8909952640533447 / 0.8909952640533447
after epoch: 6,now: 2024-07-26 03:24:47.452350,epoch time: 0:02:47.997408,used: 0:16:53.878291,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97085494, 'precision': 0.9717881, 'recall': 0.97135574, 'specificity': 0.97135574, 'f1': 0.97085285, 'auroc': 0.9981117, 'binary_precision': 0.99798524, 'binary_recall': 0.94469166, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.97060746}
confusion matrix:
      0     1
0  1512     3
1    87  1486
---- Validation: 
scalar performance:
{'acc': 0.5386417, 'precision': 0.73950917, 'recall': 0.53247815, 'specificity': 0.53247815, 'f1': 0.40675157, 'auroc': 0.86890733, 'binary_precision': 0.95555556, 'binary_recall': 0.06803797, 'binary_specificity': 0.9969183, 'binary_f1_score': 0.12703101}
confusion matrix:
     0   1
0  647   2
1  589  43
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.521327, 'precision': 0.755448, 'recall': 0.521327, 'specificity': 0.521327, 'f1': 0.3790501, 'auroc': 0.90301204, 'binary_precision': 1.0, 'binary_recall': 0.04265403, 'binary_specificity': 1.0, 'binary_f1_score': 0.081818186}
confusion matrix:
     0  1
0  211  0
1  202  9
early stop counter: 3
val acc:0.5386416912078857, best validation acc: 0.8251366019248962, corresponding to test acc:                         0.8909952640533447 / 0.8909952640533447
after epoch: 7,now: 2024-07-26 03:27:37.505993,epoch time: 0:02:50.053643,used: 0:19:43.931934,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97959846, 'precision': 0.9797143, 'recall': 0.9798614, 'specificity': 0.9798614, 'f1': 0.97959787, 'auroc': 0.99841845, 'binary_precision': 0.99346834, 'binary_recall': 0.96632785, 'binary_specificity': 0.993395, 'binary_f1_score': 0.97971016}
confusion matrix:
      0     1
0  1504    10
1    53  1521
---- Validation: 
scalar performance:
{'acc': 0.67993754, 'precision': 0.770468, 'recall': 0.6760474, 'specificity': 0.6760474, 'f1': 0.64779186, 'auroc': 0.86595976, 'binary_precision': 0.9236641, 'binary_recall': 0.38291138, 'binary_specificity': 0.9691834, 'binary_f1_score': 0.541387}
confusion matrix:
     0    1
0  629   20
1  390  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80094784, 'precision': 0.8458123, 'recall': 0.8009479, 'specificity': 0.8009479, 'f1': 0.79427534, 'auroc': 0.9386581, 'binary_precision': 0.97037035, 'binary_recall': 0.62085307, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.7572254}
confusion matrix:
     0    1
0  207    4
1   80  131
early stop counter: 4
val acc:0.6799375414848328, best validation acc: 0.8251366019248962, corresponding to test acc:                         0.8909952640533447 / 0.8909952640533447
after epoch: 8,now: 2024-07-26 03:30:26.400532,epoch time: 0:02:48.894539,used: 0:22:32.826473,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9851036, 'precision': 0.98527986, 'recall': 0.9849948, 'specificity': 0.9849948, 'f1': 0.985096, 'auroc': 0.99917555, 'binary_precision': 0.9792322, 'binary_recall': 0.9917145, 'binary_specificity': 0.9782752, 'binary_f1_score': 0.9854338}
confusion matrix:
      0     1
0  1486    33
1    13  1556
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.8117268, 'recall': 0.802999, 'specificity': 0.802999, 'f1': 0.80243933, 'auroc': 0.8704458, 'binary_precision': 0.8574109, 'binary_recall': 0.72310126, 'binary_specificity': 0.8828968, 'binary_f1_score': 0.78454936}
confusion matrix:
     0    1
0  573   76
1  175  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8270142, 'precision': 0.866172, 'recall': 0.8270142, 'specificity': 0.8270142, 'f1': 0.8222624, 'auroc': 0.9267986, 'binary_precision': 0.9859155, 'binary_recall': 0.6635071, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.7932011}
confusion matrix:
     0    1
0  209    2
1   71  140
early stop counter: 5
val acc:0.8040593266487122, best validation acc: 0.8251366019248962, corresponding to test acc:                         0.8909952640533447 / 0.8909952640533447
after epoch: 9,now: 2024-07-26 03:33:15.314759,epoch time: 0:02:48.914227,used: 0:25:21.740700,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_07_53_seed_4_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 0:25:21.740700 at 2024-07-26 03:33:15.314759
persisted model performance metric: 

scalar performance:
{'acc': 0.89099526, 'precision': 0.8938616, 'recall': 0.89099526, 'specificity': 0.89099526, 'f1': 0.8907966, 'auroc': 0.95130396, 'binary_precision': 0.92746115, 'binary_recall': 0.8483412, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8861386}
confusion matrix:
     0    1
0  197   14
1   32  179
oracle model performance metric: 

scalar performance:
{'acc': 0.89099526, 'precision': 0.8938616, 'recall': 0.89099526, 'specificity': 0.89099526, 'f1': 0.8907966, 'auroc': 0.95130396, 'binary_precision': 0.92746115, 'binary_recall': 0.8483412, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8861386}
confusion matrix:
     0    1
0  197   14
1   32  179
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8915 MiB | 446590 GiB | 446587 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 442684 GiB | 442682 GiB |
|       from small pool |     91 MiB |    132 MiB |   3905 GiB |   3905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8915 MiB | 446590 GiB | 446587 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 442684 GiB | 442682 GiB |
|       from small pool |     91 MiB |    132 MiB |   3905 GiB |   3905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 445985 GiB | 445982 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 442085 GiB | 442083 GiB |
|       from small pool |     91 MiB |    132 MiB |   3899 GiB |   3899 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9738 MiB |   9824 MiB |  34868 MiB |  25130 MiB |
|       from large pool |   9602 MiB |   9688 MiB |  34590 MiB |  24988 MiB |
|       from small pool |    136 MiB |    140 MiB |    278 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1042 MiB |   1892 MiB | 316395 GiB | 316393 GiB |
|       from large pool |   1032 MiB |   1887 MiB | 312377 GiB | 312376 GiB |
|       from small pool |     10 MiB |     62 MiB |   4017 GiB |   4017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   63479 K  |   63476 K  |
|       from large pool |     392    |     816    |   31885 K  |   31885 K  |
|       from small pool |    2072    |    2780    |   31593 K  |   31591 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   63479 K  |   63476 K  |
|       from large pool |     392    |     816    |   31885 K  |   31885 K  |
|       from small pool |    2072    |    2780    |   31593 K  |   31591 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     283    |     333    |     943    |     660    |
|       from large pool |     215    |     265    |     804    |     589    |
|       from small pool |      68    |      70    |     139    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     319    |   35583 K  |   35583 K  |
|       from large pool |      75    |     255    |   19283 K  |   19283 K  |
|       from small pool |      65    |     227    |   16300 K  |   16300 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 446590 GiB | 446590 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 442684 GiB | 442684 GiB |
|       from small pool |      0 KiB |    132 MiB |   3905 GiB |   3905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 446590 GiB | 446590 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 442684 GiB | 442684 GiB |
|       from small pool |      0 KiB |    132 MiB |   3905 GiB |   3905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 445985 GiB | 445985 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 442085 GiB | 442085 GiB |
|       from small pool |      0 KiB |    132 MiB |   3899 GiB |   3899 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3436 MiB |   9824 MiB |  34868 MiB |  31432 MiB |
|       from large pool |   3334 MiB |   9688 MiB |  34590 MiB |  31256 MiB |
|       from small pool |    102 MiB |    140 MiB |    278 MiB |    176 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 316395 GiB | 316395 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 312378 GiB | 312378 GiB |
|       from small pool |      0 KiB |     62 MiB |   4017 GiB |   4017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   63479 K  |   63479 K  |
|       from large pool |       2    |     816    |   31885 K  |   31885 K  |
|       from small pool |       0    |    2780    |   31593 K  |   31593 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   63479 K  |   63479 K  |
|       from large pool |       2    |     816    |   31885 K  |   31885 K  |
|       from small pool |       0    |    2780    |   31593 K  |   31593 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |     943    |     813    |
|       from large pool |      79    |     265    |     804    |     725    |
|       from small pool |      51    |      70    |     139    |      88    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   35583 K  |   35583 K  |
|       from large pool |       3    |     255    |   19283 K  |   19283 K  |
|       from small pool |       0    |     227    |   16300 K  |   16300 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 446590 GiB | 446590 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 442684 GiB | 442684 GiB |
|       from small pool |      0 KiB |    132 MiB |   3905 GiB |   3905 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 446590 GiB | 446590 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 442684 GiB | 442684 GiB |
|       from small pool |      0 KiB |    132 MiB |   3905 GiB |   3905 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 445985 GiB | 445985 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 442085 GiB | 442085 GiB |
|       from small pool |      0 KiB |    132 MiB |   3899 GiB |   3899 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3436 MiB |   9824 MiB |  34868 MiB |  31432 MiB |
|       from large pool |   3334 MiB |   9688 MiB |  34590 MiB |  31256 MiB |
|       from small pool |    102 MiB |    140 MiB |    278 MiB |    176 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 316395 GiB | 316395 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 312378 GiB | 312378 GiB |
|       from small pool |      0 KiB |     62 MiB |   4017 GiB |   4017 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   63479 K  |   63479 K  |
|       from large pool |       2    |     816    |   31885 K  |   31885 K  |
|       from small pool |       0    |    2780    |   31593 K  |   31593 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   63479 K  |   63479 K  |
|       from large pool |       2    |     816    |   31885 K  |   31885 K  |
|       from small pool |       0    |    2780    |   31593 K  |   31593 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |     943    |     813    |
|       from large pool |      79    |     265    |     804    |     725    |
|       from small pool |      51    |      70    |     139    |      88    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   35583 K  |   35583 K  |
|       from large pool |       3    |     255    |   19283 K  |   19283 K  |
|       from small pool |       0    |     227    |   16300 K  |   16300 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731

 Experiment start at: 2024-07-26 03:33:51.986611
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94306284, 'precision': 0.94719076, 'recall': 0.943861, 'specificity': 0.943861, 'f1': 0.94298893, 'auroc': 0.9921447, 'binary_precision': 0.99426115, 'binary_recall': 0.89304125, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.94093686}
confusion matrix:
      0     1
0  1496     8
1   166  1386
---- Validation: 
scalar performance:
{'acc': 0.82037324, 'precision': 0.82209384, 'recall': 0.819252, 'specificity': 0.819252, 'f1': 0.8196578, 'auroc': 0.8980696, 'binary_precision': 0.83965516, 'binary_recall': 0.7792, 'binary_specificity': 0.8593041, 'binary_f1_score': 0.80829877}
confusion matrix:
     0    1
0  568   93
1  138  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83667094, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83291924, 'auroc': 0.9046869, 'binary_precision': 0.8701923, 'binary_recall': 0.7835498, 'binary_specificity': 0.8831169, 'binary_f1_score': 0.82460135}
confusion matrix:
     0    1
0  204   27
1   50  181
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:36:43.599648,epoch time: 0:02:51.613037,used: 0:02:51.613037,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9437173, 'precision': 0.9481766, 'recall': 0.9429418, 'specificity': 0.9429418, 'f1': 0.9434942, 'auroc': 0.9956546, 'binary_precision': 0.9073746, 'binary_recall': 0.99034125, 'binary_specificity': 0.89554226, 'binary_f1_score': 0.9470444}
confusion matrix:
      0     1
0  1346   157
1    15  1538
---- Validation: 
scalar performance:
{'acc': 0.7791602, 'precision': 0.801299, 'recall': 0.78286475, 'specificity': 0.78286475, 'f1': 0.7764343, 'auroc': 0.8997252, 'binary_precision': 0.7123288, 'binary_recall': 0.9152, 'binary_specificity': 0.6505295, 'binary_f1_score': 0.80112046}
confusion matrix:
     0    1
0  430  231
1   53  572
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84632033, 'precision': 0.84820616, 'recall': 0.8463204, 'specificity': 0.8463204, 'f1': 0.846112, 'auroc': 0.9437417, 'binary_precision': 0.82258064, 'binary_recall': 0.8831169, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.8517746}
confusion matrix:
     0    1
0  187   44
1   27  204
new oracle model saved
early stop counter: 1
val acc:0.77916020154953, best validation acc: 0.8203732371330261, corresponding to test acc:                         0.8333333134651184 / 0.8463203310966492
after epoch: 2,now: 2024-07-26 03:39:31.886024,epoch time: 0:02:48.286376,used: 0:05:39.899413,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.9668866, 'recall': 0.96663195, 'specificity': 0.96663195, 'f1': 0.9662945, 'auroc': 0.995165, 'binary_precision': 0.9878788, 'binary_recall': 0.945232, 'binary_specificity': 0.9880319, 'binary_f1_score': 0.966085}
confusion matrix:
      0     1
0  1486    18
1    85  1467
---- Validation: 
scalar performance:
{'acc': 0.7791602, 'precision': 0.8054664, 'recall': 0.77493495, 'specificity': 0.77493495, 'f1': 0.7723769, 'auroc': 0.8887794, 'binary_precision': 0.8883827, 'binary_recall': 0.624, 'binary_specificity': 0.9258699, 'binary_f1_score': 0.73308265}
confusion matrix:
     0    1
0  612   49
1  235  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8356038, 'recall': 0.8333333, 'specificity': 0.8333333, 'f1': 0.83305097, 'auroc': 0.9026442, 'binary_precision': 0.8632075, 'binary_recall': 0.7922078, 'binary_specificity': 0.87445885, 'binary_f1_score': 0.8261851}
confusion matrix:
     0    1
0  202   29
1   48  183
early stop counter: 2
val acc:0.77916020154953, best validation acc: 0.8203732371330261, corresponding to test acc:                         0.8333333134651184 / 0.8463203310966492
after epoch: 3,now: 2024-07-26 03:42:19.171498,epoch time: 0:02:47.285474,used: 0:08:27.184887,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.9796052, 'recall': 0.9792508, 'specificity': 0.9792508, 'f1': 0.9793724, 'auroc': 0.9985828, 'binary_precision': 0.972733, 'binary_recall': 0.98713, 'binary_specificity': 0.97137153, 'binary_f1_score': 0.97987866}
confusion matrix:
      0     1
0  1459    43
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.85069984, 'precision': 0.8507073, 'recall': 0.85040843, 'specificity': 0.85040843, 'f1': 0.85052484, 'auroc': 0.9130771, 'binary_precision': 0.8508914, 'binary_recall': 0.84, 'binary_specificity': 0.86081696, 'binary_f1_score': 0.8454106}
confusion matrix:
     0    1
0  569   92
1  100  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84632033, 'precision': 0.84867924, 'recall': 0.84632033, 'specificity': 0.84632033, 'f1': 0.84606, 'auroc': 0.9080039, 'binary_precision': 0.8773585, 'binary_recall': 0.8051948, 'binary_specificity': 0.88744587, 'binary_f1_score': 0.83972913}
confusion matrix:
     0    1
0  205   26
1   45  186
better model found
persisted
after epoch: 4,now: 2024-07-26 03:45:07.725528,epoch time: 0:02:48.554030,used: 0:11:15.738917,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9748037, 'precision': 0.975911, 'recall': 0.9744595, 'specificity': 0.9744595, 'f1': 0.9747691, 'auroc': 0.99913156, 'binary_precision': 0.95668316, 'binary_recall': 0.9954926, 'binary_specificity': 0.9534265, 'binary_f1_score': 0.9757021}
confusion matrix:
      0     1
0  1433    70
1     7  1546
---- Validation: 
scalar performance:
{'acc': 0.7286159, 'precision': 0.77962166, 'recall': 0.73443747, 'specificity': 0.73443747, 'f1': 0.71873796, 'auroc': 0.90232253, 'binary_precision': 0.6529933, 'binary_recall': 0.9424, 'binary_specificity': 0.526475, 'binary_f1_score': 0.77144724}
confusion matrix:
     0    1
0  348  313
1   36  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7121212, 'precision': 0.78875, 'recall': 0.71212125, 'specificity': 0.71212125, 'f1': 0.6916646, 'auroc': 0.9304173, 'binary_precision': 0.64, 'binary_recall': 0.969697, 'binary_specificity': 0.45454547, 'binary_f1_score': 0.7710843}
confusion matrix:
     0    1
0  105  126
1    7  224
early stop counter: 1
val acc:0.7286158800125122, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8463203310966492 / 0.8463203310966492
after epoch: 5,now: 2024-07-26 03:47:54.991960,epoch time: 0:02:47.266432,used: 0:14:03.005349,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.97629464, 'recall': 0.9752061, 'specificity': 0.9752061, 'f1': 0.97543335, 'auroc': 0.99868655, 'binary_precision': 0.9594763, 'binary_recall': 0.9935442, 'binary_specificity': 0.95686793, 'binary_f1_score': 0.9762131}
confusion matrix:
      0     1
0  1442    65
1    10  1539
---- Validation: 
scalar performance:
{'acc': 0.82037324, 'precision': 0.8335457, 'recall': 0.8231298, 'specificity': 0.8231298, 'f1': 0.8193454, 'auroc': 0.90858215, 'binary_precision': 0.75989443, 'binary_recall': 0.9216, 'binary_specificity': 0.7246596, 'binary_f1_score': 0.83297175}
confusion matrix:
     0    1
0  479  182
1   49  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8160173, 'precision': 0.8234426, 'recall': 0.8160173, 'specificity': 0.8160173, 'f1': 0.8149553, 'auroc': 0.90869737, 'binary_precision': 0.7744361, 'binary_recall': 0.8917749, 'binary_specificity': 0.74025977, 'binary_f1_score': 0.8289739}
confusion matrix:
     0    1
0  171   60
1   25  206
early stop counter: 2
val acc:0.8203732371330261, best validation acc: 0.8506998419761658, corresponding to test acc:                         0.8463203310966492 / 0.8463203310966492
after epoch: 6,now: 2024-07-26 03:50:43.079543,epoch time: 0:02:48.087583,used: 0:16:51.092932,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.988217, 'recall': 0.988217, 'specificity': 0.988217, 'f1': 0.988217, 'auroc': 0.9990768, 'binary_precision': 0.98840207, 'binary_recall': 0.98840207, 'binary_specificity': 0.9880319, 'binary_f1_score': 0.98840207}
confusion matrix:
      0     1
0  1486    18
1    18  1534
---- Validation: 
scalar performance:
{'acc': 0.86236393, 'precision': 0.8641455, 'recall': 0.8613628, 'specificity': 0.8613628, 'f1': 0.86186874, 'auroc': 0.9200702, 'binary_precision': 0.8835617, 'binary_recall': 0.8256, 'binary_specificity': 0.89712554, 'binary_f1_score': 0.853598}
confusion matrix:
     0    1
0  593   68
1  109  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8701299, 'precision': 0.874879, 'recall': 0.8701298, 'specificity': 0.8701298, 'f1': 0.86971724, 'auroc': 0.94153035, 'binary_precision': 0.9170732, 'binary_recall': 0.8138528, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.8623853}
confusion matrix:
     0    1
0  214   17
1   43  188
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 03:53:32.027181,epoch time: 0:02:48.947638,used: 0:19:40.040570,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.983966, 'precision': 0.9840317, 'recall': 0.98410237, 'specificity': 0.98410237, 'f1': 0.98396575, 'auroc': 0.9989282, 'binary_precision': 0.9940711, 'binary_recall': 0.9741769, 'binary_specificity': 0.99402785, 'binary_f1_score': 0.9840235}
confusion matrix:
      0     1
0  1498     9
1    40  1509
---- Validation: 
scalar performance:
{'acc': 0.7986003, 'precision': 0.82674885, 'recall': 0.79441214, 'specificity': 0.79441214, 'f1': 0.7924714, 'auroc': 0.89806473, 'binary_precision': 0.9159091, 'binary_recall': 0.6448, 'binary_specificity': 0.9440242, 'binary_f1_score': 0.7568075}
confusion matrix:
     0    1
0  624   37
1  222  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116883, 'precision': 0.85064936, 'recall': 0.8116883, 'specificity': 0.8116883, 'f1': 0.806308, 'auroc': 0.9056427, 'binary_precision': 0.96753246, 'binary_recall': 0.6450216, 'binary_specificity': 0.978355, 'binary_f1_score': 0.7740259}
confusion matrix:
     0    1
0  226    5
1   82  149
early stop counter: 1
val acc:0.7986003160476685, best validation acc: 0.8623639345169067, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 8,now: 2024-07-26 03:56:19.966734,epoch time: 0:02:47.939553,used: 0:22:27.980123,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9764398, 'precision': 0.97692037, 'recall': 0.97681576, 'specificity': 0.97681576, 'f1': 0.97643965, 'auroc': 0.9972153, 'binary_precision': 0.99731904, 'binary_recall': 0.9562982, 'binary_specificity': 0.99733335, 'binary_f1_score': 0.97637796}
confusion matrix:
      0     1
0  1496     4
1    68  1488
---- Validation: 
scalar performance:
{'acc': 0.777605, 'precision': 0.8049921, 'recall': 0.77329135, 'specificity': 0.77329135, 'f1': 0.7705176, 'auroc': 0.8683328, 'binary_precision': 0.8896552, 'binary_recall': 0.6192, 'binary_specificity': 0.92738277, 'binary_f1_score': 0.73018867}
confusion matrix:
     0    1
0  613   48
1  238  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77922076, 'precision': 0.8057123, 'recall': 0.7792208, 'specificity': 0.7792208, 'f1': 0.7743319, 'auroc': 0.8755833, 'binary_precision': 0.8957055, 'binary_recall': 0.63203466, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.74111676}
confusion matrix:
     0    1
0  214   17
1   85  146
early stop counter: 2
val acc:0.7776049971580505, best validation acc: 0.8623639345169067, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 9,now: 2024-07-26 03:59:06.069745,epoch time: 0:02:46.103011,used: 0:25:14.083134,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.98174405, 'recall': 0.98115146, 'specificity': 0.98115146, 'f1': 0.9813331, 'auroc': 0.9992978, 'binary_precision': 0.97166246, 'binary_recall': 0.992283, 'binary_specificity': 0.97002, 'binary_f1_score': 0.9818645}
confusion matrix:
      0     1
0  1456    45
1    12  1543
---- Validation: 
scalar performance:
{'acc': 0.86236393, 'precision': 0.862888, 'recall': 0.8629749, 'specificity': 0.8629749, 'f1': 0.8623632, 'auroc': 0.92262876, 'binary_precision': 0.84042555, 'binary_recall': 0.8848, 'binary_specificity': 0.84114975, 'binary_f1_score': 0.86204207}
confusion matrix:
     0    1
0  556  105
1   72  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8636364, 'precision': 0.8656165, 'recall': 0.8636364, 'specificity': 0.8636364, 'f1': 0.8634514, 'auroc': 0.9060737, 'binary_precision': 0.89252335, 'binary_recall': 0.8268398, 'binary_specificity': 0.9004329, 'binary_f1_score': 0.85842687}
confusion matrix:
     0    1
0  208   23
1   40  191
early stop counter: 3
val acc:0.8623639345169067, best validation acc: 0.8623639345169067, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 10,now: 2024-07-26 04:01:52.178123,epoch time: 0:02:46.108378,used: 0:28:00.191512,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97840315, 'precision': 0.97892606, 'recall': 0.9782195, 'specificity': 0.9782195, 'f1': 0.9783876, 'auroc': 0.99897915, 'binary_precision': 0.96603775, 'binary_recall': 0.99224806, 'binary_specificity': 0.96419096, 'binary_f1_score': 0.9789675}
confusion matrix:
      0     1
0  1454    54
1    12  1536
---- Validation: 
scalar performance:
{'acc': 0.82270604, 'precision': 0.8323674, 'recall': 0.8202578, 'specificity': 0.8202578, 'f1': 0.8205177, 'auroc': 0.90105665, 'binary_precision': 0.88246626, 'binary_recall': 0.7328, 'binary_specificity': 0.90771556, 'binary_f1_score': 0.8006993}
confusion matrix:
     0    1
0  600   61
1  167  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7987013, 'precision': 0.827963, 'recall': 0.7987013, 'specificity': 0.7987013, 'f1': 0.79410875, 'auroc': 0.90062034, 'binary_precision': 0.9259259, 'binary_recall': 0.64935064, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.7633588}
confusion matrix:
     0    1
0  219   12
1   81  150
early stop counter: 4
val acc:0.8227060437202454, best validation acc: 0.8623639345169067, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 11,now: 2024-07-26 04:04:38.180838,epoch time: 0:02:46.002715,used: 0:30:46.194227,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.97447646, 'precision': 0.9752332, 'recall': 0.97492373, 'specificity': 0.97492373, 'f1': 0.9744753, 'auroc': 0.9984846, 'binary_precision': 0.9993243, 'binary_recall': 0.95051414, 'binary_specificity': 0.9993333, 'binary_f1_score': 0.9743083}
confusion matrix:
      0     1
0  1499     1
1    77  1479
---- Validation: 
scalar performance:
{'acc': 0.58786935, 'precision': 0.7539212, 'recall': 0.57621783, 'specificity': 0.57621783, 'f1': 0.4931209, 'auroc': 0.91292465, 'binary_precision': 0.95238096, 'binary_recall': 0.16, 'binary_specificity': 0.9924357, 'binary_f1_score': 0.27397257}
confusion matrix:
     0    1
0  656    5
1  525  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.504329, 'precision': 0.75108695, 'recall': 0.504329, 'specificity': 0.504329, 'f1': 0.3428818, 'auroc': 0.89449227, 'binary_precision': 1.0, 'binary_recall': 0.008658009, 'binary_specificity': 1.0, 'binary_f1_score': 0.017167382}
confusion matrix:
     0  1
0  231  0
1  229  2
early stop counter: 5
val acc:0.5878693461418152, best validation acc: 0.8623639345169067, corresponding to test acc:                         0.8701298832893372 / 0.8701298832893372
after epoch: 12,now: 2024-07-26 04:07:24.981063,epoch time: 0:02:46.800225,used: 0:33:32.994452,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_33_51_seed_5_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:33:32.994452 at 2024-07-26 04:07:24.981063
persisted model performance metric: 

scalar performance:
{'acc': 0.8701299, 'precision': 0.874879, 'recall': 0.8701298, 'specificity': 0.8701298, 'f1': 0.86971724, 'auroc': 0.94153035, 'binary_precision': 0.9170732, 'binary_recall': 0.8138528, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.8623853}
confusion matrix:
     0    1
0  214   17
1   43  188
oracle model performance metric: 

scalar performance:
{'acc': 0.8701299, 'precision': 0.874879, 'recall': 0.8701298, 'specificity': 0.8701298, 'f1': 0.86971724, 'auroc': 0.94153035, 'binary_precision': 0.9170732, 'binary_recall': 0.8138528, 'binary_specificity': 0.9264069, 'binary_f1_score': 0.8623853}
confusion matrix:
     0    1
0  214   17
1   43  188
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8915 MiB | 526347 GiB | 526344 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 521744 GiB | 521742 GiB |
|       from small pool |     91 MiB |    132 MiB |   4603 GiB |   4602 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8915 MiB | 526347 GiB | 526344 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 521744 GiB | 521742 GiB |
|       from small pool |     91 MiB |    132 MiB |   4603 GiB |   4602 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 525635 GiB | 525633 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 521039 GiB | 521036 GiB |
|       from small pool |     91 MiB |    132 MiB |   4596 GiB |   4596 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9748 MiB |   9824 MiB |  41180 MiB |  31432 MiB |
|       from large pool |   9612 MiB |   9688 MiB |  40868 MiB |  31256 MiB |
|       from small pool |    136 MiB |    140 MiB |    312 MiB |    176 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1100 MiB |   1892 MiB | 375817 GiB | 375816 GiB |
|       from large pool |   1090 MiB |   1887 MiB | 371083 GiB | 371082 GiB |
|       from small pool |     10 MiB |     62 MiB |   4734 GiB |   4734 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   74825 K  |   74822 K  |
|       from large pool |     392    |     816    |   37583 K  |   37583 K  |
|       from small pool |    2084    |    2780    |   37241 K  |   37239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   74825 K  |   74822 K  |
|       from large pool |     392    |     816    |   37583 K  |   37583 K  |
|       from small pool |    2084    |    2780    |   37241 K  |   37239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     333    |    1097    |     813    |
|       from large pool |     216    |     265    |     941    |     725    |
|       from small pool |      68    |      70    |     156    |      88    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     146    |     319    |   41821 K  |   41821 K  |
|       from large pool |      75    |     255    |   22579 K  |   22579 K  |
|       from small pool |      71    |     227    |   19241 K  |   19241 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 526347 GiB | 526347 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 521744 GiB | 521744 GiB |
|       from small pool |      0 KiB |    132 MiB |   4603 GiB |   4603 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 526347 GiB | 526347 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 521744 GiB | 521744 GiB |
|       from small pool |      0 KiB |    132 MiB |   4603 GiB |   4603 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 525635 GiB | 525635 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 521039 GiB | 521039 GiB |
|       from small pool |      0 KiB |    132 MiB |   4596 GiB |   4596 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3494 MiB |   9824 MiB |  41180 MiB |  37686 MiB |
|       from large pool |   3392 MiB |   9688 MiB |  40868 MiB |  37476 MiB |
|       from small pool |    102 MiB |    140 MiB |    312 MiB |    210 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 375818 GiB | 375818 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 371084 GiB | 371084 GiB |
|       from small pool |      0 KiB |     62 MiB |   4734 GiB |   4734 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   74825 K  |   74825 K  |
|       from large pool |       2    |     816    |   37583 K  |   37583 K  |
|       from small pool |       0    |    2780    |   37241 K  |   37241 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   74825 K  |   74825 K  |
|       from large pool |       2    |     816    |   37583 K  |   37583 K  |
|       from small pool |       0    |    2780    |   37241 K  |   37241 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     333    |    1097    |     964    |
|       from large pool |      82    |     265    |     941    |     859    |
|       from small pool |      51    |      70    |     156    |     105    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   41822 K  |   41822 K  |
|       from large pool |       3    |     255    |   22580 K  |   22580 K  |
|       from small pool |       0    |     227    |   19242 K  |   19242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 526347 GiB | 526347 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 521744 GiB | 521744 GiB |
|       from small pool |      0 KiB |    132 MiB |   4603 GiB |   4603 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 526347 GiB | 526347 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 521744 GiB | 521744 GiB |
|       from small pool |      0 KiB |    132 MiB |   4603 GiB |   4603 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 525635 GiB | 525635 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 521039 GiB | 521039 GiB |
|       from small pool |      0 KiB |    132 MiB |   4596 GiB |   4596 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3494 MiB |   9824 MiB |  41180 MiB |  37686 MiB |
|       from large pool |   3392 MiB |   9688 MiB |  40868 MiB |  37476 MiB |
|       from small pool |    102 MiB |    140 MiB |    312 MiB |    210 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 375818 GiB | 375818 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 371084 GiB | 371084 GiB |
|       from small pool |      0 KiB |     62 MiB |   4734 GiB |   4734 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   74825 K  |   74825 K  |
|       from large pool |       2    |     816    |   37583 K  |   37583 K  |
|       from small pool |       0    |    2780    |   37241 K  |   37241 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   74825 K  |   74825 K  |
|       from large pool |       2    |     816    |   37583 K  |   37583 K  |
|       from small pool |       0    |    2780    |   37241 K  |   37241 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     133    |     333    |    1097    |     964    |
|       from large pool |      82    |     265    |     941    |     859    |
|       from small pool |      51    |      70    |     156    |     105    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   41822 K  |   41822 K  |
|       from large pool |       3    |     255    |   22580 K  |   22580 K  |
|       from small pool |       0    |     227    |   19242 K  |   19242 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731

 Experiment start at: 2024-07-26 04:08:00.065996
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.9515544, 'recall': 0.9499608, 'specificity': 0.9499608, 'f1': 0.9495142, 'auroc': 0.9877862, 'binary_precision': 0.98475397, 'binary_recall': 0.9144144, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.94828165}
confusion matrix:
      0     1
0  1496    22
1   133  1421
---- Validation: 
scalar performance:
{'acc': 0.7540856, 'precision': 0.79267967, 'recall': 0.75534904, 'specificity': 0.75534904, 'f1': 0.7463076, 'auroc': 0.91042995, 'binary_precision': 0.684633, 'binary_recall': 0.93573666, 'binary_specificity': 0.57496136, 'binary_f1_score': 0.79072845}
confusion matrix:
     0    1
0  372  275
1   41  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6486486, 'precision': 0.7192888, 'recall': 0.6486486, 'specificity': 0.6486486, 'f1': 0.61787486, 'auroc': 0.89041066, 'binary_precision': 0.5948276, 'binary_recall': 0.9324324, 'binary_specificity': 0.36486486, 'binary_f1_score': 0.7263158}
confusion matrix:
    0    1
0  81  141
1  15  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:10:48.424901,epoch time: 0:02:48.358905,used: 0:02:48.358905,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9557292, 'precision': 0.95806724, 'recall': 0.95533395, 'specificity': 0.95533395, 'f1': 0.9556397, 'auroc': 0.99715006, 'binary_precision': 0.9281401, 'binary_recall': 0.98906046, 'binary_specificity': 0.9216074, 'binary_f1_score': 0.9576324}
confusion matrix:
      0     1
0  1399   119
1    17  1537
---- Validation: 
scalar performance:
{'acc': 0.8319066, 'precision': 0.83866465, 'recall': 0.83239985, 'specificity': 0.83239985, 'f1': 0.8312024, 'auroc': 0.91473305, 'binary_precision': 0.7890411, 'binary_recall': 0.9028213, 'binary_specificity': 0.7619784, 'binary_f1_score': 0.8421053}
confusion matrix:
     0    1
0  493  154
1   62  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8153153, 'precision': 0.8248328, 'recall': 0.8153153, 'specificity': 0.8153153, 'f1': 0.81395257, 'auroc': 0.9098896, 'binary_precision': 0.7692308, 'binary_recall': 0.9009009, 'binary_specificity': 0.7297297, 'binary_f1_score': 0.8298756}
confusion matrix:
     0    1
0  162   60
1   22  200
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:13:36.978626,epoch time: 0:02:48.553725,used: 0:05:36.912630,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96809894, 'precision': 0.96957433, 'recall': 0.9684143, 'specificity': 0.9684143, 'f1': 0.968086, 'auroc': 0.9978593, 'binary_precision': 0.99862826, 'binary_recall': 0.9381443, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.9674419}
confusion matrix:
      0     1
0  1518     2
1    96  1456
---- Validation: 
scalar performance:
{'acc': 0.76420236, 'precision': 0.7793081, 'recall': 0.7633786, 'specificity': 0.7633786, 'f1': 0.7605827, 'auroc': 0.8768563, 'binary_precision': 0.8425358, 'binary_recall': 0.64576805, 'binary_specificity': 0.8809892, 'binary_f1_score': 0.7311446}
confusion matrix:
     0    1
0  570   77
1  226  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8220721, 'precision': 0.84480286, 'recall': 0.8220721, 'specificity': 0.8220721, 'f1': 0.8190905, 'auroc': 0.90195596, 'binary_precision': 0.93333334, 'binary_recall': 0.6936937, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.79586565}
confusion matrix:
     0    1
0  211   11
1   68  154
new oracle model saved
early stop counter: 1
val acc:0.764202356338501, best validation acc: 0.8319066166877747, corresponding to test acc:                         0.815315306186676 / 0.8220720887184143
after epoch: 3,now: 2024-07-26 04:16:24.385666,epoch time: 0:02:47.407040,used: 0:08:24.319670,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.97496533, 'recall': 0.9749048, 'specificity': 0.9749048, 'f1': 0.97493, 'auroc': 0.9958906, 'binary_precision': 0.97309417, 'binary_recall': 0.9774775, 'binary_specificity': 0.972332, 'binary_f1_score': 0.97528094}
confusion matrix:
      0     1
0  1476    42
1    35  1519
---- Validation: 
scalar performance:
{'acc': 0.78132296, 'precision': 0.8149345, 'recall': 0.78017306, 'specificity': 0.78017306, 'f1': 0.77484274, 'auroc': 0.9060651, 'binary_precision': 0.91608393, 'binary_recall': 0.6159875, 'binary_specificity': 0.9443586, 'binary_f1_score': 0.73664486}
confusion matrix:
     0    1
0  611   36
1  245  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7792793, 'precision': 0.8313433, 'recall': 0.7792793, 'specificity': 0.7792793, 'f1': 0.7702543, 'auroc': 0.89542246, 'binary_precision': 0.96268654, 'binary_recall': 0.5810811, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.7247191}
confusion matrix:
     0    1
0  217    5
1   93  129
early stop counter: 2
val acc:0.7813229560852051, best validation acc: 0.8319066166877747, corresponding to test acc:                         0.815315306186676 / 0.8220720887184143
after epoch: 4,now: 2024-07-26 04:19:10.801370,epoch time: 0:02:46.415704,used: 0:11:10.735374,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.953246, 'recall': 0.9493548, 'specificity': 0.9493548, 'f1': 0.94880295, 'auroc': 0.9961516, 'binary_precision': 1.0, 'binary_recall': 0.89870965, 'binary_specificity': 1.0, 'binary_f1_score': 0.94665307}
confusion matrix:
      0     1
0  1522     0
1   157  1393
---- Validation: 
scalar performance:
{'acc': 0.53540856, 'precision': 0.70354235, 'recall': 0.53219706, 'specificity': 0.53219706, 'f1': 0.40915626, 'auroc': 0.8566425, 'binary_precision': 0.8867925, 'binary_recall': 0.07366771, 'binary_specificity': 0.9907264, 'binary_f1_score': 0.13603473}
confusion matrix:
     0   1
0  641   6
1  591  47
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.518018, 'precision': 0.6712963, 'recall': 0.518018, 'specificity': 0.518018, 'f1': 0.37912646, 'auroc': 0.88600767, 'binary_precision': 0.8333333, 'binary_recall': 0.045045044, 'binary_specificity': 0.990991, 'binary_f1_score': 0.08547009}
confusion matrix:
     0   1
0  220   2
1  212  10
early stop counter: 3
val acc:0.5354085564613342, best validation acc: 0.8319066166877747, corresponding to test acc:                         0.815315306186676 / 0.8220720887184143
after epoch: 5,now: 2024-07-26 04:21:57.503650,epoch time: 0:02:46.702280,used: 0:13:57.437654,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9638672, 'precision': 0.9654706, 'recall': 0.96423995, 'specificity': 0.96423995, 'f1': 0.963852, 'auroc': 0.9970017, 'binary_precision': 0.9958763, 'binary_recall': 0.9324324, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9631107}
confusion matrix:
      0     1
0  1512     6
1   105  1449
---- Validation: 
scalar performance:
{'acc': 0.6910506, 'precision': 0.76368237, 'recall': 0.68919855, 'specificity': 0.68919855, 'f1': 0.6669004, 'auroc': 0.8719821, 'binary_precision': 0.9003322, 'binary_recall': 0.4247649, 'binary_specificity': 0.9536322, 'binary_f1_score': 0.5772098}
confusion matrix:
     0    1
0  617   30
1  367  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8018018, 'precision': 0.84684265, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.7951514, 'auroc': 0.88499314, 'binary_precision': 0.97183096, 'binary_recall': 0.6216216, 'binary_specificity': 0.981982, 'binary_f1_score': 0.7582418}
confusion matrix:
     0    1
0  218    4
1   84  138
early stop counter: 4
val acc:0.6910505890846252, best validation acc: 0.8319066166877747, corresponding to test acc:                         0.815315306186676 / 0.8220720887184143
after epoch: 6,now: 2024-07-26 04:24:43.471637,epoch time: 0:02:45.967987,used: 0:16:43.405641,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876145, 'recall': 0.98765755, 'specificity': 0.98765755, 'f1': 0.9876293, 'auroc': 0.9989462, 'binary_precision': 0.99029124, 'binary_recall': 0.98519, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.98773396}
confusion matrix:
      0     1
0  1504    15
1    23  1530
---- Validation: 
scalar performance:
{'acc': 0.8396887, 'precision': 0.84547913, 'recall': 0.8392339, 'specificity': 0.8392339, 'f1': 0.8388807, 'auroc': 0.90557575, 'binary_precision': 0.8884892, 'binary_recall': 0.7742947, 'binary_specificity': 0.90417314, 'binary_f1_score': 0.8274707}
confusion matrix:
     0    1
0  585   62
1  144  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8198198, 'precision': 0.85741496, 'recall': 0.8198198, 'specificity': 0.8198198, 'f1': 0.8149538, 'auroc': 0.8921354, 'binary_precision': 0.97333336, 'binary_recall': 0.6576577, 'binary_specificity': 0.981982, 'binary_f1_score': 0.78494626}
confusion matrix:
     0    1
0  218    4
1   76  146
better model found
persisted
after epoch: 7,now: 2024-07-26 04:27:30.359953,epoch time: 0:02:46.888316,used: 0:19:30.293957,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.98469037, 'recall': 0.98470944, 'specificity': 0.98470944, 'f1': 0.98469895, 'auroc': 0.99878347, 'binary_precision': 0.98580647, 'binary_recall': 0.9839021, 'binary_specificity': 0.9855168, 'binary_f1_score': 0.9848533}
confusion matrix:
      0     1
0  1497    22
1    25  1528
---- Validation: 
scalar performance:
{'acc': 0.8404669, 'precision': 0.8405437, 'recall': 0.84041, 'specificity': 0.84041, 'f1': 0.8404356, 'auroc': 0.90932345, 'binary_precision': 0.84419715, 'binary_recall': 0.8322884, 'binary_specificity': 0.84853166, 'binary_f1_score': 0.8382005}
confusion matrix:
     0    1
0  549   98
1  107  531
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7837838, 'precision': 0.79060006, 'recall': 0.7837838, 'specificity': 0.7837838, 'f1': 0.7825084, 'auroc': 0.89065415, 'binary_precision': 0.74609375, 'binary_recall': 0.8603604, 'binary_specificity': 0.7072072, 'binary_f1_score': 0.79916316}
confusion matrix:
     0    1
0  157   65
1   31  191
better model found
persisted
after epoch: 8,now: 2024-07-26 04:30:17.267481,epoch time: 0:02:46.907528,used: 0:22:17.201485,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9814453, 'precision': 0.98191625, 'recall': 0.98164845, 'specificity': 0.98164845, 'f1': 0.98144424, 'auroc': 0.99923444, 'binary_precision': 1.0, 'binary_recall': 0.96329683, 'binary_specificity': 1.0, 'binary_f1_score': 0.9813053}
confusion matrix:
      0     1
0  1519     0
1    57  1496
---- Validation: 
scalar performance:
{'acc': 0.64824903, 'precision': 0.7419398, 'recall': 0.64605147, 'specificity': 0.64605147, 'f1': 0.60859704, 'auroc': 0.8585714, 'binary_precision': 0.8907563, 'binary_recall': 0.3322884, 'binary_specificity': 0.95981455, 'binary_f1_score': 0.48401827}
confusion matrix:
     0    1
0  621   26
1  426  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5765766, 'precision': 0.7144318, 'recall': 0.5765766, 'specificity': 0.5765766, 'f1': 0.49549115, 'auroc': 0.8788856, 'binary_precision': 0.8863636, 'binary_recall': 0.17567568, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.2932331}
confusion matrix:
     0   1
0  217   5
1  183  39
early stop counter: 1
val acc:0.6482490301132202, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.7837837934494019 / 0.8220720887184143
after epoch: 9,now: 2024-07-26 04:33:05.102976,epoch time: 0:02:47.835495,used: 0:25:05.036980,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97935086, 'recall': 0.9790511, 'specificity': 0.9790511, 'f1': 0.97883976, 'auroc': 0.99808824, 'binary_precision': 0.997992, 'binary_recall': 0.9600773, 'binary_specificity': 0.998025, 'binary_f1_score': 0.97866756}
confusion matrix:
      0     1
0  1516     3
1    62  1491
---- Validation: 
scalar performance:
{'acc': 0.7634241, 'precision': 0.8081691, 'recall': 0.7620826, 'specificity': 0.7620826, 'f1': 0.7538836, 'auroc': 0.908401, 'binary_precision': 0.92385787, 'binary_recall': 0.5705329, 'binary_specificity': 0.9536322, 'binary_f1_score': 0.7054264}
confusion matrix:
     0    1
0  617   30
1  274  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7747748, 'precision': 0.83480024, 'recall': 0.7747748, 'specificity': 0.7747748, 'f1': 0.76420605, 'auroc': 0.9065214, 'binary_precision': 0.9765625, 'binary_recall': 0.5630631, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.71428573}
confusion matrix:
     0    1
0  219    3
1   97  125
early stop counter: 2
val acc:0.7634240984916687, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.7837837934494019 / 0.8220720887184143
after epoch: 10,now: 2024-07-26 04:35:52.969683,epoch time: 0:02:47.866707,used: 0:27:52.903687,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.9851093, 'recall': 0.98497695, 'specificity': 0.98497695, 'f1': 0.98502266, 'auroc': 0.99917465, 'binary_precision': 0.9808429, 'binary_recall': 0.9896907, 'binary_specificity': 0.9802632, 'binary_f1_score': 0.9852469}
confusion matrix:
      0     1
0  1490    30
1    16  1536
---- Validation: 
scalar performance:
{'acc': 0.8692607, 'precision': 0.8699281, 'recall': 0.86911255, 'specificity': 0.86911255, 'f1': 0.86916363, 'auroc': 0.9246074, 'binary_precision': 0.88398695, 'binary_recall': 0.8479624, 'binary_specificity': 0.8902627, 'binary_f1_score': 0.8656}
confusion matrix:
     0    1
0  576   71
1   97  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8513514, 'precision': 0.8570309, 'recall': 0.8513514, 'specificity': 0.8513514, 'f1': 0.85075784, 'auroc': 0.91352165, 'binary_precision': 0.9020619, 'binary_recall': 0.7882883, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.8413462}
confusion matrix:
     0    1
0  203   19
1   47  175
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-26 04:38:41.782041,epoch time: 0:02:48.812358,used: 0:30:41.716045,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9840598, 'recall': 0.98403585, 'specificity': 0.98403585, 'f1': 0.9840469, 'auroc': 0.9992764, 'binary_precision': 0.9833012, 'binary_recall': 0.9851995, 'binary_specificity': 0.9828722, 'binary_f1_score': 0.9842494}
confusion matrix:
      0     1
0  1492    26
1    23  1531
---- Validation: 
scalar performance:
{'acc': 0.8303502, 'precision': 0.8390864, 'recall': 0.82978594, 'specificity': 0.82978594, 'f1': 0.8290748, 'auroc': 0.89885014, 'binary_precision': 0.89179105, 'binary_recall': 0.7492163, 'binary_specificity': 0.9103555, 'binary_f1_score': 0.81431}
confusion matrix:
     0    1
0  589   58
1  160  478
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288288, 'precision': 0.84791756, 'recall': 0.8288288, 'specificity': 0.8288288, 'f1': 0.8264483, 'auroc': 0.8909788, 'binary_precision': 0.92941177, 'binary_recall': 0.7117117, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.8061224}
confusion matrix:
     0    1
0  210   12
1   64  158
early stop counter: 1
val acc:0.8303502202033997, best validation acc: 0.8692607283592224, corresponding to test acc:                         0.8513513803482056 / 0.8513513803482056
after epoch: 12,now: 2024-07-26 04:41:29.416541,epoch time: 0:02:47.634500,used: 0:33:29.350545,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.992816, 'recall': 0.99287283, 'specificity': 0.99287283, 'f1': 0.99283767, 'auroc': 0.9997126, 'binary_precision': 0.99548095, 'binary_recall': 0.9903661, 'binary_specificity': 0.99537957, 'binary_f1_score': 0.99291694}
confusion matrix:
      0     1
0  1508     7
1    15  1542
---- Validation: 
scalar performance:
{'acc': 0.79766536, 'precision': 0.81812155, 'recall': 0.7967724, 'specificity': 0.7967724, 'f1': 0.79401773, 'auroc': 0.8995606, 'binary_precision': 0.89705884, 'binary_recall': 0.669279, 'binary_specificity': 0.92426586, 'binary_f1_score': 0.7666068}
confusion matrix:
     0    1
0  598   49
1  211  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8040541, 'precision': 0.832564, 'recall': 0.8040541, 'specificity': 0.8040541, 'f1': 0.7997626, 'auroc': 0.89404273, 'binary_precision': 0.9299363, 'binary_recall': 0.6576577, 'binary_specificity': 0.9504505, 'binary_f1_score': 0.7704485}
confusion matrix:
     0    1
0  211   11
1   76  146
early stop counter: 2
val acc:0.7976653575897217, best validation acc: 0.8692607283592224, corresponding to test acc:                         0.8513513803482056 / 0.8513513803482056
after epoch: 13,now: 2024-07-26 04:44:16.299092,epoch time: 0:02:46.882551,used: 0:36:16.233096,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98801243, 'recall': 0.98805153, 'specificity': 0.98805153, 'f1': 0.9879557, 'auroc': 0.99927425, 'binary_precision': 0.9967235, 'binary_recall': 0.97939473, 'binary_specificity': 0.99670833, 'binary_f1_score': 0.98798317}
confusion matrix:
      0     1
0  1514     5
1    32  1521
---- Validation: 
scalar performance:
{'acc': 0.8645914, 'precision': 0.87468517, 'recall': 0.86401796, 'specificity': 0.86401796, 'f1': 0.8635362, 'auroc': 0.9320253, 'binary_precision': 0.93445694, 'binary_recall': 0.7821317, 'binary_specificity': 0.9459042, 'binary_f1_score': 0.85153586}
confusion matrix:
     0    1
0  612   35
1  139  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8642594, 'recall': 0.8310811, 'specificity': 0.8310811, 'f1': 0.827145, 'auroc': 0.92273355, 'binary_precision': 0.9741936, 'binary_recall': 0.6801802, 'binary_specificity': 0.981982, 'binary_f1_score': 0.80106103}
confusion matrix:
     0    1
0  218    4
1   71  151
early stop counter: 3
val acc:0.8645914196968079, best validation acc: 0.8692607283592224, corresponding to test acc:                         0.8513513803482056 / 0.8513513803482056
after epoch: 14,now: 2024-07-26 04:47:02.460437,epoch time: 0:02:46.161345,used: 0:39:02.394441,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.9754639, 'recall': 0.9736402, 'specificity': 0.9736402, 'f1': 0.9739212, 'auroc': 0.9995947, 'binary_precision': 0.9516228, 'binary_recall': 0.9993569, 'binary_specificity': 0.94792354, 'binary_f1_score': 0.9749059}
confusion matrix:
      0     1
0  1438    79
1     1  1554
---- Validation: 
scalar performance:
{'acc': 0.8101167, 'precision': 0.82355314, 'recall': 0.8108269, 'specificity': 0.8108269, 'f1': 0.80836093, 'auroc': 0.9067895, 'binary_precision': 0.7558442, 'binary_recall': 0.9122257, 'binary_specificity': 0.70942813, 'binary_f1_score': 0.8267046}
confusion matrix:
     0    1
0  459  188
1   56  582
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8378378, 'precision': 0.8400735, 'recall': 0.8378378, 'specificity': 0.8378378, 'f1': 0.8375708, 'auroc': 0.9017937, 'binary_precision': 0.86764705, 'binary_recall': 0.7972973, 'binary_specificity': 0.8783784, 'binary_f1_score': 0.83098584}
confusion matrix:
     0    1
0  195   27
1   45  177
early stop counter: 4
val acc:0.810116708278656, best validation acc: 0.8692607283592224, corresponding to test acc:                         0.8513513803482056 / 0.8513513803482056
after epoch: 15,now: 2024-07-26 04:49:48.350059,epoch time: 0:02:45.889622,used: 0:41:48.284063,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9860026, 'precision': 0.9862162, 'recall': 0.98614013, 'specificity': 0.98614013, 'f1': 0.98600245, 'auroc': 0.99959207, 'binary_precision': 0.9993382, 'binary_recall': 0.9729381, 'binary_specificity': 0.9993421, 'binary_f1_score': 0.98596144}
confusion matrix:
      0     1
0  1519     1
1    42  1510
---- Validation: 
scalar performance:
{'acc': 0.7167315, 'precision': 0.79612386, 'recall': 0.71490794, 'specificity': 0.71490794, 'f1': 0.69527227, 'auroc': 0.9073684, 'binary_precision': 0.9477124, 'binary_recall': 0.45454547, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.61440676}
confusion matrix:
     0    1
0  631   16
1  348  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.704955, 'precision': 0.79574, 'recall': 0.704955, 'specificity': 0.704955, 'f1': 0.6804299, 'auroc': 0.9090831, 'binary_precision': 0.959596, 'binary_recall': 0.42792794, 'binary_specificity': 0.981982, 'binary_f1_score': 0.59190035}
confusion matrix:
     0   1
0  218   4
1  127  95
early stop counter: 5
val acc:0.7167314887046814, best validation acc: 0.8692607283592224, corresponding to test acc:                         0.8513513803482056 / 0.8513513803482056
after epoch: 16,now: 2024-07-26 04:52:34.541516,epoch time: 0:02:46.191457,used: 0:44:34.475520,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_08_00_seed_6_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:44:34.475520 at 2024-07-26 04:52:34.541516
persisted model performance metric: 

scalar performance:
{'acc': 0.8513514, 'precision': 0.8570309, 'recall': 0.8513514, 'specificity': 0.8513514, 'f1': 0.85075784, 'auroc': 0.91352165, 'binary_precision': 0.9020619, 'binary_recall': 0.7882883, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.8413462}
confusion matrix:
     0    1
0  203   19
1   47  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8513514, 'precision': 0.8570309, 'recall': 0.8513514, 'specificity': 0.8513514, 'f1': 0.85075784, 'auroc': 0.91352165, 'binary_precision': 0.9020619, 'binary_recall': 0.7882883, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.8413462}
confusion matrix:
     0    1
0  203   19
1   47  175
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8915 MiB | 633122 GiB | 633119 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 627586 GiB | 627584 GiB |
|       from small pool |     91 MiB |    132 MiB |   5535 GiB |   5535 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8915 MiB | 633122 GiB | 633119 GiB |
|       from large pool |   2302 MiB |   8839 MiB | 627586 GiB | 627584 GiB |
|       from small pool |     91 MiB |    132 MiB |   5535 GiB |   5535 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 632270 GiB | 632268 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 626743 GiB | 626740 GiB |
|       from small pool |     91 MiB |    132 MiB |   5527 GiB |   5527 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9740 MiB |   9824 MiB |  47426 MiB |  37686 MiB |
|       from large pool |   9604 MiB |   9688 MiB |  47080 MiB |  37476 MiB |
|       from small pool |    136 MiB |    140 MiB |    346 MiB |    210 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    963 MiB |   1892 MiB | 455959 GiB | 455958 GiB |
|       from large pool |    953 MiB |   1887 MiB | 450265 GiB | 450265 GiB |
|       from small pool |     10 MiB |     62 MiB |   5693 GiB |   5693 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   90002 K  |   89999 K  |
|       from large pool |     392    |     816    |   45209 K  |   45208 K  |
|       from small pool |    2078    |    2780    |   44792 K  |   44790 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   90002 K  |   89999 K  |
|       from large pool |     392    |     816    |   45209 K  |   45208 K  |
|       from small pool |    2078    |    2780    |   44792 K  |   44790 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     333    |    1248    |     964    |
|       from large pool |     216    |     265    |    1075    |     859    |
|       from small pool |      68    |      70    |     173    |     105    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     319    |   49940 K  |   49940 K  |
|       from large pool |      70    |     255    |   26801 K  |   26801 K  |
|       from small pool |      70    |     227    |   23139 K  |   23139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 633122 GiB | 633122 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 627586 GiB | 627586 GiB |
|       from small pool |      0 KiB |    132 MiB |   5535 GiB |   5535 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 633122 GiB | 633122 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 627586 GiB | 627586 GiB |
|       from small pool |      0 KiB |    132 MiB |   5535 GiB |   5535 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 632270 GiB | 632270 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 626743 GiB | 626743 GiB |
|       from small pool |      0 KiB |    132 MiB |   5527 GiB |   5527 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3358 MiB |   9824 MiB |  47426 MiB |  44068 MiB |
|       from large pool |   3256 MiB |   9688 MiB |  47080 MiB |  43824 MiB |
|       from small pool |    102 MiB |    140 MiB |    346 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 455960 GiB | 455960 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 450266 GiB | 450266 GiB |
|       from small pool |      0 KiB |     62 MiB |   5693 GiB |   5693 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   90002 K  |   90002 K  |
|       from large pool |       2    |     816    |   45209 K  |   45209 K  |
|       from small pool |       0    |    2780    |   44792 K  |   44792 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   90002 K  |   90002 K  |
|       from large pool |       2    |     816    |   45209 K  |   45209 K  |
|       from small pool |       0    |    2780    |   44792 K  |   44792 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1248    |    1119    |
|       from large pool |      78    |     265    |    1075    |     997    |
|       from small pool |      51    |      70    |     173    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   49941 K  |   49941 K  |
|       from large pool |       3    |     255    |   26801 K  |   26801 K  |
|       from small pool |       0    |     227    |   23139 K  |   23139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 633122 GiB | 633122 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 627586 GiB | 627586 GiB |
|       from small pool |      0 KiB |    132 MiB |   5535 GiB |   5535 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 633122 GiB | 633122 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 627586 GiB | 627586 GiB |
|       from small pool |      0 KiB |    132 MiB |   5535 GiB |   5535 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 632270 GiB | 632270 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 626743 GiB | 626743 GiB |
|       from small pool |      0 KiB |    132 MiB |   5527 GiB |   5527 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3358 MiB |   9824 MiB |  47426 MiB |  44068 MiB |
|       from large pool |   3256 MiB |   9688 MiB |  47080 MiB |  43824 MiB |
|       from small pool |    102 MiB |    140 MiB |    346 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 455960 GiB | 455960 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 450266 GiB | 450266 GiB |
|       from small pool |      0 KiB |     62 MiB |   5693 GiB |   5693 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   90002 K  |   90002 K  |
|       from large pool |       2    |     816    |   45209 K  |   45209 K  |
|       from small pool |       0    |    2780    |   44792 K  |   44792 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   90002 K  |   90002 K  |
|       from large pool |       2    |     816    |   45209 K  |   45209 K  |
|       from small pool |       0    |    2780    |   44792 K  |   44792 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1248    |    1119    |
|       from large pool |      78    |     265    |    1075    |     997    |
|       from small pool |      51    |      70    |     173    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   49941 K  |   49941 K  |
|       from large pool |       3    |     255    |   26801 K  |   26801 K  |
|       from small pool |       0    |     227    |   23139 K  |   23139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731

 Experiment start at: 2024-07-26 04:53:09.455684
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9189453, 'precision': 0.9291246, 'recall': 0.9201821, 'specificity': 0.9201821, 'f1': 0.9186037, 'auroc': 0.99277616, 'binary_precision': 0.9992384, 'binary_recall': 0.84102565, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.913331}
confusion matrix:
      0     1
0  1511     1
1   248  1312
---- Validation: 
scalar performance:
{'acc': 0.67615384, 'precision': 0.7703217, 'recall': 0.6715436, 'specificity': 0.6715436, 'f1': 0.6417235, 'auroc': 0.8826847, 'binary_precision': 0.92607003, 'binary_recall': 0.371875, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.53065777}
confusion matrix:
     0    1
0  641   19
1  402  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7751092, 'precision': 0.82944375, 'recall': 0.7751092, 'specificity': 0.7751092, 'f1': 0.7654377, 'auroc': 0.91949046, 'binary_precision': 0.9632353, 'binary_recall': 0.5720524, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.71780825}
confusion matrix:
     0    1
0  224    5
1   98  131
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:55:57.386621,epoch time: 0:02:47.930937,used: 0:02:47.930937,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97526044, 'precision': 0.97525436, 'recall': 0.97525436, 'specificity': 0.97525436, 'f1': 0.97525436, 'auroc': 0.9972205, 'binary_precision': 0.975641, 'binary_recall': 0.975641, 'binary_specificity': 0.9748677, 'binary_f1_score': 0.975641}
confusion matrix:
      0     1
0  1474    38
1    38  1522
---- Validation: 
scalar performance:
{'acc': 0.7776923, 'precision': 0.81864417, 'recall': 0.7749053, 'specificity': 0.7749053, 'f1': 0.7690841, 'auroc': 0.89559186, 'binary_precision': 0.9290953, 'binary_recall': 0.59375, 'binary_specificity': 0.9560606, 'binary_f1_score': 0.7244995}
confusion matrix:
     0    1
0  631   29
1  260  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83406115, 'precision': 0.86236423, 'recall': 0.83406115, 'specificity': 0.83406115, 'f1': 0.8307564, 'auroc': 0.92921567, 'binary_precision': 0.96363634, 'binary_recall': 0.6943231, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.8071066}
confusion matrix:
     0    1
0  223    6
1   70  159
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:58:46.150702,epoch time: 0:02:48.764081,used: 0:05:36.695018,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9713542, 'precision': 0.9716867, 'recall': 0.9716219, 'specificity': 0.9716219, 'f1': 0.971354, 'auroc': 0.9980935, 'binary_precision': 0.98871183, 'binary_recall': 0.9544872, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.9712981}
confusion matrix:
      0     1
0  1495    17
1    71  1489
---- Validation: 
scalar performance:
{'acc': 0.7630769, 'precision': 0.81996405, 'recall': 0.75980115, 'specificity': 0.75980115, 'f1': 0.7504885, 'auroc': 0.8984778, 'binary_precision': 0.95108694, 'binary_recall': 0.546875, 'binary_specificity': 0.9727273, 'binary_f1_score': 0.6944444}
confusion matrix:
     0    1
0  642   18
1  290  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231441, 'precision': 0.86679655, 'recall': 0.8231441, 'specificity': 0.8231441, 'f1': 0.8177209, 'auroc': 0.92538285, 'binary_precision': 0.99333334, 'binary_recall': 0.65065503, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.78627974}
confusion matrix:
     0    1
0  228    1
1   80  149
early stop counter: 1
val acc:0.763076901435852, best validation acc: 0.7776923179626465, corresponding to test acc:                         0.8340611457824707 / 0.8340611457824707
after epoch: 3,now: 2024-07-26 05:01:32.520998,epoch time: 0:02:46.370296,used: 0:08:23.065314,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98349917, 'recall': 0.9835826, 'specificity': 0.9835826, 'f1': 0.9833982, 'auroc': 0.9992509, 'binary_precision': 0.9954038, 'binary_recall': 0.97179484, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.9834577}
confusion matrix:
      0     1
0  1505     7
1    44  1516
---- Validation: 
scalar performance:
{'acc': 0.7315385, 'precision': 0.80358976, 'recall': 0.72774625, 'specificity': 0.72774625, 'f1': 0.7124431, 'auroc': 0.90628076, 'binary_precision': 0.94769233, 'binary_recall': 0.48125, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.63834196}
confusion matrix:
     0    1
0  643   17
1  332  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7008734, 'precision': 0.81284153, 'recall': 0.7008734, 'specificity': 0.7008734, 'f1': 0.6714783, 'auroc': 0.9194523, 'binary_precision': 1.0, 'binary_recall': 0.40174672, 'binary_specificity': 1.0, 'binary_f1_score': 0.5732087}
confusion matrix:
     0   1
0  229   0
1  137  92
early stop counter: 2
val acc:0.7315384745597839, best validation acc: 0.7776923179626465, corresponding to test acc:                         0.8340611457824707 / 0.8340611457824707
after epoch: 4,now: 2024-07-26 05:04:19.862489,epoch time: 0:02:47.341491,used: 0:11:10.406805,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9685498, 'recall': 0.96833026, 'specificity': 0.96833026, 'f1': 0.9684104, 'auroc': 0.9964044, 'binary_precision': 0.96385545, 'binary_recall': 0.974359, 'binary_specificity': 0.9623016, 'binary_f1_score': 0.9690788}
confusion matrix:
      0     1
0  1455    57
1    40  1520
---- Validation: 
scalar performance:
{'acc': 0.7592308, 'precision': 0.81573164, 'recall': 0.7559422, 'specificity': 0.7559422, 'f1': 0.7463455, 'auroc': 0.91438687, 'binary_precision': 0.94550407, 'binary_recall': 0.5421875, 'binary_specificity': 0.969697, 'binary_f1_score': 0.6891757}
confusion matrix:
     0    1
0  640   20
1  293  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6462882, 'precision': 0.7791971, 'recall': 0.6462882, 'specificity': 0.6462882, 'f1': 0.59850645, 'auroc': 0.9409622, 'binary_precision': 0.97183096, 'binary_recall': 0.30131003, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.45999998}
confusion matrix:
     0   1
0  227   2
1  160  69
early stop counter: 3
val acc:0.7592307925224304, best validation acc: 0.7776923179626465, corresponding to test acc:                         0.8340611457824707 / 0.8340611457824707
after epoch: 5,now: 2024-07-26 05:07:06.537718,epoch time: 0:02:46.675229,used: 0:13:57.082034,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9813756, 'recall': 0.9809829, 'specificity': 0.9809829, 'f1': 0.98110884, 'auroc': 0.9990754, 'binary_precision': 0.9735183, 'binary_recall': 0.9897436, 'binary_specificity': 0.9722222, 'binary_f1_score': 0.9815639}
confusion matrix:
      0     1
0  1470    42
1    16  1544
---- Validation: 
scalar performance:
{'acc': 0.86923075, 'precision': 0.87319195, 'recall': 0.86844224, 'specificity': 0.86844224, 'f1': 0.8686825, 'auroc': 0.91526514, 'binary_precision': 0.9079861, 'binary_recall': 0.8171875, 'binary_specificity': 0.919697, 'binary_f1_score': 0.8601973}
confusion matrix:
     0    1
0  607   53
1  117  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8794439, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.86808753, 'auroc': 0.9302263, 'binary_precision': 0.9424084, 'binary_recall': 0.7860262, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  218   11
1   49  180
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 05:09:53.943333,epoch time: 0:02:47.405615,used: 0:16:44.487649,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.9805591, 'recall': 0.9806471, 'specificity': 0.9806471, 'f1': 0.9804684, 'auroc': 0.99895966, 'binary_precision': 0.992126, 'binary_recall': 0.9692308, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.98054475}
confusion matrix:
      0     1
0  1500    12
1    48  1512
---- Validation: 
scalar performance:
{'acc': 0.7592308, 'precision': 0.81275034, 'recall': 0.7560133, 'specificity': 0.7560133, 'f1': 0.74689466, 'auroc': 0.8961387, 'binary_precision': 0.9383378, 'binary_recall': 0.546875, 'binary_specificity': 0.9651515, 'binary_f1_score': 0.6910168}
confusion matrix:
     0    1
0  637   23
1  290  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7489083, 'precision': 0.815168, 'recall': 0.7489083, 'specificity': 0.7489083, 'f1': 0.73497903, 'auroc': 0.9154669, 'binary_precision': 0.9596774, 'binary_recall': 0.51965064, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.674221}
confusion matrix:
     0    1
0  224    5
1  110  119
early stop counter: 1
val acc:0.7592307925224304, best validation acc: 0.8692307472229004, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 7,now: 2024-07-26 05:12:39.800880,epoch time: 0:02:45.857547,used: 0:19:30.345196,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98695606, 'recall': 0.9870676, 'specificity': 0.9870676, 'f1': 0.98697793, 'auroc': 0.99948406, 'binary_precision': 0.9928664, 'binary_recall': 0.98141026, 'binary_specificity': 0.9927249, 'binary_f1_score': 0.98710513}
confusion matrix:
      0     1
0  1501    11
1    29  1531
---- Validation: 
scalar performance:
{'acc': 0.8330769, 'precision': 0.84317076, 'recall': 0.8317472, 'specificity': 0.8317472, 'f1': 0.8314169, 'auroc': 0.9048029, 'binary_precision': 0.89830506, 'binary_recall': 0.7453125, 'binary_specificity': 0.91818184, 'binary_f1_score': 0.81468827}
confusion matrix:
     0    1
0  606   54
1  163  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.8338058, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.81419873, 'auroc': 0.90524113, 'binary_precision': 0.90960455, 'binary_recall': 0.70305675, 'binary_specificity': 0.930131, 'binary_f1_score': 0.7931034}
confusion matrix:
     0    1
0  213   16
1   68  161
early stop counter: 2
val acc:0.8330768942832947, best validation acc: 0.8692307472229004, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 8,now: 2024-07-26 05:15:25.969195,epoch time: 0:02:46.168315,used: 0:22:16.513511,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.9727355, 'recall': 0.9721052, 'specificity': 0.9721052, 'f1': 0.97167563, 'auroc': 0.99942684, 'binary_precision': 0.99932206, 'binary_recall': 0.9448718, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.97133446}
confusion matrix:
      0     1
0  1511     1
1    86  1474
---- Validation: 
scalar performance:
{'acc': 0.72692305, 'precision': 0.8102397, 'recall': 0.722893, 'specificity': 0.722893, 'f1': 0.7049185, 'auroc': 0.91685075, 'binary_precision': 0.9672131, 'binary_recall': 0.4609375, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.62433857}
confusion matrix:
     0    1
0  650   10
1  345  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6834061, 'precision': 0.80063766, 'recall': 0.6834061, 'specificity': 0.6834061, 'f1': 0.64920896, 'auroc': 0.919705, 'binary_precision': 0.9883721, 'binary_recall': 0.37117904, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.5396825}
confusion matrix:
     0   1
0  228   1
1  144  85
early stop counter: 3
val acc:0.7269230484962463, best validation acc: 0.8692307472229004, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 9,now: 2024-07-26 05:18:11.447486,epoch time: 0:02:45.478291,used: 0:25:01.991802,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883304, 'recall': 0.9882377, 'specificity': 0.9882377, 'f1': 0.9882773, 'auroc': 0.9995078, 'binary_precision': 0.98596936, 'binary_recall': 0.9910256, 'binary_specificity': 0.98544973, 'binary_f1_score': 0.98849106}
confusion matrix:
      0     1
0  1490    22
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.74, 'precision': 0.805913, 'recall': 0.7363873, 'specificity': 0.7363873, 'f1': 0.72323, 'auroc': 0.9016371, 'binary_precision': 0.94411767, 'binary_recall': 0.5015625, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.655102}
confusion matrix:
     0    1
0  641   19
1  319  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79257643, 'precision': 0.8368238, 'recall': 0.79257643, 'specificity': 0.79257643, 'f1': 0.78553295, 'auroc': 0.9193951, 'binary_precision': 0.9589041, 'binary_recall': 0.6113537, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.74666667}
confusion matrix:
     0    1
0  223    6
1   89  140
early stop counter: 4
val acc:0.7400000095367432, best validation acc: 0.8692307472229004, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 10,now: 2024-07-26 05:20:57.706062,epoch time: 0:02:46.258576,used: 0:27:48.250378,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98516005, 'recall': 0.9852259, 'specificity': 0.9852259, 'f1': 0.9850259, 'auroc': 0.99963796, 'binary_precision': 0.9980263, 'binary_recall': 0.9724359, 'binary_specificity': 0.9980159, 'binary_f1_score': 0.9850649}
confusion matrix:
      0     1
0  1509     3
1    43  1517
---- Validation: 
scalar performance:
{'acc': 0.72384614, 'precision': 0.7994118, 'recall': 0.71993375, 'specificity': 0.71993375, 'f1': 0.70292336, 'auroc': 0.9109523, 'binary_precision': 0.94603175, 'binary_recall': 0.465625, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.62408376}
confusion matrix:
     0    1
0  643   17
1  342  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80349344, 'precision': 0.8533245, 'recall': 0.80349344, 'specificity': 0.80349344, 'f1': 0.79631174, 'auroc': 0.930131, 'binary_precision': 0.986014, 'binary_recall': 0.6157205, 'binary_specificity': 0.99126637, 'binary_f1_score': 0.75806457}
confusion matrix:
     0    1
0  227    2
1   88  141
early stop counter: 5
val acc:0.7238461375236511, best validation acc: 0.8692307472229004, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 11,now: 2024-07-26 05:23:45.536384,epoch time: 0:02:47.830322,used: 0:30:36.080700,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_53_09_seed_7_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:30:36.080700 at 2024-07-26 05:23:45.536384
persisted model performance metric: 

scalar performance:
{'acc': 0.8689956, 'precision': 0.8794439, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.86808753, 'auroc': 0.9302263, 'binary_precision': 0.9424084, 'binary_recall': 0.7860262, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  218   11
1   49  180
oracle model performance metric: 

scalar performance:
{'acc': 0.8689956, 'precision': 0.8794439, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.86808753, 'auroc': 0.9302263, 'binary_precision': 0.9424084, 'binary_recall': 0.7860262, 'binary_specificity': 0.9519651, 'binary_f1_score': 0.8571428}
confusion matrix:
     0    1
0  218   11
1   49  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2396 MiB |   8917 MiB | 706619 GiB | 706616 GiB |
|       from large pool |   2304 MiB |   8841 MiB | 700440 GiB | 700437 GiB |
|       from small pool |     91 MiB |    132 MiB |   6179 GiB |   6178 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2396 MiB |   8917 MiB | 706619 GiB | 706616 GiB |
|       from large pool |   2304 MiB |   8841 MiB | 700440 GiB | 700437 GiB |
|       from small pool |     91 MiB |    132 MiB |   6179 GiB |   6178 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 705677 GiB | 705675 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 699507 GiB | 699505 GiB |
|       from small pool |     91 MiB |    132 MiB |   6169 GiB |   6169 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9742 MiB |   9824 MiB |  53810 MiB |  44068 MiB |
|       from large pool |   9606 MiB |   9688 MiB |  53430 MiB |  43824 MiB |
|       from small pool |    136 MiB |    140 MiB |    380 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    911 MiB |   1892 MiB | 511843 GiB | 511842 GiB |
|       from large pool |    901 MiB |   1887 MiB | 505488 GiB | 505487 GiB |
|       from small pool |     10 MiB |     62 MiB |   6355 GiB |   6355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |  100463 K  |  100461 K  |
|       from large pool |     392    |     816    |   50461 K  |   50461 K  |
|       from small pool |    2084    |    2780    |   50002 K  |   49999 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |  100463 K  |  100461 K  |
|       from large pool |     392    |     816    |   50461 K  |   50461 K  |
|       from small pool |    2084    |    2780    |   50002 K  |   49999 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |    1405    |    1119    |
|       from large pool |     218    |     265    |    1215    |     997    |
|       from small pool |      68    |      70    |     190    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     137    |     319    |   55675 K  |   55675 K  |
|       from large pool |      66    |     255    |   29826 K  |   29826 K  |
|       from small pool |      71    |     227    |   25849 K  |   25849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8917 MiB | 706619 GiB | 706619 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 700440 GiB | 700440 GiB |
|       from small pool |      0 KiB |    132 MiB |   6179 GiB |   6179 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8917 MiB | 706619 GiB | 706619 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 700440 GiB | 700440 GiB |
|       from small pool |      0 KiB |    132 MiB |   6179 GiB |   6179 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 705677 GiB | 705677 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 699507 GiB | 699507 GiB |
|       from small pool |      0 KiB |    132 MiB |   6169 GiB |   6169 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3308 MiB |   9824 MiB |  53810 MiB |  50502 MiB |
|       from large pool |   3206 MiB |   9688 MiB |  53430 MiB |  50224 MiB |
|       from small pool |    102 MiB |    140 MiB |    380 MiB |    278 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 511844 GiB | 511844 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 505489 GiB | 505489 GiB |
|       from small pool |      0 KiB |     62 MiB |   6355 GiB |   6355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  100463 K  |  100463 K  |
|       from large pool |       2    |     816    |   50461 K  |   50461 K  |
|       from small pool |       0    |    2780    |   50002 K  |   50002 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  100463 K  |  100463 K  |
|       from large pool |       2    |     816    |   50461 K  |   50461 K  |
|       from small pool |       0    |    2780    |   50002 K  |   50002 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     333    |    1405    |    1278    |
|       from large pool |      76    |     265    |    1215    |    1139    |
|       from small pool |      51    |      70    |     190    |     139    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   55676 K  |   55676 K  |
|       from large pool |       3    |     255    |   29826 K  |   29826 K  |
|       from small pool |       0    |     227    |   25849 K  |   25849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8917 MiB | 706619 GiB | 706619 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 700440 GiB | 700440 GiB |
|       from small pool |      0 KiB |    132 MiB |   6179 GiB |   6179 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8917 MiB | 706619 GiB | 706619 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 700440 GiB | 700440 GiB |
|       from small pool |      0 KiB |    132 MiB |   6179 GiB |   6179 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 705677 GiB | 705677 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 699507 GiB | 699507 GiB |
|       from small pool |      0 KiB |    132 MiB |   6169 GiB |   6169 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3308 MiB |   9824 MiB |  53810 MiB |  50502 MiB |
|       from large pool |   3206 MiB |   9688 MiB |  53430 MiB |  50224 MiB |
|       from small pool |    102 MiB |    140 MiB |    380 MiB |    278 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 511844 GiB | 511844 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 505489 GiB | 505489 GiB |
|       from small pool |      0 KiB |     62 MiB |   6355 GiB |   6355 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  100463 K  |  100463 K  |
|       from large pool |       2    |     816    |   50461 K  |   50461 K  |
|       from small pool |       0    |    2780    |   50002 K  |   50002 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  100463 K  |  100463 K  |
|       from large pool |       2    |     816    |   50461 K  |   50461 K  |
|       from small pool |       0    |    2780    |   50002 K  |   50002 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     333    |    1405    |    1278    |
|       from large pool |      76    |     265    |    1215    |    1139    |
|       from small pool |      51    |      70    |     190    |     139    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   55676 K  |   55676 K  |
|       from large pool |       3    |     255    |   29826 K  |   29826 K  |
|       from small pool |       0    |     227    |   25849 K  |   25849 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731

 Experiment start at: 2024-07-26 05:24:22.365384
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96085525, 'precision': 0.9613329, 'recall': 0.9610483, 'specificity': 0.9610483, 'f1': 0.9608526, 'auroc': 0.99348485, 'binary_precision': 0.9790399, 'binary_recall': 0.9427083, 'binary_specificity': 0.9793883, 'binary_f1_score': 0.9605307}
confusion matrix:
      0     1
0  1473    31
1    88  1448
---- Validation: 
scalar performance:
{'acc': 0.8522815, 'precision': 0.85803366, 'recall': 0.8502426, 'specificity': 0.8502426, 'f1': 0.8510409, 'auroc': 0.92278147, 'binary_precision': 0.89617485, 'binary_recall': 0.7859425, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.8374468}
confusion matrix:
     0    1
0  610   57
1  134  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8348624, 'precision': 0.86037135, 'recall': 0.83486235, 'specificity': 0.83486235, 'f1': 0.8318874, 'auroc': 0.9136436, 'binary_precision': 0.95625, 'binary_recall': 0.70183486, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.8095238}
confusion matrix:
     0    1
0  211    7
1   65  153
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:27:09.770150,epoch time: 0:02:47.404766,used: 0:02:47.404766,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96907896, 'precision': 0.9697161, 'recall': 0.9688767, 'specificity': 0.9688767, 'f1': 0.9690542, 'auroc': 0.9970212, 'binary_precision': 0.9552615, 'binary_recall': 0.9850552, 'binary_specificity': 0.95269823, 'binary_f1_score': 0.96992964}
confusion matrix:
      0     1
0  1430    71
1    23  1516
---- Validation: 
scalar performance:
{'acc': 0.83139986, 'precision': 0.8328309, 'recall': 0.83024824, 'specificity': 0.83024824, 'f1': 0.83073556, 'auroc': 0.89891076, 'binary_precision': 0.8481229, 'binary_recall': 0.7939297, 'binary_specificity': 0.8665667, 'binary_f1_score': 0.820132}
confusion matrix:
     0    1
0  578   89
1  129  497
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85091746, 'precision': 0.8548676, 'recall': 0.85091746, 'specificity': 0.85091746, 'f1': 0.8505014, 'auroc': 0.9137068, 'binary_precision': 0.8923077, 'binary_recall': 0.79816514, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.84261507}
confusion matrix:
     0    1
0  197   21
1   44  174
new oracle model saved
early stop counter: 1
val acc:0.8313998579978943, best validation acc: 0.8522815108299255, corresponding to test acc:                         0.8348624110221863 / 0.8509174585342407
after epoch: 2,now: 2024-07-26 05:30:00.137597,epoch time: 0:02:50.367447,used: 0:05:37.772213,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.82335526, 'precision': 0.8688326, 'recall': 0.8216207, 'specificity': 0.8216207, 'f1': 0.8171735, 'auroc': 0.9901674, 'binary_precision': 0.7417636, 'binary_recall': 0.99739414, 'binary_specificity': 0.6458472, 'binary_f1_score': 0.85079193}
confusion matrix:
     0     1
0  972   533
1    4  1531
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.85213804, 'recall': 0.8500786, 'specificity': 0.8500786, 'f1': 0.8483157, 'auroc': 0.92860365, 'binary_precision': 0.80714285, 'binary_recall': 0.9025559, 'binary_specificity': 0.7976012, 'binary_f1_score': 0.85218704}
confusion matrix:
     0    1
0  532  135
1   61  565
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.82815427, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.827959, 'auroc': 0.90057653, 'binary_precision': 0.8206278, 'binary_recall': 0.8394495, 'binary_specificity': 0.8165138, 'binary_f1_score': 0.829932}
confusion matrix:
     0    1
0  178   40
1   35  183
early stop counter: 2
val acc:0.8484145402908325, best validation acc: 0.8522815108299255, corresponding to test acc:                         0.8348624110221863 / 0.8509174585342407
after epoch: 3,now: 2024-07-26 05:32:46.102435,epoch time: 0:02:45.964838,used: 0:08:23.737051,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97664475, 'precision': 0.9772383, 'recall': 0.97688687, 'specificity': 0.97688687, 'f1': 0.97664285, 'auroc': 0.9976945, 'binary_precision': 0.9972881, 'binary_recall': 0.95643693, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.9764354}
confusion matrix:
      0     1
0  1498     4
1    67  1471
---- Validation: 
scalar performance:
{'acc': 0.8221191, 'precision': 0.8284197, 'recall': 0.81982887, 'specificity': 0.81982887, 'f1': 0.8203863, 'auroc': 0.905746, 'binary_precision': 0.8666667, 'binary_recall': 0.74760383, 'binary_specificity': 0.89205396, 'binary_f1_score': 0.8027445}
confusion matrix:
     0    1
0  595   72
1  158  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.8403139, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.83677727, 'auroc': 0.8883301, 'binary_precision': 0.87309647, 'binary_recall': 0.78899086, 'binary_specificity': 0.8853211, 'binary_f1_score': 0.82891566}
confusion matrix:
     0    1
0  193   25
1   46  172
early stop counter: 3
val acc:0.8221191167831421, best validation acc: 0.8522815108299255, corresponding to test acc:                         0.8348624110221863 / 0.8509174585342407
after epoch: 4,now: 2024-07-26 05:35:31.716319,epoch time: 0:02:45.613884,used: 0:11:09.350935,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9611842, 'precision': 0.9632462, 'recall': 0.9608335, 'specificity': 0.9608335, 'f1': 0.96111524, 'auroc': 0.9979824, 'binary_precision': 0.9350092, 'binary_recall': 0.99219257, 'binary_specificity': 0.9294744, 'binary_f1_score': 0.9627525}
confusion matrix:
      0     1
0  1397   106
1    12  1525
---- Validation: 
scalar performance:
{'acc': 0.81825215, 'precision': 0.83021367, 'recall': 0.82123595, 'specificity': 0.82123595, 'f1': 0.81740636, 'auroc': 0.91921055, 'binary_precision': 0.7589404, 'binary_recall': 0.9153355, 'binary_specificity': 0.72713643, 'binary_f1_score': 0.82983345}
confusion matrix:
     0    1
0  485  182
1   53  573
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8944954, 'precision': 0.90018785, 'recall': 0.8944954, 'specificity': 0.8944954, 'f1': 0.8941189, 'auroc': 0.9465953, 'binary_precision': 0.9479167, 'binary_recall': 0.8348624, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.88780487}
confusion matrix:
     0    1
0  208   10
1   36  182
new oracle model saved
early stop counter: 4
val acc:0.8182521462440491, best validation acc: 0.8522815108299255, corresponding to test acc:                         0.8348624110221863 / 0.89449542760849
after epoch: 5,now: 2024-07-26 05:38:17.723036,epoch time: 0:02:46.006717,used: 0:13:55.357652,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.9782258, 'recall': 0.97812337, 'specificity': 0.97812337, 'f1': 0.9779602, 'auroc': 0.99856067, 'binary_precision': 0.9926273, 'binary_recall': 0.9635654, 'binary_specificity': 0.9926813, 'binary_f1_score': 0.9778805}
confusion matrix:
      0     1
0  1492    11
1    56  1481
---- Validation: 
scalar performance:
{'acc': 0.8638824, 'precision': 0.866315, 'recall': 0.8625671, 'specificity': 0.8625671, 'f1': 0.8632345, 'auroc': 0.9277103, 'binary_precision': 0.88927335, 'binary_recall': 0.8210863, 'binary_specificity': 0.90404797, 'binary_f1_score': 0.8538206}
confusion matrix:
     0    1
0  603   64
1  112  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85779816, 'precision': 0.8729929, 'recall': 0.8577982, 'specificity': 0.8577982, 'f1': 0.85633504, 'auroc': 0.9226286, 'binary_precision': 0.94827586, 'binary_recall': 0.75688076, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.8418368}
confusion matrix:
     0    1
0  209    9
1   53  165
better model found
persisted
after epoch: 6,now: 2024-07-26 05:41:02.973892,epoch time: 0:02:45.250856,used: 0:16:40.608508,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9802632, 'precision': 0.98040795, 'recall': 0.9801917, 'specificity': 0.9801917, 'f1': 0.9802574, 'auroc': 0.99849486, 'binary_precision': 0.97429305, 'binary_recall': 0.9869792, 'binary_specificity': 0.9734042, 'binary_f1_score': 0.9805951}
confusion matrix:
      0     1
0  1464    40
1    20  1516
---- Validation: 
scalar performance:
{'acc': 0.81051815, 'precision': 0.8139118, 'recall': 0.8087318, 'specificity': 0.8087318, 'f1': 0.8092361, 'auroc': 0.88904166, 'binary_precision': 0.8395722, 'binary_recall': 0.75239617, 'binary_specificity': 0.8650675, 'binary_f1_score': 0.79359734}
confusion matrix:
     0    1
0  577   90
1  155  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76834863, 'precision': 0.79114443, 'recall': 0.76834863, 'specificity': 0.76834863, 'f1': 0.76372373, 'auroc': 0.8755156, 'binary_precision': 0.87261146, 'binary_recall': 0.6284404, 'binary_specificity': 0.9082569, 'binary_f1_score': 0.7306667}
confusion matrix:
     0    1
0  198   20
1   81  137
early stop counter: 1
val acc:0.8105181455612183, best validation acc: 0.8638824224472046, corresponding to test acc:                         0.857798159122467 / 0.89449542760849
after epoch: 7,now: 2024-07-26 05:43:47.174842,epoch time: 0:02:44.200950,used: 0:19:24.809458,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9832237, 'precision': 0.983271, 'recall': 0.98318624, 'specificity': 0.98318624, 'f1': 0.98322, 'auroc': 0.99886155, 'binary_precision': 0.9806076, 'binary_recall': 0.9863459, 'binary_specificity': 0.9800266, 'binary_f1_score': 0.98346835}
confusion matrix:
      0     1
0  1472    30
1    21  1517
---- Validation: 
scalar performance:
{'acc': 0.7904099, 'precision': 0.79325414, 'recall': 0.7886524, 'specificity': 0.7886524, 'f1': 0.7890451, 'auroc': 0.8821867, 'binary_precision': 0.8152753, 'binary_recall': 0.73322684, 'binary_specificity': 0.84407794, 'binary_f1_score': 0.7720773}
confusion matrix:
     0    1
0  563  104
1  167  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78669727, 'precision': 0.8207165, 'recall': 0.78669727, 'specificity': 0.78669727, 'f1': 0.78088677, 'auroc': 0.8953371, 'binary_precision': 0.92517006, 'binary_recall': 0.6238532, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.74520546}
confusion matrix:
     0    1
0  207   11
1   82  136
early stop counter: 2
val acc:0.7904099225997925, best validation acc: 0.8638824224472046, corresponding to test acc:                         0.857798159122467 / 0.89449542760849
after epoch: 8,now: 2024-07-26 05:46:31.660961,epoch time: 0:02:44.486119,used: 0:22:09.295577,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98092103, 'precision': 0.9811345, 'recall': 0.981082, 'specificity': 0.981082, 'f1': 0.98092103, 'auroc': 0.99848366, 'binary_precision': 0.9946524, 'binary_recall': 0.96749026, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.9808833}
confusion matrix:
      0     1
0  1494     8
1    50  1488
---- Validation: 
scalar performance:
{'acc': 0.8074246, 'precision': 0.82833344, 'recall': 0.80332756, 'specificity': 0.80332756, 'f1': 0.80270416, 'auroc': 0.9100809, 'binary_precision': 0.9036403, 'binary_recall': 0.6741214, 'binary_specificity': 0.93253374, 'binary_f1_score': 0.77218664}
confusion matrix:
     0    1
0  622   45
1  204  422
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6582569, 'precision': 0.73216546, 'recall': 0.6582569, 'specificity': 0.6582569, 'f1': 0.6287072, 'auroc': 0.86806667, 'binary_precision': 0.86315787, 'binary_recall': 0.3761468, 'binary_specificity': 0.940367, 'binary_f1_score': 0.52396166}
confusion matrix:
     0   1
0  205  13
1  136  82
early stop counter: 3
val acc:0.8074246048927307, best validation acc: 0.8638824224472046, corresponding to test acc:                         0.857798159122467 / 0.89449542760849
after epoch: 9,now: 2024-07-26 05:49:16.114598,epoch time: 0:02:44.453637,used: 0:24:53.749214,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.98916715, 'recall': 0.98912376, 'specificity': 0.98912376, 'f1': 0.9891428, 'auroc': 0.9991702, 'binary_precision': 0.98768634, 'binary_recall': 0.9908973, 'binary_specificity': 0.9873502, 'binary_f1_score': 0.9892893}
confusion matrix:
      0     1
0  1483    19
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.86001545, 'precision': 0.86454743, 'recall': 0.8582299, 'specificity': 0.8582299, 'f1': 0.859032, 'auroc': 0.9298059, 'binary_precision': 0.8980322, 'binary_recall': 0.80191696, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.84725744}
confusion matrix:
     0    1
0  610   57
1  124  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71330273, 'precision': 0.799601, 'recall': 0.71330273, 'specificity': 0.71330273, 'f1': 0.69105536, 'auroc': 0.9058318, 'binary_precision': 0.96039605, 'binary_recall': 0.44495413, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.6081505}
confusion matrix:
     0   1
0  214   4
1  121  97
early stop counter: 4
val acc:0.8600154519081116, best validation acc: 0.8638824224472046, corresponding to test acc:                         0.857798159122467 / 0.89449542760849
after epoch: 10,now: 2024-07-26 05:51:59.927468,epoch time: 0:02:43.812870,used: 0:27:37.562084,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98355263, 'precision': 0.9836828, 'recall': 0.98366857, 'specificity': 0.98366857, 'f1': 0.98355263, 'auroc': 0.9985373, 'binary_precision': 0.9946738, 'binary_recall': 0.97265625, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.98354185}
confusion matrix:
      0     1
0  1496     8
1    42  1494
---- Validation: 
scalar performance:
{'acc': 0.79737043, 'precision': 0.837446, 'recall': 0.791815, 'specificity': 0.791815, 'f1': 0.7889004, 'auroc': 0.9319805, 'binary_precision': 0.9460784, 'binary_recall': 0.61661345, 'binary_specificity': 0.9670165, 'binary_f1_score': 0.74661505}
confusion matrix:
     0    1
0  645   22
1  240  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73165137, 'precision': 0.8253732, 'recall': 0.73165137, 'specificity': 0.73165137, 'f1': 0.7108278, 'auroc': 0.927989, 'binary_precision': 1.0, 'binary_recall': 0.46330276, 'binary_specificity': 1.0, 'binary_f1_score': 0.63322884}
confusion matrix:
     0    1
0  218    0
1  117  101
early stop counter: 5
val acc:0.797370433807373, best validation acc: 0.8638824224472046, corresponding to test acc:                         0.857798159122467 / 0.89449542760849
after epoch: 11,now: 2024-07-26 05:54:44.566296,epoch time: 0:02:44.638828,used: 0:30:22.200912,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_24_22_seed_8_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:30:22.200912 at 2024-07-26 05:54:44.566296
persisted model performance metric: 

scalar performance:
{'acc': 0.85779816, 'precision': 0.8729929, 'recall': 0.8577982, 'specificity': 0.8577982, 'f1': 0.85633504, 'auroc': 0.9226286, 'binary_precision': 0.94827586, 'binary_recall': 0.75688076, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.8418368}
confusion matrix:
     0    1
0  209    9
1   53  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8944954, 'precision': 0.90018785, 'recall': 0.8944954, 'specificity': 0.8944954, 'f1': 0.8941189, 'auroc': 0.9465953, 'binary_precision': 0.9479167, 'binary_recall': 0.8348624, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.88780487}
confusion matrix:
     0    1
0  208   10
1   36  182
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2391 MiB |   8917 MiB | 779296 GiB | 779294 GiB |
|       from large pool |   2300 MiB |   8841 MiB | 772481 GiB | 772479 GiB |
|       from small pool |     91 MiB |    132 MiB |   6815 GiB |   6815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2391 MiB |   8917 MiB | 779296 GiB | 779294 GiB |
|       from large pool |   2300 MiB |   8841 MiB | 772481 GiB | 772479 GiB |
|       from small pool |     91 MiB |    132 MiB |   6815 GiB |   6815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 778296 GiB | 778294 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 771491 GiB | 771489 GiB |
|       from small pool |     91 MiB |    132 MiB |   6805 GiB |   6805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  60246 MiB |  50502 MiB |
|       from large pool |   9608 MiB |   9688 MiB |  59832 MiB |  50224 MiB |
|       from small pool |    136 MiB |    140 MiB |    414 MiB |    278 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    934 MiB |   1892 MiB | 565190 GiB | 565189 GiB |
|       from large pool |    923 MiB |   1887 MiB | 558181 GiB | 558180 GiB |
|       from small pool |     10 MiB |     62 MiB |   7009 GiB |   7009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |  110809 K  |  110806 K  |
|       from large pool |     392    |     816    |   55656 K  |   55656 K  |
|       from small pool |    2078    |    2780    |   55152 K  |   55150 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |  110809 K  |  110806 K  |
|       from large pool |     392    |     816    |   55656 K  |   55656 K  |
|       from small pool |    2078    |    2780    |   55152 K  |   55150 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |    1564    |    1278    |
|       from large pool |     218    |     265    |    1357    |    1139    |
|       from small pool |      68    |      70    |     207    |     139    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     136    |     319    |   61278 K  |   61277 K  |
|       from large pool |      70    |     255    |   32782 K  |   32782 K  |
|       from small pool |      66    |     227    |   28495 K  |   28495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8917 MiB | 779296 GiB | 779296 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 772481 GiB | 772481 GiB |
|       from small pool |      0 KiB |    132 MiB |   6815 GiB |   6815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8917 MiB | 779296 GiB | 779296 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 772481 GiB | 772481 GiB |
|       from small pool |      0 KiB |    132 MiB |   6815 GiB |   6815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 778296 GiB | 778296 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 771491 GiB | 771491 GiB |
|       from small pool |      0 KiB |    132 MiB |   6805 GiB |   6805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3326 MiB |   9824 MiB |  60246 MiB |  56920 MiB |
|       from large pool |   3224 MiB |   9688 MiB |  59832 MiB |  56608 MiB |
|       from small pool |    102 MiB |    140 MiB |    414 MiB |    312 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 565191 GiB | 565191 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 558181 GiB | 558181 GiB |
|       from small pool |      0 KiB |     62 MiB |   7009 GiB |   7009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  110809 K  |  110809 K  |
|       from large pool |       2    |     816    |   55656 K  |   55656 K  |
|       from small pool |       0    |    2780    |   55152 K  |   55152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  110809 K  |  110809 K  |
|       from large pool |       2    |     816    |   55656 K  |   55656 K  |
|       from small pool |       0    |    2780    |   55152 K  |   55152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     333    |    1564    |    1438    |
|       from large pool |      75    |     265    |    1357    |    1282    |
|       from small pool |      51    |      70    |     207    |     156    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   61278 K  |   61278 K  |
|       from large pool |       3    |     255    |   32782 K  |   32782 K  |
|       from small pool |       0    |     227    |   28495 K  |   28495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8917 MiB | 779296 GiB | 779296 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 772481 GiB | 772481 GiB |
|       from small pool |      0 KiB |    132 MiB |   6815 GiB |   6815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8917 MiB | 779296 GiB | 779296 GiB |
|       from large pool |  16640 KiB |   8841 MiB | 772481 GiB | 772481 GiB |
|       from small pool |      0 KiB |    132 MiB |   6815 GiB |   6815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 778296 GiB | 778296 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 771491 GiB | 771491 GiB |
|       from small pool |      0 KiB |    132 MiB |   6805 GiB |   6805 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3326 MiB |   9824 MiB |  60246 MiB |  56920 MiB |
|       from large pool |   3224 MiB |   9688 MiB |  59832 MiB |  56608 MiB |
|       from small pool |    102 MiB |    140 MiB |    414 MiB |    312 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 565191 GiB | 565191 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 558181 GiB | 558181 GiB |
|       from small pool |      0 KiB |     62 MiB |   7009 GiB |   7009 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  110809 K  |  110809 K  |
|       from large pool |       2    |     816    |   55656 K  |   55656 K  |
|       from small pool |       0    |    2780    |   55152 K  |   55152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  110809 K  |  110809 K  |
|       from large pool |       2    |     816    |   55656 K  |   55656 K  |
|       from small pool |       0    |    2780    |   55152 K  |   55152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     126    |     333    |    1564    |    1438    |
|       from large pool |      75    |     265    |    1357    |    1282    |
|       from small pool |      51    |      70    |     207    |     156    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   61278 K  |   61278 K  |
|       from large pool |       3    |     255    |   32782 K  |   32782 K  |
|       from small pool |       0    |     227    |   28495 K  |   28495 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731

 Experiment start at: 2024-07-26 05:55:19.191218
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95811516, 'precision': 0.9581177, 'recall': 0.95810914, 'specificity': 0.95810914, 'f1': 0.9581131, 'auroc': 0.9923856, 'binary_precision': 0.9577922, 'binary_recall': 0.9590377, 'binary_specificity': 0.9571805, 'binary_f1_score': 0.9584146}
confusion matrix:
      0     1
0  1453    65
1    63  1475
---- Validation: 
scalar performance:
{'acc': 0.8355212, 'precision': 0.8358673, 'recall': 0.835683, 'specificity': 0.835683, 'f1': 0.83551145, 'auroc': 0.9119972, 'binary_precision': 0.82228917, 'binary_recall': 0.85179406, 'binary_specificity': 0.81957185, 'binary_f1_score': 0.8367816}
confusion matrix:
     0    1
0  536  118
1   95  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8000908, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.7999848, 'auroc': 0.8904537, 'binary_precision': 0.8053097, 'binary_recall': 0.79130435, 'binary_specificity': 0.8086957, 'binary_f1_score': 0.79824555}
confusion matrix:
     0    1
0  186   44
1   48  182
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:58:06.330142,epoch time: 0:02:47.138924,used: 0:02:47.138924,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.9732225, 'recall': 0.97295433, 'specificity': 0.97295433, 'f1': 0.97283816, 'auroc': 0.9969054, 'binary_precision': 0.9885906, 'binary_recall': 0.957115, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9725982}
confusion matrix:
      0     1
0  1500    17
1    66  1473
---- Validation: 
scalar performance:
{'acc': 0.7776062, 'precision': 0.8207102, 'recall': 0.77575415, 'specificity': 0.77575415, 'f1': 0.7690685, 'auroc': 0.9155849, 'binary_precision': 0.93580246, 'binary_recall': 0.59126365, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.7246654}
confusion matrix:
     0    1
0  628   26
1  262  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6434783, 'precision': 0.7847389, 'recall': 0.6434783, 'specificity': 0.6434783, 'f1': 0.5929994, 'auroc': 0.9102458, 'binary_precision': 0.9852941, 'binary_recall': 0.29130435, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.4496644}
confusion matrix:
     0   1
0  229   1
1  163  67
early stop counter: 1
val acc:0.777606189250946, best validation acc: 0.8355212211608887, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 2,now: 2024-07-26 06:00:51.456533,epoch time: 0:02:45.126391,used: 0:05:32.265315,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98070145, 'recall': 0.9806848, 'specificity': 0.9806848, 'f1': 0.9806922, 'auroc': 0.99856335, 'binary_precision': 0.97990924, 'binary_recall': 0.9818182, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.9808628}
confusion matrix:
      0     1
0  1485    31
1    28  1512
---- Validation: 
scalar performance:
{'acc': 0.81621623, 'precision': 0.8293861, 'recall': 0.81520534, 'specificity': 0.81520534, 'f1': 0.81401134, 'auroc': 0.90050185, 'binary_precision': 0.8927875, 'binary_recall': 0.7145086, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.79376084}
confusion matrix:
     0    1
0  599   55
1  183  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7695652, 'precision': 0.8236202, 'recall': 0.7695652, 'specificity': 0.7695652, 'f1': 0.75952333, 'auroc': 0.89769375, 'binary_precision': 0.9558824, 'binary_recall': 0.5652174, 'binary_specificity': 0.973913, 'binary_f1_score': 0.71038246}
confusion matrix:
     0    1
0  224    6
1  100  130
early stop counter: 2
val acc:0.816216230392456, best validation acc: 0.8355212211608887, corresponding to test acc:                         0.800000011920929 / 0.800000011920929
after epoch: 3,now: 2024-07-26 06:03:36.816411,epoch time: 0:02:45.359878,used: 0:08:17.625193,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.976767, 'precision': 0.97744244, 'recall': 0.9769142, 'specificity': 0.9769142, 'f1': 0.97676283, 'auroc': 0.9982846, 'binary_precision': 0.99728996, 'binary_recall': 0.95646524, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.9764511}
confusion matrix:
      0     1
0  1513     4
1    67  1472
---- Validation: 
scalar performance:
{'acc': 0.7019305, 'precision': 0.78718865, 'recall': 0.69917154, 'specificity': 0.69917154, 'f1': 0.676208, 'auroc': 0.9209497, 'binary_precision': 0.9411765, 'binary_recall': 0.42433697, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.5849462}
confusion matrix:
     0    1
0  637   17
1  369  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8130435, 'precision': 0.8537252, 'recall': 0.8130435, 'specificity': 0.8130435, 'f1': 0.80750895, 'auroc': 0.9226465, 'binary_precision': 0.9736842, 'binary_recall': 0.6434783, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.7748691}
confusion matrix:
     0    1
0  226    4
1   82  148
new oracle model saved
early stop counter: 3
val acc:0.7019305229187012, best validation acc: 0.8355212211608887, corresponding to test acc:                         0.800000011920929 / 0.813043475151062
after epoch: 4,now: 2024-07-26 06:06:22.568113,epoch time: 0:02:45.751702,used: 0:11:03.376895,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.98690754, 'recall': 0.98692757, 'specificity': 0.98692757, 'f1': 0.9869108, 'auroc': 0.9993905, 'binary_precision': 0.9895425, 'binary_recall': 0.9843953, 'binary_specificity': 0.9894598, 'binary_f1_score': 0.98696226}
confusion matrix:
      0     1
0  1502    16
1    24  1514
---- Validation: 
scalar performance:
{'acc': 0.8710425, 'precision': 0.88032126, 'recall': 0.87026197, 'specificity': 0.87026197, 'f1': 0.8700706, 'auroc': 0.94464636, 'binary_precision': 0.9372694, 'binary_recall': 0.7925117, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.85883343}
confusion matrix:
     0    1
0  620   34
1  133  508
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.8481704, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.82577014, 'auroc': 0.89317584, 'binary_precision': 0.93142855, 'binary_recall': 0.70869565, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.8049383}
confusion matrix:
     0    1
0  218   12
1   67  163
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 06:09:09.682896,epoch time: 0:02:47.114783,used: 0:13:50.491678,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98527485, 'precision': 0.9854083, 'recall': 0.98522925, 'specificity': 0.98522925, 'f1': 0.9852722, 'auroc': 0.9992676, 'binary_precision': 0.9788326, 'binary_recall': 0.99219763, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.9854698}
confusion matrix:
      0     1
0  1485    33
1    12  1526
---- Validation: 
scalar performance:
{'acc': 0.8733591, 'precision': 0.87597454, 'recall': 0.87294316, 'specificity': 0.87294316, 'f1': 0.87303925, 'auroc': 0.93966806, 'binary_precision': 0.9049236, 'binary_recall': 0.8315133, 'binary_specificity': 0.9143731, 'binary_f1_score': 0.86666673}
confusion matrix:
     0    1
0  598   56
1  108  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8716872, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85745, 'auroc': 0.90449905, 'binary_precision': 0.9411765, 'binary_recall': 0.76521736, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  219   11
1   54  176
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 06:11:56.304840,epoch time: 0:02:46.621944,used: 0:16:37.113622,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9623691, 'precision': 0.9641214, 'recall': 0.9621575, 'specificity': 0.9621575, 'f1': 0.9623194, 'auroc': 0.99508053, 'binary_precision': 0.93734646, 'binary_recall': 0.99155295, 'binary_specificity': 0.932762, 'binary_f1_score': 0.963688}
confusion matrix:
      0     1
0  1415   102
1    13  1526
---- Validation: 
scalar performance:
{'acc': 0.84247106, 'precision': 0.8592423, 'recall': 0.8413853, 'specificity': 0.8413853, 'f1': 0.8402997, 'auroc': 0.931684, 'binary_precision': 0.93439364, 'binary_recall': 0.73322934, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.8216783}
confusion matrix:
     0    1
0  621   33
1  171  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8152174, 'precision': 0.859848, 'recall': 0.8152174, 'specificity': 0.8152174, 'f1': 0.80930454, 'auroc': 0.9127221, 'binary_precision': 0.98657715, 'binary_recall': 0.6391304, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.77572554}
confusion matrix:
     0    1
0  228    2
1   83  147
early stop counter: 1
val acc:0.8424710631370544, best validation acc: 0.8733590841293335, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 7,now: 2024-07-26 06:14:41.644987,epoch time: 0:02:45.340147,used: 0:19:22.453769,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9878944, 'recall': 0.98789, 'specificity': 0.98789, 'f1': 0.98789215, 'auroc': 0.9993682, 'binary_precision': 0.9876543, 'binary_recall': 0.9882965, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9879753}
confusion matrix:
      0     1
0  1499    19
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.7976834, 'precision': 0.79786867, 'recall': 0.797539, 'specificity': 0.797539, 'f1': 0.7975819, 'auroc': 0.8571279, 'binary_precision': 0.8032, 'binary_recall': 0.7831513, 'binary_specificity': 0.8119266, 'binary_f1_score': 0.7930489}
confusion matrix:
     0    1
0  531  123
1  139  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76521736, 'precision': 0.7752924, 'recall': 0.7652174, 'specificity': 0.7652174, 'f1': 0.7630495, 'auroc': 0.8508507, 'binary_precision': 0.827957, 'binary_recall': 0.6695652, 'binary_specificity': 0.8608696, 'binary_f1_score': 0.74038464}
confusion matrix:
     0    1
0  198   32
1   76  154
early stop counter: 2
val acc:0.7976834177970886, best validation acc: 0.8733590841293335, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 8,now: 2024-07-26 06:17:26.414080,epoch time: 0:02:44.769093,used: 0:22:07.222862,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9813496, 'recall': 0.9813448, 'specificity': 0.9813448, 'f1': 0.9813471, 'auroc': 0.9991262, 'binary_precision': 0.9811688, 'binary_recall': 0.9818064, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.98148745}
confusion matrix:
      0     1
0  1488    29
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.8710425, 'precision': 0.881897, 'recall': 0.8701999, 'specificity': 0.8701999, 'f1': 0.8699256, 'auroc': 0.93979144, 'binary_precision': 0.94382024, 'binary_recall': 0.78627145, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.85787237}
confusion matrix:
     0    1
0  624   30
1  137  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82173914, 'precision': 0.8635509, 'recall': 0.82173914, 'specificity': 0.82173914, 'f1': 0.81646204, 'auroc': 0.9240454, 'binary_precision': 0.9868421, 'binary_recall': 0.65217394, 'binary_specificity': 0.99130434, 'binary_f1_score': 0.78534037}
confusion matrix:
     0    1
0  228    2
1   80  150
early stop counter: 3
val acc:0.8710424900054932, best validation acc: 0.8733590841293335, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 9,now: 2024-07-26 06:20:11.205147,epoch time: 0:02:44.791067,used: 0:24:52.013929,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.9901767, 'recall': 0.9901968, 'specificity': 0.9901968, 'f1': 0.990183, 'auroc': 0.9996059, 'binary_precision': 0.9921722, 'binary_recall': 0.9883041, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9902344}
confusion matrix:
      0     1
0  1505    12
1    18  1521
---- Validation: 
scalar performance:
{'acc': 0.76602316, 'precision': 0.8101376, 'recall': 0.7641157, 'specificity': 0.7641157, 'f1': 0.75650775, 'auroc': 0.9258088, 'binary_precision': 0.92462313, 'binary_recall': 0.57410294, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.70837337}
confusion matrix:
     0    1
0  624   30
1  273  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7217391, 'precision': 0.8168216, 'recall': 0.7217392, 'specificity': 0.7217392, 'f1': 0.6991682, 'auroc': 0.9238564, 'binary_precision': 0.99038464, 'binary_recall': 0.4478261, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.61676645}
confusion matrix:
     0    1
0  229    1
1  127  103
early stop counter: 4
val acc:0.7660231590270996, best validation acc: 0.8733590841293335, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 10,now: 2024-07-26 06:22:56.390900,epoch time: 0:02:45.185753,used: 0:27:37.199682,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97949374, 'recall': 0.9794521, 'specificity': 0.9794521, 'f1': 0.9793847, 'auroc': 0.99775517, 'binary_precision': 0.9887417, 'binary_recall': 0.9701105, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9793375}
confusion matrix:
      0     1
0  1500    17
1    46  1493
---- Validation: 
scalar performance:
{'acc': 0.77065635, 'precision': 0.7998405, 'recall': 0.76907504, 'specificity': 0.76907504, 'f1': 0.7642177, 'auroc': 0.8869026, 'binary_precision': 0.8909091, 'binary_recall': 0.6115445, 'binary_specificity': 0.9266055, 'binary_f1_score': 0.7252544}
confusion matrix:
     0    1
0  606   48
1  249  392
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78913045, 'precision': 0.83242047, 'recall': 0.78913045, 'specificity': 0.78913045, 'f1': 0.78203416, 'auroc': 0.90816635, 'binary_precision': 0.95238096, 'binary_recall': 0.6086956, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.7427055}
confusion matrix:
     0    1
0  223    7
1   90  140
early stop counter: 5
val acc:0.7706563472747803, best validation acc: 0.8733590841293335, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 11,now: 2024-07-26 06:25:41.173971,epoch time: 0:02:44.783071,used: 0:30:21.982753,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_05_55_19_seed_9_23064731
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:30:21.982753 at 2024-07-26 06:25:41.173971
persisted model performance metric: 

scalar performance:
{'acc': 0.8586956, 'precision': 0.8716872, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85745, 'auroc': 0.90449905, 'binary_precision': 0.9411765, 'binary_recall': 0.76521736, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  219   11
1   54  176
oracle model performance metric: 

scalar performance:
{'acc': 0.8586956, 'precision': 0.8716872, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85745, 'auroc': 0.90449905, 'binary_precision': 0.9411765, 'binary_recall': 0.76521736, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  219   11
1   54  176
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2390 MiB |   8917 MiB |    832 TiB |    832 TiB |
|       from large pool |   2298 MiB |   8841 MiB |    825 TiB |    825 TiB |
|       from small pool |     91 MiB |    132 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |   2390 MiB |   8917 MiB |    832 TiB |    832 TiB |
|       from large pool |   2298 MiB |   8841 MiB |    825 TiB |    825 TiB |
|       from small pool |     91 MiB |    132 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB |    831 TiB |    831 TiB |
|       from large pool |   2284 MiB |   8826 MiB |    824 TiB |    824 TiB |
|       from small pool |     91 MiB |    132 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9736 MiB |   9824 MiB |  66656 MiB |  56920 MiB |
|       from large pool |   9600 MiB |   9688 MiB |  66208 MiB |  56608 MiB |
|       from small pool |    136 MiB |    140 MiB |    448 MiB |    312 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1061 MiB |   1892 MiB | 621881 GiB | 621880 GiB |
|       from large pool |   1051 MiB |   1887 MiB | 614213 GiB | 614212 GiB |
|       from small pool |     10 MiB |     62 MiB |   7667 GiB |   7667 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |  121214 K  |  121212 K  |
|       from large pool |     392    |     816    |   60881 K  |   60880 K  |
|       from small pool |    2084    |    2780    |   60333 K  |   60331 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |  121214 K  |  121212 K  |
|       from large pool |     392    |     816    |   60881 K  |   60880 K  |
|       from small pool |    2084    |    2780    |   60333 K  |   60331 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     333    |    1722    |    1438    |
|       from large pool |     216    |     265    |    1498    |    1282    |
|       from small pool |      68    |      70    |     224    |     156    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     143    |     319    |   66967 K  |   66967 K  |
|       from large pool |      74    |     255    |   35778 K  |   35778 K  |
|       from small pool |      69    |     227    |   31189 K  |   31189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8917 MiB |    832 TiB |    832 TiB |
|       from large pool |  16640 KiB |   8841 MiB |    825 TiB |    825 TiB |
|       from small pool |      0 KiB |    132 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8917 MiB |    832 TiB |    832 TiB |
|       from large pool |  16640 KiB |   8841 MiB |    825 TiB |    825 TiB |
|       from small pool |      0 KiB |    132 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |    831 TiB |    831 TiB |
|       from large pool |  16640 KiB |   8826 MiB |    824 TiB |    824 TiB |
|       from small pool |      0 KiB |    132 MiB |      7 TiB |      7 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3452 MiB |   9824 MiB |  66656 MiB |  63204 MiB |
|       from large pool |   3350 MiB |   9688 MiB |  66208 MiB |  62858 MiB |
|       from small pool |    102 MiB |    140 MiB |    448 MiB |    346 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1892 MiB | 621882 GiB | 621882 GiB |
|       from large pool |  24320 KiB |   1887 MiB | 614214 GiB | 614214 GiB |
|       from small pool |      0 KiB |     62 MiB |   7667 GiB |   7667 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  121214 K  |  121214 K  |
|       from large pool |       2    |     816    |   60881 K  |   60881 K  |
|       from small pool |       0    |    2780    |   60333 K  |   60333 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  121214 K  |  121214 K  |
|       from large pool |       2    |     816    |   60881 K  |   60881 K  |
|       from small pool |       0    |    2780    |   60333 K  |   60333 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     130    |     333    |    1722    |    1592    |
|       from large pool |      79    |     265    |    1498    |    1419    |
|       from small pool |      51    |      70    |     224    |     173    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   66967 K  |   66967 K  |
|       from large pool |       3    |     255    |   35778 K  |   35778 K  |
|       from small pool |       0    |     227    |   31189 K  |   31189 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 06:25:53 2024]
Finished job 0.
1 of 1 steps (100%) done
