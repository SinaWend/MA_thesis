Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 00:14:13 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702

 Experiment start at: 2024-07-26 00:14:44.624648
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9195964, 'precision': 0.9276954, 'recall': 0.9186777, 'specificity': 0.9186777, 'f1': 0.9190817, 'auroc': 0.9928075, 'binary_precision': 0.87215906, 'binary_recall': 0.98587024, 'binary_specificity': 0.85148513, 'binary_f1_score': 0.9255351}
confusion matrix:
      0     1
0  1290   225
1    22  1535
---- Validation: 
scalar performance:
{'acc': 0.7158385, 'precision': 0.78362304, 'recall': 0.71921235, 'specificity': 0.71921235, 'f1': 0.6997669, 'auroc': 0.91353774, 'binary_precision': 0.6414301, 'binary_recall': 0.96062994, 'binary_specificity': 0.4777948, 'binary_f1_score': 0.7692308}
confusion matrix:
     0    1
0  312  341
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7372093, 'precision': 0.78115386, 'recall': 0.7372093, 'specificity': 0.7372093, 'f1': 0.72652316, 'auroc': 0.9170362, 'binary_precision': 0.67, 'binary_recall': 0.9348837, 'binary_specificity': 0.53953487, 'binary_f1_score': 0.78058255}
confusion matrix:
     0    1
0  116   99
1   14  201
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:17:32.254959,epoch time: 0:02:47.630311,used: 0:02:47.630311,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.9773445, 'recall': 0.9771023, 'specificity': 0.9771023, 'f1': 0.9768869, 'auroc': 0.9960229, 'binary_precision': 0.99532396, 'binary_recall': 0.95881593, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9767289}
confusion matrix:
      0     1
0  1511     7
1    64  1490
---- Validation: 
scalar performance:
{'acc': 0.8152174, 'precision': 0.81776357, 'recall': 0.81583244, 'specificity': 0.81583244, 'f1': 0.8150207, 'auroc': 0.8605757, 'binary_precision': 0.7856115, 'binary_recall': 0.85984254, 'binary_specificity': 0.77182233, 'binary_f1_score': 0.8210526}
confusion matrix:
     0    1
0  504  149
1   89  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8302969, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8302243, 'auroc': 0.84936714, 'binary_precision': 0.82568806, 'binary_recall': 0.8372093, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.83140874}
confusion matrix:
     0    1
0  177   38
1   35  180
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:20:16.820673,epoch time: 0:02:44.565714,used: 0:05:32.196025,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.9739429, 'recall': 0.97403693, 'specificity': 0.97403693, 'f1': 0.97395647, 'auroc': 0.9959559, 'binary_precision': 0.97987014, 'binary_recall': 0.96854943, 'binary_specificity': 0.97952443, 'binary_f1_score': 0.97417694}
confusion matrix:
      0     1
0  1483    31
1    49  1509
---- Validation: 
scalar performance:
{'acc': 0.6902174, 'precision': 0.73007417, 'recall': 0.68723756, 'specificity': 0.68723756, 'f1': 0.6740326, 'auroc': 0.8146001, 'binary_precision': 0.8224044, 'binary_recall': 0.47401574, 'binary_specificity': 0.9004594, 'binary_f1_score': 0.6013986}
confusion matrix:
     0    1
0  588   65
1  334  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.80714285, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.8069506, 'auroc': 0.85075176, 'binary_precision': 0.8, 'binary_recall': 0.81860465, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.8091954}
confusion matrix:
     0    1
0  171   44
1   39  176
early stop counter: 1
val acc:0.6902173757553101, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 3,now: 2024-07-26 00:22:59.698808,epoch time: 0:02:42.878135,used: 0:08:15.074160,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9823967, 'recall': 0.9824556, 'specificity': 0.9824556, 'f1': 0.9824194, 'auroc': 0.99876, 'binary_precision': 0.9851613, 'binary_recall': 0.9801027, 'binary_specificity': 0.98480844, 'binary_f1_score': 0.9826254}
confusion matrix:
      0     1
0  1491    23
1    31  1527
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.71856576, 'recall': 0.71323144, 'specificity': 0.71323144, 'f1': 0.71218646, 'auroc': 0.78761625, 'binary_precision': 0.74585634, 'binary_recall': 0.63779527, 'binary_specificity': 0.7886677, 'binary_f1_score': 0.6876061}
confusion matrix:
     0    1
0  515  138
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.8115529, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.80356336, 'auroc': 0.80467284, 'binary_precision': 0.7651822, 'binary_recall': 0.87906975, 'binary_specificity': 0.73023254, 'binary_f1_score': 0.8181819}
confusion matrix:
     0    1
0  157   58
1   26  189
early stop counter: 2
val acc:0.7142857313156128, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 4,now: 2024-07-26 00:25:42.468229,epoch time: 0:02:42.769421,used: 0:10:57.843581,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.98031366, 'recall': 0.980322, 'specificity': 0.980322, 'f1': 0.9801432, 'auroc': 0.9951837, 'binary_precision': 0.9934037, 'binary_recall': 0.9672447, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9801497}
confusion matrix:
      0     1
0  1505    10
1    51  1506
---- Validation: 
scalar performance:
{'acc': 0.7763975, 'precision': 0.80640066, 'recall': 0.7741834, 'specificity': 0.7741834, 'f1': 0.76980305, 'auroc': 0.8766613, 'binary_precision': 0.89885056, 'binary_recall': 0.61574805, 'binary_specificity': 0.9326187, 'binary_f1_score': 0.73084116}
confusion matrix:
     0    1
0  609   44
1  244  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.8368211, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.8161185, 'auroc': 0.8941049, 'binary_precision': 0.91515154, 'binary_recall': 0.7023256, 'binary_specificity': 0.9348837, 'binary_f1_score': 0.79473686}
confusion matrix:
     0    1
0  201   14
1   64  151
early stop counter: 3
val acc:0.7763975262641907, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 5,now: 2024-07-26 00:28:25.309694,epoch time: 0:02:42.841465,used: 0:13:40.685046,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9792646, 'recall': 0.9790909, 'specificity': 0.9790909, 'f1': 0.9788407, 'auroc': 0.9988986, 'binary_precision': 0.99733335, 'binary_recall': 0.9608221, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.97873735}
confusion matrix:
      0     1
0  1511     4
1    61  1496
---- Validation: 
scalar performance:
{'acc': 0.7414596, 'precision': 0.806447, 'recall': 0.7382077, 'specificity': 0.7382077, 'f1': 0.72523326, 'auroc': 0.9017955, 'binary_precision': 0.94411767, 'binary_recall': 0.5055118, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.6584615}
confusion matrix:
     0    1
0  634   19
1  314  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.7891525, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6109644, 'auroc': 0.90364516, 'binary_precision': 0.98550725, 'binary_recall': 0.31627908, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.47887328}
confusion matrix:
     0   1
0  214   1
1  147  68
early stop counter: 4
val acc:0.7414596080780029, best validation acc: 0.8152173757553101, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 6,now: 2024-07-26 00:31:08.152894,epoch time: 0:02:42.843200,used: 0:16:23.528246,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98439527, 'recall': 0.98447406, 'specificity': 0.98447406, 'f1': 0.9843745, 'auroc': 0.998736, 'binary_precision': 0.9921671, 'binary_recall': 0.97686374, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98445594}
confusion matrix:
      0     1
0  1504    12
1    36  1520
---- Validation: 
scalar performance:
{'acc': 0.82608694, 'precision': 0.8482346, 'recall': 0.8243166, 'specificity': 0.8243166, 'f1': 0.82270074, 'auroc': 0.91153365, 'binary_precision': 0.93263155, 'binary_recall': 0.6976378, 'binary_specificity': 0.9509954, 'binary_f1_score': 0.79819816}
confusion matrix:
     0    1
0  621   32
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.8744792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8539946, 'auroc': 0.9185506, 'binary_precision': 0.9580838, 'binary_recall': 0.74418604, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8376964}
confusion matrix:
     0    1
0  208    7
1   55  160
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 00:33:52.267675,epoch time: 0:02:44.114781,used: 0:19:07.643027,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.98734134, 'recall': 0.9874432, 'specificity': 0.9874432, 'f1': 0.98730433, 'auroc': 0.9990834, 'binary_precision': 0.996732, 'binary_recall': 0.97819114, 'binary_specificity': 0.9966953, 'binary_f1_score': 0.98737454}
confusion matrix:
      0     1
0  1508     5
1    34  1525
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.7822107, 'recall': 0.75972193, 'specificity': 0.75972193, 'f1': 0.75628656, 'auroc': 0.87566775, 'binary_precision': 0.8549784, 'binary_recall': 0.62204725, 'binary_specificity': 0.8973966, 'binary_f1_score': 0.7201458}
confusion matrix:
     0    1
0  586   67
1  240  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8259269, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8255352, 'auroc': 0.85925364, 'binary_precision': 0.83653843, 'binary_recall': 0.80930233, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.822695}
confusion matrix:
     0    1
0  181   34
1   41  174
early stop counter: 1
val acc:0.7616459727287292, best validation acc: 0.8260869383811951, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 8,now: 2024-07-26 00:36:36.471333,epoch time: 0:02:44.203658,used: 0:21:51.846685,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886165, 'recall': 0.98870707, 'specificity': 0.98870707, 'f1': 0.98860633, 'auroc': 0.9995566, 'binary_precision': 0.9960887, 'binary_recall': 0.98137444, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9886768}
confusion matrix:
      0     1
0  1509     6
1    29  1528
---- Validation: 
scalar performance:
{'acc': 0.7569876, 'precision': 0.82061833, 'recall': 0.7538472, 'specificity': 0.7538472, 'f1': 0.742751, 'auroc': 0.9251425, 'binary_precision': 0.96, 'binary_recall': 0.52913386, 'binary_specificity': 0.9785605, 'binary_f1_score': 0.6822335}
confusion matrix:
     0    1
0  639   14
1  299  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.808165, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.67436576, 'auroc': 0.91956735, 'binary_precision': 0.98876405, 'binary_recall': 0.40930232, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5789473}
confusion matrix:
     0   1
0  214   1
1  127  88
early stop counter: 2
val acc:0.7569875717163086, best validation acc: 0.8260869383811951, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 9,now: 2024-07-26 00:39:19.668631,epoch time: 0:02:43.197298,used: 0:24:35.043983,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873569, 'recall': 0.987453, 'specificity': 0.987453, 'f1': 0.98730433, 'auroc': 0.99951625, 'binary_precision': 0.9973822, 'binary_recall': 0.97754973, 'binary_specificity': 0.99735624, 'binary_f1_score': 0.9873664}
confusion matrix:
      0     1
0  1509     4
1    35  1524
---- Validation: 
scalar performance:
{'acc': 0.66537267, 'precision': 0.7779236, 'recall': 0.66086864, 'specificity': 0.66086864, 'f1': 0.6240537, 'auroc': 0.91531456, 'binary_precision': 0.95132744, 'binary_recall': 0.33858266, 'binary_specificity': 0.98315465, 'binary_f1_score': 0.4994193}
confusion matrix:
     0    1
0  642   11
1  420  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52093023, 'precision': 0.5782198, 'recall': 0.52093023, 'specificity': 0.52093023, 'f1': 0.41354835, 'auroc': 0.8600757, 'binary_precision': 0.6451613, 'binary_recall': 0.093023255, 'binary_specificity': 0.9488372, 'binary_f1_score': 0.16260162}
confusion matrix:
     0   1
0  204  11
1  195  20
early stop counter: 3
val acc:0.6653726696968079, best validation acc: 0.8260869383811951, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 10,now: 2024-07-26 00:42:04.027990,epoch time: 0:02:44.359359,used: 0:27:19.403342,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98832345, 'recall': 0.9882473, 'specificity': 0.9882473, 'f1': 0.9882786, 'auroc': 0.99934673, 'binary_precision': 0.9859245, 'binary_recall': 0.9909968, 'binary_specificity': 0.9854977, 'binary_f1_score': 0.9884541}
confusion matrix:
      0     1
0  1495    22
1    14  1541
---- Validation: 
scalar performance:
{'acc': 0.82375777, 'precision': 0.83443624, 'recall': 0.822497, 'specificity': 0.822497, 'f1': 0.8219155, 'auroc': 0.90667665, 'binary_precision': 0.8908046, 'binary_recall': 0.7322835, 'binary_specificity': 0.91271055, 'binary_f1_score': 0.8038029}
confusion matrix:
     0    1
0  596   57
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.81373477, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80051196, 'auroc': 0.88854516, 'binary_precision': 0.87356323, 'binary_recall': 0.7069768, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.7814911}
confusion matrix:
     0    1
0  193   22
1   63  152
early stop counter: 4
val acc:0.8237577676773071, best validation acc: 0.8260869383811951, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 11,now: 2024-07-26 00:44:47.087343,epoch time: 0:02:43.059353,used: 0:30:02.462695,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.9767262, 'recall': 0.9765166, 'specificity': 0.9765166, 'f1': 0.9762362, 'auroc': 0.99728507, 'binary_precision': 0.995992, 'binary_recall': 0.95699614, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9761048}
confusion matrix:
      0     1
0  1508     6
1    67  1491
---- Validation: 
scalar performance:
{'acc': 0.7795031, 'precision': 0.81123924, 'recall': 0.7772461, 'specificity': 0.7772461, 'f1': 0.77275205, 'auroc': 0.89843845, 'binary_precision': 0.9071926, 'binary_recall': 0.61574805, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.73358357}
confusion matrix:
     0    1
0  613   40
1  244  391
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.809393, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.80659914, 'auroc': 0.8890643, 'binary_precision': 0.8367347, 'binary_recall': 0.7627907, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.7980535}
confusion matrix:
     0    1
0  183   32
1   51  164
early stop counter: 5
val acc:0.7795031070709229, best validation acc: 0.8260869383811951, corresponding to test acc:                         0.8558139801025391 / 0.8558139801025391
after epoch: 12,now: 2024-07-26 00:47:30.349642,epoch time: 0:02:43.262299,used: 0:32:45.724994,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_14_44_seed_0_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:32:45.724994 at 2024-07-26 00:47:30.349642
persisted model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.8744792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8539946, 'auroc': 0.9185506, 'binary_precision': 0.9580838, 'binary_recall': 0.74418604, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8376964}
confusion matrix:
     0    1
0  208    7
1   55  160
oracle model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.8744792, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.8539946, 'auroc': 0.9185506, 'binary_precision': 0.9580838, 'binary_recall': 0.74418604, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8376964}
confusion matrix:
     0    1
0  208    7
1   55  160
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2389 MiB |   8910 MiB |  80135 GiB |  80133 GiB |
|       from large pool |   2297 MiB |   8834 MiB |  79435 GiB |  79433 GiB |
|       from small pool |     91 MiB |    129 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2389 MiB |   8910 MiB |  80135 GiB |  80133 GiB |
|       from large pool |   2297 MiB |   8834 MiB |  79435 GiB |  79433 GiB |
|       from small pool |     91 MiB |    129 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB |  79985 GiB |  79983 GiB |
|       from large pool |   2284 MiB |   8826 MiB |  79287 GiB |  79285 GiB |
|       from small pool |     91 MiB |    128 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9824 MiB |   9824 MiB |   9824 MiB |      0 B   |
|       from large pool |   9688 MiB |   9688 MiB |   9688 MiB |      0 B   |
|       from small pool |    136 MiB |    136 MiB |    136 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1060 MiB |   1215 MiB |  49602 GiB |  49601 GiB |
|       from large pool |   1048 MiB |   1200 MiB |  48882 GiB |  48881 GiB |
|       from small pool |     12 MiB |     22 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3317    |   11382 K  |   11380 K  |
|       from large pool |     392    |     816    |    5719 K  |    5718 K  |
|       from small pool |    2072    |    2768    |    5663 K  |    5661 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3317    |   11382 K  |   11380 K  |
|       from large pool |     392    |     816    |    5719 K  |    5718 K  |
|       from small pool |    2072    |    2768    |    5663 K  |    5661 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     333    |     333    |     333    |       0    |
|       from large pool |     265    |     265    |     265    |       0    |
|       from small pool |      68    |      68    |      68    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     151    |     319    |    6601 K  |    6601 K  |
|       from large pool |      82    |     255    |    3716 K  |    3716 K  |
|       from small pool |      69    |     227    |    2885 K  |    2885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8910 MiB |  80135 GiB |  80135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  79435 GiB |  79435 GiB |
|       from small pool |      0 KiB |    129 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8910 MiB |  80135 GiB |  80135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  79435 GiB |  79435 GiB |
|       from small pool |      0 KiB |    129 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |  79985 GiB |  79985 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  79287 GiB |  79287 GiB |
|       from small pool |      0 KiB |    128 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3450 MiB |   9824 MiB |   9824 MiB |   6374 MiB |
|       from large pool |   3346 MiB |   9688 MiB |   9688 MiB |   6342 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1215 MiB |  49603 GiB |  49603 GiB |
|       from large pool |  24320 KiB |   1200 MiB |  48883 GiB |  48883 GiB |
|       from small pool |      0 KiB |     60 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   11382 K  |   11382 K  |
|       from large pool |       2    |     816    |    5719 K  |    5719 K  |
|       from small pool |       0    |    2768    |    5663 K  |    5663 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   11382 K  |   11382 K  |
|       from large pool |       2    |     816    |    5719 K  |    5719 K  |
|       from small pool |       0    |    2768    |    5663 K  |    5663 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     333    |     333    |     198    |
|       from large pool |      83    |     265    |     265    |     182    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |    6602 K  |    6602 K  |
|       from large pool |       3    |     255    |    3716 K  |    3716 K  |
|       from small pool |       0    |     227    |    2885 K  |    2885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8910 MiB |  80135 GiB |  80135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  79435 GiB |  79435 GiB |
|       from small pool |      0 KiB |    129 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8910 MiB |  80135 GiB |  80135 GiB |
|       from large pool |  16640 KiB |   8834 MiB |  79435 GiB |  79435 GiB |
|       from small pool |      0 KiB |    129 MiB |    699 GiB |    699 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB |  79985 GiB |  79985 GiB |
|       from large pool |  16640 KiB |   8826 MiB |  79287 GiB |  79287 GiB |
|       from small pool |      0 KiB |    128 MiB |    698 GiB |    698 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3450 MiB |   9824 MiB |   9824 MiB |   6374 MiB |
|       from large pool |   3346 MiB |   9688 MiB |   9688 MiB |   6342 MiB |
|       from small pool |    104 MiB |    136 MiB |    136 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1215 MiB |  49603 GiB |  49603 GiB |
|       from large pool |  24320 KiB |   1200 MiB |  48883 GiB |  48883 GiB |
|       from small pool |      0 KiB |     60 MiB |    719 GiB |    719 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3317    |   11382 K  |   11382 K  |
|       from large pool |       2    |     816    |    5719 K  |    5719 K  |
|       from small pool |       0    |    2768    |    5663 K  |    5663 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3317    |   11382 K  |   11382 K  |
|       from large pool |       2    |     816    |    5719 K  |    5719 K  |
|       from small pool |       0    |    2768    |    5663 K  |    5663 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     333    |     333    |     198    |
|       from large pool |      83    |     265    |     265    |     182    |
|       from small pool |      52    |      68    |      68    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |    6602 K  |    6602 K  |
|       from large pool |       3    |     255    |    3716 K  |    3716 K  |
|       from small pool |       0    |     227    |    2885 K  |    2885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702

 Experiment start at: 2024-07-26 00:48:04.608305
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9641927, 'precision': 0.9658332, 'recall': 0.96456933, 'specificity': 0.96456933, 'f1': 0.96417713, 'auroc': 0.99577916, 'binary_precision': 0.9965612, 'binary_recall': 0.9324324, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9634308}
confusion matrix:
      0     1
0  1513     5
1   105  1449
---- Validation: 
scalar performance:
{'acc': 0.7291179, 'precision': 0.80455077, 'recall': 0.7249872, 'specificity': 0.7249872, 'f1': 0.7088478, 'auroc': 0.90571773, 'binary_precision': 0.9520767, 'binary_recall': 0.47301587, 'binary_specificity': 0.9769585, 'binary_f1_score': 0.6320255}
confusion matrix:
     0    1
0  636   15
1  332  298
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.8378378, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.7453311, 'auroc': 0.910637, 'binary_precision': 1.0, 'binary_recall': 0.52, 'binary_specificity': 1.0, 'binary_f1_score': 0.68421054}
confusion matrix:
     0    1
0  225    0
1  108  117
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 00:50:48.550607,epoch time: 0:02:43.942302,used: 0:02:43.942302,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97335404, 'recall': 0.97342145, 'specificity': 0.97342145, 'f1': 0.9733069, 'auroc': 0.996024, 'binary_precision': 0.98232985, 'binary_recall': 0.96465296, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.97341114}
confusion matrix:
      0     1
0  1489    27
1    55  1501
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.84401923, 'recall': 0.82731694, 'specificity': 0.82731694, 'f1': 0.8265984, 'auroc': 0.90327704, 'binary_precision': 0.91182363, 'binary_recall': 0.7222222, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.80602306}
confusion matrix:
     0    1
0  607   44
1  175  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.87372255, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8463361, 'auroc': 0.92823696, 'binary_precision': 0.9700599, 'binary_recall': 0.72, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8265306}
confusion matrix:
     0    1
0  220    5
1   63  162
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 00:53:34.818060,epoch time: 0:02:46.267453,used: 0:05:30.209755,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97397363, 'recall': 0.9735911, 'specificity': 0.9735911, 'f1': 0.9733051, 'auroc': 0.9969621, 'binary_precision': 0.9952957, 'binary_recall': 0.9517995, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9730618}
confusion matrix:
      0     1
0  1509     7
1    75  1481
---- Validation: 
scalar performance:
{'acc': 0.66432476, 'precision': 0.7813333, 'recall': 0.6589606, 'specificity': 0.6589606, 'f1': 0.6210247, 'auroc': 0.8977008, 'binary_precision': 0.9587156, 'binary_recall': 0.33174604, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.49292454}
confusion matrix:
     0    1
0  642    9
1  421  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.7598152, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.41219324, 'auroc': 0.92001975, 'binary_precision': 1.0, 'binary_recall': 0.075555556, 'binary_specificity': 1.0, 'binary_f1_score': 0.14049587}
confusion matrix:
     0   1
0  225   0
1  208  17
early stop counter: 1
val acc:0.6643247604370117, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 3,now: 2024-07-26 00:56:19.296738,epoch time: 0:02:44.478678,used: 0:08:14.688433,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.9792102, 'recall': 0.97926295, 'specificity': 0.97926295, 'f1': 0.9791664, 'auroc': 0.99774605, 'binary_precision': 0.98756546, 'binary_recall': 0.97104245, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.9792343}
confusion matrix:
      0     1
0  1499    19
1    45  1509
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.82431334, 'recall': 0.82429594, 'specificity': 0.82429594, 'f1': 0.82430416, 'auroc': 0.89730084, 'binary_precision': 0.8219396, 'binary_recall': 0.8206349, 'binary_specificity': 0.827957, 'binary_f1_score': 0.82128674}
confusion matrix:
     0    1
0  539  112
1  113  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8268991, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82663584, 'auroc': 0.9124346, 'binary_precision': 0.8181818, 'binary_recall': 0.84, 'binary_specificity': 0.81333333, 'binary_f1_score': 0.82894737}
confusion matrix:
     0    1
0  183   42
1   36  189
early stop counter: 2
val acc:0.824355959892273, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 4,now: 2024-07-26 00:59:03.323937,epoch time: 0:02:44.027199,used: 0:10:58.715632,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98449564, 'recall': 0.98449564, 'specificity': 0.98449564, 'f1': 0.984375, 'auroc': 0.9988872, 'binary_precision': 0.9953917, 'binary_recall': 0.9735995, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.984375}
confusion matrix:
      0     1
0  1512     7
1    41  1512
---- Validation: 
scalar performance:
{'acc': 0.8227947, 'precision': 0.84536064, 'recall': 0.8206861, 'specificity': 0.8206861, 'f1': 0.819144, 'auroc': 0.91813326, 'binary_precision': 0.92963755, 'binary_recall': 0.6920635, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.7934487}
confusion matrix:
     0    1
0  618   33
1  194  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8587037, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.81242764, 'auroc': 0.9159506, 'binary_precision': 0.9798658, 'binary_recall': 0.6488889, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.7807487}
confusion matrix:
     0    1
0  222    3
1   79  146
early stop counter: 3
val acc:0.8227946758270264, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 5,now: 2024-07-26 01:01:46.848539,epoch time: 0:02:43.524602,used: 0:13:42.240234,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9704126, 'recall': 0.96952784, 'specificity': 0.96952784, 'f1': 0.96970224, 'auroc': 0.9978092, 'binary_precision': 0.9551402, 'binary_recall': 0.9864865, 'binary_specificity': 0.9525692, 'binary_f1_score': 0.9705603}
confusion matrix:
      0     1
0  1446    72
1    21  1533
---- Validation: 
scalar performance:
{'acc': 0.7704918, 'precision': 0.8239913, 'recall': 0.7671275, 'specificity': 0.7671275, 'f1': 0.75906265, 'auroc': 0.9154067, 'binary_precision': 0.9516129, 'binary_recall': 0.5619048, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.70658684}
confusion matrix:
     0    1
0  633   18
1  276  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8560649, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83315295, 'auroc': 0.90947163, 'binary_precision': 0.94152045, 'binary_recall': 0.71555555, 'binary_specificity': 0.95555556, 'binary_f1_score': 0.8131313}
confusion matrix:
     0    1
0  215   10
1   64  161
early stop counter: 4
val acc:0.7704917788505554, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 6,now: 2024-07-26 01:04:29.830049,epoch time: 0:02:42.981510,used: 0:16:25.221744,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9550781, 'precision': 0.9582324, 'recall': 0.95571244, 'specificity': 0.95571244, 'f1': 0.95503604, 'auroc': 0.9979863, 'binary_precision': 1.0, 'binary_recall': 0.9114249, 'binary_specificity': 1.0, 'binary_f1_score': 0.95366013}
confusion matrix:
      0     1
0  1514     0
1   138  1420
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.7710851, 'recall': 0.6423195, 'specificity': 0.6423195, 'f1': 0.59786433, 'auroc': 0.9050448, 'binary_precision': 0.94974875, 'binary_recall': 0.3, 'binary_specificity': 0.984639, 'binary_f1_score': 0.45597106}
confusion matrix:
     0    1
0  641   10
1  441  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63555557, 'precision': 0.78920305, 'recall': 0.63555557, 'specificity': 0.63555557, 'f1': 0.57973623, 'auroc': 0.90903705, 'binary_precision': 1.0, 'binary_recall': 0.2711111, 'binary_specificity': 1.0, 'binary_f1_score': 0.4265734}
confusion matrix:
     0   1
0  225   0
1  164  61
early stop counter: 5
val acc:0.6479312777519226, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8488888740539551 / 0.8488888740539551
after epoch: 7,now: 2024-07-26 01:07:12.435039,epoch time: 0:02:42.604990,used: 0:19:07.826734,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_00_48_04_seed_1_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:07.826734 at 2024-07-26 01:07:12.435039
persisted model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.87372255, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8463361, 'auroc': 0.92823696, 'binary_precision': 0.9700599, 'binary_recall': 0.72, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8265306}
confusion matrix:
     0    1
0  220    5
1   63  162
oracle model performance metric: 

scalar performance:
{'acc': 0.8488889, 'precision': 0.87372255, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8463361, 'auroc': 0.92823696, 'binary_precision': 0.9700599, 'binary_recall': 0.72, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.8265306}
confusion matrix:
     0    1
0  220    5
1   63  162
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2392 MiB |   8913 MiB | 126965 GiB | 126963 GiB |
|       from large pool |   2301 MiB |   8837 MiB | 125854 GiB | 125852 GiB |
|       from small pool |     91 MiB |    132 MiB |   1111 GiB |   1111 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2392 MiB |   8913 MiB | 126965 GiB | 126963 GiB |
|       from large pool |   2301 MiB |   8837 MiB | 125854 GiB | 125852 GiB |
|       from small pool |     91 MiB |    132 MiB |   1111 GiB |   1111 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 126719 GiB | 126717 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 125610 GiB | 125608 GiB |
|       from small pool |     91 MiB |    132 MiB |   1109 GiB |   1109 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  16118 MiB |   6374 MiB |
|       from large pool |   9604 MiB |   9688 MiB |  15946 MiB |   6342 MiB |
|       from small pool |    140 MiB |    140 MiB |    172 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1095 MiB |   1656 MiB |  82938 GiB |  82937 GiB |
|       from large pool |   1082 MiB |   1651 MiB |  81795 GiB |  81794 GiB |
|       from small pool |     12 MiB |     60 MiB |   1143 GiB |   1143 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   18050 K  |   18048 K  |
|       from large pool |     392    |     816    |    9062 K  |    9062 K  |
|       from small pool |    2084    |    2780    |    8988 K  |    8985 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   18050 K  |   18048 K  |
|       from large pool |     392    |     816    |    9062 K  |    9062 K  |
|       from small pool |    2084    |    2780    |    8988 K  |    8985 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     289    |     333    |     487    |     198    |
|       from large pool |     219    |     265    |     401    |     182    |
|       from small pool |      70    |      70    |      86    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |     319    |   10260 K  |   10260 K  |
|       from large pool |      74    |     255    |    5668 K  |    5668 K  |
|       from small pool |      67    |     227    |    4592 K  |    4591 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 126965 GiB | 126965 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 125854 GiB | 125854 GiB |
|       from small pool |      0 KiB |    132 MiB |   1111 GiB |   1111 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 126965 GiB | 126965 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 125854 GiB | 125854 GiB |
|       from small pool |      0 KiB |    132 MiB |   1111 GiB |   1111 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 126719 GiB | 126719 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 125610 GiB | 125610 GiB |
|       from small pool |      0 KiB |    132 MiB |   1109 GiB |   1109 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3488 MiB |   9824 MiB |  16118 MiB |  12630 MiB |
|       from large pool |   3384 MiB |   9688 MiB |  15946 MiB |  12562 MiB |
|       from small pool |    104 MiB |    140 MiB |    172 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB |  82939 GiB |  82939 GiB |
|       from large pool |  24320 KiB |   1651 MiB |  81796 GiB |  81795 GiB |
|       from small pool |      0 KiB |     60 MiB |   1143 GiB |   1143 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   18050 K  |   18050 K  |
|       from large pool |       2    |     816    |    9062 K  |    9062 K  |
|       from small pool |       0    |    2780    |    8988 K  |    8988 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   18050 K  |   18050 K  |
|       from large pool |       2    |     816    |    9062 K  |    9062 K  |
|       from small pool |       0    |    2780    |    8988 K  |    8988 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     333    |     487    |     352    |
|       from large pool |      83    |     265    |     401    |     318    |
|       from small pool |      52    |      70    |      86    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   10261 K  |   10261 K  |
|       from large pool |       3    |     255    |    5668 K  |    5668 K  |
|       from small pool |       0    |     227    |    4592 K  |    4592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8913 MiB | 126965 GiB | 126965 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 125854 GiB | 125854 GiB |
|       from small pool |      0 KiB |    132 MiB |   1111 GiB |   1111 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8913 MiB | 126965 GiB | 126965 GiB |
|       from large pool |  16640 KiB |   8837 MiB | 125854 GiB | 125854 GiB |
|       from small pool |      0 KiB |    132 MiB |   1111 GiB |   1111 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 126719 GiB | 126719 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 125610 GiB | 125610 GiB |
|       from small pool |      0 KiB |    132 MiB |   1109 GiB |   1109 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3488 MiB |   9824 MiB |  16118 MiB |  12630 MiB |
|       from large pool |   3384 MiB |   9688 MiB |  15946 MiB |  12562 MiB |
|       from small pool |    104 MiB |    140 MiB |    172 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB |  82939 GiB |  82939 GiB |
|       from large pool |  24320 KiB |   1651 MiB |  81796 GiB |  81795 GiB |
|       from small pool |      0 KiB |     60 MiB |   1143 GiB |   1143 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   18050 K  |   18050 K  |
|       from large pool |       2    |     816    |    9062 K  |    9062 K  |
|       from small pool |       0    |    2780    |    8988 K  |    8988 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   18050 K  |   18050 K  |
|       from large pool |       2    |     816    |    9062 K  |    9062 K  |
|       from small pool |       0    |    2780    |    8988 K  |    8988 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     135    |     333    |     487    |     352    |
|       from large pool |      83    |     265    |     401    |     318    |
|       from small pool |      52    |      70    |      86    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   10261 K  |   10261 K  |
|       from large pool |       3    |     255    |    5668 K  |    5668 K  |
|       from small pool |       0    |     227    |    4592 K  |    4592 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702

 Experiment start at: 2024-07-26 01:07:50.929003
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.966623, 'precision': 0.96662307, 'recall': 0.9666518, 'specificity': 0.9666518, 'f1': 0.96662253, 'auroc': 0.9955822, 'binary_precision': 0.97054976, 'binary_recall': 0.962987, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9667536}
confusion matrix:
      0     1
0  1471    45
1    57  1483
---- Validation: 
scalar performance:
{'acc': 0.75508606, 'precision': 0.7572216, 'recall': 0.7561833, 'specificity': 0.7561833, 'f1': 0.7549767, 'auroc': 0.8449209, 'binary_precision': 0.7262079, 'binary_recall': 0.79742765, 'binary_specificity': 0.714939, 'binary_f1_score': 0.76015323}
confusion matrix:
     0    1
0  469  187
1  126  496
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7986111, 'precision': 0.79913044, 'recall': 0.7986111, 'specificity': 0.7986111, 'f1': 0.7985237, 'auroc': 0.86552644, 'binary_precision': 0.7866667, 'binary_recall': 0.8194444, 'binary_specificity': 0.7777778, 'binary_f1_score': 0.80272114}
confusion matrix:
     0    1
0  168   48
1   39  177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:10:39.540446,epoch time: 0:02:48.611443,used: 0:02:48.611443,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9646597, 'precision': 0.966358, 'recall': 0.9649094, 'specificity': 0.9649094, 'f1': 0.96463895, 'auroc': 0.99570346, 'binary_precision': 0.9965326, 'binary_recall': 0.9331169, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.9637827}
confusion matrix:
      0     1
0  1511     5
1   103  1437
---- Validation: 
scalar performance:
{'acc': 0.6697966, 'precision': 0.7419746, 'recall': 0.6622716, 'specificity': 0.6622716, 'f1': 0.63702667, 'auroc': 0.8483354, 'binary_precision': 0.86764705, 'binary_recall': 0.37942123, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.52796423}
confusion matrix:
     0    1
0  620   36
1  386  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6736111, 'precision': 0.7904579, 'recall': 0.6736111, 'specificity': 0.6736111, 'f1': 0.63711536, 'auroc': 0.8901963, 'binary_precision': 0.9746835, 'binary_recall': 0.3564815, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.5220339}
confusion matrix:
     0   1
0  214   2
1  139  77
early stop counter: 1
val acc:0.6697965860366821, best validation acc: 0.7550860643386841, corresponding to test acc:                         0.7986111044883728 / 0.7986111044883728
after epoch: 2,now: 2024-07-26 01:13:22.206978,epoch time: 0:02:42.666532,used: 0:05:31.277975,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97120416, 'precision': 0.97125876, 'recall': 0.9711716, 'specificity': 0.9711716, 'f1': 0.9712002, 'auroc': 0.9965142, 'binary_precision': 0.9677835, 'binary_recall': 0.9753247, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.97153944}
confusion matrix:
      0     1
0  1466    50
1    38  1502
---- Validation: 
scalar performance:
{'acc': 0.81220657, 'precision': 0.8175036, 'recall': 0.81040704, 'specificity': 0.81040704, 'f1': 0.8107003, 'auroc': 0.8933319, 'binary_precision': 0.8523985, 'binary_recall': 0.74276525, 'binary_specificity': 0.8780488, 'binary_f1_score': 0.79381436}
confusion matrix:
     0    1
0  576   80
1  160  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.8553411, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.80667293, 'auroc': 0.92528296, 'binary_precision': 0.9787234, 'binary_recall': 0.6388889, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7731092}
confusion matrix:
     0    1
0  213    3
1   78  138
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 01:16:05.796251,epoch time: 0:02:43.589273,used: 0:08:14.867248,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.9733972, 'recall': 0.9726964, 'specificity': 0.9726964, 'f1': 0.97250634, 'auroc': 0.9975661, 'binary_precision': 0.9959128, 'binary_recall': 0.94935066, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9720745}
confusion matrix:
      0     1
0  1510     6
1    78  1462
---- Validation: 
scalar performance:
{'acc': 0.78482, 'precision': 0.81578237, 'recall': 0.7805638, 'specificity': 0.7805638, 'f1': 0.7775524, 'auroc': 0.8938025, 'binary_precision': 0.9082353, 'binary_recall': 0.62057877, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.7373448}
confusion matrix:
     0    1
0  617   39
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.775463, 'precision': 0.8231826, 'recall': 0.775463, 'specificity': 0.775463, 'f1': 0.76685673, 'auroc': 0.89257544, 'binary_precision': 0.94736844, 'binary_recall': 0.5833333, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.722063}
confusion matrix:
     0    1
0  209    7
1   90  126
early stop counter: 1
val acc:0.784820020198822, best validation acc: 0.8122065663337708, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 4,now: 2024-07-26 01:18:48.951655,epoch time: 0:02:43.155404,used: 0:10:58.022652,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.953534, 'precision': 0.9550553, 'recall': 0.9537728, 'specificity': 0.9537728, 'f1': 0.9535097, 'auroc': 0.99038565, 'binary_precision': 0.9834025, 'binary_recall': 0.9233766, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.9524448}
confusion matrix:
      0     1
0  1492    24
1   118  1422
---- Validation: 
scalar performance:
{'acc': 0.79890454, 'precision': 0.8287864, 'recall': 0.7948249, 'specificity': 0.7948249, 'f1': 0.7925894, 'auroc': 0.90758073, 'binary_precision': 0.92147803, 'binary_recall': 0.6414791, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.7563981}
confusion matrix:
     0    1
0  622   34
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7152778, 'precision': 0.8185841, 'recall': 0.7152778, 'specificity': 0.7152778, 'f1': 0.69016004, 'auroc': 0.94127226, 'binary_precision': 1.0, 'binary_recall': 0.43055555, 'binary_specificity': 1.0, 'binary_f1_score': 0.6019417}
confusion matrix:
     0   1
0  216   0
1  123  93
early stop counter: 2
val acc:0.798904538154602, best validation acc: 0.8122065663337708, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 5,now: 2024-07-26 01:21:31.371991,epoch time: 0:02:42.420336,used: 0:13:40.442988,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.9811106, 'recall': 0.98097867, 'specificity': 0.98097867, 'f1': 0.9810177, 'auroc': 0.99860585, 'binary_precision': 0.9762211, 'binary_recall': 0.98636365, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.98126614}
confusion matrix:
      0     1
0  1479    37
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.81533647, 'precision': 0.8152398, 'recall': 0.81512237, 'specificity': 0.81512237, 'f1': 0.81517303, 'auroc': 0.8947239, 'binary_precision': 0.81229776, 'binary_recall': 0.80707395, 'binary_specificity': 0.8231707, 'binary_f1_score': 0.8096774}
confusion matrix:
     0    1
0  540  116
1  120  502
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8125, 'precision': 0.85279596, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8069886, 'auroc': 0.9214892, 'binary_precision': 0.97202796, 'binary_recall': 0.6435185, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.77437323}
confusion matrix:
     0    1
0  212    4
1   77  139
better model found
persisted
after epoch: 6,now: 2024-07-26 01:24:14.716042,epoch time: 0:02:43.344051,used: 0:16:23.787039,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98036647, 'precision': 0.9808783, 'recall': 0.98050916, 'specificity': 0.98050916, 'f1': 0.9803643, 'auroc': 0.99891543, 'binary_precision': 0.9986523, 'binary_recall': 0.9623377, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.98015875}
confusion matrix:
      0     1
0  1514     2
1    58  1482
---- Validation: 
scalar performance:
{'acc': 0.73552424, 'precision': 0.8085835, 'recall': 0.7289208, 'specificity': 0.7289208, 'f1': 0.7151234, 'auroc': 0.9094017, 'binary_precision': 0.9522293, 'binary_recall': 0.4807074, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.6388889}
confusion matrix:
     0    1
0  641   15
1  323  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6157407, 'precision': 0.7732793, 'recall': 0.6157408, 'specificity': 0.6157408, 'f1': 0.5510367, 'auroc': 0.9206533, 'binary_precision': 0.9807692, 'binary_recall': 0.2361111, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.380597}
confusion matrix:
     0   1
0  215   1
1  165  51
early stop counter: 1
val acc:0.7355242371559143, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 7,now: 2024-07-26 01:26:56.062452,epoch time: 0:02:41.346410,used: 0:19:05.133449,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9741492, 'precision': 0.97511876, 'recall': 0.9743403, 'specificity': 0.9743403, 'f1': 0.97414196, 'auroc': 0.99895215, 'binary_precision': 0.9986348, 'binary_recall': 0.95, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9737104}
confusion matrix:
      0     1
0  1514     2
1    77  1463
---- Validation: 
scalar performance:
{'acc': 0.5516432, 'precision': 0.71786976, 'recall': 0.53963906, 'specificity': 0.53963906, 'f1': 0.4275639, 'auroc': 0.86369634, 'binary_precision': 0.90163934, 'binary_recall': 0.08842444, 'binary_specificity': 0.99085367, 'binary_f1_score': 0.16105416}
confusion matrix:
     0   1
0  650   6
1  567  55
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.7571429, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.39225423, 'auroc': 0.894976, 'binary_precision': 1.0, 'binary_recall': 0.055555556, 'binary_specificity': 1.0, 'binary_f1_score': 0.10526316}
confusion matrix:
     0   1
0  216   0
1  204  12
early stop counter: 2
val acc:0.5516431927680969, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 8,now: 2024-07-26 01:29:40.789682,epoch time: 0:02:44.727230,used: 0:21:49.860679,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98756546, 'recall': 0.98759556, 'specificity': 0.98759556, 'f1': 0.9875653, 'auroc': 0.99916047, 'binary_precision': 0.99149215, 'binary_recall': 0.98376626, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9876141}
confusion matrix:
      0     1
0  1503    13
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.81377155, 'precision': 0.8246907, 'recall': 0.81126475, 'specificity': 0.81126475, 'f1': 0.8112401, 'auroc': 0.89915, 'binary_precision': 0.87795275, 'binary_recall': 0.7170418, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.78938055}
confusion matrix:
     0    1
0  594   62
1  176  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7800926, 'precision': 0.80436707, 'recall': 0.7800926, 'specificity': 0.7800926, 'f1': 0.7756188, 'auroc': 0.88760287, 'binary_precision': 0.89032257, 'binary_recall': 0.6388889, 'binary_specificity': 0.9212963, 'binary_f1_score': 0.7439353}
confusion matrix:
     0    1
0  199   17
1   78  138
early stop counter: 3
val acc:0.8137715458869934, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 9,now: 2024-07-26 01:32:25.346463,epoch time: 0:02:44.556781,used: 0:24:34.417460,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9718586, 'precision': 0.97307247, 'recall': 0.9716719, 'specificity': 0.9716719, 'f1': 0.97183084, 'auroc': 0.99897283, 'binary_precision': 0.9509926, 'binary_recall': 0.99545455, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.97271574}
confusion matrix:
      0     1
0  1437    79
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.7308294, 'precision': 0.77258873, 'recall': 0.73588836, 'specificity': 0.73588836, 'f1': 0.7227626, 'auroc': 0.86295927, 'binary_precision': 0.6590389, 'binary_recall': 0.926045, 'binary_specificity': 0.5457317, 'binary_f1_score': 0.77005345}
confusion matrix:
     0    1
0  358  298
1   46  576
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.712963, 'precision': 0.7805195, 'recall': 0.712963, 'specificity': 0.712963, 'f1': 0.69457436, 'auroc': 0.8822017, 'binary_precision': 0.64285713, 'binary_recall': 0.9583333, 'binary_specificity': 0.4675926, 'binary_f1_score': 0.7695167}
confusion matrix:
     0    1
0  101  115
1    9  207
early stop counter: 4
val acc:0.7308294177055359, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 10,now: 2024-07-26 01:35:07.450214,epoch time: 0:02:42.103751,used: 0:27:16.521211,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.98626137, 'recall': 0.9862505, 'specificity': 0.9862505, 'f1': 0.9862555, 'auroc': 0.99921745, 'binary_precision': 0.9857328, 'binary_recall': 0.987013, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9863725}
confusion matrix:
      0     1
0  1494    22
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.80203444, 'precision': 0.8094294, 'recall': 0.8040399, 'specificity': 0.8040399, 'f1': 0.8014557, 'auroc': 0.8823303, 'binary_precision': 0.75448275, 'binary_recall': 0.87942123, 'binary_specificity': 0.72865856, 'binary_f1_score': 0.8121752}
confusion matrix:
     0    1
0  478  178
1   75  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.78483516, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7763927, 'auroc': 0.8728567, 'binary_precision': 0.74, 'binary_recall': 0.8564815, 'binary_specificity': 0.6990741, 'binary_f1_score': 0.79399145}
confusion matrix:
     0    1
0  151   65
1   31  185
early stop counter: 5
val acc:0.8020344376564026, best validation acc: 0.8153364658355713, corresponding to test acc:                         0.8125 / 0.8125
after epoch: 11,now: 2024-07-26 01:37:50.430202,epoch time: 0:02:42.979988,used: 0:29:59.501199,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_07_50_seed_2_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 0:29:59.501199 at 2024-07-26 01:37:50.430202
persisted model performance metric: 

scalar performance:
{'acc': 0.8125, 'precision': 0.85279596, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.8069886, 'auroc': 0.9214892, 'binary_precision': 0.97202796, 'binary_recall': 0.6435185, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.77437323}
confusion matrix:
     0    1
0  212    4
1   77  139
oracle model performance metric: 

scalar performance:
{'acc': 0.8125, 'precision': 0.8553411, 'recall': 0.8125, 'specificity': 0.8125, 'f1': 0.80667293, 'auroc': 0.92528296, 'binary_precision': 0.9787234, 'binary_recall': 0.6388889, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7731092}
confusion matrix:
     0    1
0  213    3
1   78  138
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2392 MiB |   8915 MiB | 199985 GiB | 199983 GiB |
|       from large pool |   2300 MiB |   8839 MiB | 198236 GiB | 198234 GiB |
|       from small pool |     91 MiB |    132 MiB |   1749 GiB |   1748 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2392 MiB |   8915 MiB | 199985 GiB | 199983 GiB |
|       from large pool |   2300 MiB |   8839 MiB | 198236 GiB | 198234 GiB |
|       from small pool |     91 MiB |    132 MiB |   1749 GiB |   1748 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 199671 GiB | 199669 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 197925 GiB | 197922 GiB |
|       from small pool |     91 MiB |    132 MiB |   1746 GiB |   1746 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9746 MiB |   9824 MiB |  22376 MiB |  12630 MiB |
|       from large pool |   9610 MiB |   9688 MiB |  22172 MiB |  12562 MiB |
|       from small pool |    136 MiB |    140 MiB |    204 MiB |     68 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1141 MiB |   1656 MiB | 136816 GiB | 136815 GiB |
|       from large pool |   1131 MiB |   1651 MiB | 135017 GiB | 135016 GiB |
|       from small pool |     10 MiB |     60 MiB |   1799 GiB |   1799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   28430 K  |   28427 K  |
|       from large pool |     392    |     816    |   14277 K  |   14277 K  |
|       from small pool |    2072    |    2780    |   14152 K  |   14150 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   28430 K  |   28427 K  |
|       from large pool |     392    |     816    |   14277 K  |   14277 K  |
|       from small pool |    2072    |    2780    |   14152 K  |   14150 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |     638    |     352    |
|       from large pool |     218    |     265    |     536    |     318    |
|       from small pool |      68    |      70    |     102    |      34    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     150    |     319    |   15790 K  |   15790 K  |
|       from large pool |      82    |     255    |    8550 K  |    8550 K  |
|       from small pool |      68    |     227    |    7239 K  |    7239 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 199985 GiB | 199985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 198236 GiB | 198236 GiB |
|       from small pool |      0 KiB |    132 MiB |   1749 GiB |   1749 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 199985 GiB | 199985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 198236 GiB | 198236 GiB |
|       from small pool |      0 KiB |    132 MiB |   1749 GiB |   1749 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 199671 GiB | 199671 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 197925 GiB | 197925 GiB |
|       from small pool |      0 KiB |    132 MiB |   1746 GiB |   1746 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3534 MiB |   9824 MiB |  22376 MiB |  18842 MiB |
|       from large pool |   3432 MiB |   9688 MiB |  22172 MiB |  18740 MiB |
|       from small pool |    102 MiB |    140 MiB |    204 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 136817 GiB | 136817 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 135018 GiB | 135018 GiB |
|       from small pool |      0 KiB |     60 MiB |   1799 GiB |   1799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   28430 K  |   28430 K  |
|       from large pool |       2    |     816    |   14277 K  |   14277 K  |
|       from small pool |       0    |    2780    |   14152 K  |   14152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   28430 K  |   28430 K  |
|       from large pool |       2    |     816    |   14277 K  |   14277 K  |
|       from small pool |       0    |    2780    |   14152 K  |   14152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     638    |     504    |
|       from large pool |      83    |     265    |     536    |     453    |
|       from small pool |      51    |      70    |     102    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   15790 K  |   15790 K  |
|       from large pool |       3    |     255    |    8550 K  |    8550 K  |
|       from small pool |       0    |     227    |    7240 K  |    7240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 199985 GiB | 199985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 198236 GiB | 198236 GiB |
|       from small pool |      0 KiB |    132 MiB |   1749 GiB |   1749 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 199985 GiB | 199985 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 198236 GiB | 198236 GiB |
|       from small pool |      0 KiB |    132 MiB |   1749 GiB |   1749 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 199671 GiB | 199671 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 197925 GiB | 197925 GiB |
|       from small pool |      0 KiB |    132 MiB |   1746 GiB |   1746 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3534 MiB |   9824 MiB |  22376 MiB |  18842 MiB |
|       from large pool |   3432 MiB |   9688 MiB |  22172 MiB |  18740 MiB |
|       from small pool |    102 MiB |    140 MiB |    204 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 136817 GiB | 136817 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 135018 GiB | 135018 GiB |
|       from small pool |      0 KiB |     60 MiB |   1799 GiB |   1799 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   28430 K  |   28430 K  |
|       from large pool |       2    |     816    |   14277 K  |   14277 K  |
|       from small pool |       0    |    2780    |   14152 K  |   14152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   28430 K  |   28430 K  |
|       from large pool |       2    |     816    |   14277 K  |   14277 K  |
|       from small pool |       0    |    2780    |   14152 K  |   14152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     134    |     333    |     638    |     504    |
|       from large pool |      83    |     265    |     536    |     453    |
|       from small pool |      51    |      70    |     102    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   15790 K  |   15790 K  |
|       from large pool |       3    |     255    |    8550 K  |    8550 K  |
|       from small pool |       0    |     227    |    7240 K  |    7240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702

 Experiment start at: 2024-07-26 01:38:26.592345
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.9704163, 'recall': 0.9698874, 'specificity': 0.9698874, 'f1': 0.9700328, 'auroc': 0.9966394, 'binary_precision': 0.96042717, 'binary_recall': 0.98138636, 'binary_specificity': 0.9583884, 'binary_f1_score': 0.97079366}
confusion matrix:
      0     1
0  1451    63
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.79345286, 'precision': 0.79701346, 'recall': 0.7944835, 'specificity': 0.7944835, 'f1': 0.79316336, 'auroc': 0.88267624, 'binary_precision': 0.7592593, 'binary_recall': 0.84737676, 'binary_specificity': 0.7415902, 'binary_f1_score': 0.8009016}
confusion matrix:
     0    1
0  485  169
1   96  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.7960224, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.78496766, 'auroc': 0.9081086, 'binary_precision': 0.7433962, 'binary_recall': 0.8755556, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.8040816}
confusion matrix:
     0    1
0  157   68
1   28  197
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 01:41:13.551272,epoch time: 0:02:46.958927,used: 0:02:46.958927,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96158856, 'precision': 0.9628936, 'recall': 0.9619909, 'specificity': 0.9619909, 'f1': 0.96157837, 'auroc': 0.9911864, 'binary_precision': 0.9911263, 'binary_recall': 0.93256265, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.96095306}
confusion matrix:
      0     1
0  1502    13
1   105  1452
---- Validation: 
scalar performance:
{'acc': 0.8222915, 'precision': 0.8406819, 'recall': 0.8200058, 'specificity': 0.8200058, 'f1': 0.8190776, 'auroc': 0.8905184, 'binary_precision': 0.91511387, 'binary_recall': 0.7027027, 'binary_specificity': 0.93730885, 'binary_f1_score': 0.794964}
confusion matrix:
     0    1
0  613   41
1  187  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8885596, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8573793, 'auroc': 0.93487406, 'binary_precision': 0.99390244, 'binary_recall': 0.72444445, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.8380463}
confusion matrix:
     0    1
0  224    1
1   62  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 01:43:58.070973,epoch time: 0:02:44.519701,used: 0:05:31.478628,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9563802, 'precision': 0.95770425, 'recall': 0.9568287, 'specificity': 0.9568287, 'f1': 0.9563695, 'auroc': 0.99448276, 'binary_precision': 0.98634815, 'binary_recall': 0.9268762, 'binary_specificity': 0.98678124, 'binary_f1_score': 0.9556878}
confusion matrix:
      0     1
0  1493    20
1   114  1445
---- Validation: 
scalar performance:
{'acc': 0.74512863, 'precision': 0.7771101, 'recall': 0.74173486, 'specificity': 0.74173486, 'f1': 0.73572636, 'auroc': 0.81259996, 'binary_precision': 0.86650485, 'binary_recall': 0.5675676, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.68587893}
confusion matrix:
     0    1
0  599   55
1  272  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8010925, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7652677, 'auroc': 0.8745284, 'binary_precision': 0.8961039, 'binary_recall': 0.61333334, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7282322}
confusion matrix:
     0    1
0  209   16
1   87  138
early stop counter: 1
val acc:0.7451286315917969, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 3,now: 2024-07-26 01:46:42.465682,epoch time: 0:02:44.394709,used: 0:08:15.873337,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.9732627, 'recall': 0.9729449, 'specificity': 0.9729449, 'f1': 0.9726546, 'auroc': 0.9982063, 'binary_precision': 0.9939638, 'binary_recall': 0.95183045, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.97244096}
confusion matrix:
      0     1
0  1506     9
1    75  1482
---- Validation: 
scalar performance:
{'acc': 0.7412315, 'precision': 0.7892939, 'recall': 0.737183, 'specificity': 0.737183, 'f1': 0.7278, 'auroc': 0.87668157, 'binary_precision': 0.902439, 'binary_recall': 0.5294118, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.6673347}
confusion matrix:
     0    1
0  618   36
1  296  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8223073, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7859312, 'auroc': 0.89214814, 'binary_precision': 0.92258066, 'binary_recall': 0.63555557, 'binary_specificity': 0.94666666, 'binary_f1_score': 0.7526316}
confusion matrix:
     0    1
0  213   12
1   82  143
early stop counter: 2
val acc:0.7412315011024475, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 4,now: 2024-07-26 01:49:26.533616,epoch time: 0:02:44.067934,used: 0:10:59.941271,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97265625, 'precision': 0.973523, 'recall': 0.9729738, 'specificity': 0.9729738, 'f1': 0.9726525, 'auroc': 0.99714744, 'binary_precision': 0.9972973, 'binary_recall': 0.9485861, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.972332}
confusion matrix:
      0     1
0  1512     4
1    80  1476
---- Validation: 
scalar performance:
{'acc': 0.5339049, 'precision': 0.66950846, 'recall': 0.52491575, 'specificity': 0.52491575, 'f1': 0.40062842, 'auroc': 0.81235933, 'binary_precision': 0.81632656, 'binary_recall': 0.06359301, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.11799411}
confusion matrix:
     0   1
0  645   9
1  589  40
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.84503365, 'recall': 0.7822223, 'specificity': 0.7822223, 'f1': 0.77183837, 'auroc': 0.8996346, 'binary_precision': 0.99224806, 'binary_recall': 0.5688889, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.7231639}
confusion matrix:
     0    1
0  224    1
1   97  128
early stop counter: 3
val acc:0.5339049100875854, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 5,now: 2024-07-26 01:52:10.532201,epoch time: 0:02:43.998585,used: 0:13:43.939856,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.98382944, 'recall': 0.9838885, 'specificity': 0.9838885, 'f1': 0.9837239, 'auroc': 0.99871373, 'binary_precision': 0.9954008, 'binary_recall': 0.9724005, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9837662}
confusion matrix:
      0     1
0  1507     7
1    43  1515
---- Validation: 
scalar performance:
{'acc': 0.75681996, 'precision': 0.7759235, 'recall': 0.7541751, 'specificity': 0.7541751, 'f1': 0.7511897, 'auroc': 0.8558607, 'binary_precision': 0.8438178, 'binary_recall': 0.618442, 'binary_specificity': 0.88990825, 'binary_f1_score': 0.7137615}
confusion matrix:
     0    1
0  582   72
1  240  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.81447965, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80803573, 'auroc': 0.9019457, 'binary_precision': 0.85641026, 'binary_recall': 0.74222225, 'binary_specificity': 0.8755556, 'binary_f1_score': 0.7952381}
confusion matrix:
     0    1
0  197   28
1   58  167
early stop counter: 4
val acc:0.7568199634552002, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 6,now: 2024-07-26 01:54:53.883037,epoch time: 0:02:43.350836,used: 0:16:27.290692,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9749349, 'precision': 0.9755209, 'recall': 0.97521955, 'specificity': 0.97521955, 'f1': 0.9749335, 'auroc': 0.99767387, 'binary_precision': 0.99597853, 'binary_recall': 0.95439947, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.97474587}
confusion matrix:
      0     1
0  1509     6
1    71  1486
---- Validation: 
scalar performance:
{'acc': 0.81995326, 'precision': 0.82307816, 'recall': 0.81895804, 'specificity': 0.81895804, 'f1': 0.8191406, 'auroc': 0.87764907, 'binary_precision': 0.8503521, 'binary_recall': 0.7678855, 'binary_specificity': 0.8700306, 'binary_f1_score': 0.8070175}
confusion matrix:
     0    1
0  569   85
1  146  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.80246216, 'recall': 0.7955556, 'specificity': 0.7955556, 'f1': 0.79438174, 'auroc': 0.8901333, 'binary_precision': 0.7567568, 'binary_recall': 0.8711111, 'binary_specificity': 0.72, 'binary_f1_score': 0.80991733}
confusion matrix:
     0    1
0  162   63
1   29  196
early stop counter: 5
val acc:0.8199532628059387, best validation acc: 0.8222914934158325, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 7,now: 2024-07-26 01:57:37.496438,epoch time: 0:02:43.613401,used: 0:19:10.904093,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_38_26_seed_3_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:10.904093 at 2024-07-26 01:57:37.496438
persisted model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.8885596, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8573793, 'auroc': 0.93487406, 'binary_precision': 0.99390244, 'binary_recall': 0.72444445, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.8380463}
confusion matrix:
     0    1
0  224    1
1   62  163
oracle model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.8885596, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8573793, 'auroc': 0.93487406, 'binary_precision': 0.99390244, 'binary_recall': 0.72444445, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.8380463}
confusion matrix:
     0    1
0  224    1
1   62  163
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8915 MiB | 246770 GiB | 246768 GiB |
|       from large pool |   2303 MiB |   8839 MiB | 244610 GiB | 244608 GiB |
|       from small pool |     91 MiB |    132 MiB |   2160 GiB |   2160 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8915 MiB | 246770 GiB | 246768 GiB |
|       from large pool |   2303 MiB |   8839 MiB | 244610 GiB | 244608 GiB |
|       from small pool |     91 MiB |    132 MiB |   2160 GiB |   2160 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 246407 GiB | 246405 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 244250 GiB | 244248 GiB |
|       from small pool |     91 MiB |    132 MiB |   2157 GiB |   2157 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9752 MiB |   9824 MiB |  28594 MiB |  18842 MiB |
|       from large pool |   9612 MiB |   9688 MiB |  28352 MiB |  18740 MiB |
|       from small pool |    140 MiB |    140 MiB |    242 MiB |    102 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    985 MiB |   1656 MiB | 170801 GiB | 170800 GiB |
|       from large pool |    974 MiB |   1651 MiB | 168579 GiB | 168578 GiB |
|       from small pool |     10 MiB |     60 MiB |   2222 GiB |   2222 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   35098 K  |   35095 K  |
|       from large pool |     392    |     816    |   17622 K  |   17621 K  |
|       from small pool |    2084    |    2780    |   17476 K  |   17473 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   35098 K  |   35095 K  |
|       from large pool |     392    |     816    |   17622 K  |   17621 K  |
|       from small pool |    2084    |    2780    |   17476 K  |   17473 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     286    |     333    |     790    |     504    |
|       from large pool |     216    |     265    |     669    |     453    |
|       from small pool |      70    |      70    |     121    |      51    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     143    |     319    |   19487 K  |   19487 K  |
|       from large pool |      72    |     255    |   10543 K  |   10543 K  |
|       from small pool |      71    |     227    |    8943 K  |    8943 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 246770 GiB | 246770 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 244610 GiB | 244610 GiB |
|       from small pool |      0 KiB |    132 MiB |   2160 GiB |   2160 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 246770 GiB | 246770 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 244610 GiB | 244610 GiB |
|       from small pool |      0 KiB |    132 MiB |   2160 GiB |   2160 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 246407 GiB | 246407 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 244250 GiB | 244250 GiB |
|       from small pool |      0 KiB |    132 MiB |   2157 GiB |   2157 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3380 MiB |   9824 MiB |  28594 MiB |  25214 MiB |
|       from large pool |   3278 MiB |   9688 MiB |  28352 MiB |  25074 MiB |
|       from small pool |    102 MiB |    140 MiB |    242 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 170802 GiB | 170802 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 168580 GiB | 168580 GiB |
|       from small pool |      0 KiB |     60 MiB |   2222 GiB |   2222 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   35098 K  |   35098 K  |
|       from large pool |       2    |     816    |   17622 K  |   17622 K  |
|       from small pool |       0    |    2780    |   17476 K  |   17476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   35098 K  |   35098 K  |
|       from large pool |       2    |     816    |   17622 K  |   17622 K  |
|       from small pool |       0    |    2780    |   17476 K  |   17476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |     790    |     661    |
|       from large pool |      78    |     265    |     669    |     591    |
|       from small pool |      51    |      70    |     121    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   19488 K  |   19488 K  |
|       from large pool |       3    |     255    |   10543 K  |   10543 K  |
|       from small pool |       0    |     227    |    8944 K  |    8944 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 246770 GiB | 246770 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 244610 GiB | 244610 GiB |
|       from small pool |      0 KiB |    132 MiB |   2160 GiB |   2160 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 246770 GiB | 246770 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 244610 GiB | 244610 GiB |
|       from small pool |      0 KiB |    132 MiB |   2160 GiB |   2160 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 246407 GiB | 246407 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 244250 GiB | 244250 GiB |
|       from small pool |      0 KiB |    132 MiB |   2157 GiB |   2157 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3380 MiB |   9824 MiB |  28594 MiB |  25214 MiB |
|       from large pool |   3278 MiB |   9688 MiB |  28352 MiB |  25074 MiB |
|       from small pool |    102 MiB |    140 MiB |    242 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 170802 GiB | 170802 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 168580 GiB | 168580 GiB |
|       from small pool |      0 KiB |     60 MiB |   2222 GiB |   2222 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   35098 K  |   35098 K  |
|       from large pool |       2    |     816    |   17622 K  |   17622 K  |
|       from small pool |       0    |    2780    |   17476 K  |   17476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   35098 K  |   35098 K  |
|       from large pool |       2    |     816    |   17622 K  |   17622 K  |
|       from small pool |       0    |    2780    |   17476 K  |   17476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |     790    |     661    |
|       from large pool |      78    |     265    |     669    |     591    |
|       from small pool |      51    |      70    |     121    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   19488 K  |   19488 K  |
|       from large pool |       3    |     255    |   10543 K  |   10543 K  |
|       from small pool |       0    |     227    |    8944 K  |    8944 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702

 Experiment start at: 2024-07-26 01:58:14.678459
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.96146375, 'precision': 0.9628114, 'recall': 0.96200144, 'specificity': 0.96200144, 'f1': 0.9614562, 'auroc': 0.9946803, 'binary_precision': 0.9925373, 'binary_recall': 0.93125397, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9609195}
confusion matrix:
      0     1
0  1506    11
1   108  1463
---- Validation: 
scalar performance:
{'acc': 0.5659641, 'precision': 0.69258213, 'recall': 0.56047887, 'specificity': 0.56047887, 'f1': 0.47258967, 'auroc': 0.7484006, 'binary_precision': 0.8454546, 'binary_recall': 0.1471519, 'binary_specificity': 0.97380584, 'binary_f1_score': 0.25067386}
confusion matrix:
     0   1
0  632  17
1  539  93
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60900474, 'precision': 0.7367779, 'recall': 0.60900474, 'specificity': 0.60900474, 'f1': 0.54803026, 'auroc': 0.8645358, 'binary_precision': 0.91071427, 'binary_recall': 0.24170616, 'binary_specificity': 0.97630334, 'binary_f1_score': 0.3820225}
confusion matrix:
     0   1
0  206   5
1  160  51
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:01:06.129061,epoch time: 0:02:51.450602,used: 0:02:51.450602,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94332904, 'precision': 0.94333774, 'recall': 0.943281, 'specificity': 0.943281, 'f1': 0.9433069, 'auroc': 0.9876394, 'binary_precision': 0.9429296, 'binary_recall': 0.94592875, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.94442683}
confusion matrix:
      0     1
0  1426    90
1    85  1487
---- Validation: 
scalar performance:
{'acc': 0.72287273, 'precision': 0.762658, 'recall': 0.72024393, 'specificity': 0.72024393, 'f1': 0.71038496, 'auroc': 0.8436885, 'binary_precision': 0.8616188, 'binary_recall': 0.5221519, 'binary_specificity': 0.9183359, 'binary_f1_score': 0.6502463}
confusion matrix:
     0    1
0  596   53
1  302  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7701422, 'precision': 0.8352754, 'recall': 0.7701422, 'specificity': 0.7701422, 'f1': 0.75840884, 'auroc': 0.9294041, 'binary_precision': 0.9830508, 'binary_recall': 0.549763, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.7051672}
confusion matrix:
     0    1
0  209    2
1   95  116
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 02:03:53.755527,epoch time: 0:02:47.626466,used: 0:05:39.077068,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9621114, 'precision': 0.96262276, 'recall': 0.9625057, 'specificity': 0.9625057, 'f1': 0.9621111, 'auroc': 0.9926369, 'binary_precision': 0.98339975, 'binary_recall': 0.94151306, 'binary_specificity': 0.98349833, 'binary_f1_score': 0.96200067}
confusion matrix:
      0     1
0  1490    25
1    92  1481
---- Validation: 
scalar performance:
{'acc': 0.57064795, 'precision': 0.62253785, 'recall': 0.56615824, 'specificity': 0.56615824, 'f1': 0.5123249, 'auroc': 0.75059974, 'binary_precision': 0.69902915, 'binary_recall': 0.2278481, 'binary_specificity': 0.9044684, 'binary_f1_score': 0.3436754}
confusion matrix:
     0    1
0  587   62
1  488  144
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80094784, 'precision': 0.80227864, 'recall': 0.80094784, 'specificity': 0.80094784, 'f1': 0.80072856, 'auroc': 0.8401878, 'binary_precision': 0.822335, 'binary_recall': 0.7677725, 'binary_specificity': 0.8341232, 'binary_f1_score': 0.7941176}
confusion matrix:
     0    1
0  176   35
1   49  162
new oracle model saved
early stop counter: 1
val acc:0.5706479549407959, best validation acc: 0.7228727340698242, corresponding to test acc:                         0.7701421976089478 / 0.8009478449821472
after epoch: 3,now: 2024-07-26 02:06:40.038414,epoch time: 0:02:46.282887,used: 0:08:25.359955,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9847798, 'precision': 0.9847555, 'recall': 0.9849099, 'specificity': 0.9849099, 'f1': 0.98477805, 'auroc': 0.9988763, 'binary_precision': 0.99225307, 'binary_recall': 0.97773534, 'binary_specificity': 0.99208444, 'binary_f1_score': 0.98494077}
confusion matrix:
      0     1
0  1504    12
1    35  1537
---- Validation: 
scalar performance:
{'acc': 0.7135051, 'precision': 0.773316, 'recall': 0.7103565, 'specificity': 0.7103565, 'f1': 0.6949416, 'auroc': 0.85921866, 'binary_precision': 0.8978979, 'binary_recall': 0.47310126, 'binary_specificity': 0.9476117, 'binary_f1_score': 0.6196891}
confusion matrix:
     0    1
0  615   34
1  333  299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7298578, 'precision': 0.8114557, 'recall': 0.7298578, 'specificity': 0.7298578, 'f1': 0.7109242, 'auroc': 0.9090766, 'binary_precision': 0.9708738, 'binary_recall': 0.47393364, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.6369427}
confusion matrix:
     0    1
0  208    3
1  111  100
early stop counter: 2
val acc:0.7135050892829895, best validation acc: 0.7228727340698242, corresponding to test acc:                         0.7701421976089478 / 0.8009478449821472
after epoch: 4,now: 2024-07-26 02:09:25.258934,epoch time: 0:02:45.220520,used: 0:11:10.580475,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9773316, 'precision': 0.97776294, 'recall': 0.9776884, 'specificity': 0.9776884, 'f1': 0.9773315, 'auroc': 0.99890065, 'binary_precision': 0.997351, 'binary_recall': 0.95801526, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.9772875}
confusion matrix:
      0     1
0  1512     4
1    66  1506
---- Validation: 
scalar performance:
{'acc': 0.6721311, 'precision': 0.77076113, 'recall': 0.6680738, 'specificity': 0.6680738, 'f1': 0.636117, 'auroc': 0.8690488, 'binary_precision': 0.9308943, 'binary_recall': 0.36234176, 'binary_specificity': 0.97380584, 'binary_f1_score': 0.5216401}
confusion matrix:
     0    1
0  632   17
1  403  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6279621, 'precision': 0.736665, 'recall': 0.6279621, 'specificity': 0.6279621, 'f1': 0.5796999, 'auroc': 0.8948586, 'binary_precision': 0.89705884, 'binary_recall': 0.2890995, 'binary_specificity': 0.96682465, 'binary_f1_score': 0.43727595}
confusion matrix:
     0   1
0  204   7
1  150  61
early stop counter: 3
val acc:0.6721311211585999, best validation acc: 0.7228727340698242, corresponding to test acc:                         0.7701421976089478 / 0.8009478449821472
after epoch: 5,now: 2024-07-26 02:12:09.272820,epoch time: 0:02:44.013886,used: 0:13:54.594361,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98542744, 'precision': 0.9853875, 'recall': 0.9855225, 'specificity': 0.9855225, 'f1': 0.9854251, 'auroc': 0.99891365, 'binary_precision': 0.9909968, 'binary_recall': 0.9802799, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.98560923}
confusion matrix:
      0     1
0  1502    14
1    31  1541
---- Validation: 
scalar performance:
{'acc': 0.6869633, 'precision': 0.7319964, 'recall': 0.6839758, 'specificity': 0.6839758, 'f1': 0.6687982, 'auroc': 0.8424548, 'binary_precision': 0.83094555, 'binary_recall': 0.45886075, 'binary_specificity': 0.90909094, 'binary_f1_score': 0.5912334}
confusion matrix:
     0    1
0  590   59
1  342  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67535543, 'precision': 0.7458743, 'recall': 0.67535543, 'specificity': 0.67535543, 'f1': 0.65027976, 'auroc': 0.86273897, 'binary_precision': 0.877551, 'binary_recall': 0.40758294, 'binary_specificity': 0.943128, 'binary_f1_score': 0.5566343}
confusion matrix:
     0   1
0  199  12
1  125  86
early stop counter: 4
val acc:0.6869633197784424, best validation acc: 0.7228727340698242, corresponding to test acc:                         0.7701421976089478 / 0.8009478449821472
after epoch: 6,now: 2024-07-26 02:14:53.122915,epoch time: 0:02:43.850095,used: 0:16:38.444456,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97409326, 'precision': 0.9751414, 'recall': 0.97370577, 'specificity': 0.97370577, 'f1': 0.9740541, 'auroc': 0.99886024, 'binary_precision': 0.95716035, 'binary_recall': 0.99364674, 'binary_specificity': 0.95376486, 'binary_f1_score': 0.9750623}
confusion matrix:
      0     1
0  1444    70
1    10  1564
---- Validation: 
scalar performance:
{'acc': 0.8165496, 'precision': 0.8180977, 'recall': 0.81700426, 'specificity': 0.81700426, 'f1': 0.8164489, 'auroc': 0.8806782, 'binary_precision': 0.79234165, 'binary_recall': 0.85126585, 'binary_specificity': 0.7827427, 'binary_f1_score': 0.8207475}
confusion matrix:
     0    1
0  508  141
1   94  538
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80094784, 'precision': 0.8013811, 'recall': 0.8009479, 'specificity': 0.8009479, 'f1': 0.8008763, 'auroc': 0.88380766, 'binary_precision': 0.81280786, 'binary_recall': 0.7819905, 'binary_specificity': 0.8199052, 'binary_f1_score': 0.79710144}
confusion matrix:
     0    1
0  173   38
1   46  165
better model found
persisted
after epoch: 7,now: 2024-07-26 02:17:37.868751,epoch time: 0:02:44.745836,used: 0:19:23.190292,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9498057, 'precision': 0.9536483, 'recall': 0.95066833, 'specificity': 0.95066833, 'f1': 0.949752, 'auroc': 0.9962605, 'binary_precision': 1.0, 'binary_recall': 0.9013367, 'binary_specificity': 1.0, 'binary_f1_score': 0.9481085}
confusion matrix:
      0     1
0  1517     0
1   155  1416
---- Validation: 
scalar performance:
{'acc': 0.5175644, 'precision': 0.7248765, 'recall': 0.51109666, 'specificity': 0.51109666, 'f1': 0.36170617, 'auroc': 0.8061776, 'binary_precision': 0.9375, 'binary_recall': 0.023734177, 'binary_specificity': 0.99845916, 'binary_f1_score': 0.046296295}
confusion matrix:
     0   1
0  648   1
1  617  15
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33749992, 'auroc': 0.8662822, 'binary_precision': 0.5, 'binary_recall': 0.0047393367, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.0093896715}
confusion matrix:
     0  1
0  210  1
1  210  1
early stop counter: 1
val acc:0.5175644159317017, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.8009478449821472 / 0.8009478449821472
after epoch: 8,now: 2024-07-26 02:20:22.176457,epoch time: 0:02:44.307706,used: 0:22:07.497998,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.9834617, 'recall': 0.9836534, 'specificity': 0.9836534, 'f1': 0.98348236, 'auroc': 0.9981561, 'binary_precision': 0.99224806, 'binary_recall': 0.9752381, 'binary_specificity': 0.9920687, 'binary_f1_score': 0.9836695}
confusion matrix:
      0     1
0  1501    12
1    39  1536
---- Validation: 
scalar performance:
{'acc': 0.6533958, 'precision': 0.75144225, 'recall': 0.64919007, 'specificity': 0.64919007, 'f1': 0.6123135, 'auroc': 0.8782011, 'binary_precision': 0.9051724, 'binary_recall': 0.3322785, 'binary_specificity': 0.9661017, 'binary_f1_score': 0.48611116}
confusion matrix:
     0    1
0  627   22
1  422  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6161137, 'precision': 0.77321494, 'recall': 0.6161137, 'specificity': 0.6161137, 'f1': 0.5516644, 'auroc': 0.9154949, 'binary_precision': 0.98039216, 'binary_recall': 0.23696682, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.3816794}
confusion matrix:
     0   1
0  210   1
1  161  50
early stop counter: 2
val acc:0.6533957719802856, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.8009478449821472 / 0.8009478449821472
after epoch: 9,now: 2024-07-26 02:23:06.102988,epoch time: 0:02:43.926531,used: 0:24:51.424529,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9831606, 'precision': 0.98321426, 'recall': 0.9831039, 'specificity': 0.9831039, 'f1': 0.98315245, 'auroc': 0.9990097, 'binary_precision': 0.98103666, 'binary_recall': 0.9860229, 'binary_specificity': 0.9801849, 'binary_f1_score': 0.9835234}
confusion matrix:
      0     1
0  1484    30
1    22  1552
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.80081165, 'recall': 0.79799986, 'specificity': 0.79799986, 'f1': 0.7979742, 'auroc': 0.88045144, 'binary_precision': 0.8235294, 'binary_recall': 0.7531645, 'binary_specificity': 0.8428351, 'binary_f1_score': 0.78677684}
confusion matrix:
     0    1
0  547  102
1  156  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8649289, 'precision': 0.86513394, 'recall': 0.8649289, 'specificity': 0.8649289, 'f1': 0.86491, 'auroc': 0.92053187, 'binary_precision': 0.8737864, 'binary_recall': 0.8530806, 'binary_specificity': 0.87677723, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  185   26
1   31  180
new oracle model saved
early stop counter: 3
val acc:0.7985948324203491, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.8009478449821472 / 0.8649289011955261
after epoch: 10,now: 2024-07-26 02:25:50.130615,epoch time: 0:02:44.027627,used: 0:27:35.452156,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.9876518, 'recall': 0.98781556, 'specificity': 0.98781556, 'f1': 0.98769224, 'auroc': 0.9995077, 'binary_precision': 0.9942085, 'binary_recall': 0.9815756, 'binary_specificity': 0.9940555, 'binary_f1_score': 0.9878517}
confusion matrix:
      0     1
0  1505     9
1    29  1545
---- Validation: 
scalar performance:
{'acc': 0.6323185, 'precision': 0.74944997, 'recall': 0.627705, 'specificity': 0.627705, 'f1': 0.57896686, 'auroc': 0.8924782, 'binary_precision': 0.91709846, 'binary_recall': 0.2800633, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.42909092}
confusion matrix:
     0    1
0  633   16
1  455  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.578199, 'precision': 0.7712082, 'recall': 0.578199, 'specificity': 0.578199, 'f1': 0.48691255, 'auroc': 0.935289, 'binary_precision': 1.0, 'binary_recall': 0.1563981, 'binary_specificity': 1.0, 'binary_f1_score': 0.2704918}
confusion matrix:
     0   1
0  211   0
1  178  33
early stop counter: 4
val acc:0.6323184967041016, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.8009478449821472 / 0.8649289011955261
after epoch: 11,now: 2024-07-26 02:28:34.518998,epoch time: 0:02:44.388383,used: 0:30:19.840539,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9773316, 'precision': 0.9784172, 'recall': 0.9769735, 'specificity': 0.9769735, 'f1': 0.9772996, 'auroc': 0.99909574, 'binary_precision': 0.9595836, 'binary_recall': 0.99745387, 'binary_specificity': 0.9564931, 'binary_f1_score': 0.9781523}
confusion matrix:
      0     1
0  1451    66
1     4  1567
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.7977104, 'recall': 0.796687, 'specificity': 0.796687, 'f1': 0.79675996, 'auroc': 0.86385334, 'binary_precision': 0.8089701, 'binary_recall': 0.7705696, 'binary_specificity': 0.82280433, 'binary_f1_score': 0.78930306}
confusion matrix:
     0    1
0  534  115
1  145  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.85654914, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.8500973, 'auroc': 0.91624177, 'binary_precision': 0.90217394, 'binary_recall': 0.7867299, 'binary_specificity': 0.9146919, 'binary_f1_score': 0.8405063}
confusion matrix:
     0    1
0  193   18
1   45  166
early stop counter: 5
val acc:0.7970335483551025, best validation acc: 0.8165495991706848, corresponding to test acc:                         0.8009478449821472 / 0.8649289011955261
after epoch: 12,now: 2024-07-26 02:31:17.882417,epoch time: 0:02:43.363419,used: 0:33:03.203958,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_01_58_14_seed_4_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 0:33:03.203958 at 2024-07-26 02:31:17.882417
persisted model performance metric: 

scalar performance:
{'acc': 0.80094784, 'precision': 0.8013811, 'recall': 0.8009479, 'specificity': 0.8009479, 'f1': 0.8008763, 'auroc': 0.88380766, 'binary_precision': 0.81280786, 'binary_recall': 0.7819905, 'binary_specificity': 0.8199052, 'binary_f1_score': 0.79710144}
confusion matrix:
     0    1
0  173   38
1   46  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8649289, 'precision': 0.86513394, 'recall': 0.8649289, 'specificity': 0.8649289, 'f1': 0.86491, 'auroc': 0.92053187, 'binary_precision': 0.8737864, 'binary_recall': 0.8530806, 'binary_specificity': 0.87677723, 'binary_f1_score': 0.8633094}
confusion matrix:
     0    1
0  185   26
1   31  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8915 MiB | 327236 GiB | 327234 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 324372 GiB | 324370 GiB |
|       from small pool |     91 MiB |    132 MiB |   2863 GiB |   2863 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8915 MiB | 327236 GiB | 327234 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 324372 GiB | 324370 GiB |
|       from small pool |     91 MiB |    132 MiB |   2863 GiB |   2863 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 326764 GiB | 326762 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 323904 GiB | 323902 GiB |
|       from small pool |     91 MiB |    132 MiB |   2859 GiB |   2859 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9738 MiB |   9824 MiB |  34952 MiB |  25214 MiB |
|       from large pool |   9602 MiB |   9688 MiB |  34676 MiB |  25074 MiB |
|       from small pool |    136 MiB |    140 MiB |    276 MiB |    140 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    920 MiB |   1656 MiB | 229803 GiB | 229802 GiB |
|       from large pool |    910 MiB |   1651 MiB | 226857 GiB | 226856 GiB |
|       from small pool |     10 MiB |     60 MiB |   2945 GiB |   2945 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2464    |    3329    |   46536 K  |   46533 K  |
|       from large pool |     392    |     816    |   23367 K  |   23367 K  |
|       from small pool |    2072    |    2780    |   23168 K  |   23166 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2464    |    3329    |   46536 K  |   46533 K  |
|       from large pool |     392    |     816    |   23367 K  |   23367 K  |
|       from small pool |    2072    |    2780    |   23168 K  |   23166 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     333    |     946    |     661    |
|       from large pool |     217    |     265    |     808    |     591    |
|       from small pool |      68    |      70    |     138    |      70    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |     319    |   25460 K  |   25460 K  |
|       from large pool |      70    |     255    |   13584 K  |   13584 K  |
|       from small pool |      71    |     227    |   11876 K  |   11876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 327236 GiB | 327236 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 324372 GiB | 324372 GiB |
|       from small pool |      0 KiB |    132 MiB |   2863 GiB |   2863 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 327236 GiB | 327236 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 324372 GiB | 324372 GiB |
|       from small pool |      0 KiB |    132 MiB |   2863 GiB |   2863 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 326764 GiB | 326764 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 323904 GiB | 323904 GiB |
|       from small pool |      0 KiB |    132 MiB |   2859 GiB |   2859 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3314 MiB |   9824 MiB |  34952 MiB |  31638 MiB |
|       from large pool |   3212 MiB |   9688 MiB |  34676 MiB |  31464 MiB |
|       from small pool |    102 MiB |    140 MiB |    276 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 229804 GiB | 229804 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 226858 GiB | 226858 GiB |
|       from small pool |      0 KiB |     60 MiB |   2945 GiB |   2945 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   46536 K  |   46536 K  |
|       from large pool |       2    |     816    |   23367 K  |   23367 K  |
|       from small pool |       0    |    2780    |   23168 K  |   23168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   46536 K  |   46536 K  |
|       from large pool |       2    |     816    |   23367 K  |   23367 K  |
|       from small pool |       0    |    2780    |   23168 K  |   23168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |     946    |     817    |
|       from large pool |      78    |     265    |     808    |     730    |
|       from small pool |      51    |      70    |     138    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   25461 K  |   25461 K  |
|       from large pool |       3    |     255    |   13584 K  |   13584 K  |
|       from small pool |       0    |     227    |   11876 K  |   11876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 327236 GiB | 327236 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 324372 GiB | 324372 GiB |
|       from small pool |      0 KiB |    132 MiB |   2863 GiB |   2863 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 327236 GiB | 327236 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 324372 GiB | 324372 GiB |
|       from small pool |      0 KiB |    132 MiB |   2863 GiB |   2863 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 326764 GiB | 326764 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 323904 GiB | 323904 GiB |
|       from small pool |      0 KiB |    132 MiB |   2859 GiB |   2859 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3314 MiB |   9824 MiB |  34952 MiB |  31638 MiB |
|       from large pool |   3212 MiB |   9688 MiB |  34676 MiB |  31464 MiB |
|       from small pool |    102 MiB |    140 MiB |    276 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 229804 GiB | 229804 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 226858 GiB | 226858 GiB |
|       from small pool |      0 KiB |     60 MiB |   2945 GiB |   2945 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   46536 K  |   46536 K  |
|       from large pool |       2    |     816    |   23367 K  |   23367 K  |
|       from small pool |       0    |    2780    |   23168 K  |   23168 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   46536 K  |   46536 K  |
|       from large pool |       2    |     816    |   23367 K  |   23367 K  |
|       from small pool |       0    |    2780    |   23168 K  |   23168 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |     946    |     817    |
|       from large pool |      78    |     265    |     808    |     730    |
|       from small pool |      51    |      70    |     138    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   25461 K  |   25461 K  |
|       from large pool |       3    |     255    |   13584 K  |   13584 K  |
|       from small pool |       0    |     227    |   11876 K  |   11876 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702

 Experiment start at: 2024-07-26 02:31:52.221812
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.93193716, 'precision': 0.93891895, 'recall': 0.9330114, 'specificity': 0.9330114, 'f1': 0.9317639, 'auroc': 0.99113727, 'binary_precision': 0.9985174, 'binary_recall': 0.8673535, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.92832524}
confusion matrix:
      0     1
0  1501     2
1   206  1347
---- Validation: 
scalar performance:
{'acc': 0.7682737, 'precision': 0.7740036, 'recall': 0.7701833, 'specificity': 0.7701833, 'f1': 0.7677682, 'auroc': 0.8385428, 'binary_precision': 0.7267684, 'binary_recall': 0.8384, 'binary_specificity': 0.7019667, 'binary_f1_score': 0.77860326}
confusion matrix:
     0    1
0  464  197
1  101  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813853, 'precision': 0.78654575, 'recall': 0.7813853, 'specificity': 0.7813853, 'f1': 0.7803966, 'auroc': 0.8732033, 'binary_precision': 0.7480916, 'binary_recall': 0.8484849, 'binary_specificity': 0.71428573, 'binary_f1_score': 0.79513186}
confusion matrix:
     0    1
0  165   66
1   35  196
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 02:34:36.315381,epoch time: 0:02:44.093569,used: 0:02:44.093569,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9725131, 'precision': 0.9726789, 'recall': 0.9727502, 'specificity': 0.9727502, 'f1': 0.9725129, 'auroc': 0.99659526, 'binary_precision': 0.98675495, 'binary_recall': 0.95881593, 'binary_specificity': 0.98668444, 'binary_f1_score': 0.97258484}
confusion matrix:
      0     1
0  1482    20
1    64  1490
---- Validation: 
scalar performance:
{'acc': 0.80715394, 'precision': 0.8209443, 'recall': 0.8100091, 'specificity': 0.8100091, 'f1': 0.80593306, 'auroc': 0.9096738, 'binary_precision': 0.7470511, 'binary_recall': 0.912, 'binary_specificity': 0.7080182, 'binary_f1_score': 0.8213256}
confusion matrix:
     0    1
0  468  193
1   55  570
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75541127, 'precision': 0.7837483, 'recall': 0.75541127, 'specificity': 0.75541127, 'f1': 0.74914825, 'auroc': 0.9104965, 'binary_precision': 0.6940789, 'binary_recall': 0.9134199, 'binary_specificity': 0.5974026, 'binary_f1_score': 0.78878504}
confusion matrix:
     0    1
0  138   93
1   20  211
better model found
persisted
after epoch: 2,now: 2024-07-26 02:37:18.903635,epoch time: 0:02:42.588254,used: 0:05:26.681823,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9780759, 'precision': 0.9781152, 'recall': 0.97803056, 'specificity': 0.97803056, 'f1': 0.97806776, 'auroc': 0.99794054, 'binary_precision': 0.97629726, 'binary_recall': 0.980695, 'binary_specificity': 0.9753662, 'binary_f1_score': 0.9784912}
confusion matrix:
      0     1
0  1465    37
1    30  1524
---- Validation: 
scalar performance:
{'acc': 0.7978227, 'precision': 0.8178855, 'recall': 0.8012805, 'specificity': 0.8012805, 'f1': 0.79573536, 'auroc': 0.91528714, 'binary_precision': 0.7307206, 'binary_recall': 0.9248, 'binary_specificity': 0.67776096, 'binary_f1_score': 0.8163842}
confusion matrix:
     0    1
0  448  213
1   47  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8138528, 'precision': 0.8349701, 'recall': 0.8138528, 'specificity': 0.8138528, 'f1': 0.8108721, 'auroc': 0.91180825, 'binary_precision': 0.75086504, 'binary_recall': 0.93939394, 'binary_specificity': 0.6883117, 'binary_f1_score': 0.8346154}
confusion matrix:
     0    1
0  159   72
1   14  217
new oracle model saved
early stop counter: 1
val acc:0.7978227138519287, best validation acc: 0.8071539402008057, corresponding to test acc:                         0.7554112672805786 / 0.8138527870178223
after epoch: 3,now: 2024-07-26 02:40:01.451656,epoch time: 0:02:42.548021,used: 0:08:09.229844,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9195026, 'precision': 0.9299003, 'recall': 0.91831064, 'specificity': 0.91831064, 'f1': 0.91884065, 'auroc': 0.99633366, 'binary_precision': 0.86685395, 'binary_recall': 0.994201, 'binary_specificity': 0.8424202, 'binary_f1_score': 0.9261705}
confusion matrix:
      0     1
0  1267   237
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.67729396, 'precision': 0.77037597, 'recall': 0.6852974, 'specificity': 0.6852974, 'f1': 0.65257883, 'auroc': 0.918262, 'binary_precision': 0.60458165, 'binary_recall': 0.9712, 'binary_specificity': 0.39939487, 'binary_f1_score': 0.7452425}
confusion matrix:
     0    1
0  264  397
1   18  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7034632, 'precision': 0.7769643, 'recall': 0.7034632, 'specificity': 0.7034632, 'f1': 0.6823914, 'auroc': 0.92531997, 'binary_precision': 0.6342857, 'binary_recall': 0.96103895, 'binary_specificity': 0.44588745, 'binary_f1_score': 0.7641996}
confusion matrix:
     0    1
0  103  128
1    9  222
early stop counter: 2
val acc:0.6772939562797546, best validation acc: 0.8071539402008057, corresponding to test acc:                         0.7554112672805786 / 0.8138527870178223
after epoch: 4,now: 2024-07-26 02:42:44.474380,epoch time: 0:02:43.022724,used: 0:10:52.252568,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.97255814, 'recall': 0.9723972, 'specificity': 0.9723972, 'f1': 0.97218513, 'auroc': 0.9973891, 'binary_precision': 0.9892905, 'binary_recall': 0.95539755, 'binary_specificity': 0.9893969, 'binary_f1_score': 0.97204864}
confusion matrix:
      0     1
0  1493    16
1    69  1478
---- Validation: 
scalar performance:
{'acc': 0.7496112, 'precision': 0.7564492, 'recall': 0.7471056, 'specificity': 0.7471056, 'f1': 0.74652064, 'auroc': 0.8378941, 'binary_precision': 0.7919075, 'binary_recall': 0.6576, 'binary_specificity': 0.8366112, 'binary_f1_score': 0.7185314}
confusion matrix:
     0    1
0  553  108
1  214  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7922078, 'precision': 0.8133478, 'recall': 0.7922078, 'specificity': 0.7922078, 'f1': 0.78864294, 'auroc': 0.8859092, 'binary_precision': 0.8947368, 'binary_recall': 0.66233766, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.76119393}
confusion matrix:
     0    1
0  213   18
1   78  153
early stop counter: 3
val acc:0.7496111989021301, best validation acc: 0.8071539402008057, corresponding to test acc:                         0.7554112672805786 / 0.8138527870178223
after epoch: 5,now: 2024-07-26 02:45:26.680341,epoch time: 0:02:42.205961,used: 0:13:34.458529,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9656414, 'precision': 0.9679189, 'recall': 0.96508116, 'specificity': 0.96508116, 'f1': 0.9655595, 'auroc': 0.999129, 'binary_precision': 0.93939394, 'binary_recall': 0.99678457, 'binary_specificity': 0.93337774, 'binary_f1_score': 0.96723866}
confusion matrix:
      0     1
0  1401   100
1     5  1550
---- Validation: 
scalar performance:
{'acc': 0.7620529, 'precision': 0.79631984, 'recall': 0.76670253, 'specificity': 0.76670253, 'f1': 0.75696886, 'auroc': 0.8915849, 'binary_precision': 0.6883117, 'binary_recall': 0.9328, 'binary_specificity': 0.60060513, 'binary_f1_score': 0.79211956}
confusion matrix:
     0    1
0  397  264
1   42  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75541127, 'precision': 0.7912179, 'recall': 0.75541127, 'specificity': 0.75541127, 'f1': 0.7476545, 'auroc': 0.8854969, 'binary_precision': 0.6891026, 'binary_recall': 0.93073595, 'binary_specificity': 0.5800866, 'binary_f1_score': 0.79189694}
confusion matrix:
     0    1
0  134   97
1   16  215
early stop counter: 4
val acc:0.7620528936386108, best validation acc: 0.8071539402008057, corresponding to test acc:                         0.7554112672805786 / 0.8138527870178223
after epoch: 6,now: 2024-07-26 02:48:09.004135,epoch time: 0:02:42.323794,used: 0:16:16.782323,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9842783, 'recall': 0.9842999, 'specificity': 0.9842999, 'f1': 0.98428863, 'auroc': 0.99809945, 'binary_precision': 0.98519, 'binary_recall': 0.98392284, 'binary_specificity': 0.9846769, 'binary_f1_score': 0.98455596}
confusion matrix:
      0     1
0  1478    23
1    25  1530
---- Validation: 
scalar performance:
{'acc': 0.83825815, 'precision': 0.8579755, 'recall': 0.8349507, 'specificity': 0.8349507, 'f1': 0.8349524, 'auroc': 0.92117643, 'binary_precision': 0.9352818, 'binary_recall': 0.7168, 'binary_specificity': 0.95310134, 'binary_f1_score': 0.8115942}
confusion matrix:
     0    1
0  630   31
1  177  448
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74458873, 'precision': 0.8098279, 'recall': 0.74458873, 'specificity': 0.74458873, 'f1': 0.7303964, 'auroc': 0.9084725, 'binary_precision': 0.952, 'binary_recall': 0.5151515, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.66853935}
confusion matrix:
     0    1
0  225    6
1  112  119
better model found
persisted
after epoch: 7,now: 2024-07-26 02:50:51.615087,epoch time: 0:02:42.610952,used: 0:18:59.393275,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9862677, 'recall': 0.9863868, 'specificity': 0.9863868, 'f1': 0.9862558, 'auroc': 0.99867713, 'binary_precision': 0.99475753, 'binary_recall': 0.9780928, 'binary_specificity': 0.9946808, 'binary_f1_score': 0.98635477}
confusion matrix:
      0     1
0  1496     8
1    34  1518
---- Validation: 
scalar performance:
{'acc': 0.83748055, 'precision': 0.8402774, 'recall': 0.83615494, 'specificity': 0.83615494, 'f1': 0.8366627, 'auroc': 0.9121573, 'binary_precision': 0.8649123, 'binary_recall': 0.7888, 'binary_specificity': 0.8835098, 'binary_f1_score': 0.8251046}
confusion matrix:
     0    1
0  584   77
1  132  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8246753, 'precision': 0.8352361, 'recall': 0.8246753, 'specificity': 0.8246753, 'f1': 0.82328355, 'auroc': 0.8948858, 'binary_precision': 0.8947368, 'binary_recall': 0.73593074, 'binary_specificity': 0.9134199, 'binary_f1_score': 0.8076009}
confusion matrix:
     0    1
0  211   20
1   61  170
new oracle model saved
early stop counter: 1
val acc:0.8374805450439453, best validation acc: 0.8382581472396851, corresponding to test acc:                         0.7445887327194214 / 0.8246753215789795
after epoch: 8,now: 2024-07-26 02:53:35.204401,epoch time: 0:02:43.589314,used: 0:21:42.982589,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.9780674, 'recall': 0.9777706, 'specificity': 0.9777706, 'f1': 0.97742045, 'auroc': 0.9988763, 'binary_precision': 1.0, 'binary_recall': 0.95554125, 'binary_specificity': 1.0, 'binary_f1_score': 0.97726524}
confusion matrix:
      0     1
0  1504     0
1    69  1483
---- Validation: 
scalar performance:
{'acc': 0.60808706, 'precision': 0.75817484, 'recall': 0.59710497, 'specificity': 0.59710497, 'f1': 0.5293482, 'auroc': 0.89955044, 'binary_precision': 0.94814813, 'binary_recall': 0.2048, 'binary_specificity': 0.98941, 'binary_f1_score': 0.3368421}
confusion matrix:
     0    1
0  654    7
1  497  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53246754, 'precision': 0.72901523, 'recall': 0.53246754, 'specificity': 0.53246754, 'f1': 0.40475282, 'auroc': 0.9006625, 'binary_precision': 0.9411765, 'binary_recall': 0.06926407, 'binary_specificity': 0.995671, 'binary_f1_score': 0.12903225}
confusion matrix:
     0   1
0  230   1
1  215  16
early stop counter: 2
val acc:0.6080870628356934, best validation acc: 0.8382581472396851, corresponding to test acc:                         0.7445887327194214 / 0.8246753215789795
after epoch: 9,now: 2024-07-26 02:56:17.270717,epoch time: 0:02:42.066316,used: 0:24:25.048905,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98110294, 'recall': 0.9809546, 'specificity': 0.9809546, 'f1': 0.98101366, 'auroc': 0.9988519, 'binary_precision': 0.9776215, 'binary_recall': 0.98518044, 'binary_specificity': 0.97672874, 'binary_f1_score': 0.9813864}
confusion matrix:
      0     1
0  1469    35
1    23  1529
---- Validation: 
scalar performance:
{'acc': 0.7037325, 'precision': 0.7036042, 'recall': 0.70373976, 'specificity': 0.70373976, 'f1': 0.70362043, 'auroc': 0.796282, 'binary_precision': 0.6918239, 'binary_recall': 0.704, 'binary_specificity': 0.7034796, 'binary_f1_score': 0.6978588}
confusion matrix:
     0    1
0  465  196
1  185  440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8160173, 'precision': 0.8284829, 'recall': 0.81601727, 'specificity': 0.81601727, 'f1': 0.8142551, 'auroc': 0.91302633, 'binary_precision': 0.76449275, 'binary_recall': 0.9134199, 'binary_specificity': 0.7186147, 'binary_f1_score': 0.8323471}
confusion matrix:
     0    1
0  166   65
1   20  211
early stop counter: 3
val acc:0.7037324905395508, best validation acc: 0.8382581472396851, corresponding to test acc:                         0.7445887327194214 / 0.8246753215789795
after epoch: 10,now: 2024-07-26 02:59:00.129997,epoch time: 0:02:42.859280,used: 0:27:07.908185,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.987204, 'recall': 0.98730445, 'specificity': 0.98730445, 'f1': 0.9872364, 'auroc': 0.9986985, 'binary_precision': 0.99155843, 'binary_recall': 0.9832582, 'binary_specificity': 0.99135065, 'binary_f1_score': 0.9873909}
confusion matrix:
      0     1
0  1490    13
1    26  1527
---- Validation: 
scalar performance:
{'acc': 0.80637634, 'precision': 0.81743014, 'recall': 0.80367565, 'specificity': 0.80367565, 'f1': 0.8035963, 'auroc': 0.8863903, 'binary_precision': 0.87007874, 'binary_recall': 0.7072, 'binary_specificity': 0.9001513, 'binary_f1_score': 0.78022945}
confusion matrix:
     0    1
0  595   66
1  183  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8203463, 'precision': 0.82170284, 'recall': 0.82034636, 'specificity': 0.82034636, 'f1': 0.8201567, 'auroc': 0.8858155, 'binary_precision': 0.8425926, 'binary_recall': 0.7878788, 'binary_specificity': 0.85281384, 'binary_f1_score': 0.81431764}
confusion matrix:
     0    1
0  197   34
1   49  182
early stop counter: 4
val acc:0.8063763380050659, best validation acc: 0.8382581472396851, corresponding to test acc:                         0.7445887327194214 / 0.8246753215789795
after epoch: 11,now: 2024-07-26 03:01:42.153580,epoch time: 0:02:42.023583,used: 0:29:49.931768,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.98720604, 'recall': 0.9872747, 'specificity': 0.9872747, 'f1': 0.9872352, 'auroc': 0.999027, 'binary_precision': 0.9896641, 'binary_recall': 0.985209, 'binary_specificity': 0.9893404, 'binary_f1_score': 0.9874315}
confusion matrix:
      0     1
0  1485    16
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.85458785, 'precision': 0.8559432, 'recall': 0.8554977, 'specificity': 0.8554977, 'f1': 0.8545773, 'auroc': 0.9170542, 'binary_precision': 0.82589287, 'binary_recall': 0.888, 'binary_specificity': 0.8229955, 'binary_f1_score': 0.85582113}
confusion matrix:
     0    1
0  544  117
1   70  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.84199774, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.84199065, 'auroc': 0.9023069, 'binary_precision': 0.8405172, 'binary_recall': 0.84415585, 'binary_specificity': 0.8398268, 'binary_f1_score': 0.84233266}
confusion matrix:
     0    1
0  194   37
1   36  195
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-26 03:04:26.598889,epoch time: 0:02:44.445309,used: 0:32:34.377077,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99245894, 'recall': 0.9924874, 'specificity': 0.9924874, 'f1': 0.9924722, 'auroc': 0.9997293, 'binary_precision': 0.9935442, 'binary_recall': 0.9916237, 'binary_specificity': 0.99335104, 'binary_f1_score': 0.992583}
confusion matrix:
      0     1
0  1494    10
1    13  1539
---- Validation: 
scalar performance:
{'acc': 0.83592534, 'precision': 0.8496702, 'recall': 0.8331171, 'specificity': 0.8331171, 'f1': 0.83337826, 'auroc': 0.9089398, 'binary_precision': 0.9123506, 'binary_recall': 0.7328, 'binary_specificity': 0.9334342, 'binary_f1_score': 0.8127773}
confusion matrix:
     0    1
0  617   44
1  167  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8095238, 'precision': 0.8388904, 'recall': 0.8095238, 'specificity': 0.8095238, 'f1': 0.8053061, 'auroc': 0.90408725, 'binary_precision': 0.9386503, 'binary_recall': 0.66233766, 'binary_specificity': 0.95671, 'binary_f1_score': 0.7766498}
confusion matrix:
     0    1
0  221   10
1   78  153
early stop counter: 1
val acc:0.8359253406524658, best validation acc: 0.8545878529548645, corresponding to test acc:                         0.8419913649559021 / 0.8419913649559021
after epoch: 13,now: 2024-07-26 03:07:09.700564,epoch time: 0:02:43.101675,used: 0:35:17.478752,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9810209, 'precision': 0.98138565, 'recall': 0.9808445, 'specificity': 0.9808445, 'f1': 0.9810072, 'auroc': 0.9991213, 'binary_precision': 0.9716088, 'binary_recall': 0.9916291, 'binary_specificity': 0.9700599, 'binary_f1_score': 0.98151684}
confusion matrix:
      0     1
0  1458    45
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.84059095, 'precision': 0.8559973, 'recall': 0.83765566, 'specificity': 0.83765566, 'f1': 0.8379229, 'auroc': 0.9248581, 'binary_precision': 0.9233871, 'binary_recall': 0.7328, 'binary_specificity': 0.9425113, 'binary_f1_score': 0.81712765}
confusion matrix:
     0    1
0  623   38
1  167  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.8658581, 'recall': 0.84199136, 'specificity': 0.84199136, 'f1': 0.8393717, 'auroc': 0.9237833, 'binary_precision': 0.9593023, 'binary_recall': 0.71428573, 'binary_specificity': 0.969697, 'binary_f1_score': 0.81885856}
confusion matrix:
     0    1
0  224    7
1   66  165
early stop counter: 2
val acc:0.8405909538269043, best validation acc: 0.8545878529548645, corresponding to test acc:                         0.8419913649559021 / 0.8419913649559021
after epoch: 14,now: 2024-07-26 03:09:52.080301,epoch time: 0:02:42.379737,used: 0:37:59.858489,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99443716, 'precision': 0.9944047, 'recall': 0.9944773, 'specificity': 0.9944773, 'f1': 0.9944358, 'auroc': 0.99970734, 'binary_precision': 0.9967721, 'binary_recall': 0.99228793, 'binary_specificity': 0.99666667, 'binary_f1_score': 0.994525}
confusion matrix:
      0     1
0  1495     5
1    12  1544
---- Validation: 
scalar performance:
{'acc': 0.85303265, 'precision': 0.8585079, 'recall': 0.85128355, 'specificity': 0.85128355, 'f1': 0.85192955, 'auroc': 0.9124824, 'binary_precision': 0.8963636, 'binary_recall': 0.7888, 'binary_specificity': 0.91376704, 'binary_f1_score': 0.83914894}
confusion matrix:
     0    1
0  604   57
1  132  493
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83766234, 'precision': 0.8410433, 'recall': 0.83766234, 'specificity': 0.83766234, 'f1': 0.837259, 'auroc': 0.8854407, 'binary_precision': 0.875, 'binary_recall': 0.7878788, 'binary_specificity': 0.88744587, 'binary_f1_score': 0.8291572}
confusion matrix:
     0    1
0  205   26
1   49  182
early stop counter: 3
val acc:0.853032648563385, best validation acc: 0.8545878529548645, corresponding to test acc:                         0.8419913649559021 / 0.8419913649559021
after epoch: 15,now: 2024-07-26 03:12:35.101003,epoch time: 0:02:43.020702,used: 0:40:42.879191,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9888743, 'precision': 0.98901, 'recall': 0.98878205, 'specificity': 0.98878205, 'f1': 0.98886883, 'auroc': 0.9994992, 'binary_precision': 0.98407644, 'binary_recall': 0.9942085, 'binary_specificity': 0.9833555, 'binary_f1_score': 0.9891165}
confusion matrix:
      0     1
0  1477    25
1     9  1545
---- Validation: 
scalar performance:
{'acc': 0.83437014, 'precision': 0.8382691, 'recall': 0.8358741, 'specificity': 0.8358741, 'f1': 0.83421767, 'auroc': 0.91224205, 'binary_precision': 0.7942857, 'binary_recall': 0.8896, 'binary_specificity': 0.78214824, 'binary_f1_score': 0.83924526}
confusion matrix:
     0    1
0  517  144
1   69  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8268398, 'precision': 0.8298315, 'recall': 0.8268398, 'specificity': 0.8268398, 'f1': 0.8264463, 'auroc': 0.8937988, 'binary_precision': 0.861244, 'binary_recall': 0.77922076, 'binary_specificity': 0.87445885, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  202   29
1   51  180
early stop counter: 4
val acc:0.8343701362609863, best validation acc: 0.8545878529548645, corresponding to test acc:                         0.8419913649559021 / 0.8419913649559021
after epoch: 16,now: 2024-07-26 03:15:18.585097,epoch time: 0:02:43.484094,used: 0:43:26.363285,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9878927, 'precision': 0.9879838, 'recall': 0.9878289, 'specificity': 0.9878289, 'f1': 0.98788846, 'auroc': 0.99914575, 'binary_precision': 0.9840051, 'binary_recall': 0.9922581, 'binary_specificity': 0.98339975, 'binary_f1_score': 0.98811436}
confusion matrix:
      0     1
0  1481    25
1    12  1538
---- Validation: 
scalar performance:
{'acc': 0.85458785, 'precision': 0.85657394, 'recall': 0.855672, 'specificity': 0.855672, 'f1': 0.8545561, 'auroc': 0.93277824, 'binary_precision': 0.8220588, 'binary_recall': 0.8944, 'binary_specificity': 0.816944, 'binary_f1_score': 0.856705}
confusion matrix:
     0    1
0  540  121
1   66  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.85691136, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.85478175, 'auroc': 0.929574, 'binary_precision': 0.83064514, 'binary_recall': 0.8917749, 'binary_specificity': 0.8181818, 'binary_f1_score': 0.86012524}
confusion matrix:
     0    1
0  189   42
1   25  206
new oracle model saved
early stop counter: 5
val acc:0.8545878529548645, best validation acc: 0.8545878529548645, corresponding to test acc:                         0.8419913649559021 / 0.8549783825874329
after epoch: 17,now: 2024-07-26 03:18:01.846184,epoch time: 0:02:43.261087,used: 0:46:09.624372,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_02_31_52_seed_5_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 0:46:09.624372 at 2024-07-26 03:18:01.846184
persisted model performance metric: 

scalar performance:
{'acc': 0.84199136, 'precision': 0.84199774, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.84199065, 'auroc': 0.9023069, 'binary_precision': 0.8405172, 'binary_recall': 0.84415585, 'binary_specificity': 0.8398268, 'binary_f1_score': 0.84233266}
confusion matrix:
     0    1
0  194   37
1   36  195
oracle model performance metric: 

scalar performance:
{'acc': 0.8549784, 'precision': 0.85691136, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.85478175, 'auroc': 0.929574, 'binary_precision': 0.83064514, 'binary_recall': 0.8917749, 'binary_specificity': 0.8181818, 'binary_f1_score': 0.86012524}
confusion matrix:
     0    1
0  189   42
1   25  206
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2393 MiB |   8915 MiB | 440144 GiB | 440142 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 436293 GiB | 436291 GiB |
|       from small pool |     91 MiB |    132 MiB |   3850 GiB |   3850 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2393 MiB |   8915 MiB | 440144 GiB | 440142 GiB |
|       from large pool |   2301 MiB |   8839 MiB | 436293 GiB | 436291 GiB |
|       from small pool |     91 MiB |    132 MiB |   3850 GiB |   3850 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 439543 GiB | 439540 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 435698 GiB | 435695 GiB |
|       from small pool |     91 MiB |    132 MiB |   3845 GiB |   3845 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  41382 MiB |  31638 MiB |
|       from large pool |   9608 MiB |   9688 MiB |  41072 MiB |  31464 MiB |
|       from small pool |    136 MiB |    140 MiB |    310 MiB |    174 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    984 MiB |   1656 MiB | 313746 GiB | 313745 GiB |
|       from large pool |    974 MiB |   1651 MiB | 309785 GiB | 309785 GiB |
|       from small pool |     10 MiB |     60 MiB |   3960 GiB |   3960 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   62593 K  |   62590 K  |
|       from large pool |     392    |     816    |   31433 K  |   31433 K  |
|       from small pool |    2084    |    2780    |   31159 K  |   31157 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   62593 K  |   62590 K  |
|       from large pool |     392    |     816    |   31433 K  |   31433 K  |
|       from small pool |    2084    |    2780    |   31159 K  |   31157 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     288    |     333    |    1105    |     817    |
|       from large pool |     220    |     265    |     950    |     730    |
|       from small pool |      68    |      70    |     155    |      87    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     140    |     319    |   33966 K  |   33966 K  |
|       from large pool |      72    |     255    |   17914 K  |   17914 K  |
|       from small pool |      68    |     227    |   16052 K  |   16052 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 440144 GiB | 440144 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 436293 GiB | 436293 GiB |
|       from small pool |      0 KiB |    132 MiB |   3850 GiB |   3850 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 440144 GiB | 440144 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 436293 GiB | 436293 GiB |
|       from small pool |      0 KiB |    132 MiB |   3850 GiB |   3850 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 439543 GiB | 439543 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 435698 GiB | 435698 GiB |
|       from small pool |      0 KiB |    132 MiB |   3845 GiB |   3845 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3378 MiB |   9824 MiB |  41382 MiB |  38004 MiB |
|       from large pool |   3276 MiB |   9688 MiB |  41072 MiB |  37796 MiB |
|       from small pool |    102 MiB |    140 MiB |    310 MiB |    208 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 313747 GiB | 313747 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 309786 GiB | 309786 GiB |
|       from small pool |      0 KiB |     60 MiB |   3960 GiB |   3960 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   62593 K  |   62593 K  |
|       from large pool |       2    |     816    |   31433 K  |   31433 K  |
|       from small pool |       0    |    2780    |   31159 K  |   31159 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   62593 K  |   62593 K  |
|       from large pool |       2    |     816    |   31433 K  |   31433 K  |
|       from small pool |       0    |    2780    |   31159 K  |   31159 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1105    |     974    |
|       from large pool |      80    |     265    |     950    |     870    |
|       from small pool |      51    |      70    |     155    |     104    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   33966 K  |   33966 K  |
|       from large pool |       3    |     255    |   17914 K  |   17914 K  |
|       from small pool |       0    |     227    |   16052 K  |   16052 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 440144 GiB | 440144 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 436293 GiB | 436293 GiB |
|       from small pool |      0 KiB |    132 MiB |   3850 GiB |   3850 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 440144 GiB | 440144 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 436293 GiB | 436293 GiB |
|       from small pool |      0 KiB |    132 MiB |   3850 GiB |   3850 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 439543 GiB | 439543 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 435698 GiB | 435698 GiB |
|       from small pool |      0 KiB |    132 MiB |   3845 GiB |   3845 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3378 MiB |   9824 MiB |  41382 MiB |  38004 MiB |
|       from large pool |   3276 MiB |   9688 MiB |  41072 MiB |  37796 MiB |
|       from small pool |    102 MiB |    140 MiB |    310 MiB |    208 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 313747 GiB | 313747 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 309786 GiB | 309786 GiB |
|       from small pool |      0 KiB |     60 MiB |   3960 GiB |   3960 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   62593 K  |   62593 K  |
|       from large pool |       2    |     816    |   31433 K  |   31433 K  |
|       from small pool |       0    |    2780    |   31159 K  |   31159 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   62593 K  |   62593 K  |
|       from large pool |       2    |     816    |   31433 K  |   31433 K  |
|       from small pool |       0    |    2780    |   31159 K  |   31159 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1105    |     974    |
|       from large pool |      80    |     265    |     950    |     870    |
|       from small pool |      51    |      70    |     155    |     104    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   33966 K  |   33966 K  |
|       from large pool |       3    |     255    |   17914 K  |   17914 K  |
|       from small pool |       0    |     227    |   16052 K  |   16052 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702

 Experiment start at: 2024-07-26 03:18:35.076605
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9352214, 'precision': 0.94083196, 'recall': 0.9346842, 'specificity': 0.9346842, 'f1': 0.9349538, 'auroc': 0.9946712, 'binary_precision': 0.8934808, 'binary_recall': 0.98968405, 'binary_specificity': 0.8796844, 'binary_f1_score': 0.93912506}
confusion matrix:
      0     1
0  1338   183
1    16  1535
---- Validation: 
scalar performance:
{'acc': 0.7392996, 'precision': 0.79170656, 'recall': 0.74077487, 'specificity': 0.74077487, 'f1': 0.72781086, 'auroc': 0.9097619, 'binary_precision': 0.6663008, 'binary_recall': 0.95141065, 'binary_specificity': 0.5301391, 'binary_f1_score': 0.78373146}
confusion matrix:
     0    1
0  343  304
1   31  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6824324, 'precision': 0.78457034, 'recall': 0.6824324, 'specificity': 0.6824324, 'f1': 0.6511282, 'auroc': 0.90751565, 'binary_precision': 0.6140845, 'binary_recall': 0.981982, 'binary_specificity': 0.3828829, 'binary_f1_score': 0.7556326}
confusion matrix:
    0    1
0  85  137
1   4  218
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:21:20.558260,epoch time: 0:02:45.481655,used: 0:02:45.481655,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9690755, 'precision': 0.9691883, 'recall': 0.96900237, 'specificity': 0.96900237, 'f1': 0.9690656, 'auroc': 0.9956006, 'binary_precision': 0.96437657, 'binary_recall': 0.9749196, 'binary_specificity': 0.96308506, 'binary_f1_score': 0.96961945}
confusion matrix:
      0     1
0  1461    56
1    39  1516
---- Validation: 
scalar performance:
{'acc': 0.8404669, 'precision': 0.8415179, 'recall': 0.8406608, 'specificity': 0.8406608, 'f1': 0.84039116, 'auroc': 0.90683305, 'binary_precision': 0.82074076, 'binary_recall': 0.8683386, 'binary_specificity': 0.812983, 'binary_f1_score': 0.8438691}
confusion matrix:
     0    1
0  526  121
1   84  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8040541, 'precision': 0.81373656, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.8025304, 'auroc': 0.90443146, 'binary_precision': 0.7586207, 'binary_recall': 0.8918919, 'binary_specificity': 0.7162162, 'binary_f1_score': 0.8198757}
confusion matrix:
     0    1
0  159   63
1   24  198
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 03:24:07.500789,epoch time: 0:02:46.942529,used: 0:05:32.424184,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96484375, 'precision': 0.96657884, 'recall': 0.965207, 'specificity': 0.965207, 'f1': 0.96482646, 'auroc': 0.99590373, 'binary_precision': 0.99793243, 'binary_recall': 0.9323889, 'binary_specificity': 0.998025, 'binary_f1_score': 0.9640479}
confusion matrix:
      0     1
0  1516     3
1   105  1448
---- Validation: 
scalar performance:
{'acc': 0.71128404, 'precision': 0.77838194, 'recall': 0.7095529, 'specificity': 0.7095529, 'f1': 0.69168293, 'auroc': 0.86886185, 'binary_precision': 0.9133127, 'binary_recall': 0.46238244, 'binary_specificity': 0.95672333, 'binary_f1_score': 0.6139438}
confusion matrix:
     0    1
0  619   28
1  343  295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7545045, 'precision': 0.8209324, 'recall': 0.7545045, 'specificity': 0.7545045, 'f1': 0.7411078, 'auroc': 0.904817, 'binary_precision': 0.96694213, 'binary_recall': 0.527027, 'binary_specificity': 0.981982, 'binary_f1_score': 0.6822157}
confusion matrix:
     0    1
0  218    4
1  105  117
early stop counter: 1
val acc:0.7112840414047241, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.8040540814399719 / 0.8040540814399719
after epoch: 3,now: 2024-07-26 03:26:50.238858,epoch time: 0:02:42.738069,used: 0:08:15.162253,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97721356, 'precision': 0.9772111, 'recall': 0.9772111, 'specificity': 0.9772111, 'f1': 0.9772111, 'auroc': 0.9978678, 'binary_precision': 0.97744846, 'binary_recall': 0.97744846, 'binary_specificity': 0.9769737, 'binary_f1_score': 0.97744846}
confusion matrix:
      0     1
0  1485    35
1    35  1517
---- Validation: 
scalar performance:
{'acc': 0.5867704, 'precision': 0.73567307, 'recall': 0.5839648, 'specificity': 0.5839648, 'f1': 0.5058498, 'auroc': 0.874444, 'binary_precision': 0.9212598, 'binary_recall': 0.18338558, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.30588236}
confusion matrix:
     0    1
0  637   10
1  521  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5540541, 'precision': 0.72870874, 'recall': 0.5540541, 'specificity': 0.5540541, 'f1': 0.4488276, 'auroc': 0.9081446, 'binary_precision': 0.9285714, 'binary_recall': 0.117117114, 'binary_specificity': 0.990991, 'binary_f1_score': 0.20799999}
confusion matrix:
     0   1
0  220   2
1  196  26
early stop counter: 2
val acc:0.5867704153060913, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.8040540814399719 / 0.8040540814399719
after epoch: 4,now: 2024-07-26 03:29:33.802516,epoch time: 0:02:43.563658,used: 0:10:58.725911,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9803746, 'recall': 0.9802958, 'specificity': 0.9802958, 'f1': 0.9801431, 'auroc': 0.9980788, 'binary_precision': 0.9940397, 'binary_recall': 0.96651644, 'binary_specificity': 0.99407506, 'binary_f1_score': 0.9800849}
confusion matrix:
      0     1
0  1510     9
1    52  1501
---- Validation: 
scalar performance:
{'acc': 0.8241245, 'precision': 0.83606464, 'recall': 0.8234618, 'specificity': 0.8234618, 'f1': 0.822334, 'auroc': 0.907354, 'binary_precision': 0.8976834, 'binary_recall': 0.7288401, 'binary_specificity': 0.9180835, 'binary_f1_score': 0.80449826}
confusion matrix:
     0    1
0  594   53
1  173  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8175676, 'precision': 0.85152614, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.81305265, 'auroc': 0.9170928, 'binary_precision': 0.9607843, 'binary_recall': 0.6621622, 'binary_specificity': 0.972973, 'binary_f1_score': 0.78400004}
confusion matrix:
     0    1
0  216    6
1   75  147
new oracle model saved
early stop counter: 3
val acc:0.8241245150566101, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.8040540814399719 / 0.8175675868988037
after epoch: 5,now: 2024-07-26 03:32:18.096085,epoch time: 0:02:44.293569,used: 0:13:43.019480,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98339844, 'precision': 0.98370373, 'recall': 0.9835932, 'specificity': 0.9835932, 'f1': 0.9833982, 'auroc': 0.9991598, 'binary_precision': 0.999336, 'binary_recall': 0.9678457, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9833388}
confusion matrix:
      0     1
0  1516     1
1    50  1505
---- Validation: 
scalar performance:
{'acc': 0.6490272, 'precision': 0.76718783, 'recall': 0.64668256, 'specificity': 0.64668256, 'f1': 0.60336494, 'auroc': 0.8995799, 'binary_precision': 0.943128, 'binary_recall': 0.31191224, 'binary_specificity': 0.9814529, 'binary_f1_score': 0.46878684}
confusion matrix:
     0    1
0  635   12
1  439  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6058559, 'precision': 0.7365021, 'recall': 0.6058559, 'specificity': 0.6058559, 'f1': 0.5427018, 'auroc': 0.89136434, 'binary_precision': 0.9122807, 'binary_recall': 0.23423423, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.37275985}
confusion matrix:
     0   1
0  217   5
1  170  52
early stop counter: 4
val acc:0.6490272283554077, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.8040540814399719 / 0.8175675868988037
after epoch: 6,now: 2024-07-26 03:35:01.363341,epoch time: 0:02:43.267256,used: 0:16:26.286736,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9664714, 'precision': 0.9678048, 'recall': 0.96621335, 'specificity': 0.96621335, 'f1': 0.96643066, 'auroc': 0.9983023, 'binary_precision': 0.9452981, 'binary_recall': 0.9909794, 'binary_specificity': 0.9414474, 'binary_f1_score': 0.9675999}
confusion matrix:
      0     1
0  1431    89
1    14  1538
---- Validation: 
scalar performance:
{'acc': 0.7680934, 'precision': 0.77803254, 'recall': 0.768747, 'specificity': 0.768747, 'f1': 0.766286, 'auroc': 0.84953946, 'binary_precision': 0.7236842, 'binary_recall': 0.86206895, 'binary_specificity': 0.67542505, 'binary_f1_score': 0.7868383}
confusion matrix:
     0    1
0  437  210
1   88  550
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7635135, 'precision': 0.7916919, 'recall': 0.7635135, 'specificity': 0.7635135, 'f1': 0.75766075, 'auroc': 0.8709115, 'binary_precision': 0.7010309, 'binary_recall': 0.9189189, 'binary_specificity': 0.6081081, 'binary_f1_score': 0.7953216}
confusion matrix:
     0    1
0  135   87
1   18  204
early stop counter: 5
val acc:0.7680934071540833, best validation acc: 0.8404669165611267, corresponding to test acc:                         0.8040540814399719 / 0.8175675868988037
after epoch: 7,now: 2024-07-26 03:37:45.057908,epoch time: 0:02:43.694567,used: 0:19:09.981303,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_18_35_seed_6_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:19:09.981303 at 2024-07-26 03:37:45.057908
persisted model performance metric: 

scalar performance:
{'acc': 0.8040541, 'precision': 0.81373656, 'recall': 0.804054, 'specificity': 0.804054, 'f1': 0.8025304, 'auroc': 0.90443146, 'binary_precision': 0.7586207, 'binary_recall': 0.8918919, 'binary_specificity': 0.7162162, 'binary_f1_score': 0.8198757}
confusion matrix:
     0    1
0  159   63
1   24  198
oracle model performance metric: 

scalar performance:
{'acc': 0.8175676, 'precision': 0.85152614, 'recall': 0.8175676, 'specificity': 0.8175676, 'f1': 0.81305265, 'auroc': 0.9170928, 'binary_precision': 0.9607843, 'binary_recall': 0.6621622, 'binary_specificity': 0.972973, 'binary_f1_score': 0.78400004}
confusion matrix:
     0    1
0  216    6
1   75  147
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8915 MiB | 486917 GiB | 486915 GiB |
|       from large pool |   2303 MiB |   8839 MiB | 482657 GiB | 482654 GiB |
|       from small pool |     91 MiB |    132 MiB |   4260 GiB |   4260 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8915 MiB | 486917 GiB | 486915 GiB |
|       from large pool |   2303 MiB |   8839 MiB | 482657 GiB | 482654 GiB |
|       from small pool |     91 MiB |    132 MiB |   4260 GiB |   4260 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 486273 GiB | 486271 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 482019 GiB | 482017 GiB |
|       from small pool |     91 MiB |    132 MiB |   4254 GiB |   4254 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9742 MiB |   9824 MiB |  47746 MiB |  38004 MiB |
|       from large pool |   9606 MiB |   9688 MiB |  47402 MiB |  37796 MiB |
|       from small pool |    136 MiB |    140 MiB |    344 MiB |    208 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    943 MiB |   1656 MiB | 348910 GiB | 348909 GiB |
|       from large pool |    934 MiB |   1651 MiB | 344528 GiB | 344527 GiB |
|       from small pool |      8 MiB |     60 MiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   69256 K  |   69253 K  |
|       from large pool |     392    |     816    |   34777 K  |   34777 K  |
|       from small pool |    2078    |    2780    |   34478 K  |   34476 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   69256 K  |   69253 K  |
|       from large pool |     392    |     816    |   34777 K  |   34777 K  |
|       from small pool |    2078    |    2780    |   34478 K  |   34476 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     287    |     333    |    1261    |     974    |
|       from large pool |     219    |     265    |    1089    |     870    |
|       from small pool |      68    |      70    |     172    |     104    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     137    |     319    |   37532 K  |   37532 K  |
|       from large pool |      68    |     255    |   19785 K  |   19785 K  |
|       from small pool |      69    |     227    |   17747 K  |   17747 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 486917 GiB | 486917 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 482657 GiB | 482657 GiB |
|       from small pool |      0 KiB |    132 MiB |   4260 GiB |   4260 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 486917 GiB | 486917 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 482657 GiB | 482657 GiB |
|       from small pool |      0 KiB |    132 MiB |   4260 GiB |   4260 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 486273 GiB | 486273 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 482019 GiB | 482019 GiB |
|       from small pool |      0 KiB |    132 MiB |   4254 GiB |   4254 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3338 MiB |   9824 MiB |  47746 MiB |  44408 MiB |
|       from large pool |   3238 MiB |   9688 MiB |  47402 MiB |  44164 MiB |
|       from small pool |    100 MiB |    140 MiB |    344 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 348911 GiB | 348911 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 344529 GiB | 344529 GiB |
|       from small pool |      0 KiB |     60 MiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   69256 K  |   69256 K  |
|       from large pool |       2    |     816    |   34777 K  |   34777 K  |
|       from small pool |       0    |    2780    |   34478 K  |   34478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   69256 K  |   69256 K  |
|       from large pool |       2    |     816    |   34777 K  |   34777 K  |
|       from small pool |       0    |    2780    |   34478 K  |   34478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     333    |    1261    |    1133    |
|       from large pool |      78    |     265    |    1089    |    1011    |
|       from small pool |      50    |      70    |     172    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   37533 K  |   37533 K  |
|       from large pool |       3    |     255    |   19785 K  |   19785 K  |
|       from small pool |       0    |     227    |   17747 K  |   17747 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 486917 GiB | 486917 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 482657 GiB | 482657 GiB |
|       from small pool |      0 KiB |    132 MiB |   4260 GiB |   4260 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 486917 GiB | 486917 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 482657 GiB | 482657 GiB |
|       from small pool |      0 KiB |    132 MiB |   4260 GiB |   4260 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 486273 GiB | 486273 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 482019 GiB | 482019 GiB |
|       from small pool |      0 KiB |    132 MiB |   4254 GiB |   4254 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3338 MiB |   9824 MiB |  47746 MiB |  44408 MiB |
|       from large pool |   3238 MiB |   9688 MiB |  47402 MiB |  44164 MiB |
|       from small pool |    100 MiB |    140 MiB |    344 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 348911 GiB | 348911 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 344529 GiB | 344529 GiB |
|       from small pool |      0 KiB |     60 MiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   69256 K  |   69256 K  |
|       from large pool |       2    |     816    |   34777 K  |   34777 K  |
|       from small pool |       0    |    2780    |   34478 K  |   34478 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   69256 K  |   69256 K  |
|       from large pool |       2    |     816    |   34777 K  |   34777 K  |
|       from small pool |       0    |    2780    |   34478 K  |   34478 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     128    |     333    |    1261    |    1133    |
|       from large pool |      78    |     265    |    1089    |    1011    |
|       from small pool |      50    |      70    |     172    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   37533 K  |   37533 K  |
|       from large pool |       3    |     255    |   19785 K  |   19785 K  |
|       from small pool |       0    |     227    |   17747 K  |   17747 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702

 Experiment start at: 2024-07-26 03:38:18.843462
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9547526, 'precision': 0.9561542, 'recall': 0.955235, 'specificity': 0.955235, 'f1': 0.9547411, 'auroc': 0.98955286, 'binary_precision': 0.98564595, 'binary_recall': 0.92435896, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.95401925}
confusion matrix:
      0     1
0  1491    21
1   118  1442
---- Validation: 
scalar performance:
{'acc': 0.80615383, 'precision': 0.8120911, 'recall': 0.807197, 'specificity': 0.807197, 'f1': 0.8055574, 'auroc': 0.88861036, 'binary_precision': 0.76502734, 'binary_recall': 0.875, 'binary_specificity': 0.73939395, 'binary_f1_score': 0.81632656}
confusion matrix:
     0    1
0  488  172
1   80  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8253275, 'precision': 0.82692343, 'recall': 0.8253275, 'specificity': 0.8253275, 'f1': 0.82511413, 'auroc': 0.90610397, 'binary_precision': 0.8040816, 'binary_recall': 0.86026204, 'binary_specificity': 0.790393, 'binary_f1_score': 0.83122367}
confusion matrix:
     0    1
0  181   48
1   32  197
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 03:41:03.853650,epoch time: 0:02:45.010188,used: 0:02:45.010188,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9635417, 'precision': 0.9641496, 'recall': 0.96329874, 'specificity': 0.96329874, 'f1': 0.96350753, 'auroc': 0.99582696, 'binary_precision': 0.9508095, 'binary_recall': 0.97884613, 'binary_specificity': 0.94775134, 'binary_f1_score': 0.96462417}
confusion matrix:
      0     1
0  1433    79
1    33  1527
---- Validation: 
scalar performance:
{'acc': 0.7438462, 'precision': 0.77665937, 'recall': 0.7464489, 'specificity': 0.7464489, 'f1': 0.7373139, 'auroc': 0.8816904, 'binary_precision': 0.6774567, 'binary_recall': 0.915625, 'binary_specificity': 0.5772727, 'binary_f1_score': 0.7787375}
confusion matrix:
     0    1
0  381  279
1   54  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72925764, 'precision': 0.77113736, 'recall': 0.72925764, 'specificity': 0.72925764, 'f1': 0.7183831, 'auroc': 0.8988768, 'binary_precision': 0.6645768, 'binary_recall': 0.9257642, 'binary_specificity': 0.5327511, 'binary_f1_score': 0.7737226}
confusion matrix:
     0    1
0  122  107
1   17  212
early stop counter: 1
val acc:0.7438461780548096, best validation acc: 0.8061538338661194, corresponding to test acc:                         0.8253275156021118 / 0.8253275156021118
after epoch: 2,now: 2024-07-26 03:43:46.880471,epoch time: 0:02:43.026821,used: 0:05:28.037009,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.95339835, 'recall': 0.95031035, 'specificity': 0.95031035, 'f1': 0.94948524, 'auroc': 0.9945876, 'binary_precision': 0.9992893, 'binary_recall': 0.9012821, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9477587}
confusion matrix:
      0     1
0  1511     1
1   154  1406
---- Validation: 
scalar performance:
{'acc': 0.6392308, 'precision': 0.76687884, 'recall': 0.6338305, 'specificity': 0.6338305, 'f1': 0.5852491, 'auroc': 0.81925666, 'binary_precision': 0.947644, 'binary_recall': 0.2828125, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.43561977}
confusion matrix:
     0    1
0  650   10
1  459  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5895197, 'precision': 0.7430243, 'recall': 0.5895196, 'specificity': 0.5895196, 'f1': 0.5125453, 'auroc': 0.8671078, 'binary_precision': 0.9361702, 'binary_recall': 0.19213974, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.3188406}
confusion matrix:
     0   1
0  226   3
1  185  44
early stop counter: 2
val acc:0.6392307877540588, best validation acc: 0.8061538338661194, corresponding to test acc:                         0.8253275156021118 / 0.8253275156021118
after epoch: 3,now: 2024-07-26 03:46:29.354396,epoch time: 0:02:42.473925,used: 0:08:10.510934,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90983075, 'precision': 0.923144, 'recall': 0.90847075, 'specificity': 0.90847075, 'f1': 0.90889704, 'auroc': 0.9965472, 'binary_precision': 0.8518925, 'binary_recall': 0.99551284, 'binary_specificity': 0.8214286, 'binary_f1_score': 0.91812}
confusion matrix:
      0     1
0  1242   270
1     7  1553
---- Validation: 
scalar performance:
{'acc': 0.75461537, 'precision': 0.781152, 'recall': 0.75693655, 'specificity': 0.75693655, 'f1': 0.74976456, 'auroc': 0.8891146, 'binary_precision': 0.69084424, 'binary_recall': 0.9078125, 'binary_specificity': 0.6060606, 'binary_f1_score': 0.784605}
confusion matrix:
     0    1
0  400  260
1   59  581
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78165936, 'precision': 0.7995741, 'recall': 0.78165936, 'specificity': 0.78165936, 'f1': 0.7783456, 'auroc': 0.8910013, 'binary_precision': 0.7263158, 'binary_recall': 0.9039301, 'binary_specificity': 0.65938866, 'binary_f1_score': 0.80544746}
confusion matrix:
     0    1
0  151   78
1   22  207
early stop counter: 3
val acc:0.7546153664588928, best validation acc: 0.8061538338661194, corresponding to test acc:                         0.8253275156021118 / 0.8253275156021118
after epoch: 4,now: 2024-07-26 03:49:14.472201,epoch time: 0:02:45.117805,used: 0:10:55.628739,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97624683, 'recall': 0.9762159, 'specificity': 0.9762159, 'f1': 0.9762304, 'auroc': 0.99741936, 'binary_precision': 0.9756878, 'binary_recall': 0.9775641, 'binary_specificity': 0.9748677, 'binary_f1_score': 0.976625}
confusion matrix:
      0     1
0  1474    38
1    35  1525
---- Validation: 
scalar performance:
{'acc': 0.85384613, 'precision': 0.8559942, 'recall': 0.85324335, 'specificity': 0.85324335, 'f1': 0.8534452, 'auroc': 0.9041761, 'binary_precision': 0.8800676, 'binary_recall': 0.8140625, 'binary_specificity': 0.8924242, 'binary_f1_score': 0.84577924}
confusion matrix:
     0    1
0  589   71
1  119  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.88138497, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.86312544, 'auroc': 0.9276329, 'binary_precision': 0.96132594, 'binary_recall': 0.75982535, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.8487805}
confusion matrix:
     0    1
0  222    7
1   55  174
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 03:51:59.484237,epoch time: 0:02:45.012036,used: 0:13:40.640775,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9701876, 'recall': 0.9700295, 'specificity': 0.9700295, 'f1': 0.9697261, 'auroc': 0.99692464, 'binary_precision': 0.98932624, 'binary_recall': 0.95064104, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.96959794}
confusion matrix:
      0     1
0  1496    16
1    77  1483
---- Validation: 
scalar performance:
{'acc': 0.8161538, 'precision': 0.81952024, 'recall': 0.8153409, 'specificity': 0.8153409, 'f1': 0.8153645, 'auroc': 0.8749408, 'binary_precision': 0.84869564, 'binary_recall': 0.7625, 'binary_specificity': 0.8681818, 'binary_f1_score': 0.8032922}
confusion matrix:
     0    1
0  573   87
1  152  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.8598888, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.838448, 'auroc': 0.9106424, 'binary_precision': 0.9431818, 'binary_recall': 0.7248908, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.81975305}
confusion matrix:
     0    1
0  219   10
1   63  166
early stop counter: 1
val acc:0.8161538243293762, best validation acc: 0.8538461327552795, corresponding to test acc:                         0.864628791809082 / 0.864628791809082
after epoch: 6,now: 2024-07-26 03:54:42.908225,epoch time: 0:02:43.423988,used: 0:16:24.064763,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.9876, 'recall': 0.98769844, 'specificity': 0.98769844, 'f1': 0.9876287, 'auroc': 0.9990804, 'binary_precision': 0.99223804, 'binary_recall': 0.98333335, 'binary_specificity': 0.99206346, 'binary_f1_score': 0.9877656}
confusion matrix:
      0     1
0  1500    12
1    26  1534
---- Validation: 
scalar performance:
{'acc': 0.81846154, 'precision': 0.83804005, 'recall': 0.8165957, 'specificity': 0.8165957, 'f1': 0.81514996, 'auroc': 0.89246684, 'binary_precision': 0.91563785, 'binary_recall': 0.6953125, 'binary_specificity': 0.9378788, 'binary_f1_score': 0.7904085}
confusion matrix:
     0    1
0  619   41
1  195  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74454147, 'precision': 0.7880503, 'recall': 0.7445415, 'specificity': 0.7445415, 'f1': 0.73451644, 'auroc': 0.89069617, 'binary_precision': 0.9, 'binary_recall': 0.55021834, 'binary_specificity': 0.93886465, 'binary_f1_score': 0.68292683}
confusion matrix:
     0    1
0  215   14
1  103  126
early stop counter: 2
val acc:0.818461537361145, best validation acc: 0.8538461327552795, corresponding to test acc:                         0.864628791809082 / 0.864628791809082
after epoch: 7,now: 2024-07-26 03:57:25.736522,epoch time: 0:02:42.828297,used: 0:19:06.893060,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9803977, 'recall': 0.9803877, 'specificity': 0.9803877, 'f1': 0.98014325, 'auroc': 0.99870306, 'binary_precision': 0.99602914, 'binary_recall': 0.9647436, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.9801368}
confusion matrix:
      0     1
0  1506     6
1    55  1505
---- Validation: 
scalar performance:
{'acc': 0.78923076, 'precision': 0.81094587, 'recall': 0.78716856, 'specificity': 0.78716856, 'f1': 0.78463024, 'auroc': 0.86998045, 'binary_precision': 0.8893617, 'binary_recall': 0.653125, 'binary_specificity': 0.92121214, 'binary_f1_score': 0.7531531}
confusion matrix:
     0    1
0  608   52
1  222  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515284, 'precision': 0.8542303, 'recall': 0.8515284, 'specificity': 0.8515284, 'f1': 0.85124475, 'auroc': 0.9042543, 'binary_precision': 0.8851675, 'binary_recall': 0.80786026, 'binary_specificity': 0.8951965, 'binary_f1_score': 0.8447489}
confusion matrix:
     0    1
0  205   24
1   44  185
early stop counter: 3
val acc:0.7892307639122009, best validation acc: 0.8538461327552795, corresponding to test acc:                         0.864628791809082 / 0.864628791809082
after epoch: 8,now: 2024-07-26 04:00:09.379614,epoch time: 0:02:43.643092,used: 0:21:50.536152,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9815494, 'recall': 0.980932, 'specificity': 0.980932, 'f1': 0.9811057, 'auroc': 0.9987923, 'binary_precision': 0.9705514, 'binary_recall': 0.9929487, 'binary_specificity': 0.96891534, 'binary_f1_score': 0.98162234}
confusion matrix:
      0     1
0  1465    47
1    11  1549
---- Validation: 
scalar performance:
{'acc': 0.82, 'precision': 0.82254434, 'recall': 0.8192945, 'specificity': 0.8192945, 'f1': 0.81938267, 'auroc': 0.8689607, 'binary_precision': 0.8476027, 'binary_recall': 0.7734375, 'binary_specificity': 0.8651515, 'binary_f1_score': 0.80882347}
confusion matrix:
     0    1
0  571   89
1  145  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8362445, 'precision': 0.8363023, 'recall': 0.8362446, 'specificity': 0.8362446, 'f1': 0.83623755, 'auroc': 0.8814858, 'binary_precision': 0.83189654, 'binary_recall': 0.8427948, 'binary_specificity': 0.82969433, 'binary_f1_score': 0.8373102}
confusion matrix:
     0    1
0  190   39
1   36  193
early stop counter: 4
val acc:0.8199999928474426, best validation acc: 0.8538461327552795, corresponding to test acc:                         0.864628791809082 / 0.864628791809082
after epoch: 9,now: 2024-07-26 04:02:53.129828,epoch time: 0:02:43.750214,used: 0:24:34.286366,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98213506, 'recall': 0.9820564, 'specificity': 0.9820564, 'f1': 0.9820906, 'auroc': 0.9988693, 'binary_precision': 0.980217, 'binary_recall': 0.9846154, 'binary_specificity': 0.9794974, 'binary_f1_score': 0.98241127}
confusion matrix:
      0     1
0  1481    31
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.8476923, 'precision': 0.8588917, 'recall': 0.8463305, 'specificity': 0.8463305, 'f1': 0.8461057, 'auroc': 0.90183234, 'binary_precision': 0.9185606, 'binary_recall': 0.7578125, 'binary_specificity': 0.9348485, 'binary_f1_score': 0.83047944}
confusion matrix:
     0    1
0  617   43
1  155  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.8604692, 'recall': 0.8471616, 'specificity': 0.8471616, 'f1': 0.8457378, 'auroc': 0.905265, 'binary_precision': 0.9297297, 'binary_recall': 0.7510917, 'binary_specificity': 0.94323146, 'binary_f1_score': 0.8309179}
confusion matrix:
     0    1
0  216   13
1   57  172
early stop counter: 5
val acc:0.8476923108100891, best validation acc: 0.8538461327552795, corresponding to test acc:                         0.864628791809082 / 0.864628791809082
after epoch: 10,now: 2024-07-26 04:05:36.500422,epoch time: 0:02:43.370594,used: 0:27:17.656960,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_03_38_18_seed_7_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 0:27:17.656960 at 2024-07-26 04:05:36.500422
persisted model performance metric: 

scalar performance:
{'acc': 0.8646288, 'precision': 0.88138497, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.86312544, 'auroc': 0.9276329, 'binary_precision': 0.96132594, 'binary_recall': 0.75982535, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.8487805}
confusion matrix:
     0    1
0  222    7
1   55  174
oracle model performance metric: 

scalar performance:
{'acc': 0.8646288, 'precision': 0.88138497, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.86312544, 'auroc': 0.9276329, 'binary_precision': 0.96132594, 'binary_recall': 0.75982535, 'binary_specificity': 0.9694323, 'binary_f1_score': 0.8487805}
confusion matrix:
     0    1
0  222    7
1   55  174
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2396 MiB |   8915 MiB | 553752 GiB | 553750 GiB |
|       from large pool |   2304 MiB |   8839 MiB | 548907 GiB | 548904 GiB |
|       from small pool |     91 MiB |    132 MiB |   4845 GiB |   4845 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2396 MiB |   8915 MiB | 553752 GiB | 553750 GiB |
|       from large pool |   2304 MiB |   8839 MiB | 548907 GiB | 548904 GiB |
|       from small pool |     91 MiB |    132 MiB |   4845 GiB |   4845 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 553019 GiB | 553017 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 548180 GiB | 548178 GiB |
|       from small pool |     91 MiB |    132 MiB |   4838 GiB |   4838 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9744 MiB |   9824 MiB |  54152 MiB |  44408 MiB |
|       from large pool |   9608 MiB |   9688 MiB |  53772 MiB |  44164 MiB |
|       from small pool |    136 MiB |    140 MiB |    380 MiB |    244 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    949 MiB |   1656 MiB | 399773 GiB | 399772 GiB |
|       from large pool |    937 MiB |   1651 MiB | 394789 GiB | 394788 GiB |
|       from small pool |     12 MiB |     60 MiB |   4983 GiB |   4983 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |   78769 K  |   78767 K  |
|       from large pool |     392    |     816    |   39553 K  |   39553 K  |
|       from small pool |    2084    |    2780    |   39215 K  |   39213 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |   78769 K  |   78767 K  |
|       from large pool |     392    |     816    |   39553 K  |   39553 K  |
|       from small pool |    2084    |    2780    |   39215 K  |   39213 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     287    |     333    |    1420    |    1133    |
|       from large pool |     219    |     265    |    1230    |    1011    |
|       from small pool |      68    |      70    |     190    |     122    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     127    |     319    |   42540 K  |   42539 K  |
|       from large pool |      58    |     255    |   22355 K  |   22355 K  |
|       from small pool |      69    |     227    |   20184 K  |   20184 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 553752 GiB | 553752 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 548907 GiB | 548907 GiB |
|       from small pool |      0 KiB |    132 MiB |   4845 GiB |   4845 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 553752 GiB | 553752 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 548907 GiB | 548907 GiB |
|       from small pool |      0 KiB |    132 MiB |   4845 GiB |   4845 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 553019 GiB | 553019 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 548180 GiB | 548180 GiB |
|       from small pool |      0 KiB |    132 MiB |   4838 GiB |   4838 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3346 MiB |   9824 MiB |  54152 MiB |  50806 MiB |
|       from large pool |   3242 MiB |   9688 MiB |  53772 MiB |  50530 MiB |
|       from small pool |    104 MiB |    140 MiB |    380 MiB |    276 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 399774 GiB | 399774 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 394790 GiB | 394790 GiB |
|       from small pool |      0 KiB |     60 MiB |   4983 GiB |   4983 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   78769 K  |   78769 K  |
|       from large pool |       2    |     816    |   39553 K  |   39553 K  |
|       from small pool |       0    |    2780    |   39215 K  |   39215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   78769 K  |   78769 K  |
|       from large pool |       2    |     816    |   39553 K  |   39553 K  |
|       from small pool |       0    |    2780    |   39215 K  |   39215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     333    |    1420    |    1293    |
|       from large pool |      75    |     265    |    1230    |    1155    |
|       from small pool |      52    |      70    |     190    |     138    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   42540 K  |   42540 K  |
|       from large pool |       3    |     255    |   22355 K  |   22355 K  |
|       from small pool |       0    |     227    |   20184 K  |   20184 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8915 MiB | 553752 GiB | 553752 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 548907 GiB | 548907 GiB |
|       from small pool |      0 KiB |    132 MiB |   4845 GiB |   4845 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8915 MiB | 553752 GiB | 553752 GiB |
|       from large pool |  16640 KiB |   8839 MiB | 548907 GiB | 548907 GiB |
|       from small pool |      0 KiB |    132 MiB |   4845 GiB |   4845 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 553019 GiB | 553019 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 548180 GiB | 548180 GiB |
|       from small pool |      0 KiB |    132 MiB |   4838 GiB |   4838 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3346 MiB |   9824 MiB |  54152 MiB |  50806 MiB |
|       from large pool |   3242 MiB |   9688 MiB |  53772 MiB |  50530 MiB |
|       from small pool |    104 MiB |    140 MiB |    380 MiB |    276 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 399774 GiB | 399774 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 394790 GiB | 394790 GiB |
|       from small pool |      0 KiB |     60 MiB |   4983 GiB |   4983 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   78769 K  |   78769 K  |
|       from large pool |       2    |     816    |   39553 K  |   39553 K  |
|       from small pool |       0    |    2780    |   39215 K  |   39215 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   78769 K  |   78769 K  |
|       from large pool |       2    |     816    |   39553 K  |   39553 K  |
|       from small pool |       0    |    2780    |   39215 K  |   39215 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     333    |    1420    |    1293    |
|       from large pool |      75    |     265    |    1230    |    1155    |
|       from small pool |      52    |      70    |     190    |     138    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   42540 K  |   42540 K  |
|       from large pool |       3    |     255    |   22355 K  |   22355 K  |
|       from small pool |       0    |     227    |   20184 K  |   20184 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702

 Experiment start at: 2024-07-26 04:06:11.163768
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94638157, 'precision': 0.9465263, 'recall': 0.9462868, 'specificity': 0.9462868, 'f1': 0.9463613, 'auroc': 0.9895729, 'binary_precision': 0.9410256, 'binary_recall': 0.9538661, 'binary_specificity': 0.93870753, 'binary_f1_score': 0.94740236}
confusion matrix:
      0     1
0  1409    92
1    71  1468
---- Validation: 
scalar performance:
{'acc': 0.6434648, 'precision': 0.77888405, 'recall': 0.6542264, 'specificity': 0.6542264, 'f1': 0.6031749, 'auroc': 0.91992486, 'binary_precision': 0.5764597, 'binary_recall': 0.9936102, 'binary_specificity': 0.31484258, 'binary_f1_score': 0.7296188}
confusion matrix:
     0    1
0  210  457
1    4  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66972476, 'precision': 0.7590238, 'recall': 0.66972476, 'specificity': 0.66972476, 'f1': 0.63857424, 'auroc': 0.9181466, 'binary_precision': 0.6069364, 'binary_recall': 0.96330273, 'binary_specificity': 0.3761468, 'binary_f1_score': 0.7446809}
confusion matrix:
    0    1
0  82  136
1   8  210
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:08:55.275574,epoch time: 0:02:44.111806,used: 0:02:44.111806,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96907896, 'precision': 0.96907026, 'recall': 0.9690825, 'specificity': 0.9690825, 'f1': 0.9690759, 'auroc': 0.99623024, 'binary_precision': 0.970013, 'binary_recall': 0.96875, 'binary_specificity': 0.9694149, 'binary_f1_score': 0.9693811}
confusion matrix:
      0     1
0  1458    46
1    48  1488
---- Validation: 
scalar performance:
{'acc': 0.7880897, 'precision': 0.8132229, 'recall': 0.79249156, 'specificity': 0.79249156, 'f1': 0.78531486, 'auroc': 0.8924689, 'binary_precision': 0.7162162, 'binary_recall': 0.9313099, 'binary_specificity': 0.6536732, 'binary_f1_score': 0.80972224}
confusion matrix:
     0    1
0  436  231
1   43  583
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77522933, 'precision': 0.8011882, 'recall': 0.77522933, 'specificity': 0.77522933, 'f1': 0.77027965, 'auroc': 0.9120234, 'binary_precision': 0.71276593, 'binary_recall': 0.92201835, 'binary_specificity': 0.6284404, 'binary_f1_score': 0.804}
confusion matrix:
     0    1
0  137   81
1   17  201
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:11:40.928249,epoch time: 0:02:45.652675,used: 0:05:29.764481,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.97039473, 'precision': 0.97037923, 'recall': 0.97044766, 'specificity': 0.97044766, 'f1': 0.97039294, 'auroc': 0.99612904, 'binary_precision': 0.975082, 'binary_recall': 0.96621186, 'binary_specificity': 0.9746835, 'binary_f1_score': 0.97062665}
confusion matrix:
      0     1
0  1463    38
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.78499615, 'precision': 0.8182513, 'recall': 0.7900331, 'specificity': 0.7900331, 'f1': 0.78107697, 'auroc': 0.92081994, 'binary_precision': 0.70714283, 'binary_recall': 0.9488818, 'binary_specificity': 0.6311844, 'binary_f1_score': 0.8103683}
confusion matrix:
     0    1
0  421  246
1   32  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79816514, 'precision': 0.81335694, 'recall': 0.79816514, 'specificity': 0.79816514, 'f1': 0.79568887, 'auroc': 0.92035604, 'binary_precision': 0.7443609, 'binary_recall': 0.9082569, 'binary_specificity': 0.6880734, 'binary_f1_score': 0.8181818}
confusion matrix:
     0    1
0  150   68
1   20  198
new oracle model saved
early stop counter: 1
val acc:0.7849961519241333, best validation acc: 0.7880896925926208, corresponding to test acc:                         0.7752293348312378 / 0.7981651425361633
after epoch: 3,now: 2024-07-26 04:14:23.625099,epoch time: 0:02:42.696850,used: 0:08:12.461331,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9555921, 'precision': 0.9587151, 'recall': 0.9560478, 'specificity': 0.9560478, 'f1': 0.95554304, 'auroc': 0.9972149, 'binary_precision': 0.99928725, 'binary_recall': 0.91276044, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.95406604}
confusion matrix:
      0     1
0  1503     1
1   134  1402
---- Validation: 
scalar performance:
{'acc': 0.73085845, 'precision': 0.8066138, 'recall': 0.7227812, 'specificity': 0.7227812, 'f1': 0.7083776, 'auroc': 0.9319589, 'binary_precision': 0.9512987, 'binary_recall': 0.4680511, 'binary_specificity': 0.9775112, 'binary_f1_score': 0.627409}
confusion matrix:
     0    1
0  652   15
1  333  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75688076, 'precision': 0.83257055, 'recall': 0.75688076, 'specificity': 0.75688076, 'f1': 0.74221337, 'auroc': 0.910319, 'binary_precision': 0.99122804, 'binary_recall': 0.51834863, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.6807229}
confusion matrix:
     0    1
0  217    1
1  105  113
early stop counter: 2
val acc:0.7308584451675415, best validation acc: 0.7880896925926208, corresponding to test acc:                         0.7752293348312378 / 0.7981651425361633
after epoch: 4,now: 2024-07-26 04:17:05.212848,epoch time: 0:02:41.587749,used: 0:10:54.049080,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97861844, 'precision': 0.9788295, 'recall': 0.97852373, 'specificity': 0.97852373, 'f1': 0.97861034, 'auroc': 0.9983797, 'binary_precision': 0.9711908, 'binary_recall': 0.98698765, 'binary_specificity': 0.9700599, 'binary_f1_score': 0.9790255}
confusion matrix:
      0     1
0  1458    45
1    20  1517
---- Validation: 
scalar performance:
{'acc': 0.81979895, 'precision': 0.84819824, 'recall': 0.8243063, 'specificity': 0.8243063, 'f1': 0.8173407, 'auroc': 0.9513079, 'binary_precision': 0.7405141, 'binary_recall': 0.9664537, 'binary_specificity': 0.68215895, 'binary_f1_score': 0.8385308}
confusion matrix:
     0    1
0  455  212
1   21  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8211009, 'precision': 0.83347905, 'recall': 0.82110095, 'specificity': 0.82110095, 'f1': 0.81942534, 'auroc': 0.9384942, 'binary_precision': 0.7692308, 'binary_recall': 0.9174312, 'binary_specificity': 0.72477067, 'binary_f1_score': 0.8368201}
confusion matrix:
     0    1
0  158   60
1   18  200
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 04:19:48.368926,epoch time: 0:02:43.156078,used: 0:13:37.205158,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9838816, 'precision': 0.9838996, 'recall': 0.9839568, 'specificity': 0.9839568, 'f1': 0.9838813, 'auroc': 0.99841607, 'binary_precision': 0.99076515, 'binary_recall': 0.97722834, 'binary_specificity': 0.9906853, 'binary_f1_score': 0.9839502}
confusion matrix:
      0     1
0  1489    14
1    35  1502
---- Validation: 
scalar performance:
{'acc': 0.82830626, 'precision': 0.84369, 'recall': 0.82489306, 'specificity': 0.82489306, 'f1': 0.8251766, 'auroc': 0.91349137, 'binary_precision': 0.9089069, 'binary_recall': 0.7172524, 'binary_specificity': 0.93253374, 'binary_f1_score': 0.8017857}
confusion matrix:
     0    1
0  622   45
1  177  449
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79587156, 'precision': 0.797279, 'recall': 0.79587156, 'specificity': 0.79587156, 'f1': 0.7956297, 'auroc': 0.87648344, 'binary_precision': 0.817734, 'binary_recall': 0.7614679, 'binary_specificity': 0.83027524, 'binary_f1_score': 0.78859854}
confusion matrix:
     0    1
0  181   37
1   52  166
better model found
persisted
after epoch: 6,now: 2024-07-26 04:22:30.034909,epoch time: 0:02:41.665983,used: 0:16:18.871141,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.96907896, 'precision': 0.9703492, 'recall': 0.96941745, 'specificity': 0.96941745, 'f1': 0.96906996, 'auroc': 0.99807584, 'binary_precision': 0.99793106, 'binary_recall': 0.94083226, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.96854085}
confusion matrix:
      0     1
0  1499     3
1    91  1447
---- Validation: 
scalar performance:
{'acc': 0.86465585, 'precision': 0.86760473, 'recall': 0.86321855, 'specificity': 0.86321855, 'f1': 0.86393666, 'auroc': 0.9275354, 'binary_precision': 0.89354277, 'binary_recall': 0.81789136, 'binary_specificity': 0.90854573, 'binary_f1_score': 0.85404503}
confusion matrix:
     0    1
0  606   61
1  114  512
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8422822, 'recall': 0.82568806, 'specificity': 0.82568806, 'f1': 0.8235495, 'auroc': 0.9141487, 'binary_precision': 0.91764706, 'binary_recall': 0.7155963, 'binary_specificity': 0.9357798, 'binary_f1_score': 0.8041237}
confusion matrix:
     0    1
0  204   14
1   62  156
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 04:25:12.707873,epoch time: 0:02:42.672964,used: 0:19:01.544105,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95657897, 'precision': 0.9596291, 'recall': 0.9561209, 'specificity': 0.9561209, 'f1': 0.95647013, 'auroc': 0.99825245, 'binary_precision': 0.92503023, 'binary_recall': 0.9947984, 'binary_specificity': 0.9174434, 'binary_f1_score': 0.9586466}
confusion matrix:
      0     1
0  1378   124
1     8  1530
---- Validation: 
scalar performance:
{'acc': 0.71229696, 'precision': 0.7435496, 'recall': 0.7177026, 'specificity': 0.7177026, 'f1': 0.7058791, 'auroc': 0.76974773, 'binary_precision': 0.64801866, 'binary_recall': 0.8881789, 'binary_specificity': 0.54722637, 'binary_f1_score': 0.74932617}
confusion matrix:
     0    1
0  365  302
1   70  556
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76605505, 'precision': 0.8051158, 'recall': 0.76605505, 'specificity': 0.76605505, 'f1': 0.7583201, 'auroc': 0.8943691, 'binary_precision': 0.6959459, 'binary_recall': 0.94495416, 'binary_specificity': 0.58715594, 'binary_f1_score': 0.8015564}
confusion matrix:
     0    1
0  128   90
1   12  206
early stop counter: 1
val acc:0.7122969627380371, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8256880640983582 / 0.8256880640983582
after epoch: 8,now: 2024-07-26 04:27:53.433561,epoch time: 0:02:40.725688,used: 0:21:42.269793,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.9754901, 'recall': 0.9752437, 'specificity': 0.9752437, 'f1': 0.9753203, 'auroc': 0.9977381, 'binary_precision': 0.96921104, 'binary_recall': 0.98244476, 'binary_specificity': 0.9680426, 'binary_f1_score': 0.975783}
confusion matrix:
      0     1
0  1454    48
1    27  1511
---- Validation: 
scalar performance:
{'acc': 0.84996134, 'precision': 0.8587539, 'recall': 0.8474537, 'specificity': 0.8474537, 'f1': 0.8482578, 'auroc': 0.9265721, 'binary_precision': 0.9075472, 'binary_recall': 0.7683706, 'binary_specificity': 0.92653674, 'binary_f1_score': 0.83217996}
confusion matrix:
     0    1
0  618   49
1  145  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8027523, 'precision': 0.8156094, 'recall': 0.80275226, 'specificity': 0.80275226, 'f1': 0.8007228, 'auroc': 0.8955054, 'binary_precision': 0.87931037, 'binary_recall': 0.70183486, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.78061223}
confusion matrix:
     0    1
0  197   21
1   65  153
early stop counter: 2
val acc:0.8499613404273987, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8256880640983582 / 0.8256880640983582
after epoch: 9,now: 2024-07-26 04:30:34.063240,epoch time: 0:02:40.629679,used: 0:24:22.899472,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98059213, 'precision': 0.9810724, 'recall': 0.98079944, 'specificity': 0.98079944, 'f1': 0.98059106, 'auroc': 0.9994273, 'binary_precision': 0.9993243, 'binary_recall': 0.9622642, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9804442}
confusion matrix:
      0     1
0  1502     1
1    58  1479
---- Validation: 
scalar performance:
{'acc': 0.7857695, 'precision': 0.8303435, 'recall': 0.77983415, 'specificity': 0.77983415, 'f1': 0.775697, 'auroc': 0.9198686, 'binary_precision': 0.94402033, 'binary_recall': 0.5926518, 'binary_specificity': 0.9670165, 'binary_f1_score': 0.7281649}
confusion matrix:
     0    1
0  645   22
1  255  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74311924, 'precision': 0.7986456, 'recall': 0.74311924, 'specificity': 0.74311924, 'f1': 0.73059696, 'auroc': 0.8795556, 'binary_precision': 0.92741936, 'binary_recall': 0.5275229, 'binary_specificity': 0.9587156, 'binary_f1_score': 0.6725147}
confusion matrix:
     0    1
0  209    9
1  103  115
early stop counter: 3
val acc:0.785769522190094, best validation acc: 0.8646558523178101, corresponding to test acc:                         0.8256880640983582 / 0.8256880640983582
after epoch: 10,now: 2024-07-26 04:33:15.234239,epoch time: 0:02:41.170999,used: 0:27:04.070471,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.981892, 'recall': 0.9819314, 'specificity': 0.9819314, 'f1': 0.9819064, 'auroc': 0.9984126, 'binary_precision': 0.9843137, 'binary_recall': 0.97983086, 'binary_specificity': 0.9840319, 'binary_f1_score': 0.98206717}
confusion matrix:
      0     1
0  1479    24
1    31  1506
---- Validation: 
scalar performance:
{'acc': 0.87703013, 'precision': 0.8793174, 'recall': 0.8758017, 'specificity': 0.8758017, 'f1': 0.8764837, 'auroc': 0.93935704, 'binary_precision': 0.90189326, 'binary_recall': 0.8370607, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.8682684}
confusion matrix:
     0    1
0  610   57
1  102  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85779816, 'precision': 0.86901045, 'recall': 0.8577982, 'specificity': 0.8577982, 'f1': 0.8567097, 'auroc': 0.92622674, 'binary_precision': 0.93333334, 'binary_recall': 0.7706422, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.8442211}
confusion matrix:
     0    1
0  206   12
1   50  168
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-26 04:35:57.395574,epoch time: 0:02:42.161335,used: 0:29:46.231806,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9769737, 'precision': 0.97785, 'recall': 0.9767703, 'specificity': 0.9767703, 'f1': 0.9769535, 'auroc': 0.99906373, 'binary_precision': 0.9598494, 'binary_recall': 0.99609375, 'binary_specificity': 0.9574468, 'binary_f1_score': 0.9776358}
confusion matrix:
      0     1
0  1440    64
1     6  1530
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.8506924, 'recall': 0.8497349, 'specificity': 0.8497349, 'f1': 0.84838176, 'auroc': 0.93076146, 'binary_precision': 0.81341106, 'binary_recall': 0.8913738, 'binary_specificity': 0.80809593, 'binary_f1_score': 0.8506097}
confusion matrix:
     0    1
0  539  128
1   68  558
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82568806, 'precision': 0.8257155, 'recall': 0.82568806, 'specificity': 0.82568806, 'f1': 0.8256844, 'auroc': 0.9035645, 'binary_precision': 0.82272726, 'binary_recall': 0.83027524, 'binary_specificity': 0.8211009, 'binary_f1_score': 0.826484}
confusion matrix:
     0    1
0  179   39
1   37  181
early stop counter: 1
val acc:0.8484145402908325, best validation acc: 0.8770301342010498, corresponding to test acc:                         0.857798159122467 / 0.857798159122467
after epoch: 12,now: 2024-07-26 04:38:39.120991,epoch time: 0:02:41.725417,used: 0:32:27.957223,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9799342, 'precision': 0.9799974, 'recall': 0.98002553, 'specificity': 0.98002553, 'f1': 0.97993416, 'auroc': 0.9986572, 'binary_precision': 0.98873425, 'binary_recall': 0.9713542, 'binary_specificity': 0.9886968, 'binary_f1_score': 0.9799671}
confusion matrix:
      0     1
0  1487    17
1    44  1492
---- Validation: 
scalar performance:
{'acc': 0.84532094, 'precision': 0.865479, 'recall': 0.8415812, 'specificity': 0.8415812, 'f1': 0.84201646, 'auroc': 0.9318632, 'binary_precision': 0.94375, 'binary_recall': 0.7236422, 'binary_specificity': 0.9595202, 'binary_f1_score': 0.81916815}
confusion matrix:
     0    1
0  640   27
1  173  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165138, 'precision': 0.8603047, 'recall': 0.8165138, 'specificity': 0.8165138, 'f1': 0.81076384, 'auroc': 0.9435233, 'binary_precision': 0.9859155, 'binary_recall': 0.64220184, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.77777773}
confusion matrix:
     0    1
0  216    2
1   78  140
early stop counter: 2
val acc:0.8453209400177002, best validation acc: 0.8770301342010498, corresponding to test acc:                         0.857798159122467 / 0.857798159122467
after epoch: 13,now: 2024-07-26 04:41:19.975895,epoch time: 0:02:40.854904,used: 0:35:08.812127,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.98913735, 'recall': 0.989213, 'specificity': 0.989213, 'f1': 0.98914427, 'auroc': 0.99971473, 'binary_precision': 0.99474376, 'binary_recall': 0.9837557, 'binary_specificity': 0.9946702, 'binary_f1_score': 0.9892193}
confusion matrix:
      0     1
0  1493     8
1    25  1514
---- Validation: 
scalar performance:
{'acc': 0.82675946, 'precision': 0.83511215, 'recall': 0.82417935, 'specificity': 0.82417935, 'f1': 0.824734, 'auroc': 0.90490294, 'binary_precision': 0.8806818, 'binary_recall': 0.7428115, 'binary_specificity': 0.9055472, 'binary_f1_score': 0.8058925}
confusion matrix:
     0    1
0  604   63
1  161  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486239, 'precision': 0.86206293, 'recall': 0.8486239, 'specificity': 0.8486239, 'f1': 0.847206, 'auroc': 0.92894113, 'binary_precision': 0.9318182, 'binary_recall': 0.7522936, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.83248734}
confusion matrix:
     0    1
0  206   12
1   54  164
early stop counter: 3
val acc:0.8267594575881958, best validation acc: 0.8770301342010498, corresponding to test acc:                         0.857798159122467 / 0.857798159122467
after epoch: 14,now: 2024-07-26 04:44:00.744438,epoch time: 0:02:40.768543,used: 0:37:49.580670,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9779605, 'precision': 0.9784986, 'recall': 0.97820795, 'specificity': 0.97820795, 'f1': 0.9779593, 'auroc': 0.998929, 'binary_precision': 0.9979702, 'binary_recall': 0.95841455, 'binary_specificity': 0.99800134, 'binary_f1_score': 0.9777925}
confusion matrix:
      0     1
0  1498     3
1    64  1475
---- Validation: 
scalar performance:
{'acc': 0.66898686, 'precision': 0.7714262, 'recall': 0.6589325, 'specificity': 0.6589325, 'f1': 0.6263006, 'auroc': 0.91097665, 'binary_precision': 0.93043476, 'binary_recall': 0.34185302, 'binary_specificity': 0.976012, 'binary_f1_score': 0.49999994}
confusion matrix:
     0    1
0  651   16
1  412  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75688076, 'precision': 0.82887936, 'recall': 0.75688076, 'specificity': 0.75688076, 'f1': 0.7428044, 'auroc': 0.93929386, 'binary_precision': 0.98275864, 'binary_recall': 0.5229358, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.68263483}
confusion matrix:
     0    1
0  216    2
1  104  114
early stop counter: 4
val acc:0.6689868569374084, best validation acc: 0.8770301342010498, corresponding to test acc:                         0.857798159122467 / 0.857798159122467
after epoch: 15,now: 2024-07-26 04:46:41.386271,epoch time: 0:02:40.641833,used: 0:40:30.222503,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.9847859, 'recall': 0.9846867, 'specificity': 0.9846867, 'f1': 0.9845393, 'auroc': 0.9993681, 'binary_precision': 0.9986604, 'binary_recall': 0.9707031, 'binary_specificity': 0.9986702, 'binary_f1_score': 0.9844833}
confusion matrix:
      0     1
0  1502     2
1    45  1491
---- Validation: 
scalar performance:
{'acc': 0.84841454, 'precision': 0.86447537, 'recall': 0.8450707, 'specificity': 0.8450707, 'f1': 0.8457161, 'auroc': 0.9387026, 'binary_precision': 0.93346775, 'binary_recall': 0.73961663, 'binary_specificity': 0.95052475, 'binary_f1_score': 0.82531196}
confusion matrix:
     0    1
0  634   33
1  163  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165138, 'precision': 0.85526687, 'recall': 0.8165138, 'specificity': 0.8165138, 'f1': 0.8113698, 'auroc': 0.932876, 'binary_precision': 0.9726027, 'binary_recall': 0.6513761, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.7802198}
confusion matrix:
     0    1
0  214    4
1   76  142
early stop counter: 5
val acc:0.8484145402908325, best validation acc: 0.8770301342010498, corresponding to test acc:                         0.857798159122467 / 0.857798159122467
after epoch: 16,now: 2024-07-26 04:49:22.241954,epoch time: 0:02:40.855683,used: 0:43:11.078186,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_06_11_seed_8_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 0:43:11.078186 at 2024-07-26 04:49:22.241954
persisted model performance metric: 

scalar performance:
{'acc': 0.85779816, 'precision': 0.86901045, 'recall': 0.8577982, 'specificity': 0.8577982, 'f1': 0.8567097, 'auroc': 0.92622674, 'binary_precision': 0.93333334, 'binary_recall': 0.7706422, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.8442211}
confusion matrix:
     0    1
0  206   12
1   50  168
oracle model performance metric: 

scalar performance:
{'acc': 0.85779816, 'precision': 0.86901045, 'recall': 0.8577982, 'specificity': 0.8577982, 'f1': 0.8567097, 'auroc': 0.92622674, 'binary_precision': 0.93333334, 'binary_recall': 0.7706422, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.8442211}
confusion matrix:
     0    1
0  206   12
1   50  168
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2397 MiB |   8916 MiB | 659458 GiB | 659455 GiB |
|       from large pool |   2305 MiB |   8840 MiB | 653688 GiB | 653686 GiB |
|       from small pool |     91 MiB |    132 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2397 MiB |   8916 MiB | 659458 GiB | 659455 GiB |
|       from large pool |   2305 MiB |   8840 MiB | 653688 GiB | 653686 GiB |
|       from small pool |     91 MiB |    132 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 658587 GiB | 658585 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 652826 GiB | 652824 GiB |
|       from small pool |     91 MiB |    132 MiB |   5761 GiB |   5761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9748 MiB |   9824 MiB |  60554 MiB |  50806 MiB |
|       from large pool |   9612 MiB |   9688 MiB |  60142 MiB |  50530 MiB |
|       from small pool |    136 MiB |    140 MiB |    412 MiB |    276 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    970 MiB |   1656 MiB | 478799 GiB | 478798 GiB |
|       from large pool |    960 MiB |   1651 MiB | 472865 GiB | 472864 GiB |
|       from small pool |     10 MiB |     60 MiB |   5934 GiB |   5934 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2470    |    3329    |   93803 K  |   93800 K  |
|       from large pool |     392    |     816    |   47104 K  |   47104 K  |
|       from small pool |    2078    |    2780    |   46698 K  |   46696 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2470    |    3329    |   93803 K  |   93800 K  |
|       from large pool |     392    |     816    |   47104 K  |   47104 K  |
|       from small pool |    2078    |    2780    |   46698 K  |   46696 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     284    |     333    |    1577    |    1293    |
|       from large pool |     216    |     265    |    1371    |    1155    |
|       from small pool |      68    |      70    |     206    |     138    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     139    |     319    |   50657 K  |   50657 K  |
|       from large pool |      67    |     255    |   26602 K  |   26602 K  |
|       from small pool |      72    |     227    |   24055 K  |   24054 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8916 MiB | 659458 GiB | 659458 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 653688 GiB | 653688 GiB |
|       from small pool |      0 KiB |    132 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8916 MiB | 659458 GiB | 659458 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 653688 GiB | 653688 GiB |
|       from small pool |      0 KiB |    132 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 658587 GiB | 658587 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 652826 GiB | 652826 GiB |
|       from small pool |      0 KiB |    132 MiB |   5761 GiB |   5761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3368 MiB |   9824 MiB |  60554 MiB |  57186 MiB |
|       from large pool |   3266 MiB |   9688 MiB |  60142 MiB |  56876 MiB |
|       from small pool |    102 MiB |    140 MiB |    412 MiB |    310 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 478800 GiB | 478800 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 472866 GiB | 472866 GiB |
|       from small pool |      0 KiB |     60 MiB |   5934 GiB |   5934 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   93803 K  |   93803 K  |
|       from large pool |       2    |     816    |   47104 K  |   47104 K  |
|       from small pool |       0    |    2780    |   46698 K  |   46698 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   93803 K  |   93803 K  |
|       from large pool |       2    |     816    |   47104 K  |   47104 K  |
|       from small pool |       0    |    2780    |   46698 K  |   46698 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1577    |    1448    |
|       from large pool |      78    |     265    |    1371    |    1293    |
|       from small pool |      51    |      70    |     206    |     155    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   50658 K  |   50658 K  |
|       from large pool |       3    |     255    |   26602 K  |   26602 K  |
|       from small pool |       0    |     227    |   24055 K  |   24055 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8916 MiB | 659458 GiB | 659458 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 653688 GiB | 653688 GiB |
|       from small pool |      0 KiB |    132 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8916 MiB | 659458 GiB | 659458 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 653688 GiB | 653688 GiB |
|       from small pool |      0 KiB |    132 MiB |   5769 GiB |   5769 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 658587 GiB | 658587 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 652826 GiB | 652826 GiB |
|       from small pool |      0 KiB |    132 MiB |   5761 GiB |   5761 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3368 MiB |   9824 MiB |  60554 MiB |  57186 MiB |
|       from large pool |   3266 MiB |   9688 MiB |  60142 MiB |  56876 MiB |
|       from small pool |    102 MiB |    140 MiB |    412 MiB |    310 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 478800 GiB | 478800 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 472866 GiB | 472866 GiB |
|       from small pool |      0 KiB |     60 MiB |   5934 GiB |   5934 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |   93803 K  |   93803 K  |
|       from large pool |       2    |     816    |   47104 K  |   47104 K  |
|       from small pool |       0    |    2780    |   46698 K  |   46698 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |   93803 K  |   93803 K  |
|       from large pool |       2    |     816    |   47104 K  |   47104 K  |
|       from small pool |       0    |    2780    |   46698 K  |   46698 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     129    |     333    |    1577    |    1448    |
|       from large pool |      78    |     265    |    1371    |    1293    |
|       from small pool |      51    |      70    |     206    |     155    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   50658 K  |   50658 K  |
|       from large pool |       3    |     255    |   26602 K  |   26602 K  |
|       from small pool |       0    |     227    |   24055 K  |   24055 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main

using device: cuda:0

/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702

 Experiment start at: 2024-07-26 04:49:58.827223
hyper-parameter scheduler not set,going to use default Warmpup and epoch update
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95811516, 'precision': 0.9601176, 'recall': 0.9583627, 'specificity': 0.9583627, 'f1': 0.9580835, 'auroc': 0.9932924, 'binary_precision': 0.9923238, 'binary_recall': 0.9239766, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9569314}
confusion matrix:
      0     1
0  1506    11
1   117  1422
---- Validation: 
scalar performance:
{'acc': 0.6826255, 'precision': 0.718365, 'recall': 0.68055457, 'specificity': 0.68055457, 'f1': 0.66752326, 'auroc': 0.7736717, 'binary_precision': 0.8042328, 'binary_recall': 0.47425896, 'binary_specificity': 0.8868502, 'binary_f1_score': 0.59666336}
confusion matrix:
     0    1
0  580   74
1  337  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7695652, 'precision': 0.80881846, 'recall': 0.7695652, 'specificity': 0.7695652, 'f1': 0.76200235, 'auroc': 0.8260113, 'binary_precision': 0.9189189, 'binary_recall': 0.59130436, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.7195767}
confusion matrix:
     0    1
0  218   12
1   94  136
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:52:42.834015,epoch time: 0:02:44.006792,used: 0:02:44.006792,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9623691, 'precision': 0.9633327, 'recall': 0.96254385, 'specificity': 0.96254385, 'f1': 0.96235776, 'auroc': 0.99608123, 'binary_precision': 0.9863388, 'binary_recall': 0.9382716, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.96170497}
confusion matrix:
      0     1
0  1497    20
1    95  1444
---- Validation: 
scalar performance:
{'acc': 0.8563706, 'precision': 0.8566952, 'recall': 0.85652673, 'specificity': 0.85652673, 'f1': 0.8563638, 'auroc': 0.9230131, 'binary_precision': 0.84313726, 'binary_recall': 0.8720749, 'binary_specificity': 0.8409786, 'binary_f1_score': 0.85736203}
confusion matrix:
     0    1
0  550  104
1   82  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8608696, 'precision': 0.8608696, 'recall': 0.8608696, 'specificity': 0.8608696, 'f1': 0.8608696, 'auroc': 0.9268998, 'binary_precision': 0.8608696, 'binary_recall': 0.8608696, 'binary_specificity': 0.8608696, 'binary_f1_score': 0.8608696}
confusion matrix:
     0    1
0  198   32
1   32  198
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 04:55:25.920407,epoch time: 0:02:43.086392,used: 0:05:27.093184,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.97170204, 'recall': 0.97073644, 'specificity': 0.97073644, 'f1': 0.9708565, 'auroc': 0.9985591, 'binary_precision': 0.95369214, 'binary_recall': 0.9902534, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.9716289}
confusion matrix:
      0     1
0  1443    74
1    15  1524
---- Validation: 
scalar performance:
{'acc': 0.8123552, 'precision': 0.8143368, 'recall': 0.8127472, 'specificity': 0.8127472, 'f1': 0.812176, 'auroc': 0.8841331, 'binary_precision': 0.7867435, 'binary_recall': 0.85179406, 'binary_specificity': 0.7737003, 'binary_f1_score': 0.81797755}
confusion matrix:
     0    1
0  506  148
1   95  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78913045, 'precision': 0.79005706, 'recall': 0.78913045, 'specificity': 0.78913045, 'f1': 0.7889619, 'auroc': 0.87527406, 'binary_precision': 0.8064516, 'binary_recall': 0.76086956, 'binary_specificity': 0.8173913, 'binary_f1_score': 0.7829978}
confusion matrix:
     0    1
0  188   42
1   55  175
early stop counter: 1
val acc:0.8123552203178406, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.8608695864677429 / 0.8608695864677429
after epoch: 3,now: 2024-07-26 04:58:07.461648,epoch time: 0:02:41.541241,used: 0:08:08.634425,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96531415, 'precision': 0.9672642, 'recall': 0.96555734, 'specificity': 0.96555734, 'f1': 0.9652892, 'auroc': 0.9987887, 'binary_precision': 0.99930316, 'binary_recall': 0.9317739, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.96435785}
confusion matrix:
      0     1
0  1516     1
1   105  1434
---- Validation: 
scalar performance:
{'acc': 0.5281853, 'precision': 0.67904764, 'recall': 0.52350944, 'specificity': 0.52350944, 'f1': 0.3936471, 'auroc': 0.85590893, 'binary_precision': 0.84090906, 'binary_recall': 0.057722308, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.10802919}
confusion matrix:
     0   1
0  647   7
1  604  37
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.25, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.33333334, 'auroc': 0.8759924, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 1.0, 'binary_f1_score': 0.0}
confusion matrix:
     0  1
0  230  0
1  230  0
early stop counter: 2
val acc:0.5281853079795837, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.8608695864677429 / 0.8608695864677429
after epoch: 4,now: 2024-07-26 05:00:49.506468,epoch time: 0:02:42.044820,used: 0:10:50.679245,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9820026, 'precision': 0.98216116, 'recall': 0.98207253, 'specificity': 0.98207253, 'f1': 0.9820023, 'auroc': 0.9986726, 'binary_precision': 0.99269104, 'binary_recall': 0.97139144, 'binary_specificity': 0.9927536, 'binary_f1_score': 0.9819257}
confusion matrix:
      0     1
0  1507    11
1    44  1494
---- Validation: 
scalar performance:
{'acc': 0.8061776, 'precision': 0.83325243, 'recall': 0.80473936, 'specificity': 0.80473936, 'f1': 0.8016336, 'auroc': 0.92138386, 'binary_precision': 0.9257642, 'binary_recall': 0.6614665, 'binary_specificity': 0.94801223, 'binary_f1_score': 0.77161056}
confusion matrix:
     0    1
0  620   34
1  217  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6826087, 'precision': 0.80033576, 'recall': 0.6826087, 'specificity': 0.6826087, 'f1': 0.64812636, 'auroc': 0.9157089, 'binary_precision': 0.9883721, 'binary_recall': 0.36956522, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.53797466}
confusion matrix:
     0   1
0  229   1
1  145  85
early stop counter: 3
val acc:0.8061776161193848, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.8608695864677429 / 0.8608695864677429
after epoch: 5,now: 2024-07-26 05:03:31.053796,epoch time: 0:02:41.547328,used: 0:13:32.226573,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9518979, 'precision': 0.9545996, 'recall': 0.9516292, 'specificity': 0.9516292, 'f1': 0.95180386, 'auroc': 0.99689716, 'binary_precision': 0.9213075, 'binary_recall': 0.9889539, 'binary_specificity': 0.91430455, 'binary_f1_score': 0.953933}
confusion matrix:
      0     1
0  1387   130
1    17  1522
---- Validation: 
scalar performance:
{'acc': 0.7714286, 'precision': 0.8132671, 'recall': 0.77325064, 'specificity': 0.77325064, 'f1': 0.7643138, 'auroc': 0.93584895, 'binary_precision': 0.69624573, 'binary_recall': 0.95475817, 'binary_specificity': 0.5917431, 'binary_f1_score': 0.80526316}
confusion matrix:
     0    1
0  387  267
1   29  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7717391, 'precision': 0.80217993, 'recall': 0.7717391, 'specificity': 0.7717391, 'f1': 0.765842, 'auroc': 0.9193573, 'binary_precision': 0.70627064, 'binary_recall': 0.93043476, 'binary_specificity': 0.6130435, 'binary_f1_score': 0.8030019}
confusion matrix:
     0    1
0  141   89
1   16  214
early stop counter: 4
val acc:0.7714285850524902, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.8608695864677429 / 0.8608695864677429
after epoch: 6,now: 2024-07-26 05:06:12.788019,epoch time: 0:02:41.734223,used: 0:16:13.960796,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97022253, 'precision': 0.9712572, 'recall': 0.97040236, 'specificity': 0.97040236, 'f1': 0.9702129, 'auroc': 0.9985143, 'binary_precision': 0.995212, 'binary_recall': 0.94541913, 'binary_specificity': 0.99538565, 'binary_f1_score': 0.96967673}
confusion matrix:
      0     1
0  1510     7
1    84  1455
---- Validation: 
scalar performance:
{'acc': 0.7799228, 'precision': 0.7986069, 'recall': 0.7786524, 'specificity': 0.7786524, 'f1': 0.7758766, 'auroc': 0.8877655, 'binary_precision': 0.87083334, 'binary_recall': 0.6521061, 'binary_specificity': 0.90519875, 'binary_f1_score': 0.74576277}
confusion matrix:
     0    1
0  592   62
1  223  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79347825, 'precision': 0.8424809, 'recall': 0.79347825, 'specificity': 0.79347825, 'f1': 0.7858169, 'auroc': 0.923157, 'binary_precision': 0.97202796, 'binary_recall': 0.6043478, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.74530834}
confusion matrix:
     0    1
0  226    4
1   91  139
early stop counter: 5
val acc:0.7799227833747864, best validation acc: 0.8563706278800964, corresponding to test acc:                         0.8608695864677429 / 0.8608695864677429
after epoch: 7,now: 2024-07-26 05:08:54.401363,epoch time: 0:02:41.613344,used: 0:18:55.574140,model: dset_te_center0_diva_b888c1ef2_not_commited_2024md_07md_26_04_49_58_seed_9_23064702
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 7 with time: 0:18:55.574140 at 2024-07-26 05:08:54.401363
persisted model performance metric: 

scalar performance:
{'acc': 0.8608696, 'precision': 0.8608696, 'recall': 0.8608696, 'specificity': 0.8608696, 'f1': 0.8608696, 'auroc': 0.9268998, 'binary_precision': 0.8608696, 'binary_recall': 0.8608696, 'binary_specificity': 0.8608696, 'binary_f1_score': 0.8608696}
confusion matrix:
     0    1
0  198   32
1   32  198
oracle model performance metric: 

scalar performance:
{'acc': 0.8608696, 'precision': 0.8608696, 'recall': 0.8608696, 'specificity': 0.8608696, 'f1': 0.8608696, 'auroc': 0.9268998, 'binary_precision': 0.8608696, 'binary_recall': 0.8608696, 'binary_specificity': 0.8608696, 'binary_f1_score': 0.8608696}
confusion matrix:
     0    1
0  198   32
1   32  198
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2394 MiB |   8916 MiB | 706023 GiB | 706020 GiB |
|       from large pool |   2302 MiB |   8840 MiB | 699845 GiB | 699842 GiB |
|       from small pool |     91 MiB |    132 MiB |   6178 GiB |   6178 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   2394 MiB |   8916 MiB | 706023 GiB | 706020 GiB |
|       from large pool |   2302 MiB |   8840 MiB | 699845 GiB | 699842 GiB |
|       from small pool |     91 MiB |    132 MiB |   6178 GiB |   6178 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2375 MiB |   8902 MiB | 705116 GiB | 705114 GiB |
|       from large pool |   2284 MiB |   8826 MiB | 698947 GiB | 698945 GiB |
|       from small pool |     91 MiB |    132 MiB |   6168 GiB |   6168 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9732 MiB |   9824 MiB |  66918 MiB |  57186 MiB |
|       from large pool |   9596 MiB |   9688 MiB |  66472 MiB |  56876 MiB |
|       from small pool |    136 MiB |    140 MiB |    446 MiB |    310 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   1055 MiB |   1656 MiB | 512322 GiB | 512321 GiB |
|       from large pool |   1045 MiB |   1651 MiB | 505968 GiB | 505967 GiB |
|       from small pool |     10 MiB |     60 MiB |   6353 GiB |   6353 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    2476    |    3329    |  100439 K  |  100437 K  |
|       from large pool |     392    |     816    |   50434 K  |   50433 K  |
|       from small pool |    2084    |    2780    |   50005 K  |   50003 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    2476    |    3329    |  100439 K  |  100437 K  |
|       from large pool |     392    |     816    |   50434 K  |   50433 K  |
|       from small pool |    2084    |    2780    |   50005 K  |   50003 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     285    |     333    |    1733    |    1448    |
|       from large pool |     217    |     265    |    1510    |    1293    |
|       from small pool |      68    |      70    |     223    |     155    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     141    |     319    |   54393 K  |   54393 K  |
|       from large pool |      73    |     255    |   28626 K  |   28626 K  |
|       from small pool |      68    |     227    |   25766 K  |   25766 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   8916 MiB | 706023 GiB | 706023 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 699845 GiB | 699845 GiB |
|       from small pool |      0 KiB |    132 MiB |   6178 GiB |   6178 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   8916 MiB | 706023 GiB | 706023 GiB |
|       from large pool |  16640 KiB |   8840 MiB | 699845 GiB | 699845 GiB |
|       from small pool |      0 KiB |    132 MiB |   6178 GiB |   6178 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   8902 MiB | 705116 GiB | 705116 GiB |
|       from large pool |  16640 KiB |   8826 MiB | 698947 GiB | 698947 GiB |
|       from small pool |      0 KiB |    132 MiB |   6168 GiB |   6168 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3450 MiB |   9824 MiB |  66918 MiB |  63468 MiB |
|       from large pool |   3348 MiB |   9688 MiB |  66472 MiB |  63124 MiB |
|       from small pool |    102 MiB |    140 MiB |    446 MiB |    344 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1656 MiB | 512322 GiB | 512322 GiB |
|       from large pool |  24320 KiB |   1651 MiB | 505968 GiB | 505968 GiB |
|       from small pool |      0 KiB |     60 MiB |   6354 GiB |   6354 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    3329    |  100439 K  |  100439 K  |
|       from large pool |       2    |     816    |   50434 K  |   50434 K  |
|       from small pool |       0    |    2780    |   50005 K  |   50005 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    3329    |  100439 K  |  100439 K  |
|       from large pool |       2    |     816    |   50434 K  |   50434 K  |
|       from small pool |       0    |    2780    |   50005 K  |   50005 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     131    |     333    |    1733    |    1602    |
|       from large pool |      80    |     265    |    1510    |    1430    |
|       from small pool |      51    |      70    |     223    |     172    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     319    |   54393 K  |   54393 K  |
|       from large pool |       3    |     255    |   28626 K  |   28626 K  |
|       from small pool |       0    |     227    |   25767 K  |   25767 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 05:09:05 2024]
Finished job 0.
1 of 1 steps (100%) done
