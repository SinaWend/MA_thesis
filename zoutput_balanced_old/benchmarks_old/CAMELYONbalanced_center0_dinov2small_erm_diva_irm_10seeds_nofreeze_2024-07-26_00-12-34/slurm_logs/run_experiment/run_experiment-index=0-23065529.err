Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 04:38:27 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529

 Experiment start at: 2024-07-26 04:39:08.952318
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.944987, 'precision': 0.948727, 'recall': 0.94571084, 'specificity': 0.94571084, 'f1': 0.9449226, 'auroc': 0.9882642, 'binary_precision': 0.99360794, 'binary_recall': 0.8973701, 'binary_specificity': 0.9940516, 'binary_f1_score': 0.9430401}
confusion matrix:
      0     1
0  1504     9
1   160  1399
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.79347825, 'precision': 0.8207724, 'recall': 0.7914194, 'specificity': 0.7914194, 'f1': 0.78816414, 'auroc': 0.88809013, 'binary_precision': 0.91091317, 'binary_recall': 0.64409447, 'binary_specificity': 0.93874425, 'binary_f1_score': 0.7546125}
confusion matrix:
     0    1
0  613   40
1  226  409
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.84146833, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.8288244, 'auroc': 0.89763117, 'binary_precision': 0.90340906, 'binary_recall': 0.73953485, 'binary_specificity': 0.9209302, 'binary_f1_score': 0.81329924}
confusion matrix:
     0    1
0  198   17
1   56  159
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 04:40:40.033041,epoch time: 0:01:31.080723,used: 0:01:31.080723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97558594, 'precision': 0.97560525, 'recall': 0.97567487, 'specificity': 0.97567487, 'f1': 0.97558534, 'auroc': 0.9956387, 'binary_precision': 0.9830287, 'binary_recall': 0.96848875, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.97570455}
confusion matrix:
      0     1
0  1491    26
1    49  1506
---- Validation: 
scalar performance:
{'acc': 0.8136646, 'precision': 0.8163825, 'recall': 0.814301, 'specificity': 0.814301, 'f1': 0.8134469, 'auroc': 0.87989473, 'binary_precision': 0.78335726, 'binary_recall': 0.85984254, 'binary_specificity': 0.76875955, 'binary_f1_score': 0.81981987}
confusion matrix:
     0    1
0  502  151
1   89  546
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.83041126, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8302096, 'auroc': 0.9068253, 'binary_precision': 0.82272726, 'binary_recall': 0.8418605, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.83218396}
confusion matrix:
     0    1
0  176   39
1   34  181
better model found
persisted
after epoch: 2,now: 2024-07-26 04:42:03.365961,epoch time: 0:01:23.332920,used: 0:02:54.413643,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9720052, 'precision': 0.9720577, 'recall': 0.97211367, 'specificity': 0.97211367, 'f1': 0.9720049, 'auroc': 0.99619067, 'binary_precision': 0.9810085, 'binary_recall': 0.96334404, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.97209597}
confusion matrix:
      0     1
0  1488    29
1    57  1498
---- Validation: 
scalar performance:
{'acc': 0.7841615, 'precision': 0.78478277, 'recall': 0.78379375, 'specificity': 0.78379375, 'f1': 0.7838613, 'auroc': 0.86353475, 'binary_precision': 0.7950413, 'binary_recall': 0.7574803, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.7758064}
confusion matrix:
     0    1
0  529  124
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.8018752, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.7776238, 'auroc': 0.9183558, 'binary_precision': 0.72324723, 'binary_recall': 0.9116279, 'binary_specificity': 0.6511628, 'binary_f1_score': 0.80658436}
confusion matrix:
     0    1
0  140   75
1   19  196
early stop counter: 1
val acc:0.7841615080833435, best validation acc: 0.8136646151542664, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 3,now: 2024-07-26 04:43:25.161142,epoch time: 0:01:21.795181,used: 0:04:16.208824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.95947355, 'recall': 0.9562521, 'specificity': 0.9562521, 'f1': 0.95660365, 'auroc': 0.99799144, 'binary_precision': 0.9267707, 'binary_recall': 0.99292606, 'binary_specificity': 0.91957814, 'binary_f1_score': 0.95870847}
confusion matrix:
      0     1
0  1395   122
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.8164597, 'recall': 0.7901183, 'specificity': 0.7901183, 'f1': 0.7839637, 'auroc': 0.90170383, 'binary_precision': 0.7180723, 'binary_recall': 0.93858266, 'binary_specificity': 0.6416539, 'binary_f1_score': 0.8136519}
confusion matrix:
     0    1
0  419  234
1   39  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7767442, 'precision': 0.8095584, 'recall': 0.7767442, 'specificity': 0.7767442, 'f1': 0.77066666, 'auroc': 0.92010814, 'binary_precision': 0.70877194, 'binary_recall': 0.9395349, 'binary_specificity': 0.6139535, 'binary_f1_score': 0.808}
confusion matrix:
     0    1
0  132   83
1   13  202
early stop counter: 2
val acc:0.7880434989929199, best validation acc: 0.8136646151542664, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 4,now: 2024-07-26 04:44:47.592494,epoch time: 0:01:22.431352,used: 0:05:38.640176,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9828304, 'recall': 0.9826894, 'specificity': 0.9826894, 'f1': 0.9827423, 'auroc': 0.99833477, 'binary_precision': 0.9789675, 'binary_recall': 0.98714656, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.98304003}
confusion matrix:
      0     1
0  1483    33
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.80667704, 'precision': 0.8088671, 'recall': 0.80606407, 'specificity': 0.80606407, 'f1': 0.8060878, 'auroc': 0.8831655, 'binary_precision': 0.83161515, 'binary_recall': 0.7622047, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.79539853}
confusion matrix:
     0    1
0  555   98
1  151  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8307983, 'recall': 0.8255814, 'specificity': 0.8255814, 'f1': 0.824891, 'auroc': 0.92439157, 'binary_precision': 0.7892562, 'binary_recall': 0.88837206, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.8358862}
confusion matrix:
     0    1
0  164   51
1   24  191
early stop counter: 3
val acc:0.8066770434379578, best validation acc: 0.8136646151542664, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 5,now: 2024-07-26 04:46:10.664150,epoch time: 0:01:23.071656,used: 0:07:01.711832,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9794922, 'precision': 0.98029757, 'recall': 0.9792292, 'specificity': 0.9792292, 'f1': 0.97947085, 'auroc': 0.9990296, 'binary_precision': 0.96401983, 'binary_recall': 0.9967928, 'binary_specificity': 0.9616656, 'binary_f1_score': 0.98013246}
confusion matrix:
      0     1
0  1455    58
1     5  1554
---- Validation: 
scalar performance:
{'acc': 0.8625776, 'precision': 0.86573505, 'recall': 0.8632345, 'specificity': 0.8632345, 'f1': 0.8624097, 'auroc': 0.9182043, 'binary_precision': 0.82808024, 'binary_recall': 0.91023624, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.8672168}
confusion matrix:
     0    1
0  533  120
1   57  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8433162, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8416927, 'auroc': 0.9302975, 'binary_precision': 0.8209607, 'binary_recall': 0.8744186, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8468469}
confusion matrix:
     0    1
0  174   41
1   27  188
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 04:47:33.548814,epoch time: 0:01:22.884664,used: 0:08:24.596496,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9827758, 'recall': 0.98286974, 'specificity': 0.98286974, 'f1': 0.9827469, 'auroc': 0.9981003, 'binary_precision': 0.99150884, 'binary_recall': 0.9743261, 'binary_specificity': 0.9914135, 'binary_f1_score': 0.9828424}
confusion matrix:
      0     1
0  1501    13
1    40  1518
---- Validation: 
scalar performance:
{'acc': 0.738354, 'precision': 0.7744882, 'recall': 0.7357743, 'specificity': 0.7357743, 'f1': 0.7280253, 'auroc': 0.8723589, 'binary_precision': 0.8706468, 'binary_recall': 0.5511811, 'binary_specificity': 0.92036754, 'binary_f1_score': 0.6750241}
confusion matrix:
     0    1
0  601   52
1  285  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.8492074, 'recall': 0.84883726, 'specificity': 0.84883726, 'f1': 0.8487972, 'auroc': 0.92633855, 'binary_precision': 0.8605769, 'binary_recall': 0.83255816, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.8463357}
confusion matrix:
     0    1
0  186   29
1   36  179
new oracle model saved
early stop counter: 1
val acc:0.7383540272712708, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8488371968269348
after epoch: 7,now: 2024-07-26 04:48:57.437641,epoch time: 0:01:23.888827,used: 0:09:48.485323,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98046875, 'precision': 0.98087025, 'recall': 0.98067206, 'specificity': 0.98067206, 'f1': 0.9804681, 'auroc': 0.9985685, 'binary_precision': 0.998, 'binary_recall': 0.96332043, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.98035365}
confusion matrix:
      0     1
0  1515     3
1    57  1497
---- Validation: 
scalar performance:
{'acc': 0.70729816, 'precision': 0.7861399, 'recall': 0.7035837, 'specificity': 0.7035837, 'f1': 0.6832344, 'auroc': 0.9074875, 'binary_precision': 0.9328859, 'binary_recall': 0.43779528, 'binary_specificity': 0.96937215, 'binary_f1_score': 0.5959271}
confusion matrix:
     0    1
0  633   20
1  357  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.85360956, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.7976471, 'auroc': 0.91922116, 'binary_precision': 0.9851852, 'binary_recall': 0.61860466, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.76000005}
confusion matrix:
     0    1
0  213    2
1   82  133
early stop counter: 2
val acc:0.7072981595993042, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8488371968269348
after epoch: 8,now: 2024-07-26 04:50:20.809707,epoch time: 0:01:23.372066,used: 0:11:11.857389,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.9908786, 'recall': 0.9909452, 'specificity': 0.9909452, 'f1': 0.990885, 'auroc': 0.99938536, 'binary_precision': 0.9960988, 'binary_recall': 0.985843, 'binary_specificity': 0.99604744, 'binary_f1_score': 0.9909444}
confusion matrix:
      0     1
0  1512     6
1    22  1532
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.86227775, 'recall': 0.85215783, 'specificity': 0.85215783, 'f1': 0.85203993, 'auroc': 0.92647386, 'binary_precision': 0.9160448, 'binary_recall': 0.77322835, 'binary_specificity': 0.9310873, 'binary_f1_score': 0.8385995}
confusion matrix:
     0    1
0  608   45
1  144  491
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8744186, 'precision': 0.8852189, 'recall': 0.8744186, 'specificity': 0.8744186, 'f1': 0.8735322, 'auroc': 0.93975127, 'binary_precision': 0.9497207, 'binary_recall': 0.7906977, 'binary_specificity': 0.95813954, 'binary_f1_score': 0.8629441}
confusion matrix:
     0    1
0  206    9
1   45  170
new oracle model saved
early stop counter: 3
val acc:0.85326087474823, best validation acc: 0.8625776171684265, corresponding to test acc:                         0.8418604731559753 / 0.8744186162948608
after epoch: 9,now: 2024-07-26 04:51:44.223630,epoch time: 0:01:23.413923,used: 0:12:35.271312,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9714098, 'recall': 0.9693696, 'specificity': 0.9693696, 'f1': 0.9696779, 'auroc': 0.99949336, 'binary_precision': 0.94630873, 'binary_recall': 0.99678665, 'binary_specificity': 0.9419525, 'binary_f1_score': 0.970892}
confusion matrix:
      0     1
0  1428    88
1     5  1551
---- Validation: 
scalar performance:
{'acc': 0.878882, 'precision': 0.8788953, 'recall': 0.87881494, 'specificity': 0.87881494, 'f1': 0.87884665, 'auroc': 0.92620134, 'binary_precision': 0.87955624, 'binary_recall': 0.87401575, 'binary_specificity': 0.88361406, 'binary_f1_score': 0.87677723}
confusion matrix:
     0    1
0  577   76
1   80  555
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89069766, 'precision': 0.8913835, 'recall': 0.89069766, 'specificity': 0.89069766, 'f1': 0.8906498, 'auroc': 0.94364524, 'binary_precision': 0.907767, 'binary_recall': 0.8697674, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.88836104}
confusion matrix:
     0    1
0  196   19
1   28  187
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-26 04:53:07.392543,epoch time: 0:01:23.168913,used: 0:13:58.440225,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99348956, 'precision': 0.9934653, 'recall': 0.99352556, 'specificity': 0.99352556, 'f1': 0.9934887, 'auroc': 0.9997897, 'binary_precision': 0.99612904, 'binary_recall': 0.9910141, 'binary_specificity': 0.996037, 'binary_f1_score': 0.993565}
confusion matrix:
      0     1
0  1508     6
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.7259317, 'precision': 0.793064, 'recall': 0.72254646, 'specificity': 0.72254646, 'f1': 0.7072952, 'auroc': 0.9126117, 'binary_precision': 0.92987806, 'binary_recall': 0.48031497, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.6334372}
confusion matrix:
     0    1
0  630   23
1  330  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.8561437, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.80827534, 'auroc': 0.9234613, 'binary_precision': 0.9787234, 'binary_recall': 0.6418605, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.7752809}
confusion matrix:
     0    1
0  212    3
1   77  138
early stop counter: 1
val acc:0.725931704044342, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 11,now: 2024-07-26 04:54:30.328008,epoch time: 0:01:22.935465,used: 0:15:21.375690,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895748, 'recall': 0.98967445, 'specificity': 0.98967445, 'f1': 0.98958266, 'auroc': 0.99931157, 'binary_precision': 0.9960988, 'binary_recall': 0.98331195, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9896641}
confusion matrix:
      0     1
0  1508     6
1    26  1532
---- Validation: 
scalar performance:
{'acc': 0.7872671, 'precision': 0.83277094, 'recall': 0.7846644, 'specificity': 0.7846644, 'f1': 0.7786592, 'auroc': 0.9167495, 'binary_precision': 0.95238096, 'binary_recall': 0.5984252, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.7350097}
confusion matrix:
     0    1
0  634   19
1  255  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.83489096, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.7375392, 'auroc': 0.9308816, 'binary_precision': 1.0, 'binary_recall': 0.5069767, 'binary_specificity': 1.0, 'binary_f1_score': 0.67283946}
confusion matrix:
     0    1
0  215    0
1  106  109
early stop counter: 2
val acc:0.7872670888900757, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 12,now: 2024-07-26 04:55:54.595439,epoch time: 0:01:24.267431,used: 0:16:45.643121,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.98285705, 'recall': 0.9828929, 'specificity': 0.9828929, 'f1': 0.9827473, 'auroc': 0.9990652, 'binary_precision': 0.99408287, 'binary_recall': 0.97172236, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9827754}
confusion matrix:
      0     1
0  1507     9
1    44  1512
---- Validation: 
scalar performance:
{'acc': 0.7872671, 'precision': 0.83277094, 'recall': 0.7846644, 'specificity': 0.7846644, 'f1': 0.7786592, 'auroc': 0.90656686, 'binary_precision': 0.95238096, 'binary_recall': 0.5984252, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.7350097}
confusion matrix:
     0    1
0  634   19
1  255  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.85527253, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.7946756, 'auroc': 0.92538667, 'binary_precision': 0.99242425, 'binary_recall': 0.60930234, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.75504327}
confusion matrix:
     0    1
0  214    1
1   84  131
early stop counter: 3
val acc:0.7872670888900757, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 13,now: 2024-07-26 04:57:17.202927,epoch time: 0:01:22.607488,used: 0:18:08.250609,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906878, 'recall': 0.9904862, 'specificity': 0.9904862, 'f1': 0.9905566, 'auroc': 0.999694, 'binary_precision': 0.98537827, 'binary_recall': 0.99614394, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.99073184}
confusion matrix:
      0     1
0  1493    23
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.79037267, 'precision': 0.8093639, 'recall': 0.788617, 'specificity': 0.788617, 'f1': 0.786384, 'auroc': 0.8912204, 'binary_precision': 0.8825996, 'binary_recall': 0.6629921, 'binary_specificity': 0.91424197, 'binary_f1_score': 0.7571942}
confusion matrix:
     0    1
0  597   56
1  214  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.84434104, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.78501326, 'auroc': 0.9247594, 'binary_precision': 0.97727275, 'binary_recall': 0.6, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.74351585}
confusion matrix:
     0    1
0  212    3
1   86  129
early stop counter: 4
val acc:0.7903726696968079, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 14,now: 2024-07-26 04:58:40.847433,epoch time: 0:01:23.644506,used: 0:19:31.895115,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98630476, 'recall': 0.986379, 'specificity': 0.986379, 'f1': 0.9863268, 'auroc': 0.9987451, 'binary_precision': 0.99029124, 'binary_recall': 0.982659, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9864604}
confusion matrix:
      0     1
0  1500    15
1    27  1530
---- Validation: 
scalar performance:
{'acc': 0.8408385, 'precision': 0.85919946, 'recall': 0.8392556, 'specificity': 0.8392556, 'f1': 0.83831215, 'auroc': 0.9311403, 'binary_precision': 0.9369919, 'binary_recall': 0.7259843, 'binary_specificity': 0.9525268, 'binary_f1_score': 0.81810117}
confusion matrix:
     0    1
0  622   31
1  174  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.8369906, 'recall': 0.7581395, 'specificity': 0.7581395, 'f1': 0.7431125, 'auroc': 0.9286966, 'binary_precision': 1.0, 'binary_recall': 0.51627904, 'binary_specificity': 1.0, 'binary_f1_score': 0.6809816}
confusion matrix:
     0    1
0  215    0
1  104  111
early stop counter: 5
val acc:0.8408384919166565, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 15,now: 2024-07-26 05:00:05.008387,epoch time: 0:01:24.160954,used: 0:20:56.056069,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9897498, 'recall': 0.98949236, 'specificity': 0.98949236, 'f1': 0.98957914, 'auroc': 0.99968415, 'binary_precision': 0.983513, 'binary_recall': 0.99614644, 'binary_specificity': 0.9828383, 'binary_f1_score': 0.9897894}
confusion matrix:
      0     1
0  1489    26
1     6  1551
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.8482567, 'recall': 0.8474648, 'specificity': 0.8474648, 'f1': 0.8470009, 'auroc': 0.9006909, 'binary_precision': 0.8239645, 'binary_recall': 0.8771654, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.849733}
confusion matrix:
     0    1
0  534  119
1   78  557
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88139534, 'precision': 0.88180006, 'recall': 0.88139534, 'specificity': 0.88139534, 'f1': 0.881364, 'auroc': 0.9394051, 'binary_precision': 0.8942308, 'binary_recall': 0.8651163, 'binary_specificity': 0.89767444, 'binary_f1_score': 0.8794327}
confusion matrix:
     0    1
0  193   22
1   29  186
early stop counter: 6
val acc:0.8470497131347656, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8906976580619812
after epoch: 16,now: 2024-07-26 05:01:28.169437,epoch time: 0:01:23.161050,used: 0:22:19.217119,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98891354, 'recall': 0.98895586, 'specificity': 0.98895586, 'f1': 0.98893094, 'auroc': 0.999309, 'binary_precision': 0.99096775, 'binary_recall': 0.98714656, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9890534}
confusion matrix:
      0     1
0  1502    14
1    20  1536
---- Validation: 
scalar performance:
{'acc': 0.8447205, 'precision': 0.84510565, 'recall': 0.8444731, 'specificity': 0.8444731, 'f1': 0.8445853, 'auroc': 0.91108274, 'binary_precision': 0.85365856, 'binary_recall': 0.8267717, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.8400001}
confusion matrix:
     0    1
0  563   90
1  110  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89767444, 'precision': 0.90668344, 'recall': 0.89767444, 'specificity': 0.89767444, 'f1': 0.8971046, 'auroc': 0.94487834, 'binary_precision': 0.9672131, 'binary_recall': 0.82325584, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8894472}
confusion matrix:
     0    1
0  209    6
1   38  177
new oracle model saved
early stop counter: 7
val acc:0.8447204828262329, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 17,now: 2024-07-26 05:02:50.670293,epoch time: 0:01:22.500856,used: 0:23:41.717975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931593, 'recall': 0.99316704, 'specificity': 0.99316704, 'f1': 0.9931631, 'auroc': 0.99981093, 'binary_precision': 0.993565, 'binary_recall': 0.99292606, 'binary_specificity': 0.993408, 'binary_f1_score': 0.9932455}
confusion matrix:
      0     1
0  1507    10
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.8051242, 'precision': 0.8419415, 'recall': 0.802818, 'specificity': 0.802818, 'f1': 0.7988771, 'auroc': 0.9291706, 'binary_precision': 0.9507042, 'binary_recall': 0.63779527, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.7634307}
confusion matrix:
     0    1
0  632   21
1  230  405
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581395, 'precision': 0.885215, 'recall': 0.8581395, 'specificity': 0.8581395, 'f1': 0.85560226, 'auroc': 0.9396647, 'binary_precision': 0.98734176, 'binary_recall': 0.7255814, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.8364611}
confusion matrix:
     0    1
0  213    2
1   59  156
early stop counter: 8
val acc:0.8051242232322693, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 18,now: 2024-07-26 05:04:13.043816,epoch time: 0:01:22.373523,used: 0:25:04.091498,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.98708606, 'recall': 0.9871141, 'specificity': 0.9871141, 'f1': 0.9869791, 'auroc': 0.99940526, 'binary_precision': 0.9980276, 'binary_recall': 0.97620577, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98699605}
confusion matrix:
      0     1
0  1514     3
1    37  1518
---- Validation: 
scalar performance:
{'acc': 0.6545031, 'precision': 0.76841486, 'recall': 0.64988846, 'specificity': 0.64988846, 'f1': 0.6095574, 'auroc': 0.87675536, 'binary_precision': 0.9398148, 'binary_recall': 0.31968504, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.4770858}
confusion matrix:
     0    1
0  640   13
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.808165, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.67436576, 'auroc': 0.9062412, 'binary_precision': 0.98876405, 'binary_recall': 0.40930232, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5789473}
confusion matrix:
     0   1
0  214   1
1  127  88
early stop counter: 9
val acc:0.6545031070709229, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 19,now: 2024-07-26 05:05:35.958301,epoch time: 0:01:22.914485,used: 0:26:27.005983,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.9895426, 'recall': 0.9891394, 'specificity': 0.9891394, 'f1': 0.9892527, 'auroc': 0.9998466, 'binary_precision': 0.9804293, 'binary_recall': 0.99871385, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.9894871}
confusion matrix:
      0     1
0  1486    31
1     2  1553
---- Validation: 
scalar performance:
{'acc': 0.8532609, 'precision': 0.8538783, 'recall': 0.8529609, 'specificity': 0.8529609, 'f1': 0.85309714, 'auroc': 0.9142178, 'binary_precision': 0.86557376, 'binary_recall': 0.83149606, 'binary_specificity': 0.8744257, 'binary_f1_score': 0.84819275}
confusion matrix:
     0    1
0  571   82
1  107  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.84654164, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465083, 'auroc': 0.90658736, 'binary_precision': 0.84976524, 'binary_recall': 0.8418605, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8457944}
confusion matrix:
     0    1
0  183   32
1   34  181
early stop counter: 10
val acc:0.85326087474823, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 20,now: 2024-07-26 05:06:58.265698,epoch time: 0:01:22.307397,used: 0:27:49.313380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896271, 'recall': 0.9896811, 'specificity': 0.9896811, 'f1': 0.98958325, 'auroc': 0.99943495, 'binary_precision': 0.9980366, 'binary_recall': 0.9813385, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.98961717}
confusion matrix:
      0     1
0  1515     3
1    29  1525
---- Validation: 
scalar performance:
{'acc': 0.7787267, 'precision': 0.82589287, 'recall': 0.77604634, 'specificity': 0.77604634, 'f1': 0.76925147, 'auroc': 0.9387057, 'binary_precision': 0.9464286, 'binary_recall': 0.58425194, 'binary_specificity': 0.96784073, 'binary_f1_score': 0.7224927}
confusion matrix:
     0    1
0  632   21
1  264  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7046512, 'precision': 0.80915034, 'recall': 0.7046511, 'specificity': 0.7046511, 'f1': 0.67738885, 'auroc': 0.9214927, 'binary_precision': 0.98888886, 'binary_recall': 0.41395348, 'binary_specificity': 0.9953488, 'binary_f1_score': 0.5836066}
confusion matrix:
     0   1
0  214   1
1  126  89
early stop counter: 11
val acc:0.7787266969680786, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 21,now: 2024-07-26 05:08:22.237626,epoch time: 0:01:23.971928,used: 0:29:13.285308,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899373, 'recall': 0.9900327, 'specificity': 0.9900327, 'f1': 0.9899085, 'auroc': 0.9996642, 'binary_precision': 0.99869365, 'binary_recall': 0.98138636, 'binary_specificity': 0.998679, 'binary_f1_score': 0.98996437}
confusion matrix:
      0     1
0  1512     2
1    29  1529
---- Validation: 
scalar performance:
{'acc': 0.746118, 'precision': 0.8027182, 'recall': 0.7430623, 'specificity': 0.7430623, 'f1': 0.7320626, 'auroc': 0.9091052, 'binary_precision': 0.9301676, 'binary_recall': 0.5244095, 'binary_specificity': 0.96171516, 'binary_f1_score': 0.6706949}
confusion matrix:
     0    1
0  628   25
1  302  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8714266, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83601487, 'auroc': 0.9297999, 'binary_precision': 0.9802632, 'binary_recall': 0.69302326, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.8119891}
confusion matrix:
     0    1
0  212    3
1   66  149
early stop counter: 12
val acc:0.7461180090904236, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 22,now: 2024-07-26 05:09:45.220859,epoch time: 0:01:22.983233,used: 0:30:36.268541,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99092674, 'recall': 0.99100834, 'specificity': 0.99100834, 'f1': 0.99088526, 'auroc': 0.9993068, 'binary_precision': 1.0, 'binary_recall': 0.9820167, 'binary_specificity': 1.0, 'binary_f1_score': 0.99092674}
confusion matrix:
      0     1
0  1515     0
1    28  1529
---- Validation: 
scalar performance:
{'acc': 0.61024845, 'precision': 0.74255615, 'recall': 0.6050066, 'specificity': 0.6050066, 'f1': 0.54302615, 'auroc': 0.85666823, 'binary_precision': 0.918239, 'binary_recall': 0.22992127, 'binary_specificity': 0.98009187, 'binary_f1_score': 0.3677582}
confusion matrix:
     0    1
0  640   13
1  489  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.7732731, 'recall': 0.63488376, 'specificity': 0.63488376, 'f1': 0.5819582, 'auroc': 0.8856625, 'binary_precision': 0.9677419, 'binary_recall': 0.27906978, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.43321303}
confusion matrix:
     0   1
0  213   2
1  155  60
early stop counter: 13
val acc:0.6102484464645386, best validation acc: 0.8788819909095764, corresponding to test acc:                         0.8906976580619812 / 0.8976744413375854
after epoch: 23,now: 2024-07-26 05:11:08.028479,epoch time: 0:01:22.807620,used: 0:31:59.076161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.984375, 'precision': 0.98461956, 'recall': 0.9842563, 'specificity': 0.9842563, 'f1': 0.9843673, 'auroc': 0.999526, 'binary_precision': 0.97662663, 'binary_recall': 0.9929351, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.9847133}
confusion matrix:
      0     1
0  1478    37
1    11  1546
---- Validation: 
scalar performance:
{'acc': 0.88897514, 'precision': 0.89238024, 'recall': 0.8883349, 'specificity': 0.8883349, 'f1': 0.8885974, 'auroc': 0.94084, 'binary_precision': 0.92560554, 'binary_recall': 0.8425197, 'binary_specificity': 0.9341501, 'binary_f1_score': 0.8821104}
confusion matrix:
     0    1
0  610   43
1  100  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8860465, 'precision': 0.89655554, 'recall': 0.8860465, 'specificity': 0.8860465, 'f1': 0.88528645, 'auroc': 0.92897785, 'binary_precision': 0.9611111, 'binary_recall': 0.80465114, 'binary_specificity': 0.96744186, 'binary_f1_score': 0.8759493}
confusion matrix:
     0    1
0  208    7
1   42  173
better model found
persisted
after epoch: 24,now: 2024-07-26 05:12:30.613801,epoch time: 0:01:22.585322,used: 0:33:21.661483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.9928472, 'recall': 0.9928272, 'specificity': 0.9928272, 'f1': 0.99283683, 'auroc': 0.9998105, 'binary_precision': 0.9923126, 'binary_recall': 0.99358565, 'binary_specificity': 0.9920687, 'binary_f1_score': 0.9929487}
confusion matrix:
      0     1
0  1501    12
1    10  1549
---- Validation: 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8746406, 'recall': 0.85725725, 'specificity': 0.85725725, 'f1': 0.85680497, 'auroc': 0.9367643, 'binary_precision': 0.9485149, 'binary_recall': 0.7543307, 'binary_specificity': 0.96018374, 'binary_f1_score': 0.84035087}
confusion matrix:
     0    1
0  627   26
1  156  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.8909091, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.85769445, 'auroc': 0.9352082, 'binary_precision': 1.0, 'binary_recall': 0.7209302, 'binary_specificity': 1.0, 'binary_f1_score': 0.8378378}
confusion matrix:
     0    1
0  215    0
1   60  155
early stop counter: 1
val acc:0.8586956262588501, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8860465288162231 / 0.8976744413375854
after epoch: 25,now: 2024-07-26 05:13:53.852545,epoch time: 0:01:23.238744,used: 0:34:44.900227,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.994447, 'recall': 0.99453187, 'specificity': 0.99453187, 'f1': 0.9944657, 'auroc': 0.9996846, 'binary_precision': 0.9993515, 'binary_recall': 0.9897238, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.99451435}
confusion matrix:
      0     1
0  1514     1
1    16  1541
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.82142603, 'recall': 0.7649793, 'specificity': 0.7649793, 'f1': 0.75642824, 'auroc': 0.9212556, 'binary_precision': 0.9491979, 'binary_recall': 0.5590551, 'binary_specificity': 0.9709035, 'binary_f1_score': 0.703667}
confusion matrix:
     0    1
0  634   19
1  280  355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80697674, 'precision': 0.8607383, 'recall': 0.80697674, 'specificity': 0.80697674, 'f1': 0.7995068, 'auroc': 0.9304056, 'binary_precision': 1.0, 'binary_recall': 0.6139535, 'binary_specificity': 1.0, 'binary_f1_score': 0.7608069}
confusion matrix:
     0    1
0  215    0
1   83  132
early stop counter: 2
val acc:0.7678571343421936, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8860465288162231 / 0.8976744413375854
after epoch: 26,now: 2024-07-26 05:15:17.315815,epoch time: 0:01:23.463270,used: 0:36:08.363497,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921968, 'recall': 0.9922794, 'specificity': 0.9922794, 'f1': 0.99218726, 'auroc': 0.9997257, 'binary_precision': 0.9993481, 'binary_recall': 0.9852185, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.992233}
confusion matrix:
      0     1
0  1515     1
1    23  1533
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.83649015, 'recall': 0.7965622, 'specificity': 0.7965622, 'f1': 0.79223, 'auroc': 0.92094994, 'binary_precision': 0.94549763, 'binary_recall': 0.62834644, 'binary_specificity': 0.96477795, 'binary_f1_score': 0.75496686}
confusion matrix:
     0    1
0  630   23
1  236  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.8448365, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.7793392, 'auroc': 0.9345971, 'binary_precision': 0.984375, 'binary_recall': 0.5860465, 'binary_specificity': 0.9906977, 'binary_f1_score': 0.7346939}
confusion matrix:
     0    1
0  213    2
1   89  126
early stop counter: 3
val acc:0.7989130616188049, best validation acc: 0.8889751434326172, corresponding to test acc:                         0.8860465288162231 / 0.8976744413375854
after epoch: 27,now: 2024-07-26 05:16:39.507187,epoch time: 0:01:22.191372,used: 0:37:30.554869,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98949695, 'recall': 0.989139, 'specificity': 0.989139, 'f1': 0.9892524, 'auroc': 0.99984866, 'binary_precision': 0.98168033, 'binary_recall': 0.9974326, 'binary_specificity': 0.98084545, 'binary_f1_score': 0.9894938}
confusion matrix:
      0     1
0  1485    29
1     4  1554
---- Validation: 
scalar performance:
{'acc': 0.89285713, 'precision': 0.8929931, 'recall': 0.89272773, 'specificity': 0.89272773, 'f1': 0.89280653, 'auroc': 0.9343671, 'binary_precision': 0.8976, 'binary_recall': 0.8834646, 'binary_specificity': 0.90199083, 'binary_f1_score': 0.8904762}
confusion matrix:
     0    1
0  589   64
1   74  561
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8627907, 'precision': 0.86298704, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8627721, 'auroc': 0.93378043, 'binary_precision': 0.87142855, 'binary_recall': 0.8511628, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8611764}
confusion matrix:
     0    1
0  188   27
1   32  183
better model found
persisted
after epoch: 28,now: 2024-07-26 05:18:04.366306,epoch time: 0:01:24.859119,used: 0:38:55.413988,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.99152195, 'recall': 0.991552, 'specificity': 0.991552, 'f1': 0.9915353, 'auroc': 0.99976933, 'binary_precision': 0.99291235, 'binary_recall': 0.9903599, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9916344}
confusion matrix:
      0     1
0  1505    11
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8470497, 'precision': 0.8479581, 'recall': 0.8466834, 'specificity': 0.8466834, 'f1': 0.846828, 'auroc': 0.90153503, 'binary_precision': 0.8625828, 'binary_recall': 0.8204724, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.84100085}
confusion matrix:
     0    1
0  570   83
1  114  521
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.84902596, 'recall': 0.8488372, 'specificity': 0.8488372, 'f1': 0.84881675, 'auroc': 0.8983667, 'binary_precision': 0.84090906, 'binary_recall': 0.8604651, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8505747}
confusion matrix:
     0    1
0  180   35
1   30  185
early stop counter: 1
val acc:0.8470497131347656, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.8627907037734985 / 0.8976744413375854
after epoch: 29,now: 2024-07-26 05:19:26.783056,epoch time: 0:01:22.416750,used: 0:40:17.830738,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98079425, 'precision': 0.9814263, 'recall': 0.9805918, 'specificity': 0.9805918, 'f1': 0.9807789, 'auroc': 0.99965405, 'binary_precision': 0.966937, 'binary_recall': 0.99614394, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.98132324}
confusion matrix:
      0     1
0  1463    53
1     6  1550
---- Validation: 
scalar performance:
{'acc': 0.8835404, 'precision': 0.8836616, 'recall': 0.8836913, 'specificity': 0.8836913, 'f1': 0.88354003, 'auroc': 0.93308896, 'binary_precision': 0.8725038, 'binary_recall': 0.8944882, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.88335925}
confusion matrix:
     0    1
0  570   83
1   67  568
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8604651, 'precision': 0.86427927, 'recall': 0.8604651, 'specificity': 0.8604651, 'f1': 0.86009884, 'auroc': 0.9230287, 'binary_precision': 0.9015544, 'binary_recall': 0.80930233, 'binary_specificity': 0.9116279, 'binary_f1_score': 0.85294116}
confusion matrix:
     0    1
0  196   19
1   41  174
early stop counter: 2
val acc:0.8835403919219971, best validation acc: 0.8928571343421936, corresponding to test acc:                         0.8627907037734985 / 0.8976744413375854
after epoch: 30,now: 2024-07-26 05:20:49.059149,epoch time: 0:01:22.276093,used: 0:41:40.106831,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_04_39_08_seed_0_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:40.106831 at 2024-07-26 05:20:49.059149
persisted model performance metric: 

scalar performance:
{'acc': 0.8627907, 'precision': 0.86298704, 'recall': 0.8627907, 'specificity': 0.8627907, 'f1': 0.8627721, 'auroc': 0.93378043, 'binary_precision': 0.87142855, 'binary_recall': 0.8511628, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8611764}
confusion matrix:
     0    1
0  188   27
1   32  183
oracle model performance metric: 

scalar performance:
{'acc': 0.89767444, 'precision': 0.90668344, 'recall': 0.89767444, 'specificity': 0.89767444, 'f1': 0.8971046, 'auroc': 0.94487834, 'binary_precision': 0.9672131, 'binary_recall': 0.82325584, 'binary_specificity': 0.97209305, 'binary_f1_score': 0.8894472}
confusion matrix:
     0    1
0  209    6
1   38  177
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455454 KiB |  13219 MiB |  73816 GiB |  73816 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  72949 GiB |  72949 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455454 KiB |  13219 MiB |  73816 GiB |  73816 GiB |
|       from large pool | 414861 KiB |  13181 MiB |  72949 GiB |  72949 GiB |
|       from small pool |  40592 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool | 407075 KiB |  13175 MiB |  72474 GiB |  72473 GiB |
|       from small pool |  40405 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14480 MiB |  14480 MiB |  14480 MiB |      0 B   |
|       from large pool |  14414 MiB |  14414 MiB |  14414 MiB |      0 B   |
|       from small pool |     66 MiB |     66 MiB |     66 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445666 KiB |   1252 MiB |  52543 GiB |  52543 GiB |
|       from large pool | 435058 KiB |   1243 MiB |  51673 GiB |  51672 GiB |
|       from small pool |  10607 KiB |     17 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2594    |   12911 K  |   12910 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6348 K  |    6347 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2594    |   12911 K  |   12910 K  |
|       from large pool |     187    |    1413    |    6562 K  |    6562 K  |
|       from small pool |    1111    |    1407    |    6348 K  |    6347 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     634    |     634    |       0    |
|       from large pool |     601    |     601    |     601    |       0    |
|       from small pool |      33    |      33    |      33    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      91    |     649    |    8569 K  |    8569 K  |
|       from large pool |      37    |     600    |    4906 K  |    4906 K  |
|       from small pool |      54    |     234    |    3663 K  |    3663 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73816 GiB |  73816 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72949 GiB |  72949 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73816 GiB |  73816 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72949 GiB |  72949 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72474 GiB |  72474 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  14480 MiB |  13600 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  52543 GiB |  52543 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  51673 GiB |  51673 GiB |
|       from small pool |      0 KiB |     39 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6348 K  |    6348 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6348 K  |    6348 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     649    |    8570 K  |    8570 K  |
|       from large pool |       4    |     600    |    4906 K  |    4906 K  |
|       from small pool |       0    |     234    |    3663 K  |    3663 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB |  73816 GiB |  73816 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72949 GiB |  72949 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB |  73816 GiB |  73816 GiB |
|       from large pool |  16640 KiB |  13181 MiB |  72949 GiB |  72949 GiB |
|       from small pool |      0 KiB |     56 MiB |    867 GiB |    867 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB |  73339 GiB |  73339 GiB |
|       from large pool |  16640 KiB |  13175 MiB |  72474 GiB |  72474 GiB |
|       from small pool |      0 KiB |     56 MiB |    865 GiB |    865 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  14480 MiB |  13600 MiB |
|       from large pool |    830 MiB |  14414 MiB |  14414 MiB |  13584 MiB |
|       from small pool |     50 MiB |     66 MiB |     66 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB |  52543 GiB |  52543 GiB |
|       from large pool |  24320 KiB |   1243 MiB |  51673 GiB |  51673 GiB |
|       from small pool |      0 KiB |     39 MiB |    870 GiB |    870 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6348 K  |    6348 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2594    |   12911 K  |   12911 K  |
|       from large pool |       2    |    1413    |    6562 K  |    6562 K  |
|       from small pool |       0    |    1407    |    6348 K  |    6348 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     634    |     634    |     572    |
|       from large pool |      37    |     601    |     601    |     564    |
|       from small pool |      25    |      33    |      33    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     649    |    8570 K  |    8570 K  |
|       from large pool |       4    |     600    |    4906 K  |    4906 K  |
|       from small pool |       0    |     234    |    3663 K  |    3663 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529

 Experiment start at: 2024-07-26 05:21:22.730421
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9472656, 'precision': 0.94815046, 'recall': 0.9475874, 'specificity': 0.9475874, 'f1': 0.94725764, 'auroc': 0.9870982, 'binary_precision': 0.97158325, 'binary_recall': 0.92287916, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9466052}
confusion matrix:
      0     1
0  1474    42
1   120  1436
---- Validation: 
scalar performance:
{'acc': 0.8071819, 'precision': 0.82688916, 'recall': 0.8051459, 'specificity': 0.8051459, 'f1': 0.8034721, 'auroc': 0.898698, 'binary_precision': 0.9031579, 'binary_recall': 0.68095237, 'binary_specificity': 0.92933947, 'binary_f1_score': 0.7764706}
confusion matrix:
     0    1
0  605   46
1  201  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8706944, 'recall': 0.85777783, 'specificity': 0.85777783, 'f1': 0.8565279, 'auroc': 0.9187753, 'binary_precision': 0.9398907, 'binary_recall': 0.7644445, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8431372}
confusion matrix:
     0    1
0  214   11
1   53  172
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 05:22:50.193866,epoch time: 0:01:27.463445,used: 0:01:27.463445,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.96972656, 'precision': 0.9698868, 'recall': 0.969879, 'specificity': 0.969879, 'f1': 0.96972656, 'auroc': 0.995576, 'binary_precision': 0.98218995, 'binary_recall': 0.95755625, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.96971667}
confusion matrix:
      0     1
0  1490    27
1    66  1489
---- Validation: 
scalar performance:
{'acc': 0.8290398, 'precision': 0.835872, 'recall': 0.82785463, 'specificity': 0.82785463, 'f1': 0.8277699, 'auroc': 0.9046595, 'binary_precision': 0.8798521, 'binary_recall': 0.75555557, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.81298035}
confusion matrix:
     0    1
0  586   65
1  154  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84132147, 'recall': 0.84000003, 'specificity': 0.84000003, 'f1': 0.839845, 'auroc': 0.9097086, 'binary_precision': 0.86255926, 'binary_recall': 0.8088889, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.8348624}
confusion matrix:
     0    1
0  196   29
1   43  182
better model found
persisted
after epoch: 2,now: 2024-07-26 05:24:14.419141,epoch time: 0:01:24.225275,used: 0:02:51.688720,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9742839, 'precision': 0.97433126, 'recall': 0.974239, 'specificity': 0.974239, 'f1': 0.9742768, 'auroc': 0.99615955, 'binary_precision': 0.97190297, 'binary_recall': 0.9775209, 'binary_specificity': 0.9709571, 'binary_f1_score': 0.97470385}
confusion matrix:
      0     1
0  1471    44
1    35  1522
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.80627507, 'recall': 0.8024322, 'specificity': 0.8024322, 'f1': 0.80244935, 'auroc': 0.8822178, 'binary_precision': 0.8327465, 'binary_recall': 0.75079364, 'binary_specificity': 0.85407066, 'binary_f1_score': 0.78964937}
confusion matrix:
     0    1
0  556   95
1  157  473
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82445085, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.8244436, 'auroc': 0.9211457, 'binary_precision': 0.82589287, 'binary_recall': 0.82222223, 'binary_specificity': 0.82666665, 'binary_f1_score': 0.82405347}
confusion matrix:
     0    1
0  186   39
1   40  185
early stop counter: 1
val acc:0.8032786846160889, best validation acc: 0.8290398120880127, corresponding to test acc:                         0.8399999737739563 / 0.8577777743339539
after epoch: 3,now: 2024-07-26 05:25:38.329932,epoch time: 0:01:23.910791,used: 0:04:15.599511,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95394146, 'recall': 0.94993246, 'specificity': 0.94993246, 'f1': 0.9503724, 'auroc': 0.99644613, 'binary_precision': 0.9179548, 'binary_recall': 0.9910141, 'binary_specificity': 0.9088507, 'binary_f1_score': 0.95308644}
confusion matrix:
      0     1
0  1376   138
1    14  1544
---- Validation: 
scalar performance:
{'acc': 0.85323966, 'precision': 0.8535695, 'recall': 0.8535074, 'specificity': 0.8535074, 'f1': 0.8532388, 'auroc': 0.9117719, 'binary_precision': 0.8379205, 'binary_recall': 0.8698413, 'binary_specificity': 0.8371736, 'binary_f1_score': 0.85358256}
confusion matrix:
     0    1
0  545  106
1   82  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.83896434, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.83263826, 'auroc': 0.9142518, 'binary_precision': 0.79527557, 'binary_recall': 0.8977778, 'binary_specificity': 0.7688889, 'binary_f1_score': 0.8434238}
confusion matrix:
     0    1
0  173   52
1   23  202
better model found
persisted
after epoch: 4,now: 2024-07-26 05:27:03.101589,epoch time: 0:01:24.771657,used: 0:05:40.371168,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97204787, 'recall': 0.9718888, 'specificity': 0.9718888, 'f1': 0.971679, 'auroc': 0.997175, 'binary_precision': 0.98868173, 'binary_recall': 0.95498395, 'binary_specificity': 0.9887937, 'binary_f1_score': 0.9715407}
confusion matrix:
      0     1
0  1500    17
1    70  1485
---- Validation: 
scalar performance:
{'acc': 0.7681499, 'precision': 0.8159152, 'recall': 0.7649258, 'specificity': 0.7649258, 'f1': 0.7575375, 'auroc': 0.90921175, 'binary_precision': 0.9347258, 'binary_recall': 0.568254, 'binary_specificity': 0.96159756, 'binary_f1_score': 0.7068115}
confusion matrix:
     0    1
0  626   25
1  272  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.8187709, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7622236, 'auroc': 0.9131259, 'binary_precision': 0.942029, 'binary_recall': 0.5777778, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.71625346}
confusion matrix:
     0    1
0  217    8
1   95  130
early stop counter: 1
val acc:0.7681499123573303, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 5,now: 2024-07-26 05:28:28.175881,epoch time: 0:01:25.074292,used: 0:07:05.445460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9822351, 'recall': 0.98224264, 'specificity': 0.98224264, 'f1': 0.9820963, 'auroc': 0.99870574, 'binary_precision': 0.9940711, 'binary_recall': 0.97041804, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.98210216}
confusion matrix:
      0     1
0  1508     9
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.6580796, 'precision': 0.75598776, 'recall': 0.6529186, 'specificity': 0.6529186, 'f1': 0.6175525, 'auroc': 0.8810469, 'binary_precision': 0.9102564, 'binary_recall': 0.33809525, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.49305558}
confusion matrix:
     0    1
0  630   21
1  417  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.8467016, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.82666254, 'auroc': 0.90629137, 'binary_precision': 0.92528737, 'binary_recall': 0.71555555, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.80701756}
confusion matrix:
     0    1
0  212   13
1   64  161
early stop counter: 2
val acc:0.6580796241760254, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 6,now: 2024-07-26 05:29:52.168726,epoch time: 0:01:23.992845,used: 0:08:29.438305,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9804567, 'recall': 0.9800085, 'specificity': 0.9800085, 'f1': 0.9801326, 'auroc': 0.9988571, 'binary_precision': 0.9710145, 'binary_recall': 0.9903599, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9805918}
confusion matrix:
      0     1
0  1470    46
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8017174, 'precision': 0.80889475, 'recall': 0.8004352, 'specificity': 0.8004352, 'f1': 0.8000494, 'auroc': 0.87563944, 'binary_precision': 0.8520599, 'binary_recall': 0.7222222, 'binary_specificity': 0.8786482, 'binary_f1_score': 0.7817869}
confusion matrix:
     0    1
0  572   79
1  175  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.806, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.8016099, 'auroc': 0.89677036, 'binary_precision': 0.772, 'binary_recall': 0.8577778, 'binary_specificity': 0.74666667, 'binary_f1_score': 0.81263155}
confusion matrix:
     0    1
0  168   57
1   32  193
early stop counter: 3
val acc:0.8017174005508423, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 7,now: 2024-07-26 05:31:16.575615,epoch time: 0:01:24.406889,used: 0:09:53.845194,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976888, 'precision': 0.97742623, 'recall': 0.97711754, 'specificity': 0.97711754, 'f1': 0.9768865, 'auroc': 0.9977143, 'binary_precision': 0.99665105, 'binary_recall': 0.95752895, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.9766984}
confusion matrix:
      0     1
0  1513     5
1    66  1488
---- Validation: 
scalar performance:
{'acc': 0.8306011, 'precision': 0.8394615, 'recall': 0.8292627, 'specificity': 0.8292627, 'f1': 0.82905054, 'auroc': 0.9009094, 'binary_precision': 0.89035916, 'binary_recall': 0.74761903, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.81276965}
confusion matrix:
     0    1
0  593   58
1  159  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82222223, 'precision': 0.8224515, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.82219064, 'auroc': 0.88189626, 'binary_precision': 0.8138528, 'binary_recall': 0.83555555, 'binary_specificity': 0.8088889, 'binary_f1_score': 0.82456136}
confusion matrix:
     0    1
0  182   43
1   37  188
early stop counter: 4
val acc:0.8306010961532593, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8577777743339539
after epoch: 8,now: 2024-07-26 05:32:40.239311,epoch time: 0:01:23.663696,used: 0:11:17.508890,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.98372394, 'precision': 0.9837442, 'recall': 0.98382294, 'specificity': 0.98382294, 'f1': 0.9837235, 'auroc': 0.99892235, 'binary_precision': 0.9915144, 'binary_recall': 0.9762211, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9838083}
confusion matrix:
      0     1
0  1503    13
1    37  1519
---- Validation: 
scalar performance:
{'acc': 0.80796254, 'precision': 0.8302417, 'recall': 0.8058115, 'specificity': 0.8058115, 'f1': 0.8038719, 'auroc': 0.9007169, 'binary_precision': 0.91201717, 'binary_recall': 0.67460316, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.77554744}
confusion matrix:
     0    1
0  610   41
1  205  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8723643, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8588281, 'auroc': 0.92639995, 'binary_precision': 0.9402174, 'binary_recall': 0.7688889, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8459658}
confusion matrix:
     0    1
0  214   11
1   52  173
new oracle model saved
early stop counter: 5
val acc:0.8079625368118286, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8600000143051147
after epoch: 9,now: 2024-07-26 05:34:04.522362,epoch time: 0:01:24.283051,used: 0:12:41.791941,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.976979, 'recall': 0.9765339, 'specificity': 0.9765339, 'f1': 0.97623456, 'auroc': 0.9991492, 'binary_precision': 0.9993266, 'binary_recall': 0.9537275, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9759947}
confusion matrix:
      0     1
0  1515     1
1    72  1484
---- Validation: 
scalar performance:
{'acc': 0.7103825, 'precision': 0.8004271, 'recall': 0.7058372, 'specificity': 0.7058372, 'f1': 0.6840215, 'auroc': 0.90697587, 'binary_precision': 0.9608541, 'binary_recall': 0.42857143, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.59275526}
confusion matrix:
     0    1
0  640   11
1  360  270
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79555553, 'precision': 0.83140266, 'recall': 0.79555553, 'specificity': 0.79555553, 'f1': 0.7898733, 'auroc': 0.8945185, 'binary_precision': 0.9403973, 'binary_recall': 0.6311111, 'binary_specificity': 0.96, 'binary_f1_score': 0.7553191}
confusion matrix:
     0    1
0  216    9
1   83  142
early stop counter: 6
val acc:0.7103825211524963, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8600000143051147
after epoch: 10,now: 2024-07-26 05:35:30.204418,epoch time: 0:01:25.682056,used: 0:14:07.473997,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.9921665, 'recall': 0.99224836, 'specificity': 0.99224836, 'f1': 0.99218684, 'auroc': 0.99918306, 'binary_precision': 0.99675953, 'binary_recall': 0.987797, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.992258}
confusion matrix:
      0     1
0  1510     5
1    19  1538
---- Validation: 
scalar performance:
{'acc': 0.74863386, 'precision': 0.8173921, 'recall': 0.74477726, 'specificity': 0.74477726, 'f1': 0.7322366, 'auroc': 0.9199376, 'binary_precision': 0.96107787, 'binary_recall': 0.5095238, 'binary_specificity': 0.9800307, 'binary_f1_score': 0.6659751}
confusion matrix:
     0    1
0  638   13
1  309  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68666667, 'precision': 0.80187833, 'recall': 0.68666667, 'specificity': 0.68666667, 'f1': 0.6536175, 'auroc': 0.9235556, 'binary_precision': 0.9883721, 'binary_recall': 0.37777779, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.54662377}
confusion matrix:
     0   1
0  224   1
1  140  85
early stop counter: 7
val acc:0.748633861541748, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8600000143051147
after epoch: 11,now: 2024-07-26 05:36:55.607354,epoch time: 0:01:25.402936,used: 0:15:32.876933,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.98858523, 'recall': 0.988643, 'specificity': 0.988643, 'f1': 0.9886056, 'auroc': 0.9993293, 'binary_precision': 0.99159664, 'binary_recall': 0.9858612, 'binary_specificity': 0.9914248, 'binary_f1_score': 0.9887206}
confusion matrix:
      0     1
0  1503    13
1    22  1534
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.82142854, 'recall': 0.7857911, 'specificity': 0.7857911, 'f1': 0.78177375, 'auroc': 0.8893156, 'binary_precision': 0.9203747, 'binary_recall': 0.6238095, 'binary_specificity': 0.9477727, 'binary_f1_score': 0.74361396}
confusion matrix:
     0    1
0  617   34
1  237  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81333333, 'precision': 0.8513367, 'recall': 0.81333333, 'specificity': 0.81333333, 'f1': 0.80814517, 'auroc': 0.926005, 'binary_precision': 0.9668874, 'binary_recall': 0.6488889, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.7765957}
confusion matrix:
     0    1
0  220    5
1   79  146
early stop counter: 8
val acc:0.7884465456008911, best validation acc: 0.8532396554946899, corresponding to test acc:                         0.8333333134651184 / 0.8600000143051147
after epoch: 12,now: 2024-07-26 05:38:19.874724,epoch time: 0:01:24.267370,used: 0:16:57.144303,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9899089, 'precision': 0.9899025, 'recall': 0.98991144, 'specificity': 0.98991144, 'f1': 0.98990685, 'auroc': 0.99957263, 'binary_precision': 0.9903661, 'binary_recall': 0.9897304, 'binary_specificity': 0.99009246, 'binary_f1_score': 0.9900481}
confusion matrix:
      0     1
0  1499    15
1    16  1542
---- Validation: 
scalar performance:
{'acc': 0.88056207, 'precision': 0.8872951, 'recall': 0.8794931, 'specificity': 0.8794931, 'f1': 0.87979996, 'auroc': 0.92375344, 'binary_precision': 0.93442625, 'binary_recall': 0.8142857, 'binary_specificity': 0.9447005, 'binary_f1_score': 0.870229}
confusion matrix:
     0    1
0  615   36
1  117  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8688889, 'precision': 0.8828727, 'recall': 0.86888885, 'specificity': 0.86888885, 'f1': 0.86768067, 'auroc': 0.9245037, 'binary_precision': 0.95604396, 'binary_recall': 0.7733333, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.85503685}
confusion matrix:
     0    1
0  217    8
1   51  174
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-26 05:39:44.982759,epoch time: 0:01:25.108035,used: 0:18:22.252338,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.9794564, 'recall': 0.9790997, 'specificity': 0.9790997, 'f1': 0.9788395, 'auroc': 0.99934924, 'binary_precision': 1.0, 'binary_recall': 0.9581994, 'binary_specificity': 1.0, 'binary_f1_score': 0.97865355}
confusion matrix:
      0     1
0  1517     0
1    65  1490
---- Validation: 
scalar performance:
{'acc': 0.55347383, 'precision': 0.74279094, 'recall': 0.54610854, 'specificity': 0.54610854, 'f1': 0.43479136, 'auroc': 0.90082407, 'binary_precision': 0.953125, 'binary_recall': 0.0968254, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.17579252}
confusion matrix:
     0   1
0  648   3
1  569  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6066667, 'precision': 0.7609199, 'recall': 0.6066667, 'specificity': 0.6066667, 'f1': 0.53845084, 'auroc': 0.8928642, 'binary_precision': 0.96153843, 'binary_recall': 0.22222222, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.36101085}
confusion matrix:
     0   1
0  223   2
1  175  50
early stop counter: 1
val acc:0.5534738302230835, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 14,now: 2024-07-26 05:41:10.448406,epoch time: 0:01:25.465647,used: 0:19:47.717985,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9485677, 'precision': 0.9528358, 'recall': 0.9491961, 'specificity': 0.9491961, 'f1': 0.9484891, 'auroc': 0.9986286, 'binary_precision': 1.0, 'binary_recall': 0.89839226, 'binary_specificity': 1.0, 'binary_f1_score': 0.946477}
confusion matrix:
      0     1
0  1517     0
1   158  1397
---- Validation: 
scalar performance:
{'acc': 0.5675254, 'precision': 0.7519325, 'recall': 0.5603943, 'specificity': 0.5603943, 'f1': 0.46122533, 'auroc': 0.89683634, 'binary_precision': 0.9634146, 'binary_recall': 0.12539683, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.22191013}
confusion matrix:
     0   1
0  648   3
1  551  79
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53333336, 'precision': 0.7586207, 'recall': 0.53333336, 'specificity': 0.53333336, 'f1': 0.4034091, 'auroc': 0.90214324, 'binary_precision': 1.0, 'binary_recall': 0.06666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.125}
confusion matrix:
     0   1
0  225   0
1  210  15
early stop counter: 2
val acc:0.5675253868103027, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 15,now: 2024-07-26 05:42:34.168548,epoch time: 0:01:23.720142,used: 0:21:11.438127,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.97361344, 'recall': 0.9736731, 'specificity': 0.9736731, 'f1': 0.9736308, 'auroc': 0.9972466, 'binary_precision': 0.9773316, 'binary_recall': 0.97041804, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.9738625}
confusion matrix:
      0     1
0  1482    35
1    46  1509
---- Validation: 
scalar performance:
{'acc': 0.6955503, 'precision': 0.76074713, 'recall': 0.6913723, 'specificity': 0.6913723, 'f1': 0.6723312, 'auroc': 0.85922027, 'binary_precision': 0.88709676, 'binary_recall': 0.43650794, 'binary_specificity': 0.94623655, 'binary_f1_score': 0.58510643}
confusion matrix:
     0    1
0  616   35
1  355  275
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.8133971, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.78733027, 'auroc': 0.8840494, 'binary_precision': 0.8969697, 'binary_recall': 0.6577778, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7589743}
confusion matrix:
     0    1
0  208   17
1   77  148
early stop counter: 3
val acc:0.6955503225326538, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 16,now: 2024-07-26 05:43:59.243766,epoch time: 0:01:25.075218,used: 0:22:36.513345,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.9938185, 'recall': 0.99380946, 'specificity': 0.99380946, 'f1': 0.9938139, 'auroc': 0.999799, 'binary_precision': 0.99358153, 'binary_recall': 0.99421966, 'binary_specificity': 0.9933993, 'binary_f1_score': 0.9939005}
confusion matrix:
      0     1
0  1505    10
1     9  1548
---- Validation: 
scalar performance:
{'acc': 0.8430913, 'precision': 0.85735047, 'recall': 0.841449, 'specificity': 0.841449, 'f1': 0.8410263, 'auroc': 0.9184332, 'binary_precision': 0.9247525, 'binary_recall': 0.7412698, 'binary_specificity': 0.9416283, 'binary_f1_score': 0.82290745}
confusion matrix:
     0    1
0  613   38
1  163  467
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.85648143, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8406285, 'auroc': 0.9163259, 'binary_precision': 0.92777777, 'binary_recall': 0.74222225, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.82469136}
confusion matrix:
     0    1
0  212   13
1   58  167
early stop counter: 4
val acc:0.8430913090705872, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 17,now: 2024-07-26 05:45:25.326805,epoch time: 0:01:26.083039,used: 0:24:02.596384,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9871147, 'recall': 0.9871147, 'specificity': 0.9871147, 'f1': 0.9869792, 'auroc': 0.99957395, 'binary_precision': 0.9986825, 'binary_recall': 0.97554696, 'binary_specificity': 0.9986825, 'binary_f1_score': 0.9869792}
confusion matrix:
      0     1
0  1516     2
1    38  1516
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.8000895, 'recall': 0.6986431, 'specificity': 0.6986431, 'f1': 0.67423606, 'auroc': 0.91611254, 'binary_precision': 0.9664179, 'binary_recall': 0.41111112, 'binary_specificity': 0.9861751, 'binary_f1_score': 0.5768374}
confusion matrix:
     0    1
0  642    9
1  371  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.7770936, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.52014565, 'auroc': 0.9126519, 'binary_precision': 1.0, 'binary_recall': 0.19555555, 'binary_specificity': 1.0, 'binary_f1_score': 0.32713753}
confusion matrix:
     0   1
0  225   0
1  181  44
early stop counter: 5
val acc:0.7033567428588867, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 18,now: 2024-07-26 05:46:50.729396,epoch time: 0:01:25.402591,used: 0:25:27.998975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99183595, 'recall': 0.9919116, 'specificity': 0.9919116, 'f1': 0.99186105, 'auroc': 0.9998796, 'binary_precision': 0.9954751, 'binary_recall': 0.9884467, 'binary_specificity': 0.99537647, 'binary_f1_score': 0.9919485}
confusion matrix:
      0     1
0  1507     7
1    18  1540
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.83425, 'recall': 0.79103947, 'specificity': 0.79103947, 'f1': 0.78634894, 'auroc': 0.9173335, 'binary_precision': 0.94634145, 'binary_recall': 0.61587304, 'binary_specificity': 0.96620584, 'binary_f1_score': 0.7461539}
confusion matrix:
     0    1
0  629   22
1  242  388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.8384366, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.77818406, 'auroc': 0.9302913, 'binary_precision': 0.9708029, 'binary_recall': 0.5911111, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.7348067}
confusion matrix:
     0    1
0  221    4
1   92  133
early stop counter: 6
val acc:0.7939109802246094, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 19,now: 2024-07-26 05:48:14.481778,epoch time: 0:01:23.752382,used: 0:26:51.751357,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9896364, 'recall': 0.9896945, 'specificity': 0.9896945, 'f1': 0.98958325, 'auroc': 0.9997105, 'binary_precision': 0.99869025, 'binary_recall': 0.9807074, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98961717}
confusion matrix:
      0     1
0  1515     2
1    30  1525
---- Validation: 
scalar performance:
{'acc': 0.6814988, 'precision': 0.7860415, 'recall': 0.67647207, 'specificity': 0.67647207, 'f1': 0.6457373, 'auroc': 0.90349644, 'binary_precision': 0.954918, 'binary_recall': 0.36984128, 'binary_specificity': 0.9831029, 'binary_f1_score': 0.53318083}
confusion matrix:
     0    1
0  640   11
1  397  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64444447, 'precision': 0.7922078, 'recall': 0.64444447, 'specificity': 0.64444447, 'f1': 0.5929904, 'auroc': 0.92222714, 'binary_precision': 1.0, 'binary_recall': 0.2888889, 'binary_specificity': 1.0, 'binary_f1_score': 0.44827586}
confusion matrix:
     0   1
0  225   0
1  160  65
early stop counter: 7
val acc:0.6814988255500793, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 20,now: 2024-07-26 05:49:40.299830,epoch time: 0:01:25.818052,used: 0:28:17.569409,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886738, 'recall': 0.9887158, 'specificity': 0.9887158, 'f1': 0.9886067, 'auroc': 0.9993386, 'binary_precision': 0.9980328, 'binary_recall': 0.97940797, 'binary_specificity': 0.9980237, 'binary_f1_score': 0.9886327}
confusion matrix:
      0     1
0  1515     3
1    32  1522
---- Validation: 
scalar performance:
{'acc': 0.6612022, 'precision': 0.7777908, 'recall': 0.65581155, 'specificity': 0.65581155, 'f1': 0.61704195, 'auroc': 0.9189032, 'binary_precision': 0.9537037, 'binary_recall': 0.32698414, 'binary_specificity': 0.984639, 'binary_f1_score': 0.48699766}
confusion matrix:
     0    1
0  641   10
1  424  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.79527557, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.605981, 'auroc': 0.9095704, 'binary_precision': 1.0, 'binary_recall': 0.30666667, 'binary_specificity': 1.0, 'binary_f1_score': 0.46938777}
confusion matrix:
     0   1
0  225   0
1  156  69
early stop counter: 8
val acc:0.6612021923065186, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 21,now: 2024-07-26 05:51:04.340155,epoch time: 0:01:24.040325,used: 0:29:41.609734,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.99054945, 'recall': 0.99057007, 'specificity': 0.99057007, 'f1': 0.99055886, 'auroc': 0.9996575, 'binary_precision': 0.99161834, 'binary_recall': 0.989704, 'binary_specificity': 0.9914361, 'binary_f1_score': 0.9906603}
confusion matrix:
      0     1
0  1505    13
1    16  1538
---- Validation: 
scalar performance:
{'acc': 0.82435596, 'precision': 0.8476448, 'recall': 0.82222223, 'specificity': 0.82222223, 'f1': 0.8206558, 'auroc': 0.9190501, 'binary_precision': 0.93361884, 'binary_recall': 0.6920635, 'binary_specificity': 0.95238096, 'binary_f1_score': 0.7948952}
confusion matrix:
     0    1
0  620   31
1  194  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.8322445, 'recall': 0.79333335, 'specificity': 0.79333335, 'f1': 0.78709984, 'auroc': 0.9004642, 'binary_precision': 0.9459459, 'binary_recall': 0.62222224, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.75067025}
confusion matrix:
     0    1
0  217    8
1   85  140
early stop counter: 9
val acc:0.824355959892273, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 22,now: 2024-07-26 05:52:29.446122,epoch time: 0:01:25.105967,used: 0:31:06.715701,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918577, 'recall': 0.99186456, 'specificity': 0.99186456, 'f1': 0.99186105, 'auroc': 0.99967825, 'binary_precision': 0.992268, 'binary_recall': 0.9916291, 'binary_specificity': 0.99210006, 'binary_f1_score': 0.9919484}
confusion matrix:
      0     1
0  1507    12
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.8633635, 'recall': 0.86129034, 'specificity': 0.86129034, 'f1': 0.8615229, 'auroc': 0.9171312, 'binary_precision': 0.88324875, 'binary_recall': 0.82857144, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.8550369}
confusion matrix:
     0    1
0  582   69
1  108  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8254057, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.81924933, 'auroc': 0.8983308, 'binary_precision': 0.78346455, 'binary_recall': 0.8844444, 'binary_specificity': 0.75555557, 'binary_f1_score': 0.8308977}
confusion matrix:
     0    1
0  170   55
1   26  199
early stop counter: 10
val acc:0.8618267178535461, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 23,now: 2024-07-26 05:53:54.992275,epoch time: 0:01:25.546153,used: 0:32:32.261854,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.9941201, 'recall': 0.9941905, 'specificity': 0.9941905, 'f1': 0.99414015, 'auroc': 0.9997333, 'binary_precision': 0.998057, 'binary_recall': 0.9903599, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.99419355}
confusion matrix:
      0     1
0  1513     3
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.8040593, 'precision': 0.84133846, 'recall': 0.8013313, 'specificity': 0.8013313, 'f1': 0.7975324, 'auroc': 0.9262331, 'binary_precision': 0.9501188, 'binary_recall': 0.63492066, 'binary_specificity': 0.9677419, 'binary_f1_score': 0.76117986}
confusion matrix:
     0    1
0  630   21
1  230  400
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8459488, 'recall': 0.79999995, 'specificity': 0.79999995, 'f1': 0.7931309, 'auroc': 0.92553085, 'binary_precision': 0.97202796, 'binary_recall': 0.61777776, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.75543475}
confusion matrix:
     0    1
0  221    4
1   86  139
early stop counter: 11
val acc:0.8040593266487122, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 24,now: 2024-07-26 05:55:22.550059,epoch time: 0:01:27.557784,used: 0:33:59.819638,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.97233075, 'precision': 0.97342646, 'recall': 0.9726436, 'specificity': 0.9726436, 'f1': 0.97232425, 'auroc': 0.9991174, 'binary_precision': 0.9993202, 'binary_recall': 0.9459459, 'binary_specificity': 0.99934125, 'binary_f1_score': 0.9719008}
confusion matrix:
      0     1
0  1517     1
1    84  1470
---- Validation: 
scalar performance:
{'acc': 0.7673693, 'precision': 0.8222028, 'recall': 0.7639529, 'specificity': 0.7639529, 'f1': 0.75543284, 'auroc': 0.92088723, 'binary_precision': 0.95108694, 'binary_recall': 0.5555556, 'binary_specificity': 0.97235024, 'binary_f1_score': 0.7014028}
confusion matrix:
     0    1
0  633   18
1  280  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.7690977, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.53300995, 'auroc': 0.9490963, 'binary_precision': 0.97959185, 'binary_recall': 0.21333334, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.35036495}
confusion matrix:
     0   1
0  224   1
1  177  48
early stop counter: 12
val acc:0.767369270324707, best validation acc: 0.8805620670318604, corresponding to test acc:                         0.8688889145851135 / 0.8688889145851135
after epoch: 25,now: 2024-07-26 05:56:47.059846,epoch time: 0:01:24.509787,used: 0:35:24.329425,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9890671, 'recall': 0.9888581, 'specificity': 0.9888581, 'f1': 0.9889287, 'auroc': 0.9995192, 'binary_precision': 0.9834711, 'binary_recall': 0.9948553, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.9891305}
confusion matrix:
      0     1
0  1491    26
1     8  1547
---- Validation: 
scalar performance:
{'acc': 0.88212335, 'precision': 0.8870692, 'recall': 0.8812084, 'specificity': 0.8812084, 'f1': 0.88153857, 'auroc': 0.92904687, 'binary_precision': 0.92691624, 'binary_recall': 0.82539684, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.87321573}
confusion matrix:
     0    1
0  610   41
1  110  520
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.8619868, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.84998435, 'auroc': 0.9349333, 'binary_precision': 0.9247312, 'binary_recall': 0.7644445, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.836983}
confusion matrix:
     0    1
0  211   14
1   53  172
better model found
persisted
after epoch: 26,now: 2024-07-26 05:58:12.774982,epoch time: 0:01:25.715136,used: 0:36:50.044561,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.9918647, 'recall': 0.9918574, 'specificity': 0.9918574, 'f1': 0.9918609, 'auroc': 0.99977154, 'binary_precision': 0.9916345, 'binary_recall': 0.99227303, 'binary_specificity': 0.9914417, 'binary_f1_score': 0.9919537}
confusion matrix:
      0     1
0  1506    13
1    12  1541
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.87449336, 'recall': 0.8636457, 'specificity': 0.8636457, 'f1': 0.8637536, 'auroc': 0.9329603, 'binary_precision': 0.93032014, 'binary_recall': 0.784127, 'binary_specificity': 0.94316435, 'binary_f1_score': 0.85099053}
confusion matrix:
     0    1
0  614   37
1  136  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8666667, 'precision': 0.8857143, 'recall': 0.8666667, 'specificity': 0.8666667, 'f1': 0.865, 'auroc': 0.94127405, 'binary_precision': 0.9714286, 'binary_recall': 0.75555557, 'binary_specificity': 0.9777778, 'binary_f1_score': 0.85}
confusion matrix:
     0    1
0  220    5
1   55  170
early stop counter: 1
val acc:0.8649492859840393, best validation acc: 0.8821233510971069, corresponding to test acc:                         0.851111114025116 / 0.8688889145851135
after epoch: 27,now: 2024-07-26 05:59:37.636117,epoch time: 0:01:24.861135,used: 0:38:14.905696,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99088544, 'precision': 0.99096286, 'recall': 0.99083304, 'specificity': 0.99083304, 'f1': 0.99088275, 'auroc': 0.99982363, 'binary_precision': 0.9872449, 'binary_recall': 0.9948586, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9910371}
confusion matrix:
      0     1
0  1496    20
1     8  1548
---- Validation: 
scalar performance:
{'acc': 0.8985168, 'precision': 0.90003014, 'recall': 0.8980287, 'specificity': 0.8980287, 'f1': 0.8983154, 'auroc': 0.93503284, 'binary_precision': 0.92087543, 'binary_recall': 0.86825395, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.8937909}
confusion matrix:
     0    1
0  604   47
1   83  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.88666666, 'precision': 0.8931986, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.886194, 'auroc': 0.94344693, 'binary_precision': 0.9438776, 'binary_recall': 0.82222223, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8788599}
confusion matrix:
     0    1
0  214   11
1   40  185
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-26 06:01:03.771474,epoch time: 0:01:26.135357,used: 0:39:41.041053,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931513, 'recall': 0.9932234, 'specificity': 0.9932234, 'f1': 0.9931637, 'auroc': 0.9999156, 'binary_precision': 0.99805194, 'binary_recall': 0.9884244, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9932148}
confusion matrix:
      0     1
0  1514     3
1    18  1537
---- Validation: 
scalar performance:
{'acc': 0.77907884, 'precision': 0.8280032, 'recall': 0.77588326, 'specificity': 0.77588326, 'f1': 0.7691238, 'auroc': 0.92438555, 'binary_precision': 0.9506493, 'binary_recall': 0.5809524, 'binary_specificity': 0.9708141, 'binary_f1_score': 0.72118235}
confusion matrix:
     0    1
0  632   19
1  264  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63555557, 'precision': 0.76104075, 'recall': 0.63555557, 'specificity': 0.63555557, 'f1': 0.5857749, 'auroc': 0.91500247, 'binary_precision': 0.942029, 'binary_recall': 0.2888889, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.44217688}
confusion matrix:
     0   1
0  221   4
1  160  65
early stop counter: 1
val acc:0.7790788412094116, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8866666555404663 / 0.8866666555404663
after epoch: 29,now: 2024-07-26 06:02:28.730553,epoch time: 0:01:24.959079,used: 0:41:06.000132,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99477446, 'recall': 0.9948214, 'specificity': 0.9948214, 'f1': 0.99479127, 'auroc': 0.9999576, 'binary_precision': 0.9974127, 'binary_recall': 0.992278, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9948387}
confusion matrix:
      0     1
0  1514     4
1    12  1542
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.8541703, 'recall': 0.8333845, 'specificity': 0.8333845, 'f1': 0.8324717, 'auroc': 0.92195094, 'binary_precision': 0.93195873, 'binary_recall': 0.71746033, 'binary_specificity': 0.94930875, 'binary_f1_score': 0.81076235}
confusion matrix:
     0    1
0  618   33
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8155556, 'precision': 0.8275176, 'recall': 0.8155556, 'specificity': 0.8155556, 'f1': 0.81385595, 'auroc': 0.89621735, 'binary_precision': 0.8901099, 'binary_recall': 0.72, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.79606885}
confusion matrix:
     0    1
0  205   20
1   63  162
early stop counter: 2
val acc:0.835284948348999, best validation acc: 0.8985167741775513, corresponding to test acc:                         0.8866666555404663 / 0.8866666555404663
after epoch: 30,now: 2024-07-26 06:03:55.282636,epoch time: 0:01:26.552083,used: 0:42:32.552215,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_05_21_22_seed_1_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:32.552215 at 2024-07-26 06:03:55.282636
persisted model performance metric: 

scalar performance:
{'acc': 0.88666666, 'precision': 0.8931986, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.886194, 'auroc': 0.94344693, 'binary_precision': 0.9438776, 'binary_recall': 0.82222223, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8788599}
confusion matrix:
     0    1
0  214   11
1   40  185
oracle model performance metric: 

scalar performance:
{'acc': 0.88666666, 'precision': 0.8931986, 'recall': 0.88666666, 'specificity': 0.88666666, 'f1': 0.886194, 'auroc': 0.94344693, 'binary_precision': 0.9438776, 'binary_recall': 0.82222223, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.8788599}
confusion matrix:
     0    1
0  214   11
1   40  185
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 149050 GiB | 149050 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 147293 GiB | 147292 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 149050 GiB | 149050 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 147293 GiB | 147292 GiB |
|       from small pool |  40598 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 146769 GiB | 146768 GiB |
|       from small pool |  40406 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14480 MiB |  28078 MiB |  13600 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  27992 MiB |  13584 MiB |
|       from small pool |     70 MiB |     70 MiB |     86 MiB |     16 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 106141 GiB | 106141 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 104374 GiB | 104373 GiB |
|       from small pool |  10601 KiB |     39 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   26108 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12825 K  |   12824 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   26108 K  |   26106 K  |
|       from large pool |     187    |    1413    |   13282 K  |   13282 K  |
|       from small pool |    1123    |    1419    |   12825 K  |   12824 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    1208    |     572    |
|       from large pool |     601    |     601    |    1165    |     564    |
|       from small pool |      35    |      35    |      43    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     651    |   17202 K  |   17201 K  |
|       from large pool |      40    |     604    |    9630 K  |    9630 K  |
|       from small pool |      59    |     234    |    7571 K  |    7570 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149050 GiB | 149050 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147293 GiB | 147293 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149050 GiB | 149050 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147293 GiB | 147293 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146769 GiB | 146769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 106141 GiB | 106141 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 104374 GiB | 104374 GiB |
|       from small pool |      0 KiB |     43 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   17202 K  |   17202 K  |
|       from large pool |       4    |     604    |    9631 K  |    9631 K  |
|       from small pool |       0    |     234    |    7571 K  |    7571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 149050 GiB | 149050 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147293 GiB | 147293 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 149050 GiB | 149050 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 147293 GiB | 147293 GiB |
|       from small pool |      0 KiB |     60 MiB |   1757 GiB |   1757 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 148522 GiB | 148522 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 146769 GiB | 146769 GiB |
|       from small pool |      0 KiB |     60 MiB |   1753 GiB |   1753 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  28078 MiB |  27198 MiB |
|       from large pool |    830 MiB |  14414 MiB |  27992 MiB |  27162 MiB |
|       from small pool |     50 MiB |     70 MiB |     86 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 106141 GiB | 106141 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 104374 GiB | 104374 GiB |
|       from small pool |      0 KiB |     43 MiB |   1767 GiB |   1767 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   26108 K  |   26108 K  |
|       from large pool |       2    |    1413    |   13282 K  |   13282 K  |
|       from small pool |       0    |    1419    |   12825 K  |   12825 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1208    |    1146    |
|       from large pool |      37    |     601    |    1165    |    1128    |
|       from small pool |      25    |      35    |      43    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   17202 K  |   17202 K  |
|       from large pool |       4    |     604    |    9631 K  |    9631 K  |
|       from small pool |       0    |     234    |    7571 K  |    7571 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529

 Experiment start at: 2024-07-26 06:04:29.944431
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.934555, 'precision': 0.93941414, 'recall': 0.93497753, 'specificity': 0.93497753, 'f1': 0.9344134, 'auroc': 0.98756206, 'binary_precision': 0.9876274, 'binary_recall': 0.88116884, 'binary_specificity': 0.9887863, 'binary_f1_score': 0.93136585}
confusion matrix:
      0     1
0  1499    17
1   183  1357
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.8045641, 'recall': 0.8047433, 'specificity': 0.8047433, 'f1': 0.8043699, 'auroc': 0.88564444, 'binary_precision': 0.7879257, 'binary_recall': 0.81832796, 'binary_specificity': 0.79115856, 'binary_f1_score': 0.80283916}
confusion matrix:
     0    1
0  519  137
1  113  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7569444, 'precision': 0.7792128, 'recall': 0.7569444, 'specificity': 0.7569444, 'f1': 0.75199974, 'auroc': 0.9024563, 'binary_precision': 0.700361, 'binary_recall': 0.8981481, 'binary_specificity': 0.6157407, 'binary_f1_score': 0.78701824}
confusion matrix:
     0    1
0  133   83
1   22  194
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 06:05:58.073797,epoch time: 0:01:28.129366,used: 0:01:28.129366,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9728403, 'precision': 0.9728582, 'recall': 0.97288233, 'specificity': 0.97288233, 'f1': 0.97284013, 'auroc': 0.9957129, 'binary_precision': 0.9783322, 'binary_recall': 0.96753246, 'binary_specificity': 0.9782322, 'binary_f1_score': 0.97290236}
confusion matrix:
      0     1
0  1483    33
1    50  1490
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.8082378, 'recall': 0.80582654, 'specificity': 0.80582654, 'f1': 0.80417037, 'auroc': 0.8864647, 'binary_precision': 0.7664756, 'binary_recall': 0.86012864, 'binary_specificity': 0.7515244, 'binary_f1_score': 0.810606}
confusion matrix:
     0    1
0  493  163
1   87  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7106481, 'precision': 0.76386017, 'recall': 0.7106482, 'specificity': 0.7106482, 'f1': 0.69528544, 'auroc': 0.9143304, 'binary_precision': 0.6453674, 'binary_recall': 0.9351852, 'binary_specificity': 0.4861111, 'binary_f1_score': 0.76370513}
confusion matrix:
     0    1
0  105  111
1   14  202
early stop counter: 1
val acc:0.8043818473815918, best validation acc: 0.8043818473815918, corresponding to test acc:                         0.7569444179534912 / 0.7569444179534912
after epoch: 2,now: 2024-07-26 06:07:23.322283,epoch time: 0:01:25.248486,used: 0:02:53.377852,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9816754, 'precision': 0.9816754, 'recall': 0.98170507, 'specificity': 0.98170507, 'f1': 0.98167515, 'auroc': 0.997723, 'binary_precision': 0.9856021, 'binary_recall': 0.9779221, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9817471}
confusion matrix:
      0     1
0  1494    22
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.81924886, 'precision': 0.8197824, 'recall': 0.81980824, 'specificity': 0.81980824, 'f1': 0.81924874, 'auroc': 0.892604, 'binary_precision': 0.7984733, 'binary_recall': 0.840836, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.8191073}
confusion matrix:
     0    1
0  524  132
1   99  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8194444, 'precision': 0.8346206, 'recall': 0.8194444, 'specificity': 0.8194444, 'f1': 0.8173738, 'auroc': 0.93870026, 'binary_precision': 0.7633588, 'binary_recall': 0.9259259, 'binary_specificity': 0.712963, 'binary_f1_score': 0.8368201}
confusion matrix:
     0    1
0  154   62
1   16  200
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 06:08:47.772993,epoch time: 0:01:24.450710,used: 0:04:17.828562,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9695681, 'precision': 0.9710302, 'recall': 0.96980006, 'specificity': 0.96980006, 'f1': 0.9695535, 'auroc': 0.99843323, 'binary_precision': 0.9993099, 'binary_recall': 0.94025975, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.9688859}
confusion matrix:
      0     1
0  1515     1
1    92  1448
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.756315, 'recall': 0.6414252, 'specificity': 0.6414252, 'f1': 0.601977, 'auroc': 0.8830215, 'binary_precision': 0.9146919, 'binary_recall': 0.31028938, 'binary_specificity': 0.972561, 'binary_f1_score': 0.46338534}
confusion matrix:
     0    1
0  638   18
1  429  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7939815, 'precision': 0.8449091, 'recall': 0.7939815, 'specificity': 0.7939815, 'f1': 0.7860851, 'auroc': 0.9060785, 'binary_precision': 0.97744364, 'binary_recall': 0.6018519, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.7449857}
confusion matrix:
     0    1
0  213    3
1   86  130
early stop counter: 1
val acc:0.6502347588539124, best validation acc: 0.8192488551139832, corresponding to test acc:                         0.8194444179534912 / 0.8194444179534912
after epoch: 4,now: 2024-07-26 06:10:11.342372,epoch time: 0:01:23.569379,used: 0:05:41.397941,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.98269427, 'recall': 0.9826329, 'specificity': 0.9826329, 'f1': 0.98265505, 'auroc': 0.9986541, 'binary_precision': 0.9799871, 'binary_recall': 0.98571426, 'binary_specificity': 0.97955143, 'binary_f1_score': 0.9828423}
confusion matrix:
      0     1
0  1485    31
1    22  1518
---- Validation: 
scalar performance:
{'acc': 0.8262911, 'precision': 0.83544755, 'recall': 0.8240432, 'specificity': 0.8240432, 'f1': 0.82430136, 'auroc': 0.8843179, 'binary_precision': 0.88461536, 'binary_recall': 0.7395498, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.80560416}
confusion matrix:
     0    1
0  596   60
1  162  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8425926, 'precision': 0.8502805, 'recall': 0.8425926, 'specificity': 0.8425926, 'f1': 0.84172416, 'auroc': 0.9114369, 'binary_precision': 0.90217394, 'binary_recall': 0.7685185, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.83000004}
confusion matrix:
     0    1
0  198   18
1   50  166
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 06:11:34.448283,epoch time: 0:01:23.105911,used: 0:07:04.503852,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9861237, 'recall': 0.98602355, 'specificity': 0.98602355, 'f1': 0.98592913, 'auroc': 0.99844474, 'binary_precision': 0.998004, 'binary_recall': 0.97402596, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.9858693}
confusion matrix:
      0     1
0  1513     3
1    40  1500
---- Validation: 
scalar performance:
{'acc': 0.69092333, 'precision': 0.77856356, 'recall': 0.6832675, 'specificity': 0.6832675, 'f1': 0.659005, 'auroc': 0.8633146, 'binary_precision': 0.9283019, 'binary_recall': 0.3954984, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.5546787}
confusion matrix:
     0    1
0  637   19
1  376  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847222, 'precision': 0.8237552, 'recall': 0.7847222, 'specificity': 0.7847222, 'f1': 0.77803195, 'auroc': 0.88852453, 'binary_precision': 0.9361702, 'binary_recall': 0.6111111, 'binary_specificity': 0.9583333, 'binary_f1_score': 0.7394959}
confusion matrix:
     0    1
0  207    9
1   84  132
early stop counter: 1
val acc:0.6909233331680298, best validation acc: 0.8262910842895508, corresponding to test acc:                         0.8425925970077515 / 0.8425925970077515
after epoch: 6,now: 2024-07-26 06:12:58.550356,epoch time: 0:01:24.102073,used: 0:08:28.605925,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9842932, 'precision': 0.9842932, 'recall': 0.984323, 'specificity': 0.984323, 'f1': 0.9842929, 'auroc': 0.9985707, 'binary_precision': 0.9882199, 'binary_recall': 0.9805195, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.9843546}
confusion matrix:
      0     1
0  1498    18
1    30  1510
---- Validation: 
scalar performance:
{'acc': 0.8364632, 'precision': 0.8416296, 'recall': 0.834785, 'specificity': 0.834785, 'f1': 0.8352649, 'auroc': 0.8881166, 'binary_precision': 0.8775137, 'binary_recall': 0.7717042, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.82121474}
confusion matrix:
     0    1
0  589   67
1  142  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.8080541, 'recall': 0.8032407, 'specificity': 0.8032407, 'f1': 0.8024692, 'auroc': 0.89969134, 'binary_precision': 0.76954734, 'binary_recall': 0.8657407, 'binary_specificity': 0.7407407, 'binary_f1_score': 0.81481487}
confusion matrix:
     0    1
0  160   56
1   29  187
better model found
persisted
after epoch: 7,now: 2024-07-26 06:14:21.739486,epoch time: 0:01:23.189130,used: 0:09:51.795055,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.9734541, 'recall': 0.9724026, 'specificity': 0.9724026, 'f1': 0.97217476, 'auroc': 0.9985578, 'binary_precision': 1.0, 'binary_recall': 0.9448052, 'binary_specificity': 1.0, 'binary_f1_score': 0.9716194}
confusion matrix:
      0     1
0  1516     0
1    85  1455
---- Validation: 
scalar performance:
{'acc': 0.74178404, 'precision': 0.80718255, 'recall': 0.73551834, 'specificity': 0.73551834, 'f1': 0.7238128, 'auroc': 0.8705764, 'binary_precision': 0.94242424, 'binary_recall': 0.5, 'binary_specificity': 0.9710366, 'binary_f1_score': 0.6533613}
confusion matrix:
     0    1
0  637   19
1  311  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6828704, 'precision': 0.7706252, 'recall': 0.6828704, 'specificity': 0.6828704, 'f1': 0.65489376, 'auroc': 0.8791795, 'binary_precision': 0.9247312, 'binary_recall': 0.39814815, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.5566343}
confusion matrix:
     0   1
0  209   7
1  130  86
early stop counter: 1
val acc:0.7417840361595154, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 8,now: 2024-07-26 06:15:44.740501,epoch time: 0:01:23.001015,used: 0:11:14.796070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9882258, 'recall': 0.98825514, 'specificity': 0.98825514, 'f1': 0.98821974, 'auroc': 0.99912703, 'binary_precision': 0.9927916, 'binary_recall': 0.98376626, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.9882583}
confusion matrix:
      0     1
0  1505    11
1    25  1515
---- Validation: 
scalar performance:
{'acc': 0.7777778, 'precision': 0.7979125, 'recall': 0.774204, 'specificity': 0.774204, 'f1': 0.7723125, 'auroc': 0.8686549, 'binary_precision': 0.8689956, 'binary_recall': 0.63987136, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.737037}
confusion matrix:
     0    1
0  596   60
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8428571, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8321678, 'auroc': 0.9050497, 'binary_precision': 0.9, 'binary_recall': 0.75, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.81818175}
confusion matrix:
     0    1
0  198   18
1   54  162
early stop counter: 2
val acc:0.7777777910232544, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 9,now: 2024-07-26 06:17:09.819542,epoch time: 0:01:25.079041,used: 0:12:39.875111,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9872382, 'precision': 0.9872917, 'recall': 0.9872966, 'specificity': 0.9872966, 'f1': 0.98723817, 'auroc': 0.999501, 'binary_precision': 0.9947264, 'binary_recall': 0.97987014, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9872424}
confusion matrix:
      0     1
0  1508     8
1    31  1509
---- Validation: 
scalar performance:
{'acc': 0.80359936, 'precision': 0.8240011, 'recall': 0.80018973, 'specificity': 0.80018973, 'f1': 0.7991123, 'auroc': 0.8930042, 'binary_precision': 0.8989247, 'binary_recall': 0.67202574, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.76908916}
confusion matrix:
     0    1
0  609   47
1  204  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8101852, 'precision': 0.8162864, 'recall': 0.8101852, 'specificity': 0.8101852, 'f1': 0.8092654, 'auroc': 0.8818587, 'binary_precision': 0.86021507, 'binary_recall': 0.7407407, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.7960199}
confusion matrix:
     0    1
0  190   26
1   56  160
early stop counter: 3
val acc:0.8035993576049805, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 10,now: 2024-07-26 06:18:35.107293,epoch time: 0:01:25.287751,used: 0:14:05.162862,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98756546, 'precision': 0.98767936, 'recall': 0.9876418, 'specificity': 0.9876418, 'f1': 0.9875654, 'auroc': 0.99941534, 'binary_precision': 0.997351, 'binary_recall': 0.9779221, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.98754096}
confusion matrix:
      0     1
0  1512     4
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.8439846, 'recall': 0.8056206, 'specificity': 0.8056206, 'f1': 0.80343723, 'auroc': 0.90753484, 'binary_precision': 0.9458824, 'binary_recall': 0.6463022, 'binary_specificity': 0.964939, 'binary_f1_score': 0.7679083}
confusion matrix:
     0    1
0  633   23
1  220  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8078704, 'precision': 0.8326925, 'recall': 0.8078704, 'specificity': 0.8078704, 'f1': 0.80421853, 'auroc': 0.89328265, 'binary_precision': 0.9235669, 'binary_recall': 0.6712963, 'binary_specificity': 0.9444444, 'binary_f1_score': 0.7774799}
confusion matrix:
     0    1
0  204   12
1   71  145
early stop counter: 4
val acc:0.8098591566085815, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8425925970077515
after epoch: 11,now: 2024-07-26 06:19:57.975798,epoch time: 0:01:22.868505,used: 0:15:28.031367,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908298, 'recall': 0.9908526, 'specificity': 0.9908526, 'f1': 0.9908374, 'auroc': 0.99935365, 'binary_precision': 0.9928292, 'binary_recall': 0.98896104, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99089134}
confusion matrix:
      0     1
0  1505    11
1    17  1523
---- Validation: 
scalar performance:
{'acc': 0.80438185, 'precision': 0.8374413, 'recall': 0.8001603, 'specificity': 0.8001603, 'f1': 0.7978339, 'auroc': 0.90819836, 'binary_precision': 0.9366197, 'binary_recall': 0.6414791, 'binary_specificity': 0.95884144, 'binary_f1_score': 0.76145035}
confusion matrix:
     0    1
0  629   27
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8541667, 'precision': 0.8674041, 'recall': 0.8541667, 'specificity': 0.8541667, 'f1': 0.85284114, 'auroc': 0.92271096, 'binary_precision': 0.93714285, 'binary_recall': 0.7592593, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.8388747}
confusion matrix:
     0    1
0  205   11
1   52  164
new oracle model saved
early stop counter: 5
val acc:0.8043818473815918, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 12,now: 2024-07-26 06:21:23.632679,epoch time: 0:01:25.656881,used: 0:16:53.688248,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9911745, 'recall': 0.99120295, 'specificity': 0.99120295, 'f1': 0.9911648, 'auroc': 0.9993515, 'binary_precision': 0.99606556, 'binary_recall': 0.98636365, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.99119085}
confusion matrix:
      0     1
0  1510     6
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.7824726, 'precision': 0.80301684, 'recall': 0.7789022, 'specificity': 0.7789022, 'f1': 0.77712286, 'auroc': 0.8501196, 'binary_precision': 0.87554586, 'binary_recall': 0.6446945, 'binary_specificity': 0.9131098, 'binary_f1_score': 0.74259263}
confusion matrix:
     0    1
0  599   57
1  221  401
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8408135, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8324138, 'auroc': 0.92712617, 'binary_precision': 0.8913044, 'binary_recall': 0.7592593, 'binary_specificity': 0.9074074, 'binary_f1_score': 0.82}
confusion matrix:
     0    1
0  196   20
1   52  164
early stop counter: 6
val acc:0.7824726104736328, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 13,now: 2024-07-26 06:22:46.726024,epoch time: 0:01:23.093345,used: 0:18:16.781593,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.9858664, 'recall': 0.98570913, 'specificity': 0.98570913, 'f1': 0.9856016, 'auroc': 0.9996171, 'binary_precision': 0.9993324, 'binary_recall': 0.9720779, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98551685}
confusion matrix:
      0     1
0  1515     1
1    43  1497
---- Validation: 
scalar performance:
{'acc': 0.7237872, 'precision': 0.77611727, 'recall': 0.7178211, 'specificity': 0.7178211, 'f1': 0.7064006, 'auroc': 0.8230654, 'binary_precision': 0.8898551, 'binary_recall': 0.49356914, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.63495344}
confusion matrix:
     0    1
0  618   38
1  315  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7291667, 'precision': 0.7735436, 'recall': 0.7291667, 'specificity': 0.7291667, 'f1': 0.717718, 'auroc': 0.81670094, 'binary_precision': 0.88372093, 'binary_recall': 0.5277778, 'binary_specificity': 0.9305556, 'binary_f1_score': 0.66086954}
confusion matrix:
     0    1
0  201   15
1  102  114
early stop counter: 7
val acc:0.7237871885299683, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 14,now: 2024-07-26 06:24:09.952799,epoch time: 0:01:23.226775,used: 0:19:40.008368,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921696, 'recall': 0.9921924, 'specificity': 0.9921924, 'f1': 0.9921466, 'auroc': 0.9994881, 'binary_precision': 0.99802893, 'binary_recall': 0.98636365, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.992162}
confusion matrix:
      0     1
0  1513     3
1    21  1519
---- Validation: 
scalar performance:
{'acc': 0.7793427, 'precision': 0.81427836, 'recall': 0.77481174, 'specificity': 0.77481174, 'f1': 0.77099514, 'auroc': 0.8816931, 'binary_precision': 0.9126214, 'binary_recall': 0.6045016, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  620   36
1  246  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7060185, 'precision': 0.7378325, 'recall': 0.7060185, 'specificity': 0.7060185, 'f1': 0.69584715, 'auroc': 0.8079132, 'binary_precision': 0.82481754, 'binary_recall': 0.5231481, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.6402266}
confusion matrix:
     0    1
0  192   24
1  103  113
early stop counter: 8
val acc:0.7793427109718323, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 15,now: 2024-07-26 06:25:33.593897,epoch time: 0:01:23.641098,used: 0:21:03.649466,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9937827, 'precision': 0.99378, 'recall': 0.9937849, 'specificity': 0.9937849, 'f1': 0.9937824, 'auroc': 0.99971986, 'binary_precision': 0.99415207, 'binary_recall': 0.9935065, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.9938292}
confusion matrix:
      0     1
0  1507     9
1    10  1530
---- Validation: 
scalar performance:
{'acc': 0.76447576, 'precision': 0.8095708, 'recall': 0.7592885, 'specificity': 0.7592885, 'f1': 0.7530409, 'auroc': 0.8794506, 'binary_precision': 0.9212598, 'binary_recall': 0.5643087, 'binary_specificity': 0.9542683, 'binary_f1_score': 0.6999003}
confusion matrix:
     0    1
0  626   30
1  271  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7407407, 'precision': 0.7860927, 'recall': 0.7407408, 'specificity': 0.7407408, 'f1': 0.7300422, 'auroc': 0.8630401, 'binary_precision': 0.9, 'binary_recall': 0.5416667, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.67630064}
confusion matrix:
     0    1
0  203   13
1   99  117
early stop counter: 9
val acc:0.7644757628440857, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 16,now: 2024-07-26 06:26:57.052749,epoch time: 0:01:23.458852,used: 0:22:27.108318,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.9931557, 'recall': 0.9931098, 'specificity': 0.9931098, 'f1': 0.9931276, 'auroc': 0.9997721, 'binary_precision': 0.9909502, 'binary_recall': 0.99545455, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.99319726}
confusion matrix:
      0     1
0  1502    14
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.773083, 'precision': 0.8009242, 'recall': 0.76892257, 'specificity': 0.76892257, 'f1': 0.7657577, 'auroc': 0.8653072, 'binary_precision': 0.8860465, 'binary_recall': 0.6125402, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.7243346}
confusion matrix:
     0    1
0  607   49
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7384259, 'precision': 0.7411603, 'recall': 0.73842597, 'specificity': 0.73842597, 'f1': 0.73768234, 'auroc': 0.84122086, 'binary_precision': 0.7668394, 'binary_recall': 0.6851852, 'binary_specificity': 0.7916667, 'binary_f1_score': 0.7237164}
confusion matrix:
     0    1
0  171   45
1   68  148
early stop counter: 10
val acc:0.773082971572876, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 17,now: 2024-07-26 06:28:20.279338,epoch time: 0:01:23.226589,used: 0:23:50.334907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9921466, 'precision': 0.9921526, 'recall': 0.9921821, 'specificity': 0.9921821, 'f1': 0.9921465, 'auroc': 0.9995122, 'binary_precision': 0.9967235, 'binary_recall': 0.9876623, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99217224}
confusion matrix:
      0     1
0  1511     5
1    19  1521
---- Validation: 
scalar performance:
{'acc': 0.7769953, 'precision': 0.815858, 'recall': 0.77223355, 'specificity': 0.77223355, 'f1': 0.76774883, 'auroc': 0.9051086, 'binary_precision': 0.9201995, 'binary_recall': 0.5932476, 'binary_specificity': 0.9512195, 'binary_f1_score': 0.72140765}
confusion matrix:
     0    1
0  624   32
1  253  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6967593, 'precision': 0.75764084, 'recall': 0.6967592, 'specificity': 0.6967592, 'f1': 0.67772025, 'auroc': 0.8735639, 'binary_precision': 0.8828829, 'binary_recall': 0.4537037, 'binary_specificity': 0.9398148, 'binary_f1_score': 0.59938836}
confusion matrix:
     0   1
0  203  13
1  118  98
early stop counter: 11
val acc:0.7769953012466431, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 18,now: 2024-07-26 06:29:44.012135,epoch time: 0:01:23.732797,used: 0:25:14.067704,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98857534, 'recall': 0.98859525, 'specificity': 0.98859525, 'f1': 0.9885471, 'auroc': 0.9997276, 'binary_precision': 0.9947403, 'binary_recall': 0.98246753, 'binary_specificity': 0.99472296, 'binary_f1_score': 0.9885658}
confusion matrix:
      0     1
0  1508     8
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.7370892, 'precision': 0.8159647, 'recall': 0.7303202, 'specificity': 0.7303202, 'f1': 0.71577144, 'auroc': 0.9160446, 'binary_precision': 0.96732026, 'binary_recall': 0.47588426, 'binary_specificity': 0.9847561, 'binary_f1_score': 0.63793105}
confusion matrix:
     0    1
0  646   10
1  326  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7662037, 'precision': 0.8369963, 'recall': 0.7662037, 'specificity': 0.7662037, 'f1': 0.75324476, 'auroc': 0.94613767, 'binary_precision': 0.991453, 'binary_recall': 0.537037, 'binary_specificity': 0.9953704, 'binary_f1_score': 0.6966967}
confusion matrix:
     0    1
0  215    1
1  100  116
early stop counter: 12
val acc:0.737089216709137, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 19,now: 2024-07-26 06:31:09.076996,epoch time: 0:01:25.064861,used: 0:26:39.132565,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918118, 'recall': 0.99183685, 'specificity': 0.99183685, 'f1': 0.9918191, 'auroc': 0.99976826, 'binary_precision': 0.9941292, 'binary_recall': 0.9896104, 'binary_specificity': 0.9940633, 'binary_f1_score': 0.99186456}
confusion matrix:
      0     1
0  1507     9
1    16  1524
---- Validation: 
scalar performance:
{'acc': 0.7934272, 'precision': 0.82100457, 'recall': 0.7894479, 'specificity': 0.7894479, 'f1': 0.78723633, 'auroc': 0.9016205, 'binary_precision': 0.9086758, 'binary_recall': 0.63987136, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.75094336}
confusion matrix:
     0    1
0  616   40
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8171296, 'precision': 0.8302163, 'recall': 0.8171296, 'specificity': 0.8171296, 'f1': 0.81529975, 'auroc': 0.9114583, 'binary_precision': 0.8959538, 'binary_recall': 0.7175926, 'binary_specificity': 0.9166667, 'binary_f1_score': 0.7969152}
confusion matrix:
     0    1
0  198   18
1   61  155
early stop counter: 13
val acc:0.7934272289276123, best validation acc: 0.836463212966919, corresponding to test acc:                         0.8032407164573669 / 0.8541666865348816
after epoch: 20,now: 2024-07-26 06:32:32.275997,epoch time: 0:01:23.199001,used: 0:28:02.331566,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.99279416, 'recall': 0.9928212, 'specificity': 0.9928212, 'f1': 0.99280083, 'auroc': 0.9997785, 'binary_precision': 0.9954308, 'binary_recall': 0.99025977, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.99283856}
confusion matrix:
      0     1
0  1509     7
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.85289514, 'precision': 0.8655307, 'recall': 0.8504162, 'specificity': 0.8504162, 'f1': 0.85089546, 'auroc': 0.9262754, 'binary_precision': 0.9271653, 'binary_recall': 0.75723475, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.8336283}
confusion matrix:
     0    1
0  619   37
1  151  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8935185, 'precision': 0.89930403, 'recall': 0.8935185, 'specificity': 0.8935185, 'f1': 0.8931315, 'auroc': 0.94911695, 'binary_precision': 0.94736844, 'binary_recall': 0.8333333, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.88669956}
confusion matrix:
     0    1
0  206   10
1   36  180
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-26 06:33:56.063260,epoch time: 0:01:23.787263,used: 0:29:26.118829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9862091, 'recall': 0.9860389, 'specificity': 0.9860389, 'f1': 0.9859288, 'auroc': 0.9996457, 'binary_precision': 1.0, 'binary_recall': 0.9720779, 'binary_specificity': 1.0, 'binary_f1_score': 0.98584133}
confusion matrix:
      0     1
0  1516     0
1    43  1497
---- Validation: 
scalar performance:
{'acc': 0.53051645, 'precision': 0.74033093, 'recall': 0.51772654, 'specificity': 0.51772654, 'f1': 0.37853563, 'auroc': 0.87900215, 'binary_precision': 0.9583333, 'binary_recall': 0.036977492, 'binary_specificity': 0.9984756, 'binary_f1_score': 0.071207434}
confusion matrix:
     0   1
0  655   1
1  599  23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.75116277, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.34353966, 'auroc': 0.8552222, 'binary_precision': 1.0, 'binary_recall': 0.009259259, 'binary_specificity': 1.0, 'binary_f1_score': 0.018348625}
confusion matrix:
     0  1
0  216  0
1  214  2
early stop counter: 1
val acc:0.5305164456367493, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 22,now: 2024-07-26 06:35:21.091854,epoch time: 0:01:25.028594,used: 0:30:51.147423,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.99247384, 'precision': 0.99249196, 'recall': 0.99251705, 'specificity': 0.99251705, 'f1': 0.9924737, 'auroc': 0.999815, 'binary_precision': 0.9980302, 'binary_recall': 0.987013, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.992491}
confusion matrix:
      0     1
0  1513     3
1    20  1520
---- Validation: 
scalar performance:
{'acc': 0.7965571, 'precision': 0.8258239, 'recall': 0.7924967, 'specificity': 0.7924967, 'f1': 0.7902273, 'auroc': 0.88495755, 'binary_precision': 0.9170507, 'binary_recall': 0.63987136, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.7537879}
confusion matrix:
     0    1
0  620   36
1  224  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8333333, 'precision': 0.8522058, 'recall': 0.8333334, 'specificity': 0.8333334, 'f1': 0.8310703, 'auroc': 0.92588305, 'binary_precision': 0.93373495, 'binary_recall': 0.7175926, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.81151825}
confusion matrix:
     0    1
0  205   11
1   61  155
early stop counter: 2
val acc:0.7965571284294128, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 23,now: 2024-07-26 06:36:45.121533,epoch time: 0:01:24.029679,used: 0:32:15.177102,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9865866, 'recall': 0.9866164, 'specificity': 0.9866164, 'f1': 0.9865836, 'auroc': 0.9986366, 'binary_precision': 0.9908317, 'binary_recall': 0.98246753, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9866319}
confusion matrix:
      0     1
0  1502    14
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.80985916, 'precision': 0.84633154, 'recall': 0.8054956, 'specificity': 0.8054956, 'f1': 0.80308723, 'auroc': 0.9018551, 'binary_precision': 0.9522673, 'binary_recall': 0.6414791, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.7665705}
confusion matrix:
     0    1
0  636   20
1  223  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7592593, 'precision': 0.8264601, 'recall': 0.7592592, 'specificity': 0.7592592, 'f1': 0.7461982, 'auroc': 0.9166666, 'binary_precision': 0.9745763, 'binary_recall': 0.5324074, 'binary_specificity': 0.9861111, 'binary_f1_score': 0.6886227}
confusion matrix:
     0    1
0  213    3
1  101  115
early stop counter: 3
val acc:0.8098591566085815, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 24,now: 2024-07-26 06:38:09.004406,epoch time: 0:01:23.882873,used: 0:33:39.059975,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.99475753, 'recall': 0.9947846, 'specificity': 0.9947846, 'f1': 0.9947642, 'auroc': 0.99991775, 'binary_precision': 0.997389, 'binary_recall': 0.99220777, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.99479157}
confusion matrix:
      0     1
0  1512     4
1    12  1528
---- Validation: 
scalar performance:
{'acc': 0.70187795, 'precision': 0.79059684, 'recall': 0.6943549, 'specificity': 0.6943549, 'f1': 0.6721221, 'auroc': 0.90699995, 'binary_precision': 0.94464946, 'binary_recall': 0.41157556, 'binary_specificity': 0.97713417, 'binary_f1_score': 0.5733483}
confusion matrix:
     0    1
0  641   15
1  366  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7037037, 'precision': 0.80383635, 'recall': 0.7037037, 'specificity': 0.7037037, 'f1': 0.6770999, 'auroc': 0.9226037, 'binary_precision': 0.9782609, 'binary_recall': 0.41666666, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.5844156}
confusion matrix:
     0   1
0  214   2
1  126  90
early stop counter: 4
val acc:0.7018779516220093, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 25,now: 2024-07-26 06:39:32.999789,epoch time: 0:01:23.995383,used: 0:35:03.055358,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98344934, 'recall': 0.98287535, 'specificity': 0.98287535, 'f1': 0.9829763, 'auroc': 0.9994564, 'binary_precision': 0.9702908, 'binary_recall': 0.9967533, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.98334396}
confusion matrix:
      0     1
0  1469    47
1     5  1535
---- Validation: 
scalar performance:
{'acc': 0.84115803, 'precision': 0.8530649, 'recall': 0.8386916, 'specificity': 0.8386916, 'f1': 0.83902836, 'auroc': 0.92122436, 'binary_precision': 0.91159135, 'binary_recall': 0.7459807, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.8205128}
confusion matrix:
     0    1
0  611   45
1  158  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8217593, 'precision': 0.83043516, 'recall': 0.8217592, 'specificity': 0.8217592, 'f1': 0.82058156, 'auroc': 0.9032707, 'binary_precision': 0.8839779, 'binary_recall': 0.7407407, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.80604523}
confusion matrix:
     0    1
0  195   21
1   56  160
early stop counter: 5
val acc:0.8411580324172974, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 26,now: 2024-07-26 06:40:57.262656,epoch time: 0:01:24.262867,used: 0:36:27.318225,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98869336, 'recall': 0.98863125, 'specificity': 0.98863125, 'f1': 0.988547, 'auroc': 0.9998193, 'binary_precision': 0.9993364, 'binary_recall': 0.9779221, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98851335}
confusion matrix:
      0     1
0  1515     1
1    34  1506
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.7852156, 'recall': 0.63035005, 'specificity': 0.63035005, 'f1': 0.57862294, 'auroc': 0.90988946, 'binary_precision': 0.98214287, 'binary_recall': 0.2652733, 'binary_specificity': 0.99542683, 'binary_f1_score': 0.4177215}
confusion matrix:
     0    1
0  653    3
1  457  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6041667, 'precision': 0.75896525, 'recall': 0.6041666, 'specificity': 0.6041666, 'f1': 0.5346206, 'auroc': 0.8855667, 'binary_precision': 0.9591837, 'binary_recall': 0.2175926, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.354717}
confusion matrix:
     0   1
0  214   2
1  169  47
early stop counter: 6
val acc:0.6400625705718994, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 27,now: 2024-07-26 06:42:20.104679,epoch time: 0:01:22.842023,used: 0:37:50.160248,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.9912508, 'recall': 0.99123377, 'specificity': 0.99123377, 'f1': 0.9911649, 'auroc': 0.9998634, 'binary_precision': 1.0, 'binary_recall': 0.98246753, 'binary_specificity': 1.0, 'binary_f1_score': 0.9911562}
confusion matrix:
      0     1
0  1516     0
1    27  1513
---- Validation: 
scalar performance:
{'acc': 0.73865414, 'precision': 0.80424905, 'recall': 0.7323445, 'specificity': 0.7323445, 'f1': 0.72022545, 'auroc': 0.8993927, 'binary_precision': 0.9390244, 'binary_recall': 0.49517685, 'binary_specificity': 0.9695122, 'binary_f1_score': 0.64842105}
confusion matrix:
     0    1
0  636   20
1  314  308
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7615741, 'precision': 0.8043771, 'recall': 0.7615741, 'specificity': 0.7615741, 'f1': 0.75288653, 'auroc': 0.8717421, 'binary_precision': 0.91851854, 'binary_recall': 0.5740741, 'binary_specificity': 0.9490741, 'binary_f1_score': 0.70655274}
confusion matrix:
     0    1
0  205   11
1   92  124
early stop counter: 7
val acc:0.7386541366577148, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 28,now: 2024-07-26 06:43:44.716546,epoch time: 0:01:24.611867,used: 0:39:14.772115,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99541885, 'precision': 0.995412, 'recall': 0.9954392, 'specificity': 0.9954392, 'f1': 0.9954188, 'auroc': 0.9999237, 'binary_precision': 0.99804175, 'binary_recall': 0.99285716, 'binary_specificity': 0.9980211, 'binary_f1_score': 0.99544275}
confusion matrix:
      0     1
0  1513     3
1    11  1529
---- Validation: 
scalar performance:
{'acc': 0.7331768, 'precision': 0.8182475, 'recall': 0.7261759, 'specificity': 0.7261759, 'f1': 0.71004075, 'auroc': 0.90988886, 'binary_precision': 0.9762712, 'binary_recall': 0.4630225, 'binary_specificity': 0.9893293, 'binary_f1_score': 0.6281352}
confusion matrix:
     0    1
0  649    7
1  334  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.599537, 'precision': 0.75664544, 'recall': 0.599537, 'specificity': 0.599537, 'f1': 0.5271758, 'auroc': 0.8865527, 'binary_precision': 0.9574468, 'binary_recall': 0.20833333, 'binary_specificity': 0.9907407, 'binary_f1_score': 0.3422053}
confusion matrix:
     0   1
0  214   2
1  171  45
early stop counter: 8
val acc:0.7331768274307251, best validation acc: 0.8528951406478882, corresponding to test acc:                         0.8935185074806213 / 0.8935185074806213
after epoch: 29,now: 2024-07-26 06:45:07.162112,epoch time: 0:01:22.445566,used: 0:40:37.217681,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9830642, 'recall': 0.98255575, 'specificity': 0.98255575, 'f1': 0.9826497, 'auroc': 0.99944746, 'binary_precision': 0.97086763, 'binary_recall': 0.99545455, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9830074}
confusion matrix:
      0     1
0  1470    46
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.8802817, 'precision': 0.8802438, 'recall': 0.8805094, 'specificity': 0.8805094, 'f1': 0.8802552, 'auroc': 0.9311378, 'binary_precision': 0.8681319, 'binary_recall': 0.88906753, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.878475}
confusion matrix:
     0    1
0  572   84
1   69  553
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8032407, 'precision': 0.821144, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.80045974, 'auroc': 0.88513803, 'binary_precision': 0.74531835, 'binary_recall': 0.9212963, 'binary_specificity': 0.6851852, 'binary_f1_score': 0.8240166}
confusion matrix:
     0    1
0  148   68
1   17  199
better model found
persisted
after epoch: 30,now: 2024-07-26 06:46:31.102583,epoch time: 0:01:23.940471,used: 0:42:01.158152,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_04_29_seed_2_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:01.158152 at 2024-07-26 06:46:31.102583
persisted model performance metric: 

scalar performance:
{'acc': 0.8032407, 'precision': 0.821144, 'recall': 0.8032408, 'specificity': 0.8032408, 'f1': 0.80045974, 'auroc': 0.88513803, 'binary_precision': 0.74531835, 'binary_recall': 0.9212963, 'binary_specificity': 0.6851852, 'binary_f1_score': 0.8240166}
confusion matrix:
     0    1
0  148   68
1   17  199
oracle model performance metric: 

scalar performance:
{'acc': 0.8935185, 'precision': 0.89930403, 'recall': 0.8935185, 'specificity': 0.8935185, 'f1': 0.8931315, 'auroc': 0.94911695, 'binary_precision': 0.94736844, 'binary_recall': 0.8333333, 'binary_specificity': 0.9537037, 'binary_f1_score': 0.88669956}
confusion matrix:
     0    1
0  206   10
1   36  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455124 KiB |  13219 MiB | 222332 GiB | 222331 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 219710 GiB | 219710 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455124 KiB |  13219 MiB | 222332 GiB | 222331 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 219710 GiB | 219710 GiB |
|       from small pool |  40592 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |  40406 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  41672 MiB |  27198 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  41570 MiB |  27162 MiB |
|       from small pool |     66 MiB |     70 MiB |    102 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445996 KiB |   1252 MiB | 158449 GiB | 158448 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 155812 GiB | 155811 GiB |
|       from small pool |  10607 KiB |     43 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   38981 K  |   38979 K  |
|       from large pool |     187    |    1413    |   19831 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19150 K  |   19148 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   38981 K  |   38979 K  |
|       from large pool |     187    |    1413    |   19831 K  |   19830 K  |
|       from small pool |    1111    |    1419    |   19150 K  |   19148 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    1780    |    1146    |
|       from large pool |     601    |     601    |    1729    |    1128    |
|       from small pool |      33    |      35    |      51    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     651    |   25439 K  |   25439 K  |
|       from large pool |      40    |     604    |   14230 K  |   14230 K  |
|       from small pool |      61    |     234    |   11208 K  |   11208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222332 GiB | 222332 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219710 GiB | 219710 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222332 GiB | 222332 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219710 GiB | 219710 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  41672 MiB |  40792 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     50 MiB |     70 MiB |    102 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 158449 GiB | 158449 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 155812 GiB | 155812 GiB |
|       from small pool |      0 KiB |     43 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1780    |    1718    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      25    |      35    |      51    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   25439 K  |   25439 K  |
|       from large pool |       4    |     604    |   14230 K  |   14230 K  |
|       from small pool |       0    |     234    |   11208 K  |   11208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 222332 GiB | 222332 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219710 GiB | 219710 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 222332 GiB | 222332 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 219710 GiB | 219710 GiB |
|       from small pool |      0 KiB |     60 MiB |   2621 GiB |   2621 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 221753 GiB | 221753 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 219137 GiB | 219137 GiB |
|       from small pool |      0 KiB |     60 MiB |   2616 GiB |   2616 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  41672 MiB |  40792 MiB |
|       from large pool |    830 MiB |  14414 MiB |  41570 MiB |  40740 MiB |
|       from small pool |     50 MiB |     70 MiB |    102 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 158449 GiB | 158449 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 155812 GiB | 155812 GiB |
|       from small pool |      0 KiB |     43 MiB |   2636 GiB |   2636 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   38981 K  |   38981 K  |
|       from large pool |       2    |    1413    |   19831 K  |   19831 K  |
|       from small pool |       0    |    1419    |   19150 K  |   19150 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    1780    |    1718    |
|       from large pool |      37    |     601    |    1729    |    1692    |
|       from small pool |      25    |      35    |      51    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   25439 K  |   25439 K  |
|       from large pool |       4    |     604    |   14230 K  |   14230 K  |
|       from small pool |       0    |     234    |   11208 K  |   11208 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529

 Experiment start at: 2024-07-26 06:47:05.933549
before training, model accuracy: 0.47111111879348755
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8531901, 'precision': 0.8838502, 'recall': 0.851262, 'specificity': 0.851262, 'f1': 0.8496866, 'auroc': 0.98789835, 'binary_precision': 0.77872986, 'binary_recall': 0.9922929, 'binary_specificity': 0.710231, 'binary_f1_score': 0.8726348}
confusion matrix:
      0     1
0  1076   439
1    12  1545
---- Validation: 
scalar performance:
{'acc': 0.68667185, 'precision': 0.760368, 'recall': 0.691749, 'specificity': 0.691749, 'f1': 0.6663004, 'auroc': 0.8870319, 'binary_precision': 0.6168898, 'binary_recall': 0.95230526, 'binary_specificity': 0.43119267, 'binary_f1_score': 0.74875}
confusion matrix:
     0    1
0  282  372
1   30  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70444447, 'precision': 0.7802144, 'recall': 0.70444447, 'specificity': 0.70444447, 'f1': 0.68301636, 'auroc': 0.9144099, 'binary_precision': 0.63450295, 'binary_recall': 0.96444446, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.7654321}
confusion matrix:
     0    1
0  100  125
1    8  217
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 06:48:34.837165,epoch time: 0:01:28.903616,used: 0:01:28.903616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9716797, 'precision': 0.97167563, 'recall': 0.97175545, 'specificity': 0.97175545, 'f1': 0.9716784, 'auroc': 0.99686253, 'binary_precision': 0.977879, 'binary_recall': 0.9659383, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.9718719}
confusion matrix:
      0     1
0  1482    34
1    53  1503
---- Validation: 
scalar performance:
{'acc': 0.832424, 'precision': 0.838475, 'recall': 0.8310993, 'specificity': 0.8310993, 'f1': 0.8312281, 'auroc': 0.88989365, 'binary_precision': 0.8791209, 'binary_recall': 0.76311606, 'binary_specificity': 0.89908254, 'binary_f1_score': 0.81702125}
confusion matrix:
     0    1
0  588   66
1  149  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81777775, 'precision': 0.8198247, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8174858, 'auroc': 0.90445435, 'binary_precision': 0.84541065, 'binary_recall': 0.7777778, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8101852}
confusion matrix:
     0    1
0  193   32
1   50  175
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 06:49:58.930538,epoch time: 0:01:24.093373,used: 0:02:52.996989,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9739471, 'recall': 0.9738549, 'specificity': 0.9738549, 'f1': 0.9736326, 'auroc': 0.9963317, 'binary_precision': 0.9900398, 'binary_recall': 0.9576108, 'binary_specificity': 0.990099, 'binary_f1_score': 0.97355527}
confusion matrix:
      0     1
0  1500    15
1    66  1491
---- Validation: 
scalar performance:
{'acc': 0.8098207, 'precision': 0.8163402, 'recall': 0.8083811, 'specificity': 0.8083811, 'f1': 0.8082804, 'auroc': 0.86706245, 'binary_precision': 0.85714287, 'binary_recall': 0.7344992, 'binary_specificity': 0.882263, 'binary_f1_score': 0.7910959}
confusion matrix:
     0    1
0  577   77
1  167  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7977778, 'precision': 0.80432415, 'recall': 0.7977778, 'specificity': 0.7977778, 'f1': 0.7966844, 'auroc': 0.89653337, 'binary_precision': 0.8489583, 'binary_recall': 0.72444445, 'binary_specificity': 0.8711111, 'binary_f1_score': 0.7817746}
confusion matrix:
     0    1
0  196   29
1   62  163
early stop counter: 1
val acc:0.8098207116127014, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 3,now: 2024-07-26 06:51:21.666094,epoch time: 0:01:22.735556,used: 0:04:15.732545,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9710286, 'precision': 0.97148633, 'recall': 0.9712858, 'specificity': 0.9712858, 'f1': 0.97102773, 'auroc': 0.9966026, 'binary_precision': 0.98998666, 'binary_recall': 0.9524727, 'binary_specificity': 0.990099, 'binary_f1_score': 0.9708674}
confusion matrix:
      0     1
0  1500    15
1    74  1483
---- Validation: 
scalar performance:
{'acc': 0.7786438, 'precision': 0.79804736, 'recall': 0.77609843, 'specificity': 0.77609843, 'f1': 0.77383935, 'auroc': 0.86174965, 'binary_precision': 0.86937904, 'binary_recall': 0.645469, 'binary_specificity': 0.90672785, 'binary_f1_score': 0.74087596}
confusion matrix:
     0    1
0  593   61
1  223  406
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.7873303, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.78125, 'auroc': 0.8780247, 'binary_precision': 0.7490196, 'binary_recall': 0.8488889, 'binary_specificity': 0.71555555, 'binary_f1_score': 0.7958333}
confusion matrix:
     0    1
0  161   64
1   34  191
early stop counter: 2
val acc:0.778643786907196, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 4,now: 2024-07-26 06:52:44.772499,epoch time: 0:01:23.106405,used: 0:05:38.838950,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97753906, 'precision': 0.978186, 'recall': 0.97781926, 'specificity': 0.97781926, 'f1': 0.9775373, 'auroc': 0.99756277, 'binary_precision': 0.99932843, 'binary_recall': 0.9562982, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.97733986}
confusion matrix:
      0     1
0  1515     1
1    68  1488
---- Validation: 
scalar performance:
{'acc': 0.7630553, 'precision': 0.81026125, 'recall': 0.75919735, 'specificity': 0.75919735, 'f1': 0.75181854, 'auroc': 0.87119496, 'binary_precision': 0.9265092, 'binary_recall': 0.56120825, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.69900995}
confusion matrix:
     0    1
0  626   28
1  276  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.81430244, 'recall': 0.7755556, 'specificity': 0.7755556, 'f1': 0.7684183, 'auroc': 0.8832395, 'binary_precision': 0.9246575, 'binary_recall': 0.6, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.7277629}
confusion matrix:
     0    1
0  214   11
1   90  135
early stop counter: 3
val acc:0.7630553245544434, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 5,now: 2024-07-26 06:54:07.995678,epoch time: 0:01:23.223179,used: 0:07:02.062129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9557292, 'precision': 0.958383, 'recall': 0.9563433, 'specificity': 0.9563433, 'f1': 0.9556976, 'auroc': 0.9953487, 'binary_precision': 0.9972048, 'binary_recall': 0.91533035, 'binary_specificity': 0.99735624, 'binary_f1_score': 0.95451504}
confusion matrix:
      0     1
0  1509     4
1   132  1427
---- Validation: 
scalar performance:
{'acc': 0.65939206, 'precision': 0.7504605, 'recall': 0.6533829, 'specificity': 0.6533829, 'f1': 0.6202303, 'auroc': 0.8380275, 'binary_precision': 0.89669424, 'binary_recall': 0.34499204, 'binary_specificity': 0.9617737, 'binary_f1_score': 0.49827778}
confusion matrix:
     0    1
0  629   25
1  412  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.7353846, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.67272735, 'auroc': 0.8097185, 'binary_precision': 0.84, 'binary_recall': 0.46666667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.6}
confusion matrix:
     0    1
0  205   20
1  120  105
early stop counter: 4
val acc:0.6593920588493347, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 6,now: 2024-07-26 06:55:30.994406,epoch time: 0:01:22.998728,used: 0:08:25.060857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9869792, 'precision': 0.9871066, 'recall': 0.9871537, 'specificity': 0.9871537, 'f1': 0.9869791, 'auroc': 0.9987659, 'binary_precision': 0.9993421, 'binary_recall': 0.9749679, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9870045}
confusion matrix:
      0     1
0  1513     1
1    39  1519
---- Validation: 
scalar performance:
{'acc': 0.61886203, 'precision': 0.76974106, 'recall': 0.6114397, 'specificity': 0.6114397, 'f1': 0.54931456, 'auroc': 0.84407616, 'binary_precision': 0.96666664, 'binary_recall': 0.23052464, 'binary_specificity': 0.99235475, 'binary_f1_score': 0.37227216}
confusion matrix:
     0    1
0  649    5
1  484  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.78691065, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6243594, 'auroc': 0.878079, 'binary_precision': 0.974359, 'binary_recall': 0.33777776, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.50165015}
confusion matrix:
     0   1
0  223   2
1  149  76
early stop counter: 5
val acc:0.6188620328903198, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 7,now: 2024-07-26 06:56:54.750637,epoch time: 0:01:23.756231,used: 0:09:48.817088,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873408, 'recall': 0.98727286, 'specificity': 0.98727286, 'f1': 0.9873017, 'auroc': 0.99920607, 'binary_precision': 0.9852847, 'binary_recall': 0.98971725, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.987496}
confusion matrix:
      0     1
0  1493    23
1    16  1540
---- Validation: 
scalar performance:
{'acc': 0.76461416, 'precision': 0.77499175, 'recall': 0.76264083, 'specificity': 0.76264083, 'f1': 0.7613961, 'auroc': 0.81867003, 'binary_precision': 0.82376236, 'binary_recall': 0.66136724, 'binary_specificity': 0.8639144, 'binary_f1_score': 0.7336861}
confusion matrix:
     0    1
0  565   89
1  213  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.804453, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7914289, 'auroc': 0.8573432, 'binary_precision': 0.86263734, 'binary_recall': 0.69777775, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.77149874}
confusion matrix:
     0    1
0  200   25
1   68  157
early stop counter: 6
val acc:0.7646141648292542, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8177777528762817
after epoch: 8,now: 2024-07-26 06:58:19.324844,epoch time: 0:01:24.574207,used: 0:11:13.391295,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97591144, 'precision': 0.9767773, 'recall': 0.97564536, 'specificity': 0.97564536, 'f1': 0.97588587, 'auroc': 0.99906266, 'binary_precision': 0.9597274, 'binary_recall': 0.99422336, 'binary_specificity': 0.9570674, 'binary_f1_score': 0.97667086}
confusion matrix:
      0     1
0  1449    65
1     9  1549
---- Validation: 
scalar performance:
{'acc': 0.817615, 'precision': 0.83182436, 'recall': 0.8155706, 'specificity': 0.8155706, 'f1': 0.81491363, 'auroc': 0.89367676, 'binary_precision': 0.8957916, 'binary_recall': 0.7106518, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.7925532}
confusion matrix:
     0    1
0  602   52
1  182  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84, 'precision': 0.84067297, 'recall': 0.84, 'specificity': 0.84, 'f1': 0.8399209, 'auroc': 0.90593576, 'binary_precision': 0.855814, 'binary_recall': 0.81777775, 'binary_specificity': 0.8622222, 'binary_f1_score': 0.8363636}
confusion matrix:
     0    1
0  194   31
1   41  184
new oracle model saved
early stop counter: 7
val acc:0.8176149725914001, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 9,now: 2024-07-26 06:59:41.440583,epoch time: 0:01:22.115739,used: 0:12:35.507034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9867368, 'recall': 0.98679805, 'specificity': 0.98679805, 'f1': 0.98665357, 'auroc': 0.9991856, 'binary_precision': 0.9973753, 'binary_recall': 0.97623634, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9866926}
confusion matrix:
      0     1
0  1511     4
1    37  1520
---- Validation: 
scalar performance:
{'acc': 0.6874513, 'precision': 0.7842434, 'recall': 0.6816655, 'specificity': 0.6816655, 'f1': 0.65417206, 'auroc': 0.8480866, 'binary_precision': 0.9453125, 'binary_recall': 0.38473767, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.5468926}
confusion matrix:
     0    1
0  640   14
1  387  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6333333, 'precision': 0.7236877, 'recall': 0.6333333, 'specificity': 0.6333333, 'f1': 0.59214723, 'auroc': 0.8584889, 'binary_precision': 0.86585367, 'binary_recall': 0.31555554, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.4625407}
confusion matrix:
     0   1
0  214  11
1  154  71
early stop counter: 8
val acc:0.6874513030052185, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 10,now: 2024-07-26 07:01:03.160658,epoch time: 0:01:21.720075,used: 0:13:57.227109,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9739583, 'precision': 0.97528684, 'recall': 0.973633, 'specificity': 0.973633, 'f1': 0.9739225, 'auroc': 0.99913985, 'binary_precision': 0.9533456, 'binary_recall': 0.997431, 'binary_specificity': 0.949835, 'binary_f1_score': 0.9748902}
confusion matrix:
      0     1
0  1439    76
1     4  1553
---- Validation: 
scalar performance:
{'acc': 0.8020265, 'precision': 0.80302197, 'recall': 0.80140436, 'specificity': 0.80140436, 'f1': 0.8015779, 'auroc': 0.85587287, 'binary_precision': 0.8161889, 'binary_recall': 0.76947534, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.792144}
confusion matrix:
     0    1
0  545  109
1  145  484
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77555555, 'precision': 0.7989969, 'recall': 0.77555555, 'specificity': 0.77555555, 'f1': 0.77106845, 'auroc': 0.9039605, 'binary_precision': 0.7152778, 'binary_recall': 0.91555554, 'binary_specificity': 0.63555557, 'binary_f1_score': 0.8031189}
confusion matrix:
     0    1
0  143   82
1   19  206
early stop counter: 9
val acc:0.8020265102386475, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 11,now: 2024-07-26 07:02:26.724716,epoch time: 0:01:23.564058,used: 0:15:20.791167,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98904836, 'recall': 0.98886263, 'specificity': 0.98886263, 'f1': 0.9889286, 'auroc': 0.99946713, 'binary_precision': 0.9840967, 'binary_recall': 0.99421597, 'binary_specificity': 0.98350924, 'binary_f1_score': 0.98913044}
confusion matrix:
      0     1
0  1491    25
1     9  1547
---- Validation: 
scalar performance:
{'acc': 0.8020265, 'precision': 0.81016886, 'recall': 0.80040157, 'specificity': 0.80040157, 'f1': 0.8000674, 'auroc': 0.8655139, 'binary_precision': 0.85578746, 'binary_recall': 0.71701115, 'binary_specificity': 0.88379204, 'binary_f1_score': 0.7802768}
confusion matrix:
     0    1
0  578   76
1  178  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7688889, 'precision': 0.7692293, 'recall': 0.7688889, 'specificity': 0.7688889, 'f1': 0.7688159, 'auroc': 0.807842, 'binary_precision': 0.75965667, 'binary_recall': 0.7866667, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.7729258}
confusion matrix:
     0    1
0  169   56
1   48  177
early stop counter: 10
val acc:0.8020265102386475, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 12,now: 2024-07-26 07:03:49.774143,epoch time: 0:01:23.049427,used: 0:16:43.840594,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.9826145, 'recall': 0.9819015, 'specificity': 0.9819015, 'f1': 0.98208266, 'auroc': 0.99934244, 'binary_precision': 0.96998125, 'binary_recall': 0.99550706, 'binary_specificity': 0.96829593, 'binary_f1_score': 0.9825784}
confusion matrix:
      0     1
0  1466    48
1     7  1551
---- Validation: 
scalar performance:
{'acc': 0.8082619, 'precision': 0.80828637, 'recall': 0.80840176, 'specificity': 0.80840176, 'f1': 0.8082478, 'auroc': 0.8708109, 'binary_precision': 0.7978227, 'binary_recall': 0.8155803, 'binary_specificity': 0.8012232, 'binary_f1_score': 0.8066037}
confusion matrix:
     0    1
0  524  130
1  116  513
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.77707124, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76987356, 'auroc': 0.8813629, 'binary_precision': 0.7364341, 'binary_recall': 0.84444445, 'binary_specificity': 0.69777775, 'binary_f1_score': 0.7867495}
confusion matrix:
     0    1
0  157   68
1   35  190
early stop counter: 11
val acc:0.8082618713378906, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 13,now: 2024-07-26 07:05:12.411568,epoch time: 0:01:22.637425,used: 0:18:06.478019,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98925376, 'recall': 0.98933655, 'specificity': 0.98933655, 'f1': 0.98925734, 'auroc': 0.9993539, 'binary_precision': 0.99544567, 'binary_recall': 0.9832905, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.98933077}
confusion matrix:
      0     1
0  1509     7
1    26  1530
---- Validation: 
scalar performance:
{'acc': 0.74356973, 'precision': 0.8078723, 'recall': 0.7390511, 'specificity': 0.7390511, 'f1': 0.7270094, 'auroc': 0.8705089, 'binary_precision': 0.943787, 'binary_recall': 0.5071542, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.6597725}
confusion matrix:
     0    1
0  635   19
1  310  319
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75555557, 'precision': 0.8249893, 'recall': 0.75555557, 'specificity': 0.75555557, 'f1': 0.7417625, 'auroc': 0.90945184, 'binary_precision': 0.9752066, 'binary_recall': 0.52444446, 'binary_specificity': 0.9866667, 'binary_f1_score': 0.6820809}
confusion matrix:
     0    1
0  222    3
1  107  118
early stop counter: 12
val acc:0.7435697317123413, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 14,now: 2024-07-26 07:06:35.180054,epoch time: 0:01:22.768486,used: 0:19:29.246505,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98923427, 'recall': 0.98929584, 'specificity': 0.98929584, 'f1': 0.98925656, 'auroc': 0.99923986, 'binary_precision': 0.99224806, 'binary_recall': 0.98651254, 'binary_specificity': 0.9920792, 'binary_f1_score': 0.98937196}
confusion matrix:
      0     1
0  1503    12
1    21  1536
---- Validation: 
scalar performance:
{'acc': 0.73265785, 'precision': 0.78861487, 'recall': 0.728287, 'specificity': 0.728287, 'f1': 0.7165331, 'auroc': 0.82526267, 'binary_precision': 0.91091955, 'binary_recall': 0.50397456, 'binary_specificity': 0.9525994, 'binary_f1_score': 0.6489253}
confusion matrix:
     0    1
0  623   31
1  312  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66, 'precision': 0.7314286, 'recall': 0.65999997, 'specificity': 0.65999997, 'f1': 0.63157195, 'auroc': 0.8354765, 'binary_precision': 0.86, 'binary_recall': 0.38222224, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.5292308}
confusion matrix:
     0   1
0  211  14
1  139  86
early stop counter: 13
val acc:0.7326578497886658, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 15,now: 2024-07-26 07:07:58.393100,epoch time: 0:01:23.213046,used: 0:20:52.459551,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.9815639, 'recall': 0.98137444, 'specificity': 0.98137444, 'f1': 0.9811193, 'auroc': 0.99982023, 'binary_precision': 1.0, 'binary_recall': 0.9627489, 'binary_specificity': 1.0, 'binary_f1_score': 0.9810209}
confusion matrix:
      0     1
0  1515     0
1    58  1499
---- Validation: 
scalar performance:
{'acc': 0.59158224, 'precision': 0.7685088, 'recall': 0.5835266, 'specificity': 0.5835266, 'f1': 0.5016604, 'auroc': 0.86213744, 'binary_precision': 0.98165137, 'binary_recall': 0.17011128, 'binary_specificity': 0.9969419, 'binary_f1_score': 0.2899729}
confusion matrix:
     0    1
0  652    2
1  522  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.7610209, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.42085662, 'auroc': 0.89534813, 'binary_precision': 1.0, 'binary_recall': 0.08444444, 'binary_specificity': 1.0, 'binary_f1_score': 0.1557377}
confusion matrix:
     0   1
0  225   0
1  206  19
early stop counter: 14
val acc:0.5915822386741638, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 16,now: 2024-07-26 07:09:20.707690,epoch time: 0:01:22.314590,used: 0:22:14.774141,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9906515, 'recall': 0.99049735, 'specificity': 0.99049735, 'f1': 0.99055666, 'auroc': 0.9997045, 'binary_precision': 0.9866327, 'binary_recall': 0.99486524, 'binary_specificity': 0.98612946, 'binary_f1_score': 0.9907319}
confusion matrix:
      0     1
0  1493    21
1     8  1550
---- Validation: 
scalar performance:
{'acc': 0.751364, 'precision': 0.7649425, 'recall': 0.74906653, 'specificity': 0.74906653, 'f1': 0.7469207, 'auroc': 0.8081951, 'binary_precision': 0.82024795, 'binary_recall': 0.63116056, 'binary_specificity': 0.8669725, 'binary_f1_score': 0.7133872}
confusion matrix:
     0    1
0  567   87
1  232  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8056999, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7725849, 'auroc': 0.8946173, 'binary_precision': 0.8980892, 'binary_recall': 0.62666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.7382199}
confusion matrix:
     0    1
0  209   16
1   84  141
early stop counter: 15
val acc:0.75136399269104, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 17,now: 2024-07-26 07:10:43.501041,epoch time: 0:01:22.793351,used: 0:23:37.567492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.9883796, 'recall': 0.9884541, 'specificity': 0.9884541, 'f1': 0.98828113, 'auroc': 0.9997549, 'binary_precision': 1.0, 'binary_recall': 0.97690827, 'binary_specificity': 1.0, 'binary_f1_score': 0.9883193}
confusion matrix:
      0     1
0  1513     0
1    36  1523
---- Validation: 
scalar performance:
{'acc': 0.6843336, 'precision': 0.79120326, 'recall': 0.6783339, 'specificity': 0.6783339, 'f1': 0.6480396, 'auroc': 0.89817154, 'binary_precision': 0.9628099, 'binary_recall': 0.37042925, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.5350172}
confusion matrix:
     0    1
0  645    9
1  396  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.7285037, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.44743448, 'auroc': 0.88306177, 'binary_precision': 0.9285714, 'binary_recall': 0.115555555, 'binary_specificity': 0.9911111, 'binary_f1_score': 0.2055336}
confusion matrix:
     0   1
0  223   2
1  199  26
early stop counter: 16
val acc:0.6843336224555969, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 18,now: 2024-07-26 07:12:06.055684,epoch time: 0:01:22.554643,used: 0:25:00.122135,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9874307, 'recall': 0.9872305, 'specificity': 0.9872305, 'f1': 0.98730034, 'auroc': 0.9996163, 'binary_precision': 0.9821996, 'binary_recall': 0.9929306, 'binary_specificity': 0.98153037, 'binary_f1_score': 0.98753595}
confusion matrix:
      0     1
0  1488    28
1    11  1545
---- Validation: 
scalar performance:
{'acc': 0.73343724, 'precision': 0.7673631, 'recall': 0.729872, 'specificity': 0.729872, 'f1': 0.7226525, 'auroc': 0.8279331, 'binary_precision': 0.8578554, 'binary_recall': 0.54689986, 'binary_specificity': 0.91284406, 'binary_f1_score': 0.6679612}
confusion matrix:
     0    1
0  597   57
1  285  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78444445, 'precision': 0.7923502, 'recall': 0.78444445, 'specificity': 0.78444445, 'f1': 0.7829773, 'auroc': 0.84948146, 'binary_precision': 0.84042555, 'binary_recall': 0.7022222, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.76513314}
confusion matrix:
     0    1
0  195   30
1   67  158
early stop counter: 17
val acc:0.7334372401237488, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 19,now: 2024-07-26 07:13:28.868368,epoch time: 0:01:22.812684,used: 0:26:22.934819,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.9821293, 'recall': 0.98201895, 'specificity': 0.98201895, 'f1': 0.98177063, 'auroc': 0.9992751, 'binary_precision': 0.9993351, 'binary_recall': 0.9646983, 'binary_specificity': 0.9993395, 'binary_f1_score': 0.9817113}
confusion matrix:
      0     1
0  1513     1
1    55  1503
---- Validation: 
scalar performance:
{'acc': 0.5759938, 'precision': 0.7672461, 'recall': 0.567598, 'specificity': 0.567598, 'f1': 0.47308472, 'auroc': 0.8585292, 'binary_precision': 0.9885057, 'binary_recall': 0.13672496, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.24022348}
confusion matrix:
     0   1
0  653   1
1  543  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51111114, 'precision': 0.752809, 'recall': 0.51111114, 'specificity': 0.51111114, 'f1': 0.35756, 'auroc': 0.89236546, 'binary_precision': 1.0, 'binary_recall': 0.022222223, 'binary_specificity': 1.0, 'binary_f1_score': 0.043478258}
confusion matrix:
     0  1
0  225  0
1  220  5
early stop counter: 18
val acc:0.5759937763214111, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 20,now: 2024-07-26 07:14:52.060619,epoch time: 0:01:23.192251,used: 0:27:46.127070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98567706, 'precision': 0.98608583, 'recall': 0.98552203, 'specificity': 0.98552203, 'f1': 0.9856683, 'auroc': 0.9996698, 'binary_precision': 0.9748744, 'binary_recall': 0.9974293, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.98602295}
confusion matrix:
      0     1
0  1476    40
1     4  1552
---- Validation: 
scalar performance:
{'acc': 0.80592364, 'precision': 0.80938494, 'recall': 0.80692863, 'specificity': 0.80692863, 'f1': 0.80567384, 'auroc': 0.8853382, 'binary_precision': 0.7714286, 'binary_recall': 0.85850555, 'binary_specificity': 0.75535166, 'binary_f1_score': 0.81264114}
confusion matrix:
     0    1
0  494  160
1   89  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.81565654, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.8104287, 'auroc': 0.9143112, 'binary_precision': 0.7777778, 'binary_recall': 0.8711111, 'binary_specificity': 0.7511111, 'binary_f1_score': 0.821803}
confusion matrix:
     0    1
0  169   56
1   29  196
early stop counter: 19
val acc:0.8059236407279968, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 21,now: 2024-07-26 07:16:18.148583,epoch time: 0:01:26.087964,used: 0:29:12.215034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99444675, 'recall': 0.9945203, 'specificity': 0.9945203, 'f1': 0.9944657, 'auroc': 0.99984527, 'binary_precision': 0.99870384, 'binary_recall': 0.9903599, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9945144}
confusion matrix:
      0     1
0  1514     2
1    15  1541
---- Validation: 
scalar performance:
{'acc': 0.7630553, 'precision': 0.81592274, 'recall': 0.7590151, 'specificity': 0.7590151, 'f1': 0.7507566, 'auroc': 0.88327426, 'binary_precision': 0.9403794, 'binary_recall': 0.5516693, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.69539076}
confusion matrix:
     0    1
0  632   22
1  282  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.80346584, 'recall': 0.71999997, 'specificity': 0.71999997, 'f1': 0.69932544, 'auroc': 0.9314765, 'binary_precision': 0.9626168, 'binary_recall': 0.45777777, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.6204819}
confusion matrix:
     0    1
0  221    4
1  122  103
early stop counter: 20
val acc:0.7630553245544434, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 22,now: 2024-07-26 07:17:41.204194,epoch time: 0:01:23.055611,used: 0:30:35.270645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9824219, 'precision': 0.9827696, 'recall': 0.9826812, 'specificity': 0.9826812, 'f1': 0.98242176, 'auroc': 0.99973667, 'binary_precision': 1.0, 'binary_recall': 0.9653624, 'binary_specificity': 1.0, 'binary_f1_score': 0.982376}
confusion matrix:
      0     1
0  1513     0
1    54  1505
---- Validation: 
scalar performance:
{'acc': 0.766173, 'precision': 0.82277966, 'recall': 0.76204276, 'specificity': 0.76204276, 'f1': 0.75349176, 'auroc': 0.9107704, 'binary_precision': 0.95316803, 'binary_recall': 0.55007946, 'binary_specificity': 0.9740061, 'binary_f1_score': 0.69758064}
confusion matrix:
     0    1
0  637   17
1  283  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.8341669, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.745901, 'auroc': 0.93732345, 'binary_precision': 0.99159664, 'binary_recall': 0.52444446, 'binary_specificity': 0.9955556, 'binary_f1_score': 0.68604654}
confusion matrix:
     0    1
0  224    1
1  107  118
early stop counter: 21
val acc:0.7661730051040649, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 23,now: 2024-07-26 07:19:05.985877,epoch time: 0:01:24.781683,used: 0:32:00.052328,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99314183, 'recall': 0.9932207, 'specificity': 0.9932207, 'f1': 0.99316347, 'auroc': 0.99941236, 'binary_precision': 0.99740934, 'binary_recall': 0.98908156, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.993228}
confusion matrix:
      0     1
0  1511     4
1    17  1540
---- Validation: 
scalar performance:
{'acc': 0.82307094, 'precision': 0.8445513, 'recall': 0.8206184, 'specificity': 0.8206184, 'f1': 0.8194375, 'auroc': 0.9076321, 'binary_precision': 0.9258475, 'binary_recall': 0.6947536, 'binary_specificity': 0.9464832, 'binary_f1_score': 0.79382384}
confusion matrix:
     0    1
0  619   35
1  192  437
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80444443, 'precision': 0.8413697, 'recall': 0.80444443, 'specificity': 0.80444443, 'f1': 0.79900926, 'auroc': 0.9113679, 'binary_precision': 0.95364237, 'binary_recall': 0.64, 'binary_specificity': 0.9688889, 'binary_f1_score': 0.7659575}
confusion matrix:
     0    1
0  218    7
1   81  144
early stop counter: 22
val acc:0.8230709433555603, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 24,now: 2024-07-26 07:20:28.857618,epoch time: 0:01:22.871741,used: 0:33:22.924069,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.992818, 'recall': 0.9928882, 'specificity': 0.9928882, 'f1': 0.99283797, 'auroc': 0.9997308, 'binary_precision': 0.9967617, 'binary_recall': 0.9890745, 'binary_specificity': 0.99670184, 'binary_f1_score': 0.99290323}
confusion matrix:
      0     1
0  1511     5
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.5931411, 'precision': 0.73596054, 'recall': 0.58538985, 'specificity': 0.58538985, 'f1': 0.5113144, 'auroc': 0.8380998, 'binary_precision': 0.9147287, 'binary_recall': 0.18759936, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.31134564}
confusion matrix:
     0    1
0  643   11
1  511  118
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72, 'precision': 0.80346584, 'recall': 0.71999997, 'specificity': 0.71999997, 'f1': 0.69932544, 'auroc': 0.9052839, 'binary_precision': 0.9626168, 'binary_recall': 0.45777777, 'binary_specificity': 0.9822222, 'binary_f1_score': 0.6204819}
confusion matrix:
     0    1
0  221    4
1  122  103
early stop counter: 23
val acc:0.5931410789489746, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 25,now: 2024-07-26 07:21:51.924109,epoch time: 0:01:23.066491,used: 0:34:45.990560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98903227, 'recall': 0.9890746, 'specificity': 0.9890746, 'f1': 0.98893225, 'auroc': 0.9998889, 'binary_precision': 1.0, 'binary_recall': 0.9781491, 'binary_specificity': 1.0, 'binary_f1_score': 0.9889538}
confusion matrix:
      0     1
0  1516     0
1    34  1522
---- Validation: 
scalar performance:
{'acc': 0.609509, 'precision': 0.7499167, 'recall': 0.6020527, 'specificity': 0.6020527, 'f1': 0.5375838, 'auroc': 0.8606065, 'binary_precision': 0.9324324, 'binary_recall': 0.21939586, 'binary_specificity': 0.9847095, 'binary_f1_score': 0.35521233}
confusion matrix:
     0    1
0  644   10
1  491  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7644445, 'precision': 0.8122012, 'recall': 0.7644445, 'specificity': 0.7644445, 'f1': 0.7550781, 'auroc': 0.8943012, 'binary_precision': 0.93430656, 'binary_recall': 0.5688889, 'binary_specificity': 0.96, 'binary_f1_score': 0.7071823}
confusion matrix:
     0    1
0  216    9
1   97  128
early stop counter: 24
val acc:0.6095089912414551, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8399999737739563
after epoch: 26,now: 2024-07-26 07:23:14.405762,epoch time: 0:01:22.481653,used: 0:36:08.472213,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.995417, 'recall': 0.9954884, 'specificity': 0.9954884, 'f1': 0.99544215, 'auroc': 0.9998139, 'binary_precision': 0.998708, 'binary_recall': 0.9922978, 'binary_specificity': 0.998679, 'binary_f1_score': 0.9954926}
confusion matrix:
      0     1
0  1512     2
1    12  1546
---- Validation: 
scalar performance:
{'acc': 0.7365549, 'precision': 0.7890947, 'recall': 0.73232234, 'specificity': 0.73232234, 'f1': 0.7216384, 'auroc': 0.86535525, 'binary_precision': 0.90756303, 'binary_recall': 0.51510334, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.6572008}
confusion matrix:
     0    1
0  621   33
1  305  324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8517338, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8411483, 'auroc': 0.9076346, 'binary_precision': 0.90957445, 'binary_recall': 0.76, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8280871}
confusion matrix:
     0    1
0  208   17
1   54  171
new oracle model saved
early stop counter: 25
val acc:0.7365549206733704, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8422222137451172
after epoch: 27,now: 2024-07-26 07:24:38.034507,epoch time: 0:01:23.628745,used: 0:37:32.100958,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9967448, 'precision': 0.99674416, 'recall': 0.99674416, 'specificity': 0.99674416, 'f1': 0.99674416, 'auroc': 0.9998987, 'binary_precision': 0.9967887, 'binary_recall': 0.9967887, 'binary_specificity': 0.9966997, 'binary_f1_score': 0.9967887}
confusion matrix:
      0     1
0  1510     5
1     5  1552
---- Validation: 
scalar performance:
{'acc': 0.8254092, 'precision': 0.8378084, 'recall': 0.8235197, 'specificity': 0.8235197, 'f1': 0.8231504, 'auroc': 0.8777609, 'binary_precision': 0.8978389, 'binary_recall': 0.7265501, 'binary_specificity': 0.9204893, 'binary_f1_score': 0.80316347}
confusion matrix:
     0    1
0  602   52
1  172  457
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7866667, 'precision': 0.7899658, 'recall': 0.78666663, 'specificity': 0.78666663, 'f1': 0.7860581, 'auroc': 0.8672198, 'binary_precision': 0.7590361, 'binary_recall': 0.84, 'binary_specificity': 0.73333335, 'binary_f1_score': 0.79746836}
confusion matrix:
     0    1
0  165   60
1   36  189
early stop counter: 26
val acc:0.8254091739654541, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8422222137451172
after epoch: 28,now: 2024-07-26 07:26:02.396409,epoch time: 0:01:24.361902,used: 0:38:56.462860,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.992167, 'recall': 0.99226046, 'specificity': 0.99226046, 'f1': 0.99218684, 'auroc': 0.9995781, 'binary_precision': 0.99740595, 'binary_recall': 0.987163, 'binary_specificity': 0.99735796, 'binary_f1_score': 0.9922581}
confusion matrix:
      0     1
0  1510     4
1    20  1538
---- Validation: 
scalar performance:
{'acc': 0.74279034, 'precision': 0.8085774, 'recall': 0.7382258, 'specificity': 0.7382258, 'f1': 0.7258419, 'auroc': 0.86949277, 'binary_precision': 0.9462687, 'binary_recall': 0.50397456, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.65767634}
confusion matrix:
     0    1
0  636   18
1  312  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.8491379, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8161644, 'auroc': 0.9205333, 'binary_precision': 0.95, 'binary_recall': 0.6755555, 'binary_specificity': 0.96444446, 'binary_f1_score': 0.7896104}
confusion matrix:
     0    1
0  217    8
1   73  152
early stop counter: 27
val acc:0.7427903413772583, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8422222137451172
after epoch: 29,now: 2024-07-26 07:27:25.862442,epoch time: 0:01:23.466033,used: 0:40:19.928893,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.9954232, 'recall': 0.9954686, 'specificity': 0.9954686, 'f1': 0.9954421, 'auroc': 0.9999466, 'binary_precision': 0.997421, 'binary_recall': 0.9935774, 'binary_specificity': 0.99735975, 'binary_f1_score': 0.9954955}
confusion matrix:
      0     1
0  1511     4
1    10  1547
---- Validation: 
scalar performance:
{'acc': 0.7895557, 'precision': 0.8284616, 'recall': 0.7861637, 'specificity': 0.7861637, 'f1': 0.7817257, 'auroc': 0.89728916, 'binary_precision': 0.9367397, 'binary_recall': 0.61208266, 'binary_specificity': 0.96024466, 'binary_f1_score': 0.7403846}
confusion matrix:
     0    1
0  628   26
1  244  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79333335, 'precision': 0.81197476, 'recall': 0.7933333, 'specificity': 0.7933333, 'f1': 0.7901993, 'auroc': 0.8969679, 'binary_precision': 0.8882353, 'binary_recall': 0.6711111, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.76455694}
confusion matrix:
     0    1
0  206   19
1   74  151
early stop counter: 28
val acc:0.7895557284355164, best validation acc: 0.832423985004425, corresponding to test acc:                         0.8177777528762817 / 0.8422222137451172
after epoch: 30,now: 2024-07-26 07:28:48.867414,epoch time: 0:01:23.004972,used: 0:41:42.933865,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_06_47_05_seed_3_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:42.933865 at 2024-07-26 07:28:48.867414
persisted model performance metric: 

scalar performance:
{'acc': 0.81777775, 'precision': 0.8198247, 'recall': 0.81777775, 'specificity': 0.81777775, 'f1': 0.8174858, 'auroc': 0.90445435, 'binary_precision': 0.84541065, 'binary_recall': 0.7777778, 'binary_specificity': 0.8577778, 'binary_f1_score': 0.8101852}
confusion matrix:
     0    1
0  193   32
1   50  175
oracle model performance metric: 

scalar performance:
{'acc': 0.8422222, 'precision': 0.8517338, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8411483, 'auroc': 0.9076346, 'binary_precision': 0.90957445, 'binary_recall': 0.76, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.8280871}
confusion matrix:
     0    1
0  208   17
1   54  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 295800 GiB | 295800 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 292304 GiB | 292304 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 295800 GiB | 295800 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 292304 GiB | 292304 GiB |
|       from small pool |  40598 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |  40406 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14478 MiB |  14480 MiB |  55270 MiB |  40792 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  55148 MiB |  40740 MiB |
|       from small pool |     70 MiB |     70 MiB |    122 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448038 KiB |   1252 MiB | 210930 GiB | 210930 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 207413 GiB | 207413 GiB |
|       from small pool |  12649 KiB |     43 MiB |   3516 GiB |   3516 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   51931 K  |   51930 K  |
|       from large pool |     187    |    1413    |   26403 K  |   26402 K  |
|       from small pool |    1123    |    1419    |   25528 K  |   25527 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   51931 K  |   51930 K  |
|       from large pool |     187    |    1413    |   26403 K  |   26402 K  |
|       from small pool |    1123    |    1419    |   25528 K  |   25527 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     636    |     636    |    2354    |    1718    |
|       from large pool |     601    |     601    |    2293    |    1692    |
|       from small pool |      35    |      35    |      61    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     101    |     651    |   33606 K  |   33606 K  |
|       from large pool |      40    |     604    |   18844 K  |   18844 K  |
|       from small pool |      61    |     236    |   14762 K  |   14761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295800 GiB | 295800 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292304 GiB | 292304 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295800 GiB | 295800 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292304 GiB | 292304 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  55270 MiB |  54388 MiB |
|       from large pool |    830 MiB |  14414 MiB |  55148 MiB |  54318 MiB |
|       from small pool |     52 MiB |     70 MiB |    122 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 210930 GiB | 210930 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 207413 GiB | 207413 GiB |
|       from small pool |      0 KiB |     44 MiB |   3516 GiB |   3516 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    2354    |    2291    |
|       from large pool |      37    |     601    |    2293    |    2256    |
|       from small pool |      26    |      35    |      61    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   33606 K  |   33606 K  |
|       from large pool |       4    |     604    |   18844 K  |   18844 K  |
|       from small pool |       0    |     236    |   14762 K  |   14762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 295800 GiB | 295800 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292304 GiB | 292304 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 295800 GiB | 295800 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 292304 GiB | 292304 GiB |
|       from small pool |      0 KiB |     60 MiB |   3496 GiB |   3496 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 295171 GiB | 295171 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 291682 GiB | 291682 GiB |
|       from small pool |      0 KiB |     60 MiB |   3488 GiB |   3488 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  55270 MiB |  54388 MiB |
|       from large pool |    830 MiB |  14414 MiB |  55148 MiB |  54318 MiB |
|       from small pool |     52 MiB |     70 MiB |    122 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 210930 GiB | 210930 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 207413 GiB | 207413 GiB |
|       from small pool |      0 KiB |     44 MiB |   3516 GiB |   3516 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   51931 K  |   51931 K  |
|       from large pool |       2    |    1413    |   26403 K  |   26403 K  |
|       from small pool |       0    |    1419    |   25528 K  |   25528 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    2354    |    2291    |
|       from large pool |      37    |     601    |    2293    |    2256    |
|       from small pool |      26    |      35    |      61    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   33606 K  |   33606 K  |
|       from large pool |       4    |     604    |   18844 K  |   18844 K  |
|       from small pool |       0    |     236    |   14762 K  |   14762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529

 Experiment start at: 2024-07-26 07:29:27.334615
before training, model accuracy: 0.6350710988044739
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9375, 'precision': 0.9419565, 'recall': 0.93854016, 'specificity': 0.93854016, 'f1': 0.93742204, 'auroc': 0.9888252, 'binary_precision': 0.9914591, 'binary_recall': 0.88500637, 'binary_specificity': 0.99207395, 'binary_f1_score': 0.9352132}
confusion matrix:
      0     1
0  1502    12
1   181  1393
---- Validation: 
scalar performance:
{'acc': 0.8056206, 'precision': 0.8062316, 'recall': 0.8059076, 'specificity': 0.8059076, 'f1': 0.8055974, 'auroc': 0.87231576, 'binary_precision': 0.7888386, 'binary_recall': 0.82753164, 'binary_specificity': 0.7842835, 'binary_f1_score': 0.8077221}
confusion matrix:
     0    1
0  509  140
1  109  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8293839, 'precision': 0.8293839, 'recall': 0.8293839, 'specificity': 0.8293839, 'f1': 0.8293839, 'auroc': 0.90568495, 'binary_precision': 0.8293839, 'binary_recall': 0.8293839, 'binary_specificity': 0.8293839, 'binary_f1_score': 0.8293839}
confusion matrix:
     0    1
0  175   36
1   36  175
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 07:30:54.432068,epoch time: 0:01:27.097453,used: 0:01:27.097453,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9598446, 'precision': 0.96065736, 'recall': 0.96031713, 'specificity': 0.96031713, 'f1': 0.9598425, 'auroc': 0.9944258, 'binary_precision': 0.98526454, 'binary_recall': 0.93515575, 'binary_specificity': 0.9854785, 'binary_f1_score': 0.9595564}
confusion matrix:
      0     1
0  1493    22
1   102  1471
---- Validation: 
scalar performance:
{'acc': 0.7837627, 'precision': 0.80376446, 'recall': 0.78203565, 'specificity': 0.78203565, 'f1': 0.77940714, 'auroc': 0.8719183, 'binary_precision': 0.8784648, 'binary_recall': 0.65189874, 'binary_specificity': 0.91217256, 'binary_f1_score': 0.7484105}
confusion matrix:
     0    1
0  592   57
1  220  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8199052, 'precision': 0.8523191, 'recall': 0.8199052, 'specificity': 0.8199052, 'f1': 0.8156655, 'auroc': 0.91545564, 'binary_precision': 0.9591837, 'binary_recall': 0.66824645, 'binary_specificity': 0.971564, 'binary_f1_score': 0.78770953}
confusion matrix:
     0    1
0  205    6
1   70  141
early stop counter: 1
val acc:0.7837626934051514, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 2,now: 2024-07-26 07:32:15.419649,epoch time: 0:01:20.987581,used: 0:02:48.085034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95595855, 'precision': 0.9559311, 'recall': 0.9559679, 'specificity': 0.9559679, 'f1': 0.95594794, 'auroc': 0.9940175, 'binary_precision': 0.9578544, 'binary_recall': 0.955414, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.9566327}
confusion matrix:
      0     1
0  1452    66
1    70  1500
---- Validation: 
scalar performance:
{'acc': 0.793911, 'precision': 0.81299186, 'recall': 0.7955326, 'specificity': 0.7955326, 'f1': 0.7913104, 'auroc': 0.9033737, 'binary_precision': 0.7323232, 'binary_recall': 0.9177215, 'binary_specificity': 0.6733436, 'binary_f1_score': 0.8146068}
confusion matrix:
     0    1
0  437  212
1   52  580
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7867299, 'precision': 0.80527055, 'recall': 0.7867298, 'specificity': 0.7867298, 'f1': 0.78344166, 'auroc': 0.90370834, 'binary_precision': 0.73003805, 'binary_recall': 0.9099526, 'binary_specificity': 0.6635071, 'binary_f1_score': 0.81012666}
confusion matrix:
     0    1
0  140   71
1   19  192
early stop counter: 2
val acc:0.7939109802246094, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 3,now: 2024-07-26 07:33:36.861549,epoch time: 0:01:21.441900,used: 0:04:09.526934,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9773316, 'precision': 0.9774531, 'recall': 0.9775709, 'specificity': 0.9775709, 'f1': 0.97733116, 'auroc': 0.9967908, 'binary_precision': 0.9908497, 'binary_recall': 0.96437657, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9774339}
confusion matrix:
      0     1
0  1502    14
1    56  1516
---- Validation: 
scalar performance:
{'acc': 0.80093676, 'precision': 0.8082057, 'recall': 0.7998966, 'specificity': 0.7998966, 'f1': 0.79934764, 'auroc': 0.8745904, 'binary_precision': 0.85233647, 'binary_recall': 0.721519, 'binary_specificity': 0.87827426, 'binary_f1_score': 0.78149104}
confusion matrix:
     0    1
0  570   79
1  176  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.82702446, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.82432497, 'auroc': 0.9175221, 'binary_precision': 0.7991266, 'binary_recall': 0.8672986, 'binary_specificity': 0.7819905, 'binary_f1_score': 0.83181816}
confusion matrix:
     0    1
0  165   46
1   28  183
early stop counter: 3
val acc:0.800936758518219, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 4,now: 2024-07-26 07:34:58.277517,epoch time: 0:01:21.415968,used: 0:05:30.942902,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9682642, 'precision': 0.96925044, 'recall': 0.96877635, 'specificity': 0.96877635, 'f1': 0.96826166, 'auroc': 0.99834204, 'binary_precision': 0.995965, 'binary_recall': 0.94151306, 'binary_specificity': 0.9960396, 'binary_f1_score': 0.9679738}
confusion matrix:
      0     1
0  1509     6
1    92  1481
---- Validation: 
scalar performance:
{'acc': 0.6736924, 'precision': 0.7819581, 'recall': 0.66953176, 'specificity': 0.66953176, 'f1': 0.63584, 'auroc': 0.8712625, 'binary_precision': 0.9533898, 'binary_recall': 0.35601267, 'binary_specificity': 0.9830508, 'binary_f1_score': 0.5184332}
confusion matrix:
     0    1
0  638   11
1  407  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73459715, 'precision': 0.81378996, 'recall': 0.73459715, 'specificity': 0.73459715, 'f1': 0.71672416, 'auroc': 0.9093013, 'binary_precision': 0.9714286, 'binary_recall': 0.48341233, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.6455696}
confusion matrix:
     0    1
0  208    3
1  109  102
early stop counter: 4
val acc:0.6736924052238464, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 5,now: 2024-07-26 07:36:19.778333,epoch time: 0:01:21.500816,used: 0:06:52.443718,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9715026, 'precision': 0.97255147, 'recall': 0.97202796, 'specificity': 0.97202796, 'f1': 0.9714999, 'auroc': 0.9986513, 'binary_precision': 1.0, 'binary_recall': 0.9440559, 'binary_specificity': 1.0, 'binary_f1_score': 0.971223}
confusion matrix:
      0     1
0  1515     0
1    88  1485
---- Validation: 
scalar performance:
{'acc': 0.6830601, 'precision': 0.7783764, 'recall': 0.679129, 'specificity': 0.679129, 'f1': 0.6504986, 'auroc': 0.87201583, 'binary_precision': 0.93798447, 'binary_recall': 0.38291138, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.5438202}
confusion matrix:
     0    1
0  633   16
1  390  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6848341, 'precision': 0.7951578, 'recall': 0.6848341, 'specificity': 0.6848341, 'f1': 0.6523479, 'auroc': 0.90869474, 'binary_precision': 0.9756098, 'binary_recall': 0.37914693, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.5460751}
confusion matrix:
     0   1
0  209   2
1  131  80
early stop counter: 5
val acc:0.6830601096153259, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.829383909702301
after epoch: 6,now: 2024-07-26 07:37:41.597700,epoch time: 0:01:21.819367,used: 0:08:14.263085,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9776554, 'precision': 0.977782, 'recall': 0.9779799, 'specificity': 0.9779799, 'f1': 0.97765446, 'auroc': 0.99756575, 'binary_precision': 0.99281514, 'binary_recall': 0.9632446, 'binary_specificity': 0.99271524, 'binary_f1_score': 0.9778064}
confusion matrix:
      0     1
0  1499    11
1    58  1520
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8001009, 'recall': 0.787114, 'specificity': 0.787114, 'f1': 0.78581464, 'auroc': 0.87529993, 'binary_precision': 0.8560158, 'binary_recall': 0.68670887, 'binary_specificity': 0.88751924, 'binary_f1_score': 0.762072}
confusion matrix:
     0    1
0  576   73
1  198  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672986, 'precision': 0.8674306, 'recall': 0.8672986, 'specificity': 0.8672986, 'f1': 0.8672867, 'auroc': 0.9371757, 'binary_precision': 0.87439615, 'binary_recall': 0.8578199, 'binary_specificity': 0.87677723, 'binary_f1_score': 0.8660287}
confusion matrix:
     0    1
0  185   26
1   30  181
new oracle model saved
early stop counter: 6
val acc:0.7884465456008911, best validation acc: 0.8056206107139587, corresponding to test acc:                         0.829383909702301 / 0.8672986030578613
after epoch: 7,now: 2024-07-26 07:39:04.469224,epoch time: 0:01:22.871524,used: 0:09:37.134609,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9737694, 'precision': 0.9746438, 'recall': 0.9734498, 'specificity': 0.9734498, 'f1': 0.9737367, 'auroc': 0.99822843, 'binary_precision': 0.9581796, 'binary_recall': 0.991725, 'binary_specificity': 0.9551747, 'binary_f1_score': 0.97466373}
confusion matrix:
      0     1
0  1449    68
1    13  1558
---- Validation: 
scalar performance:
{'acc': 0.8462139, 'precision': 0.8482537, 'recall': 0.8456998, 'specificity': 0.8456998, 'f1': 0.845829, 'auroc': 0.90756226, 'binary_precision': 0.8717949, 'binary_recall': 0.806962, 'binary_specificity': 0.8844376, 'binary_f1_score': 0.8381265}
confusion matrix:
     0    1
0  574   75
1  122  510
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86966825, 'precision': 0.87411344, 'recall': 0.86966825, 'specificity': 0.86966825, 'f1': 0.86927986, 'auroc': 0.94735074, 'binary_precision': 0.9148936, 'binary_recall': 0.8151659, 'binary_specificity': 0.9241706, 'binary_f1_score': 0.8621554}
confusion matrix:
     0    1
0  195   16
1   39  172
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-26 07:40:26.286966,epoch time: 0:01:21.817742,used: 0:10:58.952351,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9851036, 'precision': 0.98521113, 'recall': 0.985023, 'specificity': 0.985023, 'f1': 0.9850968, 'auroc': 0.99927497, 'binary_precision': 0.9810606, 'binary_recall': 0.9898089, 'binary_specificity': 0.9802371, 'binary_f1_score': 0.98541534}
confusion matrix:
      0     1
0  1488    30
1    16  1554
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.8003466, 'recall': 0.79806197, 'specificity': 0.79806197, 'f1': 0.7980749, 'auroc': 0.86849535, 'binary_precision': 0.82020545, 'binary_recall': 0.7579114, 'binary_specificity': 0.8382126, 'binary_f1_score': 0.7878289}
confusion matrix:
     0    1
0  544  105
1  153  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86018956, 'precision': 0.8602624, 'recall': 0.86018956, 'specificity': 0.86018956, 'f1': 0.8601825, 'auroc': 0.9340985, 'binary_precision': 0.86538464, 'binary_recall': 0.8530806, 'binary_specificity': 0.8672986, 'binary_f1_score': 0.85918856}
confusion matrix:
     0    1
0  183   28
1   31  180
early stop counter: 1
val acc:0.7985948324203491, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8696682453155518 / 0.8696682453155518
after epoch: 9,now: 2024-07-26 07:41:48.075392,epoch time: 0:01:21.788426,used: 0:12:20.740777,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9802461, 'precision': 0.9805745, 'recall': 0.98058593, 'specificity': 0.98058593, 'f1': 0.98024607, 'auroc': 0.9990537, 'binary_precision': 0.9986807, 'binary_recall': 0.96249205, 'binary_specificity': 0.9986799, 'binary_f1_score': 0.98025244}
confusion matrix:
      0     1
0  1513     2
1    59  1514
---- Validation: 
scalar performance:
{'acc': 0.79313034, 'precision': 0.8155235, 'recall': 0.79134285, 'specificity': 0.79134285, 'f1': 0.788675, 'auroc': 0.8999654, 'binary_precision': 0.8963283, 'binary_recall': 0.6566456, 'binary_specificity': 0.92604005, 'binary_f1_score': 0.75799084}
confusion matrix:
     0    1
0  601   48
1  217  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7203792, 'precision': 0.8026279, 'recall': 0.7203792, 'specificity': 0.7203792, 'f1': 0.6999952, 'auroc': 0.9203522, 'binary_precision': 0.96039605, 'binary_recall': 0.45971563, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.6217949}
confusion matrix:
     0   1
0  207   4
1  114  97
early stop counter: 2
val acc:0.7931303381919861, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8696682453155518 / 0.8696682453155518
after epoch: 10,now: 2024-07-26 07:43:10.127782,epoch time: 0:01:22.052390,used: 0:13:42.793167,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97279793, 'precision': 0.9734125, 'recall': 0.97324085, 'specificity': 0.97324085, 'f1': 0.9727975, 'auroc': 0.99713004, 'binary_precision': 0.9960053, 'binary_recall': 0.9504447, 'binary_specificity': 0.996037, 'binary_f1_score': 0.9726918}
confusion matrix:
      0     1
0  1508     6
1    78  1496
---- Validation: 
scalar performance:
{'acc': 0.8095238, 'precision': 0.81319916, 'recall': 0.8087857, 'specificity': 0.8087857, 'f1': 0.8086815, 'auroc': 0.87125033, 'binary_precision': 0.8439716, 'binary_recall': 0.7531645, 'binary_specificity': 0.86440676, 'binary_f1_score': 0.79598665}
confusion matrix:
     0    1
0  561   88
1  156  476
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83886254, 'precision': 0.8686738, 'recall': 0.83886254, 'specificity': 0.83886254, 'f1': 0.8355379, 'auroc': 0.93872553, 'binary_precision': 0.9735099, 'binary_recall': 0.69668245, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.81215465}
confusion matrix:
     0    1
0  207    4
1   64  147
early stop counter: 3
val acc:0.8095238208770752, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8696682453155518 / 0.8696682453155518
after epoch: 11,now: 2024-07-26 07:44:32.273597,epoch time: 0:01:22.145815,used: 0:15:04.938982,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98348445, 'precision': 0.9836693, 'recall': 0.9837551, 'specificity': 0.9837551, 'f1': 0.9834843, 'auroc': 0.99925816, 'binary_precision': 0.9986885, 'binary_recall': 0.9688295, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9835324}
confusion matrix:
      0     1
0  1514     2
1    49  1523
---- Validation: 
scalar performance:
{'acc': 0.7978142, 'precision': 0.8340856, 'recall': 0.79561305, 'specificity': 0.79561305, 'f1': 0.7913189, 'auroc': 0.908713, 'binary_precision': 0.94089836, 'binary_recall': 0.62974685, 'binary_specificity': 0.9614792, 'binary_f1_score': 0.7545024}
confusion matrix:
     0    1
0  624   25
1  234  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.857008, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.7984436, 'auroc': 0.94865346, 'binary_precision': 0.99236643, 'binary_recall': 0.6161137, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.7602339}
confusion matrix:
     0    1
0  210    1
1   81  130
early stop counter: 4
val acc:0.7978141903877258, best validation acc: 0.8462138772010803, corresponding to test acc:                         0.8696682453155518 / 0.8696682453155518
after epoch: 12,now: 2024-07-26 07:45:53.106187,epoch time: 0:01:20.832590,used: 0:16:25.771572,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.97862697, 'precision': 0.9791666, 'recall': 0.9789809, 'specificity': 0.9789809, 'f1': 0.9786265, 'auroc': 0.9988512, 'binary_precision': 1.0, 'binary_recall': 0.9579618, 'binary_specificity': 1.0, 'binary_f1_score': 0.97852963}
confusion matrix:
      0     1
0  1518     0
1    66  1504
---- Validation: 
scalar performance:
{'acc': 0.8555816, 'precision': 0.8667054, 'recall': 0.85442674, 'specificity': 0.85442674, 'f1': 0.8541707, 'auroc': 0.91918194, 'binary_precision': 0.92734224, 'binary_recall': 0.7674051, 'binary_specificity': 0.9414484, 'binary_f1_score': 0.8398268}
confusion matrix:
     0    1
0  611   38
1  147  485
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87677723, 'precision': 0.89733994, 'recall': 0.87677723, 'specificity': 0.87677723, 'f1': 0.8751622, 'auroc': 0.9501808, 'binary_precision': 0.9877301, 'binary_recall': 0.76303315, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.8609626}
confusion matrix:
     0    1
0  209    2
1   50  161
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-26 07:47:14.965544,epoch time: 0:01:21.859357,used: 0:17:47.630929,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9876943, 'precision': 0.9876741, 'recall': 0.98783123, 'specificity': 0.98783123, 'f1': 0.98769295, 'auroc': 0.9991621, 'binary_precision': 0.99547803, 'binary_recall': 0.9802799, 'binary_specificity': 0.9953826, 'binary_f1_score': 0.9878205}
confusion matrix:
      0     1
0  1509     7
1    31  1541
---- Validation: 
scalar performance:
{'acc': 0.6830601, 'precision': 0.76934826, 'recall': 0.6792534, 'specificity': 0.6792534, 'f1': 0.6526554, 'auroc': 0.8296186, 'binary_precision': 0.91851854, 'binary_recall': 0.39240506, 'binary_specificity': 0.9661017, 'binary_f1_score': 0.54988915}
confusion matrix:
     0    1
0  627   22
1  384  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.8485594, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.79952264, 'auroc': 0.93726563, 'binary_precision': 0.9708029, 'binary_recall': 0.63033175, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.7643678}
confusion matrix:
     0    1
0  207    4
1   78  133
early stop counter: 1
val acc:0.6830601096153259, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 14,now: 2024-07-26 07:48:36.174539,epoch time: 0:01:21.208995,used: 0:19:08.839924,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98542744, 'precision': 0.9854968, 'recall': 0.98564005, 'specificity': 0.98564005, 'f1': 0.9854269, 'auroc': 0.9992585, 'binary_precision': 0.99739414, 'binary_recall': 0.97391856, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.98551655}
confusion matrix:
      0     1
0  1512     4
1    41  1531
---- Validation: 
scalar performance:
{'acc': 0.6885246, 'precision': 0.77253985, 'recall': 0.6847913, 'specificity': 0.6847913, 'f1': 0.65983844, 'auroc': 0.83680105, 'binary_precision': 0.92057765, 'binary_recall': 0.403481, 'binary_specificity': 0.9661017, 'binary_f1_score': 0.5610561}
confusion matrix:
     0    1
0  627   22
1  377  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7914692, 'precision': 0.8433209, 'recall': 0.7914692, 'specificity': 0.7914692, 'f1': 0.7832867, 'auroc': 0.93088657, 'binary_precision': 0.9767442, 'binary_recall': 0.5971564, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.7411765}
confusion matrix:
     0    1
0  208    3
1   85  126
early stop counter: 2
val acc:0.688524603843689, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 15,now: 2024-07-26 07:49:59.101813,epoch time: 0:01:22.927274,used: 0:20:31.767198,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9851036, 'precision': 0.9852116, 'recall': 0.9853257, 'specificity': 0.9853257, 'f1': 0.9851033, 'auroc': 0.99963415, 'binary_precision': 0.9980405, 'binary_recall': 0.9726289, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.98517084}
confusion matrix:
      0     1
0  1514     3
1    43  1528
---- Validation: 
scalar performance:
{'acc': 0.79703355, 'precision': 0.8320525, 'recall': 0.79486334, 'specificity': 0.79486334, 'f1': 0.7906904, 'auroc': 0.9257182, 'binary_precision': 0.9366197, 'binary_recall': 0.6313291, 'binary_specificity': 0.9583975, 'binary_f1_score': 0.75425327}
confusion matrix:
     0    1
0  622   27
1  233  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8341232, 'precision': 0.87284756, 'recall': 0.83412325, 'specificity': 0.83412325, 'f1': 0.8297014, 'auroc': 0.9519777, 'binary_precision': 0.993007, 'binary_recall': 0.6729858, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.8022599}
confusion matrix:
     0    1
0  210    1
1   69  142
early stop counter: 3
val acc:0.7970335483551025, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 16,now: 2024-07-26 07:51:23.041595,epoch time: 0:01:23.939782,used: 0:21:55.706980,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.98867273, 'recall': 0.98888254, 'specificity': 0.98888254, 'f1': 0.9886647, 'auroc': 0.9997406, 'binary_precision': 0.9993519, 'binary_recall': 0.9784264, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9887785}
confusion matrix:
      0     1
0  1511     1
1    34  1542
---- Validation: 
scalar performance:
{'acc': 0.7408275, 'precision': 0.8048072, 'recall': 0.73775625, 'specificity': 0.73775625, 'f1': 0.7248156, 'auroc': 0.9122603, 'binary_precision': 0.9411765, 'binary_recall': 0.5063291, 'binary_specificity': 0.9691834, 'binary_f1_score': 0.65843624}
confusion matrix:
     0    1
0  629   20
1  312  320
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68957347, 'precision': 0.802726, 'recall': 0.68957347, 'specificity': 0.68957347, 'f1': 0.6575757, 'auroc': 0.93093145, 'binary_precision': 0.9878049, 'binary_recall': 0.38388625, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.552901}
confusion matrix:
     0   1
0  210   1
1  130  81
early stop counter: 4
val acc:0.7408275008201599, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 17,now: 2024-07-26 07:52:45.280190,epoch time: 0:01:22.238595,used: 0:23:17.945575,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98704666, 'precision': 0.98704267, 'recall': 0.98704267, 'specificity': 0.98704267, 'f1': 0.98704267, 'auroc': 0.99882054, 'binary_precision': 0.9872693, 'binary_recall': 0.9872693, 'binary_specificity': 0.9868161, 'binary_f1_score': 0.9872693}
confusion matrix:
      0     1
0  1497    20
1    20  1551
---- Validation: 
scalar performance:
{'acc': 0.83528495, 'precision': 0.8402018, 'recall': 0.8344788, 'specificity': 0.8344788, 'f1': 0.83443093, 'auroc': 0.9138597, 'binary_precision': 0.8779174, 'binary_recall': 0.77373415, 'binary_specificity': 0.89522344, 'binary_f1_score': 0.8225399}
confusion matrix:
     0    1
0  581   68
1  143  489
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8649289, 'precision': 0.8693172, 'recall': 0.8649289, 'specificity': 0.8649289, 'f1': 0.8645265, 'auroc': 0.92381126, 'binary_precision': 0.90957445, 'binary_recall': 0.81042653, 'binary_specificity': 0.91943127, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  194   17
1   40  171
early stop counter: 5
val acc:0.835284948348999, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 18,now: 2024-07-26 07:54:05.670359,epoch time: 0:01:20.390169,used: 0:24:38.335744,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9925518, 'precision': 0.992518, 'recall': 0.99259174, 'specificity': 0.99259174, 'f1': 0.9925498, 'auroc': 0.99931353, 'binary_precision': 0.99489146, 'binary_recall': 0.9904641, 'binary_specificity': 0.99471945, 'binary_f1_score': 0.9926728}
confusion matrix:
      0     1
0  1507     8
1    15  1558
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.8312012, 'recall': 0.8013375, 'specificity': 0.8013375, 'f1': 0.7983131, 'auroc': 0.90907013, 'binary_precision': 0.92410713, 'binary_recall': 0.6550633, 'binary_specificity': 0.9476117, 'binary_f1_score': 0.76666665}
confusion matrix:
     0    1
0  615   34
1  218  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7677725, 'precision': 0.8340759, 'recall': 0.7677725, 'specificity': 0.7677725, 'f1': 0.7556485, 'auroc': 0.9469913, 'binary_precision': 0.982906, 'binary_recall': 0.5450237, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.7012195}
confusion matrix:
     0    1
0  209    2
1   96  115
early stop counter: 6
val acc:0.8032786846160889, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 19,now: 2024-07-26 07:55:27.061788,epoch time: 0:01:21.391429,used: 0:25:59.727173,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9896373, 'precision': 0.9896436, 'recall': 0.9898162, 'specificity': 0.9898162, 'f1': 0.9896364, 'auroc': 0.99956775, 'binary_precision': 0.9993519, 'binary_recall': 0.98029244, 'binary_specificity': 0.99933994, 'binary_f1_score': 0.9897304}
confusion matrix:
      0     1
0  1514     1
1    31  1542
---- Validation: 
scalar performance:
{'acc': 0.5589383, 'precision': 0.76008034, 'recall': 0.55302703, 'specificity': 0.55302703, 'f1': 0.4452042, 'auroc': 0.9021151, 'binary_precision': 0.98550725, 'binary_recall': 0.10759494, 'binary_specificity': 0.99845916, 'binary_f1_score': 0.19400856}
confusion matrix:
     0   1
0  648   1
1  564  68
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.507109, 'precision': 0.75179, 'recall': 0.507109, 'specificity': 0.507109, 'f1': 0.34893933, 'auroc': 0.9362941, 'binary_precision': 1.0, 'binary_recall': 0.014218009, 'binary_specificity': 1.0, 'binary_f1_score': 0.028037384}
confusion matrix:
     0  1
0  211  0
1  208  3
early stop counter: 7
val acc:0.5589383244514465, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 20,now: 2024-07-26 07:56:48.661672,epoch time: 0:01:21.599884,used: 0:27:21.327057,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9799223, 'precision': 0.9799152, 'recall': 0.9799152, 'specificity': 0.9799152, 'f1': 0.9799152, 'auroc': 0.9982565, 'binary_precision': 0.98029244, 'binary_recall': 0.98029244, 'binary_specificity': 0.97953796, 'binary_f1_score': 0.98029244}
confusion matrix:
      0     1
0  1484    31
1    31  1542
---- Validation: 
scalar performance:
{'acc': 0.80483997, 'precision': 0.8256309, 'recall': 0.80314773, 'specificity': 0.80314773, 'f1': 0.8010415, 'auroc': 0.88826525, 'binary_precision': 0.904661, 'binary_recall': 0.6756329, 'binary_specificity': 0.9306626, 'binary_f1_score': 0.77355075}
confusion matrix:
     0    1
0  604   45
1  205  427
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81279624, 'precision': 0.8527355, 'recall': 0.81279624, 'specificity': 0.81279624, 'f1': 0.80734265, 'auroc': 0.9489006, 'binary_precision': 0.9714286, 'binary_recall': 0.6445498, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.7749288}
confusion matrix:
     0    1
0  207    4
1   75  136
early stop counter: 8
val acc:0.8048399686813354, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 21,now: 2024-07-26 07:58:11.133653,epoch time: 0:01:22.471981,used: 0:28:43.799038,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9886658, 'precision': 0.9886658, 'recall': 0.98883826, 'specificity': 0.98883826, 'f1': 0.98866487, 'auroc': 0.99919516, 'binary_precision': 0.998057, 'binary_recall': 0.9796567, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.98877126}
confusion matrix:
      0     1
0  1512     3
1    32  1541
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.7934578, 'recall': 0.7076101, 'specificity': 0.7076101, 'f1': 0.68713534, 'auroc': 0.90465915, 'binary_precision': 0.9455782, 'binary_recall': 0.43987343, 'binary_specificity': 0.9753467, 'binary_f1_score': 0.600432}
confusion matrix:
     0    1
0  633   16
1  354  278
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6800948, 'precision': 0.8049133, 'recall': 0.6800948, 'specificity': 0.6800948, 'f1': 0.6436235, 'auroc': 0.94728327, 'binary_precision': 1.0, 'binary_recall': 0.3601896, 'binary_specificity': 1.0, 'binary_f1_score': 0.5296168}
confusion matrix:
     0   1
0  211   0
1  135  76
early stop counter: 9
val acc:0.7111631631851196, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 22,now: 2024-07-26 07:59:31.769656,epoch time: 0:01:20.636003,used: 0:30:04.435041,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98996115, 'precision': 0.98992276, 'recall': 0.99004304, 'specificity': 0.99004304, 'f1': 0.98995954, 'auroc': 0.99961436, 'binary_precision': 0.9948586, 'binary_recall': 0.98535967, 'binary_specificity': 0.9947264, 'binary_f1_score': 0.9900864}
confusion matrix:
      0     1
0  1509     8
1    23  1548
---- Validation: 
scalar performance:
{'acc': 0.77361435, 'precision': 0.8199603, 'recall': 0.77106696, 'specificity': 0.77106696, 'f1': 0.7639655, 'auroc': 0.92112446, 'binary_precision': 0.93846154, 'binary_recall': 0.5791139, 'binary_specificity': 0.96302, 'binary_f1_score': 0.7162426}
confusion matrix:
     0    1
0  625   24
1  266  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5900474, 'precision': 0.7747396, 'recall': 0.5900474, 'specificity': 0.5900474, 'f1': 0.5072323, 'auroc': 0.9437344, 'binary_precision': 1.0, 'binary_recall': 0.1800948, 'binary_specificity': 1.0, 'binary_f1_score': 0.30522087}
confusion matrix:
     0   1
0  211   0
1  173  38
early stop counter: 10
val acc:0.7736143469810486, best validation acc: 0.8555815815925598, corresponding to test acc:                         0.8767772316932678 / 0.8767772316932678
after epoch: 23,now: 2024-07-26 08:00:55.574270,epoch time: 0:01:23.804614,used: 0:31:28.239655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9925518, 'precision': 0.99251586, 'recall': 0.99264586, 'specificity': 0.99264586, 'f1': 0.99255073, 'auroc': 0.99964416, 'binary_precision': 0.9980695, 'binary_recall': 0.9872693, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.99264}
confusion matrix:
      0     1
0  1514     3
1    20  1551
---- Validation: 
scalar performance:
{'acc': 0.86729115, 'precision': 0.87154615, 'recall': 0.86658394, 'specificity': 0.86658394, 'f1': 0.86673164, 'auroc': 0.93106234, 'binary_precision': 0.9081272, 'binary_recall': 0.81329113, 'binary_specificity': 0.91987675, 'binary_f1_score': 0.8580968}
confusion matrix:
     0    1
0  597   52
1  118  514
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8672986, 'precision': 0.88734394, 'recall': 0.8672986, 'specificity': 0.8672986, 'f1': 0.8655592, 'auroc': 0.9580198, 'binary_precision': 0.9754601, 'binary_recall': 0.7535545, 'binary_specificity': 0.9810427, 'binary_f1_score': 0.85026735}
confusion matrix:
     0    1
0  207    4
1   52  159
better model found
persisted
after epoch: 24,now: 2024-07-26 08:02:17.681300,epoch time: 0:01:22.107030,used: 0:32:50.346685,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99093264, 'precision': 0.99106693, 'recall': 0.9908428, 'specificity': 0.9908428, 'f1': 0.9909282, 'auroc': 0.9997084, 'binary_precision': 0.9861286, 'binary_recall': 0.9961783, 'binary_specificity': 0.98550725, 'binary_f1_score': 0.99112797}
confusion matrix:
      0     1
0  1496    22
1     6  1564
---- Validation: 
scalar performance:
{'acc': 0.8649493, 'precision': 0.8662289, 'recall': 0.8653503, 'specificity': 0.8653503, 'f1': 0.86490184, 'auroc': 0.9261029, 'binary_precision': 0.8410104, 'binary_recall': 0.8955696, 'binary_specificity': 0.835131, 'binary_f1_score': 0.86743295}
confusion matrix:
     0    1
0  542  107
1   66  566
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9146919, 'precision': 0.91603756, 'recall': 0.9146919, 'specificity': 0.9146919, 'f1': 0.9146229, 'auroc': 0.95795244, 'binary_precision': 0.9396985, 'binary_recall': 0.8862559, 'binary_specificity': 0.943128, 'binary_f1_score': 0.91219515}
confusion matrix:
     0    1
0  199   12
1   24  187
new oracle model saved
early stop counter: 1
val acc:0.8649492859840393, best validation acc: 0.8672911524772644, corresponding to test acc:                         0.8672986030578613 / 0.9146919250488281
after epoch: 25,now: 2024-07-26 08:03:39.666556,epoch time: 0:01:21.985256,used: 0:34:12.331941,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.990285, 'precision': 0.9902711, 'recall': 0.9903978, 'specificity': 0.9903978, 'f1': 0.9902842, 'auroc': 0.9992589, 'binary_precision': 0.99741435, 'binary_recall': 0.98342896, 'binary_specificity': 0.99736667, 'binary_f1_score': 0.9903723}
confusion matrix:
      0     1
0  1515     4
1    26  1543
---- Validation: 
scalar performance:
{'acc': 0.87119436, 'precision': 0.87421465, 'recall': 0.8706018, 'specificity': 0.8706018, 'f1': 0.8707862, 'auroc': 0.93522716, 'binary_precision': 0.90467936, 'binary_recall': 0.8259494, 'binary_specificity': 0.91525424, 'binary_f1_score': 0.86352354}
confusion matrix:
     0    1
0  594   55
1  110  522
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8056872, 'precision': 0.8512582, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.7991736, 'auroc': 0.9256755, 'binary_precision': 0.9777778, 'binary_recall': 0.6255924, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.76300573}
confusion matrix:
     0    1
0  208    3
1   79  132
better model found
persisted
after epoch: 26,now: 2024-07-26 08:05:00.610391,epoch time: 0:01:20.943835,used: 0:35:33.275776,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99384713, 'precision': 0.99390054, 'recall': 0.9937975, 'specificity': 0.9937975, 'f1': 0.9938439, 'auroc': 0.9998661, 'binary_precision': 0.99178773, 'binary_recall': 0.9961929, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.9939855}
confusion matrix:
      0     1
0  1499    13
1     6  1570
---- Validation: 
scalar performance:
{'acc': 0.84387195, 'precision': 0.8441217, 'recall': 0.8436787, 'specificity': 0.8436787, 'f1': 0.84376824, 'auroc': 0.9083376, 'binary_precision': 0.85064936, 'binary_recall': 0.8291139, 'binary_specificity': 0.85824347, 'binary_f1_score': 0.83974355}
confusion matrix:
     0    1
0  557   92
1  108  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82464457, 'precision': 0.8408443, 'recall': 0.82464457, 'specificity': 0.82464457, 'f1': 0.8225359, 'auroc': 0.9208913, 'binary_precision': 0.91515154, 'binary_recall': 0.7156398, 'binary_specificity': 0.9336493, 'binary_f1_score': 0.8031915}
confusion matrix:
     0    1
0  197   14
1   60  151
early stop counter: 1
val acc:0.8438719511032104, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8056871891021729 / 0.9146919250488281
after epoch: 27,now: 2024-07-26 08:06:23.566373,epoch time: 0:01:22.955982,used: 0:36:56.231758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9860751, 'precision': 0.98613685, 'recall': 0.98629534, 'specificity': 0.98629534, 'f1': 0.98607445, 'auroc': 0.9996081, 'binary_precision': 0.9980469, 'binary_recall': 0.9745709, 'binary_specificity': 0.9980198, 'binary_f1_score': 0.98616916}
confusion matrix:
      0     1
0  1512     3
1    40  1533
---- Validation: 
scalar performance:
{'acc': 0.83138174, 'precision': 0.845211, 'recall': 0.8300465, 'specificity': 0.8300465, 'f1': 0.8292539, 'auroc': 0.9229096, 'binary_precision': 0.9110672, 'binary_recall': 0.7294304, 'binary_specificity': 0.9306626, 'binary_f1_score': 0.8101933}
confusion matrix:
     0    1
0  604   45
1  171  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7393365, 'precision': 0.8051665, 'recall': 0.7393365, 'specificity': 0.7393365, 'f1': 0.72447765, 'auroc': 0.90925634, 'binary_precision': 0.94690263, 'binary_recall': 0.507109, 'binary_specificity': 0.971564, 'binary_f1_score': 0.6604938}
confusion matrix:
     0    1
0  205    6
1  104  107
early stop counter: 2
val acc:0.8313817381858826, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8056871891021729 / 0.9146919250488281
after epoch: 28,now: 2024-07-26 08:07:45.524783,epoch time: 0:01:21.958410,used: 0:38:18.190168,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.98898965, 'precision': 0.98894525, 'recall': 0.98908305, 'specificity': 0.98908305, 'f1': 0.98898757, 'auroc': 0.99965465, 'binary_precision': 0.99421966, 'binary_recall': 0.9841068, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.98913735}
confusion matrix:
      0     1
0  1506     9
1    25  1548
---- Validation: 
scalar performance:
{'acc': 0.8618267, 'precision': 0.86720246, 'recall': 0.8610252, 'specificity': 0.8610252, 'f1': 0.8611103, 'auroc': 0.93314695, 'binary_precision': 0.9084381, 'binary_recall': 0.8006329, 'binary_specificity': 0.9214176, 'binary_f1_score': 0.8511355}
confusion matrix:
     0    1
0  598   51
1  126  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8507109, 'precision': 0.8804581, 'recall': 0.85071087, 'specificity': 0.85071087, 'f1': 0.8477346, 'auroc': 0.94979894, 'binary_precision': 0.9868421, 'binary_recall': 0.7109005, 'binary_specificity': 0.9905213, 'binary_f1_score': 0.8264463}
confusion matrix:
     0    1
0  209    2
1   61  150
early stop counter: 3
val acc:0.8618267178535461, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8056871891021729 / 0.9146919250488281
after epoch: 29,now: 2024-07-26 08:09:07.185732,epoch time: 0:01:21.660949,used: 0:39:39.851117,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.98639894, 'precision': 0.98648596, 'recall': 0.98661005, 'specificity': 0.98661005, 'f1': 0.9863986, 'auroc': 0.99962234, 'binary_precision': 0.9986954, 'binary_recall': 0.9745385, 'binary_specificity': 0.9986816, 'binary_f1_score': 0.98646903}
confusion matrix:
      0     1
0  1515     2
1    40  1531
---- Validation: 
scalar performance:
{'acc': 0.72677594, 'precision': 0.80979717, 'recall': 0.7233085, 'specificity': 0.7233085, 'f1': 0.70514, 'auroc': 0.91572416, 'binary_precision': 0.9668874, 'binary_recall': 0.4620253, 'binary_specificity': 0.98459166, 'binary_f1_score': 0.6252677}
confusion matrix:
     0    1
0  639   10
1  340  292
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57109004, 'precision': 0.7536058, 'recall': 0.57109004, 'specificity': 0.57109004, 'f1': 0.4769897, 'auroc': 0.90021, 'binary_precision': 0.96875, 'binary_recall': 0.14691943, 'binary_specificity': 0.99526066, 'binary_f1_score': 0.25514403}
confusion matrix:
     0   1
0  210   1
1  180  31
early stop counter: 4
val acc:0.7267759442329407, best validation acc: 0.8711943626403809, corresponding to test acc:                         0.8056871891021729 / 0.9146919250488281
after epoch: 30,now: 2024-07-26 08:10:28.722611,epoch time: 0:01:21.536879,used: 0:41:01.387996,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_07_29_27_seed_4_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:01.387996 at 2024-07-26 08:10:28.722611
persisted model performance metric: 

scalar performance:
{'acc': 0.8056872, 'precision': 0.8512582, 'recall': 0.8056872, 'specificity': 0.8056872, 'f1': 0.7991736, 'auroc': 0.9256755, 'binary_precision': 0.9777778, 'binary_recall': 0.6255924, 'binary_specificity': 0.98578197, 'binary_f1_score': 0.76300573}
confusion matrix:
     0    1
0  208    3
1   79  132
oracle model performance metric: 

scalar performance:
{'acc': 0.9146919, 'precision': 0.91603756, 'recall': 0.9146919, 'specificity': 0.9146919, 'f1': 0.9146229, 'auroc': 0.95795244, 'binary_precision': 0.9396985, 'binary_recall': 0.8862559, 'binary_specificity': 0.943128, 'binary_f1_score': 0.91219515}
confusion matrix:
     0    1
0  199   12
1   24  187
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455124 KiB |  13219 MiB | 367416 GiB | 367415 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 363064 GiB | 363064 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455124 KiB |  13219 MiB | 367416 GiB | 367415 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 363064 GiB | 363064 GiB |
|       from small pool |  40592 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447480 KiB |  13213 MiB | 366738 GiB | 366737 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |  40405 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  68862 MiB |  54388 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  68726 MiB |  54318 MiB |
|       from small pool |     66 MiB |     70 MiB |    136 MiB |     70 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448044 KiB |   1252 MiB | 262231 GiB | 262231 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 257852 GiB | 257852 GiB |
|       from small pool |  12655 KiB |     44 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1298    |    2598    |   64613 K  |   64612 K  |
|       from large pool |     187    |    1413    |   32814 K  |   32813 K  |
|       from small pool |    1111    |    1419    |   31799 K  |   31798 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1298    |    2598    |   64613 K  |   64612 K  |
|       from large pool |     187    |    1413    |   32814 K  |   32813 K  |
|       from small pool |    1111    |    1419    |   31799 K  |   31798 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    2925    |    2291    |
|       from large pool |     601    |     601    |    2857    |    2256    |
|       from small pool |      33    |      35    |      68    |      35    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     102    |     651    |   41941 K  |   41941 K  |
|       from large pool |      40    |     604    |   23335 K  |   23335 K  |
|       from small pool |      62    |     237    |   18605 K  |   18605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367416 GiB | 367416 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363064 GiB | 363064 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367416 GiB | 367416 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363064 GiB | 363064 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  68862 MiB |  67980 MiB |
|       from large pool |    830 MiB |  14414 MiB |  68726 MiB |  67896 MiB |
|       from small pool |     52 MiB |     70 MiB |    136 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 262231 GiB | 262231 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 257852 GiB | 257852 GiB |
|       from small pool |      0 KiB |     44 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31799 K  |   31799 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31799 K  |   31799 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    2925    |    2862    |
|       from large pool |      37    |     601    |    2857    |    2820    |
|       from small pool |      26    |      35    |      68    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   41941 K  |   41941 K  |
|       from large pool |       4    |     604    |   23335 K  |   23335 K  |
|       from small pool |       0    |     237    |   18605 K  |   18605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 367416 GiB | 367416 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363064 GiB | 363064 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 367416 GiB | 367416 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 363064 GiB | 363064 GiB |
|       from small pool |      0 KiB |     60 MiB |   4351 GiB |   4351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 366738 GiB | 366738 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 362395 GiB | 362395 GiB |
|       from small pool |      0 KiB |     60 MiB |   4342 GiB |   4342 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  68862 MiB |  67980 MiB |
|       from large pool |    830 MiB |  14414 MiB |  68726 MiB |  67896 MiB |
|       from small pool |     52 MiB |     70 MiB |    136 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 262231 GiB | 262231 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 257852 GiB | 257852 GiB |
|       from small pool |      0 KiB |     44 MiB |   4379 GiB |   4379 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31799 K  |   31799 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   64613 K  |   64613 K  |
|       from large pool |       2    |    1413    |   32814 K  |   32814 K  |
|       from small pool |       0    |    1419    |   31799 K  |   31799 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    2925    |    2862    |
|       from large pool |      37    |     601    |    2857    |    2820    |
|       from small pool |      26    |      35    |      68    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   41941 K  |   41941 K  |
|       from large pool |       4    |     604    |   23335 K  |   23335 K  |
|       from small pool |       0    |     237    |   18605 K  |   18605 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529

 Experiment start at: 2024-07-26 08:11:05.000658
before training, model accuracy: 0.5476190447807312
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95615184, 'precision': 0.95617306, 'recall': 0.9561145, 'specificity': 0.9561145, 'f1': 0.95614004, 'auroc': 0.99101746, 'binary_precision': 0.95501286, 'binary_recall': 0.95870966, 'binary_specificity': 0.9535193, 'binary_f1_score': 0.9568577}
confusion matrix:
      0     1
0  1436    70
1    64  1486
---- Validation: 
scalar performance:
{'acc': 0.7659409, 'precision': 0.80099833, 'recall': 0.77061546, 'specificity': 0.77061546, 'f1': 0.7608849, 'auroc': 0.8932527, 'binary_precision': 0.6910377, 'binary_recall': 0.9376, 'binary_specificity': 0.60363084, 'binary_f1_score': 0.7956551}
confusion matrix:
     0    1
0  399  262
1   39  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77056277, 'precision': 0.78876734, 'recall': 0.77056277, 'specificity': 0.77056277, 'f1': 0.76688874, 'auroc': 0.9105902, 'binary_precision': 0.716263, 'binary_recall': 0.8961039, 'binary_specificity': 0.6450216, 'binary_f1_score': 0.79615384}
confusion matrix:
     0    1
0  149   82
1   24  207
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 08:12:33.772920,epoch time: 0:01:28.772262,used: 0:01:28.772262,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9466623, 'precision': 0.9512415, 'recall': 0.946, 'specificity': 0.946, 'f1': 0.94646186, 'auroc': 0.9973855, 'binary_precision': 0.90909094, 'binary_recall': 0.9941898, 'binary_specificity': 0.8978102, 'binary_f1_score': 0.9497379}
confusion matrix:
      0     1
0  1353   154
1     9  1540
---- Validation: 
scalar performance:
{'acc': 0.7379471, 'precision': 0.78630126, 'recall': 0.7435583, 'specificity': 0.7435583, 'f1': 0.7292099, 'auroc': 0.91164905, 'binary_precision': 0.66143495, 'binary_recall': 0.944, 'binary_specificity': 0.5431165, 'binary_f1_score': 0.77785105}
confusion matrix:
     0    1
0  359  302
1   35  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948052, 'precision': 0.77189267, 'recall': 0.6948052, 'specificity': 0.6948052, 'f1': 0.67152256, 'auroc': 0.9082663, 'binary_precision': 0.62711865, 'binary_recall': 0.96103895, 'binary_specificity': 0.42857143, 'binary_f1_score': 0.7589743}
confusion matrix:
    0    1
0  99  132
1   9  222
early stop counter: 1
val acc:0.7379471063613892, best validation acc: 0.7659409046173096, corresponding to test acc:                         0.7705627679824829 / 0.7705627679824829
after epoch: 2,now: 2024-07-26 08:13:55.311243,epoch time: 0:01:21.538323,used: 0:02:50.310585,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.970877, 'precision': 0.9720031, 'recall': 0.97131705, 'specificity': 0.97131705, 'f1': 0.97087216, 'auroc': 0.99699473, 'binary_precision': 0.9993174, 'binary_recall': 0.943299, 'binary_specificity': 0.9993351, 'binary_f1_score': 0.97050047}
confusion matrix:
      0     1
0  1503     1
1    88  1464
---- Validation: 
scalar performance:
{'acc': 0.83903575, 'precision': 0.83922833, 'recall': 0.8394542, 'specificity': 0.8394542, 'f1': 0.83902395, 'auroc': 0.90149474, 'binary_precision': 0.82153845, 'binary_recall': 0.8544, 'binary_specificity': 0.8245083, 'binary_f1_score': 0.8376471}
confusion matrix:
     0    1
0  545  116
1   91  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8311937, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.8311657, 'auroc': 0.9101591, 'binary_precision': 0.83406115, 'binary_recall': 0.8268398, 'binary_specificity': 0.83549786, 'binary_f1_score': 0.8304348}
confusion matrix:
     0    1
0  193   38
1   40  191
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 08:15:18.557116,epoch time: 0:01:23.245873,used: 0:04:13.556458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.97971207, 'precision': 0.97978073, 'recall': 0.97991395, 'specificity': 0.97991395, 'f1': 0.9797114, 'auroc': 0.9980126, 'binary_precision': 0.9914417, 'binary_recall': 0.96848875, 'binary_specificity': 0.9913391, 'binary_f1_score': 0.9798309}
confusion matrix:
      0     1
0  1488    13
1    49  1506
---- Validation: 
scalar performance:
{'acc': 0.79004663, 'precision': 0.790923, 'recall': 0.7890978, 'specificity': 0.7890978, 'f1': 0.7893865, 'auroc': 0.87765443, 'binary_precision': 0.8013582, 'binary_recall': 0.7552, 'binary_specificity': 0.8229955, 'binary_f1_score': 0.77759475}
confusion matrix:
     0    1
0  544  117
1  153  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83116883, 'precision': 0.8317906, 'recall': 0.83116883, 'specificity': 0.83116883, 'f1': 0.83108974, 'auroc': 0.9025693, 'binary_precision': 0.8174274, 'binary_recall': 0.85281384, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.83474576}
confusion matrix:
     0    1
0  187   44
1   34  197
early stop counter: 1
val acc:0.7900466322898865, best validation acc: 0.8390357494354248, corresponding to test acc:                         0.8311688303947449 / 0.8311688303947449
after epoch: 4,now: 2024-07-26 08:16:40.812119,epoch time: 0:01:22.255003,used: 0:05:35.811461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9754581, 'precision': 0.9757558, 'recall': 0.97570384, 'specificity': 0.97570384, 'f1': 0.975458, 'auroc': 0.997682, 'binary_precision': 0.992, 'binary_recall': 0.95938104, 'binary_specificity': 0.99202657, 'binary_f1_score': 0.9754179}
confusion matrix:
      0     1
0  1493    12
1    63  1488
---- Validation: 
scalar performance:
{'acc': 0.7799378, 'precision': 0.82650256, 'recall': 0.77455854, 'specificity': 0.77455854, 'f1': 0.7693926, 'auroc': 0.8968158, 'binary_precision': 0.9430052, 'binary_recall': 0.5824, 'binary_specificity': 0.9667171, 'binary_f1_score': 0.7200792}
confusion matrix:
     0    1
0  639   22
1  261  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84415585, 'precision': 0.85968626, 'recall': 0.84415585, 'specificity': 0.84415585, 'f1': 0.84245527, 'auroc': 0.90905344, 'binary_precision': 0.93442625, 'binary_recall': 0.74025977, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.826087}
confusion matrix:
     0    1
0  219   12
1   60  171
new oracle model saved
early stop counter: 2
val acc:0.7799378037452698, best validation acc: 0.8390357494354248, corresponding to test acc:                         0.8311688303947449 / 0.8441558480262756
after epoch: 5,now: 2024-07-26 08:18:04.051276,epoch time: 0:01:23.239157,used: 0:06:59.050618,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9806937, 'precision': 0.98089445, 'recall': 0.98056126, 'specificity': 0.98056126, 'f1': 0.9806814, 'auroc': 0.9988535, 'binary_precision': 0.97463536, 'binary_recall': 0.9877892, 'binary_specificity': 0.97333336, 'binary_f1_score': 0.9811682}
confusion matrix:
      0     1
0  1460    40
1    19  1537
---- Validation: 
scalar performance:
{'acc': 0.83825815, 'precision': 0.83811474, 'recall': 0.838262, 'specificity': 0.838262, 'f1': 0.8381701, 'auroc': 0.90251136, 'binary_precision': 0.8304279, 'binary_recall': 0.8384, 'binary_specificity': 0.83812404, 'binary_f1_score': 0.83439493}
confusion matrix:
     0    1
0  554  107
1  101  524
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85714287, 'precision': 0.86246836, 'recall': 0.85714287, 'specificity': 0.85714287, 'f1': 0.8566162, 'auroc': 0.9130826, 'binary_precision': 0.90640396, 'binary_recall': 0.7965368, 'binary_specificity': 0.9177489, 'binary_f1_score': 0.84792626}
confusion matrix:
     0    1
0  212   19
1   47  184
new oracle model saved
early stop counter: 3
val acc:0.8382581472396851, best validation acc: 0.8390357494354248, corresponding to test acc:                         0.8311688303947449 / 0.8571428656578064
after epoch: 6,now: 2024-07-26 08:19:27.187757,epoch time: 0:01:23.136481,used: 0:08:22.187099,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98331153, 'precision': 0.98329294, 'recall': 0.9833234, 'specificity': 0.9833234, 'f1': 0.9833072, 'auroc': 0.99887455, 'binary_precision': 0.9845261, 'binary_recall': 0.9826255, 'binary_specificity': 0.9840213, 'binary_f1_score': 0.98357487}
confusion matrix:
      0     1
0  1478    24
1    27  1527
---- Validation: 
scalar performance:
{'acc': 0.84914464, 'precision': 0.8493056, 'recall': 0.8495492, 'specificity': 0.8495492, 'f1': 0.84913146, 'auroc': 0.9072871, 'binary_precision': 0.8320493, 'binary_recall': 0.864, 'binary_specificity': 0.8350983, 'binary_f1_score': 0.8477237}
confusion matrix:
     0    1
0  552  109
1   85  540
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.84215164, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.8419728, 'auroc': 0.9272877, 'binary_precision': 0.83474576, 'binary_recall': 0.85281384, 'binary_specificity': 0.83116883, 'binary_f1_score': 0.8436831}
confusion matrix:
     0    1
0  192   39
1   34  197
better model found
persisted
after epoch: 7,now: 2024-07-26 08:20:50.758527,epoch time: 0:01:23.570770,used: 0:09:45.757869,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98134816, 'precision': 0.9813187, 'recall': 0.9813981, 'specificity': 0.9813981, 'f1': 0.9813457, 'auroc': 0.9984033, 'binary_precision': 0.9850649, 'binary_recall': 0.97807866, 'binary_specificity': 0.9847176, 'binary_f1_score': 0.9815594}
confusion matrix:
      0     1
0  1482    23
1    34  1517
---- Validation: 
scalar performance:
{'acc': 0.8452566, 'precision': 0.8464552, 'recall': 0.8461156, 'specificity': 0.8461156, 'f1': 0.84524906, 'auroc': 0.8988127, 'binary_precision': 0.81791043, 'binary_recall': 0.8768, 'binary_specificity': 0.8154312, 'binary_f1_score': 0.846332}
confusion matrix:
     0    1
0  539  122
1   77  548
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8095238, 'precision': 0.8155798, 'recall': 0.8095238, 'specificity': 0.8095238, 'f1': 0.8086056, 'auroc': 0.8687993, 'binary_precision': 0.7718631, 'binary_recall': 0.8787879, 'binary_specificity': 0.74025977, 'binary_f1_score': 0.82186234}
confusion matrix:
     0    1
0  171   60
1   28  203
early stop counter: 1
val acc:0.8452566266059875, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 8,now: 2024-07-26 08:22:12.346150,epoch time: 0:01:21.587623,used: 0:11:07.345492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.98559034, 'recall': 0.9856087, 'specificity': 0.9856087, 'f1': 0.9855991, 'auroc': 0.99885106, 'binary_precision': 0.98644286, 'binary_recall': 0.98517084, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.98580647}
confusion matrix:
      0     1
0  1484    21
1    23  1528
---- Validation: 
scalar performance:
{'acc': 0.84136856, 'precision': 0.8432099, 'recall': 0.84028566, 'specificity': 0.84028566, 'f1': 0.84075236, 'auroc': 0.8973628, 'binary_precision': 0.86230636, 'binary_recall': 0.8016, 'binary_specificity': 0.8789713, 'binary_f1_score': 0.8308458}
confusion matrix:
     0    1
0  581   80
1  124  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84199136, 'precision': 0.84215164, 'recall': 0.8419913, 'specificity': 0.8419913, 'f1': 0.8419728, 'auroc': 0.9094095, 'binary_precision': 0.8495575, 'binary_recall': 0.83116883, 'binary_specificity': 0.85281384, 'binary_f1_score': 0.8402626}
confusion matrix:
     0    1
0  197   34
1   39  192
early stop counter: 2
val acc:0.841368556022644, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 9,now: 2024-07-26 08:23:33.758692,epoch time: 0:01:21.412542,used: 0:12:28.758034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9829843, 'precision': 0.98305523, 'recall': 0.9829186, 'specificity': 0.9829186, 'f1': 0.9829763, 'auroc': 0.99910676, 'binary_precision': 0.98020434, 'binary_recall': 0.98650384, 'binary_specificity': 0.97933334, 'binary_f1_score': 0.98334396}
confusion matrix:
      0     1
0  1469    31
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.8452566, 'precision': 0.8475719, 'recall': 0.84406775, 'specificity': 0.84406775, 'f1': 0.8445776, 'auroc': 0.9108962, 'binary_precision': 0.8697917, 'binary_recall': 0.8016, 'binary_specificity': 0.8865355, 'binary_f1_score': 0.8343047}
confusion matrix:
     0    1
0  586   75
1  124  501
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.8598951, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.85448134, 'auroc': 0.9050805, 'binary_precision': 0.9019608, 'binary_recall': 0.7965368, 'binary_specificity': 0.9134199, 'binary_f1_score': 0.845977}
confusion matrix:
     0    1
0  211   20
1   47  184
early stop counter: 3
val acc:0.8452566266059875, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 10,now: 2024-07-26 08:24:56.143508,epoch time: 0:01:22.384816,used: 0:13:51.142850,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.98625654, 'precision': 0.9862443, 'recall': 0.98626345, 'specificity': 0.98626345, 'f1': 0.98625344, 'auroc': 0.9991157, 'binary_precision': 0.9870968, 'binary_recall': 0.98582476, 'binary_specificity': 0.98670214, 'binary_f1_score': 0.9864603}
confusion matrix:
      0     1
0  1484    20
1    22  1530
---- Validation: 
scalar performance:
{'acc': 0.8421462, 'precision': 0.8471178, 'recall': 0.84043205, 'specificity': 0.84043205, 'f1': 0.841004, 'auroc': 0.9109731, 'binary_precision': 0.8822464, 'binary_recall': 0.7792, 'binary_specificity': 0.90166414, 'binary_f1_score': 0.8275277}
confusion matrix:
     0    1
0  596   65
1  138  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82251084, 'precision': 0.85310954, 'recall': 0.82251084, 'specificity': 0.82251084, 'f1': 0.8185806, 'auroc': 0.90869737, 'binary_precision': 0.9570552, 'binary_recall': 0.6753247, 'binary_specificity': 0.969697, 'binary_f1_score': 0.7918782}
confusion matrix:
     0    1
0  224    7
1   75  156
early stop counter: 4
val acc:0.8421462178230286, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 11,now: 2024-07-26 08:26:18.218356,epoch time: 0:01:22.074848,used: 0:15:13.217698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98363876, 'precision': 0.9841244, 'recall': 0.98343086, 'specificity': 0.98343086, 'f1': 0.9836252, 'auroc': 0.9993527, 'binary_precision': 0.97234446, 'binary_recall': 0.9961365, 'binary_specificity': 0.97072524, 'binary_f1_score': 0.9840967}
confusion matrix:
      0     1
0  1459    44
1     6  1547
---- Validation: 
scalar performance:
{'acc': 0.8289269, 'precision': 0.8331337, 'recall': 0.83049196, 'specificity': 0.83049196, 'f1': 0.8287443, 'auroc': 0.9067013, 'binary_precision': 0.7880512, 'binary_recall': 0.8864, 'binary_specificity': 0.77458394, 'binary_f1_score': 0.8343374}
confusion matrix:
     0    1
0  512  149
1   71  554
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78571427, 'precision': 0.7950077, 'recall': 0.78571427, 'specificity': 0.78571427, 'f1': 0.7840133, 'auroc': 0.8842788, 'binary_precision': 0.74264705, 'binary_recall': 0.87445885, 'binary_specificity': 0.6969697, 'binary_f1_score': 0.8031809}
confusion matrix:
     0    1
0  161   70
1   29  202
early stop counter: 5
val acc:0.8289269208908081, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 12,now: 2024-07-26 08:27:40.479854,epoch time: 0:01:22.261498,used: 0:16:35.479196,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9849476, 'precision': 0.9852201, 'recall': 0.9847985, 'specificity': 0.9847985, 'f1': 0.9849378, 'auroc': 0.99947476, 'binary_precision': 0.9772152, 'binary_recall': 0.993565, 'binary_specificity': 0.97603196, 'binary_f1_score': 0.9853223}
confusion matrix:
      0     1
0  1466    36
1    10  1544
---- Validation: 
scalar performance:
{'acc': 0.7636081, 'precision': 0.80749816, 'recall': 0.75819427, 'specificity': 0.75819427, 'f1': 0.7521938, 'auroc': 0.8799921, 'binary_precision': 0.9168831, 'binary_recall': 0.5648, 'binary_specificity': 0.9515885, 'binary_f1_score': 0.6990099}
confusion matrix:
     0    1
0  629   32
1  272  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813853, 'precision': 0.83307457, 'recall': 0.7813853, 'specificity': 0.7813853, 'f1': 0.7725613, 'auroc': 0.91660583, 'binary_precision': 0.96428573, 'binary_recall': 0.58441556, 'binary_specificity': 0.978355, 'binary_f1_score': 0.72776276}
confusion matrix:
     0    1
0  226    5
1   96  135
early stop counter: 6
val acc:0.7636080980300903, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 13,now: 2024-07-26 08:29:03.792706,epoch time: 0:01:23.312852,used: 0:17:58.792048,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97218585, 'precision': 0.97321105, 'recall': 0.9725884, 'specificity': 0.9725884, 'f1': 0.9721818, 'auroc': 0.99911714, 'binary_precision': 0.9993188, 'binary_recall': 0.9458414, 'binary_specificity': 0.9993355, 'binary_f1_score': 0.971845}
confusion matrix:
      0     1
0  1504     1
1    84  1467
---- Validation: 
scalar performance:
{'acc': 0.6982893, 'precision': 0.78888756, 'recall': 0.69025356, 'specificity': 0.69025356, 'f1': 0.667035, 'auroc': 0.8801863, 'binary_precision': 0.94382024, 'binary_recall': 0.4032, 'binary_specificity': 0.9773071, 'binary_f1_score': 0.5650224}
confusion matrix:
     0    1
0  646   15
1  373  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63203466, 'precision': 0.78028405, 'recall': 0.6320346, 'specificity': 0.6320346, 'f1': 0.57596374, 'auroc': 0.9122956, 'binary_precision': 0.984127, 'binary_recall': 0.26839826, 'binary_specificity': 0.995671, 'binary_f1_score': 0.4217687}
confusion matrix:
     0   1
0  230   1
1  169  62
early stop counter: 7
val acc:0.6982892751693726, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 14,now: 2024-07-26 08:30:25.542677,epoch time: 0:01:21.749971,used: 0:19:20.542019,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.98853916, 'recall': 0.9885494, 'specificity': 0.9885494, 'f1': 0.98854417, 'auroc': 0.9996033, 'binary_precision': 0.9890464, 'binary_recall': 0.9884095, 'binary_specificity': 0.9886893, 'binary_f1_score': 0.98872787}
confusion matrix:
      0     1
0  1486    17
1    18  1535
---- Validation: 
scalar performance:
{'acc': 0.83748055, 'precision': 0.83781886, 'recall': 0.83798486, 'specificity': 0.83798486, 'f1': 0.8374758, 'auroc': 0.9029446, 'binary_precision': 0.8180428, 'binary_recall': 0.856, 'binary_specificity': 0.8199697, 'binary_f1_score': 0.8365911}
confusion matrix:
     0    1
0  542  119
1   90  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85281384, 'precision': 0.85411453, 'recall': 0.85281384, 'specificity': 0.85281384, 'f1': 0.85267854, 'auroc': 0.9162122, 'binary_precision': 0.875576, 'binary_recall': 0.82251084, 'binary_specificity': 0.8831169, 'binary_f1_score': 0.84821427}
confusion matrix:
     0    1
0  204   27
1   41  190
early stop counter: 8
val acc:0.8374805450439453, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 15,now: 2024-07-26 08:31:47.874450,epoch time: 0:01:22.331773,used: 0:20:42.873792,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9882087, 'recall': 0.9883719, 'specificity': 0.9883719, 'f1': 0.9882188, 'auroc': 0.99967647, 'binary_precision': 0.996732, 'binary_recall': 0.98007715, 'binary_specificity': 0.99666667, 'binary_f1_score': 0.9883344}
confusion matrix:
      0     1
0  1495     5
1    31  1525
---- Validation: 
scalar performance:
{'acc': 0.8087092, 'precision': 0.83973145, 'recall': 0.80442, 'specificity': 0.80442, 'f1': 0.802613, 'auroc': 0.9055782, 'binary_precision': 0.93563217, 'binary_recall': 0.6512, 'binary_specificity': 0.95763993, 'binary_f1_score': 0.76792455}
confusion matrix:
     0    1
0  633   28
1  218  407
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84632033, 'precision': 0.8781307, 'recall': 0.8463204, 'specificity': 0.8463204, 'f1': 0.84301883, 'auroc': 0.9307922, 'binary_precision': 0.9878049, 'binary_recall': 0.7012987, 'binary_specificity': 0.991342, 'binary_f1_score': 0.82025313}
confusion matrix:
     0    1
0  229    2
1   69  162
early stop counter: 9
val acc:0.8087092041969299, best validation acc: 0.8491446375846863, corresponding to test acc:                         0.8419913649559021 / 0.8571428656578064
after epoch: 16,now: 2024-07-26 08:33:10.424531,epoch time: 0:01:22.550081,used: 0:22:05.423873,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.9898326, 'recall': 0.9898869, 'specificity': 0.9898869, 'f1': 0.9898546, 'auroc': 0.9995069, 'binary_precision': 0.99222296, 'binary_recall': 0.98774195, 'binary_specificity': 0.9920319, 'binary_f1_score': 0.98997736}
confusion matrix:
      0     1
0  1494    12
1    19  1531
---- Validation: 
scalar performance:
{'acc': 0.85614306, 'precision': 0.8642372, 'recall': 0.8540478, 'specificity': 0.8540478, 'f1': 0.85472625, 'auroc': 0.9117532, 'binary_precision': 0.91198504, 'binary_recall': 0.7792, 'binary_specificity': 0.9288956, 'binary_f1_score': 0.84037966}
confusion matrix:
     0    1
0  614   47
1  138  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8246753, 'precision': 0.8352361, 'recall': 0.8246753, 'specificity': 0.8246753, 'f1': 0.82328355, 'auroc': 0.878057, 'binary_precision': 0.8947368, 'binary_recall': 0.73593074, 'binary_specificity': 0.9134199, 'binary_f1_score': 0.8076009}
confusion matrix:
     0    1
0  211   20
1   61  170
better model found
persisted
after epoch: 17,now: 2024-07-26 08:34:33.645241,epoch time: 0:01:23.220710,used: 0:23:28.644583,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9928011, 'precision': 0.9927727, 'recall': 0.99284863, 'specificity': 0.99284863, 'f1': 0.99280006, 'auroc': 0.9995082, 'binary_precision': 0.99610645, 'binary_recall': 0.98968405, 'binary_specificity': 0.9960133, 'binary_f1_score': 0.9928849}
confusion matrix:
      0     1
0  1499     6
1    16  1535
---- Validation: 
scalar performance:
{'acc': 0.8133748, 'precision': 0.8435104, 'recall': 0.80917645, 'specificity': 0.80917645, 'f1': 0.80764246, 'auroc': 0.9180914, 'binary_precision': 0.9384966, 'binary_recall': 0.6592, 'binary_specificity': 0.9591528, 'binary_f1_score': 0.7744362}
confusion matrix:
     0    1
0  634   27
1  213  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67099565, 'precision': 0.7467615, 'recall': 0.67099565, 'specificity': 0.67099565, 'f1': 0.6436416, 'auroc': 0.8919014, 'binary_precision': 0.88349515, 'binary_recall': 0.3939394, 'binary_specificity': 0.9480519, 'binary_f1_score': 0.5449102}
confusion matrix:
     0   1
0  219  12
1  140  91
early stop counter: 1
val acc:0.8133748173713684, best validation acc: 0.856143057346344, corresponding to test acc:                         0.8246753215789795 / 0.8571428656578064
after epoch: 18,now: 2024-07-26 08:35:56.340117,epoch time: 0:01:22.694876,used: 0:24:51.339459,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.99003416, 'recall': 0.989743, 'specificity': 0.989743, 'f1': 0.98985016, 'auroc': 0.9997344, 'binary_precision': 0.9841169, 'binary_recall': 0.9961415, 'binary_specificity': 0.98334444, 'binary_f1_score': 0.99009264}
confusion matrix:
      0     1
0  1476    25
1     6  1549
---- Validation: 
scalar performance:
{'acc': 0.86858475, 'precision': 0.87096065, 'recall': 0.86745775, 'specificity': 0.86745775, 'f1': 0.8680351, 'auroc': 0.9235002, 'binary_precision': 0.89446366, 'binary_recall': 0.8272, 'binary_specificity': 0.90771556, 'binary_f1_score': 0.8595179}
confusion matrix:
     0    1
0  600   61
1  108  517
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8181818, 'precision': 0.8325401, 'recall': 0.8181818, 'specificity': 0.8181818, 'f1': 0.8161978, 'auroc': 0.90661716, 'binary_precision': 0.90163934, 'binary_recall': 0.71428573, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.7971015}
confusion matrix:
     0    1
0  213   18
1   66  165
better model found
persisted
after epoch: 19,now: 2024-07-26 08:37:20.982483,epoch time: 0:01:24.642366,used: 0:26:15.981825,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.9940889, 'recall': 0.9941312, 'specificity': 0.9941312, 'f1': 0.99410844, 'auroc': 0.99985266, 'binary_precision': 0.9954868, 'binary_recall': 0.99292606, 'binary_specificity': 0.9953364, 'binary_f1_score': 0.9942048}
confusion matrix:
      0     1
0  1494     7
1    11  1544
---- Validation: 
scalar performance:
{'acc': 0.84059095, 'precision': 0.8541134, 'recall': 0.83782995, 'specificity': 0.83782995, 'f1': 0.8381792, 'auroc': 0.91580033, 'binary_precision': 0.9166667, 'binary_recall': 0.7392, 'binary_specificity': 0.9364599, 'binary_f1_score': 0.81842345}
confusion matrix:
     0    1
0  619   42
1  163  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7164502, 'precision': 0.7676089, 'recall': 0.7164502, 'specificity': 0.7164502, 'f1': 0.70221853, 'auroc': 0.87944376, 'binary_precision': 0.88461536, 'binary_recall': 0.4978355, 'binary_specificity': 0.9350649, 'binary_f1_score': 0.6371191}
confusion matrix:
     0    1
0  216   15
1  116  115
early stop counter: 1
val acc:0.8405909538269043, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 20,now: 2024-07-26 08:38:43.859941,epoch time: 0:01:22.877458,used: 0:27:38.859283,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99112254, 'recall': 0.99125195, 'specificity': 0.99125195, 'f1': 0.9911634, 'auroc': 0.9996311, 'binary_precision': 0.99610645, 'binary_recall': 0.98650384, 'binary_specificity': 0.996, 'binary_f1_score': 0.9912819}
confusion matrix:
      0     1
0  1494     6
1    21  1535
---- Validation: 
scalar performance:
{'acc': 0.66640747, 'precision': 0.77907777, 'recall': 0.65727925, 'specificity': 0.65727925, 'f1': 0.62149143, 'auroc': 0.9107866, 'binary_precision': 0.9495413, 'binary_recall': 0.3312, 'binary_specificity': 0.98335856, 'binary_f1_score': 0.49110323}
confusion matrix:
     0    1
0  650   11
1  418  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53896105, 'precision': 0.7147727, 'recall': 0.53896105, 'specificity': 0.53896105, 'f1': 0.42033303, 'auroc': 0.92089725, 'binary_precision': 0.90909094, 'binary_recall': 0.08658009, 'binary_specificity': 0.991342, 'binary_f1_score': 0.15810278}
confusion matrix:
     0   1
0  229   2
1  211  20
early stop counter: 2
val acc:0.6664074659347534, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 21,now: 2024-07-26 08:40:07.963438,epoch time: 0:01:24.103497,used: 0:29:02.962780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9947644, 'precision': 0.9947362, 'recall': 0.9948125, 'specificity': 0.9948125, 'f1': 0.99476373, 'auroc': 0.9998895, 'binary_precision': 0.9980532, 'binary_recall': 0.99161834, 'binary_specificity': 0.99800664, 'binary_f1_score': 0.9948254}
confusion matrix:
      0     1
0  1502     3
1    13  1538
---- Validation: 
scalar performance:
{'acc': 0.85069984, 'precision': 0.86743027, 'recall': 0.84770715, 'specificity': 0.84770715, 'f1': 0.84810764, 'auroc': 0.9330336, 'binary_precision': 0.93914807, 'binary_recall': 0.7408, 'binary_specificity': 0.9546142, 'binary_f1_score': 0.8282648}
confusion matrix:
     0    1
0  631   30
1  162  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8116883, 'precision': 0.85789293, 'recall': 0.8116883, 'specificity': 0.8116883, 'f1': 0.80540776, 'auroc': 0.914788, 'binary_precision': 0.9864865, 'binary_recall': 0.63203466, 'binary_specificity': 0.991342, 'binary_f1_score': 0.77044857}
confusion matrix:
     0    1
0  229    2
1   85  146
early stop counter: 3
val acc:0.8506998419761658, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 22,now: 2024-07-26 08:41:31.970456,epoch time: 0:01:24.007018,used: 0:30:26.969798,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.993116, 'recall': 0.9932164, 'specificity': 0.9932164, 'f1': 0.9931278, 'auroc': 0.9998852, 'binary_precision': 0.99934685, 'binary_recall': 0.9870968, 'binary_specificity': 0.999336, 'binary_f1_score': 0.99318403}
confusion matrix:
      0     1
0  1505     1
1    20  1530
---- Validation: 
scalar performance:
{'acc': 0.7822706, 'precision': 0.83761114, 'recall': 0.7765229, 'specificity': 0.7765229, 'f1': 0.7704351, 'auroc': 0.9252163, 'binary_precision': 0.96747965, 'binary_recall': 0.5712, 'binary_specificity': 0.9818457, 'binary_f1_score': 0.71830994}
confusion matrix:
     0    1
0  649   12
1  268  357
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65584415, 'precision': 0.7619047, 'recall': 0.65584415, 'specificity': 0.65584415, 'f1': 0.6170772, 'auroc': 0.9001143, 'binary_precision': 0.9285714, 'binary_recall': 0.33766234, 'binary_specificity': 0.97402596, 'binary_f1_score': 0.4952381}
confusion matrix:
     0   1
0  225   6
1  153  78
early stop counter: 4
val acc:0.782270610332489, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 23,now: 2024-07-26 08:42:56.055015,epoch time: 0:01:24.084559,used: 0:31:51.054357,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9950916, 'precision': 0.99506557, 'recall': 0.99512637, 'specificity': 0.99512637, 'f1': 0.9950907, 'auroc': 0.9996894, 'binary_precision': 0.997411, 'binary_recall': 0.99291235, 'binary_specificity': 0.99734044, 'binary_f1_score': 0.99515665}
confusion matrix:
      0     1
0  1500     4
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.7923795, 'precision': 0.82320964, 'recall': 0.7879685, 'specificity': 0.7879685, 'f1': 0.78545713, 'auroc': 0.8827909, 'binary_precision': 0.9162791, 'binary_recall': 0.6304, 'binary_specificity': 0.9455371, 'binary_f1_score': 0.7469195}
confusion matrix:
     0    1
0  625   36
1  231  394
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75974023, 'precision': 0.8241954, 'recall': 0.75974023, 'specificity': 0.75974023, 'f1': 0.7471738, 'auroc': 0.90538037, 'binary_precision': 0.96875, 'binary_recall': 0.5367965, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.69080776}
confusion matrix:
     0    1
0  227    4
1  107  124
early stop counter: 5
val acc:0.7923794984817505, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 24,now: 2024-07-26 08:44:17.517095,epoch time: 0:01:21.462080,used: 0:33:12.516437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9960733, 'precision': 0.99604964, 'recall': 0.99610317, 'specificity': 0.99610317, 'f1': 0.99607253, 'auroc': 0.9998762, 'binary_precision': 0.9980595, 'binary_recall': 0.994201, 'binary_specificity': 0.99800533, 'binary_f1_score': 0.9961266}
confusion matrix:
      0     1
0  1501     3
1     9  1543
---- Validation: 
scalar performance:
{'acc': 0.6749611, 'precision': 0.78345656, 'recall': 0.6660793, 'specificity': 0.6660793, 'f1': 0.63361627, 'auroc': 0.88458216, 'binary_precision': 0.9519651, 'binary_recall': 0.3488, 'binary_specificity': 0.98335856, 'binary_f1_score': 0.5105387}
confusion matrix:
     0    1
0  650   11
1  407  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5367965, 'precision': 0.7332779, 'recall': 0.5367965, 'specificity': 0.5367965, 'f1': 0.41324627, 'auroc': 0.85764885, 'binary_precision': 0.94736844, 'binary_recall': 0.077922076, 'binary_specificity': 0.995671, 'binary_f1_score': 0.14400001}
confusion matrix:
     0   1
0  230   1
1  213  18
early stop counter: 6
val acc:0.6749610900878906, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 25,now: 2024-07-26 08:45:40.924037,epoch time: 0:01:23.406942,used: 0:34:35.923379,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.993434, 'recall': 0.99356085, 'specificity': 0.99356085, 'f1': 0.9934549, 'auroc': 0.9999186, 'binary_precision': 1.0, 'binary_recall': 0.9871217, 'binary_specificity': 1.0, 'binary_f1_score': 0.9935191}
confusion matrix:
      0     1
0  1503     0
1    20  1533
---- Validation: 
scalar performance:
{'acc': 0.6718507, 'precision': 0.776332, 'recall': 0.66301, 'specificity': 0.66301, 'f1': 0.6305443, 'auroc': 0.90149534, 'binary_precision': 0.93939394, 'binary_recall': 0.3472, 'binary_specificity': 0.97881997, 'binary_f1_score': 0.5070093}
confusion matrix:
     0    1
0  647   14
1  408  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5800866, 'precision': 0.73719263, 'recall': 0.5800866, 'specificity': 0.5800866, 'f1': 0.49675465, 'auroc': 0.90442455, 'binary_precision': 0.9302326, 'binary_recall': 0.17316018, 'binary_specificity': 0.987013, 'binary_f1_score': 0.29197082}
confusion matrix:
     0   1
0  228   3
1  191  40
early stop counter: 7
val acc:0.6718506813049316, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 26,now: 2024-07-26 08:47:04.349192,epoch time: 0:01:23.425155,used: 0:35:59.348534,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99018323, 'precision': 0.99015206, 'recall': 0.9902663, 'specificity': 0.9902663, 'f1': 0.99018204, 'auroc': 0.99962556, 'binary_precision': 0.99544567, 'binary_recall': 0.98519, 'binary_specificity': 0.9953427, 'binary_f1_score': 0.9902913}
confusion matrix:
      0     1
0  1496     7
1    23  1530
---- Validation: 
scalar performance:
{'acc': 0.70995337, 'precision': 0.7868663, 'recall': 0.702515, 'specificity': 0.702515, 'f1': 0.6842369, 'auroc': 0.9001634, 'binary_precision': 0.9285714, 'binary_recall': 0.4368, 'binary_specificity': 0.96822995, 'binary_f1_score': 0.594124}
confusion matrix:
     0    1
0  640   21
1  352  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73376626, 'precision': 0.8144283, 'recall': 0.7337662, 'specificity': 0.7337662, 'f1': 0.7155215, 'auroc': 0.9418489, 'binary_precision': 0.9736842, 'binary_recall': 0.48051947, 'binary_specificity': 0.987013, 'binary_f1_score': 0.6434783}
confusion matrix:
     0    1
0  228    3
1  120  111
early stop counter: 8
val acc:0.7099533677101135, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 27,now: 2024-07-26 08:48:27.760117,epoch time: 0:01:23.410925,used: 0:37:22.759459,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99640054, 'precision': 0.99637735, 'recall': 0.9964273, 'specificity': 0.9964273, 'f1': 0.99639964, 'auroc': 0.9999387, 'binary_precision': 0.99806327, 'binary_recall': 0.994852, 'binary_specificity': 0.99800265, 'binary_f1_score': 0.996455}
confusion matrix:
      0     1
0  1499     3
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.785381, 'precision': 0.8297929, 'recall': 0.7801585, 'specificity': 0.7801585, 'f1': 0.775637, 'auroc': 0.90523446, 'binary_precision': 0.94402033, 'binary_recall': 0.5936, 'binary_specificity': 0.9667171, 'binary_f1_score': 0.7288801}
confusion matrix:
     0    1
0  639   22
1  254  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55411255, 'precision': 0.71611404, 'recall': 0.55411255, 'specificity': 0.55411255, 'f1': 0.4512811, 'auroc': 0.9038061, 'binary_precision': 0.9032258, 'binary_recall': 0.121212125, 'binary_specificity': 0.987013, 'binary_f1_score': 0.21374047}
confusion matrix:
     0   1
0  228   3
1  203  28
early stop counter: 9
val acc:0.785381019115448, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 28,now: 2024-07-26 08:49:50.610502,epoch time: 0:01:22.850385,used: 0:38:45.609844,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.99345374, 'recall': 0.99345374, 'specificity': 0.99345374, 'f1': 0.99345374, 'auroc': 0.99970436, 'binary_precision': 0.99356085, 'binary_recall': 0.99356085, 'binary_specificity': 0.99334663, 'binary_f1_score': 0.99356085}
confusion matrix:
      0     1
0  1493    10
1    10  1543
---- Validation: 
scalar performance:
{'acc': 0.7636081, 'precision': 0.8092487, 'recall': 0.7581071, 'specificity': 0.7581071, 'f1': 0.751844, 'auroc': 0.90309477, 'binary_precision': 0.9212598, 'binary_recall': 0.5616, 'binary_specificity': 0.9546142, 'binary_f1_score': 0.6978131}
confusion matrix:
     0    1
0  631   30
1  274  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6147186, 'precision': 0.7502555, 'recall': 0.6147186, 'specificity': 0.6147186, 'f1': 0.5543827, 'auroc': 0.9206115, 'binary_precision': 0.93442625, 'binary_recall': 0.24675325, 'binary_specificity': 0.98268396, 'binary_f1_score': 0.39041096}
confusion matrix:
     0   1
0  227   4
1  174  57
early stop counter: 10
val acc:0.7636080980300903, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 29,now: 2024-07-26 08:51:13.049105,epoch time: 0:01:22.438603,used: 0:40:08.048447,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9906055, 'recall': 0.9904443, 'specificity': 0.9904443, 'f1': 0.99050695, 'auroc': 0.9996989, 'binary_precision': 0.98657286, 'binary_recall': 0.99484205, 'binary_specificity': 0.9860465, 'binary_f1_score': 0.99069023}
confusion matrix:
      0     1
0  1484    21
1     8  1543
---- Validation: 
scalar performance:
{'acc': 0.86780715, 'precision': 0.8690891, 'recall': 0.8669628, 'specificity': 0.8669628, 'f1': 0.86741436, 'auroc': 0.92151046, 'binary_precision': 0.8849408, 'binary_recall': 0.8368, 'binary_specificity': 0.89712554, 'binary_f1_score': 0.8601974}
confusion matrix:
     0    1
0  593   68
1  102  523
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8549784, 'precision': 0.8643253, 'recall': 0.8549783, 'specificity': 0.8549783, 'f1': 0.85404223, 'auroc': 0.9187609, 'binary_precision': 0.92268044, 'binary_recall': 0.7748918, 'binary_specificity': 0.9350649, 'binary_f1_score': 0.842353}
confusion matrix:
     0    1
0  216   15
1   52  179
early stop counter: 11
val acc:0.867807149887085, best validation acc: 0.8685847520828247, corresponding to test acc:                         0.8181818127632141 / 0.8571428656578064
after epoch: 30,now: 2024-07-26 08:52:36.506329,epoch time: 0:01:23.457224,used: 0:41:31.505671,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_11_04_seed_5_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:31.505671 at 2024-07-26 08:52:36.506329
persisted model performance metric: 

scalar performance:
{'acc': 0.8181818, 'precision': 0.8325401, 'recall': 0.8181818, 'specificity': 0.8181818, 'f1': 0.8161978, 'auroc': 0.90661716, 'binary_precision': 0.90163934, 'binary_recall': 0.71428573, 'binary_specificity': 0.9220779, 'binary_f1_score': 0.7971015}
confusion matrix:
     0    1
0  213   18
1   66  165
oracle model performance metric: 

scalar performance:
{'acc': 0.85714287, 'precision': 0.86246836, 'recall': 0.85714287, 'specificity': 0.85714287, 'f1': 0.8566162, 'auroc': 0.9130826, 'binary_precision': 0.90640396, 'binary_recall': 0.7965368, 'binary_specificity': 0.9177489, 'binary_f1_score': 0.84792626}
confusion matrix:
     0    1
0  212   19
1   47  184
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 440884 GiB | 440883 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 435663 GiB | 435663 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 440884 GiB | 440883 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 435663 GiB | 435663 GiB |
|       from small pool |  40598 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 434945 GiB | 434945 GiB |
|       from small pool |  40407 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  82454 MiB |  67980 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  82304 MiB |  67896 MiB |
|       from small pool |     66 MiB |     70 MiB |    150 MiB |     84 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448038 KiB |   1252 MiB | 314713 GiB | 314712 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 309459 GiB | 309459 GiB |
|       from small pool |  12649 KiB |     44 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |   77546 K  |   77545 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38161 K  |   38160 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |   77546 K  |   77545 K  |
|       from large pool |     187    |    1413    |   39384 K  |   39384 K  |
|       from small pool |    1123    |    1419    |   38161 K  |   38160 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    3496    |    2862    |
|       from large pool |     601    |     601    |    3421    |    2820    |
|       from small pool |      33    |      35    |      75    |      42    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     651    |   50176 K  |   50176 K  |
|       from large pool |      40    |     604    |   27946 K  |   27946 K  |
|       from small pool |      59    |     237    |   22229 K  |   22229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 440884 GiB | 440884 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435663 GiB | 435663 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 440884 GiB | 440884 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435663 GiB | 435663 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434945 GiB | 434945 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  82454 MiB |  81572 MiB |
|       from large pool |    830 MiB |  14414 MiB |  82304 MiB |  81474 MiB |
|       from small pool |     52 MiB |     70 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 314713 GiB | 314713 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 309460 GiB | 309460 GiB |
|       from small pool |      0 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    3496    |    3433    |
|       from large pool |      37    |     601    |    3421    |    3384    |
|       from small pool |      26    |      35    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   50176 K  |   50176 K  |
|       from large pool |       4    |     604    |   27946 K  |   27946 K  |
|       from small pool |       0    |     237    |   22229 K  |   22229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 440884 GiB | 440884 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435663 GiB | 435663 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 440884 GiB | 440884 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 435663 GiB | 435663 GiB |
|       from small pool |      0 KiB |     60 MiB |   5220 GiB |   5220 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 440155 GiB | 440155 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 434945 GiB | 434945 GiB |
|       from small pool |      0 KiB |     60 MiB |   5209 GiB |   5209 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB |  82454 MiB |  81572 MiB |
|       from large pool |    830 MiB |  14414 MiB |  82304 MiB |  81474 MiB |
|       from small pool |     52 MiB |     70 MiB |    150 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 314713 GiB | 314713 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 309460 GiB | 309460 GiB |
|       from small pool |      0 KiB |     45 MiB |   5253 GiB |   5253 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   77546 K  |   77546 K  |
|       from large pool |       2    |    1413    |   39384 K  |   39384 K  |
|       from small pool |       0    |    1419    |   38161 K  |   38161 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    3496    |    3433    |
|       from large pool |      37    |     601    |    3421    |    3384    |
|       from small pool |      26    |      35    |      75    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     651    |   50176 K  |   50176 K  |
|       from large pool |       4    |     604    |   27946 K  |   27946 K  |
|       from small pool |       0    |     237    |   22229 K  |   22229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529

 Experiment start at: 2024-07-26 08:53:12.009774
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5247747898101807
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.9489107, 'recall': 0.9489626, 'specificity': 0.9489626, 'f1': 0.94889235, 'auroc': 0.98759985, 'binary_precision': 0.95561355, 'binary_recall': 0.94269156, 'binary_specificity': 0.9552337, 'binary_f1_score': 0.9491086}
confusion matrix:
      0     1
0  1451    68
1    89  1464
---- Validation: 
scalar performance:
{'acc': 0.78988326, 'precision': 0.8137046, 'recall': 0.7908432, 'specificity': 0.7908432, 'f1': 0.7861849, 'auroc': 0.90688396, 'binary_precision': 0.7254902, 'binary_recall': 0.92789966, 'binary_specificity': 0.6537867, 'binary_f1_score': 0.81430537}
confusion matrix:
     0    1
0  423  224
1   46  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7815315, 'precision': 0.81360894, 'recall': 0.7815315, 'specificity': 0.7815315, 'f1': 0.77579844, 'auroc': 0.9162811, 'binary_precision': 0.7133106, 'binary_recall': 0.9414414, 'binary_specificity': 0.6216216, 'binary_f1_score': 0.8116505}
confusion matrix:
     0    1
0  138   84
1   13  209
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 08:54:42.743999,epoch time: 0:01:30.734225,used: 0:01:30.734225,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97005206, 'precision': 0.97020805, 'recall': 0.9701929, 'specificity': 0.9701929, 'f1': 0.970052, 'auroc': 0.9959414, 'binary_precision': 0.98218995, 'binary_recall': 0.95817244, 'binary_specificity': 0.98221344, 'binary_f1_score': 0.9700325}
confusion matrix:
      0     1
0  1491    27
1    65  1489
---- Validation: 
scalar performance:
{'acc': 0.85214007, 'precision': 0.8535489, 'recall': 0.85236174, 'specificity': 0.85236174, 'f1': 0.85204256, 'auroc': 0.91815126, 'binary_precision': 0.82941175, 'binary_recall': 0.8840125, 'binary_specificity': 0.82071096, 'binary_f1_score': 0.85584223}
confusion matrix:
     0    1
0  531  116
1   74  564
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8445946, 'precision': 0.8514476, 'recall': 0.8445946, 'specificity': 0.8445946, 'f1': 0.8438333, 'auroc': 0.9402443, 'binary_precision': 0.80237156, 'binary_recall': 0.9144144, 'binary_specificity': 0.7747748, 'binary_f1_score': 0.85473686}
confusion matrix:
     0    1
0  172   50
1   19  203
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 08:56:05.637377,epoch time: 0:01:22.893378,used: 0:02:53.627603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9684245, 'precision': 0.9691628, 'recall': 0.96865505, 'specificity': 0.96865505, 'f1': 0.9684199, 'auroc': 0.997265, 'binary_precision': 0.9905597, 'binary_recall': 0.9465206, 'binary_specificity': 0.9907895, 'binary_f1_score': 0.9680395}
confusion matrix:
      0     1
0  1506    14
1    83  1469
---- Validation: 
scalar performance:
{'acc': 0.8319066, 'precision': 0.84332615, 'recall': 0.83126605, 'specificity': 0.83126605, 'f1': 0.8303008, 'auroc': 0.9129113, 'binary_precision': 0.90421456, 'binary_recall': 0.7398119, 'binary_specificity': 0.92272025, 'binary_f1_score': 0.81379306}
confusion matrix:
     0    1
0  597   50
1  166  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8496063, 'recall': 0.8423424, 'specificity': 0.8423424, 'f1': 0.8415191, 'auroc': 0.9218408, 'binary_precision': 0.9, 'binary_recall': 0.7702703, 'binary_specificity': 0.9144144, 'binary_f1_score': 0.83009714}
confusion matrix:
     0    1
0  203   19
1   51  171
early stop counter: 1
val acc:0.8319066166877747, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8445945978164673
after epoch: 3,now: 2024-07-26 08:57:28.637110,epoch time: 0:01:22.999733,used: 0:04:16.627336,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9736328, 'precision': 0.9739876, 'recall': 0.9738133, 'specificity': 0.9738133, 'f1': 0.97363204, 'auroc': 0.99772525, 'binary_precision': 0.9900133, 'binary_recall': 0.9575016, 'binary_specificity': 0.99012506, 'binary_f1_score': 0.9734861}
confusion matrix:
      0     1
0  1504    15
1    66  1487
---- Validation: 
scalar performance:
{'acc': 0.82645917, 'precision': 0.83748233, 'recall': 0.8258238, 'specificity': 0.8258238, 'f1': 0.82482797, 'auroc': 0.8926732, 'binary_precision': 0.8967495, 'binary_recall': 0.73510975, 'binary_specificity': 0.9165379, 'binary_f1_score': 0.8079242}
confusion matrix:
     0    1
0  593   54
1  169  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8536036, 'precision': 0.8541857, 'recall': 0.8536036, 'specificity': 0.8536036, 'f1': 0.8535434, 'auroc': 0.9327774, 'binary_precision': 0.8685446, 'binary_recall': 0.8333333, 'binary_specificity': 0.8738739, 'binary_f1_score': 0.85057473}
confusion matrix:
     0    1
0  194   28
1   37  185
new oracle model saved
early stop counter: 2
val acc:0.8264591693878174, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 4,now: 2024-07-26 08:58:50.607942,epoch time: 0:01:21.970832,used: 0:05:38.598168,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9791667, 'precision': 0.97955656, 'recall': 0.97938097, 'specificity': 0.97938097, 'f1': 0.9791661, 'auroc': 0.99781764, 'binary_precision': 0.9966689, 'binary_recall': 0.9620579, 'binary_specificity': 0.99670404, 'binary_f1_score': 0.97905755}
confusion matrix:
      0     1
0  1512     5
1    59  1496
---- Validation: 
scalar performance:
{'acc': 0.8420234, 'precision': 0.84800076, 'recall': 0.8415632, 'specificity': 0.8415632, 'f1': 0.8412094, 'auroc': 0.9101423, 'binary_precision': 0.8918919, 'binary_recall': 0.7758621, 'binary_specificity': 0.9072643, 'binary_f1_score': 0.8298408}
confusion matrix:
     0    1
0  587   60
1  143  495
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8423423, 'precision': 0.8577001, 'recall': 0.8423423, 'specificity': 0.8423423, 'f1': 0.8406317, 'auroc': 0.91760004, 'binary_precision': 0.9318182, 'binary_recall': 0.7387387, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.8241206}
confusion matrix:
     0    1
0  210   12
1   58  164
early stop counter: 3
val acc:0.8420233726501465, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 5,now: 2024-07-26 09:00:13.471307,epoch time: 0:01:22.863365,used: 0:07:01.461533,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95963544, 'precision': 0.9619617, 'recall': 0.95928514, 'specificity': 0.95928514, 'f1': 0.9595584, 'auroc': 0.997499, 'binary_precision': 0.9316808, 'binary_recall': 0.99291235, 'binary_specificity': 0.92565787, 'binary_f1_score': 0.9613225}
confusion matrix:
      0     1
0  1407   113
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.80544746, 'precision': 0.80881, 'recall': 0.8058086, 'specificity': 0.8058086, 'f1': 0.8050365, 'auroc': 0.88637936, 'binary_precision': 0.77478755, 'binary_recall': 0.8573668, 'binary_specificity': 0.7542504, 'binary_f1_score': 0.81398815}
confusion matrix:
     0    1
0  488  159
1   91  547
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7454955, 'precision': 0.777125, 'recall': 0.7454955, 'specificity': 0.7454955, 'f1': 0.73802024, 'auroc': 0.8810568, 'binary_precision': 0.68350166, 'binary_recall': 0.9144144, 'binary_specificity': 0.5765766, 'binary_f1_score': 0.78227353}
confusion matrix:
     0    1
0  128   94
1   19  203
early stop counter: 4
val acc:0.8054474592208862, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 6,now: 2024-07-26 09:01:36.188402,epoch time: 0:01:22.717095,used: 0:08:24.178628,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9887007, 'recall': 0.98855466, 'specificity': 0.98855466, 'f1': 0.9886041, 'auroc': 0.99951386, 'binary_precision': 0.9840459, 'binary_recall': 0.9935567, 'binary_specificity': 0.98355263, 'binary_f1_score': 0.9887785}
confusion matrix:
      0     1
0  1495    25
1    10  1542
---- Validation: 
scalar performance:
{'acc': 0.8396887, 'precision': 0.83968085, 'recall': 0.83968085, 'specificity': 0.83968085, 'f1': 0.83968085, 'auroc': 0.902613, 'binary_precision': 0.838558, 'binary_recall': 0.838558, 'binary_specificity': 0.8408037, 'binary_f1_score': 0.838558}
confusion matrix:
     0    1
0  544  103
1  103  535
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8018018, 'precision': 0.80820554, 'recall': 0.8018018, 'specificity': 0.8018018, 'f1': 0.80076694, 'auroc': 0.8921759, 'binary_precision': 0.7637795, 'binary_recall': 0.8738739, 'binary_specificity': 0.7297297, 'binary_f1_score': 0.81512606}
confusion matrix:
     0    1
0  162   60
1   28  194
early stop counter: 5
val acc:0.8396887183189392, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 7,now: 2024-07-26 09:02:58.875681,epoch time: 0:01:22.687279,used: 0:09:46.865907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.976971, 'recall': 0.9764827, 'specificity': 0.9764827, 'f1': 0.9762339, 'auroc': 0.99820447, 'binary_precision': 0.9986523, 'binary_recall': 0.95428205, 'binary_specificity': 0.99868333, 'binary_f1_score': 0.9759632}
confusion matrix:
      0     1
0  1517     2
1    71  1482
---- Validation: 
scalar performance:
{'acc': 0.7844358, 'precision': 0.81699765, 'recall': 0.7833078, 'specificity': 0.7833078, 'f1': 0.7782867, 'auroc': 0.89230496, 'binary_precision': 0.91685915, 'binary_recall': 0.62225705, 'binary_specificity': 0.9443586, 'binary_f1_score': 0.7413632}
confusion matrix:
     0    1
0  611   36
1  241  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7004505, 'precision': 0.79350245, 'recall': 0.7004504, 'specificity': 0.7004504, 'f1': 0.6746644, 'auroc': 0.8813002, 'binary_precision': 0.9587629, 'binary_recall': 0.4189189, 'binary_specificity': 0.981982, 'binary_f1_score': 0.5830721}
confusion matrix:
     0   1
0  218   4
1  129  93
early stop counter: 6
val acc:0.7844358086585999, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 8,now: 2024-07-26 09:04:22.467350,epoch time: 0:01:23.591669,used: 0:11:10.457576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9658203, 'precision': 0.9679875, 'recall': 0.9654666, 'specificity': 0.9654666, 'f1': 0.965758, 'auroc': 0.999393, 'binary_precision': 0.9387879, 'binary_recall': 0.99742436, 'binary_specificity': 0.9335089, 'binary_f1_score': 0.9672182}
confusion matrix:
      0     1
0  1418   101
1     4  1549
---- Validation: 
scalar performance:
{'acc': 0.8326848, 'precision': 0.83716816, 'recall': 0.8322787, 'specificity': 0.8322787, 'f1': 0.83200073, 'auroc': 0.89631736, 'binary_precision': 0.8743363, 'binary_recall': 0.7742947, 'binary_specificity': 0.8902627, 'binary_f1_score': 0.8212802}
confusion matrix:
     0    1
0  576   71
1  144  494
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8310811, 'precision': 0.8310878, 'recall': 0.83108103, 'specificity': 0.83108103, 'f1': 0.8310802, 'auroc': 0.9109447, 'binary_precision': 0.8325792, 'binary_recall': 0.8288288, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.8306998}
confusion matrix:
     0    1
0  185   37
1   38  184
early stop counter: 7
val acc:0.8326848149299622, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 9,now: 2024-07-26 09:05:46.284348,epoch time: 0:01:23.816998,used: 0:12:34.274574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.9843614, 'recall': 0.9841974, 'specificity': 0.9841974, 'f1': 0.98404896, 'auroc': 0.9995108, 'binary_precision': 0.9993351, 'binary_recall': 0.9690522, 'binary_specificity': 0.99934256, 'binary_f1_score': 0.9839607}
confusion matrix:
      0     1
0  1520     1
1    48  1503
---- Validation: 
scalar performance:
{'acc': 0.6988327, 'precision': 0.78805065, 'recall': 0.696872, 'specificity': 0.696872, 'f1': 0.67224336, 'auroc': 0.90915453, 'binary_precision': 0.9466192, 'binary_recall': 0.4169279, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.57889014}
confusion matrix:
     0    1
0  632   15
1  372  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5382883, 'precision': 0.75995314, 'recall': 0.5382883, 'specificity': 0.5382883, 'f1': 0.41319445, 'auroc': 0.9028082, 'binary_precision': 1.0, 'binary_recall': 0.076576576, 'binary_specificity': 1.0, 'binary_f1_score': 0.1422594}
confusion matrix:
     0   1
0  222   0
1  205  17
early stop counter: 8
val acc:0.6988326907157898, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 10,now: 2024-07-26 09:07:08.206027,epoch time: 0:01:21.921679,used: 0:13:56.196253,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9848175, 'recall': 0.98483914, 'specificity': 0.98483914, 'f1': 0.9847005, 'auroc': 0.9989462, 'binary_precision': 0.9960526, 'binary_recall': 0.97363347, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.98471546}
confusion matrix:
      0     1
0  1511     6
1    41  1514
---- Validation: 
scalar performance:
{'acc': 0.63112843, 'precision': 0.75098276, 'recall': 0.6286901, 'specificity': 0.6286901, 'f1': 0.5787806, 'auroc': 0.8039614, 'binary_precision': 0.92268044, 'binary_recall': 0.28056425, 'binary_specificity': 0.97681606, 'binary_f1_score': 0.43028843}
confusion matrix:
     0    1
0  632   15
1  459  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7207207, 'precision': 0.82080925, 'recall': 0.7207207, 'specificity': 0.7207207, 'f1': 0.69709504, 'auroc': 0.90903735, 'binary_precision': 1.0, 'binary_recall': 0.44144145, 'binary_specificity': 1.0, 'binary_f1_score': 0.6125}
confusion matrix:
     0   1
0  222   0
1  124  98
early stop counter: 9
val acc:0.6311284303665161, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8536036014556885
after epoch: 11,now: 2024-07-26 09:08:30.216333,epoch time: 0:01:22.010306,used: 0:15:18.206559,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9892578, 'precision': 0.98923886, 'recall': 0.9893005, 'specificity': 0.9893005, 'f1': 0.989257, 'auroc': 0.99909365, 'binary_precision': 0.99287564, 'binary_recall': 0.98585206, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9893514}
confusion matrix:
      0     1
0  1506    11
1    22  1533
---- Validation: 
scalar performance:
{'acc': 0.72762644, 'precision': 0.79142326, 'recall': 0.72597784, 'specificity': 0.72597784, 'f1': 0.71091, 'auroc': 0.88889337, 'binary_precision': 0.9260355, 'binary_recall': 0.4905956, 'binary_specificity': 0.9613601, 'binary_f1_score': 0.6413934}
confusion matrix:
     0    1
0  622   25
1  325  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8738739, 'precision': 0.8906462, 'recall': 0.8738739, 'specificity': 0.8738739, 'f1': 0.8725054, 'auroc': 0.9276439, 'binary_precision': 0.97159094, 'binary_recall': 0.7702703, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.8592965}
confusion matrix:
     0    1
0  217    5
1   51  171
new oracle model saved
early stop counter: 10
val acc:0.7276264429092407, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 12,now: 2024-07-26 09:09:52.867932,epoch time: 0:01:22.651599,used: 0:16:40.858158,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.9931869, 'recall': 0.99314404, 'specificity': 0.99314404, 'f1': 0.9931629, 'auroc': 0.999828, 'binary_precision': 0.9916613, 'binary_recall': 0.994852, 'binary_specificity': 0.9914361, 'binary_f1_score': 0.99325407}
confusion matrix:
      0     1
0  1505    13
1     8  1546
---- Validation: 
scalar performance:
{'acc': 0.7945525, 'precision': 0.8107847, 'recall': 0.79374665, 'specificity': 0.79374665, 'f1': 0.7915192, 'auroc': 0.89144254, 'binary_precision': 0.8800813, 'binary_recall': 0.6786834, 'binary_specificity': 0.9088099, 'binary_f1_score': 0.7663717}
confusion matrix:
     0    1
0  588   59
1  205  433
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8468468, 'precision': 0.8486579, 'recall': 0.8468468, 'specificity': 0.8468468, 'f1': 0.84664774, 'auroc': 0.9088142, 'binary_precision': 0.8737864, 'binary_recall': 0.8108108, 'binary_specificity': 0.8828829, 'binary_f1_score': 0.8411215}
confusion matrix:
     0    1
0  196   26
1   42  180
early stop counter: 11
val acc:0.7945525050163269, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 13,now: 2024-07-26 09:11:15.396708,epoch time: 0:01:22.528776,used: 0:18:03.386934,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.99316406, 'precision': 0.99318504, 'recall': 0.9931464, 'specificity': 0.9931464, 'f1': 0.9931631, 'auroc': 0.999819, 'binary_precision': 0.9916506, 'binary_recall': 0.9948454, 'binary_specificity': 0.9914474, 'binary_f1_score': 0.9932454}
confusion matrix:
      0     1
0  1507    13
1     8  1544
---- Validation: 
scalar performance:
{'acc': 0.71906614, 'precision': 0.79607743, 'recall': 0.71726996, 'specificity': 0.71726996, 'f1': 0.6984488, 'auroc': 0.90796864, 'binary_precision': 0.9453376, 'binary_recall': 0.46081504, 'binary_specificity': 0.9737249, 'binary_f1_score': 0.6195996}
confusion matrix:
     0    1
0  630   17
1  344  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6801802, 'precision': 0.788424, 'recall': 0.6801802, 'specificity': 0.6801802, 'f1': 0.6470667, 'auroc': 0.9219828, 'binary_precision': 0.96511626, 'binary_recall': 0.37387386, 'binary_specificity': 0.9864865, 'binary_f1_score': 0.53896105}
confusion matrix:
     0   1
0  219   3
1  139  83
early stop counter: 12
val acc:0.7190661430358887, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 14,now: 2024-07-26 09:12:37.732942,epoch time: 0:01:22.336234,used: 0:19:25.723168,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99283856, 'precision': 0.99284613, 'recall': 0.9928988, 'specificity': 0.9928988, 'f1': 0.9928384, 'auroc': 0.9994167, 'binary_precision': 0.9986962, 'binary_recall': 0.9871134, 'binary_specificity': 0.9986842, 'binary_f1_score': 0.99287105}
confusion matrix:
      0     1
0  1518     2
1    20  1532
---- Validation: 
scalar performance:
{'acc': 0.6607004, 'precision': 0.7660023, 'recall': 0.6584816, 'specificity': 0.6584816, 'f1': 0.6216136, 'auroc': 0.891749, 'binary_precision': 0.93162394, 'binary_recall': 0.34169278, 'binary_specificity': 0.97527045, 'binary_f1_score': 0.49999994}
confusion matrix:
     0    1
0  631   16
1  420  218
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5315315, 'precision': 0.70266044, 'recall': 0.5315315, 'specificity': 0.5315315, 'f1': 0.4061728, 'auroc': 0.8809756, 'binary_precision': 0.8888889, 'binary_recall': 0.072072074, 'binary_specificity': 0.990991, 'binary_f1_score': 0.13333333}
confusion matrix:
     0   1
0  220   2
1  206  16
early stop counter: 13
val acc:0.6607003808021545, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 15,now: 2024-07-26 09:14:01.609997,epoch time: 0:01:23.877055,used: 0:20:49.600223,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.98911893, 'recall': 0.98886013, 'specificity': 0.98886013, 'f1': 0.9889291, 'auroc': 0.99926496, 'binary_precision': 0.9815756, 'binary_recall': 0.9967742, 'binary_specificity': 0.9809461, 'binary_f1_score': 0.9891165}
confusion matrix:
      0     1
0  1493    29
1     5  1545
---- Validation: 
scalar performance:
{'acc': 0.6249027, 'precision': 0.71755886, 'recall': 0.622595, 'specificity': 0.622595, 'f1': 0.5778512, 'auroc': 0.81585133, 'binary_precision': 0.85779816, 'binary_recall': 0.29310346, 'binary_specificity': 0.95208657, 'binary_f1_score': 0.4369159}
confusion matrix:
     0    1
0  616   31
1  451  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.759009, 'precision': 0.81413805, 'recall': 0.759009, 'specificity': 0.759009, 'f1': 0.7479508, 'auroc': 0.9178841, 'binary_precision': 0.9457364, 'binary_recall': 0.5495495, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.6951567}
confusion matrix:
     0    1
0  215    7
1  100  122
early stop counter: 14
val acc:0.6249027252197266, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 16,now: 2024-07-26 09:15:24.461908,epoch time: 0:01:22.851911,used: 0:22:12.452134,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98828125, 'precision': 0.98838824, 'recall': 0.98841643, 'specificity': 0.98841643, 'f1': 0.98828125, 'auroc': 0.9996723, 'binary_precision': 0.99934256, 'binary_recall': 0.977492, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.9882965}
confusion matrix:
      0     1
0  1516     1
1    35  1520
---- Validation: 
scalar performance:
{'acc': 0.72840464, 'precision': 0.79991186, 'recall': 0.7266853, 'specificity': 0.7266853, 'f1': 0.71020806, 'auroc': 0.91747606, 'binary_precision': 0.94461536, 'binary_recall': 0.48119122, 'binary_specificity': 0.9721793, 'binary_f1_score': 0.6375909}
confusion matrix:
     0    1
0  629   18
1  331  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7027027, 'precision': 0.8084857, 'recall': 0.7027027, 'specificity': 0.7027027, 'f1': 0.6748264, 'auroc': 0.9378297, 'binary_precision': 0.98913044, 'binary_recall': 0.4099099, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.57961786}
confusion matrix:
     0   1
0  221   1
1  131  91
early stop counter: 15
val acc:0.7284046411514282, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 17,now: 2024-07-26 09:16:47.853313,epoch time: 0:01:23.391405,used: 0:23:35.843539,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99543, 'recall': 0.9954854, 'specificity': 0.9954854, 'f1': 0.9954425, 'auroc': 0.99986523, 'binary_precision': 0.9993511, 'binary_recall': 0.9916291, 'binary_specificity': 0.99934167, 'binary_f1_score': 0.9954752}
confusion matrix:
      0     1
0  1518     1
1    13  1540
---- Validation: 
scalar performance:
{'acc': 0.72607005, 'precision': 0.7998624, 'recall': 0.7243233, 'specificity': 0.7243233, 'f1': 0.7071028, 'auroc': 0.90610874, 'binary_precision': 0.946875, 'binary_recall': 0.47492164, 'binary_specificity': 0.9737249, 'binary_f1_score': 0.6325679}
confusion matrix:
     0    1
0  630   17
1  335  303
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7274775, 'precision': 0.8236152, 'recall': 0.7274775, 'specificity': 0.7274775, 'f1': 0.70561385, 'auroc': 0.92987585, 'binary_precision': 1.0, 'binary_recall': 0.45495495, 'binary_specificity': 1.0, 'binary_f1_score': 0.62538695}
confusion matrix:
     0    1
0  222    0
1  121  101
early stop counter: 16
val acc:0.7260700464248657, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 18,now: 2024-07-26 09:18:09.922444,epoch time: 0:01:22.069131,used: 0:24:57.912670,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9912052, 'recall': 0.99121374, 'specificity': 0.99121374, 'f1': 0.9912093, 'auroc': 0.99950397, 'binary_precision': 0.9916452, 'binary_recall': 0.99100834, 'binary_specificity': 0.99141914, 'binary_f1_score': 0.99132663}
confusion matrix:
      0     1
0  1502    13
1    14  1543
---- Validation: 
scalar performance:
{'acc': 0.76731515, 'precision': 0.81406736, 'recall': 0.7659575, 'specificity': 0.7659575, 'f1': 0.7576984, 'auroc': 0.8989041, 'binary_precision': 0.9335038, 'binary_recall': 0.57210034, 'binary_specificity': 0.95981455, 'binary_f1_score': 0.70942664}
confusion matrix:
     0    1
0  621   26
1  273  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7342342, 'precision': 0.8222061, 'recall': 0.7342342, 'specificity': 0.7342342, 'f1': 0.7147648, 'auroc': 0.91989285, 'binary_precision': 0.990566, 'binary_recall': 0.47297296, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.6402438}
confusion matrix:
     0    1
0  221    1
1  117  105
early stop counter: 17
val acc:0.767315149307251, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 19,now: 2024-07-26 09:19:33.820950,epoch time: 0:01:23.898506,used: 0:26:21.811176,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9889323, 'precision': 0.9889164, 'recall': 0.98895365, 'specificity': 0.98895365, 'f1': 0.9889313, 'auroc': 0.9996706, 'binary_precision': 0.99095607, 'binary_recall': 0.98713, 'binary_specificity': 0.9907773, 'binary_f1_score': 0.98903936}
confusion matrix:
      0     1
0  1504    14
1    20  1534
---- Validation: 
scalar performance:
{'acc': 0.6817121, 'precision': 0.74623823, 'recall': 0.67990315, 'specificity': 0.67990315, 'f1': 0.6580537, 'auroc': 0.8633481, 'binary_precision': 0.87055016, 'binary_recall': 0.42163008, 'binary_specificity': 0.9381762, 'binary_f1_score': 0.5681098}
confusion matrix:
     0    1
0  607   40
1  369  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8220721, 'precision': 0.8543476, 'recall': 0.8220721, 'specificity': 0.8220721, 'f1': 0.81792605, 'auroc': 0.9210494, 'binary_precision': 0.9612903, 'binary_recall': 0.6711712, 'binary_specificity': 0.972973, 'binary_f1_score': 0.79045093}
confusion matrix:
     0    1
0  216    6
1   73  149
early stop counter: 18
val acc:0.6817120909690857, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 20,now: 2024-07-26 09:20:55.331368,epoch time: 0:01:21.510418,used: 0:27:43.321594,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9938151, 'precision': 0.99380684, 'recall': 0.9938585, 'specificity': 0.9938585, 'f1': 0.9938148, 'auroc': 0.9997745, 'binary_precision': 0.9980507, 'binary_recall': 0.9896907, 'binary_specificity': 0.9980263, 'binary_f1_score': 0.9938531}
confusion matrix:
      0     1
0  1517     3
1    16  1536
---- Validation: 
scalar performance:
{'acc': 0.7548638, 'precision': 0.8104412, 'recall': 0.75337464, 'specificity': 0.75337464, 'f1': 0.74264455, 'auroc': 0.91402566, 'binary_precision': 0.9400545, 'binary_recall': 0.54075235, 'binary_specificity': 0.9659969, 'binary_f1_score': 0.6865671}
confusion matrix:
     0    1
0  625   22
1  293  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6824324, 'precision': 0.8057851, 'recall': 0.6824324, 'specificity': 0.6824324, 'f1': 0.6468139, 'auroc': 0.9381138, 'binary_precision': 1.0, 'binary_recall': 0.36486486, 'binary_specificity': 1.0, 'binary_f1_score': 0.5346535}
confusion matrix:
     0   1
0  222   0
1  141  81
early stop counter: 19
val acc:0.7548637986183167, best validation acc: 0.8521400690078735, corresponding to test acc:                         0.8445945978164673 / 0.8738738894462585
after epoch: 21,now: 2024-07-26 09:22:19.152775,epoch time: 0:01:23.821407,used: 0:29:07.143001,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.9867697, 'recall': 0.98659074, 'specificity': 0.98659074, 'f1': 0.98665, 'auroc': 0.99927425, 'binary_precision': 0.98152864, 'binary_recall': 0.99227303, 'binary_specificity': 0.9809085, 'binary_f1_score': 0.98687166}
confusion matrix:
      0     1
0  1490    29
1    12  1541
---- Validation: 
scalar performance:
{'acc': 0.8638132, 'precision': 0.86849004, 'recall': 0.86341953, 'specificity': 0.86341953, 'f1': 0.8632833, 'auroc': 0.9214072, 'binary_precision': 0.90828925, 'binary_recall': 0.80721, 'binary_specificity': 0.91962904, 'binary_f1_score': 0.85477173}
confusion matrix:
     0    1
0  595   52
1  123  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8738739, 'precision': 0.8799175, 'recall': 0.87387383, 'specificity': 0.87387383, 'f1': 0.8733703, 'auroc': 0.92873955, 'binary_precision': 0.92783505, 'binary_recall': 0.8108108, 'binary_specificity': 0.9369369, 'binary_f1_score': 0.8653846}
confusion matrix:
     0    1
0  208   14
1   42  180
better model found
persisted
after epoch: 22,now: 2024-07-26 09:23:41.817960,epoch time: 0:01:22.665185,used: 0:30:29.808186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.9880458, 'recall': 0.98809355, 'specificity': 0.98809355, 'f1': 0.9879557, 'auroc': 0.99978554, 'binary_precision': 0.9986868, 'binary_recall': 0.9775064, 'binary_specificity': 0.9986807, 'binary_f1_score': 0.9879831}
confusion matrix:
      0     1
0  1514     2
1    35  1521
---- Validation: 
scalar performance:
{'acc': 0.6614786, 'precision': 0.7755556, 'recall': 0.6592108, 'specificity': 0.6592108, 'f1': 0.6205557, 'auroc': 0.901065, 'binary_precision': 0.95111114, 'binary_recall': 0.3354232, 'binary_specificity': 0.98299843, 'binary_f1_score': 0.4959444}
confusion matrix:
     0    1
0  636   11
1  424  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5608108, 'precision': 0.7661871, 'recall': 0.5608108, 'specificity': 0.5608108, 'f1': 0.45585155, 'auroc': 0.8808335, 'binary_precision': 1.0, 'binary_recall': 0.12162162, 'binary_specificity': 1.0, 'binary_f1_score': 0.21686748}
confusion matrix:
     0   1
0  222   0
1  195  27
early stop counter: 1
val acc:0.661478579044342, best validation acc: 0.8638132214546204, corresponding to test acc:                         0.8738738894462585 / 0.8738738894462585
after epoch: 23,now: 2024-07-26 09:25:05.198537,epoch time: 0:01:23.380577,used: 0:31:53.188763,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9781901, 'precision': 0.9788364, 'recall': 0.9780109, 'specificity': 0.9780109, 'f1': 0.9781742, 'auroc': 0.9992255, 'binary_precision': 0.96379524, 'binary_recall': 0.99420476, 'binary_specificity': 0.96181697, 'binary_f1_score': 0.9787639}
confusion matrix:
      0     1
0  1461    58
1     9  1544
---- Validation: 
scalar performance:
{'acc': 0.8669261, 'precision': 0.8688456, 'recall': 0.8666743, 'specificity': 0.8666743, 'f1': 0.86669064, 'auroc': 0.9228753, 'binary_precision': 0.89376056, 'binary_recall': 0.830721, 'binary_specificity': 0.9026275, 'binary_f1_score': 0.8610886}
confusion matrix:
     0    1
0  584   63
1  108  530
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8558559, 'precision': 0.87487173, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.8540044, 'auroc': 0.9179449, 'binary_precision': 0.9593023, 'binary_recall': 0.7432432, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.83756346}
confusion matrix:
     0    1
0  215    7
1   57  165
better model found
persisted
after epoch: 24,now: 2024-07-26 09:26:28.123616,epoch time: 0:01:22.925079,used: 0:33:16.113842,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9873047, 'precision': 0.9873396, 'recall': 0.9872745, 'specificity': 0.9872745, 'f1': 0.98730195, 'auroc': 0.99935865, 'binary_precision': 0.98527527, 'binary_recall': 0.9897106, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.98748803}
confusion matrix:
      0     1
0  1494    23
1    16  1539
---- Validation: 
scalar performance:
{'acc': 0.81167316, 'precision': 0.8227376, 'recall': 0.81102073, 'specificity': 0.81102073, 'f1': 0.80981547, 'auroc': 0.8932376, 'binary_precision': 0.88076925, 'binary_recall': 0.7178683, 'binary_specificity': 0.90417314, 'binary_f1_score': 0.791019}
confusion matrix:
     0    1
0  585   62
1  180  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.795045, 'precision': 0.8034749, 'recall': 0.795045, 'specificity': 0.795045, 'f1': 0.79361176, 'auroc': 0.8863729, 'binary_precision': 0.85405403, 'binary_recall': 0.7117117, 'binary_specificity': 0.8783784, 'binary_f1_score': 0.7764127}
confusion matrix:
     0    1
0  195   27
1   64  158
early stop counter: 1
val acc:0.8116731643676758, best validation acc: 0.8669260740280151, corresponding to test acc:                         0.8558558821678162 / 0.8738738894462585
after epoch: 25,now: 2024-07-26 09:27:51.627348,epoch time: 0:01:23.503732,used: 0:34:39.617574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9947917, 'precision': 0.99479115, 'recall': 0.99479115, 'specificity': 0.99479115, 'f1': 0.99479115, 'auroc': 0.9998597, 'binary_precision': 0.9948454, 'binary_recall': 0.9948454, 'binary_specificity': 0.99473685, 'binary_f1_score': 0.9948454}
confusion matrix:
      0     1
0  1512     8
1     8  1544
---- Validation: 
scalar performance:
{'acc': 0.7136187, 'precision': 0.7918344, 'recall': 0.711795, 'specificity': 0.711795, 'f1': 0.6919236, 'auroc': 0.88706017, 'binary_precision': 0.9411765, 'binary_recall': 0.45141065, 'binary_specificity': 0.9721793, 'binary_f1_score': 0.6101695}
confusion matrix:
     0    1
0  629   18
1  350  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6846847, 'precision': 0.7856874, 'recall': 0.6846847, 'specificity': 0.6846847, 'f1': 0.6541133, 'auroc': 0.8948543, 'binary_precision': 0.95555556, 'binary_recall': 0.3873874, 'binary_specificity': 0.981982, 'binary_f1_score': 0.55128205}
confusion matrix:
     0   1
0  218   4
1  136  86
early stop counter: 2
val acc:0.7136186957359314, best validation acc: 0.8669260740280151, corresponding to test acc:                         0.8558558821678162 / 0.8738738894462585
after epoch: 26,now: 2024-07-26 09:29:15.473250,epoch time: 0:01:23.845902,used: 0:36:03.463476,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9954427, 'precision': 0.99544215, 'recall': 0.99544215, 'specificity': 0.99544215, 'f1': 0.99544215, 'auroc': 0.99990165, 'binary_precision': 0.9954926, 'binary_recall': 0.9954926, 'binary_specificity': 0.9953917, 'binary_f1_score': 0.9954926}
confusion matrix:
      0     1
0  1512     7
1     7  1546
---- Validation: 
scalar performance:
{'acc': 0.79688716, 'precision': 0.82875866, 'recall': 0.79579246, 'specificity': 0.79579246, 'f1': 0.7914221, 'auroc': 0.92085063, 'binary_precision': 0.92938495, 'binary_recall': 0.6394984, 'binary_specificity': 0.95208657, 'binary_f1_score': 0.75766015}
confusion matrix:
     0    1
0  616   31
1  230  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6981982, 'precision': 0.80659133, 'recall': 0.6981982, 'specificity': 0.6981982, 'f1': 0.66893697, 'auroc': 0.91415066, 'binary_precision': 0.98888886, 'binary_recall': 0.4009009, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.5705128}
confusion matrix:
     0   1
0  221   1
1  133  89
early stop counter: 3
val acc:0.7968871593475342, best validation acc: 0.8669260740280151, corresponding to test acc:                         0.8558558821678162 / 0.8738738894462585
after epoch: 27,now: 2024-07-26 09:30:38.958708,epoch time: 0:01:23.485458,used: 0:37:26.948934,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9941406, 'precision': 0.99412704, 'recall': 0.99420744, 'specificity': 0.99420744, 'f1': 0.99414027, 'auroc': 0.9997766, 'binary_precision': 0.99935067, 'binary_recall': 0.9890745, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.994186}
confusion matrix:
      0     1
0  1515     1
1    17  1539
---- Validation: 
scalar performance:
{'acc': 0.70272374, 'precision': 0.79754317, 'recall': 0.700736, 'specificity': 0.700736, 'f1': 0.6756903, 'auroc': 0.913856, 'binary_precision': 0.9637681, 'binary_recall': 0.4169279, 'binary_specificity': 0.98454404, 'binary_f1_score': 0.5820569}
confusion matrix:
     0    1
0  637   10
1  372  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5990991, 'precision': 0.7569444, 'recall': 0.5990991, 'specificity': 0.5990991, 'f1': 0.5263574, 'auroc': 0.9037061, 'binary_precision': 0.9583333, 'binary_recall': 0.2072072, 'binary_specificity': 0.990991, 'binary_f1_score': 0.34074074}
confusion matrix:
     0   1
0  220   2
1  176  46
early stop counter: 4
val acc:0.7027237415313721, best validation acc: 0.8669260740280151, corresponding to test acc:                         0.8558558821678162 / 0.8738738894462585
after epoch: 28,now: 2024-07-26 09:32:03.688352,epoch time: 0:01:24.729644,used: 0:38:51.678578,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9921875, 'precision': 0.99220145, 'recall': 0.9922749, 'specificity': 0.9922749, 'f1': 0.99218726, 'auroc': 0.9998249, 'binary_precision': 0.9993477, 'binary_recall': 0.985209, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.992228}
confusion matrix:
      0     1
0  1516     1
1    23  1532
---- Validation: 
scalar performance:
{'acc': 0.6155642, 'precision': 0.75628275, 'recall': 0.6129508, 'specificity': 0.6129508, 'f1': 0.551702, 'auroc': 0.8994552, 'binary_precision': 0.9444444, 'binary_recall': 0.23981191, 'binary_specificity': 0.98608965, 'binary_f1_score': 0.3825}
confusion matrix:
     0    1
0  638    9
1  485  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5585586, 'precision': 0.76555026, 'recall': 0.5585586, 'specificity': 0.5585586, 'f1': 0.45171368, 'auroc': 0.886662, 'binary_precision': 1.0, 'binary_recall': 0.117117114, 'binary_specificity': 1.0, 'binary_f1_score': 0.2096774}
confusion matrix:
     0   1
0  222   0
1  196  26
early stop counter: 5
val acc:0.615564227104187, best validation acc: 0.8669260740280151, corresponding to test acc:                         0.8558558821678162 / 0.8738738894462585
after epoch: 29,now: 2024-07-26 09:33:28.670050,epoch time: 0:01:24.981698,used: 0:40:16.660276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.9944542, 'recall': 0.9944825, 'specificity': 0.9944825, 'f1': 0.9944657, 'auroc': 0.9997041, 'binary_precision': 0.9961215, 'binary_recall': 0.99291235, 'binary_specificity': 0.9960526, 'binary_f1_score': 0.9945143}
confusion matrix:
      0     1
0  1514     6
1    11  1541
---- Validation: 
scalar performance:
{'acc': 0.8326848, 'precision': 0.8536074, 'recall': 0.83183175, 'specificity': 0.83183175, 'f1': 0.82991445, 'auroc': 0.9328538, 'binary_precision': 0.9378882, 'binary_recall': 0.71003133, 'binary_specificity': 0.9536322, 'binary_f1_score': 0.808207}
confusion matrix:
     0    1
0  617   30
1  185  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7657658, 'precision': 0.8368827, 'recall': 0.7657658, 'specificity': 0.7657658, 'f1': 0.7527151, 'auroc': 0.9306874, 'binary_precision': 0.9916667, 'binary_recall': 0.536036, 'binary_specificity': 0.9954955, 'binary_f1_score': 0.69590646}
confusion matrix:
     0    1
0  221    1
1  103  119
early stop counter: 6
val acc:0.8326848149299622, best validation acc: 0.8669260740280151, corresponding to test acc:                         0.8558558821678162 / 0.8738738894462585
after epoch: 30,now: 2024-07-26 09:34:51.398790,epoch time: 0:01:22.728740,used: 0:41:39.389016,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_08_53_11_seed_6_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:39.389016 at 2024-07-26 09:34:51.398790
persisted model performance metric: 

scalar performance:
{'acc': 0.8558559, 'precision': 0.87487173, 'recall': 0.8558558, 'specificity': 0.8558558, 'f1': 0.8540044, 'auroc': 0.9179449, 'binary_precision': 0.9593023, 'binary_recall': 0.7432432, 'binary_specificity': 0.9684685, 'binary_f1_score': 0.83756346}
confusion matrix:
     0    1
0  215    7
1   57  165
oracle model performance metric: 

scalar performance:
{'acc': 0.8738739, 'precision': 0.8906462, 'recall': 0.8738739, 'specificity': 0.8738739, 'f1': 0.8725054, 'auroc': 0.9276439, 'binary_precision': 0.97159094, 'binary_recall': 0.7702703, 'binary_specificity': 0.9774775, 'binary_f1_score': 0.8592965}
confusion matrix:
     0    1
0  217    5
1   51  171
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455127 KiB |  13219 MiB | 514330 GiB | 514330 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 508241 GiB | 508241 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455127 KiB |  13219 MiB | 514330 GiB | 514330 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 508241 GiB | 508241 GiB |
|       from small pool |  40595 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 507474 GiB | 507474 GiB |
|       from small pool |  40406 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB |  96046 MiB |  81572 MiB |
|       from large pool |  14408 MiB |  14414 MiB |  95882 MiB |  81474 MiB |
|       from small pool |     66 MiB |     70 MiB |    164 MiB |     98 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445993 KiB |   1252 MiB | 367153 GiB | 367153 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 361026 GiB | 361026 GiB |
|       from small pool |  10604 KiB |     45 MiB |   6126 GiB |   6126 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |   90476 K  |   90475 K  |
|       from large pool |     187    |    1413    |   45954 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44522 K  |   44520 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |   90476 K  |   90475 K  |
|       from large pool |     187    |    1413    |   45954 K  |   45954 K  |
|       from small pool |    1117    |    1419    |   44522 K  |   44520 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    4067    |    3433    |
|       from large pool |     601    |     601    |    3985    |    3384    |
|       from small pool |      33    |      35    |      82    |      49    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     652    |   58491 K  |   58491 K  |
|       from large pool |      40    |     604    |   32558 K  |   32558 K  |
|       from small pool |      59    |     240    |   25933 K  |   25933 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 514330 GiB | 514330 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508241 GiB | 508241 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 514330 GiB | 514330 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508241 GiB | 508241 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507474 GiB | 507474 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  96046 MiB |  95166 MiB |
|       from large pool |    830 MiB |  14414 MiB |  95882 MiB |  95052 MiB |
|       from small pool |     50 MiB |     70 MiB |    164 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 367153 GiB | 367153 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 361026 GiB | 361026 GiB |
|       from small pool |      0 KiB |     45 MiB |   6126 GiB |   6126 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    4067    |    4005    |
|       from large pool |      37    |     601    |    3985    |    3948    |
|       from small pool |      25    |      35    |      82    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   58491 K  |   58491 K  |
|       from large pool |       4    |     604    |   32558 K  |   32558 K  |
|       from small pool |       0    |     240    |   25933 K  |   25933 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 514330 GiB | 514330 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508241 GiB | 508241 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 514330 GiB | 514330 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 508241 GiB | 508241 GiB |
|       from small pool |      0 KiB |     60 MiB |   6089 GiB |   6089 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 513551 GiB | 513551 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 507474 GiB | 507474 GiB |
|       from small pool |      0 KiB |     60 MiB |   6076 GiB |   6076 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB |  96046 MiB |  95166 MiB |
|       from large pool |    830 MiB |  14414 MiB |  95882 MiB |  95052 MiB |
|       from small pool |     50 MiB |     70 MiB |    164 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 367153 GiB | 367153 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 361026 GiB | 361026 GiB |
|       from small pool |      0 KiB |     45 MiB |   6126 GiB |   6126 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |   90476 K  |   90476 K  |
|       from large pool |       2    |    1413    |   45954 K  |   45954 K  |
|       from small pool |       0    |    1419    |   44522 K  |   44522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    4067    |    4005    |
|       from large pool |      37    |     601    |    3985    |    3948    |
|       from small pool |      25    |      35    |      82    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   58491 K  |   58491 K  |
|       from large pool |       4    |     604    |   32558 K  |   32558 K  |
|       from small pool |       0    |     240    |   25933 K  |   25933 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529

 Experiment start at: 2024-07-26 09:35:29.408119
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.4978165924549103
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9576823, 'precision': 0.957811, 'recall': 0.9575804, 'specificity': 0.9575804, 'f1': 0.9576628, 'auroc': 0.99198675, 'binary_precision': 0.9531052, 'binary_recall': 0.96410257, 'binary_specificity': 0.9510582, 'binary_f1_score': 0.9585724}
confusion matrix:
      0     1
0  1438    74
1    56  1504
---- Validation: 
scalar performance:
{'acc': 0.85307693, 'precision': 0.8562751, 'recall': 0.85234374, 'specificity': 0.85234374, 'f1': 0.8525324, 'auroc': 0.9013305, 'binary_precision': 0.8864027, 'binary_recall': 0.8046875, 'binary_specificity': 0.9, 'binary_f1_score': 0.8435709}
confusion matrix:
     0    1
0  594   66
1  125  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8689956, 'precision': 0.8703799, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8688731, 'auroc': 0.9388455, 'binary_precision': 0.89302325, 'binary_recall': 0.83842796, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.8648648}
confusion matrix:
     0    1
0  206   23
1   37  192
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 09:37:01.544545,epoch time: 0:01:32.136426,used: 0:01:32.136426,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.95110166, 'recall': 0.9502747, 'specificity': 0.9502747, 'f1': 0.9504745, 'auroc': 0.98909664, 'binary_precision': 0.93835616, 'binary_recall': 0.96602565, 'binary_specificity': 0.9345238, 'binary_f1_score': 0.95198995}
confusion matrix:
      0     1
0  1413    99
1    53  1507
---- Validation: 
scalar performance:
{'acc': 0.8353846, 'precision': 0.8379031, 'recall': 0.8347064, 'specificity': 0.8347064, 'f1': 0.8348495, 'auroc': 0.90516573, 'binary_precision': 0.8634812, 'binary_recall': 0.790625, 'binary_specificity': 0.8787879, 'binary_f1_score': 0.82544863}
confusion matrix:
     0    1
0  580   80
1  134  506
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84934497, 'precision': 0.8496717, 'recall': 0.84934497, 'specificity': 0.84934497, 'f1': 0.8493098, 'auroc': 0.93297225, 'binary_precision': 0.83898306, 'binary_recall': 0.8646288, 'binary_specificity': 0.83406115, 'binary_f1_score': 0.8516129}
confusion matrix:
     0    1
0  191   38
1   31  198
early stop counter: 1
val acc:0.8353846073150635, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8689956068992615
after epoch: 2,now: 2024-07-26 09:38:24.350829,epoch time: 0:01:22.806284,used: 0:02:54.942710,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9733073, 'precision': 0.97354496, 'recall': 0.97354496, 'specificity': 0.97354496, 'f1': 0.9733073, 'auroc': 0.99706876, 'binary_precision': 0.9887566, 'binary_recall': 0.9583333, 'binary_specificity': 0.9887566, 'binary_f1_score': 0.9733073}
confusion matrix:
      0     1
0  1495    17
1    65  1495
---- Validation: 
scalar performance:
{'acc': 0.79923075, 'precision': 0.82565784, 'recall': 0.79701704, 'specificity': 0.79701704, 'f1': 0.7942128, 'auroc': 0.88321257, 'binary_precision': 0.9146608, 'binary_recall': 0.653125, 'binary_specificity': 0.9409091, 'binary_f1_score': 0.7620784}
confusion matrix:
     0    1
0  621   39
1  222  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8733624, 'precision': 0.8839344, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.8724847, 'auroc': 0.94294536, 'binary_precision': 0.947644, 'binary_recall': 0.790393, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.86190474}
confusion matrix:
     0    1
0  219   10
1   48  181
new oracle model saved
early stop counter: 2
val acc:0.7992307543754578, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 3,now: 2024-07-26 09:39:48.083176,epoch time: 0:01:23.732347,used: 0:04:18.675057,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.93912804, 'recall': 0.93030626, 'specificity': 0.93030626, 'f1': 0.93088263, 'auroc': 0.9963014, 'binary_precision': 0.8843305, 'binary_recall': 0.9948718, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.9363499}
confusion matrix:
      0     1
0  1309   203
1     8  1552
---- Validation: 
scalar performance:
{'acc': 0.76153845, 'precision': 0.7755939, 'recall': 0.7632339, 'specificity': 0.7632339, 'f1': 0.75920403, 'auroc': 0.8690767, 'binary_precision': 0.7093909, 'binary_recall': 0.8734375, 'binary_specificity': 0.6530303, 'binary_f1_score': 0.7829132}
confusion matrix:
     0    1
0  431  229
1   81  559
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7248908, 'precision': 0.7862153, 'recall': 0.7248908, 'specificity': 0.7248908, 'f1': 0.7093206, 'auroc': 0.9162296, 'binary_precision': 0.65373135, 'binary_recall': 0.95633185, 'binary_specificity': 0.49344978, 'binary_f1_score': 0.7765958}
confusion matrix:
     0    1
0  113  116
1   10  219
early stop counter: 3
val acc:0.7615384459495544, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 4,now: 2024-07-26 09:41:11.784893,epoch time: 0:01:23.701717,used: 0:05:42.376774,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9811198, 'precision': 0.98118263, 'recall': 0.9810643, 'specificity': 0.9810643, 'f1': 0.9811131, 'auroc': 0.9982567, 'binary_precision': 0.97834396, 'binary_recall': 0.9846154, 'binary_specificity': 0.97751325, 'binary_f1_score': 0.9814697}
confusion matrix:
      0     1
0  1478    34
1    24  1536
---- Validation: 
scalar performance:
{'acc': 0.83076924, 'precision': 0.847008, 'recall': 0.8290956, 'specificity': 0.8290956, 'f1': 0.82823193, 'auroc': 0.9065666, 'binary_precision': 0.9183267, 'binary_recall': 0.7203125, 'binary_specificity': 0.9378788, 'binary_f1_score': 0.80735546}
confusion matrix:
     0    1
0  619   41
1  179  461
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.8878207, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.86257434, 'auroc': 0.94100034, 'binary_precision': 0.982659, 'binary_recall': 0.7423581, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.8457712}
confusion matrix:
     0    1
0  226    3
1   59  170
early stop counter: 4
val acc:0.8307692408561707, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 5,now: 2024-07-26 09:42:36.585366,epoch time: 0:01:24.800473,used: 0:07:07.177247,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9827474, 'precision': 0.9831228, 'recall': 0.9825753, 'specificity': 0.9825753, 'f1': 0.9827354, 'auroc': 0.9990494, 'binary_precision': 0.9730069, 'binary_recall': 0.99358976, 'binary_specificity': 0.97156084, 'binary_f1_score': 0.98319066}
confusion matrix:
      0     1
0  1469    43
1    10  1550
---- Validation: 
scalar performance:
{'acc': 0.8376923, 'precision': 0.83962953, 'recall': 0.8370975, 'specificity': 0.8370975, 'f1': 0.83726, 'auroc': 0.90042615, 'binary_precision': 0.8617201, 'binary_recall': 0.7984375, 'binary_specificity': 0.8757576, 'binary_f1_score': 0.8288726}
confusion matrix:
     0    1
0  578   82
1  129  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.86681724, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8620343, 'auroc': 0.92860544, 'binary_precision': 0.90686274, 'binary_recall': 0.80786026, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8545034}
confusion matrix:
     0    1
0  210   19
1   44  185
early stop counter: 5
val acc:0.8376923203468323, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 6,now: 2024-07-26 09:43:58.912926,epoch time: 0:01:22.327560,used: 0:08:29.504807,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.98176634, 'recall': 0.98176634, 'specificity': 0.98176634, 'f1': 0.98176634, 'auroc': 0.9983648, 'binary_precision': 0.98205125, 'binary_recall': 0.98205125, 'binary_specificity': 0.9814815, 'binary_f1_score': 0.98205125}
confusion matrix:
      0     1
0  1484    28
1    28  1532
---- Validation: 
scalar performance:
{'acc': 0.82153845, 'precision': 0.834154, 'recall': 0.8200284, 'specificity': 0.8200284, 'f1': 0.8193216, 'auroc': 0.894472, 'binary_precision': 0.89534885, 'binary_recall': 0.721875, 'binary_specificity': 0.91818184, 'binary_f1_score': 0.79930794}
confusion matrix:
     0    1
0  606   54
1  178  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8646288, 'precision': 0.86743146, 'recall': 0.8646288, 'specificity': 0.8646288, 'f1': 0.8643702, 'auroc': 0.9310844, 'binary_precision': 0.8995215, 'binary_recall': 0.8209607, 'binary_specificity': 0.90829694, 'binary_f1_score': 0.8584475}
confusion matrix:
     0    1
0  208   21
1   41  188
early stop counter: 6
val acc:0.8215384483337402, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 7,now: 2024-07-26 09:45:22.612805,epoch time: 0:01:23.699879,used: 0:09:53.204686,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9817708, 'precision': 0.982092, 'recall': 0.98161376, 'specificity': 0.98161376, 'f1': 0.9817591, 'auroc': 0.99914825, 'binary_precision': 0.972956, 'binary_recall': 0.9916667, 'binary_specificity': 0.97156084, 'binary_f1_score': 0.9822222}
confusion matrix:
      0     1
0  1469    43
1    13  1547
---- Validation: 
scalar performance:
{'acc': 0.83692306, 'precision': 0.8430666, 'recall': 0.8379498, 'specificity': 0.8379498, 'f1': 0.8364489, 'auroc': 0.90643466, 'binary_precision': 0.79315066, 'binary_recall': 0.9046875, 'binary_specificity': 0.7712121, 'binary_f1_score': 0.84525543}
confusion matrix:
     0    1
0  509  151
1   61  579
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76419216, 'precision': 0.7914221, 'recall': 0.7641921, 'specificity': 0.7641921, 'f1': 0.758552, 'auroc': 0.9109285, 'binary_precision': 0.70234114, 'binary_recall': 0.9170306, 'binary_specificity': 0.6113537, 'binary_f1_score': 0.79545456}
confusion matrix:
     0    1
0  140   89
1   19  210
early stop counter: 7
val acc:0.8369230628013611, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 8,now: 2024-07-26 09:46:46.335721,epoch time: 0:01:23.722916,used: 0:11:16.927602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9788411, 'precision': 0.97881544, 'recall': 0.9789225, 'specificity': 0.9789225, 'f1': 0.978839, 'auroc': 0.99836314, 'binary_precision': 0.98444587, 'binary_recall': 0.9737179, 'binary_specificity': 0.984127, 'binary_f1_score': 0.97905254}
confusion matrix:
      0     1
0  1488    24
1    41  1519
---- Validation: 
scalar performance:
{'acc': 0.7307692, 'precision': 0.77106225, 'recall': 0.72774625, 'specificity': 0.72774625, 'f1': 0.7186321, 'auroc': 0.8343667, 'binary_precision': 0.8717949, 'binary_recall': 0.53125, 'binary_specificity': 0.92424244, 'binary_f1_score': 0.66019416}
confusion matrix:
     0    1
0  610   50
1  300  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84497815, 'precision': 0.8451427, 'recall': 0.8449782, 'specificity': 0.8449782, 'f1': 0.84495974, 'auroc': 0.91794586, 'binary_precision': 0.8526786, 'binary_recall': 0.83406115, 'binary_specificity': 0.8558952, 'binary_f1_score': 0.8432672}
confusion matrix:
     0    1
0  196   33
1   38  191
early stop counter: 8
val acc:0.7307692170143127, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 9,now: 2024-07-26 09:48:07.539254,epoch time: 0:01:21.203533,used: 0:12:38.131135,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98267394, 'recall': 0.9818732, 'specificity': 0.9818732, 'f1': 0.9820806, 'auroc': 0.99944335, 'binary_precision': 0.9694323, 'binary_recall': 0.99615383, 'binary_specificity': 0.9675926, 'binary_f1_score': 0.98261136}
confusion matrix:
      0     1
0  1463    49
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.82384616, 'precision': 0.84193707, 'recall': 0.8220644, 'specificity': 0.8220644, 'f1': 0.8208904, 'auroc': 0.8891903, 'binary_precision': 0.9168357, 'binary_recall': 0.70625, 'binary_specificity': 0.9378788, 'binary_f1_score': 0.7978817}
confusion matrix:
     0    1
0  619   41
1  188  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8515284, 'precision': 0.87063956, 'recall': 0.8515284, 'specificity': 0.8515284, 'f1': 0.84958947, 'auroc': 0.92392874, 'binary_precision': 0.9548023, 'binary_recall': 0.7379913, 'binary_specificity': 0.9650655, 'binary_f1_score': 0.83251226}
confusion matrix:
     0    1
0  221    8
1   60  169
early stop counter: 9
val acc:0.823846161365509, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 10,now: 2024-07-26 09:49:30.413464,epoch time: 0:01:22.874210,used: 0:14:01.005345,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94628906, 'precision': 0.95138264, 'recall': 0.9454975, 'specificity': 0.9454975, 'f1': 0.94605815, 'auroc': 0.9976042, 'binary_precision': 0.90718037, 'binary_recall': 0.99615383, 'binary_specificity': 0.89484125, 'binary_f1_score': 0.9495875}
confusion matrix:
      0     1
0  1353   159
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.7661539, 'precision': 0.7796235, 'recall': 0.7678031, 'specificity': 0.7678031, 'f1': 0.76400673, 'auroc': 0.86876655, 'binary_precision': 0.71428573, 'binary_recall': 0.875, 'binary_specificity': 0.6606061, 'binary_f1_score': 0.78651685}
confusion matrix:
     0    1
0  436  224
1   80  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8165939, 'precision': 0.83523476, 'recall': 0.8165939, 'specificity': 0.8165939, 'f1': 0.81400836, 'auroc': 0.93337274, 'binary_precision': 0.75618374, 'binary_recall': 0.93449783, 'binary_specificity': 0.69868994, 'binary_f1_score': 0.8359375}
confusion matrix:
     0    1
0  160   69
1   15  214
early stop counter: 10
val acc:0.766153872013092, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 11,now: 2024-07-26 09:50:54.036019,epoch time: 0:01:23.622555,used: 0:15:24.627900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9866536, 'precision': 0.98662376, 'recall': 0.9866961, 'specificity': 0.9866961, 'f1': 0.9866515, 'auroc': 0.99925977, 'binary_precision': 0.98968405, 'binary_recall': 0.98397434, 'binary_specificity': 0.98941797, 'binary_f1_score': 0.986821}
confusion matrix:
      0     1
0  1496    16
1    25  1535
---- Validation: 
scalar performance:
{'acc': 0.77307695, 'precision': 0.7774378, 'recall': 0.7720644, 'specificity': 0.7720644, 'f1': 0.77169883, 'auroc': 0.8480557, 'binary_precision': 0.8085868, 'binary_recall': 0.70625, 'binary_specificity': 0.83787876, 'binary_f1_score': 0.7539616}
confusion matrix:
     0    1
0  553  107
1  188  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8231441, 'precision': 0.8234463, 'recall': 0.8231441, 'specificity': 0.8231441, 'f1': 0.8231027, 'auroc': 0.9028814, 'binary_precision': 0.8333333, 'binary_recall': 0.80786026, 'binary_specificity': 0.83842796, 'binary_f1_score': 0.8203991}
confusion matrix:
     0    1
0  192   37
1   44  185
early stop counter: 11
val acc:0.7730769515037537, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 12,now: 2024-07-26 09:52:18.215443,epoch time: 0:01:24.179424,used: 0:16:48.807324,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9876302, 'precision': 0.98773545, 'recall': 0.987556, 'specificity': 0.987556, 'f1': 0.9876251, 'auroc': 0.99943656, 'binary_precision': 0.9834816, 'binary_recall': 0.99230766, 'binary_specificity': 0.98280424, 'binary_f1_score': 0.98787487}
confusion matrix:
      0     1
0  1486    26
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.7592308, 'precision': 0.8053793, 'recall': 0.75620264, 'specificity': 0.75620264, 'f1': 0.74829257, 'auroc': 0.8807978, 'binary_precision': 0.9203085, 'binary_recall': 0.559375, 'binary_specificity': 0.9530303, 'binary_f1_score': 0.6958212}
confusion matrix:
     0    1
0  629   31
1  282  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8122271, 'precision': 0.848632, 'recall': 0.8122271, 'specificity': 0.8122271, 'f1': 0.80719376, 'auroc': 0.93259084, 'binary_precision': 0.9612903, 'binary_recall': 0.65065503, 'binary_specificity': 0.9737991, 'binary_f1_score': 0.7760416}
confusion matrix:
     0    1
0  223    6
1   80  149
early stop counter: 12
val acc:0.7592307925224304, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 13,now: 2024-07-26 09:53:40.521353,epoch time: 0:01:22.305910,used: 0:18:11.113234,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9840495, 'precision': 0.98427504, 'recall': 0.9842847, 'specificity': 0.9842847, 'f1': 0.98404944, 'auroc': 0.9995769, 'binary_precision': 0.99933904, 'binary_recall': 0.9692308, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9840547}
confusion matrix:
      0     1
0  1511     1
1    48  1512
---- Validation: 
scalar performance:
{'acc': 0.56846154, 'precision': 0.7375044, 'recall': 0.5618608, 'specificity': 0.5618608, 'f1': 0.46619877, 'auroc': 0.8808516, 'binary_precision': 0.93406594, 'binary_recall': 0.1328125, 'binary_specificity': 0.9909091, 'binary_f1_score': 0.23255813}
confusion matrix:
     0   1
0  654   6
1  555  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6004367, 'precision': 0.7779126, 'recall': 0.6004367, 'specificity': 0.6004367, 'f1': 0.524527, 'auroc': 0.9376251, 'binary_precision': 1.0, 'binary_recall': 0.20087336, 'binary_specificity': 1.0, 'binary_f1_score': 0.33454543}
confusion matrix:
     0   1
0  229   0
1  183  46
early stop counter: 13
val acc:0.568461537361145, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 14,now: 2024-07-26 09:55:03.860911,epoch time: 0:01:23.339558,used: 0:19:34.452792,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9895833, 'precision': 0.9895833, 'recall': 0.9897029, 'specificity': 0.9897029, 'f1': 0.98958266, 'auroc': 0.9994972, 'binary_precision': 0.9973958, 'binary_recall': 0.98205125, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.989664}
confusion matrix:
      0     1
0  1508     4
1    28  1532
---- Validation: 
scalar performance:
{'acc': 0.7915385, 'precision': 0.82308674, 'recall': 0.7891098, 'specificity': 0.7891098, 'f1': 0.78533465, 'auroc': 0.8878664, 'binary_precision': 0.92027336, 'binary_recall': 0.63125, 'binary_specificity': 0.9469697, 'binary_f1_score': 0.7488415}
confusion matrix:
     0    1
0  625   35
1  236  404
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7751092, 'precision': 0.82944375, 'recall': 0.7751092, 'specificity': 0.7751092, 'f1': 0.7654377, 'auroc': 0.91725934, 'binary_precision': 0.9632353, 'binary_recall': 0.5720524, 'binary_specificity': 0.9781659, 'binary_f1_score': 0.71780825}
confusion matrix:
     0    1
0  224    5
1   98  131
early stop counter: 14
val acc:0.7915384769439697, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 15,now: 2024-07-26 09:56:28.479378,epoch time: 0:01:24.618467,used: 0:20:59.071259,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9820964, 'precision': 0.98245054, 'recall': 0.9823718, 'specificity': 0.9823718, 'f1': 0.9820963, 'auroc': 0.9995252, 'binary_precision': 1.0, 'binary_recall': 0.9647436, 'binary_specificity': 1.0, 'binary_f1_score': 0.9820555}
confusion matrix:
      0     1
0  1512     0
1    55  1505
---- Validation: 
scalar performance:
{'acc': 0.72615385, 'precision': 0.80066353, 'recall': 0.72227746, 'specificity': 0.72227746, 'f1': 0.7057919, 'auroc': 0.8789921, 'binary_precision': 0.9465409, 'binary_recall': 0.4703125, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.62839246}
confusion matrix:
     0    1
0  643   17
1  339  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7510917, 'precision': 0.8195607, 'recall': 0.7510917, 'specificity': 0.7510917, 'f1': 0.7370043, 'auroc': 0.91743577, 'binary_precision': 0.96747965, 'binary_recall': 0.51965064, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.6761363}
confusion matrix:
     0    1
0  225    4
1  110  119
early stop counter: 15
val acc:0.7261538505554199, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 16,now: 2024-07-26 09:57:52.674506,epoch time: 0:01:24.195128,used: 0:22:23.266387,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98014325, 'precision': 0.9808581, 'recall': 0.9798891, 'specificity': 0.9798891, 'f1': 0.9801234, 'auroc': 0.9992373, 'binary_precision': 0.9658173, 'binary_recall': 0.99615383, 'binary_specificity': 0.96362436, 'binary_f1_score': 0.98075104}
confusion matrix:
      0     1
0  1457    55
1     6  1554
---- Validation: 
scalar performance:
{'acc': 0.78, 'precision': 0.78018856, 'recall': 0.77973485, 'specificity': 0.77973485, 'f1': 0.77981186, 'auroc': 0.85196555, 'binary_precision': 0.7845659, 'binary_recall': 0.7625, 'binary_specificity': 0.7969697, 'binary_f1_score': 0.7733756}
confusion matrix:
     0    1
0  526  134
1  152  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.779476, 'precision': 0.80396545, 'recall': 0.779476, 'specificity': 0.779476, 'f1': 0.774943, 'auroc': 0.88125706, 'binary_precision': 0.7176871, 'binary_recall': 0.9213974, 'binary_specificity': 0.6375546, 'binary_f1_score': 0.80688334}
confusion matrix:
     0    1
0  146   83
1   18  211
early stop counter: 16
val acc:0.7799999713897705, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 17,now: 2024-07-26 09:59:20.194273,epoch time: 0:01:27.519767,used: 0:23:50.786154,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.99121094, 'precision': 0.9911815, 'recall': 0.99125457, 'specificity': 0.99125457, 'f1': 0.99120957, 'auroc': 0.99933225, 'binary_precision': 0.9941973, 'binary_recall': 0.98846155, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.99132115}
confusion matrix:
      0     1
0  1503     9
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.7307692, 'precision': 0.80564415, 'recall': 0.7269176, 'specificity': 0.7269176, 'f1': 0.71100104, 'auroc': 0.8860452, 'binary_precision': 0.953125, 'binary_recall': 0.4765625, 'binary_specificity': 0.97727275, 'binary_f1_score': 0.6354167}
confusion matrix:
     0    1
0  645   15
1  335  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66157204, 'precision': 0.7918503, 'recall': 0.66157204, 'specificity': 0.66157204, 'f1': 0.6190604, 'auroc': 0.9273946, 'binary_precision': 0.9868421, 'binary_recall': 0.32751092, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.4918033}
confusion matrix:
     0   1
0  228   1
1  154  75
early stop counter: 17
val acc:0.7307692170143127, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 18,now: 2024-07-26 10:00:46.502881,epoch time: 0:01:26.308608,used: 0:25:17.094762,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.992556, 'recall': 0.99247557, 'specificity': 0.99247557, 'f1': 0.9925107, 'auroc': 0.9994843, 'binary_precision': 0.99042755, 'binary_recall': 0.9948718, 'binary_specificity': 0.99007934, 'binary_f1_score': 0.9926447}
confusion matrix:
      0     1
0  1497    15
1     8  1552
---- Validation: 
scalar performance:
{'acc': 0.7753846, 'precision': 0.82417583, 'recall': 0.7723721, 'specificity': 0.7723721, 'f1': 0.7652588, 'auroc': 0.91149855, 'binary_precision': 0.9461538, 'binary_recall': 0.5765625, 'binary_specificity': 0.9681818, 'binary_f1_score': 0.71650493}
confusion matrix:
     0    1
0  639   21
1  271  369
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7510917, 'precision': 0.82291484, 'recall': 0.7510917, 'specificity': 0.7510917, 'f1': 0.7364361, 'auroc': 0.92992127, 'binary_precision': 0.9752066, 'binary_recall': 0.5152838, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.67428565}
confusion matrix:
     0    1
0  226    3
1  111  118
early stop counter: 18
val acc:0.7753846049308777, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 19,now: 2024-07-26 10:02:10.595312,epoch time: 0:01:24.092431,used: 0:26:41.187193,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.976237, 'precision': 0.97694296, 'recall': 0.97598183, 'specificity': 0.97598183, 'f1': 0.9762133, 'auroc': 0.99902064, 'binary_precision': 0.9620882, 'binary_recall': 0.99230766, 'binary_specificity': 0.95965606, 'binary_f1_score': 0.97696435}
confusion matrix:
      0     1
0  1451    61
1    12  1548
---- Validation: 
scalar performance:
{'acc': 0.7146154, 'precision': 0.73286116, 'recall': 0.7123816, 'specificity': 0.7123816, 'f1': 0.70748264, 'auroc': 0.8020786, 'binary_precision': 0.79431075, 'binary_recall': 0.5671875, 'binary_specificity': 0.8575758, 'binary_f1_score': 0.6618049}
confusion matrix:
     0    1
0  566   94
1  277  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860262, 'precision': 0.7897614, 'recall': 0.78602624, 'specificity': 0.78602624, 'f1': 0.78533435, 'auroc': 0.86276007, 'binary_precision': 0.8226601, 'binary_recall': 0.72925764, 'binary_specificity': 0.8427948, 'binary_f1_score': 0.7731481}
confusion matrix:
     0    1
0  193   36
1   62  167
early stop counter: 19
val acc:0.7146154046058655, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 20,now: 2024-07-26 10:03:33.449373,epoch time: 0:01:22.854061,used: 0:28:04.041254,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9847005, 'precision': 0.9849262, 'recall': 0.9849359, 'specificity': 0.9849359, 'f1': 0.98470056, 'auroc': 0.99959505, 'binary_precision': 1.0, 'binary_recall': 0.9698718, 'binary_specificity': 1.0, 'binary_f1_score': 0.98470557}
confusion matrix:
      0     1
0  1512     0
1    47  1513
---- Validation: 
scalar performance:
{'acc': 0.68538463, 'precision': 0.77855253, 'recall': 0.68087125, 'specificity': 0.68087125, 'f1': 0.6533842, 'auroc': 0.881253, 'binary_precision': 0.9358491, 'binary_recall': 0.3875, 'binary_specificity': 0.97424245, 'binary_f1_score': 0.5480663}
confusion matrix:
     0    1
0  643   17
1  392  248
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6637555, 'precision': 0.7927191, 'recall': 0.6637555, 'specificity': 0.6637555, 'f1': 0.62213653, 'auroc': 0.92391443, 'binary_precision': 0.987013, 'binary_recall': 0.33187774, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.49673206}
confusion matrix:
     0   1
0  228   1
1  153  76
early stop counter: 20
val acc:0.6853846311569214, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 21,now: 2024-07-26 10:04:58.042739,epoch time: 0:01:24.593366,used: 0:29:28.634620,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98860675, 'precision': 0.9886019, 'recall': 0.988721, 'specificity': 0.988721, 'f1': 0.988606, 'auroc': 0.99952644, 'binary_precision': 0.9960963, 'binary_recall': 0.98141026, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.9886987}
confusion matrix:
      0     1
0  1506     6
1    29  1531
---- Validation: 
scalar performance:
{'acc': 0.76153845, 'precision': 0.79515594, 'recall': 0.7589015, 'specificity': 0.7589015, 'f1': 0.7532687, 'auroc': 0.88852984, 'binary_precision': 0.89099526, 'binary_recall': 0.5875, 'binary_specificity': 0.93030304, 'binary_f1_score': 0.7080979}
confusion matrix:
     0    1
0  614   46
1  264  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8624454, 'precision': 0.86681724, 'recall': 0.8624454, 'specificity': 0.8624454, 'f1': 0.8620343, 'auroc': 0.9202913, 'binary_precision': 0.90686274, 'binary_recall': 0.80786026, 'binary_specificity': 0.9170306, 'binary_f1_score': 0.8545034}
confusion matrix:
     0    1
0  210   19
1   44  185
early stop counter: 21
val acc:0.7615384459495544, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 22,now: 2024-07-26 10:06:20.875579,epoch time: 0:01:22.832840,used: 0:30:51.467460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.991862, 'precision': 0.99183124, 'recall': 0.99192613, 'specificity': 0.99192613, 'f1': 0.9918609, 'auroc': 0.99971724, 'binary_precision': 0.9961215, 'binary_recall': 0.9878205, 'binary_specificity': 0.99603176, 'binary_f1_score': 0.9919537}
confusion matrix:
      0     1
0  1506     6
1    19  1541
---- Validation: 
scalar performance:
{'acc': 0.74923074, 'precision': 0.81109154, 'recall': 0.74576235, 'specificity': 0.74576235, 'f1': 0.7343173, 'auroc': 0.8967253, 'binary_precision': 0.94602275, 'binary_recall': 0.5203125, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.671371}
confusion matrix:
     0    1
0  641   19
1  307  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7510917, 'precision': 0.8195607, 'recall': 0.7510917, 'specificity': 0.7510917, 'f1': 0.7370043, 'auroc': 0.9271562, 'binary_precision': 0.96747965, 'binary_recall': 0.51965064, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.6761363}
confusion matrix:
     0    1
0  225    4
1  110  119
early stop counter: 22
val acc:0.7492307424545288, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 23,now: 2024-07-26 10:07:45.505436,epoch time: 0:01:24.629857,used: 0:32:16.097317,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.992513, 'precision': 0.9924917, 'recall': 0.99253666, 'specificity': 0.99253666, 'f1': 0.9925115, 'auroc': 0.99969816, 'binary_precision': 0.9942122, 'binary_recall': 0.9910256, 'binary_specificity': 0.99404764, 'binary_f1_score': 0.99261636}
confusion matrix:
      0     1
0  1503     9
1    14  1546
---- Validation: 
scalar performance:
{'acc': 0.76692307, 'precision': 0.813658, 'recall': 0.7639204, 'specificity': 0.7639204, 'f1': 0.756497, 'auroc': 0.9114127, 'binary_precision': 0.9309463, 'binary_recall': 0.56875, 'binary_specificity': 0.9590909, 'binary_f1_score': 0.70611066}
confusion matrix:
     0    1
0  633   27
1  276  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63973796, 'precision': 0.76367295, 'recall': 0.63973796, 'specificity': 0.63973796, 'f1': 0.59176725, 'auroc': 0.905265, 'binary_precision': 0.9444444, 'binary_recall': 0.29694322, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.4518272}
confusion matrix:
     0   1
0  225   4
1  161  68
early stop counter: 23
val acc:0.7669230699539185, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 24,now: 2024-07-26 10:09:09.081186,epoch time: 0:01:23.575750,used: 0:33:39.673067,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99153644, 'precision': 0.9915061, 'recall': 0.99158525, 'specificity': 0.99158525, 'f1': 0.9915352, 'auroc': 0.9997257, 'binary_precision': 0.9948387, 'binary_recall': 0.98846155, 'binary_specificity': 0.994709, 'binary_f1_score': 0.9916399}
confusion matrix:
      0     1
0  1504     8
1    18  1542
---- Validation: 
scalar performance:
{'acc': 0.8030769, 'precision': 0.8321569, 'recall': 0.80078125, 'specificity': 0.80078125, 'f1': 0.79780066, 'auroc': 0.9031025, 'binary_precision': 0.9266667, 'binary_recall': 0.6515625, 'binary_specificity': 0.95, 'binary_f1_score': 0.7651377}
confusion matrix:
     0    1
0  627   33
1  223  417
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84061134, 'precision': 0.8614619, 'recall': 0.84061134, 'specificity': 0.84061134, 'f1': 0.8382792, 'auroc': 0.9279428, 'binary_precision': 0.94827586, 'binary_recall': 0.720524, 'binary_specificity': 0.96069866, 'binary_f1_score': 0.81885856}
confusion matrix:
     0    1
0  220    9
1   64  165
early stop counter: 24
val acc:0.8030769228935242, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 25,now: 2024-07-26 10:10:32.729322,epoch time: 0:01:23.648136,used: 0:35:03.321203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9863281, 'precision': 0.98646224, 'recall': 0.9865283, 'specificity': 0.9865283, 'f1': 0.986328, 'auroc': 0.9991888, 'binary_precision': 0.9993421, 'binary_recall': 0.9737179, 'binary_specificity': 0.9993386, 'binary_f1_score': 0.9863636}
confusion matrix:
      0     1
0  1511     1
1    41  1519
---- Validation: 
scalar performance:
{'acc': 0.6423077, 'precision': 0.7684766, 'recall': 0.6369555, 'specificity': 0.6369555, 'f1': 0.58982885, 'auroc': 0.8932185, 'binary_precision': 0.94871795, 'binary_recall': 0.2890625, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.4431138}
confusion matrix:
     0    1
0  650   10
1  455  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58733624, 'precision': 0.74166316, 'recall': 0.58733624, 'specificity': 0.58733624, 'f1': 0.5089377, 'auroc': 0.9299259, 'binary_precision': 0.9347826, 'binary_recall': 0.18777293, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.3127273}
confusion matrix:
     0   1
0  226   3
1  186  43
early stop counter: 25
val acc:0.642307698726654, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 26,now: 2024-07-26 10:11:55.553932,epoch time: 0:01:22.824610,used: 0:36:26.145813,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.98795575, 'precision': 0.98794234, 'recall': 0.98805964, 'specificity': 0.98805964, 'f1': 0.9879548, 'auroc': 0.9993526, 'binary_precision': 0.9948018, 'binary_recall': 0.98141026, 'binary_specificity': 0.994709, 'binary_f1_score': 0.9880607}
confusion matrix:
      0     1
0  1504     8
1    29  1531
---- Validation: 
scalar performance:
{'acc': 0.68846154, 'precision': 0.77727544, 'recall': 0.6840436, 'specificity': 0.6840436, 'f1': 0.6581682, 'auroc': 0.8943951, 'binary_precision': 0.93040293, 'binary_recall': 0.396875, 'binary_specificity': 0.97121215, 'binary_f1_score': 0.55640745}
confusion matrix:
     0    1
0  641   19
1  386  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6113537, 'precision': 0.7813268, 'recall': 0.6113537, 'specificity': 0.6113537, 'f1': 0.54220575, 'auroc': 0.9504776, 'binary_precision': 1.0, 'binary_recall': 0.22270742, 'binary_specificity': 1.0, 'binary_f1_score': 0.3642857}
confusion matrix:
     0   1
0  229   0
1  178  51
early stop counter: 26
val acc:0.6884615421295166, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 27,now: 2024-07-26 10:13:17.788315,epoch time: 0:01:22.234383,used: 0:37:48.380196,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9944661, 'precision': 0.99452657, 'recall': 0.994419, 'specificity': 0.994419, 'f1': 0.9944643, 'auroc': 0.9999207, 'binary_precision': 0.9917145, 'binary_recall': 0.99743587, 'binary_specificity': 0.9914021, 'binary_f1_score': 0.994567}
confusion matrix:
      0     1
0  1499    13
1     4  1556
---- Validation: 
scalar performance:
{'acc': 0.79846156, 'precision': 0.8264057, 'recall': 0.7961885, 'specificity': 0.7961885, 'f1': 0.79316664, 'auroc': 0.89995027, 'binary_precision': 0.9181416, 'binary_recall': 0.6484375, 'binary_specificity': 0.9439394, 'binary_f1_score': 0.76007324}
confusion matrix:
     0    1
0  623   37
1  225  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80131006, 'precision': 0.8468783, 'recall': 0.80131006, 'specificity': 0.80131006, 'f1': 0.7945632, 'auroc': 0.944223, 'binary_precision': 0.9726027, 'binary_recall': 0.6200873, 'binary_specificity': 0.98253274, 'binary_f1_score': 0.75733334}
confusion matrix:
     0    1
0  225    4
1   87  142
early stop counter: 27
val acc:0.7984615564346313, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 28,now: 2024-07-26 10:14:41.966708,epoch time: 0:01:24.178393,used: 0:39:12.558589,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9905599, 'precision': 0.9905465, 'recall': 0.9906644, 'specificity': 0.9906644, 'f1': 0.9905592, 'auroc': 0.99970067, 'binary_precision': 0.99740094, 'binary_recall': 0.98397434, 'binary_specificity': 0.9973545, 'binary_f1_score': 0.9906422}
confusion matrix:
      0     1
0  1508     4
1    25  1535
---- Validation: 
scalar performance:
{'acc': 0.66307694, 'precision': 0.77702636, 'recall': 0.65807295, 'specificity': 0.65807295, 'f1': 0.62037563, 'auroc': 0.913682, 'binary_precision': 0.95089287, 'binary_recall': 0.3328125, 'binary_specificity': 0.98333335, 'binary_f1_score': 0.49305552}
confusion matrix:
     0    1
0  649   11
1  427  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5414847, 'precision': 0.73706007, 'recall': 0.5414847, 'specificity': 0.5414847, 'f1': 0.42234236, 'auroc': 0.93175185, 'binary_precision': 0.95238096, 'binary_recall': 0.08733624, 'binary_specificity': 0.9956332, 'binary_f1_score': 0.16}
confusion matrix:
     0   1
0  228   1
1  209  20
early stop counter: 28
val acc:0.6630769371986389, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 29,now: 2024-07-26 10:16:06.522106,epoch time: 0:01:24.555398,used: 0:40:37.113987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9973958, 'precision': 0.9974061, 'recall': 0.997385, 'specificity': 0.997385, 'f1': 0.99739516, 'auroc': 0.99996865, 'binary_precision': 0.996799, 'binary_recall': 0.9980769, 'binary_specificity': 0.99669313, 'binary_f1_score': 0.99743754}
confusion matrix:
      0     1
0  1507     5
1     3  1557
---- Validation: 
scalar performance:
{'acc': 0.8453846, 'precision': 0.8616663, 'recall': 0.84375, 'specificity': 0.84375, 'f1': 0.8431549, 'auroc': 0.92161345, 'binary_precision': 0.93465346, 'binary_recall': 0.7375, 'binary_specificity': 0.95, 'binary_f1_score': 0.8244541}
confusion matrix:
     0    1
0  627   33
1  168  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8471616, 'precision': 0.87657464, 'recall': 0.84716153, 'specificity': 0.84716153, 'f1': 0.8441177, 'auroc': 0.95316637, 'binary_precision': 0.9818182, 'binary_recall': 0.70742357, 'binary_specificity': 0.98689955, 'binary_f1_score': 0.82233506}
confusion matrix:
     0    1
0  226    3
1   67  162
early stop counter: 29
val acc:0.8453845977783203, best validation acc: 0.8530769348144531, corresponding to test acc:                         0.8689956068992615 / 0.8733624219894409
after epoch: 30,now: 2024-07-26 10:17:31.246956,epoch time: 0:01:24.724850,used: 0:42:01.838837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_09_35_29_seed_7_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:01.838837 at 2024-07-26 10:17:31.246956
persisted model performance metric: 

scalar performance:
{'acc': 0.8689956, 'precision': 0.8703799, 'recall': 0.86899567, 'specificity': 0.86899567, 'f1': 0.8688731, 'auroc': 0.9388455, 'binary_precision': 0.89302325, 'binary_recall': 0.83842796, 'binary_specificity': 0.8995633, 'binary_f1_score': 0.8648648}
confusion matrix:
     0    1
0  206   23
1   37  192
oracle model performance metric: 

scalar performance:
{'acc': 0.8733624, 'precision': 0.8839344, 'recall': 0.8733624, 'specificity': 0.8733624, 'f1': 0.8724847, 'auroc': 0.94294536, 'binary_precision': 0.947644, 'binary_recall': 0.790393, 'binary_specificity': 0.95633185, 'binary_f1_score': 0.86190474}
confusion matrix:
     0    1
0  219   10
1   48  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 587914 GiB | 587914 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 580953 GiB | 580953 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 587914 GiB | 587914 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 580953 GiB | 580953 GiB |
|       from small pool |  40598 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 587084 GiB | 587084 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 580138 GiB | 580137 GiB |
|       from small pool |  40407 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB | 109640 MiB |  95166 MiB |
|       from large pool |  14408 MiB |  14414 MiB | 109460 MiB |  95052 MiB |
|       from small pool |     66 MiB |     70 MiB |    180 MiB |    114 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448038 KiB |   1252 MiB | 419743 GiB | 419743 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 412739 GiB | 412739 GiB |
|       from small pool |  12649 KiB |     45 MiB |   7003 GiB |   7003 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  103445 K  |  103443 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50905 K  |   50904 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  103445 K  |  103443 K  |
|       from large pool |     187    |    1413    |   52539 K  |   52539 K  |
|       from small pool |    1123    |    1419    |   50905 K  |   50904 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    4639    |    4005    |
|       from large pool |     601    |     601    |    4549    |    3948    |
|       from small pool |      33    |      35    |      90    |      57    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      99    |     652    |   66795 K  |   66795 K  |
|       from large pool |      40    |     604    |   37180 K  |   37180 K  |
|       from small pool |      59    |     240    |   29614 K  |   29614 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 587914 GiB | 587914 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 580953 GiB | 580953 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 587914 GiB | 587914 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 580953 GiB | 580953 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587084 GiB | 587084 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 109640 MiB | 108758 MiB |
|       from large pool |    830 MiB |  14414 MiB | 109460 MiB | 108630 MiB |
|       from small pool |     52 MiB |     70 MiB |    180 MiB |    128 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 419743 GiB | 419743 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 412739 GiB | 412739 GiB |
|       from small pool |      0 KiB |     45 MiB |   7003 GiB |   7003 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50905 K  |   50905 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50905 K  |   50905 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    4639    |    4576    |
|       from large pool |      37    |     601    |    4549    |    4512    |
|       from small pool |      26    |      35    |      90    |      64    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   66795 K  |   66795 K  |
|       from large pool |       4    |     604    |   37180 K  |   37180 K  |
|       from small pool |       0    |     240    |   29614 K  |   29614 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 587914 GiB | 587914 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 580953 GiB | 580953 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 587914 GiB | 587914 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 580953 GiB | 580953 GiB |
|       from small pool |      0 KiB |     60 MiB |   6961 GiB |   6961 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 587084 GiB | 587084 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 580138 GiB | 580138 GiB |
|       from small pool |      0 KiB |     60 MiB |   6946 GiB |   6946 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 109640 MiB | 108758 MiB |
|       from large pool |    830 MiB |  14414 MiB | 109460 MiB | 108630 MiB |
|       from small pool |     52 MiB |     70 MiB |    180 MiB |    128 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 419743 GiB | 419743 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 412739 GiB | 412739 GiB |
|       from small pool |      0 KiB |     45 MiB |   7003 GiB |   7003 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50905 K  |   50905 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  103445 K  |  103445 K  |
|       from large pool |       2    |    1413    |   52539 K  |   52539 K  |
|       from small pool |       0    |    1419    |   50905 K  |   50905 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    4639    |    4576    |
|       from large pool |      37    |     601    |    4549    |    4512    |
|       from small pool |      26    |      35    |      90    |      64    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   66795 K  |   66795 K  |
|       from large pool |       4    |     604    |   37180 K  |   37180 K  |
|       from small pool |       0    |     240    |   29614 K  |   29614 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529

 Experiment start at: 2024-07-26 10:18:08.453606
before training, model accuracy: 0.4931192398071289
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9335526, 'precision': 0.93604165, 'recall': 0.93314695, 'specificity': 0.93314695, 'f1': 0.93340737, 'auroc': 0.9892299, 'binary_precision': 0.90577507, 'binary_recall': 0.96942097, 'binary_specificity': 0.89687294, 'binary_f1_score': 0.93651795}
confusion matrix:
      0     1
0  1348   155
1    47  1490
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.804331, 'precision': 0.8315741, 'recall': 0.8088228, 'specificity': 0.8088228, 'f1': 0.80166173, 'auroc': 0.9291425, 'binary_precision': 0.72827417, 'binary_recall': 0.9504792, 'binary_specificity': 0.6671664, 'binary_f1_score': 0.82467085}
confusion matrix:
     0    1
0  445  222
1   31  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.79357797, 'precision': 0.8098792, 'recall': 0.793578, 'specificity': 0.793578, 'f1': 0.79082716, 'auroc': 0.91242313, 'binary_precision': 0.73880595, 'binary_recall': 0.9082569, 'binary_specificity': 0.6788991, 'binary_f1_score': 0.8148148}
confusion matrix:
     0    1
0  148   70
1   20  198
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 10:19:38.024546,epoch time: 0:01:29.570940,used: 0:01:29.570940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9680921, 'precision': 0.96833605, 'recall': 0.9682722, 'specificity': 0.9682722, 'f1': 0.96809196, 'auroc': 0.99646413, 'binary_precision': 0.98259705, 'binary_recall': 0.9538661, 'binary_specificity': 0.98267823, 'binary_f1_score': 0.9680185}
confusion matrix:
      0     1
0  1475    26
1    71  1468
---- Validation: 
scalar performance:
{'acc': 0.8074246, 'precision': 0.8246405, 'recall': 0.80367124, 'specificity': 0.80367124, 'f1': 0.80335534, 'auroc': 0.9019811, 'binary_precision': 0.8918919, 'binary_recall': 0.6853035, 'binary_specificity': 0.922039, 'binary_f1_score': 0.77506775}
confusion matrix:
     0    1
0  615   52
1  197  429
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8424331, 'recall': 0.83256876, 'specificity': 0.83256876, 'f1': 0.8313543, 'auroc': 0.9140434, 'binary_precision': 0.9005525, 'binary_recall': 0.7477064, 'binary_specificity': 0.9174312, 'binary_f1_score': 0.81704265}
confusion matrix:
     0    1
0  200   18
1   55  163
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 10:21:01.032921,epoch time: 0:01:23.008375,used: 0:02:52.579315,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9773026, 'precision': 0.9774213, 'recall': 0.97744304, 'specificity': 0.97744304, 'f1': 0.9773026, 'auroc': 0.9978564, 'binary_precision': 0.9886968, 'binary_recall': 0.96621186, 'binary_specificity': 0.9886742, 'binary_f1_score': 0.977325}
confusion matrix:
      0     1
0  1484    17
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.866976, 'precision': 0.87051356, 'recall': 0.8654183, 'specificity': 0.8654183, 'f1': 0.86619157, 'auroc': 0.9310704, 'binary_precision': 0.8996479, 'binary_recall': 0.81629395, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.8559464}
confusion matrix:
     0    1
0  610   57
1  115  511
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86926603, 'precision': 0.8768872, 'recall': 0.86926603, 'specificity': 0.86926603, 'f1': 0.8686018, 'auroc': 0.92639506, 'binary_precision': 0.93048126, 'binary_recall': 0.79816514, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  205   13
1   44  174
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 10:22:22.839365,epoch time: 0:01:21.806444,used: 0:04:14.385759,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94342107, 'precision': 0.9480942, 'recall': 0.9428694, 'specificity': 0.9428694, 'f1': 0.9432175, 'auroc': 0.9967807, 'binary_precision': 0.9050445, 'binary_recall': 0.99219257, 'binary_specificity': 0.8935462, 'binary_f1_score': 0.946617}
confusion matrix:
      0     1
0  1343   160
1    12  1525
---- Validation: 
scalar performance:
{'acc': 0.71384376, 'precision': 0.7600424, 'recall': 0.720282, 'specificity': 0.720282, 'f1': 0.7042397, 'auroc': 0.87754464, 'binary_precision': 0.6422222, 'binary_recall': 0.9233227, 'binary_specificity': 0.51724136, 'binary_f1_score': 0.7575361}
confusion matrix:
     0    1
0  345  322
1   48  578
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6651376, 'precision': 0.77035964, 'recall': 0.6651376, 'specificity': 0.6651376, 'f1': 0.6290443, 'auroc': 0.92191315, 'binary_precision': 0.60169494, 'binary_recall': 0.9770642, 'binary_specificity': 0.35321102, 'binary_f1_score': 0.7447552}
confusion matrix:
    0    1
0  77  141
1   5  213
early stop counter: 1
val acc:0.7138437628746033, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 4,now: 2024-07-26 10:23:46.125353,epoch time: 0:01:23.285988,used: 0:05:37.671747,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98092103, 'precision': 0.9809382, 'recall': 0.9809882, 'specificity': 0.9809882, 'f1': 0.98092073, 'auroc': 0.9988265, 'binary_precision': 0.987467, 'binary_recall': 0.9746094, 'binary_specificity': 0.98736703, 'binary_f1_score': 0.980996}
confusion matrix:
      0     1
0  1485    19
1    39  1497
---- Validation: 
scalar performance:
{'acc': 0.6550657, 'precision': 0.7038908, 'recall': 0.646814, 'specificity': 0.646814, 'f1': 0.62555325, 'auroc': 0.82160115, 'binary_precision': 0.79605263, 'binary_recall': 0.38658148, 'binary_specificity': 0.9070465, 'binary_f1_score': 0.5204301}
confusion matrix:
     0    1
0  605   62
1  384  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7775229, 'precision': 0.7963887, 'recall': 0.7775229, 'specificity': 0.7775229, 'f1': 0.7739254, 'auroc': 0.8813652, 'binary_precision': 0.87116563, 'binary_recall': 0.6513761, 'binary_specificity': 0.9036697, 'binary_f1_score': 0.7454068}
confusion matrix:
     0    1
0  197   21
1   76  142
early stop counter: 2
val acc:0.6550657153129578, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 5,now: 2024-07-26 10:25:07.598064,epoch time: 0:01:21.472711,used: 0:06:59.144458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9736842, 'precision': 0.97467315, 'recall': 0.9739679, 'specificity': 0.9739679, 'f1': 0.9736787, 'auroc': 0.99837494, 'binary_precision': 0.9993146, 'binary_recall': 0.9486012, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9732977}
confusion matrix:
      0     1
0  1502     1
1    79  1458
---- Validation: 
scalar performance:
{'acc': 0.60943544, 'precision': 0.7332387, 'recall': 0.59743094, 'specificity': 0.59743094, 'f1': 0.5361321, 'auroc': 0.8289106, 'binary_precision': 0.89542484, 'binary_recall': 0.21884984, 'binary_specificity': 0.976012, 'binary_f1_score': 0.35173297}
confusion matrix:
     0    1
0  651   16
1  489  137
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.603211, 'precision': 0.749809, 'recall': 0.60321105, 'specificity': 0.60321105, 'f1': 0.53498924, 'auroc': 0.8764624, 'binary_precision': 0.9411765, 'binary_recall': 0.22018349, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.3568773}
confusion matrix:
     0   1
0  215   3
1  170  48
early stop counter: 3
val acc:0.6094354391098022, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 6,now: 2024-07-26 10:26:30.509016,epoch time: 0:01:22.910952,used: 0:08:22.055410,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9707237, 'precision': 0.97190154, 'recall': 0.97105074, 'specificity': 0.97105074, 'f1': 0.9707161, 'auroc': 0.99852216, 'binary_precision': 0.99862355, 'binary_recall': 0.94343305, 'binary_specificity': 0.99866843, 'binary_f1_score': 0.97024405}
confusion matrix:
      0     1
0  1500     2
1    87  1451
---- Validation: 
scalar performance:
{'acc': 0.59783447, 'precision': 0.74859655, 'recall': 0.5850573, 'specificity': 0.5850573, 'f1': 0.5109483, 'auroc': 0.8465382, 'binary_precision': 0.93442625, 'binary_recall': 0.18210863, 'binary_specificity': 0.988006, 'binary_f1_score': 0.30481285}
confusion matrix:
     0    1
0  659    8
1  512  114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5321101, 'precision': 0.75829387, 'recall': 0.5321101, 'specificity': 0.5321101, 'f1': 0.4009698, 'auroc': 0.89338017, 'binary_precision': 1.0, 'binary_recall': 0.06422018, 'binary_specificity': 1.0, 'binary_f1_score': 0.12068965}
confusion matrix:
     0   1
0  218   0
1  204  14
early stop counter: 4
val acc:0.5978344678878784, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 7,now: 2024-07-26 10:27:53.349759,epoch time: 0:01:22.840743,used: 0:09:44.896153,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.97465646, 'recall': 0.97468626, 'specificity': 0.97468626, 'f1': 0.97466874, 'auroc': 0.9974114, 'binary_precision': 0.9765013, 'binary_recall': 0.97332466, 'binary_specificity': 0.97604793, 'binary_f1_score': 0.9749104}
confusion matrix:
      0     1
0  1467    36
1    41  1496
---- Validation: 
scalar performance:
{'acc': 0.866976, 'precision': 0.8668103, 'recall': 0.8669403, 'specificity': 0.8669403, 'f1': 0.866867, 'auroc': 0.92646253, 'binary_precision': 0.86031747, 'binary_recall': 0.8658147, 'binary_specificity': 0.86806595, 'binary_f1_score': 0.8630573}
confusion matrix:
     0    1
0  579   88
1   84  542
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8669725, 'precision': 0.87505376, 'recall': 0.86697245, 'specificity': 0.86697245, 'f1': 0.86625206, 'auroc': 0.93413854, 'binary_precision': 0.93010753, 'binary_recall': 0.79357797, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85643566}
confusion matrix:
     0    1
0  205   13
1   45  173
early stop counter: 5
val acc:0.8669760227203369, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 8,now: 2024-07-26 10:29:16.176956,epoch time: 0:01:22.827197,used: 0:11:07.723350,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97401315, 'precision': 0.9744495, 'recall': 0.9742123, 'specificity': 0.9742123, 'f1': 0.9740119, 'auroc': 0.9982736, 'binary_precision': 0.9919028, 'binary_recall': 0.95640856, 'binary_specificity': 0.99201596, 'binary_f1_score': 0.9738324}
confusion matrix:
      0     1
0  1491    12
1    67  1470
---- Validation: 
scalar performance:
{'acc': 0.8259861, 'precision': 0.8548876, 'recall': 0.82141674, 'specificity': 0.82141674, 'f1': 0.8207982, 'auroc': 0.92605054, 'binary_precision': 0.9485459, 'binary_recall': 0.6773163, 'binary_specificity': 0.9655172, 'binary_f1_score': 0.7903076}
confusion matrix:
     0    1
0  644   23
1  202  424
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.8455478, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.80723774, 'auroc': 0.9202088, 'binary_precision': 0.9533333, 'binary_recall': 0.6559633, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.77717394}
confusion matrix:
     0    1
0  211    7
1   75  143
early stop counter: 6
val acc:0.8259860873222351, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 9,now: 2024-07-26 10:30:38.729834,epoch time: 0:01:22.552878,used: 0:12:30.276228,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.98453945, 'precision': 0.9845501, 'recall': 0.9845256, 'specificity': 0.9845256, 'f1': 0.9845369, 'auroc': 0.9992589, 'binary_precision': 0.98377675, 'binary_recall': 0.9856957, 'binary_specificity': 0.9833555, 'binary_f1_score': 0.9847353}
confusion matrix:
      0     1
0  1477    25
1    22  1516
---- Validation: 
scalar performance:
{'acc': 0.8553751, 'precision': 0.85557663, 'recall': 0.8548613, 'specificity': 0.8548613, 'f1': 0.85510325, 'auroc': 0.9237777, 'binary_precision': 0.85924715, 'binary_recall': 0.83865815, 'binary_specificity': 0.8710645, 'binary_f1_score': 0.8488278}
confusion matrix:
     0    1
0  581   86
1  101  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83715594, 'precision': 0.8387598, 'recall': 0.83715594, 'specificity': 0.83715594, 'f1': 0.836963, 'auroc': 0.9070785, 'binary_precision': 0.86206895, 'binary_recall': 0.8027523, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.83135396}
confusion matrix:
     0    1
0  190   28
1   43  175
early stop counter: 7
val acc:0.8553751111030579, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 10,now: 2024-07-26 10:32:00.476767,epoch time: 0:01:21.746933,used: 0:13:52.023161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9753289, 'precision': 0.9761666, 'recall': 0.9756099, 'specificity': 0.9756099, 'f1': 0.9753253, 'auroc': 0.99946404, 'binary_precision': 0.9993174, 'binary_recall': 0.9518856, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.975025}
confusion matrix:
      0     1
0  1501     1
1    74  1464
---- Validation: 
scalar performance:
{'acc': 0.65429235, 'precision': 0.7773398, 'recall': 0.6434131, 'specificity': 0.6434131, 'f1': 0.6016601, 'auroc': 0.8825723, 'binary_precision': 0.9543147, 'binary_recall': 0.3003195, 'binary_specificity': 0.98650676, 'binary_f1_score': 0.45686516}
confusion matrix:
     0    1
0  658    9
1  438  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63761467, 'precision': 0.76781327, 'recall': 0.63761467, 'specificity': 0.63761467, 'f1': 0.58747727, 'auroc': 0.9046797, 'binary_precision': 0.95454544, 'binary_recall': 0.28899083, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.443662}
confusion matrix:
     0   1
0  215   3
1  155  63
early stop counter: 8
val acc:0.6542923450469971, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 11,now: 2024-07-26 10:33:24.957329,epoch time: 0:01:24.480562,used: 0:15:16.503723,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98092103, 'precision': 0.9813182, 'recall': 0.9807781, 'specificity': 0.9807781, 'f1': 0.9809103, 'auroc': 0.99947405, 'binary_precision': 0.97013974, 'binary_recall': 0.99284786, 'binary_specificity': 0.9687084, 'binary_f1_score': 0.9813624}
confusion matrix:
      0     1
0  1455    47
1    11  1527
---- Validation: 
scalar performance:
{'acc': 0.8213457, 'precision': 0.8236089, 'recall': 0.82266337, 'specificity': 0.82266337, 'f1': 0.82130295, 'auroc': 0.9044503, 'binary_precision': 0.7874818, 'binary_recall': 0.8642173, 'binary_specificity': 0.78110945, 'binary_f1_score': 0.824067}
confusion matrix:
     0    1
0  521  146
1   85  541
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.809633, 'precision': 0.81311846, 'recall': 0.809633, 'specificity': 0.809633, 'f1': 0.8091018, 'auroc': 0.8975675, 'binary_precision': 0.780083, 'binary_recall': 0.86238533, 'binary_specificity': 0.75688076, 'binary_f1_score': 0.8191721}
confusion matrix:
     0    1
0  165   53
1   30  188
early stop counter: 9
val acc:0.8213456869125366, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 12,now: 2024-07-26 10:34:47.737887,epoch time: 0:01:22.780558,used: 0:16:39.284281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99013156, 'precision': 0.9901553, 'recall': 0.99021125, 'specificity': 0.99021125, 'f1': 0.9901314, 'auroc': 0.9994879, 'binary_precision': 0.99735975, 'binary_recall': 0.9830839, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.9901703}
confusion matrix:
      0     1
0  1499     4
1    26  1511
---- Validation: 
scalar performance:
{'acc': 0.8538283, 'precision': 0.8636942, 'recall': 0.8512018, 'specificity': 0.8512018, 'f1': 0.85204387, 'auroc': 0.9293269, 'binary_precision': 0.9161905, 'binary_recall': 0.7683706, 'binary_specificity': 0.934033, 'binary_f1_score': 0.835795}
confusion matrix:
     0    1
0  623   44
1  145  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.8272425, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.81763214, 'auroc': 0.8944533, 'binary_precision': 0.8797814, 'binary_recall': 0.7385321, 'binary_specificity': 0.89908254, 'binary_f1_score': 0.8029925}
confusion matrix:
     0    1
0  196   22
1   57  161
early stop counter: 10
val acc:0.8538283109664917, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 13,now: 2024-07-26 10:36:11.091949,epoch time: 0:01:23.354062,used: 0:18:02.638343,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98914474, 'precision': 0.9891784, 'recall': 0.9891176, 'specificity': 0.9891176, 'f1': 0.9891428, 'auroc': 0.99964464, 'binary_precision': 0.98704666, 'binary_recall': 0.991542, 'binary_specificity': 0.98669326, 'binary_f1_score': 0.9892892}
confusion matrix:
      0     1
0  1483    20
1    13  1524
---- Validation: 
scalar performance:
{'acc': 0.79969066, 'precision': 0.8221932, 'recall': 0.7953894, 'specificity': 0.7953894, 'f1': 0.79436934, 'auroc': 0.9106419, 'binary_precision': 0.8997821, 'binary_recall': 0.6597444, 'binary_specificity': 0.9310345, 'binary_f1_score': 0.7612903}
confusion matrix:
     0    1
0  621   46
1  213  413
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71100914, 'precision': 0.7943525, 'recall': 0.71100914, 'specificity': 0.71100914, 'f1': 0.6889945, 'auroc': 0.89230704, 'binary_precision': 0.95098037, 'binary_recall': 0.44495413, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.60625}
confusion matrix:
     0   1
0  213   5
1  121  97
early stop counter: 11
val acc:0.7996906638145447, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 14,now: 2024-07-26 10:37:35.739177,epoch time: 0:01:24.647228,used: 0:19:27.285571,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.98782897, 'precision': 0.98784024, 'recall': 0.98781556, 'specificity': 0.98781556, 'f1': 0.98782694, 'auroc': 0.9993242, 'binary_precision': 0.9870214, 'binary_recall': 0.9889467, 'binary_specificity': 0.98668444, 'binary_f1_score': 0.98798305}
confusion matrix:
      0     1
0  1482    20
1    17  1521
---- Validation: 
scalar performance:
{'acc': 0.8422274, 'precision': 0.85342777, 'recall': 0.8393682, 'specificity': 0.8393682, 'f1': 0.84004587, 'auroc': 0.9140589, 'binary_precision': 0.90891474, 'binary_recall': 0.7492013, 'binary_specificity': 0.9295352, 'binary_f1_score': 0.821366}
confusion matrix:
     0    1
0  620   47
1  157  469
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.85663676, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.8138715, 'auroc': 0.91940916, 'binary_precision': 0.9727891, 'binary_recall': 0.6559633, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.78356165}
confusion matrix:
     0    1
0  214    4
1   75  143
early stop counter: 12
val acc:0.8422273993492126, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 15,now: 2024-07-26 10:38:58.364326,epoch time: 0:01:22.625149,used: 0:20:49.910720,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.97894734, 'precision': 0.97939503, 'recall': 0.9791626, 'specificity': 0.9791626, 'f1': 0.97894645, 'auroc': 0.999313, 'binary_precision': 0.9973009, 'binary_recall': 0.9609883, 'binary_specificity': 0.99733686, 'binary_f1_score': 0.978808}
confusion matrix:
      0     1
0  1498     4
1    60  1478
---- Validation: 
scalar performance:
{'acc': 0.65429235, 'precision': 0.77957827, 'recall': 0.643364, 'specificity': 0.643364, 'f1': 0.60114217, 'auroc': 0.87422824, 'binary_precision': 0.95897436, 'binary_recall': 0.29872206, 'binary_specificity': 0.988006, 'binary_f1_score': 0.45554206}
confusion matrix:
     0    1
0  659    8
1  439  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5917431, 'precision': 0.74303234, 'recall': 0.5917431, 'specificity': 0.5917431, 'f1': 0.5164972, 'auroc': 0.87484217, 'binary_precision': 0.9347826, 'binary_recall': 0.19724771, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.32575756}
confusion matrix:
     0   1
0  215   3
1  175  43
early stop counter: 13
val acc:0.6542923450469971, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 16,now: 2024-07-26 10:40:20.815775,epoch time: 0:01:22.451449,used: 0:22:12.362169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.98651314, 'precision': 0.98660594, 'recall': 0.98662555, 'specificity': 0.98662555, 'f1': 0.98651314, 'auroc': 0.9991636, 'binary_precision': 0.99667996, 'binary_recall': 0.97657776, 'binary_specificity': 0.99667335, 'binary_f1_score': 0.9865264}
confusion matrix:
      0     1
0  1498     5
1    36  1501
---- Validation: 
scalar performance:
{'acc': 0.77726215, 'precision': 0.7847698, 'recall': 0.774485, 'specificity': 0.774485, 'f1': 0.7744254, 'auroc': 0.8660614, 'binary_precision': 0.8237548, 'binary_recall': 0.686901, 'binary_specificity': 0.86206895, 'binary_f1_score': 0.74912894}
confusion matrix:
     0    1
0  575   92
1  196  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8142202, 'precision': 0.81502223, 'recall': 0.8142202, 'specificity': 0.8142202, 'f1': 0.8141019, 'auroc': 0.88304853, 'binary_precision': 0.8309179, 'binary_recall': 0.78899086, 'binary_specificity': 0.8394495, 'binary_f1_score': 0.80941176}
confusion matrix:
     0    1
0  183   35
1   46  172
early stop counter: 14
val acc:0.7772621512413025, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 17,now: 2024-07-26 10:41:43.139141,epoch time: 0:01:22.323366,used: 0:23:34.685535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.97467107, 'precision': 0.97603667, 'recall': 0.9743669, 'specificity': 0.9743669, 'f1': 0.97463715, 'auroc': 0.9996143, 'binary_precision': 0.9534739, 'binary_recall': 0.99870044, 'binary_specificity': 0.9500333, 'binary_f1_score': 0.9755632}
confusion matrix:
      0     1
0  1426    75
1     2  1537
---- Validation: 
scalar performance:
{'acc': 0.8638824, 'precision': 0.8638907, 'recall': 0.86354905, 'specificity': 0.86354905, 'f1': 0.8636867, 'auroc': 0.9351131, 'binary_precision': 0.8640777, 'binary_recall': 0.85303515, 'binary_specificity': 0.87406296, 'binary_f1_score': 0.8585209}
confusion matrix:
     0    1
0  583   84
1   92  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8417431, 'precision': 0.841923, 'recall': 0.8417431, 'specificity': 0.8417431, 'f1': 0.8417223, 'auroc': 0.91989315, 'binary_precision': 0.84976524, 'binary_recall': 0.83027524, 'binary_specificity': 0.853211, 'binary_f1_score': 0.8399072}
confusion matrix:
     0    1
0  186   32
1   37  181
early stop counter: 15
val acc:0.8638824224472046, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 18,now: 2024-07-26 10:43:06.423754,epoch time: 0:01:23.284613,used: 0:24:57.970148,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9838816, 'precision': 0.98438156, 'recall': 0.9837196, 'specificity': 0.9837196, 'f1': 0.9838712, 'auroc': 0.99966145, 'binary_precision': 0.97150093, 'binary_recall': 0.9973992, 'binary_specificity': 0.97003996, 'binary_f1_score': 0.98427975}
confusion matrix:
      0     1
0  1457    45
1     4  1534
---- Validation: 
scalar performance:
{'acc': 0.86001545, 'precision': 0.8618921, 'recall': 0.8612248, 'specificity': 0.8612248, 'f1': 0.85999906, 'auroc': 0.9329816, 'binary_precision': 0.8267254, 'binary_recall': 0.899361, 'binary_specificity': 0.82308847, 'binary_f1_score': 0.8615149}
confusion matrix:
     0    1
0  549  118
1   63  563
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8394495, 'precision': 0.8408553, 'recall': 0.8394495, 'specificity': 0.8394495, 'f1': 0.8392838, 'auroc': 0.91968274, 'binary_precision': 0.8627451, 'binary_recall': 0.80733943, 'binary_specificity': 0.8715596, 'binary_f1_score': 0.83412325}
confusion matrix:
     0    1
0  190   28
1   42  176
early stop counter: 16
val acc:0.8600154519081116, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 19,now: 2024-07-26 10:44:28.778811,epoch time: 0:01:22.355057,used: 0:26:20.325205,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.99112666, 'recall': 0.9911872, 'specificity': 0.9911872, 'f1': 0.9911182, 'auroc': 0.99971735, 'binary_precision': 0.99736494, 'binary_recall': 0.9850358, 'binary_specificity': 0.99733865, 'binary_f1_score': 0.99116206}
confusion matrix:
      0     1
0  1499     4
1    23  1514
---- Validation: 
scalar performance:
{'acc': 0.8569219, 'precision': 0.8619278, 'recall': 0.85503495, 'specificity': 0.85503495, 'f1': 0.8558402, 'auroc': 0.9127723, 'binary_precision': 0.8972973, 'binary_recall': 0.79552716, 'binary_specificity': 0.91454273, 'binary_f1_score': 0.8433531}
confusion matrix:
     0    1
0  610   57
1  128  498
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8119266, 'precision': 0.8140678, 'recall': 0.8119266, 'specificity': 0.8119266, 'f1': 0.8116055, 'auroc': 0.8691135, 'binary_precision': 0.84, 'binary_recall': 0.7706422, 'binary_specificity': 0.853211, 'binary_f1_score': 0.80382776}
confusion matrix:
     0    1
0  186   32
1   50  168
early stop counter: 17
val acc:0.856921911239624, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 20,now: 2024-07-26 10:45:51.513337,epoch time: 0:01:22.734526,used: 0:27:43.059731,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.98256576, 'precision': 0.98294723, 'recall': 0.98278105, 'specificity': 0.98278105, 'f1': 0.9825654, 'auroc': 0.9997507, 'binary_precision': 1.0, 'binary_recall': 0.96556205, 'binary_specificity': 1.0, 'binary_f1_score': 0.98247933}
confusion matrix:
      0     1
0  1501     0
1    53  1486
---- Validation: 
scalar performance:
{'acc': 0.71925753, 'precision': 0.8060986, 'recall': 0.71060395, 'specificity': 0.71060395, 'f1': 0.69241023, 'auroc': 0.90634537, 'binary_precision': 0.9614035, 'binary_recall': 0.43769968, 'binary_specificity': 0.9835082, 'binary_f1_score': 0.60153675}
confusion matrix:
     0    1
0  656   11
1  352  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.603211, 'precision': 0.69839823, 'recall': 0.603211, 'specificity': 0.603211, 'f1': 0.54913175, 'auroc': 0.8738743, 'binary_precision': 0.8358209, 'binary_recall': 0.25688073, 'binary_specificity': 0.9495413, 'binary_f1_score': 0.39298245}
confusion matrix:
     0   1
0  207  11
1  162  56
early stop counter: 18
val acc:0.7192575335502625, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 21,now: 2024-07-26 10:47:14.364278,epoch time: 0:01:22.850941,used: 0:29:05.910672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9868421, 'precision': 0.9868499, 'recall': 0.98690295, 'specificity': 0.98690295, 'f1': 0.9868418, 'auroc': 0.99931604, 'binary_precision': 0.9927536, 'binary_recall': 0.9811198, 'binary_specificity': 0.99268615, 'binary_f1_score': 0.9869024}
confusion matrix:
      0     1
0  1493    11
1    29  1507
---- Validation: 
scalar performance:
{'acc': 0.84377414, 'precision': 0.85504025, 'recall': 0.84091663, 'specificity': 0.84091663, 'f1': 0.84161407, 'auroc': 0.92281973, 'binary_precision': 0.91085273, 'binary_recall': 0.7507987, 'binary_specificity': 0.9310345, 'binary_f1_score': 0.8231174}
confusion matrix:
     0    1
0  621   46
1  156  470
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81880736, 'precision': 0.8357711, 'recall': 0.81880736, 'specificity': 0.81880736, 'f1': 0.8164895, 'auroc': 0.8975886, 'binary_precision': 0.9112426, 'binary_recall': 0.70642203, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.7958657}
confusion matrix:
     0    1
0  203   15
1   64  154
early stop counter: 19
val acc:0.843774139881134, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 22,now: 2024-07-26 10:48:38.399002,epoch time: 0:01:24.034724,used: 0:30:29.945396,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9819079, 'precision': 0.9821164, 'recall': 0.9820565, 'specificity': 0.9820565, 'f1': 0.98190784, 'auroc': 0.99948967, 'binary_precision': 0.99532086, 'binary_recall': 0.9687703, 'binary_specificity': 0.9953427, 'binary_f1_score': 0.9818662}
confusion matrix:
      0     1
0  1496     7
1    48  1489
---- Validation: 
scalar performance:
{'acc': 0.70843, 'precision': 0.7975817, 'recall': 0.69952005, 'specificity': 0.69952005, 'f1': 0.6789186, 'auroc': 0.9308058, 'binary_precision': 0.95272726, 'binary_recall': 0.41853034, 'binary_specificity': 0.98050976, 'binary_f1_score': 0.58157605}
confusion matrix:
     0    1
0  654   13
1  364  262
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7844037, 'precision': 0.849359, 'recall': 0.7844037, 'specificity': 0.7844037, 'f1': 0.77389383, 'auroc': 0.930856, 'binary_precision': 1.0, 'binary_recall': 0.56880736, 'binary_specificity': 1.0, 'binary_f1_score': 0.72514623}
confusion matrix:
     0    1
0  218    0
1   94  124
early stop counter: 20
val acc:0.7084299921989441, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 23,now: 2024-07-26 10:50:00.844804,epoch time: 0:01:22.445802,used: 0:31:52.391198,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.98815787, 'precision': 0.9881382, 'recall': 0.988189, 'specificity': 0.988189, 'f1': 0.98815674, 'auroc': 0.99949914, 'binary_precision': 0.99085563, 'binary_recall': 0.985705, 'binary_specificity': 0.9906729, 'binary_f1_score': 0.9882736}
confusion matrix:
      0     1
0  1487    14
1    22  1517
---- Validation: 
scalar performance:
{'acc': 0.78344935, 'precision': 0.83169603, 'recall': 0.7772907, 'specificity': 0.7772907, 'f1': 0.7725537, 'auroc': 0.9163108, 'binary_precision': 0.9505208, 'binary_recall': 0.5830671, 'binary_specificity': 0.9715142, 'binary_f1_score': 0.7227723}
confusion matrix:
     0    1
0  648   19
1  261  365
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63761467, 'precision': 0.77469754, 'recall': 0.6376147, 'specificity': 0.6376147, 'f1': 0.58595985, 'auroc': 0.90733105, 'binary_precision': 0.96875, 'binary_recall': 0.28440368, 'binary_specificity': 0.9908257, 'binary_f1_score': 0.4397163}
confusion matrix:
     0   1
0  216   2
1  156  62
early stop counter: 21
val acc:0.7834493517875671, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 24,now: 2024-07-26 10:51:24.949505,epoch time: 0:01:24.104701,used: 0:33:16.495899,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9911481, 'recall': 0.99120194, 'specificity': 0.99120194, 'f1': 0.99111825, 'auroc': 0.9997797, 'binary_precision': 0.998679, 'binary_recall': 0.98373455, 'binary_specificity': 0.9986693, 'binary_f1_score': 0.9911504}
confusion matrix:
      0     1
0  1501     2
1    25  1512
---- Validation: 
scalar performance:
{'acc': 0.63959783, 'precision': 0.7800403, 'recall': 0.628041, 'specificity': 0.628041, 'f1': 0.5771189, 'auroc': 0.9133973, 'binary_precision': 0.9705882, 'binary_recall': 0.26357827, 'binary_specificity': 0.99250376, 'binary_f1_score': 0.41457286}
confusion matrix:
     0    1
0  662    5
1  461  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5321101, 'precision': 0.7270833, 'recall': 0.5321101, 'specificity': 0.5321101, 'f1': 0.40422794, 'auroc': 0.9056213, 'binary_precision': 0.9375, 'binary_recall': 0.06880734, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.12820512}
confusion matrix:
     0   1
0  217   1
1  203  15
early stop counter: 22
val acc:0.6395978331565857, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 25,now: 2024-07-26 10:52:48.428605,epoch time: 0:01:23.479100,used: 0:34:39.974999,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9914474, 'precision': 0.9914298, 'recall': 0.9914851, 'specificity': 0.9914851, 'f1': 0.99144673, 'auroc': 0.99968654, 'binary_precision': 0.9947644, 'binary_recall': 0.9882965, 'binary_specificity': 0.9946738, 'binary_f1_score': 0.9915199}
confusion matrix:
      0     1
0  1494     8
1    18  1520
---- Validation: 
scalar performance:
{'acc': 0.8058778, 'precision': 0.8389018, 'recall': 0.80084634, 'specificity': 0.80084634, 'f1': 0.79907006, 'auroc': 0.91856325, 'binary_precision': 0.9370629, 'binary_recall': 0.6421725, 'binary_specificity': 0.9595202, 'binary_f1_score': 0.76208526}
confusion matrix:
     0    1
0  640   27
1  224  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.690367, 'precision': 0.77512693, 'recall': 0.690367, 'specificity': 0.690367, 'f1': 0.6645294, 'auroc': 0.8738532, 'binary_precision': 0.92783505, 'binary_recall': 0.41284403, 'binary_specificity': 0.9678899, 'binary_f1_score': 0.5714286}
confusion matrix:
     0   1
0  211   7
1  128  90
early stop counter: 23
val acc:0.8058778047561646, best validation acc: 0.8669760227203369, corresponding to test acc:                         0.8692660331726074 / 0.8692660331726074
after epoch: 26,now: 2024-07-26 10:54:11.352606,epoch time: 0:01:22.924001,used: 0:36:02.899000,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.99111843, 'precision': 0.9911821, 'recall': 0.9910768, 'specificity': 0.9910768, 'f1': 0.9911165, 'auroc': 0.9998022, 'binary_precision': 0.9877261, 'binary_recall': 0.9947951, 'binary_specificity': 0.9873586, 'binary_f1_score': 0.991248}
confusion matrix:
      0     1
0  1484    19
1     8  1529
---- Validation: 
scalar performance:
{'acc': 0.88089716, 'precision': 0.8884845, 'recall': 0.87871516, 'specificity': 0.87871516, 'f1': 0.8797735, 'auroc': 0.94442713, 'binary_precision': 0.9354243, 'binary_recall': 0.80990416, 'binary_specificity': 0.9475262, 'binary_f1_score': 0.8681507}
confusion matrix:
     0    1
0  632   35
1  119  507
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8325688, 'precision': 0.8672592, 'recall': 0.8325688, 'specificity': 0.8325688, 'f1': 0.8285194, 'auroc': 0.92793643, 'binary_precision': 0.98013246, 'binary_recall': 0.6788991, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.802168}
confusion matrix:
     0    1
0  215    3
1   70  148
better model found
persisted
after epoch: 27,now: 2024-07-26 10:55:35.554628,epoch time: 0:01:24.202022,used: 0:37:27.101022,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.99210525, 'precision': 0.99212897, 'recall': 0.99218524, 'specificity': 0.99218524, 'f1': 0.9921051, 'auroc': 0.99981606, 'binary_precision': 0.99933994, 'binary_recall': 0.9850358, 'binary_specificity': 0.9993347, 'binary_f1_score': 0.9921363}
confusion matrix:
      0     1
0  1502     1
1    23  1514
---- Validation: 
scalar performance:
{'acc': 0.81206495, 'precision': 0.8531498, 'recall': 0.80659795, 'specificity': 0.80659795, 'f1': 0.8043974, 'auroc': 0.93183446, 'binary_precision': 0.9659367, 'binary_recall': 0.6341853, 'binary_specificity': 0.9790105, 'binary_f1_score': 0.7656702}
confusion matrix:
     0    1
0  653   14
1  229  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71100914, 'precision': 0.8119323, 'recall': 0.71100914, 'specificity': 0.71100914, 'f1': 0.6855769, 'auroc': 0.91113436, 'binary_precision': 0.9893617, 'binary_recall': 0.4266055, 'binary_specificity': 0.9954128, 'binary_f1_score': 0.5961538}
confusion matrix:
     0   1
0  217   1
1  125  93
early stop counter: 1
val acc:0.8120649456977844, best validation acc: 0.8808971643447876, corresponding to test acc:                         0.8325688242912292 / 0.8692660331726074
after epoch: 28,now: 2024-07-26 10:56:59.007113,epoch time: 0:01:23.452485,used: 0:38:50.553507,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9950658, 'precision': 0.99511683, 'recall': 0.99503005, 'specificity': 0.99503005, 'f1': 0.99506474, 'auroc': 0.9999173, 'binary_precision': 0.99224305, 'binary_recall': 0.99804944, 'binary_specificity': 0.99201065, 'binary_f1_score': 0.99513775}
confusion matrix:
      0     1
0  1490    12
1     3  1535
---- Validation: 
scalar performance:
{'acc': 0.86620265, 'precision': 0.8687599, 'recall': 0.86486506, 'specificity': 0.86486506, 'f1': 0.86555123, 'auroc': 0.93506527, 'binary_precision': 0.89254767, 'binary_recall': 0.8226837, 'binary_specificity': 0.9070465, 'binary_f1_score': 0.8561928}
confusion matrix:
     0    1
0  605   62
1  111  515
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82798165, 'precision': 0.8295418, 'recall': 0.82798165, 'specificity': 0.82798165, 'f1': 0.82777786, 'auroc': 0.894832, 'binary_precision': 0.8522167, 'binary_recall': 0.79357797, 'binary_specificity': 0.86238533, 'binary_f1_score': 0.82185274}
confusion matrix:
     0    1
0  188   30
1   45  173
early stop counter: 2
val acc:0.8662026524543762, best validation acc: 0.8808971643447876, corresponding to test acc:                         0.8325688242912292 / 0.8692660331726074
after epoch: 29,now: 2024-07-26 10:58:23.571333,epoch time: 0:01:24.564220,used: 0:40:15.117727,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9950658, 'precision': 0.9950517, 'recall': 0.99511576, 'specificity': 0.99511576, 'f1': 0.99506557, 'auroc': 0.9999221, 'binary_precision': 0.9993443, 'binary_recall': 0.9908973, 'binary_specificity': 0.9993342, 'binary_f1_score': 0.9951029}
confusion matrix:
      0     1
0  1501     1
1    14  1524
---- Validation: 
scalar performance:
{'acc': 0.7733952, 'precision': 0.83418727, 'recall': 0.76651454, 'specificity': 0.76651454, 'f1': 0.75938535, 'auroc': 0.9369495, 'binary_precision': 0.9690141, 'binary_recall': 0.5495208, 'binary_specificity': 0.9835082, 'binary_f1_score': 0.70132524}
confusion matrix:
     0    1
0  656   11
1  282  344
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6513761, 'precision': 0.7945946, 'recall': 0.6513761, 'specificity': 0.6513761, 'f1': 0.6031426, 'auroc': 0.934875, 'binary_precision': 1.0, 'binary_recall': 0.3027523, 'binary_specificity': 1.0, 'binary_f1_score': 0.46478873}
confusion matrix:
     0   1
0  218   0
1  152  66
early stop counter: 3
val acc:0.7733951807022095, best validation acc: 0.8808971643447876, corresponding to test acc:                         0.8325688242912292 / 0.8692660331726074
after epoch: 30,now: 2024-07-26 10:59:46.903107,epoch time: 0:01:23.331774,used: 0:41:38.449501,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_10_18_08_seed_8_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:38.449501 at 2024-07-26 10:59:46.903107
persisted model performance metric: 

scalar performance:
{'acc': 0.8325688, 'precision': 0.8672592, 'recall': 0.8325688, 'specificity': 0.8325688, 'f1': 0.8285194, 'auroc': 0.92793643, 'binary_precision': 0.98013246, 'binary_recall': 0.6788991, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.802168}
confusion matrix:
     0    1
0  215    3
1   70  148
oracle model performance metric: 

scalar performance:
{'acc': 0.86926603, 'precision': 0.8768872, 'recall': 0.86926603, 'specificity': 0.86926603, 'f1': 0.8686018, 'auroc': 0.92639506, 'binary_precision': 0.93048126, 'binary_recall': 0.79816514, 'binary_specificity': 0.940367, 'binary_f1_score': 0.85925925}
confusion matrix:
     0    1
0  205   13
1   44  174
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455127 KiB |  13219 MiB | 661212 GiB | 661212 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 653385 GiB | 653385 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455127 KiB |  13219 MiB | 661212 GiB | 661212 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 653385 GiB | 653385 GiB |
|       from small pool |  40595 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447481 KiB |  13213 MiB | 660332 GiB | 660331 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 652521 GiB | 652521 GiB |
|       from small pool |  40406 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14474 MiB |  14480 MiB | 123232 MiB | 108758 MiB |
|       from large pool |  14408 MiB |  14414 MiB | 123038 MiB | 108630 MiB |
|       from small pool |     66 MiB |     70 MiB |    194 MiB |    128 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 448041 KiB |   1252 MiB | 472043 GiB | 472043 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 464169 GiB | 464168 GiB |
|       from small pool |  12652 KiB |     45 MiB |   7874 GiB |   7874 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1304    |    2598    |  116337 K  |  116336 K  |
|       from large pool |     187    |    1413    |   59095 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57242 K  |   57240 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1304    |    2598    |  116337 K  |  116336 K  |
|       from large pool |     187    |    1413    |   59095 K  |   59095 K  |
|       from small pool |    1117    |    1419    |   57242 K  |   57240 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     634    |     636    |    5210    |    4576    |
|       from large pool |     601    |     601    |    5113    |    4512    |
|       from small pool |      33    |      35    |      97    |      64    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     109    |     652    |   75015 K  |   75015 K  |
|       from large pool |      40    |     604    |   41784 K  |   41784 K  |
|       from small pool |      69    |     240    |   33230 K  |   33230 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 661212 GiB | 661212 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 653385 GiB | 653385 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 661212 GiB | 661212 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 653385 GiB | 653385 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660332 GiB | 660332 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652521 GiB | 652521 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 123232 MiB | 122350 MiB |
|       from large pool |    830 MiB |  14414 MiB | 123038 MiB | 122208 MiB |
|       from small pool |     52 MiB |     70 MiB |    194 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 472044 GiB | 472044 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 464169 GiB | 464169 GiB |
|       from small pool |      0 KiB |     45 MiB |   7874 GiB |   7874 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116337 K  |  116337 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57242 K  |   57242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116337 K  |  116337 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57242 K  |   57242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    5210    |    5147    |
|       from large pool |      37    |     601    |    5113    |    5076    |
|       from small pool |      26    |      35    |      97    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   75015 K  |   75015 K  |
|       from large pool |       4    |     604    |   41784 K  |   41784 K  |
|       from small pool |       0    |     240    |   33230 K  |   33230 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 661212 GiB | 661212 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 653385 GiB | 653385 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 661212 GiB | 661212 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 653385 GiB | 653385 GiB |
|       from small pool |      0 KiB |     60 MiB |   7826 GiB |   7826 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 660332 GiB | 660332 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 652521 GiB | 652521 GiB |
|       from small pool |      0 KiB |     60 MiB |   7810 GiB |   7810 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  14480 MiB | 123232 MiB | 122350 MiB |
|       from large pool |    830 MiB |  14414 MiB | 123038 MiB | 122208 MiB |
|       from small pool |     52 MiB |     70 MiB |    194 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 472044 GiB | 472044 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 464169 GiB | 464169 GiB |
|       from small pool |      0 KiB |     45 MiB |   7874 GiB |   7874 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  116337 K  |  116337 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57242 K  |   57242 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  116337 K  |  116337 K  |
|       from large pool |       2    |    1413    |   59095 K  |   59095 K  |
|       from small pool |       0    |    1419    |   57242 K  |   57242 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      63    |     636    |    5210    |    5147    |
|       from large pool |      37    |     601    |    5113    |    5076    |
|       from small pool |      26    |      35    |      97    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   75015 K  |   75015 K  |
|       from large pool |       4    |     604    |   41784 K  |   41784 K  |
|       from small pool |       0    |     240    |   33230 K  |   33230 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529

 Experiment start at: 2024-07-26 11:00:26.278259
before training, model accuracy: 0.49782606959342957
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9443717, 'precision': 0.94633913, 'recall': 0.94459635, 'specificity': 0.94459635, 'f1': 0.9443276, 'auroc': 0.9918139, 'binary_precision': 0.9776536, 'binary_recall': 0.9102731, 'binary_specificity': 0.9789196, 'binary_f1_score': 0.94276094}
confusion matrix:
      0     1
0  1486    32
1   138  1400
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.84092665, 'precision': 0.8547548, 'recall': 0.83993375, 'specificity': 0.83993375, 'f1': 0.8390726, 'auroc': 0.9182136, 'binary_precision': 0.9223301, 'binary_recall': 0.7410296, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.8217993}
confusion matrix:
     0    1
0  614   40
1  166  475
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84130436, 'precision': 0.87092966, 'recall': 0.8413043, 'specificity': 0.8413043, 'f1': 0.8380711, 'auroc': 0.9146693, 'binary_precision': 0.9757576, 'binary_recall': 0.7, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.81518984}
confusion matrix:
     0    1
0  226    4
1   69  161
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 11:02:01.795532,epoch time: 0:01:35.517273,used: 0:01:35.517273,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97316754, 'precision': 0.97347844, 'recall': 0.9730785, 'specificity': 0.9730785, 'f1': 0.9731579, 'auroc': 0.997107, 'binary_precision': 0.9631512, 'binary_recall': 0.9844156, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9736674}
confusion matrix:
      0     1
0  1458    58
1    24  1516
---- Validation: 
scalar performance:
{'acc': 0.8648649, 'precision': 0.864952, 'recall': 0.864952, 'specificity': 0.864952, 'f1': 0.8648648, 'auroc': 0.9356629, 'binary_precision': 0.8562691, 'binary_recall': 0.87363493, 'binary_specificity': 0.8562691, 'binary_f1_score': 0.8648648}
confusion matrix:
     0    1
0  560   94
1   81  560
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.82901347, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.82816255, 'auroc': 0.8995652, 'binary_precision': 0.84474885, 'binary_recall': 0.8043478, 'binary_specificity': 0.8521739, 'binary_f1_score': 0.8240534}
confusion matrix:
     0    1
0  196   34
1   45  185
better model found
persisted
after epoch: 2,now: 2024-07-26 11:03:27.090984,epoch time: 0:01:25.295452,used: 0:03:00.812725,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96924084, 'precision': 0.9693265, 'recall': 0.9691978, 'specificity': 0.9691978, 'f1': 0.96923554, 'auroc': 0.99693406, 'binary_precision': 0.96465296, 'binary_recall': 0.9746753, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.9696382}
confusion matrix:
      0     1
0  1461    55
1    39  1501
---- Validation: 
scalar performance:
{'acc': 0.78301156, 'precision': 0.7834382, 'recall': 0.7827959, 'specificity': 0.7827959, 'f1': 0.78282464, 'auroc': 0.85562265, 'binary_precision': 0.7922078, 'binary_recall': 0.76131046, 'binary_specificity': 0.80428135, 'binary_f1_score': 0.7764519}
confusion matrix:
     0    1
0  526  128
1  153  488
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8043478, 'precision': 0.8062234, 'recall': 0.8043478, 'specificity': 0.8043478, 'f1': 0.8040478, 'auroc': 0.88918716, 'binary_precision': 0.7822581, 'binary_recall': 0.84347826, 'binary_specificity': 0.76521736, 'binary_f1_score': 0.8117155}
confusion matrix:
     0    1
0  176   54
1   36  194
early stop counter: 1
val acc:0.7830115556716919, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 3,now: 2024-07-26 11:04:54.450936,epoch time: 0:01:27.359952,used: 0:04:28.172677,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96433246, 'precision': 0.9662394, 'recall': 0.96457326, 'specificity': 0.96457326, 'f1': 0.9643074, 'auroc': 0.99751914, 'binary_precision': 0.99791086, 'binary_recall': 0.9311241, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9633613}
confusion matrix:
      0     1
0  1514     3
1   106  1433
---- Validation: 
scalar performance:
{'acc': 0.7096525, 'precision': 0.79978466, 'recall': 0.7068788, 'specificity': 0.7068788, 'f1': 0.684297, 'auroc': 0.90902734, 'binary_precision': 0.9616725, 'binary_recall': 0.43057722, 'binary_specificity': 0.9831804, 'binary_f1_score': 0.5948276}
confusion matrix:
     0    1
0  643   11
1  365  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7826087, 'precision': 0.8484849, 'recall': 0.7826087, 'specificity': 0.7826087, 'f1': 0.7718254, 'auroc': 0.9069376, 'binary_precision': 1.0, 'binary_recall': 0.5652174, 'binary_specificity': 1.0, 'binary_f1_score': 0.7222222}
confusion matrix:
     0    1
0  230    0
1  100  130
early stop counter: 2
val acc:0.7096524834632874, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 4,now: 2024-07-26 11:06:20.941594,epoch time: 0:01:26.490658,used: 0:05:54.663335,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.97938484, 'precision': 0.97964036, 'recall': 0.9794804, 'specificity': 0.9794804, 'f1': 0.97938406, 'auroc': 0.998778, 'binary_precision': 0.9926569, 'binary_recall': 0.96621186, 'binary_specificity': 0.99274886, 'binary_f1_score': 0.9792559}
confusion matrix:
      0     1
0  1506    11
1    52  1487
---- Validation: 
scalar performance:
{'acc': 0.6980695, 'precision': 0.78947103, 'recall': 0.6952249, 'specificity': 0.6952249, 'f1': 0.67027295, 'auroc': 0.88913536, 'binary_precision': 0.9496403, 'binary_recall': 0.41185647, 'binary_specificity': 0.9785933, 'binary_f1_score': 0.5745376}
confusion matrix:
     0    1
0  640   14
1  377  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6826087, 'precision': 0.7853261, 'recall': 0.68260866, 'specificity': 0.68260866, 'f1': 0.65121835, 'auroc': 0.90219283, 'binary_precision': 0.95652175, 'binary_recall': 0.38260868, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.54658383}
confusion matrix:
     0   1
0  226   4
1  142  88
early stop counter: 3
val acc:0.6980695128440857, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 5,now: 2024-07-26 11:07:45.872359,epoch time: 0:01:24.930765,used: 0:07:19.594100,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9826571, 'precision': 0.9828931, 'recall': 0.98273987, 'specificity': 0.98273987, 'f1': 0.9826565, 'auroc': 0.99907863, 'binary_precision': 0.9953302, 'binary_recall': 0.97009104, 'binary_specificity': 0.9953887, 'binary_f1_score': 0.9825486}
confusion matrix:
      0     1
0  1511     7
1    46  1492
---- Validation: 
scalar performance:
{'acc': 0.77837837, 'precision': 0.8228928, 'recall': 0.77650315, 'specificity': 0.77650315, 'f1': 0.76965594, 'auroc': 0.9287524, 'binary_precision': 0.9402985, 'binary_recall': 0.58970356, 'binary_specificity': 0.96330273, 'binary_f1_score': 0.7248322}
confusion matrix:
     0    1
0  630   24
1  263  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7847826, 'precision': 0.8349341, 'recall': 0.78478265, 'specificity': 0.78478265, 'f1': 0.7764129, 'auroc': 0.9107183, 'binary_precision': 0.964539, 'binary_recall': 0.59130436, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.73315364}
confusion matrix:
     0    1
0  225    5
1   94  136
early stop counter: 4
val acc:0.7783783674240112, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 6,now: 2024-07-26 11:09:13.206572,epoch time: 0:01:27.334213,used: 0:08:46.928313,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9859293, 'precision': 0.9859293, 'recall': 0.9859545, 'specificity': 0.9859545, 'f1': 0.98592913, 'auroc': 0.9988837, 'binary_precision': 0.9895288, 'binary_recall': 0.98245615, 'binary_specificity': 0.98945284, 'binary_f1_score': 0.9859798}
confusion matrix:
      0     1
0  1501    16
1    27  1512
---- Validation: 
scalar performance:
{'acc': 0.8316602, 'precision': 0.85435086, 'recall': 0.83038735, 'specificity': 0.83038735, 'f1': 0.8285289, 'auroc': 0.92836356, 'binary_precision': 0.9415449, 'binary_recall': 0.7035881, 'binary_specificity': 0.9571865, 'binary_f1_score': 0.8053571}
confusion matrix:
     0    1
0  626   28
1  190  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8369565, 'precision': 0.86820143, 'recall': 0.8369565, 'specificity': 0.8369565, 'f1': 0.8334226, 'auroc': 0.91946596, 'binary_precision': 0.9754601, 'binary_recall': 0.6913043, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.80916023}
confusion matrix:
     0    1
0  226    4
1   71  159
early stop counter: 5
val acc:0.8316602110862732, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 7,now: 2024-07-26 11:10:40.384983,epoch time: 0:01:27.178411,used: 0:10:14.106724,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.98003924, 'precision': 0.9800551, 'recall': 0.98007053, 'specificity': 0.98007053, 'f1': 0.9800392, 'auroc': 0.99872917, 'binary_precision': 0.9848982, 'binary_recall': 0.97529256, 'binary_specificity': 0.9848485, 'binary_f1_score': 0.98007184}
confusion matrix:
      0     1
0  1495    23
1    38  1500
---- Validation: 
scalar performance:
{'acc': 0.8123552, 'precision': 0.8470639, 'recall': 0.8107625, 'specificity': 0.8107625, 'f1': 0.80698544, 'auroc': 0.9370393, 'binary_precision': 0.9543379, 'binary_recall': 0.6521061, 'binary_specificity': 0.96941894, 'binary_f1_score': 0.77479154}
confusion matrix:
     0    1
0  634   20
1  223  418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7717391, 'precision': 0.8399068, 'recall': 0.7717391, 'specificity': 0.7717391, 'f1': 0.75969076, 'auroc': 0.9287902, 'binary_precision': 0.992126, 'binary_recall': 0.5478261, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.70588243}
confusion matrix:
     0    1
0  229    1
1  104  126
early stop counter: 6
val acc:0.8123552203178406, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 8,now: 2024-07-26 11:12:06.445957,epoch time: 0:01:26.060974,used: 0:11:40.167698,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.96629584, 'precision': 0.96798086, 'recall': 0.9665226, 'specificity': 0.9665226, 'f1': 0.9662755, 'auroc': 0.99836063, 'binary_precision': 0.99791956, 'binary_recall': 0.9350228, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.96544784}
confusion matrix:
      0     1
0  1514     3
1   100  1439
---- Validation: 
scalar performance:
{'acc': 0.7776062, 'precision': 0.8307467, 'recall': 0.77558357, 'specificity': 0.77558357, 'f1': 0.767421, 'auroc': 0.9118953, 'binary_precision': 0.9608355, 'binary_recall': 0.57410294, 'binary_specificity': 0.9770642, 'binary_f1_score': 0.71875}
confusion matrix:
     0    1
0  639   15
1  273  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.78695655, 'precision': 0.8506098, 'recall': 0.78695655, 'specificity': 0.78695655, 'f1': 0.7768272, 'auroc': 0.92270327, 'binary_precision': 1.0, 'binary_recall': 0.57391304, 'binary_specificity': 1.0, 'binary_f1_score': 0.7292817}
confusion matrix:
     0    1
0  230    0
1   98  132
early stop counter: 7
val acc:0.777606189250946, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.841304361820221
after epoch: 9,now: 2024-07-26 11:13:32.063164,epoch time: 0:01:25.617207,used: 0:13:05.784905,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9882225, 'recall': 0.9882475, 'specificity': 0.9882475, 'f1': 0.98821974, 'auroc': 0.9993292, 'binary_precision': 0.9921414, 'binary_recall': 0.98440546, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9882583}
confusion matrix:
      0     1
0  1505    12
1    24  1515
---- Validation: 
scalar performance:
{'acc': 0.7752896, 'precision': 0.8112979, 'recall': 0.7735691, 'specificity': 0.7735691, 'f1': 0.7678384, 'auroc': 0.8966781, 'binary_precision': 0.9146919, 'binary_recall': 0.6021841, 'binary_specificity': 0.94495416, 'binary_f1_score': 0.72624654}
confusion matrix:
     0    1
0  618   36
1  255  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8543478, 'precision': 0.87421894, 'recall': 0.8543478, 'specificity': 0.8543478, 'f1': 0.8523883, 'auroc': 0.92355394, 'binary_precision': 0.96045196, 'binary_recall': 0.73913044, 'binary_specificity': 0.9695652, 'binary_f1_score': 0.8353809}
confusion matrix:
     0    1
0  223    7
1   60  170
new oracle model saved
early stop counter: 8
val acc:0.7752895951271057, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.854347825050354
after epoch: 10,now: 2024-07-26 11:14:58.841750,epoch time: 0:01:26.778586,used: 0:14:32.563491,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.986911, 'precision': 0.9870591, 'recall': 0.98697895, 'specificity': 0.98697895, 'f1': 0.9869108, 'auroc': 0.99959743, 'binary_precision': 0.99734396, 'binary_recall': 0.97659296, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.9868594}
confusion matrix:
      0     1
0  1514     4
1    36  1502
---- Validation: 
scalar performance:
{'acc': 0.796139, 'precision': 0.83875245, 'recall': 0.79435086, 'specificity': 0.79435086, 'f1': 0.7888253, 'auroc': 0.93683237, 'binary_precision': 0.9564165, 'binary_recall': 0.61622465, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.7495256}
confusion matrix:
     0    1
0  636   18
1  246  395
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81956524, 'precision': 0.8553636, 'recall': 0.8195652, 'specificity': 0.8195652, 'f1': 0.8149037, 'auroc': 0.91411626, 'binary_precision': 0.9681529, 'binary_recall': 0.66086954, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.7855297}
confusion matrix:
     0    1
0  225    5
1   78  152
early stop counter: 9
val acc:0.7961390018463135, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.854347825050354
after epoch: 11,now: 2024-07-26 11:16:23.781422,epoch time: 0:01:24.939672,used: 0:15:57.503163,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.98854715, 'precision': 0.9885855, 'recall': 0.98852324, 'specificity': 0.98852324, 'f1': 0.9885458, 'auroc': 0.99948514, 'binary_precision': 0.9857973, 'binary_recall': 0.99155843, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.98866946}
confusion matrix:
      0     1
0  1494    22
1    13  1527
---- Validation: 
scalar performance:
{'acc': 0.85714287, 'precision': 0.85816956, 'recall': 0.8568726, 'specificity': 0.8568726, 'f1': 0.8569623, 'auroc': 0.92048454, 'binary_precision': 0.875, 'binary_recall': 0.8299532, 'binary_specificity': 0.88379204, 'binary_f1_score': 0.8518815}
confusion matrix:
     0    1
0  578   76
1  109  532
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8602278, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85854524, 'auroc': 0.91924393, 'binary_precision': 0.88372093, 'binary_recall': 0.82608694, 'binary_specificity': 0.8913044, 'binary_f1_score': 0.85393256}
confusion matrix:
     0    1
0  205   25
1   40  190
new oracle model saved
early stop counter: 10
val acc:0.8571428656578064, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 12,now: 2024-07-26 11:17:50.247217,epoch time: 0:01:26.465795,used: 0:17:23.968958,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9918194, 'precision': 0.9918249, 'recall': 0.99184954, 'specificity': 0.99184954, 'f1': 0.99181926, 'auroc': 0.99964106, 'binary_precision': 0.9960682, 'binary_recall': 0.9876543, 'binary_specificity': 0.9960448, 'binary_f1_score': 0.9918434}
confusion matrix:
      0     1
0  1511     6
1    19  1520
---- Validation: 
scalar performance:
{'acc': 0.7791506, 'precision': 0.81683666, 'recall': 0.7774072, 'specificity': 0.7774072, 'f1': 0.7716303, 'auroc': 0.9072287, 'binary_precision': 0.9236277, 'binary_recall': 0.60374415, 'binary_specificity': 0.9510703, 'binary_f1_score': 0.73018867}
confusion matrix:
     0    1
0  622   32
1  254  387
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.773913, 'precision': 0.8116129, 'recall': 0.773913, 'specificity': 0.773913, 'f1': 0.7668616, 'auroc': 0.8871267, 'binary_precision': 0.92, 'binary_recall': 0.6, 'binary_specificity': 0.9478261, 'binary_f1_score': 0.72631586}
confusion matrix:
     0    1
0  218   12
1   92  138
early stop counter: 11
val acc:0.7791506052017212, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 13,now: 2024-07-26 11:19:16.879456,epoch time: 0:01:26.632239,used: 0:18:50.601197,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.98658377, 'precision': 0.9867297, 'recall': 0.98666775, 'specificity': 0.98666775, 'f1': 0.98658365, 'auroc': 0.9996025, 'binary_precision': 0.99734575, 'binary_recall': 0.975974, 'binary_specificity': 0.9973615, 'binary_f1_score': 0.98654413}
confusion matrix:
      0     1
0  1512     4
1    37  1503
---- Validation: 
scalar performance:
{'acc': 0.6833977, 'precision': 0.7902451, 'recall': 0.68032676, 'specificity': 0.68032676, 'f1': 0.6490747, 'auroc': 0.90386355, 'binary_precision': 0.96385545, 'binary_recall': 0.37441498, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.53932583}
confusion matrix:
     0    1
0  645    9
1  401  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6826087, 'precision': 0.7900901, 'recall': 0.6826087, 'specificity': 0.6826087, 'f1': 0.65020835, 'auroc': 0.90932417, 'binary_precision': 0.96666664, 'binary_recall': 0.37826088, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.54375}
confusion matrix:
     0   1
0  227   3
1  143  87
early stop counter: 12
val acc:0.6833977103233337, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 14,now: 2024-07-26 11:20:44.114652,epoch time: 0:01:27.235196,used: 0:20:17.836393,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9856021, 'precision': 0.985708, 'recall': 0.98566145, 'specificity': 0.98566145, 'f1': 0.985602, 'auroc': 0.9988482, 'binary_precision': 0.994702, 'binary_recall': 0.97659296, 'binary_specificity': 0.99472994, 'binary_f1_score': 0.98556435}
confusion matrix:
      0     1
0  1510     8
1    36  1502
---- Validation: 
scalar performance:
{'acc': 0.5945946, 'precision': 0.71657634, 'recall': 0.59077823, 'specificity': 0.59077823, 'f1': 0.5235717, 'auroc': 0.8682362, 'binary_precision': 0.8766234, 'binary_recall': 0.21060842, 'binary_specificity': 0.97094804, 'binary_f1_score': 0.33962262}
confusion matrix:
     0    1
0  635   19
1  506  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54130435, 'precision': 0.7009195, 'recall': 0.54130435, 'specificity': 0.54130435, 'f1': 0.42762786, 'auroc': 0.9167297, 'binary_precision': 0.88, 'binary_recall': 0.09565217, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.17254902}
confusion matrix:
     0   1
0  227   3
1  208  22
early stop counter: 13
val acc:0.5945945978164673, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 15,now: 2024-07-26 11:22:09.610169,epoch time: 0:01:25.495517,used: 0:21:43.331910,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9882199, 'precision': 0.9883777, 'recall': 0.9883065, 'specificity': 0.9883065, 'f1': 0.9882198, 'auroc': 0.9995434, 'binary_precision': 0.999336, 'binary_recall': 0.97727275, 'binary_specificity': 0.99934036, 'binary_f1_score': 0.98818123}
confusion matrix:
      0     1
0  1515     1
1    35  1505
---- Validation: 
scalar performance:
{'acc': 0.63552123, 'precision': 0.7478407, 'recall': 0.6321044, 'specificity': 0.6321044, 'f1': 0.5857191, 'auroc': 0.8970144, 'binary_precision': 0.91219515, 'binary_recall': 0.29173166, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.44208038}
confusion matrix:
     0    1
0  636   18
1  454  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6847826, 'precision': 0.7863965, 'recall': 0.6847826, 'specificity': 0.6847826, 'f1': 0.65410125, 'auroc': 0.89192814, 'binary_precision': 0.9569892, 'binary_recall': 0.3869565, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.5510836}
confusion matrix:
     0   1
0  226   4
1  141  89
early stop counter: 14
val acc:0.6355212330818176, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 16,now: 2024-07-26 11:23:35.952252,epoch time: 0:01:26.342083,used: 0:23:09.673993,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9895949, 'recall': 0.9895848, 'specificity': 0.9895848, 'f1': 0.98952883, 'auroc': 0.9993639, 'binary_precision': 0.99735975, 'binary_recall': 0.9818064, 'binary_specificity': 0.9973632, 'binary_f1_score': 0.989522}
confusion matrix:
      0     1
0  1513     4
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.79305017, 'precision': 0.8273069, 'recall': 0.79141676, 'specificity': 0.79141676, 'f1': 0.7868422, 'auroc': 0.91151834, 'binary_precision': 0.9307159, 'binary_recall': 0.62870514, 'binary_specificity': 0.95412844, 'binary_f1_score': 0.7504656}
confusion matrix:
     0    1
0  624   30
1  238  403
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84130436, 'precision': 0.860444, 'recall': 0.84130436, 'specificity': 0.84130436, 'f1': 0.8391694, 'auroc': 0.90629494, 'binary_precision': 0.94350284, 'binary_recall': 0.726087, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.8206389}
confusion matrix:
     0    1
0  220   10
1   63  167
early stop counter: 15
val acc:0.7930501699447632, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 17,now: 2024-07-26 11:25:00.661500,epoch time: 0:01:24.709248,used: 0:24:34.383241,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.98926485, 'recall': 0.98925036, 'specificity': 0.98925036, 'f1': 0.9892016, 'auroc': 0.9996085, 'binary_precision': 0.9966997, 'binary_recall': 0.98179454, 'binary_specificity': 0.9967062, 'binary_f1_score': 0.989191}
confusion matrix:
      0     1
0  1513     5
1    28  1510
---- Validation: 
scalar performance:
{'acc': 0.7011583, 'precision': 0.79870516, 'recall': 0.69826746, 'specificity': 0.69826746, 'f1': 0.6726767, 'auroc': 0.89238846, 'binary_precision': 0.9669118, 'binary_recall': 0.4102964, 'binary_specificity': 0.98623854, 'binary_f1_score': 0.57612264}
confusion matrix:
     0    1
0  645    9
1  378  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6130435, 'precision': 0.78186274, 'recall': 0.6130435, 'specificity': 0.6130435, 'f1': 0.54489875, 'auroc': 0.93670607, 'binary_precision': 1.0, 'binary_recall': 0.22608696, 'binary_specificity': 1.0, 'binary_f1_score': 0.36879432}
confusion matrix:
     0   1
0  230   0
1  178  52
early stop counter: 16
val acc:0.7011582851409912, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 18,now: 2024-07-26 11:26:26.876570,epoch time: 0:01:26.215070,used: 0:26:00.598311,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.9905076, 'recall': 0.9905125, 'specificity': 0.9905125, 'f1': 0.99051, 'auroc': 0.9997918, 'binary_precision': 0.9909032, 'binary_recall': 0.99025977, 'binary_specificity': 0.99076515, 'binary_f1_score': 0.9905814}
confusion matrix:
      0     1
0  1502    14
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.8277992, 'precision': 0.8450338, 'recall': 0.82667327, 'specificity': 0.82667327, 'f1': 0.8252636, 'auroc': 0.9211077, 'binary_precision': 0.9196787, 'binary_recall': 0.7145086, 'binary_specificity': 0.93883795, 'binary_f1_score': 0.80421424}
confusion matrix:
     0    1
0  614   40
1  183  458
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8521739, 'precision': 0.8682109, 'recall': 0.8521739, 'specificity': 0.8521739, 'f1': 0.8505466, 'auroc': 0.9065785, 'binary_precision': 0.94505495, 'binary_recall': 0.7478261, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.8349514}
confusion matrix:
     0    1
0  220   10
1   58  172
early stop counter: 17
val acc:0.8277992010116577, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 19,now: 2024-07-26 11:27:53.524505,epoch time: 0:01:26.647935,used: 0:27:27.246246,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9911649, 'precision': 0.99116105, 'recall': 0.99118567, 'specificity': 0.99118567, 'f1': 0.9911648, 'auroc': 0.9990346, 'binary_precision': 0.9941176, 'binary_recall': 0.9883041, 'binary_specificity': 0.99406725, 'binary_f1_score': 0.99120235}
confusion matrix:
      0     1
0  1508     9
1    18  1521
---- Validation: 
scalar performance:
{'acc': 0.7505792, 'precision': 0.8083056, 'recall': 0.74839103, 'specificity': 0.74839103, 'f1': 0.73721874, 'auroc': 0.90373766, 'binary_precision': 0.9392265, 'binary_recall': 0.5304212, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.6779661}
confusion matrix:
     0    1
0  632   22
1  301  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8108696, 'precision': 0.86004376, 'recall': 0.8108696, 'specificity': 0.8108696, 'f1': 0.8041835, 'auroc': 0.93483937, 'binary_precision': 0.99310344, 'binary_recall': 0.62608695, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.768}
confusion matrix:
     0    1
0  229    1
1   86  144
early stop counter: 18
val acc:0.7505791783332825, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 20,now: 2024-07-26 11:29:19.200222,epoch time: 0:01:25.675717,used: 0:28:52.921963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.99051046, 'precision': 0.99060196, 'recall': 0.99057364, 'specificity': 0.99057364, 'f1': 0.99051046, 'auroc': 0.9997597, 'binary_precision': 0.9993386, 'binary_recall': 0.9818064, 'binary_specificity': 0.99934083, 'binary_f1_score': 0.99049497}
confusion matrix:
      0     1
0  1516     1
1    28  1511
---- Validation: 
scalar performance:
{'acc': 0.5899614, 'precision': 0.77152896, 'recall': 0.58581895, 'specificity': 0.58581895, 'f1': 0.5028812, 'auroc': 0.94560295, 'binary_precision': 0.9910714, 'binary_recall': 0.17316693, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.2948207}
confusion matrix:
     0    1
0  653    1
1  530  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.51521736, 'precision': 0.6983247, 'recall': 0.5152174, 'specificity': 0.5152174, 'f1': 0.369743, 'auroc': 0.90020794, 'binary_precision': 0.8888889, 'binary_recall': 0.034782607, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.066945605}
confusion matrix:
     0  1
0  229  1
1  222  8
early stop counter: 19
val acc:0.5899614095687866, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 21,now: 2024-07-26 11:30:43.618156,epoch time: 0:01:24.417934,used: 0:30:17.339897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.98920155, 'precision': 0.9892808, 'recall': 0.98925465, 'specificity': 0.98925465, 'f1': 0.98920155, 'auroc': 0.9995498, 'binary_precision': 0.99735624, 'binary_recall': 0.98114437, 'binary_specificity': 0.99736494, 'binary_f1_score': 0.98918384}
confusion matrix:
      0     1
0  1514     4
1    29  1509
---- Validation: 
scalar performance:
{'acc': 0.72895753, 'precision': 0.81492484, 'recall': 0.7263176, 'specificity': 0.7263176, 'f1': 0.70759875, 'auroc': 0.9441788, 'binary_precision': 0.9769737, 'binary_recall': 0.46333852, 'binary_specificity': 0.9892966, 'binary_f1_score': 0.6285714}
confusion matrix:
     0    1
0  647    7
1  344  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6847826, 'precision': 0.8012234, 'recall': 0.6847826, 'specificity': 0.6847826, 'f1': 0.65106124, 'auroc': 0.9346645, 'binary_precision': 0.9885057, 'binary_recall': 0.37391305, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.54258674}
confusion matrix:
     0   1
0  229   1
1  144  86
early stop counter: 20
val acc:0.7289575338363647, best validation acc: 0.8648648858070374, corresponding to test acc:                         0.8282608985900879 / 0.8586956262588501
after epoch: 22,now: 2024-07-26 11:32:08.509654,epoch time: 0:01:24.891498,used: 0:31:42.231395,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.97742146, 'precision': 0.97841346, 'recall': 0.97728133, 'specificity': 0.97728133, 'f1': 0.977404, 'auroc': 0.9997623, 'binary_precision': 0.9582034, 'binary_recall': 0.9986996, 'binary_specificity': 0.955863, 'binary_f1_score': 0.97803247}
confusion matrix:
      0     1
0  1451    67
1     2  1536
---- Validation: 
scalar performance:
{'acc': 0.87644786, 'precision': 0.8788948, 'recall': 0.8760478, 'specificity': 0.8760478, 'f1': 0.8761548, 'auroc': 0.9399233, 'binary_precision': 0.9069374, 'binary_recall': 0.83619344, 'binary_specificity': 0.91590214, 'binary_f1_score': 0.8701298}
confusion matrix:
     0    1
0  599   55
1  105  536
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8586956, 'precision': 0.8716872, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85745, 'auroc': 0.91597354, 'binary_precision': 0.9411765, 'binary_recall': 0.76521736, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  219   11
1   54  176
better model found
persisted
after epoch: 23,now: 2024-07-26 11:33:34.552115,epoch time: 0:01:26.042461,used: 0:33:08.273856,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.994123, 'recall': 0.9940993, 'specificity': 0.9940993, 'f1': 0.9941095, 'auroc': 0.99979055, 'binary_precision': 0.99287564, 'binary_recall': 0.99545455, 'binary_specificity': 0.9927441, 'binary_f1_score': 0.99416345}
confusion matrix:
      0     1
0  1505    11
1     7  1533
---- Validation: 
scalar performance:
{'acc': 0.8046332, 'precision': 0.8407016, 'recall': 0.80299324, 'specificity': 0.80299324, 'f1': 0.798718, 'auroc': 0.9128566, 'binary_precision': 0.9490741, 'binary_recall': 0.6396256, 'binary_specificity': 0.96636087, 'binary_f1_score': 0.7642125}
confusion matrix:
     0    1
0  632   22
1  231  410
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.726087, 'precision': 0.8106494, 'recall': 0.726087, 'specificity': 0.726087, 'f1': 0.7060852, 'auroc': 0.920794, 'binary_precision': 0.9727273, 'binary_recall': 0.46521738, 'binary_specificity': 0.98695654, 'binary_f1_score': 0.62941176}
confusion matrix:
     0    1
0  227    3
1  123  107
early stop counter: 1
val acc:0.8046332001686096, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 24,now: 2024-07-26 11:34:59.097203,epoch time: 0:01:24.545088,used: 0:34:32.818944,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.99345547, 'precision': 0.9934677, 'recall': 0.99344575, 'specificity': 0.99344575, 'f1': 0.99345505, 'auroc': 0.99973524, 'binary_precision': 0.99222296, 'binary_recall': 0.9948018, 'binary_specificity': 0.9920896, 'binary_f1_score': 0.9935107}
confusion matrix:
      0     1
0  1505    12
1     8  1531
---- Validation: 
scalar performance:
{'acc': 0.85096526, 'precision': 0.87474436, 'recall': 0.84970206, 'specificity': 0.84970206, 'f1': 0.84822524, 'auroc': 0.9477403, 'binary_precision': 0.96666664, 'binary_recall': 0.72386897, 'binary_specificity': 0.97553515, 'binary_f1_score': 0.82783234}
confusion matrix:
     0    1
0  638   16
1  177  464
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82173914, 'precision': 0.8660215, 'recall': 0.82173914, 'specificity': 0.82173914, 'f1': 0.81617934, 'auroc': 0.94439983, 'binary_precision': 0.99333334, 'binary_recall': 0.6478261, 'binary_specificity': 0.9956522, 'binary_f1_score': 0.7842105}
confusion matrix:
     0    1
0  229    1
1   81  149
early stop counter: 2
val acc:0.8509652614593506, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 25,now: 2024-07-26 11:36:24.719479,epoch time: 0:01:25.622276,used: 0:35:58.441220,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.989856, 'precision': 0.99001855, 'recall': 0.9898013, 'specificity': 0.9898013, 'f1': 0.98985386, 'auroc': 0.9997648, 'binary_precision': 0.9827145, 'binary_recall': 0.99740094, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.9900033}
confusion matrix:
      0     1
0  1490    27
1     4  1535
---- Validation: 
scalar performance:
{'acc': 0.8756757, 'precision': 0.8805263, 'recall': 0.8751127, 'specificity': 0.8751127, 'f1': 0.8751504, 'auroc': 0.939222, 'binary_precision': 0.92105263, 'binary_recall': 0.8190328, 'binary_specificity': 0.93119264, 'binary_f1_score': 0.8670521}
confusion matrix:
     0    1
0  609   45
1  116  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8586956, 'precision': 0.86623496, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85796463, 'auroc': 0.91379964, 'binary_precision': 0.9187817, 'binary_recall': 0.78695655, 'binary_specificity': 0.93043476, 'binary_f1_score': 0.84777516}
confusion matrix:
     0    1
0  214   16
1   49  181
early stop counter: 3
val acc:0.8756756782531738, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 26,now: 2024-07-26 11:37:51.076742,epoch time: 0:01:26.357263,used: 0:37:24.798483,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9931283, 'precision': 0.99312246, 'recall': 0.99315095, 'specificity': 0.99315095, 'f1': 0.99312806, 'auroc': 0.99957937, 'binary_precision': 0.996081, 'binary_recall': 0.99025977, 'binary_specificity': 0.9960422, 'binary_f1_score': 0.9931618}
confusion matrix:
      0     1
0  1510     6
1    15  1525
---- Validation: 
scalar performance:
{'acc': 0.8061776, 'precision': 0.8448111, 'recall': 0.8044913, 'specificity': 0.8044913, 'f1': 0.79997736, 'auroc': 0.9418268, 'binary_precision': 0.9577465, 'binary_recall': 0.6365055, 'binary_specificity': 0.9724771, 'binary_f1_score': 0.76476103}
confusion matrix:
     0    1
0  636   18
1  233  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8282609, 'precision': 0.85869944, 'recall': 0.8282609, 'specificity': 0.8282609, 'f1': 0.8245385, 'auroc': 0.92729676, 'binary_precision': 0.9631902, 'binary_recall': 0.6826087, 'binary_specificity': 0.973913, 'binary_f1_score': 0.7989822}
confusion matrix:
     0    1
0  224    6
1   73  157
early stop counter: 4
val acc:0.8061776161193848, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 27,now: 2024-07-26 11:39:17.443750,epoch time: 0:01:26.367008,used: 0:38:51.165491,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9908377, 'precision': 0.9908891, 'recall': 0.9908891, 'specificity': 0.9908891, 'f1': 0.9908377, 'auroc': 0.99985605, 'binary_precision': 0.99802244, 'binary_recall': 0.9837557, 'binary_specificity': 0.99802244, 'binary_f1_score': 0.9908377}
confusion matrix:
      0     1
0  1514     3
1    25  1514
---- Validation: 
scalar performance:
{'acc': 0.56911194, 'precision': 0.7639524, 'recall': 0.5647581, 'specificity': 0.5647581, 'f1': 0.46602437, 'auroc': 0.92626375, 'binary_precision': 0.9882353, 'binary_recall': 0.13104524, 'binary_specificity': 0.99847096, 'binary_f1_score': 0.23140495}
confusion matrix:
     0   1
0  653   1
1  557  84
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.50869566, 'precision': 0.752193, 'recall': 0.50869566, 'specificity': 0.50869566, 'f1': 0.35237098, 'auroc': 0.9443668, 'binary_precision': 1.0, 'binary_recall': 0.017391304, 'binary_specificity': 1.0, 'binary_f1_score': 0.034188032}
confusion matrix:
     0  1
0  230  0
1  226  4
early stop counter: 5
val acc:0.5691119432449341, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 28,now: 2024-07-26 11:40:42.658463,epoch time: 0:01:25.214713,used: 0:40:16.380204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9895288, 'precision': 0.9896984, 'recall': 0.9894769, 'specificity': 0.9894769, 'f1': 0.9895266, 'auroc': 0.99983, 'binary_precision': 0.98207426, 'binary_recall': 0.9973992, 'binary_specificity': 0.9815547, 'binary_f1_score': 0.9896774}
confusion matrix:
      0     1
0  1490    28
1     4  1534
---- Validation: 
scalar performance:
{'acc': 0.84942085, 'precision': 0.85883427, 'recall': 0.8486072, 'specificity': 0.8486072, 'f1': 0.84820294, 'auroc': 0.93632364, 'binary_precision': 0.91449815, 'binary_recall': 0.7675507, 'binary_specificity': 0.9296636, 'binary_f1_score': 0.8346057}
confusion matrix:
     0    1
0  608   46
1  149  492
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.726087, 'precision': 0.80321467, 'recall': 0.726087, 'specificity': 0.726087, 'f1': 0.70748544, 'auroc': 0.94315696, 'binary_precision': 0.95614034, 'binary_recall': 0.47391304, 'binary_specificity': 0.9782609, 'binary_f1_score': 0.63372093}
confusion matrix:
     0    1
0  225    5
1  121  109
early stop counter: 6
val acc:0.8494208455085754, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 29,now: 2024-07-26 11:42:08.252522,epoch time: 0:01:25.594059,used: 0:41:41.974263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9941099, 'precision': 0.99411476, 'recall': 0.9941054, 'specificity': 0.9941054, 'f1': 0.99410963, 'auroc': 0.9998942, 'binary_precision': 0.9935065, 'binary_recall': 0.9947984, 'binary_specificity': 0.9934124, 'binary_f1_score': 0.99415207}
confusion matrix:
      0     1
0  1508    10
1     8  1530
---- Validation: 
scalar performance:
{'acc': 0.67104244, 'precision': 0.77887267, 'recall': 0.66789275, 'specificity': 0.66789275, 'f1': 0.63339317, 'auroc': 0.92471385, 'binary_precision': 0.9497908, 'binary_recall': 0.35413417, 'binary_specificity': 0.98165137, 'binary_f1_score': 0.5159091}
confusion matrix:
     0    1
0  642   12
1  414  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6673913, 'precision': 0.7778039, 'recall': 0.6673913, 'specificity': 0.6673913, 'f1': 0.63069654, 'auroc': 0.9271692, 'binary_precision': 0.9529412, 'binary_recall': 0.35217392, 'binary_specificity': 0.9826087, 'binary_f1_score': 0.51428574}
confusion matrix:
     0   1
0  226   4
1  149  81
early stop counter: 7
val acc:0.6710424423217773, best validation acc: 0.876447856426239, corresponding to test acc:                         0.8586956262588501 / 0.8586956262588501
after epoch: 30,now: 2024-07-26 11:43:32.411138,epoch time: 0:01:24.158616,used: 0:43:06.132879,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_00_26_seed_9_23065529
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:43:06.132879 at 2024-07-26 11:43:32.411138
persisted model performance metric: 

scalar performance:
{'acc': 0.8586956, 'precision': 0.8716872, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85745, 'auroc': 0.91597354, 'binary_precision': 0.9411765, 'binary_recall': 0.76521736, 'binary_specificity': 0.9521739, 'binary_f1_score': 0.8441247}
confusion matrix:
     0    1
0  219   11
1   54  176
oracle model performance metric: 

scalar performance:
{'acc': 0.8586956, 'precision': 0.8602278, 'recall': 0.8586956, 'specificity': 0.8586956, 'f1': 0.85854524, 'auroc': 0.91924393, 'binary_precision': 0.88372093, 'binary_recall': 0.82608694, 'binary_specificity': 0.8913044, 'binary_f1_score': 0.85393256}
confusion matrix:
     0    1
0  205   25
1   40  190
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_diva_irm_10seeds_nofreeze_2024-07-26_00-12-34/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455130 KiB |  13219 MiB | 738261 GiB | 738261 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 729537 GiB | 729536 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455130 KiB |  13219 MiB | 738261 GiB | 738261 GiB |
|       from large pool | 414531 KiB |  13181 MiB | 729537 GiB | 729536 GiB |
|       from small pool |  40598 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447482 KiB |  13213 MiB | 737328 GiB | 737328 GiB |
|       from large pool | 407075 KiB |  13175 MiB | 728622 GiB | 728622 GiB |
|       from small pool |  40407 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14472 MiB |  14480 MiB | 136822 MiB | 122350 MiB |
|       from large pool |  14408 MiB |  14414 MiB | 136616 MiB | 122208 MiB |
|       from small pool |     64 MiB |     70 MiB |    206 MiB |    142 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 445990 KiB |   1252 MiB | 526754 GiB | 526753 GiB |
|       from large pool | 435388 KiB |   1244 MiB | 517975 GiB | 517974 GiB |
|       from small pool |  10601 KiB |     45 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1310    |    2598    |  129760 K  |  129759 K  |
|       from large pool |     187    |    1413    |   65972 K  |   65972 K  |
|       from small pool |    1123    |    1419    |   63788 K  |   63787 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1310    |    2598    |  129760 K  |  129759 K  |
|       from large pool |     187    |    1413    |   65972 K  |   65972 K  |
|       from small pool |    1123    |    1419    |   63788 K  |   63787 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     633    |     636    |    5780    |    5147    |
|       from large pool |     601    |     601    |    5677    |    5076    |
|       from small pool |      32    |      35    |     103    |      71    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      94    |     652    |   83848 K  |   83848 K  |
|       from large pool |      40    |     604    |   46628 K  |   46628 K  |
|       from small pool |      54    |     240    |   37219 K  |   37219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |  13219 MiB | 738261 GiB | 738261 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 729537 GiB | 729537 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |  13219 MiB | 738261 GiB | 738261 GiB |
|       from large pool |  16640 KiB |  13181 MiB | 729537 GiB | 729537 GiB |
|       from small pool |      0 KiB |     60 MiB |   8724 GiB |   8724 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |  13213 MiB | 737328 GiB | 737328 GiB |
|       from large pool |  16640 KiB |  13175 MiB | 728622 GiB | 728622 GiB |
|       from small pool |      0 KiB |     60 MiB |   8706 GiB |   8706 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    880 MiB |  14480 MiB | 136822 MiB | 135942 MiB |
|       from large pool |    830 MiB |  14414 MiB | 136616 MiB | 135786 MiB |
|       from small pool |     50 MiB |     70 MiB |    206 MiB |    156 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB |   1252 MiB | 526754 GiB | 526754 GiB |
|       from large pool |  24320 KiB |   1244 MiB | 517975 GiB | 517975 GiB |
|       from small pool |      0 KiB |     45 MiB |   8778 GiB |   8778 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2598    |  129760 K  |  129760 K  |
|       from large pool |       2    |    1413    |   65972 K  |   65972 K  |
|       from small pool |       0    |    1419    |   63788 K  |   63788 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2598    |  129760 K  |  129760 K  |
|       from large pool |       2    |    1413    |   65972 K  |   65972 K  |
|       from small pool |       0    |    1419    |   63788 K  |   63788 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      62    |     636    |    5780    |    5718    |
|       from large pool |      37    |     601    |    5677    |    5640    |
|       from small pool |      25    |      35    |     103    |      78    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     652    |   83848 K  |   83848 K  |
|       from large pool |       4    |     604    |   46628 K  |   46628 K  |
|       from small pool |       0    |     240    |   37219 K  |   37219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 26 11:43:40 2024]
Finished job 0.
1 of 1 steps (100%) done
