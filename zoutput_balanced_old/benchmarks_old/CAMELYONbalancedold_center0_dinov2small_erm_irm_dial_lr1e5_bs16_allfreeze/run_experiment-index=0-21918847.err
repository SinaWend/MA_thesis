Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 13:34:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847

 Experiment start at: 2024-07-12 13:43:59.509696
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9519997, 'precision': 0.80762315, 'recall': 0.5169894, 'specificity': 0.5169894, 'f1': 0.5208291, 'auroc': 0.9110819, 'binary_precision': 0.9527463, 'binary_recall': 0.9990874, 'binary_specificity': 0.034891374, 'binary_f1_score': 0.9753667}
confusion matrix:
    0      1
0  53   1466
1  27  29558
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5535714, 'precision': 0.7502427, 'recall': 0.55968094, 'specificity': 0.55968094, 'f1': 0.45267844, 'auroc': 0.84538716, 'binary_precision': 0.52487564, 'binary_recall': 0.9968504, 'binary_specificity': 0.122511484, 'binary_f1_score': 0.6876698}
confusion matrix:
    0    1
0  80  573
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5731959, 'precision': 0.7830188, 'recall': 0.51860464, 'specificity': 0.51860464, 'f1': 0.3973202, 'auroc': 0.8369509, 'binary_precision': 0.5660377, 'binary_recall': 1.0, 'binary_specificity': 0.037209302, 'binary_f1_score': 0.72289157}
confusion matrix:
   0    1
0  8  207
1  0  270
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 13:59:41.254791,epoch time: 0:15:41.745095,used: 0:15:41.745095,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9592657, 'precision': 0.89203596, 'recall': 0.60449547, 'specificity': 0.60449547, 'f1': 0.65764487, 'auroc': 0.9394665, 'binary_precision': 0.96099496, 'binary_recall': 0.99766773, 'binary_specificity': 0.21132325, 'binary_f1_score': 0.978988}
confusion matrix:
     0      1
0  321   1198
1   69  29516
---- Validation: 
scalar performance:
{'acc': 0.5931677, 'precision': 0.73523366, 'recall': 0.59851444, 'specificity': 0.59851444, 'f1': 0.5269154, 'auroc': 0.8525593, 'binary_precision': 0.5488987, 'binary_recall': 0.98110235, 'binary_specificity': 0.2159265, 'binary_f1_score': 0.7039548}
confusion matrix:
     0    1
0  141  512
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6371134, 'precision': 0.79073286, 'recall': 0.5911714, 'specificity': 0.5911714, 'f1': 0.5330007, 'auroc': 0.8623773, 'binary_precision': 0.6058559, 'binary_recall': 0.9962963, 'binary_specificity': 0.18604651, 'binary_f1_score': 0.7535014}
confusion matrix:
    0    1
0  40  175
1   1  269
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 14:15:23.552330,epoch time: 0:15:42.297539,used: 0:31:24.042634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9661458, 'precision': 0.88300157, 'recall': 0.7034715, 'specificity': 0.7034715, 'f1': 0.76279426, 'auroc': 0.9578769, 'binary_precision': 0.97057754, 'binary_recall': 0.9945582, 'binary_specificity': 0.41238472, 'binary_f1_score': 0.9824215}
confusion matrix:
     0      1
0  626    892
1  161  29425
---- Validation: 
scalar performance:
{'acc': 0.64363354, 'precision': 0.75787127, 'recall': 0.6482196, 'specificity': 0.6482196, 'f1': 0.603233, 'auroc': 0.8642751, 'binary_precision': 0.58270675, 'binary_recall': 0.97637796, 'binary_specificity': 0.32006127, 'binary_f1_score': 0.72984105}
confusion matrix:
     0    1
0  209  444
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.77521515, 'recall': 0.63772607, 'specificity': 0.63772607, 'f1': 0.6099629, 'auroc': 0.8829802, 'binary_precision': 0.6361446, 'binary_recall': 0.9777778, 'binary_specificity': 0.29767442, 'binary_f1_score': 0.7708029}
confusion matrix:
    0    1
0  64  151
1   6  264
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 14:30:53.800626,epoch time: 0:15:30.248296,used: 0:46:54.290930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96511704, 'precision': 0.8843912, 'recall': 0.6881354, 'specificity': 0.6881354, 'f1': 0.7490895, 'auroc': 0.96371377, 'binary_precision': 0.9690586, 'binary_recall': 0.9950989, 'binary_specificity': 0.38117182, 'binary_f1_score': 0.9819061}
confusion matrix:
     0      1
0  579    940
1  145  29440
---- Validation: 
scalar performance:
{'acc': 0.6164596, 'precision': 0.74239206, 'recall': 0.6214202, 'specificity': 0.6214202, 'f1': 0.56420565, 'auroc': 0.87683254, 'binary_precision': 0.5641492, 'binary_recall': 0.97637796, 'binary_specificity': 0.26646248, 'binary_f1_score': 0.7151096}
confusion matrix:
     0    1
0  174  479
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.78560007, 'recall': 0.6200258, 'specificity': 0.6200258, 'f1': 0.5810509, 'auroc': 0.89801896, 'binary_precision': 0.62383175, 'binary_recall': 0.98888886, 'binary_specificity': 0.2511628, 'binary_f1_score': 0.76504296}
confusion matrix:
    0    1
0  54  161
1   3  267
early stop counter: 1
val acc:0.6164596080780029, best validation acc: 0.6436335444450378, corresponding to test acc:                         0.6762886643409729 / 0.6762886643409729
after epoch: 4,now: 2024-07-12 14:45:32.532935,epoch time: 0:14:38.732309,used: 1:01:33.023239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96865356, 'precision': 0.90164655, 'recall': 0.7224698, 'specificity': 0.7224698, 'f1': 0.7836126, 'auroc': 0.9702811, 'binary_precision': 0.97239286, 'binary_recall': 0.99530166, 'binary_specificity': 0.44963792, 'binary_f1_score': 0.98371387}
confusion matrix:
     0      1
0  683    836
1  139  29446
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.74134576, 'recall': 0.6160821, 'specificity': 0.6160821, 'f1': 0.55556196, 'auroc': 0.88294125, 'binary_precision': 0.5604693, 'binary_recall': 0.9779528, 'binary_specificity': 0.25421134, 'binary_f1_score': 0.7125645}
confusion matrix:
     0    1
0  166  487
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6659794, 'precision': 0.77429855, 'recall': 0.6256245, 'specificity': 0.6256245, 'f1': 0.5915811, 'auroc': 0.9053575, 'binary_precision': 0.6279621, 'binary_recall': 0.9814815, 'binary_specificity': 0.26976743, 'binary_f1_score': 0.76589596}
confusion matrix:
    0    1
0  58  157
1   5  265
early stop counter: 2
val acc:0.6110248565673828, best validation acc: 0.6436335444450378, corresponding to test acc:                         0.6762886643409729 / 0.6762886643409729
after epoch: 5,now: 2024-07-12 15:00:13.347921,epoch time: 0:14:40.814986,used: 1:16:13.838225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97003603, 'precision': 0.9033963, 'recall': 0.73878145, 'specificity': 0.73878145, 'f1': 0.7977181, 'auroc': 0.9737228, 'binary_precision': 0.9740281, 'binary_recall': 0.9950316, 'binary_specificity': 0.4825313, 'binary_f1_score': 0.98441786}
confusion matrix:
     0      1
0  732    785
1  147  29440
---- Validation: 
scalar performance:
{'acc': 0.6265528, 'precision': 0.7483225, 'recall': 0.6313743, 'specificity': 0.6313743, 'f1': 0.5789692, 'auroc': 0.88569295, 'binary_precision': 0.5709024, 'binary_recall': 0.97637796, 'binary_specificity': 0.2863706, 'binary_f1_score': 0.72051144}
confusion matrix:
     0    1
0  187  466
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.7697908, 'recall': 0.6381998, 'specificity': 0.6381998, 'f1': 0.61154675, 'auroc': 0.90907836, 'binary_precision': 0.63680387, 'binary_recall': 0.97407407, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.77013177}
confusion matrix:
    0    1
0  65  150
1   7  263
early stop counter: 3
val acc:0.6265528202056885, best validation acc: 0.6436335444450378, corresponding to test acc:                         0.6762886643409729 / 0.6762886643409729
after epoch: 6,now: 2024-07-12 15:14:50.072817,epoch time: 0:14:36.724896,used: 1:30:50.563121,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.97148275, 'precision': 0.9052542, 'recall': 0.75674474, 'specificity': 0.75674474, 'f1': 0.8125118, 'auroc': 0.9757143, 'binary_precision': 0.9757626, 'binary_recall': 0.9947271, 'binary_specificity': 0.51876235, 'binary_f1_score': 0.98515356}
confusion matrix:
     0      1
0  788    731
1  156  29429
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.7481528, 'recall': 0.6237607, 'specificity': 0.6237607, 'f1': 0.56658703, 'auroc': 0.8887557, 'binary_precision': 0.56545454, 'binary_recall': 0.97952753, 'binary_specificity': 0.26799387, 'binary_f1_score': 0.71700287}
confusion matrix:
     0    1
0  175  478
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77122957, 'recall': 0.6405254, 'specificity': 0.6405254, 'f1': 0.6147972, 'auroc': 0.91322994, 'binary_precision': 0.63834953, 'binary_recall': 0.97407407, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.771261}
confusion matrix:
    0    1
0  66  149
1   7  263
new oracle model saved
early stop counter: 4
val acc:0.6187888383865356, best validation acc: 0.6436335444450378, corresponding to test acc:                         0.6762886643409729 / 0.6783505082130432
after epoch: 7,now: 2024-07-12 15:29:27.377496,epoch time: 0:14:37.304679,used: 1:45:27.867800,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97038966, 'precision': 0.91808987, 'recall': 0.73212576, 'specificity': 0.73212576, 'f1': 0.79576474, 'auroc': 0.9782771, 'binary_precision': 0.9733157, 'binary_recall': 0.9961805, 'binary_specificity': 0.4680711, 'binary_f1_score': 0.9846153}
confusion matrix:
     0      1
0  711    808
1  113  29472
---- Validation: 
scalar performance:
{'acc': 0.6040373, 'precision': 0.7419487, 'recall': 0.60923415, 'specificity': 0.60923415, 'f1': 0.543808, 'auroc': 0.8917389, 'binary_precision': 0.55575377, 'binary_recall': 0.98110235, 'binary_specificity': 0.237366, 'binary_f1_score': 0.7095671}
confusion matrix:
     0    1
0  155  498
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6742268, 'precision': 0.77382946, 'recall': 0.63540053, 'specificity': 0.63540053, 'f1': 0.6066706, 'auroc': 0.91510767, 'binary_precision': 0.63461536, 'binary_recall': 0.9777778, 'binary_specificity': 0.29302326, 'binary_f1_score': 0.76967925}
confusion matrix:
    0    1
0  63  152
1   6  264
early stop counter: 5
val acc:0.6040372848510742, best validation acc: 0.6436335444450378, corresponding to test acc:                         0.6762886643409729 / 0.6783505082130432
after epoch: 8,now: 2024-07-12 15:44:03.124289,epoch time: 0:14:35.746793,used: 2:00:03.614593,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_13_43_59_seed_0_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 8 with time: 2:00:03.614593 at 2024-07-12 15:44:03.124289
persisted model performance metric: 

scalar performance:
{'acc': 0.67628866, 'precision': 0.77521515, 'recall': 0.63772607, 'specificity': 0.63772607, 'f1': 0.6099629, 'auroc': 0.8829802, 'binary_precision': 0.6361446, 'binary_recall': 0.9777778, 'binary_specificity': 0.29767442, 'binary_f1_score': 0.7708029}
confusion matrix:
    0    1
0  64  151
1   6  264
oracle model performance metric: 

scalar performance:
{'acc': 0.6783505, 'precision': 0.77122957, 'recall': 0.6405254, 'specificity': 0.6405254, 'f1': 0.6147972, 'auroc': 0.91322994, 'binary_precision': 0.63834953, 'binary_recall': 0.97407407, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.771261}
confusion matrix:
    0    1
0  66  149
1   7  263
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190794 KiB | 460563 KiB |  82393 GiB |  82393 GiB |
|       from large pool | 174400 KiB | 428048 KiB |  80702 GiB |  80702 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   1691 GiB |   1691 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190794 KiB | 460563 KiB |  82393 GiB |  82393 GiB |
|       from large pool | 174400 KiB | 428048 KiB |  80702 GiB |  80702 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   1691 GiB |   1691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB |  82390 GiB |  82389 GiB |
|       from large pool | 172814 KiB | 424940 KiB |  80701 GiB |  80701 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   1688 GiB |   1688 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36533 KiB |  74940 KiB |  46272 GiB |  46272 GiB |
|       from large pool |  30400 KiB |  70632 KiB |  44539 GiB |  44539 GiB |
|       from small pool |   6133 KiB |   9283 KiB |   1732 GiB |   1732 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    4351    |   16801 K  |   16800 K  |
|       from large pool |      76    |     158    |    7957 K  |    7957 K  |
|       from small pool |     724    |    4274    |    8843 K  |    8842 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    4351    |   16801 K  |   16800 K  |
|       from large pool |      76    |     158    |    7957 K  |    7957 K  |
|       from small pool |     724    |    4274    |    8843 K  |    8842 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1960    |   10531 K  |   10531 K  |
|       from large pool |       9    |      19    |    5291 K  |    5291 K  |
|       from small pool |      24    |    1951    |    5240 K  |    5240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB |  82393 GiB |  82393 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  80702 GiB |  80702 GiB |
|       from small pool |      0 KiB |  33617 KiB |   1691 GiB |   1691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB |  82393 GiB |  82393 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  80702 GiB |  80702 GiB |
|       from small pool |      0 KiB |  33617 KiB |   1691 GiB |   1691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB |  82390 GiB |  82389 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  80701 GiB |  80701 GiB |
|       from small pool |      0 KiB |  33425 KiB |   1688 GiB |   1688 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  74940 KiB |  46272 GiB |  46272 GiB |
|       from large pool |  23872 KiB |  70632 KiB |  44539 GiB |  44539 GiB |
|       from small pool |      0 KiB |  11485 KiB |   1732 GiB |   1732 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4351    |   16801 K  |   16801 K  |
|       from large pool |       2    |     158    |    7957 K  |    7957 K  |
|       from small pool |       0    |    4274    |    8843 K  |    8843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4351    |   16801 K  |   16801 K  |
|       from large pool |       2    |     158    |    7957 K  |    7957 K  |
|       from small pool |       0    |    4274    |    8843 K  |    8843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1960    |   10531 K  |   10531 K  |
|       from large pool |       3    |      19    |    5291 K  |    5291 K  |
|       from small pool |       0    |    1951    |    5240 K  |    5240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB |  82393 GiB |  82393 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  80702 GiB |  80702 GiB |
|       from small pool |      0 KiB |  33617 KiB |   1691 GiB |   1691 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB |  82393 GiB |  82393 GiB |
|       from large pool |  17088 KiB | 428048 KiB |  80702 GiB |  80702 GiB |
|       from small pool |      0 KiB |  33617 KiB |   1691 GiB |   1691 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB |  82390 GiB |  82389 GiB |
|       from large pool |  16640 KiB | 424940 KiB |  80701 GiB |  80701 GiB |
|       from small pool |      0 KiB |  33425 KiB |   1688 GiB |   1688 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  74940 KiB |  46272 GiB |  46272 GiB |
|       from large pool |  23872 KiB |  70632 KiB |  44539 GiB |  44539 GiB |
|       from small pool |      0 KiB |  11485 KiB |   1732 GiB |   1732 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4351    |   16801 K  |   16801 K  |
|       from large pool |       2    |     158    |    7957 K  |    7957 K  |
|       from small pool |       0    |    4274    |    8843 K  |    8843 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4351    |   16801 K  |   16801 K  |
|       from large pool |       2    |     158    |    7957 K  |    7957 K  |
|       from small pool |       0    |    4274    |    8843 K  |    8843 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1960    |   10531 K  |   10531 K  |
|       from large pool |       3    |      19    |    5291 K  |    5291 K  |
|       from small pool |       0    |    1951    |    5240 K  |    5240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847

 Experiment start at: 2024-07-12 15:57:29.594230
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.95290875, 'precision': 0.81763744, 'recall': 0.5301802, 'specificity': 0.5301802, 'f1': 0.54460084, 'auroc': 0.9085759, 'binary_precision': 0.95411545, 'binary_recall': 0.99851835, 'binary_specificity': 0.061842106, 'binary_f1_score': 0.975812}
confusion matrix:
    0      1
0  94   1426
1  44  29652
---- Validation: 
scalar performance:
{'acc': 0.6284153, 'precision': 0.73779714, 'recall': 0.63387096, 'specificity': 0.63387096, 'f1': 0.5853106, 'auroc': 0.82918584, 'binary_precision': 0.57236844, 'binary_recall': 0.96666664, 'binary_specificity': 0.30107528, 'binary_f1_score': 0.71900827}
confusion matrix:
     0    1
0  196  455
1   21  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62343097, 'precision': 0.77213264, 'recall': 0.6004919, 'specificity': 0.6004919, 'f1': 0.53956807, 'auroc': 0.8579711, 'binary_precision': 0.5850816, 'binary_recall': 0.9920949, 'binary_specificity': 0.20888889, 'binary_f1_score': 0.7360704}
confusion matrix:
    0    1
0  47  178
1   2  251
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 16:12:18.157217,epoch time: 0:14:48.562987,used: 0:14:48.562987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.95950794, 'precision': 0.8908832, 'recall': 0.6069402, 'specificity': 0.6069402, 'f1': 0.6607313, 'auroc': 0.9442898, 'binary_precision': 0.96131754, 'binary_recall': 0.99757534, 'binary_specificity': 0.21630506, 'binary_f1_score': 0.97911096}
confusion matrix:
     0      1
0  329   1192
1   72  29623
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.72455424, 'recall': 0.62455195, 'specificity': 0.62455195, 'f1': 0.5738941, 'auroc': 0.8525126, 'binary_precision': 0.5664794, 'binary_recall': 0.96031743, 'binary_specificity': 0.28878647, 'binary_f1_score': 0.71260303}
confusion matrix:
     0    1
0  188  463
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6506276, 'precision': 0.78555363, 'recall': 0.62938076, 'specificity': 0.62938076, 'f1': 0.5842461, 'auroc': 0.88808084, 'binary_precision': 0.60336536, 'binary_recall': 0.9920949, 'binary_specificity': 0.26666668, 'binary_f1_score': 0.7503737}
confusion matrix:
    0    1
0  60  165
1   2  251
new oracle model saved
early stop counter: 1
val acc:0.6190476417541504, best validation acc: 0.6284152865409851, corresponding to test acc:                         0.6234309673309326 / 0.650627613067627
after epoch: 2,now: 2024-07-12 16:26:56.549659,epoch time: 0:14:38.392442,used: 0:29:26.955429,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9647296, 'precision': 0.89987254, 'recall': 0.67112774, 'specificity': 0.67112774, 'f1': 0.73517776, 'auroc': 0.9591893, 'binary_precision': 0.96746665, 'binary_recall': 0.9964304, 'binary_specificity': 0.3458251, 'binary_f1_score': 0.98173493}
confusion matrix:
     0      1
0  526    995
1  106  29589
---- Validation: 
scalar performance:
{'acc': 0.6291959, 'precision': 0.73308897, 'recall': 0.6345622, 'specificity': 0.6345622, 'f1': 0.58778894, 'auroc': 0.86688614, 'binary_precision': 0.57332075, 'binary_recall': 0.96190476, 'binary_specificity': 0.30721965, 'binary_f1_score': 0.7184351}
confusion matrix:
     0    1
0  200  451
1   24  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.79713005, 'recall': 0.65604746, 'specificity': 0.65604746, 'f1': 0.6228422, 'auroc': 0.90399647, 'binary_precision': 0.6212871, 'binary_recall': 0.9920949, 'binary_specificity': 0.32, 'binary_f1_score': 0.7640791}
confusion matrix:
    0    1
0  72  153
1   2  251
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 16:41:41.364979,epoch time: 0:14:44.815320,used: 0:44:11.770749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96761274, 'precision': 0.8917717, 'recall': 0.7156844, 'specificity': 0.7156844, 'f1': 0.77547, 'auroc': 0.96796954, 'binary_precision': 0.97180736, 'binary_recall': 0.9948139, 'binary_specificity': 0.4365549, 'binary_f1_score': 0.98317605}
confusion matrix:
     0      1
0  664    857
1  154  29541
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.7404239, 'recall': 0.6529186, 'specificity': 0.6529186, 'f1': 0.6147394, 'auroc': 0.87642944, 'binary_precision': 0.58714706, 'binary_recall': 0.95714283, 'binary_specificity': 0.34869432, 'binary_f1_score': 0.7278214}
confusion matrix:
     0    1
0  227  424
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6882845, 'precision': 0.7921803, 'recall': 0.66987264, 'specificity': 0.66987264, 'f1': 0.6437529, 'auroc': 0.91439617, 'binary_precision': 0.6319797, 'binary_recall': 0.98418975, 'binary_specificity': 0.35555556, 'binary_f1_score': 0.76970637}
confusion matrix:
    0    1
0  80  145
1   4  249
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 16:56:19.901151,epoch time: 0:14:38.536172,used: 0:58:50.306921,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.96815735, 'precision': 0.898829, 'recall': 0.7172182, 'specificity': 0.7172182, 'f1': 0.778426, 'auroc': 0.9728007, 'binary_precision': 0.97194725, 'binary_recall': 0.9952517, 'binary_specificity': 0.43918476, 'binary_f1_score': 0.98346144}
confusion matrix:
     0      1
0  668    853
1  141  29554
---- Validation: 
scalar performance:
{'acc': 0.6112412, 'precision': 0.73260075, 'recall': 0.6170507, 'specificity': 0.6170507, 'f1': 0.5589721, 'auroc': 0.8840831, 'binary_precision': 0.5604396, 'binary_recall': 0.9714286, 'binary_specificity': 0.2626728, 'binary_f1_score': 0.7108014}
confusion matrix:
     0    1
0  171  480
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6715481, 'precision': 0.8016807, 'recall': 0.65135705, 'specificity': 0.65135705, 'f1': 0.6151388, 'auroc': 0.921054, 'binary_precision': 0.61764705, 'binary_recall': 0.99604744, 'binary_specificity': 0.30666667, 'binary_f1_score': 0.7624811}
confusion matrix:
    0    1
0  69  156
1   1  252
early stop counter: 1
val acc:0.6112412214279175, best validation acc: 0.6479312777519226, corresponding to test acc:                         0.6882845163345337 / 0.6882845163345337
after epoch: 5,now: 2024-07-12 17:10:59.938596,epoch time: 0:14:40.037445,used: 1:13:30.344366,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.97017556, 'precision': 0.9131372, 'recall': 0.7323142, 'specificity': 0.7323142, 'f1': 0.79475456, 'auroc': 0.9766266, 'binary_precision': 0.9734036, 'binary_recall': 0.9958579, 'binary_specificity': 0.46877053, 'binary_f1_score': 0.98450273}
confusion matrix:
     0      1
0  713    808
1  123  29572
---- Validation: 
scalar performance:
{'acc': 0.6393443, 'precision': 0.74454546, 'recall': 0.64462364, 'specificity': 0.64462364, 'f1': 0.60059524, 'auroc': 0.8868121, 'binary_precision': 0.58, 'binary_recall': 0.96666664, 'binary_specificity': 0.32258064, 'binary_f1_score': 0.72499996}
confusion matrix:
     0    1
0  210  441
1   21  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70711297, 'precision': 0.8065139, 'recall': 0.6896267, 'specificity': 0.6896267, 'f1': 0.669106, 'auroc': 0.9249363, 'binary_precision': 0.64599484, 'binary_recall': 0.9881423, 'binary_specificity': 0.3911111, 'binary_f1_score': 0.78125}
confusion matrix:
    0    1
0  88  137
1   3  250
new oracle model saved
early stop counter: 2
val acc:0.6393442749977112, best validation acc: 0.6479312777519226, corresponding to test acc:                         0.6882845163345337 / 0.7071129679679871
after epoch: 6,now: 2024-07-12 17:25:53.815729,epoch time: 0:14:53.877133,used: 1:28:24.221499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9695028, 'precision': 0.9067854, 'recall': 0.7283528, 'specificity': 0.7283528, 'f1': 0.789868, 'auroc': 0.97722995, 'binary_precision': 0.97304326, 'binary_recall': 0.9955213, 'binary_specificity': 0.4611842, 'binary_f1_score': 0.984154}
confusion matrix:
     0      1
0  701    819
1  133  29563
---- Validation: 
scalar performance:
{'acc': 0.60811865, 'precision': 0.734892, 'recall': 0.6140297, 'specificity': 0.6140297, 'f1': 0.55323064, 'auroc': 0.8885939, 'binary_precision': 0.5581818, 'binary_recall': 0.9746032, 'binary_specificity': 0.25345623, 'binary_f1_score': 0.7098266}
confusion matrix:
     0    1
0  165  486
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6715481, 'precision': 0.7952244, 'recall': 0.651603, 'specificity': 0.651603, 'f1': 0.61657035, 'auroc': 0.92635924, 'binary_precision': 0.6182266, 'binary_recall': 0.9920949, 'binary_specificity': 0.31111112, 'binary_f1_score': 0.7617602}
confusion matrix:
    0    1
0  70  155
1   2  251
early stop counter: 3
val acc:0.6081186532974243, best validation acc: 0.6479312777519226, corresponding to test acc:                         0.6882845163345337 / 0.7071129679679871
after epoch: 7,now: 2024-07-12 17:40:46.221418,epoch time: 0:14:52.405689,used: 1:43:16.627188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9731548, 'precision': 0.8935879, 'recall': 0.7909566, 'specificity': 0.7909566, 'f1': 0.83367795, 'auroc': 0.97948194, 'binary_precision': 0.9792407, 'binary_recall': 0.99282706, 'binary_specificity': 0.5890861, 'binary_f1_score': 0.98598707}
confusion matrix:
     0      1
0  896    625
1  213  29482
---- Validation: 
scalar performance:
{'acc': 0.66432476, 'precision': 0.74792886, 'recall': 0.6689964, 'specificity': 0.6689964, 'f1': 0.637077, 'auroc': 0.8896545, 'binary_precision': 0.5998004, 'binary_recall': 0.9539682, 'binary_specificity': 0.3840246, 'binary_f1_score': 0.7365196}
confusion matrix:
     0    1
0  250  401
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.7893389, 'recall': 0.70443565, 'specificity': 0.70443565, 'f1': 0.6916841, 'auroc': 0.9270444, 'binary_precision': 0.6612466, 'binary_recall': 0.9644269, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.78456587}
confusion matrix:
     0    1
0  100  125
1    9  244
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 17:55:38.107558,epoch time: 0:14:51.886140,used: 1:58:08.513328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97328293, 'precision': 0.9056201, 'recall': 0.7794839, 'specificity': 0.7794839, 'f1': 0.8296348, 'auroc': 0.98156476, 'binary_precision': 0.9780686, 'binary_recall': 0.9942078, 'binary_specificity': 0.56476, 'binary_f1_score': 0.9860721}
confusion matrix:
     0      1
0  859    662
1  172  29523
---- Validation: 
scalar performance:
{'acc': 0.6533958, 'precision': 0.75610864, 'recall': 0.6584997, 'specificity': 0.6584997, 'f1': 0.61897886, 'auroc': 0.88892543, 'binary_precision': 0.58976835, 'binary_recall': 0.96984124, 'binary_specificity': 0.34715822, 'binary_f1_score': 0.7334934}
confusion matrix:
     0    1
0  226  425
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70711297, 'precision': 0.7891847, 'recall': 0.6906104, 'specificity': 0.6906104, 'f1': 0.6731912, 'auroc': 0.92634165, 'binary_precision': 0.6490765, 'binary_recall': 0.972332, 'binary_specificity': 0.40888888, 'binary_f1_score': 0.77848107}
confusion matrix:
    0    1
0  92  133
1   7  246
early stop counter: 1
val acc:0.6533957719802856, best validation acc: 0.6643247604370117, corresponding to test acc:                         0.7196652889251709 / 0.7196652889251709
after epoch: 9,now: 2024-07-12 18:10:36.732182,epoch time: 0:14:58.624624,used: 2:13:07.137952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.97264224, 'precision': 0.9201209, 'recall': 0.75778055, 'specificity': 0.75778055, 'f1': 0.8174517, 'auroc': 0.98238546, 'binary_precision': 0.9759092, 'binary_recall': 0.99582434, 'binary_specificity': 0.5197368, 'binary_f1_score': 0.9857662}
confusion matrix:
     0      1
0  790    730
1  124  29572
---- Validation: 
scalar performance:
{'acc': 0.62138957, 'precision': 0.74306774, 'recall': 0.6270865, 'specificity': 0.6270865, 'f1': 0.57280535, 'auroc': 0.89119303, 'binary_precision': 0.56694365, 'binary_recall': 0.9746032, 'binary_specificity': 0.2795699, 'binary_f1_score': 0.71687096}
confusion matrix:
     0    1
0  182  469
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69246864, 'precision': 0.7943462, 'recall': 0.6743171, 'specificity': 0.6743171, 'f1': 0.6497121, 'auroc': 0.92751867, 'binary_precision': 0.6352041, 'binary_recall': 0.98418975, 'binary_specificity': 0.36444443, 'binary_f1_score': 0.77209306}
confusion matrix:
    0    1
0  82  143
1   4  249
early stop counter: 2
val acc:0.6213895678520203, best validation acc: 0.6643247604370117, corresponding to test acc:                         0.7196652889251709 / 0.7196652889251709
after epoch: 10,now: 2024-07-12 18:25:41.912962,epoch time: 0:15:05.180780,used: 2:28:12.318732,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97642237, 'precision': 0.91652423, 'recall': 0.8095163, 'specificity': 0.8095163, 'f1': 0.8542403, 'auroc': 0.9820915, 'binary_precision': 0.9810305, 'binary_recall': 0.99444354, 'binary_specificity': 0.6245891, 'binary_f1_score': 0.98769146}
confusion matrix:
     0      1
0  950    571
1  165  29530
---- Validation: 
scalar performance:
{'acc': 0.65105385, 'precision': 0.75477654, 'recall': 0.6561956, 'specificity': 0.6561956, 'f1': 0.61580753, 'auroc': 0.89025676, 'binary_precision': 0.58806545, 'binary_recall': 0.96984124, 'binary_specificity': 0.34254992, 'binary_f1_score': 0.732175}
confusion matrix:
     0    1
0  223  428
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70920503, 'precision': 0.78658223, 'recall': 0.69307864, 'specificity': 0.69307864, 'f1': 0.67696893, 'auroc': 0.92718494, 'binary_precision': 0.6515958, 'binary_recall': 0.96837944, 'binary_specificity': 0.41777778, 'binary_f1_score': 0.7790143}
confusion matrix:
    0    1
0  94  131
1   8  245
early stop counter: 3
val acc:0.6510538458824158, best validation acc: 0.6643247604370117, corresponding to test acc:                         0.7196652889251709 / 0.7196652889251709
after epoch: 11,now: 2024-07-12 18:40:38.576964,epoch time: 0:14:56.664002,used: 2:43:08.982734,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9745964, 'precision': 0.91541314, 'recall': 0.7870359, 'specificity': 0.7870359, 'f1': 0.8381922, 'auroc': 0.98370755, 'binary_precision': 0.9787953, 'binary_recall': 0.9948476, 'binary_specificity': 0.57922417, 'binary_f1_score': 0.9867562}
confusion matrix:
     0      1
0  881    640
1  153  29542
---- Validation: 
scalar performance:
{'acc': 0.6432475, 'precision': 0.75028145, 'recall': 0.6485151, 'specificity': 0.6485151, 'f1': 0.6051302, 'auroc': 0.8915417, 'binary_precision': 0.5824595, 'binary_recall': 0.96984124, 'binary_specificity': 0.32718894, 'binary_f1_score': 0.7278142}
confusion matrix:
     0    1
0  213  438
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70083684, 'precision': 0.7815521, 'recall': 0.68418974, 'specificity': 0.68418974, 'f1': 0.66568357, 'auroc': 0.9280281, 'binary_precision': 0.6447368, 'binary_recall': 0.96837944, 'binary_specificity': 0.4, 'binary_f1_score': 0.7740916}
confusion matrix:
    0    1
0  90  135
1   8  245
early stop counter: 4
val acc:0.6432474851608276, best validation acc: 0.6643247604370117, corresponding to test acc:                         0.7196652889251709 / 0.7196652889251709
after epoch: 12,now: 2024-07-12 18:55:41.255447,epoch time: 0:15:02.678483,used: 2:58:11.661217,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9753652, 'precision': 0.9050803, 'recall': 0.808025, 'specificity': 0.808025, 'f1': 0.8491809, 'auroc': 0.98371965, 'binary_precision': 0.98091376, 'binary_recall': 0.99343324, 'binary_specificity': 0.6226167, 'binary_f1_score': 0.9871338}
confusion matrix:
     0      1
0  947    574
1  195  29500
---- Validation: 
scalar performance:
{'acc': 0.6596409, 'precision': 0.7534877, 'recall': 0.6645417, 'specificity': 0.6645417, 'f1': 0.62884367, 'auroc': 0.89052737, 'binary_precision': 0.595098, 'binary_recall': 0.96349204, 'binary_specificity': 0.3655914, 'binary_f1_score': 0.7357575}
confusion matrix:
     0    1
0  238  413
1   23  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7833967, 'recall': 0.70023715, 'specificity': 0.70023715, 'f1': 0.6870824, 'auroc': 0.9258323, 'binary_precision': 0.6585366, 'binary_recall': 0.9604743, 'binary_specificity': 0.44, 'binary_f1_score': 0.7813505}
confusion matrix:
    0    1
0  99  126
1  10  243
early stop counter: 5
val acc:0.659640908241272, best validation acc: 0.6643247604370117, corresponding to test acc:                         0.7196652889251709 / 0.7196652889251709
after epoch: 13,now: 2024-07-12 19:10:32.887886,epoch time: 0:14:51.632439,used: 3:13:03.293656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_15_57_29_seed_1_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 3:13:03.293656 at 2024-07-12 19:10:32.887886
persisted model performance metric: 

scalar performance:
{'acc': 0.7196653, 'precision': 0.7893389, 'recall': 0.70443565, 'specificity': 0.70443565, 'f1': 0.6916841, 'auroc': 0.9270444, 'binary_precision': 0.6612466, 'binary_recall': 0.9644269, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.78456587}
confusion matrix:
     0    1
0  100  125
1    9  244
oracle model performance metric: 

scalar performance:
{'acc': 0.7196653, 'precision': 0.7893389, 'recall': 0.70443565, 'specificity': 0.70443565, 'f1': 0.6916841, 'auroc': 0.9270444, 'binary_precision': 0.6612466, 'binary_recall': 0.9644269, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.78456587}
confusion matrix:
     0    1
0  100  125
1    9  244
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 213468 GiB | 213468 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 209086 GiB | 209085 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 213468 GiB | 213468 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 209086 GiB | 209085 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 213459 GiB | 213459 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 209084 GiB | 209084 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   4374 GiB |   4374 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37442 KiB |  84596 KiB | 128984 GiB | 128984 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 124493 GiB | 124493 GiB |
|       from small pool |   6136 KiB |  11485 KiB |   4490 GiB |   4490 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4365    |   43718 K  |   43717 K  |
|       from large pool |      76    |     158    |   20612 K  |   20612 K  |
|       from small pool |     718    |    4288    |   23105 K  |   23104 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4365    |   43718 K  |   43717 K  |
|       from large pool |      76    |     158    |   20612 K  |   20612 K  |
|       from small pool |     718    |    4288    |   23105 K  |   23104 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      19    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    1969    |   26979 K  |   26979 K  |
|       from large pool |      10    |      22    |   13546 K  |   13546 K  |
|       from small pool |      26    |    1959    |   13432 K  |   13432 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 213468 GiB | 213468 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 209086 GiB | 209086 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 213468 GiB | 213468 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 209086 GiB | 209086 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 213459 GiB | 213459 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 209084 GiB | 209084 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4374 GiB |   4374 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |    792 MiB | 583680 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  22528 KiB |  38912 KiB |     54 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 128984 GiB | 128984 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 124493 GiB | 124493 GiB |
|       from small pool |      0 KiB |  11485 KiB |   4490 GiB |   4490 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4365    |   43718 K  |   43718 K  |
|       from large pool |       2    |     158    |   20612 K  |   20612 K  |
|       from small pool |       0    |    4288    |   23105 K  |   23105 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4365    |   43718 K  |   43718 K  |
|       from large pool |       2    |     158    |   20612 K  |   20612 K  |
|       from small pool |       0    |    4288    |   23105 K  |   23105 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      60    |      39    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      11    |      19    |      27    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1969    |   26979 K  |   26979 K  |
|       from large pool |       3    |      22    |   13546 K  |   13546 K  |
|       from small pool |       0    |    1959    |   13432 K  |   13432 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 213468 GiB | 213468 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 209086 GiB | 209086 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 213468 GiB | 213468 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 209086 GiB | 209086 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4382 GiB |   4382 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 213459 GiB | 213459 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 209084 GiB | 209084 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4374 GiB |   4374 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |    792 MiB | 583680 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  22528 KiB |  38912 KiB |     54 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 128984 GiB | 128984 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 124493 GiB | 124493 GiB |
|       from small pool |      0 KiB |  11485 KiB |   4490 GiB |   4490 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4365    |   43718 K  |   43718 K  |
|       from large pool |       2    |     158    |   20612 K  |   20612 K  |
|       from small pool |       0    |    4288    |   23105 K  |   23105 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4365    |   43718 K  |   43718 K  |
|       from large pool |       2    |     158    |   20612 K  |   20612 K  |
|       from small pool |       0    |    4288    |   23105 K  |   23105 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      60    |      39    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      11    |      19    |      27    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1969    |   26979 K  |   26979 K  |
|       from large pool |       3    |      22    |   13546 K  |   13546 K  |
|       from small pool |       0    |    1959    |   13432 K  |   13432 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847

 Experiment start at: 2024-07-12 19:24:29.982105
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9532764, 'precision': 0.8627747, 'recall': 0.52306527, 'specificity': 0.52306527, 'f1': 0.5321662, 'auroc': 0.90018463, 'binary_precision': 0.9538103, 'binary_recall': 0.9992967, 'binary_specificity': 0.046833772, 'binary_f1_score': 0.97602385}
confusion matrix:
    0      1
0  71   1445
1  21  29839
---- Validation: 
scalar performance:
{'acc': 0.4945227, 'precision': 0.703594, 'recall': 0.5075803, 'specificity': 0.5075803, 'f1': 0.34538653, 'auroc': 0.8002167, 'binary_precision': 0.49052134, 'binary_recall': 0.9983923, 'binary_specificity': 0.016768293, 'binary_f1_score': 0.65783894}
confusion matrix:
    0    1
0  11  645
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.64534175, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 19:39:29.527084,epoch time: 0:14:59.544979,used: 0:14:59.544979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9606068, 'precision': 0.8756937, 'recall': 0.62459457, 'specificity': 0.62459457, 'f1': 0.68113583, 'auroc': 0.9382255, 'binary_precision': 0.96332145, 'binary_recall': 0.99655056, 'binary_specificity': 0.25263852, 'binary_f1_score': 0.9796543}
confusion matrix:
     0      1
0  383   1133
1  103  29757
---- Validation: 
scalar performance:
{'acc': 0.58685446, 'precision': 0.7286997, 'recall': 0.5970194, 'specificity': 0.5970194, 'f1': 0.5228714, 'auroc': 0.8226242, 'binary_precision': 0.5418149, 'binary_recall': 0.9790997, 'binary_specificity': 0.21493903, 'binary_f1_score': 0.6975945}
confusion matrix:
     0    1
0  141  515
1   13  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.77322096, 'recall': 0.56519914, 'specificity': 0.56519914, 'f1': 0.48436344, 'auroc': 0.7644609, 'binary_precision': 0.5797753, 'binary_recall': 0.996139, 'binary_specificity': 0.13425925, 'binary_f1_score': 0.73295456}
confusion matrix:
    0    1
0  29  187
1   1  258
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 19:54:33.600057,epoch time: 0:15:04.072973,used: 0:30:03.617952,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9637621, 'precision': 0.87925565, 'recall': 0.6675776, 'specificity': 0.6675776, 'f1': 0.7282722, 'auroc': 0.95297694, 'binary_precision': 0.96742064, 'binary_recall': 0.99544543, 'binary_specificity': 0.33970976, 'binary_f1_score': 0.98123294}
confusion matrix:
     0      1
0  515   1001
1  136  29724
---- Validation: 
scalar performance:
{'acc': 0.6064163, 'precision': 0.7296996, 'recall': 0.61586595, 'specificity': 0.61586595, 'f1': 0.55537677, 'auroc': 0.8403802, 'binary_precision': 0.55463725, 'binary_recall': 0.9710611, 'binary_specificity': 0.26067072, 'binary_f1_score': 0.7060198}
confusion matrix:
     0    1
0  171  485
1   18  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6315789, 'precision': 0.7671505, 'recall': 0.59606034, 'specificity': 0.59606034, 'f1': 0.539935, 'auroc': 0.8182111, 'binary_precision': 0.5981308, 'binary_recall': 0.98841697, 'binary_specificity': 0.2037037, 'binary_f1_score': 0.74526924}
confusion matrix:
    0    1
0  44  172
1   3  256
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 20:09:27.832836,epoch time: 0:14:54.232779,used: 0:44:57.850731,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9659294, 'precision': 0.88269687, 'recall': 0.69595337, 'specificity': 0.69595337, 'f1': 0.7560104, 'auroc': 0.96143776, 'binary_precision': 0.9701493, 'binary_recall': 0.9948091, 'binary_specificity': 0.39709762, 'binary_f1_score': 0.9823244}
confusion matrix:
     0      1
0  602    914
1  155  29705
---- Validation: 
scalar performance:
{'acc': 0.6314554, 'precision': 0.73795176, 'recall': 0.6400895, 'specificity': 0.6400895, 'f1': 0.59296477, 'auroc': 0.8536439, 'binary_precision': 0.5719733, 'binary_recall': 0.96463025, 'binary_specificity': 0.31554878, 'binary_f1_score': 0.7181329}
confusion matrix:
     0    1
0  207  449
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65052634, 'precision': 0.76435745, 'recall': 0.6176623, 'specificity': 0.6176623, 'f1': 0.57613, 'auroc': 0.8536215, 'binary_precision': 0.6120482, 'binary_recall': 0.980695, 'binary_specificity': 0.25462964, 'binary_f1_score': 0.7537092}
confusion matrix:
    0    1
0  55  161
1   5  254
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 20:24:39.422433,epoch time: 0:15:11.589597,used: 1:00:09.440328,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9670449, 'precision': 0.8729465, 'recall': 0.72158504, 'specificity': 0.72158504, 'f1': 0.77583754, 'auroc': 0.96844786, 'binary_precision': 0.97265035, 'binary_recall': 0.99330205, 'binary_specificity': 0.44986808, 'binary_f1_score': 0.9828677}
confusion matrix:
     0      1
0  682    834
1  200  29660
---- Validation: 
scalar performance:
{'acc': 0.6651017, 'precision': 0.75216866, 'recall': 0.67269725, 'specificity': 0.67269725, 'f1': 0.63926876, 'auroc': 0.8630255, 'binary_precision': 0.5971944, 'binary_recall': 0.9581994, 'binary_specificity': 0.3871951, 'binary_f1_score': 0.73580253}
confusion matrix:
     0    1
0  254  402
1   26  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6652632, 'precision': 0.75739455, 'recall': 0.63501894, 'specificity': 0.63501894, 'f1': 0.6046412, 'auroc': 0.87596524, 'binary_precision': 0.6243781, 'binary_recall': 0.969112, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.7594553}
confusion matrix:
    0    1
0  65  151
1   8  251
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-12 20:40:46.589947,epoch time: 0:16:07.167514,used: 1:16:16.607842,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9701364, 'precision': 0.88895893, 'recall': 0.7501334, 'specificity': 0.7501334, 'f1': 0.80278176, 'auroc': 0.971285, 'binary_precision': 0.9754101, 'binary_recall': 0.99367046, 'binary_specificity': 0.5065963, 'binary_f1_score': 0.9844556}
confusion matrix:
     0      1
0  768    748
1  189  29671
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.7526144, 'recall': 0.6712145, 'specificity': 0.6712145, 'f1': 0.63692415, 'auroc': 0.8660816, 'binary_precision': 0.5958084, 'binary_recall': 0.9598071, 'binary_specificity': 0.38262194, 'binary_f1_score': 0.73522174}
confusion matrix:
     0    1
0  251  405
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67368424, 'precision': 0.7633786, 'recall': 0.6442782, 'specificity': 0.6442782, 'f1': 0.6175344, 'auroc': 0.88517094, 'binary_precision': 0.63065326, 'binary_recall': 0.969112, 'binary_specificity': 0.31944445, 'binary_f1_score': 0.7640791}
confusion matrix:
    0    1
0  69  147
1   8  251
new oracle model saved
early stop counter: 1
val acc:0.663536787033081, best validation acc: 0.6651017069816589, corresponding to test acc:                         0.6652631759643555 / 0.6736842393875122
after epoch: 6,now: 2024-07-12 20:57:07.685276,epoch time: 0:16:21.095329,used: 1:32:37.703171,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9710926, 'precision': 0.89864427, 'recall': 0.7537664, 'specificity': 0.7537664, 'f1': 0.8083528, 'auroc': 0.9755058, 'binary_precision': 0.9757468, 'binary_recall': 0.99434024, 'binary_specificity': 0.5131926, 'binary_f1_score': 0.9849558}
confusion matrix:
     0      1
0  778    738
1  169  29691
---- Validation: 
scalar performance:
{'acc': 0.64632237, 'precision': 0.74690735, 'recall': 0.65457124, 'specificity': 0.65457124, 'f1': 0.61319613, 'auroc': 0.8697332, 'binary_precision': 0.5825243, 'binary_recall': 0.96463025, 'binary_specificity': 0.3445122, 'binary_f1_score': 0.7263923}
confusion matrix:
     0    1
0  226  430
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6631579, 'precision': 0.75585884, 'recall': 0.63270414, 'specificity': 0.63270414, 'f1': 0.6013763, 'auroc': 0.89235663, 'binary_precision': 0.6228288, 'binary_recall': 0.969112, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7583082}
confusion matrix:
    0    1
0  64  152
1   8  251
early stop counter: 2
val acc:0.6463223695755005, best validation acc: 0.6651017069816589, corresponding to test acc:                         0.6652631759643555 / 0.6736842393875122
after epoch: 7,now: 2024-07-12 21:13:06.792802,epoch time: 0:15:59.107526,used: 1:48:36.810697,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9725905, 'precision': 0.89169025, 'recall': 0.78210366, 'specificity': 0.78210366, 'f1': 0.82695735, 'auroc': 0.9780066, 'binary_precision': 0.9785479, 'binary_recall': 0.9929672, 'binary_specificity': 0.5712401, 'binary_f1_score': 0.9857048}
confusion matrix:
     0      1
0  866    650
1  210  29650
---- Validation: 
scalar performance:
{'acc': 0.672144, 'precision': 0.7563318, 'recall': 0.679557, 'specificity': 0.679557, 'f1': 0.64826345, 'auroc': 0.87317663, 'binary_precision': 0.60262895, 'binary_recall': 0.9581994, 'binary_specificity': 0.40091464, 'binary_f1_score': 0.73991317}
confusion matrix:
     0    1
0  263  393
1   26  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.7631881, 'recall': 0.651607, 'specificity': 0.651607, 'f1': 0.62840205, 'auroc': 0.8987559, 'binary_precision': 0.6361323, 'binary_recall': 0.96525097, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.7668712}
confusion matrix:
    0    1
0  73  143
1   9  250
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 21:29:18.378621,epoch time: 0:16:11.585819,used: 2:04:48.396516,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9711563, 'precision': 0.9014996, 'recall': 0.75192153, 'specificity': 0.75192153, 'f1': 0.807727, 'auroc': 0.97948205, 'binary_precision': 0.9755609, 'binary_recall': 0.99460816, 'binary_specificity': 0.50923485, 'binary_f1_score': 0.9849925}
confusion matrix:
     0      1
0  772    744
1  161  29699
---- Validation: 
scalar performance:
{'acc': 0.64319247, 'precision': 0.7403697, 'recall': 0.65139747, 'specificity': 0.65139747, 'f1': 0.6101626, 'auroc': 0.8762156, 'binary_precision': 0.5807393, 'binary_recall': 0.9598071, 'binary_specificity': 0.3429878, 'binary_f1_score': 0.7236364}
confusion matrix:
     0    1
0  225  431
1   25  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67157894, 'precision': 0.7619047, 'recall': 0.64196336, 'specificity': 0.64196336, 'f1': 0.6143357, 'auroc': 0.9029386, 'binary_precision': 0.62907267, 'binary_recall': 0.969112, 'binary_specificity': 0.3148148, 'binary_f1_score': 0.76291794}
confusion matrix:
    0    1
0  68  148
1   8  251
early stop counter: 1
val acc:0.6431924700737, best validation acc: 0.6721439957618713, corresponding to test acc:                         0.6800000071525574 / 0.6800000071525574
after epoch: 9,now: 2024-07-12 21:45:11.490081,epoch time: 0:15:53.111460,used: 2:20:41.507976,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9721443, 'precision': 0.89998174, 'recall': 0.7668418, 'specificity': 0.7668418, 'f1': 0.8186424, 'auroc': 0.97943807, 'binary_precision': 0.97702587, 'binary_recall': 0.9941058, 'binary_specificity': 0.53957784, 'binary_f1_score': 0.9854919}
confusion matrix:
     0      1
0  818    698
1  176  29684
---- Validation: 
scalar performance:
{'acc': 0.63928014, 'precision': 0.741096, 'recall': 0.6476698, 'specificity': 0.6476698, 'f1': 0.6040932, 'auroc': 0.8792963, 'binary_precision': 0.5776278, 'binary_recall': 0.96302253, 'binary_specificity': 0.33231708, 'binary_f1_score': 0.7221218}
confusion matrix:
     0    1
0  218  438
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67157894, 'precision': 0.7619047, 'recall': 0.64196336, 'specificity': 0.64196336, 'f1': 0.6143357, 'auroc': 0.9062456, 'binary_precision': 0.62907267, 'binary_recall': 0.969112, 'binary_specificity': 0.3148148, 'binary_f1_score': 0.76291794}
confusion matrix:
    0    1
0  68  148
1   8  251
early stop counter: 2
val acc:0.6392801403999329, best validation acc: 0.6721439957618713, corresponding to test acc:                         0.6800000071525574 / 0.6800000071525574
after epoch: 10,now: 2024-07-12 22:00:56.830591,epoch time: 0:15:45.340510,used: 2:36:26.848486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9723355, 'precision': 0.9166813, 'recall': 0.7541064, 'specificity': 0.7541064, 'f1': 0.81361544, 'auroc': 0.9813807, 'binary_precision': 0.97574663, 'binary_recall': 0.99567986, 'binary_specificity': 0.512533, 'binary_f1_score': 0.98561245}
confusion matrix:
     0      1
0  777    739
1  129  29731
---- Validation: 
scalar performance:
{'acc': 0.63067293, 'precision': 0.7463865, 'recall': 0.63953567, 'specificity': 0.63953567, 'f1': 0.589668, 'auroc': 0.8808868, 'binary_precision': 0.5707547, 'binary_recall': 0.9726688, 'binary_specificity': 0.30640244, 'binary_f1_score': 0.7193817}
confusion matrix:
     0    1
0  201  455
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6673684, 'precision': 0.7694886, 'recall': 0.63656515, 'specificity': 0.63656515, 'f1': 0.60480034, 'auroc': 0.90890884, 'binary_precision': 0.62469137, 'binary_recall': 0.976834, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.76204824}
confusion matrix:
    0    1
0  64  152
1   6  253
early stop counter: 3
val acc:0.6306729316711426, best validation acc: 0.6721439957618713, corresponding to test acc:                         0.6800000071525574 / 0.6800000071525574
after epoch: 11,now: 2024-07-12 22:16:42.068063,epoch time: 0:15:45.237472,used: 2:52:12.085958,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9748215, 'precision': 0.9008992, 'recall': 0.80268615, 'specificity': 0.80268615, 'f1': 0.8441464, 'auroc': 0.9815968, 'binary_precision': 0.9805594, 'binary_recall': 0.9932351, 'binary_specificity': 0.6121372, 'binary_f1_score': 0.9868566}
confusion matrix:
     0      1
0  928    588
1  202  29658
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.7489545, 'recall': 0.65537506, 'specificity': 0.65537506, 'f1': 0.6138582, 'auroc': 0.88172257, 'binary_precision': 0.5829292, 'binary_recall': 0.96623796, 'binary_specificity': 0.3445122, 'binary_f1_score': 0.7271628}
confusion matrix:
     0    1
0  226  430
1   21  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67368424, 'precision': 0.7586945, 'recall': 0.6446625, 'specificity': 0.6446625, 'f1': 0.61896753, 'auroc': 0.90987414, 'binary_precision': 0.63131315, 'binary_recall': 0.96525097, 'binary_specificity': 0.32407406, 'binary_f1_score': 0.7633588}
confusion matrix:
    0    1
0  70  146
1   9  250
early stop counter: 4
val acc:0.6471048593521118, best validation acc: 0.6721439957618713, corresponding to test acc:                         0.6800000071525574 / 0.6800000071525574
after epoch: 12,now: 2024-07-12 22:32:49.689171,epoch time: 0:16:07.621108,used: 3:08:19.707066,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9756502, 'precision': 0.91116536, 'recall': 0.80249536, 'specificity': 0.80249536, 'f1': 0.8476232, 'auroc': 0.98148394, 'binary_precision': 0.9805126, 'binary_recall': 0.9941728, 'binary_specificity': 0.61081797, 'binary_f1_score': 0.98729545}
confusion matrix:
     0      1
0  926    590
1  174  29686
---- Validation: 
scalar performance:
{'acc': 0.63928014, 'precision': 0.74948215, 'recall': 0.6478781, 'specificity': 0.6478781, 'f1': 0.60202867, 'auroc': 0.8832003, 'binary_precision': 0.57688636, 'binary_recall': 0.9710611, 'binary_specificity': 0.3246951, 'binary_f1_score': 0.7237868}
confusion matrix:
     0    1
0  213  443
1   18  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6652632, 'precision': 0.7525, 'recall': 0.6354033, 'specificity': 0.6354033, 'f1': 0.6061668, 'auroc': 0.91155446, 'binary_precision': 0.625, 'binary_recall': 0.96525097, 'binary_specificity': 0.30555555, 'binary_f1_score': 0.75872535}
confusion matrix:
    0    1
0  66  150
1   9  250
early stop counter: 5
val acc:0.6392801403999329, best validation acc: 0.6721439957618713, corresponding to test acc:                         0.6800000071525574 / 0.6800000071525574
after epoch: 13,now: 2024-07-12 22:48:29.500739,epoch time: 0:15:39.811568,used: 3:23:59.518634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_24_29_seed_2_21918847
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 3:23:59.518634 at 2024-07-12 22:48:29.500739
persisted model performance metric: 

scalar performance:
{'acc': 0.68, 'precision': 0.7631881, 'recall': 0.651607, 'specificity': 0.651607, 'f1': 0.62840205, 'auroc': 0.8987559, 'binary_precision': 0.6361323, 'binary_recall': 0.96525097, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.7668712}
confusion matrix:
    0    1
0  73  143
1   9  250
oracle model performance metric: 

scalar performance:
{'acc': 0.68, 'precision': 0.7631881, 'recall': 0.651607, 'specificity': 0.651607, 'f1': 0.62840205, 'auroc': 0.8987559, 'binary_precision': 0.6361323, 'binary_recall': 0.96525097, 'binary_specificity': 0.33796296, 'binary_f1_score': 0.7668712}
confusion matrix:
    0    1
0  73  143
1   9  250
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 345180 GiB | 345180 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 338095 GiB | 338095 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   7085 GiB |   7085 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 345180 GiB | 345180 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 338095 GiB | 338095 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   7085 GiB |   7085 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 345167 GiB | 345166 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 338093 GiB | 338093 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   7073 GiB |   7073 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1084 MiB | 583680 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     70 MiB |  32768 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37442 KiB | 104341 KiB | 212102 GiB | 212102 GiB |
|       from large pool |  31306 KiB | 100062 KiB | 204841 GiB | 204841 GiB |
|       from small pool |   6136 KiB |  11485 KiB |   7260 GiB |   7260 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4385    |   70760 K  |   70760 K  |
|       from large pool |      76    |     158    |   33330 K  |   33330 K  |
|       from small pool |     718    |    4308    |   37430 K  |   37429 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4385    |   70760 K  |   70760 K  |
|       from large pool |      76    |     158    |   33330 K  |   33330 K  |
|       from small pool |     718    |    4308    |   37430 K  |   37429 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      80    |      39    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      19    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      35    |    1980    |   43548 K  |   43548 K  |
|       from large pool |      10    |      22    |   21841 K  |   21841 K  |
|       from small pool |      25    |    1970    |   21706 K  |   21706 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 345180 GiB | 345180 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 338095 GiB | 338095 GiB |
|       from small pool |      0 KiB |  33617 KiB |   7085 GiB |   7085 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 345180 GiB | 345180 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 338095 GiB | 338095 GiB |
|       from small pool |      0 KiB |  33617 KiB |   7085 GiB |   7085 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 345167 GiB | 345166 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 338093 GiB | 338093 GiB |
|       from small pool |      0 KiB |  33425 KiB |   7073 GiB |   7073 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |   1084 MiB |    862 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  38912 KiB |     70 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 104341 KiB | 212102 GiB | 212102 GiB |
|       from large pool |  23872 KiB | 100062 KiB | 204841 GiB | 204841 GiB |
|       from small pool |      0 KiB |  11485 KiB |   7260 GiB |   7260 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |   70760 K  |   70760 K  |
|       from large pool |       2    |     158    |   33330 K  |   33330 K  |
|       from small pool |       0    |    4308    |   37430 K  |   37430 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |   70760 K  |   70760 K  |
|       from large pool |       2    |     158    |   33330 K  |   33330 K  |
|       from small pool |       0    |    4308    |   37430 K  |   37430 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      80    |      59    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      19    |      35    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1980    |   43548 K  |   43548 K  |
|       from large pool |       3    |      22    |   21841 K  |   21841 K  |
|       from small pool |       0    |    1970    |   21706 K  |   21706 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 22:56:35 2024]
Finished job 0.
1 of 1 steps (100%) done
