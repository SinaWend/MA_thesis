Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 07:03:42 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843

 Experiment start at: 2024-07-12 07:10:53.935419
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92579734, 'precision': 0.505851, 'recall': 0.50352776, 'specificity': 0.50352776, 'f1': 0.50305074, 'auroc': 0.44479877, 'binary_precision': 0.9515013, 'binary_recall': 0.9715058, 'binary_specificity': 0.035549704, 'binary_f1_score': 0.9613995}
confusion matrix:
     0      1
0   54   1465
1  843  28742
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5496894, 'precision': 0.73129034, 'recall': 0.5557873, 'specificity': 0.5557873, 'f1': 0.44836956, 'auroc': 0.73046756, 'binary_precision': 0.5228216, 'binary_recall': 0.992126, 'binary_specificity': 0.1194487, 'binary_f1_score': 0.68478256}
confusion matrix:
    0    1
0  78  575
1   5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5670103, 'precision': 0.6152482, 'recall': 0.51399654, 'specificity': 0.51399654, 'f1': 0.40158635, 'auroc': 0.64770025, 'binary_precision': 0.5638298, 'binary_recall': 0.9814815, 'binary_specificity': 0.046511628, 'binary_f1_score': 0.7162162}
confusion matrix:
    0    1
0  10  205
1   5  265
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 07:20:40.970552,epoch time: 0:09:47.035133,used: 0:09:47.035133,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94839895, 'precision': 0.5578512, 'recall': 0.5051041, 'specificity': 0.5051041, 'f1': 0.49949932, 'auroc': 0.5360799, 'binary_precision': 0.95163995, 'binary_recall': 0.9963833, 'binary_specificity': 0.013824885, 'binary_f1_score': 0.97349775}
confusion matrix:
     0      1
0   21   1498
1  107  29478
---- Validation: 
scalar performance:
{'acc': 0.51475155, 'precision': 0.72074044, 'recall': 0.5213961, 'specificity': 0.5213961, 'f1': 0.37853914, 'auroc': 0.76804817, 'binary_precision': 0.5039809, 'binary_recall': 0.9968504, 'binary_specificity': 0.045941807, 'binary_f1_score': 0.66948706}
confusion matrix:
    0    1
0  30  623
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56494844, 'precision': 0.7806653, 'recall': 0.5093023, 'specificity': 0.5093023, 'f1': 0.37778547, 'auroc': 0.687907, 'binary_precision': 0.56133056, 'binary_recall': 1.0, 'binary_specificity': 0.018604651, 'binary_f1_score': 0.7190413}
confusion matrix:
   0    1
0  4  211
1  0  270
early stop counter: 1
val acc:0.5147515535354614, best validation acc: 0.5496894121170044, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 2,now: 2024-07-12 07:30:19.687957,epoch time: 0:09:38.717405,used: 0:19:25.752538,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94945985, 'precision': 0.5580077, 'recall': 0.5031637, 'specificity': 0.5031637, 'f1': 0.49516702, 'auroc': 0.64156485, 'binary_precision': 0.9514585, 'binary_recall': 0.9977691, 'binary_specificity': 0.008558262, 'binary_f1_score': 0.9740637}
confusion matrix:
    0      1
0  13   1506
1  66  29519
---- Validation: 
scalar performance:
{'acc': 0.51552796, 'precision': 0.7521843, 'recall': 0.52220523, 'specificity': 0.52220523, 'f1': 0.37779126, 'auroc': 0.79491377, 'binary_precision': 0.50436854, 'binary_recall': 1.0, 'binary_specificity': 0.044410415, 'binary_f1_score': 0.67053854}
confusion matrix:
    0    1
0  29  624
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56082475, 'precision': 0.7795031, 'recall': 0.5046512, 'specificity': 0.5046512, 'f1': 0.36778232, 'auroc': 0.72768307, 'binary_precision': 0.5590062, 'binary_recall': 1.0, 'binary_specificity': 0.009302326, 'binary_f1_score': 0.7171315}
confusion matrix:
   0    1
0  2  213
1  0  270
early stop counter: 2
val acc:0.5155279636383057, best validation acc: 0.5496894121170044, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 3,now: 2024-07-12 07:39:58.266681,epoch time: 0:09:38.578724,used: 0:29:04.331262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9499743, 'precision': 0.58344865, 'recall': 0.5037464, 'specificity': 0.5037464, 'f1': 0.49600518, 'auroc': 0.7450848, 'binary_precision': 0.95151263, 'binary_recall': 0.9982762, 'binary_specificity': 0.00921659, 'binary_f1_score': 0.9743336}
confusion matrix:
    0      1
0  14   1505
1  51  29534
---- Validation: 
scalar performance:
{'acc': 0.5256211, 'precision': 0.7548154, 'recall': 0.53215927, 'specificity': 0.53215927, 'f1': 0.39801803, 'auroc': 0.81319654, 'binary_precision': 0.5096308, 'binary_recall': 1.0, 'binary_specificity': 0.06431853, 'binary_f1_score': 0.67517275}
confusion matrix:
    0    1
0  42  611
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56082475, 'precision': 0.7795031, 'recall': 0.5046512, 'specificity': 0.5046512, 'f1': 0.36778232, 'auroc': 0.75896645, 'binary_precision': 0.5590062, 'binary_recall': 1.0, 'binary_specificity': 0.009302326, 'binary_f1_score': 0.7171315}
confusion matrix:
   0    1
0  2  213
1  0  270
early stop counter: 3
val acc:0.5256211161613464, best validation acc: 0.5496894121170044, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 4,now: 2024-07-12 07:49:36.894776,epoch time: 0:09:38.628095,used: 0:38:42.959357,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9513567, 'precision': 0.7464385, 'recall': 0.51259196, 'specificity': 0.51259196, 'f1': 0.51262945, 'auroc': 0.80920076, 'binary_precision': 0.95233643, 'binary_recall': 0.99885076, 'binary_specificity': 0.026333114, 'binary_f1_score': 0.9750392}
confusion matrix:
    0      1
0  40   1479
1  34  29551
---- Validation: 
scalar performance:
{'acc': 0.53959626, 'precision': 0.75049996, 'recall': 0.5459201, 'specificity': 0.5459201, 'f1': 0.42599174, 'auroc': 0.82414234, 'binary_precision': 0.5171289, 'binary_recall': 0.9984252, 'binary_specificity': 0.09341501, 'binary_f1_score': 0.6813541}
confusion matrix:
    0    1
0  61  592
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5628866, 'precision': 0.780083, 'recall': 0.5069767, 'specificity': 0.5069767, 'f1': 0.37280402, 'auroc': 0.779845, 'binary_precision': 0.560166, 'binary_recall': 1.0, 'binary_specificity': 0.013953488, 'binary_f1_score': 0.7180851}
confusion matrix:
   0    1
0  3  212
1  0  270
early stop counter: 4
val acc:0.5395962595939636, best validation acc: 0.5496894121170044, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 5,now: 2024-07-12 07:59:16.000265,epoch time: 0:09:39.105489,used: 0:48:22.064846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95122814, 'precision': 0.7320374, 'recall': 0.5137734, 'specificity': 0.5137734, 'f1': 0.5148985, 'auroc': 0.8531827, 'binary_precision': 0.95244694, 'binary_recall': 0.99858034, 'binary_specificity': 0.028966425, 'binary_f1_score': 0.97496825}
confusion matrix:
    0      1
0  44   1475
1  42  29543
---- Validation: 
scalar performance:
{'acc': 0.56055903, 'precision': 0.753422, 'recall': 0.5665722, 'specificity': 0.5665722, 'f1': 0.46514767, 'auroc': 0.8298947, 'binary_precision': 0.52882206, 'binary_recall': 0.9968504, 'binary_specificity': 0.13629402, 'binary_f1_score': 0.691048}
confusion matrix:
    0    1
0  89  564
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5690722, 'precision': 0.78183717, 'recall': 0.5139535, 'specificity': 0.5139535, 'f1': 0.38762996, 'auroc': 0.7930405, 'binary_precision': 0.56367433, 'binary_recall': 1.0, 'binary_specificity': 0.027906977, 'binary_f1_score': 0.7209613}
confusion matrix:
   0    1
0  6  209
1  0  270
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-12 08:08:58.715259,epoch time: 0:09:42.714994,used: 0:58:04.779840,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95187116, 'precision': 0.7746092, 'recall': 0.5197253, 'specificity': 0.5197253, 'f1': 0.52589387, 'auroc': 0.8719779, 'binary_precision': 0.9530645, 'binary_recall': 0.99858046, 'binary_specificity': 0.040870138, 'binary_f1_score': 0.9752918}
confusion matrix:
    0      1
0  62   1455
1  42  29545
---- Validation: 
scalar performance:
{'acc': 0.57608694, 'precision': 0.75157714, 'recall': 0.5818427, 'specificity': 0.5818427, 'f1': 0.4935357, 'auroc': 0.83358693, 'binary_precision': 0.5379369, 'binary_recall': 0.9937008, 'binary_specificity': 0.16998468, 'binary_f1_score': 0.6980089}
confusion matrix:
     0    1
0  111  542
1    4  631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5752577, 'precision': 0.78361344, 'recall': 0.52093023, 'specificity': 0.52093023, 'f1': 0.40210885, 'auroc': 0.8038243, 'binary_precision': 0.5672269, 'binary_recall': 1.0, 'binary_specificity': 0.041860465, 'binary_f1_score': 0.72386056}
confusion matrix:
   0    1
0  9  206
1  0  270
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 08:18:38.161624,epoch time: 0:09:39.446365,used: 1:07:44.226205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9522891, 'precision': 0.7926226, 'recall': 0.5268217, 'specificity': 0.5268217, 'f1': 0.5385943, 'auroc': 0.8907316, 'binary_precision': 0.9536663, 'binary_recall': 0.99834377, 'binary_specificity': 0.05529954, 'binary_f1_score': 0.9754937}
confusion matrix:
    0      1
0  84   1435
1  49  29536
---- Validation: 
scalar performance:
{'acc': 0.58928573, 'precision': 0.74768114, 'recall': 0.59479445, 'specificity': 0.59479445, 'f1': 0.5174339, 'auroc': 0.8364978, 'binary_precision': 0.54608697, 'binary_recall': 0.98897636, 'binary_specificity': 0.20061256, 'binary_f1_score': 0.7036415}
confusion matrix:
     0    1
0  131  522
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58762884, 'precision': 0.7579814, 'recall': 0.5353575, 'specificity': 0.5353575, 'f1': 0.43346417, 'auroc': 0.81298876, 'binary_precision': 0.5747863, 'binary_recall': 0.9962963, 'binary_specificity': 0.074418604, 'binary_f1_score': 0.7289973}
confusion matrix:
    0    1
0  16  199
1   1  269
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 08:28:19.684778,epoch time: 0:09:41.523154,used: 1:17:25.749359,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9540895, 'precision': 0.82583344, 'recall': 0.5515179, 'specificity': 0.5515179, 'f1': 0.5797237, 'auroc': 0.89246035, 'binary_precision': 0.95601475, 'binary_recall': 0.997634, 'binary_specificity': 0.105401844, 'binary_f1_score': 0.976381}
confusion matrix:
     0      1
0  160   1358
1   70  29516
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.7496525, 'recall': 0.6039611, 'specificity': 0.6039611, 'f1': 0.5329193, 'auroc': 0.8372165, 'binary_precision': 0.5519366, 'binary_recall': 0.98740155, 'binary_specificity': 0.22052068, 'binary_f1_score': 0.70807457}
confusion matrix:
     0    1
0  144  509
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103093, 'precision': 0.7764536, 'recall': 0.56093884, 'specificity': 0.56093884, 'f1': 0.48112482, 'auroc': 0.8172093, 'binary_precision': 0.58862144, 'binary_recall': 0.9962963, 'binary_specificity': 0.1255814, 'binary_f1_score': 0.7400274}
confusion matrix:
    0    1
0  27  188
1   1  269
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 08:37:59.145296,epoch time: 0:09:39.460518,used: 1:27:05.209877,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.955697, 'precision': 0.8495467, 'recall': 0.5695494, 'specificity': 0.5695494, 'f1': 0.60750866, 'auroc': 0.9032142, 'binary_precision': 0.957714, 'binary_recall': 0.997465, 'binary_specificity': 0.14163373, 'binary_f1_score': 0.9771854}
confusion matrix:
     0      1
0  215   1303
1   75  29511
---- Validation: 
scalar performance:
{'acc': 0.6032609, 'precision': 0.74404347, 'recall': 0.60849017, 'specificity': 0.60849017, 'f1': 0.5420175, 'auroc': 0.8378556, 'binary_precision': 0.55516016, 'binary_recall': 0.98267716, 'binary_specificity': 0.23430322, 'binary_f1_score': 0.70949405}
confusion matrix:
     0    1
0  153  500
1   11  624
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6226804, 'precision': 0.7706632, 'recall': 0.5753661, 'specificity': 0.5753661, 'f1': 0.50819814, 'auroc': 0.82036173, 'binary_precision': 0.596882, 'binary_recall': 0.9925926, 'binary_specificity': 0.15813954, 'binary_f1_score': 0.7454799}
confusion matrix:
    0    1
0  34  181
1   2  268
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-12 08:47:38.400703,epoch time: 0:09:39.255407,used: 1:36:44.465284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9576582, 'precision': 0.8437395, 'recall': 0.60458726, 'specificity': 0.60458726, 'f1': 0.65395474, 'auroc': 0.9147396, 'binary_precision': 0.9610216, 'binary_recall': 0.9958763, 'binary_specificity': 0.21329822, 'binary_f1_score': 0.97813857}
confusion matrix:
     0      1
0  324   1195
1  122  29463
---- Validation: 
scalar performance:
{'acc': 0.61413044, 'precision': 0.7432065, 'recall': 0.61914486, 'specificity': 0.61914486, 'f1': 0.56020814, 'auroc': 0.8381932, 'binary_precision': 0.5625, 'binary_recall': 0.9779528, 'binary_specificity': 0.2603369, 'binary_f1_score': 0.7142036}
confusion matrix:
     0    1
0  170  483
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6371134, 'precision': 0.7700758, 'recall': 0.59211886, 'specificity': 0.59211886, 'f1': 0.5375948, 'auroc': 0.82341087, 'binary_precision': 0.6068182, 'binary_recall': 0.98888886, 'binary_specificity': 0.19534884, 'binary_f1_score': 0.7521127}
confusion matrix:
    0    1
0  42  173
1   3  267
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-12 08:57:18.867507,epoch time: 0:09:40.466804,used: 1:46:24.932088,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9589442, 'precision': 0.85151947, 'recall': 0.6200033, 'specificity': 0.6200033, 'f1': 0.673146, 'auroc': 0.9170613, 'binary_precision': 0.96252, 'binary_recall': 0.995606, 'binary_specificity': 0.24440053, 'binary_f1_score': 0.9787834}
confusion matrix:
     0      1
0  371   1147
1  130  29456
---- Validation: 
scalar performance:
{'acc': 0.6273292, 'precision': 0.74876845, 'recall': 0.63214, 'specificity': 0.63214, 'f1': 0.5800913, 'auroc': 0.83974385, 'binary_precision': 0.5714286, 'binary_recall': 0.97637796, 'binary_specificity': 0.287902, 'binary_f1_score': 0.7209303}
confusion matrix:
     0    1
0  188  465
1   15  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6453608, 'precision': 0.7755804, 'recall': 0.6014212, 'specificity': 0.6014212, 'f1': 0.5524294, 'auroc': 0.8276485, 'binary_precision': 0.61238533, 'binary_recall': 0.98888886, 'binary_specificity': 0.2139535, 'binary_f1_score': 0.75637394}
confusion matrix:
    0    1
0  46  169
1   3  267
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-12 09:07:04.358310,epoch time: 0:09:45.490803,used: 1:56:10.422891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9595872, 'precision': 0.8523362, 'recall': 0.6297157, 'specificity': 0.6297157, 'f1': 0.68430567, 'auroc': 0.919247, 'binary_precision': 0.9634525, 'binary_recall': 0.99526805, 'binary_specificity': 0.26416337, 'binary_f1_score': 0.97910184}
confusion matrix:
     0      1
0  401   1117
1  140  29446
---- Validation: 
scalar performance:
{'acc': 0.6319876, 'precision': 0.7456512, 'recall': 0.63666904, 'specificity': 0.63666904, 'f1': 0.58819973, 'auroc': 0.84101486, 'binary_precision': 0.5750233, 'binary_recall': 0.9716535, 'binary_specificity': 0.30168453, 'binary_f1_score': 0.7224824}
confusion matrix:
     0    1
0  197  456
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6515464, 'precision': 0.77946794, 'recall': 0.6083979, 'specificity': 0.6083979, 'f1': 0.5633215, 'auroc': 0.8311628, 'binary_precision': 0.61662817, 'binary_recall': 0.98888886, 'binary_specificity': 0.22790697, 'binary_f1_score': 0.7596017}
confusion matrix:
    0    1
0  49  166
1   3  267
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 09:16:47.682703,epoch time: 0:09:43.324393,used: 2:05:53.747284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9603267, 'precision': 0.84541595, 'recall': 0.6470604, 'specificity': 0.6470604, 'f1': 0.7019478, 'auroc': 0.9247496, 'binary_precision': 0.96515405, 'binary_recall': 0.99418664, 'binary_specificity': 0.2999341, 'binary_f1_score': 0.9794553}
confusion matrix:
     0      1
0  455   1062
1  172  29415
---- Validation: 
scalar performance:
{'acc': 0.6413044, 'precision': 0.7493557, 'recall': 0.6458357, 'specificity': 0.6458357, 'f1': 0.60173166, 'auroc': 0.84194815, 'binary_precision': 0.58168083, 'binary_recall': 0.97007877, 'binary_specificity': 0.32159266, 'binary_f1_score': 0.72727275}
confusion matrix:
     0    1
0  210  443
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.78560007, 'recall': 0.6200258, 'specificity': 0.6200258, 'f1': 0.5810509, 'auroc': 0.8338846, 'binary_precision': 0.62383175, 'binary_recall': 0.98888886, 'binary_specificity': 0.2511628, 'binary_f1_score': 0.76504296}
confusion matrix:
    0    1
0  54  161
1   3  267
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-12 09:26:27.233165,epoch time: 0:09:39.550462,used: 2:15:33.297746,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9614841, 'precision': 0.8651389, 'recall': 0.64977413, 'specificity': 0.64977413, 'f1': 0.7077501, 'auroc': 0.924168, 'binary_precision': 0.96537703, 'binary_recall': 0.99520046, 'binary_specificity': 0.3043478, 'binary_f1_score': 0.9800619}
confusion matrix:
     0      1
0  462   1056
1  142  29444
---- Validation: 
scalar performance:
{'acc': 0.64518636, 'precision': 0.75162184, 'recall': 0.64966416, 'specificity': 0.64966416, 'f1': 0.60710293, 'auroc': 0.8426306, 'binary_precision': 0.58444023, 'binary_recall': 0.97007877, 'binary_specificity': 0.32924962, 'binary_f1_score': 0.7294257}
confusion matrix:
     0    1
0  215  438
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66391754, 'precision': 0.77960783, 'recall': 0.62282515, 'specificity': 0.62282515, 'f1': 0.58637017, 'auroc': 0.8348148, 'binary_precision': 0.6258823, 'binary_recall': 0.9851852, 'binary_specificity': 0.26046512, 'binary_f1_score': 0.7654676}
confusion matrix:
    0    1
0  56  159
1   4  266
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 09:36:08.103743,epoch time: 0:09:40.870578,used: 2:25:14.168324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9627379, 'precision': 0.85304165, 'recall': 0.6801189, 'specificity': 0.6801189, 'f1': 0.7353817, 'auroc': 0.9282303, 'binary_precision': 0.96833503, 'binary_recall': 0.99330765, 'binary_specificity': 0.36693016, 'binary_f1_score': 0.98066235}
confusion matrix:
     0      1
0  557    961
1  198  29388
---- Validation: 
scalar performance:
{'acc': 0.65217394, 'precision': 0.7523986, 'recall': 0.656512, 'specificity': 0.656512, 'f1': 0.61745954, 'auroc': 0.8427946, 'binary_precision': 0.58981746, 'binary_recall': 0.96692914, 'binary_specificity': 0.34609494, 'binary_f1_score': 0.73269683}
confusion matrix:
     0    1
0  226  427
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6659794, 'precision': 0.76813185, 'recall': 0.62609816, 'specificity': 0.62609816, 'f1': 0.593323, 'auroc': 0.83677864, 'binary_precision': 0.62857145, 'binary_recall': 0.9777778, 'binary_specificity': 0.2744186, 'binary_f1_score': 0.7652174}
confusion matrix:
    0    1
0  59  156
1   6  264
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-12 09:45:48.711453,epoch time: 0:09:40.607710,used: 2:34:54.776034,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.963188, 'precision': 0.86067045, 'recall': 0.67973053, 'specificity': 0.67973053, 'f1': 0.7365706, 'auroc': 0.9273493, 'binary_precision': 0.96828794, 'binary_recall': 0.99384844, 'binary_specificity': 0.36561266, 'binary_f1_score': 0.9809017}
confusion matrix:
     0      1
0  555    963
1  182  29404
---- Validation: 
scalar performance:
{'acc': 0.6529503, 'precision': 0.7544552, 'recall': 0.65729946, 'specificity': 0.65729946, 'f1': 0.61811674, 'auroc': 0.8438726, 'binary_precision': 0.59021115, 'binary_recall': 0.96850395, 'binary_specificity': 0.34609494, 'binary_f1_score': 0.7334526}
confusion matrix:
     0    1
0  226  427
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6659794, 'precision': 0.76813185, 'recall': 0.62609816, 'specificity': 0.62609816, 'f1': 0.593323, 'auroc': 0.839242, 'binary_precision': 0.62857145, 'binary_recall': 0.9777778, 'binary_specificity': 0.2744186, 'binary_f1_score': 0.7652174}
confusion matrix:
    0    1
0  59  156
1   6  264
better model found
persisted
after epoch: 17,now: 2024-07-12 09:55:29.677900,epoch time: 0:09:40.966447,used: 2:44:35.742481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9629308, 'precision': 0.8580613, 'recall': 0.678555, 'specificity': 0.678555, 'f1': 0.73495626, 'auroc': 0.9335177, 'binary_precision': 0.96815515, 'binary_recall': 0.993713, 'binary_specificity': 0.36339697, 'binary_f1_score': 0.9807676}
confusion matrix:
     0      1
0  552    967
1  186  29399
---- Validation: 
scalar performance:
{'acc': 0.6513975, 'precision': 0.7551989, 'recall': 0.65578973, 'specificity': 0.65578973, 'f1': 0.6156106, 'auroc': 0.8457103, 'binary_precision': 0.58891016, 'binary_recall': 0.97007877, 'binary_specificity': 0.34150076, 'binary_f1_score': 0.7328971}
confusion matrix:
     0    1
0  223  430
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66391754, 'precision': 0.7666642, 'recall': 0.6237726, 'specificity': 0.6237726, 'f1': 0.5899403, 'auroc': 0.8415848, 'binary_precision': 0.6270784, 'binary_recall': 0.9777778, 'binary_specificity': 0.26976743, 'binary_f1_score': 0.76410997}
confusion matrix:
    0    1
0  58  157
1   6  264
early stop counter: 1
val acc:0.6513975262641907, best validation acc: 0.6529502868652344, corresponding to test acc:                         0.6659793853759766 / 0.6659793853759766
after epoch: 18,now: 2024-07-12 10:05:09.870527,epoch time: 0:09:40.192627,used: 2:54:15.935108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9650527, 'precision': 0.8843434, 'recall': 0.68696034, 'specificity': 0.68696034, 'f1': 0.747978, 'auroc': 0.93300664, 'binary_precision': 0.96896493, 'binary_recall': 0.9951328, 'binary_specificity': 0.37878788, 'binary_f1_score': 0.9818745}
confusion matrix:
     0      1
0  575    943
1  144  29442
---- Validation: 
scalar performance:
{'acc': 0.6467391, 'precision': 0.754233, 'recall': 0.6512173, 'specificity': 0.6512173, 'f1': 0.6088224, 'auroc': 0.8482739, 'binary_precision': 0.585389, 'binary_recall': 0.9716535, 'binary_specificity': 0.330781, 'binary_f1_score': 0.73060983}
confusion matrix:
     0    1
0  216  437
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597938, 'precision': 0.7700981, 'recall': 0.6186477, 'specificity': 0.6186477, 'f1': 0.58129495, 'auroc': 0.84490955, 'binary_precision': 0.62352943, 'binary_recall': 0.9814815, 'binary_specificity': 0.25581396, 'binary_f1_score': 0.7625899}
confusion matrix:
    0    1
0  55  160
1   5  265
early stop counter: 2
val acc:0.64673912525177, best validation acc: 0.6529502868652344, corresponding to test acc:                         0.6659793853759766 / 0.6659793853759766
after epoch: 19,now: 2024-07-12 10:14:49.617788,epoch time: 0:09:39.747261,used: 3:03:55.682369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96428114, 'precision': 0.85859144, 'recall': 0.69956195, 'specificity': 0.69956195, 'f1': 0.75383353, 'auroc': 0.9385495, 'binary_precision': 0.9702094, 'binary_recall': 0.9929356, 'binary_specificity': 0.40618828, 'binary_f1_score': 0.98144096}
confusion matrix:
     0      1
0  617    902
1  209  29376
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.76022375, 'recall': 0.6672535, 'specificity': 0.6672535, 'f1': 0.6316527, 'auroc': 0.84910583, 'binary_precision': 0.59766763, 'binary_recall': 0.96850395, 'binary_specificity': 0.36600307, 'binary_f1_score': 0.73918265}
confusion matrix:
     0    1
0  239  414
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77658707, 'recall': 0.64005166, 'specificity': 0.64005166, 'f1': 0.6132376, 'auroc': 0.84670115, 'binary_precision': 0.6376812, 'binary_recall': 0.9777778, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.7719298}
confusion matrix:
    0    1
0  65  150
1   6  264
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-12 10:24:34.986058,epoch time: 0:09:45.368270,used: 3:13:41.050639,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96392745, 'precision': 0.8567077, 'recall': 0.69594115, 'specificity': 0.69594115, 'f1': 0.7502704, 'auroc': 0.9397625, 'binary_precision': 0.96985704, 'binary_recall': 0.9929356, 'binary_specificity': 0.39894667, 'binary_f1_score': 0.98126066}
confusion matrix:
     0      1
0  606    913
1  209  29376
---- Validation: 
scalar performance:
{'acc': 0.6576087, 'precision': 0.75872445, 'recall': 0.66191536, 'specificity': 0.66191536, 'f1': 0.62401485, 'auroc': 0.85098696, 'binary_precision': 0.59344894, 'binary_recall': 0.97007877, 'binary_specificity': 0.35375193, 'binary_f1_score': 0.73640174}
confusion matrix:
     0    1
0  231  422
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6701031, 'precision': 0.7710134, 'recall': 0.63074934, 'specificity': 0.63074934, 'f1': 0.600033, 'auroc': 0.84944016, 'binary_precision': 0.6315789, 'binary_recall': 0.9777778, 'binary_specificity': 0.28372094, 'binary_f1_score': 0.76744187}
confusion matrix:
    0    1
0  61  154
1   6  264
early stop counter: 1
val acc:0.657608687877655, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.6783505082130432 / 0.6783505082130432
after epoch: 21,now: 2024-07-12 10:34:15.761858,epoch time: 0:09:40.775800,used: 3:23:21.826439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96479553, 'precision': 0.8539388, 'recall': 0.71307355, 'specificity': 0.71307355, 'f1': 0.7639477, 'auroc': 0.93893373, 'binary_precision': 0.97156477, 'binary_recall': 0.9920232, 'binary_specificity': 0.43412384, 'binary_f1_score': 0.98168737}
confusion matrix:
     0      1
0  659    859
1  236  29350
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.76022375, 'recall': 0.6672535, 'specificity': 0.6672535, 'f1': 0.6316527, 'auroc': 0.85109067, 'binary_precision': 0.59766763, 'binary_recall': 0.96850395, 'binary_specificity': 0.36600307, 'binary_f1_score': 0.73918265}
confusion matrix:
     0    1
0  239  414
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68041235, 'precision': 0.77794594, 'recall': 0.64237726, 'specificity': 0.64237726, 'f1': 0.6164952, 'auroc': 0.85119724, 'binary_precision': 0.6392252, 'binary_recall': 0.9777778, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.7730601}
confusion matrix:
    0    1
0  66  149
1   6  264
new oracle model saved
early stop counter: 2
val acc:0.6630434989929199, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.6783505082130432 / 0.6804123520851135
after epoch: 22,now: 2024-07-12 10:43:56.409317,epoch time: 0:09:40.647459,used: 3:33:02.473898,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9656314, 'precision': 0.8615551, 'recall': 0.71775854, 'specificity': 0.71775854, 'f1': 0.7697358, 'auroc': 0.94911194, 'binary_precision': 0.97199416, 'binary_recall': 0.9924624, 'binary_specificity': 0.44305465, 'binary_f1_score': 0.98212165}
confusion matrix:
     0      1
0  673    846
1  223  29362
---- Validation: 
scalar performance:
{'acc': 0.66071427, 'precision': 0.7589026, 'recall': 0.66495645, 'specificity': 0.66495645, 'f1': 0.6285522, 'auroc': 0.85350955, 'binary_precision': 0.5959302, 'binary_recall': 0.96850395, 'binary_specificity': 0.3614089, 'binary_f1_score': 0.73785245}
confusion matrix:
     0    1
0  236  417
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77658707, 'recall': 0.64005166, 'specificity': 0.64005166, 'f1': 0.6132376, 'auroc': 0.8540052, 'binary_precision': 0.6376812, 'binary_recall': 0.9777778, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.7719298}
confusion matrix:
    0    1
0  65  150
1   6  264
early stop counter: 3
val acc:0.6607142686843872, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.6783505082130432 / 0.6804123520851135
after epoch: 23,now: 2024-07-12 10:53:38.475305,epoch time: 0:09:42.065988,used: 3:42:44.539886,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96566355, 'precision': 0.8601444, 'recall': 0.7199613, 'specificity': 0.7199613, 'f1': 0.7711331, 'auroc': 0.9468124, 'binary_precision': 0.9722139, 'binary_recall': 0.99225956, 'binary_specificity': 0.44766295, 'binary_f1_score': 0.98213446}
confusion matrix:
     0      1
0  680    839
1  229  29356
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.76022375, 'recall': 0.6672535, 'specificity': 0.6672535, 'f1': 0.6316527, 'auroc': 0.85431266, 'binary_precision': 0.59766763, 'binary_recall': 0.96850395, 'binary_specificity': 0.36600307, 'binary_f1_score': 0.73918265}
confusion matrix:
     0    1
0  239  414
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68041235, 'precision': 0.77794594, 'recall': 0.64237726, 'specificity': 0.64237726, 'f1': 0.6164952, 'auroc': 0.8556762, 'binary_precision': 0.6392252, 'binary_recall': 0.9777778, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.7730601}
confusion matrix:
    0    1
0  66  149
1   6  264
early stop counter: 4
val acc:0.6630434989929199, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.6783505082130432 / 0.6804123520851135
after epoch: 24,now: 2024-07-12 11:03:21.877992,epoch time: 0:09:43.402687,used: 3:52:27.942573,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9650527, 'precision': 0.8563838, 'recall': 0.71464396, 'specificity': 0.71464396, 'f1': 0.76585853, 'auroc': 0.94843566, 'binary_precision': 0.97169626, 'binary_recall': 0.9921582, 'binary_specificity': 0.43712968, 'binary_f1_score': 0.98182064}
confusion matrix:
     0      1
0  664    855
1  232  29353
---- Validation: 
scalar performance:
{'acc': 0.6622671, 'precision': 0.7582535, 'recall': 0.6664661, 'specificity': 0.6664661, 'f1': 0.63098663, 'auroc': 0.8568955, 'binary_precision': 0.5972763, 'binary_recall': 0.96692914, 'binary_specificity': 0.36600307, 'binary_f1_score': 0.73842454}
confusion matrix:
     0    1
0  239  414
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6845361, 'precision': 0.7754632, 'recall': 0.6475022, 'specificity': 0.6475022, 'f1': 0.6244477, 'auroc': 0.85953486, 'binary_precision': 0.6430318, 'binary_recall': 0.97407407, 'binary_specificity': 0.32093024, 'binary_f1_score': 0.77466863}
confusion matrix:
    0    1
0  69  146
1   7  263
new oracle model saved
early stop counter: 5
val acc:0.6622670888900757, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.6783505082130432 / 0.6845360994338989
after epoch: 25,now: 2024-07-12 11:13:08.786878,epoch time: 0:09:46.908886,used: 4:02:14.851459,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9663709, 'precision': 0.8694546, 'recall': 0.71965647, 'specificity': 0.71965647, 'f1': 0.7733387, 'auroc': 0.9494432, 'binary_precision': 0.97220474, 'binary_recall': 0.99303746, 'binary_specificity': 0.44627553, 'binary_f1_score': 0.98251075}
confusion matrix:
     0      1
0  677    840
1  206  29381
---- Validation: 
scalar performance:
{'acc': 0.6576087, 'precision': 0.75872445, 'recall': 0.66191536, 'specificity': 0.66191536, 'f1': 0.62401485, 'auroc': 0.8601247, 'binary_precision': 0.59344894, 'binary_recall': 0.97007877, 'binary_specificity': 0.35375193, 'binary_f1_score': 0.73640174}
confusion matrix:
     0    1
0  231  422
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.672165, 'precision': 0.7724291, 'recall': 0.63307494, 'specificity': 0.63307494, 'f1': 0.6033608, 'auroc': 0.8635831, 'binary_precision': 0.63309354, 'binary_recall': 0.9777778, 'binary_specificity': 0.2883721, 'binary_f1_score': 0.768559}
confusion matrix:
    0    1
0  62  153
1   6  264
early stop counter: 6
val acc:0.657608687877655, best validation acc: 0.6630434989929199, corresponding to test acc:                         0.6783505082130432 / 0.6845360994338989
after epoch: 26,now: 2024-07-12 11:22:51.611510,epoch time: 0:09:42.824632,used: 4:11:57.676091,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96630657, 'precision': 0.85269094, 'recall': 0.7405964, 'specificity': 0.7405964, 'f1': 0.7847566, 'auroc': 0.947789, 'binary_precision': 0.9742729, 'binary_recall': 0.9907386, 'binary_specificity': 0.49045426, 'binary_f1_score': 0.9824368}
confusion matrix:
     0      1
0  745    774
1  274  29311
---- Validation: 
scalar performance:
{'acc': 0.67391306, 'precision': 0.76067173, 'recall': 0.6778864, 'specificity': 0.6778864, 'f1': 0.6472678, 'auroc': 0.85926855, 'binary_precision': 0.60675275, 'binary_recall': 0.9622047, 'binary_specificity': 0.39356816, 'binary_f1_score': 0.74421436}
confusion matrix:
     0    1
0  257  396
1   24  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70515466, 'precision': 0.7888763, 'recall': 0.67075795, 'specificity': 0.67075795, 'f1': 0.65558255, 'auroc': 0.86332476, 'binary_precision': 0.65914786, 'binary_recall': 0.97407407, 'binary_specificity': 0.36744186, 'binary_f1_score': 0.78624815}
confusion matrix:
    0    1
0  79  136
1   7  263
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-12 11:32:39.080208,epoch time: 0:09:47.468698,used: 4:21:45.144789,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96566355, 'precision': 0.855563, 'recall': 0.72540414, 'specificity': 0.72540414, 'f1': 0.77416533, 'auroc': 0.95123094, 'binary_precision': 0.9727785, 'binary_recall': 0.9916515, 'binary_specificity': 0.45915678, 'binary_f1_score': 0.9821243}
confusion matrix:
     0      1
0  697    821
1  247  29339
---- Validation: 
scalar performance:
{'acc': 0.66847825, 'precision': 0.7589017, 'recall': 0.67254823, 'specificity': 0.67254823, 'f1': 0.6398736, 'auroc': 0.86169946, 'binary_precision': 0.6023622, 'binary_recall': 0.9637795, 'binary_specificity': 0.381317, 'binary_f1_score': 0.7413689}
confusion matrix:
     0    1
0  249  404
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7010309, 'precision': 0.7862635, 'recall': 0.6661068, 'specificity': 0.6661068, 'f1': 0.6494774, 'auroc': 0.86647713, 'binary_precision': 0.65586036, 'binary_recall': 0.97407407, 'binary_specificity': 0.35813954, 'binary_f1_score': 0.7839047}
confusion matrix:
    0    1
0  77  138
1   7  263
early stop counter: 1
val acc:0.66847825050354, best validation acc: 0.6739130616188049, corresponding to test acc:                         0.7051546573638916 / 0.7051546573638916
after epoch: 28,now: 2024-07-12 11:42:24.271596,epoch time: 0:09:45.191388,used: 4:31:30.336177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96566355, 'precision': 0.85509145, 'recall': 0.7260291, 'specificity': 0.7260291, 'f1': 0.7745166, 'auroc': 0.94971967, 'binary_precision': 0.9728412, 'binary_recall': 0.9915839, 'binary_specificity': 0.4604743, 'binary_f1_score': 0.98212314}
confusion matrix:
     0      1
0  699    819
1  249  29337
---- Validation: 
scalar performance:
{'acc': 0.66847825, 'precision': 0.76033986, 'recall': 0.67257, 'specificity': 0.67257, 'f1': 0.63952994, 'auroc': 0.86345994, 'binary_precision': 0.6021611, 'binary_recall': 0.9653543, 'binary_specificity': 0.3797856, 'binary_f1_score': 0.7416818}
confusion matrix:
     0    1
0  248  405
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70309275, 'precision': 0.7875736, 'recall': 0.66843235, 'specificity': 0.66843235, 'f1': 0.65253735, 'auroc': 0.8687166, 'binary_precision': 0.6575, 'binary_recall': 0.97407407, 'binary_specificity': 0.3627907, 'binary_f1_score': 0.78507465}
confusion matrix:
    0    1
0  78  137
1   7  263
early stop counter: 2
val acc:0.66847825050354, best validation acc: 0.6739130616188049, corresponding to test acc:                         0.7051546573638916 / 0.7051546573638916
after epoch: 29,now: 2024-07-12 11:52:06.101688,epoch time: 0:09:41.830092,used: 4:41:12.166269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9669817, 'precision': 0.8637292, 'recall': 0.73657966, 'specificity': 0.73657966, 'f1': 0.78509367, 'auroc': 0.95512545, 'binary_precision': 0.97385013, 'binary_recall': 0.9919216, 'binary_specificity': 0.48123765, 'binary_f1_score': 0.9828028}
confusion matrix:
     0      1
0  731    788
1  239  29346
---- Validation: 
scalar performance:
{'acc': 0.6622671, 'precision': 0.759784, 'recall': 0.6664878, 'specificity': 0.6664878, 'f1': 0.6306207, 'auroc': 0.8654858, 'binary_precision': 0.5970874, 'binary_recall': 0.96850395, 'binary_specificity': 0.36447167, 'binary_f1_score': 0.7387387}
confusion matrix:
     0    1
0  238  415
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6845361, 'precision': 0.7754632, 'recall': 0.6475022, 'specificity': 0.6475022, 'f1': 0.6244477, 'auroc': 0.8715762, 'binary_precision': 0.6430318, 'binary_recall': 0.97407407, 'binary_specificity': 0.32093024, 'binary_f1_score': 0.77466863}
confusion matrix:
    0    1
0  69  146
1   7  263
early stop counter: 3
val acc:0.6622670888900757, best validation acc: 0.6739130616188049, corresponding to test acc:                         0.7051546573638916 / 0.7051546573638916
after epoch: 30,now: 2024-07-12 12:01:50.851504,epoch time: 0:09:44.749816,used: 4:50:56.916085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_10_53_seed_0_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:50:56.916085 at 2024-07-12 12:01:50.851504
persisted model performance metric: 

scalar performance:
{'acc': 0.70515466, 'precision': 0.7888763, 'recall': 0.67075795, 'specificity': 0.67075795, 'f1': 0.65558255, 'auroc': 0.86332476, 'binary_precision': 0.65914786, 'binary_recall': 0.97407407, 'binary_specificity': 0.36744186, 'binary_f1_score': 0.78624815}
confusion matrix:
    0    1
0  79  136
1   7  263
oracle model performance metric: 

scalar performance:
{'acc': 0.70515466, 'precision': 0.7888763, 'recall': 0.67075795, 'specificity': 0.67075795, 'f1': 0.65558255, 'auroc': 0.86332476, 'binary_precision': 0.65914786, 'binary_recall': 0.97407407, 'binary_specificity': 0.36744186, 'binary_f1_score': 0.78624815}
confusion matrix:
    0    1
0  79  136
1   7  263
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 216499 GiB | 216498 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36533 KiB |  74940 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |   6133 KiB |   9283 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    4371    |   50234 K  |   50233 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    4371    |   50234 K  |   50233 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    1961    |   29176 K  |   29176 K  |
|       from large pool |       9    |      19    |   13022 K  |   13022 K  |
|       from small pool |      28    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29177 K  |   29176 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29177 K  |   29176 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843

 Experiment start at: 2024-07-12 12:15:23.111131
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9488403, 'precision': 0.59225434, 'recall': 0.5090128, 'specificity': 0.5090128, 'f1': 0.50670373, 'auroc': 0.49631292, 'binary_precision': 0.9521143, 'binary_recall': 0.99632937, 'binary_specificity': 0.021696253, 'binary_f1_score': 0.97372013}
confusion matrix:
     0      1
0   33   1488
1  109  29586
---- Validation: 
scalar performance:
{'acc': 0.64246684, 'precision': 0.73998547, 'recall': 0.64759344, 'specificity': 0.64759344, 'f1': 0.6065577, 'auroc': 0.68715525, 'binary_precision': 0.58285165, 'binary_recall': 0.96031743, 'binary_specificity': 0.33486944, 'binary_f1_score': 0.7254197}
confusion matrix:
     0    1
0  218  433
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6359833, 'precision': 0.74997133, 'recall': 0.6148089, 'specificity': 0.6148089, 'f1': 0.56767714, 'auroc': 0.7221607, 'binary_precision': 0.59518075, 'binary_recall': 0.97628456, 'binary_specificity': 0.25333333, 'binary_f1_score': 0.73952097}
confusion matrix:
    0    1
0  57  168
1   6  247
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 12:25:08.585412,epoch time: 0:09:45.474281,used: 0:09:45.474281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9499936, 'precision': 0.6569169, 'recall': 0.51554495, 'specificity': 0.51554495, 'f1': 0.5183871, 'auroc': 0.5880965, 'binary_precision': 0.9527227, 'binary_recall': 0.9969018, 'binary_specificity': 0.034188036, 'binary_f1_score': 0.9743117}
confusion matrix:
    0      1
0  52   1469
1  92  29603
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.7480713, 'recall': 0.6530466, 'specificity': 0.6530466, 'f1': 0.61277175, 'auroc': 0.72797406, 'binary_precision': 0.58630663, 'binary_recall': 0.96507937, 'binary_specificity': 0.34101382, 'binary_f1_score': 0.7294541}
confusion matrix:
     0    1
0  222  429
1   22  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6359833, 'precision': 0.74997133, 'recall': 0.6148089, 'specificity': 0.6148089, 'f1': 0.56767714, 'auroc': 0.7615634, 'binary_precision': 0.59518075, 'binary_recall': 0.97628456, 'binary_specificity': 0.25333333, 'binary_f1_score': 0.73952097}
confusion matrix:
    0    1
0  57  168
1   6  247
better model found
persisted
after epoch: 2,now: 2024-07-12 12:34:50.931053,epoch time: 0:09:42.345641,used: 0:19:27.819922,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95076245, 'precision': 0.6954896, 'recall': 0.51844037, 'specificity': 0.51844037, 'f1': 0.52356505, 'auroc': 0.69649446, 'binary_precision': 0.95302296, 'binary_recall': 0.9974071, 'binary_specificity': 0.039473683, 'binary_f1_score': 0.97471005}
confusion matrix:
    0      1
0  60   1460
1  77  29619
---- Validation: 
scalar performance:
{'acc': 0.66978925, 'precision': 0.75260997, 'recall': 0.67439836, 'specificity': 0.67439836, 'f1': 0.643803, 'auroc': 0.757094, 'binary_precision': 0.60381144, 'binary_recall': 0.95555556, 'binary_specificity': 0.39324117, 'binary_f1_score': 0.74001235}
confusion matrix:
     0    1
0  256  395
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6422594, 'precision': 0.73799264, 'recall': 0.6222134, 'specificity': 0.6222134, 'f1': 0.5823792, 'auroc': 0.79040843, 'binary_precision': 0.6009852, 'binary_recall': 0.9644269, 'binary_specificity': 0.28, 'binary_f1_score': 0.74051595}
confusion matrix:
    0    1
0  63  162
1   9  244
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 12:44:33.058048,epoch time: 0:09:42.126995,used: 0:29:09.946917,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9514672, 'precision': 0.73397845, 'recall': 0.52879834, 'specificity': 0.52879834, 'f1': 0.5416768, 'auroc': 0.774215, 'binary_precision': 0.9539904, 'binary_recall': 0.9970703, 'binary_specificity': 0.060526315, 'binary_f1_score': 0.9750547}
confusion matrix:
    0      1
0  92   1428
1  87  29609
---- Validation: 
scalar performance:
{'acc': 0.6791569, 'precision': 0.7570391, 'recall': 0.68358934, 'specificity': 0.68358934, 'f1': 0.6560539, 'auroc': 0.77692926, 'binary_precision': 0.6113937, 'binary_recall': 0.9539682, 'binary_specificity': 0.41321045, 'binary_f1_score': 0.74519527}
confusion matrix:
     0    1
0  269  382
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6527197, 'precision': 0.7457979, 'recall': 0.63332456, 'specificity': 0.63332456, 'f1': 0.59825426, 'auroc': 0.80879664, 'binary_precision': 0.6084788, 'binary_recall': 0.9644269, 'binary_specificity': 0.30222222, 'binary_f1_score': 0.7461774}
confusion matrix:
    0    1
0  68  157
1   9  244
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 12:54:14.542199,epoch time: 0:09:41.484151,used: 0:38:51.431068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9521079, 'precision': 0.7577785, 'recall': 0.537865, 'specificity': 0.537865, 'f1': 0.556849, 'auroc': 0.835616, 'binary_precision': 0.95480937, 'binary_recall': 0.99683446, 'binary_specificity': 0.078895465, 'binary_f1_score': 0.97536945}
confusion matrix:
     0      1
0  120   1401
1   94  29601
---- Validation: 
scalar performance:
{'acc': 0.68930525, 'precision': 0.76317, 'recall': 0.69357395, 'specificity': 0.69357395, 'f1': 0.66876423, 'auroc': 0.79197323, 'binary_precision': 0.6195876, 'binary_recall': 0.9539682, 'binary_specificity': 0.43317974, 'binary_f1_score': 0.75124997}
confusion matrix:
     0    1
0  282  369
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6820084, 'precision': 0.761821, 'recall': 0.6646816, 'specificity': 0.6646816, 'f1': 0.641884, 'auroc': 0.8211155, 'binary_precision': 0.63116884, 'binary_recall': 0.9604743, 'binary_specificity': 0.36888888, 'binary_f1_score': 0.76175547}
confusion matrix:
    0    1
0  83  142
1  10  243
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-12 13:04:00.590688,epoch time: 0:09:46.048489,used: 0:48:37.479557,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9529728, 'precision': 0.779495, 'recall': 0.5492359, 'specificity': 0.5492359, 'f1': 0.5750752, 'auroc': 0.8539204, 'binary_precision': 0.9558771, 'binary_recall': 0.9965651, 'binary_specificity': 0.10190664, 'binary_f1_score': 0.9757972}
confusion matrix:
     0      1
0  155   1366
1  102  29593
---- Validation: 
scalar performance:
{'acc': 0.6869633, 'precision': 0.7571112, 'recall': 0.6911674, 'specificity': 0.6911674, 'f1': 0.6669524, 'auroc': 0.8042352, 'binary_precision': 0.6186528, 'binary_recall': 0.947619, 'binary_specificity': 0.4347158, 'binary_f1_score': 0.7485894}
confusion matrix:
     0    1
0  283  368
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6966527, 'precision': 0.7714286, 'recall': 0.6802372, 'specificity': 0.6802372, 'f1': 0.66202605, 'auroc': 0.8314097, 'binary_precision': 0.64285713, 'binary_recall': 0.9604743, 'binary_specificity': 0.4, 'binary_f1_score': 0.77020603}
confusion matrix:
    0    1
0  90  135
1  10  243
new oracle model saved
early stop counter: 1
val acc:0.6869633197784424, best validation acc: 0.6893052458763123, corresponding to test acc:                         0.6820083856582642 / 0.6966527104377747
after epoch: 6,now: 2024-07-12 13:13:47.435333,epoch time: 0:09:46.844645,used: 0:58:24.324202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9545425, 'precision': 0.8159214, 'recall': 0.5631604, 'specificity': 0.5631604, 'f1': 0.5969554, 'auroc': 0.87858033, 'binary_precision': 0.9571853, 'binary_recall': 0.9968008, 'binary_specificity': 0.12952006, 'binary_f1_score': 0.9765914}
confusion matrix:
     0      1
0  197   1324
1   95  29600
---- Validation: 
scalar performance:
{'acc': 0.69633096, 'precision': 0.7629165, 'recall': 0.700384, 'specificity': 0.700384, 'f1': 0.6784599, 'auroc': 0.81263506, 'binary_precision': 0.6264428, 'binary_recall': 0.947619, 'binary_specificity': 0.453149, 'binary_f1_score': 0.754264}
confusion matrix:
     0    1
0  295  356
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6966527, 'precision': 0.76788694, 'recall': 0.6804831, 'specificity': 0.6804831, 'f1': 0.66302514, 'auroc': 0.8375406, 'binary_precision': 0.64361703, 'binary_recall': 0.95652175, 'binary_specificity': 0.40444446, 'binary_f1_score': 0.76947534}
confusion matrix:
    0    1
0  91  134
1  11  242
better model found
persisted
after epoch: 7,now: 2024-07-12 13:23:35.483787,epoch time: 0:09:48.048454,used: 1:08:12.372656,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95559967, 'precision': 0.82396007, 'recall': 0.57841104, 'specificity': 0.57841104, 'f1': 0.6187592, 'auroc': 0.8957977, 'binary_precision': 0.95865464, 'binary_recall': 0.9962958, 'binary_specificity': 0.16052632, 'binary_f1_score': 0.9771128}
confusion matrix:
     0      1
0  244   1276
1  110  29586
---- Validation: 
scalar performance:
{'acc': 0.7025761, 'precision': 0.7667659, 'recall': 0.7065284, 'specificity': 0.7065284, 'f1': 0.6860385, 'auroc': 0.8186648, 'binary_precision': 0.63174605, 'binary_recall': 0.947619, 'binary_specificity': 0.4654378, 'binary_f1_score': 0.75809526}
confusion matrix:
     0    1
0  303  348
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70920503, 'precision': 0.7729002, 'recall': 0.69406235, 'specificity': 0.69406235, 'f1': 0.680621, 'auroc': 0.8419148, 'binary_precision': 0.6548913, 'binary_recall': 0.9525692, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.7761675}
confusion matrix:
    0    1
0  98  127
1  12  241
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 13:33:23.572082,epoch time: 0:09:48.088295,used: 1:18:00.460951,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95678496, 'precision': 0.8259587, 'recall': 0.5993212, 'specificity': 0.5993212, 'f1': 0.64593685, 'auroc': 0.90304804, 'binary_precision': 0.9606422, 'binary_recall': 0.9953529, 'binary_specificity': 0.20328948, 'binary_f1_score': 0.9776896}
confusion matrix:
     0      1
0  309   1211
1  138  29558
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.761266, 'recall': 0.7011008, 'specificity': 0.7011008, 'f1': 0.67990506, 'auroc': 0.8243996, 'binary_precision': 0.62763715, 'binary_recall': 0.9444444, 'binary_specificity': 0.4577573, 'binary_f1_score': 0.7541191}
confusion matrix:
     0    1
0  298  353
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7833967, 'recall': 0.70023715, 'specificity': 0.70023715, 'f1': 0.6870824, 'auroc': 0.84725523, 'binary_precision': 0.6585366, 'binary_recall': 0.9604743, 'binary_specificity': 0.44, 'binary_f1_score': 0.7813505}
confusion matrix:
    0    1
0  99  126
1  10  243
new oracle model saved
early stop counter: 1
val acc:0.6971116065979004, best validation acc: 0.7025761008262634, corresponding to test acc:                         0.7092050313949585 / 0.715481162071228
after epoch: 9,now: 2024-07-12 13:43:09.525927,epoch time: 0:09:45.953845,used: 1:27:46.414796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9597322, 'precision': 0.8688085, 'recall': 0.6204695, 'specificity': 0.6204695, 'f1': 0.6755068, 'auroc': 0.91267264, 'binary_precision': 0.9626171, 'binary_recall': 0.99636304, 'binary_specificity': 0.24457593, 'binary_f1_score': 0.97919947}
confusion matrix:
     0      1
0  372   1149
1  108  29587
---- Validation: 
scalar performance:
{'acc': 0.6986729, 'precision': 0.7622433, 'recall': 0.70263696, 'specificity': 0.70263696, 'f1': 0.68179774, 'auroc': 0.8305635, 'binary_precision': 0.62896407, 'binary_recall': 0.9444444, 'binary_specificity': 0.4608295, 'binary_f1_score': 0.75507617}
confusion matrix:
     0    1
0  300  351
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7833967, 'recall': 0.70023715, 'specificity': 0.70023715, 'f1': 0.6870824, 'auroc': 0.85350895, 'binary_precision': 0.6585366, 'binary_recall': 0.9604743, 'binary_specificity': 0.44, 'binary_f1_score': 0.7813505}
confusion matrix:
    0    1
0  99  126
1  10  243
early stop counter: 2
val acc:0.698672890663147, best validation acc: 0.7025761008262634, corresponding to test acc:                         0.7092050313949585 / 0.715481162071228
after epoch: 10,now: 2024-07-12 13:52:54.415148,epoch time: 0:09:44.889221,used: 1:37:31.304017,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9603088, 'precision': 0.84948695, 'recall': 0.64260507, 'specificity': 0.64260507, 'f1': 0.69792384, 'auroc': 0.9191197, 'binary_precision': 0.9647547, 'binary_recall': 0.99461186, 'binary_specificity': 0.2905983, 'binary_f1_score': 0.97945577}
confusion matrix:
     0      1
0  442   1079
1  160  29535
---- Validation: 
scalar performance:
{'acc': 0.7010148, 'precision': 0.75968444, 'recall': 0.7048387, 'specificity': 0.7048387, 'f1': 0.6855595, 'auroc': 0.8342867, 'binary_precision': 0.63208556, 'binary_recall': 0.9380952, 'binary_specificity': 0.47158217, 'binary_f1_score': 0.75527155}
confusion matrix:
     0    1
0  307  344
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7217573, 'precision': 0.7873243, 'recall': 0.7069038, 'specificity': 0.7069038, 'f1': 0.6952393, 'auroc': 0.8570399, 'binary_precision': 0.6639344, 'binary_recall': 0.9604743, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78513736}
confusion matrix:
     0    1
0  102  123
1   10  243
new oracle model saved
early stop counter: 3
val acc:0.7010148167610168, best validation acc: 0.7025761008262634, corresponding to test acc:                         0.7092050313949585 / 0.7217572927474976
after epoch: 11,now: 2024-07-12 14:02:41.466020,epoch time: 0:09:47.050872,used: 1:47:18.354889,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9614621, 'precision': 0.85372233, 'recall': 0.65733504, 'specificity': 0.65733504, 'f1': 0.7137198, 'auroc': 0.92409927, 'binary_precision': 0.96619654, 'binary_recall': 0.99427533, 'binary_specificity': 0.32039472, 'binary_f1_score': 0.9800349}
confusion matrix:
     0      1
0  487   1033
1  170  29526
---- Validation: 
scalar performance:
{'acc': 0.7010148, 'precision': 0.75968444, 'recall': 0.7048387, 'specificity': 0.7048387, 'f1': 0.6855595, 'auroc': 0.83763194, 'binary_precision': 0.63208556, 'binary_recall': 0.9380952, 'binary_specificity': 0.47158217, 'binary_f1_score': 0.75527155}
confusion matrix:
     0    1
0  307  344
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.79695773, 'recall': 0.717769, 'specificity': 0.717769, 'f1': 0.70786864, 'auroc': 0.8601669, 'binary_precision': 0.6721763, 'binary_recall': 0.9644269, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.79220784}
confusion matrix:
     0    1
0  106  119
1    9  244
new oracle model saved
early stop counter: 4
val acc:0.7010148167610168, best validation acc: 0.7025761008262634, corresponding to test acc:                         0.7092050313949585 / 0.73221755027771
after epoch: 12,now: 2024-07-12 14:12:27.674604,epoch time: 0:09:46.208584,used: 1:57:04.563473,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96303177, 'precision': 0.85366064, 'recall': 0.6833348, 'specificity': 0.6833348, 'f1': 0.738441, 'auroc': 0.93200815, 'binary_precision': 0.9686997, 'binary_recall': 0.9932312, 'binary_specificity': 0.37343854, 'binary_f1_score': 0.9808121}
confusion matrix:
     0      1
0  568    953
1  201  29494
---- Validation: 
scalar performance:
{'acc': 0.7103825, 'precision': 0.76474845, 'recall': 0.71402967, 'specificity': 0.71402967, 'f1': 0.696918, 'auroc': 0.840848, 'binary_precision': 0.640608, 'binary_recall': 0.93650794, 'binary_specificity': 0.49155146, 'binary_f1_score': 0.76079947}
confusion matrix:
     0    1
0  320  331
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7994886, 'recall': 0.72221345, 'specificity': 0.72221345, 'f1': 0.71318364, 'auroc': 0.8633992, 'binary_precision': 0.6759003, 'binary_recall': 0.9644269, 'binary_specificity': 0.48, 'binary_f1_score': 0.7947883}
confusion matrix:
     0    1
0  108  117
1    9  244
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 14:22:13.774044,epoch time: 0:09:46.099440,used: 2:06:50.662913,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96399283, 'precision': 0.85859346, 'recall': 0.6933094, 'specificity': 0.6933094, 'f1': 0.7484094, 'auroc': 0.9265255, 'binary_precision': 0.969687, 'binary_recall': 0.99319774, 'binary_specificity': 0.39342105, 'binary_f1_score': 0.98130155}
confusion matrix:
     0      1
0  598    922
1  202  29494
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.7623112, 'recall': 0.71169996, 'specificity': 0.71169996, 'f1': 0.6943618, 'auroc': 0.8443762, 'binary_precision': 0.63882864, 'binary_recall': 0.9349206, 'binary_specificity': 0.48847926, 'binary_f1_score': 0.75902057}
confusion matrix:
     0    1
0  318  333
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74058574, 'precision': 0.80201775, 'recall': 0.72665787, 'specificity': 0.72665787, 'f1': 0.71846026, 'auroc': 0.8669829, 'binary_precision': 0.67966574, 'binary_recall': 0.9644269, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.79738563}
confusion matrix:
     0    1
0  110  115
1    9  244
new oracle model saved
early stop counter: 1
val acc:0.7080405950546265, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 14,now: 2024-07-12 14:31:58.641144,epoch time: 0:09:44.867100,used: 2:16:35.530013,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9647296, 'precision': 0.8573141, 'recall': 0.7069955, 'specificity': 0.7069955, 'f1': 0.7598212, 'auroc': 0.93345577, 'binary_precision': 0.9710088, 'binary_recall': 0.99255764, 'binary_specificity': 0.42143327, 'binary_f1_score': 0.98166496}
confusion matrix:
     0      1
0  641    880
1  221  29474
---- Validation: 
scalar performance:
{'acc': 0.7010148, 'precision': 0.76166785, 'recall': 0.7048899, 'specificity': 0.7048899, 'f1': 0.68509775, 'auroc': 0.8486254, 'binary_precision': 0.6315229, 'binary_recall': 0.9412698, 'binary_specificity': 0.46850997, 'binary_f1_score': 0.75589544}
confusion matrix:
     0    1
0  305  346
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.8719895, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
early stop counter: 2
val acc:0.7010148167610168, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 15,now: 2024-07-12 14:41:43.460243,epoch time: 0:09:44.819099,used: 2:26:20.349112,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9644093, 'precision': 0.8558818, 'recall': 0.7026985, 'specificity': 0.7026985, 'f1': 0.7558683, 'auroc': 0.938484, 'binary_precision': 0.9706289, 'binary_recall': 0.99262553, 'binary_specificity': 0.41277155, 'binary_f1_score': 0.981504}
confusion matrix:
     0      1
0  627    892
1  219  29478
---- Validation: 
scalar performance:
{'acc': 0.69633096, 'precision': 0.76077706, 'recall': 0.7003328, 'specificity': 0.7003328, 'f1': 0.6789571, 'auroc': 0.8513349, 'binary_precision': 0.6269758, 'binary_recall': 0.9444444, 'binary_specificity': 0.4562212, 'binary_f1_score': 0.75364155}
confusion matrix:
     0    1
0  297  354
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7867849, 'recall': 0.6999912, 'specificity': 0.6999912, 'f1': 0.68620634, 'auroc': 0.8744664, 'binary_precision': 0.65768194, 'binary_recall': 0.9644269, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.7820513}
confusion matrix:
    0    1
0  98  127
1   9  244
early stop counter: 3
val acc:0.6963309645652771, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 16,now: 2024-07-12 14:51:27.888834,epoch time: 0:09:44.428591,used: 2:36:04.777703,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96517813, 'precision': 0.865355, 'recall': 0.7048562, 'specificity': 0.7048562, 'f1': 0.75997186, 'auroc': 0.93864846, 'binary_precision': 0.97080606, 'binary_recall': 0.9932651, 'binary_specificity': 0.41644737, 'binary_f1_score': 0.9819072}
confusion matrix:
     0      1
0  633    887
1  200  29496
---- Validation: 
scalar performance:
{'acc': 0.69320846, 'precision': 0.7609863, 'recall': 0.6973118, 'specificity': 0.6973118, 'f1': 0.67464304, 'auroc': 0.85418034, 'binary_precision': 0.6238245, 'binary_recall': 0.947619, 'binary_specificity': 0.44700462, 'binary_f1_score': 0.75236297}
confusion matrix:
     0    1
0  291  360
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70711297, 'precision': 0.781644, 'recall': 0.6911023, 'specificity': 0.6911023, 'f1': 0.6751204, 'auroc': 0.87768114, 'binary_precision': 0.65066665, 'binary_recall': 0.9644269, 'binary_specificity': 0.41777778, 'binary_f1_score': 0.77707005}
confusion matrix:
    0    1
0  94  131
1   9  244
early stop counter: 4
val acc:0.6932084560394287, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 17,now: 2024-07-12 15:01:12.084028,epoch time: 0:09:44.195194,used: 2:45:48.972897,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9655625, 'precision': 0.85541856, 'recall': 0.72302794, 'specificity': 0.72302794, 'f1': 0.7722752, 'auroc': 0.9425298, 'binary_precision': 0.9725892, 'binary_recall': 0.99174947, 'binary_specificity': 0.45430636, 'binary_f1_score': 0.98207587}
confusion matrix:
     0      1
0  691    830
1  245  29450
---- Validation: 
scalar performance:
{'acc': 0.70569867, 'precision': 0.7598673, 'recall': 0.7093702, 'specificity': 0.7093702, 'f1': 0.69180334, 'auroc': 0.85552627, 'binary_precision': 0.6370531, 'binary_recall': 0.93333334, 'binary_specificity': 0.48540705, 'binary_f1_score': 0.757244}
confusion matrix:
     0    1
0  316  335
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7994886, 'recall': 0.72221345, 'specificity': 0.72221345, 'f1': 0.71318364, 'auroc': 0.87889326, 'binary_precision': 0.6759003, 'binary_recall': 0.9644269, 'binary_specificity': 0.48, 'binary_f1_score': 0.7947883}
confusion matrix:
     0    1
0  108  117
1    9  244
early stop counter: 5
val acc:0.7056986689567566, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 18,now: 2024-07-12 15:10:52.134515,epoch time: 0:09:40.050487,used: 2:55:29.023384,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9665556, 'precision': 0.86807656, 'recall': 0.72354984, 'specificity': 0.72354984, 'f1': 0.77613187, 'auroc': 0.9457519, 'binary_precision': 0.9726172, 'binary_recall': 0.9927934, 'binary_specificity': 0.45430636, 'binary_f1_score': 0.98260176}
confusion matrix:
     0      1
0  691    830
1  214  29481
---- Validation: 
scalar performance:
{'acc': 0.70179546, 'precision': 0.76523286, 'recall': 0.7057348, 'specificity': 0.7057348, 'f1': 0.68533325, 'auroc': 0.8584473, 'binary_precision': 0.63135594, 'binary_recall': 0.94603175, 'binary_specificity': 0.4654378, 'binary_f1_score': 0.7573062}
confusion matrix:
     0    1
0  303  348
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7867849, 'recall': 0.6999912, 'specificity': 0.6999912, 'f1': 0.68620634, 'auroc': 0.88274044, 'binary_precision': 0.65768194, 'binary_recall': 0.9644269, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.7820513}
confusion matrix:
    0    1
0  98  127
1   9  244
early stop counter: 6
val acc:0.7017954587936401, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 19,now: 2024-07-12 15:20:35.690234,epoch time: 0:09:43.555719,used: 3:05:12.579103,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96694005, 'precision': 0.86161953, 'recall': 0.7374753, 'specificity': 0.7374753, 'f1': 0.78515494, 'auroc': 0.9503236, 'binary_precision': 0.9740036, 'binary_recall': 0.9917158, 'binary_specificity': 0.4832347, 'binary_f1_score': 0.98277986}
confusion matrix:
     0      1
0  735    786
1  246  29449
---- Validation: 
scalar performance:
{'acc': 0.70882124, 'precision': 0.76758325, 'recall': 0.712596, 'specificity': 0.712596, 'f1': 0.6942116, 'auroc': 0.86059296, 'binary_precision': 0.6380236, 'binary_recall': 0.94285715, 'binary_specificity': 0.48233488, 'binary_f1_score': 0.7610506}
confusion matrix:
     0    1
0  314  337
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7931548, 'recall': 0.7111023, 'specificity': 0.7111023, 'f1': 0.6998221, 'auroc': 0.8854457, 'binary_precision': 0.6666667, 'binary_recall': 0.9644269, 'binary_specificity': 0.45777777, 'binary_f1_score': 0.78836834}
confusion matrix:
     0    1
0  103  122
1    9  244
early stop counter: 7
val acc:0.7088212370872498, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 20,now: 2024-07-12 15:30:21.065311,epoch time: 0:09:45.375077,used: 3:14:57.954180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96806127, 'precision': 0.87521815, 'recall': 0.73837644, 'specificity': 0.73837644, 'f1': 0.7897829, 'auroc': 0.95078605, 'binary_precision': 0.974065, 'binary_recall': 0.99286073, 'binary_specificity': 0.48389217, 'binary_f1_score': 0.98337305}
confusion matrix:
     0      1
0  736    785
1  212  29483
---- Validation: 
scalar performance:
{'acc': 0.7041374, 'precision': 0.7656568, 'recall': 0.7080133, 'specificity': 0.7080133, 'f1': 0.68838656, 'auroc': 0.8628216, 'binary_precision': 0.6336528, 'binary_recall': 0.9444444, 'binary_specificity': 0.47158217, 'binary_f1_score': 0.7584448}
confusion matrix:
     0    1
0  307  344
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7217573, 'precision': 0.7906127, 'recall': 0.7066579, 'specificity': 0.7066579, 'f1': 0.6944072, 'auroc': 0.88806325, 'binary_precision': 0.6630435, 'binary_recall': 0.9644269, 'binary_specificity': 0.4488889, 'binary_f1_score': 0.78582937}
confusion matrix:
     0    1
0  101  124
1    9  244
early stop counter: 8
val acc:0.70413738489151, best validation acc: 0.7103825211524963, corresponding to test acc:                         0.7364016771316528 / 0.7405857443809509
after epoch: 21,now: 2024-07-12 15:40:01.660711,epoch time: 0:09:40.595400,used: 3:24:38.549580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96694005, 'precision': 0.8570513, 'recall': 0.74371314, 'specificity': 0.74371314, 'f1': 0.78839445, 'auroc': 0.9528472, 'binary_precision': 0.97463155, 'binary_recall': 0.99104226, 'binary_specificity': 0.49638397, 'binary_f1_score': 0.9827684}
confusion matrix:
     0      1
0  755    766
1  266  29429
---- Validation: 
scalar performance:
{'acc': 0.715847, 'precision': 0.77009845, 'recall': 0.71945727, 'specificity': 0.71945727, 'f1': 0.7029418, 'auroc': 0.86375535, 'binary_precision': 0.6448802, 'binary_recall': 0.93968254, 'binary_specificity': 0.49923196, 'binary_f1_score': 0.7648579}
confusion matrix:
     0    1
0  325  326
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.8888011, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
better model found
persisted
after epoch: 22,now: 2024-07-12 15:49:43.231953,epoch time: 0:09:41.571242,used: 3:34:20.120822,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96726036, 'precision': 0.86280805, 'recall': 0.74107444, 'specificity': 0.74107444, 'f1': 0.7882099, 'auroc': 0.952029, 'binary_precision': 0.9743573, 'binary_recall': 0.9916821, 'binary_specificity': 0.4904668, 'binary_f1_score': 0.98294336}
confusion matrix:
     0      1
0  746    775
1  247  29448
---- Validation: 
scalar performance:
{'acc': 0.71272445, 'precision': 0.77003014, 'recall': 0.71643627, 'specificity': 0.71643627, 'f1': 0.6988455, 'auroc': 0.86587906, 'binary_precision': 0.6414687, 'binary_recall': 0.94285715, 'binary_specificity': 0.49001536, 'binary_f1_score': 0.76349616}
confusion matrix:
     0    1
0  319  332
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.8911902, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
early stop counter: 1
val acc:0.7127244472503662, best validation acc: 0.7158470153808594, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 23,now: 2024-07-12 15:59:25.146039,epoch time: 0:09:41.914086,used: 3:44:02.034908,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96786904, 'precision': 0.8647425, 'recall': 0.748256, 'specificity': 0.748256, 'f1': 0.794108, 'auroc': 0.95408237, 'binary_precision': 0.9750646, 'binary_recall': 0.9915811, 'binary_specificity': 0.504931, 'binary_f1_score': 0.9832534}
confusion matrix:
     0      1
0  768    753
1  250  29445
---- Validation: 
scalar performance:
{'acc': 0.71662766, 'precision': 0.7724756, 'recall': 0.7202765, 'specificity': 0.7202765, 'f1': 0.70345354, 'auroc': 0.86708117, 'binary_precision': 0.64495116, 'binary_recall': 0.94285715, 'binary_specificity': 0.49769586, 'binary_f1_score': 0.7659575}
confusion matrix:
     0    1
0  324  327
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.89231443, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
better model found
persisted
after epoch: 24,now: 2024-07-12 16:09:07.704709,epoch time: 0:09:42.558670,used: 3:53:44.593578,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9686379, 'precision': 0.8674927, 'recall': 0.75676936, 'specificity': 0.75676936, 'f1': 0.80113375, 'auroc': 0.9574708, 'binary_precision': 0.9759032, 'binary_recall': 0.9915137, 'binary_specificity': 0.522025, 'binary_f1_score': 0.9836465}
confusion matrix:
     0      1
0  794    727
1  252  29443
---- Validation: 
scalar performance:
{'acc': 0.7096019, 'precision': 0.7710842, 'recall': 0.71344084, 'specificity': 0.71344084, 'f1': 0.6944791, 'auroc': 0.8692975, 'binary_precision': 0.63782054, 'binary_recall': 0.947619, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.7624521}
confusion matrix:
     0    1
0  312  339
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.8951603, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
early stop counter: 1
val acc:0.709601879119873, best validation acc: 0.7166276574134827, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 25,now: 2024-07-12 16:18:53.317914,epoch time: 0:09:45.613205,used: 4:03:30.206783,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9688621, 'precision': 0.874768, 'recall': 0.75096124, 'specificity': 0.75096124, 'f1': 0.7991836, 'auroc': 0.95930374, 'binary_precision': 0.97531027, 'binary_recall': 0.99238926, 'binary_specificity': 0.5095332, 'binary_f1_score': 0.9837757}
confusion matrix:
     0      1
0  775    746
1  226  29469
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.7672462, 'recall': 0.7072965, 'specificity': 0.7072965, 'f1': 0.6869807, 'auroc': 0.8717699, 'binary_precision': 0.63241524, 'binary_recall': 0.947619, 'binary_specificity': 0.4669739, 'binary_f1_score': 0.75857687}
confusion matrix:
     0    1
0  304  347
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.7988261, 'recall': 0.7083882, 'specificity': 0.7083882, 'f1': 0.6954356, 'auroc': 0.89798856, 'binary_precision': 0.66307276, 'binary_recall': 0.972332, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.7884615}
confusion matrix:
     0    1
0  100  125
1    7  246
early stop counter: 2
val acc:0.7033567428588867, best validation acc: 0.7166276574134827, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 26,now: 2024-07-12 16:28:40.545084,epoch time: 0:09:47.227170,used: 4:13:17.433953,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96841365, 'precision': 0.8732004, 'recall': 0.74604714, 'specificity': 0.74604714, 'f1': 0.7950454, 'auroc': 0.9587257, 'binary_precision': 0.9748272, 'binary_recall': 0.99242294, 'binary_specificity': 0.49967128, 'binary_f1_score': 0.9835464}
confusion matrix:
     0      1
0  760    761
1  225  29470
---- Validation: 
scalar performance:
{'acc': 0.6955503, 'precision': 0.76243436, 'recall': 0.69961596, 'specificity': 0.69961596, 'f1': 0.6775074, 'auroc': 0.8728696, 'binary_precision': 0.6257862, 'binary_recall': 0.947619, 'binary_specificity': 0.4516129, 'binary_f1_score': 0.7537879}
confusion matrix:
     0    1
0  294  357
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.79642534, 'recall': 0.7039438, 'specificity': 0.7039438, 'f1': 0.6899409, 'auroc': 0.8994994, 'binary_precision': 0.6595174, 'binary_recall': 0.972332, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.78594244}
confusion matrix:
    0    1
0  98  127
1   7  246
early stop counter: 3
val acc:0.6955503225326538, best validation acc: 0.7166276574134827, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 27,now: 2024-07-12 16:38:24.752795,epoch time: 0:09:44.207711,used: 4:23:01.641664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96905434, 'precision': 0.8638804, 'recall': 0.7685283, 'specificity': 0.7685283, 'f1': 0.8081337, 'auroc': 0.960019, 'binary_precision': 0.97708327, 'binary_recall': 0.9907055, 'binary_specificity': 0.5463511, 'binary_f1_score': 0.98384726}
confusion matrix:
     0      1
0  831    690
1  276  29419
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.77252185, 'recall': 0.715745, 'specificity': 0.715745, 'f1': 0.69727314, 'auroc': 0.8738936, 'binary_precision': 0.63987136, 'binary_recall': 0.947619, 'binary_specificity': 0.48387095, 'binary_f1_score': 0.7639156}
confusion matrix:
     0    1
0  315  336
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.80268294, 'recall': 0.7219675, 'specificity': 0.7219675, 'f1': 0.71243316, 'auroc': 0.90044796, 'binary_precision': 0.6749311, 'binary_recall': 0.96837944, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79545456}
confusion matrix:
     0    1
0  107  118
1    8  245
early stop counter: 4
val acc:0.7119438052177429, best validation acc: 0.7166276574134827, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 28,now: 2024-07-12 16:48:07.170038,epoch time: 0:09:42.417243,used: 4:32:44.058907,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9691504, 'precision': 0.86576045, 'recall': 0.76733124, 'specificity': 0.76733124, 'f1': 0.80796087, 'auroc': 0.96283376, 'binary_precision': 0.9769588, 'binary_recall': 0.9909412, 'binary_specificity': 0.54372126, 'binary_f1_score': 0.98390037}
confusion matrix:
     0      1
0  827    694
1  269  29426
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.76964575, 'recall': 0.7111367, 'specificity': 0.7111367, 'f1': 0.6916754, 'auroc': 0.8753493, 'binary_precision': 0.6357827, 'binary_recall': 0.947619, 'binary_specificity': 0.47465438, 'binary_f1_score': 0.7609943}
confusion matrix:
     0    1
0  309  342
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.8014507, 'recall': 0.7197453, 'specificity': 0.7197453, 'f1': 0.70976704, 'auroc': 0.90245056, 'binary_precision': 0.6730769, 'binary_recall': 0.96837944, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.7941653}
confusion matrix:
     0    1
0  106  119
1    8  245
early stop counter: 5
val acc:0.7072599530220032, best validation acc: 0.7166276574134827, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 29,now: 2024-07-12 16:57:50.718582,epoch time: 0:09:43.548544,used: 4:42:27.607451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9691504, 'precision': 0.8707361, 'recall': 0.76046956, 'specificity': 0.76046956, 'f1': 0.8048205, 'auroc': 0.9627427, 'binary_precision': 0.9762631, 'binary_recall': 0.9916821, 'binary_specificity': 0.52925706, 'binary_f1_score': 0.9839122}
confusion matrix:
     0      1
0  805    716
1  247  29448
---- Validation: 
scalar performance:
{'acc': 0.6986729, 'precision': 0.76654065, 'recall': 0.70273936, 'specificity': 0.70273936, 'f1': 0.6808151, 'auroc': 0.87623924, 'binary_precision': 0.6278826, 'binary_recall': 0.9507936, 'binary_specificity': 0.4546851, 'binary_f1_score': 0.75631315}
confusion matrix:
     0    1
0  296  355
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.79642534, 'recall': 0.7039438, 'specificity': 0.7039438, 'f1': 0.6899409, 'auroc': 0.90301275, 'binary_precision': 0.6595174, 'binary_recall': 0.972332, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.78594244}
confusion matrix:
    0    1
0  98  127
1   7  246
early stop counter: 6
val acc:0.698672890663147, best validation acc: 0.7166276574134827, corresponding to test acc:                         0.7343096137046814 / 0.7405857443809509
after epoch: 30,now: 2024-07-12 17:07:34.945328,epoch time: 0:09:44.226746,used: 4:52:11.834197,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_15_23_seed_1_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:52:11.834197 at 2024-07-12 17:07:34.945328
persisted model performance metric: 

scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.89231443, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
oracle model performance metric: 

scalar performance:
{'acc': 0.74058574, 'precision': 0.80201775, 'recall': 0.72665787, 'specificity': 0.72665787, 'f1': 0.71846026, 'auroc': 0.8669829, 'binary_precision': 0.67966574, 'binary_recall': 0.9644269, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.79738563}
confusion matrix:
     0    1
0  110  115
1    9  244
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  35394 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |   4088 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4385    |  100305 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57741 K  |   57740 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4385    |  100305 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57741 K  |   57740 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      19    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    1972    |   57314 K  |   57314 K  |
|       from large pool |      10    |      22    |   24954 K  |   24954 K  |
|       from small pool |      29    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57314 K  |   57314 K  |
|       from large pool |       3    |      22    |   24954 K  |   24954 K  |
|       from small pool |       0    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57314 K  |   57314 K  |
|       from large pool |       3    |      22    |   24954 K  |   24954 K  |
|       from small pool |       0    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843

 Experiment start at: 2024-07-12 17:21:28.947937
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.887143, 'precision': 0.5318537, 'recall': 0.55218613, 'specificity': 0.55218613, 'f1': 0.53703886, 'auroc': 0.61663735, 'binary_precision': 0.9569112, 'binary_recall': 0.9229739, 'binary_specificity': 0.18139842, 'binary_f1_score': 0.93963623}
confusion matrix:
      0      1
0   275   1241
1  2300  27560
---- Validation: 
scalar performance:
{'acc': 0.5164319, 'precision': 0.60190845, 'recall': 0.52779686, 'specificity': 0.52779686, 'f1': 0.41690364, 'auroc': 0.689691, 'binary_precision': 0.5016892, 'binary_recall': 0.95498395, 'binary_specificity': 0.10060976, 'binary_f1_score': 0.6578073}
confusion matrix:
    0    1
0  66  590
1  28  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53894734, 'precision': 0.46395272, 'recall': 0.49613005, 'specificity': 0.49613005, 'f1': 0.36996162, 'auroc': 0.3053053, 'binary_precision': 0.54329, 'binary_recall': 0.969112, 'binary_specificity': 0.023148147, 'binary_f1_score': 0.69625515}
confusion matrix:
   0    1
0  5  211
1  8  251
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 17:31:14.999076,epoch time: 0:09:46.051139,used: 0:09:46.051139,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9450854, 'precision': 0.5973805, 'recall': 0.5265886, 'specificity': 0.5265886, 'f1': 0.5359698, 'auroc': 0.6679666, 'binary_precision': 0.95415956, 'binary_recall': 0.98985267, 'binary_specificity': 0.06332454, 'binary_f1_score': 0.9716785}
confusion matrix:
     0      1
0   96   1420
1  303  29557
---- Validation: 
scalar performance:
{'acc': 0.49530515, 'precision': 0.64016974, 'recall': 0.5082175, 'specificity': 0.5082175, 'f1': 0.3507709, 'auroc': 0.7186158, 'binary_precision': 0.49086577, 'binary_recall': 0.99356914, 'binary_specificity': 0.022865854, 'binary_f1_score': 0.65709734}
confusion matrix:
    0    1
0  15  641
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.3425926, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
new oracle model saved
early stop counter: 1
val acc:0.4953051507472992, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 2,now: 2024-07-12 17:41:02.051281,epoch time: 0:09:47.052205,used: 0:19:33.103344,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9495793, 'precision': 0.63794947, 'recall': 0.51767904, 'specificity': 0.51767904, 'f1': 0.5222961, 'auroc': 0.72265255, 'binary_precision': 0.95331836, 'binary_recall': 0.9957803, 'binary_specificity': 0.039577838, 'binary_f1_score': 0.9740868}
confusion matrix:
     0      1
0   60   1456
1  126  29734
---- Validation: 
scalar performance:
{'acc': 0.49295774, 'precision': 0.6615324, 'recall': 0.5060142, 'specificity': 0.5060142, 'f1': 0.3433599, 'auroc': 0.7389108, 'binary_precision': 0.48973143, 'binary_recall': 0.99678457, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65677965}
confusion matrix:
    0    1
0  10  646
1   2  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.3892643, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 2
val acc:0.49295774102211, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 3,now: 2024-07-12 17:50:53.559127,epoch time: 0:09:51.507846,used: 0:29:24.611190,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9508542, 'precision': 0.67952955, 'recall': 0.5170966, 'specificity': 0.5170966, 'f1': 0.5212382, 'auroc': 0.76108646, 'binary_precision': 0.95326203, 'binary_recall': 0.99725384, 'binary_specificity': 0.036939315, 'binary_f1_score': 0.97476184}
confusion matrix:
    0      1
0  56   1460
1  82  29778
---- Validation: 
scalar performance:
{'acc': 0.49374023, 'precision': 0.69961256, 'recall': 0.5068181, 'specificity': 0.5068181, 'f1': 0.34373787, 'auroc': 0.75464, 'binary_precision': 0.49013418, 'binary_recall': 0.9983923, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65749073}
confusion matrix:
    0    1
0  10  646
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.4384563, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 3
val acc:0.4937402307987213, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 4,now: 2024-07-12 18:00:45.796423,epoch time: 0:09:52.237296,used: 0:39:16.848486,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9519697, 'precision': 0.7424792, 'recall': 0.5242571, 'specificity': 0.5242571, 'f1': 0.5340235, 'auroc': 0.80996156, 'binary_precision': 0.953924, 'binary_recall': 0.9977227, 'binary_specificity': 0.050791558, 'binary_f1_score': 0.97533184}
confusion matrix:
    0      1
0  77   1439
1  68  29792
---- Validation: 
scalar performance:
{'acc': 0.4945227, 'precision': 0.703594, 'recall': 0.5075803, 'specificity': 0.5075803, 'f1': 0.34538653, 'auroc': 0.76770693, 'binary_precision': 0.49052134, 'binary_recall': 0.9983923, 'binary_specificity': 0.016768293, 'binary_f1_score': 0.65783894}
confusion matrix:
    0    1
0  11  645
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.4873445, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 4
val acc:0.49452269077301025, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 5,now: 2024-07-12 18:10:30.450022,epoch time: 0:09:44.653599,used: 0:49:01.502085,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9520653, 'precision': 0.75065756, 'recall': 0.5218028, 'specificity': 0.5218028, 'f1': 0.52971625, 'auroc': 0.8426999, 'binary_precision': 0.953696, 'binary_recall': 0.9980911, 'binary_specificity': 0.045514513, 'binary_f1_score': 0.97538865}
confusion matrix:
    0      1
0  69   1447
1  57  29803
---- Validation: 
scalar performance:
{'acc': 0.4976526, 'precision': 0.714788, 'recall': 0.51062906, 'specificity': 0.51062906, 'f1': 0.35193926, 'auroc': 0.77737284, 'binary_precision': 0.49207607, 'binary_recall': 0.9983923, 'binary_specificity': 0.022865854, 'binary_f1_score': 0.65923566}
confusion matrix:
    0    1
0  15  641
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.52672315, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 5
val acc:0.4976525902748108, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 6,now: 2024-07-12 18:20:15.457128,epoch time: 0:09:45.007106,used: 0:58:46.509191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9539457, 'precision': 0.84352964, 'recall': 0.5362528, 'specificity': 0.5362528, 'f1': 0.5552779, 'auroc': 0.8626957, 'binary_precision': 0.9550331, 'binary_recall': 0.99862695, 'binary_specificity': 0.07387863, 'binary_f1_score': 0.9763437}
confusion matrix:
     0      1
0  112   1404
1   41  29819
---- Validation: 
scalar performance:
{'acc': 0.5054773, 'precision': 0.7287724, 'recall': 0.518251, 'specificity': 0.518251, 'f1': 0.36803362, 'auroc': 0.78436744, 'binary_precision': 0.4960064, 'binary_recall': 0.9983923, 'binary_specificity': 0.038109757, 'binary_f1_score': 0.66275346}
confusion matrix:
    0    1
0  25  631
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5602031, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 6
val acc:0.5054773092269897, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 7,now: 2024-07-12 18:29:56.730932,epoch time: 0:09:41.273804,used: 1:08:27.782995,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9539457, 'precision': 0.8268682, 'recall': 0.54032266, 'specificity': 0.54032266, 'f1': 0.5619131, 'auroc': 0.8807137, 'binary_precision': 0.9554124, 'binary_recall': 0.99819154, 'binary_specificity': 0.082453825, 'binary_f1_score': 0.97633356}
confusion matrix:
     0      1
0  125   1391
1   54  29806
---- Validation: 
scalar performance:
{'acc': 0.51564944, 'precision': 0.7061638, 'recall': 0.52803457, 'specificity': 0.52803457, 'f1': 0.3916415, 'auroc': 0.78884494, 'binary_precision': 0.50121653, 'binary_recall': 0.99356914, 'binary_specificity': 0.0625, 'binary_f1_score': 0.6663073}
confusion matrix:
    0    1
0  41  615
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5879451, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 7
val acc:0.5156494379043579, best validation acc: 0.5164319276809692, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 8,now: 2024-07-12 18:39:37.988392,epoch time: 0:09:41.257460,used: 1:18:09.040455,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95436, 'precision': 0.82803696, 'recall': 0.54742795, 'specificity': 0.54742795, 'f1': 0.5734353, 'auroc': 0.8921771, 'binary_precision': 0.95607394, 'binary_recall': 0.9978902, 'binary_specificity': 0.0969657, 'binary_f1_score': 0.9765346}
confusion matrix:
     0      1
0  147   1369
1   63  29797
---- Validation: 
scalar performance:
{'acc': 0.52582157, 'precision': 0.7116174, 'recall': 0.53790146, 'specificity': 0.53790146, 'f1': 0.41214174, 'auroc': 0.79308, 'binary_precision': 0.50656813, 'binary_recall': 0.9919614, 'binary_specificity': 0.083841465, 'binary_f1_score': 0.6706522}
confusion matrix:
    0    1
0  55  601
1   5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.61044973, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 9,now: 2024-07-12 18:49:19.318379,epoch time: 0:09:41.329987,used: 1:27:50.370442,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9553162, 'precision': 0.8350465, 'recall': 0.5617054, 'specificity': 0.5617054, 'f1': 0.59556496, 'auroc': 0.90233743, 'binary_precision': 0.95740646, 'binary_recall': 0.9974213, 'binary_specificity': 0.12598945, 'binary_f1_score': 0.97700435}
confusion matrix:
     0      1
0  191   1325
1   77  29783
---- Validation: 
scalar performance:
{'acc': 0.5406886, 'precision': 0.7056227, 'recall': 0.5522165, 'specificity': 0.5522165, 'f1': 0.44309348, 'auroc': 0.795869, 'binary_precision': 0.51469356, 'binary_recall': 0.98553056, 'binary_specificity': 0.11890244, 'binary_f1_score': 0.67622733}
confusion matrix:
    0    1
0  78  578
1   9  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.62676966, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 10,now: 2024-07-12 18:58:59.622508,epoch time: 0:09:40.304129,used: 1:37:30.674571,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9560492, 'precision': 0.85438275, 'recall': 0.5664735, 'specificity': 0.5664735, 'f1': 0.603279, 'auroc': 0.90740883, 'binary_precision': 0.95784974, 'binary_recall': 0.9977227, 'binary_specificity': 0.13522427, 'binary_f1_score': 0.97737974}
confusion matrix:
     0      1
0  205   1311
1   68  29792
---- Validation: 
scalar performance:
{'acc': 0.5547731, 'precision': 0.71458614, 'recall': 0.56589437, 'specificity': 0.56589437, 'f1': 0.4684571, 'auroc': 0.7984766, 'binary_precision': 0.5226302, 'binary_recall': 0.98392284, 'binary_specificity': 0.14786585, 'binary_f1_score': 0.68265474}
confusion matrix:
    0    1
0  97  559
1  10  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5705263, 'precision': 0.77969766, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.41135734, 'auroc': 0.643733, 'binary_precision': 0.55939525, 'binary_recall': 1.0, 'binary_specificity': 0.055555556, 'binary_f1_score': 0.7174515}
confusion matrix:
    0    1
0  12  204
1   0  259
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-12 19:08:40.018043,epoch time: 0:09:40.395535,used: 1:47:11.070106,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.957834, 'precision': 0.8601539, 'recall': 0.5915176, 'specificity': 0.5915176, 'f1': 0.6385752, 'auroc': 0.91506827, 'binary_precision': 0.96019995, 'binary_recall': 0.9970194, 'binary_specificity': 0.18601583, 'binary_f1_score': 0.9782633}
confusion matrix:
     0      1
0  282   1234
1   89  29771
---- Validation: 
scalar performance:
{'acc': 0.5766823, 'precision': 0.7217107, 'recall': 0.5871108, 'specificity': 0.5871108, 'f1': 0.50682163, 'auroc': 0.80012596, 'binary_precision': 0.53562003, 'binary_recall': 0.9790997, 'binary_specificity': 0.19512194, 'binary_f1_score': 0.69243884}
confusion matrix:
     0    1
0  128  528
1   13  609
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5936842, 'precision': 0.7865044, 'recall': 0.5532407, 'specificity': 0.5532407, 'f1': 0.46051, 'auroc': 0.6593379, 'binary_precision': 0.57300884, 'binary_recall': 1.0, 'binary_specificity': 0.106481485, 'binary_f1_score': 0.7285513}
confusion matrix:
    0    1
0  23  193
1   0  259
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-12 19:18:22.015389,epoch time: 0:09:41.997346,used: 1:56:53.067452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9587583, 'precision': 0.8672936, 'recall': 0.6020215, 'specificity': 0.6020215, 'f1': 0.6527353, 'auroc': 0.9157413, 'binary_precision': 0.96118826, 'binary_recall': 0.996919, 'binary_specificity': 0.20712401, 'binary_f1_score': 0.9787276}
confusion matrix:
     0      1
0  314   1202
1   92  29768
---- Validation: 
scalar performance:
{'acc': 0.58215964, 'precision': 0.7201961, 'recall': 0.5923629, 'specificity': 0.5923629, 'f1': 0.51680845, 'auroc': 0.8024273, 'binary_precision': 0.5390764, 'binary_recall': 0.97588426, 'binary_specificity': 0.20884146, 'binary_f1_score': 0.694508}
confusion matrix:
     0    1
0  137  519
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60210526, 'precision': 0.7890625, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.47744775, 'auroc': 0.6714214, 'binary_precision': 0.578125, 'binary_recall': 1.0, 'binary_specificity': 0.125, 'binary_f1_score': 0.7326733}
confusion matrix:
    0    1
0  27  189
1   0  259
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 19:28:04.652295,epoch time: 0:09:42.636906,used: 2:06:35.704358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9591089, 'precision': 0.8698013, 'recall': 0.6059625, 'specificity': 0.6059625, 'f1': 0.6579274, 'auroc': 0.9166882, 'binary_precision': 0.9615596, 'binary_recall': 0.9968855, 'binary_specificity': 0.21503958, 'binary_f1_score': 0.97890395}
confusion matrix:
     0      1
0  326   1190
1   93  29767
---- Validation: 
scalar performance:
{'acc': 0.5915493, 'precision': 0.72670996, 'recall': 0.6015092, 'specificity': 0.6015092, 'f1': 0.5313617, 'auroc': 0.8047555, 'binary_precision': 0.5448833, 'binary_recall': 0.97588426, 'binary_specificity': 0.22713415, 'binary_f1_score': 0.69930875}
confusion matrix:
     0    1
0  149  507
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.7707335, 'recall': 0.5605695, 'specificity': 0.5605695, 'f1': 0.47609484, 'auroc': 0.68084157, 'binary_precision': 0.5771812, 'binary_recall': 0.996139, 'binary_specificity': 0.125, 'binary_f1_score': 0.73087823}
confusion matrix:
    0    1
0  27  189
1   1  258
better model found
persisted
after epoch: 14,now: 2024-07-12 19:37:48.588156,epoch time: 0:09:43.935861,used: 2:16:19.640219,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9607981, 'precision': 0.87050045, 'recall': 0.6303303, 'specificity': 0.6303303, 'f1': 0.6872141, 'auroc': 0.9185045, 'binary_precision': 0.9638691, 'binary_recall': 0.9961487, 'binary_specificity': 0.26451188, 'binary_f1_score': 0.9797431}
confusion matrix:
     0      1
0  401   1115
1  115  29745
---- Validation: 
scalar performance:
{'acc': 0.6056338, 'precision': 0.72711396, 'recall': 0.61506206, 'specificity': 0.61506206, 'f1': 0.5547592, 'auroc': 0.8053609, 'binary_precision': 0.55422795, 'binary_recall': 0.9694534, 'binary_specificity': 0.26067072, 'binary_f1_score': 0.70526314}
confusion matrix:
     0    1
0  171  485
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.7461318, 'recall': 0.56596774, 'specificity': 0.56596774, 'f1': 0.48971426, 'auroc': 0.6892965, 'binary_precision': 0.5804989, 'binary_recall': 0.98841697, 'binary_specificity': 0.14351852, 'binary_f1_score': 0.73142856}
confusion matrix:
    0    1
0  31  185
1   3  256
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 19:47:33.079157,epoch time: 0:09:44.491001,used: 2:26:04.131220,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9596826, 'precision': 0.8434608, 'recall': 0.6316226, 'specificity': 0.6316226, 'f1': 0.68534243, 'auroc': 0.92690825, 'binary_precision': 0.9640087, 'binary_recall': 0.9947756, 'binary_specificity': 0.26846966, 'binary_f1_score': 0.9791505}
confusion matrix:
     0      1
0  407   1109
1  156  29704
---- Validation: 
scalar performance:
{'acc': 0.6111111, 'precision': 0.7306851, 'recall': 0.62039745, 'specificity': 0.62039745, 'f1': 0.5627563, 'auroc': 0.8076842, 'binary_precision': 0.55781686, 'binary_recall': 0.9694534, 'binary_specificity': 0.27134147, 'binary_f1_score': 0.70816207}
confusion matrix:
     0    1
0  178  478
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61263156, 'precision': 0.7534325, 'recall': 0.575227, 'specificity': 0.575227, 'f1': 0.5056114, 'auroc': 0.69850206, 'binary_precision': 0.58581233, 'binary_recall': 0.98841697, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.73563224}
confusion matrix:
    0    1
0  35  181
1   3  256
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-12 19:57:17.954190,epoch time: 0:09:44.875033,used: 2:35:49.006253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9624235, 'precision': 0.86632836, 'recall': 0.65748215, 'specificity': 0.65748215, 'f1': 0.71595913, 'auroc': 0.93216765, 'binary_precision': 0.9664639, 'binary_recall': 0.9950435, 'binary_specificity': 0.31992084, 'binary_f1_score': 0.9805455}
confusion matrix:
     0      1
0  485   1031
1  148  29712
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.7331748, 'recall': 0.6242084, 'specificity': 0.6242084, 'f1': 0.5684104, 'auroc': 0.80929434, 'binary_precision': 0.56040895, 'binary_recall': 0.9694534, 'binary_specificity': 0.27896342, 'binary_f1_score': 0.7102474}
confusion matrix:
     0    1
0  183  473
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105263, 'precision': 0.7411492, 'recall': 0.5732965, 'specificity': 0.5732965, 'f1': 0.50416136, 'auroc': 0.7054733, 'binary_precision': 0.5848624, 'binary_recall': 0.98455596, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.7338129}
confusion matrix:
    0    1
0  35  181
1   4  255
better model found
persisted
after epoch: 17,now: 2024-07-12 20:07:00.143930,epoch time: 0:09:42.189740,used: 2:45:31.195993,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9623916, 'precision': 0.85180223, 'recall': 0.66967523, 'specificity': 0.66967523, 'f1': 0.72544026, 'auroc': 0.9273107, 'binary_precision': 0.96764934, 'binary_recall': 0.99370396, 'binary_specificity': 0.34564644, 'binary_f1_score': 0.98050356}
confusion matrix:
     0      1
0  524    992
1  188  29672
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.73231673, 'recall': 0.6339503, 'specificity': 0.6339503, 'f1': 0.58471674, 'auroc': 0.81050503, 'binary_precision': 0.5677725, 'binary_recall': 0.96302253, 'binary_specificity': 0.30487806, 'binary_f1_score': 0.7143709}
confusion matrix:
     0    1
0  200  456
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6210526, 'precision': 0.75036913, 'recall': 0.5848706, 'specificity': 0.5848706, 'f1': 0.52341133, 'auroc': 0.71162236, 'binary_precision': 0.5916473, 'binary_recall': 0.98455596, 'binary_specificity': 0.18518518, 'binary_f1_score': 0.7391304}
confusion matrix:
    0    1
0  40  176
1   4  255
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-12 20:16:43.217184,epoch time: 0:09:43.073254,used: 2:55:14.269247,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9624235, 'precision': 0.8454711, 'recall': 0.6768926, 'specificity': 0.6768926, 'f1': 0.7309039, 'auroc': 0.9320827, 'binary_precision': 0.968353, 'binary_recall': 0.9929672, 'binary_specificity': 0.36081794, 'binary_f1_score': 0.98050565}
confusion matrix:
     0      1
0  547    969
1  210  29650
---- Validation: 
scalar performance:
{'acc': 0.63771516, 'precision': 0.7354189, 'recall': 0.6460204, 'specificity': 0.6460204, 'f1': 0.6031841, 'auroc': 0.8119093, 'binary_precision': 0.5769603, 'binary_recall': 0.9581994, 'binary_specificity': 0.33384147, 'binary_f1_score': 0.7202417}
confusion matrix:
     0    1
0  219  437
1   26  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62736845, 'precision': 0.74710166, 'recall': 0.5921993, 'specificity': 0.5921993, 'f1': 0.5368407, 'auroc': 0.71905833, 'binary_precision': 0.59624416, 'binary_recall': 0.980695, 'binary_specificity': 0.2037037, 'binary_f1_score': 0.7416059}
confusion matrix:
    0    1
0  44  172
1   5  254
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-12 20:26:27.121045,epoch time: 0:09:43.903861,used: 3:04:58.173108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9632522, 'precision': 0.8499299, 'recall': 0.6860939, 'specificity': 0.6860939, 'f1': 0.74013734, 'auroc': 0.93359107, 'binary_precision': 0.9692373, 'binary_recall': 0.9929002, 'binary_specificity': 0.3792876, 'binary_f1_score': 0.9809261}
confusion matrix:
     0      1
0  575    941
1  212  29648
---- Validation: 
scalar performance:
{'acc': 0.63849765, 'precision': 0.7314467, 'recall': 0.64665765, 'specificity': 0.64665765, 'f1': 0.6054248, 'auroc': 0.81479394, 'binary_precision': 0.5779727, 'binary_recall': 0.95337623, 'binary_specificity': 0.33993903, 'binary_f1_score': 0.7196602}
confusion matrix:
     0    1
0  223  433
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6315789, 'precision': 0.7431593, 'recall': 0.59721327, 'specificity': 0.59721327, 'f1': 0.54623365, 'auroc': 0.72981906, 'binary_precision': 0.59952605, 'binary_recall': 0.976834, 'binary_specificity': 0.2175926, 'binary_f1_score': 0.743025}
confusion matrix:
    0    1
0  47  169
1   6  253
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-12 20:36:11.712662,epoch time: 0:09:44.591617,used: 3:14:42.764725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9636028, 'precision': 0.85752785, 'recall': 0.6837735, 'specificity': 0.6837735, 'f1': 0.7396795, 'auroc': 0.9341504, 'binary_precision': 0.96900314, 'binary_recall': 0.99353653, 'binary_specificity': 0.37401056, 'binary_f1_score': 0.9811165}
confusion matrix:
     0      1
0  567    949
1  193  29667
---- Validation: 
scalar performance:
{'acc': 0.64162755, 'precision': 0.73347676, 'recall': 0.6497064, 'specificity': 0.6497064, 'f1': 0.60960907, 'auroc': 0.8167546, 'binary_precision': 0.5802348, 'binary_recall': 0.95337623, 'binary_specificity': 0.34603658, 'binary_f1_score': 0.72141117}
confusion matrix:
     0    1
0  227  429
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63789475, 'precision': 0.74833786, 'recall': 0.60415775, 'specificity': 0.60415775, 'f1': 0.5569799, 'auroc': 0.73655796, 'binary_precision': 0.6038186, 'binary_recall': 0.976834, 'binary_specificity': 0.23148148, 'binary_f1_score': 0.7463127}
confusion matrix:
    0    1
0  50  166
1   6  253
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-12 20:45:53.428193,epoch time: 0:09:41.715531,used: 3:24:24.480256,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9635709, 'precision': 0.8397219, 'recall': 0.70473254, 'specificity': 0.70473254, 'f1': 0.7534902, 'auroc': 0.9380429, 'binary_precision': 0.9710639, 'binary_recall': 0.9912592, 'binary_specificity': 0.4182058, 'binary_f1_score': 0.9810576}
confusion matrix:
     0      1
0  634    882
1  261  29599
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.73339945, 'recall': 0.655679, 'specificity': 0.655679, 'f1': 0.6189827, 'auroc': 0.8179879, 'binary_precision': 0.58531743, 'binary_recall': 0.948553, 'binary_specificity': 0.3628049, 'binary_f1_score': 0.72392637}
confusion matrix:
     0    1
0  238  418
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6463158, 'precision': 0.7428528, 'recall': 0.61418563, 'specificity': 0.61418563, 'f1': 0.57462686, 'auroc': 0.74356496, 'binary_precision': 0.6107056, 'binary_recall': 0.969112, 'binary_specificity': 0.25925925, 'binary_f1_score': 0.74925375}
confusion matrix:
    0    1
0  56  160
1   8  251
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-12 20:55:37.279840,epoch time: 0:09:43.851647,used: 3:34:08.331903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9640808, 'precision': 0.85354555, 'recall': 0.6959214, 'specificity': 0.6959214, 'f1': 0.7495518, 'auroc': 0.9399384, 'binary_precision': 0.9701849, 'binary_recall': 0.99276626, 'binary_specificity': 0.39907652, 'binary_f1_score': 0.98134565}
confusion matrix:
     0      1
0  605    911
1  216  29644
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.7340867, 'recall': 0.65271354, 'specificity': 0.65271354, 'f1': 0.6141397, 'auroc': 0.8208597, 'binary_precision': 0.5826772, 'binary_recall': 0.9517685, 'binary_specificity': 0.35365853, 'binary_f1_score': 0.7228327}
confusion matrix:
     0    1
0  232  424
1   30  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7435626, 'recall': 0.6068569, 'specificity': 0.6068569, 'f1': 0.56242424, 'auroc': 0.7512691, 'binary_precision': 0.6057692, 'binary_recall': 0.972973, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7466666}
confusion matrix:
    0    1
0  52  164
1   7  252
early stop counter: 1
val acc:0.6447574496269226, best validation acc: 0.6478873491287231, corresponding to test acc:                         0.6463158130645752 / 0.6463158130645752
after epoch: 23,now: 2024-07-12 21:05:22.438261,epoch time: 0:09:45.158421,used: 3:43:53.490324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9640171, 'precision': 0.84849584, 'recall': 0.700897, 'specificity': 0.700897, 'f1': 0.7525658, 'auroc': 0.94149053, 'binary_precision': 0.97067595, 'binary_recall': 0.9921634, 'binary_specificity': 0.4096306, 'binary_f1_score': 0.981302}
confusion matrix:
     0      1
0  621    895
1  234  29626
---- Validation: 
scalar performance:
{'acc': 0.6510172, 'precision': 0.73543054, 'recall': 0.65872777, 'specificity': 0.65872777, 'f1': 0.6230687, 'auroc': 0.8223889, 'binary_precision': 0.5876494, 'binary_recall': 0.948553, 'binary_specificity': 0.36890244, 'binary_f1_score': 0.72570723}
confusion matrix:
     0    1
0  242  414
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64842105, 'precision': 0.7445591, 'recall': 0.61650044, 'specificity': 0.61650044, 'f1': 0.5780338, 'auroc': 0.75704277, 'binary_precision': 0.61219513, 'binary_recall': 0.969112, 'binary_specificity': 0.2638889, 'binary_f1_score': 0.75037366}
confusion matrix:
    0    1
0  57  159
1   8  251
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-12 21:15:07.416617,epoch time: 0:09:44.978356,used: 3:53:38.468680,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9642402, 'precision': 0.8436193, 'recall': 0.71134555, 'specificity': 0.71134555, 'f1': 0.7598357, 'auroc': 0.94091225, 'binary_precision': 0.97170246, 'binary_recall': 0.9912927, 'binary_specificity': 0.43139842, 'binary_f1_score': 0.98139983}
confusion matrix:
     0      1
0  654    862
1  260  29600
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.7369436, 'recall': 0.6610143, 'specificity': 0.6610143, 'f1': 0.6261181, 'auroc': 0.8246902, 'binary_precision': 0.5894106, 'binary_recall': 0.948553, 'binary_specificity': 0.3734756, 'binary_f1_score': 0.7270487}
confusion matrix:
     0    1
0  245  411
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65052634, 'precision': 0.7462399, 'recall': 0.61881524, 'specificity': 0.61881524, 'f1': 0.58142227, 'auroc': 0.76331687, 'binary_precision': 0.6136919, 'binary_recall': 0.969112, 'binary_specificity': 0.2685185, 'binary_f1_score': 0.75149703}
confusion matrix:
    0    1
0  58  158
1   8  251
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-12 21:24:51.857370,epoch time: 0:09:44.440753,used: 4:03:22.909433,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9640808, 'precision': 0.8452406, 'recall': 0.7062527, 'specificity': 0.7062527, 'f1': 0.7561641, 'auroc': 0.94345796, 'binary_precision': 0.97120273, 'binary_recall': 0.9916611, 'binary_specificity': 0.42084432, 'binary_f1_score': 0.98132527}
confusion matrix:
     0      1
0  638    878
1  249  29611
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.7364402, 'recall': 0.6602521, 'specificity': 0.6602521, 'f1': 0.6251031, 'auroc': 0.8273641, 'binary_precision': 0.58882236, 'binary_recall': 0.948553, 'binary_specificity': 0.37195122, 'binary_f1_score': 0.726601}
confusion matrix:
     0    1
0  244  412
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65052634, 'precision': 0.7462399, 'recall': 0.61881524, 'specificity': 0.61881524, 'f1': 0.58142227, 'auroc': 0.77007365, 'binary_precision': 0.6136919, 'binary_recall': 0.969112, 'binary_specificity': 0.2685185, 'binary_f1_score': 0.75149703}
confusion matrix:
    0    1
0  58  158
1   8  251
early stop counter: 1
val acc:0.6525821685791016, best validation acc: 0.6533646583557129, corresponding to test acc:                         0.6505263447761536 / 0.6505263447761536
after epoch: 26,now: 2024-07-12 21:34:37.926974,epoch time: 0:09:46.069604,used: 4:13:08.979037,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9652601, 'precision': 0.85006654, 'recall': 0.7203343, 'specificity': 0.7203343, 'f1': 0.76869434, 'auroc': 0.9455106, 'binary_precision': 0.972569, 'binary_recall': 0.99146014, 'binary_specificity': 0.44920844, 'binary_f1_score': 0.98192376}
confusion matrix:
     0      1
0  681    835
1  255  29605
---- Validation: 
scalar performance:
{'acc': 0.6549296, 'precision': 0.7379476, 'recall': 0.6625387, 'specificity': 0.6625387, 'f1': 0.62814397, 'auroc': 0.8295667, 'binary_precision': 0.5905906, 'binary_recall': 0.948553, 'binary_specificity': 0.3765244, 'binary_f1_score': 0.7279457}
confusion matrix:
     0    1
0  247  409
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6547368, 'precision': 0.7495303, 'recall': 0.6234449, 'specificity': 0.6234449, 'f1': 0.58814454, 'auroc': 0.77619135, 'binary_precision': 0.6167076, 'binary_recall': 0.969112, 'binary_specificity': 0.2777778, 'binary_f1_score': 0.7537538}
confusion matrix:
    0    1
0  60  156
1   8  251
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-12 21:44:37.955686,epoch time: 0:10:00.028712,used: 4:23:09.007749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9657063, 'precision': 0.8464905, 'recall': 0.73340464, 'specificity': 0.73340464, 'f1': 0.77757585, 'auroc': 0.9524199, 'binary_precision': 0.9738575, 'binary_recall': 0.99055594, 'binary_specificity': 0.4762533, 'binary_f1_score': 0.9821358}
confusion matrix:
     0      1
0  722    794
1  282  29578
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.7434106, 'recall': 0.6709229, 'specificity': 0.6709229, 'f1': 0.6391869, 'auroc': 0.83137596, 'binary_precision': 0.597166, 'binary_recall': 0.948553, 'binary_specificity': 0.3932927, 'binary_f1_score': 0.7329193}
confusion matrix:
     0    1
0  258  398
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66105264, 'precision': 0.7543055, 'recall': 0.63038933, 'specificity': 0.63038933, 'f1': 0.5980944, 'auroc': 0.7829258, 'binary_precision': 0.6212871, 'binary_recall': 0.969112, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.7571644}
confusion matrix:
    0    1
0  63  153
1   8  251
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-12 21:54:26.897505,epoch time: 0:09:48.941819,used: 4:32:57.949568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9655469, 'precision': 0.84884405, 'recall': 0.7270595, 'specificity': 0.7270595, 'f1': 0.77352655, 'auroc': 0.9479848, 'binary_precision': 0.9732298, 'binary_recall': 0.9910583, 'binary_specificity': 0.46306068, 'binary_f1_score': 0.9820632}
confusion matrix:
     0      1
0  702    814
1  267  29593
---- Validation: 
scalar performance:
{'acc': 0.6651017, 'precision': 0.7443941, 'recall': 0.67244726, 'specificity': 0.67244726, 'f1': 0.641177, 'auroc': 0.832746, 'binary_precision': 0.5983773, 'binary_recall': 0.948553, 'binary_specificity': 0.39634147, 'binary_f1_score': 0.7338308}
confusion matrix:
     0    1
0  260  396
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66105264, 'precision': 0.74930143, 'recall': 0.63077366, 'specificity': 0.63077366, 'f1': 0.5996681, 'auroc': 0.7868583, 'binary_precision': 0.62189054, 'binary_recall': 0.96525097, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7564297}
confusion matrix:
    0    1
0  64  152
1   9  250
better model found
persisted
after epoch: 29,now: 2024-07-12 22:04:19.490966,epoch time: 0:09:52.593461,used: 4:42:50.543029,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9662162, 'precision': 0.85210276, 'recall': 0.7339856, 'specificity': 0.7339856, 'f1': 0.7797103, 'auroc': 0.9501511, 'binary_precision': 0.97390246, 'binary_recall': 0.9910583, 'binary_specificity': 0.47691292, 'binary_f1_score': 0.9824054}
confusion matrix:
     0      1
0  723    793
1  267  29593
---- Validation: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.745375, 'recall': 0.67397165, 'specificity': 0.67397165, 'f1': 0.6431619, 'auroc': 0.8344321, 'binary_precision': 0.5995935, 'binary_recall': 0.948553, 'binary_specificity': 0.39939025, 'binary_f1_score': 0.7347448}
confusion matrix:
     0    1
0  262  394
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66105264, 'precision': 0.74930143, 'recall': 0.63077366, 'specificity': 0.63077366, 'f1': 0.5996681, 'auroc': 0.7917918, 'binary_precision': 0.62189054, 'binary_recall': 0.96525097, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7564297}
confusion matrix:
    0    1
0  64  152
1   9  250
better model found
persisted
after epoch: 30,now: 2024-07-12 22:14:07.462230,epoch time: 0:09:47.971264,used: 4:52:38.514293,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_21_28_seed_2_21918843
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:52:38.514293 at 2024-07-12 22:14:07.462230
persisted model performance metric: 

scalar performance:
{'acc': 0.66105264, 'precision': 0.74930143, 'recall': 0.63077366, 'specificity': 0.63077366, 'f1': 0.5996681, 'auroc': 0.7917918, 'binary_precision': 0.62189054, 'binary_recall': 0.96525097, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7564297}
confusion matrix:
    0    1
0  64  152
1   9  250
oracle model performance metric: 

scalar performance:
{'acc': 0.66105264, 'precision': 0.7543055, 'recall': 0.63038933, 'specificity': 0.63038933, 'f1': 0.5980944, 'auroc': 0.7829258, 'binary_precision': 0.6212871, 'binary_recall': 0.969112, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.7571644}
confusion matrix:
    0    1
0  63  153
1   8  251
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |  16198 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1086 MiB | 585728 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     72 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37442 KiB | 104341 KiB | 365910 GiB | 365910 GiB |
|       from large pool |  31306 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |   6136 KiB |  11184 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4405    |  150557 K  |  150556 K  |
|       from large pool |      76    |     158    |   63852 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86705 K  |   86704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4405    |  150557 K  |  150556 K  |
|       from large pool |      76    |     158    |   63852 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86705 K  |   86704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      81    |      40    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      19    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    1983    |   85696 K  |   85696 K  |
|       from large pool |      10    |      22    |   36924 K  |   36924 K  |
|       from small pool |      31    |    1973    |   48771 K  |   48771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |      0 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |   1086 MiB |    864 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  38912 KiB |     72 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 104341 KiB | 365910 GiB | 365910 GiB |
|       from large pool |  23872 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |      0 KiB |  12070 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4405    |  150557 K  |  150557 K  |
|       from large pool |       2    |     158    |   63852 K  |   63852 K  |
|       from small pool |       0    |    4327    |   86705 K  |   86705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4405    |  150557 K  |  150557 K  |
|       from large pool |       2    |     158    |   63852 K  |   63852 K  |
|       from small pool |       0    |    4327    |   86705 K  |   86705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      81    |      60    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      19    |      36    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1983    |   85696 K  |   85696 K  |
|       from large pool |       3    |      22    |   36924 K  |   36924 K  |
|       from small pool |       0    |    1973    |   48771 K  |   48771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 22:21:54 2024]
Finished job 0.
1 of 1 steps (100%) done
