Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 14:41:36 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/3.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=3
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849

 Experiment start at: 2024-07-12 14:47:25.579204
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9267297, 'precision': 0.50840586, 'recall': 0.5049506, 'specificity': 0.5049506, 'f1': 0.504769, 'auroc': 0.44464612, 'binary_precision': 0.9516689, 'binary_recall': 0.9723518, 'binary_specificity': 0.037549406, 'binary_f1_score': 0.96189916}
confusion matrix:
     0      1
0   57   1461
1  818  28768
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.55124223, 'precision': 0.7324336, 'recall': 0.55731875, 'specificity': 0.55731875, 'f1': 0.45116496, 'auroc': 0.7281885, 'binary_precision': 0.52369076, 'binary_recall': 0.992126, 'binary_specificity': 0.122511484, 'binary_f1_score': 0.68552774}
confusion matrix:
    0    1
0  80  573
1   5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5690722, 'precision': 0.626266, 'recall': 0.51632214, 'specificity': 0.51632214, 'f1': 0.40621173, 'auroc': 0.6454608, 'binary_precision': 0.565032, 'binary_recall': 0.9814815, 'binary_specificity': 0.05116279, 'binary_f1_score': 0.7171854}
confusion matrix:
    0    1
0  11  204
1   5  265
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 14:57:03.253764,epoch time: 0:09:37.674560,used: 0:09:37.674560,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94753087, 'precision': 0.54354084, 'recall': 0.5046478, 'specificity': 0.5046478, 'f1': 0.4990648, 'auroc': 0.5336677, 'binary_precision': 0.9515978, 'binary_recall': 0.9954707, 'binary_specificity': 0.013824885, 'binary_f1_score': 0.97304}
confusion matrix:
     0      1
0   21   1498
1  134  29451
---- Validation: 
scalar performance:
{'acc': 0.51475155, 'precision': 0.72074044, 'recall': 0.5213961, 'specificity': 0.5213961, 'f1': 0.37853914, 'auroc': 0.76497567, 'binary_precision': 0.5039809, 'binary_recall': 0.9968504, 'binary_specificity': 0.045941807, 'binary_f1_score': 0.66948706}
confusion matrix:
    0    1
0  30  623
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56494844, 'precision': 0.7806653, 'recall': 0.5093023, 'specificity': 0.5093023, 'f1': 0.37778547, 'auroc': 0.6868217, 'binary_precision': 0.56133056, 'binary_recall': 1.0, 'binary_specificity': 0.018604651, 'binary_f1_score': 0.7190413}
confusion matrix:
   0    1
0  4  211
1  0  270
early stop counter: 1
val acc:0.5147515535354614, best validation acc: 0.5512422323226929, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 2,now: 2024-07-12 15:06:35.357364,epoch time: 0:09:32.103600,used: 0:19:09.778160,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9492991, 'precision': 0.534124, 'recall': 0.50181526, 'specificity': 0.50181526, 'f1': 0.49263385, 'auroc': 0.6295309, 'binary_precision': 0.95136493, 'binary_recall': 0.99770164, 'binary_specificity': 0.0059288535, 'binary_f1_score': 0.97398245}
confusion matrix:
    0      1
0   9   1509
1  68  29518
---- Validation: 
scalar performance:
{'acc': 0.5124224, 'precision': 0.75138557, 'recall': 0.5191424, 'specificity': 0.5191424, 'f1': 0.37143588, 'auroc': 0.7917836, 'binary_precision': 0.5027712, 'binary_recall': 1.0, 'binary_specificity': 0.03828484, 'binary_f1_score': 0.66912544}
confusion matrix:
    0    1
0  25  628
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5587629, 'precision': 0.77892566, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.36271983, 'auroc': 0.72627044, 'binary_precision': 0.55785125, 'binary_recall': 1.0, 'binary_specificity': 0.004651163, 'binary_f1_score': 0.7161804}
confusion matrix:
   0    1
0  1  214
1  0  270
early stop counter: 2
val acc:0.5124223828315735, best validation acc: 0.5512422323226929, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 3,now: 2024-07-12 15:16:08.600801,epoch time: 0:09:33.243437,used: 0:28:43.021597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95045656, 'precision': 0.63714564, 'recall': 0.50587344, 'specificity': 0.50587344, 'f1': 0.49994135, 'auroc': 0.72640467, 'binary_precision': 0.9517106, 'binary_recall': 0.99858034, 'binary_specificity': 0.013166557, 'binary_f1_score': 0.97458225}
confusion matrix:
    0      1
0  20   1499
1  42  29543
---- Validation: 
scalar performance:
{'acc': 0.52251554, 'precision': 0.754, 'recall': 0.5290965, 'specificity': 0.5290965, 'f1': 0.3918628, 'auroc': 0.81111765, 'binary_precision': 0.508, 'binary_recall': 1.0, 'binary_specificity': 0.058192957, 'binary_f1_score': 0.6737401}
confusion matrix:
    0    1
0  38  615
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5587629, 'precision': 0.77892566, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.36271983, 'auroc': 0.7563824, 'binary_precision': 0.55785125, 'binary_recall': 1.0, 'binary_specificity': 0.004651163, 'binary_f1_score': 0.7161804}
confusion matrix:
   0    1
0  1  214
1  0  270
early stop counter: 3
val acc:0.5225155353546143, best validation acc: 0.5512422323226929, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 4,now: 2024-07-12 15:25:30.785181,epoch time: 0:09:22.184380,used: 0:38:05.205977,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95154965, 'precision': 0.7638886, 'recall': 0.5133101, 'specificity': 0.5133101, 'f1': 0.513968, 'auroc': 0.79624677, 'binary_precision': 0.95243466, 'binary_recall': 0.9989522, 'binary_specificity': 0.027667984, 'binary_f1_score': 0.97513896}
confusion matrix:
    0      1
0  42   1476
1  31  29555
---- Validation: 
scalar performance:
{'acc': 0.53959626, 'precision': 0.7585505, 'recall': 0.5459418, 'specificity': 0.5459418, 'f1': 0.42499956, 'auroc': 0.8220641, 'binary_precision': 0.517101, 'binary_recall': 1.0, 'binary_specificity': 0.091883615, 'binary_f1_score': 0.6816962}
confusion matrix:
    0    1
0  60  593
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5628866, 'precision': 0.780083, 'recall': 0.5069767, 'specificity': 0.5069767, 'f1': 0.37280402, 'auroc': 0.77827734, 'binary_precision': 0.560166, 'binary_recall': 1.0, 'binary_specificity': 0.013953488, 'binary_f1_score': 0.7180851}
confusion matrix:
   0    1
0  3  212
1  0  270
early stop counter: 4
val acc:0.5395962595939636, best validation acc: 0.5512422323226929, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 5,now: 2024-07-12 15:34:50.877494,epoch time: 0:09:20.092313,used: 0:47:25.298290,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95071375, 'precision': 0.6883186, 'recall': 0.51287067, 'specificity': 0.51287067, 'f1': 0.5133236, 'auroc': 0.84319055, 'binary_precision': 0.9523948, 'binary_recall': 0.9980734, 'binary_specificity': 0.027667984, 'binary_f1_score': 0.9746992}
confusion matrix:
    0      1
0  42   1476
1  57  29529
---- Validation: 
scalar performance:
{'acc': 0.55279505, 'precision': 0.75587106, 'recall': 0.55893695, 'specificity': 0.55893695, 'f1': 0.4503752, 'auroc': 0.8298731, 'binary_precision': 0.52440035, 'binary_recall': 0.9984252, 'binary_specificity': 0.1194487, 'binary_f1_score': 0.68763566}
confusion matrix:
    0    1
0  78  575
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5690722, 'precision': 0.78183717, 'recall': 0.5139535, 'specificity': 0.5139535, 'f1': 0.38762996, 'auroc': 0.7929543, 'binary_precision': 0.56367433, 'binary_recall': 1.0, 'binary_specificity': 0.027906977, 'binary_f1_score': 0.7209613}
confusion matrix:
   0    1
0  6  209
1  0  270
better model found
persisted
after epoch: 6,now: 2024-07-12 15:44:13.021097,epoch time: 0:09:22.143603,used: 0:56:47.441893,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9519033, 'precision': 0.7845685, 'recall': 0.5194368, 'specificity': 0.5194368, 'f1': 0.5253556, 'auroc': 0.8670162, 'binary_precision': 0.95297533, 'binary_recall': 0.9987156, 'binary_specificity': 0.040158, 'binary_f1_score': 0.97530943}
confusion matrix:
    0      1
0  61   1458
1  38  29547
---- Validation: 
scalar performance:
{'acc': 0.5659938, 'precision': 0.75099325, 'recall': 0.5719104, 'specificity': 0.5719104, 'f1': 0.47549936, 'auroc': 0.8339324, 'binary_precision': 0.53198653, 'binary_recall': 0.9952756, 'binary_specificity': 0.14854518, 'binary_f1_score': 0.6933626}
confusion matrix:
    0    1
0  97  556
1   3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57113403, 'precision': 0.7824268, 'recall': 0.51627904, 'specificity': 0.51627904, 'f1': 0.3924941, 'auroc': 0.8042722, 'binary_precision': 0.56485355, 'binary_recall': 1.0, 'binary_specificity': 0.03255814, 'binary_f1_score': 0.72192514}
confusion matrix:
   0    1
0  7  208
1  0  270
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 15:53:34.517660,epoch time: 0:09:21.496563,used: 1:06:08.938456,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95244986, 'precision': 0.7919625, 'recall': 0.53096557, 'specificity': 0.53096557, 'f1': 0.5457636, 'auroc': 0.8863393, 'binary_precision': 0.95405495, 'binary_recall': 0.99807334, 'binary_specificity': 0.0638578, 'binary_f1_score': 0.9755679}
confusion matrix:
    0      1
0  97   1422
1  57  29528
---- Validation: 
scalar performance:
{'acc': 0.58152175, 'precision': 0.7504573, 'recall': 0.5871809, 'specificity': 0.5871809, 'f1': 0.5033477, 'auroc': 0.836329, 'binary_precision': 0.5412371, 'binary_recall': 0.992126, 'binary_specificity': 0.18223584, 'binary_f1_score': 0.7003891}
confusion matrix:
     0    1
0  119  534
1    5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5814433, 'precision': 0.74984837, 'recall': 0.5283807, 'specificity': 0.5283807, 'f1': 0.4197915, 'auroc': 0.8121964, 'binary_precision': 0.57112527, 'binary_recall': 0.9962963, 'binary_specificity': 0.060465116, 'binary_f1_score': 0.72604585}
confusion matrix:
    0    1
0  13  202
1   1  269
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 16:02:55.560191,epoch time: 0:09:21.042531,used: 1:15:29.980987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9530929, 'precision': 0.79970145, 'recall': 0.54285735, 'specificity': 0.54285735, 'f1': 0.5655295, 'auroc': 0.89609855, 'binary_precision': 0.9551722, 'binary_recall': 0.99749875, 'binary_specificity': 0.08821593, 'binary_f1_score': 0.9758767}
confusion matrix:
     0      1
0  134   1385
1   74  29511
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.7496525, 'recall': 0.6039611, 'specificity': 0.6039611, 'f1': 0.5329193, 'auroc': 0.8373467, 'binary_precision': 0.5519366, 'binary_recall': 0.98740155, 'binary_specificity': 0.22052068, 'binary_f1_score': 0.70807457}
confusion matrix:
     0    1
0  144  509
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6082474, 'precision': 0.7751496, 'recall': 0.55861324, 'specificity': 0.55861324, 'f1': 0.47694352, 'auroc': 0.81698537, 'binary_precision': 0.58733624, 'binary_recall': 0.9962963, 'binary_specificity': 0.12093023, 'binary_f1_score': 0.739011}
confusion matrix:
    0    1
0  26  189
1   1  269
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 16:12:17.285542,epoch time: 0:09:21.725351,used: 1:24:51.706338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9549254, 'precision': 0.8321595, 'recall': 0.5638316, 'specificity': 0.5638316, 'f1': 0.5985183, 'auroc': 0.9075848, 'binary_precision': 0.9571762, 'binary_recall': 0.99722844, 'binary_specificity': 0.13043478, 'binary_f1_score': 0.9767919}
confusion matrix:
     0      1
0  198   1320
1   82  29504
---- Validation: 
scalar performance:
{'acc': 0.6040373, 'precision': 0.7419487, 'recall': 0.60923415, 'specificity': 0.60923415, 'f1': 0.543808, 'auroc': 0.8382149, 'binary_precision': 0.55575377, 'binary_recall': 0.98110235, 'binary_specificity': 0.237366, 'binary_f1_score': 0.7095671}
confusion matrix:
     0    1
0  155  498
1   12  623
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62474227, 'precision': 0.77208006, 'recall': 0.5776916, 'specificity': 0.5776916, 'f1': 0.5121479, 'auroc': 0.82049954, 'binary_precision': 0.59821427, 'binary_recall': 0.9925926, 'binary_specificity': 0.1627907, 'binary_f1_score': 0.7465181}
confusion matrix:
    0    1
0  35  180
1   2  268
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-12 16:21:41.766013,epoch time: 0:09:24.480471,used: 1:34:16.186809,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95672584, 'precision': 0.8450756, 'recall': 0.5884839, 'specificity': 0.5884839, 'f1': 0.6335091, 'auroc': 0.90695393, 'binary_precision': 0.9594845, 'binary_recall': 0.9965861, 'binary_specificity': 0.18038183, 'binary_f1_score': 0.9776834}
confusion matrix:
     0      1
0  274   1245
1  101  29484
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.7399299, 'recall': 0.61378497, 'specificity': 0.61378497, 'f1': 0.55205566, 'auroc': 0.83937967, 'binary_precision': 0.5589559, 'binary_recall': 0.9779528, 'binary_specificity': 0.24961714, 'binary_f1_score': 0.71134025}
confusion matrix:
     0    1
0  163  490
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63917524, 'precision': 0.7811276, 'recall': 0.5939707, 'specificity': 0.5939707, 'f1': 0.53909606, 'auroc': 0.8254436, 'binary_precision': 0.60770977, 'binary_recall': 0.9925926, 'binary_specificity': 0.19534884, 'binary_f1_score': 0.7538678}
confusion matrix:
    0    1
0  42  173
1   2  268
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-12 16:31:03.378904,epoch time: 0:09:21.612891,used: 1:43:37.799700,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.86937135, 'recall': 0.601195, 'specificity': 0.601195, 'f1': 0.6517516, 'auroc': 0.91604686, 'binary_precision': 0.9606879, 'binary_recall': 0.9969917, 'binary_specificity': 0.20539829, 'binary_f1_score': 0.97850317}
confusion matrix:
     0      1
0  312   1207
1   89  29496
---- Validation: 
scalar performance:
{'acc': 0.613354, 'precision': 0.7427441, 'recall': 0.6183791, 'specificity': 0.6183791, 'f1': 0.5590497, 'auroc': 0.8404602, 'binary_precision': 0.561991, 'binary_recall': 0.9779528, 'binary_specificity': 0.2588055, 'binary_f1_score': 0.7137932}
confusion matrix:
     0    1
0  169  484
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63917524, 'precision': 0.7714915, 'recall': 0.59444445, 'specificity': 0.59444445, 'f1': 0.54133767, 'auroc': 0.8293712, 'binary_precision': 0.60820043, 'binary_recall': 0.98888886, 'binary_specificity': 0.2, 'binary_f1_score': 0.7531735}
confusion matrix:
    0    1
0  43  172
1   3  267
better model found
persisted
after epoch: 12,now: 2024-07-12 16:40:26.117921,epoch time: 0:09:22.739017,used: 1:53:00.538717,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9598444, 'precision': 0.85391843, 'recall': 0.63266325, 'specificity': 0.63266325, 'f1': 0.6877791, 'auroc': 0.92087567, 'binary_precision': 0.96373516, 'binary_recall': 0.99523425, 'binary_specificity': 0.27009222, 'binary_f1_score': 0.97923154}
confusion matrix:
     0      1
0  410   1108
1  141  29445
---- Validation: 
scalar performance:
{'acc': 0.63586956, 'precision': 0.7461378, 'recall': 0.6404758, 'specificity': 0.6404758, 'f1': 0.59413993, 'auroc': 0.83951724, 'binary_precision': 0.5778612, 'binary_recall': 0.97007877, 'binary_specificity': 0.31087288, 'binary_f1_score': 0.7242799}
confusion matrix:
     0    1
0  203  450
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65773195, 'precision': 0.7831924, 'recall': 0.6153747, 'specificity': 0.6153747, 'f1': 0.57402116, 'auroc': 0.82976747, 'binary_precision': 0.62093025, 'binary_recall': 0.98888886, 'binary_specificity': 0.24186046, 'binary_f1_score': 0.76285714}
confusion matrix:
    0    1
0  52  163
1   3  267
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 16:49:52.233015,epoch time: 0:09:26.115094,used: 2:02:26.653811,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96103394, 'precision': 0.85882664, 'recall': 0.64766264, 'specificity': 0.64766264, 'f1': 0.70460343, 'auroc': 0.9237777, 'binary_precision': 0.9651781, 'binary_recall': 0.99493, 'binary_specificity': 0.30039525, 'binary_f1_score': 0.9798283}
confusion matrix:
     0      1
0  456   1062
1  150  29436
---- Validation: 
scalar performance:
{'acc': 0.63897514, 'precision': 0.74623466, 'recall': 0.6435169, 'specificity': 0.6435169, 'f1': 0.5989272, 'auroc': 0.84052527, 'binary_precision': 0.5801887, 'binary_recall': 0.96850395, 'binary_specificity': 0.31852987, 'binary_f1_score': 0.7256637}
confusion matrix:
     0    1
0  208  445
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.78560007, 'recall': 0.6200258, 'specificity': 0.6200258, 'f1': 0.5810509, 'auroc': 0.83226526, 'binary_precision': 0.62383175, 'binary_recall': 0.98888886, 'binary_specificity': 0.2511628, 'binary_f1_score': 0.76504296}
confusion matrix:
    0    1
0  54  161
1   3  267
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-12 16:59:18.768521,epoch time: 0:09:26.535506,used: 2:11:53.189317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96135545, 'precision': 0.8519447, 'recall': 0.6589911, 'specificity': 0.6589911, 'f1': 0.71505564, 'auroc': 0.9255662, 'binary_precision': 0.96625817, 'binary_recall': 0.99408484, 'binary_specificity': 0.3238973, 'binary_f1_score': 0.97997403}
confusion matrix:
     0      1
0  492   1027
1  175  29410
---- Validation: 
scalar performance:
{'acc': 0.6467391, 'precision': 0.7508403, 'recall': 0.6511739, 'specificity': 0.6511739, 'f1': 0.60965407, 'auroc': 0.84109926, 'binary_precision': 0.5857143, 'binary_recall': 0.96850395, 'binary_specificity': 0.3338438, 'binary_f1_score': 0.7299703}
confusion matrix:
     0    1
0  218  435
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6659794, 'precision': 0.7808924, 'recall': 0.62515074, 'specificity': 0.62515074, 'f1': 0.58980703, 'auroc': 0.8346081, 'binary_precision': 0.6273585, 'binary_recall': 0.9851852, 'binary_specificity': 0.26511627, 'binary_f1_score': 0.76657057}
confusion matrix:
    0    1
0  57  158
1   4  266
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 17:08:43.771488,epoch time: 0:09:25.002967,used: 2:21:18.192284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9620628, 'precision': 0.8534895, 'recall': 0.66904306, 'specificity': 0.66904306, 'f1': 0.7251142, 'auroc': 0.9282117, 'binary_precision': 0.9672336, 'binary_recall': 0.9937806, 'binary_specificity': 0.34430546, 'binary_f1_score': 0.98032737}
confusion matrix:
     0      1
0  523    996
1  184  29401
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.7501106, 'recall': 0.65268356, 'specificity': 0.65268356, 'f1': 0.6121862, 'auroc': 0.84224, 'binary_precision': 0.5869981, 'binary_recall': 0.96692914, 'binary_specificity': 0.33843797, 'binary_f1_score': 0.7305176}
confusion matrix:
     0    1
0  221  432
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.76517713, 'recall': 0.621447, 'specificity': 0.621447, 'f1': 0.5865388, 'auroc': 0.8368131, 'binary_precision': 0.6255924, 'binary_recall': 0.9777778, 'binary_specificity': 0.26511627, 'binary_f1_score': 0.76300573}
confusion matrix:
    0    1
0  57  158
1   6  264
better model found
persisted
after epoch: 16,now: 2024-07-12 17:18:12.201095,epoch time: 0:09:28.429607,used: 2:30:46.621891,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9620949, 'precision': 0.84837866, 'recall': 0.6739438, 'specificity': 0.6739438, 'f1': 0.7287482, 'auroc': 0.92936325, 'binary_precision': 0.96775997, 'binary_recall': 0.9932403, 'binary_specificity': 0.35464734, 'binary_f1_score': 0.9803346}
confusion matrix:
     0      1
0  538    979
1  200  29387
---- Validation: 
scalar performance:
{'acc': 0.6529503, 'precision': 0.75285363, 'recall': 0.6572777, 'specificity': 0.6572777, 'f1': 0.6185095, 'auroc': 0.8429899, 'binary_precision': 0.5903846, 'binary_recall': 0.96692914, 'binary_specificity': 0.34762633, 'binary_f1_score': 0.7331344}
confusion matrix:
     0    1
0  227  426
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6680412, 'precision': 0.76958126, 'recall': 0.6284238, 'specificity': 0.6284238, 'f1': 0.59668714, 'auroc': 0.8383807, 'binary_precision': 0.6300716, 'binary_recall': 0.9777778, 'binary_specificity': 0.27906978, 'binary_f1_score': 0.766328}
confusion matrix:
    0    1
0  60  155
1   6  264
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-12 17:27:41.634597,epoch time: 0:09:29.433502,used: 2:40:16.055393,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9629951, 'precision': 0.85973084, 'recall': 0.67796427, 'specificity': 0.67796427, 'f1': 0.7347373, 'auroc': 0.93245435, 'binary_precision': 0.9680956, 'binary_recall': 0.9938482, 'binary_specificity': 0.3620803, 'binary_f1_score': 0.9808029}
confusion matrix:
     0      1
0  550    969
1  182  29403
---- Validation: 
scalar performance:
{'acc': 0.6552795, 'precision': 0.755797, 'recall': 0.65959656, 'specificity': 0.65959656, 'f1': 0.62126374, 'auroc': 0.8448204, 'binary_precision': 0.5919153, 'binary_recall': 0.96850395, 'binary_specificity': 0.3506891, 'binary_f1_score': 0.73476696}
confusion matrix:
     0    1
0  229  424
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6680412, 'precision': 0.76958126, 'recall': 0.6284238, 'specificity': 0.6284238, 'f1': 0.59668714, 'auroc': 0.84182596, 'binary_precision': 0.6300716, 'binary_recall': 0.9777778, 'binary_specificity': 0.27906978, 'binary_f1_score': 0.766328}
confusion matrix:
    0    1
0  60  155
1   6  264
better model found
persisted
after epoch: 18,now: 2024-07-12 17:37:10.547050,epoch time: 0:09:28.912453,used: 2:49:44.967846,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96212703, 'precision': 0.839864, 'recall': 0.6847975, 'specificity': 0.6847975, 'f1': 0.736722, 'auroc': 0.9353167, 'binary_precision': 0.96880984, 'binary_recall': 0.9921247, 'binary_specificity': 0.37747034, 'binary_f1_score': 0.9803287}
confusion matrix:
     0      1
0  573    945
1  233  29353
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.75914395, 'recall': 0.6679975, 'specificity': 0.6679975, 'f1': 0.63304484, 'auroc': 0.8457995, 'binary_precision': 0.5984405, 'binary_recall': 0.96692914, 'binary_specificity': 0.36906585, 'binary_f1_score': 0.73931366}
confusion matrix:
     0    1
0  241  412
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68041235, 'precision': 0.77794594, 'recall': 0.64237726, 'specificity': 0.64237726, 'f1': 0.6164952, 'auroc': 0.8439621, 'binary_precision': 0.6392252, 'binary_recall': 0.9777778, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.7730601}
confusion matrix:
    0    1
0  66  149
1   6  264
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-12 17:46:37.060186,epoch time: 0:09:26.513136,used: 2:59:11.480982,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9633166, 'precision': 0.8477186, 'recall': 0.69624454, 'specificity': 0.69624454, 'f1': 0.748423, 'auroc': 0.93567264, 'binary_precision': 0.9699002, 'binary_recall': 0.99222577, 'binary_specificity': 0.40026334, 'binary_f1_score': 0.98093593}
confusion matrix:
     0      1
0  608    911
1  230  29355
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.7576498, 'recall': 0.6679758, 'specificity': 0.6679758, 'f1': 0.6334038, 'auroc': 0.8481123, 'binary_precision': 0.5986328, 'binary_recall': 0.9653543, 'binary_specificity': 0.37059724, 'binary_f1_score': 0.7389994}
confusion matrix:
     0    1
0  242  411
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77658707, 'recall': 0.64005166, 'specificity': 0.64005166, 'f1': 0.6132376, 'auroc': 0.84783804, 'binary_precision': 0.6376812, 'binary_recall': 0.9777778, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.7719298}
confusion matrix:
    0    1
0  65  150
1   6  264
early stop counter: 1
val acc:0.6638198494911194, best validation acc: 0.6638198494911194, corresponding to test acc:                         0.6804123520851135 / 0.6804123520851135
after epoch: 20,now: 2024-07-12 17:56:00.993409,epoch time: 0:09:23.933223,used: 3:08:35.414205,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9650527, 'precision': 0.86398315, 'recall': 0.70590055, 'specificity': 0.70590055, 'f1': 0.7605246, 'auroc': 0.94063544, 'binary_precision': 0.9708234, 'binary_recall': 0.99310464, 'binary_specificity': 0.41869652, 'binary_f1_score': 0.98183763}
confusion matrix:
     0      1
0  636    883
1  204  29381
---- Validation: 
scalar performance:
{'acc': 0.65993786, 'precision': 0.758461, 'recall': 0.6641907, 'specificity': 0.6641907, 'f1': 0.6275157, 'auroc': 0.85025865, 'binary_precision': 0.59535336, 'binary_recall': 0.96850395, 'binary_specificity': 0.3598775, 'binary_f1_score': 0.7374101}
confusion matrix:
     0    1
0  235  418
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.77521515, 'recall': 0.63772607, 'specificity': 0.63772607, 'f1': 0.6099629, 'auroc': 0.8512144, 'binary_precision': 0.6361446, 'binary_recall': 0.9777778, 'binary_specificity': 0.29767442, 'binary_f1_score': 0.7708029}
confusion matrix:
    0    1
0  64  151
1   6  264
early stop counter: 2
val acc:0.659937858581543, best validation acc: 0.6638198494911194, corresponding to test acc:                         0.6804123520851135 / 0.6804123520851135
after epoch: 21,now: 2024-07-12 18:05:32.605268,epoch time: 0:09:31.611859,used: 3:18:07.026064,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.96518135, 'precision': 0.85713476, 'recall': 0.71546376, 'specificity': 0.71546376, 'f1': 0.7667202, 'auroc': 0.9401099, 'binary_precision': 0.9717946, 'binary_recall': 0.99219227, 'binary_specificity': 0.4387352, 'binary_f1_score': 0.9818875}
confusion matrix:
     0      1
0  666    852
1  231  29355
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.756635, 'recall': 0.66871977, 'specificity': 0.66871977, 'f1': 0.63478255, 'auroc': 0.85122573, 'binary_precision': 0.5994123, 'binary_recall': 0.9637795, 'binary_specificity': 0.37366003, 'binary_f1_score': 0.73913044}
confusion matrix:
     0    1
0  244  409
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69072163, 'precision': 0.77958786, 'recall': 0.6544789, 'specificity': 0.6544789, 'f1': 0.6339512, 'auroc': 0.8534194, 'binary_precision': 0.6477833, 'binary_recall': 0.97407407, 'binary_specificity': 0.33488372, 'binary_f1_score': 0.7781065}
confusion matrix:
    0    1
0  72  143
1   7  263
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-12 18:15:03.434251,epoch time: 0:09:30.828983,used: 3:27:37.855047,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9654707, 'precision': 0.8526819, 'recall': 0.7264174, 'specificity': 0.7264174, 'f1': 0.7741277, 'auroc': 0.9422494, 'binary_precision': 0.9728663, 'binary_recall': 0.99134696, 'binary_specificity': 0.46148783, 'binary_f1_score': 0.98201966}
confusion matrix:
     0      1
0  701    818
1  256  29329
---- Validation: 
scalar performance:
{'acc': 0.66537267, 'precision': 0.75854874, 'recall': 0.66950715, 'specificity': 0.66950715, 'f1': 0.6354517, 'auroc': 0.8537748, 'binary_precision': 0.5998043, 'binary_recall': 0.9653543, 'binary_specificity': 0.37366003, 'binary_f1_score': 0.73989135}
confusion matrix:
     0    1
0  244  409
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68659794, 'precision': 0.7768494, 'recall': 0.6498277, 'specificity': 0.6498277, 'f1': 0.62763166, 'auroc': 0.85698533, 'binary_precision': 0.64460784, 'binary_recall': 0.97407407, 'binary_specificity': 0.3255814, 'binary_f1_score': 0.7758112}
confusion matrix:
    0    1
0  70  145
1   7  263
better model found
persisted
after epoch: 23,now: 2024-07-12 18:24:28.377134,epoch time: 0:09:24.942883,used: 3:37:02.797930,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96608156, 'precision': 0.8638258, 'recall': 0.72187406, 'specificity': 0.72187406, 'f1': 0.77365065, 'auroc': 0.9444293, 'binary_precision': 0.9724145, 'binary_recall': 0.99249643, 'binary_specificity': 0.45125166, 'binary_f1_score': 0.98235285}
confusion matrix:
     0      1
0  685    833
1  222  29364
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.75869906, 'recall': 0.6672318, 'specificity': 0.6672318, 'f1': 0.6320165, 'auroc': 0.8552387, 'binary_precision': 0.59785783, 'binary_recall': 0.96692914, 'binary_specificity': 0.36753446, 'binary_f1_score': 0.73886883}
confusion matrix:
     0    1
0  240  413
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68247426, 'precision': 0.774065, 'recall': 0.6451766, 'specificity': 0.6451766, 'f1': 0.6212475, 'auroc': 0.8588114, 'binary_precision': 0.6414634, 'binary_recall': 0.97407407, 'binary_specificity': 0.31627908, 'binary_f1_score': 0.7735294}
confusion matrix:
    0    1
0  68  147
1   7  263
early stop counter: 1
val acc:0.6630434989929199, best validation acc: 0.6653726696968079, corresponding to test acc:                         0.6865979433059692 / 0.6907216310501099
after epoch: 24,now: 2024-07-12 18:33:54.916799,epoch time: 0:09:26.539665,used: 3:46:29.337595,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9652456, 'precision': 0.8525895, 'recall': 0.72237206, 'specificity': 0.72237206, 'f1': 0.77097034, 'auroc': 0.945508, 'binary_precision': 0.97248465, 'binary_recall': 0.99151623, 'binary_specificity': 0.45322794, 'binary_f1_score': 0.9819082}
confusion matrix:
     0      1
0  688    830
1  251  29335
---- Validation: 
scalar performance:
{'acc': 0.6622671, 'precision': 0.7567482, 'recall': 0.6664444, 'specificity': 0.6664444, 'f1': 0.6313498, 'auroc': 0.8571993, 'binary_precision': 0.5974659, 'binary_recall': 0.9653543, 'binary_specificity': 0.36753446, 'binary_f1_score': 0.7381095}
confusion matrix:
     0    1
0  240  413
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68247426, 'precision': 0.774065, 'recall': 0.6451766, 'specificity': 0.6451766, 'f1': 0.6212475, 'auroc': 0.8616365, 'binary_precision': 0.6414634, 'binary_recall': 0.97407407, 'binary_specificity': 0.31627908, 'binary_f1_score': 0.7735294}
confusion matrix:
    0    1
0  68  147
1   7  263
early stop counter: 2
val acc:0.6622670888900757, best validation acc: 0.6653726696968079, corresponding to test acc:                         0.6865979433059692 / 0.6907216310501099
after epoch: 25,now: 2024-07-12 18:43:21.043321,epoch time: 0:09:26.126522,used: 3:55:55.464117,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96656376, 'precision': 0.85536885, 'recall': 0.74104387, 'specificity': 0.74104387, 'f1': 0.785915, 'auroc': 0.94795907, 'binary_precision': 0.97431123, 'binary_recall': 0.99097514, 'binary_specificity': 0.49111256, 'binary_f1_score': 0.98257256}
confusion matrix:
     0      1
0  746    773
1  267  29318
---- Validation: 
scalar performance:
{'acc': 0.66770184, 'precision': 0.75844955, 'recall': 0.67178255, 'specificity': 0.67178255, 'f1': 0.6388583, 'auroc': 0.8592155, 'binary_precision': 0.6017699, 'binary_recall': 0.9637795, 'binary_specificity': 0.3797856, 'binary_f1_score': 0.7409201}
confusion matrix:
     0    1
0  248  405
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69896907, 'precision': 0.7849457, 'recall': 0.6637812, 'specificity': 0.6637812, 'f1': 0.6464026, 'auroc': 0.8641516, 'binary_precision': 0.65422887, 'binary_recall': 0.97407407, 'binary_specificity': 0.3534884, 'binary_f1_score': 0.7827381}
confusion matrix:
    0    1
0  76  139
1   7  263
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-12 18:52:54.189834,epoch time: 0:09:33.146513,used: 4:05:28.610630,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9662101, 'precision': 0.855065, 'recall': 0.7355495, 'specificity': 0.7355495, 'f1': 0.7817515, 'auroc': 0.9511851, 'binary_precision': 0.9737663, 'binary_recall': 0.991178, 'binary_specificity': 0.479921, 'binary_f1_score': 0.982395}
confusion matrix:
     0      1
0  729    790
1  261  29324
---- Validation: 
scalar performance:
{'acc': 0.66537267, 'precision': 0.75708956, 'recall': 0.66948545, 'specificity': 0.66948545, 'f1': 0.6358037, 'auroc': 0.861058, 'binary_precision': 0.6, 'binary_recall': 0.9637795, 'binary_specificity': 0.37519142, 'binary_f1_score': 0.73957705}
confusion matrix:
     0    1
0  245  408
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948454, 'precision': 0.7822852, 'recall': 0.65913004, 'specificity': 0.65913004, 'f1': 0.64020777, 'auroc': 0.86625326, 'binary_precision': 0.6509901, 'binary_recall': 0.97407407, 'binary_specificity': 0.34418604, 'binary_f1_score': 0.7804155}
confusion matrix:
    0    1
0  74  141
1   7  263
early stop counter: 1
val acc:0.6653726696968079, best validation acc: 0.6677018404006958, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 27,now: 2024-07-12 19:02:26.123671,epoch time: 0:09:31.933837,used: 4:15:00.544467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96543854, 'precision': 0.8477626, 'recall': 0.732958, 'specificity': 0.732958, 'f1': 0.7776166, 'auroc': 0.95256615, 'binary_precision': 0.9735251, 'binary_recall': 0.9906033, 'binary_specificity': 0.4753127, 'binary_f1_score': 0.98199}
confusion matrix:
     0      1
0  722    797
1  278  29307
---- Validation: 
scalar performance:
{'acc': 0.6669255, 'precision': 0.7594454, 'recall': 0.67103857, 'specificity': 0.67103857, 'f1': 0.6374937, 'auroc': 0.8624568, 'binary_precision': 0.6009804, 'binary_recall': 0.9653543, 'binary_specificity': 0.3767228, 'binary_f1_score': 0.7407855}
confusion matrix:
     0    1
0  246  407
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948454, 'precision': 0.7822852, 'recall': 0.65913004, 'specificity': 0.65913004, 'f1': 0.64020777, 'auroc': 0.8691301, 'binary_precision': 0.6509901, 'binary_recall': 0.97407407, 'binary_specificity': 0.34418604, 'binary_f1_score': 0.7804155}
confusion matrix:
    0    1
0  74  141
1   7  263
early stop counter: 2
val acc:0.6669254899024963, best validation acc: 0.6677018404006958, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 28,now: 2024-07-12 19:11:52.938766,epoch time: 0:09:26.815095,used: 4:24:27.359562,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9664352, 'precision': 0.86001974, 'recall': 0.73188555, 'specificity': 0.73188555, 'f1': 0.78043705, 'auroc': 0.9501517, 'binary_precision': 0.9734284, 'binary_recall': 0.99178696, 'binary_specificity': 0.47198418, 'binary_f1_score': 0.9825219}
confusion matrix:
     0      1
0  716    801
1  243  29344
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.75809956, 'recall': 0.66874146, 'specificity': 0.66874146, 'f1': 0.63442844, 'auroc': 0.86443675, 'binary_precision': 0.599218, 'binary_recall': 0.9653543, 'binary_specificity': 0.37212864, 'binary_f1_score': 0.73944515}
confusion matrix:
     0    1
0  243  410
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69278353, 'precision': 0.78094137, 'recall': 0.65680444, 'specificity': 0.65680444, 'f1': 0.6370873, 'auroc': 0.87068045, 'binary_precision': 0.6493827, 'binary_recall': 0.97407407, 'binary_specificity': 0.33953488, 'binary_f1_score': 0.77925926}
confusion matrix:
    0    1
0  73  142
1   7  263
early stop counter: 3
val acc:0.6645962595939636, best validation acc: 0.6677018404006958, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 29,now: 2024-07-12 19:21:22.211929,epoch time: 0:09:29.273163,used: 4:33:56.632725,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9667567, 'precision': 0.8617461, 'recall': 0.73552454, 'specificity': 0.73552454, 'f1': 0.783712, 'auroc': 0.9522872, 'binary_precision': 0.9737497, 'binary_recall': 0.99178636, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.9826852}
confusion matrix:
     0      1
0  728    791
1  243  29342
---- Validation: 
scalar performance:
{'acc': 0.6661491, 'precision': 0.7589974, 'recall': 0.6702729, 'specificity': 0.6702729, 'f1': 0.6364734, 'auroc': 0.86583304, 'binary_precision': 0.60039175, 'binary_recall': 0.9653543, 'binary_specificity': 0.37519142, 'binary_f1_score': 0.7403381}
confusion matrix:
     0    1
0  245  408
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6969072, 'precision': 0.7836198, 'recall': 0.66145563, 'specificity': 0.66145563, 'f1': 0.64331275, 'auroc': 0.87259257, 'binary_precision': 0.6526055, 'binary_recall': 0.97407407, 'binary_specificity': 0.3488372, 'binary_f1_score': 0.781575}
confusion matrix:
    0    1
0  75  140
1   7  263
early stop counter: 4
val acc:0.6661490797996521, best validation acc: 0.6677018404006958, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 30,now: 2024-07-12 19:30:47.904820,epoch time: 0:09:25.692891,used: 4:43:22.325616,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_47_25_seed_0_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:43:22.325616 at 2024-07-12 19:30:47.904820
persisted model performance metric: 

scalar performance:
{'acc': 0.69896907, 'precision': 0.7849457, 'recall': 0.6637812, 'specificity': 0.6637812, 'f1': 0.6464026, 'auroc': 0.8641516, 'binary_precision': 0.65422887, 'binary_recall': 0.97407407, 'binary_specificity': 0.3534884, 'binary_f1_score': 0.7827381}
confusion matrix:
    0    1
0  76  139
1   7  263
oracle model performance metric: 

scalar performance:
{'acc': 0.69896907, 'precision': 0.7849457, 'recall': 0.6637812, 'specificity': 0.6637812, 'f1': 0.6464026, 'auroc': 0.8641516, 'binary_precision': 0.65422887, 'binary_recall': 0.97407407, 'binary_specificity': 0.3534884, 'binary_f1_score': 0.7827381}
confusion matrix:
    0    1
0  76  139
1   7  263
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 216499 GiB | 216498 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36533 KiB |  74940 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |   6133 KiB |   9283 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    4371    |   50234 K  |   50233 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    4371    |   50234 K  |   50233 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    1961    |   29176 K  |   29176 K  |
|       from large pool |       9    |      19    |   13022 K  |   13022 K  |
|       from small pool |      28    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29176 K  |   29176 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28886 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29176 K  |   29176 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849

 Experiment start at: 2024-07-12 19:44:11.591778
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9484559, 'precision': 0.5818478, 'recall': 0.5087915, 'specificity': 0.5087915, 'f1': 0.50646025, 'auroc': 0.49852875, 'binary_precision': 0.95215714, 'binary_recall': 0.9958582, 'binary_specificity': 0.021724818, 'binary_f1_score': 0.97351754}
confusion matrix:
     0      1
0   33   1486
1  123  29574
---- Validation: 
scalar performance:
{'acc': 0.63700235, 'precision': 0.73811626, 'recall': 0.64224267, 'specificity': 0.64224267, 'f1': 0.5986477, 'auroc': 0.6872821, 'binary_precision': 0.57879657, 'binary_recall': 0.96190476, 'binary_specificity': 0.32258064, 'binary_f1_score': 0.72271913}
confusion matrix:
     0    1
0  210  441
1   24  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6297071, 'precision': 0.74545455, 'recall': 0.60814226, 'specificity': 0.60814226, 'f1': 0.55758095, 'auroc': 0.72224855, 'binary_precision': 0.59090906, 'binary_recall': 0.97628456, 'binary_specificity': 0.24, 'binary_f1_score': 0.7362146}
confusion matrix:
    0    1
0  54  171
1   6  247
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 19:53:38.345298,epoch time: 0:09:26.753520,used: 0:09:26.753520,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94960916, 'precision': 0.6385755, 'recall': 0.514401, 'specificity': 0.514401, 'f1': 0.51637965, 'auroc': 0.58733046, 'binary_precision': 0.9526477, 'binary_recall': 0.9965652, 'binary_specificity': 0.03223684, 'binary_f1_score': 0.97411174}
confusion matrix:
     0      1
0   49   1471
1  102  29594
---- Validation: 
scalar performance:
{'acc': 0.6541764, 'precision': 0.74578846, 'recall': 0.6590886, 'specificity': 0.6590886, 'f1': 0.62269944, 'auroc': 0.7268305, 'binary_precision': 0.5915769, 'binary_recall': 0.95873016, 'binary_specificity': 0.359447, 'binary_f1_score': 0.7316777}
confusion matrix:
     0    1
0  234  417
1   26  604
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6359833, 'precision': 0.7439747, 'recall': 0.6150549, 'specificity': 0.6150549, 'f1': 0.5693694, 'auroc': 0.76049185, 'binary_precision': 0.5956417, 'binary_recall': 0.972332, 'binary_specificity': 0.25777778, 'binary_f1_score': 0.7387388}
confusion matrix:
    0    1
0  58  167
1   7  246
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 20:02:58.549347,epoch time: 0:09:20.204049,used: 0:18:46.957569,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95133907, 'precision': 0.729992, 'recall': 0.5246732, 'specificity': 0.5246732, 'f1': 0.5346069, 'auroc': 0.69909, 'binary_precision': 0.9535737, 'binary_recall': 0.99740696, 'binary_specificity': 0.051939514, 'binary_f1_score': 0.97499794}
confusion matrix:
    0      1
0  79   1442
1  77  29618
---- Validation: 
scalar performance:
{'acc': 0.6721311, 'precision': 0.7527504, 'recall': 0.67667687, 'specificity': 0.67667687, 'f1': 0.64712596, 'auroc': 0.75406086, 'binary_precision': 0.60584676, 'binary_recall': 0.9539682, 'binary_specificity': 0.39938557, 'binary_f1_score': 0.74106044}
confusion matrix:
     0    1
0  260  391
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64853555, 'precision': 0.74272954, 'recall': 0.6288801, 'specificity': 0.6288801, 'f1': 0.5919512, 'auroc': 0.78717613, 'binary_precision': 0.60545903, 'binary_recall': 0.9644269, 'binary_specificity': 0.29333332, 'binary_f1_score': 0.7439024}
confusion matrix:
    0    1
0  66  159
1   9  244
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 20:12:22.860709,epoch time: 0:09:24.311362,used: 0:28:11.268931,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95053816, 'precision': 0.69500023, 'recall': 0.5242523, 'specificity': 0.5242523, 'f1': 0.533704, 'auroc': 0.77238977, 'binary_precision': 0.95353633, 'binary_recall': 0.9965651, 'binary_specificity': 0.051939514, 'binary_f1_score': 0.97457606}
confusion matrix:
     0      1
0   79   1442
1  102  29593
---- Validation: 
scalar performance:
{'acc': 0.68384075, 'precision': 0.7574862, 'recall': 0.6881464, 'specificity': 0.6881464, 'f1': 0.6625169, 'auroc': 0.77346206, 'binary_precision': 0.6156218, 'binary_recall': 0.9507936, 'binary_specificity': 0.42549923, 'binary_f1_score': 0.7473487}
confusion matrix:
     0    1
0  277  374
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.75368893, 'recall': 0.6582609, 'specificity': 0.6582609, 'f1': 0.63423723, 'auroc': 0.80444443, 'binary_precision': 0.626943, 'binary_recall': 0.95652175, 'binary_specificity': 0.36, 'binary_f1_score': 0.7574335}
confusion matrix:
    0    1
0  81  144
1  11  242
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 20:21:51.306856,epoch time: 0:09:28.446147,used: 0:37:39.715078,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9524923, 'precision': 0.771894, 'recall': 0.5399384, 'specificity': 0.5399384, 'f1': 0.560406, 'auroc': 0.82311606, 'binary_precision': 0.9550029, 'binary_recall': 0.9970365, 'binary_specificity': 0.082840234, 'binary_f1_score': 0.9755671}
confusion matrix:
     0      1
0  126   1395
1   88  29607
---- Validation: 
scalar performance:
{'acc': 0.6900859, 'precision': 0.7568549, 'recall': 0.6941884, 'specificity': 0.6941884, 'f1': 0.67133147, 'auroc': 0.7876966, 'binary_precision': 0.62173456, 'binary_recall': 0.9444444, 'binary_specificity': 0.4439324, 'binary_f1_score': 0.7498424}
confusion matrix:
     0    1
0  289  362
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69246864, 'precision': 0.76510584, 'recall': 0.6760386, 'specificity': 0.6760386, 'f1': 0.65736437, 'auroc': 0.81696975, 'binary_precision': 0.64021164, 'binary_recall': 0.95652175, 'binary_specificity': 0.39555556, 'binary_f1_score': 0.76703644}
confusion matrix:
    0    1
0  89  136
1  11  242
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-12 20:31:15.475780,epoch time: 0:09:24.168924,used: 0:47:03.884002,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9524923, 'precision': 0.76635444, 'recall': 0.54492867, 'specificity': 0.54492867, 'f1': 0.5681393, 'auroc': 0.8526405, 'binary_precision': 0.95547307, 'binary_recall': 0.99649775, 'binary_specificity': 0.093359634, 'binary_f1_score': 0.9755543}
confusion matrix:
     0      1
0  142   1379
1  104  29591
---- Validation: 
scalar performance:
{'acc': 0.68774396, 'precision': 0.7587302, 'recall': 0.69196105, 'specificity': 0.69196105, 'f1': 0.66764736, 'auroc': 0.8009552, 'binary_precision': 0.61904764, 'binary_recall': 0.94920635, 'binary_specificity': 0.4347158, 'binary_f1_score': 0.74937344}
confusion matrix:
     0    1
0  283  368
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6987448, 'precision': 0.7802852, 'recall': 0.6819675, 'specificity': 0.6819675, 'f1': 0.66283286, 'auroc': 0.8271761, 'binary_precision': 0.6430446, 'binary_recall': 0.96837944, 'binary_specificity': 0.39555556, 'binary_f1_score': 0.7728707}
confusion matrix:
    0    1
0  89  136
1   8  245
new oracle model saved
early stop counter: 1
val acc:0.6877439618110657, best validation acc: 0.6900858879089355, corresponding to test acc:                         0.6924686431884766 / 0.6987447738647461
after epoch: 6,now: 2024-07-12 20:40:36.645440,epoch time: 0:09:21.169660,used: 0:56:25.053662,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9539339, 'precision': 0.79834133, 'recall': 0.56065726, 'specificity': 0.56065726, 'f1': 0.5926485, 'auroc': 0.8763468, 'binary_precision': 0.95695204, 'binary_recall': 0.9963967, 'binary_specificity': 0.12491782, 'binary_f1_score': 0.9762761}
confusion matrix:
     0      1
0  190   1331
1  107  29588
---- Validation: 
scalar performance:
{'acc': 0.69789225, 'precision': 0.76280993, 'recall': 0.7018945, 'specificity': 0.7018945, 'f1': 0.6806077, 'auroc': 0.8093385, 'binary_precision': 0.6280295, 'binary_recall': 0.94603175, 'binary_specificity': 0.4577573, 'binary_f1_score': 0.7549082}
confusion matrix:
     0    1
0  298  353
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7050209, 'precision': 0.7767894, 'recall': 0.689126, 'specificity': 0.689126, 'f1': 0.6732741, 'auroc': 0.8350812, 'binary_precision': 0.64973265, 'binary_recall': 0.9604743, 'binary_specificity': 0.41777778, 'binary_f1_score': 0.7751196}
confusion matrix:
    0    1
0  94  131
1  10  243
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 20:49:58.233656,epoch time: 0:09:21.588216,used: 1:05:46.641878,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9561443, 'precision': 0.8204249, 'recall': 0.5917608, 'specificity': 0.5917608, 'f1': 0.63603103, 'auroc': 0.8851514, 'binary_precision': 0.9598974, 'binary_recall': 0.99548745, 'binary_specificity': 0.18803419, 'binary_f1_score': 0.97736853}
confusion matrix:
     0      1
0  286   1235
1  134  29561
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.7680817, 'recall': 0.7148745, 'specificity': 0.7148745, 'f1': 0.69720876, 'auroc': 0.8163363, 'binary_precision': 0.6403888, 'binary_recall': 0.9412698, 'binary_specificity': 0.48847926, 'binary_f1_score': 0.7622108}
confusion matrix:
     0    1
0  318  333
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.7881715, 'recall': 0.7138164, 'specificity': 0.7138164, 'f1': 0.7040783, 'auroc': 0.8410716, 'binary_precision': 0.6703601, 'binary_recall': 0.95652175, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.78827363}
confusion matrix:
     0    1
0  106  119
1   11  242
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 20:59:26.052357,epoch time: 0:09:27.818701,used: 1:15:14.460579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95736164, 'precision': 0.8338175, 'recall': 0.6045645, 'specificity': 0.6045645, 'f1': 0.65304965, 'auroc': 0.9038571, 'binary_precision': 0.9611133, 'binary_recall': 0.9954538, 'binary_specificity': 0.21367522, 'binary_f1_score': 0.97798216}
confusion matrix:
     0      1
0  325   1196
1  135  29560
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.7705438, 'recall': 0.7187148, 'specificity': 0.7187148, 'f1': 0.70181966, 'auroc': 0.82265866, 'binary_precision': 0.64386535, 'binary_recall': 0.9412698, 'binary_specificity': 0.49615976, 'binary_f1_score': 0.7646679}
confusion matrix:
     0    1
0  323  328
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.78950095, 'recall': 0.71603864, 'specificity': 0.71603864, 'f1': 0.70673317, 'auroc': 0.8458674, 'binary_precision': 0.6722222, 'binary_recall': 0.95652175, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.7895596}
confusion matrix:
     0    1
0  107  118
1   11  242
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 21:08:57.101357,epoch time: 0:09:31.049000,used: 1:24:45.509579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95861095, 'precision': 0.84457827, 'recall': 0.6183207, 'specificity': 0.6183207, 'f1': 0.6704508, 'auroc': 0.9098191, 'binary_precision': 0.96242386, 'binary_recall': 0.99535275, 'binary_specificity': 0.24128863, 'binary_f1_score': 0.9786114}
confusion matrix:
     0      1
0  367   1154
1  138  29557
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.7666038, 'recall': 0.7110599, 'specificity': 0.7110599, 'f1': 0.6923507, 'auroc': 0.8290152, 'binary_precision': 0.6366559, 'binary_recall': 0.94285715, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.76007676}
confusion matrix:
     0    1
0  312  339
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.79123247, 'recall': 0.7135705, 'specificity': 0.7135705, 'f1': 0.70330405, 'auroc': 0.8522969, 'binary_precision': 0.6694215, 'binary_recall': 0.9604743, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.78896105}
confusion matrix:
     0    1
0  105  120
1   10  243
early stop counter: 1
val acc:0.7072599530220032, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7301255464553833 / 0.7301255464553833
after epoch: 10,now: 2024-07-12 21:18:23.926541,epoch time: 0:09:26.825184,used: 1:34:12.334763,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9608214, 'precision': 0.8535559, 'recall': 0.64755285, 'specificity': 0.64755285, 'f1': 0.70370936, 'auroc': 0.91673344, 'binary_precision': 0.96522874, 'binary_recall': 0.99464554, 'binary_specificity': 0.30046022, 'binary_f1_score': 0.9797164}
confusion matrix:
     0      1
0  457   1064
1  159  29536
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.76525056, 'recall': 0.71479774, 'specificity': 0.71479774, 'f1': 0.69783884, 'auroc': 0.8329164, 'binary_precision': 0.6413044, 'binary_recall': 0.93650794, 'binary_specificity': 0.49308756, 'binary_f1_score': 0.7612904}
confusion matrix:
     0    1
0  321  330
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73849374, 'precision': 0.79480565, 'recall': 0.72492754, 'specificity': 0.72492754, 'f1': 0.7172575, 'auroc': 0.8553711, 'binary_precision': 0.6797753, 'binary_recall': 0.95652175, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7947455}
confusion matrix:
     0    1
0  111  114
1   11  242
new oracle model saved
early stop counter: 2
val acc:0.7111631631851196, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7301255464553833 / 0.7384937405586243
after epoch: 11,now: 2024-07-12 21:27:47.333621,epoch time: 0:09:23.407080,used: 1:43:35.741843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9609175, 'precision': 0.84092546, 'recall': 0.6610148, 'specificity': 0.6610148, 'f1': 0.7150944, 'auroc': 0.92236054, 'binary_precision': 0.96654326, 'binary_recall': 0.99329853, 'binary_specificity': 0.3287311, 'binary_f1_score': 0.9797383}
confusion matrix:
     0      1
0  500   1021
1  199  29496
---- Validation: 
scalar performance:
{'acc': 0.7103825, 'precision': 0.7656824, 'recall': 0.7140553, 'specificity': 0.7140553, 'f1': 0.6967083, 'auroc': 0.8375857, 'binary_precision': 0.6403034, 'binary_recall': 0.9380952, 'binary_specificity': 0.49001536, 'binary_f1_score': 0.7611075}
confusion matrix:
     0    1
0  319  332
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.79383004, 'recall': 0.71801496, 'specificity': 0.71801496, 'f1': 0.7086309, 'auroc': 0.86039525, 'binary_precision': 0.6731302, 'binary_recall': 0.9604743, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.7915309}
confusion matrix:
     0    1
0  107  118
1   10  243
early stop counter: 3
val acc:0.7103825211524963, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7301255464553833 / 0.7384937405586243
after epoch: 12,now: 2024-07-12 21:37:09.747286,epoch time: 0:09:22.413665,used: 1:52:58.155508,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9629036, 'precision': 0.8572053, 'recall': 0.67765343, 'specificity': 0.67765343, 'f1': 0.7339563, 'auroc': 0.92577016, 'binary_precision': 0.968142, 'binary_recall': 0.99370265, 'binary_specificity': 0.3616042, 'binary_f1_score': 0.9807558}
confusion matrix:
     0      1
0  550    971
1  187  29508
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.76635176, 'recall': 0.71784437, 'specificity': 0.71784437, 'f1': 0.7017125, 'auroc': 0.84010434, 'binary_precision': 0.64442015, 'binary_recall': 0.9349206, 'binary_specificity': 0.50076807, 'binary_f1_score': 0.7629534}
confusion matrix:
     0    1
0  326  325
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7964233, 'recall': 0.7224594, 'specificity': 0.7224594, 'f1': 0.7139193, 'auroc': 0.8624681, 'binary_precision': 0.67688024, 'binary_recall': 0.9604743, 'binary_specificity': 0.48444444, 'binary_f1_score': 0.7941176}
confusion matrix:
     0    1
0  109  116
1   10  243
early stop counter: 4
val acc:0.7142857313156128, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7301255464553833 / 0.7384937405586243
after epoch: 13,now: 2024-07-12 21:46:40.701471,epoch time: 0:09:30.954185,used: 2:02:29.109693,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96303177, 'precision': 0.8566927, 'recall': 0.68021595, 'specificity': 0.68021595, 'f1': 0.73622423, 'auroc': 0.93050134, 'binary_precision': 0.968392, 'binary_recall': 0.99356794, 'binary_specificity': 0.3668639, 'binary_f1_score': 0.98081845}
confusion matrix:
     0      1
0  558    963
1  191  29504
---- Validation: 
scalar performance:
{'acc': 0.70882124, 'precision': 0.7656373, 'recall': 0.7125448, 'specificity': 0.7125448, 'f1': 0.69464624, 'auroc': 0.84394705, 'binary_precision': 0.6386192, 'binary_recall': 0.93968254, 'binary_specificity': 0.48540705, 'binary_f1_score': 0.7604368}
confusion matrix:
     0    1
0  316  335
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7994886, 'recall': 0.72221345, 'specificity': 0.72221345, 'f1': 0.71318364, 'auroc': 0.8662275, 'binary_precision': 0.6759003, 'binary_recall': 0.9644269, 'binary_specificity': 0.48, 'binary_f1_score': 0.7947883}
confusion matrix:
     0    1
0  108  117
1    9  244
early stop counter: 5
val acc:0.7088212370872498, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7301255464553833 / 0.7384937405586243
after epoch: 14,now: 2024-07-12 21:56:04.602824,epoch time: 0:09:23.901353,used: 2:11:53.011046,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96338415, 'precision': 0.84502673, 'recall': 0.69942665, 'specificity': 0.69942665, 'f1': 0.7504579, 'auroc': 0.9360912, 'binary_precision': 0.97028595, 'binary_recall': 0.9918842, 'binary_specificity': 0.4069691, 'binary_f1_score': 0.9809662}
confusion matrix:
     0      1
0  619    902
1  241  29454
---- Validation: 
scalar performance:
{'acc': 0.7189696, 'precision': 0.7651148, 'recall': 0.7223246, 'specificity': 0.7223246, 'f1': 0.7081177, 'auroc': 0.8455343, 'binary_precision': 0.65033406, 'binary_recall': 0.92698413, 'binary_specificity': 0.51766515, 'binary_f1_score': 0.7643979}
confusion matrix:
     0    1
0  337  314
1   46  584
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7426778, 'precision': 0.8003085, 'recall': 0.72912604, 'specificity': 0.72912604, 'f1': 0.7217814, 'auroc': 0.8675802, 'binary_precision': 0.6825843, 'binary_recall': 0.9604743, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.7980296}
confusion matrix:
     0    1
0  112  113
1   10  243
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 22:05:27.648204,epoch time: 0:09:23.045380,used: 2:21:16.056426,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96453744, 'precision': 0.8656094, 'recall': 0.6943331, 'specificity': 0.6943331, 'f1': 0.7508722, 'auroc': 0.9393817, 'binary_precision': 0.96979755, 'binary_recall': 0.9936694, 'binary_specificity': 0.3949967, 'binary_f1_score': 0.9815884}
confusion matrix:
     0      1
0  600    919
1  188  29509
---- Validation: 
scalar performance:
{'acc': 0.7096019, 'precision': 0.763322, 'recall': 0.71323603, 'specificity': 0.71323603, 'f1': 0.6962055, 'auroc': 0.8489552, 'binary_precision': 0.64021736, 'binary_recall': 0.9349206, 'binary_specificity': 0.49155146, 'binary_f1_score': 0.76}
confusion matrix:
     0    1
0  320  331
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.79695773, 'recall': 0.717769, 'specificity': 0.717769, 'f1': 0.70786864, 'auroc': 0.8709706, 'binary_precision': 0.6721763, 'binary_recall': 0.9644269, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.79220784}
confusion matrix:
     0    1
0  106  119
1    9  244
early stop counter: 1
val acc:0.709601879119873, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7426778078079224
after epoch: 16,now: 2024-07-12 22:14:47.424941,epoch time: 0:09:19.776737,used: 2:30:35.833163,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96466553, 'precision': 0.86289763, 'recall': 0.6997882, 'specificity': 0.6997882, 'f1': 0.7550381, 'auroc': 0.9393538, 'binary_precision': 0.9702941, 'binary_recall': 0.99326485, 'binary_specificity': 0.40631163, 'binary_f1_score': 0.98164517}
confusion matrix:
     0      1
0  618    903
1  200  29495
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.76180565, 'recall': 0.7109319, 'specificity': 0.7109319, 'f1': 0.69343835, 'auroc': 0.8506571, 'binary_precision': 0.6381365, 'binary_recall': 0.9349206, 'binary_specificity': 0.48694316, 'binary_f1_score': 0.7585318}
confusion matrix:
     0    1
0  317  334
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8717786, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 2
val acc:0.7072599530220032, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7426778078079224
after epoch: 17,now: 2024-07-12 22:24:10.171540,epoch time: 0:09:22.746599,used: 2:39:58.579762,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9657227, 'precision': 0.85914296, 'recall': 0.72092885, 'specificity': 0.72092885, 'f1': 0.7716403, 'auroc': 0.94509935, 'binary_precision': 0.97237533, 'binary_recall': 0.9921536, 'binary_specificity': 0.44970414, 'binary_f1_score': 0.9821649}
confusion matrix:
     0      1
0  684    837
1  233  29462
---- Validation: 
scalar performance:
{'acc': 0.71662766, 'precision': 0.7687628, 'recall': 0.7201741, 'specificity': 0.7201741, 'f1': 0.7042562, 'auroc': 0.8527589, 'binary_precision': 0.6462212, 'binary_recall': 0.93650794, 'binary_specificity': 0.50384027, 'binary_f1_score': 0.764744}
confusion matrix:
     0    1
0  328  323
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7426778, 'precision': 0.80328214, 'recall': 0.7288801, 'specificity': 0.7288801, 'f1': 0.7210845, 'auroc': 0.8737637, 'binary_precision': 0.6815643, 'binary_recall': 0.9644269, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7986907}
confusion matrix:
     0    1
0  111  114
1    9  244
early stop counter: 3
val acc:0.7166276574134827, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7426778078079224
after epoch: 18,now: 2024-07-12 22:33:34.928522,epoch time: 0:09:24.756982,used: 2:49:23.336744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96601105, 'precision': 0.8616644, 'recall': 0.72214794, 'specificity': 0.72214794, 'f1': 0.7732934, 'auroc': 0.9448844, 'binary_precision': 0.97250915, 'binary_recall': 0.9923222, 'binary_specificity': 0.45197368, 'binary_f1_score': 0.9823158}
confusion matrix:
     0      1
0  687    833
1  228  29468
---- Validation: 
scalar performance:
{'acc': 0.7174083, 'precision': 0.76926434, 'recall': 0.72094214, 'specificity': 0.72094214, 'f1': 0.70516896, 'auroc': 0.8557458, 'binary_precision': 0.6469298, 'binary_recall': 0.93650794, 'binary_specificity': 0.50537634, 'binary_f1_score': 0.76523995}
confusion matrix:
     0    1
0  329  322
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7447699, 'precision': 0.8045466, 'recall': 0.73110235, 'specificity': 0.73110235, 'f1': 0.72369945, 'auroc': 0.8781203, 'binary_precision': 0.6834734, 'binary_recall': 0.9644269, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  112  113
1    9  244
new oracle model saved
early stop counter: 4
val acc:0.717408299446106, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 19,now: 2024-07-12 22:42:56.878153,epoch time: 0:09:21.949631,used: 2:58:45.286375,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96492183, 'precision': 0.8613162, 'recall': 0.705537, 'specificity': 0.705537, 'f1': 0.7595794, 'auroc': 0.9477025, 'binary_precision': 0.9708594, 'binary_recall': 0.9929281, 'binary_specificity': 0.41814595, 'binary_f1_score': 0.9817697}
confusion matrix:
     0      1
0  636    885
1  210  29485
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.76760375, 'recall': 0.7110855, 'specificity': 0.7110855, 'f1': 0.69212747, 'auroc': 0.85839856, 'binary_precision': 0.6363636, 'binary_recall': 0.9444444, 'binary_specificity': 0.47772658, 'binary_f1_score': 0.76038337}
confusion matrix:
     0    1
0  311  340
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7175732, 'precision': 0.78806305, 'recall': 0.7022134, 'specificity': 0.7022134, 'f1': 0.6889506, 'auroc': 0.88147557, 'binary_precision': 0.6594595, 'binary_recall': 0.9644269, 'binary_specificity': 0.44, 'binary_f1_score': 0.7833066}
confusion matrix:
    0    1
0  99  126
1   9  244
early stop counter: 5
val acc:0.7072599530220032, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 20,now: 2024-07-12 22:52:18.229416,epoch time: 0:09:21.351263,used: 3:08:06.637638,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96876603, 'precision': 0.87648296, 'recall': 0.7474799, 'specificity': 0.7474799, 'f1': 0.7970991, 'auroc': 0.94899833, 'binary_precision': 0.97496194, 'binary_recall': 0.9926587, 'binary_specificity': 0.5023011, 'binary_f1_score': 0.98373073}
confusion matrix:
     0      1
0  764    757
1  218  29477
---- Validation: 
scalar performance:
{'acc': 0.71818894, 'precision': 0.7706691, 'recall': 0.7217358, 'specificity': 0.7217358, 'f1': 0.70588565, 'auroc': 0.85895205, 'binary_precision': 0.6473165, 'binary_recall': 0.9380952, 'binary_specificity': 0.50537634, 'binary_f1_score': 0.76604015}
confusion matrix:
     0    1
0  329  322
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7994886, 'recall': 0.72221345, 'specificity': 0.72221345, 'f1': 0.71318364, 'auroc': 0.8818797, 'binary_precision': 0.6759003, 'binary_recall': 0.9644269, 'binary_specificity': 0.48, 'binary_f1_score': 0.7947883}
confusion matrix:
     0    1
0  108  117
1    9  244
early stop counter: 6
val acc:0.7181889414787292, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 21,now: 2024-07-12 23:01:52.819445,epoch time: 0:09:34.590029,used: 3:17:41.227667,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9667478, 'precision': 0.8605135, 'recall': 0.73581475, 'specificity': 0.73581475, 'f1': 0.7835742, 'auroc': 0.94933975, 'binary_precision': 0.9738417, 'binary_recall': 0.9916821, 'binary_specificity': 0.4799474, 'binary_f1_score': 0.9826809}
confusion matrix:
     0      1
0  730    791
1  247  29448
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.767125, 'recall': 0.71484894, 'specificity': 0.71484894, 'f1': 0.6974206, 'auroc': 0.8604491, 'binary_precision': 0.64069265, 'binary_recall': 0.93968254, 'binary_specificity': 0.49001536, 'binary_f1_score': 0.7619048}
confusion matrix:
     0    1
0  319  332
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.88335526, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 7
val acc:0.7111631631851196, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 22,now: 2024-07-12 23:11:39.335232,epoch time: 0:09:46.515787,used: 3:27:27.743454,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96658766, 'precision': 0.8651375, 'recall': 0.7271327, 'specificity': 0.7271327, 'f1': 0.7781881, 'auroc': 0.95232916, 'binary_precision': 0.9729935, 'binary_recall': 0.99242324, 'binary_specificity': 0.46184212, 'binary_f1_score': 0.9826124}
confusion matrix:
     0      1
0  702    818
1  225  29471
---- Validation: 
scalar performance:
{'acc': 0.7041374, 'precision': 0.7687831, 'recall': 0.7080901, 'specificity': 0.7080901, 'f1': 0.68768656, 'auroc': 0.86335063, 'binary_precision': 0.6328042, 'binary_recall': 0.94920635, 'binary_specificity': 0.4669739, 'binary_f1_score': 0.7593651}
confusion matrix:
     0    1
0  304  347
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71548116, 'precision': 0.7867849, 'recall': 0.6999912, 'specificity': 0.6999912, 'f1': 0.68620634, 'auroc': 0.88714975, 'binary_precision': 0.65768194, 'binary_recall': 0.9644269, 'binary_specificity': 0.43555555, 'binary_f1_score': 0.7820513}
confusion matrix:
    0    1
0  98  127
1   9  244
early stop counter: 8
val acc:0.70413738489151, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 23,now: 2024-07-12 23:21:22.319886,epoch time: 0:09:42.984654,used: 3:37:10.728108,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9670682, 'precision': 0.85370183, 'recall': 0.75048137, 'specificity': 0.75048137, 'f1': 0.79218733, 'auroc': 0.9555391, 'binary_precision': 0.97532827, 'binary_recall': 0.99043643, 'binary_specificity': 0.5105263, 'binary_f1_score': 0.98282427}
confusion matrix:
     0      1
0  776    744
1  284  29412
---- Validation: 
scalar performance:
{'acc': 0.71272445, 'precision': 0.7690667, 'recall': 0.71641064, 'specificity': 0.71641064, 'f1': 0.6990562, 'auroc': 0.8639139, 'binary_precision': 0.6417749, 'binary_recall': 0.9412698, 'binary_specificity': 0.49155146, 'binary_f1_score': 0.76319176}
confusion matrix:
     0    1
0  320  331
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.79695773, 'recall': 0.717769, 'specificity': 0.717769, 'f1': 0.70786864, 'auroc': 0.88748354, 'binary_precision': 0.6721763, 'binary_recall': 0.9644269, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.79220784}
confusion matrix:
     0    1
0  106  119
1    9  244
early stop counter: 9
val acc:0.7127244472503662, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 24,now: 2024-07-12 23:31:02.776218,epoch time: 0:09:40.456332,used: 3:46:51.184440,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9682855, 'precision': 0.86476874, 'recall': 0.7545544, 'specificity': 0.7545544, 'f1': 0.7986741, 'auroc': 0.95498693, 'binary_precision': 0.975706, 'binary_recall': 0.99134564, 'binary_specificity': 0.51776314, 'binary_f1_score': 0.9834636}
confusion matrix:
     0      1
0  787    733
1  257  29439
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.7705209, 'recall': 0.7156938, 'specificity': 0.7156938, 'f1': 0.6977067, 'auroc': 0.86591816, 'binary_precision': 0.6404736, 'binary_recall': 0.9444444, 'binary_specificity': 0.48694316, 'binary_f1_score': 0.7633098}
confusion matrix:
     0    1
0  317  334
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7931548, 'recall': 0.7111023, 'specificity': 0.7111023, 'f1': 0.6998221, 'auroc': 0.8900658, 'binary_precision': 0.6666667, 'binary_recall': 0.9644269, 'binary_specificity': 0.45777777, 'binary_f1_score': 0.78836834}
confusion matrix:
     0    1
0  103  122
1    9  244
early stop counter: 10
val acc:0.7119438052177429, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 25,now: 2024-07-12 23:40:43.152732,epoch time: 0:09:40.376514,used: 3:56:31.560954,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9685738, 'precision': 0.858461, 'recall': 0.76889956, 'specificity': 0.76889956, 'f1': 0.8064915, 'auroc': 0.95601285, 'binary_precision': 0.97713524, 'binary_recall': 0.99013305, 'binary_specificity': 0.547666, 'binary_f1_score': 0.98359126}
confusion matrix:
     0      1
0  833    688
1  293  29402
---- Validation: 
scalar performance:
{'acc': 0.715847, 'precision': 0.77009845, 'recall': 0.71945727, 'specificity': 0.71945727, 'f1': 0.7029418, 'auroc': 0.86698604, 'binary_precision': 0.6448802, 'binary_recall': 0.93968254, 'binary_specificity': 0.49923196, 'binary_f1_score': 0.7648579}
confusion matrix:
     0    1
0  325  326
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73849374, 'precision': 0.7977188, 'recall': 0.7246816, 'specificity': 0.7246816, 'f1': 0.7165493, 'auroc': 0.89122534, 'binary_precision': 0.67877096, 'binary_recall': 0.9604743, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.79541737}
confusion matrix:
     0    1
0  110  115
1   10  243
early stop counter: 11
val acc:0.7158470153808594, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 26,now: 2024-07-12 23:50:26.044152,epoch time: 0:09:42.891420,used: 4:06:14.452374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96963096, 'precision': 0.87831485, 'recall': 0.758227, 'specificity': 0.758227, 'f1': 0.80561817, 'auroc': 0.95943516, 'binary_precision': 0.97602254, 'binary_recall': 0.9924566, 'binary_specificity': 0.52399737, 'binary_f1_score': 0.98417103}
confusion matrix:
     0      1
0  797    724
1  224  29471
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.7672462, 'recall': 0.7072965, 'specificity': 0.7072965, 'f1': 0.6869807, 'auroc': 0.8697096, 'binary_precision': 0.63241524, 'binary_recall': 0.947619, 'binary_specificity': 0.4669739, 'binary_f1_score': 0.75857687}
confusion matrix:
     0    1
0  304  347
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.79280555, 'recall': 0.7041897, 'specificity': 0.7041897, 'f1': 0.690821, 'auroc': 0.8948792, 'binary_precision': 0.6603774, 'binary_recall': 0.96837944, 'binary_specificity': 0.44, 'binary_f1_score': 0.78525645}
confusion matrix:
    0    1
0  99  126
1   8  245
early stop counter: 12
val acc:0.7033567428588867, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 27,now: 2024-07-13 00:00:12.568474,epoch time: 0:09:46.524322,used: 4:16:00.976696,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9681894, 'precision': 0.86656857, 'recall': 0.7509196, 'specificity': 0.7509196, 'f1': 0.79662097, 'auroc': 0.9601095, 'binary_precision': 0.9753246, 'binary_recall': 0.99164844, 'binary_specificity': 0.51019067, 'binary_f1_score': 0.9834187}
confusion matrix:
     0      1
0  776    745
1  248  29447
---- Validation: 
scalar performance:
{'acc': 0.704918, 'precision': 0.7682064, 'recall': 0.70883256, 'specificity': 0.70883256, 'f1': 0.68886185, 'auroc': 0.87141883, 'binary_precision': 0.63375795, 'binary_recall': 0.947619, 'binary_specificity': 0.47004607, 'binary_f1_score': 0.7595419}
confusion matrix:
     0    1
0  306  345
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7965168, 'recall': 0.7108564, 'specificity': 0.7108564, 'f1': 0.6990026, 'auroc': 0.8972156, 'binary_precision': 0.6657609, 'binary_recall': 0.96837944, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78905}
confusion matrix:
     0    1
0  102  123
1    8  245
early stop counter: 13
val acc:0.7049180269241333, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 28,now: 2024-07-13 00:09:54.011089,epoch time: 0:09:41.442615,used: 4:25:42.419311,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.96879804, 'precision': 0.8647727, 'recall': 0.76309144, 'specificity': 0.76309144, 'f1': 0.80469656, 'auroc': 0.96328044, 'binary_precision': 0.9765389, 'binary_recall': 0.9910086, 'binary_specificity': 0.53517425, 'binary_f1_score': 0.98372054}
confusion matrix:
     0      1
0  814    707
1  267  29428
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.76964575, 'recall': 0.7111367, 'specificity': 0.7111367, 'f1': 0.6916754, 'auroc': 0.87285984, 'binary_precision': 0.6357827, 'binary_recall': 0.947619, 'binary_specificity': 0.47465438, 'binary_f1_score': 0.7609943}
confusion matrix:
     0    1
0  309  342
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.8012233, 'recall': 0.7128327, 'specificity': 0.7128327, 'f1': 0.7008876, 'auroc': 0.8987615, 'binary_precision': 0.6666667, 'binary_recall': 0.972332, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.7909968}
confusion matrix:
     0    1
0  102  123
1    7  246
early stop counter: 14
val acc:0.7072599530220032, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 29,now: 2024-07-13 00:19:33.449506,epoch time: 0:09:39.438417,used: 4:35:21.857728,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96825343, 'precision': 0.86154044, 'recall': 0.758595, 'specificity': 0.758595, 'f1': 0.80048084, 'auroc': 0.9616325, 'binary_precision': 0.97611547, 'binary_recall': 0.9908742, 'binary_specificity': 0.5263158, 'binary_f1_score': 0.98343945}
confusion matrix:
     0      1
0  800    720
1  271  29425
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.7672462, 'recall': 0.7072965, 'specificity': 0.7072965, 'f1': 0.6869807, 'auroc': 0.8748421, 'binary_precision': 0.63241524, 'binary_recall': 0.947619, 'binary_specificity': 0.4669739, 'binary_f1_score': 0.75857687}
confusion matrix:
     0    1
0  304  347
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.802421, 'recall': 0.71505487, 'specificity': 0.71505487, 'f1': 0.7035979, 'auroc': 0.9012034, 'binary_precision': 0.66847825, 'binary_recall': 0.972332, 'binary_specificity': 0.45777777, 'binary_f1_score': 0.79227054}
confusion matrix:
     0    1
0  103  122
1    7  246
early stop counter: 15
val acc:0.7033567428588867, best validation acc: 0.7189695835113525, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 30,now: 2024-07-13 00:29:14.194967,epoch time: 0:09:40.745461,used: 4:45:02.603189,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_44_11_seed_1_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:45:02.603189 at 2024-07-13 00:29:14.194967
persisted model performance metric: 

scalar performance:
{'acc': 0.7426778, 'precision': 0.8003085, 'recall': 0.72912604, 'specificity': 0.72912604, 'f1': 0.7217814, 'auroc': 0.8675802, 'binary_precision': 0.6825843, 'binary_recall': 0.9604743, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.7980296}
confusion matrix:
     0    1
0  112  113
1   10  243
oracle model performance metric: 

scalar performance:
{'acc': 0.7447699, 'precision': 0.8045466, 'recall': 0.73110235, 'specificity': 0.73110235, 'f1': 0.72369945, 'auroc': 0.8781203, 'binary_precision': 0.6834734, 'binary_recall': 0.9644269, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.8}
confusion matrix:
     0    1
0  112  113
1    9  244
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  35394 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |   4088 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4385    |  100305 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57741 K  |   57740 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4385    |  100305 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57741 K  |   57740 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      19    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    1972    |   57314 K  |   57314 K  |
|       from large pool |      10    |      22    |   24954 K  |   24954 K  |
|       from small pool |      29    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57314 K  |   57314 K  |
|       from large pool |       3    |      22    |   24954 K  |   24954 K  |
|       from small pool |       0    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57314 K  |   57314 K  |
|       from large pool |       3    |      22    |   24954 K  |   24954 K  |
|       from small pool |       0    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849

 Experiment start at: 2024-07-13 00:43:09.026892
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8894378, 'precision': 0.53732824, 'recall': 0.5605924, 'specificity': 0.5605924, 'f1': 0.54375356, 'auroc': 0.6229578, 'binary_precision': 0.95774794, 'binary_recall': 0.92461485, 'binary_specificity': 0.19656992, 'binary_f1_score': 0.9408897}
confusion matrix:
      0      1
0   298   1218
1  2251  27609
---- Validation: 
scalar performance:
{'acc': 0.51799685, 'precision': 0.603312, 'recall': 0.5292796, 'specificity': 0.5292796, 'f1': 0.42059076, 'auroc': 0.68935275, 'binary_precision': 0.5025424, 'binary_recall': 0.95337623, 'binary_specificity': 0.10518292, 'binary_f1_score': 0.65815765}
confusion matrix:
    0    1
0  69  587
1  29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53894734, 'precision': 0.46395272, 'recall': 0.49613005, 'specificity': 0.49613005, 'f1': 0.36996162, 'auroc': 0.30464393, 'binary_precision': 0.54329, 'binary_recall': 0.969112, 'binary_specificity': 0.023148147, 'binary_f1_score': 0.69625515}
confusion matrix:
   0    1
0  5  211
1  8  251
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-13 00:52:55.691146,epoch time: 0:09:46.664254,used: 0:09:46.664254,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9450854, 'precision': 0.5986972, 'recall': 0.52721477, 'specificity': 0.52721477, 'f1': 0.5369066, 'auroc': 0.6733214, 'binary_precision': 0.9542182, 'binary_recall': 0.9897857, 'binary_specificity': 0.0646438, 'binary_f1_score': 0.97167665}
confusion matrix:
     0      1
0   98   1418
1  305  29555
---- Validation: 
scalar performance:
{'acc': 0.49608764, 'precision': 0.645628, 'recall': 0.5089797, 'specificity': 0.5089797, 'f1': 0.35239205, 'auroc': 0.7184608, 'binary_precision': 0.49125597, 'binary_recall': 0.99356914, 'binary_specificity': 0.024390243, 'binary_f1_score': 0.6574468}
confusion matrix:
    0    1
0  16  640
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.34153795, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
new oracle model saved
early stop counter: 1
val acc:0.4960876405239105, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 2,now: 2024-07-13 01:02:39.157511,epoch time: 0:09:43.466365,used: 0:19:30.130619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9499936, 'precision': 0.6526902, 'recall': 0.51883596, 'specificity': 0.51883596, 'f1': 0.5243195, 'auroc': 0.7286274, 'binary_precision': 0.953425, 'binary_recall': 0.9961152, 'binary_specificity': 0.041556727, 'binary_f1_score': 0.97430277}
confusion matrix:
     0      1
0   63   1453
1  116  29744
---- Validation: 
scalar performance:
{'acc': 0.49217528, 'precision': 0.65376335, 'recall': 0.50525206, 'specificity': 0.50525206, 'f1': 0.34170923, 'auroc': 0.7396945, 'binary_precision': 0.4893449, 'binary_recall': 0.99678457, 'binary_specificity': 0.013719512, 'binary_f1_score': 0.656432}
confusion matrix:
   0    1
0  9  647
1  2  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.38904977, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 2
val acc:0.49217528104782104, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 3,now: 2024-07-13 01:12:26.318017,epoch time: 0:09:47.160506,used: 0:29:17.291125,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9507585, 'precision': 0.6694406, 'recall': 0.51485485, 'specificity': 0.51485485, 'f1': 0.5171821, 'auroc': 0.7650523, 'binary_precision': 0.9530545, 'binary_recall': 0.9973878, 'binary_specificity': 0.0323219, 'binary_f1_score': 0.97471726}
confusion matrix:
    0      1
0  49   1467
1  78  29782
---- Validation: 
scalar performance:
{'acc': 0.49374023, 'precision': 0.69961256, 'recall': 0.5068181, 'specificity': 0.5068181, 'f1': 0.34373787, 'auroc': 0.75648963, 'binary_precision': 0.49013418, 'binary_recall': 0.9983923, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65749073}
confusion matrix:
    0    1
0  10  646
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.4423352, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 3
val acc:0.4937402307987213, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 4,now: 2024-07-13 01:22:12.489266,epoch time: 0:09:46.171249,used: 0:39:03.462374,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9514916, 'precision': 0.7143799, 'recall': 0.51805764, 'specificity': 0.51805764, 'f1': 0.52295685, 'auroc': 0.81358624, 'binary_precision': 0.95334995, 'binary_recall': 0.9978567, 'binary_specificity': 0.038258575, 'binary_f1_score': 0.9750956}
confusion matrix:
    0      1
0  58   1458
1  64  29796
---- Validation: 
scalar performance:
{'acc': 0.4945227, 'precision': 0.703594, 'recall': 0.5075803, 'specificity': 0.5075803, 'f1': 0.34538653, 'auroc': 0.76844704, 'binary_precision': 0.49052134, 'binary_recall': 0.9983923, 'binary_specificity': 0.016768293, 'binary_f1_score': 0.65783894}
confusion matrix:
    0    1
0  11  645
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.49002576, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 4
val acc:0.49452269077301025, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 5,now: 2024-07-13 01:31:55.237230,epoch time: 0:09:42.747964,used: 0:48:46.210338,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9518422, 'precision': 0.7365037, 'recall': 0.52105945, 'specificity': 0.52105945, 'f1': 0.5283659, 'auroc': 0.8382164, 'binary_precision': 0.9536275, 'binary_recall': 0.9979237, 'binary_specificity': 0.04419525, 'binary_f1_score': 0.97527283}
confusion matrix:
    0      1
0  67   1449
1  62  29798
---- Validation: 
scalar performance:
{'acc': 0.49608764, 'precision': 0.7099344, 'recall': 0.50910467, 'specificity': 0.50910467, 'f1': 0.34867126, 'auroc': 0.7780781, 'binary_precision': 0.49129745, 'binary_recall': 0.9983923, 'binary_specificity': 0.019817073, 'binary_f1_score': 0.65853655}
confusion matrix:
    0    1
0  13  643
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5265087, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 5
val acc:0.4960876405239105, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 6,now: 2024-07-13 01:41:37.090501,epoch time: 0:09:41.853271,used: 0:58:28.063609,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9536588, 'precision': 0.82318914, 'recall': 0.53610206, 'specificity': 0.53610206, 'f1': 0.55484253, 'auroc': 0.87147117, 'binary_precision': 0.9550202, 'binary_recall': 0.9983255, 'binary_specificity': 0.07387863, 'binary_f1_score': 0.97619283}
confusion matrix:
     0      1
0  112   1404
1   50  29810
---- Validation: 
scalar performance:
{'acc': 0.5015649, 'precision': 0.7232072, 'recall': 0.51444006, 'specificity': 0.51444006, 'f1': 0.36003706, 'auroc': 0.78363955, 'binary_precision': 0.49403343, 'binary_recall': 0.9983923, 'binary_specificity': 0.030487806, 'binary_f1_score': 0.66098994}
confusion matrix:
    0    1
0  20  636
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.55823684, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 6
val acc:0.5015649199485779, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 7,now: 2024-07-13 01:51:19.736188,epoch time: 0:09:42.645687,used: 1:08:10.709296,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9535314, 'precision': 0.80321777, 'recall': 0.540105, 'specificity': 0.540105, 'f1': 0.56124276, 'auroc': 0.8720031, 'binary_precision': 0.9553938, 'binary_recall': 0.9977562, 'binary_specificity': 0.082453825, 'binary_f1_score': 0.9761155}
confusion matrix:
     0      1
0  125   1391
1   67  29793
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.7125, 'recall': 0.5257896, 'specificity': 0.5257896, 'f1': 0.38595662, 'auroc': 0.78874147, 'binary_precision': 0.5, 'binary_recall': 0.99517685, 'binary_specificity': 0.056402437, 'binary_f1_score': 0.6655914}
confusion matrix:
    0    1
0  37  619
1   3  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5875697, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 7
val acc:0.5133020281791687, best validation acc: 0.5179968476295471, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 8,now: 2024-07-13 02:01:02.784526,epoch time: 0:09:43.048338,used: 1:17:53.757634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9541369, 'precision': 0.82560146, 'recall': 0.54418, 'specificity': 0.54418, 'f1': 0.56818914, 'auroc': 0.88865507, 'binary_precision': 0.9557715, 'binary_recall': 0.9979906, 'binary_specificity': 0.090369396, 'binary_f1_score': 0.97642493}
confusion matrix:
     0      1
0  137   1379
1   60  29800
---- Validation: 
scalar performance:
{'acc': 0.52190924, 'precision': 0.706794, 'recall': 0.53409046, 'specificity': 0.53409046, 'f1': 0.40474084, 'auroc': 0.7925652, 'binary_precision': 0.5044971, 'binary_recall': 0.9919614, 'binary_specificity': 0.076219514, 'binary_f1_score': 0.6688347}
confusion matrix:
    0    1
0  50  606
1   5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.60878736, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 9,now: 2024-07-13 02:10:42.023145,epoch time: 0:09:39.238619,used: 1:27:32.996253,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9553799, 'precision': 0.8464439, 'recall': 0.5586082, 'specificity': 0.5586082, 'f1': 0.5912469, 'auroc': 0.9011607, 'binary_precision': 0.95711535, 'binary_recall': 0.9978232, 'binary_specificity': 0.11939314, 'binary_f1_score': 0.9770454}
confusion matrix:
     0      1
0  181   1335
1   65  29795
---- Validation: 
scalar performance:
{'acc': 0.53912365, 'precision': 0.71368235, 'recall': 0.5507754, 'specificity': 0.5507754, 'f1': 0.43850493, 'auroc': 0.7949132, 'binary_precision': 0.51378447, 'binary_recall': 0.988746, 'binary_specificity': 0.112804875, 'binary_f1_score': 0.67619574}
confusion matrix:
    0    1
0  74  582
1   7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.6259295, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 10,now: 2024-07-13 02:20:21.641532,epoch time: 0:09:39.618387,used: 1:37:12.614640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9568779, 'precision': 0.8572162, 'recall': 0.5781794, 'specificity': 0.5781794, 'f1': 0.62022984, 'auroc': 0.90763307, 'binary_precision': 0.95894647, 'binary_recall': 0.9973878, 'binary_specificity': 0.15897098, 'binary_f1_score': 0.9777894}
confusion matrix:
     0      1
0  241   1275
1   78  29782
---- Validation: 
scalar performance:
{'acc': 0.5594679, 'precision': 0.7184132, 'recall': 0.57046753, 'specificity': 0.57046753, 'f1': 0.4764136, 'auroc': 0.7977543, 'binary_precision': 0.5253219, 'binary_recall': 0.98392284, 'binary_specificity': 0.1570122, 'binary_f1_score': 0.6849469}
confusion matrix:
     0    1
0  103  553
1   10  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5768421, 'precision': 0.78152174, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.4251576, 'auroc': 0.643304, 'binary_precision': 0.5630435, 'binary_recall': 1.0, 'binary_specificity': 0.06944445, 'binary_f1_score': 0.72044504}
confusion matrix:
    0    1
0  15  201
1   0  259
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-13 02:30:04.510312,epoch time: 0:09:42.868780,used: 1:46:55.483420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9590451, 'precision': 0.8966547, 'recall': 0.59434545, 'specificity': 0.59434545, 'f1': 0.64457417, 'auroc': 0.9119834, 'binary_precision': 0.9604564, 'binary_recall': 0.9980576, 'binary_specificity': 0.19063325, 'binary_f1_score': 0.9788961}
confusion matrix:
     0      1
0  289   1227
1   58  29802
---- Validation: 
scalar performance:
{'acc': 0.57276994, 'precision': 0.7218323, 'recall': 0.5833415, 'specificity': 0.5833415, 'f1': 0.49984378, 'auroc': 0.8003441, 'binary_precision': 0.5332168, 'binary_recall': 0.9807074, 'binary_specificity': 0.18597561, 'binary_f1_score': 0.6908268}
confusion matrix:
     0    1
0  122  534
1   12  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58947366, 'precision': 0.7852423, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.45186144, 'auroc': 0.6584084, 'binary_precision': 0.5704846, 'binary_recall': 1.0, 'binary_specificity': 0.097222224, 'binary_f1_score': 0.72650766}
confusion matrix:
    0    1
0  21  195
1   0  259
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-13 02:39:47.607439,epoch time: 0:09:43.097127,used: 1:56:38.580547,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9586308, 'precision': 0.8535929, 'recall': 0.60727674, 'specificity': 0.60727674, 'f1': 0.6582018, 'auroc': 0.9150542, 'binary_precision': 0.9616902, 'binary_recall': 0.9962157, 'binary_specificity': 0.21833773, 'binary_f1_score': 0.97864854}
confusion matrix:
     0      1
0  331   1185
1  113  29747
---- Validation: 
scalar performance:
{'acc': 0.59233177, 'precision': 0.7248231, 'recall': 0.6022297, 'specificity': 0.6022297, 'f1': 0.5331577, 'auroc': 0.801371, 'binary_precision': 0.54545456, 'binary_recall': 0.97427654, 'binary_specificity': 0.23018293, 'binary_f1_score': 0.69936526}
confusion matrix:
     0    1
0  151  505
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60210526, 'precision': 0.77199626, 'recall': 0.56288433, 'specificity': 0.56288433, 'f1': 0.48024318, 'auroc': 0.67274415, 'binary_precision': 0.57847536, 'binary_recall': 0.996139, 'binary_specificity': 0.12962963, 'binary_f1_score': 0.73191494}
confusion matrix:
    0    1
0  28  188
1   1  258
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-13 02:49:29.884312,epoch time: 0:09:42.276873,used: 2:06:20.857420,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9608299, 'precision': 0.8717836, 'recall': 0.63003397, 'specificity': 0.63003397, 'f1': 0.68702173, 'auroc': 0.91785455, 'binary_precision': 0.9638402, 'binary_recall': 0.9962157, 'binary_specificity': 0.26385224, 'binary_f1_score': 0.9797606}
confusion matrix:
     0      1
0  400   1116
1  113  29747
---- Validation: 
scalar performance:
{'acc': 0.59859157, 'precision': 0.7223543, 'recall': 0.60820234, 'specificity': 0.60820234, 'f1': 0.54433376, 'auroc': 0.80297375, 'binary_precision': 0.54968095, 'binary_recall': 0.9694534, 'binary_specificity': 0.24695122, 'binary_f1_score': 0.70157075}
confusion matrix:
     0    1
0  162  494
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.7461318, 'recall': 0.56596774, 'specificity': 0.56596774, 'f1': 0.48971426, 'auroc': 0.6835943, 'binary_precision': 0.5804989, 'binary_recall': 0.98841697, 'binary_specificity': 0.14351852, 'binary_f1_score': 0.73142856}
confusion matrix:
    0    1
0  31  185
1   3  256
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-13 02:59:16.668278,epoch time: 0:09:46.783966,used: 2:16:07.641386,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9606387, 'precision': 0.8447726, 'recall': 0.6468393, 'specificity': 0.6468393, 'f1': 0.70166427, 'auroc': 0.9220951, 'binary_precision': 0.96546227, 'binary_recall': 0.9942063, 'binary_specificity': 0.2994723, 'binary_f1_score': 0.97962344}
confusion matrix:
     0      1
0  454   1062
1  173  29687
---- Validation: 
scalar performance:
{'acc': 0.6118936, 'precision': 0.73118687, 'recall': 0.6211596, 'specificity': 0.6211596, 'f1': 0.56389093, 'auroc': 0.80481434, 'binary_precision': 0.55833334, 'binary_recall': 0.9694534, 'binary_specificity': 0.27286586, 'binary_f1_score': 0.7085781}
confusion matrix:
     0    1
0  179  477
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105263, 'precision': 0.7516969, 'recall': 0.5729122, 'specificity': 0.5729122, 'f1': 0.50167567, 'auroc': 0.69397974, 'binary_precision': 0.58447486, 'binary_recall': 0.98841697, 'binary_specificity': 0.1574074, 'binary_f1_score': 0.7345767}
confusion matrix:
    0    1
0  34  182
1   3  256
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-13 03:09:04.072104,epoch time: 0:09:47.403826,used: 2:25:55.045212,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9608618, 'precision': 0.8612991, 'recall': 0.6372513, 'specificity': 0.6372513, 'f1': 0.69383466, 'auroc': 0.9257487, 'binary_precision': 0.9645337, 'binary_recall': 0.9954789, 'binary_specificity': 0.27902374, 'binary_f1_score': 0.97976196}
confusion matrix:
     0      1
0  423   1093
1  135  29725
---- Validation: 
scalar performance:
{'acc': 0.6134585, 'precision': 0.73023486, 'recall': 0.62264234, 'specificity': 0.62264234, 'f1': 0.566656, 'auroc': 0.80642694, 'binary_precision': 0.55947953, 'binary_recall': 0.9678457, 'binary_specificity': 0.27743903, 'binary_f1_score': 0.7090695}
confusion matrix:
     0    1
0  182  474
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105263, 'precision': 0.7411492, 'recall': 0.5732965, 'specificity': 0.5732965, 'f1': 0.50416136, 'auroc': 0.70087945, 'binary_precision': 0.5848624, 'binary_recall': 0.98455596, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.7338129}
confusion matrix:
    0    1
0  35  181
1   4  255
better model found
persisted
after epoch: 16,now: 2024-07-13 03:18:48.014418,epoch time: 0:09:43.942314,used: 2:35:38.987526,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9618817, 'precision': 0.8466581, 'recall': 0.6662766, 'specificity': 0.6662766, 'f1': 0.7212354, 'auroc': 0.9261457, 'binary_precision': 0.96732754, 'binary_recall': 0.99350303, 'binary_specificity': 0.33905014, 'binary_f1_score': 0.9802406}
confusion matrix:
     0      1
0  514   1002
1  194  29666
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.7347995, 'recall': 0.63776124, 'specificity': 0.63776124, 'f1': 0.59015405, 'auroc': 0.80846107, 'binary_precision': 0.5704762, 'binary_recall': 0.96302253, 'binary_specificity': 0.3125, 'binary_f1_score': 0.7165072}
confusion matrix:
     0    1
0  205  451
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6189474, 'precision': 0.7486273, 'recall': 0.5825558, 'specificity': 0.5825558, 'f1': 0.5196096, 'auroc': 0.70999575, 'binary_precision': 0.5902778, 'binary_recall': 0.98455596, 'binary_specificity': 0.18055555, 'binary_f1_score': 0.7380608}
confusion matrix:
    0    1
0  39  177
1   4  255
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-13 03:28:26.108824,epoch time: 0:09:38.094406,used: 2:45:17.081932,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9613399, 'precision': 0.8392423, 'recall': 0.6647396, 'specificity': 0.6647396, 'f1': 0.71837056, 'auroc': 0.92665327, 'binary_precision': 0.96718746, 'binary_recall': 0.9930676, 'binary_specificity': 0.3364116, 'binary_f1_score': 0.9799566}
confusion matrix:
     0      1
0  510   1006
1  207  29653
---- Validation: 
scalar performance:
{'acc': 0.63067293, 'precision': 0.73578244, 'recall': 0.6392857, 'specificity': 0.6392857, 'f1': 0.592317, 'auroc': 0.81051, 'binary_precision': 0.5715649, 'binary_recall': 0.96302253, 'binary_specificity': 0.31554878, 'binary_f1_score': 0.7173653}
confusion matrix:
     0    1
0  207  449
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6231579, 'precision': 0.7520672, 'recall': 0.5871854, 'specificity': 0.5871854, 'f1': 0.52718973, 'auroc': 0.71800375, 'binary_precision': 0.59302324, 'binary_recall': 0.98455596, 'binary_specificity': 0.18981482, 'binary_f1_score': 0.74020314}
confusion matrix:
    0    1
0  41  175
1   4  255
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-13 03:38:03.612556,epoch time: 0:09:37.503732,used: 2:54:54.585664,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9636665, 'precision': 0.8620516, 'recall': 0.68036324, 'specificity': 0.68036324, 'f1': 0.73747015, 'auroc': 0.93440515, 'binary_precision': 0.9686684, 'binary_recall': 0.9939719, 'binary_specificity': 0.36675462, 'binary_f1_score': 0.98115706}
confusion matrix:
     0      1
0  556    960
1  180  29680
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.73690104, 'recall': 0.648307, 'specificity': 0.648307, 'f1': 0.60635, 'auroc': 0.81180394, 'binary_precision': 0.57864076, 'binary_recall': 0.9581994, 'binary_specificity': 0.33841464, 'binary_f1_score': 0.7215496}
confusion matrix:
     0    1
0  222  434
1   26  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6294737, 'precision': 0.7488235, 'recall': 0.5945142, 'specificity': 0.5945142, 'f1': 0.5405179, 'auroc': 0.7241527, 'binary_precision': 0.5976471, 'binary_recall': 0.980695, 'binary_specificity': 0.20833333, 'binary_f1_score': 0.7426901}
confusion matrix:
    0    1
0  45  171
1   5  254
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-13 03:47:37.784857,epoch time: 0:09:34.172301,used: 3:04:28.757965,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9629335, 'precision': 0.86368227, 'recall': 0.6674553, 'specificity': 0.6674553, 'f1': 0.72547716, 'auroc': 0.93095815, 'binary_precision': 0.9674235, 'binary_recall': 0.99454117, 'binary_specificity': 0.3403694, 'binary_f1_score': 0.9807949}
confusion matrix:
     0      1
0  516   1000
1  163  29697
---- Validation: 
scalar performance:
{'acc': 0.63849765, 'precision': 0.73902327, 'recall': 0.64686596, 'specificity': 0.64686596, 'f1': 0.6034372, 'auroc': 0.8143381, 'binary_precision': 0.5772201, 'binary_recall': 0.9614148, 'binary_specificity': 0.33231708, 'binary_f1_score': 0.721351}
confusion matrix:
     0    1
0  218  438
1   24  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62526315, 'precision': 0.7453406, 'recall': 0.5898845, 'specificity': 0.5898845, 'f1': 0.53314114, 'auroc': 0.73130274, 'binary_precision': 0.5948478, 'binary_recall': 0.980695, 'binary_specificity': 0.19907407, 'binary_f1_score': 0.74052477}
confusion matrix:
    0    1
0  43  173
1   5  254
early stop counter: 1
val acc:0.6384976506233215, best validation acc: 0.6400625705718994, corresponding to test acc:                         0.6294736862182617 / 0.6294736862182617
after epoch: 20,now: 2024-07-13 03:57:12.795960,epoch time: 0:09:35.011103,used: 3:14:03.769068,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9634434, 'precision': 0.8556905, 'recall': 0.6830637, 'specificity': 0.6830637, 'f1': 0.73865026, 'auroc': 0.9357616, 'binary_precision': 0.9689368, 'binary_recall': 0.99343604, 'binary_specificity': 0.3726913, 'binary_f1_score': 0.9810335}
confusion matrix:
     0      1
0  565    951
1  196  29664
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.7339814, 'recall': 0.6504686, 'specificity': 0.6504686, 'f1': 0.6106513, 'auroc': 0.8162693, 'binary_precision': 0.58080316, 'binary_recall': 0.95337623, 'binary_specificity': 0.34756097, 'binary_f1_score': 0.7218503}
confusion matrix:
     0    1
0  228  428
1   29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.75, 'recall': 0.60647255, 'specificity': 0.60647255, 'f1': 0.56052077, 'auroc': 0.73891747, 'binary_precision': 0.6052632, 'binary_recall': 0.976834, 'binary_specificity': 0.2361111, 'binary_f1_score': 0.7474151}
confusion matrix:
    0    1
0  51  165
1   6  253
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-13 04:06:47.889586,epoch time: 0:09:35.093626,used: 3:23:38.862694,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9634115, 'precision': 0.8476273, 'recall': 0.6914998, 'specificity': 0.6914998, 'f1': 0.74435914, 'auroc': 0.9368804, 'binary_precision': 0.9697644, 'binary_recall': 0.99249834, 'binary_specificity': 0.39050132, 'binary_f1_score': 0.98099965}
confusion matrix:
     0      1
0  592    924
1  224  29636
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.732708, 'recall': 0.6526719, 'specificity': 0.6526719, 'f1': 0.6145078, 'auroc': 0.81806576, 'binary_precision': 0.58284026, 'binary_recall': 0.9501608, 'binary_specificity': 0.35518292, 'binary_f1_score': 0.72249395}
confusion matrix:
     0    1
0  233  423
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7435626, 'recall': 0.6068569, 'specificity': 0.6068569, 'f1': 0.56242424, 'auroc': 0.7456385, 'binary_precision': 0.6057692, 'binary_recall': 0.972973, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7466666}
confusion matrix:
    0    1
0  52  164
1   7  252
better model found
persisted
after epoch: 22,now: 2024-07-13 04:16:23.698336,epoch time: 0:09:35.808750,used: 3:33:14.671444,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.964782, 'precision': 0.8618909, 'recall': 0.69816816, 'specificity': 0.69816816, 'f1': 0.75342625, 'auroc': 0.93718255, 'binary_precision': 0.970391, 'binary_recall': 0.99330205, 'binary_specificity': 0.4030343, 'binary_f1_score': 0.9817128}
confusion matrix:
     0      1
0  611    905
1  200  29660
---- Validation: 
scalar performance:
{'acc': 0.64397496, 'precision': 0.73219764, 'recall': 0.65190965, 'specificity': 0.65190965, 'f1': 0.6134746, 'auroc': 0.8201269, 'binary_precision': 0.58226603, 'binary_recall': 0.9501608, 'binary_specificity': 0.35365853, 'binary_f1_score': 0.7220526}
confusion matrix:
     0    1
0  232  424
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7435626, 'recall': 0.6068569, 'specificity': 0.6068569, 'f1': 0.56242424, 'auroc': 0.752288, 'binary_precision': 0.6057692, 'binary_recall': 0.972973, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7466666}
confusion matrix:
    0    1
0  52  164
1   7  252
early stop counter: 1
val acc:0.6439749598503113, best validation acc: 0.6447574496269226, corresponding to test acc:                         0.6399999856948853 / 0.6399999856948853
after epoch: 23,now: 2024-07-13 04:26:01.740296,epoch time: 0:09:38.041960,used: 3:42:52.713404,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9650688, 'precision': 0.85720557, 'recall': 0.7080241, 'specificity': 0.7080241, 'f1': 0.7606709, 'auroc': 0.94431734, 'binary_precision': 0.97135556, 'binary_recall': 0.99256533, 'binary_specificity': 0.42348284, 'binary_f1_score': 0.981846}
confusion matrix:
     0      1
0  642    874
1  222  29638
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.7328891, 'recall': 0.65491676, 'specificity': 0.65491676, 'f1': 0.6179575, 'auroc': 0.821965, 'binary_precision': 0.58473736, 'binary_recall': 0.948553, 'binary_specificity': 0.3612805, 'binary_f1_score': 0.72348255}
confusion matrix:
     0    1
0  237  419
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6463158, 'precision': 0.7428528, 'recall': 0.61418563, 'specificity': 0.61418563, 'f1': 0.57462686, 'auroc': 0.75791866, 'binary_precision': 0.6107056, 'binary_recall': 0.969112, 'binary_specificity': 0.25925925, 'binary_f1_score': 0.74925375}
confusion matrix:
    0    1
0  56  160
1   8  251
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-13 04:35:36.958172,epoch time: 0:09:35.217876,used: 3:52:27.931280,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9664074, 'precision': 0.86544883, 'recall': 0.7199979, 'specificity': 0.7199979, 'f1': 0.7725942, 'auroc': 0.941542, 'binary_precision': 0.9725084, 'binary_recall': 0.99276626, 'binary_specificity': 0.44722956, 'binary_f1_score': 0.9825329}
confusion matrix:
     0      1
0  678    838
1  216  29644
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.73339945, 'recall': 0.655679, 'specificity': 0.655679, 'f1': 0.6189827, 'auroc': 0.82415104, 'binary_precision': 0.58531743, 'binary_recall': 0.948553, 'binary_specificity': 0.3628049, 'binary_f1_score': 0.72392637}
confusion matrix:
     0    1
0  238  418
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6463158, 'precision': 0.7428528, 'recall': 0.61418563, 'specificity': 0.61418563, 'f1': 0.57462686, 'auroc': 0.76397824, 'binary_precision': 0.6107056, 'binary_recall': 0.969112, 'binary_specificity': 0.25925925, 'binary_f1_score': 0.74925375}
confusion matrix:
    0    1
0  56  160
1   8  251
better model found
persisted
after epoch: 25,now: 2024-07-13 04:45:17.562138,epoch time: 0:09:40.603966,used: 4:02:08.535246,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9658019, 'precision': 0.8627972, 'recall': 0.71341836, 'specificity': 0.71341836, 'f1': 0.7665411, 'auroc': 0.9454634, 'binary_precision': 0.9718716, 'binary_recall': 0.99279976, 'binary_specificity': 0.43403694, 'binary_f1_score': 0.9822242}
confusion matrix:
     0      1
0  658    858
1  215  29645
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.7362503, 'recall': 0.65800726, 'specificity': 0.65800726, 'f1': 0.621699, 'auroc': 0.8266901, 'binary_precision': 0.5868918, 'binary_recall': 0.9501608, 'binary_specificity': 0.36585367, 'binary_f1_score': 0.7255985}
confusion matrix:
     0    1
0  240  416
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64842105, 'precision': 0.7445591, 'recall': 0.61650044, 'specificity': 0.61650044, 'f1': 0.5780338, 'auroc': 0.7702702, 'binary_precision': 0.61219513, 'binary_recall': 0.969112, 'binary_specificity': 0.2638889, 'binary_f1_score': 0.75037366}
confusion matrix:
    0    1
0  57  159
1   8  251
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-13 04:54:58.434250,epoch time: 0:09:40.872112,used: 4:11:49.407358,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9654832, 'precision': 0.86148703, 'recall': 0.7098071, 'specificity': 0.7098071, 'f1': 0.7632229, 'auroc': 0.9420521, 'binary_precision': 0.9715222, 'binary_recall': 0.9928332, 'binary_specificity': 0.426781, 'binary_f1_score': 0.98206204}
confusion matrix:
     0      1
0  647    869
1  214  29646
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.7362503, 'recall': 0.65800726, 'specificity': 0.65800726, 'f1': 0.621699, 'auroc': 0.8288835, 'binary_precision': 0.5868918, 'binary_recall': 0.9501608, 'binary_specificity': 0.36585367, 'binary_f1_score': 0.7255985}
confusion matrix:
     0    1
0  240  416
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65052634, 'precision': 0.7462399, 'recall': 0.61881524, 'specificity': 0.61881524, 'f1': 0.58142227, 'auroc': 0.7754183, 'binary_precision': 0.6136919, 'binary_recall': 0.969112, 'binary_specificity': 0.2685185, 'binary_f1_score': 0.75149703}
confusion matrix:
    0    1
0  58  158
1   8  251
new oracle model saved
early stop counter: 1
val acc:0.6502347588539124, best validation acc: 0.6502347588539124, corresponding to test acc:                         0.648421049118042 / 0.6505263447761536
after epoch: 27,now: 2024-07-13 05:04:37.910419,epoch time: 0:09:39.476169,used: 4:21:28.883527,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9669811, 'precision': 0.85700285, 'recall': 0.7400228, 'specificity': 0.7400228, 'f1': 0.78568137, 'auroc': 0.9496894, 'binary_precision': 0.97448474, 'binary_recall': 0.9912592, 'binary_specificity': 0.48878628, 'binary_f1_score': 0.9828004}
confusion matrix:
     0      1
0  741    775
1  261  29599
---- Validation: 
scalar performance:
{'acc': 0.6627543, 'precision': 0.7429178, 'recall': 0.67016065, 'specificity': 0.67016065, 'f1': 0.63818985, 'auroc': 0.82950354, 'binary_precision': 0.5965622, 'binary_recall': 0.948553, 'binary_specificity': 0.3917683, 'binary_f1_score': 0.7324643}
confusion matrix:
     0    1
0  257  399
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65894735, 'precision': 0.7476737, 'recall': 0.6284588, 'specificity': 0.6284588, 'f1': 0.59639347, 'auroc': 0.7796904, 'binary_precision': 0.6203474, 'binary_recall': 0.96525097, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.755287}
confusion matrix:
    0    1
0  63  153
1   9  250
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-13 05:14:17.054379,epoch time: 0:09:39.143960,used: 4:31:08.027487,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9661843, 'precision': 0.8494127, 'recall': 0.73741263, 'specificity': 0.73741263, 'f1': 0.78142434, 'auroc': 0.94894576, 'binary_precision': 0.97424495, 'binary_recall': 0.9906564, 'binary_specificity': 0.48416886, 'binary_f1_score': 0.9823821}
confusion matrix:
     0      1
0  734    782
1  279  29581
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.74684155, 'recall': 0.6762582, 'specificity': 0.6762582, 'f1': 0.64612913, 'auroc': 0.831126, 'binary_precision': 0.60142714, 'binary_recall': 0.948553, 'binary_specificity': 0.40396342, 'binary_f1_score': 0.7361198}
confusion matrix:
     0    1
0  265  391
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.7857858, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-13 05:23:56.088930,epoch time: 0:09:39.034551,used: 4:40:47.062038,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9654194, 'precision': 0.84714156, 'recall': 0.72730553, 'specificity': 0.72730553, 'f1': 0.7732135, 'auroc': 0.94914305, 'binary_precision': 0.9732575, 'binary_recall': 0.9908908, 'binary_specificity': 0.46372032, 'binary_f1_score': 0.981995}
confusion matrix:
     0      1
0  703    813
1  272  29588
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.74684155, 'recall': 0.6762582, 'specificity': 0.6762582, 'f1': 0.64612913, 'auroc': 0.83322877, 'binary_precision': 0.60142714, 'binary_recall': 0.948553, 'binary_specificity': 0.40396342, 'binary_f1_score': 0.7361198}
confusion matrix:
     0    1
0  265  391
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.79136276, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
early stop counter: 1
val acc:0.6690140962600708, best validation acc: 0.6690140962600708, corresponding to test acc:                         0.6631578803062439 / 0.6631578803062439
after epoch: 30,now: 2024-07-13 05:33:34.211060,epoch time: 0:09:38.122130,used: 4:50:25.184168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_13_00_43_09_seed_2_21918849
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:50:25.184168 at 2024-07-13 05:33:34.211060
persisted model performance metric: 

scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.7857858, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
oracle model performance metric: 

scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.7857858, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/3.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/3.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 661286 GiB | 661285 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 661286 GiB | 661285 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |  16198 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1086 MiB | 585728 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     72 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37442 KiB | 104341 KiB | 365909 GiB | 365909 GiB |
|       from large pool |  31306 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |   6136 KiB |  11184 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4405    |  150557 K  |  150556 K  |
|       from large pool |      76    |     158    |   63851 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86705 K  |   86704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4405    |  150557 K  |  150556 K  |
|       from large pool |      76    |     158    |   63851 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86705 K  |   86704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      81    |      40    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      19    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1980    |   85757 K  |   85757 K  |
|       from large pool |      10    |      22    |   36924 K  |   36924 K  |
|       from small pool |      30    |    1970    |   48832 K  |   48832 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |      0 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |   1086 MiB |    864 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  38912 KiB |     72 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 104341 KiB | 365909 GiB | 365909 GiB |
|       from large pool |  23872 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |      0 KiB |  12070 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4405    |  150557 K  |  150557 K  |
|       from large pool |       2    |     158    |   63851 K  |   63851 K  |
|       from small pool |       0    |    4327    |   86705 K  |   86705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4405    |  150557 K  |  150557 K  |
|       from large pool |       2    |     158    |   63851 K  |   63851 K  |
|       from small pool |       0    |    4327    |   86705 K  |   86705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      81    |      60    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      19    |      36    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1980    |   85757 K  |   85757 K  |
|       from large pool |       3    |      22    |   36924 K  |   36924 K  |
|       from small pool |       0    |    1970    |   48832 K  |   48832 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 05:41:12 2024]
Finished job 0.
1 of 1 steps (100%) done
