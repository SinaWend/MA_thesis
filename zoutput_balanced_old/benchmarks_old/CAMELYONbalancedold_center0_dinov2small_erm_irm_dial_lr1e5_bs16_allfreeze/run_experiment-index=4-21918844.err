Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 07:35:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844

 Experiment start at: 2024-07-12 07:41:37.302978
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9296875, 'precision': 0.5047763, 'recall': 0.50244313, 'specificity': 0.50244313, 'f1': 0.50109524, 'auroc': 0.4434835, 'binary_precision': 0.9514285, 'binary_recall': 0.97590077, 'binary_specificity': 0.028985508, 'binary_f1_score': 0.9635092}
confusion matrix:
     0      1
0   44   1474
1  713  28873
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5450311, 'precision': 0.727648, 'recall': 0.5511932, 'specificity': 0.5511932, 'f1': 0.43990853, 'auroc': 0.7306725, 'binary_precision': 0.5202312, 'binary_recall': 0.992126, 'binary_specificity': 0.11026034, 'binary_f1_score': 0.6825568}
confusion matrix:
    0    1
0  72  581
1   5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5670103, 'precision': 0.6279335, 'recall': 0.51352286, 'specificity': 0.51352286, 'f1': 0.39796427, 'auroc': 0.6479242, 'binary_precision': 0.5635593, 'binary_recall': 0.9851852, 'binary_specificity': 0.041860465, 'binary_f1_score': 0.7169812}
confusion matrix:
   0    1
0  9  206
1  4  266
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 07:50:52.630986,epoch time: 0:09:15.328008,used: 0:09:15.328008,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.948206, 'precision': 0.5504583, 'recall': 0.50466543, 'specificity': 0.50466543, 'f1': 0.49881235, 'auroc': 0.5352658, 'binary_precision': 0.9516629, 'binary_recall': 0.996147, 'binary_specificity': 0.013183916, 'binary_f1_score': 0.97339696}
confusion matrix:
     0      1
0   20   1497
1  114  29473
---- Validation: 
scalar performance:
{'acc': 0.5124224, 'precision': 0.71690726, 'recall': 0.519099, 'specificity': 0.519099, 'f1': 0.37380272, 'auroc': 0.76678926, 'binary_precision': 0.50277996, 'binary_recall': 0.9968504, 'binary_specificity': 0.041347627, 'binary_f1_score': 0.6684266}
confusion matrix:
    0    1
0  27  626
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56494844, 'precision': 0.7806653, 'recall': 0.5093023, 'specificity': 0.5093023, 'f1': 0.37778547, 'auroc': 0.6857364, 'binary_precision': 0.56133056, 'binary_recall': 1.0, 'binary_specificity': 0.018604651, 'binary_f1_score': 0.7190413}
confusion matrix:
   0    1
0  4  211
1  0  270
early stop counter: 1
val acc:0.5124223828315735, best validation acc: 0.5450310707092285, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 2,now: 2024-07-12 08:00:03.859618,epoch time: 0:09:11.228632,used: 0:18:26.556640,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95036006, 'precision': 0.6007664, 'recall': 0.50362283, 'specificity': 0.50362283, 'f1': 0.49554896, 'auroc': 0.64111376, 'binary_precision': 0.9515329, 'binary_recall': 0.9986818, 'binary_specificity': 0.008563899, 'binary_f1_score': 0.97453743}
confusion matrix:
    0      1
0  13   1505
1  39  29547
---- Validation: 
scalar performance:
{'acc': 0.5124224, 'precision': 0.75138557, 'recall': 0.5191424, 'specificity': 0.5191424, 'f1': 0.37143588, 'auroc': 0.7941735, 'binary_precision': 0.5027712, 'binary_recall': 1.0, 'binary_specificity': 0.03828484, 'binary_f1_score': 0.66912544}
confusion matrix:
    0    1
0  25  628
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5587629, 'precision': 0.77892566, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.36271983, 'auroc': 0.7267872, 'binary_precision': 0.55785125, 'binary_recall': 1.0, 'binary_specificity': 0.004651163, 'binary_f1_score': 0.7161804}
confusion matrix:
   0    1
0  1  214
1  0  270
early stop counter: 2
val acc:0.5124223828315735, best validation acc: 0.5450310707092285, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 3,now: 2024-07-12 08:09:15.111524,epoch time: 0:09:11.251906,used: 0:27:37.808546,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9505851, 'precision': 0.65905964, 'recall': 0.5078034, 'specificity': 0.5078034, 'f1': 0.503685, 'auroc': 0.74300826, 'binary_precision': 0.9519221, 'binary_recall': 0.998479, 'binary_specificity': 0.017127799, 'binary_f1_score': 0.97464496}
confusion matrix:
    0      1
0  26   1492
1  45  29541
---- Validation: 
scalar performance:
{'acc': 0.5256211, 'precision': 0.7548154, 'recall': 0.53215927, 'specificity': 0.53215927, 'f1': 0.39801803, 'auroc': 0.813346, 'binary_precision': 0.5096308, 'binary_recall': 1.0, 'binary_specificity': 0.06431853, 'binary_f1_score': 0.67517275}
confusion matrix:
    0    1
0  42  611
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56082475, 'precision': 0.7795031, 'recall': 0.5046512, 'specificity': 0.5046512, 'f1': 0.36778232, 'auroc': 0.7578294, 'binary_precision': 0.5590062, 'binary_recall': 1.0, 'binary_specificity': 0.009302326, 'binary_f1_score': 0.7171315}
confusion matrix:
   0    1
0  2  213
1  0  270
early stop counter: 3
val acc:0.5256211161613464, best validation acc: 0.5450310707092285, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 4,now: 2024-07-12 08:18:26.966957,epoch time: 0:09:11.855433,used: 0:36:49.663979,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.95039225, 'precision': 0.63210374, 'recall': 0.50583965, 'specificity': 0.50583965, 'f1': 0.49990848, 'auroc': 0.7965343, 'binary_precision': 0.9517075, 'binary_recall': 0.99851274, 'binary_specificity': 0.013166557, 'binary_f1_score': 0.97454846}
confusion matrix:
    0      1
0  20   1499
1  44  29541
---- Validation: 
scalar performance:
{'acc': 0.5372671, 'precision': 0.7494587, 'recall': 0.54362303, 'specificity': 0.54362303, 'f1': 0.42158943, 'auroc': 0.82448304, 'binary_precision': 0.5158666, 'binary_recall': 0.9984252, 'binary_specificity': 0.08882083, 'binary_f1_score': 0.6802575}
confusion matrix:
    0    1
0  58  595
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5628866, 'precision': 0.780083, 'recall': 0.5069767, 'specificity': 0.5069767, 'f1': 0.37280402, 'auroc': 0.7795693, 'binary_precision': 0.560166, 'binary_recall': 1.0, 'binary_specificity': 0.013953488, 'binary_f1_score': 0.7180851}
confusion matrix:
   0    1
0  3  212
1  0  270
early stop counter: 4
val acc:0.5372670888900757, best validation acc: 0.5450310707092285, corresponding to test acc:                         0.5670102834701538 / 0.5670102834701538
after epoch: 5,now: 2024-07-12 08:28:03.039985,epoch time: 0:09:36.073028,used: 0:46:25.737007,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95148534, 'precision': 0.7506652, 'recall': 0.51420665, 'specificity': 0.51420665, 'f1': 0.51569396, 'auroc': 0.8483702, 'binary_precision': 0.9525498, 'binary_recall': 0.99874943, 'binary_specificity': 0.02966381, 'binary_f1_score': 0.9751028}
confusion matrix:
    0      1
0  45   1472
1  37  29550
---- Validation: 
scalar performance:
{'acc': 0.55590063, 'precision': 0.75704646, 'recall': 0.56199974, 'specificity': 0.56199974, 'f1': 0.45597827, 'auroc': 0.83120185, 'binary_precision': 0.5261411, 'binary_recall': 0.9984252, 'binary_specificity': 0.12557428, 'binary_f1_score': 0.6891305}
confusion matrix:
    0    1
0  82  571
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5670103, 'precision': 0.78125, 'recall': 0.5116279, 'specificity': 0.5116279, 'f1': 0.3827273, 'auroc': 0.79429805, 'binary_precision': 0.5625, 'binary_recall': 1.0, 'binary_specificity': 0.023255814, 'binary_f1_score': 0.72}
confusion matrix:
   0    1
0  5  210
1  0  270
better model found
persisted
after epoch: 6,now: 2024-07-12 08:37:17.153945,epoch time: 0:09:14.113960,used: 0:55:39.850967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95209616, 'precision': 0.791939, 'recall': 0.5223486, 'specificity': 0.5223486, 'f1': 0.5306466, 'auroc': 0.8685749, 'binary_precision': 0.9532475, 'binary_recall': 0.9986142, 'binary_specificity': 0.04608295, 'binary_f1_score': 0.97540367}
confusion matrix:
    0      1
0  70   1449
1  41  29544
---- Validation: 
scalar performance:
{'acc': 0.5706522, 'precision': 0.75319254, 'recall': 0.5765046, 'specificity': 0.5765046, 'f1': 0.483531, 'auroc': 0.83463603, 'binary_precision': 0.534687, 'binary_recall': 0.9952756, 'binary_specificity': 0.15773354, 'binary_f1_score': 0.69565225}
confusion matrix:
     0    1
0  103  550
1    3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5731959, 'precision': 0.7830188, 'recall': 0.51860464, 'specificity': 0.51860464, 'f1': 0.3973202, 'auroc': 0.8049785, 'binary_precision': 0.5660377, 'binary_recall': 1.0, 'binary_specificity': 0.037209302, 'binary_f1_score': 0.72289157}
confusion matrix:
   0    1
0  8  207
1  0  270
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 08:46:34.541421,epoch time: 0:09:17.387476,used: 1:04:57.238443,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9525784, 'precision': 0.79005814, 'recall': 0.53416216, 'specificity': 0.53416216, 'f1': 0.55116487, 'auroc': 0.88275373, 'binary_precision': 0.9543853, 'binary_recall': 0.9978368, 'binary_specificity': 0.070487484, 'binary_f1_score': 0.9756275}
confusion matrix:
     0      1
0  107   1411
1   64  29522
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.74934864, 'recall': 0.59785724, 'specificity': 0.59785724, 'f1': 0.5224222, 'auroc': 0.8357382, 'binary_precision': 0.547993, 'binary_recall': 0.98897636, 'binary_specificity': 0.20673813, 'binary_f1_score': 0.7052218}
confusion matrix:
     0    1
0  135  518
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59381443, 'precision': 0.7642473, 'recall': 0.5423342, 'specificity': 0.5423342, 'f1': 0.44683748, 'auroc': 0.81164515, 'binary_precision': 0.5784946, 'binary_recall': 0.9962963, 'binary_specificity': 0.0883721, 'binary_f1_score': 0.7319728}
confusion matrix:
    0    1
0  19  196
1   1  269
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 08:55:51.334207,epoch time: 0:09:16.792786,used: 1:14:14.031229,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95392877, 'precision': 0.8273925, 'recall': 0.5486052, 'specificity': 0.5486052, 'f1': 0.57518345, 'auroc': 0.8963131, 'binary_precision': 0.95571095, 'binary_recall': 0.9978029, 'binary_specificity': 0.0994075, 'binary_f1_score': 0.97630346}
confusion matrix:
     0      1
0  151   1368
1   65  29520
---- Validation: 
scalar performance:
{'acc': 0.6001553, 'precision': 0.750481, 'recall': 0.6054925, 'specificity': 0.6054925, 'f1': 0.5353545, 'auroc': 0.83707654, 'binary_precision': 0.55291003, 'binary_recall': 0.98740155, 'binary_specificity': 0.22358346, 'binary_f1_score': 0.70887506}
confusion matrix:
     0    1
0  146  507
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103093, 'precision': 0.7764536, 'recall': 0.56093884, 'specificity': 0.56093884, 'f1': 0.48112482, 'auroc': 0.8156245, 'binary_precision': 0.58862144, 'binary_recall': 0.9962963, 'binary_specificity': 0.1255814, 'binary_f1_score': 0.7400274}
confusion matrix:
    0    1
0  27  188
1   1  269
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 09:05:02.999996,epoch time: 0:09:11.665789,used: 1:23:25.697018,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95556843, 'precision': 0.83934796, 'recall': 0.5716691, 'specificity': 0.5716691, 'f1': 0.6101334, 'auroc': 0.90680826, 'binary_precision': 0.9579166, 'binary_recall': 0.9970932, 'binary_specificity': 0.14624506, 'binary_f1_score': 0.97711235}
confusion matrix:
     0      1
0  222   1296
1   86  29500
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.74228215, 'recall': 0.61380666, 'specificity': 0.61380666, 'f1': 0.5514874, 'auroc': 0.83699703, 'binary_precision': 0.55884993, 'binary_recall': 0.97952753, 'binary_specificity': 0.24808575, 'binary_f1_score': 0.7116704}
confusion matrix:
     0    1
0  162  491
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63092786, 'precision': 0.7761236, 'recall': 0.5846684, 'specificity': 0.5846684, 'f1': 0.5238448, 'auroc': 0.8182256, 'binary_precision': 0.6022472, 'binary_recall': 0.9925926, 'binary_specificity': 0.1767442, 'binary_f1_score': 0.7496503}
confusion matrix:
    0    1
0  38  177
1   2  268
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-12 09:14:19.546870,epoch time: 0:09:16.546874,used: 1:32:42.243892,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.95704734, 'precision': 0.8428774, 'recall': 0.59405404, 'specificity': 0.59405404, 'f1': 0.64064074, 'auroc': 0.9054663, 'binary_precision': 0.96006906, 'binary_recall': 0.99628216, 'binary_specificity': 0.19182597, 'binary_f1_score': 0.9778404}
confusion matrix:
     0      1
0  291   1226
1  110  29477
---- Validation: 
scalar performance:
{'acc': 0.61180127, 'precision': 0.7418138, 'recall': 0.61684775, 'specificity': 0.61684775, 'f1': 0.5567266, 'auroc': 0.83763134, 'binary_precision': 0.5609756, 'binary_recall': 0.9779528, 'binary_specificity': 0.25574273, 'binary_f1_score': 0.7129736}
confusion matrix:
     0    1
0  167  486
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63917524, 'precision': 0.7811276, 'recall': 0.5939707, 'specificity': 0.5939707, 'f1': 0.53909606, 'auroc': 0.82136095, 'binary_precision': 0.60770977, 'binary_recall': 0.9925926, 'binary_specificity': 0.19534884, 'binary_f1_score': 0.7538678}
confusion matrix:
    0    1
0  42  173
1   2  268
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-12 09:23:37.277711,epoch time: 0:09:17.730841,used: 1:41:59.974733,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9583976, 'precision': 0.8538665, 'recall': 0.61028445, 'specificity': 0.61028445, 'f1': 0.6618291, 'auroc': 0.91594505, 'binary_precision': 0.96156234, 'binary_recall': 0.9960791, 'binary_specificity': 0.2244898, 'binary_f1_score': 0.97851646}
confusion matrix:
     0      1
0  341   1178
1  116  29469
---- Validation: 
scalar performance:
{'acc': 0.63121116, 'precision': 0.7451879, 'recall': 0.63590336, 'specificity': 0.63590336, 'f1': 0.58709675, 'auroc': 0.8386804, 'binary_precision': 0.5744879, 'binary_recall': 0.9716535, 'binary_specificity': 0.30015314, 'binary_f1_score': 0.7220597}
confusion matrix:
     0    1
0  196  457
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6494845, 'precision': 0.7781919, 'recall': 0.6060723, 'specificity': 0.6060723, 'f1': 0.5597125, 'auroc': 0.82449615, 'binary_precision': 0.6152074, 'binary_recall': 0.98888886, 'binary_specificity': 0.22325581, 'binary_f1_score': 0.75852275}
confusion matrix:
    0    1
0  48  167
1   3  267
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-12 09:32:50.411792,epoch time: 0:09:13.134081,used: 1:51:13.108814,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96045524, 'precision': 0.88087785, 'recall': 0.6251723, 'specificity': 0.6251723, 'f1': 0.6822854, 'auroc': 0.9228695, 'binary_precision': 0.9630005, 'binary_recall': 0.99672145, 'binary_specificity': 0.2536232, 'binary_f1_score': 0.9795708}
confusion matrix:
     0      1
0  385   1133
1   97  29489
---- Validation: 
scalar performance:
{'acc': 0.6335404, 'precision': 0.7447407, 'recall': 0.6381787, 'specificity': 0.6381787, 'f1': 0.5908601, 'auroc': 0.83939177, 'binary_precision': 0.57623947, 'binary_recall': 0.97007877, 'binary_specificity': 0.3062787, 'binary_f1_score': 0.7230047}
confusion matrix:
     0    1
0  200  453
1   19  616
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6556701, 'precision': 0.781967, 'recall': 0.6130491, 'specificity': 0.6130491, 'f1': 0.5704755, 'auroc': 0.82578814, 'binary_precision': 0.61948955, 'binary_recall': 0.98888886, 'binary_specificity': 0.2372093, 'binary_f1_score': 0.7617689}
confusion matrix:
    0    1
0  51  164
1   3  267
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 09:42:02.930358,epoch time: 0:09:12.518566,used: 2:00:25.627380,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9598122, 'precision': 0.84226036, 'recall': 0.6411614, 'specificity': 0.6411614, 'f1': 0.6953418, 'auroc': 0.9205761, 'binary_precision': 0.9645867, 'binary_recall': 0.99425423, 'binary_specificity': 0.28806856, 'binary_f1_score': 0.97919583}
confusion matrix:
     0      1
0  437   1080
1  170  29417
---- Validation: 
scalar performance:
{'acc': 0.64363354, 'precision': 0.7490107, 'recall': 0.6481111, 'specificity': 0.6481111, 'f1': 0.60538346, 'auroc': 0.83984035, 'binary_precision': 0.58349144, 'binary_recall': 0.96850395, 'binary_specificity': 0.32771823, 'binary_f1_score': 0.72824156}
confusion matrix:
     0    1
0  214  439
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.7783083, 'recall': 0.6204996, 'specificity': 0.6204996, 'f1': 0.5829138, 'auroc': 0.8285788, 'binary_precision': 0.62441313, 'binary_recall': 0.9851852, 'binary_specificity': 0.25581396, 'binary_f1_score': 0.76436776}
confusion matrix:
    0    1
0  55  160
1   4  266
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-12 09:51:12.859297,epoch time: 0:09:09.928939,used: 2:09:35.556319,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9613233, 'precision': 0.85397434, 'recall': 0.6562517, 'specificity': 0.6562517, 'f1': 0.71266484, 'auroc': 0.92413825, 'binary_precision': 0.9660132, 'binary_recall': 0.99432164, 'binary_specificity': 0.3181818, 'binary_f1_score': 0.97996306}
confusion matrix:
     0      1
0  483   1035
1  168  29418
---- Validation: 
scalar performance:
{'acc': 0.6506211, 'precision': 0.75148606, 'recall': 0.65498066, 'specificity': 0.65498066, 'f1': 0.61535496, 'auroc': 0.8406434, 'binary_precision': 0.58868647, 'binary_recall': 0.96692914, 'binary_specificity': 0.34303215, 'binary_f1_score': 0.73182356}
confusion matrix:
     0    1
0  224  429
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66391754, 'precision': 0.7729162, 'recall': 0.6232989, 'specificity': 0.6232989, 'f1': 0.58817154, 'auroc': 0.83092165, 'binary_precision': 0.62647754, 'binary_recall': 0.9814815, 'binary_specificity': 0.26511627, 'binary_f1_score': 0.7647907}
confusion matrix:
    0    1
0  57  158
1   5  265
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 10:00:21.546368,epoch time: 0:09:08.687071,used: 2:18:44.243390,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96309155, 'precision': 0.8685664, 'recall': 0.6712429, 'specificity': 0.6712429, 'f1': 0.7299984, 'auroc': 0.9294003, 'binary_precision': 0.9674535, 'binary_recall': 0.99465966, 'binary_specificity': 0.3478261, 'binary_f1_score': 0.9808679}
confusion matrix:
     0      1
0  528    990
1  158  29428
---- Validation: 
scalar performance:
{'acc': 0.6490683, 'precision': 0.75057006, 'recall': 0.65344924, 'specificity': 0.65344924, 'f1': 0.61324406, 'auroc': 0.8411933, 'binary_precision': 0.5875598, 'binary_recall': 0.96692914, 'binary_specificity': 0.33996937, 'binary_f1_score': 0.73095244}
confusion matrix:
     0    1
0  222  431
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66391754, 'precision': 0.7666642, 'recall': 0.6237726, 'specificity': 0.6237726, 'f1': 0.5899403, 'auroc': 0.83329886, 'binary_precision': 0.6270784, 'binary_recall': 0.9777778, 'binary_specificity': 0.26976743, 'binary_f1_score': 0.76410997}
confusion matrix:
    0    1
0  58  157
1   6  264
early stop counter: 1
val acc:0.649068295955658, best validation acc: 0.6506211161613464, corresponding to test acc:                         0.6639175415039062 / 0.6639175415039062
after epoch: 16,now: 2024-07-12 10:09:31.000280,epoch time: 0:09:09.453912,used: 2:27:53.697302,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9637989, 'precision': 0.8662331, 'recall': 0.6843198, 'specificity': 0.6843198, 'f1': 0.741933, 'auroc': 0.92825794, 'binary_precision': 0.9687078, 'binary_recall': 0.99405104, 'binary_specificity': 0.37458855, 'binary_f1_score': 0.98121583}
confusion matrix:
     0      1
0  569    950
1  176  29409
---- Validation: 
scalar performance:
{'acc': 0.6506211, 'precision': 0.7531061, 'recall': 0.65500236, 'specificity': 0.65500236, 'f1': 0.61495537, 'auroc': 0.84275115, 'binary_precision': 0.5885168, 'binary_recall': 0.96850395, 'binary_specificity': 0.34150076, 'binary_f1_score': 0.73214287}
confusion matrix:
     0    1
0  223  430
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66391754, 'precision': 0.7666642, 'recall': 0.6237726, 'specificity': 0.6237726, 'f1': 0.5899403, 'auroc': 0.8367614, 'binary_precision': 0.6270784, 'binary_recall': 0.9777778, 'binary_specificity': 0.26976743, 'binary_f1_score': 0.76410997}
confusion matrix:
    0    1
0  58  157
1   6  264
early stop counter: 2
val acc:0.6506211161613464, best validation acc: 0.6506211161613464, corresponding to test acc:                         0.6639175415039062 / 0.6639175415039062
after epoch: 17,now: 2024-07-12 10:18:40.200827,epoch time: 0:09:09.200547,used: 2:37:02.897849,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9635738, 'precision': 0.856503, 'recall': 0.69044673, 'specificity': 0.69044673, 'f1': 0.74541014, 'auroc': 0.9317845, 'binary_precision': 0.9693191, 'binary_recall': 0.99313843, 'binary_specificity': 0.3877551, 'binary_f1_score': 0.9810842}
confusion matrix:
     0      1
0  589    930
1  203  29382
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.75914395, 'recall': 0.6679975, 'specificity': 0.6679975, 'f1': 0.63304484, 'auroc': 0.8434024, 'binary_precision': 0.5984405, 'binary_recall': 0.96692914, 'binary_specificity': 0.36906585, 'binary_f1_score': 0.73931366}
confusion matrix:
     0    1
0  241  412
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.7697908, 'recall': 0.6381998, 'specificity': 0.6381998, 'f1': 0.61154675, 'auroc': 0.8379673, 'binary_precision': 0.63680387, 'binary_recall': 0.97407407, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.77013177}
confusion matrix:
    0    1
0  65  150
1   7  263
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-12 10:28:00.321189,epoch time: 0:09:20.120362,used: 2:46:23.018211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9629308, 'precision': 0.8531557, 'recall': 0.6835512, 'specificity': 0.6835512, 'f1': 0.73852193, 'auroc': 0.9332944, 'binary_precision': 0.968649, 'binary_recall': 0.9931722, 'binary_specificity': 0.37393022, 'binary_f1_score': 0.9807573}
confusion matrix:
     0      1
0  568    951
1  202  29383
---- Validation: 
scalar performance:
{'acc': 0.6583851, 'precision': 0.75757575, 'recall': 0.66265935, 'specificity': 0.66265935, 'f1': 0.62543786, 'auroc': 0.8457079, 'binary_precision': 0.5942029, 'binary_recall': 0.96850395, 'binary_specificity': 0.3568147, 'binary_f1_score': 0.73652697}
confusion matrix:
     0    1
0  233  420
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6701031, 'precision': 0.7710134, 'recall': 0.63074934, 'specificity': 0.63074934, 'f1': 0.600033, 'auroc': 0.8404995, 'binary_precision': 0.6315789, 'binary_recall': 0.9777778, 'binary_specificity': 0.28372094, 'binary_f1_score': 0.76744187}
confusion matrix:
    0    1
0  61  154
1   6  264
early stop counter: 1
val acc:0.6583850979804993, best validation acc: 0.6638198494911194, corresponding to test acc:                         0.6762886643409729 / 0.6762886643409729
after epoch: 19,now: 2024-07-12 10:37:20.581013,epoch time: 0:09:20.259824,used: 2:55:43.278035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.96360594, 'precision': 0.85018784, 'recall': 0.69776165, 'specificity': 0.69776165, 'f1': 0.75030565, 'auroc': 0.93781716, 'binary_precision': 0.9700654, 'binary_recall': 0.99236125, 'binary_specificity': 0.40316206, 'binary_f1_score': 0.9810867}
confusion matrix:
     0      1
0  612    906
1  226  29360
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.75869906, 'recall': 0.6672318, 'specificity': 0.6672318, 'f1': 0.6320165, 'auroc': 0.84772396, 'binary_precision': 0.59785783, 'binary_recall': 0.96692914, 'binary_specificity': 0.36753446, 'binary_f1_score': 0.73886883}
confusion matrix:
     0    1
0  240  413
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77658707, 'recall': 0.64005166, 'specificity': 0.64005166, 'f1': 0.6132376, 'auroc': 0.84475446, 'binary_precision': 0.6376812, 'binary_recall': 0.9777778, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.7719298}
confusion matrix:
    0    1
0  65  150
1   6  264
new oracle model saved
early stop counter: 2
val acc:0.6630434989929199, best validation acc: 0.6638198494911194, corresponding to test acc:                         0.6762886643409729 / 0.6783505082130432
after epoch: 20,now: 2024-07-12 10:46:33.675584,epoch time: 0:09:13.094571,used: 3:04:56.372606,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96360594, 'precision': 0.8484044, 'recall': 0.699949, 'specificity': 0.699949, 'f1': 0.7517226, 'auroc': 0.9353533, 'binary_precision': 0.970283, 'binary_recall': 0.9921247, 'binary_specificity': 0.40777338, 'binary_f1_score': 0.98108226}
confusion matrix:
     0      1
0  619    899
1  233  29353
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.7611016, 'recall': 0.6687849, 'specificity': 0.6687849, 'f1': 0.6337123, 'auroc': 0.8494773, 'binary_precision': 0.59883153, 'binary_recall': 0.96850395, 'binary_specificity': 0.36906585, 'binary_f1_score': 0.7400722}
confusion matrix:
     0    1
0  241  412
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77122957, 'recall': 0.6405254, 'specificity': 0.6405254, 'f1': 0.6147972, 'auroc': 0.84825146, 'binary_precision': 0.63834953, 'binary_recall': 0.97407407, 'binary_specificity': 0.30697674, 'binary_f1_score': 0.771261}
confusion matrix:
    0    1
0  66  149
1   7  263
better model found
persisted
after epoch: 21,now: 2024-07-12 10:55:46.106153,epoch time: 0:09:12.430569,used: 3:14:08.803175,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9647312, 'precision': 0.8578901, 'recall': 0.7076051, 'specificity': 0.7076051, 'f1': 0.7604665, 'auroc': 0.9428018, 'binary_precision': 0.9710006, 'binary_recall': 0.9925638, 'binary_specificity': 0.4226465, 'binary_f1_score': 0.9816638}
confusion matrix:
     0      1
0  642    877
1  220  29365
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.75914395, 'recall': 0.6679975, 'specificity': 0.6679975, 'f1': 0.63304484, 'auroc': 0.8520843, 'binary_precision': 0.5984405, 'binary_recall': 0.96692914, 'binary_specificity': 0.36906585, 'binary_f1_score': 0.73931366}
confusion matrix:
     0    1
0  241  412
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68247426, 'precision': 0.774065, 'recall': 0.6451766, 'specificity': 0.6451766, 'f1': 0.6212475, 'auroc': 0.85269594, 'binary_precision': 0.6414634, 'binary_recall': 0.97407407, 'binary_specificity': 0.31627908, 'binary_f1_score': 0.7735294}
confusion matrix:
    0    1
0  68  147
1   7  263
new oracle model saved
early stop counter: 1
val acc:0.6638198494911194, best validation acc: 0.6645962595939636, corresponding to test acc:                         0.6783505082130432 / 0.6824742555618286
after epoch: 22,now: 2024-07-12 11:05:05.583965,epoch time: 0:09:19.477812,used: 3:23:28.280987,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96543854, 'precision': 0.85995245, 'recall': 0.71622384, 'specificity': 0.71622384, 'f1': 0.76807475, 'auroc': 0.9438925, 'binary_precision': 0.9718646, 'binary_recall': 0.99239504, 'binary_specificity': 0.4400527, 'binary_f1_score': 0.9820225}
confusion matrix:
     0      1
0  668    850
1  225  29361
---- Validation: 
scalar performance:
{'acc': 0.6669255, 'precision': 0.7579968, 'recall': 0.6710169, 'specificity': 0.6710169, 'f1': 0.6378415, 'auroc': 0.85293317, 'binary_precision': 0.60117877, 'binary_recall': 0.9637795, 'binary_specificity': 0.3782542, 'binary_f1_score': 0.7404718}
confusion matrix:
     0    1
0  247  406
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6886598, 'precision': 0.7734568, 'recall': 0.65262705, 'specificity': 0.65262705, 'f1': 0.6322159, 'auroc': 0.85403967, 'binary_precision': 0.6469136, 'binary_recall': 0.97037035, 'binary_specificity': 0.33488372, 'binary_f1_score': 0.77629626}
confusion matrix:
    0    1
0  72  143
1   8  262
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-12 11:14:27.509575,epoch time: 0:09:21.925610,used: 3:32:50.206597,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9646991, 'precision': 0.84417856, 'recall': 0.72489715, 'specificity': 0.72489715, 'f1': 0.7705015, 'auroc': 0.94218755, 'binary_precision': 0.97275144, 'binary_recall': 0.9906375, 'binary_specificity': 0.45915678, 'binary_f1_score': 0.981613}
confusion matrix:
     0      1
0  697    821
1  277  29309
---- Validation: 
scalar performance:
{'acc': 0.6746894, 'precision': 0.75977075, 'recall': 0.6786305, 'specificity': 0.6786305, 'f1': 0.64859223, 'auroc': 0.8536253, 'binary_precision': 0.6075697, 'binary_recall': 0.96062994, 'binary_specificity': 0.39663094, 'binary_f1_score': 0.7443563}
confusion matrix:
     0    1
0  259  394
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69896907, 'precision': 0.78044116, 'recall': 0.66425496, 'specificity': 0.66425496, 'f1': 0.64771146, 'auroc': 0.85440135, 'binary_precision': 0.655, 'binary_recall': 0.97037035, 'binary_specificity': 0.35813954, 'binary_f1_score': 0.7820896}
confusion matrix:
    0    1
0  77  138
1   8  262
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-12 11:23:48.512632,epoch time: 0:09:21.003057,used: 3:42:11.209654,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9658243, 'precision': 0.8628744, 'recall': 0.7189265, 'specificity': 0.7189265, 'f1': 0.77102816, 'auroc': 0.9445871, 'binary_precision': 0.97212565, 'binary_recall': 0.9925302, 'binary_specificity': 0.44532278, 'binary_f1_score': 0.98222196}
confusion matrix:
     0      1
0  676    842
1  221  29365
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.756635, 'recall': 0.66871977, 'specificity': 0.66871977, 'f1': 0.63478255, 'auroc': 0.85648793, 'binary_precision': 0.5994123, 'binary_recall': 0.9637795, 'binary_specificity': 0.37366003, 'binary_f1_score': 0.73913044}
confusion matrix:
     0    1
0  244  409
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69072163, 'precision': 0.77958786, 'recall': 0.6544789, 'specificity': 0.6544789, 'f1': 0.6339512, 'auroc': 0.8580533, 'binary_precision': 0.6477833, 'binary_recall': 0.97407407, 'binary_specificity': 0.33488372, 'binary_f1_score': 0.7781065}
confusion matrix:
    0    1
0  72  143
1   7  263
early stop counter: 1
val acc:0.6645962595939636, best validation acc: 0.6746894121170044, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 25,now: 2024-07-12 11:33:11.761102,epoch time: 0:09:23.248470,used: 3:51:34.458124,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9669496, 'precision': 0.86345893, 'recall': 0.7360795, 'specificity': 0.7360795, 'f1': 0.78463566, 'auroc': 0.94797766, 'binary_precision': 0.97381866, 'binary_recall': 0.99192184, 'binary_specificity': 0.48023716, 'binary_f1_score': 0.9827869}
confusion matrix:
     0      1
0  729    789
1  239  29347
---- Validation: 
scalar performance:
{'acc': 0.66537267, 'precision': 0.75854874, 'recall': 0.66950715, 'specificity': 0.66950715, 'f1': 0.6354517, 'auroc': 0.8577589, 'binary_precision': 0.5998043, 'binary_recall': 0.9653543, 'binary_specificity': 0.37366003, 'binary_f1_score': 0.73989135}
confusion matrix:
     0    1
0  244  409
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6948454, 'precision': 0.7822852, 'recall': 0.65913004, 'specificity': 0.65913004, 'f1': 0.64020777, 'auroc': 0.8606719, 'binary_precision': 0.6509901, 'binary_recall': 0.97407407, 'binary_specificity': 0.34418604, 'binary_f1_score': 0.7804155}
confusion matrix:
    0    1
0  74  141
1   7  263
early stop counter: 2
val acc:0.6653726696968079, best validation acc: 0.6746894121170044, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 26,now: 2024-07-12 11:42:28.095728,epoch time: 0:09:16.334626,used: 4:00:50.792750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96598506, 'precision': 0.8600184, 'recall': 0.72494817, 'specificity': 0.72494817, 'f1': 0.77505314, 'auroc': 0.9483253, 'binary_precision': 0.97272485, 'binary_recall': 0.992057, 'binary_specificity': 0.45783925, 'binary_f1_score': 0.9822959}
confusion matrix:
     0      1
0  695    823
1  235  29351
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.760663, 'recall': 0.6680192, 'specificity': 0.6680192, 'f1': 0.6326833, 'auroc': 0.859734, 'binary_precision': 0.598249, 'binary_recall': 0.96850395, 'binary_specificity': 0.36753446, 'binary_f1_score': 0.73962724}
confusion matrix:
     0    1
0  240  413
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6886598, 'precision': 0.778224, 'recall': 0.6521533, 'specificity': 0.6521533, 'f1': 0.6307994, 'auroc': 0.86254954, 'binary_precision': 0.64619166, 'binary_recall': 0.97407407, 'binary_specificity': 0.33023256, 'binary_f1_score': 0.77695715}
confusion matrix:
    0    1
0  71  144
1   7  263
early stop counter: 3
val acc:0.6638198494911194, best validation acc: 0.6746894121170044, corresponding to test acc:                         0.6989690661430359 / 0.6989690661430359
after epoch: 27,now: 2024-07-12 11:51:49.023744,epoch time: 0:09:20.928016,used: 4:10:11.720766,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96656376, 'precision': 0.8546757, 'recall': 0.7413341, 'specificity': 0.7413341, 'f1': 0.785915, 'auroc': 0.9520363, 'binary_precision': 0.974376, 'binary_recall': 0.99090815, 'binary_specificity': 0.49176005, 'binary_f1_score': 0.9825726}
confusion matrix:
     0      1
0  746    771
1  269  29318
---- Validation: 
scalar performance:
{'acc': 0.66925466, 'precision': 0.7593533, 'recall': 0.673314, 'specificity': 0.673314, 'f1': 0.6408875, 'auroc': 0.8605057, 'binary_precision': 0.60295564, 'binary_recall': 0.9637795, 'binary_specificity': 0.38284838, 'binary_f1_score': 0.7418182}
confusion matrix:
     0    1
0  250  403
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7010309, 'precision': 0.7862635, 'recall': 0.6661068, 'specificity': 0.6661068, 'f1': 0.6494774, 'auroc': 0.864789, 'binary_precision': 0.65586036, 'binary_recall': 0.97407407, 'binary_specificity': 0.35813954, 'binary_f1_score': 0.7839047}
confusion matrix:
    0    1
0  77  138
1   7  263
new oracle model saved
early stop counter: 4
val acc:0.6692546606063843, best validation acc: 0.6746894121170044, corresponding to test acc:                         0.6989690661430359 / 0.7010309100151062
after epoch: 28,now: 2024-07-12 12:01:06.364860,epoch time: 0:09:17.341116,used: 4:19:29.061882,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9662423, 'precision': 0.85441685, 'recall': 0.73664516, 'specificity': 0.73664516, 'f1': 0.7823746, 'auroc': 0.9523965, 'binary_precision': 0.973894, 'binary_recall': 0.9910769, 'binary_specificity': 0.48221344, 'binary_f1_score': 0.9824103}
confusion matrix:
     0      1
0  732    786
1  264  29322
---- Validation: 
scalar performance:
{'acc': 0.66770184, 'precision': 0.75989294, 'recall': 0.67180425, 'specificity': 0.67180425, 'f1': 0.6385126, 'auroc': 0.86305237, 'binary_precision': 0.6015702, 'binary_recall': 0.9653543, 'binary_specificity': 0.3782542, 'binary_f1_score': 0.7412334}
confusion matrix:
     0    1
0  247  406
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7010309, 'precision': 0.7862635, 'recall': 0.6661068, 'specificity': 0.6661068, 'f1': 0.6494774, 'auroc': 0.8679414, 'binary_precision': 0.65586036, 'binary_recall': 0.97407407, 'binary_specificity': 0.35813954, 'binary_f1_score': 0.7839047}
confusion matrix:
    0    1
0  77  138
1   7  263
early stop counter: 5
val acc:0.6677018404006958, best validation acc: 0.6746894121170044, corresponding to test acc:                         0.6989690661430359 / 0.7010309100151062
after epoch: 29,now: 2024-07-12 12:10:20.693691,epoch time: 0:09:14.328831,used: 4:28:43.390713,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96717465, 'precision': 0.86229, 'recall': 0.7411975, 'specificity': 0.7411975, 'f1': 0.78814304, 'auroc': 0.952682, 'binary_precision': 0.97432834, 'binary_recall': 0.9916177, 'binary_specificity': 0.49077734, 'binary_f1_score': 0.982897}
confusion matrix:
     0      1
0  745    773
1  248  29338
---- Validation: 
scalar performance:
{'acc': 0.66770184, 'precision': 0.75989294, 'recall': 0.67180425, 'specificity': 0.67180425, 'f1': 0.6385126, 'auroc': 0.8656546, 'binary_precision': 0.6015702, 'binary_recall': 0.9653543, 'binary_specificity': 0.3782542, 'binary_f1_score': 0.7412334}
confusion matrix:
     0    1
0  247  406
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70309275, 'precision': 0.7875736, 'recall': 0.66843235, 'specificity': 0.66843235, 'f1': 0.65253735, 'auroc': 0.8710594, 'binary_precision': 0.6575, 'binary_recall': 0.97407407, 'binary_specificity': 0.3627907, 'binary_f1_score': 0.78507465}
confusion matrix:
    0    1
0  78  137
1   7  263
new oracle model saved
early stop counter: 6
val acc:0.6677018404006958, best validation acc: 0.6746894121170044, corresponding to test acc:                         0.6989690661430359 / 0.7030927538871765
after epoch: 30,now: 2024-07-12 12:19:40.146446,epoch time: 0:09:19.452755,used: 4:38:02.843468,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_07_41_37_seed_0_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:38:02.843468 at 2024-07-12 12:19:40.146446
persisted model performance metric: 

scalar performance:
{'acc': 0.69896907, 'precision': 0.78044116, 'recall': 0.66425496, 'specificity': 0.66425496, 'f1': 0.64771146, 'auroc': 0.85440135, 'binary_precision': 0.655, 'binary_recall': 0.97037035, 'binary_specificity': 0.35813954, 'binary_f1_score': 0.7820896}
confusion matrix:
    0    1
0  77  138
1   8  262
oracle model performance metric: 

scalar performance:
{'acc': 0.70309275, 'precision': 0.7875736, 'recall': 0.66843235, 'specificity': 0.66843235, 'f1': 0.65253735, 'auroc': 0.8710594, 'binary_precision': 0.6575, 'binary_recall': 0.97407407, 'binary_specificity': 0.3627907, 'binary_f1_score': 0.78507465}
confusion matrix:
    0    1
0  78  137
1   7  263
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36533 KiB |  74940 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |   6133 KiB |   9283 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    4371    |   50234 K  |   50233 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28887 K  |   28886 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    4371    |   50234 K  |   50233 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28887 K  |   28886 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    1961    |   29177 K  |   29176 K  |
|       from large pool |       9    |      19    |   13022 K  |   13022 K  |
|       from small pool |      28    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29177 K  |   29177 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216501 GiB | 216501 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114111 GiB | 114111 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50234 K  |   50234 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29177 K  |   29177 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16154 K  |   16154 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844

 Experiment start at: 2024-07-12 12:33:05.964401
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94903255, 'precision': 0.59753555, 'recall': 0.50940686, 'specificity': 0.50940686, 'f1': 0.50740457, 'auroc': 0.49718535, 'binary_precision': 0.95221394, 'binary_recall': 0.99643064, 'binary_specificity': 0.022383146, 'binary_f1_score': 0.9738206}
confusion matrix:
     0      1
0   34   1485
1  106  29591
---- Validation: 
scalar performance:
{'acc': 0.6440281, 'precision': 0.7379343, 'recall': 0.6490783, 'specificity': 0.6490783, 'f1': 0.6094825, 'auroc': 0.68602395, 'binary_precision': 0.5843023, 'binary_recall': 0.95714283, 'binary_specificity': 0.34101382, 'binary_f1_score': 0.7256318}
confusion matrix:
     0    1
0  222  429
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6380753, 'precision': 0.7455134, 'recall': 0.61727715, 'specificity': 0.61727715, 'f1': 0.572674, 'auroc': 0.72184455, 'binary_precision': 0.5970874, 'binary_recall': 0.972332, 'binary_specificity': 0.26222223, 'binary_f1_score': 0.7398496}
confusion matrix:
    0    1
0  59  166
1   7  246
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 12:42:35.215228,epoch time: 0:09:29.250827,used: 0:09:29.250827,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9493529, 'precision': 0.62487817, 'recall': 0.512713, 'specificity': 0.512713, 'f1': 0.5133535, 'auroc': 0.6110517, 'binary_precision': 0.9524591, 'binary_recall': 0.99649775, 'binary_specificity': 0.028928336, 'binary_f1_score': 0.97398084}
confusion matrix:
     0      1
0   44   1477
1  104  29591
---- Validation: 
scalar performance:
{'acc': 0.6635441, 'precision': 0.74877787, 'recall': 0.66825396, 'specificity': 0.66825396, 'f1': 0.63572544, 'auroc': 0.7272621, 'binary_precision': 0.599005, 'binary_recall': 0.95555556, 'binary_specificity': 0.3809524, 'binary_f1_score': 0.7363915}
confusion matrix:
     0    1
0  248  403
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6338912, 'precision': 0.736724, 'recall': 0.6130786, 'specificity': 0.6130786, 'f1': 0.56773376, 'auroc': 0.7609311, 'binary_precision': 0.5946602, 'binary_recall': 0.96837944, 'binary_specificity': 0.25777778, 'binary_f1_score': 0.73684216}
confusion matrix:
    0    1
0  58  167
1   8  245
better model found
persisted
after epoch: 2,now: 2024-07-12 12:51:57.746951,epoch time: 0:09:22.531723,used: 0:18:51.782550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95178753, 'precision': 0.7549663, 'recall': 0.52490896, 'specificity': 0.52490896, 'f1': 0.53512156, 'auroc': 0.7009498, 'binary_precision': 0.9535946, 'binary_recall': 0.99787843, 'binary_specificity': 0.051939514, 'binary_f1_score': 0.9752341}
confusion matrix:
    0      1
0  79   1442
1  63  29632
---- Validation: 
scalar performance:
{'acc': 0.6721311, 'precision': 0.7527504, 'recall': 0.67667687, 'specificity': 0.67667687, 'f1': 0.64712596, 'auroc': 0.7562066, 'binary_precision': 0.60584676, 'binary_recall': 0.9539682, 'binary_specificity': 0.39938557, 'binary_f1_score': 0.74106044}
confusion matrix:
     0    1
0  260  391
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64853555, 'precision': 0.74272954, 'recall': 0.6288801, 'specificity': 0.6288801, 'f1': 0.5919512, 'auroc': 0.788599, 'binary_precision': 0.60545903, 'binary_recall': 0.9644269, 'binary_specificity': 0.29333332, 'binary_f1_score': 0.7439024}
confusion matrix:
    0    1
0  66  159
1   9  244
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 13:01:34.861754,epoch time: 0:09:37.114803,used: 0:28:28.897353,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.95236415, 'precision': 0.771397, 'recall': 0.53488773, 'specificity': 0.53488773, 'f1': 0.5521968, 'auroc': 0.7844299, 'binary_precision': 0.9545586, 'binary_recall': 0.9974071, 'binary_specificity': 0.07236842, 'binary_f1_score': 0.97551256}
confusion matrix:
     0      1
0  110   1410
1   77  29619
---- Validation: 
scalar performance:
{'acc': 0.68227947, 'precision': 0.7565259, 'recall': 0.68661034, 'specificity': 0.68661034, 'f1': 0.660565, 'auroc': 0.77620995, 'binary_precision': 0.61435896, 'binary_recall': 0.9507936, 'binary_specificity': 0.42242703, 'binary_f1_score': 0.74641734}
confusion matrix:
     0    1
0  275  376
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6715481, 'precision': 0.7547203, 'recall': 0.6535705, 'specificity': 0.6535705, 'f1': 0.6271173, 'auroc': 0.8073255, 'binary_precision': 0.6230769, 'binary_recall': 0.9604743, 'binary_specificity': 0.34666666, 'binary_f1_score': 0.755832}
confusion matrix:
    0    1
0  78  147
1  10  243
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 13:11:10.645685,epoch time: 0:09:35.783931,used: 0:38:04.681284,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.952204, 'precision': 0.76375103, 'recall': 0.5360441, 'specificity': 0.5360441, 'f1': 0.5539915, 'auroc': 0.8283018, 'binary_precision': 0.95463777, 'binary_recall': 0.99713755, 'binary_specificity': 0.07495069, 'binary_f1_score': 0.9754249}
confusion matrix:
     0      1
0  114   1407
1   85  29610
---- Validation: 
scalar performance:
{'acc': 0.68540204, 'precision': 0.7608195, 'recall': 0.68973374, 'specificity': 0.68973374, 'f1': 0.663901, 'auroc': 0.79011536, 'binary_precision': 0.61641026, 'binary_recall': 0.9539682, 'binary_specificity': 0.42549923, 'binary_f1_score': 0.74890965}
confusion matrix:
     0    1
0  277  374
1   29  601
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6820084, 'precision': 0.76579493, 'recall': 0.6644356, 'specificity': 0.6644356, 'f1': 0.64074373, 'auroc': 0.81925344, 'binary_precision': 0.63049096, 'binary_recall': 0.9644269, 'binary_specificity': 0.36444443, 'binary_f1_score': 0.76250005}
confusion matrix:
    0    1
0  82  143
1   9  244
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-12 13:20:46.992981,epoch time: 0:09:36.347296,used: 0:47:41.028580,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95351744, 'precision': 0.7939316, 'recall': 0.5535767, 'specificity': 0.5535767, 'f1': 0.58204925, 'auroc': 0.85503876, 'binary_precision': 0.95628434, 'binary_recall': 0.9966998, 'binary_specificity': 0.11045365, 'binary_f1_score': 0.9760739}
confusion matrix:
     0      1
0  168   1353
1   98  29597
---- Validation: 
scalar performance:
{'acc': 0.69476974, 'precision': 0.7619519, 'recall': 0.6988479, 'specificity': 0.6988479, 'f1': 0.67655385, 'auroc': 0.7998854, 'binary_precision': 0.6251309, 'binary_recall': 0.947619, 'binary_specificity': 0.45007682, 'binary_f1_score': 0.75331235}
confusion matrix:
     0    1
0  293  358
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6987448, 'precision': 0.76926863, 'recall': 0.6827053, 'specificity': 0.6827053, 'f1': 0.6658381, 'auroc': 0.82664907, 'binary_precision': 0.64533335, 'binary_recall': 0.95652175, 'binary_specificity': 0.40888888, 'binary_f1_score': 0.77070063}
confusion matrix:
    0    1
0  92  133
1  11  242
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-12 13:30:20.613455,epoch time: 0:09:33.620474,used: 0:57:14.649054,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9542542, 'precision': 0.80840945, 'recall': 0.5614494, 'specificity': 0.5614494, 'f1': 0.59418195, 'auroc': 0.8782556, 'binary_precision': 0.95702505, 'binary_recall': 0.99666613, 'binary_specificity': 0.12623274, 'binary_f1_score': 0.9764434}
confusion matrix:
     0      1
0  192   1329
1   99  29596
---- Validation: 
scalar performance:
{'acc': 0.6924278, 'precision': 0.7616141, 'recall': 0.6965694, 'specificity': 0.6965694, 'f1': 0.6734257, 'auroc': 0.8096628, 'binary_precision': 0.62291664, 'binary_recall': 0.94920635, 'binary_specificity': 0.4439324, 'binary_f1_score': 0.7522012}
confusion matrix:
     0    1
0  289  362
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6966527, 'precision': 0.77513427, 'recall': 0.67999125, 'specificity': 0.67999125, 'f1': 0.6610079, 'auroc': 0.8349583, 'binary_precision': 0.6421053, 'binary_recall': 0.9644269, 'binary_specificity': 0.39555556, 'binary_f1_score': 0.77093214}
confusion matrix:
    0    1
0  89  136
1   9  244
early stop counter: 1
val acc:0.6924278140068054, best validation acc: 0.6947697401046753, corresponding to test acc:                         0.6987447738647461 / 0.6987447738647461
after epoch: 7,now: 2024-07-12 13:39:47.832310,epoch time: 0:09:27.218855,used: 1:06:41.867909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9550871, 'precision': 0.804811, 'recall': 0.58216023, 'specificity': 0.58216023, 'f1': 0.6225499, 'auroc': 0.8890363, 'binary_precision': 0.958989, 'binary_recall': 0.99535275, 'binary_specificity': 0.16896778, 'binary_f1_score': 0.9768326}
confusion matrix:
     0      1
0  257   1264
1  138  29557
---- Validation: 
scalar performance:
{'acc': 0.70335674, 'precision': 0.76620066, 'recall': 0.70727086, 'specificity': 0.70727086, 'f1': 0.6872156, 'auroc': 0.81637037, 'binary_precision': 0.6326964, 'binary_recall': 0.94603175, 'binary_specificity': 0.46850997, 'binary_f1_score': 0.75826967}
confusion matrix:
     0    1
0  305  346
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7133891, 'precision': 0.7788043, 'recall': 0.6982609, 'specificity': 0.6982609, 'f1': 0.6852164, 'auroc': 0.8410716, 'binary_precision': 0.6576087, 'binary_recall': 0.95652175, 'binary_specificity': 0.44, 'binary_f1_score': 0.779388}
confusion matrix:
    0    1
0  99  126
1  11  242
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 13:49:34.658151,epoch time: 0:09:46.825841,used: 1:16:28.693750,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9576179, 'precision': 0.8637326, 'recall': 0.59191155, 'specificity': 0.59191155, 'f1': 0.6392586, 'auroc': 0.90366906, 'binary_precision': 0.9598976, 'binary_recall': 0.99710387, 'binary_specificity': 0.18671927, 'binary_f1_score': 0.9781471}
confusion matrix:
     0      1
0  284   1237
1   86  29609
---- Validation: 
scalar performance:
{'acc': 0.6869633, 'precision': 0.7582483, 'recall': 0.69119304, 'specificity': 0.69119304, 'f1': 0.6666801, 'auroc': 0.82379735, 'binary_precision': 0.6184074, 'binary_recall': 0.94920635, 'binary_specificity': 0.43317974, 'binary_f1_score': 0.74890417}
confusion matrix:
     0    1
0  282  369
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7050209, 'precision': 0.7767894, 'recall': 0.689126, 'specificity': 0.689126, 'f1': 0.6732741, 'auroc': 0.84693897, 'binary_precision': 0.64973265, 'binary_recall': 0.9604743, 'binary_specificity': 0.41777778, 'binary_f1_score': 0.7751196}
confusion matrix:
    0    1
0  94  131
1  10  243
early stop counter: 1
val acc:0.6869633197784424, best validation acc: 0.7033567428588867, corresponding to test acc:                         0.7133890986442566 / 0.7133890986442566
after epoch: 9,now: 2024-07-12 13:59:27.011312,epoch time: 0:09:52.353161,used: 1:26:21.046911,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9589313, 'precision': 0.85763395, 'recall': 0.61449426, 'specificity': 0.61449426, 'f1': 0.6672842, 'auroc': 0.9106493, 'binary_precision': 0.96207637, 'binary_recall': 0.99609375, 'binary_specificity': 0.23289473, 'binary_f1_score': 0.9787895}
confusion matrix:
     0      1
0  354   1166
1  116  29580
---- Validation: 
scalar performance:
{'acc': 0.68930525, 'precision': 0.7596928, 'recall': 0.6934972, 'specificity': 0.6934972, 'f1': 0.6695783, 'auroc': 0.82873964, 'binary_precision': 0.62033194, 'binary_recall': 0.94920635, 'binary_specificity': 0.437788, 'binary_f1_score': 0.75031364}
confusion matrix:
     0    1
0  285  366
1   32  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70711297, 'precision': 0.781644, 'recall': 0.6911023, 'specificity': 0.6911023, 'f1': 0.6751204, 'auroc': 0.8506632, 'binary_precision': 0.65066665, 'binary_recall': 0.9644269, 'binary_specificity': 0.41777778, 'binary_f1_score': 0.77707005}
confusion matrix:
    0    1
0  94  131
1   9  244
early stop counter: 2
val acc:0.6893052458763123, best validation acc: 0.7033567428588867, corresponding to test acc:                         0.7133890986442566 / 0.7133890986442566
after epoch: 10,now: 2024-07-12 14:09:22.798563,epoch time: 0:09:55.787251,used: 1:36:16.834162,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9602127, 'precision': 0.8491491, 'recall': 0.641307, 'specificity': 0.641307, 'f1': 0.69650275, 'auroc': 0.9144492, 'binary_precision': 0.9646298, 'binary_recall': 0.99464554, 'binary_specificity': 0.28796843, 'binary_f1_score': 0.9794077}
confusion matrix:
     0      1
0  438   1083
1  159  29536
---- Validation: 
scalar performance:
{'acc': 0.6986729, 'precision': 0.76329494, 'recall': 0.7026626, 'specificity': 0.7026626, 'f1': 0.68155503, 'auroc': 0.83179235, 'binary_precision': 0.628692, 'binary_recall': 0.94603175, 'binary_specificity': 0.4592934, 'binary_f1_score': 0.75538653}
confusion matrix:
     0    1
0  299  352
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.85312253, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
new oracle model saved
early stop counter: 3
val acc:0.698672890663147, best validation acc: 0.7033567428588867, corresponding to test acc:                         0.7133890986442566 / 0.723849356174469
after epoch: 11,now: 2024-07-12 14:19:15.430280,epoch time: 0:09:52.631717,used: 1:46:09.465879,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96088547, 'precision': 0.8410901, 'recall': 0.65984094, 'specificity': 0.65984094, 'f1': 0.7139921, 'auroc': 0.9157219, 'binary_precision': 0.9664515, 'binary_recall': 0.9933661, 'binary_specificity': 0.3263158, 'binary_f1_score': 0.979724}
confusion matrix:
     0      1
0  496   1024
1  197  29499
---- Validation: 
scalar performance:
{'acc': 0.7002342, 'precision': 0.76218927, 'recall': 0.70414746, 'specificity': 0.70414746, 'f1': 0.68392324, 'auroc': 0.8354814, 'binary_precision': 0.6305733, 'binary_recall': 0.94285715, 'binary_specificity': 0.4654378, 'binary_f1_score': 0.75572526}
confusion matrix:
     0    1
0  303  348
1   36  594
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8566184, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
new oracle model saved
early stop counter: 4
val acc:0.7002341747283936, best validation acc: 0.7033567428588867, corresponding to test acc:                         0.7133890986442566 / 0.7301255464553833
after epoch: 12,now: 2024-07-12 14:28:45.161536,epoch time: 0:09:29.731256,used: 1:55:39.197135,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9617183, 'precision': 0.84594214, 'recall': 0.669545, 'specificity': 0.669545, 'f1': 0.7241622, 'auroc': 0.92454064, 'binary_precision': 0.96736634, 'binary_recall': 0.99326485, 'binary_specificity': 0.3458251, 'binary_f1_score': 0.9801446}
confusion matrix:
     0      1
0  526    995
1  200  29495
---- Validation: 
scalar performance:
{'acc': 0.70179546, 'precision': 0.7621622, 'recall': 0.70565796, 'specificity': 0.70565796, 'f1': 0.6860359, 'auroc': 0.83889985, 'binary_precision': 0.6321962, 'binary_recall': 0.9412698, 'binary_specificity': 0.47004607, 'binary_f1_score': 0.7563776}
confusion matrix:
     0    1
0  306  345
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8597101, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 5
val acc:0.7017954587936401, best validation acc: 0.7033567428588867, corresponding to test acc:                         0.7133890986442566 / 0.7301255464553833
after epoch: 13,now: 2024-07-12 14:38:32.664609,epoch time: 0:09:47.503073,used: 2:05:26.700208,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96482575, 'precision': 0.8588859, 'recall': 0.70673406, 'specificity': 0.70673406, 'f1': 0.75999194, 'auroc': 0.9286971, 'binary_precision': 0.9709806, 'binary_recall': 0.99269235, 'binary_specificity': 0.4207758, 'binary_f1_score': 0.98171645}
confusion matrix:
     0      1
0  640    881
1  217  29478
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.76393443, 'recall': 0.7155146, 'specificity': 0.7155146, 'f1': 0.69916654, 'auroc': 0.8419428, 'binary_precision': 0.64262295, 'binary_recall': 0.93333334, 'binary_specificity': 0.49769586, 'binary_f1_score': 0.76116496}
confusion matrix:
     0    1
0  324  327
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74058574, 'precision': 0.80201775, 'recall': 0.72665787, 'specificity': 0.72665787, 'f1': 0.71846026, 'auroc': 0.8625736, 'binary_precision': 0.67966574, 'binary_recall': 0.9644269, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.79738563}
confusion matrix:
     0    1
0  110  115
1    9  244
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-12 14:47:57.974640,epoch time: 0:09:25.310031,used: 2:14:52.010239,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9629357, 'precision': 0.8528071, 'recall': 0.6826606, 'specificity': 0.6826606, 'f1': 0.7376509, 'auroc': 0.9311862, 'binary_precision': 0.968635, 'binary_recall': 0.9931975, 'binary_specificity': 0.3721236, 'binary_f1_score': 0.98076254}
confusion matrix:
     0      1
0  566    955
1  202  29493
---- Validation: 
scalar performance:
{'acc': 0.704918, 'precision': 0.7621864, 'recall': 0.70867896, 'specificity': 0.70867896, 'f1': 0.6902234, 'auroc': 0.84548795, 'binary_precision': 0.63548386, 'binary_recall': 0.9380952, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.7576923}
confusion matrix:
     0    1
0  312  339
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8663329, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 1
val acc:0.7049180269241333, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7405857443809509 / 0.7405857443809509
after epoch: 15,now: 2024-07-12 14:57:16.340436,epoch time: 0:09:18.365796,used: 2:24:10.376035,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9647617, 'precision': 0.8577465, 'recall': 0.7070123, 'specificity': 0.7070123, 'f1': 0.75994253, 'auroc': 0.93543553, 'binary_precision': 0.97100973, 'binary_recall': 0.9925913, 'binary_specificity': 0.42143327, 'binary_f1_score': 0.9816819}
confusion matrix:
     0      1
0  641    880
1  220  29475
---- Validation: 
scalar performance:
{'acc': 0.7064793, 'precision': 0.76129997, 'recall': 0.71016383, 'specificity': 0.71016383, 'f1': 0.69251394, 'auroc': 0.8484627, 'binary_precision': 0.63744587, 'binary_recall': 0.9349206, 'binary_specificity': 0.48540705, 'binary_f1_score': 0.7580437}
confusion matrix:
     0    1
0  316  335
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7994886, 'recall': 0.72221345, 'specificity': 0.72221345, 'f1': 0.71318364, 'auroc': 0.8702327, 'binary_precision': 0.6759003, 'binary_recall': 0.9644269, 'binary_specificity': 0.48, 'binary_f1_score': 0.7947883}
confusion matrix:
     0    1
0  108  117
1    9  244
early stop counter: 2
val acc:0.7064793109893799, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7405857443809509 / 0.7405857443809509
after epoch: 16,now: 2024-07-12 15:06:41.830789,epoch time: 0:09:25.490353,used: 2:33:35.866388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9656907, 'precision': 0.85910285, 'recall': 0.7201069, 'specificity': 0.7201069, 'f1': 0.77097625, 'auroc': 0.9401839, 'binary_precision': 0.972313, 'binary_recall': 0.9921875, 'binary_specificity': 0.44802633, 'binary_f1_score': 0.9821497}
confusion matrix:
     0      1
0  681    839
1  232  29464
---- Validation: 
scalar performance:
{'acc': 0.71975017, 'precision': 0.7690108, 'recall': 0.7231951, 'specificity': 0.7231951, 'f1': 0.7082809, 'auroc': 0.85061085, 'binary_precision': 0.64972377, 'binary_recall': 0.93333334, 'binary_specificity': 0.5130568, 'binary_f1_score': 0.7661237}
confusion matrix:
     0    1
0  334  317
1   42  588
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7447699, 'precision': 0.80160314, 'recall': 0.7313483, 'specificity': 0.7313483, 'f1': 0.7243837, 'auroc': 0.8725516, 'binary_precision': 0.6845071, 'binary_recall': 0.9604743, 'binary_specificity': 0.50222224, 'binary_f1_score': 0.7993421}
confusion matrix:
     0    1
0  113  112
1   10  243
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-12 15:16:10.968728,epoch time: 0:09:29.137939,used: 2:43:05.004327,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96485776, 'precision': 0.85904944, 'recall': 0.70706284, 'specificity': 0.70706284, 'f1': 0.7603073, 'auroc': 0.94247353, 'binary_precision': 0.9710126, 'binary_recall': 0.99269235, 'binary_specificity': 0.42143327, 'binary_f1_score': 0.9817328}
confusion matrix:
     0      1
0  641    880
1  217  29478
---- Validation: 
scalar performance:
{'acc': 0.70725995, 'precision': 0.76180565, 'recall': 0.7109319, 'specificity': 0.7109319, 'f1': 0.69343835, 'auroc': 0.854156, 'binary_precision': 0.6381365, 'binary_recall': 0.9349206, 'binary_specificity': 0.48694316, 'binary_f1_score': 0.7585318}
confusion matrix:
     0    1
0  317  334
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8763461, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 1
val acc:0.7072599530220032, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7447698712348938 / 0.7447698712348938
after epoch: 18,now: 2024-07-12 15:25:29.370169,epoch time: 0:09:18.401441,used: 2:52:23.405768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96521014, 'precision': 0.8597275, 'recall': 0.71123993, 'specificity': 0.71123993, 'f1': 0.7639493, 'auroc': 0.9435626, 'binary_precision': 0.9714596, 'binary_recall': 0.99259186, 'binary_specificity': 0.42988807, 'binary_f1_score': 0.981912}
confusion matrix:
     0      1
0  653    866
1  220  29477
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.76618135, 'recall': 0.71482337, 'specificity': 0.71482337, 'f1': 0.69763064, 'auroc': 0.8555702, 'binary_precision': 0.6409978, 'binary_recall': 0.9380952, 'binary_specificity': 0.49155146, 'binary_f1_score': 0.76159793}
confusion matrix:
     0    1
0  320  331
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.7944236, 'recall': 0.71332455, 'specificity': 0.71332455, 'f1': 0.7025143, 'auroc': 0.87750554, 'binary_precision': 0.66849315, 'binary_recall': 0.9644269, 'binary_specificity': 0.46222222, 'binary_f1_score': 0.789644}
confusion matrix:
     0    1
0  104  121
1    9  244
early stop counter: 2
val acc:0.7111631631851196, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7447698712348938 / 0.7447698712348938
after epoch: 19,now: 2024-07-12 15:34:47.808217,epoch time: 0:09:18.438048,used: 3:01:41.843816,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9665236, 'precision': 0.86471254, 'recall': 0.7269639, 'specificity': 0.7269639, 'f1': 0.7779368, 'auroc': 0.9484986, 'binary_precision': 0.9729596, 'binary_recall': 0.99238926, 'binary_specificity': 0.46153846, 'binary_f1_score': 0.9825784}
confusion matrix:
     0      1
0  702    819
1  226  29469
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.768675, 'recall': 0.7186636, 'specificity': 0.7186636, 'f1': 0.70222676, 'auroc': 0.85829127, 'binary_precision': 0.6444929, 'binary_recall': 0.9380952, 'binary_specificity': 0.49923196, 'binary_f1_score': 0.7640594}
confusion matrix:
     0    1
0  325  326
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7931548, 'recall': 0.7111023, 'specificity': 0.7111023, 'f1': 0.6998221, 'auroc': 0.8816161, 'binary_precision': 0.6666667, 'binary_recall': 0.9644269, 'binary_specificity': 0.45777777, 'binary_f1_score': 0.78836834}
confusion matrix:
     0    1
0  103  122
1    9  244
early stop counter: 3
val acc:0.7150663733482361, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7447698712348938 / 0.7447698712348938
after epoch: 20,now: 2024-07-12 15:44:06.683407,epoch time: 0:09:18.875190,used: 3:11:00.719006,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9667158, 'precision': 0.864558, 'recall': 0.73018384, 'specificity': 0.73018384, 'f1': 0.78041553, 'auroc': 0.9517224, 'binary_precision': 0.9732774, 'binary_recall': 0.9922546, 'binary_specificity': 0.4681131, 'binary_f1_score': 0.9826743}
confusion matrix:
     0      1
0  712    809
1  230  29465
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.76857424, 'recall': 0.7156426, 'specificity': 0.7156426, 'f1': 0.698133, 'auroc': 0.8612367, 'binary_precision': 0.6410811, 'binary_recall': 0.9412698, 'binary_specificity': 0.49001536, 'binary_f1_score': 0.7627009}
confusion matrix:
     0    1
0  319  332
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.7944236, 'recall': 0.71332455, 'specificity': 0.71332455, 'f1': 0.7025143, 'auroc': 0.88546336, 'binary_precision': 0.66849315, 'binary_recall': 0.9644269, 'binary_specificity': 0.46222222, 'binary_f1_score': 0.789644}
confusion matrix:
     0    1
0  104  121
1    9  244
early stop counter: 4
val acc:0.7119438052177429, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7447698712348938 / 0.7447698712348938
after epoch: 21,now: 2024-07-12 15:53:25.584969,epoch time: 0:09:18.901562,used: 3:20:19.620568,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9671643, 'precision': 0.8653065, 'recall': 0.7363455, 'specificity': 0.7363455, 'f1': 0.78537893, 'auroc': 0.9531834, 'binary_precision': 0.9738843, 'binary_recall': 0.99208623, 'binary_specificity': 0.48060486, 'binary_f1_score': 0.982901}
confusion matrix:
     0      1
0  731    790
1  235  29460
---- Validation: 
scalar performance:
{'acc': 0.71272445, 'precision': 0.7690667, 'recall': 0.71641064, 'specificity': 0.71641064, 'f1': 0.6990562, 'auroc': 0.8625997, 'binary_precision': 0.6417749, 'binary_recall': 0.9412698, 'binary_specificity': 0.49155146, 'binary_f1_score': 0.76319176}
confusion matrix:
     0    1
0  320  331
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.88660514, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 5
val acc:0.7127244472503662, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7447698712348938 / 0.7447698712348938
after epoch: 22,now: 2024-07-12 16:02:43.703644,epoch time: 0:09:18.118675,used: 3:29:37.739243,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96732444, 'precision': 0.8596417, 'recall': 0.7464103, 'specificity': 0.7464103, 'f1': 0.7911696, 'auroc': 0.9539657, 'binary_precision': 0.97489315, 'binary_recall': 0.99117696, 'binary_specificity': 0.50164366, 'binary_f1_score': 0.98296756}
confusion matrix:
     0      1
0  763    758
1  262  29433
---- Validation: 
scalar performance:
{'acc': 0.724434, 'precision': 0.77554846, 'recall': 0.72790575, 'specificity': 0.72790575, 'f1': 0.71297073, 'auroc': 0.86401874, 'binary_precision': 0.6527012, 'binary_recall': 0.93968254, 'binary_specificity': 0.516129, 'binary_f1_score': 0.7703318}
confusion matrix:
     0    1
0  336  315
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7426778, 'precision': 0.8003085, 'recall': 0.72912604, 'specificity': 0.72912604, 'f1': 0.7217814, 'auroc': 0.88809836, 'binary_precision': 0.6825843, 'binary_recall': 0.9604743, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.7980296}
confusion matrix:
     0    1
0  112  113
1   10  243
better model found
persisted
after epoch: 23,now: 2024-07-12 16:12:03.053391,epoch time: 0:09:19.349747,used: 3:38:57.088990,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96812534, 'precision': 0.86785793, 'recall': 0.74791586, 'specificity': 0.74791586, 'f1': 0.7948214, 'auroc': 0.9571887, 'binary_precision': 0.97504056, 'binary_recall': 0.9918844, 'binary_specificity': 0.5039474, 'binary_f1_score': 0.9833904}
confusion matrix:
     0      1
0  766    754
1  241  29455
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.76910067, 'recall': 0.71187913, 'specificity': 0.71187913, 'f1': 0.6928364, 'auroc': 0.86647403, 'binary_precision': 0.6367521, 'binary_recall': 0.94603175, 'binary_specificity': 0.47772658, 'binary_f1_score': 0.7611749}
confusion matrix:
     0    1
0  311  340
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.7893389, 'recall': 0.70443565, 'specificity': 0.70443565, 'f1': 0.6916841, 'auroc': 0.89087397, 'binary_precision': 0.6612466, 'binary_recall': 0.9644269, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.78456587}
confusion matrix:
     0    1
0  100  125
1    9  244
early stop counter: 1
val acc:0.7080405950546265, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 24,now: 2024-07-12 16:21:25.779732,epoch time: 0:09:22.726341,used: 3:48:19.815331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96694005, 'precision': 0.8540756, 'recall': 0.7480796, 'specificity': 0.7480796, 'f1': 0.79060197, 'auroc': 0.95465744, 'binary_precision': 0.9750721, 'binary_recall': 0.9905708, 'binary_specificity': 0.5055884, 'binary_f1_score': 0.98276025}
confusion matrix:
     0      1
0  769    752
1  280  29415
---- Validation: 
scalar performance:
{'acc': 0.7174083, 'precision': 0.7720206, 'recall': 0.7210189, 'specificity': 0.7210189, 'f1': 0.704574, 'auroc': 0.8678882, 'binary_precision': 0.6459695, 'binary_recall': 0.9412698, 'binary_specificity': 0.50076807, 'binary_f1_score': 0.76614994}
confusion matrix:
     0    1
0  326  325
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7994886, 'recall': 0.72221345, 'specificity': 0.72221345, 'f1': 0.71318364, 'auroc': 0.8924725, 'binary_precision': 0.6759003, 'binary_recall': 0.9644269, 'binary_specificity': 0.48, 'binary_f1_score': 0.7947883}
confusion matrix:
     0    1
0  108  117
1    9  244
early stop counter: 2
val acc:0.717408299446106, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 25,now: 2024-07-12 16:30:45.476310,epoch time: 0:09:19.696578,used: 3:57:39.511909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9685418, 'precision': 0.86285615, 'recall': 0.7617091, 'specificity': 0.7617091, 'f1': 0.80309236, 'auroc': 0.9584677, 'binary_precision': 0.97640616, 'binary_recall': 0.9908739, 'binary_specificity': 0.5325444, 'binary_f1_score': 0.9835868}
confusion matrix:
     0      1
0  810    711
1  271  29424
---- Validation: 
scalar performance:
{'acc': 0.7220921, 'precision': 0.77497417, 'recall': 0.7256272, 'specificity': 0.7256272, 'f1': 0.7100557, 'auroc': 0.86902446, 'binary_precision': 0.6502193, 'binary_recall': 0.9412698, 'binary_specificity': 0.5099846, 'binary_f1_score': 0.769131}
confusion matrix:
     0    1
0  332  319
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74058574, 'precision': 0.79901385, 'recall': 0.7269038, 'specificity': 0.7269038, 'f1': 0.71916986, 'auroc': 0.8936144, 'binary_precision': 0.6806723, 'binary_recall': 0.9604743, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7967213}
confusion matrix:
     0    1
0  111  114
1   10  243
early stop counter: 3
val acc:0.7220920920372009, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 26,now: 2024-07-12 16:40:03.040268,epoch time: 0:09:17.563958,used: 4:06:57.075867,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9680933, 'precision': 0.86120003, 'recall': 0.756795, 'specificity': 0.756795, 'f1': 0.79910326, 'auroc': 0.95901036, 'binary_precision': 0.9759212, 'binary_recall': 0.99090755, 'binary_specificity': 0.5226824, 'binary_f1_score': 0.98335725}
confusion matrix:
     0      1
0  795    726
1  270  29425
---- Validation: 
scalar performance:
{'acc': 0.7189696, 'precision': 0.773005, 'recall': 0.72255504, 'specificity': 0.72255504, 'f1': 0.70640516, 'auroc': 0.87023866, 'binary_precision': 0.64737993, 'binary_recall': 0.9412698, 'binary_specificity': 0.50384027, 'binary_f1_score': 0.76714104}
confusion matrix:
     0    1
0  328  323
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74058574, 'precision': 0.79901385, 'recall': 0.7269038, 'specificity': 0.7269038, 'f1': 0.71916986, 'auroc': 0.8949671, 'binary_precision': 0.6806723, 'binary_recall': 0.9604743, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7967213}
confusion matrix:
     0    1
0  111  114
1   10  243
early stop counter: 4
val acc:0.7189695835113525, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 27,now: 2024-07-12 16:49:26.299665,epoch time: 0:09:23.259397,used: 4:16:20.335264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9680292, 'precision': 0.86167955, 'recall': 0.7547318, 'specificity': 0.7547318, 'f1': 0.7978019, 'auroc': 0.9613112, 'binary_precision': 0.9757311, 'binary_recall': 0.99104255, 'binary_specificity': 0.51842105, 'binary_f1_score': 0.9833272}
confusion matrix:
     0      1
0  788    732
1  266  29430
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.76809025, 'recall': 0.71185356, 'specificity': 0.71185356, 'f1': 0.69306004, 'auroc': 0.8718991, 'binary_precision': 0.63704497, 'binary_recall': 0.9444444, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.7608696}
confusion matrix:
     0    1
0  312  339
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74058574, 'precision': 0.80201775, 'recall': 0.72665787, 'specificity': 0.72665787, 'f1': 0.71846026, 'auroc': 0.8962494, 'binary_precision': 0.67966574, 'binary_recall': 0.9644269, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.79738563}
confusion matrix:
     0    1
0  110  115
1    9  244
early stop counter: 5
val acc:0.7080405950546265, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 28,now: 2024-07-12 16:58:50.671962,epoch time: 0:09:24.372297,used: 4:25:44.707561,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9679972, 'precision': 0.8574518, 'recall': 0.76079905, 'specificity': 0.76079905, 'f1': 0.8006361, 'auroc': 0.9594879, 'binary_precision': 0.97632957, 'binary_recall': 0.9903687, 'binary_specificity': 0.53122944, 'binary_f1_score': 0.9832991}
confusion matrix:
     0      1
0  808    713
1  286  29409
---- Validation: 
scalar performance:
{'acc': 0.7080406, 'precision': 0.76809025, 'recall': 0.71185356, 'specificity': 0.71185356, 'f1': 0.69306004, 'auroc': 0.87303054, 'binary_precision': 0.63704497, 'binary_recall': 0.9444444, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.7608696}
confusion matrix:
     0    1
0  312  339
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.79348105, 'recall': 0.7227053, 'specificity': 0.7227053, 'f1': 0.7146404, 'auroc': 0.8978656, 'binary_precision': 0.67787117, 'binary_recall': 0.95652175, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.7934426}
confusion matrix:
     0    1
0  110  115
1   11  242
early stop counter: 6
val acc:0.7080405950546265, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 29,now: 2024-07-12 17:08:13.380042,epoch time: 0:09:22.708080,used: 4:35:07.415641,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96905434, 'precision': 0.861098, 'recall': 0.7724366, 'specificity': 0.7724366, 'f1': 0.8097936, 'auroc': 0.963875, 'binary_precision': 0.9774963, 'binary_recall': 0.99026805, 'binary_specificity': 0.55460525, 'binary_f1_score': 0.9838407}
confusion matrix:
     0      1
0  843    677
1  289  29407
---- Validation: 
scalar performance:
{'acc': 0.715847, 'precision': 0.77295005, 'recall': 0.71953404, 'specificity': 0.71953404, 'f1': 0.7023273, 'auroc': 0.8737229, 'binary_precision': 0.6439394, 'binary_recall': 0.9444444, 'binary_specificity': 0.49462366, 'binary_f1_score': 0.7657658}
confusion matrix:
     0    1
0  322  329
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.7906561, 'recall': 0.7229513, 'specificity': 0.7229513, 'f1': 0.7153471, 'auroc': 0.8983048, 'binary_precision': 0.67887324, 'binary_recall': 0.9525692, 'binary_specificity': 0.49333334, 'binary_f1_score': 0.7927632}
confusion matrix:
     0    1
0  111  114
1   12  241
early stop counter: 7
val acc:0.7158470153808594, best validation acc: 0.7244340181350708, corresponding to test acc:                         0.7426778078079224 / 0.7447698712348938
after epoch: 30,now: 2024-07-12 17:17:38.262789,epoch time: 0:09:24.882747,used: 4:44:32.298388,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_33_05_seed_1_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:44:32.298388 at 2024-07-12 17:17:38.262789
persisted model performance metric: 

scalar performance:
{'acc': 0.7426778, 'precision': 0.8003085, 'recall': 0.72912604, 'specificity': 0.72912604, 'f1': 0.7217814, 'auroc': 0.88809836, 'binary_precision': 0.6825843, 'binary_recall': 0.9604743, 'binary_specificity': 0.4977778, 'binary_f1_score': 0.7980296}
confusion matrix:
     0    1
0  112  113
1   10  243
oracle model performance metric: 

scalar performance:
{'acc': 0.7447699, 'precision': 0.80160314, 'recall': 0.7313483, 'specificity': 0.7313483, 'f1': 0.7243837, 'auroc': 0.8725516, 'binary_precision': 0.6845071, 'binary_recall': 0.9604743, 'binary_specificity': 0.50222224, 'binary_f1_score': 0.7993421}
confusion matrix:
     0    1
0  113  112
1   10  243
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  35394 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |   4088 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4385    |  100305 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57741 K  |   57740 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4385    |  100305 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57741 K  |   57740 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      19    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      39    |    1972    |   57314 K  |   57314 K  |
|       from large pool |      10    |      22    |   24954 K  |   24954 K  |
|       from small pool |      29    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57314 K  |   57314 K  |
|       from large pool |       3    |      22    |   24954 K  |   24954 K  |
|       from small pool |       0    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100305 K  |  100305 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57741 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57314 K  |   57314 K  |
|       from large pool |       3    |      22    |   24954 K  |   24954 K  |
|       from small pool |       0    |    1962    |   32359 K  |   32359 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844

 Experiment start at: 2024-07-12 17:31:06.165275
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8860594, 'precision': 0.5337773, 'recall': 0.55662596, 'specificity': 0.55662596, 'f1': 0.5394964, 'auroc': 0.6247509, 'binary_precision': 0.9573691, 'binary_recall': 0.9212994, 'binary_specificity': 0.19195251, 'binary_f1_score': 0.938988}
confusion matrix:
      0      1
0   291   1225
1  2350  27510
---- Validation: 
scalar performance:
{'acc': 0.51877934, 'precision': 0.6050197, 'recall': 0.53004175, 'specificity': 0.53004175, 'f1': 0.42197675, 'auroc': 0.68934727, 'binary_precision': 0.5029686, 'binary_recall': 0.95337623, 'binary_specificity': 0.10670732, 'binary_f1_score': 0.658523}
confusion matrix:
    0    1
0  70  586
1  29  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53894734, 'precision': 0.46395272, 'recall': 0.49613005, 'specificity': 0.49613005, 'f1': 0.36996162, 'auroc': 0.3055377, 'binary_precision': 0.54329, 'binary_recall': 0.969112, 'binary_specificity': 0.023148147, 'binary_f1_score': 0.69625515}
confusion matrix:
   0    1
0  5  211
1  8  251
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 17:40:38.424629,epoch time: 0:09:32.259354,used: 0:09:32.259354,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9448623, 'precision': 0.60102737, 'recall': 0.529289, 'specificity': 0.529289, 'f1': 0.5398996, 'auroc': 0.6710768, 'binary_precision': 0.9544133, 'binary_recall': 0.9893168, 'binary_specificity': 0.069261216, 'binary_f1_score': 0.9715517}
confusion matrix:
     0      1
0  105   1411
1  319  29541
---- Validation: 
scalar performance:
{'acc': 0.49608764, 'precision': 0.645628, 'recall': 0.5089797, 'specificity': 0.5089797, 'f1': 0.35239205, 'auroc': 0.71875244, 'binary_precision': 0.49125597, 'binary_recall': 0.99356914, 'binary_specificity': 0.024390243, 'binary_f1_score': 0.6574468}
confusion matrix:
    0    1
0  16  640
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.3432361, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
new oracle model saved
early stop counter: 1
val acc:0.4960876405239105, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 2,now: 2024-07-12 17:50:05.754606,epoch time: 0:09:27.329977,used: 0:18:59.589331,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9501849, 'precision': 0.66185796, 'recall': 0.52018875, 'specificity': 0.52018875, 'f1': 0.5266815, 'auroc': 0.72725797, 'binary_precision': 0.9535502, 'binary_recall': 0.9961822, 'binary_specificity': 0.04419525, 'binary_f1_score': 0.9744001}
confusion matrix:
     0      1
0   67   1449
1  114  29746
---- Validation: 
scalar performance:
{'acc': 0.49295774, 'precision': 0.6615324, 'recall': 0.5060142, 'specificity': 0.5060142, 'f1': 0.3433599, 'auroc': 0.7409744, 'binary_precision': 0.48973143, 'binary_recall': 0.99678457, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65677965}
confusion matrix:
    0    1
0  10  646
1   2  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.39469826, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 2
val acc:0.49295774102211, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 3,now: 2024-07-12 17:59:32.656274,epoch time: 0:09:26.901668,used: 0:28:26.490999,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9512047, 'precision': 0.69711167, 'recall': 0.51728076, 'specificity': 0.51728076, 'f1': 0.5215572, 'auroc': 0.77425563, 'binary_precision': 0.9532785, 'binary_recall': 0.99762225, 'binary_specificity': 0.036939315, 'binary_f1_score': 0.9749464}
confusion matrix:
    0      1
0  56   1460
1  71  29789
---- Validation: 
scalar performance:
{'acc': 0.49374023, 'precision': 0.69961256, 'recall': 0.5068181, 'specificity': 0.5068181, 'f1': 0.34373787, 'auroc': 0.7562691, 'binary_precision': 0.49013418, 'binary_recall': 0.9983923, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65749073}
confusion matrix:
    0    1
0  10  646
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.4454633, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 3
val acc:0.4937402307987213, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 4,now: 2024-07-12 18:09:04.767854,epoch time: 0:09:32.111580,used: 0:37:58.602579,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.951874, 'precision': 0.7403203, 'recall': 0.5182586, 'specificity': 0.5182586, 'f1': 0.5233188, 'auroc': 0.810609, 'binary_precision': 0.9533679, 'binary_recall': 0.99825853, 'binary_specificity': 0.038258575, 'binary_f1_score': 0.9752969}
confusion matrix:
    0      1
0  58   1458
1  52  29808
---- Validation: 
scalar performance:
{'acc': 0.4945227, 'precision': 0.703594, 'recall': 0.5075803, 'specificity': 0.5075803, 'f1': 0.34538653, 'auroc': 0.76858926, 'binary_precision': 0.49052134, 'binary_recall': 0.9983923, 'binary_specificity': 0.016768293, 'binary_f1_score': 0.65783894}
confusion matrix:
    0    1
0  11  645
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.4900794, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 4
val acc:0.49452269077301025, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 5,now: 2024-07-12 18:18:31.916947,epoch time: 0:09:27.149093,used: 0:47:25.751672,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9518103, 'precision': 0.7341175, 'recall': 0.522295, 'specificity': 0.522295, 'f1': 0.5305526, 'auroc': 0.8434956, 'binary_precision': 0.95374227, 'binary_recall': 0.9977562, 'binary_specificity': 0.046833772, 'binary_f1_score': 0.9752528}
confusion matrix:
    0      1
0  71   1445
1  67  29793
---- Validation: 
scalar performance:
{'acc': 0.4976526, 'precision': 0.714788, 'recall': 0.51062906, 'specificity': 0.51062906, 'f1': 0.35193926, 'auroc': 0.777863, 'binary_precision': 0.49207607, 'binary_recall': 0.9983923, 'binary_specificity': 0.022865854, 'binary_f1_score': 0.65923566}
confusion matrix:
    0    1
0  15  641
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5289217, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 5
val acc:0.4976525902748108, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 6,now: 2024-07-12 18:27:57.478814,epoch time: 0:09:25.561867,used: 0:56:51.313539,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9528621, 'precision': 0.79097927, 'recall': 0.52910894, 'specificity': 0.52910894, 'f1': 0.5426814, 'auroc': 0.8668077, 'binary_precision': 0.9543723, 'binary_recall': 0.99819154, 'binary_specificity': 0.060026385, 'binary_f1_score': 0.9757902}
confusion matrix:
    0      1
0  91   1425
1  54  29806
---- Validation: 
scalar performance:
{'acc': 0.5062598, 'precision': 0.7137158, 'recall': 0.51897156, 'specificity': 0.51897156, 'f1': 0.37078965, 'auroc': 0.7852669, 'binary_precision': 0.4963971, 'binary_recall': 0.99678457, 'binary_specificity': 0.04115854, 'binary_f1_score': 0.6627472}
confusion matrix:
    0    1
0  27  629
1   2  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.56313455, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 6
val acc:0.5062597990036011, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 7,now: 2024-07-12 18:37:21.018048,epoch time: 0:09:23.539234,used: 1:06:14.852773,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9540413, 'precision': 0.8283102, 'recall': 0.5416252, 'specificity': 0.5416252, 'f1': 0.5640728, 'auroc': 0.8794693, 'binary_precision': 0.95553344, 'binary_recall': 0.9981581, 'binary_specificity': 0.08509235, 'binary_f1_score': 0.9763808}
confusion matrix:
     0      1
0  129   1387
1   55  29805
---- Validation: 
scalar performance:
{'acc': 0.514867, 'precision': 0.7146902, 'recall': 0.527314, 'specificity': 0.527314, 'f1': 0.38902786, 'auroc': 0.79062915, 'binary_precision': 0.5008091, 'binary_recall': 0.99517685, 'binary_specificity': 0.05945122, 'binary_f1_score': 0.66630787}
confusion matrix:
    0    1
0  39  617
1   3  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5917882, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 7
val acc:0.5148670077323914, best validation acc: 0.5187793374061584, corresponding to test acc:                         0.538947343826294 / 0.5494737029075623
after epoch: 8,now: 2024-07-12 18:46:48.154069,epoch time: 0:09:27.136021,used: 1:15:41.988794,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9543281, 'precision': 0.83119696, 'recall': 0.5458458, 'specificity': 0.5458458, 'f1': 0.5709632, 'auroc': 0.887442, 'binary_precision': 0.95592624, 'binary_recall': 0.9980241, 'binary_specificity': 0.093667544, 'binary_f1_score': 0.9765216}
confusion matrix:
     0      1
0  142   1374
1   59  29801
---- Validation: 
scalar performance:
{'acc': 0.52660406, 'precision': 0.71250856, 'recall': 0.5386636, 'specificity': 0.5386636, 'f1': 0.41361165, 'auroc': 0.7940431, 'binary_precision': 0.5069844, 'binary_recall': 0.9919614, 'binary_specificity': 0.085365854, 'binary_f1_score': 0.67101693}
confusion matrix:
    0    1
0  56  600
1   5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.6139711, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 9,now: 2024-07-12 18:56:17.541372,epoch time: 0:09:29.387303,used: 1:25:11.376097,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9550931, 'precision': 0.8394445, 'recall': 0.55626595, 'specificity': 0.55626595, 'f1': 0.58748233, 'auroc': 0.89606583, 'binary_precision': 0.9568974, 'binary_recall': 0.9977562, 'binary_specificity': 0.114775725, 'binary_f1_score': 0.9768998}
confusion matrix:
     0      1
0  174   1342
1   67  29793
---- Validation: 
scalar performance:
{'acc': 0.54147106, 'precision': 0.71587104, 'recall': 0.553062, 'specificity': 0.553062, 'f1': 0.44271046, 'auroc': 0.7970208, 'binary_precision': 0.5150754, 'binary_recall': 0.988746, 'binary_specificity': 0.11737805, 'binary_f1_score': 0.6773128}
confusion matrix:
    0    1
0  77  579
1   7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.6311311, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 10,now: 2024-07-12 19:05:45.216485,epoch time: 0:09:27.675113,used: 1:34:39.051210,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9574834, 'precision': 0.87182105, 'recall': 0.5816282, 'specificity': 0.5816282, 'f1': 0.62576073, 'auroc': 0.9098251, 'binary_precision': 0.95926714, 'binary_recall': 0.9976892, 'binary_specificity': 0.16556728, 'binary_f1_score': 0.97810096}
confusion matrix:
     0      1
0  251   1265
1   69  29791
---- Validation: 
scalar performance:
{'acc': 0.556338, 'precision': 0.71968603, 'recall': 0.5674604, 'specificity': 0.5674604, 'f1': 0.4703255, 'auroc': 0.79941523, 'binary_precision': 0.52348423, 'binary_recall': 0.98553056, 'binary_specificity': 0.14939025, 'binary_f1_score': 0.68377024}
confusion matrix:
    0    1
0  98  558
1   9  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5726316, 'precision': 0.780303, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.41599187, 'auroc': 0.6477907, 'binary_precision': 0.56060606, 'binary_recall': 1.0, 'binary_specificity': 0.060185187, 'binary_f1_score': 0.7184466}
confusion matrix:
    0    1
0  13  203
1   0  259
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-12 19:15:12.401556,epoch time: 0:09:27.185071,used: 1:44:06.236281,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9578659, 'precision': 0.8632979, 'recall': 0.5905952, 'specificity': 0.5905952, 'f1': 0.6375454, 'auroc': 0.90878093, 'binary_precision': 0.9601122, 'binary_recall': 0.9971534, 'binary_specificity': 0.18403694, 'binary_f1_score': 0.97828233}
confusion matrix:
     0      1
0  279   1237
1   85  29775
---- Validation: 
scalar performance:
{'acc': 0.5688576, 'precision': 0.7253946, 'recall': 0.57961386, 'specificity': 0.57961386, 'f1': 0.49203587, 'auroc': 0.80046415, 'binary_precision': 0.53078926, 'binary_recall': 0.98392284, 'binary_specificity': 0.17530487, 'binary_f1_score': 0.68957746}
confusion matrix:
     0    1
0  115  541
1   10  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5873684, 'precision': 0.7846154, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.44749087, 'auroc': 0.6599277, 'binary_precision': 0.5692308, 'binary_recall': 1.0, 'binary_specificity': 0.09259259, 'binary_f1_score': 0.7254902}
confusion matrix:
    0    1
0  20  196
1   0  259
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-12 19:24:37.030753,epoch time: 0:09:24.629197,used: 1:53:30.865478,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9587583, 'precision': 0.8692994, 'recall': 0.60108227, 'specificity': 0.60108227, 'f1': 0.65168214, 'auroc': 0.9155601, 'binary_precision': 0.9610989, 'binary_recall': 0.9970194, 'binary_specificity': 0.20514512, 'binary_f1_score': 0.97872967}
confusion matrix:
     0      1
0  311   1205
1   89  29771
---- Validation: 
scalar performance:
{'acc': 0.57746476, 'precision': 0.7194665, 'recall': 0.5878314, 'specificity': 0.5878314, 'f1': 0.5087415, 'auroc': 0.8024585, 'binary_precision': 0.5361552, 'binary_recall': 0.977492, 'binary_specificity': 0.19817074, 'binary_f1_score': 0.69248295}
confusion matrix:
     0    1
0  130  526
1   14  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5978947, 'precision': 0.7877778, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.46903768, 'auroc': 0.6712427, 'binary_precision': 0.57555556, 'binary_recall': 1.0, 'binary_specificity': 0.11574074, 'binary_f1_score': 0.7306065}
confusion matrix:
    0    1
0  25  191
1   0  259
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 19:34:05.849128,epoch time: 0:09:28.818375,used: 2:02:59.683853,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9593957, 'precision': 0.86103183, 'recall': 0.6148792, 'specificity': 0.6148792, 'f1': 0.66812533, 'auroc': 0.9149085, 'binary_precision': 0.962407, 'binary_recall': 0.99624914, 'binary_specificity': 0.23350923, 'binary_f1_score': 0.97903574}
confusion matrix:
     0      1
0  354   1162
1  112  29748
---- Validation: 
scalar performance:
{'acc': 0.5946792, 'precision': 0.7264069, 'recall': 0.6045163, 'specificity': 0.6045163, 'f1': 0.5367297, 'auroc': 0.8042923, 'binary_precision': 0.5469314, 'binary_recall': 0.97427654, 'binary_specificity': 0.2347561, 'binary_f1_score': 0.70057803}
confusion matrix:
     0    1
0  154  502
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.77322096, 'recall': 0.56519914, 'specificity': 0.56519914, 'f1': 0.48436344, 'auroc': 0.6817532, 'binary_precision': 0.5797753, 'binary_recall': 0.996139, 'binary_specificity': 0.13425925, 'binary_f1_score': 0.73295456}
confusion matrix:
    0    1
0  29  187
1   1  258
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-12 19:43:34.488774,epoch time: 0:09:28.639646,used: 2:12:28.323499,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9611486, 'precision': 0.87095165, 'recall': 0.6352105, 'specificity': 0.6352105, 'f1': 0.6927869, 'auroc': 0.9233948, 'binary_precision': 0.9643332, 'binary_recall': 0.9960147, 'binary_specificity': 0.27440634, 'binary_f1_score': 0.97991794}
confusion matrix:
     0      1
0  416   1100
1  119  29741
---- Validation: 
scalar performance:
{'acc': 0.6095462, 'precision': 0.7296754, 'recall': 0.61887306, 'specificity': 0.61887306, 'f1': 0.56048125, 'auroc': 0.8054589, 'binary_precision': 0.5567867, 'binary_recall': 0.9694534, 'binary_specificity': 0.2682927, 'binary_f1_score': 0.7073314}
confusion matrix:
     0    1
0  176  480
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.7461318, 'recall': 0.56596774, 'specificity': 0.56596774, 'f1': 0.48971426, 'auroc': 0.6906728, 'binary_precision': 0.5804989, 'binary_recall': 0.98841697, 'binary_specificity': 0.14351852, 'binary_f1_score': 0.73142856}
confusion matrix:
    0    1
0  31  185
1   3  256
better model found
persisted
after epoch: 15,now: 2024-07-12 19:52:58.597757,epoch time: 0:09:24.108983,used: 2:21:52.432482,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9616905, 'precision': 0.8657703, 'recall': 0.6467657, 'specificity': 0.6467657, 'f1': 0.7047149, 'auroc': 0.9252149, 'binary_precision': 0.96543884, 'binary_recall': 0.99537843, 'binary_specificity': 0.29815304, 'binary_f1_score': 0.98018}
confusion matrix:
     0      1
0  452   1064
1  138  29722
---- Validation: 
scalar performance:
{'acc': 0.6118936, 'precision': 0.72922075, 'recall': 0.62111795, 'specificity': 0.62111795, 'f1': 0.56439805, 'auroc': 0.80809104, 'binary_precision': 0.5584416, 'binary_recall': 0.9678457, 'binary_specificity': 0.27439025, 'binary_f1_score': 0.70823526}
confusion matrix:
     0    1
0  180  476
1   20  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105263, 'precision': 0.7411492, 'recall': 0.5732965, 'specificity': 0.5732965, 'f1': 0.50416136, 'auroc': 0.69987845, 'binary_precision': 0.5848624, 'binary_recall': 0.98455596, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.7338129}
confusion matrix:
    0    1
0  35  181
1   4  255
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-12 20:02:22.379488,epoch time: 0:09:23.781731,used: 2:31:16.214213,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9626785, 'precision': 0.86913896, 'recall': 0.6591815, 'specificity': 0.6591815, 'f1': 0.71813947, 'auroc': 0.93115926, 'binary_precision': 0.9666244, 'binary_recall': 0.995144, 'binary_specificity': 0.323219, 'binary_f1_score': 0.9806769}
confusion matrix:
     0      1
0  490   1026
1  145  29715
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.73404837, 'recall': 0.63399196, 'specificity': 0.63399196, 'f1': 0.5842655, 'auroc': 0.80953455, 'binary_precision': 0.5676443, 'binary_recall': 0.96463025, 'binary_specificity': 0.30335367, 'binary_f1_score': 0.7147111}
confusion matrix:
     0    1
0  199  457
1   22  600
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61263156, 'precision': 0.74310344, 'recall': 0.5756113, 'specificity': 0.5756113, 'f1': 0.50806016, 'auroc': 0.7082082, 'binary_precision': 0.5862069, 'binary_recall': 0.98455596, 'binary_specificity': 0.16666667, 'binary_f1_score': 0.7348703}
confusion matrix:
    0    1
0  36  180
1   4  255
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-12 20:11:48.256369,epoch time: 0:09:25.876881,used: 2:40:42.091094,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9626466, 'precision': 0.8553283, 'recall': 0.6704353, 'specificity': 0.6704353, 'f1': 0.72682935, 'auroc': 0.92772675, 'binary_precision': 0.9677188, 'binary_recall': 0.9939049, 'binary_specificity': 0.3469657, 'binary_f1_score': 0.9806371}
confusion matrix:
     0      1
0  526    990
1  182  29678
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.73331434, 'recall': 0.6354747, 'specificity': 0.6354747, 'f1': 0.5868968, 'auroc': 0.81194365, 'binary_precision': 0.5688509, 'binary_recall': 0.96302253, 'binary_specificity': 0.30792683, 'binary_f1_score': 0.71522385}
confusion matrix:
     0    1
0  202  454
1   23  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6210526, 'precision': 0.75036913, 'recall': 0.5848706, 'specificity': 0.5848706, 'f1': 0.52341133, 'auroc': 0.71682394, 'binary_precision': 0.5916473, 'binary_recall': 0.98455596, 'binary_specificity': 0.18518518, 'binary_f1_score': 0.7391304}
confusion matrix:
    0    1
0  40  176
1   4  255
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-12 20:21:18.361803,epoch time: 0:09:30.105434,used: 2:50:12.196528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9631566, 'precision': 0.8571239, 'recall': 0.67696464, 'specificity': 0.67696464, 'f1': 0.7333295, 'auroc': 0.93092763, 'binary_precision': 0.9683462, 'binary_recall': 0.99377096, 'binary_specificity': 0.36015832, 'binary_f1_score': 0.9808938}
confusion matrix:
     0      1
0  546    970
1  186  29674
---- Validation: 
scalar performance:
{'acc': 0.63615024, 'precision': 0.73756754, 'recall': 0.64457935, 'specificity': 0.64457935, 'f1': 0.6002475, 'auroc': 0.81330633, 'binary_precision': 0.5755534, 'binary_recall': 0.9614148, 'binary_specificity': 0.3277439, 'binary_f1_score': 0.7200481}
confusion matrix:
     0    1
0  215  441
1   24  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6231579, 'precision': 0.7435375, 'recall': 0.5875697, 'specificity': 0.5875697, 'f1': 0.52941924, 'auroc': 0.72472477, 'binary_precision': 0.59345794, 'binary_recall': 0.980695, 'binary_specificity': 0.19444445, 'binary_f1_score': 0.7394468}
confusion matrix:
    0    1
0  42  174
1   5  254
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-12 20:30:42.756940,epoch time: 0:09:24.395137,used: 2:59:36.591665,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9636984, 'precision': 0.8556602, 'recall': 0.68726754, 'specificity': 0.68726754, 'f1': 0.74243194, 'auroc': 0.9363599, 'binary_precision': 0.9693434, 'binary_recall': 0.9932686, 'binary_specificity': 0.3812665, 'binary_f1_score': 0.98116016}
confusion matrix:
     0      1
0  578    938
1  201  29659
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.73154604, 'recall': 0.64890254, 'specificity': 0.64890254, 'f1': 0.6089474, 'auroc': 0.81487536, 'binary_precision': 0.5798237, 'binary_recall': 0.9517685, 'binary_specificity': 0.34603658, 'binary_f1_score': 0.720633}
confusion matrix:
     0    1
0  227  429
1   30  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63789475, 'precision': 0.74833786, 'recall': 0.60415775, 'specificity': 0.60415775, 'f1': 0.5569799, 'auroc': 0.7325003, 'binary_precision': 0.6038186, 'binary_recall': 0.976834, 'binary_specificity': 0.23148148, 'binary_f1_score': 0.7463127}
confusion matrix:
    0    1
0  50  166
1   6  253
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-12 20:40:05.665592,epoch time: 0:09:22.908652,used: 3:08:59.500317,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9641764, 'precision': 0.8535284, 'recall': 0.69753695, 'specificity': 0.69753695, 'f1': 0.7509355, 'auroc': 0.9350034, 'binary_precision': 0.97034174, 'binary_recall': 0.99269927, 'binary_specificity': 0.40237468, 'binary_f1_score': 0.98139316}
confusion matrix:
     0      1
0  610    906
1  218  29642
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.7318652, 'recall': 0.6533924, 'specificity': 0.6533924, 'f1': 0.6159028, 'auroc': 0.8163551, 'binary_precision': 0.5835806, 'binary_recall': 0.948553, 'binary_specificity': 0.3582317, 'binary_f1_score': 0.72259647}
confusion matrix:
     0    1
0  235  421
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63789475, 'precision': 0.735743, 'recall': 0.60492635, 'specificity': 0.60492635, 'f1': 0.5608094, 'auroc': 0.73956096, 'binary_precision': 0.6048193, 'binary_recall': 0.969112, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7448072}
confusion matrix:
    0    1
0  52  164
1   8  251
better model found
persisted
after epoch: 21,now: 2024-07-12 20:49:27.775390,epoch time: 0:09:22.109798,used: 3:18:21.610115,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9629972, 'precision': 0.8467837, 'recall': 0.6853338, 'specificity': 0.6853338, 'f1': 0.7387708, 'auroc': 0.9392327, 'binary_precision': 0.9691679, 'binary_recall': 0.99269927, 'binary_specificity': 0.37796834, 'binary_f1_score': 0.9807925}
confusion matrix:
     0      1
0  573    943
1  218  29642
---- Validation: 
scalar performance:
{'acc': 0.6455399, 'precision': 0.73321724, 'recall': 0.65343404, 'specificity': 0.65343404, 'f1': 0.61553955, 'auroc': 0.8192862, 'binary_precision': 0.58341557, 'binary_recall': 0.9501608, 'binary_specificity': 0.3567073, 'binary_f1_score': 0.72293574}
confusion matrix:
     0    1
0  234  422
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7435626, 'recall': 0.6068569, 'specificity': 0.6068569, 'f1': 0.56242424, 'auroc': 0.7478372, 'binary_precision': 0.6057692, 'binary_recall': 0.972973, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7466666}
confusion matrix:
    0    1
0  52  164
1   7  252
new oracle model saved
early stop counter: 1
val acc:0.6455398797988892, best validation acc: 0.6455398797988892, corresponding to test acc:                         0.6378947496414185 / 0.6399999856948853
after epoch: 22,now: 2024-07-12 20:58:54.186867,epoch time: 0:09:26.411477,used: 3:27:48.021592,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9656425, 'precision': 0.8731948, 'recall': 0.70018566, 'specificity': 0.70018566, 'f1': 0.757749, 'auroc': 0.94064426, 'binary_precision': 0.9705709, 'binary_recall': 0.9940388, 'binary_specificity': 0.40633246, 'binary_f1_score': 0.9821647}
confusion matrix:
     0      1
0  616    900
1  178  29682
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.73339945, 'recall': 0.655679, 'specificity': 0.655679, 'f1': 0.6189827, 'auroc': 0.8208351, 'binary_precision': 0.58531743, 'binary_recall': 0.948553, 'binary_specificity': 0.3628049, 'binary_f1_score': 0.72392637}
confusion matrix:
     0    1
0  238  418
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64842105, 'precision': 0.7445591, 'recall': 0.61650044, 'specificity': 0.61650044, 'f1': 0.5780338, 'auroc': 0.75355715, 'binary_precision': 0.61219513, 'binary_recall': 0.969112, 'binary_specificity': 0.2638889, 'binary_f1_score': 0.75037366}
confusion matrix:
    0    1
0  57  159
1   8  251
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-12 21:08:26.504828,epoch time: 0:09:32.317961,used: 3:37:20.339553,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9641764, 'precision': 0.8417593, 'recall': 0.7128774, 'specificity': 0.7128774, 'f1': 0.7605423, 'auroc': 0.94419277, 'binary_precision': 0.9718555, 'binary_recall': 0.9910583, 'binary_specificity': 0.43469656, 'binary_f1_score': 0.981363}
confusion matrix:
     0      1
0  659    857
1  267  29593
---- Validation: 
scalar performance:
{'acc': 0.6580595, 'precision': 0.7399453, 'recall': 0.6655875, 'specificity': 0.6655875, 'f1': 0.6321789, 'auroc': 0.8220507, 'binary_precision': 0.5929648, 'binary_recall': 0.948553, 'binary_specificity': 0.38262194, 'binary_f1_score': 0.7297464}
confusion matrix:
     0    1
0  251  405
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6547368, 'precision': 0.7443563, 'recall': 0.6238292, 'specificity': 0.6238292, 'f1': 0.5897927, 'auroc': 0.7591699, 'binary_precision': 0.61728394, 'binary_recall': 0.96525097, 'binary_specificity': 0.2824074, 'binary_f1_score': 0.753012}
confusion matrix:
    0    1
0  61  155
1   9  250
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-12 21:17:53.599122,epoch time: 0:09:27.094294,used: 3:46:47.433847,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9652601, 'precision': 0.861193, 'recall': 0.7065592, 'specificity': 0.7065592, 'f1': 0.76043355, 'auroc': 0.94215333, 'binary_precision': 0.9712068, 'binary_recall': 0.9929337, 'binary_specificity': 0.4201847, 'binary_f1_score': 0.9819501}
confusion matrix:
     0      1
0  637    879
1  211  29649
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.7364402, 'recall': 0.6602521, 'specificity': 0.6602521, 'f1': 0.6251031, 'auroc': 0.8252784, 'binary_precision': 0.58882236, 'binary_recall': 0.948553, 'binary_specificity': 0.37195122, 'binary_f1_score': 0.726601}
confusion matrix:
     0    1
0  244  412
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64842105, 'precision': 0.73920834, 'recall': 0.6168847, 'specificity': 0.6168847, 'f1': 0.57975966, 'auroc': 0.7661948, 'binary_precision': 0.6127451, 'binary_recall': 0.96525097, 'binary_specificity': 0.2685185, 'binary_f1_score': 0.74962527}
confusion matrix:
    0    1
0  58  158
1   9  250
early stop counter: 1
val acc:0.6525821685791016, best validation acc: 0.6580594778060913, corresponding to test acc:                         0.6547368168830872 / 0.6547368168830872
after epoch: 25,now: 2024-07-12 21:27:18.108726,epoch time: 0:09:24.509604,used: 3:56:11.943451,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9632203, 'precision': 0.83263844, 'recall': 0.7089313, 'specificity': 0.7089313, 'f1': 0.75492126, 'auroc': 0.9447471, 'binary_precision': 0.97148675, 'binary_recall': 0.99042195, 'binary_specificity': 0.42744064, 'binary_f1_score': 0.980863}
confusion matrix:
     0      1
0  648    868
1  286  29574
---- Validation: 
scalar performance:
{'acc': 0.6604069, 'precision': 0.741435, 'recall': 0.6678741, 'specificity': 0.6678741, 'f1': 0.6351905, 'auroc': 0.8273003, 'binary_precision': 0.5947581, 'binary_recall': 0.948553, 'binary_specificity': 0.3871951, 'binary_f1_score': 0.7311028}
confusion matrix:
     0    1
0  254  402
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6568421, 'precision': 0.7460257, 'recall': 0.626144, 'specificity': 0.626144, 'f1': 0.5931018, 'auroc': 0.7722007, 'binary_precision': 0.6188119, 'binary_recall': 0.96525097, 'binary_specificity': 0.28703704, 'binary_f1_score': 0.7541479}
confusion matrix:
    0    1
0  62  154
1   9  250
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-12 21:36:43.806081,epoch time: 0:09:25.697355,used: 4:05:37.640806,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9656425, 'precision': 0.85041046, 'recall': 0.7264836, 'specificity': 0.7264836, 'f1': 0.77354336, 'auroc': 0.94334817, 'binary_precision': 0.9731702, 'binary_recall': 0.9912257, 'binary_specificity': 0.46174142, 'binary_f1_score': 0.982115}
confusion matrix:
     0      1
0  700    816
1  262  29598
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.74488485, 'recall': 0.6732094, 'specificity': 0.6732094, 'f1': 0.6421701, 'auroc': 0.8290012, 'binary_precision': 0.5989848, 'binary_recall': 0.948553, 'binary_specificity': 0.39786586, 'binary_f1_score': 0.7342875}
confusion matrix:
     0    1
0  261  395
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65894735, 'precision': 0.7476737, 'recall': 0.6284588, 'specificity': 0.6284588, 'f1': 0.59639347, 'auroc': 0.77745605, 'binary_precision': 0.6203474, 'binary_recall': 0.96525097, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.755287}
confusion matrix:
    0    1
0  63  153
1   9  250
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-12 21:46:15.230208,epoch time: 0:09:31.424127,used: 4:15:09.064933,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9655469, 'precision': 0.85407984, 'recall': 0.7198589, 'specificity': 0.7198589, 'f1': 0.76943123, 'auroc': 0.9500699, 'binary_precision': 0.97251505, 'binary_recall': 0.99182856, 'binary_specificity': 0.44788918, 'binary_f1_score': 0.9820769}
confusion matrix:
     0      1
0  679    837
1  244  29616
---- Validation: 
scalar performance:
{'acc': 0.6627543, 'precision': 0.7429178, 'recall': 0.67016065, 'specificity': 0.67016065, 'f1': 0.63818985, 'auroc': 0.8314569, 'binary_precision': 0.5965622, 'binary_recall': 0.948553, 'binary_specificity': 0.3917683, 'binary_f1_score': 0.7324643}
confusion matrix:
     0    1
0  257  399
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65894735, 'precision': 0.7476737, 'recall': 0.6284588, 'specificity': 0.6284588, 'f1': 0.59639347, 'auroc': 0.7835514, 'binary_precision': 0.6203474, 'binary_recall': 0.96525097, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.755287}
confusion matrix:
    0    1
0  63  153
1   9  250
early stop counter: 1
val acc:0.6627542972564697, best validation acc: 0.6658841967582703, corresponding to test acc:                         0.6589473485946655 / 0.6589473485946655
after epoch: 28,now: 2024-07-12 21:55:41.938767,epoch time: 0:09:26.708559,used: 4:24:35.773492,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9659294, 'precision': 0.857676, 'recall': 0.72162515, 'specificity': 0.72162515, 'f1': 0.7718111, 'auroc': 0.94944704, 'binary_precision': 0.972681, 'binary_recall': 0.992063, 'binary_specificity': 0.45118734, 'binary_f1_score': 0.9822764}
confusion matrix:
     0      1
0  684    832
1  237  29623
---- Validation: 
scalar performance:
{'acc': 0.6627543, 'precision': 0.7429178, 'recall': 0.67016065, 'specificity': 0.67016065, 'f1': 0.63818985, 'auroc': 0.83341503, 'binary_precision': 0.5965622, 'binary_recall': 0.948553, 'binary_specificity': 0.3917683, 'binary_f1_score': 0.7324643}
confusion matrix:
     0    1
0  257  399
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65894735, 'precision': 0.7476737, 'recall': 0.6284588, 'specificity': 0.6284588, 'f1': 0.59639347, 'auroc': 0.7876805, 'binary_precision': 0.6203474, 'binary_recall': 0.96525097, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.755287}
confusion matrix:
    0    1
0  63  153
1   9  250
early stop counter: 2
val acc:0.6627542972564697, best validation acc: 0.6658841967582703, corresponding to test acc:                         0.6589473485946655 / 0.6589473485946655
after epoch: 29,now: 2024-07-12 22:05:06.364443,epoch time: 0:09:24.425676,used: 4:34:00.199168,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9663756, 'precision': 0.85599613, 'recall': 0.7312517, 'specificity': 0.7312517, 'f1': 0.77880293, 'auroc': 0.9501296, 'binary_precision': 0.97362626, 'binary_recall': 0.99152714, 'binary_specificity': 0.47097626, 'binary_f1_score': 0.9824951}
confusion matrix:
     0      1
0  714    802
1  253  29607
---- Validation: 
scalar performance:
{'acc': 0.6713615, 'precision': 0.74830264, 'recall': 0.6785448, 'specificity': 0.6785448, 'f1': 0.6490847, 'auroc': 0.83517957, 'binary_precision': 0.60327196, 'binary_recall': 0.948553, 'binary_specificity': 0.40853658, 'binary_f1_score': 0.73749995}
confusion matrix:
     0    1
0  268  388
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.79409766, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-12 22:14:28.941033,epoch time: 0:09:22.576590,used: 4:43:22.775758,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_17_31_06_seed_2_21918844
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:43:22.775758 at 2024-07-12 22:14:28.941033
persisted model performance metric: 

scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.79409766, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
oracle model performance metric: 

scalar performance:
{'acc': 0.6631579, 'precision': 0.7509099, 'recall': 0.63308847, 'specificity': 0.63308847, 'f1': 0.6029258, 'auroc': 0.79409766, 'binary_precision': 0.6234414, 'binary_recall': 0.96525097, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.75757575}
confusion matrix:
    0    1
0  65  151
1   9  250
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |  16198 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1086 MiB | 585728 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     72 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37442 KiB | 104341 KiB | 365909 GiB | 365909 GiB |
|       from large pool |  31306 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |   6136 KiB |  11184 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4405    |  150557 K  |  150556 K  |
|       from large pool |      76    |     158    |   63852 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86705 K  |   86704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4405    |  150557 K  |  150556 K  |
|       from large pool |      76    |     158    |   63852 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86705 K  |   86704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      81    |      40    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      19    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      41    |    1983    |   85696 K  |   85696 K  |
|       from large pool |      10    |      22    |   36924 K  |   36924 K  |
|       from small pool |      31    |    1973    |   48771 K  |   48771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |      0 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |   1086 MiB |    864 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  38912 KiB |     72 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 104341 KiB | 365910 GiB | 365910 GiB |
|       from large pool |  23872 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |      0 KiB |  12070 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4405    |  150557 K  |  150557 K  |
|       from large pool |       2    |     158    |   63852 K  |   63852 K  |
|       from small pool |       0    |    4327    |   86705 K  |   86705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4405    |  150557 K  |  150557 K  |
|       from large pool |       2    |     158    |   63852 K  |   63852 K  |
|       from small pool |       0    |    4327    |   86705 K  |   86705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      81    |      60    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      19    |      36    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1983    |   85696 K  |   85696 K  |
|       from large pool |       3    |      22    |   36924 K  |   36924 K  |
|       from small pool |       0    |    1973    |   48771 K  |   48771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 22:21:55 2024]
Finished job 0.
1 of 1 steps (100%) done
