Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 08:34:24 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845

 Experiment start at: 2024-07-12 08:42:02.065752
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9513246, 'precision': 0.86457634, 'recall': 0.50227034, 'specificity': 0.50227034, 'f1': 0.49210587, 'auroc': 0.9132763, 'binary_precision': 0.9513748, 'binary_recall': 0.9999324, 'binary_specificity': 0.004608295, 'binary_f1_score': 0.97504944}
confusion matrix:
   0      1
0  7   1512
1  2  29583
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.51552796, 'precision': 0.7521843, 'recall': 0.52220523, 'specificity': 0.52220523, 'f1': 0.37779126, 'auroc': 0.84558487, 'binary_precision': 0.50436854, 'binary_recall': 1.0, 'binary_specificity': 0.044410415, 'binary_f1_score': 0.67053854}
confusion matrix:
    0    1
0  29  624
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.556701, 'precision': 0.2783505, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.3576159, 'auroc': 0.8348321, 'binary_precision': 0.556701, 'binary_recall': 1.0, 'binary_specificity': 0.0, 'binary_f1_score': 0.7152318}
confusion matrix:
   0    1
0  0  215
1  0  270
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 09:04:05.342738,epoch time: 0:22:03.276986,used: 0:22:03.276986,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.955472, 'precision': 0.89237106, 'recall': 0.5550372, 'specificity': 0.5550372, 'f1': 0.5866356, 'auroc': 0.9458833, 'binary_precision': 0.9563107, 'binary_recall': 0.99881697, 'binary_specificity': 0.111257404, 'binary_f1_score': 0.97710174}
confusion matrix:
     0      1
0  169   1350
1   35  29550
---- Validation: 
scalar performance:
{'acc': 0.55667704, 'precision': 0.7462878, 'recall': 0.562722, 'specificity': 0.562722, 'f1': 0.459124, 'auroc': 0.85489506, 'binary_precision': 0.52666664, 'binary_recall': 0.9952756, 'binary_specificity': 0.13016845, 'binary_f1_score': 0.6888283}
confusion matrix:
    0    1
0  85  568
1   3  632
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60618556, 'precision': 0.7928417, 'recall': 0.55581397, 'specificity': 0.55581397, 'f1': 0.46977544, 'auroc': 0.86931956, 'binary_precision': 0.5856833, 'binary_recall': 1.0, 'binary_specificity': 0.11162791, 'binary_f1_score': 0.73871404}
confusion matrix:
    0    1
0  24  191
1   0  270
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 09:26:07.391766,epoch time: 0:22:02.049028,used: 0:44:05.326014,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9610018, 'precision': 0.8999214, 'recall': 0.6238316, 'specificity': 0.6238316, 'f1': 0.68253124, 'auroc': 0.96162987, 'binary_precision': 0.9628385, 'binary_recall': 0.99749875, 'binary_specificity': 0.25016457, 'binary_f1_score': 0.9798622}
confusion matrix:
     0      1
0  380   1139
1   74  29511
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.7525261, 'recall': 0.59787893, 'specificity': 0.59787893, 'f1': 0.5217548, 'auroc': 0.86769485, 'binary_precision': 0.5479094, 'binary_recall': 0.9905512, 'binary_specificity': 0.20520674, 'binary_f1_score': 0.70555246}
confusion matrix:
     0    1
0  134  519
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6474227, 'precision': 0.79550856, 'recall': 0.6027993, 'specificity': 0.6027993, 'f1': 0.5518214, 'auroc': 0.8893024, 'binary_precision': 0.61275625, 'binary_recall': 0.9962963, 'binary_specificity': 0.20930232, 'binary_f1_score': 0.7588152}
confusion matrix:
    0    1
0  45  170
1   1  269
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 09:48:23.216866,epoch time: 0:22:15.825100,used: 1:06:21.151114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96572787, 'precision': 0.9037961, 'recall': 0.6821074, 'specificity': 0.6821074, 'f1': 0.74684924, 'auroc': 0.96492934, 'binary_precision': 0.96849436, 'binary_recall': 0.99638355, 'binary_specificity': 0.36783126, 'binary_f1_score': 0.9822411}
confusion matrix:
     0      1
0  558    959
1  107  29480
---- Validation: 
scalar performance:
{'acc': 0.61024845, 'precision': 0.74087584, 'recall': 0.6153164, 'specificity': 0.6153164, 'f1': 0.5543953, 'auroc': 0.8765118, 'binary_precision': 0.55996394, 'binary_recall': 0.9779528, 'binary_specificity': 0.25267994, 'binary_f1_score': 0.712156}
confusion matrix:
     0    1
0  165  488
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.79344606, 'recall': 0.6195521, 'specificity': 0.6195521, 'f1': 0.5791534, 'auroc': 0.90074074, 'binary_precision': 0.6232558, 'binary_recall': 0.9925926, 'binary_specificity': 0.24651162, 'binary_f1_score': 0.7657143}
confusion matrix:
    0    1
0  53  162
1   2  268
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 10:10:33.858191,epoch time: 0:22:10.641325,used: 1:28:31.792439,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9658886, 'precision': 0.9133105, 'recall': 0.6784395, 'specificity': 0.6784395, 'f1': 0.74476606, 'auroc': 0.97334003, 'binary_precision': 0.96813047, 'binary_recall': 0.99695814, 'binary_specificity': 0.3599209, 'binary_f1_score': 0.9823328}
confusion matrix:
     0      1
0  546    971
1   90  29497
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.74033904, 'recall': 0.59779215, 'specificity': 0.59779215, 'f1': 0.52439725, 'auroc': 0.88432074, 'binary_precision': 0.5482456, 'binary_recall': 0.984252, 'binary_specificity': 0.2113323, 'binary_f1_score': 0.7042253}
confusion matrix:
     0    1
0  138  515
1   10  625
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65360826, 'precision': 0.79828215, 'recall': 0.609776, 'specificity': 0.609776, 'f1': 0.562838, 'auroc': 0.90739024, 'binary_precision': 0.6169725, 'binary_recall': 0.9962963, 'binary_specificity': 0.22325581, 'binary_f1_score': 0.76203966}
confusion matrix:
    0    1
0  48  167
1   1  269
early stop counter: 1
val acc:0.592391312122345, best validation acc: 0.6102484464645386, corresponding to test acc:                         0.6618556976318359 / 0.6618556976318359
after epoch: 5,now: 2024-07-12 10:32:57.287362,epoch time: 0:22:23.429171,used: 1:50:55.221610,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96659595, 'precision': 0.91612923, 'recall': 0.68589664, 'specificity': 0.68589664, 'f1': 0.752715, 'auroc': 0.9762671, 'binary_precision': 0.96882904, 'binary_recall': 0.996958, 'binary_specificity': 0.3748353, 'binary_f1_score': 0.9826923}
confusion matrix:
     0      1
0  569    949
1   90  29496
---- Validation: 
scalar performance:
{'acc': 0.57686335, 'precision': 0.7406082, 'recall': 0.5825433, 'specificity': 0.5825433, 'f1': 0.49708226, 'auroc': 0.891886, 'binary_precision': 0.5385935, 'binary_recall': 0.98897636, 'binary_specificity': 0.17611027, 'binary_f1_score': 0.6973903}
confusion matrix:
     0    1
0  115  538
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.643299, 'precision': 0.793625, 'recall': 0.59814817, 'specificity': 0.59814817, 'f1': 0.5443635, 'auroc': 0.91479754, 'binary_precision': 0.6099773, 'binary_recall': 0.9962963, 'binary_specificity': 0.2, 'binary_f1_score': 0.75668067}
confusion matrix:
    0    1
0  43  172
1   1  269
early stop counter: 2
val acc:0.5768633484840393, best validation acc: 0.6102484464645386, corresponding to test acc:                         0.6618556976318359 / 0.6618556976318359
after epoch: 6,now: 2024-07-12 10:54:56.861051,epoch time: 0:21:59.573689,used: 2:12:54.795299,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.967046, 'precision': 0.918303, 'recall': 0.6901955, 'specificity': 0.6901955, 'f1': 0.7573359, 'auroc': 0.9788795, 'binary_precision': 0.9692439, 'binary_recall': 0.9969918, 'binary_specificity': 0.38339922, 'binary_f1_score': 0.9829221}
confusion matrix:
     0      1
0  582    936
1   89  29497
---- Validation: 
scalar performance:
{'acc': 0.5745342, 'precision': 0.74293286, 'recall': 0.5802679, 'specificity': 0.5802679, 'f1': 0.49243933, 'auroc': 0.89573264, 'binary_precision': 0.53714776, 'binary_recall': 0.9905512, 'binary_specificity': 0.16998468, 'binary_f1_score': 0.696567}
confusion matrix:
     0    1
0  111  542
1    6  629
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63092786, 'precision': 0.7761236, 'recall': 0.5846684, 'specificity': 0.5846684, 'f1': 0.5238448, 'auroc': 0.9177778, 'binary_precision': 0.6022472, 'binary_recall': 0.9925926, 'binary_specificity': 0.1767442, 'binary_f1_score': 0.7496503}
confusion matrix:
    0    1
0  38  177
1   2  268
early stop counter: 3
val acc:0.5745341777801514, best validation acc: 0.6102484464645386, corresponding to test acc:                         0.6618556976318359 / 0.6618556976318359
after epoch: 7,now: 2024-07-12 11:16:52.307793,epoch time: 0:21:55.446742,used: 2:34:50.242041,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97038966, 'precision': 0.922895, 'recall': 0.72869086, 'specificity': 0.72869086, 'f1': 0.79390466, 'auroc': 0.97852194, 'binary_precision': 0.9729721, 'binary_recall': 0.9965523, 'binary_specificity': 0.4608295, 'binary_f1_score': 0.984621}
confusion matrix:
     0      1
0  700    819
1  102  29483
---- Validation: 
scalar performance:
{'acc': 0.5869565, 'precision': 0.74640715, 'recall': 0.59249735, 'specificity': 0.59249735, 'f1': 0.513667, 'auroc': 0.896731, 'binary_precision': 0.5446661, 'binary_recall': 0.98897636, 'binary_specificity': 0.19601838, 'binary_f1_score': 0.7024608}
confusion matrix:
     0    1
0  128  525
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.643299, 'precision': 0.774242, 'recall': 0.5990956, 'specificity': 0.5990956, 'f1': 0.5487547, 'auroc': 0.9189491, 'binary_precision': 0.61098397, 'binary_recall': 0.98888886, 'binary_specificity': 0.20930232, 'binary_f1_score': 0.7553041}
confusion matrix:
    0    1
0  45  170
1   3  267
early stop counter: 4
val acc:0.5869565010070801, best validation acc: 0.6102484464645386, corresponding to test acc:                         0.6618556976318359 / 0.6618556976318359
after epoch: 8,now: 2024-07-12 11:38:44.146283,epoch time: 0:21:51.838490,used: 2:56:42.080531,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.97038966, 'precision': 0.9115578, 'recall': 0.737122, 'specificity': 0.737122, 'f1': 0.7984088, 'auroc': 0.9802798, 'binary_precision': 0.97381645, 'binary_recall': 0.9956397, 'binary_specificity': 0.47860435, 'binary_f1_score': 0.9846071}
confusion matrix:
     0      1
0  727    792
1  129  29456
---- Validation: 
scalar performance:
{'acc': 0.5908385, 'precision': 0.7485192, 'recall': 0.5963259, 'specificity': 0.5963259, 'f1': 0.51993287, 'auroc': 0.8980019, 'binary_precision': 0.5470383, 'binary_recall': 0.98897636, 'binary_specificity': 0.20367534, 'binary_f1_score': 0.7044307}
confusion matrix:
     0    1
0  133  520
1    7  628
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6597938, 'precision': 0.7769927, 'recall': 0.618174, 'specificity': 0.618174, 'f1': 0.5794378, 'auroc': 0.9200517, 'binary_precision': 0.6229508, 'binary_recall': 0.9851852, 'binary_specificity': 0.2511628, 'binary_f1_score': 0.76327115}
confusion matrix:
    0    1
0  54  161
1   4  266
early stop counter: 5
val acc:0.5908384919166565, best validation acc: 0.6102484464645386, corresponding to test acc:                         0.6618556976318359 / 0.6618556976318359
after epoch: 9,now: 2024-07-12 12:00:29.821014,epoch time: 0:21:45.674731,used: 3:18:27.755262,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_08_42_02_seed_0_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 3:18:27.755262 at 2024-07-12 12:00:29.821014
persisted model performance metric: 

scalar performance:
{'acc': 0.6618557, 'precision': 0.79344606, 'recall': 0.6195521, 'specificity': 0.6195521, 'f1': 0.5791534, 'auroc': 0.90074074, 'binary_precision': 0.6232558, 'binary_recall': 0.9925926, 'binary_specificity': 0.24651162, 'binary_f1_score': 0.7657143}
confusion matrix:
    0    1
0  53  162
1   2  268
oracle model performance metric: 

scalar performance:
{'acc': 0.6618557, 'precision': 0.79344606, 'recall': 0.6195521, 'specificity': 0.6195521, 'f1': 0.5791534, 'auroc': 0.90074074, 'binary_precision': 0.6232558, 'binary_recall': 0.9925926, 'binary_specificity': 0.24651162, 'binary_f1_score': 0.7657143}
confusion matrix:
    0    1
0  53  162
1   2  268
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190346 KiB |   2147 MiB | 390598 GiB | 390598 GiB |
|       from large pool | 173952 KiB |   2130 MiB | 385246 GiB | 385246 GiB |
|       from small pool |  16394 KiB |     32 MiB |   5351 GiB |   5351 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190346 KiB |   2147 MiB | 390598 GiB | 390598 GiB |
|       from large pool | 173952 KiB |   2130 MiB | 385246 GiB | 385246 GiB |
|       from small pool |  16394 KiB |     32 MiB |   5351 GiB |   5351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB |   2146 MiB | 390588 GiB | 390588 GiB |
|       from large pool | 172814 KiB |   2128 MiB | 385241 GiB | 385241 GiB |
|       from small pool |  16198 KiB |     32 MiB |   5346 GiB |   5346 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2916 MiB |   2916 MiB |   2916 MiB |      0 B   |
|       from large pool |   2878 MiB |   2878 MiB |   2878 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  55413 KiB | 233525 KiB | 205926 GiB | 205926 GiB |
|       from large pool |  51328 KiB | 232732 KiB | 200443 GiB | 200443 GiB |
|       from small pool |   4085 KiB |   9283 KiB |   5483 GiB |   5483 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    4351    |   52347 K  |   52347 K  |
|       from large pool |      76    |     251    |   34451 K  |   34451 K  |
|       from small pool |     724    |    4274    |   17896 K  |   17895 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    4351    |   52347 K  |   52347 K  |
|       from large pool |      76    |     251    |   34451 K  |   34451 K  |
|       from small pool |     724    |    4274    |   17896 K  |   17895 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     118    |     118    |     118    |       0    |
|       from large pool |      99    |      99    |      99    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |    1964    |   37488 K  |   37488 K  |
|       from large pool |      11    |      99    |   26423 K  |   26423 K  |
|       from small pool |      22    |    1953    |   11064 K  |   11064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 390598 GiB | 390598 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 385246 GiB | 385246 GiB |
|       from small pool |      0 KiB |     32 MiB |   5351 GiB |   5351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 390598 GiB | 390598 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 385246 GiB | 385246 GiB |
|       from small pool |      0 KiB |     32 MiB |   5351 GiB |   5351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 390588 GiB | 390588 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 385241 GiB | 385241 GiB |
|       from small pool |      0 KiB |     32 MiB |   5346 GiB |   5346 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   2916 MiB |   2916 MiB |   2676 MiB |
|       from large pool | 225280 KiB |   2878 MiB |   2878 MiB |   2658 MiB |
|       from small pool |  20480 KiB |     38 MiB |     38 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 205926 GiB | 205926 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 200443 GiB | 200443 GiB |
|       from small pool |      0 KiB |   9437 KiB |   5483 GiB |   5483 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4351    |   52347 K  |   52347 K  |
|       from large pool |       2    |     251    |   34451 K  |   34451 K  |
|       from small pool |       0    |    4274    |   17896 K  |   17896 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4351    |   52347 K  |   52347 K  |
|       from large pool |       2    |     251    |   34451 K  |   34451 K  |
|       from small pool |       0    |    4274    |   17896 K  |   17896 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     118    |      97    |
|       from large pool |      11    |      99    |      99    |      88    |
|       from small pool |      10    |      19    |      19    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1964    |   37488 K  |   37488 K  |
|       from large pool |       4    |      99    |   26423 K  |   26423 K  |
|       from small pool |       0    |    1953    |   11064 K  |   11064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB | 390598 GiB | 390598 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 385246 GiB | 385246 GiB |
|       from small pool |      0 KiB |     32 MiB |   5351 GiB |   5351 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB | 390598 GiB | 390598 GiB |
|       from large pool |  16640 KiB |   2130 MiB | 385246 GiB | 385246 GiB |
|       from small pool |      0 KiB |     32 MiB |   5351 GiB |   5351 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB | 390588 GiB | 390588 GiB |
|       from large pool |  16640 KiB |   2128 MiB | 385241 GiB | 385241 GiB |
|       from small pool |      0 KiB |     32 MiB |   5346 GiB |   5346 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   2916 MiB |   2916 MiB |   2676 MiB |
|       from large pool | 225280 KiB |   2878 MiB |   2878 MiB |   2658 MiB |
|       from small pool |  20480 KiB |     38 MiB |     38 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 205926 GiB | 205926 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 200443 GiB | 200443 GiB |
|       from small pool |      0 KiB |   9437 KiB |   5483 GiB |   5483 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4351    |   52347 K  |   52347 K  |
|       from large pool |       2    |     251    |   34451 K  |   34451 K  |
|       from small pool |       0    |    4274    |   17896 K  |   17896 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4351    |   52347 K  |   52347 K  |
|       from large pool |       2    |     251    |   34451 K  |   34451 K  |
|       from small pool |       0    |    4274    |   17896 K  |   17896 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     118    |      97    |
|       from large pool |      11    |      99    |      99    |      88    |
|       from small pool |      10    |      19    |      19    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1964    |   37488 K  |   37488 K  |
|       from large pool |       4    |      99    |   26423 K  |   26423 K  |
|       from small pool |       0    |    1953    |   11064 K  |   11064 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845

 Experiment start at: 2024-07-12 12:13:25.666388
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9514992, 'precision': 0.7649083, 'recall': 0.5082271, 'specificity': 0.5082271, 'f1': 0.50416565, 'auroc': 0.9161497, 'binary_precision': 0.95203876, 'binary_recall': 0.99936014, 'binary_specificity': 0.017094018, 'binary_f1_score': 0.97512573}
confusion matrix:
    0      1
0  26   1495
1  19  29676
---- Validation: 
scalar performance:
{'acc': 0.5800156, 'precision': 0.7263093, 'recall': 0.58648235, 'specificity': 0.58648235, 'f1': 0.5069947, 'auroc': 0.8310194, 'binary_precision': 0.5402098, 'binary_recall': 0.9809524, 'binary_specificity': 0.1920123, 'binary_f1_score': 0.6967305}
confusion matrix:
     0    1
0  125  526
1   12  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57740587, 'precision': 0.778022, 'recall': 0.5511111, 'specificity': 0.5511111, 'f1': 0.4500866, 'auroc': 0.8603426, 'binary_precision': 0.556044, 'binary_recall': 1.0, 'binary_specificity': 0.10222222, 'binary_f1_score': 0.7146893}
confusion matrix:
    0    1
0  23  202
1   0  253
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 12:35:18.892115,epoch time: 0:21:53.225727,used: 0:21:53.225727,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9564326, 'precision': 0.9106716, 'recall': 0.5622825, 'specificity': 0.5622825, 'f1': 0.5984396, 'auroc': 0.94985986, 'binary_precision': 0.95708984, 'binary_recall': 0.9989897, 'binary_specificity': 0.12557527, 'binary_f1_score': 0.97759104}
confusion matrix:
     0      1
0  191   1330
1   30  29665
---- Validation: 
scalar performance:
{'acc': 0.5909446, 'precision': 0.72580576, 'recall': 0.5971582, 'specificity': 0.5971582, 'f1': 0.5263697, 'auroc': 0.8567381, 'binary_precision': 0.547153, 'binary_recall': 0.97619045, 'binary_specificity': 0.21812595, 'binary_f1_score': 0.7012542}
confusion matrix:
     0    1
0  142  509
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6380753, 'precision': 0.7969483, 'recall': 0.6155555, 'specificity': 0.6155555, 'f1': 0.5603324, 'auroc': 0.89124286, 'binary_precision': 0.5938967, 'binary_recall': 1.0, 'binary_specificity': 0.23111111, 'binary_f1_score': 0.74521357}
confusion matrix:
    0    1
0  52  173
1   0  253
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 12:57:07.122963,epoch time: 0:21:48.230848,used: 0:43:41.456575,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.961398, 'precision': 0.91424054, 'recall': 0.62196887, 'specificity': 0.62196887, 'f1': 0.6815381, 'auroc': 0.96305645, 'binary_precision': 0.96274036, 'binary_recall': 0.9980468, 'binary_specificity': 0.24589086, 'binary_f1_score': 0.9800757}
confusion matrix:
     0      1
0  374   1147
1   58  29637
---- Validation: 
scalar performance:
{'acc': 0.5932865, 'precision': 0.7274337, 'recall': 0.59946233, 'specificity': 0.59946233, 'f1': 0.53001946, 'auroc': 0.8715651, 'binary_precision': 0.5486173, 'binary_recall': 0.97619045, 'binary_specificity': 0.22273426, 'binary_f1_score': 0.7024557}
confusion matrix:
     0    1
0  145  506
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6527197, 'precision': 0.8019093, 'recall': 0.63111115, 'specificity': 0.63111115, 'f1': 0.58423454, 'auroc': 0.90775585, 'binary_precision': 0.6038186, 'binary_recall': 1.0, 'binary_specificity': 0.26222223, 'binary_f1_score': 0.7529761}
confusion matrix:
    0    1
0  59  166
1   0  253
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 13:18:54.486892,epoch time: 0:21:47.363929,used: 1:05:28.820504,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.96309584, 'precision': 0.9186396, 'recall': 0.64095104, 'specificity': 0.64095104, 'f1': 0.70475185, 'auroc': 0.9707426, 'binary_precision': 0.9645519, 'binary_recall': 0.99787843, 'binary_specificity': 0.28402367, 'binary_f1_score': 0.98093224}
confusion matrix:
     0      1
0  432   1089
1   63  29632
---- Validation: 
scalar performance:
{'acc': 0.61202186, 'precision': 0.7373545, 'recall': 0.61787, 'specificity': 0.61787, 'f1': 0.55904835, 'auroc': 0.87872136, 'binary_precision': 0.5607306, 'binary_recall': 0.9746032, 'binary_specificity': 0.2611367, 'binary_f1_score': 0.711884}
confusion matrix:
     0    1
0  170  481
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.79713005, 'recall': 0.65604746, 'specificity': 0.65604746, 'f1': 0.6228422, 'auroc': 0.9157488, 'binary_precision': 0.6212871, 'binary_recall': 0.9920949, 'binary_specificity': 0.32, 'binary_f1_score': 0.7640791}
confusion matrix:
    0    1
0  72  153
1   2  251
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 13:40:44.228358,epoch time: 0:21:49.741466,used: 1:27:18.561970,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9659149, 'precision': 0.92389864, 'recall': 0.67268646, 'specificity': 0.67268646, 'f1': 0.740472, 'auroc': 0.975863, 'binary_precision': 0.9675976, 'binary_recall': 0.99757534, 'binary_specificity': 0.3477975, 'binary_f1_score': 0.9823578}
confusion matrix:
     0      1
0  529    992
1   72  29623
---- Validation: 
scalar performance:
{'acc': 0.59562844, 'precision': 0.7290324, 'recall': 0.60176647, 'specificity': 0.60176647, 'f1': 0.5336488, 'auroc': 0.8873796, 'binary_precision': 0.5500894, 'binary_recall': 0.97619045, 'binary_specificity': 0.22734255, 'binary_f1_score': 0.70366126}
confusion matrix:
     0    1
0  148  503
1   15  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6799163, 'precision': 0.81157637, 'recall': 0.65999997, 'specificity': 0.65999997, 'f1': 0.6263393, 'auroc': 0.92175674, 'binary_precision': 0.62315273, 'binary_recall': 1.0, 'binary_specificity': 0.32, 'binary_f1_score': 0.7678301}
confusion matrix:
    0    1
0  72  153
1   0  253
new oracle model saved
early stop counter: 1
val acc:0.5956284403800964, best validation acc: 0.6120218634605408, corresponding to test acc:                         0.6757321953773499 / 0.6799163222312927
after epoch: 5,now: 2024-07-12 14:03:12.011647,epoch time: 0:22:27.783289,used: 1:49:46.345259,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.96505, 'precision': 0.9486586, 'recall': 0.65195876, 'specificity': 0.65195876, 'f1': 0.7207872, 'auroc': 0.9764194, 'binary_precision': 0.9655902, 'binary_recall': 0.99885505, 'binary_specificity': 0.30506247, 'binary_f1_score': 0.981941}
confusion matrix:
     0      1
0  464   1057
1   34  29661
---- Validation: 
scalar performance:
{'acc': 0.55971897, 'precision': 0.7066046, 'recall': 0.56648743, 'specificity': 0.56648743, 'f1': 0.47404912, 'auroc': 0.88977396, 'binary_precision': 0.52825344, 'binary_recall': 0.97936505, 'binary_specificity': 0.15360983, 'binary_f1_score': 0.68631816}
confusion matrix:
     0    1
0  100  551
1   13  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6297071, 'precision': 0.79418606, 'recall': 0.6066667, 'specificity': 0.6066667, 'f1': 0.5462488, 'auroc': 0.92400527, 'binary_precision': 0.5883721, 'binary_recall': 1.0, 'binary_specificity': 0.21333334, 'binary_f1_score': 0.7408492}
confusion matrix:
    0    1
0  48  177
1   0  253
early stop counter: 2
val acc:0.5597189664840698, best validation acc: 0.6120218634605408, corresponding to test acc:                         0.6757321953773499 / 0.6799163222312927
after epoch: 6,now: 2024-07-12 14:25:36.317100,epoch time: 0:22:24.305453,used: 2:12:10.650712,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9709764, 'precision': 0.9167986, 'recall': 0.7394269, 'specificity': 0.7394269, 'f1': 0.80164015, 'auroc': 0.9793395, 'binary_precision': 0.9741124, 'binary_recall': 0.99595904, 'binary_specificity': 0.48289475, 'binary_f1_score': 0.9849146}
confusion matrix:
     0      1
0  734    786
1  120  29576
---- Validation: 
scalar performance:
{'acc': 0.62607336, 'precision': 0.7400093, 'recall': 0.631618, 'specificity': 0.631618, 'f1': 0.58103555, 'auroc': 0.88998854, 'binary_precision': 0.5704949, 'binary_recall': 0.96984124, 'binary_specificity': 0.29339477, 'binary_f1_score': 0.71840096}
confusion matrix:
     0    1
0  191  460
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6903766, 'precision': 0.78839993, 'recall': 0.67234075, 'specificity': 0.67234075, 'f1': 0.6479137, 'auroc': 0.92428637, 'binary_precision': 0.6342711, 'binary_recall': 0.9802371, 'binary_specificity': 0.36444443, 'binary_f1_score': 0.7701863}
confusion matrix:
    0    1
0  82  143
1   5  248
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 14:47:36.991587,epoch time: 0:22:00.674487,used: 2:34:11.325199,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97113657, 'precision': 0.9275758, 'recall': 0.73358095, 'specificity': 0.73358095, 'f1': 0.7992396, 'auroc': 0.982013, 'binary_precision': 0.9735241, 'binary_recall': 0.9967672, 'binary_specificity': 0.47039473, 'binary_f1_score': 0.98500854}
confusion matrix:
     0      1
0  715    805
1   96  29600
---- Validation: 
scalar performance:
{'acc': 0.6229508, 'precision': 0.7419801, 'recall': 0.628597, 'specificity': 0.628597, 'f1': 0.57557094, 'auroc': 0.8923836, 'binary_precision': 0.56811863, 'binary_recall': 0.97301584, 'binary_specificity': 0.2841782, 'binary_f1_score': 0.7173786}
confusion matrix:
     0    1
0  185  466
1   17  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6903766, 'precision': 0.78839993, 'recall': 0.67234075, 'specificity': 0.67234075, 'f1': 0.6479137, 'auroc': 0.92602545, 'binary_precision': 0.6342711, 'binary_recall': 0.9802371, 'binary_specificity': 0.36444443, 'binary_f1_score': 0.7701863}
confusion matrix:
    0    1
0  82  143
1   5  248
early stop counter: 1
val acc:0.6229507923126221, best validation acc: 0.6260733604431152, corresponding to test acc:                         0.6903765797615051 / 0.6903765797615051
after epoch: 8,now: 2024-07-12 15:09:36.305597,epoch time: 0:21:59.314010,used: 2:56:10.639209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.971553, 'precision': 0.9209722, 'recall': 0.7434753, 'specificity': 0.7434753, 'f1': 0.8060518, 'auroc': 0.9824139, 'binary_precision': 0.97450256, 'binary_recall': 0.9961611, 'binary_specificity': 0.49078947, 'binary_f1_score': 0.9852128}
confusion matrix:
     0      1
0  746    774
1  114  29582
---- Validation: 
scalar performance:
{'acc': 0.6159251, 'precision': 0.7376681, 'recall': 0.62168455, 'specificity': 0.62168455, 'f1': 0.56534106, 'auroc': 0.8928584, 'binary_precision': 0.5634191, 'binary_recall': 0.97301584, 'binary_specificity': 0.27035332, 'binary_f1_score': 0.7136205}
confusion matrix:
     0    1
0  176  475
1   17  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68619245, 'precision': 0.78610986, 'recall': 0.66789633, 'specificity': 0.66789633, 'f1': 0.64196545, 'auroc': 0.92604303, 'binary_precision': 0.63104326, 'binary_recall': 0.9802371, 'binary_specificity': 0.35555556, 'binary_f1_score': 0.7678019}
confusion matrix:
    0    1
0  80  145
1   5  248
early stop counter: 2
val acc:0.6159250736236572, best validation acc: 0.6260733604431152, corresponding to test acc:                         0.6903765797615051 / 0.6903765797615051
after epoch: 9,now: 2024-07-12 15:31:37.703207,epoch time: 0:22:01.397610,used: 3:18:12.036819,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9698232, 'precision': 0.9281977, 'recall': 0.71747, 'specificity': 0.71747, 'f1': 0.7850466, 'auroc': 0.98254985, 'binary_precision': 0.9719332, 'binary_recall': 0.9970702, 'binary_specificity': 0.43786982, 'binary_f1_score': 0.9843412}
confusion matrix:
     0      1
0  666    855
1   87  29608
---- Validation: 
scalar performance:
{'acc': 0.5925059, 'precision': 0.7244177, 'recall': 0.5986687, 'specificity': 0.5986687, 'f1': 0.5294286, 'auroc': 0.89331436, 'binary_precision': 0.54821426, 'binary_recall': 0.9746032, 'binary_specificity': 0.22273426, 'binary_f1_score': 0.7017143}
confusion matrix:
     0    1
0  145  506
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66945606, 'precision': 0.7942693, 'recall': 0.6493808, 'specificity': 0.6493808, 'f1': 0.6134111, 'auroc': 0.92657006, 'binary_precision': 0.6167076, 'binary_recall': 0.9920949, 'binary_specificity': 0.30666667, 'binary_f1_score': 0.76060605}
confusion matrix:
    0    1
0  69  156
1   2  251
early stop counter: 3
val acc:0.5925058722496033, best validation acc: 0.6260733604431152, corresponding to test acc:                         0.6903765797615051 / 0.6903765797615051
after epoch: 10,now: 2024-07-12 15:53:42.455609,epoch time: 0:22:04.752402,used: 3:40:16.789221,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97164917, 'precision': 0.9360323, 'recall': 0.7343363, 'specificity': 0.7343363, 'f1': 0.80182385, 'auroc': 0.98452115, 'binary_precision': 0.97356826, 'binary_recall': 0.99727225, 'binary_specificity': 0.47140038, 'binary_f1_score': 0.9852778}
confusion matrix:
     0      1
0  717    804
1   81  29614
---- Validation: 
scalar performance:
{'acc': 0.5909446, 'precision': 0.7233041, 'recall': 0.5971326, 'specificity': 0.5971326, 'f1': 0.52699983, 'auroc': 0.8940141, 'binary_precision': 0.5472371, 'binary_recall': 0.9746032, 'binary_specificity': 0.21966206, 'binary_f1_score': 0.70091325}
confusion matrix:
     0    1
0  143  508
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6715481, 'precision': 0.7952244, 'recall': 0.651603, 'specificity': 0.651603, 'f1': 0.61657035, 'auroc': 0.92604303, 'binary_precision': 0.6182266, 'binary_recall': 0.9920949, 'binary_specificity': 0.31111112, 'binary_f1_score': 0.7617602}
confusion matrix:
    0    1
0  70  155
1   2  251
early stop counter: 4
val acc:0.5909445881843567, best validation acc: 0.6260733604431152, corresponding to test acc:                         0.6903765797615051 / 0.6903765797615051
after epoch: 11,now: 2024-07-12 16:15:46.790333,epoch time: 0:22:04.334724,used: 4:02:21.123945,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9746284, 'precision': 0.9239776, 'recall': 0.7794238, 'specificity': 0.7794238, 'f1': 0.83524513, 'auroc': 0.98511624, 'binary_precision': 0.9780365, 'binary_recall': 0.99568963, 'binary_specificity': 0.5631579, 'binary_f1_score': 0.9867841}
confusion matrix:
     0      1
0  856    664
1  128  29568
---- Validation: 
scalar performance:
{'acc': 0.6291959, 'precision': 0.7419243, 'recall': 0.6346902, 'specificity': 0.6346902, 'f1': 0.5854807, 'auroc': 0.89365566, 'binary_precision': 0.57263356, 'binary_recall': 0.96984124, 'binary_specificity': 0.29953918, 'binary_f1_score': 0.7200943}
confusion matrix:
     0    1
0  195  456
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6882845, 'precision': 0.7738793, 'recall': 0.67085636, 'specificity': 0.67085636, 'f1': 0.6483958, 'auroc': 0.9255512, 'binary_precision': 0.634715, 'binary_recall': 0.96837944, 'binary_specificity': 0.37333333, 'binary_f1_score': 0.7668232}
confusion matrix:
    0    1
0  84  141
1   8  245
better model found
persisted
after epoch: 12,now: 2024-07-12 16:38:01.617568,epoch time: 0:22:14.827235,used: 4:24:35.951180,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9748206, 'precision': 0.9288224, 'recall': 0.77750707, 'specificity': 0.77750707, 'f1': 0.8352317, 'auroc': 0.98476136, 'binary_precision': 0.977852, 'binary_recall': 0.99609387, 'binary_specificity': 0.5589203, 'binary_f1_score': 0.9868886}
confusion matrix:
     0      1
0  849    670
1  116  29581
---- Validation: 
scalar performance:
{'acc': 0.62373143, 'precision': 0.7404842, 'recall': 0.62933946, 'specificity': 0.62933946, 'f1': 0.5771918, 'auroc': 0.8951918, 'binary_precision': 0.5687732, 'binary_recall': 0.9714286, 'binary_specificity': 0.28725037, 'binary_f1_score': 0.7174677}
confusion matrix:
     0    1
0  187  464
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6820084, 'precision': 0.76996624, 'recall': 0.6641897, 'specificity': 0.6641897, 'f1': 0.63958174, 'auroc': 0.9269389, 'binary_precision': 0.62982005, 'binary_recall': 0.96837944, 'binary_specificity': 0.36, 'binary_f1_score': 0.76323986}
confusion matrix:
    0    1
0  81  144
1   8  245
early stop counter: 1
val acc:0.6237314343452454, best validation acc: 0.6291959285736084, corresponding to test acc:                         0.6882845163345337 / 0.6903765797615051
after epoch: 13,now: 2024-07-12 17:00:08.699951,epoch time: 0:22:07.082383,used: 4:46:43.033563,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.97414786, 'precision': 0.9307934, 'recall': 0.76808655, 'specificity': 0.76808655, 'f1': 0.82851195, 'auroc': 0.9856798, 'binary_precision': 0.97688854, 'binary_recall': 0.9963967, 'binary_specificity': 0.53977644, 'binary_f1_score': 0.9865462}
confusion matrix:
     0      1
0  821    700
1  107  29588
---- Validation: 
scalar performance:
{'acc': 0.62217015, 'precision': 0.739524, 'recall': 0.6278034, 'specificity': 0.6278034, 'f1': 0.57494146, 'auroc': 0.89503574, 'binary_precision': 0.56771797, 'binary_recall': 0.9714286, 'binary_specificity': 0.2841782, 'binary_f1_score': 0.7166276}
confusion matrix:
     0    1
0  185  466
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68619245, 'precision': 0.77686954, 'recall': 0.66838825, 'specificity': 0.66838825, 'f1': 0.64432406, 'auroc': 0.9264647, 'binary_precision': 0.63239074, 'binary_recall': 0.972332, 'binary_specificity': 0.36444443, 'binary_f1_score': 0.7663551}
confusion matrix:
    0    1
0  82  143
1   7  246
early stop counter: 2
val acc:0.6221701502799988, best validation acc: 0.6291959285736084, corresponding to test acc:                         0.6882845163345337 / 0.6903765797615051
after epoch: 14,now: 2024-07-12 17:22:24.598869,epoch time: 0:22:15.898918,used: 5:08:58.932481,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9755254, 'precision': 0.9255895, 'recall': 0.7893956, 'specificity': 0.7893956, 'f1': 0.84310985, 'auroc': 0.98650694, 'binary_precision': 0.97900593, 'binary_recall': 0.99562216, 'binary_specificity': 0.583169, 'binary_f1_score': 0.9872441}
confusion matrix:
     0      1
0  887    634
1  130  29565
---- Validation: 
scalar performance:
{'acc': 0.6455894, 'precision': 0.7516395, 'recall': 0.65081924, 'specificity': 0.65081924, 'f1': 0.6083508, 'auroc': 0.89578915, 'binary_precision': 0.58413005, 'binary_recall': 0.96984124, 'binary_specificity': 0.33179724, 'binary_f1_score': 0.729117}
confusion matrix:
     0    1
0  216  435
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70920503, 'precision': 0.7794431, 'recall': 0.6935705, 'specificity': 0.6935705, 'f1': 0.6788302, 'auroc': 0.9260957, 'binary_precision': 0.6532258, 'binary_recall': 0.9604743, 'binary_specificity': 0.42666668, 'binary_f1_score': 0.7776}
confusion matrix:
    0    1
0  96  129
1  10  243
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 17:44:35.659302,epoch time: 0:22:11.060433,used: 5:31:09.992914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9739557, 'precision': 0.92488384, 'recall': 0.7704807, 'specificity': 0.7704807, 'f1': 0.82871234, 'auroc': 0.98562825, 'binary_precision': 0.9771361, 'binary_recall': 0.99592525, 'binary_specificity': 0.54503614, 'binary_f1_score': 0.9864412}
confusion matrix:
     0      1
0  829    692
1  121  29574
---- Validation: 
scalar performance:
{'acc': 0.6245121, 'precision': 0.73904264, 'recall': 0.6300819, 'specificity': 0.6300819, 'f1': 0.5788019, 'auroc': 0.8969351, 'binary_precision': 0.5694315, 'binary_recall': 0.96984124, 'binary_specificity': 0.29032257, 'binary_f1_score': 0.7175572}
confusion matrix:
     0    1
0  189  462
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6841004, 'precision': 0.7756119, 'recall': 0.666166, 'specificity': 0.666166, 'f1': 0.64136755, 'auroc': 0.9270444, 'binary_precision': 0.63076925, 'binary_recall': 0.972332, 'binary_specificity': 0.36, 'binary_f1_score': 0.7651633}
confusion matrix:
    0    1
0  81  144
1   7  246
early stop counter: 1
val acc:0.6245120763778687, best validation acc: 0.6455894112586975, corresponding to test acc:                         0.7092050313949585 / 0.7092050313949585
after epoch: 16,now: 2024-07-12 18:06:57.077393,epoch time: 0:22:21.418091,used: 5:53:31.411005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9764544, 'precision': 0.9309783, 'recall': 0.7961217, 'specificity': 0.7961217, 'f1': 0.8496889, 'auroc': 0.9876512, 'binary_precision': 0.9796608, 'binary_recall': 0.99592525, 'binary_specificity': 0.5963182, 'binary_f1_score': 0.98772603}
confusion matrix:
     0      1
0  907    614
1  121  29574
---- Validation: 
scalar performance:
{'acc': 0.6346604, 'precision': 0.74522114, 'recall': 0.64006656, 'specificity': 0.64006656, 'f1': 0.59318984, 'auroc': 0.89484066, 'binary_precision': 0.5764151, 'binary_recall': 0.96984124, 'binary_specificity': 0.31029186, 'binary_f1_score': 0.72307694}
confusion matrix:
     0    1
0  202  449
1   19  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70083684, 'precision': 0.7777513, 'recall': 0.68443567, 'specificity': 0.68443567, 'f1': 0.6666877, 'auroc': 0.9247079, 'binary_precision': 0.6455026, 'binary_recall': 0.9644269, 'binary_specificity': 0.40444446, 'binary_f1_score': 0.7733755}
confusion matrix:
    0    1
0  91  134
1   9  244
early stop counter: 2
val acc:0.6346604228019714, best validation acc: 0.6455894112586975, corresponding to test acc:                         0.7092050313949585 / 0.7092050313949585
after epoch: 17,now: 2024-07-12 18:29:28.847539,epoch time: 0:22:31.770146,used: 6:16:03.181151,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.975205, 'precision': 0.92657363, 'recall': 0.78454876, 'specificity': 0.78454876, 'f1': 0.8398473, 'auroc': 0.9868334, 'binary_precision': 0.97852343, 'binary_recall': 0.99579054, 'binary_specificity': 0.57330704, 'binary_f1_score': 0.98708147}
confusion matrix:
     0      1
0  872    649
1  125  29570
---- Validation: 
scalar performance:
{'acc': 0.61202186, 'precision': 0.7331082, 'recall': 0.6178187, 'specificity': 0.6178187, 'f1': 0.5601257, 'auroc': 0.89656687, 'binary_precision': 0.56095326, 'binary_recall': 0.9714286, 'binary_specificity': 0.2642089, 'binary_f1_score': 0.7112145}
confusion matrix:
     0    1
0  172  479
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6820084, 'precision': 0.7789552, 'recall': 0.66369784, 'specificity': 0.66369784, 'f1': 0.63719165, 'auroc': 0.92602545, 'binary_precision': 0.62849873, 'binary_recall': 0.97628456, 'binary_specificity': 0.3511111, 'binary_f1_score': 0.7647059}
confusion matrix:
    0    1
0  79  146
1   6  247
early stop counter: 3
val acc:0.6120218634605408, best validation acc: 0.6455894112586975, corresponding to test acc:                         0.7092050313949585 / 0.7092050313949585
after epoch: 18,now: 2024-07-12 18:51:54.795380,epoch time: 0:22:25.947841,used: 6:38:29.128992,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.97770375, 'precision': 0.9383341, 'recall': 0.8047605, 'specificity': 0.8047605, 'f1': 0.8582501, 'auroc': 0.98713565, 'binary_precision': 0.9805143, 'binary_recall': 0.99636316, 'binary_specificity': 0.61315787, 'binary_f1_score': 0.9883752}
confusion matrix:
     0      1
0  932    588
1  108  29588
---- Validation: 
scalar performance:
{'acc': 0.62373143, 'precision': 0.7404842, 'recall': 0.62933946, 'specificity': 0.62933946, 'f1': 0.5771918, 'auroc': 0.8965621, 'binary_precision': 0.5687732, 'binary_recall': 0.9714286, 'binary_specificity': 0.28725037, 'binary_f1_score': 0.7174677}
confusion matrix:
     0    1
0  187  464
1   18  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68619245, 'precision': 0.77686954, 'recall': 0.66838825, 'specificity': 0.66838825, 'f1': 0.64432406, 'auroc': 0.9256214, 'binary_precision': 0.63239074, 'binary_recall': 0.972332, 'binary_specificity': 0.36444443, 'binary_f1_score': 0.7663551}
confusion matrix:
    0    1
0  82  143
1   7  246
early stop counter: 4
val acc:0.6237314343452454, best validation acc: 0.6455894112586975, corresponding to test acc:                         0.7092050313949585 / 0.7092050313949585
after epoch: 19,now: 2024-07-12 19:14:08.159112,epoch time: 0:22:13.363732,used: 7:00:42.492724,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9748847, 'precision': 0.9369735, 'recall': 0.77221656, 'specificity': 0.77221656, 'f1': 0.83346474, 'auroc': 0.98801154, 'binary_precision': 0.97728395, 'binary_recall': 0.9967671, 'binary_specificity': 0.547666, 'binary_f1_score': 0.9869294}
confusion matrix:
     0      1
0  833    688
1   96  29599
---- Validation: 
scalar performance:
{'acc': 0.59406716, 'precision': 0.72551775, 'recall': 0.6002048, 'specificity': 0.6002048, 'f1': 0.53184825, 'auroc': 0.89609635, 'binary_precision': 0.549195, 'binary_recall': 0.9746032, 'binary_specificity': 0.22580644, 'binary_f1_score': 0.70251715}
confusion matrix:
     0    1
0  147  504
1   16  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66317993, 'precision': 0.7788725, 'recall': 0.643206, 'specificity': 0.643206, 'f1': 0.60680145, 'auroc': 0.9261484, 'binary_precision': 0.6133005, 'binary_recall': 0.98418975, 'binary_specificity': 0.30222222, 'binary_f1_score': 0.75569046}
confusion matrix:
    0    1
0  68  157
1   4  249
early stop counter: 5
val acc:0.5940671563148499, best validation acc: 0.6455894112586975, corresponding to test acc:                         0.7092050313949585 / 0.7092050313949585
after epoch: 20,now: 2024-07-12 19:36:22.655944,epoch time: 0:22:14.496832,used: 7:22:56.989556,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_12_13_25_seed_1_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 20 with time: 7:22:56.989556 at 2024-07-12 19:36:22.655944
persisted model performance metric: 

scalar performance:
{'acc': 0.70920503, 'precision': 0.7794431, 'recall': 0.6935705, 'specificity': 0.6935705, 'f1': 0.6788302, 'auroc': 0.9260957, 'binary_precision': 0.6532258, 'binary_recall': 0.9604743, 'binary_specificity': 0.42666668, 'binary_f1_score': 0.7776}
confusion matrix:
    0    1
0  96  129
1  10  243
oracle model performance metric: 

scalar performance:
{'acc': 0.70920503, 'precision': 0.7794431, 'recall': 0.6935705, 'specificity': 0.6935705, 'f1': 0.6788302, 'auroc': 0.9260957, 'binary_precision': 0.6532258, 'binary_recall': 0.9604743, 'binary_specificity': 0.42666668, 'binary_f1_score': 0.7776}
confusion matrix:
    0    1
0  96  129
1  10  243
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189845 KiB |   2147 MiB |   1225 TiB |   1225 TiB |
|       from large pool | 173454 KiB |   2130 MiB |   1209 TiB |   1209 TiB |
|       from small pool |  16391 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 189845 KiB |   2147 MiB |   1225 TiB |   1225 TiB |
|       from large pool | 173454 KiB |   2130 MiB |   1209 TiB |   1209 TiB |
|       from small pool |  16391 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB |   2146 MiB |   1225 TiB |   1225 TiB |
|       from large pool | 172814 KiB |   2128 MiB |   1209 TiB |   1209 TiB |
|       from small pool |  16198 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2894 MiB |   2916 MiB |   5570 MiB |   2676 MiB |
|       from large pool |   2856 MiB |   2878 MiB |   5514 MiB |   2658 MiB |
|       from small pool |     38 MiB |     38 MiB |     56 MiB |     18 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37482 KiB | 233525 KiB | 650767 GiB | 650767 GiB |
|       from large pool |  31346 KiB | 232732 KiB | 633188 GiB | 633188 GiB |
|       from small pool |   6136 KiB |   9437 KiB |  17579 GiB |  17579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4365    |  168157 K  |  168156 K  |
|       from large pool |      76    |     251    |  110659 K  |  110659 K  |
|       from small pool |     718    |    4288    |   57498 K  |   57497 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4365    |  168157 K  |  168156 K  |
|       from large pool |      76    |     251    |  110659 K  |  110659 K  |
|       from small pool |     718    |    4288    |   57498 K  |   57497 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     116    |     118    |     213    |      97    |
|       from large pool |      97    |      99    |     185    |      88    |
|       from small pool |      19    |      19    |      28    |       9    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |    1969    |  116105 K  |  116105 K  |
|       from large pool |      10    |      99    |   81246 K  |   81246 K  |
|       from small pool |      26    |    1959    |   34858 K  |   34858 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   1225 TiB |   1225 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1209 TiB |   1209 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   1225 TiB |   1225 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1209 TiB |   1209 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   1225 TiB |   1225 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1209 TiB |   1209 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2916 MiB |   5570 MiB |   5348 MiB |
|       from large pool | 204800 KiB |   2878 MiB |   5514 MiB |   5314 MiB |
|       from small pool |  22528 KiB |     38 MiB |     56 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 650768 GiB | 650767 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 633188 GiB | 633188 GiB |
|       from small pool |      0 KiB |  10022 KiB |  17579 GiB |  17579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4365    |  168157 K  |  168157 K  |
|       from large pool |       2    |     251    |  110659 K  |  110659 K  |
|       from small pool |       0    |    4288    |   57498 K  |   57498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4365    |  168157 K  |  168157 K  |
|       from large pool |       2    |     251    |  110659 K  |  110659 K  |
|       from small pool |       0    |    4288    |   57498 K  |   57498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     213    |     192    |
|       from large pool |      10    |      99    |     185    |     175    |
|       from small pool |      11    |      19    |      28    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1969    |  116105 K  |  116105 K  |
|       from large pool |       4    |      99    |   81246 K  |   81246 K  |
|       from small pool |       0    |    1959    |   34858 K  |   34858 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   1225 TiB |   1225 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1209 TiB |   1209 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   1225 TiB |   1225 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1209 TiB |   1209 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   1225 TiB |   1225 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1209 TiB |   1209 TiB |
|       from small pool |      0 KiB |     32 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB |   2916 MiB |   5570 MiB |   5348 MiB |
|       from large pool | 204800 KiB |   2878 MiB |   5514 MiB |   5314 MiB |
|       from small pool |  22528 KiB |     38 MiB |     56 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB | 650768 GiB | 650767 GiB |
|       from large pool |  24320 KiB | 232732 KiB | 633188 GiB | 633188 GiB |
|       from small pool |      0 KiB |  10022 KiB |  17579 GiB |  17579 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4365    |  168157 K  |  168157 K  |
|       from large pool |       2    |     251    |  110659 K  |  110659 K  |
|       from small pool |       0    |    4288    |   57498 K  |   57498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4365    |  168157 K  |  168157 K  |
|       from large pool |       2    |     251    |  110659 K  |  110659 K  |
|       from small pool |       0    |    4288    |   57498 K  |   57498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |     118    |     213    |     192    |
|       from large pool |      10    |      99    |     185    |     175    |
|       from small pool |      11    |      19    |      28    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1969    |  116105 K  |  116105 K  |
|       from large pool |       4    |      99    |   81246 K  |   81246 K  |
|       from small pool |       0    |    1959    |   34858 K  |   34858 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845

 Experiment start at: 2024-07-12 19:50:14.086026
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9522884, 'precision': 0.889995, 'recall': 0.5078319, 'specificity': 0.5078319, 'f1': 0.50330496, 'auroc': 0.90189564, 'binary_precision': 0.9524037, 'binary_recall': 0.9998326, 'binary_specificity': 0.015831135, 'binary_f1_score': 0.975542}
confusion matrix:
    0      1
0  24   1492
1   5  29855
---- Validation: 
scalar performance:
{'acc': 0.48982784, 'precision': 0.6607704, 'recall': 0.5030071, 'specificity': 0.5030071, 'f1': 0.33543038, 'auroc': 0.8143871, 'binary_precision': 0.48820755, 'binary_recall': 0.9983923, 'binary_specificity': 0.0076219514, 'binary_f1_score': 0.65575504}
confusion matrix:
   0    1
0  5  651
1  1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.67084944, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 20:12:40.474999,epoch time: 0:22:26.388973,used: 0:22:26.388973,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9561767, 'precision': 0.94180113, 'recall': 0.55026084, 'specificity': 0.55026084, 'f1': 0.5797599, 'auroc': 0.9464817, 'binary_precision': 0.9563295, 'binary_recall': 0.99959815, 'binary_specificity': 0.100923486, 'binary_f1_score': 0.97748524}
confusion matrix:
     0      1
0  153   1363
1   12  29848
---- Validation: 
scalar performance:
{'acc': 0.51877934, 'precision': 0.7106076, 'recall': 0.53108335, 'specificity': 0.53108335, 'f1': 0.39770335, 'auroc': 0.8403115, 'binary_precision': 0.50284785, 'binary_recall': 0.99356914, 'binary_specificity': 0.06859756, 'binary_f1_score': 0.66774714}
confusion matrix:
    0    1
0  45  611
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55368423, 'precision': 0.7749469, 'recall': 0.5092593, 'specificity': 0.5092593, 'f1': 0.37297636, 'auroc': 0.8047333, 'binary_precision': 0.54989386, 'binary_recall': 1.0, 'binary_specificity': 0.018518519, 'binary_f1_score': 0.70958906}
confusion matrix:
   0    1
0  4  212
1  0  259
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-12 20:36:01.745290,epoch time: 0:23:21.270291,used: 0:45:47.659264,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9572603, 'precision': 0.932292, 'recall': 0.5639791, 'specificity': 0.5639791, 'f1': 0.6016636, 'auroc': 0.95982814, 'binary_precision': 0.95760727, 'binary_recall': 0.9993302, 'binary_specificity': 0.12862797, 'binary_f1_score': 0.9780239}
confusion matrix:
     0      1
0  195   1321
1   20  29840
---- Validation: 
scalar performance:
{'acc': 0.5508607, 'precision': 0.7378788, 'recall': 0.56233335, 'specificity': 0.56233335, 'f1': 0.45671794, 'auroc': 0.8554231, 'binary_precision': 0.52020204, 'binary_recall': 0.99356914, 'binary_specificity': 0.13109756, 'binary_f1_score': 0.6828729}
confusion matrix:
    0    1
0  86  570
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58947366, 'precision': 0.7852423, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.45186144, 'auroc': 0.85614187, 'binary_precision': 0.5704846, 'binary_recall': 1.0, 'binary_specificity': 0.097222224, 'binary_f1_score': 0.72650766}
confusion matrix:
    0    1
0  21  195
1   0  259
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 20:59:54.804687,epoch time: 0:23:53.059397,used: 1:09:40.718661,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9631566, 'precision': 0.9056411, 'recall': 0.64377916, 'specificity': 0.64377916, 'f1': 0.7065903, 'auroc': 0.9643434, 'binary_precision': 0.96512836, 'binary_recall': 0.99732083, 'binary_specificity': 0.29023746, 'binary_f1_score': 0.98096055}
confusion matrix:
     0      1
0  440   1076
1   80  29780
---- Validation: 
scalar performance:
{'acc': 0.599374, 'precision': 0.72724724, 'recall': 0.60904783, 'specificity': 0.60904783, 'f1': 0.54438126, 'auroc': 0.8621701, 'binary_precision': 0.55, 'binary_recall': 0.9726688, 'binary_specificity': 0.24542683, 'binary_f1_score': 0.7026713}
confusion matrix:
     0    1
0  161  495
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6294737, 'precision': 0.7977011, 'recall': 0.5925926, 'specificity': 0.5925926, 'f1': 0.52944887, 'auroc': 0.880291, 'binary_precision': 0.5954023, 'binary_recall': 1.0, 'binary_specificity': 0.18518518, 'binary_f1_score': 0.74639773}
confusion matrix:
    0    1
0  40  176
1   0  259
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 21:23:41.601877,epoch time: 0:23:46.797190,used: 1:33:27.515851,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9642083, 'precision': 0.9058732, 'recall': 0.6571676, 'specificity': 0.6571676, 'f1': 0.72143996, 'auroc': 0.9696311, 'binary_precision': 0.9664037, 'binary_recall': 0.9970529, 'binary_specificity': 0.31728232, 'binary_f1_score': 0.9814891}
confusion matrix:
     0      1
0  481   1035
1   88  29772
---- Validation: 
scalar performance:
{'acc': 0.5938967, 'precision': 0.7384204, 'recall': 0.6039624, 'specificity': 0.6039624, 'f1': 0.5325428, 'auroc': 0.87223554, 'binary_precision': 0.54602325, 'binary_recall': 0.9823151, 'binary_specificity': 0.22560975, 'binary_f1_score': 0.7018954}
confusion matrix:
     0    1
0  148  508
1   11  611
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6210526, 'precision': 0.79498863, 'recall': 0.5833333, 'specificity': 0.5833333, 'f1': 0.5139173, 'auroc': 0.8952881, 'binary_precision': 0.5899772, 'binary_recall': 1.0, 'binary_specificity': 0.16666667, 'binary_f1_score': 0.7421203}
confusion matrix:
    0    1
0  36  180
1   0  259
early stop counter: 1
val acc:0.5938966870307922, best validation acc: 0.599373996257782, corresponding to test acc:                         0.6294736862182617 / 0.6294736862182617
after epoch: 5,now: 2024-07-12 21:47:01.993935,epoch time: 0:23:20.392058,used: 1:56:47.907909,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9670767, 'precision': 0.9189383, 'recall': 0.6862249, 'specificity': 0.6862249, 'f1': 0.75356543, 'auroc': 0.9751942, 'binary_precision': 0.9691742, 'binary_recall': 0.9971199, 'binary_specificity': 0.37532982, 'binary_f1_score': 0.98294854}
confusion matrix:
     0      1
0  569    947
1   86  29774
---- Validation: 
scalar performance:
{'acc': 0.6087637, 'precision': 0.73760784, 'recall': 0.6182775, 'specificity': 0.6182775, 'f1': 0.55723023, 'auroc': 0.8779998, 'binary_precision': 0.5558608, 'binary_recall': 0.97588426, 'binary_specificity': 0.26067072, 'binary_f1_score': 0.7082847}
confusion matrix:
     0    1
0  171  485
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63578945, 'precision': 0.7537781, 'recall': 0.6014586, 'specificity': 0.6014586, 'f1': 0.5514196, 'auroc': 0.9033855, 'binary_precision': 0.60189575, 'binary_recall': 0.980695, 'binary_specificity': 0.22222222, 'binary_f1_score': 0.74596184}
confusion matrix:
    0    1
0  48  168
1   5  254
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-12 22:10:02.986135,epoch time: 0:23:00.992200,used: 2:19:48.900109,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9670767, 'precision': 0.9205968, 'recall': 0.6852856, 'specificity': 0.6852856, 'f1': 0.7529069, 'auroc': 0.97717893, 'binary_precision': 0.9690826, 'binary_recall': 0.99722034, 'binary_specificity': 0.37335092, 'binary_f1_score': 0.98295015}
confusion matrix:
     0      1
0  566    950
1   83  29777
---- Validation: 
scalar performance:
{'acc': 0.59624416, 'precision': 0.7322072, 'recall': 0.60612404, 'specificity': 0.60612404, 'f1': 0.53793246, 'auroc': 0.8805363, 'binary_precision': 0.54774773, 'binary_recall': 0.977492, 'binary_specificity': 0.2347561, 'binary_f1_score': 0.70207846}
confusion matrix:
     0    1
0  154  502
1   14  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62736845, 'precision': 0.7643411, 'recall': 0.5914307, 'specificity': 0.5914307, 'f1': 0.5324725, 'auroc': 0.9063528, 'binary_precision': 0.59534883, 'binary_recall': 0.98841697, 'binary_specificity': 0.19444445, 'binary_f1_score': 0.74310595}
confusion matrix:
    0    1
0  42  174
1   3  256
early stop counter: 1
val acc:0.5962441563606262, best validation acc: 0.6087636947631836, corresponding to test acc:                         0.6357894539833069 / 0.6357894539833069
after epoch: 7,now: 2024-07-12 22:33:17.315986,epoch time: 0:23:14.329851,used: 2:43:03.229960,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9696265, 'precision': 0.9137901, 'recall': 0.7216891, 'specificity': 0.7216891, 'f1': 0.78575015, 'auroc': 0.97867644, 'binary_precision': 0.97259915, 'binary_recall': 0.9961487, 'binary_specificity': 0.44722956, 'binary_f1_score': 0.9842331}
confusion matrix:
     0      1
0  678    838
1  115  29745
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.74413145, 'recall': 0.63572466, 'specificity': 0.63572466, 'f1': 0.58417135, 'auroc': 0.88077897, 'binary_precision': 0.5680751, 'binary_recall': 0.9726688, 'binary_specificity': 0.2987805, 'binary_f1_score': 0.7172495}
confusion matrix:
     0    1
0  196  460
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6568421, 'precision': 0.75658476, 'recall': 0.6253754, 'specificity': 0.6253754, 'f1': 0.5898252, 'auroc': 0.9076576, 'binary_precision': 0.61764705, 'binary_recall': 0.972973, 'binary_specificity': 0.2777778, 'binary_f1_score': 0.75562215}
confusion matrix:
    0    1
0  60  156
1   7  252
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 22:56:31.257172,epoch time: 0:23:13.941186,used: 3:06:17.171146,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9716025, 'precision': 0.92869467, 'recall': 0.73587626, 'specificity': 0.73587626, 'f1': 0.801507, 'auroc': 0.9796244, 'binary_precision': 0.9739537, 'binary_recall': 0.9968185, 'binary_specificity': 0.47493404, 'binary_f1_score': 0.9852534}
confusion matrix:
     0      1
0  720    796
1   95  29765
---- Validation: 
scalar performance:
{'acc': 0.60172147, 'precision': 0.73101246, 'recall': 0.61137605, 'specificity': 0.61137605, 'f1': 0.54733044, 'auroc': 0.88399434, 'binary_precision': 0.5514104, 'binary_recall': 0.97427654, 'binary_specificity': 0.24847561, 'binary_f1_score': 0.7042417}
confusion matrix:
     0    1
0  163  493
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6421053, 'precision': 0.75163317, 'recall': 0.60878736, 'specificity': 0.60878736, 'f1': 0.5640414, 'auroc': 0.9095346, 'binary_precision': 0.6067146, 'binary_recall': 0.976834, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.74852073}
confusion matrix:
    0    1
0  52  164
1   6  253
early stop counter: 1
val acc:0.601721465587616, best validation acc: 0.6267605423927307, corresponding to test acc:                         0.6568421125411987 / 0.6568421125411987
after epoch: 9,now: 2024-07-12 23:20:03.132308,epoch time: 0:23:31.875136,used: 3:29:49.046282,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9711563, 'precision': 0.92080104, 'recall': 0.7359549, 'specificity': 0.7359549, 'f1': 0.79970956, 'auroc': 0.98236465, 'binary_precision': 0.9739728, 'binary_recall': 0.99631613, 'binary_specificity': 0.47559366, 'binary_f1_score': 0.9850178}
confusion matrix:
     0      1
0  721    795
1  110  29750
---- Validation: 
scalar performance:
{'acc': 0.6111111, 'precision': 0.7347604, 'recall': 0.6204808, 'specificity': 0.6204808, 'f1': 0.5617257, 'auroc': 0.8860849, 'binary_precision': 0.55760366, 'binary_recall': 0.9726688, 'binary_specificity': 0.2682927, 'binary_f1_score': 0.7088459}
confusion matrix:
     0    1
0  176  480
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6526316, 'precision': 0.7594198, 'recall': 0.62036145, 'specificity': 0.62036145, 'f1': 0.58135027, 'auroc': 0.91117907, 'binary_precision': 0.6140777, 'binary_recall': 0.976834, 'binary_specificity': 0.2638889, 'binary_f1_score': 0.7540984}
confusion matrix:
    0    1
0  57  159
1   6  253
early stop counter: 2
val acc:0.6111111044883728, best validation acc: 0.6267605423927307, corresponding to test acc:                         0.6568421125411987 / 0.6568421125411987
after epoch: 10,now: 2024-07-12 23:43:51.558305,epoch time: 0:23:48.425997,used: 3:53:37.472279,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.97173, 'precision': 0.93274474, 'recall': 0.73469096, 'specificity': 0.73469096, 'f1': 0.8014151, 'auroc': 0.9825375, 'binary_precision': 0.97383314, 'binary_recall': 0.9970864, 'binary_specificity': 0.47229552, 'binary_f1_score': 0.9853226}
confusion matrix:
     0      1
0  716    800
1   87  29773
---- Validation: 
scalar performance:
{'acc': 0.6001565, 'precision': 0.73000664, 'recall': 0.6098517, 'specificity': 0.6098517, 'f1': 0.54498947, 'auroc': 0.8888078, 'binary_precision': 0.5504087, 'binary_recall': 0.97427654, 'binary_specificity': 0.24542683, 'binary_f1_score': 0.7034243}
confusion matrix:
     0    1
0  161  495
1   16  606
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6463158, 'precision': 0.7548193, 'recall': 0.613417, 'specificity': 0.613417, 'f1': 0.5710231, 'auroc': 0.9133955, 'binary_precision': 0.6096386, 'binary_recall': 0.976834, 'binary_specificity': 0.25, 'binary_f1_score': 0.75074184}
confusion matrix:
    0    1
0  54  162
1   6  253
early stop counter: 3
val acc:0.6001564860343933, best validation acc: 0.6267605423927307, corresponding to test acc:                         0.6568421125411987 / 0.6568421125411987
after epoch: 11,now: 2024-07-13 00:08:08.399027,epoch time: 0:24:16.840722,used: 4:17:54.313001,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9715706, 'precision': 0.9113334, 'recall': 0.7486954, 'specificity': 0.7486954, 'f1': 0.8078527, 'auroc': 0.9816352, 'binary_precision': 0.975228, 'binary_recall': 0.99541193, 'binary_specificity': 0.5019789, 'binary_f1_score': 0.9852166}
confusion matrix:
     0      1
0  761    755
1  137  29723
---- Validation: 
scalar performance:
{'acc': 0.6189358, 'precision': 0.7395234, 'recall': 0.6281027, 'specificity': 0.6281027, 'f1': 0.5730423, 'auroc': 0.88800883, 'binary_precision': 0.5627907, 'binary_recall': 0.9726688, 'binary_specificity': 0.28353658, 'binary_f1_score': 0.71302295}
confusion matrix:
     0    1
0  186  470
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6652632, 'precision': 0.75739455, 'recall': 0.63501894, 'specificity': 0.63501894, 'f1': 0.6046412, 'auroc': 0.9134313, 'binary_precision': 0.6243781, 'binary_recall': 0.969112, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.7594553}
confusion matrix:
    0    1
0  65  151
1   8  251
new oracle model saved
early stop counter: 4
val acc:0.6189358234405518, best validation acc: 0.6267605423927307, corresponding to test acc:                         0.6568421125411987 / 0.6652631759643555
after epoch: 12,now: 2024-07-13 00:32:16.486822,epoch time: 0:24:08.087795,used: 4:42:02.400796,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9724312, 'precision': 0.92406666, 'recall': 0.7494606, 'specificity': 0.7494606, 'f1': 0.8117969, 'auroc': 0.9833391, 'binary_precision': 0.9752811, 'binary_recall': 0.99628264, 'binary_specificity': 0.5026385, 'binary_f1_score': 0.98567003}
confusion matrix:
     0      1
0  762    754
1  111  29749
---- Validation: 
scalar performance:
{'acc': 0.614241, 'precision': 0.7366863, 'recall': 0.62352955, 'specificity': 0.62352955, 'f1': 0.5662754, 'auroc': 0.88958466, 'binary_precision': 0.559667, 'binary_recall': 0.9726688, 'binary_specificity': 0.27439025, 'binary_f1_score': 0.7105109}
confusion matrix:
     0    1
0  180  476
1   17  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6631579, 'precision': 0.76111114, 'recall': 0.6323198, 'specificity': 0.6323198, 'f1': 0.59979784, 'auroc': 0.91502213, 'binary_precision': 0.62222224, 'binary_recall': 0.972973, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.7590362}
confusion matrix:
    0    1
0  63  153
1   7  252
early stop counter: 5
val acc:0.6142410039901733, best validation acc: 0.6267605423927307, corresponding to test acc:                         0.6568421125411987 / 0.6652631759643555
after epoch: 13,now: 2024-07-13 00:56:46.386031,epoch time: 0:24:29.899209,used: 5:06:32.300005,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_19_50_14_seed_2_21918845
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 13 with time: 5:06:32.300005 at 2024-07-13 00:56:46.386031
persisted model performance metric: 

scalar performance:
{'acc': 0.6568421, 'precision': 0.75658476, 'recall': 0.6253754, 'specificity': 0.6253754, 'f1': 0.5898252, 'auroc': 0.9076576, 'binary_precision': 0.61764705, 'binary_recall': 0.972973, 'binary_specificity': 0.2777778, 'binary_f1_score': 0.75562215}
confusion matrix:
    0    1
0  60  156
1   7  252
oracle model performance metric: 

scalar performance:
{'acc': 0.6652632, 'precision': 0.75739455, 'recall': 0.63501894, 'specificity': 0.63501894, 'f1': 0.6046412, 'auroc': 0.9134313, 'binary_precision': 0.6243781, 'binary_recall': 0.969112, 'binary_specificity': 0.30092594, 'binary_f1_score': 0.7594553}
confusion matrix:
    0    1
0  65  151
1   8  251
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189845 KiB |   2147 MiB |   1779 TiB |   1779 TiB |
|       from large pool | 173454 KiB |   2130 MiB |   1754 TiB |   1754 TiB |
|       from small pool |  16391 KiB |     32 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 189845 KiB |   2147 MiB |   1779 TiB |   1779 TiB |
|       from large pool | 173454 KiB |   2130 MiB |   1754 TiB |   1754 TiB |
|       from small pool |  16391 KiB |     32 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB |   2146 MiB |   1779 TiB |   1779 TiB |
|       from large pool | 172814 KiB |   2128 MiB |   1754 TiB |   1754 TiB |
|       from small pool |  16198 KiB |     32 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2886 MiB |   2916 MiB |   8234 MiB |   5348 MiB |
|       from large pool |   2848 MiB |   2878 MiB |   8162 MiB |   5314 MiB |
|       from small pool |     38 MiB |     38 MiB |     72 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39530 KiB | 233525 KiB |    954 TiB |    954 TiB |
|       from large pool |  31346 KiB | 232732 KiB |    929 TiB |    929 TiB |
|       from small pool |   8184 KiB |  10022 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4385    |  244070 K  |  244069 K  |
|       from large pool |      76    |     251    |  160621 K  |  160621 K  |
|       from small pool |     718    |    4308    |   83448 K  |   83447 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4385    |  244070 K  |  244069 K  |
|       from large pool |      76    |     251    |  160621 K  |  160621 K  |
|       from small pool |     718    |    4308    |   83448 K  |   83447 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     115    |     118    |     307    |     192    |
|       from large pool |      96    |      99    |     271    |     175    |
|       from small pool |      19    |      19    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      38    |    1979    |  166852 K  |  166852 K  |
|       from large pool |      10    |      99    |  116871 K  |  116871 K  |
|       from small pool |      28    |    1969    |   49981 K  |   49981 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2147 MiB |   1779 TiB |   1779 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1754 TiB |   1754 TiB |
|       from small pool |      0 KiB |     32 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2147 MiB |   1779 TiB |   1779 TiB |
|       from large pool |  16640 KiB |   2130 MiB |   1754 TiB |   1754 TiB |
|       from small pool |      0 KiB |     32 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   2146 MiB |   1779 TiB |   1779 TiB |
|       from large pool |  16640 KiB |   2128 MiB |   1754 TiB |   1754 TiB |
|       from small pool |      0 KiB |     32 MiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   2916 MiB |   8234 MiB |   8010 MiB |
|       from large pool | 204800 KiB |   2878 MiB |   8162 MiB |   7962 MiB |
|       from small pool |  24576 KiB |     38 MiB |     72 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 233525 KiB |    954 TiB |    954 TiB |
|       from large pool |  24320 KiB | 232732 KiB |    929 TiB |    929 TiB |
|       from small pool |      0 KiB |  12070 KiB |     24 TiB |     24 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  244070 K  |  244070 K  |
|       from large pool |       2    |     251    |  160621 K  |  160621 K  |
|       from small pool |       0    |    4308    |   83448 K  |   83448 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  244070 K  |  244070 K  |
|       from large pool |       2    |     251    |  160621 K  |  160621 K  |
|       from small pool |       0    |    4308    |   83448 K  |   83448 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     118    |     307    |     285    |
|       from large pool |      10    |      99    |     271    |     261    |
|       from small pool |      12    |      19    |      36    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |    1979    |  166853 K  |  166853 K  |
|       from large pool |       4    |      99    |  116871 K  |  116871 K  |
|       from small pool |       0    |    1969    |   49981 K  |   49981 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 13 01:05:11 2024]
Finished job 0.
1 of 1 steps (100%) done
