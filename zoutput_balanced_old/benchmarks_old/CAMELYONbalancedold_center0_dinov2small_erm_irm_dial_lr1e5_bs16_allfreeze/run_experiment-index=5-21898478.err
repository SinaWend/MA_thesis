Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 12 04:32:29 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478

 Experiment start at: 2024-07-12 04:38:01.873766
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.5360825061798096
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9265368, 'precision': 0.5091929, 'recall': 0.50547415, 'specificity': 0.50547415, 'f1': 0.5054489, 'auroc': 0.44969654, 'binary_precision': 0.9517191, 'binary_recall': 0.97208136, 'binary_specificity': 0.03886693, 'binary_f1_score': 0.96179247}
confusion matrix:
     0      1
0   59   1459
1  826  28760
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.5504658, 'precision': 0.731866, 'recall': 0.55655307, 'specificity': 0.55655307, 'f1': 0.44976878, 'auroc': 0.7303704, 'binary_precision': 0.5232558, 'binary_recall': 0.992126, 'binary_specificity': 0.12098009, 'binary_f1_score': 0.685155}
confusion matrix:
    0    1
0  79  574
1   5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5690722, 'precision': 0.626266, 'recall': 0.51632214, 'specificity': 0.51632214, 'f1': 0.40621173, 'auroc': 0.6465633, 'binary_precision': 0.565032, 'binary_recall': 0.9814815, 'binary_specificity': 0.05116279, 'binary_f1_score': 0.7171854}
confusion matrix:
    0    1
0  11  204
1   5  265
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 04:47:16.546267,epoch time: 0:09:14.672501,used: 0:09:14.672501,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9480131, 'precision': 0.53921586, 'recall': 0.5036259, 'specificity': 0.5036259, 'f1': 0.49694574, 'auroc': 0.5307181, 'binary_precision': 0.95156604, 'binary_recall': 0.9960456, 'binary_specificity': 0.011206328, 'binary_f1_score': 0.9732979}
confusion matrix:
     0      1
0   17   1500
1  117  29470
---- Validation: 
scalar performance:
{'acc': 0.51475155, 'precision': 0.72074044, 'recall': 0.5213961, 'specificity': 0.5213961, 'f1': 0.37853914, 'auroc': 0.7680385, 'binary_precision': 0.5039809, 'binary_recall': 0.9968504, 'binary_specificity': 0.045941807, 'binary_f1_score': 0.66948706}
confusion matrix:
    0    1
0  30  623
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56494844, 'precision': 0.7806653, 'recall': 0.5093023, 'specificity': 0.5093023, 'f1': 0.37778547, 'auroc': 0.6877692, 'binary_precision': 0.56133056, 'binary_recall': 1.0, 'binary_specificity': 0.018604651, 'binary_f1_score': 0.7190413}
confusion matrix:
   0    1
0  4  211
1  0  270
early stop counter: 1
val acc:0.5147515535354614, best validation acc: 0.5504658222198486, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 2,now: 2024-07-12 04:56:25.310626,epoch time: 0:09:08.764359,used: 0:18:23.436860,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.94981354, 'precision': 0.57300526, 'recall': 0.5036342, 'specificity': 0.5036342, 'f1': 0.49593508, 'auroc': 0.6419915, 'binary_precision': 0.9515661, 'binary_recall': 0.99803966, 'binary_specificity': 0.009228741, 'binary_f1_score': 0.974249}
confusion matrix:
    0      1
0  14   1503
1  58  29529
---- Validation: 
scalar performance:
{'acc': 0.51475155, 'precision': 0.7519841, 'recall': 0.5214395, 'specificity': 0.5214395, 'f1': 0.37620834, 'auroc': 0.7963126, 'binary_precision': 0.50396824, 'binary_recall': 1.0, 'binary_specificity': 0.04287902, 'binary_f1_score': 0.6701847}
confusion matrix:
    0    1
0  28  625
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5587629, 'precision': 0.77892566, 'recall': 0.5023256, 'specificity': 0.5023256, 'f1': 0.36271983, 'auroc': 0.7289233, 'binary_precision': 0.55785125, 'binary_recall': 1.0, 'binary_specificity': 0.004651163, 'binary_f1_score': 0.7161804}
confusion matrix:
   0    1
0  1  214
1  0  270
early stop counter: 2
val acc:0.5147515535354614, best validation acc: 0.5504658222198486, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 3,now: 2024-07-12 05:05:34.060236,epoch time: 0:09:08.749610,used: 0:27:32.186470,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.94987786, 'precision': 0.6096059, 'recall': 0.506506, 'specificity': 0.506506, 'f1': 0.5014678, 'auroc': 0.7367337, 'binary_precision': 0.95176995, 'binary_recall': 0.99787056, 'binary_specificity': 0.01514154, 'binary_f1_score': 0.97427523}
confusion matrix:
    0      1
0  23   1496
1  63  29522
---- Validation: 
scalar performance:
{'acc': 0.5287267, 'precision': 0.7556361, 'recall': 0.53522205, 'specificity': 0.53522205, 'f1': 0.4041141, 'auroc': 0.8147135, 'binary_precision': 0.51127213, 'binary_recall': 1.0, 'binary_specificity': 0.07044411, 'binary_f1_score': 0.6766116}
confusion matrix:
    0    1
0  46  607
1   0  635
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56082475, 'precision': 0.7795031, 'recall': 0.5046512, 'specificity': 0.5046512, 'f1': 0.36778232, 'auroc': 0.7589664, 'binary_precision': 0.5590062, 'binary_recall': 1.0, 'binary_specificity': 0.009302326, 'binary_f1_score': 0.7171315}
confusion matrix:
   0    1
0  2  213
1  0  270
early stop counter: 3
val acc:0.5287266969680786, best validation acc: 0.5504658222198486, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 4,now: 2024-07-12 05:14:45.057534,epoch time: 0:09:10.997298,used: 0:36:43.183768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9506173, 'precision': 0.67606306, 'recall': 0.51032966, 'specificity': 0.51032966, 'f1': 0.5085246, 'auroc': 0.80334985, 'binary_precision': 0.95212615, 'binary_recall': 0.9982762, 'binary_specificity': 0.022383146, 'binary_f1_score': 0.9746552}
confusion matrix:
    0      1
0  34   1485
1  51  29534
---- Validation: 
scalar performance:
{'acc': 0.5411491, 'precision': 0.75117445, 'recall': 0.5474515, 'specificity': 0.5474515, 'f1': 0.4289097, 'auroc': 0.82678854, 'binary_precision': 0.51797384, 'binary_recall': 0.9984252, 'binary_specificity': 0.09647779, 'binary_f1_score': 0.6820872}
confusion matrix:
    0    1
0  63  590
1   1  634
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5628866, 'precision': 0.780083, 'recall': 0.5069767, 'specificity': 0.5069767, 'f1': 0.37280402, 'auroc': 0.78335917, 'binary_precision': 0.560166, 'binary_recall': 1.0, 'binary_specificity': 0.013953488, 'binary_f1_score': 0.7180851}
confusion matrix:
   0    1
0  3  212
1  0  270
early stop counter: 4
val acc:0.5411490797996521, best validation acc: 0.5504658222198486, corresponding to test acc:                         0.5690721869468689 / 0.5690721869468689
after epoch: 5,now: 2024-07-12 05:23:54.482957,epoch time: 0:09:09.425423,used: 0:45:52.609191,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95093876, 'precision': 0.7020246, 'recall': 0.51298124, 'specificity': 0.51298124, 'f1': 0.5134958, 'auroc': 0.8417387, 'binary_precision': 0.9524362, 'binary_recall': 0.9982763, 'binary_specificity': 0.027686223, 'binary_f1_score': 0.97481763}
confusion matrix:
    0      1
0  42   1475
1  51  29536
---- Validation: 
scalar performance:
{'acc': 0.5551242, 'precision': 0.750969, 'recall': 0.5612123, 'specificity': 0.5612123, 'f1': 0.45547068, 'auroc': 0.8325982, 'binary_precision': 0.52574754, 'binary_recall': 0.9968504, 'binary_specificity': 0.12557428, 'binary_f1_score': 0.6884176}
confusion matrix:
    0    1
0  82  571
1   2  633
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5690722, 'precision': 0.78183717, 'recall': 0.5139535, 'specificity': 0.5139535, 'f1': 0.38762996, 'auroc': 0.7974504, 'binary_precision': 0.56367433, 'binary_recall': 1.0, 'binary_specificity': 0.027906977, 'binary_f1_score': 0.7209613}
confusion matrix:
   0    1
0  6  209
1  0  270
better model found
persisted
after epoch: 6,now: 2024-07-12 05:32:59.349395,epoch time: 0:09:04.866438,used: 0:54:57.475629,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9517747, 'precision': 0.7641845, 'recall': 0.5206127, 'specificity': 0.5206127, 'f1': 0.5274966, 'auroc': 0.8718474, 'binary_precision': 0.9531477, 'binary_recall': 0.9983777, 'binary_specificity': 0.042847726, 'binary_f1_score': 0.9752385}
confusion matrix:
    0      1
0  65   1452
1  48  29539
---- Validation: 
scalar performance:
{'acc': 0.5706522, 'precision': 0.7488544, 'recall': 0.5764829, 'specificity': 0.5764829, 'f1': 0.4843207, 'auroc': 0.8353354, 'binary_precision': 0.53474575, 'binary_recall': 0.9937008, 'binary_specificity': 0.15926494, 'binary_f1_score': 0.6953168}
confusion matrix:
     0    1
0  104  549
1    4  631
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5731959, 'precision': 0.7830188, 'recall': 0.51860464, 'specificity': 0.51860464, 'f1': 0.3973202, 'auroc': 0.80713177, 'binary_precision': 0.5660377, 'binary_recall': 1.0, 'binary_specificity': 0.037209302, 'binary_f1_score': 0.72289157}
confusion matrix:
   0    1
0  8  207
1  0  270
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 05:42:04.628744,epoch time: 0:09:05.279349,used: 1:04:02.754978,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9525142, 'precision': 0.79672825, 'recall': 0.5300661, 'specificity': 0.5300661, 'f1': 0.54425853, 'auroc': 0.88936925, 'binary_precision': 0.9540007, 'binary_recall': 0.9982086, 'binary_specificity': 0.061923582, 'binary_f1_score': 0.9756042}
confusion matrix:
    0      1
0  94   1424
1  53  29533
---- Validation: 
scalar performance:
{'acc': 0.58074534, 'precision': 0.75006104, 'recall': 0.58641523, 'specificity': 0.58641523, 'f1': 0.5020619, 'auroc': 0.836915, 'binary_precision': 0.54077256, 'binary_recall': 0.992126, 'binary_specificity': 0.18070444, 'binary_f1_score': 0.70000005}
confusion matrix:
     0    1
0  118  535
1    5  630
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58350515, 'precision': 0.7528369, 'recall': 0.5307063, 'specificity': 0.5307063, 'f1': 0.4243831, 'auroc': 0.812696, 'binary_precision': 0.5723404, 'binary_recall': 0.9962963, 'binary_specificity': 0.06511628, 'binary_f1_score': 0.72702706}
confusion matrix:
    0    1
0  14  201
1   1  269
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-12 05:51:09.273061,epoch time: 0:09:04.644317,used: 1:13:07.399295,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95415384, 'precision': 0.8230243, 'recall': 0.5543443, 'specificity': 0.5543443, 'f1': 0.58400893, 'auroc': 0.89516217, 'binary_precision': 0.95625263, 'binary_recall': 0.99743116, 'binary_specificity': 0.111257404, 'binary_f1_score': 0.9764079}
confusion matrix:
     0      1
0  169   1350
1   76  29509
---- Validation: 
scalar performance:
{'acc': 0.5993789, 'precision': 0.75006765, 'recall': 0.6047268, 'specificity': 0.6047268, 'f1': 0.53413796, 'auroc': 0.8374649, 'binary_precision': 0.5524229, 'binary_recall': 0.98740155, 'binary_specificity': 0.22205207, 'binary_f1_score': 0.7084745}
confusion matrix:
     0    1
0  145  508
1    8  627
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6103093, 'precision': 0.7764536, 'recall': 0.56093884, 'specificity': 0.56093884, 'f1': 0.48112482, 'auroc': 0.8173471, 'binary_precision': 0.58862144, 'binary_recall': 0.9962963, 'binary_specificity': 0.1255814, 'binary_f1_score': 0.7400274}
confusion matrix:
    0    1
0  27  188
1   1  269
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 06:00:12.926943,epoch time: 0:09:03.653882,used: 1:22:11.053177,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95527905, 'precision': 0.8206183, 'recall': 0.57679427, 'specificity': 0.57679427, 'f1': 0.61634934, 'auroc': 0.90325356, 'binary_precision': 0.9583794, 'binary_recall': 0.9962481, 'binary_specificity': 0.15734036, 'binary_f1_score': 0.97694695}
confusion matrix:
     0      1
0  239   1280
1  111  29474
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.74228215, 'recall': 0.61380666, 'specificity': 0.61380666, 'f1': 0.5514874, 'auroc': 0.83761203, 'binary_precision': 0.55884993, 'binary_recall': 0.97952753, 'binary_specificity': 0.24808575, 'binary_f1_score': 0.7116704}
confusion matrix:
     0    1
0  162  491
1   13  622
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63505155, 'precision': 0.7786735, 'recall': 0.5893195, 'specificity': 0.5893195, 'f1': 0.5315186, 'auroc': 0.82049954, 'binary_precision': 0.60496616, 'binary_recall': 0.9925926, 'binary_specificity': 0.18604651, 'binary_f1_score': 0.75175315}
confusion matrix:
    0    1
0  40  175
1   2  268
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-12 06:09:17.393595,epoch time: 0:09:04.466652,used: 1:31:15.519829,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9565651, 'precision': 0.8391439, 'recall': 0.589024, 'specificity': 0.589024, 'f1': 0.63383275, 'auroc': 0.9120028, 'binary_precision': 0.95953774, 'binary_recall': 0.9963495, 'binary_specificity': 0.18169849, 'binary_f1_score': 0.9775972}
confusion matrix:
     0      1
0  276   1243
1  108  29477
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.7394539, 'recall': 0.6130193, 'specificity': 0.6130193, 'f1': 0.5508827, 'auroc': 0.83878404, 'binary_precision': 0.55845326, 'binary_recall': 0.9779528, 'binary_specificity': 0.24808575, 'binary_f1_score': 0.710933}
confusion matrix:
     0    1
0  162  491
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63917524, 'precision': 0.7811276, 'recall': 0.5939707, 'specificity': 0.5939707, 'f1': 0.53909606, 'auroc': 0.82413435, 'binary_precision': 0.60770977, 'binary_recall': 0.9925926, 'binary_specificity': 0.19534884, 'binary_f1_score': 0.7538678}
confusion matrix:
    0    1
0  42  173
1   2  268
new oracle model saved
early stop counter: 1
val acc:0.6079192757606506, best validation acc: 0.6086956262588501, corresponding to test acc:                         0.6350515484809875 / 0.6391752362251282
after epoch: 11,now: 2024-07-12 06:18:22.845968,epoch time: 0:09:05.452373,used: 1:40:20.972202,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.95904064, 'precision': 0.8719679, 'recall': 0.6097421, 'specificity': 0.6097421, 'f1': 0.6627621, 'auroc': 0.91265154, 'binary_precision': 0.9615284, 'binary_recall': 0.99682283, 'binary_specificity': 0.22266139, 'binary_f1_score': 0.9788576}
confusion matrix:
     0      1
0  338   1180
1   94  29492
---- Validation: 
scalar performance:
{'acc': 0.6265528, 'precision': 0.750386, 'recall': 0.631396, 'specificity': 0.631396, 'f1': 0.5784718, 'auroc': 0.83932424, 'binary_precision': 0.57077205, 'binary_recall': 0.9779528, 'binary_specificity': 0.2848392, 'binary_f1_score': 0.72083575}
confusion matrix:
     0    1
0  186  467
1   14  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.643299, 'precision': 0.774242, 'recall': 0.5990956, 'specificity': 0.5990956, 'f1': 0.5487547, 'auroc': 0.8270973, 'binary_precision': 0.61098397, 'binary_recall': 0.98888886, 'binary_specificity': 0.20930232, 'binary_f1_score': 0.7553041}
confusion matrix:
    0    1
0  45  170
1   3  267
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-12 06:27:30.159977,epoch time: 0:09:07.314009,used: 1:49:28.286211,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.95987654, 'precision': 0.8570105, 'recall': 0.63056344, 'specificity': 0.63056344, 'f1': 0.68582916, 'auroc': 0.9175241, 'binary_precision': 0.96355546, 'binary_recall': 0.995471, 'binary_specificity': 0.2656559, 'binary_f1_score': 0.97925323}
confusion matrix:
     0      1
0  403   1114
1  134  29453
---- Validation: 
scalar performance:
{'acc': 0.63509315, 'precision': 0.7474916, 'recall': 0.6397318, 'specificity': 0.6397318, 'f1': 0.5925938, 'auroc': 0.8404819, 'binary_precision': 0.5771749, 'binary_recall': 0.9716535, 'binary_specificity': 0.3078101, 'binary_f1_score': 0.7241784}
confusion matrix:
     0    1
0  201  452
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6556701, 'precision': 0.781967, 'recall': 0.6130491, 'specificity': 0.6130491, 'f1': 0.5704755, 'auroc': 0.8301292, 'binary_precision': 0.61948955, 'binary_recall': 0.98888886, 'binary_specificity': 0.2372093, 'binary_f1_score': 0.7617689}
confusion matrix:
    0    1
0  51  164
1   3  267
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 06:36:37.129245,epoch time: 0:09:06.969268,used: 1:58:35.255479,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.96084106, 'precision': 0.8627504, 'recall': 0.6413895, 'specificity': 0.6413895, 'f1': 0.6984824, 'auroc': 0.9210844, 'binary_precision': 0.96459335, 'binary_recall': 0.9953696, 'binary_specificity': 0.28740937, 'binary_f1_score': 0.9797399}
confusion matrix:
     0      1
0  436   1081
1  137  29450
---- Validation: 
scalar performance:
{'acc': 0.6319876, 'precision': 0.7456512, 'recall': 0.63666904, 'specificity': 0.63666904, 'f1': 0.58819973, 'auroc': 0.8409256, 'binary_precision': 0.5750233, 'binary_recall': 0.9716535, 'binary_specificity': 0.30168453, 'binary_f1_score': 0.7224824}
confusion matrix:
     0    1
0  197  456
1   18  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65773195, 'precision': 0.7831924, 'recall': 0.6153747, 'specificity': 0.6153747, 'f1': 0.57402116, 'auroc': 0.8320414, 'binary_precision': 0.62093025, 'binary_recall': 0.98888886, 'binary_specificity': 0.24186046, 'binary_f1_score': 0.76285714}
confusion matrix:
    0    1
0  52  163
1   3  267
new oracle model saved
early stop counter: 1
val acc:0.6319875717163086, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6556701064109802 / 0.6577319502830505
after epoch: 14,now: 2024-07-12 06:45:43.868283,epoch time: 0:09:06.739038,used: 2:07:41.994517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.96129113, 'precision': 0.8488587, 'recall': 0.66083086, 'specificity': 0.66083086, 'f1': 0.7163316, 'auroc': 0.92489684, 'binary_precision': 0.96643984, 'binary_recall': 0.9938144, 'binary_specificity': 0.32784727, 'binary_f1_score': 0.979936}
confusion matrix:
     0      1
0  498   1021
1  183  29402
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.7517494, 'recall': 0.65270525, 'specificity': 0.65270525, 'f1': 0.61177945, 'auroc': 0.8420494, 'binary_precision': 0.58683205, 'binary_recall': 0.96850395, 'binary_specificity': 0.33690658, 'binary_f1_score': 0.7308378}
confusion matrix:
     0    1
0  220  433
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6618557, 'precision': 0.7715164, 'recall': 0.6209733, 'specificity': 0.6209733, 'f1': 0.5847429, 'auroc': 0.83410853, 'binary_precision': 0.625, 'binary_recall': 0.9814815, 'binary_specificity': 0.26046512, 'binary_f1_score': 0.7636887}
confusion matrix:
    0    1
0  56  159
1   5  265
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-12 06:54:48.999766,epoch time: 0:09:05.131483,used: 2:16:47.126000,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.96219134, 'precision': 0.85675687, 'recall': 0.66764486, 'specificity': 0.66764486, 'f1': 0.72437656, 'auroc': 0.9280909, 'binary_precision': 0.96711606, 'binary_recall': 0.9940512, 'binary_specificity': 0.34123847, 'binary_f1_score': 0.98039865}
confusion matrix:
     0      1
0  518   1000
1  176  29410
---- Validation: 
scalar performance:
{'acc': 0.6506211, 'precision': 0.75148606, 'recall': 0.65498066, 'specificity': 0.65498066, 'f1': 0.61535496, 'auroc': 0.8433397, 'binary_precision': 0.58868647, 'binary_recall': 0.96692914, 'binary_specificity': 0.34303215, 'binary_f1_score': 0.73182356}
confusion matrix:
     0    1
0  224  429
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6659794, 'precision': 0.76813185, 'recall': 0.62609816, 'specificity': 0.62609816, 'f1': 0.593323, 'auroc': 0.8366581, 'binary_precision': 0.62857145, 'binary_recall': 0.9777778, 'binary_specificity': 0.2744186, 'binary_f1_score': 0.7652174}
confusion matrix:
    0    1
0  59  156
1   6  264
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-12 07:03:54.859868,epoch time: 0:09:05.860102,used: 2:25:52.986102,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9615483, 'precision': 0.8392273, 'recall': 0.67564243, 'specificity': 0.67564243, 'f1': 0.72842807, 'auroc': 0.9291054, 'binary_precision': 0.967894, 'binary_recall': 0.9924962, 'binary_specificity': 0.35878867, 'binary_f1_score': 0.9800407}
confusion matrix:
     0      1
0  545    974
1  222  29363
---- Validation: 
scalar performance:
{'acc': 0.66071427, 'precision': 0.75584406, 'recall': 0.664913, 'specificity': 0.664913, 'f1': 0.62929004, 'auroc': 0.84379303, 'binary_precision': 0.5963035, 'binary_recall': 0.9653543, 'binary_specificity': 0.36447167, 'binary_f1_score': 0.7372219}
confusion matrix:
     0    1
0  238  415
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.7697908, 'recall': 0.6381998, 'specificity': 0.6381998, 'f1': 0.61154675, 'auroc': 0.83834624, 'binary_precision': 0.63680387, 'binary_recall': 0.97407407, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.77013177}
confusion matrix:
    0    1
0  65  150
1   7  263
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-12 07:13:03.008384,epoch time: 0:09:08.148516,used: 2:35:01.134618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.96395963, 'precision': 0.86510384, 'recall': 0.68783915, 'specificity': 0.68783915, 'f1': 0.7449213, 'auroc': 0.9347389, 'binary_precision': 0.9690528, 'binary_recall': 0.9938482, 'binary_specificity': 0.38183016, 'binary_f1_score': 0.98129386}
confusion matrix:
     0      1
0  580    939
1  182  29403
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.75809956, 'recall': 0.66874146, 'specificity': 0.66874146, 'f1': 0.63442844, 'auroc': 0.8450736, 'binary_precision': 0.599218, 'binary_recall': 0.9653543, 'binary_specificity': 0.37212864, 'binary_f1_score': 0.73944515}
confusion matrix:
     0    1
0  243  410
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68041235, 'precision': 0.77265406, 'recall': 0.642851, 'specificity': 0.642851, 'f1': 0.61803067, 'auroc': 0.84005165, 'binary_precision': 0.63990265, 'binary_recall': 0.97407407, 'binary_specificity': 0.3116279, 'binary_f1_score': 0.7723935}
confusion matrix:
    0    1
0  67  148
1   7  263
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-12 07:22:14.561702,epoch time: 0:09:11.553318,used: 2:44:12.687936,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96373457, 'precision': 0.8543803, 'recall': 0.6950169, 'specificity': 0.6950169, 'f1': 0.748935, 'auroc': 0.93677473, 'binary_precision': 0.96979004, 'binary_recall': 0.99280065, 'binary_specificity': 0.3972332, 'binary_f1_score': 0.98116046}
confusion matrix:
     0      1
0  603    915
1  213  29373
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.7561798, 'recall': 0.6679541, 'specificity': 0.6679541, 'f1': 0.63376, 'auroc': 0.846933, 'binary_precision': 0.5988258, 'binary_recall': 0.9637795, 'binary_specificity': 0.37212864, 'binary_f1_score': 0.7386843}
confusion matrix:
     0    1
0  243  410
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68041235, 'precision': 0.77265406, 'recall': 0.642851, 'specificity': 0.642851, 'f1': 0.61803067, 'auroc': 0.8433247, 'binary_precision': 0.63990265, 'binary_recall': 0.97407407, 'binary_specificity': 0.3116279, 'binary_f1_score': 0.7723935}
confusion matrix:
    0    1
0  67  148
1   7  263
early stop counter: 1
val acc:0.6638198494911194, best validation acc: 0.6645962595939636, corresponding to test acc:                         0.6804123520851135 / 0.6804123520851135
after epoch: 19,now: 2024-07-12 07:31:20.128309,epoch time: 0:09:05.566607,used: 2:53:18.254543,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9635095, 'precision': 0.8495581, 'recall': 0.6972828, 'specificity': 0.6972828, 'f1': 0.74974597, 'auroc': 0.935305, 'binary_precision': 0.9699993, 'binary_recall': 0.9923272, 'binary_specificity': 0.4022383, 'binary_f1_score': 0.98103625}
confusion matrix:
     0      1
0  611    908
1  227  29358
---- Validation: 
scalar performance:
{'acc': 0.66459626, 'precision': 0.75809956, 'recall': 0.66874146, 'specificity': 0.66874146, 'f1': 0.63442844, 'auroc': 0.8488454, 'binary_precision': 0.599218, 'binary_recall': 0.9653543, 'binary_specificity': 0.37212864, 'binary_f1_score': 0.73944515}
confusion matrix:
     0    1
0  243  410
1   22  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68247426, 'precision': 0.774065, 'recall': 0.6451766, 'specificity': 0.6451766, 'f1': 0.6212475, 'auroc': 0.8474246, 'binary_precision': 0.6414634, 'binary_recall': 0.97407407, 'binary_specificity': 0.31627908, 'binary_f1_score': 0.7735294}
confusion matrix:
    0    1
0  68  147
1   7  263
new oracle model saved
early stop counter: 2
val acc:0.6645962595939636, best validation acc: 0.6645962595939636, corresponding to test acc:                         0.6804123520851135 / 0.6824742555618286
after epoch: 20,now: 2024-07-12 07:40:26.665165,epoch time: 0:09:06.536856,used: 3:02:24.791399,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96511704, 'precision': 0.8717208, 'recall': 0.6990646, 'specificity': 0.6990646, 'f1': 0.7563986, 'auroc': 0.94046044, 'binary_precision': 0.9701419, 'binary_recall': 0.99391586, 'binary_specificity': 0.4042133, 'binary_f1_score': 0.981885}
confusion matrix:
     0      1
0  614    905
1  180  29405
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.75869906, 'recall': 0.6672318, 'specificity': 0.6672318, 'f1': 0.6320165, 'auroc': 0.8512161, 'binary_precision': 0.59785783, 'binary_recall': 0.96692914, 'binary_specificity': 0.36753446, 'binary_f1_score': 0.73886883}
confusion matrix:
     0    1
0  240  413
1   21  614
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6783505, 'precision': 0.77658707, 'recall': 0.64005166, 'specificity': 0.64005166, 'f1': 0.6132376, 'auroc': 0.85107666, 'binary_precision': 0.6376812, 'binary_recall': 0.9777778, 'binary_specificity': 0.30232558, 'binary_f1_score': 0.7719298}
confusion matrix:
    0    1
0  65  150
1   6  264
early stop counter: 3
val acc:0.6630434989929199, best validation acc: 0.6645962595939636, corresponding to test acc:                         0.6804123520851135 / 0.6824742555618286
after epoch: 21,now: 2024-07-12 07:49:32.277515,epoch time: 0:09:05.612350,used: 3:11:30.403749,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9643776, 'precision': 0.84500235, 'recall': 0.71834844, 'specificity': 0.71834844, 'f1': 0.76570714, 'auroc': 0.94031215, 'binary_precision': 0.97208315, 'binary_recall': 0.99100894, 'binary_specificity': 0.44568795, 'binary_f1_score': 0.9814548}
confusion matrix:
     0      1
0  677    842
1  266  29319
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.7606849, 'recall': 0.68016183, 'specificity': 0.68016183, 'f1': 0.65058815, 'auroc': 0.85186243, 'binary_precision': 0.6087824, 'binary_recall': 0.96062994, 'binary_specificity': 0.39969373, 'binary_f1_score': 0.7452657}
confusion matrix:
     0    1
0  261  392
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7010309, 'precision': 0.7818092, 'recall': 0.66658056, 'specificity': 0.66658056, 'f1': 0.6507654, 'auroc': 0.85324717, 'binary_precision': 0.6566416, 'binary_recall': 0.97037035, 'binary_specificity': 0.3627907, 'binary_f1_score': 0.7832585}
confusion matrix:
    0    1
0  78  137
1   8  262
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-12 07:58:41.286635,epoch time: 0:09:09.009120,used: 3:20:39.412869,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9653421, 'precision': 0.86644673, 'recall': 0.7074237, 'specificity': 0.7074237, 'f1': 0.7624106, 'auroc': 0.94256055, 'binary_precision': 0.97098863, 'binary_recall': 0.99324006, 'binary_specificity': 0.42160738, 'binary_f1_score': 0.9819883}
confusion matrix:
     0      1
0  640    878
1  200  29386
---- Validation: 
scalar performance:
{'acc': 0.66071427, 'precision': 0.7589026, 'recall': 0.66495645, 'specificity': 0.66495645, 'f1': 0.6285522, 'auroc': 0.85610926, 'binary_precision': 0.5959302, 'binary_recall': 0.96850395, 'binary_specificity': 0.3614089, 'binary_f1_score': 0.73785245}
confusion matrix:
     0    1
0  236  417
1   20  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67628866, 'precision': 0.77521515, 'recall': 0.63772607, 'specificity': 0.63772607, 'f1': 0.6099629, 'auroc': 0.85815674, 'binary_precision': 0.6361446, 'binary_recall': 0.9777778, 'binary_specificity': 0.29767442, 'binary_f1_score': 0.7708029}
confusion matrix:
    0    1
0  64  151
1   6  264
early stop counter: 1
val acc:0.6607142686843872, best validation acc: 0.6762422323226929, corresponding to test acc:                         0.7010309100151062 / 0.7010309100151062
after epoch: 23,now: 2024-07-12 08:07:47.490031,epoch time: 0:09:06.203396,used: 3:29:45.616265,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9650206, 'precision': 0.855219, 'recall': 0.71556383, 'specificity': 0.71556383, 'f1': 0.76629317, 'auroc': 0.9466579, 'binary_precision': 0.971789, 'binary_recall': 0.992023, 'binary_specificity': 0.43910468, 'binary_f1_score': 0.9818018}
confusion matrix:
     0      1
0  667    852
1  236  29349
---- Validation: 
scalar performance:
{'acc': 0.66770184, 'precision': 0.75844955, 'recall': 0.67178255, 'specificity': 0.67178255, 'f1': 0.6388583, 'auroc': 0.85731995, 'binary_precision': 0.6017699, 'binary_recall': 0.9637795, 'binary_specificity': 0.3797856, 'binary_f1_score': 0.7409201}
confusion matrix:
     0    1
0  248  405
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69072163, 'precision': 0.77958786, 'recall': 0.6544789, 'specificity': 0.6544789, 'f1': 0.6339512, 'auroc': 0.86039615, 'binary_precision': 0.6477833, 'binary_recall': 0.97407407, 'binary_specificity': 0.33488372, 'binary_f1_score': 0.7781065}
confusion matrix:
    0    1
0  72  143
1   7  263
early stop counter: 2
val acc:0.6677018404006958, best validation acc: 0.6762422323226929, corresponding to test acc:                         0.7010309100151062 / 0.7010309100151062
after epoch: 24,now: 2024-07-12 08:16:56.877135,epoch time: 0:09:09.387104,used: 3:38:55.003369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9656314, 'precision': 0.8518901, 'recall': 0.73024905, 'specificity': 0.73024905, 'f1': 0.7768204, 'auroc': 0.943771, 'binary_precision': 0.97324747, 'binary_recall': 0.9911104, 'binary_specificity': 0.46938777, 'binary_f1_score': 0.9820977}
confusion matrix:
     0      1
0  713    806
1  263  29322
---- Validation: 
scalar performance:
{'acc': 0.6801242, 'precision': 0.76562464, 'recall': 0.6840337, 'specificity': 0.6840337, 'f1': 0.65493417, 'auroc': 0.8582388, 'binary_precision': 0.6113886, 'binary_recall': 0.9637795, 'binary_specificity': 0.4042879, 'binary_f1_score': 0.74816626}
confusion matrix:
     0    1
0  264  389
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70309275, 'precision': 0.7831687, 'recall': 0.6689061, 'specificity': 0.6689061, 'f1': 0.65380496, 'auroc': 0.8621705, 'binary_precision': 0.65829146, 'binary_recall': 0.97037035, 'binary_specificity': 0.36744186, 'binary_f1_score': 0.7844311}
confusion matrix:
    0    1
0  79  136
1   8  262
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-12 08:26:26.117385,epoch time: 0:09:29.240250,used: 3:48:24.243619,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9664995, 'precision': 0.86945295, 'recall': 0.72227424, 'specificity': 0.72227424, 'f1': 0.7754624, 'auroc': 0.9502493, 'binary_precision': 0.97242546, 'binary_recall': 0.9929356, 'binary_specificity': 0.4516129, 'binary_f1_score': 0.98257345}
confusion matrix:
     0      1
0  686    833
1  209  29376
---- Validation: 
scalar performance:
{'acc': 0.6661491, 'precision': 0.75754344, 'recall': 0.67025113, 'specificity': 0.67025113, 'f1': 0.6368234, 'auroc': 0.86038274, 'binary_precision': 0.6005888, 'binary_recall': 0.9637795, 'binary_specificity': 0.3767228, 'binary_f1_score': 0.7400242}
confusion matrix:
     0    1
0  246  407
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6969072, 'precision': 0.7836198, 'recall': 0.66145563, 'specificity': 0.66145563, 'f1': 0.64331275, 'auroc': 0.8645134, 'binary_precision': 0.6526055, 'binary_recall': 0.97407407, 'binary_specificity': 0.3488372, 'binary_f1_score': 0.781575}
confusion matrix:
    0    1
0  75  140
1   7  263
early stop counter: 1
val acc:0.6661490797996521, best validation acc: 0.6801242232322693, corresponding to test acc:                         0.7030927538871765 / 0.7030927538871765
after epoch: 26,now: 2024-07-12 08:35:41.407680,epoch time: 0:09:15.290295,used: 3:57:39.533914,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9656314, 'precision': 0.85145104, 'recall': 0.7308736, 'specificity': 0.7308736, 'f1': 0.7771627, 'auroc': 0.949331, 'binary_precision': 0.9733103, 'binary_recall': 0.99104273, 'binary_specificity': 0.4707044, 'binary_f1_score': 0.98209643}
confusion matrix:
     0      1
0  715    804
1  265  29320
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.76339483, 'recall': 0.6802052, 'specificity': 0.6802052, 'f1': 0.6499487, 'auroc': 0.86140287, 'binary_precision': 0.6083499, 'binary_recall': 0.9637795, 'binary_specificity': 0.39663094, 'binary_f1_score': 0.7458867}
confusion matrix:
     0    1
0  259  394
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70515466, 'precision': 0.7888763, 'recall': 0.67075795, 'specificity': 0.67075795, 'f1': 0.65558255, 'auroc': 0.8660637, 'binary_precision': 0.65914786, 'binary_recall': 0.97407407, 'binary_specificity': 0.36744186, 'binary_f1_score': 0.78624815}
confusion matrix:
    0    1
0  79  136
1   7  263
new oracle model saved
early stop counter: 2
val acc:0.6762422323226929, best validation acc: 0.6801242232322693, corresponding to test acc:                         0.7030927538871765 / 0.7051546573638916
after epoch: 27,now: 2024-07-12 08:44:56.286076,epoch time: 0:09:14.878396,used: 4:06:54.412310,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.96540636, 'precision': 0.8442803, 'recall': 0.7374557, 'specificity': 0.7374557, 'f1': 0.7798363, 'auroc': 0.9512109, 'binary_precision': 0.9739975, 'binary_recall': 0.9900629, 'binary_specificity': 0.4848485, 'binary_f1_score': 0.9819645}
confusion matrix:
     0      1
0  736    782
1  294  29292
---- Validation: 
scalar performance:
{'acc': 0.68167704, 'precision': 0.76387054, 'recall': 0.6855217, 'specificity': 0.6855217, 'f1': 0.65753126, 'auroc': 0.86179113, 'binary_precision': 0.6130653, 'binary_recall': 0.96062994, 'binary_specificity': 0.41041347, 'binary_f1_score': 0.74846625}
confusion matrix:
     0    1
0  268  385
1   25  610
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70515466, 'precision': 0.7803798, 'recall': 0.6717054, 'specificity': 0.6717054, 'f1': 0.65805495, 'auroc': 0.86651164, 'binary_precision': 0.6607595, 'binary_recall': 0.96666664, 'binary_specificity': 0.37674418, 'binary_f1_score': 0.7849624}
confusion matrix:
    0    1
0  81  134
1   9  261
better model found
persisted
after epoch: 28,now: 2024-07-12 08:54:18.965441,epoch time: 0:09:22.679365,used: 4:16:17.091675,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.966403, 'precision': 0.85216594, 'recall': 0.7426668, 'specificity': 0.7426668, 'f1': 0.78609884, 'auroc': 0.9531614, 'binary_precision': 0.9744971, 'binary_recall': 0.9906037, 'binary_specificity': 0.4947299, 'binary_f1_score': 0.98248434}
confusion matrix:
     0      1
0  751    767
1  278  29308
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.76384157, 'recall': 0.6809709, 'specificity': 0.6809709, 'f1': 0.6509485, 'auroc': 0.8638169, 'binary_precision': 0.6089552, 'binary_recall': 0.9637795, 'binary_specificity': 0.39816234, 'binary_f1_score': 0.74634147}
confusion matrix:
     0    1
0  260  393
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7072165, 'precision': 0.7901721, 'recall': 0.67308354, 'specificity': 0.67308354, 'f1': 0.6586132, 'auroc': 0.86913, 'binary_precision': 0.66080403, 'binary_recall': 0.97407407, 'binary_specificity': 0.37209302, 'binary_f1_score': 0.7874251}
confusion matrix:
    0    1
0  80  135
1   7  263
new oracle model saved
early stop counter: 1
val acc:0.6770186424255371, best validation acc: 0.6816770434379578, corresponding to test acc:                         0.7051546573638916 / 0.7072165012359619
after epoch: 29,now: 2024-07-12 09:03:27.147573,epoch time: 0:09:08.182132,used: 4:25:25.273807,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9677855, 'precision': 0.86493695, 'recall': 0.74681544, 'specificity': 0.74681544, 'f1': 0.7931113, 'auroc': 0.9561995, 'binary_precision': 0.9749136, 'binary_recall': 0.991652, 'binary_specificity': 0.5019789, 'binary_f1_score': 0.9832116}
confusion matrix:
     0      1
0  761    755
1  247  29341
---- Validation: 
scalar performance:
{'acc': 0.67624223, 'precision': 0.76339483, 'recall': 0.6802052, 'specificity': 0.6802052, 'f1': 0.6499487, 'auroc': 0.8656087, 'binary_precision': 0.6083499, 'binary_recall': 0.9637795, 'binary_specificity': 0.39663094, 'binary_f1_score': 0.7458867}
confusion matrix:
     0    1
0  259  394
1   23  612
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70927835, 'precision': 0.7914615, 'recall': 0.67540914, 'specificity': 0.67540914, 'f1': 0.66162956, 'auroc': 0.87167954, 'binary_precision': 0.6624685, 'binary_recall': 0.97407407, 'binary_specificity': 0.37674418, 'binary_f1_score': 0.78860563}
confusion matrix:
    0    1
0  81  134
1   7  263
new oracle model saved
early stop counter: 2
val acc:0.6762422323226929, best validation acc: 0.6816770434379578, corresponding to test acc:                         0.7051546573638916 / 0.7092783451080322
after epoch: 30,now: 2024-07-12 09:12:39.069781,epoch time: 0:09:11.922208,used: 4:34:37.196015,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_04_38_01_seed_0_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:34:37.196015 at 2024-07-12 09:12:39.069781
persisted model performance metric: 

scalar performance:
{'acc': 0.70515466, 'precision': 0.7803798, 'recall': 0.6717054, 'specificity': 0.6717054, 'f1': 0.65805495, 'auroc': 0.86651164, 'binary_precision': 0.6607595, 'binary_recall': 0.96666664, 'binary_specificity': 0.37674418, 'binary_f1_score': 0.7849624}
confusion matrix:
    0    1
0  81  134
1   9  261
oracle model performance metric: 

scalar performance:
{'acc': 0.70927835, 'precision': 0.7914615, 'recall': 0.67540914, 'specificity': 0.67540914, 'f1': 0.66162956, 'auroc': 0.87167954, 'binary_precision': 0.6624685, 'binary_recall': 0.97407407, 'binary_specificity': 0.37674418, 'binary_f1_score': 0.78860563}
confusion matrix:
    0    1
0  81  134
1   7  263
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216502 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 190794 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool | 174400 KiB | 428048 KiB | 216502 GiB | 216501 GiB |
|       from small pool |  16394 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 512000 KiB | 512000 KiB | 512000 KiB |      0 B   |
|       from large pool | 473088 KiB | 473088 KiB | 473088 KiB |      0 B   |
|       from small pool |  38912 KiB |  38912 KiB |  38912 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36533 KiB |  74940 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  30400 KiB |  70632 KiB | 114112 GiB | 114112 GiB |
|       from small pool |   6133 KiB |   9283 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    4371    |   50235 K  |   50234 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    4371    |   50235 K  |   50234 K  |
|       from large pool |      76    |     158    |   21347 K  |   21347 K  |
|       from small pool |     724    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |      40    |      40    |       0    |
|       from large pool |      21    |      21    |      21    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    1961    |   29177 K  |   29177 K  |
|       from large pool |       9    |      19    |   13022 K  |   13022 K  |
|       from small pool |      28    |    1953    |   16155 K  |   16155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216502 GiB | 216502 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216502 GiB | 216502 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114112 GiB | 114112 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50235 K  |   50235 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50235 K  |   50235 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29177 K  |   29177 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16155 K  |   16155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216502 GiB | 216502 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 221044 GiB | 221044 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 216502 GiB | 216502 GiB |
|       from small pool |      0 KiB |  33617 KiB |   4542 GiB |   4542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 221031 GiB | 221031 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 216499 GiB | 216499 GiB |
|       from small pool |      0 KiB |  33425 KiB |   4532 GiB |   4532 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 512000 KiB | 512000 KiB | 284672 KiB |
|       from large pool | 204800 KiB | 473088 KiB | 473088 KiB | 268288 KiB |
|       from small pool |  22528 KiB |  38912 KiB |  38912 KiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  75354 KiB | 118766 GiB | 118766 GiB |
|       from large pool |  23872 KiB |  70632 KiB | 114112 GiB | 114112 GiB |
|       from small pool |      0 KiB |  11184 KiB |   4654 GiB |   4654 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4371    |   50235 K  |   50235 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4371    |   50235 K  |   50235 K  |
|       from large pool |       2    |     158    |   21347 K  |   21347 K  |
|       from small pool |       0    |    4293    |   28887 K  |   28887 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      40    |      40    |      19    |
|       from large pool |      10    |      21    |      21    |      11    |
|       from small pool |      11    |      19    |      19    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1961    |   29177 K  |   29177 K  |
|       from large pool |       3    |      19    |   13022 K  |   13022 K  |
|       from small pool |       0    |    1953    |   16155 K  |   16155 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478

 Experiment start at: 2024-07-12 09:25:31.871103
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6276150345802307
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.94871217, 'precision': 0.6019528, 'recall': 0.5114327, 'specificity': 0.5114327, 'f1': 0.5111841, 'auroc': 0.5006335, 'binary_precision': 0.9523718, 'binary_recall': 0.9958917, 'binary_specificity': 0.026973683, 'binary_f1_score': 0.9736457}
confusion matrix:
     0      1
0   41   1479
1  122  29574
---- Validation: 
scalar performance:
{'acc': 0.64637, 'precision': 0.7394315, 'recall': 0.65138245, 'specificity': 0.65138245, 'f1': 0.6126414, 'auroc': 0.686575, 'binary_precision': 0.5860058, 'binary_recall': 0.95714283, 'binary_specificity': 0.34562212, 'binary_f1_score': 0.7269439}
confusion matrix:
     0    1
0  225  426
1   27  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6380753, 'precision': 0.739957, 'recall': 0.6175231, 'specificity': 0.6175231, 'f1': 0.57431066, 'auroc': 0.72316206, 'binary_precision': 0.597561, 'binary_recall': 0.96837944, 'binary_specificity': 0.26666668, 'binary_f1_score': 0.73906493}
confusion matrix:
    0    1
0  60  165
1   8  245
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 09:34:37.893139,epoch time: 0:09:06.022036,used: 0:09:06.022036,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9500256, 'precision': 0.65184724, 'recall': 0.5136904, 'specificity': 0.5136904, 'f1': 0.51501185, 'auroc': 0.6077448, 'binary_precision': 0.95254946, 'binary_recall': 0.99713755, 'binary_specificity': 0.03024326, 'binary_f1_score': 0.97433364}
confusion matrix:
    0      1
0  46   1475
1  85  29610
---- Validation: 
scalar performance:
{'acc': 0.65651834, 'precision': 0.74867594, 'recall': 0.6614183, 'specificity': 0.6614183, 'f1': 0.6254386, 'auroc': 0.7284398, 'binary_precision': 0.59313726, 'binary_recall': 0.96031743, 'binary_specificity': 0.3625192, 'binary_f1_score': 0.73333335}
confusion matrix:
     0    1
0  236  415
1   25  605
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6359833, 'precision': 0.7439747, 'recall': 0.6150549, 'specificity': 0.6150549, 'f1': 0.5693694, 'auroc': 0.76305664, 'binary_precision': 0.5956417, 'binary_recall': 0.972332, 'binary_specificity': 0.25777778, 'binary_f1_score': 0.7387388}
confusion matrix:
    0    1
0  58  167
1   7  246
better model found
persisted
after epoch: 2,now: 2024-07-12 09:43:41.319203,epoch time: 0:09:03.426064,used: 0:18:09.448100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9509226, 'precision': 0.71039665, 'recall': 0.5263273, 'specificity': 0.5263273, 'f1': 0.537328, 'auroc': 0.70391506, 'binary_precision': 0.9537604, 'binary_recall': 0.99673355, 'binary_specificity': 0.05592105, 'binary_f1_score': 0.9747736}
confusion matrix:
    0      1
0  85   1435
1  97  29599
---- Validation: 
scalar performance:
{'acc': 0.6721311, 'precision': 0.75023663, 'recall': 0.67662567, 'specificity': 0.67662567, 'f1': 0.6477525, 'auroc': 0.7550484, 'binary_precision': 0.6062753, 'binary_recall': 0.9507936, 'binary_specificity': 0.40245774, 'binary_f1_score': 0.7404203}
confusion matrix:
     0    1
0  262  389
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64853555, 'precision': 0.7336379, 'recall': 0.629372, 'specificity': 0.629372, 'f1': 0.5948498, 'auroc': 0.78944224, 'binary_precision': 0.6065163, 'binary_recall': 0.95652175, 'binary_specificity': 0.30222222, 'binary_f1_score': 0.74233127}
confusion matrix:
    0    1
0  68  157
1  11  242
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-12 09:52:43.427960,epoch time: 0:09:02.108757,used: 0:27:11.556857,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9521079, 'precision': 0.7617886, 'recall': 0.5338104, 'specificity': 0.5338104, 'f1': 0.55029976, 'auroc': 0.7784068, 'binary_precision': 0.95442826, 'binary_recall': 0.99727225, 'binary_specificity': 0.07034846, 'binary_f1_score': 0.97538006}
confusion matrix:
     0      1
0  107   1414
1   81  29614
---- Validation: 
scalar performance:
{'acc': 0.68384075, 'precision': 0.7574862, 'recall': 0.6881464, 'specificity': 0.6881464, 'f1': 0.6625169, 'auroc': 0.77402043, 'binary_precision': 0.6156218, 'binary_recall': 0.9507936, 'binary_specificity': 0.42549923, 'binary_f1_score': 0.7473487}
confusion matrix:
     0    1
0  277  374
1   31  599
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6736402, 'precision': 0.75615954, 'recall': 0.6557927, 'specificity': 0.6557927, 'f1': 0.63009703, 'auroc': 0.8057268, 'binary_precision': 0.6246787, 'binary_recall': 0.9604743, 'binary_specificity': 0.3511111, 'binary_f1_score': 0.7570093}
confusion matrix:
    0    1
0  79  146
1  10  243
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-12 10:01:43.975488,epoch time: 0:09:00.547528,used: 0:36:12.104385,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9525564, 'precision': 0.77943957, 'recall': 0.53685313, 'specificity': 0.53685313, 'f1': 0.5555219, 'auroc': 0.8284258, 'binary_precision': 0.9547125, 'binary_recall': 0.99744064, 'binary_specificity': 0.07626562, 'binary_f1_score': 0.97560894}
confusion matrix:
     0      1
0  116   1405
1   76  29619
---- Validation: 
scalar performance:
{'acc': 0.6830601, 'precision': 0.7606312, 'recall': 0.6874552, 'specificity': 0.6874552, 'f1': 0.6606777, 'auroc': 0.79029095, 'binary_precision': 0.6142857, 'binary_recall': 0.95555556, 'binary_specificity': 0.41935483, 'binary_f1_score': 0.74782604}
confusion matrix:
     0    1
0  273  378
1   28  602
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6757322, 'precision': 0.7616842, 'recall': 0.65776896, 'specificity': 0.65776896, 'f1': 0.6318674, 'auroc': 0.81865615, 'binary_precision': 0.62564105, 'binary_recall': 0.9644269, 'binary_specificity': 0.3511111, 'binary_f1_score': 0.7589425}
confusion matrix:
    0    1
0  79  146
1   9  244
new oracle model saved
early stop counter: 1
val acc:0.6830601096153259, best validation acc: 0.6838407516479492, corresponding to test acc:                         0.6736401915550232 / 0.6757321953773499
after epoch: 5,now: 2024-07-12 10:10:45.658679,epoch time: 0:09:01.683191,used: 0:45:13.787576,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9528447, 'precision': 0.7722774, 'recall': 0.55166364, 'specificity': 0.55166364, 'f1': 0.5785179, 'auroc': 0.85454535, 'binary_precision': 0.9561072, 'binary_recall': 0.996161, 'binary_specificity': 0.107166335, 'binary_f1_score': 0.9757232}
confusion matrix:
     0      1
0  163   1358
1  114  29581
---- Validation: 
scalar performance:
{'acc': 0.6885246, 'precision': 0.75808203, 'recall': 0.6927035, 'specificity': 0.6927035, 'f1': 0.66888225, 'auroc': 0.800573, 'binary_precision': 0.6199377, 'binary_recall': 0.947619, 'binary_specificity': 0.437788, 'binary_f1_score': 0.7495292}
confusion matrix:
     0    1
0  285  366
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6987448, 'precision': 0.7764452, 'recall': 0.6822134, 'specificity': 0.6822134, 'f1': 0.66385376, 'auroc': 0.826491, 'binary_precision': 0.6437995, 'binary_recall': 0.9644269, 'binary_specificity': 0.4, 'binary_f1_score': 0.77215195}
confusion matrix:
    0    1
0  90  135
1   9  244
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-12 10:19:47.648737,epoch time: 0:09:01.990058,used: 0:54:15.777634,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.95354944, 'precision': 0.7859111, 'recall': 0.5604552, 'specificity': 0.5604552, 'f1': 0.59186184, 'auroc': 0.8723042, 'binary_precision': 0.95693535, 'binary_recall': 0.9959926, 'binary_specificity': 0.12491782, 'binary_f1_score': 0.9760734}
confusion matrix:
     0      1
0  190   1331
1  119  29576
---- Validation: 
scalar performance:
{'acc': 0.7010148, 'precision': 0.76166785, 'recall': 0.7048899, 'specificity': 0.7048899, 'f1': 0.68509775, 'auroc': 0.8084705, 'binary_precision': 0.6315229, 'binary_recall': 0.9412698, 'binary_specificity': 0.46850997, 'binary_f1_score': 0.75589544}
confusion matrix:
     0    1
0  305  346
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70711297, 'precision': 0.7715124, 'recall': 0.6918402, 'specificity': 0.6918402, 'f1': 0.677879, 'auroc': 0.83350015, 'binary_precision': 0.6531165, 'binary_recall': 0.9525692, 'binary_specificity': 0.4311111, 'binary_f1_score': 0.7749196}
confusion matrix:
    0    1
0  97  128
1  12  241
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-12 10:29:02.573653,epoch time: 0:09:14.924916,used: 1:03:30.702550,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9547668, 'precision': 0.8034558, 'recall': 0.5760659, 'specificity': 0.5760659, 'f1': 0.61439836, 'auroc': 0.89311457, 'binary_precision': 0.9584103, 'binary_recall': 0.99565583, 'binary_specificity': 0.156476, 'binary_f1_score': 0.97667813}
confusion matrix:
     0      1
0  238   1283
1  129  29566
---- Validation: 
scalar performance:
{'acc': 0.69633096, 'precision': 0.7629165, 'recall': 0.700384, 'specificity': 0.700384, 'f1': 0.6784599, 'auroc': 0.8164143, 'binary_precision': 0.6264428, 'binary_recall': 0.947619, 'binary_specificity': 0.453149, 'binary_f1_score': 0.754264}
confusion matrix:
     0    1
0  295  356
1   33  597
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70711297, 'precision': 0.77811825, 'recall': 0.69134825, 'specificity': 0.69134825, 'f1': 0.6760577, 'auroc': 0.8395082, 'binary_precision': 0.65147454, 'binary_recall': 0.9604743, 'binary_specificity': 0.42222223, 'binary_f1_score': 0.7763578}
confusion matrix:
    0    1
0  95  130
1  10  243
early stop counter: 1
val acc:0.6963309645652771, best validation acc: 0.7010148167610168, corresponding to test acc:                         0.7071129679679871 / 0.7071129679679871
after epoch: 8,now: 2024-07-12 10:38:09.437721,epoch time: 0:09:06.864068,used: 1:12:37.566618,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9578101, 'precision': 0.84123755, 'recall': 0.6067264, 'specificity': 0.6067264, 'f1': 0.6563635, 'auroc': 0.89813423, 'binary_precision': 0.96134216, 'binary_recall': 0.99568963, 'binary_specificity': 0.21776316, 'binary_f1_score': 0.97821456}
confusion matrix:
     0      1
0  331   1189
1  128  29568
---- Validation: 
scalar performance:
{'acc': 0.71116316, 'precision': 0.7680817, 'recall': 0.7148745, 'specificity': 0.7148745, 'f1': 0.69720876, 'auroc': 0.82152486, 'binary_precision': 0.6403888, 'binary_recall': 0.9412698, 'binary_specificity': 0.48847926, 'binary_f1_score': 0.7622108}
confusion matrix:
     0    1
0  318  333
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7868403, 'recall': 0.7115942, 'specificity': 0.7115942, 'f1': 0.70141387, 'auroc': 0.84332013, 'binary_precision': 0.6685083, 'binary_recall': 0.95652175, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.7869919}
confusion matrix:
     0    1
0  105  120
1   11  242
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-12 10:47:13.696417,epoch time: 0:09:04.258696,used: 1:21:41.825314,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95886725, 'precision': 0.8365971, 'recall': 0.6290598, 'specificity': 0.6290598, 'f1': 0.6815953, 'auroc': 0.9049417, 'binary_precision': 0.9634596, 'binary_recall': 0.9944772, 'binary_specificity': 0.26364234, 'binary_f1_score': 0.97872275}
confusion matrix:
     0      1
0  401   1120
1  164  29531
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.76575243, 'recall': 0.7155658, 'specificity': 0.7155658, 'f1': 0.6987586, 'auroc': 0.8254285, 'binary_precision': 0.64200217, 'binary_recall': 0.93650794, 'binary_specificity': 0.49462366, 'binary_f1_score': 0.7617818}
confusion matrix:
     0    1
0  322  329
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7364017, 'precision': 0.79348105, 'recall': 0.7227053, 'specificity': 0.7227053, 'f1': 0.7146404, 'auroc': 0.84662277, 'binary_precision': 0.67787117, 'binary_recall': 0.95652175, 'binary_specificity': 0.4888889, 'binary_f1_score': 0.7934426}
confusion matrix:
     0    1
0  110  115
1   11  242
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-12 10:56:19.277070,epoch time: 0:09:05.580653,used: 1:30:47.405967,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9593798, 'precision': 0.8481765, 'recall': 0.6283935, 'specificity': 0.6283935, 'f1': 0.6823272, 'auroc': 0.9130652, 'binary_precision': 0.96338797, 'binary_recall': 0.995117, 'binary_specificity': 0.26166996, 'binary_f1_score': 0.9789955}
confusion matrix:
     0      1
0  398   1123
1  145  29550
---- Validation: 
scalar performance:
{'acc': 0.69789225, 'precision': 0.757679, 'recall': 0.7017665, 'specificity': 0.7017665, 'f1': 0.68180895, 'auroc': 0.83169234, 'binary_precision': 0.629393, 'binary_recall': 0.9380952, 'binary_specificity': 0.4654378, 'binary_f1_score': 0.7533461}
confusion matrix:
     0    1
0  303  348
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7217573, 'precision': 0.7873243, 'recall': 0.7069038, 'specificity': 0.7069038, 'f1': 0.6952393, 'auroc': 0.8526306, 'binary_precision': 0.6639344, 'binary_recall': 0.9604743, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78513736}
confusion matrix:
     0    1
0  102  123
1   10  243
early stop counter: 1
val acc:0.6978922486305237, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 11,now: 2024-07-12 11:05:29.919701,epoch time: 0:09:10.642631,used: 1:39:58.048598,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.96034086, 'precision': 0.8450708, 'recall': 0.64698845, 'specificity': 0.64698845, 'f1': 0.70182467, 'auroc': 0.9200566, 'binary_precision': 0.9651813, 'binary_recall': 0.9941741, 'binary_specificity': 0.29980275, 'binary_f1_score': 0.9794632}
confusion matrix:
     0      1
0  456   1065
1  173  29522
---- Validation: 
scalar performance:
{'acc': 0.69789225, 'precision': 0.757679, 'recall': 0.7017665, 'specificity': 0.7017665, 'f1': 0.68180895, 'auroc': 0.8357789, 'binary_precision': 0.629393, 'binary_recall': 0.9380952, 'binary_specificity': 0.4654378, 'binary_f1_score': 0.7533461}
confusion matrix:
     0    1
0  303  348
1   39  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7259414, 'precision': 0.7931548, 'recall': 0.7111023, 'specificity': 0.7111023, 'f1': 0.6998221, 'auroc': 0.85661834, 'binary_precision': 0.6666667, 'binary_recall': 0.9644269, 'binary_specificity': 0.45777777, 'binary_f1_score': 0.78836834}
confusion matrix:
     0    1
0  103  122
1    9  244
early stop counter: 2
val acc:0.6978922486305237, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 12,now: 2024-07-12 11:14:45.081631,epoch time: 0:09:15.161930,used: 1:49:13.210528,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.96242315, 'precision': 0.85415244, 'recall': 0.6725093, 'specificity': 0.6725093, 'f1': 0.7285425, 'auroc': 0.9254222, 'binary_precision': 0.9676668, 'binary_recall': 0.9937028, 'binary_specificity': 0.3513158, 'binary_f1_score': 0.980512}
confusion matrix:
     0      1
0  534    986
1  187  29509
---- Validation: 
scalar performance:
{'acc': 0.7002342, 'precision': 0.7601714, 'recall': 0.70409626, 'specificity': 0.70409626, 'f1': 0.68439204, 'auroc': 0.8387121, 'binary_precision': 0.63113004, 'binary_recall': 0.93968254, 'binary_specificity': 0.46850997, 'binary_f1_score': 0.755102}
confusion matrix:
     0    1
0  305  346
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.7944236, 'recall': 0.71332455, 'specificity': 0.71332455, 'f1': 0.7025143, 'auroc': 0.8594115, 'binary_precision': 0.66849315, 'binary_recall': 0.9644269, 'binary_specificity': 0.46222222, 'binary_f1_score': 0.789644}
confusion matrix:
     0    1
0  104  121
1    9  244
early stop counter: 3
val acc:0.7002341747283936, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 13,now: 2024-07-12 11:23:57.607570,epoch time: 0:09:12.525939,used: 1:58:25.736467,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.962327, 'precision': 0.8506504, 'recall': 0.67485523, 'specificity': 0.67485523, 'f1': 0.73005104, 'auroc': 0.9294604, 'binary_precision': 0.9678774, 'binary_recall': 0.9933659, 'binary_specificity': 0.35634452, 'binary_f1_score': 0.980456}
confusion matrix:
     0      1
0  542    979
1  197  29498
---- Validation: 
scalar performance:
{'acc': 0.7002342, 'precision': 0.76117337, 'recall': 0.7041218, 'specificity': 0.7041218, 'f1': 0.6841586, 'auroc': 0.8432521, 'binary_precision': 0.6308511, 'binary_recall': 0.9412698, 'binary_specificity': 0.4669739, 'binary_f1_score': 0.755414}
confusion matrix:
     0    1
0  304  347
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.8645059, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
early stop counter: 4
val acc:0.7002341747283936, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 14,now: 2024-07-12 11:33:13.354177,epoch time: 0:09:15.746607,used: 2:07:41.483074,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9646976, 'precision': 0.8689923, 'recall': 0.694191, 'specificity': 0.694191, 'f1': 0.7514795, 'auroc': 0.931679, 'binary_precision': 0.9697388, 'binary_recall': 0.9939047, 'binary_specificity': 0.3944773, 'binary_f1_score': 0.98167306}
confusion matrix:
     0      1
0  600    921
1  181  29514
---- Validation: 
scalar performance:
{'acc': 0.70179546, 'precision': 0.7621622, 'recall': 0.70565796, 'specificity': 0.70565796, 'f1': 0.6860359, 'auroc': 0.84583914, 'binary_precision': 0.6321962, 'binary_recall': 0.9412698, 'binary_specificity': 0.47004607, 'binary_f1_score': 0.7563776}
confusion matrix:
     0    1
0  306  345
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.8670707, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
early stop counter: 5
val acc:0.7017954587936401, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 15,now: 2024-07-12 11:42:22.643040,epoch time: 0:09:09.288863,used: 2:16:50.771937,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9652742, 'precision': 0.86778176, 'recall': 0.7041628, 'specificity': 0.7041628, 'f1': 0.759948, 'auroc': 0.937158, 'binary_precision': 0.970715, 'binary_recall': 0.9934669, 'binary_specificity': 0.41485864, 'binary_f1_score': 0.98195916}
confusion matrix:
     0      1
0  631    890
1  194  29501
---- Validation: 
scalar performance:
{'acc': 0.704918, 'precision': 0.76413774, 'recall': 0.70873016, 'specificity': 0.70873016, 'f1': 0.68977726, 'auroc': 0.8488296, 'binary_precision': 0.63490367, 'binary_recall': 0.9412698, 'binary_specificity': 0.47619048, 'binary_f1_score': 0.758312}
confusion matrix:
     0    1
0  310  341
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.87030303, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
early stop counter: 6
val acc:0.7049180269241333, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 16,now: 2024-07-12 11:51:36.156312,epoch time: 0:09:13.513272,used: 2:26:04.285209,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.96373653, 'precision': 0.85476816, 'recall': 0.6936859, 'specificity': 0.6936859, 'f1': 0.74787223, 'auroc': 0.9382768, 'binary_precision': 0.9697089, 'binary_recall': 0.9928944, 'binary_specificity': 0.3944773, 'binary_f1_score': 0.9811647}
confusion matrix:
     0      1
0  600    921
1  211  29484
---- Validation: 
scalar performance:
{'acc': 0.7041374, 'precision': 0.7626585, 'recall': 0.7079365, 'specificity': 0.7079365, 'f1': 0.6890691, 'auroc': 0.8515763, 'binary_precision': 0.6345123, 'binary_recall': 0.93968254, 'binary_specificity': 0.47619048, 'binary_f1_score': 0.7575176}
confusion matrix:
     0    1
0  310  341
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.72384936, 'precision': 0.79188454, 'recall': 0.7088801, 'specificity': 0.7088801, 'f1': 0.69711983, 'auroc': 0.87293804, 'binary_precision': 0.6648501, 'binary_recall': 0.9644269, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.78709674}
confusion matrix:
     0    1
0  102  123
1    9  244
early stop counter: 7
val acc:0.70413738489151, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 17,now: 2024-07-12 12:00:47.124472,epoch time: 0:09:10.968160,used: 2:35:15.253369,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.965082, 'precision': 0.8562424, 'recall': 0.71404237, 'specificity': 0.71404237, 'f1': 0.7653396, 'auroc': 0.94325566, 'binary_precision': 0.97170275, 'binary_recall': 0.99218726, 'binary_specificity': 0.43589744, 'binary_f1_score': 0.98183817}
confusion matrix:
     0      1
0  663    858
1  232  29463
---- Validation: 
scalar performance:
{'acc': 0.7041374, 'precision': 0.75978184, 'recall': 0.7078597, 'specificity': 0.7078597, 'f1': 0.68973434, 'auroc': 0.8540268, 'binary_precision': 0.63538295, 'binary_recall': 0.9349206, 'binary_specificity': 0.48079878, 'binary_f1_score': 0.7565831}
confusion matrix:
     0    1
0  313  338
1   41  589
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8755555, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 8
val acc:0.70413738489151, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 18,now: 2024-07-12 12:09:56.423217,epoch time: 0:09:09.298745,used: 2:44:24.552114,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.96585083, 'precision': 0.8531172, 'recall': 0.7309768, 'specificity': 0.7309768, 'f1': 0.77773625, 'auroc': 0.9456297, 'binary_precision': 0.9733788, 'binary_recall': 0.99121064, 'binary_specificity': 0.47074294, 'binary_f1_score': 0.98221385}
confusion matrix:
     0      1
0  716    805
1  261  29434
---- Validation: 
scalar performance:
{'acc': 0.7064793, 'precision': 0.7622365, 'recall': 0.71018946, 'specificity': 0.71018946, 'f1': 0.69229865, 'auroc': 0.856148, 'binary_precision': 0.63714904, 'binary_recall': 0.93650794, 'binary_specificity': 0.48387095, 'binary_f1_score': 0.7583547}
confusion matrix:
     0    1
0  315  336
1   40  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.87808514, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
early stop counter: 9
val acc:0.7064793109893799, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 19,now: 2024-07-12 12:19:09.253731,epoch time: 0:09:12.830514,used: 2:53:37.382628,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9657227, 'precision': 0.8664164, 'recall': 0.7125077, 'specificity': 0.7125077, 'f1': 0.76667774, 'auroc': 0.9471014, 'binary_precision': 0.97153497, 'binary_recall': 0.9930628, 'binary_specificity': 0.43195266, 'binary_f1_score': 0.98218095}
confusion matrix:
     0      1
0  657    864
1  206  29489
---- Validation: 
scalar performance:
{'acc': 0.7025761, 'precision': 0.7657169, 'recall': 0.7065028, 'specificity': 0.7065028, 'f1': 0.68627506, 'auroc': 0.8589984, 'binary_precision': 0.6320255, 'binary_recall': 0.94603175, 'binary_specificity': 0.4669739, 'binary_f1_score': 0.7577877}
confusion matrix:
     0    1
0  304  347
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7133891, 'precision': 0.7855041, 'recall': 0.697769, 'specificity': 0.697769, 'f1': 0.6834513, 'auroc': 0.8816161, 'binary_precision': 0.65591395, 'binary_recall': 0.9644269, 'binary_specificity': 0.4311111, 'binary_f1_score': 0.7808}
confusion matrix:
    0    1
0  97  128
1   9  244
early stop counter: 10
val acc:0.7025761008262634, best validation acc: 0.7119438052177429, corresponding to test acc:                         0.7364016771316528 / 0.7364016771316528
after epoch: 20,now: 2024-07-12 12:28:34.571791,epoch time: 0:09:25.318060,used: 3:03:02.700688,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.96697205, 'precision': 0.86395156, 'recall': 0.7349969, 'specificity': 0.7349969, 'f1': 0.78395605, 'auroc': 0.948246, 'binary_precision': 0.9737538, 'binary_recall': 0.9920189, 'binary_specificity': 0.477975, 'binary_f1_score': 0.9828015}
confusion matrix:
     0      1
0  727    794
1  237  29458
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.769603, 'recall': 0.7186892, 'specificity': 0.7186892, 'f1': 0.7020241, 'auroc': 0.85990536, 'binary_precision': 0.64417845, 'binary_recall': 0.93968254, 'binary_specificity': 0.49769586, 'binary_f1_score': 0.7643641}
confusion matrix:
     0    1
0  324  327
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.88267016, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
better model found
persisted
after epoch: 21,now: 2024-07-12 12:37:52.474442,epoch time: 0:09:17.902651,used: 3:12:20.603339,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9674206, 'precision': 0.8716614, 'recall': 0.73273754, 'specificity': 0.73273754, 'f1': 0.7843934, 'auroc': 0.9479228, 'binary_precision': 0.9735156, 'binary_recall': 0.9927597, 'binary_specificity': 0.47271532, 'binary_f1_score': 0.9830435}
confusion matrix:
     0      1
0  719    802
1  215  29480
---- Validation: 
scalar performance:
{'acc': 0.70569867, 'precision': 0.7666306, 'recall': 0.7095494, 'specificity': 0.7095494, 'f1': 0.6902592, 'auroc': 0.86196816, 'binary_precision': 0.63500535, 'binary_recall': 0.9444444, 'binary_specificity': 0.47465438, 'binary_f1_score': 0.7594129}
confusion matrix:
     0    1
0  309  342
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7196653, 'precision': 0.7893389, 'recall': 0.70443565, 'specificity': 0.70443565, 'f1': 0.6916841, 'auroc': 0.88490117, 'binary_precision': 0.6612466, 'binary_recall': 0.9644269, 'binary_specificity': 0.44444445, 'binary_f1_score': 0.78456587}
confusion matrix:
     0    1
0  100  125
1    9  244
early stop counter: 1
val acc:0.7056986689567566, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7343096137046814 / 0.7364016771316528
after epoch: 22,now: 2024-07-12 12:47:09.520948,epoch time: 0:09:17.046506,used: 3:21:37.649845,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.96780497, 'precision': 0.8677262, 'recall': 0.74306583, 'specificity': 0.74306583, 'f1': 0.7911757, 'auroc': 0.9539788, 'binary_precision': 0.97456086, 'binary_recall': 0.9920528, 'binary_specificity': 0.49407893, 'binary_f1_score': 0.98322904}
confusion matrix:
     0      1
0  751    769
1  236  29460
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.769603, 'recall': 0.7186892, 'specificity': 0.7186892, 'f1': 0.7020241, 'auroc': 0.86290693, 'binary_precision': 0.64417845, 'binary_recall': 0.93968254, 'binary_specificity': 0.49769586, 'binary_f1_score': 0.7643641}
confusion matrix:
     0    1
0  324  327
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73221755, 'precision': 0.79695773, 'recall': 0.717769, 'specificity': 0.717769, 'f1': 0.70786864, 'auroc': 0.88593763, 'binary_precision': 0.6721763, 'binary_recall': 0.9644269, 'binary_specificity': 0.47111112, 'binary_f1_score': 0.79220784}
confusion matrix:
     0    1
0  106  119
1    9  244
early stop counter: 2
val acc:0.7150663733482361, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7343096137046814 / 0.7364016771316528
after epoch: 23,now: 2024-07-12 12:56:31.427492,epoch time: 0:09:21.906544,used: 3:30:59.556389,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.96790105, 'precision': 0.8610356, 'recall': 0.75388694, 'specificity': 0.75388694, 'f1': 0.79699147, 'auroc': 0.9542984, 'binary_precision': 0.97563237, 'binary_recall': 0.9910086, 'binary_specificity': 0.5167653, 'binary_f1_score': 0.9832604}
confusion matrix:
     0      1
0  786    735
1  267  29428
---- Validation: 
scalar performance:
{'acc': 0.7150664, 'precision': 0.769603, 'recall': 0.7186892, 'specificity': 0.7186892, 'f1': 0.7020241, 'auroc': 0.8653866, 'binary_precision': 0.64417845, 'binary_recall': 0.93968254, 'binary_specificity': 0.49769586, 'binary_f1_score': 0.7643641}
confusion matrix:
     0    1
0  324  327
1   38  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73849374, 'precision': 0.8007533, 'recall': 0.7244357, 'specificity': 0.7244357, 'f1': 0.71582663, 'auroc': 0.8891348, 'binary_precision': 0.67777777, 'binary_recall': 0.9644269, 'binary_specificity': 0.48444444, 'binary_f1_score': 0.7960848}
confusion matrix:
     0    1
0  109  116
1    9  244
new oracle model saved
early stop counter: 3
val acc:0.7150663733482361, best validation acc: 0.7150663733482361, corresponding to test acc:                         0.7343096137046814 / 0.7384937405586243
after epoch: 24,now: 2024-07-12 13:06:01.986328,epoch time: 0:09:30.558836,used: 3:40:30.115225,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.96754867, 'precision': 0.86336297, 'recall': 0.7449687, 'specificity': 0.7449687, 'f1': 0.7912679, 'auroc': 0.9566625, 'binary_precision': 0.9747418, 'binary_recall': 0.9915811, 'binary_specificity': 0.49835634, 'binary_f1_score': 0.9830894}
confusion matrix:
     0      1
0  758    763
1  250  29445
---- Validation: 
scalar performance:
{'acc': 0.715847, 'precision': 0.77295005, 'recall': 0.71953404, 'specificity': 0.71953404, 'f1': 0.7023273, 'auroc': 0.8674426, 'binary_precision': 0.6439394, 'binary_recall': 0.9444444, 'binary_specificity': 0.49462366, 'binary_f1_score': 0.7657658}
confusion matrix:
     0    1
0  322  329
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.89198065, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
better model found
persisted
after epoch: 25,now: 2024-07-12 13:15:32.221273,epoch time: 0:09:30.234945,used: 3:50:00.350170,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.96790105, 'precision': 0.856842, 'recall': 0.7601248, 'specificity': 0.7601248, 'f1': 0.79996437, 'auroc': 0.9562968, 'binary_precision': 0.976264, 'binary_recall': 0.99033505, 'binary_specificity': 0.52991456, 'binary_f1_score': 0.98324925}
confusion matrix:
     0      1
0  806    715
1  287  29408
---- Validation: 
scalar performance:
{'acc': 0.71975017, 'precision': 0.7734973, 'recall': 0.7233231, 'specificity': 0.7233231, 'f1': 0.70731926, 'auroc': 0.8686514, 'binary_precision': 0.64808744, 'binary_recall': 0.9412698, 'binary_specificity': 0.50537634, 'binary_f1_score': 0.76763755}
confusion matrix:
     0    1
0  329  322
1   37  593
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73849374, 'precision': 0.8007533, 'recall': 0.7244357, 'specificity': 0.7244357, 'f1': 0.71582663, 'auroc': 0.89306986, 'binary_precision': 0.67777777, 'binary_recall': 0.9644269, 'binary_specificity': 0.48444444, 'binary_f1_score': 0.7960848}
confusion matrix:
     0    1
0  109  116
1    9  244
better model found
persisted
after epoch: 26,now: 2024-07-12 13:24:59.996863,epoch time: 0:09:27.775590,used: 3:59:28.125760,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9689262, 'precision': 0.8693654, 'recall': 0.7587923, 'specificity': 0.7587923, 'f1': 0.803182, 'auroc': 0.9599656, 'binary_precision': 0.9760997, 'binary_recall': 0.99161476, 'binary_specificity': 0.52596974, 'binary_f1_score': 0.983796}
confusion matrix:
     0      1
0  800    721
1  249  29446
---- Validation: 
scalar performance:
{'acc': 0.71662766, 'precision': 0.77440935, 'recall': 0.72032773, 'specificity': 0.72032773, 'f1': 0.7030414, 'auroc': 0.87076783, 'binary_precision': 0.6443243, 'binary_recall': 0.94603175, 'binary_specificity': 0.49462366, 'binary_f1_score': 0.7665594}
confusion matrix:
     0    1
0  322  329
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73012555, 'precision': 0.79569113, 'recall': 0.7155468, 'specificity': 0.7155468, 'f1': 0.70519644, 'auroc': 0.8956697, 'binary_precision': 0.6703297, 'binary_recall': 0.9644269, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.79092383}
confusion matrix:
     0    1
0  105  120
1    9  244
early stop counter: 1
val acc:0.7166276574134827, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7384937405586243 / 0.7384937405586243
after epoch: 27,now: 2024-07-12 13:34:26.871446,epoch time: 0:09:26.874583,used: 4:08:55.000343,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9688301, 'precision': 0.871863, 'recall': 0.75406337, 'specificity': 0.75406337, 'f1': 0.80056715, 'auroc': 0.9594115, 'binary_precision': 0.9756243, 'binary_recall': 0.9920189, 'binary_specificity': 0.5161078, 'binary_f1_score': 0.98375326}
confusion matrix:
     0      1
0  785    736
1  237  29458
---- Validation: 
scalar performance:
{'acc': 0.71818894, 'precision': 0.7744074, 'recall': 0.7218382, 'specificity': 0.7218382, 'f1': 0.7050874, 'auroc': 0.8718358, 'binary_precision': 0.6460369, 'binary_recall': 0.9444444, 'binary_specificity': 0.49923196, 'binary_f1_score': 0.76724696}
confusion matrix:
     0    1
0  325  326
1   35  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.7982235, 'recall': 0.7199912, 'specificity': 0.7199912, 'f1': 0.710531, 'auroc': 0.89723325, 'binary_precision': 0.67403316, 'binary_recall': 0.9644269, 'binary_specificity': 0.47555557, 'binary_f1_score': 0.79349595}
confusion matrix:
     0    1
0  107  118
1    9  244
early stop counter: 2
val acc:0.7181889414787292, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7384937405586243 / 0.7384937405586243
after epoch: 28,now: 2024-07-12 13:43:50.843691,epoch time: 0:09:23.972245,used: 4:18:18.972588,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9682214, 'precision': 0.8726646, 'recall': 0.74376285, 'specificity': 0.74376285, 'f1': 0.7931654, 'auroc': 0.9598329, 'binary_precision': 0.97460234, 'binary_recall': 0.9924566, 'binary_specificity': 0.49506903, 'binary_f1_score': 0.98344845}
confusion matrix:
     0      1
0  753    768
1  224  29471
---- Validation: 
scalar performance:
{'acc': 0.70882124, 'precision': 0.76958364, 'recall': 0.7126472, 'specificity': 0.7126472, 'f1': 0.69376945, 'auroc': 0.8735913, 'binary_precision': 0.6374332, 'binary_recall': 0.94603175, 'binary_specificity': 0.47926268, 'binary_f1_score': 0.76166135}
confusion matrix:
     0    1
0  312  339
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7280335, 'precision': 0.8012233, 'recall': 0.7128327, 'specificity': 0.7128327, 'f1': 0.7008876, 'auroc': 0.8988669, 'binary_precision': 0.6666667, 'binary_recall': 0.972332, 'binary_specificity': 0.45333335, 'binary_f1_score': 0.7909968}
confusion matrix:
     0    1
0  102  123
1    7  246
early stop counter: 3
val acc:0.7088212370872498, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7384937405586243 / 0.7384937405586243
after epoch: 29,now: 2024-07-12 13:53:40.109906,epoch time: 0:09:49.266215,used: 4:28:08.238803,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9686379, 'precision': 0.8674927, 'recall': 0.75676936, 'specificity': 0.75676936, 'f1': 0.80113375, 'auroc': 0.96271384, 'binary_precision': 0.9759032, 'binary_recall': 0.9915137, 'binary_specificity': 0.522025, 'binary_f1_score': 0.9836465}
confusion matrix:
     0      1
0  794    727
1  252  29443
---- Validation: 
scalar performance:
{'acc': 0.7119438, 'precision': 0.77151453, 'recall': 0.7157194, 'specificity': 0.7157194, 'f1': 0.69749093, 'auroc': 0.8745081, 'binary_precision': 0.6401719, 'binary_recall': 0.94603175, 'binary_specificity': 0.48540705, 'binary_f1_score': 0.76361316}
confusion matrix:
     0    1
0  316  335
1   34  596
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7343096, 'precision': 0.80481553, 'recall': 0.71949935, 'specificity': 0.71949935, 'f1': 0.7089879, 'auroc': 0.89960474, 'binary_precision': 0.6721311, 'binary_recall': 0.972332, 'binary_specificity': 0.46666667, 'binary_f1_score': 0.7948304}
confusion matrix:
     0    1
0  105  120
1    7  246
early stop counter: 4
val acc:0.7119438052177429, best validation acc: 0.719750165939331, corresponding to test acc:                         0.7384937405586243 / 0.7384937405586243
after epoch: 30,now: 2024-07-12 14:03:31.130253,epoch time: 0:09:51.020347,used: 4:37:59.259150,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_09_25_31_seed_1_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:37:59.259150 at 2024-07-12 14:03:31.130253
persisted model performance metric: 

scalar performance:
{'acc': 0.73849374, 'precision': 0.8007533, 'recall': 0.7244357, 'specificity': 0.7244357, 'f1': 0.71582663, 'auroc': 0.89306986, 'binary_precision': 0.67777777, 'binary_recall': 0.9644269, 'binary_specificity': 0.48444444, 'binary_f1_score': 0.7960848}
confusion matrix:
     0    1
0  109  116
1    9  244
oracle model performance metric: 

scalar performance:
{'acc': 0.73849374, 'precision': 0.8007533, 'recall': 0.7244357, 'specificity': 0.7244357, 'f1': 0.71582663, 'auroc': 0.8891348, 'binary_precision': 0.67777777, 'binary_recall': 0.9644269, 'binary_specificity': 0.48444444, 'binary_f1_score': 0.7960848}
confusion matrix:
     0    1
0  109  116
1    9  244
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |  16391 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |  16198 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |    792 MiB | 284672 KiB |
|       from large pool | 487424 KiB | 487424 KiB |    738 MiB | 268288 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     54 MiB |  16384 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  35394 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  31306 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |   4088 KiB |  11184 KiB |   9283 GiB |   9283 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4385    |  100306 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57742 K  |   57741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4385    |  100306 K  |  100305 K  |
|       from large pool |      76    |     158    |   42564 K  |   42564 K  |
|       from small pool |     718    |    4307    |   57742 K  |   57741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      60    |      19    |
|       from large pool |      22    |      22    |      33    |      11    |
|       from small pool |      19    |      19    |      27    |       8    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      37    |    1972    |   57336 K  |   57336 K  |
|       from large pool |      10    |      22    |   24955 K  |   24955 K  |
|       from small pool |      27    |    1962    |   32381 K  |   32381 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9284 GiB |   9284 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100306 K  |  100306 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57742 K  |   57742 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100306 K  |  100306 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57742 K  |   57742 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57336 K  |   57336 K  |
|       from large pool |       3    |      22    |   24955 K  |   24955 K  |
|       from small pool |       0    |    1962    |   32381 K  |   32381 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 440805 GiB | 440805 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 431745 GiB | 431745 GiB |
|       from small pool |      0 KiB |  33617 KiB |   9059 GiB |   9059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 440782 GiB | 440782 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 431742 GiB | 431742 GiB |
|       from small pool |      0 KiB |  33425 KiB |   9040 GiB |   9040 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 225280 KiB | 526336 KiB |    792 MiB | 585728 KiB |
|       from large pool | 204800 KiB | 487424 KiB |    738 MiB | 550912 KiB |
|       from small pool |  20480 KiB |  38912 KiB |     54 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB |  84596 KiB | 242143 GiB | 242143 GiB |
|       from large pool |  23872 KiB |  79555 KiB | 232859 GiB | 232859 GiB |
|       from small pool |      0 KiB |  11184 KiB |   9284 GiB |   9284 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4385    |  100306 K  |  100306 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57742 K  |   57742 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4385    |  100306 K  |  100306 K  |
|       from large pool |       2    |     158    |   42564 K  |   42564 K  |
|       from small pool |       0    |    4307    |   57742 K  |   57742 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      41    |      60    |      40    |
|       from large pool |      10    |      22    |      33    |      23    |
|       from small pool |      10    |      19    |      27    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1972    |   57336 K  |   57336 K  |
|       from large pool |       3    |      22    |   24955 K  |   24955 K  |
|       from small pool |       0    |    1962    |   32381 K  |   32381 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'44271c83'
model name: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478

 Experiment start at: 2024-07-12 14:17:38.385360
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.3810526132583618
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.8797807, 'precision': 0.5307388, 'recall': 0.55520564, 'specificity': 0.55520564, 'f1': 0.53572345, 'auroc': 0.6219379, 'binary_precision': 0.95726705, 'binary_recall': 0.914501, 'binary_specificity': 0.19591029, 'binary_f1_score': 0.93539554}
confusion matrix:
      0      1
0   297   1219
1  2553  27307
---- Validation: 
scalar performance:
{'acc': 0.5195618, 'precision': 0.5938235, 'recall': 0.5305123, 'specificity': 0.5305123, 'f1': 0.4294062, 'auroc': 0.6883627, 'binary_precision': 0.50343645, 'binary_recall': 0.94212216, 'binary_specificity': 0.11890244, 'binary_f1_score': 0.656215}
confusion matrix:
    0    1
0  78  578
1  36  586
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5326316, 'precision': 0.4264025, 'recall': 0.49033853, 'specificity': 0.49033853, 'f1': 0.36695564, 'auroc': 0.30535892, 'binary_precision': 0.540305, 'binary_recall': 0.95752895, 'binary_specificity': 0.023148147, 'binary_f1_score': 0.6908078}
confusion matrix:
    0    1
0   5  211
1  11  248
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-12 14:27:14.374440,epoch time: 0:09:35.989080,used: 0:09:35.989080,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9440974, 'precision': 0.5866826, 'recall': 0.5251303, 'specificity': 0.5251303, 'f1': 0.53351665, 'auroc': 0.66487086, 'binary_precision': 0.95402557, 'binary_recall': 0.9889149, 'binary_specificity': 0.061345648, 'binary_f1_score': 0.97115695}
confusion matrix:
     0      1
0   93   1423
1  331  29529
---- Validation: 
scalar performance:
{'acc': 0.4968701, 'precision': 0.6505853, 'recall': 0.5097419, 'specificity': 0.5097419, 'f1': 0.35400912, 'auroc': 0.7164316, 'binary_precision': 0.49164677, 'binary_recall': 0.99356914, 'binary_specificity': 0.025914634, 'binary_f1_score': 0.6577967}
confusion matrix:
    0    1
0  17  639
1   4  618
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.33967894, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
new oracle model saved
early stop counter: 1
val acc:0.49687010049819946, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 2,now: 2024-07-12 14:37:02.431009,epoch time: 0:09:48.056569,used: 0:19:24.045649,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9494837, 'precision': 0.6302156, 'recall': 0.5160635, 'specificity': 0.5160635, 'f1': 0.5194687, 'auroc': 0.7231952, 'binary_precision': 0.9531686, 'binary_recall': 0.9958473, 'binary_specificity': 0.036279682, 'binary_f1_score': 0.9740407}
confusion matrix:
     0      1
0   55   1461
1  124  29736
---- Validation: 
scalar performance:
{'acc': 0.49295774, 'precision': 0.6615324, 'recall': 0.5060142, 'specificity': 0.5060142, 'f1': 0.3433599, 'auroc': 0.7381921, 'binary_precision': 0.48973143, 'binary_recall': 0.99678457, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65677965}
confusion matrix:
    0    1
0  10  646
1   2  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.38770914, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 2
val acc:0.49295774102211, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 3,now: 2024-07-12 14:46:33.364652,epoch time: 0:09:30.933643,used: 0:28:54.979292,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9514916, 'precision': 0.7153839, 'recall': 0.519623, 'specificity': 0.519623, 'f1': 0.525774, 'auroc': 0.7677643, 'binary_precision': 0.9534951, 'binary_recall': 0.9976892, 'binary_specificity': 0.041556727, 'binary_f1_score': 0.97509164}
confusion matrix:
    0      1
0  63   1453
1  69  29791
---- Validation: 
scalar performance:
{'acc': 0.49374023, 'precision': 0.69961256, 'recall': 0.5068181, 'specificity': 0.5068181, 'f1': 0.34373787, 'auroc': 0.7539164, 'binary_precision': 0.49013418, 'binary_recall': 0.9983923, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65749073}
confusion matrix:
    0    1
0  10  646
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.43649006, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 3
val acc:0.4937402307987213, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 4,now: 2024-07-12 14:55:54.784844,epoch time: 0:09:21.420192,used: 0:38:16.399484,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.951874, 'precision': 0.73853326, 'recall': 0.5210762, 'specificity': 0.5210762, 'f1': 0.52839905, 'auroc': 0.8055978, 'binary_precision': 0.953629, 'binary_recall': 0.9979571, 'binary_specificity': 0.04419525, 'binary_f1_score': 0.9752896}
confusion matrix:
    0      1
0  67   1449
1  61  29799
---- Validation: 
scalar performance:
{'acc': 0.49374023, 'precision': 0.69961256, 'recall': 0.5068181, 'specificity': 0.5068181, 'f1': 0.34373787, 'auroc': 0.76631916, 'binary_precision': 0.49013418, 'binary_recall': 0.9983923, 'binary_specificity': 0.015243903, 'binary_f1_score': 0.65749073}
confusion matrix:
    0    1
0  10  646
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.4841091, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 4
val acc:0.4937402307987213, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 5,now: 2024-07-12 15:05:23.001733,epoch time: 0:09:28.216889,used: 0:47:44.616373,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9518422, 'precision': 0.73624134, 'recall': 0.5216856, 'specificity': 0.5216856, 'f1': 0.52947915, 'auroc': 0.8347821, 'binary_precision': 0.95368564, 'binary_recall': 0.9978567, 'binary_specificity': 0.045514513, 'binary_f1_score': 0.9752712}
confusion matrix:
    0      1
0  69   1447
1  64  29796
---- Validation: 
scalar performance:
{'acc': 0.4976526, 'precision': 0.714788, 'recall': 0.51062906, 'specificity': 0.51062906, 'f1': 0.35193926, 'auroc': 0.7753215, 'binary_precision': 0.49207607, 'binary_recall': 0.9983923, 'binary_specificity': 0.022865854, 'binary_f1_score': 0.65923566}
confusion matrix:
    0    1
0  15  641
1   1  621
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.5201452, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 5
val acc:0.4976525902748108, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 6,now: 2024-07-12 15:14:52.105263,epoch time: 0:09:29.103530,used: 0:57:13.719903,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9527346, 'precision': 0.7848319, 'recall': 0.5281028, 'specificity': 0.5281028, 'f1': 0.5409068, 'auroc': 0.86364985, 'binary_precision': 0.9542791, 'binary_recall': 0.9981581, 'binary_specificity': 0.058047492, 'binary_f1_score': 0.9757256}
confusion matrix:
    0      1
0  88   1428
1  55  29805
---- Validation: 
scalar performance:
{'acc': 0.5054773, 'precision': 0.7122857, 'recall': 0.51820934, 'specificity': 0.51820934, 'f1': 0.3692083, 'auroc': 0.7821078, 'binary_precision': 0.496, 'binary_recall': 0.99678457, 'binary_specificity': 0.039634146, 'binary_f1_score': 0.6623932}
confusion matrix:
    0    1
0  26  630
1   2  620
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.55176604, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 6
val acc:0.5054773092269897, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 7,now: 2024-07-12 15:24:15.149716,epoch time: 0:09:23.044453,used: 1:06:36.764356,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9534995, 'precision': 0.80549204, 'recall': 0.5385229, 'specificity': 0.5385229, 'f1': 0.5586812, 'auroc': 0.87724555, 'binary_precision': 0.9552464, 'binary_recall': 0.9978902, 'binary_specificity': 0.079155676, 'binary_f1_score': 0.97610277}
confusion matrix:
     0      1
0  120   1396
1   63  29797
---- Validation: 
scalar performance:
{'acc': 0.513302, 'precision': 0.7125, 'recall': 0.5257896, 'specificity': 0.5257896, 'f1': 0.38595662, 'auroc': 0.787524, 'binary_precision': 0.5, 'binary_recall': 0.99517685, 'binary_specificity': 0.056402437, 'binary_f1_score': 0.6655914}
confusion matrix:
    0    1
0  37  619
1   3  619
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.58140284, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
early stop counter: 7
val acc:0.5133020281791687, best validation acc: 0.5195618271827698, corresponding to test acc:                         0.5326315760612488 / 0.5494737029075623
after epoch: 8,now: 2024-07-12 15:33:35.509070,epoch time: 0:09:20.359354,used: 1:15:57.123710,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9547425, 'precision': 0.8446088, 'recall': 0.5488812, 'specificity': 0.5488812, 'f1': 0.5760551, 'auroc': 0.890494, 'binary_precision': 0.9562079, 'binary_recall': 0.9981581, 'binary_specificity': 0.09960422, 'binary_f1_score': 0.97673273}
confusion matrix:
     0      1
0  151   1365
1   55  29805
---- Validation: 
scalar performance:
{'acc': 0.52425665, 'precision': 0.70976543, 'recall': 0.5363771, 'specificity': 0.5363771, 'f1': 0.4091917, 'auroc': 0.79187906, 'binary_precision': 0.5057377, 'binary_recall': 0.9919614, 'binary_specificity': 0.08079268, 'binary_f1_score': 0.669924}
confusion matrix:
    0    1
0  53  603
1   5  617
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.60521233, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 9,now: 2024-07-12 15:42:55.283507,epoch time: 0:09:19.774437,used: 1:25:16.898147,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9549337, 'precision': 0.8304746, 'recall': 0.55680835, 'specificity': 0.55680835, 'f1': 0.5880674, 'auroc': 0.8957081, 'binary_precision': 0.9569492, 'binary_recall': 0.99752176, 'binary_specificity': 0.116094984, 'binary_f1_score': 0.9768144}
confusion matrix:
     0      1
0  176   1340
1   74  29786
---- Validation: 
scalar performance:
{'acc': 0.5375587, 'precision': 0.7121599, 'recall': 0.549251, 'specificity': 0.549251, 'f1': 0.4356857, 'auroc': 0.79548174, 'binary_precision': 0.5129274, 'binary_recall': 0.988746, 'binary_specificity': 0.1097561, 'binary_f1_score': 0.675453}
confusion matrix:
    0    1
0  72  584
1   7  615
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5494737, 'precision': 0.7737844, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.36299944, 'auroc': 0.6242492, 'binary_precision': 0.54756874, 'binary_recall': 1.0, 'binary_specificity': 0.009259259, 'binary_f1_score': 0.70765024}
confusion matrix:
   0    1
0  2  214
1  0  259
better model found
persisted
after epoch: 10,now: 2024-07-12 15:52:15.731103,epoch time: 0:09:20.447596,used: 1:34:37.345743,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9563998, 'precision': 0.8660282, 'recall': 0.56790996, 'specificity': 0.56790996, 'f1': 0.6058019, 'auroc': 0.90131664, 'binary_precision': 0.95798236, 'binary_recall': 0.9979571, 'binary_specificity': 0.1378628, 'binary_f1_score': 0.9775612}
confusion matrix:
     0      1
0  209   1307
1   61  29799
---- Validation: 
scalar performance:
{'acc': 0.5516432, 'precision': 0.71585333, 'recall': 0.56288725, 'specificity': 0.56288725, 'f1': 0.46227717, 'auroc': 0.7981243, 'binary_precision': 0.5208156, 'binary_recall': 0.98553056, 'binary_specificity': 0.1402439, 'binary_f1_score': 0.68148965}
confusion matrix:
    0    1
0  92  564
1   9  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56842107, 'precision': 0.7790948, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.40668774, 'auroc': 0.64042616, 'binary_precision': 0.55818963, 'binary_recall': 1.0, 'binary_specificity': 0.050925925, 'binary_f1_score': 0.71645916}
confusion matrix:
    0    1
0  11  205
1   0  259
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-12 16:01:33.466860,epoch time: 0:09:17.735757,used: 1:43:55.081500,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9570054, 'precision': 0.8473774, 'recall': 0.58450776, 'specificity': 0.58450776, 'f1': 0.6284186, 'auroc': 0.91506994, 'binary_precision': 0.9595435, 'binary_recall': 0.996852, 'binary_specificity': 0.17216359, 'binary_f1_score': 0.97784203}
confusion matrix:
     0      1
0  261   1255
1   94  29766
---- Validation: 
scalar performance:
{'acc': 0.5625978, 'precision': 0.7244121, 'recall': 0.573558, 'specificity': 0.573558, 'f1': 0.48090112, 'auroc': 0.80080235, 'binary_precision': 0.5270851, 'binary_recall': 0.98553056, 'binary_specificity': 0.16158536, 'binary_f1_score': 0.6868347}
confusion matrix:
     0    1
0  106  550
1    9  613
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58105266, 'precision': 0.7827511, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.43418872, 'auroc': 0.6561562, 'binary_precision': 0.56550217, 'binary_recall': 1.0, 'binary_specificity': 0.0787037, 'binary_f1_score': 0.72245467}
confusion matrix:
    0    1
0  17  199
1   0  259
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-12 16:10:55.596812,epoch time: 0:09:22.129952,used: 1:53:17.211452,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9582165, 'precision': 0.8563857, 'recall': 0.59923226, 'specificity': 0.59923226, 'f1': 0.64835024, 'auroc': 0.91042817, 'binary_precision': 0.9609287, 'binary_recall': 0.99661756, 'binary_specificity': 0.20184697, 'binary_f1_score': 0.9784478}
confusion matrix:
     0      1
0  306   1210
1  101  29759
---- Validation: 
scalar performance:
{'acc': 0.57902974, 'precision': 0.720606, 'recall': 0.58935577, 'specificity': 0.58935577, 'f1': 0.51122475, 'auroc': 0.8019053, 'binary_precision': 0.53710246, 'binary_recall': 0.977492, 'binary_specificity': 0.20121951, 'binary_f1_score': 0.6932725}
confusion matrix:
     0    1
0  132  524
1   14  608
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5978947, 'precision': 0.7877778, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.46903768, 'auroc': 0.66732806, 'binary_precision': 0.57555556, 'binary_recall': 1.0, 'binary_specificity': 0.11574074, 'binary_f1_score': 0.7306065}
confusion matrix:
    0    1
0  25  191
1   0  259
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-12 16:20:21.555547,epoch time: 0:09:25.958735,used: 2:02:43.170187,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9591726, 'precision': 0.8590902, 'recall': 0.61257046, 'specificity': 0.61257046, 'f1': 0.6651577, 'auroc': 0.91335267, 'binary_precision': 0.9621891, 'binary_recall': 0.99624914, 'binary_specificity': 0.22889182, 'binary_f1_score': 0.97892296}
confusion matrix:
     0      1
0  347   1169
1  112  29748
---- Validation: 
scalar performance:
{'acc': 0.59311426, 'precision': 0.72775096, 'recall': 0.6030336, 'specificity': 0.6030336, 'f1': 0.53375596, 'auroc': 0.8034345, 'binary_precision': 0.54586333, 'binary_recall': 0.97588426, 'binary_specificity': 0.23018293, 'binary_f1_score': 0.7001153}
confusion matrix:
     0    1
0  151  505
1   15  607
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.77322096, 'recall': 0.56519914, 'specificity': 0.56519914, 'f1': 0.48436344, 'auroc': 0.6764622, 'binary_precision': 0.5797753, 'binary_recall': 0.996139, 'binary_specificity': 0.13425925, 'binary_f1_score': 0.73295456}
confusion matrix:
    0    1
0  29  187
1   1  258
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-12 16:29:43.857061,epoch time: 0:09:22.301514,used: 2:12:05.471701,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9604156, 'precision': 0.8504226, 'recall': 0.6382692, 'specificity': 0.6382692, 'f1': 0.69348335, 'auroc': 0.928563, 'binary_precision': 0.9646383, 'binary_recall': 0.9948761, 'binary_specificity': 0.28166226, 'binary_f1_score': 0.9795239}
confusion matrix:
     0      1
0  427   1089
1  153  29707
---- Validation: 
scalar performance:
{'acc': 0.6095462, 'precision': 0.7296754, 'recall': 0.61887306, 'specificity': 0.61887306, 'f1': 0.56048125, 'auroc': 0.80480206, 'binary_precision': 0.5567867, 'binary_recall': 0.9694534, 'binary_specificity': 0.2682927, 'binary_f1_score': 0.7073314}
confusion matrix:
     0    1
0  176  480
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60421056, 'precision': 0.7461318, 'recall': 0.56596774, 'specificity': 0.56596774, 'f1': 0.48971426, 'auroc': 0.6864722, 'binary_precision': 0.5804989, 'binary_recall': 0.98841697, 'binary_specificity': 0.14351852, 'binary_f1_score': 0.73142856}
confusion matrix:
    0    1
0  31  185
1   3  256
better model found
persisted
after epoch: 15,now: 2024-07-12 16:39:02.914128,epoch time: 0:09:19.057067,used: 2:21:24.528768,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.961563, 'precision': 0.8640429, 'recall': 0.6460726, 'specificity': 0.6460726, 'f1': 0.7037323, 'auroc': 0.92803013, 'binary_precision': 0.9653739, 'binary_recall': 0.99531144, 'binary_specificity': 0.29683378, 'binary_f1_score': 0.98011416}
confusion matrix:
     0      1
0  450   1066
1  140  29720
---- Validation: 
scalar performance:
{'acc': 0.6126761, 'precision': 0.7316867, 'recall': 0.62192184, 'specificity': 0.62192184, 'f1': 0.56502366, 'auroc': 0.8069122, 'binary_precision': 0.55885077, 'binary_recall': 0.9694534, 'binary_specificity': 0.27439025, 'binary_f1_score': 0.7089947}
confusion matrix:
     0    1
0  180  476
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105263, 'precision': 0.7411492, 'recall': 0.5732965, 'specificity': 0.5732965, 'f1': 0.50416136, 'auroc': 0.69601744, 'binary_precision': 0.5848624, 'binary_recall': 0.98455596, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.7338129}
confusion matrix:
    0    1
0  35  181
1   4  255
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-12 16:48:26.957164,epoch time: 0:09:24.043036,used: 2:30:48.571804,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9607343, 'precision': 0.8454766, 'recall': 0.64782876, 'specificity': 0.64782876, 'f1': 0.7027904, 'auroc': 0.9281086, 'binary_precision': 0.9655565, 'binary_recall': 0.9942063, 'binary_specificity': 0.30145118, 'binary_f1_score': 0.979672}
confusion matrix:
     0      1
0  457   1059
1  173  29687
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.73464644, 'recall': 0.626495, 'specificity': 0.626495, 'f1': 0.5717801, 'auroc': 0.80881405, 'binary_precision': 0.5619758, 'binary_recall': 0.9694534, 'binary_specificity': 0.28353658, 'binary_f1_score': 0.71150446}
confusion matrix:
     0    1
0  186  470
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6105263, 'precision': 0.7411492, 'recall': 0.5732965, 'specificity': 0.5732965, 'f1': 0.50416136, 'auroc': 0.70390034, 'binary_precision': 0.5848624, 'binary_recall': 0.98455596, 'binary_specificity': 0.16203703, 'binary_f1_score': 0.7338129}
confusion matrix:
    0    1
0  35  181
1   4  255
better model found
persisted
after epoch: 17,now: 2024-07-12 16:57:51.639548,epoch time: 0:09:24.682384,used: 2:40:13.254188,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9630291, 'precision': 0.87594634, 'recall': 0.65936565, 'specificity': 0.65936565, 'f1': 0.71940285, 'auroc': 0.93016076, 'binary_precision': 0.9666363, 'binary_recall': 0.99551237, 'binary_specificity': 0.323219, 'binary_f1_score': 0.98086184}
confusion matrix:
     0      1
0  490   1026
1  134  29726
---- Validation: 
scalar performance:
{'acc': 0.6228482, 'precision': 0.73802173, 'recall': 0.63183033, 'specificity': 0.63183033, 'f1': 0.5795777, 'auroc': 0.8110087, 'binary_precision': 0.565666, 'binary_recall': 0.9694534, 'binary_specificity': 0.2942073, 'binary_f1_score': 0.714455}
confusion matrix:
     0    1
0  193  463
1   19  603
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61263156, 'precision': 0.74310344, 'recall': 0.5756113, 'specificity': 0.5756113, 'f1': 0.50806016, 'auroc': 0.71190834, 'binary_precision': 0.5862069, 'binary_recall': 0.98455596, 'binary_specificity': 0.16666667, 'binary_f1_score': 0.7348703}
confusion matrix:
    0    1
0  36  180
1   4  255
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-12 17:07:16.097927,epoch time: 0:09:24.458379,used: 2:49:37.712567,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9617542, 'precision': 0.8398191, 'recall': 0.6715318, 'specificity': 0.6715318, 'f1': 0.724829, 'auroc': 0.9314028, 'binary_precision': 0.967842, 'binary_recall': 0.99279976, 'binary_specificity': 0.35026386, 'binary_f1_score': 0.980162}
confusion matrix:
     0      1
0  531    985
1  215  29645
---- Validation: 
scalar performance:
{'acc': 0.63067293, 'precision': 0.7341267, 'recall': 0.63924396, 'specificity': 0.63924396, 'f1': 0.5927474, 'auroc': 0.8129535, 'binary_precision': 0.5717017, 'binary_recall': 0.9614148, 'binary_specificity': 0.31707317, 'binary_f1_score': 0.71702635}
confusion matrix:
     0    1
0  208  448
1   24  598
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6231579, 'precision': 0.7520672, 'recall': 0.5871854, 'specificity': 0.5871854, 'f1': 0.52718973, 'auroc': 0.7221149, 'binary_precision': 0.59302324, 'binary_recall': 0.98455596, 'binary_specificity': 0.18981482, 'binary_f1_score': 0.74020314}
confusion matrix:
    0    1
0  41  175
1   4  255
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-12 17:16:42.224300,epoch time: 0:09:26.126373,used: 2:59:03.838940,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.962551, 'precision': 0.845433, 'recall': 0.67915106, 'specificity': 0.67915106, 'f1': 0.7329474, 'auroc': 0.9364761, 'binary_precision': 0.96857136, 'binary_recall': 0.9928667, 'binary_specificity': 0.36543536, 'binary_f1_score': 0.9805685}
confusion matrix:
     0      1
0  554    962
1  213  29647
---- Validation: 
scalar performance:
{'acc': 0.63771516, 'precision': 0.7338989, 'recall': 0.64597875, 'specificity': 0.64597875, 'f1': 0.603584, 'auroc': 0.8141861, 'binary_precision': 0.5771096, 'binary_recall': 0.95659167, 'binary_specificity': 0.33536586, 'binary_f1_score': 0.71990323}
confusion matrix:
     0    1
0  220  436
1   27  595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6294737, 'precision': 0.7413621, 'recall': 0.59489846, 'specificity': 0.59489846, 'f1': 0.5426095, 'auroc': 0.72876453, 'binary_precision': 0.59810877, 'binary_recall': 0.976834, 'binary_specificity': 0.21296297, 'binary_f1_score': 0.74193543}
confusion matrix:
    0    1
0  46  170
1   6  253
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-12 17:26:09.129075,epoch time: 0:09:26.904775,used: 3:08:30.743715,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9629972, 'precision': 0.8351693, 'recall': 0.7006743, 'specificity': 0.7006743, 'f1': 0.7490085, 'auroc': 0.9352616, 'binary_precision': 0.970676, 'binary_recall': 0.9910583, 'binary_specificity': 0.41029024, 'binary_f1_score': 0.98076123}
confusion matrix:
     0      1
0  622    894
1  267  29593
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.7311735, 'recall': 0.65038526, 'specificity': 0.65038526, 'f1': 0.61140364, 'auroc': 0.81512964, 'binary_precision': 0.58112097, 'binary_recall': 0.9501608, 'binary_specificity': 0.35060975, 'binary_f1_score': 0.7211715}
confusion matrix:
     0    1
0  230  426
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63789475, 'precision': 0.7418134, 'recall': 0.604542, 'specificity': 0.604542, 'f1': 0.5589124, 'auroc': 0.73421633, 'binary_precision': 0.60431653, 'binary_recall': 0.972973, 'binary_specificity': 0.2361111, 'binary_f1_score': 0.7455621}
confusion matrix:
    0    1
0  51  165
1   7  252
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-12 17:35:36.988195,epoch time: 0:09:27.859120,used: 3:17:58.602835,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9638896, 'precision': 0.85193884, 'recall': 0.69456863, 'specificity': 0.69456863, 'f1': 0.7480111, 'auroc': 0.9317765, 'binary_precision': 0.97005594, 'binary_recall': 0.99269927, 'binary_specificity': 0.396438, 'binary_f1_score': 0.981247}
confusion matrix:
     0      1
0  601    915
1  218  29642
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.73154604, 'recall': 0.64890254, 'specificity': 0.64890254, 'f1': 0.6089474, 'auroc': 0.817431, 'binary_precision': 0.5798237, 'binary_recall': 0.9517685, 'binary_specificity': 0.34603658, 'binary_f1_score': 0.720633}
confusion matrix:
     0    1
0  227  429
1   30  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63789475, 'precision': 0.7418134, 'recall': 0.604542, 'specificity': 0.604542, 'f1': 0.5589124, 'auroc': 0.74122334, 'binary_precision': 0.60431653, 'binary_recall': 0.972973, 'binary_specificity': 0.2361111, 'binary_f1_score': 0.7455621}
confusion matrix:
    0    1
0  51  165
1   7  252
early stop counter: 1
val acc:0.6408450603485107, best validation acc: 0.6424100399017334, corresponding to test acc:                         0.6378947496414185 / 0.6378947496414185
after epoch: 22,now: 2024-07-12 17:45:00.838460,epoch time: 0:09:23.850265,used: 3:27:22.453100,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9636665, 'precision': 0.84271574, 'recall': 0.70227814, 'specificity': 0.70227814, 'f1': 0.75226235, 'auroc': 0.9367795, 'binary_precision': 0.97081965, 'binary_recall': 0.9916276, 'binary_specificity': 0.41292876, 'binary_f1_score': 0.9811133}
confusion matrix:
     0      1
0  626    890
1  250  29610
---- Validation: 
scalar performance:
{'acc': 0.64084506, 'precision': 0.73154604, 'recall': 0.64890254, 'specificity': 0.64890254, 'f1': 0.6089474, 'auroc': 0.81922984, 'binary_precision': 0.5798237, 'binary_recall': 0.9517685, 'binary_specificity': 0.34603658, 'binary_f1_score': 0.720633}
confusion matrix:
     0    1
0  227  429
1   30  592
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7435626, 'recall': 0.6068569, 'specificity': 0.6068569, 'f1': 0.56242424, 'auroc': 0.74715793, 'binary_precision': 0.6057692, 'binary_recall': 0.972973, 'binary_specificity': 0.24074075, 'binary_f1_score': 0.7466666}
confusion matrix:
    0    1
0  52  164
1   7  252
new oracle model saved
early stop counter: 2
val acc:0.6408450603485107, best validation acc: 0.6424100399017334, corresponding to test acc:                         0.6378947496414185 / 0.6399999856948853
after epoch: 23,now: 2024-07-12 17:54:23.387233,epoch time: 0:09:22.548773,used: 3:36:45.001873,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9646226, 'precision': 0.85759, 'recall': 0.70027596, 'specificity': 0.70027596, 'f1': 0.7542393, 'auroc': 0.9408057, 'binary_precision': 0.97060174, 'binary_recall': 0.9929002, 'binary_specificity': 0.40765172, 'binary_f1_score': 0.98162436}
confusion matrix:
     0      1
0  618    898
1  212  29648
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.7313516, 'recall': 0.65263015, 'specificity': 0.65263015, 'f1': 0.6148732, 'auroc': 0.8209724, 'binary_precision': 0.58300394, 'binary_recall': 0.948553, 'binary_specificity': 0.3567073, 'binary_f1_score': 0.7221542}
confusion matrix:
     0    1
0  234  422
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6442105, 'precision': 0.7411196, 'recall': 0.6118708, 'specificity': 0.6118708, 'f1': 0.5712012, 'auroc': 0.75294936, 'binary_precision': 0.6092233, 'binary_recall': 0.969112, 'binary_specificity': 0.25462964, 'binary_f1_score': 0.7481371}
confusion matrix:
    0    1
0  55  161
1   8  251
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-12 18:03:50.402203,epoch time: 0:09:27.014970,used: 3:46:12.016843,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9648457, 'precision': 0.862226, 'recall': 0.6988278, 'specificity': 0.6988278, 'f1': 0.75407577, 'auroc': 0.9415839, 'binary_precision': 0.97045445, 'binary_recall': 0.99330205, 'binary_specificity': 0.40435356, 'binary_f1_score': 0.9817453}
confusion matrix:
     0      1
0  613    903
1  200  29660
---- Validation: 
scalar performance:
{'acc': 0.64475745, 'precision': 0.732708, 'recall': 0.6526719, 'specificity': 0.6526719, 'f1': 0.6145078, 'auroc': 0.8230384, 'binary_precision': 0.58284026, 'binary_recall': 0.9501608, 'binary_specificity': 0.35518292, 'binary_f1_score': 0.72249395}
confusion matrix:
     0    1
0  233  423
1   31  591
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6421053, 'precision': 0.73935795, 'recall': 0.60955596, 'specificity': 0.60955596, 'f1': 0.56775653, 'auroc': 0.76051056, 'binary_precision': 0.6077482, 'binary_recall': 0.969112, 'binary_specificity': 0.25, 'binary_f1_score': 0.7470238}
confusion matrix:
    0    1
0  54  162
1   8  251
early stop counter: 1
val acc:0.6447574496269226, best validation acc: 0.6447574496269226, corresponding to test acc:                         0.6442105174064636 / 0.6442105174064636
after epoch: 25,now: 2024-07-12 18:13:19.439877,epoch time: 0:09:29.037674,used: 3:55:41.054517,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9651007, 'precision': 0.8440853, 'recall': 0.7261989, 'specificity': 0.7261989, 'f1': 0.771475, 'auroc': 0.9425597, 'binary_precision': 0.97315526, 'binary_recall': 0.9906564, 'binary_specificity': 0.46174142, 'binary_f1_score': 0.9818278}
confusion matrix:
     0      1
0  700    816
1  279  29581
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.7434106, 'recall': 0.6709229, 'specificity': 0.6709229, 'f1': 0.6391869, 'auroc': 0.8233496, 'binary_precision': 0.597166, 'binary_recall': 0.948553, 'binary_specificity': 0.3932927, 'binary_f1_score': 0.7329193}
confusion matrix:
     0    1
0  258  398
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65894735, 'precision': 0.7476737, 'recall': 0.6284588, 'specificity': 0.6284588, 'f1': 0.59639347, 'auroc': 0.7637459, 'binary_precision': 0.6203474, 'binary_recall': 0.96525097, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.755287}
confusion matrix:
    0    1
0  63  153
1   9  250
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-12 18:22:44.484629,epoch time: 0:09:25.044752,used: 4:05:06.099269,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.96628, 'precision': 0.8611352, 'recall': 0.7230616, 'specificity': 0.7230616, 'f1': 0.77389216, 'auroc': 0.94220567, 'binary_precision': 0.97281504, 'binary_recall': 0.9922974, 'binary_specificity': 0.45382586, 'binary_f1_score': 0.98245966}
confusion matrix:
     0      1
0  688    828
1  230  29630
---- Validation: 
scalar performance:
{'acc': 0.657277, 'precision': 0.7394471, 'recall': 0.6648253, 'specificity': 0.6648253, 'f1': 0.6311722, 'auroc': 0.8266778, 'binary_precision': 0.5923695, 'binary_recall': 0.948553, 'binary_specificity': 0.38109756, 'binary_f1_score': 0.72929543}
confusion matrix:
     0    1
0  250  406
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6526316, 'precision': 0.74266434, 'recall': 0.6215144, 'specificity': 0.6215144, 'f1': 0.5864662, 'auroc': 0.77107465, 'binary_precision': 0.61576355, 'binary_recall': 0.96525097, 'binary_specificity': 0.2777778, 'binary_f1_score': 0.7518797}
confusion matrix:
    0    1
0  60  156
1   9  250
early stop counter: 1
val acc:0.65727698802948, best validation acc: 0.663536787033081, corresponding to test acc:                         0.6589473485946655 / 0.6589473485946655
after epoch: 27,now: 2024-07-12 18:32:07.405410,epoch time: 0:09:22.920781,used: 4:14:29.020050,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.965515, 'precision': 0.8471967, 'recall': 0.7289212, 'specificity': 0.7289212, 'f1': 0.77444816, 'auroc': 0.9471793, 'binary_precision': 0.9734158, 'binary_recall': 0.99082386, 'binary_specificity': 0.46701846, 'binary_f1_score': 0.98204273}
confusion matrix:
     0      1
0  708    808
1  274  29586
---- Validation: 
scalar performance:
{'acc': 0.6580595, 'precision': 0.7399453, 'recall': 0.6655875, 'specificity': 0.6655875, 'f1': 0.6321789, 'auroc': 0.8290404, 'binary_precision': 0.5929648, 'binary_recall': 0.948553, 'binary_specificity': 0.38262194, 'binary_f1_score': 0.7297464}
confusion matrix:
     0    1
0  251  405
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6568421, 'precision': 0.75114226, 'recall': 0.6257597, 'specificity': 0.6257597, 'f1': 0.5914787, 'auroc': 0.7776526, 'binary_precision': 0.6182266, 'binary_recall': 0.969112, 'binary_specificity': 0.2824074, 'binary_f1_score': 0.7548872}
confusion matrix:
    0    1
0  61  155
1   8  251
early stop counter: 2
val acc:0.6580594778060913, best validation acc: 0.663536787033081, corresponding to test acc:                         0.6589473485946655 / 0.6589473485946655
after epoch: 28,now: 2024-07-12 18:41:30.262104,epoch time: 0:09:22.856694,used: 4:23:51.876744,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9649414, 'precision': 0.8457847, 'recall': 0.720793, 'specificity': 0.720793, 'f1': 0.7678436, 'auroc': 0.9515041, 'binary_precision': 0.9726221, 'binary_recall': 0.9910583, 'binary_specificity': 0.4505277, 'binary_f1_score': 0.98175365}
confusion matrix:
     0      1
0  683    833
1  267  29593
---- Validation: 
scalar performance:
{'acc': 0.6635368, 'precision': 0.7434106, 'recall': 0.6709229, 'specificity': 0.6709229, 'f1': 0.6391869, 'auroc': 0.83089805, 'binary_precision': 0.597166, 'binary_recall': 0.948553, 'binary_specificity': 0.3932927, 'binary_f1_score': 0.7329193}
confusion matrix:
     0    1
0  258  398
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65894735, 'precision': 0.7476737, 'recall': 0.6284588, 'specificity': 0.6284588, 'f1': 0.59639347, 'auroc': 0.78351563, 'binary_precision': 0.6203474, 'binary_recall': 0.96525097, 'binary_specificity': 0.29166666, 'binary_f1_score': 0.755287}
confusion matrix:
    0    1
0  63  153
1   9  250
early stop counter: 3
val acc:0.663536787033081, best validation acc: 0.663536787033081, corresponding to test acc:                         0.6589473485946655 / 0.6589473485946655
after epoch: 29,now: 2024-07-12 18:50:59.747694,epoch time: 0:09:29.485590,used: 4:33:21.362334,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.96577, 'precision': 0.8492992, 'recall': 0.7303074, 'specificity': 0.7303074, 'f1': 0.7761158, 'auroc': 0.95021164, 'binary_precision': 0.9735474, 'binary_recall': 0.9909578, 'binary_specificity': 0.469657, 'binary_f1_score': 0.98217547}
confusion matrix:
     0      1
0  712    804
1  270  29590
---- Validation: 
scalar performance:
{'acc': 0.6658842, 'precision': 0.74488485, 'recall': 0.6732094, 'specificity': 0.6732094, 'f1': 0.6421701, 'auroc': 0.8321259, 'binary_precision': 0.5989848, 'binary_recall': 0.948553, 'binary_specificity': 0.39786586, 'binary_f1_score': 0.7342875}
confusion matrix:
     0    1
0  261  395
1   32  590
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66105264, 'precision': 0.74930143, 'recall': 0.63077366, 'specificity': 0.63077366, 'f1': 0.5996681, 'auroc': 0.7880738, 'binary_precision': 0.62189054, 'binary_recall': 0.96525097, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7564297}
confusion matrix:
    0    1
0  64  152
1   9  250
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-12 19:00:29.113684,epoch time: 0:09:29.365990,used: 4:42:50.728324,model: dset_te_center0_erm_b44271c83_not_commited_2024md_07md_12_14_17_38_seed_2_21898478
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 4:42:50.728324 at 2024-07-12 19:00:29.113684
persisted model performance metric: 

scalar performance:
{'acc': 0.66105264, 'precision': 0.74930143, 'recall': 0.63077366, 'specificity': 0.63077366, 'f1': 0.5996681, 'auroc': 0.7880738, 'binary_precision': 0.62189054, 'binary_recall': 0.96525097, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7564297}
confusion matrix:
    0    1
0  64  152
1   9  250
oracle model performance metric: 

scalar performance:
{'acc': 0.66105264, 'precision': 0.74930143, 'recall': 0.63077366, 'specificity': 0.63077366, 'f1': 0.5996681, 'auroc': 0.7880738, 'binary_precision': 0.62189054, 'binary_recall': 0.96525097, 'binary_specificity': 0.2962963, 'binary_f1_score': 0.7564297}
confusion matrix:
    0    1
0  64  152
1   9  250
results aggregation path: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONWILD_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_allfreeze/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 189885 KiB | 460563 KiB | 661286 GiB | 661285 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 189885 KiB | 460563 KiB | 661286 GiB | 661285 GiB |
|       from large pool | 173494 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |  16391 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 189012 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool | 172814 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |  16198 KiB |  33425 KiB |  13560 GiB |  13559 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 526336 KiB | 526336 KiB |   1086 MiB | 585728 KiB |
|       from large pool | 487424 KiB | 487424 KiB |   1014 MiB | 550912 KiB |
|       from small pool |  38912 KiB |  38912 KiB |     72 MiB |  34816 KiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  37442 KiB | 104341 KiB | 365909 GiB | 365909 GiB |
|       from large pool |  31306 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |   6136 KiB |  11184 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     794    |    4405    |  150556 K  |  150555 K  |
|       from large pool |      76    |     158    |   63851 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86704 K  |   86704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     794    |    4405    |  150556 K  |  150555 K  |
|       from large pool |      76    |     158    |   63851 K  |   63851 K  |
|       from small pool |     718    |    4327    |   86704 K  |   86704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |      41    |      81    |      40    |
|       from large pool |      22    |      22    |      45    |      23    |
|       from small pool |      19    |      19    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      40    |    1980    |   85779 K  |   85779 K  |
|       from large pool |      10    |      22    |   36924 K  |   36924 K  |
|       from small pool |      30    |    1970    |   48854 K  |   48854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  17088 KiB | 460563 KiB | 661286 GiB | 661286 GiB |
|       from large pool |  17088 KiB | 428048 KiB | 647696 GiB | 647696 GiB |
|       from small pool |      0 KiB |  33617 KiB |  13589 GiB |  13589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB | 457294 KiB | 661252 GiB | 661252 GiB |
|       from large pool |  16640 KiB | 424940 KiB | 647692 GiB | 647692 GiB |
|       from small pool |      0 KiB |  33425 KiB |  13560 GiB |  13560 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 227328 KiB | 526336 KiB |   1086 MiB |    864 MiB |
|       from large pool | 204800 KiB | 487424 KiB |   1014 MiB |    814 MiB |
|       from small pool |  22528 KiB |  38912 KiB |     72 MiB |     50 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  23872 KiB | 104341 KiB | 365909 GiB | 365909 GiB |
|       from large pool |  23872 KiB | 100062 KiB | 351984 GiB | 351984 GiB |
|       from small pool |      0 KiB |  12070 KiB |  13925 GiB |  13925 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    4405    |  150556 K  |  150556 K  |
|       from large pool |       2    |     158    |   63851 K  |   63851 K  |
|       from small pool |       0    |    4327    |   86704 K  |   86704 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    4405    |  150556 K  |  150556 K  |
|       from large pool |       2    |     158    |   63851 K  |   63851 K  |
|       from small pool |       0    |    4327    |   86704 K  |   86704 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      41    |      81    |      60    |
|       from large pool |      10    |      22    |      45    |      35    |
|       from small pool |      11    |      19    |      36    |      25    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    1980    |   85779 K  |   85779 K  |
|       from large pool |       3    |      22    |   36924 K  |   36924 K  |
|       from small pool |       0    |    1970    |   48854 K  |   48854 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Fri Jul 12 19:07:56 2024]
Finished job 0.
1 of 1 steps (100%) done
