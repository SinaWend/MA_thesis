Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 12:50:41 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/4.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=4
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806

 Experiment start at: 2024-07-20 12:53:25.515475
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5419922, 'precision': 0.5418303, 'recall': 0.54139894, 'specificity': 0.54139894, 'f1': 0.54050106, 'auroc': 0.57487607, 'binary_precision': 0.54341406, 'binary_recall': 0.5920206, 'binary_specificity': 0.49077734, 'binary_f1_score': 0.5666769}
confusion matrix:
     0    1
0  745  773
1  634  920
---- Validation: 
scalar performance:
{'acc': 0.63121116, 'precision': 0.6390565, 'recall': 0.6293919, 'specificity': 0.6293919, 'f1': 0.6239481, 'auroc': 0.70302296, 'binary_precision': 0.6687764, 'binary_recall': 0.4992126, 'binary_specificity': 0.7595712, 'binary_f1_score': 0.5716862}
confusion matrix:
     0    1
0  496  157
1  318  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.63799745, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.6249568, 'auroc': 0.666782, 'binary_precision': 0.6707317, 'binary_recall': 0.5116279, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.5804749}
confusion matrix:
     0    1
0  161   54
1  105  110
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:54:57.232892,epoch time: 0:01:31.717417,used: 0:01:31.717417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.67545575, 'precision': 0.67873216, 'recall': 0.67436785, 'specificity': 0.67436785, 'f1': 0.67305946, 'auroc': 0.7463987, 'binary_precision': 0.6578503, 'binary_recall': 0.7503209, 'binary_specificity': 0.5984148, 'binary_f1_score': 0.7010495}
confusion matrix:
     0     1
0  906   608
1  389  1169
---- Validation: 
scalar performance:
{'acc': 0.6257764, 'precision': 0.64147216, 'recall': 0.62329406, 'specificity': 0.62329406, 'f1': 0.61231565, 'auroc': 0.71103686, 'binary_precision': 0.68523, 'binary_recall': 0.4456693, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.5400763}
confusion matrix:
     0    1
0  523  130
1  352  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61627907, 'precision': 0.6355133, 'recall': 0.61627907, 'specificity': 0.61627907, 'f1': 0.60216224, 'auroc': 0.68707407, 'binary_precision': 0.6865672, 'binary_recall': 0.427907, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.52722067}
confusion matrix:
     0   1
0  173  42
1  123  92
early stop counter: 1
val acc:0.6257764101028442, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.630232572555542
after epoch: 2,now: 2024-07-20 12:55:55.768544,epoch time: 0:00:58.535652,used: 0:02:30.253069,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7467448, 'precision': 0.7470871, 'recall': 0.7463857, 'specificity': 0.7463857, 'f1': 0.74643135, 'auroc': 0.8183173, 'binary_precision': 0.7409007, 'binary_recall': 0.7703656, 'binary_specificity': 0.7224058, 'binary_f1_score': 0.75534594}
confusion matrix:
      0     1
0  1093   420
1   358  1201
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.6405674, 'recall': 0.61588186, 'specificity': 0.61588186, 'f1': 0.600021, 'auroc': 0.7188241, 'binary_precision': 0.69251335, 'binary_recall': 0.40787402, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.51337963}
confusion matrix:
     0    1
0  538  115
1  376  259
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6607213, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.61572397, 'auroc': 0.70702004, 'binary_precision': 0.728, 'binary_recall': 0.4232558, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.53529406}
confusion matrix:
     0   1
0  181  34
1  124  91
new oracle model saved
early stop counter: 2
val acc:0.6187888383865356, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 3,now: 2024-07-20 12:56:54.288486,epoch time: 0:00:58.519942,used: 0:03:28.773011,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.79785156, 'precision': 0.7978759, 'recall': 0.79792327, 'specificity': 0.79792327, 'f1': 0.7978468, 'auroc': 0.8662921, 'binary_precision': 0.80535597, 'binary_recall': 0.79241645, 'binary_specificity': 0.8034301, 'binary_f1_score': 0.79883385}
confusion matrix:
      0     1
0  1218   298
1   323  1233
---- Validation: 
scalar performance:
{'acc': 0.60559005, 'precision': 0.63380027, 'recall': 0.60221386, 'specificity': 0.60221386, 'f1': 0.57929605, 'auroc': 0.7238765, 'binary_precision': 0.6918429, 'binary_recall': 0.36062992, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.47412008}
confusion matrix:
     0    1
0  551  102
1  406  229
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61162794, 'precision': 0.64166486, 'recall': 0.61162794, 'specificity': 0.61162794, 'f1': 0.58988917, 'auroc': 0.7211033, 'binary_precision': 0.70689654, 'binary_recall': 0.38139534, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.49546826}
confusion matrix:
     0   1
0  181  34
1  133  82
early stop counter: 3
val acc:0.6055900454521179, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 4,now: 2024-07-20 12:57:52.856897,epoch time: 0:00:58.568411,used: 0:04:27.341422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8108724, 'precision': 0.81221557, 'recall': 0.81135166, 'specificity': 0.81135166, 'f1': 0.81079775, 'auroc': 0.8750771, 'binary_precision': 0.83677685, 'binary_recall': 0.77934575, 'binary_specificity': 0.84335756, 'binary_f1_score': 0.8070408}
confusion matrix:
      0     1
0  1276   237
1   344  1215
---- Validation: 
scalar performance:
{'acc': 0.5947205, 'precision': 0.62593937, 'recall': 0.59106004, 'specificity': 0.59106004, 'f1': 0.562805, 'auroc': 0.73029387, 'binary_precision': 0.68524593, 'binary_recall': 0.32913387, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.4446809}
confusion matrix:
     0    1
0  557   96
1  426  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.6505473, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.58897644, 'auroc': 0.7348188, 'binary_precision': 0.72477067, 'binary_recall': 0.36744186, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.4876543}
confusion matrix:
     0   1
0  185  30
1  136  79
early stop counter: 4
val acc:0.5947204828262329, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 5,now: 2024-07-20 12:58:51.600645,epoch time: 0:00:58.743748,used: 0:05:26.085170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.83170575, 'precision': 0.83540076, 'recall': 0.8323852, 'specificity': 0.8323852, 'f1': 0.83141756, 'auroc': 0.89013743, 'binary_precision': 0.8740101, 'binary_recall': 0.78020567, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.82444817}
confusion matrix:
      0     1
0  1341   175
1   342  1214
---- Validation: 
scalar performance:
{'acc': 0.58928573, 'precision': 0.62539685, 'recall': 0.5853529, 'specificity': 0.5853529, 'f1': 0.55168754, 'auroc': 0.7331179, 'binary_precision': 0.6892857, 'binary_recall': 0.30393702, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.42185792}
confusion matrix:
     0    1
0  566   87
1  442  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60232556, 'precision': 0.6413797, 'recall': 0.60232556, 'specificity': 0.60232556, 'f1': 0.5728253, 'auroc': 0.74429417, 'binary_precision': 0.71568626, 'binary_recall': 0.33953488, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.46056783}
confusion matrix:
     0   1
0  186  29
1  142  73
early stop counter: 5
val acc:0.5892857313156128, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 6,now: 2024-07-20 12:59:50.131564,epoch time: 0:00:58.530919,used: 0:06:24.616089,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8375651, 'precision': 0.839945, 'recall': 0.83813566, 'specificity': 0.83813566, 'f1': 0.8374161, 'auroc': 0.9039855, 'binary_precision': 0.87201124, 'binary_recall': 0.79640335, 'binary_specificity': 0.879868, 'binary_f1_score': 0.83249414}
confusion matrix:
      0     1
0  1333   182
1   317  1240
---- Validation: 
scalar performance:
{'acc': 0.59006214, 'precision': 0.6262285, 'recall': 0.5861403, 'specificity': 0.5861403, 'f1': 0.5527543, 'auroc': 0.7374927, 'binary_precision': 0.6903915, 'binary_recall': 0.3055118, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.4235808}
confusion matrix:
     0    1
0  566   87
1  441  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61860466, 'precision': 0.6606593, 'recall': 0.61860466, 'specificity': 0.61860466, 'f1': 0.5918982, 'auroc': 0.7523202, 'binary_precision': 0.74285716, 'binary_recall': 0.3627907, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.48750007}
confusion matrix:
     0   1
0  188  27
1  137  78
early stop counter: 6
val acc:0.590062141418457, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 7,now: 2024-07-20 13:00:48.683903,epoch time: 0:00:58.552339,used: 0:07:23.168428,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8515625, 'precision': 0.85604763, 'recall': 0.85240674, 'specificity': 0.85240674, 'f1': 0.85127956, 'auroc': 0.9165827, 'binary_precision': 0.8999275, 'binary_recall': 0.7960231, 'binary_specificity': 0.90879047, 'binary_f1_score': 0.8447924}
confusion matrix:
      0     1
0  1375   138
1   318  1241
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.6293269, 'recall': 0.5884808, 'specificity': 0.5884808, 'f1': 0.5555126, 'auroc': 0.74248713, 'binary_precision': 0.69503546, 'binary_recall': 0.30866143, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.4274809}
confusion matrix:
     0    1
0  567   86
1  439  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61860466, 'precision': 0.6586325, 'recall': 0.61860466, 'specificity': 0.61860466, 'f1': 0.59292525, 'auroc': 0.76004326, 'binary_precision': 0.7383177, 'binary_recall': 0.36744186, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.49068323}
confusion matrix:
     0   1
0  187  28
1  136  79
early stop counter: 7
val acc:0.592391312122345, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6325581669807434
after epoch: 8,now: 2024-07-20 13:01:47.138521,epoch time: 0:00:58.454618,used: 0:08:21.623046,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85058594, 'precision': 0.857169, 'recall': 0.851472, 'specificity': 0.851472, 'f1': 0.85009944, 'auroc': 0.91519165, 'binary_precision': 0.9090231, 'binary_recall': 0.783419, 'binary_specificity': 0.9195251, 'binary_f1_score': 0.8415602}
confusion matrix:
      0     1
0  1394   122
1   337  1219
---- Validation: 
scalar performance:
{'acc': 0.61102486, 'precision': 0.6451073, 'recall': 0.60748696, 'specificity': 0.60748696, 'f1': 0.58243924, 'auroc': 0.7494061, 'binary_precision': 0.71202534, 'binary_recall': 0.35433072, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.47318614}
confusion matrix:
     0    1
0  562   91
1  410  225
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.66935575, 'recall': 0.6348837, 'specificity': 0.6348837, 'f1': 0.6153079, 'auroc': 0.7695836, 'binary_precision': 0.7457627, 'binary_recall': 0.40930232, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.5285285}
confusion matrix:
     0   1
0  185  30
1  127  88
new oracle model saved
early stop counter: 8
val acc:0.6110248565673828, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6348837018013
after epoch: 9,now: 2024-07-20 13:02:45.775930,epoch time: 0:00:58.637409,used: 0:09:20.260455,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8655599, 'precision': 0.8709034, 'recall': 0.86630857, 'specificity': 0.86630857, 'f1': 0.86522555, 'auroc': 0.9247614, 'binary_precision': 0.9186217, 'binary_recall': 0.8057878, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.8585132}
confusion matrix:
      0     1
0  1406   111
1   302  1253
---- Validation: 
scalar performance:
{'acc': 0.6195652, 'precision': 0.64987206, 'recall': 0.6162786, 'specificity': 0.6162786, 'f1': 0.59552616, 'auroc': 0.75378567, 'binary_precision': 0.7138643, 'binary_recall': 0.38110235, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.49691996}
confusion matrix:
     0    1
0  556   97
1  393  242
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.6773739, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.62672555, 'auroc': 0.7749053, 'binary_precision': 0.75409836, 'binary_recall': 0.427907, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.54599404}
confusion matrix:
     0   1
0  185  30
1  123  92
new oracle model saved
early stop counter: 9
val acc:0.6195651888847351, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6441860198974609
after epoch: 10,now: 2024-07-20 13:03:44.760507,epoch time: 0:00:58.984577,used: 0:10:19.245032,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8652344, 'precision': 0.8711165, 'recall': 0.86601925, 'specificity': 0.86601925, 'f1': 0.86485857, 'auroc': 0.9288058, 'binary_precision': 0.9210332, 'binary_recall': 0.80257237, 'binary_specificity': 0.92946607, 'binary_f1_score': 0.85773194}
confusion matrix:
      0     1
0  1410   107
1   307  1248
---- Validation: 
scalar performance:
{'acc': 0.6164596, 'precision': 0.6503248, 'recall': 0.6129988, 'specificity': 0.6129988, 'f1': 0.58951366, 'auroc': 0.7563396, 'binary_precision': 0.71826625, 'binary_recall': 0.36535433, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.48434243}
confusion matrix:
     0    1
0  562   91
1  403  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511628, 'precision': 0.6908058, 'recall': 0.65116274, 'specificity': 0.65116274, 'f1': 0.6320509, 'auroc': 0.78226066, 'binary_precision': 0.7777778, 'binary_recall': 0.4232558, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.54819274}
confusion matrix:
     0   1
0  189  26
1  124  91
new oracle model saved
early stop counter: 10
val acc:0.6164596080780029, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6511628031730652
after epoch: 11,now: 2024-07-20 13:04:43.262829,epoch time: 0:00:58.502322,used: 0:11:17.747354,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87890625, 'precision': 0.8850587, 'recall': 0.8797828, 'specificity': 0.8797828, 'f1': 0.8785769, 'auroc': 0.94031596, 'binary_precision': 0.9372694, 'binary_recall': 0.81567115, 'binary_specificity': 0.9438944, 'binary_f1_score': 0.87225276}
confusion matrix:
      0     1
0  1430    85
1   287  1270
---- Validation: 
scalar performance:
{'acc': 0.61878884, 'precision': 0.6507977, 'recall': 0.61542606, 'specificity': 0.61542606, 'f1': 0.5935428, 'auroc': 0.7605841, 'binary_precision': 0.71686745, 'binary_recall': 0.37480316, 'binary_specificity': 0.856049, 'binary_f1_score': 0.49224404}
confusion matrix:
     0    1
0  559   94
1  397  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.69263685, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6385405, 'auroc': 0.78875065, 'binary_precision': 0.7768595, 'binary_recall': 0.4372093, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.55952376}
confusion matrix:
     0   1
0  188  27
1  121  94
new oracle model saved
early stop counter: 11
val acc:0.6187888383865356, best validation acc: 0.6312111616134644, corresponding to test acc:                         0.630232572555542 / 0.6558139324188232
after epoch: 12,now: 2024-07-20 13:05:42.309913,epoch time: 0:00:59.047084,used: 0:12:16.794438,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8694661, 'precision': 0.875322, 'recall': 0.87028766, 'specificity': 0.87028766, 'f1': 0.86911553, 'auroc': 0.9306911, 'binary_precision': 0.9255711, 'binary_recall': 0.8071979, 'binary_specificity': 0.9333773, 'binary_f1_score': 0.8623412}
confusion matrix:
      0     1
0  1415   101
1   300  1256
---- Validation: 
scalar performance:
{'acc': 0.632764, 'precision': 0.66368866, 'recall': 0.62959933, 'specificity': 0.62959933, 'f1': 0.61124986, 'auroc': 0.7628896, 'binary_precision': 0.73142856, 'binary_recall': 0.4031496, 'binary_specificity': 0.856049, 'binary_f1_score': 0.51979697}
confusion matrix:
     0    1
0  559   94
1  379  256
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6581395, 'precision': 0.6908417, 'recall': 0.6581395, 'specificity': 0.6581395, 'f1': 0.64283895, 'auroc': 0.7950243, 'binary_precision': 0.76984125, 'binary_recall': 0.4511628, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.56891495}
confusion matrix:
     0   1
0  186  29
1  118  97
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 13:06:41.233168,epoch time: 0:00:58.923255,used: 0:13:15.717693,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8886719, 'precision': 0.8938772, 'recall': 0.889591, 'specificity': 0.889591, 'f1': 0.8884468, 'auroc': 0.94365716, 'binary_precision': 0.94323146, 'binary_recall': 0.83076924, 'binary_specificity': 0.9484127, 'binary_f1_score': 0.8834356}
confusion matrix:
      0     1
0  1434    78
1   264  1296
---- Validation: 
scalar performance:
{'acc': 0.64052796, 'precision': 0.6717522, 'recall': 0.6374299, 'specificity': 0.6374299, 'f1': 0.6203408, 'auroc': 0.76688576, 'binary_precision': 0.74157304, 'binary_recall': 0.41574803, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.53279513}
confusion matrix:
     0    1
0  561   92
1  371  264
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6910299, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.64631784, 'auroc': 0.7996971, 'binary_precision': 0.76744187, 'binary_recall': 0.4604651, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.57558143}
confusion matrix:
     0   1
0  185  30
1  116  99
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 13:07:40.248465,epoch time: 0:00:59.015297,used: 0:14:14.732990,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8805339, 'precision': 0.88998234, 'recall': 0.881611, 'specificity': 0.881611, 'f1': 0.8799995, 'auroc': 0.9395355, 'binary_precision': 0.9541985, 'binary_recall': 0.8028259, 'binary_specificity': 0.96039605, 'binary_f1_score': 0.87199163}
confusion matrix:
      0     1
0  1455    60
1   307  1250
---- Validation: 
scalar performance:
{'acc': 0.6583851, 'precision': 0.68256027, 'recall': 0.6557355, 'specificity': 0.6557355, 'f1': 0.6443346, 'auroc': 0.77368903, 'binary_precision': 0.74559194, 'binary_recall': 0.46614173, 'binary_specificity': 0.8453292, 'binary_f1_score': 0.5736434}
confusion matrix:
     0    1
0  552  101
1  339  296
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.6935774, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6558248, 'auroc': 0.8065333, 'binary_precision': 0.7647059, 'binary_recall': 0.48372093, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.5925926}
confusion matrix:
     0    1
0  183   32
1  111  104
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 13:08:39.134102,epoch time: 0:00:58.885637,used: 0:15:13.618627,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8805339, 'precision': 0.8884082, 'recall': 0.88156796, 'specificity': 0.88156796, 'f1': 0.88010836, 'auroc': 0.94331086, 'binary_precision': 0.94740796, 'binary_recall': 0.809371, 'binary_specificity': 0.95376486, 'binary_f1_score': 0.8729664}
confusion matrix:
      0     1
0  1444    70
1   297  1261
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.6856097, 'recall': 0.66050327, 'specificity': 0.66050327, 'f1': 0.6502864, 'auroc': 0.7789271, 'binary_precision': 0.74692875, 'binary_recall': 0.47874016, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.58349323}
confusion matrix:
     0    1
0  550  103
1  331  304
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67674416, 'precision': 0.70123154, 'recall': 0.6767442, 'specificity': 0.6767442, 'f1': 0.66660166, 'auroc': 0.81310976, 'binary_precision': 0.7714286, 'binary_recall': 0.5023256, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.6084508}
confusion matrix:
     0    1
0  183   32
1  107  108
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 13:09:38.321382,epoch time: 0:00:59.187280,used: 0:16:12.805907,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8935547, 'precision': 0.9008119, 'recall': 0.8944918, 'specificity': 0.8944918, 'f1': 0.89321613, 'auroc': 0.94610226, 'binary_precision': 0.95827127, 'binary_recall': 0.82594734, 'binary_specificity': 0.9630363, 'binary_f1_score': 0.88720256}
confusion matrix:
      0     1
0  1459    56
1   271  1286
---- Validation: 
scalar performance:
{'acc': 0.66847825, 'precision': 0.687611, 'recall': 0.6661453, 'specificity': 0.6661453, 'f1': 0.6578506, 'auroc': 0.7827375, 'binary_precision': 0.74413145, 'binary_recall': 0.4992126, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.59754944}
confusion matrix:
     0    1
0  544  109
1  318  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69069767, 'precision': 0.70988095, 'recall': 0.69069767, 'specificity': 0.69069767, 'f1': 0.68346477, 'auroc': 0.81685233, 'binary_precision': 0.7733333, 'binary_recall': 0.53953487, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.6356165}
confusion matrix:
     0    1
0  181   34
1   99  116
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 13:10:36.969750,epoch time: 0:00:58.648368,used: 0:17:11.454275,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9007161, 'precision': 0.9067097, 'recall': 0.90156555, 'specificity': 0.90156555, 'f1': 0.9004693, 'auroc': 0.95710254, 'binary_precision': 0.9596182, 'binary_recall': 0.8394348, 'binary_specificity': 0.96369636, 'binary_f1_score': 0.89551216}
confusion matrix:
      0     1
0  1460    55
1   250  1307
---- Validation: 
scalar performance:
{'acc': 0.69409937, 'precision': 0.7071727, 'recall': 0.6922598, 'specificity': 0.6922598, 'f1': 0.68786705, 'auroc': 0.7888727, 'binary_precision': 0.75583863, 'binary_recall': 0.5606299, 'binary_specificity': 0.82388973, 'binary_f1_score': 0.64376134}
confusion matrix:
     0    1
0  538  115
1  279  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7186046, 'precision': 0.73163855, 'recall': 0.7186047, 'specificity': 0.7186047, 'f1': 0.7145897, 'auroc': 0.8220227, 'binary_precision': 0.7865854, 'binary_recall': 0.6, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.68073875}
confusion matrix:
     0    1
0  180   35
1   86  129
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 13:11:35.980461,epoch time: 0:00:59.010711,used: 0:18:10.464986,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.9132681, 'recall': 0.9070733, 'specificity': 0.9070733, 'f1': 0.905962, 'auroc': 0.9612762, 'binary_precision': 0.97030437, 'binary_recall': 0.8405145, 'binary_specificity': 0.97363216, 'binary_f1_score': 0.900758}
confusion matrix:
      0     1
0  1477    40
1   248  1307
---- Validation: 
scalar performance:
{'acc': 0.69332296, 'precision': 0.70949674, 'recall': 0.6912988, 'specificity': 0.6912988, 'f1': 0.6858232, 'auroc': 0.7914338, 'binary_precision': 0.76431715, 'binary_recall': 0.5464567, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.6372819}
confusion matrix:
     0    1
0  546  107
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7277962, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.70954084, 'auroc': 0.8263061, 'binary_precision': 0.7839506, 'binary_recall': 0.59069765, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.67374}
confusion matrix:
     0    1
0  180   35
1   88  127
early stop counter: 1
val acc:0.6933229565620422, best validation acc: 0.6940993666648865, corresponding to test acc:                         0.7186046242713928 / 0.7186046242713928
after epoch: 19,now: 2024-07-20 13:12:34.212480,epoch time: 0:00:58.232019,used: 0:19:08.697005,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9059245, 'precision': 0.91159606, 'recall': 0.9067482, 'specificity': 0.9067482, 'f1': 0.90570855, 'auroc': 0.96612465, 'binary_precision': 0.9634503, 'binary_recall': 0.8464997, 'binary_specificity': 0.9669967, 'binary_f1_score': 0.9011966}
confusion matrix:
      0     1
0  1465    50
1   239  1318
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.7227142, 'recall': 0.71034837, 'specificity': 0.71034837, 'f1': 0.7073844, 'auroc': 0.79759014, 'binary_precision': 0.76829267, 'binary_recall': 0.5952756, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.6708074}
confusion matrix:
     0    1
0  539  114
1  257  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.74420273, 'recall': 0.7348837, 'specificity': 0.7348837, 'f1': 0.7323301, 'auroc': 0.83147645, 'binary_precision': 0.7919075, 'binary_recall': 0.6372093, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.70618564}
confusion matrix:
     0    1
0  179   36
1   78  137
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 13:13:32.972509,epoch time: 0:00:58.760029,used: 0:20:07.457034,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.9137833, 'recall': 0.90745413, 'specificity': 0.90745413, 'f1': 0.90628517, 'auroc': 0.96394885, 'binary_precision': 0.9717472, 'binary_recall': 0.8399743, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.90106857}
confusion matrix:
      0     1
0  1478    38
1   249  1307
---- Validation: 
scalar performance:
{'acc': 0.7197205, 'precision': 0.7278612, 'recall': 0.71833086, 'specificity': 0.71833086, 'f1': 0.7163208, 'auroc': 0.80257565, 'binary_precision': 0.7675781, 'binary_recall': 0.6188976, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.68526584}
confusion matrix:
     0    1
0  534  119
1  242  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75116277, 'precision': 0.758, 'recall': 0.75116277, 'specificity': 0.75116277, 'f1': 0.7495032, 'auroc': 0.8372309, 'binary_precision': 0.8, 'binary_recall': 0.66976744, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.72911394}
confusion matrix:
     0    1
0  179   36
1   71  144
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 13:14:31.727588,epoch time: 0:00:58.755079,used: 0:21:06.212113,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.91503906, 'precision': 0.920465, 'recall': 0.91580045, 'specificity': 0.91580045, 'f1': 0.9148545, 'auroc': 0.96360624, 'binary_precision': 0.97159505, 'binary_recall': 0.8573265, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9108911}
confusion matrix:
      0     1
0  1477    39
1   222  1334
---- Validation: 
scalar performance:
{'acc': 0.7236025, 'precision': 0.730947, 'recall': 0.7222896, 'specificity': 0.7222896, 'f1': 0.7205781, 'auroc': 0.8059616, 'binary_precision': 0.76878613, 'binary_recall': 0.62834644, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.69150776}
confusion matrix:
     0    1
0  533  120
1  236  399
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76398754, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.7567926, 'auroc': 0.84227145, 'binary_precision': 0.8032787, 'binary_recall': 0.68372095, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.7386935}
confusion matrix:
     0    1
0  179   36
1   68  147
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 13:15:30.303274,epoch time: 0:00:58.575686,used: 0:22:04.787799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9046224, 'precision': 0.91176856, 'recall': 0.9055438, 'specificity': 0.9055438, 'f1': 0.9043328, 'auroc': 0.9623424, 'binary_precision': 0.9695394, 'binary_recall': 0.83815026, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.8990699}
confusion matrix:
      0     1
0  1474    41
1   252  1305
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.7367322, 'recall': 0.72771466, 'specificity': 0.72771466, 'f1': 0.7260274, 'auroc': 0.8083105, 'binary_precision': 0.7760618, 'binary_recall': 0.6330709, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.69731134}
confusion matrix:
     0    1
0  537  116
1  233  402
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76046515, 'precision': 0.76529175, 'recall': 0.76046515, 'specificity': 0.76046515, 'f1': 0.75937057, 'auroc': 0.8453218, 'binary_precision': 0.8010753, 'binary_recall': 0.69302326, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.7431421}
confusion matrix:
     0    1
0  178   37
1   66  149
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 13:16:29.430644,epoch time: 0:00:59.127370,used: 0:23:03.915169,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9078776, 'precision': 0.9130449, 'recall': 0.90870273, 'specificity': 0.90870273, 'f1': 0.90769404, 'auroc': 0.964569, 'binary_precision': 0.962963, 'binary_recall': 0.85109115, 'binary_specificity': 0.9663144, 'binary_f1_score': 0.90357757}
confusion matrix:
      0     1
0  1463    51
1   232  1326
---- Validation: 
scalar performance:
{'acc': 0.73524845, 'precision': 0.73913044, 'recall': 0.73429596, 'specificity': 0.73429596, 'f1': 0.7336104, 'auroc': 0.8114939, 'binary_precision': 0.7663044, 'binary_recall': 0.66614175, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.71272117}
confusion matrix:
     0    1
0  524  129
1  212  423
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.77401364, 'recall': 0.772093, 'specificity': 0.772093, 'f1': 0.771693, 'auroc': 0.84923744, 'binary_precision': 0.79695433, 'binary_recall': 0.73023254, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.7621359}
confusion matrix:
     0    1
0  175   40
1   58  157
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 13:17:28.233539,epoch time: 0:00:58.802895,used: 0:24:02.718064,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9124349, 'precision': 0.91685086, 'recall': 0.9131619, 'specificity': 0.9131619, 'f1': 0.9122896, 'auroc': 0.9658623, 'binary_precision': 0.96330935, 'binary_recall': 0.85998714, 'binary_specificity': 0.9663366, 'binary_f1_score': 0.9087207}
confusion matrix:
      0     1
0  1464    51
1   218  1339
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.75533015, 'recall': 0.75424147, 'specificity': 0.75424147, 'f1': 0.7542578, 'auroc': 0.81695867, 'binary_precision': 0.765391, 'binary_recall': 0.72440946, 'binary_specificity': 0.78407353, 'binary_f1_score': 0.74433655}
confusion matrix:
     0    1
0  512  141
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.7793659, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.77901125, 'auroc': 0.8531314, 'binary_precision': 0.78846157, 'binary_recall': 0.7627907, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.7754137}
confusion matrix:
     0    1
0  171   44
1   51  164
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 13:18:26.916599,epoch time: 0:00:58.683060,used: 0:25:01.401124,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91796875, 'precision': 0.9216658, 'recall': 0.9185683, 'specificity': 0.9185683, 'f1': 0.9178556, 'auroc': 0.9701899, 'binary_precision': 0.9643621, 'binary_recall': 0.87009645, 'binary_specificity': 0.9670402, 'binary_f1_score': 0.91480726}
confusion matrix:
      0     1
0  1467    50
1   202  1353
---- Validation: 
scalar performance:
{'acc': 0.761646, 'precision': 0.76188874, 'recall': 0.7613715, 'specificity': 0.7613715, 'f1': 0.7614272, 'auroc': 0.8217584, 'binary_precision': 0.767101, 'binary_recall': 0.7417323, 'binary_specificity': 0.78101075, 'binary_f1_score': 0.7542033}
confusion matrix:
     0    1
0  510  143
1  164  471
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.7817855, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.7813196, 'auroc': 0.8573499, 'binary_precision': 0.79227054, 'binary_recall': 0.7627907, 'binary_specificity': 0.8, 'binary_f1_score': 0.7772511}
confusion matrix:
     0    1
0  172   43
1   51  164
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 13:19:25.907617,epoch time: 0:00:58.991018,used: 0:26:00.392142,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.9160954, 'recall': 0.91160077, 'specificity': 0.91160077, 'f1': 0.91062164, 'auroc': 0.9678238, 'binary_precision': 0.96654546, 'binary_recall': 0.85356456, 'binary_specificity': 0.969637, 'binary_f1_score': 0.9065484}
confusion matrix:
      0     1
0  1469    46
1   228  1329
---- Validation: 
scalar performance:
{'acc': 0.76009315, 'precision': 0.76066476, 'recall': 0.7597099, 'specificity': 0.7597099, 'f1': 0.7597455, 'auroc': 0.8254983, 'binary_precision': 0.76986754, 'binary_recall': 0.7322835, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.75060534}
confusion matrix:
     0    1
0  514  139
1  170  465
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.78614557, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.786028, 'auroc': 0.86133045, 'binary_precision': 0.7914692, 'binary_recall': 0.7767442, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.78403753}
confusion matrix:
     0    1
0  171   44
1   48  167
new oracle model saved
early stop counter: 1
val acc:0.7600931525230408, best validation acc: 0.7616459727287292, corresponding to test acc:                         0.7813953757286072 / 0.7860465049743652
after epoch: 27,now: 2024-07-20 13:20:24.956807,epoch time: 0:00:59.049190,used: 0:26:59.441332,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9163411, 'precision': 0.9197263, 'recall': 0.91697985, 'specificity': 0.91697985, 'f1': 0.9162433, 'auroc': 0.9702983, 'binary_precision': 0.96099293, 'binary_recall': 0.87026334, 'binary_specificity': 0.96369636, 'binary_f1_score': 0.91338056}
confusion matrix:
      0     1
0  1460    55
1   202  1355
---- Validation: 
scalar performance:
{'acc': 0.77018636, 'precision': 0.7701901, 'recall': 0.7700546, 'specificity': 0.7700546, 'f1': 0.7700926, 'auroc': 0.82780147, 'binary_precision': 0.7703349, 'binary_recall': 0.7606299, 'binary_specificity': 0.7794793, 'binary_f1_score': 0.7654516}
confusion matrix:
     0    1
0  509  144
1  152  483
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.78837836, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78837097, 'auroc': 0.86401296, 'binary_precision': 0.78971964, 'binary_recall': 0.7860465, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7878789}
confusion matrix:
     0    1
0  170   45
1   46  169
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 13:21:23.654093,epoch time: 0:00:58.697286,used: 0:27:58.138618,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.9179739, 'recall': 0.91350865, 'specificity': 0.91350865, 'f1': 0.9125788, 'auroc': 0.9674746, 'binary_precision': 0.96802324, 'binary_recall': 0.85604113, 'binary_specificity': 0.97097623, 'binary_f1_score': 0.9085948}
confusion matrix:
      0     1
0  1472    44
1   224  1332
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.76009846, 'recall': 0.75887907, 'specificity': 0.75887907, 'f1': 0.758893, 'auroc': 0.8295113, 'binary_precision': 0.7712855, 'binary_recall': 0.72755903, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.7487845}
confusion matrix:
     0    1
0  516  137
1  173  462
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.7954511, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7953311, 'auroc': 0.86589503, 'binary_precision': 0.80094784, 'binary_recall': 0.7860465, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.79342717}
confusion matrix:
     0    1
0  173   42
1   46  169
new oracle model saved
early stop counter: 1
val acc:0.7593167424201965, best validation acc: 0.7701863646507263, corresponding to test acc:                         0.7883720993995667 / 0.7953488230705261
after epoch: 29,now: 2024-07-20 13:22:21.978116,epoch time: 0:00:58.324023,used: 0:28:56.462641,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9199219, 'precision': 0.9253112, 'recall': 0.92071706, 'specificity': 0.92071706, 'f1': 0.9197552, 'auroc': 0.9750061, 'binary_precision': 0.97672725, 'binary_recall': 0.8625562, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.91609824}
confusion matrix:
      0     1
0  1483    32
1   214  1343
---- Validation: 
scalar performance:
{'acc': 0.7670807, 'precision': 0.7701067, 'recall': 0.7662973, 'specificity': 0.7662973, 'f1': 0.7660377, 'auroc': 0.8314171, 'binary_precision': 0.79541445, 'binary_recall': 0.7102362, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.7504159}
confusion matrix:
     0    1
0  537  116
1  184  451
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.79110074, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.7906252, 'auroc': 0.8681449, 'binary_precision': 0.8019324, 'binary_recall': 0.772093, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.7867298}
confusion matrix:
     0    1
0  174   41
1   49  166
early stop counter: 2
val acc:0.7670807242393494, best validation acc: 0.7701863646507263, corresponding to test acc:                         0.7883720993995667 / 0.7953488230705261
after epoch: 30,now: 2024-07-20 13:23:20.263889,epoch time: 0:00:58.285773,used: 0:29:54.748414,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:54.748414 at 2024-07-20 13:23:20.263889
persisted model performance metric: 

scalar performance:
{'acc': 0.7883721, 'precision': 0.78837836, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78837097, 'auroc': 0.86401296, 'binary_precision': 0.78971964, 'binary_recall': 0.7860465, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.7878789}
confusion matrix:
     0    1
0  170   45
1   46  169
oracle model performance metric: 

scalar performance:
{'acc': 0.7953488, 'precision': 0.7954511, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7953311, 'auroc': 0.86589503, 'binary_precision': 0.80094784, 'binary_recall': 0.7860465, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.79342717}
confusion matrix:
     0    1
0  173   42
1   46  169
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/4.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |   8180 KiB |  10132 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10388 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10388 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     380    |    6463 K  |    6463 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      32    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6463 K  |    6463 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10388 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6463 K  |    6463 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806

 Experiment start at: 2024-07-20 13:24:23.134603
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54752606, 'precision': 0.5545018, 'recall': 0.545251, 'specificity': 0.545251, 'f1': 0.5263195, 'auroc': 0.52030873, 'binary_precision': 0.53757495, 'binary_recall': 0.7508049, 'binary_specificity': 0.33969718, 'binary_f1_score': 0.62654483}
confusion matrix:
     0     1
0  516  1003
1  387  1166
---- Validation: 
scalar performance:
{'acc': 0.48946136, 'precision': 0.47250473, 'recall': 0.48412699, 'specificity': 0.48412699, 'f1': 0.42564404, 'auroc': 0.6233487, 'binary_precision': 0.44642857, 'binary_recall': 0.15873016, 'binary_specificity': 0.8095238, 'binary_f1_score': 0.23419204}
confusion matrix:
     0    1
0  527  124
1  530  100
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.5867084, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.54553974, 'auroc': 0.6692543, 'binary_precision': 0.62601626, 'binary_recall': 0.3422222, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.44252875}
confusion matrix:
     0   1
0  179  46
1  148  77
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:25:30.001888,epoch time: 0:01:06.867285,used: 0:01:06.867285,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.57747394, 'precision': 0.5777624, 'recall': 0.57689613, 'specificity': 0.57689613, 'f1': 0.57601833, 'auroc': 0.59497035, 'binary_precision': 0.57504416, 'binary_recall': 0.629105, 'binary_specificity': 0.5246873, 'binary_f1_score': 0.600861}
confusion matrix:
     0    1
0  797  722
1  576  977
---- Validation: 
scalar performance:
{'acc': 0.47540984, 'precision': 0.41706464, 'recall': 0.4689196, 'specificity': 0.4689196, 'f1': 0.37333512, 'auroc': 0.62951016, 'binary_precision': 0.3432836, 'binary_recall': 0.073015876, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.120418854}
confusion matrix:
     0   1
0  563  88
1  584  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5728627, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.4673772, 'auroc': 0.67766917, 'binary_precision': 0.625, 'binary_recall': 0.17777778, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.2768166}
confusion matrix:
     0   1
0  201  24
1  185  40
early stop counter: 1
val acc:0.4754098355770111, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 2,now: 2024-07-20 13:26:29.380345,epoch time: 0:00:59.378457,used: 0:02:06.245742,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6516927, 'precision': 0.6516631, 'recall': 0.65147257, 'specificity': 0.65147257, 'f1': 0.65146804, 'auroc': 0.6900948, 'binary_precision': 0.6524467, 'binary_recall': 0.66838044, 'binary_specificity': 0.63456464, 'binary_f1_score': 0.6603175}
confusion matrix:
     0     1
0  962   554
1  516  1040
---- Validation: 
scalar performance:
{'acc': 0.4800937, 'precision': 0.4241782, 'recall': 0.4734767, 'specificity': 0.4734767, 'f1': 0.37417403, 'auroc': 0.64543927, 'binary_precision': 0.3548387, 'binary_recall': 0.06984127, 'binary_specificity': 0.87711215, 'binary_f1_score': 0.11671088}
confusion matrix:
     0   1
0  571  80
1  586  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5288889, 'precision': 0.56528723, 'recall': 0.5288889, 'specificity': 0.5288889, 'f1': 0.45259243, 'auroc': 0.69368887, 'binary_precision': 0.61403507, 'binary_recall': 0.15555556, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.24822696}
confusion matrix:
     0   1
0  203  22
1  190  35
early stop counter: 2
val acc:0.48009368777275085, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 3,now: 2024-07-20 13:27:28.520673,epoch time: 0:00:59.140328,used: 0:03:05.386070,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.71516925, 'precision': 0.71518445, 'recall': 0.714978, 'specificity': 0.714978, 'f1': 0.7150083, 'auroc': 0.77510023, 'binary_precision': 0.7147355, 'binary_recall': 0.72896594, 'binary_specificity': 0.7009901, 'binary_f1_score': 0.7217806}
confusion matrix:
      0     1
0  1062   453
1   422  1135
---- Validation: 
scalar performance:
{'acc': 0.48868072, 'precision': 0.45601627, 'recall': 0.48233485, 'specificity': 0.48233485, 'f1': 0.39415133, 'auroc': 0.664404, 'binary_precision': 0.41379312, 'binary_recall': 0.0952381, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.15483871}
confusion matrix:
     0   1
0  566  85
1  570  60
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.5673077, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.45827985, 'auroc': 0.7161679, 'binary_precision': 0.6166667, 'binary_recall': 0.16444445, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.25964913}
confusion matrix:
     0   1
0  202  23
1  188  37
early stop counter: 3
val acc:0.48868072032928467, best validation acc: 0.48946136236190796, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 4,now: 2024-07-20 13:28:27.709984,epoch time: 0:00:59.189311,used: 0:04:04.575381,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7516276, 'precision': 0.75158554, 'recall': 0.7515897, 'specificity': 0.7515897, 'f1': 0.7515875, 'auroc': 0.82370526, 'binary_precision': 0.7549839, 'binary_recall': 0.7544987, 'binary_specificity': 0.7486807, 'binary_f1_score': 0.7547412}
confusion matrix:
      0     1
0  1135   381
1   382  1174
---- Validation: 
scalar performance:
{'acc': 0.4964871, 'precision': 0.4761573, 'recall': 0.4901946, 'specificity': 0.4901946, 'f1': 0.4051328, 'auroc': 0.6821691, 'binary_precision': 0.44966444, 'binary_recall': 0.10634921, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.17201541}
confusion matrix:
     0   1
0  569  82
1  563  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.5935317, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.47564673, 'auroc': 0.7313185, 'binary_precision': 0.66129035, 'binary_recall': 0.18222222, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  204  21
1  184  41
better model found
persisted
after epoch: 5,now: 2024-07-20 13:29:27.725720,epoch time: 0:01:00.015736,used: 0:05:04.591117,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.79003906, 'precision': 0.79003155, 'recall': 0.7900754, 'specificity': 0.7900754, 'f1': 0.7900293, 'auroc': 0.86014163, 'binary_precision': 0.7958388, 'binary_recall': 0.7871383, 'binary_specificity': 0.7930125, 'binary_f1_score': 0.7914646}
confusion matrix:
      0     1
0  1203   314
1   331  1224
---- Validation: 
scalar performance:
{'acc': 0.51053864, 'precision': 0.510393, 'recall': 0.50422424, 'specificity': 0.50422424, 'f1': 0.42089486, 'auroc': 0.69620365, 'binary_precision': 0.5102041, 'binary_recall': 0.11904762, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.19305019}
confusion matrix:
     0   1
0  579  72
1  555  75
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59265685, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.47011614, 'auroc': 0.7384889, 'binary_precision': 0.66101694, 'binary_recall': 0.17333333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.27464786}
confusion matrix:
     0   1
0  205  20
1  186  39
better model found
persisted
after epoch: 6,now: 2024-07-20 13:30:27.454890,epoch time: 0:00:59.729170,used: 0:06:04.320287,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.81380206, 'precision': 0.81510055, 'recall': 0.81421137, 'specificity': 0.81421137, 'f1': 0.81372124, 'auroc': 0.88592076, 'binary_precision': 0.838843, 'binary_recall': 0.78277636, 'binary_specificity': 0.84564644, 'binary_f1_score': 0.80984044}
confusion matrix:
      0     1
0  1282   234
1   338  1218
---- Validation: 
scalar performance:
{'acc': 0.5120999, 'precision': 0.514567, 'recall': 0.5057092, 'specificity': 0.5057092, 'f1': 0.42019868, 'auroc': 0.71142566, 'binary_precision': 0.5177305, 'binary_recall': 0.11587302, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.18936445}
confusion matrix:
     0   1
0  583  68
1  557  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5466667, 'precision': 0.6087457, 'recall': 0.5466667, 'specificity': 0.5466667, 'f1': 0.4711982, 'auroc': 0.75168395, 'binary_precision': 0.6909091, 'binary_recall': 0.16888888, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.27142859}
confusion matrix:
     0   1
0  208  17
1  187  38
better model found
persisted
after epoch: 7,now: 2024-07-20 13:31:27.005685,epoch time: 0:00:59.550795,used: 0:07:03.871082,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8336589, 'precision': 0.83494365, 'recall': 0.83404016, 'specificity': 0.83404016, 'f1': 0.8335889, 'auroc': 0.9030147, 'binary_precision': 0.8590096, 'binary_recall': 0.80321544, 'binary_specificity': 0.8648649, 'binary_f1_score': 0.8301762}
confusion matrix:
      0     1
0  1312   205
1   306  1249
---- Validation: 
scalar performance:
{'acc': 0.5214676, 'precision': 0.5348797, 'recall': 0.5153354, 'specificity': 0.5153354, 'f1': 0.43944973, 'auroc': 0.7237973, 'binary_precision': 0.55279505, 'binary_recall': 0.14126985, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.22503161}
confusion matrix:
     0   1
0  579  72
1  541  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.6187544, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.48199135, 'auroc': 0.7601383, 'binary_precision': 0.70689654, 'binary_recall': 0.18222222, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.28975263}
confusion matrix:
     0   1
0  208  17
1  184  41
better model found
persisted
after epoch: 8,now: 2024-07-20 13:32:26.807782,epoch time: 0:00:59.802097,used: 0:08:03.673179,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.84277344, 'precision': 0.8456895, 'recall': 0.84334135, 'specificity': 0.84334135, 'f1': 0.8425753, 'auroc': 0.908326, 'binary_precision': 0.8806818, 'binary_recall': 0.79742765, 'binary_specificity': 0.8892551, 'binary_f1_score': 0.8369896}
confusion matrix:
      0     1
0  1349   168
1   315  1240
---- Validation: 
scalar performance:
{'acc': 0.51990634, 'precision': 0.53311837, 'recall': 0.5136201, 'specificity': 0.5136201, 'f1': 0.43280107, 'auroc': 0.73264027, 'binary_precision': 0.5503356, 'binary_recall': 0.13015874, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.21052633}
confusion matrix:
     0   1
0  584  67
1  548  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54888886, 'precision': 0.6195883, 'recall': 0.5488889, 'specificity': 0.5488889, 'f1': 0.47065264, 'auroc': 0.76713085, 'binary_precision': 0.71153843, 'binary_recall': 0.16444445, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.26714802}
confusion matrix:
     0   1
0  210  15
1  188  37
early stop counter: 1
val acc:0.5199063420295715, best validation acc: 0.5214676260948181, corresponding to test acc:                         0.5533333420753479 / 0.5688889026641846
after epoch: 9,now: 2024-07-20 13:33:26.147186,epoch time: 0:00:59.339404,used: 0:09:03.012583,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8421224, 'precision': 0.8455256, 'recall': 0.8428006, 'specificity': 0.8428006, 'f1': 0.8418931, 'auroc': 0.9096286, 'binary_precision': 0.88340485, 'binary_recall': 0.793192, 'binary_specificity': 0.89240927, 'binary_f1_score': 0.8358714}
confusion matrix:
      0     1
0  1352   163
1   322  1235
---- Validation: 
scalar performance:
{'acc': 0.520687, 'precision': 0.535547, 'recall': 0.5143625, 'specificity': 0.5143625, 'f1': 0.43248895, 'auroc': 0.74126005, 'binary_precision': 0.55479455, 'binary_recall': 0.12857144, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.2087629}
confusion matrix:
     0   1
0  586  65
1  549  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.6336676, 'recall': 0.5555555, 'specificity': 0.5555555, 'f1': 0.4795161, 'auroc': 0.78107655, 'binary_precision': 0.7358491, 'binary_recall': 0.17333333, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.28057554}
confusion matrix:
     0   1
0  211  14
1  186  39
early stop counter: 2
val acc:0.5206869840621948, best validation acc: 0.5214676260948181, corresponding to test acc:                         0.5533333420753479 / 0.5688889026641846
after epoch: 10,now: 2024-07-20 13:34:26.144534,epoch time: 0:00:59.997348,used: 0:10:03.009931,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.85091144, 'precision': 0.85475254, 'recall': 0.85155714, 'specificity': 0.85155714, 'f1': 0.85065216, 'auroc': 0.9188664, 'binary_precision': 0.8948884, 'binary_recall': 0.79935694, 'binary_specificity': 0.9037574, 'binary_f1_score': 0.8444294}
confusion matrix:
      0     1
0  1371   146
1   312  1243
---- Validation: 
scalar performance:
{'acc': 0.5261514, 'precision': 0.5483079, 'recall': 0.5198669, 'specificity': 0.5198669, 'f1': 0.44017926, 'auroc': 0.748448, 'binary_precision': 0.5771812, 'binary_recall': 0.13650794, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.22079591}
confusion matrix:
     0   1
0  588  63
1  544  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6427665, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.4903386, 'auroc': 0.78933334, 'binary_precision': 0.75, 'binary_recall': 0.18666667, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.29893237}
confusion matrix:
     0   1
0  211  14
1  183  42
better model found
persisted
after epoch: 11,now: 2024-07-20 13:35:26.342422,epoch time: 0:01:00.197888,used: 0:11:03.207819,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8766276, 'precision': 0.8788272, 'recall': 0.8771609, 'specificity': 0.8771609, 'f1': 0.87653744, 'auroc': 0.9310801, 'binary_precision': 0.9113129, 'binary_recall': 0.83815026, 'binary_specificity': 0.9161716, 'binary_f1_score': 0.8732018}
confusion matrix:
      0     1
0  1388   127
1   252  1305
---- Validation: 
scalar performance:
{'acc': 0.54722875, 'precision': 0.5827291, 'recall': 0.54144907, 'specificity': 0.54144907, 'f1': 0.47919238, 'auroc': 0.7550021, 'binary_precision': 0.63297874, 'binary_recall': 0.18888889, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.29095355}
confusion matrix:
     0    1
0  582   69
1  511  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.63936067, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.50650084, 'auroc': 0.7974124, 'binary_precision': 0.73846155, 'binary_recall': 0.21333334, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.3310345}
confusion matrix:
     0   1
0  208  17
1  177  48
better model found
persisted
after epoch: 12,now: 2024-07-20 13:36:25.933542,epoch time: 0:00:59.591120,used: 0:12:02.798939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8802083, 'precision': 0.882637, 'recall': 0.8807391, 'specificity': 0.8807391, 'f1': 0.88010544, 'auroc': 0.93686795, 'binary_precision': 0.9165498, 'binary_recall': 0.8399743, 'binary_specificity': 0.92150396, 'binary_f1_score': 0.8765929}
confusion matrix:
      0     1
0  1397   119
1   249  1307
---- Validation: 
scalar performance:
{'acc': 0.5441062, 'precision': 0.5791023, 'recall': 0.53822327, 'specificity': 0.53822327, 'f1': 0.47283947, 'auroc': 0.7587838, 'binary_precision': 0.62777776, 'binary_recall': 0.17936508, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.27901232}
confusion matrix:
     0    1
0  584   67
1  517  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.64304173, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5046977, 'auroc': 0.8019753, 'binary_precision': 0.74603176, 'binary_recall': 0.20888889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3263889}
confusion matrix:
     0   1
0  209  16
1  178  47
early stop counter: 1
val acc:0.5441061854362488, best validation acc: 0.5472287535667419, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 13,now: 2024-07-20 13:37:25.392783,epoch time: 0:00:59.459241,used: 0:13:02.258180,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8811849, 'precision': 0.88660514, 'recall': 0.88192785, 'specificity': 0.88192785, 'f1': 0.88089716, 'auroc': 0.93434495, 'binary_precision': 0.93557835, 'binary_recall': 0.82186496, 'binary_specificity': 0.9419908, 'binary_f1_score': 0.8750428}
confusion matrix:
      0     1
0  1429    88
1   277  1278
---- Validation: 
scalar performance:
{'acc': 0.54879, 'precision': 0.5851488, 'recall': 0.54303634, 'specificity': 0.54303634, 'f1': 0.4816597, 'auroc': 0.76417965, 'binary_precision': 0.63684213, 'binary_recall': 0.1920635, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.29512194}
confusion matrix:
     0    1
0  582   69
1  509  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.64304173, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5046977, 'auroc': 0.8061235, 'binary_precision': 0.74603176, 'binary_recall': 0.20888889, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3263889}
confusion matrix:
     0   1
0  209  16
1  178  47
better model found
persisted
after epoch: 14,now: 2024-07-20 13:38:25.356155,epoch time: 0:00:59.963372,used: 0:14:02.221552,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8854167, 'precision': 0.8914795, 'recall': 0.8861563, 'specificity': 0.8861563, 'f1': 0.88509715, 'auroc': 0.94149065, 'binary_precision': 0.9432153, 'binary_recall': 0.8230373, 'binary_specificity': 0.9492754, 'binary_f1_score': 0.87903774}
confusion matrix:
      0     1
0  1441    77
1   275  1279
---- Validation: 
scalar performance:
{'acc': 0.54722875, 'precision': 0.5912205, 'recall': 0.54116744, 'specificity': 0.54116744, 'f1': 0.47146547, 'auroc': 0.76835394, 'binary_precision': 0.6506024, 'binary_recall': 0.17142858, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.2713568}
confusion matrix:
     0    1
0  593   58
1  522  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.648443, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.49745435, 'auroc': 0.8082963, 'binary_precision': 0.7586207, 'binary_recall': 0.19555555, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.31095406}
confusion matrix:
     0   1
0  211  14
1  181  44
early stop counter: 1
val acc:0.5472287535667419, best validation acc: 0.5487899780273438, corresponding to test acc:                         0.5688889026641846 / 0.5688889026641846
after epoch: 15,now: 2024-07-20 13:39:25.045806,epoch time: 0:00:59.689651,used: 0:15:01.911203,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8951823, 'precision': 0.8990096, 'recall': 0.8958025, 'specificity': 0.8958025, 'f1': 0.89502203, 'auroc': 0.946993, 'binary_precision': 0.9413028, 'binary_recall': 0.84565914, 'binary_specificity': 0.9459459, 'binary_f1_score': 0.89092135}
confusion matrix:
      0     1
0  1435    82
1   240  1315
---- Validation: 
scalar performance:
{'acc': 0.5581577, 'precision': 0.6028466, 'recall': 0.5524322, 'specificity': 0.5524322, 'f1': 0.4930741, 'auroc': 0.77171624, 'binary_precision': 0.6666667, 'binary_recall': 0.2031746, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.31143552}
confusion matrix:
     0    1
0  587   64
1  502  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6385895, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.5116699, 'auroc': 0.811437, 'binary_precision': 0.7352941, 'binary_recall': 0.22222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.34129694}
confusion matrix:
     0   1
0  207  18
1  175  50
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 13:40:24.962102,epoch time: 0:00:59.916296,used: 0:16:01.827499,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8883464, 'precision': 0.89111155, 'recall': 0.8889082, 'specificity': 0.8889082, 'f1': 0.8882349, 'auroc': 0.94681287, 'binary_precision': 0.92741364, 'binary_recall': 0.8457584, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.8847059}
confusion matrix:
      0     1
0  1413   103
1   240  1316
---- Validation: 
scalar performance:
{'acc': 0.57064795, 'precision': 0.6171224, 'recall': 0.56520736, 'specificity': 0.56520736, 'f1': 0.5141008, 'auroc': 0.7755809, 'binary_precision': 0.6869159, 'binary_recall': 0.23333333, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.34834123}
confusion matrix:
     0    1
0  584   67
1  483  147
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58666664, 'precision': 0.6527628, 'recall': 0.58666664, 'specificity': 0.58666664, 'f1': 0.5365346, 'auroc': 0.81765926, 'binary_precision': 0.7532467, 'binary_recall': 0.25777778, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.38410598}
confusion matrix:
     0   1
0  206  19
1  167  58
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 13:41:24.839976,epoch time: 0:00:59.877874,used: 0:17:01.705373,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.890625, 'precision': 0.8954793, 'recall': 0.89136106, 'specificity': 0.89136106, 'f1': 0.89040387, 'auroc': 0.9493526, 'binary_precision': 0.9426705, 'binary_recall': 0.8348329, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.8854806}
confusion matrix:
      0     1
0  1437    79
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.568306, 'precision': 0.6193769, 'recall': 0.5626728, 'specificity': 0.5626728, 'f1': 0.5069157, 'auroc': 0.7789847, 'binary_precision': 0.6934673, 'binary_recall': 0.21904762, 'binary_specificity': 0.906298, 'binary_f1_score': 0.33293125}
confusion matrix:
     0    1
0  590   61
1  492  138
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.6405423, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.5200764, 'auroc': 0.81981236, 'binary_precision': 0.7361111, 'binary_recall': 0.23555556, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.35690236}
confusion matrix:
     0   1
0  206  19
1  172  53
early stop counter: 1
val acc:0.568306028842926, best validation acc: 0.5706479549407959, corresponding to test acc:                         0.5866666436195374 / 0.5866666436195374
after epoch: 18,now: 2024-07-20 13:42:24.048088,epoch time: 0:00:59.208112,used: 0:18:00.913485,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8961589, 'precision': 0.90031815, 'recall': 0.89687395, 'specificity': 0.89687395, 'f1': 0.89599216, 'auroc': 0.9475572, 'binary_precision': 0.9446839, 'binary_recall': 0.8445729, 'binary_specificity': 0.94917494, 'binary_f1_score': 0.89182776}
confusion matrix:
      0     1
0  1438    77
1   242  1315
---- Validation: 
scalar performance:
{'acc': 0.5784543, 'precision': 0.6311477, 'recall': 0.57301587, 'specificity': 0.57301587, 'f1': 0.5229353, 'auroc': 0.7831224, 'binary_precision': 0.71028036, 'binary_recall': 0.24126984, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.36018956}
confusion matrix:
     0    1
0  589   62
1  478  152
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.6536443, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.53171694, 'auroc': 0.8234469, 'binary_precision': 0.7567568, 'binary_recall': 0.2488889, 'binary_specificity': 0.92, 'binary_f1_score': 0.37458196}
confusion matrix:
     0   1
0  207  18
1  169  56
better model found
persisted
after epoch: 19,now: 2024-07-20 13:43:23.437804,epoch time: 0:00:59.389716,used: 0:19:00.303201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.89973956, 'precision': 0.90562785, 'recall': 0.9006237, 'specificity': 0.9006237, 'f1': 0.8995, 'auroc': 0.9515871, 'binary_precision': 0.9582111, 'binary_recall': 0.83889604, 'binary_specificity': 0.9623514, 'binary_f1_score': 0.8945927}
confusion matrix:
      0     1
0  1457    57
1   251  1307
---- Validation: 
scalar performance:
{'acc': 0.5823575, 'precision': 0.6376696, 'recall': 0.5769329, 'specificity': 0.5769329, 'f1': 0.527637, 'auroc': 0.78747225, 'binary_precision': 0.7209302, 'binary_recall': 0.24603175, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.3668639}
confusion matrix:
     0    1
0  591   60
1  475  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58666664, 'precision': 0.656, 'recall': 0.5866667, 'specificity': 0.5866667, 'f1': 0.53499997, 'auroc': 0.8272, 'binary_precision': 0.76, 'binary_recall': 0.25333333, 'binary_specificity': 0.92, 'binary_f1_score': 0.38}
confusion matrix:
     0   1
0  207  18
1  168  57
better model found
persisted
after epoch: 20,now: 2024-07-20 13:44:23.468131,epoch time: 0:01:00.030327,used: 0:20:00.333528,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8951823, 'precision': 0.9005644, 'recall': 0.89595306, 'specificity': 0.89595306, 'f1': 0.894945, 'auroc': 0.9495014, 'binary_precision': 0.95036495, 'binary_recall': 0.83676094, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.8899522}
confusion matrix:
      0     1
0  1448    68
1   254  1302
---- Validation: 
scalar performance:
{'acc': 0.5995316, 'precision': 0.65360737, 'recall': 0.59447, 'specificity': 0.59447, 'f1': 0.5543206, 'auroc': 0.7908492, 'binary_precision': 0.7407407, 'binary_recall': 0.2857143, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.41237113}
confusion matrix:
     0    1
0  588   63
1  450  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61777776, 'precision': 0.68558, 'recall': 0.61777776, 'specificity': 0.61777776, 'f1': 0.57935697, 'auroc': 0.8312099, 'binary_precision': 0.7977528, 'binary_recall': 0.31555554, 'binary_specificity': 0.92, 'binary_f1_score': 0.45222932}
confusion matrix:
     0   1
0  207  18
1  154  71
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 13:45:23.647621,epoch time: 0:01:00.179490,used: 0:21:00.513018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9085286, 'precision': 0.9136614, 'recall': 0.90923554, 'specificity': 0.90923554, 'f1': 0.90833557, 'auroc': 0.9597191, 'binary_precision': 0.96293604, 'binary_recall': 0.85209006, 'binary_specificity': 0.966381, 'binary_f1_score': 0.9041283}
confusion matrix:
      0     1
0  1466    51
1   230  1325
---- Validation: 
scalar performance:
{'acc': 0.5979703, 'precision': 0.6548452, 'recall': 0.592806, 'specificity': 0.592806, 'f1': 0.55057377, 'auroc': 0.79324365, 'binary_precision': 0.7446808, 'binary_recall': 0.2777778, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.4046243}
confusion matrix:
     0    1
0  591   60
1  455  175
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.6705955, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.5497289, 'auroc': 0.83217776, 'binary_precision': 0.78205127, 'binary_recall': 0.2711111, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.40264025}
confusion matrix:
     0   1
0  208  17
1  164  61
early stop counter: 1
val acc:0.5979703068733215, best validation acc: 0.5995315909385681, corresponding to test acc:                         0.6177777647972107 / 0.6177777647972107
after epoch: 22,now: 2024-07-20 13:46:23.595044,epoch time: 0:00:59.947423,used: 0:22:00.460441,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.89713544, 'precision': 0.9055092, 'recall': 0.8982337, 'specificity': 0.8982337, 'f1': 0.8967651, 'auroc': 0.9527923, 'binary_precision': 0.9676449, 'binary_recall': 0.82488775, 'binary_specificity': 0.9715797, 'binary_f1_score': 0.8905817}
confusion matrix:
      0     1
0  1470    43
1   273  1286
---- Validation: 
scalar performance:
{'acc': 0.6128025, 'precision': 0.6677238, 'recall': 0.6079365, 'specificity': 0.6079365, 'f1': 0.5725726, 'auroc': 0.79698384, 'binary_precision': 0.7596899, 'binary_recall': 0.31111112, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.44144148}
confusion matrix:
     0    1
0  589   62
1  434  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6288889, 'precision': 0.6949856, 'recall': 0.6288889, 'specificity': 0.6288889, 'f1': 0.59452677, 'auroc': 0.8346666, 'binary_precision': 0.80851066, 'binary_recall': 0.33777776, 'binary_specificity': 0.92, 'binary_f1_score': 0.47648904}
confusion matrix:
     0   1
0  207  18
1  149  76
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 13:47:23.632404,epoch time: 0:01:00.037360,used: 0:23:00.497801,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.9156091, 'recall': 0.91122544, 'specificity': 0.91122544, 'f1': 0.9102981, 'auroc': 0.9597641, 'binary_precision': 0.9651416, 'binary_recall': 0.8541131, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9062394}
confusion matrix:
      0     1
0  1468    48
1   227  1329
---- Validation: 
scalar performance:
{'acc': 0.6252927, 'precision': 0.6775142, 'recall': 0.6206861, 'specificity': 0.6206861, 'f1': 0.59058005, 'auroc': 0.8005023, 'binary_precision': 0.76978415, 'binary_recall': 0.33968255, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.47136566}
confusion matrix:
     0    1
0  587   64
1  416  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6422222, 'precision': 0.70283973, 'recall': 0.6422222, 'specificity': 0.6422222, 'f1': 0.613334, 'auroc': 0.83926916, 'binary_precision': 0.8137255, 'binary_recall': 0.36888888, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5076453}
confusion matrix:
     0   1
0  206  19
1  142  83
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 13:48:23.632584,epoch time: 0:01:00.000180,used: 0:24:00.497981,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.89746094, 'precision': 0.9047577, 'recall': 0.8982159, 'specificity': 0.8982159, 'f1': 0.89711165, 'auroc': 0.96086913, 'binary_precision': 0.9619403, 'binary_recall': 0.8300064, 'binary_specificity': 0.9664253, 'binary_f1_score': 0.8911165}
confusion matrix:
      0     1
0  1468    51
1   264  1289
---- Validation: 
scalar performance:
{'acc': 0.6206089, 'precision': 0.675049, 'recall': 0.61587304, 'specificity': 0.61587304, 'f1': 0.583365, 'auroc': 0.8023797, 'binary_precision': 0.76865673, 'binary_recall': 0.32698414, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.45879737}
confusion matrix:
     0    1
0  589   62
1  424  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.70106953, 'recall': 0.64, 'specificity': 0.64, 'f1': 0.6104188, 'auroc': 0.8416395, 'binary_precision': 0.8118812, 'binary_recall': 0.36444443, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5030675}
confusion matrix:
     0   1
0  206  19
1  143  82
early stop counter: 1
val acc:0.620608925819397, best validation acc: 0.6252927184104919, corresponding to test acc:                         0.6422222256660461 / 0.6422222256660461
after epoch: 25,now: 2024-07-20 13:49:23.478248,epoch time: 0:00:59.845664,used: 0:25:00.343645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90755206, 'precision': 0.91198975, 'recall': 0.908105, 'specificity': 0.908105, 'f1': 0.9073758, 'auroc': 0.9651536, 'binary_precision': 0.95743144, 'binary_recall': 0.85502577, 'binary_specificity': 0.9611842, 'binary_f1_score': 0.9033356}
confusion matrix:
      0     1
0  1461    59
1   225  1327
---- Validation: 
scalar performance:
{'acc': 0.6416862, 'precision': 0.6893443, 'recall': 0.6374296, 'specificity': 0.6374296, 'f1': 0.6134883, 'auroc': 0.80575913, 'binary_precision': 0.78032786, 'binary_recall': 0.37777779, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.50909096}
confusion matrix:
     0    1
0  584   67
1  392  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.71734023, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6427051, 'auroc': 0.84462225, 'binary_precision': 0.8245614, 'binary_recall': 0.41777778, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.5545723}
confusion matrix:
     0   1
0  205  20
1  131  94
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 13:50:23.797525,epoch time: 0:01:00.319277,used: 0:26:00.662922,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9140625, 'precision': 0.91876876, 'recall': 0.9146645, 'specificity': 0.9146645, 'f1': 0.91389376, 'auroc': 0.96216416, 'binary_precision': 0.96601593, 'binary_recall': 0.86027044, 'binary_specificity': 0.9690586, 'binary_f1_score': 0.9100818}
confusion matrix:
      0     1
0  1472    47
1   217  1336
---- Validation: 
scalar performance:
{'acc': 0.6401249, 'precision': 0.6905283, 'recall': 0.6357655, 'specificity': 0.6357655, 'f1': 0.6103698, 'auroc': 0.80825347, 'binary_precision': 0.7845118, 'binary_recall': 0.36984128, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.5026969}
confusion matrix:
     0    1
0  587   64
1  397  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6622222, 'precision': 0.7156587, 'recall': 0.6622222, 'specificity': 0.6622222, 'f1': 0.6399166, 'auroc': 0.8470123, 'binary_precision': 0.82300884, 'binary_recall': 0.41333333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.5502958}
confusion matrix:
     0   1
0  205  20
1  132  93
early stop counter: 1
val acc:0.6401249170303345, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6644444465637207 / 0.6644444465637207
after epoch: 27,now: 2024-07-20 13:51:23.314279,epoch time: 0:00:59.516754,used: 0:27:00.179676,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.92219007, 'recall': 0.91773695, 'specificity': 0.91773695, 'f1': 0.91682184, 'auroc': 0.96625113, 'binary_precision': 0.97240376, 'binary_recall': 0.86053985, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9130582}
confusion matrix:
      0     1
0  1478    38
1   217  1339
---- Validation: 
scalar performance:
{'acc': 0.63856363, 'precision': 0.6891928, 'recall': 0.63417816, 'specificity': 0.63417816, 'f1': 0.6083125, 'auroc': 0.8105382, 'binary_precision': 0.78305084, 'binary_recall': 0.36666667, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.49945945}
confusion matrix:
     0    1
0  587   64
1  399  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7242286, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.64380705, 'auroc': 0.8505087, 'binary_precision': 0.8378378, 'binary_recall': 0.41333333, 'binary_specificity': 0.92, 'binary_f1_score': 0.55357146}
confusion matrix:
     0   1
0  207  18
1  132  93
new oracle model saved
early stop counter: 2
val acc:0.6385636329650879, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6644444465637207 / 0.6666666865348816
after epoch: 28,now: 2024-07-20 13:52:23.187591,epoch time: 0:00:59.873312,used: 0:28:00.052988,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9169922, 'precision': 0.92203975, 'recall': 0.91776454, 'specificity': 0.91776454, 'f1': 0.9168316, 'auroc': 0.96330214, 'binary_precision': 0.9717391, 'binary_recall': 0.8612717, 'binary_specificity': 0.9742574, 'binary_f1_score': 0.9131767}
confusion matrix:
      0     1
0  1476    39
1   216  1341
---- Validation: 
scalar performance:
{'acc': 0.6338798, 'precision': 0.6869108, 'recall': 0.6293651, 'specificity': 0.6293651, 'f1': 0.60133576, 'auroc': 0.8115792, 'binary_precision': 0.78245616, 'binary_recall': 0.35396826, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.48743168}
confusion matrix:
     0    1
0  589   62
1  407  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.7391106, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.6524619, 'auroc': 0.8527802, 'binary_precision': 0.86238533, 'binary_recall': 0.41777778, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.56287426}
confusion matrix:
     0   1
0  210  15
1  131  94
new oracle model saved
early stop counter: 3
val acc:0.6338797807693481, best validation acc: 0.641686201095581, corresponding to test acc:                         0.6644444465637207 / 0.6755555272102356
after epoch: 29,now: 2024-07-20 13:53:22.580787,epoch time: 0:00:59.393196,used: 0:28:59.446184,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.913737, 'precision': 0.9183947, 'recall': 0.914482, 'specificity': 0.914482, 'f1': 0.9135846, 'auroc': 0.9637015, 'binary_precision': 0.9660895, 'binary_recall': 0.85998714, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.90995586}
confusion matrix:
      0     1
0  1468    47
1   218  1339
---- Validation: 
scalar performance:
{'acc': 0.64246684, 'precision': 0.6916691, 'recall': 0.63817203, 'specificity': 0.63817203, 'f1': 0.613801, 'auroc': 0.81449294, 'binary_precision': 0.7847682, 'binary_recall': 0.37619048, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.50858366}
confusion matrix:
     0    1
0  586   65
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.7402095, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6713341, 'auroc': 0.8557037, 'binary_precision': 0.8512397, 'binary_recall': 0.45777777, 'binary_specificity': 0.92, 'binary_f1_score': 0.5953757}
confusion matrix:
     0    1
0  207   18
1  122  103
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-20 13:54:22.227723,epoch time: 0:00:59.646936,used: 0:29:59.093120,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_24_23_seed_1_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:59.093120 at 2024-07-20 13:54:22.227723
persisted model performance metric: 

scalar performance:
{'acc': 0.6888889, 'precision': 0.7402095, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6713341, 'auroc': 0.8557037, 'binary_precision': 0.8512397, 'binary_recall': 0.45777777, 'binary_specificity': 0.92, 'binary_f1_score': 0.5953757}
confusion matrix:
     0    1
0  207   18
1  122  103
oracle model performance metric: 

scalar performance:
{'acc': 0.6888889, 'precision': 0.7402095, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.6713341, 'auroc': 0.8557037, 'binary_precision': 0.8512397, 'binary_recall': 0.45777777, 'binary_specificity': 0.92, 'binary_f1_score': 0.5953757}
confusion matrix:
     0    1
0  207   18
1  122  103
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124060 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8516 MiB |   8524 MiB |  16790 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     44 MiB |     44 MiB |     58 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67125 GiB |  67124 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65467 GiB |  65467 GiB |
|       from small pool |   8174 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20969 K  |   20968 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9570 K  |    9569 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20969 K  |   20968 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9570 K  |    9569 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     370    |     370    |     715    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      22    |      22    |      29    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      46    |     383    |   12482 K  |   12482 K  |
|       from large pool |      11    |     351    |    8265 K  |    8265 K  |
|       from small pool |      35    |     215    |    4216 K  |    4216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   12482 K  |   12482 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4216 K  |    4216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16790 MiB |  16560 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     44 MiB |     58 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20969 K  |   20969 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9570 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |     715    |     693    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      22    |      29    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   12482 K  |   12482 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4216 K  |    4216 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806

 Experiment start at: 2024-07-20 13:55:20.719048
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5847513, 'precision': 0.60275084, 'recall': 0.58632684, 'specificity': 0.58632684, 'f1': 0.5681604, 'auroc': 0.648059, 'binary_precision': 0.64776444, 'binary_recall': 0.3857143, 'binary_specificity': 0.7869393, 'binary_f1_score': 0.48351648}
confusion matrix:
      0    1
0  1193  323
1   946  594
---- Validation: 
scalar performance:
{'acc': 0.64632237, 'precision': 0.65524554, 'recall': 0.6426138, 'specificity': 0.6426138, 'f1': 0.6374432, 'auroc': 0.6693225, 'binary_precision': 0.6864035, 'binary_recall': 0.50321543, 'binary_specificity': 0.7820122, 'binary_f1_score': 0.580705}
confusion matrix:
     0    1
0  513  143
1  309  313
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36342594, 'precision': 0.33976665, 'recall': 0.36342594, 'specificity': 0.36342594, 'f1': 0.3390269, 'auroc': 0.30842763, 'binary_precision': 0.2781955, 'binary_recall': 0.1712963, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.21203437}
confusion matrix:
     0   1
0  120  96
1  179  37
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:56:24.225617,epoch time: 0:01:03.506569,used: 0:01:03.506569,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6462696, 'precision': 0.6475055, 'recall': 0.64658964, 'specificity': 0.64658964, 'f1': 0.64581907, 'auroc': 0.7071823, 'binary_precision': 0.663113, 'binary_recall': 0.60584414, 'binary_specificity': 0.6873351, 'binary_f1_score': 0.6331863}
confusion matrix:
      0    1
0  1042  474
1   607  933
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.6590767, 'recall': 0.657642, 'specificity': 0.657642, 'f1': 0.6574998, 'auroc': 0.6889068, 'binary_precision': 0.6614583, 'binary_recall': 0.6125402, 'binary_specificity': 0.7027439, 'binary_f1_score': 0.63606006}
confusion matrix:
     0    1
0  461  195
1  241  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4027778, 'precision': 0.4015625, 'recall': 0.4027778, 'specificity': 0.4027778, 'f1': 0.4009288, 'auroc': 0.3402778, 'binary_precision': 0.390625, 'binary_recall': 0.3472222, 'binary_specificity': 0.45833334, 'binary_f1_score': 0.36764705}
confusion matrix:
     0    1
0   99  117
1  141   75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 13:57:22.614054,epoch time: 0:00:58.388437,used: 0:02:01.895006,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.70124346, 'precision': 0.701252, 'recall': 0.70126355, 'specificity': 0.70126355, 'f1': 0.7012409, 'auroc': 0.7641281, 'binary_precision': 0.7055738, 'binary_recall': 0.6987013, 'binary_specificity': 0.70382583, 'binary_f1_score': 0.7021207}
confusion matrix:
      0     1
0  1067   449
1   464  1076
---- Validation: 
scalar performance:
{'acc': 0.670579, 'precision': 0.6711011, 'recall': 0.6692833, 'specificity': 0.6692833, 'f1': 0.66911536, 'auroc': 0.7022415, 'binary_precision': 0.67600703, 'binary_recall': 0.62057877, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.64710814}
confusion matrix:
     0    1
0  471  185
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4537037, 'precision': 0.45344827, 'recall': 0.4537037, 'specificity': 0.4537037, 'f1': 0.45295328, 'auroc': 0.37364972, 'binary_precision': 0.45, 'binary_recall': 0.41666666, 'binary_specificity': 0.49074075, 'binary_f1_score': 0.43269226}
confusion matrix:
     0    1
0  106  110
1  126   90
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 13:58:21.014030,epoch time: 0:00:58.399976,used: 0:03:00.294982,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.75556284, 'precision': 0.75571203, 'recall': 0.755648, 'specificity': 0.755648, 'f1': 0.75555694, 'auroc': 0.8311968, 'binary_precision': 0.76415724, 'binary_recall': 0.7448052, 'binary_specificity': 0.76649076, 'binary_f1_score': 0.75435716}
confusion matrix:
      0     1
0  1162   354
1   393  1147
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.68294644, 'recall': 0.6778463, 'specificity': 0.6778463, 'f1': 0.6768775, 'auroc': 0.71270883, 'binary_precision': 0.700565, 'binary_recall': 0.59807074, 'binary_specificity': 0.75762194, 'binary_f1_score': 0.6452732}
confusion matrix:
     0    1
0  497  159
1  250  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46064815, 'precision': 0.45970768, 'recall': 0.46064812, 'specificity': 0.46064812, 'f1': 0.45748243, 'auroc': 0.40680724, 'binary_precision': 0.45355192, 'binary_recall': 0.38425925, 'binary_specificity': 0.537037, 'binary_f1_score': 0.4160401}
confusion matrix:
     0    1
0  116  100
1  133   83
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 13:59:19.312549,epoch time: 0:00:58.298519,used: 0:03:58.593501,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7814136, 'precision': 0.7828822, 'recall': 0.781688, 'specificity': 0.781688, 'f1': 0.78123224, 'auroc': 0.8585422, 'binary_precision': 0.8053221, 'binary_recall': 0.7467533, 'binary_specificity': 0.8166227, 'binary_f1_score': 0.7749327}
confusion matrix:
      0     1
0  1238   278
1   390  1150
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.6841183, 'recall': 0.67565536, 'specificity': 0.67565536, 'f1': 0.6736026, 'auroc': 0.71945584, 'binary_precision': 0.71057886, 'binary_recall': 0.5723473, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.63401604}
confusion matrix:
     0    1
0  511  145
1  266  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46287042, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45646763, 'auroc': 0.43885028, 'binary_precision': 0.45341614, 'binary_recall': 0.33796296, 'binary_specificity': 0.5925926, 'binary_f1_score': 0.38726792}
confusion matrix:
     0   1
0  128  88
1  143  73
new oracle model saved
early stop counter: 1
val acc:0.6784037351608276, best validation acc: 0.6799687147140503, corresponding to test acc:                         0.46064814925193787 / 0.4652777910232544
after epoch: 5,now: 2024-07-20 14:00:17.550497,epoch time: 0:00:58.237948,used: 0:04:56.831449,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.815445, 'precision': 0.8171203, 'recall': 0.81572664, 'specificity': 0.81572664, 'f1': 0.81528485, 'auroc': 0.89304435, 'binary_precision': 0.842216, 'binary_recall': 0.77987015, 'binary_specificity': 0.8515831, 'binary_f1_score': 0.8098449}
confusion matrix:
      0     1
0  1291   225
1   339  1201
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.692099, 'recall': 0.6771503, 'specificity': 0.6771503, 'f1': 0.6730614, 'auroc': 0.72542596, 'binary_precision': 0.7326087, 'binary_recall': 0.5418006, 'binary_specificity': 0.8125, 'binary_f1_score': 0.6229205}
confusion matrix:
     0    1
0  533  123
1  285  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4513889, 'precision': 0.44621387, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.43786752, 'auroc': 0.46442044, 'binary_precision': 0.4295302, 'binary_recall': 0.2962963, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.35068494}
confusion matrix:
     0   1
0  131  85
1  152  64
better model found
persisted
after epoch: 6,now: 2024-07-20 14:01:16.301693,epoch time: 0:00:58.751196,used: 0:05:55.582645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8426047, 'precision': 0.84500307, 'recall': 0.8429316, 'specificity': 0.8429316, 'f1': 0.8424115, 'auroc': 0.91181254, 'binary_precision': 0.87579846, 'binary_recall': 0.8012987, 'binary_specificity': 0.88456464, 'binary_f1_score': 0.83689386}
confusion matrix:
      0     1
0  1341   175
1   306  1234
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.69347405, 'recall': 0.6752093, 'specificity': 0.6752093, 'f1': 0.6699313, 'auroc': 0.7284111, 'binary_precision': 0.739819, 'binary_recall': 0.52572346, 'binary_specificity': 0.8246951, 'binary_f1_score': 0.6146616}
confusion matrix:
     0    1
0  541  115
1  295  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46107173, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45043314, 'auroc': 0.48491085, 'binary_precision': 0.44827586, 'binary_recall': 0.30092594, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.36011085}
confusion matrix:
     0   1
0  136  80
1  151  65
early stop counter: 1
val acc:0.679186224937439, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.4652777910232544
after epoch: 7,now: 2024-07-20 14:02:14.327053,epoch time: 0:00:58.025360,used: 0:06:53.608005,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8406414, 'precision': 0.84519386, 'recall': 0.8410915, 'specificity': 0.8410915, 'f1': 0.84023035, 'auroc': 0.90903103, 'binary_precision': 0.8868479, 'binary_recall': 0.7837662, 'binary_specificity': 0.8984169, 'binary_f1_score': 0.8321268}
confusion matrix:
      0     1
0  1362   154
1   333  1207
---- Validation: 
scalar performance:
{'acc': 0.6760563, 'precision': 0.69652975, 'recall': 0.67141056, 'specificity': 0.67141056, 'f1': 0.6635918, 'auroc': 0.7327146, 'binary_precision': 0.75365853, 'binary_recall': 0.49678457, 'binary_specificity': 0.8460366, 'binary_f1_score': 0.5988372}
confusion matrix:
     0    1
0  555  101
1  313  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47685185, 'precision': 0.47272727, 'recall': 0.47685185, 'specificity': 0.47685185, 'f1': 0.45629513, 'auroc': 0.5069444, 'binary_precision': 0.46212122, 'binary_recall': 0.2824074, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.3505747}
confusion matrix:
     0   1
0  145  71
1  155  61
new oracle model saved
early stop counter: 2
val acc:0.6760563254356384, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.47685185074806213
after epoch: 8,now: 2024-07-20 14:03:12.393439,epoch time: 0:00:58.066386,used: 0:07:51.674391,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85340315, 'precision': 0.8559066, 'recall': 0.8537333, 'specificity': 0.8537333, 'f1': 0.85321987, 'auroc': 0.91949123, 'binary_precision': 0.88778406, 'binary_recall': 0.8116883, 'binary_specificity': 0.89577836, 'binary_f1_score': 0.84803253}
confusion matrix:
      0     1
0  1358   158
1   290  1250
---- Validation: 
scalar performance:
{'acc': 0.6697966, 'precision': 0.6967237, 'recall': 0.6645214, 'specificity': 0.6645214, 'f1': 0.65364254, 'auroc': 0.7361604, 'binary_precision': 0.7631579, 'binary_recall': 0.46623793, 'binary_specificity': 0.8628049, 'binary_f1_score': 0.57884234}
confusion matrix:
     0    1
0  566   90
1  332  290
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4861111, 'precision': 0.48251104, 'recall': 0.4861111, 'specificity': 0.4861111, 'f1': 0.4582307, 'auroc': 0.52278376, 'binary_precision': 0.47457626, 'binary_recall': 0.25925925, 'binary_specificity': 0.712963, 'binary_f1_score': 0.33532935}
confusion matrix:
     0   1
0  154  62
1  160  56
new oracle model saved
early stop counter: 3
val acc:0.6697965860366821, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.4861111044883728
after epoch: 9,now: 2024-07-20 14:04:10.732961,epoch time: 0:00:58.339522,used: 0:08:50.013913,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8661649, 'precision': 0.8696751, 'recall': 0.86654985, 'specificity': 0.86654985, 'f1': 0.865926, 'auroc': 0.93203235, 'binary_precision': 0.9077145, 'binary_recall': 0.8175325, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.8602665}
confusion matrix:
      0     1
0  1388   128
1   281  1259
---- Validation: 
scalar performance:
{'acc': 0.6651017, 'precision': 0.6968137, 'recall': 0.6594066, 'specificity': 0.6594066, 'f1': 0.64611804, 'auroc': 0.7373515, 'binary_precision': 0.76944447, 'binary_recall': 0.44533762, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.5641548}
confusion matrix:
     0    1
0  573   83
1  345  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5, 'precision': 0.5, 'recall': 0.5, 'specificity': 0.5, 'f1': 0.4666667, 'auroc': 0.5356225, 'binary_precision': 0.5, 'binary_recall': 0.25, 'binary_specificity': 0.75, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  162  54
1  162  54
new oracle model saved
early stop counter: 4
val acc:0.6651017069816589, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5
after epoch: 10,now: 2024-07-20 14:05:09.345447,epoch time: 0:00:58.612486,used: 0:09:48.626399,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8746728, 'precision': 0.87897074, 'recall': 0.87509423, 'specificity': 0.87509423, 'f1': 0.87439775, 'auroc': 0.9333675, 'binary_precision': 0.9213401, 'binary_recall': 0.8214286, 'binary_specificity': 0.9287599, 'binary_f1_score': 0.86852044}
confusion matrix:
      0     1
0  1408   108
1   275  1265
---- Validation: 
scalar performance:
{'acc': 0.6627543, 'precision': 0.7000613, 'recall': 0.65666175, 'specificity': 0.65666175, 'f1': 0.6409408, 'auroc': 0.74080956, 'binary_precision': 0.7800586, 'binary_recall': 0.42765275, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.5524403}
confusion matrix:
     0    1
0  581   75
1  356  266
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.50641716, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.46755135, 'auroc': 0.55339074, 'binary_precision': 0.50980395, 'binary_recall': 0.24074075, 'binary_specificity': 0.7685185, 'binary_f1_score': 0.32704404}
confusion matrix:
     0   1
0  166  50
1  164  52
new oracle model saved
early stop counter: 5
val acc:0.6627542972564697, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5046296119689941
after epoch: 11,now: 2024-07-20 14:06:08.196530,epoch time: 0:00:58.851083,used: 0:10:47.477482,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8710733, 'precision': 0.874674, 'recall': 0.87146115, 'specificity': 0.87146115, 'f1': 0.87083954, 'auroc': 0.93232965, 'binary_precision': 0.9134199, 'binary_recall': 0.82207793, 'binary_specificity': 0.9208443, 'binary_f1_score': 0.8653452}
confusion matrix:
      0     1
0  1396   120
1   274  1266
---- Validation: 
scalar performance:
{'acc': 0.6517997, 'precision': 0.6952529, 'recall': 0.6451577, 'specificity': 0.6451577, 'f1': 0.62510955, 'auroc': 0.7419908, 'binary_precision': 0.7809524, 'binary_recall': 0.3954984, 'binary_specificity': 0.89481705, 'binary_f1_score': 0.5250801}
confusion matrix:
     0    1
0  587   69
1  376  246
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5203953, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.47175965, 'auroc': 0.5626286, 'binary_precision': 0.5319149, 'binary_recall': 0.23148148, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.32258064}
confusion matrix:
     0   1
0  172  44
1  166  50
new oracle model saved
early stop counter: 6
val acc:0.6517996788024902, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 12,now: 2024-07-20 14:07:06.380569,epoch time: 0:00:58.184039,used: 0:11:45.661521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8759817, 'precision': 0.8797742, 'recall': 0.8763775, 'specificity': 0.8763775, 'f1': 0.87574637, 'auroc': 0.9427192, 'binary_precision': 0.9197397, 'binary_recall': 0.82597405, 'binary_specificity': 0.926781, 'binary_f1_score': 0.8703388}
confusion matrix:
      0     1
0  1405   111
1   268  1272
---- Validation: 
scalar performance:
{'acc': 0.64788735, 'precision': 0.6959919, 'recall': 0.6409301, 'specificity': 0.6409301, 'f1': 0.6182664, 'auroc': 0.7440127, 'binary_precision': 0.7866667, 'binary_recall': 0.37942123, 'binary_specificity': 0.902439, 'binary_f1_score': 0.5119306}
confusion matrix:
     0    1
0  592   64
1  386  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.517991, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.46375814, 'auroc': 0.5732596, 'binary_precision': 0.52873564, 'binary_recall': 0.21296297, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.30363035}
confusion matrix:
     0   1
0  175  41
1  170  46
early stop counter: 7
val acc:0.6478873491287231, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 13,now: 2024-07-20 14:08:04.657703,epoch time: 0:00:58.277134,used: 0:12:43.938655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8867801, 'precision': 0.89041734, 'recall': 0.88716376, 'specificity': 0.88716376, 'f1': 0.8865812, 'auroc': 0.94515, 'binary_precision': 0.9301153, 'binary_recall': 0.8383117, 'binary_specificity': 0.93601584, 'binary_f1_score': 0.88183063}
confusion matrix:
      0     1
0  1419    97
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.6976048, 'recall': 0.63251656, 'specificity': 0.63251656, 'f1': 0.6043418, 'auroc': 0.7443019, 'binary_precision': 0.7977941, 'binary_recall': 0.3488746, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.4854586}
confusion matrix:
     0    1
0  601   55
1  405  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5225784, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.46213865, 'auroc': 0.5793681, 'binary_precision': 0.5365854, 'binary_recall': 0.2037037, 'binary_specificity': 0.8240741, 'binary_f1_score': 0.295302}
confusion matrix:
     0   1
0  178  38
1  172  44
early stop counter: 8
val acc:0.6400625705718994, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 14,now: 2024-07-20 14:09:02.746651,epoch time: 0:00:58.088948,used: 0:13:42.027603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8903796, 'precision': 0.8946214, 'recall': 0.8907917, 'specificity': 0.8907917, 'f1': 0.89015234, 'auroc': 0.94936734, 'binary_precision': 0.93754536, 'binary_recall': 0.8383117, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.885156}
confusion matrix:
      0     1
0  1430    86
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.70353943, 'recall': 0.6397513, 'specificity': 0.6397513, 'f1': 0.6138582, 'auroc': 0.7474315, 'binary_precision': 0.80427045, 'binary_recall': 0.36334404, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.5005537}
confusion matrix:
     0    1
0  601   55
1  396  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.52177715, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.46548513, 'auroc': 0.59149945, 'binary_precision': 0.53488374, 'binary_recall': 0.21296297, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.30463576}
confusion matrix:
     0   1
0  176  40
1  170  46
early stop counter: 9
val acc:0.6471048593521118, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5138888955116272
after epoch: 15,now: 2024-07-20 14:10:01.047465,epoch time: 0:00:58.300814,used: 0:14:40.328417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.89463353, 'precision': 0.8994242, 'recall': 0.89506906, 'specificity': 0.89506906, 'f1': 0.8943858, 'auroc': 0.94976956, 'binary_precision': 0.9451754, 'binary_recall': 0.8396104, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.889271}
confusion matrix:
      0     1
0  1441    75
1   247  1293
---- Validation: 
scalar performance:
{'acc': 0.62754303, 'precision': 0.69426274, 'recall': 0.6193632, 'specificity': 0.6193632, 'f1': 0.5838751, 'auroc': 0.74718153, 'binary_precision': 0.8016529, 'binary_recall': 0.3118971, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.44907412}
confusion matrix:
     0    1
0  608   48
1  428  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.52765685, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.46033242, 'auroc': 0.60097307, 'binary_precision': 0.54545456, 'binary_recall': 0.19444445, 'binary_specificity': 0.837963, 'binary_f1_score': 0.2866894}
confusion matrix:
     0   1
0  181  35
1  174  42
new oracle model saved
early stop counter: 10
val acc:0.627543032169342, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 16,now: 2024-07-20 14:10:59.693927,epoch time: 0:00:58.646462,used: 0:15:38.974879,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8939791, 'precision': 0.89887893, 'recall': 0.89441967, 'specificity': 0.89441967, 'f1': 0.893723, 'auroc': 0.95377916, 'binary_precision': 0.9450952, 'binary_recall': 0.8383117, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.88850653}
confusion matrix:
      0     1
0  1441    75
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.6874264, 'recall': 0.60882974, 'specificity': 0.60882974, 'f1': 0.568268, 'auroc': 0.7466951, 'binary_precision': 0.79555553, 'binary_recall': 0.28778136, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.42266825}
confusion matrix:
     0    1
0  610   46
1  443  179
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.525, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.453125, 'auroc': 0.6068244, 'binary_precision': 0.5416667, 'binary_recall': 0.18055555, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.27083334}
confusion matrix:
     0   1
0  183  33
1  177  39
early stop counter: 11
val acc:0.6173709034919739, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 17,now: 2024-07-20 14:11:57.819322,epoch time: 0:00:58.125395,used: 0:16:37.100274,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.89757854, 'precision': 0.90246046, 'recall': 0.8980168, 'specificity': 0.8980168, 'f1': 0.89733446, 'auroc': 0.95334226, 'binary_precision': 0.948793, 'binary_recall': 0.8422078, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.89232886}
confusion matrix:
      0     1
0  1446    70
1   243  1297
---- Validation: 
scalar performance:
{'acc': 0.6126761, 'precision': 0.6829847, 'recall': 0.6040065, 'specificity': 0.6040065, 'f1': 0.5613926, 'auroc': 0.7473066, 'binary_precision': 0.78995436, 'binary_recall': 0.27813506, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.41141498}
confusion matrix:
     0    1
0  610   46
1  449  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.5220814, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.445625, 'auroc': 0.60982513, 'binary_precision': 0.53731346, 'binary_recall': 0.16666667, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.25441697}
confusion matrix:
     0   1
0  185  31
1  180  36
early stop counter: 12
val acc:0.6126760840415955, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 18,now: 2024-07-20 14:12:56.139385,epoch time: 0:00:58.320063,used: 0:17:35.420337,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.8943063, 'precision': 0.8992687, 'recall': 0.8947495, 'specificity': 0.8947495, 'f1': 0.89404756, 'auroc': 0.94864345, 'binary_precision': 0.94578755, 'binary_recall': 0.8383117, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.88881236}
confusion matrix:
      0     1
0  1442    74
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.68721557, 'recall': 0.60718036, 'specificity': 0.60718036, 'f1': 0.56546235, 'auroc': 0.7506715, 'binary_precision': 0.7963801, 'binary_recall': 0.2829582, 'binary_specificity': 0.93140244, 'binary_f1_score': 0.41755638}
confusion matrix:
     0    1
0  611   45
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.5288472, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.45666915, 'auroc': 0.61310446, 'binary_precision': 0.5479452, 'binary_recall': 0.18518518, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.27681658}
confusion matrix:
     0   1
0  183  33
1  176  40
early stop counter: 13
val acc:0.6158059239387512, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5162037014961243
after epoch: 19,now: 2024-07-20 14:13:54.485368,epoch time: 0:00:58.345983,used: 0:18:33.766320,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.90575916, 'precision': 0.90867794, 'recall': 0.90609777, 'specificity': 0.90609777, 'f1': 0.9056369, 'auroc': 0.9570298, 'binary_precision': 0.9452347, 'binary_recall': 0.86298704, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.90224034}
confusion matrix:
      0     1
0  1439    77
1   211  1329
---- Validation: 
scalar performance:
{'acc': 0.6197183, 'precision': 0.6883795, 'recall': 0.61128294, 'specificity': 0.61128294, 'f1': 0.5721831, 'auroc': 0.75368106, 'binary_precision': 0.79565215, 'binary_recall': 0.29421222, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.42957744}
confusion matrix:
     0    1
0  609   47
1  439  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55707383, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47576594, 'auroc': 0.6283008, 'binary_precision': 0.5945946, 'binary_recall': 0.2037037, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3034483}
confusion matrix:
     0   1
0  186  30
1  172  44
new oracle model saved
early stop counter: 14
val acc:0.6197183132171631, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5324074029922485
after epoch: 20,now: 2024-07-20 14:14:52.964184,epoch time: 0:00:58.478816,used: 0:19:32.245136,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9054319, 'precision': 0.90867627, 'recall': 0.9057884, 'specificity': 0.9057884, 'f1': 0.9052931, 'auroc': 0.95741224, 'binary_precision': 0.94710505, 'binary_recall': 0.8603896, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.9016672}
confusion matrix:
      0     1
0  1442    74
1   215  1325
---- Validation: 
scalar performance:
{'acc': 0.6205008, 'precision': 0.69031644, 'recall': 0.61204517, 'specificity': 0.61204517, 'f1': 0.5728124, 'auroc': 0.7560388, 'binary_precision': 0.7991266, 'binary_recall': 0.29421222, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.43008226}
confusion matrix:
     0    1
0  610   46
1  439  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56522727, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.4809564, 'auroc': 0.6336162, 'binary_precision': 0.6081081, 'binary_recall': 0.20833333, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.31034482}
confusion matrix:
     0   1
0  187  29
1  171  45
new oracle model saved
early stop counter: 15
val acc:0.6205008029937744, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 21,now: 2024-07-20 14:15:51.888432,epoch time: 0:00:58.924248,used: 0:20:31.169384,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90052354, 'precision': 0.90514743, 'recall': 0.9009492, 'specificity': 0.9009492, 'f1': 0.9003022, 'auroc': 0.95324767, 'binary_precision': 0.9504373, 'binary_recall': 0.84675324, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.8956044}
confusion matrix:
      0     1
0  1448    68
1   236  1304
---- Validation: 
scalar performance:
{'acc': 0.6165884, 'precision': 0.68922496, 'recall': 0.6079425, 'specificity': 0.6079425, 'f1': 0.56608564, 'auroc': 0.75667834, 'binary_precision': 0.8, 'binary_recall': 0.2829582, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.41805226}
confusion matrix:
     0    1
0  612   44
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.5560546, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.46855742, 'auroc': 0.6381173, 'binary_precision': 0.5942029, 'binary_recall': 0.18981482, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.2877193}
confusion matrix:
     0   1
0  188  28
1  175  41
early stop counter: 16
val acc:0.6165884137153625, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 22,now: 2024-07-20 14:16:50.289010,epoch time: 0:00:58.400578,used: 0:21:29.569962,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.91884816, 'precision': 0.9217578, 'recall': 0.9191824, 'specificity': 0.9191824, 'f1': 0.9187467, 'auroc': 0.96720093, 'binary_precision': 0.9588068, 'binary_recall': 0.8766234, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9158752}
confusion matrix:
      0     1
0  1458    58
1   190  1350
---- Validation: 
scalar performance:
{'acc': 0.6181534, 'precision': 0.6932924, 'recall': 0.6094669, 'specificity': 0.6094669, 'f1': 0.5673327, 'auroc': 0.7589797, 'binary_precision': 0.80733943, 'binary_recall': 0.2829582, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.41904762}
confusion matrix:
     0    1
0  614   42
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5347222, 'precision': 0.5632047, 'recall': 0.5347222, 'specificity': 0.5347222, 'f1': 0.475649, 'auroc': 0.6437757, 'binary_precision': 0.6056338, 'binary_recall': 0.19907407, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.29965156}
confusion matrix:
     0   1
0  188  28
1  173  43
early stop counter: 17
val acc:0.6181533932685852, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 23,now: 2024-07-20 14:17:48.425214,epoch time: 0:00:58.136204,used: 0:22:27.706166,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9064136, 'precision': 0.912206, 'recall': 0.90688586, 'specificity': 0.90688586, 'f1': 0.90614986, 'auroc': 0.95988846, 'binary_precision': 0.96307236, 'binary_recall': 0.84675324, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.9011748}
confusion matrix:
      0     1
0  1466    50
1   236  1304
---- Validation: 
scalar performance:
{'acc': 0.6165884, 'precision': 0.7019351, 'recall': 0.60756755, 'specificity': 0.60756755, 'f1': 0.5612149, 'auroc': 0.7583057, 'binary_precision': 0.8267327, 'binary_recall': 0.26848873, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.4053398}
confusion matrix:
     0    1
0  621   35
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.55741155, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.46664393, 'auroc': 0.64240396, 'binary_precision': 0.5970149, 'binary_recall': 0.18518518, 'binary_specificity': 0.875, 'binary_f1_score': 0.2826855}
confusion matrix:
     0   1
0  189  27
1  176  40
early stop counter: 18
val acc:0.6165884137153625, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5370370149612427
after epoch: 24,now: 2024-07-20 14:18:46.503695,epoch time: 0:00:58.078481,used: 0:23:25.784647,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90870416, 'precision': 0.9127941, 'recall': 0.909102, 'specificity': 0.909102, 'f1': 0.9085309, 'auroc': 0.9582368, 'binary_precision': 0.955893, 'binary_recall': 0.85844153, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.9045501}
confusion matrix:
      0     1
0  1455    61
1   218  1322
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.7005334, 'recall': 0.60595983, 'specificity': 0.60595983, 'f1': 0.55886143, 'auroc': 0.75861204, 'binary_precision': 0.825, 'binary_recall': 0.2652733, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.40145987}
confusion matrix:
     0    1
0  621   35
1  457  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.571632, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.48086637, 'auroc': 0.65372086, 'binary_precision': 0.6197183, 'binary_recall': 0.2037037, 'binary_specificity': 0.875, 'binary_f1_score': 0.3066202}
confusion matrix:
     0   1
0  189  27
1  172  44
new oracle model saved
early stop counter: 19
val acc:0.6150234937667847, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5393518805503845
after epoch: 25,now: 2024-07-20 14:19:44.995175,epoch time: 0:00:58.491480,used: 0:24:24.276127,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90772253, 'precision': 0.9125395, 'recall': 0.9081537, 'specificity': 0.9081537, 'f1': 0.9075114, 'auroc': 0.96250814, 'binary_precision': 0.9591241, 'binary_recall': 0.85324675, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9030928}
confusion matrix:
      0     1
0  1460    56
1   226  1314
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.704188, 'recall': 0.6083297, 'specificity': 0.6083297, 'f1': 0.56183136, 'auroc': 0.7585263, 'binary_precision': 0.8308458, 'binary_recall': 0.26848873, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.40583232}
confusion matrix:
     0    1
0  622   34
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.571632, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.48086637, 'auroc': 0.6570645, 'binary_precision': 0.6197183, 'binary_recall': 0.2037037, 'binary_specificity': 0.875, 'binary_f1_score': 0.3066202}
confusion matrix:
     0   1
0  189  27
1  172  44
early stop counter: 20
val acc:0.6173709034919739, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5393518805503845
after epoch: 26,now: 2024-07-20 14:20:43.476782,epoch time: 0:00:58.481607,used: 0:25:22.757734,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.90379584, 'precision': 0.91077495, 'recall': 0.90431416, 'specificity': 0.90431416, 'f1': 0.90346086, 'auroc': 0.95961523, 'binary_precision': 0.96631736, 'binary_recall': 0.8383117, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.89777464}
confusion matrix:
      0     1
0  1471    45
1   249  1291
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.7026303, 'recall': 0.6083714, 'specificity': 0.6083714, 'f1': 0.56238854, 'auroc': 0.76101017, 'binary_precision': 0.82758623, 'binary_recall': 0.27009645, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.4072727}
confusion matrix:
     0    1
0  621   35
1  454  168
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55707383, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47576594, 'auroc': 0.6614369, 'binary_precision': 0.5945946, 'binary_recall': 0.2037037, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3034483}
confusion matrix:
     0   1
0  186  30
1  172  44
early stop counter: 21
val acc:0.6173709034919739, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5393518805503845
after epoch: 27,now: 2024-07-20 14:21:41.728725,epoch time: 0:00:58.251943,used: 0:26:21.009677,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91786647, 'precision': 0.9210052, 'recall': 0.9182135, 'specificity': 0.9182135, 'f1': 0.91775405, 'auroc': 0.9663126, 'binary_precision': 0.95937276, 'binary_recall': 0.874026, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.91471285}
confusion matrix:
      0     1
0  1459    57
1   194  1346
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.70561403, 'recall': 0.6206376, 'specificity': 0.6206376, 'f1': 0.582255, 'auroc': 0.76362395, 'binary_precision': 0.8245614, 'binary_recall': 0.3022508, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.44235295}
confusion matrix:
     0    1
0  616   40
1  434  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.57389164, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49957442, 'auroc': 0.6692387, 'binary_precision': 0.61904764, 'binary_recall': 0.24074075, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34666666}
confusion matrix:
     0   1
0  184  32
1  164  52
new oracle model saved
early stop counter: 22
val acc:0.6291079521179199, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5462962985038757
after epoch: 28,now: 2024-07-20 14:22:40.249806,epoch time: 0:00:58.521081,used: 0:27:19.530758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.924411, 'precision': 0.92769194, 'recall': 0.92476356, 'specificity': 0.92476356, 'f1': 0.92430377, 'auroc': 0.9739739, 'binary_precision': 0.9671663, 'binary_recall': 0.8798701, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9214553}
confusion matrix:
      0     1
0  1470    46
1   185  1355
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.7005334, 'recall': 0.60595983, 'specificity': 0.60595983, 'f1': 0.55886143, 'auroc': 0.764168, 'binary_precision': 0.825, 'binary_recall': 0.2652733, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.40145987}
confusion matrix:
     0    1
0  621   35
1  457  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.56386757, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.48270905, 'auroc': 0.6740397, 'binary_precision': 0.6052632, 'binary_recall': 0.21296297, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3150685}
confusion matrix:
     0   1
0  186  30
1  170  46
early stop counter: 23
val acc:0.6150234937667847, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5462962985038757
after epoch: 29,now: 2024-07-20 14:23:38.287441,epoch time: 0:00:58.037635,used: 0:28:17.568393,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9217932, 'precision': 0.9244047, 'recall': 0.9221096, 'specificity': 0.9221096, 'f1': 0.92170763, 'auroc': 0.96719277, 'binary_precision': 0.95971733, 'binary_recall': 0.8818182, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.91912013}
confusion matrix:
      0     1
0  1459    57
1   182  1358
---- Validation: 
scalar performance:
{'acc': 0.6236307, 'precision': 0.70806444, 'recall': 0.61480224, 'specificity': 0.61480224, 'f1': 0.57170236, 'auroc': 0.7659687, 'binary_precision': 0.8341232, 'binary_recall': 0.2829582, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.42256904}
confusion matrix:
     0    1
0  621   35
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5721747, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.4946288, 'auroc': 0.68006253, 'binary_precision': 0.61728394, 'binary_recall': 0.23148148, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.33670032}
confusion matrix:
     0   1
0  185  31
1  166  50
early stop counter: 24
val acc:0.623630702495575, best validation acc: 0.6807511448860168, corresponding to test acc:                         0.4513888955116272 / 0.5462962985038757
after epoch: 30,now: 2024-07-20 14:24:36.710604,epoch time: 0:00:58.423163,used: 0:29:15.991556,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_55_20_seed_2_22504806
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:15.991556 at 2024-07-20 14:24:36.710604
persisted model performance metric: 

scalar performance:
{'acc': 0.4513889, 'precision': 0.44621387, 'recall': 0.4513889, 'specificity': 0.4513889, 'f1': 0.43786752, 'auroc': 0.46442044, 'binary_precision': 0.4295302, 'binary_recall': 0.2962963, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.35068494}
confusion matrix:
     0   1
0  131  85
1  152  64
oracle model performance metric: 

scalar performance:
{'acc': 0.5462963, 'precision': 0.57389164, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49957442, 'auroc': 0.6692387, 'binary_precision': 0.61904764, 'binary_recall': 0.24074075, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34666666}
confusion matrix:
     0   1
0  184  32
1  164  52
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/4.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/4.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185298 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185298 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185274 GiB | 185274 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8524 MiB |  25070 MiB |  16560 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     44 MiB |     72 MiB |     34 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB |  98948 GiB |  98948 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  96476 GiB |  96476 GiB |
|       from small pool |   8180 KiB |  22319 KiB |   2471 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31313 K  |   31312 K  |
|       from large pool |      79    |     762    |   17022 K  |   17021 K  |
|       from small pool |     709    |    1017    |   14291 K  |   14290 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31313 K  |   31312 K  |
|       from large pool |      79    |     762    |   17022 K  |   17021 K  |
|       from small pool |     709    |    1017    |   14291 K  |   14290 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     370    |    1060    |     693    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      22    |      36    |      17    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     383    |   18387 K  |   18387 K  |
|       from large pool |      11    |     351    |   12107 K  |   12107 K  |
|       from small pool |      33    |     215    |    6280 K  |    6280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185274 GiB | 185274 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25070 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  24576 KiB |     44 MiB |     72 MiB |     48 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  98948 GiB |  98948 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  96476 GiB |  96476 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2471 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31313 K  |   31313 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14291 K  |   14291 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31313 K  |   31313 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14291 K  |   14291 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     370    |    1060    |    1038    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      12    |      22    |      36    |      24    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     383    |   18387 K  |   18387 K  |
|       from large pool |       3    |     351    |   12107 K  |   12107 K  |
|       from small pool |       0    |     215    |    6280 K  |    6280 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 14:25:12 2024]
Finished job 0.
1 of 1 steps (100%) done
