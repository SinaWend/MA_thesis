Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 14:26:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810

 Experiment start at: 2024-07-20 14:29:37.385069
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81152344, 'precision': 0.8144331, 'recall': 0.81216925, 'specificity': 0.81216925, 'f1': 0.81127703, 'auroc': 0.86846244, 'binary_precision': 0.8482906, 'binary_recall': 0.7649326, 'binary_specificity': 0.85940593, 'binary_f1_score': 0.80445796}
confusion matrix:
      0     1
0  1302   213
1   366  1191
---- Validation: 
scalar performance:
{'acc': 0.5745342, 'precision': 0.6039728, 'recall': 0.5705876, 'specificity': 0.5705876, 'f1': 0.53535724, 'auroc': 0.7189567, 'binary_precision': 0.65591395, 'binary_recall': 0.28818896, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.40043762}
confusion matrix:
     0    1
0  557   96
1  452  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5813953, 'precision': 0.62196505, 'recall': 0.5813953, 'specificity': 0.5813953, 'f1': 0.54342747, 'auroc': 0.71392107, 'binary_precision': 0.6923077, 'binary_recall': 0.29302326, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.41176474}
confusion matrix:
     0   1
0  187  28
1  152  63
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:30:50.101215,epoch time: 0:01:12.716146,used: 0:01:12.716146,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8574219, 'precision': 0.8649465, 'recall': 0.8584559, 'specificity': 0.8584559, 'f1': 0.85690856, 'auroc': 0.91609466, 'binary_precision': 0.92105263, 'binary_recall': 0.7862644, 'binary_specificity': 0.9306473, 'binary_f1_score': 0.8483379}
confusion matrix:
      0     1
0  1409   105
1   333  1225
---- Validation: 
scalar performance:
{'acc': 0.5954969, 'precision': 0.62783945, 'recall': 0.591804, 'specificity': 0.591804, 'f1': 0.5630467, 'auroc': 0.7380533, 'binary_precision': 0.68874174, 'binary_recall': 0.32755905, 'binary_specificity': 0.856049, 'binary_f1_score': 0.4439701}
confusion matrix:
     0    1
0  559   94
1  427  208
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61162794, 'precision': 0.6465909, 'recall': 0.61162794, 'specificity': 0.61162794, 'f1': 0.58700216, 'auroc': 0.7550892, 'binary_precision': 0.7181818, 'binary_recall': 0.36744186, 'binary_specificity': 0.855814, 'binary_f1_score': 0.48615387}
confusion matrix:
     0   1
0  184  31
1  136  79
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 14:31:54.122573,epoch time: 0:01:04.021358,used: 0:02:16.737504,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.86816406, 'precision': 0.8758141, 'recall': 0.8691956, 'specificity': 0.8691956, 'f1': 0.8676946, 'auroc': 0.93596447, 'binary_precision': 0.933133, 'binary_recall': 0.7971759, 'binary_specificity': 0.94121534, 'binary_f1_score': 0.85981315}
confusion matrix:
      0     1
0  1425    89
1   316  1242
---- Validation: 
scalar performance:
{'acc': 0.6257764, 'precision': 0.6614574, 'recall': 0.62236077, 'specificity': 0.62236077, 'f1': 0.60016185, 'auroc': 0.75748694, 'binary_precision': 0.73394495, 'binary_recall': 0.37795275, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.49896052}
confusion matrix:
     0    1
0  566   87
1  395  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.6946148, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6377586, 'auroc': 0.7859167, 'binary_precision': 0.7815126, 'binary_recall': 0.43255815, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.5568862}
confusion matrix:
     0   1
0  189  26
1  122  93
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 14:32:57.857556,epoch time: 0:01:03.734983,used: 0:03:20.472487,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.88216144, 'precision': 0.8916609, 'recall': 0.8830838, 'specificity': 0.8830838, 'f1': 0.8816082, 'auroc': 0.947029, 'binary_precision': 0.9556575, 'binary_recall': 0.8043758, 'binary_specificity': 0.9617918, 'binary_f1_score': 0.87351495}
confusion matrix:
      0     1
0  1460    58
1   304  1250
---- Validation: 
scalar performance:
{'acc': 0.6614907, 'precision': 0.68246007, 'recall': 0.6590153, 'specificity': 0.6590153, 'f1': 0.6493145, 'auroc': 0.7739253, 'binary_precision': 0.7409201, 'binary_recall': 0.48188975, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.5839694}
confusion matrix:
     0    1
0  546  107
1  329  306
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67906976, 'precision': 0.7016885, 'recall': 0.67906976, 'specificity': 0.67906976, 'f1': 0.6698123, 'auroc': 0.80975664, 'binary_precision': 0.7692308, 'binary_recall': 0.5116279, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.6145251}
confusion matrix:
     0    1
0  182   33
1  105  110
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 14:34:01.476712,epoch time: 0:01:03.619156,used: 0:04:24.091643,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9059245, 'precision': 0.9125562, 'recall': 0.9067691, 'specificity': 0.9067691, 'f1': 0.90565884, 'auroc': 0.95654917, 'binary_precision': 0.96821874, 'binary_recall': 0.8419023, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9006531}
confusion matrix:
      0     1
0  1473    43
1   246  1310
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.69450325, 'recall': 0.67482847, 'specificity': 0.67482847, 'f1': 0.6678494, 'auroc': 0.786531, 'binary_precision': 0.74943054, 'binary_recall': 0.5181102, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.6126629}
confusion matrix:
     0    1
0  543  110
1  306  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7313775, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.7084649, 'auroc': 0.82875067, 'binary_precision': 0.7948718, 'binary_recall': 0.5767442, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.66846365}
confusion matrix:
     0    1
0  183   32
1   91  124
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 14:35:05.518425,epoch time: 0:01:04.041713,used: 0:05:28.133356,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9085286, 'precision': 0.9140054, 'recall': 0.9092974, 'specificity': 0.9092974, 'f1': 0.9083245, 'auroc': 0.96265924, 'binary_precision': 0.96498907, 'binary_recall': 0.8502571, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9039973}
confusion matrix:
      0     1
0  1468    48
1   233  1323
---- Validation: 
scalar performance:
{'acc': 0.7127329, 'precision': 0.7201673, 'recall': 0.7113745, 'specificity': 0.7113745, 'f1': 0.7093969, 'auroc': 0.79760283, 'binary_precision': 0.75728154, 'binary_recall': 0.61417323, 'binary_specificity': 0.8085758, 'binary_f1_score': 0.67826086}
confusion matrix:
     0    1
0  528  125
1  245  390
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76398754, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.7567926, 'auroc': 0.8408654, 'binary_precision': 0.8032787, 'binary_recall': 0.68372095, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.7386935}
confusion matrix:
     0    1
0  179   36
1   68  147
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 14:36:09.554987,epoch time: 0:01:04.036562,used: 0:06:32.169918,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9222005, 'precision': 0.9242625, 'recall': 0.92262864, 'specificity': 0.92262864, 'f1': 0.92214906, 'auroc': 0.9708042, 'binary_precision': 0.95691454, 'binary_recall': 0.8861004, 'binary_specificity': 0.9591568, 'binary_f1_score': 0.92014706}
confusion matrix:
      0     1
0  1456    62
1   177  1377
---- Validation: 
scalar performance:
{'acc': 0.7546584, 'precision': 0.75464815, 'recall': 0.7546973, 'specificity': 0.7546973, 'f1': 0.7546436, 'auroc': 0.82001424, 'binary_precision': 0.748056, 'binary_recall': 0.7574803, 'binary_specificity': 0.75191426, 'binary_f1_score': 0.75273865}
confusion matrix:
     0    1
0  491  162
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.79072285, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.79069316, 'auroc': 0.86159, 'binary_precision': 0.7880184, 'binary_recall': 0.7953488, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.7916666}
confusion matrix:
     0    1
0  169   46
1   44  171
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 14:37:13.482056,epoch time: 0:01:03.927069,used: 0:07:36.096987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9166667, 'precision': 0.9210643, 'recall': 0.91739, 'specificity': 0.91739, 'f1': 0.9165307, 'auroc': 0.97057307, 'binary_precision': 0.96764916, 'binary_recall': 0.864483, 'binary_specificity': 0.97029704, 'binary_f1_score': 0.9131615}
confusion matrix:
      0     1
0  1470    45
1   211  1346
---- Validation: 
scalar performance:
{'acc': 0.76552796, 'precision': 0.7654897, 'recall': 0.7655256, 'specificity': 0.7655256, 'f1': 0.7655002, 'auroc': 0.8269308, 'binary_precision': 0.7605634, 'binary_recall': 0.76535434, 'binary_specificity': 0.76569676, 'binary_f1_score': 0.76295125}
confusion matrix:
     0    1
0  500  153
1  149  486
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.80248916, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80229884, 'auroc': 0.87037313, 'binary_precision': 0.79545456, 'binary_recall': 0.81395346, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.8045977}
confusion matrix:
     0    1
0  170   45
1   40  175
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 14:38:17.556629,epoch time: 0:01:04.074573,used: 0:08:40.171560,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9186198, 'precision': 0.9238411, 'recall': 0.91944253, 'specificity': 0.91944253, 'f1': 0.91846, 'auroc': 0.9721839, 'binary_precision': 0.97460085, 'binary_recall': 0.86200255, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.9148501}
confusion matrix:
      0     1
0  1479    35
1   215  1343
---- Validation: 
scalar performance:
{'acc': 0.77717394, 'precision': 0.77719516, 'recall': 0.77703273, 'specificity': 0.77703273, 'f1': 0.777076, 'auroc': 0.83562, 'binary_precision': 0.7779553, 'binary_recall': 0.76692915, 'binary_specificity': 0.7871363, 'binary_f1_score': 0.7724029}
confusion matrix:
     0    1
0  514  139
1  148  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8162859, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.8162781, 'auroc': 0.88019466, 'binary_precision': 0.817757, 'binary_recall': 0.81395346, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8158508}
confusion matrix:
     0    1
0  176   39
1   40  175
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 14:39:21.856489,epoch time: 0:01:04.299860,used: 0:09:44.471420,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9186198, 'precision': 0.9250829, 'recall': 0.9194454, 'specificity': 0.9194454, 'f1': 0.918404, 'auroc': 0.9717677, 'binary_precision': 0.9808542, 'binary_recall': 0.85604113, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9142073}
confusion matrix:
      0     1
0  1490    26
1   224  1332
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.7732219, 'recall': 0.77211297, 'specificity': 0.77211297, 'f1': 0.7721584, 'auroc': 0.83726954, 'binary_precision': 0.78405315, 'binary_recall': 0.7433071, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.7631367}
confusion matrix:
     0    1
0  523  130
1  163  472
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81860465, 'precision': 0.81863225, 'recall': 0.81860465, 'specificity': 0.81860465, 'f1': 0.81860065, 'auroc': 0.8846512, 'binary_precision': 0.82159626, 'binary_recall': 0.81395346, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.81775695}
confusion matrix:
     0    1
0  177   38
1   40  175
new oracle model saved
early stop counter: 1
val acc:0.7725155353546143, best validation acc: 0.7771739363670349, corresponding to test acc:                         0.8162790536880493 / 0.8186046481132507
after epoch: 10,now: 2024-07-20 14:40:26.065804,epoch time: 0:01:04.209315,used: 0:10:48.680735,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9238281, 'precision': 0.9298136, 'recall': 0.9246206, 'specificity': 0.9246206, 'f1': 0.9236461, 'auroc': 0.9739417, 'binary_precision': 0.9838946, 'binary_recall': 0.8637532, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9199178}
confusion matrix:
      0     1
0  1494    22
1   212  1344
---- Validation: 
scalar performance:
{'acc': 0.76785713, 'precision': 0.7704565, 'recall': 0.7671281, 'specificity': 0.7671281, 'f1': 0.76693535, 'auroc': 0.8429321, 'binary_precision': 0.7937063, 'binary_recall': 0.71496063, 'binary_specificity': 0.8192956, 'binary_f1_score': 0.7522783}
confusion matrix:
     0    1
0  535  118
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.830583, 'recall': 0.8302325, 'specificity': 0.8302325, 'f1': 0.8301875, 'auroc': 0.89010274, 'binary_precision': 0.84134614, 'binary_recall': 0.81395346, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.8274231}
confusion matrix:
     0    1
0  182   33
1   40  175
new oracle model saved
early stop counter: 2
val acc:0.7678571343421936, best validation acc: 0.7771739363670349, corresponding to test acc:                         0.8162790536880493 / 0.830232560634613
after epoch: 11,now: 2024-07-20 14:41:29.913160,epoch time: 0:01:03.847356,used: 0:11:52.528091,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9296875, 'precision': 0.93308246, 'recall': 0.9302272, 'specificity': 0.9302272, 'f1': 0.9296005, 'auroc': 0.97927743, 'binary_precision': 0.9744681, 'binary_recall': 0.8841699, 'binary_specificity': 0.97628456, 'binary_f1_score': 0.92712545}
confusion matrix:
      0     1
0  1482    36
1   180  1374
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.7911169, 'recall': 0.79116255, 'specificity': 0.79116255, 'f1': 0.7911278, 'auroc': 0.85074097, 'binary_precision': 0.7859375, 'binary_recall': 0.792126, 'binary_specificity': 0.7901991, 'binary_f1_score': 0.7890196}
confusion matrix:
     0    1
0  516  137
1  132  503
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8235078, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.82322145, 'auroc': 0.8968091, 'binary_precision': 0.81447965, 'binary_recall': 0.8372093, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.8256881}
confusion matrix:
     0    1
0  174   41
1   35  180
better model found
persisted
after epoch: 12,now: 2024-07-20 14:42:33.743972,epoch time: 0:01:03.830812,used: 0:12:56.358903,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9420573, 'precision': 0.9435146, 'recall': 0.9424827, 'specificity': 0.9424827, 'f1': 0.94203806, 'auroc': 0.98384094, 'binary_precision': 0.97258395, 'binary_recall': 0.911368, 'binary_specificity': 0.97359735, 'binary_f1_score': 0.9409815}
confusion matrix:
      0     1
0  1475    40
1   138  1419
---- Validation: 
scalar performance:
{'acc': 0.79891306, 'precision': 0.79888666, 'recall': 0.79884124, 'specificity': 0.79884124, 'f1': 0.7988596, 'auroc': 0.8575635, 'binary_precision': 0.79746836, 'binary_recall': 0.7937008, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.7955802}
confusion matrix:
     0    1
0  525  128
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82790697, 'precision': 0.8280205, 'recall': 0.82790697, 'specificity': 0.82790697, 'f1': 0.82789207, 'auroc': 0.9006165, 'binary_precision': 0.82191783, 'binary_recall': 0.8372093, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.8294931}
confusion matrix:
     0    1
0  176   39
1   35  180
better model found
persisted
after epoch: 13,now: 2024-07-20 14:43:37.450751,epoch time: 0:01:03.706779,used: 0:14:00.065682,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9352214, 'precision': 0.93710387, 'recall': 0.9357257, 'specificity': 0.9357257, 'f1': 0.93519056, 'auroc': 0.98260987, 'binary_precision': 0.9695923, 'binary_recall': 0.90051347, 'binary_specificity': 0.9709379, 'binary_f1_score': 0.93377703}
confusion matrix:
      0     1
0  1470    44
1   155  1403
---- Validation: 
scalar performance:
{'acc': 0.80124223, 'precision': 0.80305994, 'recall': 0.8017677, 'specificity': 0.8017677, 'f1': 0.8011036, 'auroc': 0.8638338, 'binary_precision': 0.77583694, 'binary_recall': 0.8393701, 'binary_specificity': 0.7641654, 'binary_f1_score': 0.806354}
confusion matrix:
     0    1
0  499  154
1  102  533
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81627905, 'precision': 0.8174397, 'recall': 0.81627905, 'specificity': 0.81627905, 'f1': 0.81611097, 'auroc': 0.904251, 'binary_precision': 0.7982456, 'binary_recall': 0.8465116, 'binary_specificity': 0.7860465, 'binary_f1_score': 0.82167035}
confusion matrix:
     0    1
0  169   46
1   33  182
better model found
persisted
after epoch: 14,now: 2024-07-20 14:44:41.382683,epoch time: 0:01:03.931932,used: 0:15:03.997614,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9352214, 'precision': 0.9369197, 'recall': 0.9356555, 'specificity': 0.9356555, 'f1': 0.93519235, 'auroc': 0.9822247, 'binary_precision': 0.9676086, 'binary_recall': 0.90231365, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9338211}
confusion matrix:
      0     1
0  1469    47
1   152  1404
---- Validation: 
scalar performance:
{'acc': 0.8043478, 'precision': 0.80498636, 'recall': 0.80465686, 'specificity': 0.80465686, 'f1': 0.80432475, 'auroc': 0.86366737, 'binary_precision': 0.78710645, 'binary_recall': 0.8267717, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.8064516}
confusion matrix:
     0    1
0  511  142
1  110  525
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8217725, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82081294, 'auroc': 0.9054624, 'binary_precision': 0.8053097, 'binary_recall': 0.8465116, 'binary_specificity': 0.7953488, 'binary_f1_score': 0.82539684}
confusion matrix:
     0    1
0  171   44
1   33  182
better model found
persisted
after epoch: 15,now: 2024-07-20 14:45:45.167307,epoch time: 0:01:03.784624,used: 0:16:07.782238,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9352214, 'precision': 0.93853086, 'recall': 0.9358458, 'specificity': 0.9358458, 'f1': 0.9351513, 'auroc': 0.9798199, 'binary_precision': 0.980198, 'binary_recall': 0.89017344, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.9330192}
confusion matrix:
      0     1
0  1487    28
1   171  1386
---- Validation: 
scalar performance:
{'acc': 0.80279505, 'precision': 0.80290675, 'recall': 0.8029301, 'specificity': 0.8029301, 'f1': 0.8027946, 'auroc': 0.8670268, 'binary_precision': 0.79262674, 'binary_recall': 0.8125984, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.8024884}
confusion matrix:
     0    1
0  518  135
1  119  516
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82325584, 'precision': 0.8239566, 'recall': 0.8232558, 'specificity': 0.8232558, 'f1': 0.8231602, 'auroc': 0.9088805, 'binary_precision': 0.8088889, 'binary_recall': 0.8465116, 'binary_specificity': 0.8, 'binary_f1_score': 0.8272728}
confusion matrix:
     0    1
0  172   43
1   33  182
early stop counter: 1
val acc:0.8027950525283813, best validation acc: 0.804347813129425, corresponding to test acc:                         0.8209302425384521 / 0.830232560634613
after epoch: 16,now: 2024-07-20 14:46:48.771892,epoch time: 0:01:03.604585,used: 0:17:11.386823,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.93880206, 'precision': 0.94026804, 'recall': 0.9392072, 'specificity': 0.9392072, 'f1': 0.93878025, 'auroc': 0.98367244, 'binary_precision': 0.9691358, 'binary_recall': 0.9080977, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.9376244}
confusion matrix:
      0     1
0  1471    45
1   143  1413
---- Validation: 
scalar performance:
{'acc': 0.81055903, 'precision': 0.8110359, 'recall': 0.8108258, 'specificity': 0.8108258, 'f1': 0.8105476, 'auroc': 0.8689465, 'binary_precision': 0.7948718, 'binary_recall': 0.82992125, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.8120185}
confusion matrix:
     0    1
0  517  136
1  108  527
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.8261529, 'recall': 0.8255814, 'specificity': 0.8255814, 'f1': 0.82550496, 'auroc': 0.91045976, 'binary_precision': 0.8125, 'binary_recall': 0.8465116, 'binary_specificity': 0.80465114, 'binary_f1_score': 0.8291572}
confusion matrix:
     0    1
0  173   42
1   33  182
better model found
persisted
after epoch: 17,now: 2024-07-20 14:47:52.471249,epoch time: 0:01:03.699357,used: 0:18:15.086180,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9407552, 'precision': 0.9427141, 'recall': 0.9412427, 'specificity': 0.9412427, 'f1': 0.9407244, 'auroc': 0.98610854, 'binary_precision': 0.9757785, 'binary_recall': 0.9055877, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.9393737}
confusion matrix:
      0     1
0  1480    35
1   147  1410
---- Validation: 
scalar performance:
{'acc': 0.8128882, 'precision': 0.81332827, 'recall': 0.8131447, 'specificity': 0.8131447, 'f1': 0.8128791, 'auroc': 0.86904776, 'binary_precision': 0.7975831, 'binary_recall': 0.83149606, 'binary_specificity': 0.79479325, 'binary_f1_score': 0.81418663}
confusion matrix:
     0    1
0  519  134
1  107  528
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8308122, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8301581, 'auroc': 0.9113034, 'binary_precision': 0.81696427, 'binary_recall': 0.8511628, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.833713}
confusion matrix:
     0    1
0  174   41
1   32  183
better model found
persisted
after epoch: 18,now: 2024-07-20 14:48:56.140793,epoch time: 0:01:03.669544,used: 0:19:18.755724,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.9450096, 'recall': 0.9444074, 'specificity': 0.9444074, 'f1': 0.9440019, 'auroc': 0.98561406, 'binary_precision': 0.9701695, 'binary_recall': 0.9178961, 'binary_specificity': 0.9709187, 'binary_f1_score': 0.9433092}
confusion matrix:
      0     1
0  1469    44
1   128  1431
---- Validation: 
scalar performance:
{'acc': 0.79037267, 'precision': 0.790852, 'recall': 0.79004955, 'specificity': 0.79004955, 'f1': 0.79012775, 'auroc': 0.86780334, 'binary_precision': 0.7996716, 'binary_recall': 0.76692915, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.78295815}
confusion matrix:
     0    1
0  531  122
1  148  487
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83023256, 'precision': 0.8302969, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8302243, 'auroc': 0.91121686, 'binary_precision': 0.82568806, 'binary_recall': 0.8372093, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.83140874}
confusion matrix:
     0    1
0  177   38
1   35  180
early stop counter: 1
val acc:0.7903726696968079, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.830232560634613 / 0.830232560634613
after epoch: 19,now: 2024-07-20 14:50:00.026996,epoch time: 0:01:03.886203,used: 0:20:22.641927,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9407552, 'precision': 0.9417377, 'recall': 0.9410928, 'specificity': 0.9410928, 'f1': 0.94074416, 'auroc': 0.98704624, 'binary_precision': 0.9660787, 'binary_recall': 0.9151671, 'binary_specificity': 0.9670185, 'binary_f1_score': 0.93993396}
confusion matrix:
      0     1
0  1466    50
1   132  1424
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.7872567, 'recall': 0.78609085, 'specificity': 0.78609085, 'f1': 0.78615534, 'auroc': 0.863706, 'binary_precision': 0.7990033, 'binary_recall': 0.7574803, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.7776879}
confusion matrix:
     0    1
0  532  121
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83255816, 'precision': 0.8328173, 'recall': 0.83255816, 'specificity': 0.83255816, 'f1': 0.8325255, 'auroc': 0.91245, 'binary_precision': 0.8235294, 'binary_recall': 0.8465116, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.83486235}
confusion matrix:
     0    1
0  176   39
1   33  182
new oracle model saved
early stop counter: 2
val acc:0.7864906787872314, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.830232560634613 / 0.8325581550598145
after epoch: 20,now: 2024-07-20 14:51:03.742672,epoch time: 0:01:03.715676,used: 0:21:26.357603,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9479167, 'precision': 0.9489674, 'recall': 0.94826394, 'specificity': 0.94826394, 'f1': 0.94790596, 'auroc': 0.9856441, 'binary_precision': 0.9741848, 'binary_recall': 0.92159384, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.9471598}
confusion matrix:
      0     1
0  1478    38
1   122  1434
---- Validation: 
scalar performance:
{'acc': 0.7911491, 'precision': 0.79249185, 'recall': 0.7906416, 'specificity': 0.7906416, 'f1': 0.7906795, 'auroc': 0.86727524, 'binary_precision': 0.8091216, 'binary_recall': 0.7543307, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.78076607}
confusion matrix:
     0    1
0  540  113
1  156  479
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.84419346, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84418523, 'auroc': 0.9138994, 'binary_precision': 0.8457944, 'binary_recall': 0.8418605, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.84382284}
confusion matrix:
     0    1
0  182   33
1   34  181
new oracle model saved
early stop counter: 3
val acc:0.7911490797996521, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.830232560634613 / 0.8441860675811768
after epoch: 21,now: 2024-07-20 14:52:07.645891,epoch time: 0:01:03.903219,used: 0:22:30.260822,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.9453201, 'recall': 0.94497657, 'specificity': 0.94497657, 'f1': 0.94465744, 'auroc': 0.98657036, 'binary_precision': 0.9663978, 'binary_recall': 0.92297816, 'binary_specificity': 0.9669749, 'binary_f1_score': 0.9441891}
confusion matrix:
      0     1
0  1464    50
1   120  1438
---- Validation: 
scalar performance:
{'acc': 0.80279505, 'precision': 0.8027549, 'recall': 0.80277824, 'specificity': 0.80277824, 'f1': 0.80276465, 'auroc': 0.8737457, 'binary_precision': 0.7990581, 'binary_recall': 0.8015748, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.8003145}
confusion matrix:
     0    1
0  525  128
1  126  509
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.83732605, 'recall': 0.8372093, 'specificity': 0.8372093, 'f1': 0.8371953, 'auroc': 0.9156301, 'binary_precision': 0.8310502, 'binary_recall': 0.8465116, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8387097}
confusion matrix:
     0    1
0  178   37
1   33  182
early stop counter: 4
val acc:0.8027950525283813, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.830232560634613 / 0.8441860675811768
after epoch: 22,now: 2024-07-20 14:53:11.080419,epoch time: 0:01:03.434528,used: 0:23:33.695350,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.9437108, 'recall': 0.941905, 'specificity': 0.941905, 'f1': 0.94136643, 'auroc': 0.98889697, 'binary_precision': 0.97910863, 'binary_recall': 0.90359896, 'binary_specificity': 0.9802111, 'binary_f1_score': 0.93983954}
confusion matrix:
      0     1
0  1486    30
1   150  1406
---- Validation: 
scalar performance:
{'acc': 0.79813665, 'precision': 0.7998673, 'recall': 0.7975763, 'specificity': 0.7975763, 'f1': 0.7976052, 'auroc': 0.8691418, 'binary_precision': 0.81942075, 'binary_recall': 0.7574803, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.78723407}
confusion matrix:
     0    1
0  547  106
1  154  481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.83954227, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.83953404, 'auroc': 0.9163439, 'binary_precision': 0.837963, 'binary_recall': 0.8418605, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8399072}
confusion matrix:
     0    1
0  180   35
1   34  181
early stop counter: 5
val acc:0.7981366515159607, best validation acc: 0.8128882050514221, corresponding to test acc:                         0.830232560634613 / 0.8441860675811768
after epoch: 23,now: 2024-07-20 14:54:14.748646,epoch time: 0:01:03.668227,used: 0:24:37.363577,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_29_37_seed_0_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 23 with time: 0:24:37.363577 at 2024-07-20 14:54:14.748646
persisted model performance metric: 

scalar performance:
{'acc': 0.83023256, 'precision': 0.8308122, 'recall': 0.83023256, 'specificity': 0.83023256, 'f1': 0.8301581, 'auroc': 0.9113034, 'binary_precision': 0.81696427, 'binary_recall': 0.8511628, 'binary_specificity': 0.80930233, 'binary_f1_score': 0.833713}
confusion matrix:
     0    1
0  174   41
1   32  183
oracle model performance metric: 

scalar performance:
{'acc': 0.84418607, 'precision': 0.84419346, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84418523, 'auroc': 0.9138994, 'binary_precision': 0.8457944, 'binary_recall': 0.8418605, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.84382284}
confusion matrix:
     0    1
0  182   33
1   34  181
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196513 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool | 180117 KiB |   1178 MiB |  41560 GiB |  41559 GiB |
|       from small pool |  16396 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196513 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool | 180117 KiB |   1178 MiB |  41560 GiB |  41559 GiB |
|       from small pool |  16396 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   1193 MiB |  42140 GiB |  42140 GiB |
|       from large pool | 178979 KiB |   1176 MiB |  41558 GiB |  41557 GiB |
|       from small pool |  16209 KiB |     32 MiB |    582 GiB |    582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1348 MiB |   1348 MiB |   1348 MiB |      0 B   |
|       from large pool |   1310 MiB |   1310 MiB |   1310 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  47199 KiB | 147638 KiB |  23425 GiB |  23425 GiB |
|       from large pool |  45163 KiB | 146066 KiB |  22822 GiB |  22822 GiB |
|       from small pool |   2036 KiB |   7624 KiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |    7359 K  |    7358 K  |
|       from large pool |      79    |     167    |    3893 K  |    3893 K  |
|       from small pool |     709    |    1005    |    3466 K  |    3465 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |    7359 K  |    7358 K  |
|       from large pool |      79    |     167    |    3893 K  |    3893 K  |
|       from small pool |     709    |    1005    |    3466 K  |    3465 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      74    |      74    |       0    |
|       from large pool |      55    |      55    |      55    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     219    |    5045 K  |    5045 K  |
|       from large pool |      11    |      57    |    2959 K  |    2959 K  |
|       from small pool |      22    |     208    |    2085 K  |    2085 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  42140 GiB |  42140 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  41558 GiB |  41558 GiB |
|       from small pool |      0 KiB |     32 MiB |    582 GiB |    582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   1348 MiB |   1348 MiB |   1110 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  23425 GiB |  23425 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  22822 GiB |  22822 GiB |
|       from small pool |      0 KiB |   9146 KiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |    7359 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |    7359 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      74    |      74    |      54    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |    5045 K  |    5045 K  |
|       from large pool |       4    |      57    |    2959 K  |    2959 K  |
|       from small pool |       0    |     208    |    2085 K  |    2085 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  42143 GiB |  42143 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  41560 GiB |  41560 GiB |
|       from small pool |      0 KiB |     32 MiB |    583 GiB |    583 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  42140 GiB |  42140 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  41558 GiB |  41558 GiB |
|       from small pool |      0 KiB |     32 MiB |    582 GiB |    582 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 243712 KiB |   1348 MiB |   1348 MiB |   1110 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   1310 MiB |   1090 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  23425 GiB |  23425 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  22822 GiB |  22822 GiB |
|       from small pool |      0 KiB |   9146 KiB |    603 GiB |    603 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |    7359 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |    7359 K  |    7359 K  |
|       from large pool |       2    |     167    |    3893 K  |    3893 K  |
|       from small pool |       0    |    1005    |    3466 K  |    3466 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |      74    |      74    |      54    |
|       from large pool |      11    |      55    |      55    |      44    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |    5045 K  |    5045 K  |
|       from large pool |       4    |      57    |    2959 K  |    2959 K  |
|       from small pool |       0    |     208    |    2085 K  |    2085 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810

 Experiment start at: 2024-07-20 14:55:12.925472
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7470703, 'precision': 0.74749553, 'recall': 0.7467434, 'specificity': 0.7467434, 'f1': 0.7467631, 'auroc': 0.814788, 'binary_precision': 0.7399877, 'binary_recall': 0.7718509, 'binary_specificity': 0.7216359, 'binary_f1_score': 0.7555835}
confusion matrix:
      0     1
0  1094   422
1   355  1201
---- Validation: 
scalar performance:
{'acc': 0.50117093, 'precision': 0.48870343, 'recall': 0.49503326, 'specificity': 0.49503326, 'f1': 0.41567436, 'auroc': 0.6797479, 'binary_precision': 0.47204968, 'binary_recall': 0.12063492, 'binary_specificity': 0.8694316, 'binary_f1_score': 0.19216181}
confusion matrix:
     0   1
0  566  85
1  554  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.56375486, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.46228033, 'auroc': 0.7275456, 'binary_precision': 0.609375, 'binary_recall': 0.17333333, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.26989618}
confusion matrix:
     0   1
0  200  25
1  186  39
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:56:23.476735,epoch time: 0:01:10.551263,used: 0:01:10.551263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8417969, 'precision': 0.84341884, 'recall': 0.84224486, 'specificity': 0.84224486, 'f1': 0.84171, 'auroc': 0.9135566, 'binary_precision': 0.8704986, 'binary_recall': 0.80784065, 'binary_specificity': 0.8766491, 'binary_f1_score': 0.838}
confusion matrix:
      0     1
0  1329   187
1   299  1257
---- Validation: 
scalar performance:
{'acc': 0.5300546, 'precision': 0.5546777, 'recall': 0.52391195, 'specificity': 0.52391195, 'f1': 0.4491228, 'auroc': 0.736269, 'binary_precision': 0.5875, 'binary_recall': 0.14920636, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.2379747}
confusion matrix:
     0   1
0  585  66
1  536  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.6015874, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.46390152, 'auroc': 0.7761185, 'binary_precision': 0.6792453, 'binary_recall': 0.16, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.2589928}
confusion matrix:
     0   1
0  208  17
1  189  36
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 14:57:27.551399,epoch time: 0:01:04.074664,used: 0:02:14.625927,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8704427, 'precision': 0.87438214, 'recall': 0.8710506, 'specificity': 0.8710506, 'f1': 0.8702174, 'auroc': 0.92840147, 'binary_precision': 0.91582733, 'binary_recall': 0.8191763, 'binary_specificity': 0.9229249, 'binary_f1_score': 0.86480975}
confusion matrix:
      0     1
0  1401   117
1   281  1273
---- Validation: 
scalar performance:
{'acc': 0.53786105, 'precision': 0.567922, 'recall': 0.53189963, 'specificity': 0.53189963, 'f1': 0.46346763, 'auroc': 0.76008344, 'binary_precision': 0.6091954, 'binary_recall': 0.16825397, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.2636816}
confusion matrix:
     0    1
0  583   68
1  524  106
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.6052189, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.4675601, 'auroc': 0.80604446, 'binary_precision': 0.6851852, 'binary_recall': 0.16444445, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.26523298}
confusion matrix:
     0   1
0  208  17
1  188  37
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 14:58:31.713928,epoch time: 0:01:04.162529,used: 0:03:18.788456,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8889974, 'precision': 0.89403284, 'recall': 0.88970935, 'specificity': 0.88970935, 'f1': 0.88875633, 'auroc': 0.9355247, 'binary_precision': 0.94177586, 'binary_recall': 0.83215433, 'binary_specificity': 0.9472643, 'binary_f1_score': 0.883578}
confusion matrix:
      0     1
0  1437    80
1   261  1294
---- Validation: 
scalar performance:
{'acc': 0.5565964, 'precision': 0.6005982, 'recall': 0.55084485, 'specificity': 0.55084485, 'f1': 0.49062753, 'auroc': 0.7789262, 'binary_precision': 0.6631579, 'binary_recall': 0.2, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.3073171}
confusion matrix:
     0    1
0  587   64
1  504  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.62159127, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.49099362, 'auroc': 0.81929874, 'binary_precision': 0.7096774, 'binary_recall': 0.19555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.30662018}
confusion matrix:
     0   1
0  207  18
1  181  44
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 14:59:35.907787,epoch time: 0:01:04.193859,used: 0:04:22.982315,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.89908856, 'precision': 0.90153146, 'recall': 0.89961404, 'specificity': 0.89961404, 'f1': 0.89900565, 'auroc': 0.9539887, 'binary_precision': 0.9362745, 'binary_recall': 0.8592545, 'binary_specificity': 0.9399736, 'binary_f1_score': 0.8961126}
confusion matrix:
      0     1
0  1425    91
1   219  1337
---- Validation: 
scalar performance:
{'acc': 0.5925059, 'precision': 0.6443658, 'recall': 0.5873784, 'specificity': 0.5873784, 'f1': 0.5452356, 'auroc': 0.7898569, 'binary_precision': 0.72689074, 'binary_recall': 0.2746032, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.3986175}
confusion matrix:
     0    1
0  586   65
1  457  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.6674266, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.563383, 'auroc': 0.8315654, 'binary_precision': 0.77011496, 'binary_recall': 0.29777777, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.42948717}
confusion matrix:
     0   1
0  205  20
1  158  67
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 15:00:40.806100,epoch time: 0:01:04.898313,used: 0:05:27.880628,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9078776, 'precision': 0.91332984, 'recall': 0.9084882, 'specificity': 0.9084882, 'f1': 0.9076545, 'auroc': 0.960731, 'binary_precision': 0.963477, 'binary_recall': 0.84987116, 'binary_specificity': 0.96710527, 'binary_f1_score': 0.9031154}
confusion matrix:
      0     1
0  1470    50
1   233  1319
---- Validation: 
scalar performance:
{'acc': 0.64480877, 'precision': 0.6962192, 'recall': 0.6404762, 'specificity': 0.6404762, 'f1': 0.61579883, 'auroc': 0.8073684, 'binary_precision': 0.7926421, 'binary_recall': 0.37619048, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.5102261}
confusion matrix:
     0    1
0  589   62
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.7038418, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.6304407, 'auroc': 0.8479012, 'binary_precision': 0.8053097, 'binary_recall': 0.40444446, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.5384615}
confusion matrix:
     0   1
0  203  22
1  134  91
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 15:01:44.822894,epoch time: 0:01:04.016794,used: 0:06:31.897422,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9121094, 'precision': 0.91561496, 'recall': 0.9127606, 'specificity': 0.9127606, 'f1': 0.9120006, 'auroc': 0.95966685, 'binary_precision': 0.9573561, 'binary_recall': 0.86512524, 'binary_specificity': 0.96039605, 'binary_f1_score': 0.9089069}
confusion matrix:
      0     1
0  1455    60
1   210  1347
---- Validation: 
scalar performance:
{'acc': 0.67993754, 'precision': 0.72339803, 'recall': 0.67621607, 'specificity': 0.67621607, 'f1': 0.66070306, 'auroc': 0.81730914, 'binary_precision': 0.8179191, 'binary_recall': 0.44920635, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.5799181}
confusion matrix:
     0    1
0  588   63
1  347  283
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69777775, 'precision': 0.73959655, 'recall': 0.6977778, 'specificity': 0.6977778, 'f1': 0.68398875, 'auroc': 0.85726416, 'binary_precision': 0.8396947, 'binary_recall': 0.4888889, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.6179775}
confusion matrix:
     0    1
0  204   21
1  115  110
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 15:02:48.757531,epoch time: 0:01:03.934637,used: 0:07:35.832059,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9124349, 'precision': 0.91525, 'recall': 0.91299236, 'specificity': 0.91299236, 'f1': 0.91235113, 'auroc': 0.96778107, 'binary_precision': 0.9528501, 'binary_recall': 0.87017995, 'binary_specificity': 0.95580477, 'binary_f1_score': 0.9096406}
confusion matrix:
      0     1
0  1449    67
1   202  1354
---- Validation: 
scalar performance:
{'acc': 0.6955503, 'precision': 0.73236823, 'recall': 0.6921915, 'specificity': 0.6921915, 'f1': 0.6806164, 'auroc': 0.8250725, 'binary_precision': 0.8208556, 'binary_recall': 0.4873016, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.6115538}
confusion matrix:
     0    1
0  584   67
1  323  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7311111, 'precision': 0.7636085, 'recall': 0.73111117, 'specificity': 0.73111117, 'f1': 0.7225605, 'auroc': 0.8650074, 'binary_precision': 0.8561644, 'binary_recall': 0.5555556, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.6738545}
confusion matrix:
     0    1
0  204   21
1  100  125
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 15:03:52.661813,epoch time: 0:01:03.904282,used: 0:08:39.736341,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9160156, 'precision': 0.9196745, 'recall': 0.91664577, 'specificity': 0.91664577, 'f1': 0.91590387, 'auroc': 0.9682826, 'binary_precision': 0.9622507, 'binary_recall': 0.8682519, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.91283786}
confusion matrix:
      0     1
0  1463    53
1   205  1351
---- Validation: 
scalar performance:
{'acc': 0.6971116, 'precision': 0.73286575, 'recall': 0.6938044, 'specificity': 0.6938044, 'f1': 0.6827005, 'auroc': 0.83021, 'binary_precision': 0.8201058, 'binary_recall': 0.4920635, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.61507934}
confusion matrix:
     0    1
0  583   68
1  320  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.77, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.73257136, 'auroc': 0.86921483, 'binary_precision': 0.86, 'binary_recall': 0.5733333, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.68799996}
confusion matrix:
     0    1
0  204   21
1   96  129
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 15:04:56.726227,epoch time: 0:01:04.064414,used: 0:09:43.800755,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.91764325, 'precision': 0.91941154, 'recall': 0.918113, 'specificity': 0.918113, 'f1': 0.9176041, 'auroc': 0.96962845, 'binary_precision': 0.95027626, 'binary_recall': 0.8837508, 'binary_specificity': 0.95247525, 'binary_f1_score': 0.915807}
confusion matrix:
      0     1
0  1443    72
1   181  1376
---- Validation: 
scalar performance:
{'acc': 0.72287273, 'precision': 0.749928, 'recall': 0.7200973, 'specificity': 0.7200973, 'f1': 0.71347463, 'auroc': 0.83749545, 'binary_precision': 0.8281623, 'binary_recall': 0.55079365, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.66158247}
confusion matrix:
     0    1
0  579   72
1  283  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76, 'precision': 0.7844777, 'recall': 0.76, 'specificity': 0.76, 'f1': 0.75472385, 'auroc': 0.87622714, 'binary_precision': 0.8679245, 'binary_recall': 0.61333334, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.71875}
confusion matrix:
     0    1
0  204   21
1   87  138
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 15:06:00.796783,epoch time: 0:01:04.070556,used: 0:10:47.871311,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.92317706, 'precision': 0.92636144, 'recall': 0.9237948, 'specificity': 0.9237948, 'f1': 0.9230956, 'auroc': 0.9755924, 'binary_precision': 0.9667845, 'binary_recall': 0.8786127, 'binary_specificity': 0.9689769, 'binary_f1_score': 0.9205922}
confusion matrix:
      0     1
0  1468    47
1   189  1368
---- Validation: 
scalar performance:
{'acc': 0.7291179, 'precision': 0.7558358, 'recall': 0.72639525, 'specificity': 0.72639525, 'f1': 0.72025585, 'auroc': 0.84295714, 'binary_precision': 0.8345154, 'binary_recall': 0.56031746, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.67046535}
confusion matrix:
     0    1
0  581   70
1  277  353
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.792619, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.7668265, 'auroc': 0.8807901, 'binary_precision': 0.8719512, 'binary_recall': 0.63555557, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.7352185}
confusion matrix:
     0    1
0  204   21
1   82  143
new oracle model saved
better model found
persisted
after epoch: 11,now: 2024-07-20 15:07:04.648416,epoch time: 0:01:03.851633,used: 0:11:51.722944,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9241536, 'precision': 0.92731833, 'recall': 0.9247385, 'specificity': 0.9247385, 'f1': 0.92407155, 'auroc': 0.9778061, 'binary_precision': 0.96749115, 'binary_recall': 0.87982005, 'binary_specificity': 0.969657, 'binary_f1_score': 0.9215752}
confusion matrix:
      0     1
0  1470    46
1   187  1369
---- Validation: 
scalar performance:
{'acc': 0.7275566, 'precision': 0.75964403, 'recall': 0.7246032, 'specificity': 0.7246032, 'f1': 0.7171246, 'auroc': 0.8484627, 'binary_precision': 0.8469136, 'binary_recall': 0.54444444, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.6628019}
confusion matrix:
     0    1
0  589   62
1  287  343
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.79749, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76592207, 'auroc': 0.8887309, 'binary_precision': 0.886076, 'binary_recall': 0.62222224, 'binary_specificity': 0.92, 'binary_f1_score': 0.7310705}
confusion matrix:
     0    1
0  207   18
1   85  140
early stop counter: 1
val acc:0.727556586265564, best validation acc: 0.7291178703308105, corresponding to test acc:                         0.7711111307144165 / 0.7711111307144165
after epoch: 12,now: 2024-07-20 15:08:07.937633,epoch time: 0:01:03.289217,used: 0:12:55.012161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.93652344, 'precision': 0.94017494, 'recall': 0.9371443, 'specificity': 0.9371443, 'f1': 0.9364434, 'auroc': 0.9809474, 'binary_precision': 0.9836532, 'binary_recall': 0.88946015, 'binary_specificity': 0.9848285, 'binary_f1_score': 0.9341883}
confusion matrix:
      0     1
0  1493    23
1   172  1384
---- Validation: 
scalar performance:
{'acc': 0.7314598, 'precision': 0.75877935, 'recall': 0.7287251, 'specificity': 0.7287251, 'f1': 0.7225946, 'auroc': 0.84916246, 'binary_precision': 0.83886254, 'binary_recall': 0.5619048, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.6730038}
confusion matrix:
     0    1
0  583   68
1  276  354
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7822222, 'precision': 0.80382776, 'recall': 0.7822222, 'specificity': 0.7822222, 'f1': 0.7782805, 'auroc': 0.8904296, 'binary_precision': 0.8848485, 'binary_recall': 0.6488889, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.7487179}
confusion matrix:
     0    1
0  206   19
1   79  146
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 15:09:11.701285,epoch time: 0:01:03.763652,used: 0:13:58.775813,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.933598, 'recall': 0.9318409, 'specificity': 0.9318409, 'f1': 0.93126965, 'auroc': 0.9798534, 'binary_precision': 0.968663, 'binary_recall': 0.8933847, 'binary_specificity': 0.97029704, 'binary_f1_score': 0.9295022}
confusion matrix:
      0     1
0  1470    45
1   166  1391
---- Validation: 
scalar performance:
{'acc': 0.75800157, 'precision': 0.77627504, 'recall': 0.7558372, 'specificity': 0.7558372, 'f1': 0.7528468, 'auroc': 0.8571599, 'binary_precision': 0.84334767, 'binary_recall': 0.6238095, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.7171533}
confusion matrix:
     0    1
0  578   73
1  237  393
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.829912, 'recall': 0.82000005, 'specificity': 0.82000005, 'f1': 0.8186377, 'auroc': 0.8990222, 'binary_precision': 0.88709676, 'binary_recall': 0.73333335, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.80291975}
confusion matrix:
     0    1
0  204   21
1   60  165
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 15:10:16.019612,epoch time: 0:01:04.318327,used: 0:15:03.094140,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9358724, 'precision': 0.9370468, 'recall': 0.9362388, 'specificity': 0.9362388, 'f1': 0.9358561, 'auroc': 0.9828594, 'binary_precision': 0.9631902, 'binary_recall': 0.9080977, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.934833}
confusion matrix:
      0     1
0  1462    54
1   143  1413
---- Validation: 
scalar performance:
{'acc': 0.774395, 'precision': 0.78696287, 'recall': 0.7726319, 'specificity': 0.7726319, 'f1': 0.77108663, 'auroc': 0.8607515, 'binary_precision': 0.84305835, 'binary_recall': 0.66507936, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.743567}
confusion matrix:
     0    1
0  573   78
1  211  419
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8244445, 'precision': 0.82850003, 'recall': 0.8244444, 'specificity': 0.8244444, 'f1': 0.82390094, 'auroc': 0.90328884, 'binary_precision': 0.865, 'binary_recall': 0.7688889, 'binary_specificity': 0.88, 'binary_f1_score': 0.8141176}
confusion matrix:
     0    1
0  198   27
1   52  173
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 15:11:20.077753,epoch time: 0:01:04.058141,used: 0:16:07.152281,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.94422054, 'recall': 0.94418746, 'specificity': 0.94418746, 'f1': 0.94401026, 'auroc': 0.98626983, 'binary_precision': 0.95767194, 'binary_recall': 0.9305913, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9439374}
confusion matrix:
      0     1
0  1452    64
1   108  1448
---- Validation: 
scalar performance:
{'acc': 0.7907885, 'precision': 0.7982514, 'recall': 0.78945214, 'specificity': 0.78945214, 'f1': 0.788905, 'auroc': 0.8682052, 'binary_precision': 0.84150946, 'binary_recall': 0.7079365, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.7689656}
confusion matrix:
     0    1
0  567   84
1  184  446
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.84304214, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8421279, 'auroc': 0.9113679, 'binary_precision': 0.8598131, 'binary_recall': 0.81777775, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.8382688}
confusion matrix:
     0    1
0  195   30
1   41  184
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 15:12:23.991492,epoch time: 0:01:03.913739,used: 0:17:11.066020,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9375, 'precision': 0.9401337, 'recall': 0.93803203, 'specificity': 0.93803203, 'f1': 0.9374487, 'auroc': 0.9832057, 'binary_precision': 0.97759104, 'binary_recall': 0.8971722, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.9356568}
confusion matrix:
      0     1
0  1484    32
1   160  1396
---- Validation: 
scalar performance:
{'acc': 0.77751756, 'precision': 0.7932331, 'recall': 0.77557606, 'specificity': 0.77557606, 'f1': 0.77362394, 'auroc': 0.8665302, 'binary_precision': 0.85714287, 'binary_recall': 0.6571429, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.7439353}
confusion matrix:
     0    1
0  582   69
1  216  414
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8288889, 'precision': 0.833, 'recall': 0.8288889, 'specificity': 0.8288889, 'f1': 0.8283591, 'auroc': 0.9091358, 'binary_precision': 0.87, 'binary_recall': 0.7733333, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8188235}
confusion matrix:
     0    1
0  199   26
1   51  174
early stop counter: 1
val acc:0.777517557144165, best validation acc: 0.790788471698761, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 17,now: 2024-07-20 15:13:27.772674,epoch time: 0:01:03.781182,used: 0:18:14.847202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.93880206, 'precision': 0.9402349, 'recall': 0.93916, 'specificity': 0.93916, 'f1': 0.93877876, 'auroc': 0.9847082, 'binary_precision': 0.96844995, 'binary_recall': 0.9086229, 'binary_specificity': 0.969697, 'binary_f1_score': 0.937583}
confusion matrix:
      0     1
0  1472    46
1   142  1412
---- Validation: 
scalar performance:
{'acc': 0.785324, 'precision': 0.79612315, 'recall': 0.7837174, 'specificity': 0.7837174, 'f1': 0.7826532, 'auroc': 0.8698315, 'binary_precision': 0.848723, 'binary_recall': 0.6857143, 'binary_specificity': 0.8817204, 'binary_f1_score': 0.7585601}
confusion matrix:
     0    1
0  574   77
1  198  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.83685976, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.8353963, 'auroc': 0.9139358, 'binary_precision': 0.8578199, 'binary_recall': 0.80444443, 'binary_specificity': 0.8666667, 'binary_f1_score': 0.83027524}
confusion matrix:
     0    1
0  195   30
1   44  181
early stop counter: 2
val acc:0.785323977470398, best validation acc: 0.790788471698761, corresponding to test acc:                         0.8422222137451172 / 0.8422222137451172
after epoch: 18,now: 2024-07-20 15:14:31.553704,epoch time: 0:01:03.781030,used: 0:19:18.628232,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9407552, 'precision': 0.9427141, 'recall': 0.9412427, 'specificity': 0.9412427, 'f1': 0.9407244, 'auroc': 0.9877262, 'binary_precision': 0.9757785, 'binary_recall': 0.9055877, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.9393737}
confusion matrix:
      0     1
0  1480    35
1   147  1410
---- Validation: 
scalar performance:
{'acc': 0.7782982, 'precision': 0.79569787, 'recall': 0.7762673, 'specificity': 0.7762673, 'f1': 0.77408195, 'auroc': 0.87130904, 'binary_precision': 0.8634454, 'binary_recall': 0.65238094, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.7432188}
confusion matrix:
     0    1
0  586   65
1  219  411
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84444445, 'precision': 0.8491061, 'recall': 0.84444445, 'specificity': 0.84444445, 'f1': 0.84392345, 'auroc': 0.9163654, 'binary_precision': 0.8894472, 'binary_recall': 0.7866667, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  203   22
1   48  177
new oracle model saved
early stop counter: 3
val acc:0.7782981991767883, best validation acc: 0.790788471698761, corresponding to test acc:                         0.8422222137451172 / 0.8444444537162781
after epoch: 19,now: 2024-07-20 15:15:36.034959,epoch time: 0:01:04.481255,used: 0:20:23.109487,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94466144, 'precision': 0.94706523, 'recall': 0.94516927, 'specificity': 0.94516927, 'f1': 0.94462204, 'auroc': 0.9869409, 'binary_precision': 0.9832636, 'binary_recall': 0.90616965, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.94314384}
confusion matrix:
      0     1
0  1492    24
1   146  1410
---- Validation: 
scalar performance:
{'acc': 0.78298205, 'precision': 0.80170643, 'recall': 0.7809012, 'specificity': 0.7809012, 'f1': 0.7786603, 'auroc': 0.8734133, 'binary_precision': 0.87288135, 'binary_recall': 0.6539683, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.74773145}
confusion matrix:
     0    1
0  591   60
1  218  412
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8511111, 'precision': 0.85704243, 'recall': 0.8511111, 'specificity': 0.8511111, 'f1': 0.8504901, 'auroc': 0.91940737, 'binary_precision': 0.9030612, 'binary_recall': 0.7866667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.84085506}
confusion matrix:
     0    1
0  206   19
1   48  177
new oracle model saved
early stop counter: 4
val acc:0.7829820513725281, best validation acc: 0.790788471698761, corresponding to test acc:                         0.8422222137451172 / 0.851111114025116
after epoch: 20,now: 2024-07-20 15:16:39.870550,epoch time: 0:01:03.835591,used: 0:21:26.945078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94954425, 'precision': 0.9509543, 'recall': 0.9499191, 'specificity': 0.9499191, 'f1': 0.9495269, 'auroc': 0.9863875, 'binary_precision': 0.9794521, 'binary_recall': 0.91961414, 'binary_specificity': 0.98022413, 'binary_f1_score': 0.9485904}
confusion matrix:
      0     1
0  1487    30
1   125  1430
---- Validation: 
scalar performance:
{'acc': 0.79234976, 'precision': 0.8044294, 'recall': 0.790681, 'specificity': 0.790681, 'f1': 0.7895788, 'auroc': 0.8751981, 'binary_precision': 0.8611111, 'binary_recall': 0.6888889, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.7654321}
confusion matrix:
     0    1
0  581   70
1  196  434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488889, 'precision': 0.8506621, 'recall': 0.8488889, 'specificity': 0.8488889, 'f1': 0.8486976, 'auroc': 0.9204148, 'binary_precision': 0.8755981, 'binary_recall': 0.81333333, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.8433179}
confusion matrix:
     0    1
0  199   26
1   42  183
better model found
persisted
after epoch: 21,now: 2024-07-20 15:17:44.123406,epoch time: 0:01:04.252856,used: 0:22:31.197934,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.94661456, 'precision': 0.94741935, 'recall': 0.94695807, 'specificity': 0.94695807, 'f1': 0.9466088, 'auroc': 0.9897733, 'binary_precision': 0.9703104, 'binary_recall': 0.92297816, 'binary_specificity': 0.9709379, 'binary_f1_score': 0.94605255}
confusion matrix:
      0     1
0  1470    44
1   120  1438
---- Validation: 
scalar performance:
{'acc': 0.7978142, 'precision': 0.809952, 'recall': 0.79615974, 'specificity': 0.79615974, 'f1': 0.79515326, 'auroc': 0.8766391, 'binary_precision': 0.86732674, 'binary_recall': 0.6952381, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.7718062}
confusion matrix:
     0    1
0  584   67
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8595962, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.8575977, 'auroc': 0.9232, 'binary_precision': 0.8851675, 'binary_recall': 0.82222223, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.85253453}
confusion matrix:
     0    1
0  201   24
1   40  185
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 15:18:48.257977,epoch time: 0:01:04.134571,used: 0:23:35.332505,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9511719, 'precision': 0.95201004, 'recall': 0.95148575, 'specificity': 0.95148575, 'f1': 0.9511652, 'auroc': 0.9909839, 'binary_precision': 0.975, 'binary_recall': 0.9273779, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.95059294}
confusion matrix:
      0     1
0  1479    37
1   113  1443
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.811777, 'recall': 0.80189455, 'specificity': 0.80189455, 'f1': 0.80138755, 'auroc': 0.8775047, 'binary_precision': 0.8593156, 'binary_recall': 0.71746033, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.7820069}
confusion matrix:
     0    1
0  577   74
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8608625, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599163, 'auroc': 0.92499757, 'binary_precision': 0.8785047, 'binary_recall': 0.83555555, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85649204}
confusion matrix:
     0    1
0  199   26
1   37  188
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:19:52.615079,epoch time: 0:01:04.357102,used: 0:24:39.689607,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9453125, 'precision': 0.94643176, 'recall': 0.94565046, 'specificity': 0.94565046, 'f1': 0.94529915, 'auroc': 0.9882909, 'binary_precision': 0.9720899, 'binary_recall': 0.918328, 'binary_specificity': 0.972973, 'binary_f1_score': 0.9444445}
confusion matrix:
      0     1
0  1476    41
1   127  1428
---- Validation: 
scalar performance:
{'acc': 0.79859483, 'precision': 0.81097174, 'recall': 0.7969278, 'specificity': 0.7969278, 'f1': 0.79590726, 'auroc': 0.8786848, 'binary_precision': 0.86904764, 'binary_recall': 0.6952381, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.7724868}
confusion matrix:
     0    1
0  585   66
1  192  438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8587984, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.85767657, 'auroc': 0.92507654, 'binary_precision': 0.8779343, 'binary_recall': 0.83111113, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85388124}
confusion matrix:
     0    1
0  199   26
1   38  187
early stop counter: 1
val acc:0.7985948324203491, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8600000143051147 / 0.8600000143051147
after epoch: 24,now: 2024-07-20 15:20:56.771005,epoch time: 0:01:04.155926,used: 0:25:43.845533,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.94921875, 'precision': 0.950595, 'recall': 0.9495895, 'specificity': 0.9495895, 'f1': 0.9492019, 'auroc': 0.990157, 'binary_precision': 0.97878164, 'binary_recall': 0.91961414, 'binary_specificity': 0.9795649, 'binary_f1_score': 0.94827586}
confusion matrix:
      0     1
0  1486    31
1   125  1430
---- Validation: 
scalar performance:
{'acc': 0.78844655, 'precision': 0.8048654, 'recall': 0.78650796, 'specificity': 0.78650796, 'f1': 0.78474414, 'auroc': 0.87868965, 'binary_precision': 0.8716356, 'binary_recall': 0.66825396, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.7565139}
confusion matrix:
     0    1
0  589   62
1  209  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86444443, 'precision': 0.86653686, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.86425066, 'auroc': 0.92632097, 'binary_precision': 0.8942308, 'binary_recall': 0.82666665, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8591224}
confusion matrix:
     0    1
0  203   22
1   39  186
new oracle model saved
early stop counter: 2
val acc:0.7884465456008911, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8600000143051147 / 0.8644444346427917
after epoch: 25,now: 2024-07-20 15:22:00.743088,epoch time: 0:01:03.972083,used: 0:26:47.817616,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9505208, 'precision': 0.9519839, 'recall': 0.9508803, 'specificity': 0.9508803, 'f1': 0.9505019, 'auroc': 0.9897591, 'binary_precision': 0.9807956, 'binary_recall': 0.9202059, 'binary_specificity': 0.9815547, 'binary_f1_score': 0.9495352}
confusion matrix:
      0     1
0  1490    28
1   124  1430
---- Validation: 
scalar performance:
{'acc': 0.7900078, 'precision': 0.80382454, 'recall': 0.78822327, 'specificity': 0.78822327, 'f1': 0.78684664, 'auroc': 0.8791481, 'binary_precision': 0.8646465, 'binary_recall': 0.6793651, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.7608889}
confusion matrix:
     0    1
0  584   67
1  202  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8577778, 'precision': 0.8595962, 'recall': 0.8577778, 'specificity': 0.8577778, 'f1': 0.8575977, 'auroc': 0.92675555, 'binary_precision': 0.8851675, 'binary_recall': 0.82222223, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.85253453}
confusion matrix:
     0    1
0  201   24
1   40  185
early stop counter: 3
val acc:0.7900078296661377, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8600000143051147 / 0.8644444346427917
after epoch: 26,now: 2024-07-20 15:23:04.675105,epoch time: 0:01:03.932017,used: 0:27:51.749633,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.9575255, 'recall': 0.95701635, 'specificity': 0.95701635, 'f1': 0.9567001, 'auroc': 0.99023354, 'binary_precision': 0.9804186, 'binary_recall': 0.933162, 'binary_specificity': 0.9808707, 'binary_f1_score': 0.9562068}
confusion matrix:
      0     1
0  1487    29
1   104  1452
---- Validation: 
scalar performance:
{'acc': 0.8032787, 'precision': 0.811777, 'recall': 0.80189455, 'specificity': 0.80189455, 'f1': 0.80138755, 'auroc': 0.8817253, 'binary_precision': 0.8593156, 'binary_recall': 0.71746033, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.7820069}
confusion matrix:
     0    1
0  577   74
1  178  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86, 'precision': 0.8605769, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.859944, 'auroc': 0.9298568, 'binary_precision': 0.875, 'binary_recall': 0.84, 'binary_specificity': 0.88, 'binary_f1_score': 0.85714287}
confusion matrix:
     0    1
0  198   27
1   36  189
early stop counter: 4
val acc:0.8032786846160889, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8600000143051147 / 0.8644444346427917
after epoch: 27,now: 2024-07-20 15:24:08.467688,epoch time: 0:01:03.792583,used: 0:28:55.542216,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9550781, 'precision': 0.9556818, 'recall': 0.9553503, 'specificity': 0.9553503, 'f1': 0.95507485, 'auroc': 0.9916902, 'binary_precision': 0.9758389, 'binary_recall': 0.9344473, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.9546946}
confusion matrix:
      0     1
0  1480    36
1   102  1454
---- Validation: 
scalar performance:
{'acc': 0.80249804, 'precision': 0.8083966, 'recall': 0.8013313, 'specificity': 0.8013313, 'f1': 0.80108416, 'auroc': 0.8824055, 'binary_precision': 0.8471455, 'binary_recall': 0.73015875, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.7843138}
confusion matrix:
     0    1
0  568   83
1  170  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.85333335, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.8533333, 'auroc': 0.9310025, 'binary_precision': 0.85333335, 'binary_recall': 0.85333335, 'binary_specificity': 0.85333335, 'binary_f1_score': 0.8533333}
confusion matrix:
     0    1
0  192   33
1   33  192
early stop counter: 5
val acc:0.8024980425834656, best validation acc: 0.8032786846160889, corresponding to test acc:                         0.8600000143051147 / 0.8644444346427917
after epoch: 28,now: 2024-07-20 15:25:12.524261,epoch time: 0:01:04.056573,used: 0:29:59.598789,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_55_12_seed_1_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 28 with time: 0:29:59.598789 at 2024-07-20 15:25:12.524261
persisted model performance metric: 

scalar performance:
{'acc': 0.86, 'precision': 0.8608625, 'recall': 0.86, 'specificity': 0.86, 'f1': 0.8599163, 'auroc': 0.92499757, 'binary_precision': 0.8785047, 'binary_recall': 0.83555555, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.85649204}
confusion matrix:
     0    1
0  199   26
1   37  188
oracle model performance metric: 

scalar performance:
{'acc': 0.86444443, 'precision': 0.86653686, 'recall': 0.86444443, 'specificity': 0.86444443, 'f1': 0.86425066, 'auroc': 0.92632097, 'binary_precision': 0.8942308, 'binary_recall': 0.82666665, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.8591224}
confusion matrix:
     0    1
0  203   22
1   39  186
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196570 KiB |   1194 MiB |  93314 GiB |  93314 GiB |
|       from large pool | 180168 KiB |   1178 MiB |  92016 GiB |  92016 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1298 GiB |   1298 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196570 KiB |   1194 MiB |  93314 GiB |  93314 GiB |
|       from large pool | 180168 KiB |   1178 MiB |  92016 GiB |  92016 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1298 GiB |   1298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   1193 MiB |  93309 GiB |  93309 GiB |
|       from large pool | 178979 KiB |   1176 MiB |  92013 GiB |  92013 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1295 GiB |   1295 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1352 MiB |   1352 MiB |   2462 MiB |   1110 MiB |
|       from large pool |   1310 MiB |   1310 MiB |   2400 MiB |   1090 MiB |
|       from small pool |     42 MiB |     42 MiB |     62 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  49189 KiB | 147638 KiB |  50695 GiB |  50695 GiB |
|       from large pool |  45111 KiB | 146066 KiB |  49351 GiB |  49351 GiB |
|       from small pool |   4078 KiB |   9275 KiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1171    |   16326 K  |   16325 K  |
|       from large pool |      79    |     167    |    8618 K  |    8618 K  |
|       from small pool |     721    |    1017    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1171    |   16326 K  |   16325 K  |
|       from large pool |      79    |     167    |    8618 K  |    8618 K  |
|       from small pool |     721    |    1017    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      76    |      76    |     130    |      54    |
|       from large pool |      55    |      55    |      99    |      44    |
|       from small pool |      21    |      21    |      31    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      33    |     219    |   10476 K  |   10476 K  |
|       from large pool |      12    |      58    |    5974 K  |    5974 K  |
|       from small pool |      21    |     208    |    4501 K  |    4501 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  93314 GiB |  93314 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  92016 GiB |  92016 GiB |
|       from small pool |      0 KiB |     36 MiB |   1298 GiB |   1298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  93314 GiB |  93314 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  92016 GiB |  92016 GiB |
|       from small pool |      0 KiB |     36 MiB |   1298 GiB |   1298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  93309 GiB |  93309 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  92013 GiB |  92013 GiB |
|       from small pool |      0 KiB |     36 MiB |   1295 GiB |   1295 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   1352 MiB |   2462 MiB |   2222 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   2400 MiB |   2180 MiB |
|       from small pool |  20480 KiB |     42 MiB |     62 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  50695 GiB |  50695 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  49352 GiB |  49352 GiB |
|       from small pool |      0 KiB |  11188 KiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   16326 K  |   16326 K  |
|       from large pool |       2    |     167    |    8618 K  |    8618 K  |
|       from small pool |       0    |    1017    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   16326 K  |   16326 K  |
|       from large pool |       2    |     167    |    8618 K  |    8618 K  |
|       from small pool |       0    |    1017    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      76    |     130    |     109    |
|       from large pool |      11    |      55    |      99    |      88    |
|       from small pool |      10    |      21    |      31    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   10476 K  |   10476 K  |
|       from large pool |       4    |      58    |    5974 K  |    5974 K  |
|       from small pool |       0    |     208    |    4501 K  |    4501 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB |  93314 GiB |  93314 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  92016 GiB |  92016 GiB |
|       from small pool |      0 KiB |     36 MiB |   1298 GiB |   1298 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB |  93314 GiB |  93314 GiB |
|       from large pool |  16640 KiB |   1178 MiB |  92016 GiB |  92016 GiB |
|       from small pool |      0 KiB |     36 MiB |   1298 GiB |   1298 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB |  93309 GiB |  93309 GiB |
|       from large pool |  16640 KiB |   1176 MiB |  92013 GiB |  92013 GiB |
|       from small pool |      0 KiB |     36 MiB |   1295 GiB |   1295 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB |   1352 MiB |   2462 MiB |   2222 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   2400 MiB |   2180 MiB |
|       from small pool |  20480 KiB |     42 MiB |     62 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  50695 GiB |  50695 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  49352 GiB |  49352 GiB |
|       from small pool |      0 KiB |  11188 KiB |   1343 GiB |   1343 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   16326 K  |   16326 K  |
|       from large pool |       2    |     167    |    8618 K  |    8618 K  |
|       from small pool |       0    |    1017    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   16326 K  |   16326 K  |
|       from large pool |       2    |     167    |    8618 K  |    8618 K  |
|       from small pool |       0    |    1017    |    7707 K  |    7707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      76    |     130    |     109    |
|       from large pool |      11    |      55    |      99    |      88    |
|       from small pool |      10    |      21    |      31    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   10476 K  |   10476 K  |
|       from large pool |       4    |      58    |    5974 K  |    5974 K  |
|       from small pool |       0    |     208    |    4501 K  |    4501 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810

 Experiment start at: 2024-07-20 15:26:13.140706
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.7689791, 'precision': 0.769221, 'recall': 0.76908815, 'specificity': 0.76908815, 'f1': 0.76896477, 'auroc': 0.8458221, 'binary_precision': 0.7794906, 'binary_recall': 0.7551948, 'binary_specificity': 0.7829815, 'binary_f1_score': 0.76715034}
confusion matrix:
      0     1
0  1187   329
1   377  1163
---- Validation: 
scalar performance:
{'acc': 0.68388104, 'precision': 0.6922163, 'recall': 0.6807407, 'specificity': 0.6807407, 'f1': 0.67791057, 'auroc': 0.72079146, 'binary_precision': 0.7261411, 'binary_recall': 0.562701, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.634058}
confusion matrix:
     0    1
0  524  132
1  272  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.44675925, 'precision': 0.44109136, 'recall': 0.44675928, 'specificity': 0.44675928, 'f1': 0.4331238, 'auroc': 0.44326562, 'binary_precision': 0.42281878, 'binary_recall': 0.29166666, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.3452055}
confusion matrix:
     0   1
0  130  86
1  153  63
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:27:22.910190,epoch time: 0:01:09.769484,used: 0:01:09.769484,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8396597, 'precision': 0.8495038, 'recall': 0.84031796, 'specificity': 0.84031796, 'f1': 0.8386977, 'auroc': 0.9175492, 'binary_precision': 0.91015625, 'binary_recall': 0.7564935, 'binary_specificity': 0.9241425, 'binary_f1_score': 0.8262411}
confusion matrix:
      0     1
0  1401   115
1   375  1165
---- Validation: 
scalar performance:
{'acc': 0.657277, 'precision': 0.70063937, 'recall': 0.65074307, 'specificity': 0.65074307, 'f1': 0.6318282, 'auroc': 0.7371285, 'binary_precision': 0.7875, 'binary_recall': 0.4051447, 'binary_specificity': 0.89634144, 'binary_f1_score': 0.53503186}
confusion matrix:
     0    1
0  588   68
1  370  252
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5023148, 'precision': 0.50366163, 'recall': 0.5023148, 'specificity': 0.5023148, 'f1': 0.45191574, 'auroc': 0.5361797, 'binary_precision': 0.5058824, 'binary_recall': 0.19907407, 'binary_specificity': 0.8055556, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  174  42
1  173  43
new oracle model saved
early stop counter: 1
val acc:0.65727698802948, best validation acc: 0.6838810443878174, corresponding to test acc:                         0.44675925374031067 / 0.5023148059844971
after epoch: 2,now: 2024-07-20 15:28:26.497386,epoch time: 0:01:03.587196,used: 0:02:13.356680,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.87958115, 'precision': 0.8825059, 'recall': 0.87992835, 'specificity': 0.87992835, 'f1': 0.87941337, 'auroc': 0.94118154, 'binary_precision': 0.9179743, 'binary_recall': 0.8357143, 'binary_specificity': 0.9241425, 'binary_f1_score': 0.874915}
confusion matrix:
      0     1
0  1401   115
1   253  1287
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.696182, 'recall': 0.6400846, 'specificity': 0.6400846, 'f1': 0.61687255, 'auroc': 0.7450175, 'binary_precision': 0.7878788, 'binary_recall': 0.3762058, 'binary_specificity': 0.9039634, 'binary_f1_score': 0.50924915}
confusion matrix:
     0    1
0  593   63
1  388  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.53630257, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.4637016, 'auroc': 0.58819866, 'binary_precision': 0.56, 'binary_recall': 0.19444445, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.28865978}
confusion matrix:
     0   1
0  183  33
1  174  42
new oracle model saved
early stop counter: 2
val acc:0.6471048593521118, best validation acc: 0.6838810443878174, corresponding to test acc:                         0.44675925374031067 / 0.5208333134651184
after epoch: 3,now: 2024-07-20 15:29:30.123280,epoch time: 0:01:03.625894,used: 0:03:16.982574,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9024869, 'precision': 0.9063613, 'recall': 0.9028767, 'specificity': 0.9028767, 'f1': 0.90231013, 'auroc': 0.9566699, 'binary_precision': 0.9480519, 'binary_recall': 0.85324675, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.8981545}
confusion matrix:
      0     1
0  1444    72
1   226  1314
---- Validation: 
scalar performance:
{'acc': 0.63693273, 'precision': 0.70352966, 'recall': 0.6289678, 'specificity': 0.6289678, 'f1': 0.59662277, 'auroc': 0.7497941, 'binary_precision': 0.81349206, 'binary_recall': 0.329582, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.46910754}
confusion matrix:
     0    1
0  609   47
1  417  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.5580645, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.45696542, 'auroc': 0.6152477, 'binary_precision': 0.6, 'binary_recall': 0.16666667, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.26086956}
confusion matrix:
     0   1
0  192  24
1  180  36
new oracle model saved
early stop counter: 3
val acc:0.6369327306747437, best validation acc: 0.6838810443878174, corresponding to test acc:                         0.44675925374031067 / 0.5277777910232544
after epoch: 4,now: 2024-07-20 15:30:33.681652,epoch time: 0:01:03.558372,used: 0:04:20.540946,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90150523, 'precision': 0.9050137, 'recall': 0.9018769, 'specificity': 0.9018769, 'f1': 0.9013454, 'auroc': 0.9493636, 'binary_precision': 0.9447236, 'binary_recall': 0.8545455, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.8973747}
confusion matrix:
      0     1
0  1439    77
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.6945534, 'recall': 0.61686826, 'specificity': 0.61686826, 'f1': 0.5795715, 'auroc': 0.7555535, 'binary_precision': 0.8042553, 'binary_recall': 0.30385852, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.44107354}
confusion matrix:
     0    1
0  610   46
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.57897794, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.4732837, 'auroc': 0.65108454, 'binary_precision': 0.63492066, 'binary_recall': 0.18518518, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.28673834}
confusion matrix:
     0   1
0  193  23
1  176  40
new oracle model saved
early stop counter: 4
val acc:0.6251956224441528, best validation acc: 0.6838810443878174, corresponding to test acc:                         0.44675925374031067 / 0.5393518805503845
after epoch: 5,now: 2024-07-20 15:31:38.205892,epoch time: 0:01:04.524240,used: 0:05:25.065186,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90477747, 'precision': 0.90998214, 'recall': 0.90522647, 'specificity': 0.90522647, 'f1': 0.90453815, 'auroc': 0.9644027, 'binary_precision': 0.9581805, 'binary_recall': 0.84805197, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.8997589}
confusion matrix:
      0     1
0  1459    57
1   234  1306
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.7062767, 'recall': 0.6214415, 'specificity': 0.6214415, 'f1': 0.5833819, 'auroc': 0.76308477, 'binary_precision': 0.8253275, 'binary_recall': 0.30385852, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.4441833}
confusion matrix:
     0    1
0  616   40
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.58941877, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.48409736, 'auroc': 0.6769762, 'binary_precision': 0.6515151, 'binary_recall': 0.19907407, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.3049645}
confusion matrix:
     0   1
0  193  23
1  173  43
new oracle model saved
early stop counter: 5
val acc:0.6298904418945312, best validation acc: 0.6838810443878174, corresponding to test acc:                         0.44675925374031067 / 0.5462962985038757
after epoch: 6,now: 2024-07-20 15:32:41.632510,epoch time: 0:01:03.426618,used: 0:06:28.491804,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_26_13_seed_2_22504810
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:06:28.491804 at 2024-07-20 15:32:41.632510
persisted model performance metric: 

scalar performance:
{'acc': 0.44675925, 'precision': 0.44109136, 'recall': 0.44675928, 'specificity': 0.44675928, 'f1': 0.4331238, 'auroc': 0.44326562, 'binary_precision': 0.42281878, 'binary_recall': 0.29166666, 'binary_specificity': 0.6018519, 'binary_f1_score': 0.3452055}
confusion matrix:
     0   1
0  130  86
1  153  63
oracle model performance metric: 

scalar performance:
{'acc': 0.5462963, 'precision': 0.58941877, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.48409736, 'auroc': 0.6769762, 'binary_precision': 0.6515151, 'binary_recall': 0.19907407, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.3049645}
confusion matrix:
     0   1
0  193  23
1  173  43
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 196564 KiB |   1194 MiB | 104927 GiB | 104927 GiB |
|       from large pool | 180168 KiB |   1178 MiB | 103464 GiB | 103464 GiB |
|       from small pool |  16396 KiB |     36 MiB |   1463 GiB |   1463 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 196564 KiB |   1194 MiB | 104927 GiB | 104927 GiB |
|       from large pool | 180168 KiB |   1178 MiB | 103464 GiB | 103464 GiB |
|       from small pool |  16396 KiB |     36 MiB |   1463 GiB |   1463 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   1193 MiB | 104922 GiB | 104922 GiB |
|       from large pool | 178979 KiB |   1176 MiB | 103462 GiB | 103461 GiB |
|       from small pool |  16209 KiB |     36 MiB |   1460 GiB |   1460 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1348 MiB |   1352 MiB |   3570 MiB |   2222 MiB |
|       from large pool |   1310 MiB |   1310 MiB |   3490 MiB |   2180 MiB |
|       from small pool |     38 MiB |     42 MiB |     80 MiB |     42 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  51243 KiB | 147638 KiB |  56892 GiB |  56892 GiB |
|       from large pool |  45111 KiB | 146066 KiB |  55378 GiB |  55378 GiB |
|       from small pool |   6132 KiB |  11188 KiB |   1513 GiB |   1513 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1171    |   18342 K  |   18341 K  |
|       from large pool |      79    |     167    |    9693 K  |    9693 K  |
|       from small pool |     709    |    1017    |    8648 K  |    8648 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1171    |   18342 K  |   18341 K  |
|       from large pool |      79    |     167    |    9693 K  |    9693 K  |
|       from small pool |     709    |    1017    |    8648 K  |    8648 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |      76    |     183    |     109    |
|       from large pool |      55    |      55    |     143    |      88    |
|       from small pool |      19    |      21    |      40    |      21    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      36    |     219    |   11700 K  |   11700 K  |
|       from large pool |      12    |      58    |    6657 K  |    6657 K  |
|       from small pool |      24    |     208    |    5043 K  |    5043 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   1194 MiB | 104927 GiB | 104927 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 103464 GiB | 103464 GiB |
|       from small pool |      0 KiB |     36 MiB |   1463 GiB |   1463 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   1194 MiB | 104927 GiB | 104927 GiB |
|       from large pool |  16640 KiB |   1178 MiB | 103464 GiB | 103464 GiB |
|       from small pool |      0 KiB |     36 MiB |   1463 GiB |   1463 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1193 MiB | 104922 GiB | 104922 GiB |
|       from large pool |  16640 KiB |   1176 MiB | 103462 GiB | 103462 GiB |
|       from small pool |      0 KiB |     36 MiB |   1460 GiB |   1460 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 247808 KiB |   1352 MiB |   3570 MiB |   3328 MiB |
|       from large pool | 225280 KiB |   1310 MiB |   3490 MiB |   3270 MiB |
|       from small pool |  22528 KiB |     42 MiB |     80 MiB |     58 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 147638 KiB |  56892 GiB |  56892 GiB |
|       from large pool |  24320 KiB | 146066 KiB |  55378 GiB |  55378 GiB |
|       from small pool |      0 KiB |  13054 KiB |   1513 GiB |   1513 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   18342 K  |   18342 K  |
|       from large pool |       2    |     167    |    9693 K  |    9693 K  |
|       from small pool |       0    |    1017    |    8648 K  |    8648 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   18342 K  |   18342 K  |
|       from large pool |       2    |     167    |    9693 K  |    9693 K  |
|       from small pool |       0    |    1017    |    8648 K  |    8648 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      76    |     183    |     161    |
|       from large pool |      11    |      55    |     143    |     132    |
|       from small pool |      11    |      21    |      40    |      29    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |     219    |   11700 K  |   11700 K  |
|       from large pool |       4    |      58    |    6657 K  |    6657 K  |
|       from small pool |       0    |     208    |    5043 K  |    5043 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 15:33:17 2024]
Finished job 0.
1 of 1 steps (100%) done
