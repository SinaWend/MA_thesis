Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 15:10:19 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/5.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=5
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816

 Experiment start at: 2024-07-20 15:11:39.194340
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.53125, 'precision': 0.53125, 'recall': 0.5296149, 'specificity': 0.5296149, 'f1': 0.52419776, 'auroc': 0.56803, 'binary_precision': 0.53125, 'binary_recall': 0.6437741, 'binary_specificity': 0.41545576, 'binary_f1_score': 0.58212423}
confusion matrix:
     0     1
0  629   885
1  555  1003
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.63431674, 'precision': 0.6371238, 'recall': 0.63314927, 'specificity': 0.63314927, 'f1': 0.63116837, 'auroc': 0.70115334, 'binary_precision': 0.6535581, 'binary_recall': 0.5496063, 'binary_specificity': 0.7166922, 'binary_f1_score': 0.59709156}
confusion matrix:
     0    1
0  468  185
1  286  349
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.63118774, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.625566, 'auroc': 0.66258514, 'binary_precision': 0.6519337, 'binary_recall': 0.5488372, 'binary_specificity': 0.7069768, 'binary_f1_score': 0.5959596}
confusion matrix:
     0    1
0  152   63
1   97  118
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:13:11.240654,epoch time: 0:01:32.046314,used: 0:01:32.046314,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6666667, 'precision': 0.6737106, 'recall': 0.66517997, 'specificity': 0.66517997, 'f1': 0.6619728, 'auroc': 0.7556251, 'binary_precision': 0.6419819, 'binary_recall': 0.77392423, 'binary_specificity': 0.55643564, 'binary_f1_score': 0.7018054}
confusion matrix:
     0     1
0  843   672
1  352  1205
---- Validation: 
scalar performance:
{'acc': 0.63509315, 'precision': 0.6453167, 'recall': 0.63309014, 'specificity': 0.63309014, 'f1': 0.62644273, 'auroc': 0.70719516, 'binary_precision': 0.6805252, 'binary_recall': 0.48976377, 'binary_specificity': 0.77641654, 'binary_f1_score': 0.56959707}
confusion matrix:
     0    1
0  507  146
1  324  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62093025, 'precision': 0.63151705, 'recall': 0.6209302, 'specificity': 0.6209302, 'f1': 0.613145, 'auroc': 0.68553805, 'binary_precision': 0.66883117, 'binary_recall': 0.47906977, 'binary_specificity': 0.7627907, 'binary_f1_score': 0.5582656}
confusion matrix:
     0    1
0  164   51
1  112  103
better model found
persisted
after epoch: 2,now: 2024-07-20 15:14:40.873268,epoch time: 0:01:29.632614,used: 0:03:01.678928,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7451172, 'precision': 0.7456087, 'recall': 0.7447041, 'specificity': 0.7447041, 'f1': 0.74473417, 'auroc': 0.81528103, 'binary_precision': 0.7377451, 'binary_recall': 0.77228993, 'binary_specificity': 0.7171183, 'binary_f1_score': 0.7546224}
confusion matrix:
      0     1
0  1085   428
1   355  1204
---- Validation: 
scalar performance:
{'acc': 0.6040373, 'precision': 0.6267622, 'recall': 0.6008996, 'specificity': 0.6008996, 'f1': 0.5813235, 'auroc': 0.7118014, 'binary_precision': 0.6770538, 'binary_recall': 0.37637794, 'binary_specificity': 0.82542115, 'binary_f1_score': 0.48380566}
confusion matrix:
     0    1
0  539  114
1  396  239
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60697675, 'precision': 0.6372696, 'recall': 0.60697675, 'specificity': 0.60697675, 'f1': 0.5840274, 'auroc': 0.70286644, 'binary_precision': 0.7017544, 'binary_recall': 0.37209302, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.48632216}
confusion matrix:
     0   1
0  181  34
1  135  80
early stop counter: 1
val acc:0.6040372848510742, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6279069781303406
after epoch: 3,now: 2024-07-20 15:16:05.070120,epoch time: 0:01:24.196852,used: 0:04:25.875780,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.78841144, 'precision': 0.7883743, 'recall': 0.78840756, 'specificity': 0.78840756, 'f1': 0.78838557, 'auroc': 0.8589519, 'binary_precision': 0.79276955, 'binary_recall': 0.7886962, 'binary_specificity': 0.78811884, 'binary_f1_score': 0.7907277}
confusion matrix:
      0     1
0  1194   321
1   329  1228
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.6341413, 'recall': 0.6046629, 'specificity': 0.6046629, 'f1': 0.5836446, 'auroc': 0.7188916, 'binary_precision': 0.69005847, 'binary_recall': 0.37165356, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.4831116}
confusion matrix:
     0    1
0  547  106
1  399  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60930234, 'precision': 0.6394755, 'recall': 0.60930234, 'specificity': 0.60930234, 'f1': 0.586964, 'auroc': 0.7179881, 'binary_precision': 0.70434785, 'binary_recall': 0.37674418, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.4909091}
confusion matrix:
     0   1
0  181  34
1  134  81
early stop counter: 2
val acc:0.6079192757606506, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6279069781303406
after epoch: 4,now: 2024-07-20 15:17:28.194585,epoch time: 0:01:23.124465,used: 0:05:49.000245,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.82161456, 'precision': 0.82448995, 'recall': 0.8222202, 'specificity': 0.8222202, 'f1': 0.8213855, 'auroc': 0.87257135, 'binary_precision': 0.8584637, 'binary_recall': 0.77570695, 'binary_specificity': 0.8687335, 'binary_f1_score': 0.81498986}
confusion matrix:
      0     1
0  1317   199
1   349  1207
---- Validation: 
scalar performance:
{'acc': 0.5885093, 'precision': 0.6188847, 'recall': 0.5847825, 'specificity': 0.5847825, 'f1': 0.5548855, 'auroc': 0.7235919, 'binary_precision': 0.67558527, 'binary_recall': 0.31811023, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.43254817}
confusion matrix:
     0    1
0  556   97
1  433  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60232556, 'precision': 0.6395116, 'recall': 0.60232556, 'specificity': 0.60232556, 'f1': 0.57393426, 'auroc': 0.72889125, 'binary_precision': 0.71153843, 'binary_recall': 0.34418604, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.46394983}
confusion matrix:
     0   1
0  185  30
1  141  74
early stop counter: 3
val acc:0.5885093212127686, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6279069781303406
after epoch: 5,now: 2024-07-20 15:18:50.624217,epoch time: 0:01:22.429632,used: 0:07:11.429877,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8408203, 'precision': 0.8425977, 'recall': 0.8412893, 'specificity': 0.8412893, 'f1': 0.8407202, 'auroc': 0.89872086, 'binary_precision': 0.8707436, 'binary_recall': 0.8052699, 'binary_specificity': 0.8773087, 'binary_f1_score': 0.83672786}
confusion matrix:
      0     1
0  1330   186
1   303  1253
---- Validation: 
scalar performance:
{'acc': 0.5954969, 'precision': 0.6267421, 'recall': 0.5918474, 'specificity': 0.5918474, 'f1': 0.5638396, 'auroc': 0.7297826, 'binary_precision': 0.6862745, 'binary_recall': 0.33070865, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.44633368}
confusion matrix:
     0    1
0  557   96
1  425  210
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.6505473, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.58897644, 'auroc': 0.7399676, 'binary_precision': 0.72477067, 'binary_recall': 0.36744186, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.4876543}
confusion matrix:
     0   1
0  185  30
1  136  79
early stop counter: 4
val acc:0.5954968929290771, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6279069781303406
after epoch: 6,now: 2024-07-20 15:20:12.524677,epoch time: 0:01:21.900460,used: 0:08:33.330337,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8417969, 'precision': 0.8467651, 'recall': 0.84257555, 'specificity': 0.84257555, 'f1': 0.8414188, 'auroc': 0.899397, 'binary_precision': 0.8916545, 'binary_recall': 0.78277636, 'binary_specificity': 0.9023747, 'binary_f1_score': 0.83367556}
confusion matrix:
      0     1
0  1368   148
1   338  1218
---- Validation: 
scalar performance:
{'acc': 0.5970497, 'precision': 0.62888527, 'recall': 0.59340054, 'specificity': 0.59340054, 'f1': 0.56551397, 'auroc': 0.73712605, 'binary_precision': 0.6895425, 'binary_recall': 0.33228347, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.4484591}
confusion matrix:
     0    1
0  558   95
1  424  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.663216, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.60663235, 'auroc': 0.75247157, 'binary_precision': 0.73913044, 'binary_recall': 0.39534885, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.5151515}
confusion matrix:
     0   1
0  185  30
1  130  85
early stop counter: 5
val acc:0.5970497131347656, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6279069781303406
after epoch: 7,now: 2024-07-20 15:21:35.180134,epoch time: 0:01:22.655457,used: 0:09:55.985794,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8564453, 'precision': 0.8624432, 'recall': 0.85737187, 'specificity': 0.85737187, 'f1': 0.85604995, 'auroc': 0.91065633, 'binary_precision': 0.9127864, 'binary_recall': 0.79268295, 'binary_specificity': 0.9220608, 'binary_f1_score': 0.84850574}
confusion matrix:
      0     1
0  1396   118
1   323  1235
---- Validation: 
scalar performance:
{'acc': 0.6079193, 'precision': 0.63815475, 'recall': 0.60448927, 'specificity': 0.60448927, 'f1': 0.58090615, 'auroc': 0.7427114, 'binary_precision': 0.6993865, 'binary_recall': 0.35905513, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.47450572}
confusion matrix:
     0    1
0  555   98
1  407  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6655679, 'recall': 0.63255817, 'specificity': 0.63255817, 'f1': 0.6132829, 'auroc': 0.76064897, 'binary_precision': 0.7394958, 'binary_recall': 0.40930232, 'binary_specificity': 0.855814, 'binary_f1_score': 0.5269461}
confusion matrix:
     0   1
0  184  31
1  127  88
new oracle model saved
early stop counter: 6
val acc:0.6079192757606506, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6325581669807434
after epoch: 8,now: 2024-07-20 15:22:58.537871,epoch time: 0:01:23.357737,used: 0:11:19.343531,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85026044, 'precision': 0.8541584, 'recall': 0.8509803, 'specificity': 0.8509803, 'f1': 0.85000813, 'auroc': 0.91654634, 'binary_precision': 0.8948884, 'binary_recall': 0.7983301, 'binary_specificity': 0.9036304, 'binary_f1_score': 0.8438561}
confusion matrix:
      0     1
0  1369   146
1   314  1243
---- Validation: 
scalar performance:
{'acc': 0.61413044, 'precision': 0.64636874, 'recall': 0.6107017, 'specificity': 0.6107017, 'f1': 0.5875452, 'auroc': 0.74613595, 'binary_precision': 0.71165645, 'binary_recall': 0.36535433, 'binary_specificity': 0.856049, 'binary_f1_score': 0.48283038}
confusion matrix:
     0    1
0  559   94
1  403  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6395349, 'precision': 0.6716521, 'recall': 0.6395349, 'specificity': 0.6395349, 'f1': 0.6218461, 'auroc': 0.7681341, 'binary_precision': 0.74590164, 'binary_recall': 0.4232558, 'binary_specificity': 0.855814, 'binary_f1_score': 0.5400593}
confusion matrix:
     0   1
0  184  31
1  124  91
new oracle model saved
early stop counter: 7
val acc:0.614130437374115, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6395348906517029
after epoch: 9,now: 2024-07-20 15:24:21.418469,epoch time: 0:01:22.880598,used: 0:12:42.224129,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8720703, 'precision': 0.8785275, 'recall': 0.8730606, 'specificity': 0.8730606, 'f1': 0.87170917, 'auroc': 0.929906, 'binary_precision': 0.93185186, 'binary_recall': 0.8069275, 'binary_specificity': 0.93919367, 'binary_f1_score': 0.8649021}
confusion matrix:
      0     1
0  1421    92
1   301  1258
---- Validation: 
scalar performance:
{'acc': 0.5931677, 'precision': 0.6301461, 'recall': 0.5892682, 'specificity': 0.5892682, 'f1': 0.5565752, 'auroc': 0.74862236, 'binary_precision': 0.69611305, 'binary_recall': 0.31023622, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.42919385}
confusion matrix:
     0    1
0  567   86
1  438  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6372093, 'precision': 0.68127126, 'recall': 0.6372093, 'specificity': 0.6372093, 'f1': 0.61373687, 'auroc': 0.7744727, 'binary_precision': 0.7706422, 'binary_recall': 0.3906977, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.5185185}
confusion matrix:
     0   1
0  190  25
1  131  84
early stop counter: 8
val acc:0.5931677222251892, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6395348906517029
after epoch: 10,now: 2024-07-20 15:25:44.556386,epoch time: 0:01:23.137917,used: 0:14:05.362046,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.86816406, 'precision': 0.87328446, 'recall': 0.86893445, 'specificity': 0.86893445, 'f1': 0.8678615, 'auroc': 0.92960525, 'binary_precision': 0.9203798, 'binary_recall': 0.8097686, 'binary_specificity': 0.9281003, 'binary_f1_score': 0.8615384}
confusion matrix:
      0     1
0  1407   109
1   296  1260
---- Validation: 
scalar performance:
{'acc': 0.61568326, 'precision': 0.6489998, 'recall': 0.61223304, 'specificity': 0.61223304, 'f1': 0.5888574, 'auroc': 0.75458395, 'binary_precision': 0.7160494, 'binary_recall': 0.36535433, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.4838373}
confusion matrix:
     0    1
0  561   92
1  403  232
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6465116, 'precision': 0.68493485, 'recall': 0.6465116, 'specificity': 0.6465116, 'f1': 0.62714493, 'auroc': 0.7826717, 'binary_precision': 0.7692308, 'binary_recall': 0.41860464, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.5421687}
confusion matrix:
     0   1
0  188  27
1  125  90
new oracle model saved
early stop counter: 9
val acc:0.6156832575798035, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6465116143226624
after epoch: 11,now: 2024-07-20 15:27:07.945153,epoch time: 0:01:23.388767,used: 0:15:28.750813,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87402344, 'precision': 0.88371146, 'recall': 0.875015, 'specificity': 0.875015, 'f1': 0.8734149, 'auroc': 0.93491894, 'binary_precision': 0.9478528, 'binary_recall': 0.7948553, 'binary_specificity': 0.9551747, 'binary_f1_score': 0.864638}
confusion matrix:
      0     1
0  1449    68
1   319  1236
---- Validation: 
scalar performance:
{'acc': 0.6257764, 'precision': 0.6584542, 'recall': 0.6224693, 'specificity': 0.6224693, 'f1': 0.6018083, 'auroc': 0.76074266, 'binary_precision': 0.727003, 'binary_recall': 0.38582677, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.5041153}
confusion matrix:
     0    1
0  561   92
1  390  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.69073915, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6393026, 'auroc': 0.79069763, 'binary_precision': 0.7723577, 'binary_recall': 0.44186047, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.56213015}
confusion matrix:
     0   1
0  187  28
1  120  95
new oracle model saved
early stop counter: 10
val acc:0.6257764101028442, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6558139324188232
after epoch: 12,now: 2024-07-20 15:28:30.606736,epoch time: 0:01:22.661583,used: 0:16:51.412396,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8873698, 'precision': 0.89297616, 'recall': 0.888242, 'specificity': 0.888242, 'f1': 0.88710773, 'auroc': 0.94584477, 'binary_precision': 0.94363105, 'binary_recall': 0.82734275, 'binary_specificity': 0.9491413, 'binary_f1_score': 0.8816689}
confusion matrix:
      0     1
0  1437    77
1   269  1289
---- Validation: 
scalar performance:
{'acc': 0.632764, 'precision': 0.66313374, 'recall': 0.629621, 'specificity': 0.629621, 'f1': 0.61154926, 'auroc': 0.7660995, 'binary_precision': 0.7301136, 'binary_recall': 0.40472442, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.52077}
confusion matrix:
     0    1
0  558   95
1  378  257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6945574, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.6449095, 'auroc': 0.79660356, 'binary_precision': 0.776, 'binary_recall': 0.4511628, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.57058823}
confusion matrix:
     0   1
0  187  28
1  118  97
new oracle model saved
early stop counter: 11
val acc:0.6327639818191528, best validation acc: 0.6350931525230408, corresponding to test acc:                         0.6209302544593811 / 0.6604651212692261
after epoch: 13,now: 2024-07-20 15:29:54.418078,epoch time: 0:01:23.811342,used: 0:18:15.223738,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8779297, 'precision': 0.88415825, 'recall': 0.8787695, 'specificity': 0.8787695, 'f1': 0.87758505, 'auroc': 0.94331735, 'binary_precision': 0.93643755, 'binary_recall': 0.81426734, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.8710897}
confusion matrix:
      0     1
0  1430    86
1   289  1267
---- Validation: 
scalar performance:
{'acc': 0.6537267, 'precision': 0.67709845, 'recall': 0.6510762, 'specificity': 0.6510762, 'f1': 0.63948464, 'auroc': 0.7711037, 'binary_precision': 0.73803526, 'binary_recall': 0.46141732, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.56782943}
confusion matrix:
     0    1
0  549  104
1  342  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.6935774, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6558248, 'auroc': 0.803483, 'binary_precision': 0.7647059, 'binary_recall': 0.48372093, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.5925926}
confusion matrix:
     0    1
0  183   32
1  111  104
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 15:31:18.382689,epoch time: 0:01:23.964611,used: 0:19:39.188349,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8811849, 'precision': 0.89038944, 'recall': 0.8821453, 'specificity': 0.8821453, 'f1': 0.88065344, 'auroc': 0.94505453, 'binary_precision': 0.9535061, 'binary_recall': 0.8045016, 'binary_specificity': 0.95978904, 'binary_f1_score': 0.8726892}
confusion matrix:
      0     1
0  1456    61
1   304  1251
---- Validation: 
scalar performance:
{'acc': 0.6622671, 'precision': 0.68183565, 'recall': 0.6598679, 'specificity': 0.6598679, 'f1': 0.65084076, 'auroc': 0.77772605, 'binary_precision': 0.7380952, 'binary_recall': 0.48818898, 'binary_specificity': 0.8315467, 'binary_f1_score': 0.5876777}
confusion matrix:
     0    1
0  543  110
1  325  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.69509983, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.66555554, 'auroc': 0.8117469, 'binary_precision': 0.7586207, 'binary_recall': 0.5116279, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.6111111}
confusion matrix:
     0    1
0  180   35
1  105  110
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 15:32:41.842438,epoch time: 0:01:23.459749,used: 0:21:02.648098,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8929036, 'precision': 0.9005548, 'recall': 0.89391226, 'specificity': 0.89391226, 'f1': 0.8925469, 'auroc': 0.9558557, 'binary_precision': 0.95961106, 'binary_recall': 0.82349163, 'binary_specificity': 0.9643329, 'binary_f1_score': 0.88635576}
confusion matrix:
      0     1
0  1460    54
1   275  1283
---- Validation: 
scalar performance:
{'acc': 0.66381985, 'precision': 0.6840318, 'recall': 0.66139925, 'specificity': 0.66139925, 'f1': 0.6522433, 'auroc': 0.78060734, 'binary_precision': 0.7416268, 'binary_recall': 0.48818898, 'binary_specificity': 0.8346095, 'binary_f1_score': 0.58879393}
confusion matrix:
     0    1
0  545  108
1  325  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67674416, 'precision': 0.698378, 'recall': 0.6767442, 'specificity': 0.6767442, 'f1': 0.6676842, 'auroc': 0.81726336, 'binary_precision': 0.7638889, 'binary_recall': 0.5116279, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.6128134}
confusion matrix:
     0    1
0  181   34
1  105  110
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 15:34:05.404313,epoch time: 0:01:23.561875,used: 0:22:26.209973,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8880208, 'precision': 0.8932228, 'recall': 0.8887447, 'specificity': 0.8887447, 'f1': 0.8877673, 'auroc': 0.9506023, 'binary_precision': 0.9416484, 'binary_recall': 0.8302251, 'binary_specificity': 0.9472643, 'binary_f1_score': 0.8824334}
confusion matrix:
      0     1
0  1437    80
1   264  1291
---- Validation: 
scalar performance:
{'acc': 0.6824534, 'precision': 0.6957964, 'recall': 0.6805356, 'specificity': 0.6805356, 'f1': 0.67546535, 'auroc': 0.78602695, 'binary_precision': 0.7435345, 'binary_recall': 0.54330707, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.6278435}
confusion matrix:
     0    1
0  534  119
1  290  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7069768, 'precision': 0.7209125, 'recall': 0.7069768, 'specificity': 0.7069768, 'f1': 0.7022816, 'auroc': 0.82314765, 'binary_precision': 0.7763975, 'binary_recall': 0.5813953, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.6648936}
confusion matrix:
     0    1
0  179   36
1   90  125
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 15:35:28.342703,epoch time: 0:01:22.938390,used: 0:23:49.148363,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9029948, 'precision': 0.90725446, 'recall': 0.9035739, 'specificity': 0.9035739, 'f1': 0.9028208, 'auroc': 0.95701194, 'binary_precision': 0.95176387, 'binary_recall': 0.85125566, 'binary_specificity': 0.955892, 'binary_f1_score': 0.8987084}
confusion matrix:
      0     1
0  1452    67
1   231  1322
---- Validation: 
scalar performance:
{'acc': 0.68944097, 'precision': 0.70249486, 'recall': 0.6875788, 'specificity': 0.6875788, 'f1': 0.682971, 'auroc': 0.7913736, 'binary_precision': 0.75053304, 'binary_recall': 0.5543307, 'binary_specificity': 0.82082695, 'binary_f1_score': 0.6376812}
confusion matrix:
     0    1
0  536  117
1  283  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7277962, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.70954084, 'auroc': 0.82851267, 'binary_precision': 0.7839506, 'binary_recall': 0.59069765, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.67374}
confusion matrix:
     0    1
0  180   35
1   88  127
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 15:36:50.986337,epoch time: 0:01:22.643634,used: 0:25:11.791997,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.89420575, 'precision': 0.90239125, 'recall': 0.8951501, 'specificity': 0.8951501, 'f1': 0.89381224, 'auroc': 0.9558425, 'binary_precision': 0.9631302, 'binary_recall': 0.8226221, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.88734835}
confusion matrix:
      0     1
0  1467    49
1   276  1280
---- Validation: 
scalar performance:
{'acc': 0.6925466, 'precision': 0.7073, 'recall': 0.6905982, 'specificity': 0.6905982, 'f1': 0.6855593, 'auroc': 0.79449785, 'binary_precision': 0.7592191, 'binary_recall': 0.5511811, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.63868606}
confusion matrix:
     0    1
0  542  111
1  285  350
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.727907, 'precision': 0.7414955, 'recall': 0.72790694, 'specificity': 0.72790694, 'f1': 0.72402483, 'auroc': 0.833683, 'binary_precision': 0.7987805, 'binary_recall': 0.60930234, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.6912929}
confusion matrix:
     0    1
0  182   33
1   84  131
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 15:38:14.469569,epoch time: 0:01:23.483232,used: 0:26:35.275229,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9033203, 'precision': 0.9096134, 'recall': 0.90418804, 'specificity': 0.90418804, 'f1': 0.9030671, 'auroc': 0.96121335, 'binary_precision': 0.96391755, 'binary_recall': 0.84071934, 'binary_specificity': 0.9676568, 'binary_f1_score': 0.89811325}
confusion matrix:
      0     1
0  1466    49
1   248  1309
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.72030586, 'recall': 0.710522, 'specificity': 0.710522, 'f1': 0.7082591, 'auroc': 0.8009815, 'binary_precision': 0.7598425, 'binary_recall': 0.60787404, 'binary_specificity': 0.81316996, 'binary_f1_score': 0.6754156}
confusion matrix:
     0    1
0  531  122
1  249  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76558566, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.75643235, 'auroc': 0.8396106, 'binary_precision': 0.81005585, 'binary_recall': 0.6744186, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.73604065}
confusion matrix:
     0    1
0  181   34
1   70  145
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 15:39:37.354745,epoch time: 0:01:22.885176,used: 0:27:58.160405,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9114583, 'precision': 0.9177939, 'recall': 0.9123231, 'specificity': 0.9123231, 'f1': 0.9112294, 'auroc': 0.962355, 'binary_precision': 0.9727741, 'binary_recall': 0.8490687, 'binary_specificity': 0.97557753, 'binary_f1_score': 0.90672153}
confusion matrix:
      0     1
0  1478    37
1   235  1322
---- Validation: 
scalar performance:
{'acc': 0.7243789, 'precision': 0.7296662, 'recall': 0.7232506, 'specificity': 0.7232506, 'f1': 0.7220856, 'auroc': 0.8059447, 'binary_precision': 0.76119405, 'binary_recall': 0.6425197, 'binary_specificity': 0.8039816, 'binary_f1_score': 0.69684035}
confusion matrix:
     0    1
0  525  128
1  227  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.77476645, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.7687155, 'auroc': 0.8436993, 'binary_precision': 0.81182796, 'binary_recall': 0.7023256, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.75311726}
confusion matrix:
     0    1
0  180   35
1   64  151
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 15:41:00.622361,epoch time: 0:01:23.267616,used: 0:29:21.428021,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9016927, 'precision': 0.90847075, 'recall': 0.9025493, 'specificity': 0.9025493, 'f1': 0.9014048, 'auroc': 0.9599389, 'binary_precision': 0.96444446, 'binary_recall': 0.83676094, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.8960771}
confusion matrix:
      0     1
0  1468    48
1   254  1302
---- Validation: 
scalar performance:
{'acc': 0.7290373, 'precision': 0.73358434, 'recall': 0.72799677, 'specificity': 0.72799677, 'f1': 0.72708267, 'auroc': 0.80993116, 'binary_precision': 0.7628676, 'binary_recall': 0.6535433, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.7039864}
confusion matrix:
     0    1
0  524  129
1  220  415
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.77476645, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.7687155, 'auroc': 0.8480692, 'binary_precision': 0.81182796, 'binary_recall': 0.7023256, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.75311726}
confusion matrix:
     0    1
0  180   35
1   64  151
better model found
persisted
after epoch: 22,now: 2024-07-20 15:42:23.773130,epoch time: 0:01:23.150769,used: 0:30:44.578790,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.914388, 'precision': 0.9205593, 'recall': 0.91524005, 'specificity': 0.91524005, 'f1': 0.91417515, 'auroc': 0.9674524, 'binary_precision': 0.97503674, 'binary_recall': 0.85292226, 'binary_specificity': 0.9775578, 'binary_f1_score': 0.9099006}
confusion matrix:
      0     1
0  1481    34
1   229  1328
---- Validation: 
scalar performance:
{'acc': 0.73447204, 'precision': 0.738838, 'recall': 0.7334652, 'specificity': 0.7334652, 'f1': 0.73266137, 'auroc': 0.81393695, 'binary_precision': 0.7678245, 'binary_recall': 0.6614173, 'binary_specificity': 0.805513, 'binary_f1_score': 0.71065986}
confusion matrix:
     0    1
0  526  127
1  215  420
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.77678746, 'recall': 0.77209306, 'specificity': 0.77209306, 'f1': 0.7711225, 'auroc': 0.85107625, 'binary_precision': 0.8128342, 'binary_recall': 0.7069768, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.7562189}
confusion matrix:
     0    1
0  180   35
1   63  152
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:43:46.732498,epoch time: 0:01:22.959368,used: 0:32:07.538158,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.91639954, 'recall': 0.91036314, 'specificity': 0.91036314, 'f1': 0.9092402, 'auroc': 0.9663669, 'binary_precision': 0.97333336, 'binary_recall': 0.844473, 'binary_specificity': 0.9762533, 'binary_f1_score': 0.9043359}
confusion matrix:
      0     1
0  1480    36
1   242  1314
---- Validation: 
scalar performance:
{'acc': 0.7430124, 'precision': 0.74666333, 'recall': 0.7421049, 'specificity': 0.7421049, 'f1': 0.7415465, 'auroc': 0.8183912, 'binary_precision': 0.7733813, 'binary_recall': 0.6771653, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.72208226}
confusion matrix:
     0    1
0  527  126
1  205  430
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.7855716, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.78059316, 'auroc': 0.8560735, 'binary_precision': 0.8201058, 'binary_recall': 0.7209302, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7673267}
confusion matrix:
     0    1
0  181   34
1   60  155
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:45:08.935174,epoch time: 0:01:22.202676,used: 0:33:29.740834,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91341144, 'precision': 0.91890985, 'recall': 0.9141393, 'specificity': 0.9141393, 'f1': 0.91321546, 'auroc': 0.97046757, 'binary_precision': 0.9700948, 'binary_recall': 0.8553055, 'binary_specificity': 0.972973, 'binary_f1_score': 0.9090909}
confusion matrix:
      0     1
0  1476    41
1   225  1330
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.7551402, 'recall': 0.75242794, 'specificity': 0.75242794, 'f1': 0.752243, 'auroc': 0.82223296, 'binary_precision': 0.7746967, 'binary_recall': 0.703937, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.7376238}
confusion matrix:
     0    1
0  523  130
1  188  447
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.7876395, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.78574985, 'auroc': 0.8596647, 'binary_precision': 0.80904526, 'binary_recall': 0.74883723, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.77777773}
confusion matrix:
     0    1
0  177   38
1   54  161
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 15:46:32.193687,epoch time: 0:01:23.258513,used: 0:34:52.999347,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91015625, 'precision': 0.91357076, 'recall': 0.9107684, 'specificity': 0.9107684, 'f1': 0.9100451, 'auroc': 0.96268296, 'binary_precision': 0.95454544, 'binary_recall': 0.8637532, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.9068826}
confusion matrix:
      0     1
0  1452    64
1   212  1344
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.75737935, 'recall': 0.75568604, 'specificity': 0.75568604, 'f1': 0.75564504, 'auroc': 0.82462525, 'binary_precision': 0.7715736, 'binary_recall': 0.71811026, 'binary_specificity': 0.7932619, 'binary_f1_score': 0.7438826}
confusion matrix:
     0    1
0  518  135
1  179  456
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7906977, 'precision': 0.79160607, 'recall': 0.7906977, 'specificity': 0.7906977, 'f1': 0.79053456, 'auroc': 0.86219573, 'binary_precision': 0.8078818, 'binary_recall': 0.7627907, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.78468895}
confusion matrix:
     0    1
0  176   39
1   51  164
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:47:54.309203,epoch time: 0:01:22.115516,used: 0:36:15.114863,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9156901, 'precision': 0.9214799, 'recall': 0.91651565, 'specificity': 0.91651565, 'f1': 0.9154966, 'auroc': 0.97122717, 'binary_precision': 0.9744152, 'binary_recall': 0.8561336, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.911453}
confusion matrix:
      0     1
0  1480    35
1   224  1333
---- Validation: 
scalar performance:
{'acc': 0.7531056, 'precision': 0.7559289, 'recall': 0.7523194, 'specificity': 0.7523194, 'f1': 0.752, 'auroc': 0.8266028, 'binary_precision': 0.77954143, 'binary_recall': 0.696063, 'binary_specificity': 0.8085758, 'binary_f1_score': 0.7354409}
confusion matrix:
     0    1
0  528  125
1  193  442
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.79913044, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7974279, 'auroc': 0.86617625, 'binary_precision': 0.82, 'binary_recall': 0.7627907, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.79036146}
confusion matrix:
     0    1
0  179   36
1   51  164
new oracle model saved
early stop counter: 1
val acc:0.7531055808067322, best validation acc: 0.7562111616134644, corresponding to test acc:                         0.7906976938247681 / 0.7976744174957275
after epoch: 27,now: 2024-07-20 15:49:16.336414,epoch time: 0:01:22.027211,used: 0:37:37.142074,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9117839, 'precision': 0.91736937, 'recall': 0.9126378, 'specificity': 0.9126378, 'f1': 0.9115923, 'auroc': 0.97020113, 'binary_precision': 0.9693654, 'binary_recall': 0.8530167, 'binary_specificity': 0.9722589, 'binary_f1_score': 0.90747696}
confusion matrix:
      0     1
0  1472    42
1   229  1329
---- Validation: 
scalar performance:
{'acc': 0.76319873, 'precision': 0.7645918, 'recall': 0.76264244, 'specificity': 0.76264244, 'f1': 0.7625941, 'auroc': 0.8321786, 'binary_precision': 0.78061223, 'binary_recall': 0.72283465, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.7506133}
confusion matrix:
     0    1
0  524  129
1  176  459
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8, 'precision': 0.8006504, 'recall': 0.8, 'specificity': 0.8, 'f1': 0.79989177, 'auroc': 0.8703299, 'binary_precision': 0.81463414, 'binary_recall': 0.7767442, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.7952381}
confusion matrix:
     0    1
0  177   38
1   48  167
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 15:50:39.511981,epoch time: 0:01:23.175567,used: 0:39:00.317641,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9186198, 'precision': 0.92323923, 'recall': 0.91939586, 'specificity': 0.91939586, 'f1': 0.91848266, 'auroc': 0.97178537, 'binary_precision': 0.9711816, 'binary_recall': 0.8652118, 'binary_specificity': 0.97357994, 'binary_f1_score': 0.91513914}
confusion matrix:
      0     1
0  1474    40
1   210  1348
---- Validation: 
scalar performance:
{'acc': 0.7717391, 'precision': 0.77278674, 'recall': 0.77126044, 'specificity': 0.77126044, 'f1': 0.7712754, 'auroc': 0.8354367, 'binary_precision': 0.78655463, 'binary_recall': 0.73700786, 'binary_specificity': 0.805513, 'binary_f1_score': 0.76097566}
confusion matrix:
     0    1
0  526  127
1  167  468
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.79598916, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7952381, 'auroc': 0.87426716, 'binary_precision': 0.8097561, 'binary_recall': 0.772093, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.79047614}
confusion matrix:
     0    1
0  176   39
1   49  166
better model found
persisted
after epoch: 29,now: 2024-07-20 15:52:02.599194,epoch time: 0:01:23.087213,used: 0:40:23.404854,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9192708, 'precision': 0.9257739, 'recall': 0.92005587, 'specificity': 0.92005587, 'f1': 0.91905123, 'auroc': 0.97250664, 'binary_precision': 0.981577, 'binary_recall': 0.85659164, 'binary_specificity': 0.9835201, 'binary_f1_score': 0.91483516}
confusion matrix:
      0     1
0  1492    25
1   223  1332
---- Validation: 
scalar performance:
{'acc': 0.76397514, 'precision': 0.76612866, 'recall': 0.7632996, 'specificity': 0.7632996, 'f1': 0.76315045, 'auroc': 0.8374504, 'binary_precision': 0.7868284, 'binary_recall': 0.71496063, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.7491749}
confusion matrix:
     0    1
0  530  123
1  181  454
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8023256, 'precision': 0.80311906, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80219615, 'auroc': 0.8775122, 'binary_precision': 0.8186275, 'binary_recall': 0.7767442, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.797136}
confusion matrix:
     0    1
0  178   37
1   48  167
new oracle model saved
early stop counter: 1
val acc:0.7639751434326172, best validation acc: 0.77173912525177, corresponding to test acc:                         0.7953488230705261 / 0.8023256063461304
after epoch: 30,now: 2024-07-20 15:53:24.258227,epoch time: 0:01:21.659033,used: 0:41:45.063887,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_11_39_seed_0_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:45.063887 at 2024-07-20 15:53:24.258227
persisted model performance metric: 

scalar performance:
{'acc': 0.7953488, 'precision': 0.79598916, 'recall': 0.7953488, 'specificity': 0.7953488, 'f1': 0.7952381, 'auroc': 0.87426716, 'binary_precision': 0.8097561, 'binary_recall': 0.772093, 'binary_specificity': 0.81860465, 'binary_f1_score': 0.79047614}
confusion matrix:
     0    1
0  176   39
1   49  166
oracle model performance metric: 

scalar performance:
{'acc': 0.8023256, 'precision': 0.80311906, 'recall': 0.8023256, 'specificity': 0.8023256, 'f1': 0.80219615, 'auroc': 0.8775122, 'binary_precision': 0.8186275, 'binary_recall': 0.7767442, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.797136}
confusion matrix:
     0    1
0  178   37
1   48  167
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/5.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61332 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61332 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |   8180 KiB |  10132 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10389 K  |   10388 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4751 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10389 K  |   10388 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4751 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     380    |    6463 K  |    6463 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      32    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10389 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10389 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6463 K  |    6463 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2142 K  |    2142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10389 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10389 K  |   10388 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6463 K  |    6463 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2142 K  |    2142 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816

 Experiment start at: 2024-07-20 15:54:48.691017
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5439453, 'precision': 0.54920256, 'recall': 0.5411937, 'specificity': 0.5411937, 'f1': 0.5231855, 'auroc': 0.5274292, 'binary_precision': 0.5361781, 'binary_recall': 0.74245346, 'binary_specificity': 0.339934, 'binary_f1_score': 0.6226771}
confusion matrix:
     0     1
0  515  1000
1  401  1156
---- Validation: 
scalar performance:
{'acc': 0.4918033, 'precision': 0.47707424, 'recall': 0.48653352, 'specificity': 0.48653352, 'f1': 0.42993772, 'auroc': 0.6236949, 'binary_precision': 0.45414847, 'binary_recall': 0.16507937, 'binary_specificity': 0.8079877, 'binary_f1_score': 0.24214204}
confusion matrix:
     0    1
0  526  125
1  526  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.589056, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.54835963, 'auroc': 0.67026174, 'binary_precision': 0.62903225, 'binary_recall': 0.34666666, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.44699138}
confusion matrix:
     0   1
0  179  46
1  147  78
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:56:23.924194,epoch time: 0:01:35.233177,used: 0:01:35.233177,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.57942706, 'precision': 0.58027995, 'recall': 0.57858336, 'specificity': 0.57858336, 'f1': 0.5768008, 'auroc': 0.59953153, 'binary_precision': 0.57443184, 'binary_recall': 0.65057915, 'binary_specificity': 0.5065876, 'binary_f1_score': 0.61013883}
confusion matrix:
     0     1
0  769   749
1  543  1011
---- Validation: 
scalar performance:
{'acc': 0.47540984, 'precision': 0.42039877, 'recall': 0.46899644, 'specificity': 0.46899644, 'f1': 0.37613636, 'auroc': 0.63339186, 'binary_precision': 0.35, 'binary_recall': 0.07777778, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.12727274}
confusion matrix:
     0   1
0  560  91
1  581  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.5794344, 'recall': 0.5422222, 'specificity': 0.5422222, 'f1': 0.48149723, 'auroc': 0.6802765, 'binary_precision': 0.63380283, 'binary_recall': 0.2, 'binary_specificity': 0.8844444, 'binary_f1_score': 0.30405408}
confusion matrix:
     0   1
0  199  26
1  180  45
early stop counter: 1
val acc:0.4754098355770111, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 2,now: 2024-07-20 15:57:47.502523,epoch time: 0:01:23.578329,used: 0:02:58.811506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6695964, 'precision': 0.6723791, 'recall': 0.6687689, 'specificity': 0.6687689, 'f1': 0.6675503, 'auroc': 0.71472067, 'binary_precision': 0.6532121, 'binary_recall': 0.73938227, 'binary_specificity': 0.59815544, 'binary_f1_score': 0.6936312}
confusion matrix:
     0     1
0  908   610
1  405  1149
---- Validation: 
scalar performance:
{'acc': 0.47619048, 'precision': 0.42188072, 'recall': 0.46976447, 'specificity': 0.46976447, 'f1': 0.37660256, 'auroc': 0.6517421, 'binary_precision': 0.352518, 'binary_recall': 0.07777778, 'binary_specificity': 0.86175114, 'binary_f1_score': 0.12743825}
confusion matrix:
     0   1
0  561  90
1  581  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.5854146, 'recall': 0.54222226, 'specificity': 0.54222226, 'f1': 0.4759751, 'auroc': 0.69888395, 'binary_precision': 0.64615387, 'binary_recall': 0.18666667, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.28965518}
confusion matrix:
     0   1
0  202  23
1  183  42
early stop counter: 2
val acc:0.4761904776096344, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 3,now: 2024-07-20 15:59:11.675816,epoch time: 0:01:24.173293,used: 0:04:22.984799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.70670575, 'precision': 0.7068846, 'recall': 0.7063798, 'specificity': 0.7063798, 'f1': 0.70638835, 'auroc': 0.7666818, 'binary_precision': 0.70340556, 'binary_recall': 0.7291399, 'binary_specificity': 0.68361956, 'binary_f1_score': 0.7160417}
confusion matrix:
      0     1
0  1035   479
1   422  1136
---- Validation: 
scalar performance:
{'acc': 0.48243558, 'precision': 0.43535668, 'recall': 0.47593445, 'specificity': 0.47593445, 'f1': 0.38126174, 'auroc': 0.6653659, 'binary_precision': 0.37593985, 'binary_recall': 0.07936508, 'binary_specificity': 0.8725038, 'binary_f1_score': 0.1310616}
confusion matrix:
     0   1
0  568  83
1  580  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5869733, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.4550069, 'auroc': 0.71589136, 'binary_precision': 0.65384614, 'binary_recall': 0.15111111, 'binary_specificity': 0.92, 'binary_f1_score': 0.24548736}
confusion matrix:
     0   1
0  207  18
1  191  34
early stop counter: 3
val acc:0.48243558406829834, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 4,now: 2024-07-20 16:00:35.450763,epoch time: 0:01:23.774947,used: 0:05:46.759746,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.75065106, 'precision': 0.75072134, 'recall': 0.7507418, 'specificity': 0.7507418, 'f1': 0.7506501, 'auroc': 0.824687, 'binary_precision': 0.75902826, 'binary_recall': 0.7434084, 'binary_specificity': 0.7580752, 'binary_f1_score': 0.75113714}
confusion matrix:
      0     1
0  1150   367
1   399  1156
---- Validation: 
scalar performance:
{'acc': 0.490242, 'precision': 0.45878124, 'recall': 0.48384538, 'specificity': 0.48384538, 'f1': 0.3942236, 'auroc': 0.68224466, 'binary_precision': 0.41843972, 'binary_recall': 0.093650796, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.153048}
confusion matrix:
     0   1
0  569  82
1  571  59
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54, 'precision': 0.59177846, 'recall': 0.53999996, 'specificity': 0.53999996, 'f1': 0.46446744, 'auroc': 0.7344197, 'binary_precision': 0.66071427, 'binary_recall': 0.16444445, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.26334518}
confusion matrix:
     0   1
0  206  19
1  188  37
early stop counter: 4
val acc:0.49024200439453125, best validation acc: 0.49180328845977783, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 5,now: 2024-07-20 16:01:58.117221,epoch time: 0:01:22.666458,used: 0:07:09.426204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7796224, 'precision': 0.77961725, 'recall': 0.77956116, 'specificity': 0.77956116, 'f1': 0.77957916, 'auroc': 0.8575281, 'binary_precision': 0.77991045, 'binary_recall': 0.7854381, 'binary_specificity': 0.7736842, 'binary_f1_score': 0.78266454}
confusion matrix:
      0     1
0  1176   344
1   333  1219
---- Validation: 
scalar performance:
{'acc': 0.50507414, 'precision': 0.49689516, 'recall': 0.49874553, 'specificity': 0.49874553, 'f1': 0.41400325, 'auroc': 0.69927096, 'binary_precision': 0.48630136, 'binary_recall': 0.11269841, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.18298969}
confusion matrix:
     0   1
0  576  75
1  559  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.5935317, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.47564673, 'auroc': 0.7482469, 'binary_precision': 0.66129035, 'binary_recall': 0.18222222, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.2857143}
confusion matrix:
     0   1
0  204  21
1  184  41
better model found
persisted
after epoch: 6,now: 2024-07-20 16:03:22.301016,epoch time: 0:01:24.183795,used: 0:08:33.609999,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8063151, 'precision': 0.80671954, 'recall': 0.80652124, 'specificity': 0.80652124, 'f1': 0.8063023, 'auroc': 0.8771851, 'binary_precision': 0.82116544, 'binary_recall': 0.7889318, 'binary_specificity': 0.8241107, 'binary_f1_score': 0.804726}
confusion matrix:
      0     1
0  1251   267
1   328  1226
---- Validation: 
scalar performance:
{'acc': 0.5058548, 'precision': 0.49845913, 'recall': 0.49941117, 'specificity': 0.49941117, 'f1': 0.41103017, 'auroc': 0.71153784, 'binary_precision': 0.4890511, 'binary_recall': 0.10634921, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.17470664}
confusion matrix:
     0   1
0  581  70
1  563  67
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54888886, 'precision': 0.60288495, 'recall': 0.5488889, 'specificity': 0.5488889, 'f1': 0.4807623, 'auroc': 0.7555753, 'binary_precision': 0.67741936, 'binary_recall': 0.18666667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.29268292}
confusion matrix:
     0   1
0  205  20
1  183  42
better model found
persisted
after epoch: 7,now: 2024-07-20 16:04:46.444441,epoch time: 0:01:24.143425,used: 0:09:57.753424,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.82096356, 'precision': 0.8216907, 'recall': 0.82122266, 'specificity': 0.82122266, 'f1': 0.8209268, 'auroc': 0.8885993, 'binary_precision': 0.84, 'binary_recall': 0.7978107, 'binary_specificity': 0.84463465, 'binary_f1_score': 0.81836194}
confusion matrix:
      0     1
0  1283   236
1   314  1239
---- Validation: 
scalar performance:
{'acc': 0.5175644, 'precision': 0.5268009, 'recall': 0.5113415, 'specificity': 0.5113415, 'f1': 0.43207657, 'auroc': 0.7249458, 'binary_precision': 0.53896105, 'binary_recall': 0.13174604, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.2117347}
confusion matrix:
     0   1
0  580  71
1  547  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6275097, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.49795842, 'auroc': 0.7678815, 'binary_precision': 0.71875, 'binary_recall': 0.20444444, 'binary_specificity': 0.92, 'binary_f1_score': 0.31833908}
confusion matrix:
     0   1
0  207  18
1  179  46
better model found
persisted
after epoch: 8,now: 2024-07-20 16:06:10.263517,epoch time: 0:01:23.819076,used: 0:11:21.572500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.84440106, 'precision': 0.84573394, 'recall': 0.844807, 'specificity': 0.844807, 'f1': 0.8443376, 'auroc': 0.9116485, 'binary_precision': 0.8707015, 'binary_recall': 0.8136247, 'binary_specificity': 0.87598944, 'binary_f1_score': 0.841196}
confusion matrix:
      0     1
0  1328   188
1   290  1266
---- Validation: 
scalar performance:
{'acc': 0.52459013, 'precision': 0.5427811, 'recall': 0.5184076, 'specificity': 0.5184076, 'f1': 0.4415384, 'auroc': 0.7346573, 'binary_precision': 0.566879, 'binary_recall': 0.14126985, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.22617535}
confusion matrix:
     0   1
0  583  68
1  541  89
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.62159127, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.49099362, 'auroc': 0.7756642, 'binary_precision': 0.7096774, 'binary_recall': 0.19555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.30662018}
confusion matrix:
     0   1
0  207  18
1  181  44
better model found
persisted
after epoch: 9,now: 2024-07-20 16:07:34.867621,epoch time: 0:01:24.604104,used: 0:12:46.176604,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8541667, 'precision': 0.85680217, 'recall': 0.85467315, 'specificity': 0.85467315, 'f1': 0.8540057, 'auroc': 0.91749245, 'binary_precision': 0.8905367, 'binary_recall': 0.8114543, 'binary_specificity': 0.89789194, 'binary_f1_score': 0.8491582}
confusion matrix:
      0     1
0  1363   155
1   293  1261
---- Validation: 
scalar performance:
{'acc': 0.520687, 'precision': 0.53484523, 'recall': 0.5144137, 'specificity': 0.5144137, 'f1': 0.43413195, 'auroc': 0.74328387, 'binary_precision': 0.55333334, 'binary_recall': 0.13174604, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.21282052}
confusion matrix:
     0   1
0  584  67
1  547  83
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.6187544, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.48199135, 'auroc': 0.78534317, 'binary_precision': 0.70689654, 'binary_recall': 0.18222222, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.28975263}
confusion matrix:
     0   1
0  208  17
1  184  41
early stop counter: 1
val acc:0.5206869840621948, best validation acc: 0.5245901346206665, corresponding to test acc:                         0.5577777624130249 / 0.5711110830307007
after epoch: 10,now: 2024-07-20 16:08:58.659900,epoch time: 0:01:23.792279,used: 0:14:09.968883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.85253906, 'precision': 0.8556098, 'recall': 0.8531166, 'specificity': 0.8531166, 'f1': 0.8523463, 'auroc': 0.91634274, 'binary_precision': 0.8918919, 'binary_recall': 0.8064309, 'binary_specificity': 0.89980227, 'binary_f1_score': 0.8470112}
confusion matrix:
      0     1
0  1365   152
1   301  1254
---- Validation: 
scalar performance:
{'acc': 0.5277127, 'precision': 0.54862976, 'recall': 0.5216078, 'specificity': 0.5216078, 'f1': 0.44753665, 'auroc': 0.75084245, 'binary_precision': 0.5766871, 'binary_recall': 0.14920636, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.2370744}
confusion matrix:
     0   1
0  582  69
1  536  94
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.63661754, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.5030553, 'auroc': 0.79480493, 'binary_precision': 0.734375, 'binary_recall': 0.20888889, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.3252595}
confusion matrix:
     0   1
0  208  17
1  178  47
better model found
persisted
after epoch: 11,now: 2024-07-20 16:10:22.116981,epoch time: 0:01:23.457081,used: 0:15:33.425964,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8639323, 'precision': 0.86704063, 'recall': 0.86450756, 'specificity': 0.86450756, 'f1': 0.86375767, 'auroc': 0.9294567, 'binary_precision': 0.9040512, 'binary_recall': 0.81800646, 'binary_specificity': 0.9110086, 'binary_f1_score': 0.8588792}
confusion matrix:
      0     1
0  1382   135
1   283  1272
---- Validation: 
scalar performance:
{'acc': 0.540203, 'precision': 0.5745897, 'recall': 0.5341782, 'specificity': 0.5341782, 'f1': 0.46436948, 'auroc': 0.75791574, 'binary_precision': 0.6213018, 'binary_recall': 0.16666667, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.26282853}
confusion matrix:
     0    1
0  587   64
1  525  105
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.80244935, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
better model found
persisted
after epoch: 12,now: 2024-07-20 16:11:46.299843,epoch time: 0:01:24.182862,used: 0:16:57.608826,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87402344, 'precision': 0.87794465, 'recall': 0.874628, 'specificity': 0.874628, 'f1': 0.8738078, 'auroc': 0.9329725, 'binary_precision': 0.9194824, 'binary_recall': 0.8230373, 'binary_specificity': 0.9262187, 'binary_f1_score': 0.86859083}
confusion matrix:
      0     1
0  1406   112
1   275  1279
---- Validation: 
scalar performance:
{'acc': 0.54722875, 'precision': 0.5814035, 'recall': 0.5415003, 'specificity': 0.5415003, 'f1': 0.48053527, 'auroc': 0.763536, 'binary_precision': 0.6302083, 'binary_recall': 0.1920635, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.29440388}
confusion matrix:
     0    1
0  580   71
1  509  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6385895, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.5116699, 'auroc': 0.8058667, 'binary_precision': 0.7352941, 'binary_recall': 0.22222222, 'binary_specificity': 0.92, 'binary_f1_score': 0.34129694}
confusion matrix:
     0   1
0  207  18
1  175  50
better model found
persisted
after epoch: 13,now: 2024-07-20 16:13:10.505934,epoch time: 0:01:24.206091,used: 0:18:21.814917,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8697917, 'precision': 0.87478083, 'recall': 0.8705127, 'specificity': 0.8705127, 'f1': 0.86949694, 'auroc': 0.9363208, 'binary_precision': 0.92122537, 'binary_recall': 0.81221867, 'binary_specificity': 0.92880684, 'binary_f1_score': 0.8632946}
confusion matrix:
      0     1
0  1409   108
1   292  1263
---- Validation: 
scalar performance:
{'acc': 0.5495706, 'precision': 0.58776605, 'recall': 0.54377884, 'specificity': 0.54377884, 'f1': 0.48154935, 'auroc': 0.7673079, 'binary_precision': 0.64171124, 'binary_recall': 0.1904762, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.29375768}
confusion matrix:
     0    1
0  584   67
1  510  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.8073679, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
better model found
persisted
after epoch: 14,now: 2024-07-20 16:14:34.943379,epoch time: 0:01:24.437445,used: 0:19:46.252362,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8808594, 'precision': 0.8841067, 'recall': 0.8814077, 'specificity': 0.8814077, 'f1': 0.8807008, 'auroc': 0.9401655, 'binary_precision': 0.9224751, 'binary_recall': 0.83462036, 'binary_specificity': 0.928195, 'binary_f1_score': 0.87635136}
confusion matrix:
      0     1
0  1409   109
1   257  1297
---- Validation: 
scalar performance:
{'acc': 0.5542545, 'precision': 0.600551, 'recall': 0.5483615, 'specificity': 0.5483615, 'f1': 0.4842315, 'auroc': 0.7715919, 'binary_precision': 0.66480446, 'binary_recall': 0.18888889, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.29419035}
confusion matrix:
     0    1
0  591   60
1  511  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5777778, 'precision': 0.653443, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.5184075, 'auroc': 0.81244445, 'binary_precision': 0.76119405, 'binary_recall': 0.22666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.34931508}
confusion matrix:
     0   1
0  209  16
1  174  51
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 16:15:58.985874,epoch time: 0:01:24.042495,used: 0:21:10.294857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.88997394, 'precision': 0.8937583, 'recall': 0.8905934, 'specificity': 0.8905934, 'f1': 0.88980585, 'auroc': 0.9476255, 'binary_precision': 0.93557626, 'binary_recall': 0.8405145, 'binary_specificity': 0.9406724, 'binary_f1_score': 0.8855014}
confusion matrix:
      0     1
0  1427    90
1   248  1307
---- Validation: 
scalar performance:
{'acc': 0.56128025, 'precision': 0.6098678, 'recall': 0.55552995, 'specificity': 0.55552995, 'f1': 0.49600822, 'auroc': 0.7768708, 'binary_precision': 0.6789474, 'binary_recall': 0.20476191, 'binary_specificity': 0.906298, 'binary_f1_score': 0.31463414}
confusion matrix:
     0    1
0  590   61
1  501  129
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.64880955, 'recall': 0.58, 'specificity': 0.58, 'f1': 0.5251017, 'auroc': 0.8188247, 'binary_precision': 0.75, 'binary_recall': 0.24, 'binary_specificity': 0.92, 'binary_f1_score': 0.36363634}
confusion matrix:
     0   1
0  207  18
1  171  54
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 16:17:23.801882,epoch time: 0:01:24.816008,used: 0:22:35.110865,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8929036, 'precision': 0.898198, 'recall': 0.8936697, 'specificity': 0.8936697, 'f1': 0.89266455, 'auroc': 0.9458344, 'binary_precision': 0.9474836, 'binary_recall': 0.8348329, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.8875982}
confusion matrix:
      0     1
0  1444    72
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.56128025, 'precision': 0.6126739, 'recall': 0.5554532, 'specificity': 0.5554532, 'f1': 0.49403602, 'auroc': 0.77916515, 'binary_precision': 0.6847826, 'binary_recall': 0.2, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.30958232}
confusion matrix:
     0    1
0  593   58
1  504  126
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.6559131, 'recall': 0.58000004, 'specificity': 0.58000004, 'f1': 0.5217907, 'auroc': 0.82058275, 'binary_precision': 0.7647059, 'binary_recall': 0.23111111, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.35494882}
confusion matrix:
     0   1
0  209  16
1  173  52
early stop counter: 1
val acc:0.5612802505493164, best validation acc: 0.5612802505493164, corresponding to test acc:                         0.5799999833106995 / 0.5799999833106995
after epoch: 17,now: 2024-07-20 16:18:47.017162,epoch time: 0:01:23.215280,used: 0:23:58.326145,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8951823, 'precision': 0.8988066, 'recall': 0.89578646, 'specificity': 0.89578646, 'f1': 0.8950326, 'auroc': 0.95101434, 'binary_precision': 0.94004285, 'binary_recall': 0.84694535, 'binary_specificity': 0.9446276, 'binary_f1_score': 0.891069}
confusion matrix:
      0     1
0  1433    84
1   238  1317
---- Validation: 
scalar performance:
{'acc': 0.5761124, 'precision': 0.62925357, 'recall': 0.57060933, 'specificity': 0.57060933, 'f1': 0.5188265, 'auroc': 0.7827079, 'binary_precision': 0.708134, 'binary_recall': 0.23492064, 'binary_specificity': 0.906298, 'binary_f1_score': 0.35280094}
confusion matrix:
     0    1
0  590   61
1  482  148
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.6628412, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.54475343, 'auroc': 0.8260741, 'binary_precision': 0.7692308, 'binary_recall': 0.26666668, 'binary_specificity': 0.92, 'binary_f1_score': 0.3960396}
confusion matrix:
     0   1
0  207  18
1  165  60
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 16:20:11.989670,epoch time: 0:01:24.972508,used: 0:25:23.298653,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9029948, 'precision': 0.90815294, 'recall': 0.90366817, 'specificity': 0.90366817, 'f1': 0.9027812, 'auroc': 0.9463737, 'binary_precision': 0.9570597, 'binary_recall': 0.8462033, 'binary_specificity': 0.96113306, 'binary_f1_score': 0.89822406}
confusion matrix:
      0     1
0  1459    59
1   239  1315
---- Validation: 
scalar performance:
{'acc': 0.56518346, 'precision': 0.61710936, 'recall': 0.559447, 'specificity': 0.559447, 'f1': 0.50081396, 'auroc': 0.7840075, 'binary_precision': 0.69109946, 'binary_recall': 0.20952381, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.32155907}
confusion matrix:
     0    1
0  592   59
1  498  132
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5888889, 'precision': 0.6691729, 'recall': 0.5888889, 'specificity': 0.5888889, 'f1': 0.5335481, 'auroc': 0.8279309, 'binary_precision': 0.78571427, 'binary_recall': 0.24444444, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.37288135}
confusion matrix:
     0   1
0  210  15
1  170  55
early stop counter: 1
val acc:0.5651834607124329, best validation acc: 0.5761123895645142, corresponding to test acc:                         0.5933333039283752 / 0.5933333039283752
after epoch: 19,now: 2024-07-20 16:21:36.191091,epoch time: 0:01:24.201421,used: 0:26:47.500074,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8935547, 'precision': 0.8987859, 'recall': 0.89423823, 'specificity': 0.89423823, 'f1': 0.89331037, 'auroc': 0.94974613, 'binary_precision': 0.9474836, 'binary_recall': 0.83590734, 'binary_specificity': 0.9525692, 'binary_f1_score': 0.8882051}
confusion matrix:
      0     1
0  1446    72
1   255  1299
---- Validation: 
scalar performance:
{'acc': 0.5800156, 'precision': 0.63395274, 'recall': 0.57457757, 'specificity': 0.57457757, 'f1': 0.5247022, 'auroc': 0.78655547, 'binary_precision': 0.71495324, 'binary_recall': 0.24285714, 'binary_specificity': 0.906298, 'binary_f1_score': 0.36255923}
confusion matrix:
     0    1
0  590   61
1  477  153
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.6735826, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.56070113, 'auroc': 0.8329481, 'binary_precision': 0.78313255, 'binary_recall': 0.2888889, 'binary_specificity': 0.92, 'binary_f1_score': 0.42207795}
confusion matrix:
     0   1
0  207  18
1  160  65
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 16:23:00.985723,epoch time: 0:01:24.794632,used: 0:28:12.294706,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.88964844, 'precision': 0.89573145, 'recall': 0.89034474, 'specificity': 0.89034474, 'f1': 0.8893369, 'auroc': 0.9523922, 'binary_precision': 0.9476401, 'binary_recall': 0.8274308, 'binary_specificity': 0.9532587, 'binary_f1_score': 0.8834651}
confusion matrix:
      0     1
0  1448    71
1   268  1285
---- Validation: 
scalar performance:
{'acc': 0.59406716, 'precision': 0.6478651, 'recall': 0.5889145, 'specificity': 0.5889145, 'f1': 0.5464672, 'auroc': 0.7901275, 'binary_precision': 0.7330508, 'binary_recall': 0.2746032, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.39953813}
confusion matrix:
     0    1
0  588   63
1  457  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6288889, 'precision': 0.6949856, 'recall': 0.6288889, 'specificity': 0.6288889, 'f1': 0.59452677, 'auroc': 0.8354173, 'binary_precision': 0.80851066, 'binary_recall': 0.33777776, 'binary_specificity': 0.92, 'binary_f1_score': 0.47648904}
confusion matrix:
     0   1
0  207  18
1  149  76
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 16:24:25.619739,epoch time: 0:01:24.634016,used: 0:29:36.928722,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90755206, 'precision': 0.91133034, 'recall': 0.90822923, 'specificity': 0.90822923, 'f1': 0.9074246, 'auroc': 0.9580276, 'binary_precision': 0.95431834, 'binary_recall': 0.85870266, 'binary_specificity': 0.9577558, 'binary_f1_score': 0.90398926}
confusion matrix:
      0     1
0  1451    64
1   220  1337
---- Validation: 
scalar performance:
{'acc': 0.6010929, 'precision': 0.6570978, 'recall': 0.59600616, 'specificity': 0.59600616, 'f1': 0.555565, 'auroc': 0.7932899, 'binary_precision': 0.746888, 'binary_recall': 0.2857143, 'binary_specificity': 0.906298, 'binary_f1_score': 0.41331804}
confusion matrix:
     0    1
0  590   61
1  450  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.69681245, 'recall': 0.63111115, 'specificity': 0.63111115, 'f1': 0.59752154, 'auroc': 0.83717537, 'binary_precision': 0.8105263, 'binary_recall': 0.3422222, 'binary_specificity': 0.92, 'binary_f1_score': 0.48124996}
confusion matrix:
     0   1
0  207  18
1  148  77
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 16:25:50.159176,epoch time: 0:01:24.539437,used: 0:31:01.468159,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.89420575, 'precision': 0.9002712, 'recall': 0.8950229, 'specificity': 0.8950229, 'f1': 0.89392865, 'auroc': 0.951061, 'binary_precision': 0.95290655, 'binary_recall': 0.8322622, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.8885077}
confusion matrix:
      0     1
0  1452    64
1   261  1295
---- Validation: 
scalar performance:
{'acc': 0.6088993, 'precision': 0.6612102, 'recall': 0.6040451, 'specificity': 0.6040451, 'f1': 0.56849176, 'auroc': 0.795855, 'binary_precision': 0.74903476, 'binary_recall': 0.30793652, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.43644544}
confusion matrix:
     0    1
0  586   65
1  436  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511111, 'precision': 0.7125945, 'recall': 0.6511111, 'specificity': 0.6511111, 'f1': 0.62392, 'auroc': 0.8402766, 'binary_precision': 0.8269231, 'binary_recall': 0.38222224, 'binary_specificity': 0.92, 'binary_f1_score': 0.52279633}
confusion matrix:
     0   1
0  207  18
1  139  86
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 16:27:13.451188,epoch time: 0:01:23.292012,used: 0:32:24.760171,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90722656, 'precision': 0.9130709, 'recall': 0.9080205, 'specificity': 0.9080205, 'f1': 0.90700185, 'auroc': 0.9589959, 'binary_precision': 0.96556777, 'binary_recall': 0.8470437, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.90243065}
confusion matrix:
      0     1
0  1469    47
1   238  1318
---- Validation: 
scalar performance:
{'acc': 0.61514443, 'precision': 0.6690297, 'recall': 0.61034304, 'specificity': 0.61034304, 'f1': 0.57627094, 'auroc': 0.79979026, 'binary_precision': 0.76045626, 'binary_recall': 0.31746033, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.44792834}
confusion matrix:
     0    1
0  588   63
1  430  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.71428573, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.62679434, 'auroc': 0.84379256, 'binary_precision': 0.82857144, 'binary_recall': 0.38666666, 'binary_specificity': 0.92, 'binary_f1_score': 0.52727276}
confusion matrix:
     0   1
0  207  18
1  138  87
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 16:28:38.242938,epoch time: 0:01:24.791750,used: 0:33:49.551921,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90527344, 'precision': 0.90946513, 'recall': 0.90605664, 'specificity': 0.90605664, 'f1': 0.9051311, 'auroc': 0.95783556, 'binary_precision': 0.9548063, 'binary_recall': 0.85375243, 'binary_specificity': 0.95836085, 'binary_f1_score': 0.9014562}
confusion matrix:
      0     1
0  1450    63
1   228  1331
---- Validation: 
scalar performance:
{'acc': 0.6362217, 'precision': 0.68463373, 'recall': 0.6318741, 'specificity': 0.6318741, 'f1': 0.60632753, 'auroc': 0.8040646, 'binary_precision': 0.77516776, 'binary_recall': 0.36666667, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.4978448}
confusion matrix:
     0    1
0  584   67
1  399  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6844444, 'precision': 0.73215485, 'recall': 0.6844444, 'specificity': 0.6844444, 'f1': 0.6673538, 'auroc': 0.8487704, 'binary_precision': 0.83739835, 'binary_recall': 0.45777777, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.591954}
confusion matrix:
     0    1
0  205   20
1  122  103
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 16:30:02.966168,epoch time: 0:01:24.723230,used: 0:35:14.275151,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.91573167, 'recall': 0.9112339, 'specificity': 0.9112339, 'f1': 0.91029274, 'auroc': 0.9640319, 'binary_precision': 0.96581817, 'binary_recall': 0.85347044, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.9061754}
confusion matrix:
      0     1
0  1469    47
1   228  1328
---- Validation: 
scalar performance:
{'acc': 0.6299766, 'precision': 0.68259215, 'recall': 0.6254224, 'specificity': 0.6254224, 'f1': 0.59649515, 'auroc': 0.8057177, 'binary_precision': 0.7765958, 'binary_recall': 0.34761906, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.4802631}
confusion matrix:
     0    1
0  588   63
1  411  219
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7242286, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.64380705, 'auroc': 0.8495407, 'binary_precision': 0.8378378, 'binary_recall': 0.41333333, 'binary_specificity': 0.92, 'binary_f1_score': 0.55357146}
confusion matrix:
     0   1
0  207  18
1  132  93
early stop counter: 1
val acc:0.6299765706062317, best validation acc: 0.636221706867218, corresponding to test acc:                         0.6844444274902344 / 0.6844444274902344
after epoch: 26,now: 2024-07-20 16:31:26.868692,epoch time: 0:01:23.902524,used: 0:36:38.177675,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9042969, 'precision': 0.90809506, 'recall': 0.9049105, 'specificity': 0.9049105, 'f1': 0.9041555, 'auroc': 0.9594716, 'binary_precision': 0.95067906, 'binary_recall': 0.8553055, 'binary_specificity': 0.9545155, 'binary_f1_score': 0.90047395}
confusion matrix:
      0     1
0  1448    69
1   225  1330
---- Validation: 
scalar performance:
{'acc': 0.64090556, 'precision': 0.6886767, 'recall': 0.63663596, 'specificity': 0.63663596, 'f1': 0.6124697, 'auroc': 0.80813277, 'binary_precision': 0.77960527, 'binary_recall': 0.37619048, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.5074946}
confusion matrix:
     0    1
0  584   67
1  393  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6933333, 'precision': 0.743343, 'recall': 0.6933333, 'specificity': 0.6933333, 'f1': 0.67672414, 'auroc': 0.85123956, 'binary_precision': 0.85365856, 'binary_recall': 0.46666667, 'binary_specificity': 0.92, 'binary_f1_score': 0.6034483}
confusion matrix:
     0    1
0  207   18
1  120  105
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 16:32:51.192000,epoch time: 0:01:24.323308,used: 0:38:02.500983,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.9192587, 'recall': 0.9153771, 'specificity': 0.9153771, 'f1': 0.91456056, 'auroc': 0.96535385, 'binary_precision': 0.9661139, 'binary_recall': 0.86173636, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.91094494}
confusion matrix:
      0     1
0  1470    47
1   215  1340
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.69382334, 'recall': 0.64380443, 'specificity': 0.64380443, 'f1': 0.62191993, 'auroc': 0.81133056, 'binary_precision': 0.784127, 'binary_recall': 0.3920635, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.52275133}
confusion matrix:
     0    1
0  583   68
1  383  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.74250436, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.680071, 'auroc': 0.8552494, 'binary_precision': 0.8492063, 'binary_recall': 0.47555557, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.6096866}
confusion matrix:
     0    1
0  206   19
1  118  107
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 16:34:15.479977,epoch time: 0:01:24.287977,used: 0:39:26.788960,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9117839, 'precision': 0.9167235, 'recall': 0.91262704, 'specificity': 0.91262704, 'f1': 0.9116232, 'auroc': 0.9644395, 'binary_precision': 0.9659913, 'binary_recall': 0.8563182, 'binary_specificity': 0.9689359, 'binary_f1_score': 0.9078545}
confusion matrix:
      0     1
0  1466    47
1   224  1335
---- Validation: 
scalar performance:
{'acc': 0.6479313, 'precision': 0.6954371, 'recall': 0.6437532, 'specificity': 0.6437532, 'f1': 0.6212497, 'auroc': 0.8127667, 'binary_precision': 0.78778136, 'binary_recall': 0.3888889, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.52072257}
confusion matrix:
     0    1
0  585   66
1  385  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.7495673, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6873963, 'auroc': 0.8562567, 'binary_precision': 0.8582677, 'binary_recall': 0.48444444, 'binary_specificity': 0.92, 'binary_f1_score': 0.6193182}
confusion matrix:
     0    1
0  207   18
1  116  109
new oracle model saved
early stop counter: 1
val acc:0.6479312777519226, best validation acc: 0.6479312777519226, corresponding to test acc:                         0.695555567741394 / 0.7022222280502319
after epoch: 29,now: 2024-07-20 16:35:39.326313,epoch time: 0:01:23.846336,used: 0:40:50.635296,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9114583, 'precision': 0.9167386, 'recall': 0.912096, 'specificity': 0.912096, 'f1': 0.91125786, 'auroc': 0.96618664, 'binary_precision': 0.9664967, 'binary_recall': 0.8544752, 'binary_specificity': 0.9697169, 'binary_f1_score': 0.90704024}
confusion matrix:
      0     1
0  1473    46
1   226  1327
---- Validation: 
scalar performance:
{'acc': 0.6502732, 'precision': 0.6982069, 'recall': 0.64610857, 'specificity': 0.64610857, 'f1': 0.62393653, 'auroc': 0.81316173, 'binary_precision': 0.7916667, 'binary_recall': 0.3920635, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.5244162}
confusion matrix:
     0    1
0  586   65
1  383  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69555557, 'precision': 0.74490404, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.67940557, 'auroc': 0.8570864, 'binary_precision': 0.8548387, 'binary_recall': 0.47111112, 'binary_specificity': 0.92, 'binary_f1_score': 0.6074498}
confusion matrix:
     0    1
0  207   18
1  119  106
better model found
persisted
after epoch: 30,now: 2024-07-20 16:37:03.575187,epoch time: 0:01:24.248874,used: 0:42:14.884170,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_54_48_seed_1_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:42:14.884170 at 2024-07-20 16:37:03.575187
persisted model performance metric: 

scalar performance:
{'acc': 0.69555557, 'precision': 0.74490404, 'recall': 0.69555557, 'specificity': 0.69555557, 'f1': 0.67940557, 'auroc': 0.8570864, 'binary_precision': 0.8548387, 'binary_recall': 0.47111112, 'binary_specificity': 0.92, 'binary_f1_score': 0.6074498}
confusion matrix:
     0    1
0  207   18
1  119  106
oracle model performance metric: 

scalar performance:
{'acc': 0.7022222, 'precision': 0.7495673, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6873963, 'auroc': 0.8562567, 'binary_precision': 0.8582677, 'binary_recall': 0.48444444, 'binary_specificity': 0.92, 'binary_f1_score': 0.6193182}
confusion matrix:
     0    1
0  207   18
1  116  109
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124076 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124076 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8524 MiB |  16788 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     42 MiB |     42 MiB |     56 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |   8174 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20972 K  |   20971 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9573 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20972 K  |   20971 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9573 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     369    |     714    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      21    |      21    |      28    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     381    |   12510 K  |   12510 K  |
|       from large pool |      11    |     351    |    8266 K  |    8266 K  |
|       from small pool |      31    |     215    |    4244 K  |    4244 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   12510 K  |   12510 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     215    |    4244 K  |    4244 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   12510 K  |   12510 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     215    |    4244 K  |    4244 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816

 Experiment start at: 2024-07-20 16:38:38.774137
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.57918847, 'precision': 0.5943759, 'recall': 0.5806891, 'specificity': 0.5806891, 'f1': 0.56402117, 'auroc': 0.6434727, 'binary_precision': 0.63424945, 'binary_recall': 0.38961038, 'binary_specificity': 0.7717678, 'binary_f1_score': 0.48270312}
confusion matrix:
      0    1
0  1170  346
1   940  600
---- Validation: 
scalar performance:
{'acc': 0.6486698, 'precision': 0.65690947, 'recall': 0.6451087, 'specificity': 0.6451087, 'f1': 0.64047027, 'auroc': 0.6696754, 'binary_precision': 0.68682504, 'binary_recall': 0.511254, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.5861751}
confusion matrix:
     0    1
0  511  145
1  304  318
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36574075, 'precision': 0.34439588, 'recall': 0.36574072, 'specificity': 0.36574072, 'f1': 0.3432173, 'auroc': 0.30855626, 'binary_precision': 0.2867647, 'binary_recall': 0.18055555, 'binary_specificity': 0.5509259, 'binary_f1_score': 0.2215909}
confusion matrix:
     0   1
0  119  97
1  177  39
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 16:40:11.955280,epoch time: 0:01:33.181143,used: 0:01:33.181143,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.64267015, 'precision': 0.64300615, 'recall': 0.64282286, 'specificity': 0.64282286, 'f1': 0.64259607, 'auroc': 0.705397, 'binary_precision': 0.65217394, 'binary_recall': 0.6233766, 'binary_specificity': 0.6622691, 'binary_f1_score': 0.6374502}
confusion matrix:
      0    1
0  1004  512
1   580  960
---- Validation: 
scalar performance:
{'acc': 0.6619718, 'precision': 0.6620749, 'recall': 0.66089916, 'specificity': 0.66089916, 'f1': 0.6608348, 'auroc': 0.69055617, 'binary_precision': 0.66323024, 'binary_recall': 0.62057877, 'binary_specificity': 0.7012195, 'binary_f1_score': 0.6411961}
confusion matrix:
     0    1
0  460  196
1  236  386
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3888889, 'precision': 0.3881119, 'recall': 0.3888889, 'specificity': 0.3888889, 'f1': 0.38782609, 'auroc': 0.33995628, 'binary_precision': 0.37878788, 'binary_recall': 0.3472222, 'binary_specificity': 0.43055555, 'binary_f1_score': 0.36231884}
confusion matrix:
     0    1
0   93  123
1  141   75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 16:41:34.867763,epoch time: 0:01:22.912483,used: 0:02:56.093626,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.690445, 'precision': 0.69071627, 'recall': 0.6905699, 'specificity': 0.6905699, 'f1': 0.6904111, 'auroc': 0.76566327, 'binary_precision': 0.70013475, 'binary_recall': 0.67467535, 'binary_specificity': 0.70646435, 'binary_f1_score': 0.6871693}
confusion matrix:
      0     1
0  1071   445
1   501  1039
---- Validation: 
scalar performance:
{'acc': 0.6729264, 'precision': 0.6736734, 'recall': 0.6715282, 'specificity': 0.6715282, 'f1': 0.67129624, 'auroc': 0.70404774, 'binary_precision': 0.680212, 'binary_recall': 0.61897105, 'binary_specificity': 0.7240854, 'binary_f1_score': 0.6481481}
confusion matrix:
     0    1
0  475  181
1  237  385
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4537037, 'precision': 0.45337996, 'recall': 0.4537037, 'specificity': 0.4537037, 'f1': 0.45275366, 'auroc': 0.37523577, 'binary_precision': 0.44949496, 'binary_recall': 0.41203704, 'binary_specificity': 0.49537036, 'binary_f1_score': 0.42995173}
confusion matrix:
     0    1
0  107  109
1  127   89
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 16:42:56.175135,epoch time: 0:01:21.307372,used: 0:04:17.400998,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.75065446, 'precision': 0.7509756, 'recall': 0.75078297, 'specificity': 0.75078297, 'f1': 0.7506271, 'auroc': 0.8277075, 'binary_precision': 0.76212937, 'binary_recall': 0.7344156, 'binary_specificity': 0.7671504, 'binary_f1_score': 0.7480159}
confusion matrix:
      0     1
0  1163   353
1   409  1131
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.68455744, 'recall': 0.67941236, 'specificity': 0.67941236, 'f1': 0.67845756, 'auroc': 0.7154709, 'binary_precision': 0.7024482, 'binary_recall': 0.59967846, 'binary_specificity': 0.75914633, 'binary_f1_score': 0.64700776}
confusion matrix:
     0    1
0  498  158
1  249  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.4646404, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.46285722, 'auroc': 0.41250855, 'binary_precision': 0.45989305, 'binary_recall': 0.39814815, 'binary_specificity': 0.5324074, 'binary_f1_score': 0.42679903}
confusion matrix:
     0    1
0  115  101
1  130   86
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 16:44:18.863994,epoch time: 0:01:22.688859,used: 0:05:40.089857,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.78599477, 'precision': 0.78694296, 'recall': 0.78621286, 'specificity': 0.78621286, 'f1': 0.7858949, 'auroc': 0.8562738, 'binary_precision': 0.80551726, 'binary_recall': 0.75844157, 'binary_specificity': 0.81398416, 'binary_f1_score': 0.78127086}
confusion matrix:
      0     1
0  1234   282
1   372  1168
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.68696606, 'recall': 0.6788708, 'specificity': 0.6788708, 'f1': 0.67702484, 'auroc': 0.7230413, 'binary_precision': 0.7128713, 'binary_recall': 0.57877815, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.6388643}
confusion matrix:
     0    1
0  511  145
1  262  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4837963, 'precision': 0.48325026, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.4795546, 'auroc': 0.44373715, 'binary_precision': 0.48022598, 'binary_recall': 0.3935185, 'binary_specificity': 0.5740741, 'binary_f1_score': 0.43256995}
confusion matrix:
     0   1
0  124  92
1  131  85
new oracle model saved
early stop counter: 1
val acc:0.6815336346626282, best validation acc: 0.6815336346626282, corresponding to test acc:                         0.4652777910232544 / 0.48379629850387573
after epoch: 5,now: 2024-07-20 16:45:41.916974,epoch time: 0:01:23.052980,used: 0:07:03.142837,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8046466, 'precision': 0.8061296, 'recall': 0.80491465, 'specificity': 0.80491465, 'f1': 0.80449533, 'auroc': 0.8798791, 'binary_precision': 0.8294899, 'binary_recall': 0.7707792, 'binary_specificity': 0.8390501, 'binary_f1_score': 0.7990576}
confusion matrix:
      0     1
0  1272   244
1   353  1187
---- Validation: 
scalar performance:
{'acc': 0.68935835, 'precision': 0.6968366, 'recall': 0.6864094, 'specificity': 0.6864094, 'f1': 0.6840925, 'auroc': 0.7309941, 'binary_precision': 0.72912425, 'binary_recall': 0.5755627, 'binary_specificity': 0.7972561, 'binary_f1_score': 0.6433064}
confusion matrix:
     0    1
0  523  133
1  264  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4861111, 'precision': 0.48538962, 'recall': 0.4861111, 'specificity': 0.4861111, 'f1': 0.47968748, 'auroc': 0.47142917, 'binary_precision': 0.48214287, 'binary_recall': 0.375, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.421875}
confusion matrix:
     0   1
0  129  87
1  135  81
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 16:47:04.704336,epoch time: 0:01:22.787362,used: 0:08:25.930199,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.81904453, 'precision': 0.82109094, 'recall': 0.8193546, 'specificity': 0.8193546, 'f1': 0.81884664, 'auroc': 0.89694595, 'binary_precision': 0.8487632, 'binary_recall': 0.77987015, 'binary_specificity': 0.85883904, 'binary_f1_score': 0.8128596}
confusion matrix:
      0     1
0  1302   214
1   339  1201
---- Validation: 
scalar performance:
{'acc': 0.68388104, 'precision': 0.6948525, 'recall': 0.68036574, 'specificity': 0.68036574, 'f1': 0.6765814, 'auroc': 0.7348492, 'binary_precision': 0.73491377, 'binary_recall': 0.5482315, 'binary_specificity': 0.8125, 'binary_f1_score': 0.62799263}
confusion matrix:
     0    1
0  533  123
1  281  341
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49305555, 'precision': 0.49253577, 'recall': 0.49305555, 'specificity': 0.49305555, 'f1': 0.48407358, 'auroc': 0.49204817, 'binary_precision': 0.49056605, 'binary_recall': 0.3611111, 'binary_specificity': 0.625, 'binary_f1_score': 0.41599998}
confusion matrix:
     0   1
0  135  81
1  138  78
new oracle model saved
early stop counter: 1
val acc:0.6838810443878174, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.4930555522441864
after epoch: 7,now: 2024-07-20 16:48:26.946249,epoch time: 0:01:22.241913,used: 0:09:48.172112,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8429319, 'precision': 0.844417, 'recall': 0.84318954, 'specificity': 0.84318954, 'f1': 0.8428242, 'auroc': 0.91300416, 'binary_precision': 0.8690808, 'binary_recall': 0.81038964, 'binary_specificity': 0.87598944, 'binary_f1_score': 0.8387097}
confusion matrix:
      0     1
0  1328   188
1   292  1248
---- Validation: 
scalar performance:
{'acc': 0.6823161, 'precision': 0.6973096, 'recall': 0.6782997, 'specificity': 0.6782997, 'f1': 0.67297447, 'auroc': 0.7369398, 'binary_precision': 0.74545455, 'binary_recall': 0.5273312, 'binary_specificity': 0.8292683, 'binary_f1_score': 0.6177025}
confusion matrix:
     0    1
0  544  112
1  294  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4976852, 'precision': 0.49743876, 'recall': 0.4976852, 'specificity': 0.4976852, 'f1': 0.4853049, 'auroc': 0.5123028, 'binary_precision': 0.4966443, 'binary_recall': 0.3425926, 'binary_specificity': 0.6527778, 'binary_f1_score': 0.40547946}
confusion matrix:
     0   1
0  141  75
1  142  74
new oracle model saved
early stop counter: 2
val acc:0.6823161244392395, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.49768519401550293
after epoch: 8,now: 2024-07-20 16:49:49.627804,epoch time: 0:01:22.681555,used: 0:11:10.853667,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.85831153, 'precision': 0.86028266, 'recall': 0.8586035, 'specificity': 0.8586035, 'f1': 0.85818017, 'auroc': 0.9231316, 'binary_precision': 0.888967, 'binary_recall': 0.8214286, 'binary_specificity': 0.89577836, 'binary_f1_score': 0.8538643}
confusion matrix:
      0     1
0  1358   158
1   275  1265
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.7001208, 'recall': 0.67454267, 'specificity': 0.67454267, 'f1': 0.6668422, 'auroc': 0.74154234, 'binary_precision': 0.7585366, 'binary_recall': 0.5, 'binary_specificity': 0.8490854, 'binary_f1_score': 0.60271317}
confusion matrix:
     0    1
0  557   99
1  311  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.5080168, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.4898854, 'auroc': 0.5360297, 'binary_precision': 0.5109489, 'binary_recall': 0.32407406, 'binary_specificity': 0.6898148, 'binary_f1_score': 0.39660054}
confusion matrix:
     0   1
0  149  67
1  146  70
new oracle model saved
early stop counter: 3
val acc:0.679186224937439, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5069444179534912
after epoch: 9,now: 2024-07-20 16:51:11.788821,epoch time: 0:01:22.161017,used: 0:12:33.014684,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8576571, 'precision': 0.8610942, 'recall': 0.8580415, 'specificity': 0.8580415, 'f1': 0.857403, 'auroc': 0.9283941, 'binary_precision': 0.8983417, 'binary_recall': 0.8090909, 'binary_specificity': 0.9069921, 'binary_f1_score': 0.8513837}
confusion matrix:
      0     1
0  1375   141
1   294  1246
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.7079004, 'recall': 0.6730722, 'specificity': 0.6730722, 'f1': 0.6623097, 'auroc': 0.7449734, 'binary_precision': 0.7798408, 'binary_recall': 0.4726688, 'binary_specificity': 0.8734756, 'binary_f1_score': 0.5885886}
confusion matrix:
     0    1
0  573   83
1  328  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.51178527, 'recall': 0.5092592, 'specificity': 0.5092592, 'f1': 0.48147476, 'auroc': 0.5521048, 'binary_precision': 0.51724136, 'binary_recall': 0.2777778, 'binary_specificity': 0.7407407, 'binary_f1_score': 0.36144578}
confusion matrix:
     0   1
0  160  56
1  156  60
new oracle model saved
early stop counter: 4
val acc:0.6784037351608276, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5092592835426331
after epoch: 10,now: 2024-07-20 16:52:34.156574,epoch time: 0:01:22.367753,used: 0:13:55.382437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8671466, 'precision': 0.8711084, 'recall': 0.8675548, 'specificity': 0.8675548, 'f1': 0.8668752, 'auroc': 0.9312943, 'binary_precision': 0.9114659, 'binary_recall': 0.8155844, 'binary_specificity': 0.9195251, 'binary_f1_score': 0.8608636}
confusion matrix:
      0     1
0  1394   122
1   284  1256
---- Validation: 
scalar performance:
{'acc': 0.6651017, 'precision': 0.7027103, 'recall': 0.6590316, 'specificity': 0.6590316, 'f1': 0.64358616, 'auroc': 0.74539256, 'binary_precision': 0.7836257, 'binary_recall': 0.43086818, 'binary_specificity': 0.8871951, 'binary_f1_score': 0.5560166}
confusion matrix:
     0    1
0  582   74
1  354  268
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.52500284, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.4851367, 'auroc': 0.5597136, 'binary_precision': 0.5377358, 'binary_recall': 0.2638889, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.35403726}
confusion matrix:
     0   1
0  167  49
1  159  57
new oracle model saved
early stop counter: 5
val acc:0.6651017069816589, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5185185074806213
after epoch: 11,now: 2024-07-20 16:53:55.435853,epoch time: 0:01:21.279279,used: 0:15:16.661716,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.87859946, 'precision': 0.88372785, 'recall': 0.87905717, 'specificity': 0.87905717, 'f1': 0.87827814, 'auroc': 0.9430833, 'binary_precision': 0.9300957, 'binary_recall': 0.8207792, 'binary_specificity': 0.9373351, 'binary_f1_score': 0.87202483}
confusion matrix:
      0     1
0  1421    95
1   276  1264
---- Validation: 
scalar performance:
{'acc': 0.65336466, 'precision': 0.6989579, 'recall': 0.6466404, 'specificity': 0.6466404, 'f1': 0.62611806, 'auroc': 0.7462797, 'binary_precision': 0.78778136, 'binary_recall': 0.39389068, 'binary_specificity': 0.8993902, 'binary_f1_score': 0.52518755}
confusion matrix:
     0    1
0  590   66
1  377  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.5329952, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.48470175, 'auroc': 0.57165205, 'binary_precision': 0.5510204, 'binary_recall': 0.25, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.34394905}
confusion matrix:
     0   1
0  172  44
1  162  54
new oracle model saved
early stop counter: 6
val acc:0.6533646583557129, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5231481194496155
after epoch: 12,now: 2024-07-20 16:55:17.982271,epoch time: 0:01:22.546418,used: 0:16:39.208134,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.88154453, 'precision': 0.88725716, 'recall': 0.8820255, 'specificity': 0.8820255, 'f1': 0.8811939, 'auroc': 0.9398371, 'binary_precision': 0.9362963, 'binary_recall': 0.8207792, 'binary_specificity': 0.94327176, 'binary_f1_score': 0.8747404}
confusion matrix:
      0     1
0  1430    86
1   276  1264
---- Validation: 
scalar performance:
{'acc': 0.6510172, 'precision': 0.7039304, 'recall': 0.6438956, 'specificity': 0.6438956, 'f1': 0.62020755, 'auroc': 0.74558616, 'binary_precision': 0.80136985, 'binary_recall': 0.3762058, 'binary_specificity': 0.9115854, 'binary_f1_score': 0.5120351}
confusion matrix:
     0    1
0  598   58
1  388  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.517991, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.46375814, 'auroc': 0.57675326, 'binary_precision': 0.52873564, 'binary_recall': 0.21296297, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.30363035}
confusion matrix:
     0   1
0  175  41
1  170  46
early stop counter: 7
val acc:0.6510171890258789, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5231481194496155
after epoch: 13,now: 2024-07-20 16:56:43.413497,epoch time: 0:01:25.431226,used: 0:18:04.639360,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88972515, 'precision': 0.8941796, 'recall': 0.8901475, 'specificity': 0.8901475, 'f1': 0.88948315, 'auroc': 0.9470012, 'binary_precision': 0.93809175, 'binary_recall': 0.8363636, 'binary_specificity': 0.9439314, 'binary_f1_score': 0.88431174}
confusion matrix:
      0     1
0  1431    85
1   252  1288
---- Validation: 
scalar performance:
{'acc': 0.65023476, 'precision': 0.7014587, 'recall': 0.64317507, 'specificity': 0.64317507, 'f1': 0.61990684, 'auroc': 0.7467797, 'binary_precision': 0.7966102, 'binary_recall': 0.37781352, 'binary_specificity': 0.9085366, 'binary_f1_score': 0.51254094}
confusion matrix:
     0    1
0  596   60
1  387  235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.5345268, 'recall': 0.5231482, 'specificity': 0.5231482, 'f1': 0.4803326, 'auroc': 0.58762, 'binary_precision': 0.5543478, 'binary_recall': 0.2361111, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.33116883}
confusion matrix:
     0   1
0  175  41
1  165  51
early stop counter: 8
val acc:0.6502347588539124, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5231481194496155
after epoch: 14,now: 2024-07-20 16:58:06.475209,epoch time: 0:01:23.061712,used: 0:19:27.701072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8929974, 'precision': 0.89643884, 'recall': 0.8933686, 'specificity': 0.8933686, 'f1': 0.89282376, 'auroc': 0.94969547, 'binary_precision': 0.93539125, 'binary_recall': 0.8461039, 'binary_specificity': 0.94063324, 'binary_f1_score': 0.88851005}
confusion matrix:
      0     1
0  1426    90
1   237  1303
---- Validation: 
scalar performance:
{'acc': 0.6510172, 'precision': 0.7067695, 'recall': 0.6437706, 'specificity': 0.6437706, 'f1': 0.6190897, 'auroc': 0.74801, 'binary_precision': 0.8076923, 'binary_recall': 0.37138262, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.5088106}
confusion matrix:
     0    1
0  601   55
1  391  231
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.5318407, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.47550368, 'auroc': 0.5925497, 'binary_precision': 0.5505618, 'binary_recall': 0.22685185, 'binary_specificity': 0.8148148, 'binary_f1_score': 0.32131147}
confusion matrix:
     0   1
0  176  40
1  167  49
early stop counter: 9
val acc:0.6510171890258789, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5231481194496155
after epoch: 15,now: 2024-07-20 16:59:28.965017,epoch time: 0:01:22.489808,used: 0:20:50.190880,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8900524, 'precision': 0.89562976, 'recall': 0.8905236, 'specificity': 0.8905236, 'f1': 0.88974255, 'auroc': 0.94952023, 'binary_precision': 0.94460857, 'binary_recall': 0.8305195, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.8838977}
confusion matrix:
      0     1
0  1441    75
1   261  1279
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.70477194, 'recall': 0.63471985, 'specificity': 0.63471985, 'f1': 0.60548174, 'auroc': 0.7496226, 'binary_precision': 0.8113208, 'binary_recall': 0.34565917, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.4847802}
confusion matrix:
     0    1
0  606   50
1  407  215
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5231481, 'precision': 0.5376307, 'recall': 0.5231481, 'specificity': 0.5231481, 'f1': 0.47238362, 'auroc': 0.6000943, 'binary_precision': 0.5609756, 'binary_recall': 0.21296297, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.30872485}
confusion matrix:
     0   1
0  180  36
1  170  46
early stop counter: 10
val acc:0.6424100399017334, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5231481194496155
after epoch: 16,now: 2024-07-20 17:00:50.382240,epoch time: 0:01:21.417223,used: 0:22:11.608103,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8903796, 'precision': 0.8939972, 'recall': 0.8907609, 'specificity': 0.8907609, 'f1': 0.89018995, 'auroc': 0.95293194, 'binary_precision': 0.9337653, 'binary_recall': 0.8422078, 'binary_specificity': 0.939314, 'binary_f1_score': 0.8856265}
confusion matrix:
      0     1
0  1424    92
1   243  1297
---- Validation: 
scalar performance:
{'acc': 0.64241004, 'precision': 0.7069644, 'recall': 0.6346365, 'specificity': 0.6346365, 'f1': 0.60464215, 'auroc': 0.75132585, 'binary_precision': 0.81609195, 'binary_recall': 0.34244373, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.48244622}
confusion matrix:
     0    1
0  608   48
1  409  213
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.54101217, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.4757747, 'auroc': 0.6069101, 'binary_precision': 0.56626505, 'binary_recall': 0.2175926, 'binary_specificity': 0.8333333, 'binary_f1_score': 0.31438127}
confusion matrix:
     0   1
0  180  36
1  169  47
new oracle model saved
early stop counter: 11
val acc:0.6424100399017334, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5254629850387573
after epoch: 17,now: 2024-07-20 17:02:13.563315,epoch time: 0:01:23.181075,used: 0:23:34.789178,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9034686, 'precision': 0.9080659, 'recall': 0.9038918, 'specificity': 0.9038918, 'f1': 0.9032568, 'auroc': 0.9565214, 'binary_precision': 0.9533867, 'binary_recall': 0.85, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.89872986}
confusion matrix:
      0     1
0  1452    64
1   231  1309
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.6933511, 'recall': 0.61691, 'specificity': 0.61691, 'f1': 0.580056, 'auroc': 0.75177866, 'binary_precision': 0.8016878, 'binary_recall': 0.30546623, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.44237486}
confusion matrix:
     0    1
0  609   47
1  432  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.53792286, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.45999676, 'auroc': 0.6121185, 'binary_precision': 0.5633803, 'binary_recall': 0.18518518, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.27874565}
confusion matrix:
     0   1
0  185  31
1  176  40
early stop counter: 12
val acc:0.6251956224441528, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5254629850387573
after epoch: 18,now: 2024-07-20 17:03:35.700177,epoch time: 0:01:22.136862,used: 0:24:56.926040,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.911322, 'precision': 0.91600096, 'recall': 0.91174567, 'specificity': 0.91174567, 'f1': 0.91112745, 'auroc': 0.9585092, 'binary_precision': 0.96212673, 'binary_recall': 0.8577922, 'binary_specificity': 0.9656992, 'binary_f1_score': 0.9069688}
confusion matrix:
      0     1
0  1464    52
1   219  1321
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.6961251, 'recall': 0.61268234, 'specificity': 0.61268234, 'f1': 0.571915, 'auroc': 0.752634, 'binary_precision': 0.8108108, 'binary_recall': 0.28938907, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.4265403}
confusion matrix:
     0    1
0  614   42
1  442  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.53490627, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.45449245, 'auroc': 0.61824846, 'binary_precision': 0.5588235, 'binary_recall': 0.17592593, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.26760563}
confusion matrix:
     0   1
0  186  30
1  178  38
early stop counter: 13
val acc:0.621283233165741, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5254629850387573
after epoch: 19,now: 2024-07-20 17:04:58.286718,epoch time: 0:01:22.586541,used: 0:26:19.512581,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.90804976, 'precision': 0.9128114, 'recall': 0.9084784, 'specificity': 0.9084784, 'f1': 0.9078422, 'auroc': 0.95635515, 'binary_precision': 0.9591539, 'binary_recall': 0.8538961, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.90346956}
confusion matrix:
      0     1
0  1460    56
1   225  1315
---- Validation: 
scalar performance:
{'acc': 0.6251956, 'precision': 0.69959176, 'recall': 0.6167016, 'specificity': 0.6167016, 'f1': 0.5775988, 'auroc': 0.75533533, 'binary_precision': 0.81497794, 'binary_recall': 0.29742765, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.43580687}
confusion matrix:
     0    1
0  614   42
1  437  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.5511444, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.46688604, 'auroc': 0.6251554, 'binary_precision': 0.5857143, 'binary_recall': 0.18981482, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.2867133}
confusion matrix:
     0   1
0  187  29
1  175  41
new oracle model saved
early stop counter: 14
val acc:0.6251956224441528, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5277777910232544
after epoch: 20,now: 2024-07-20 17:06:21.107321,epoch time: 0:01:22.820603,used: 0:27:42.333184,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9034686, 'precision': 0.9081813, 'recall': 0.9038969, 'specificity': 0.9038969, 'f1': 0.9032507, 'auroc': 0.95425206, 'binary_precision': 0.95404816, 'binary_recall': 0.84935063, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.8986602}
confusion matrix:
      0     1
0  1453    63
1   232  1308
---- Validation: 
scalar performance:
{'acc': 0.6259781, 'precision': 0.70027566, 'recall': 0.6175055, 'specificity': 0.6175055, 'f1': 0.57872975, 'auroc': 0.75713915, 'binary_precision': 0.81578946, 'binary_recall': 0.29903537, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.43764707}
confusion matrix:
     0    1
0  614   42
1  436  186
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.57338065, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.48614684, 'auroc': 0.6334448, 'binary_precision': 0.6216216, 'binary_recall': 0.21296297, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.31724137}
confusion matrix:
     0   1
0  188  28
1  170  46
new oracle model saved
early stop counter: 15
val acc:0.6259781122207642, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5416666865348816
after epoch: 21,now: 2024-07-20 17:07:43.653671,epoch time: 0:01:22.546350,used: 0:29:04.879534,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90575916, 'precision': 0.9111612, 'recall': 0.90621597, 'specificity': 0.90621597, 'f1': 0.905513, 'auroc': 0.96422315, 'binary_precision': 0.9602941, 'binary_recall': 0.84805197, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.9006897}
confusion matrix:
      0     1
0  1462    54
1   234  1306
---- Validation: 
scalar performance:
{'acc': 0.62441313, 'precision': 0.7015766, 'recall': 0.61581445, 'specificity': 0.61581445, 'f1': 0.57545286, 'auroc': 0.7584969, 'binary_precision': 0.8198198, 'binary_recall': 0.2926045, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.4312796}
confusion matrix:
     0    1
0  616   40
1  440  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.581534, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49133727, 'auroc': 0.6433685, 'binary_precision': 0.6351351, 'binary_recall': 0.2175926, 'binary_specificity': 0.875, 'binary_f1_score': 0.32413793}
confusion matrix:
     0   1
0  189  27
1  169  47
new oracle model saved
early stop counter: 16
val acc:0.6244131326675415, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5462962985038757
after epoch: 22,now: 2024-07-20 17:09:05.096018,epoch time: 0:01:21.442347,used: 0:30:26.321881,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90575916, 'precision': 0.91128695, 'recall': 0.90622103, 'specificity': 0.90622103, 'f1': 0.90550655, 'auroc': 0.96284735, 'binary_precision': 0.960972, 'binary_recall': 0.8474026, 'binary_specificity': 0.96503955, 'binary_f1_score': 0.90062106}
confusion matrix:
      0     1
0  1463    53
1   235  1305
---- Validation: 
scalar performance:
{'acc': 0.6283255, 'precision': 0.7090994, 'recall': 0.6197088, 'specificity': 0.6197088, 'f1': 0.57962245, 'auroc': 0.76174414, 'binary_precision': 0.8325792, 'binary_recall': 0.29581994, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.4365362}
confusion matrix:
     0    1
0  619   37
1  438  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.58297056, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.49648243, 'auroc': 0.6488769, 'binary_precision': 0.6363636, 'binary_recall': 0.22685185, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.334471}
confusion matrix:
     0   1
0  188  28
1  167  49
new oracle model saved
early stop counter: 17
val acc:0.6283255219459534, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5486111044883728
after epoch: 23,now: 2024-07-20 17:10:28.036809,epoch time: 0:01:22.940791,used: 0:31:49.262672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90445024, 'precision': 0.9092319, 'recall': 0.90488124, 'specificity': 0.90488124, 'f1': 0.90423167, 'auroc': 0.9612471, 'binary_precision': 0.95547444, 'binary_recall': 0.85, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.8996563}
confusion matrix:
      0     1
0  1455    61
1   231  1309
---- Validation: 
scalar performance:
{'acc': 0.6283255, 'precision': 0.70768917, 'recall': 0.6197504, 'specificity': 0.6197504, 'f1': 0.5801272, 'auroc': 0.76352346, 'binary_precision': 0.8295964, 'binary_recall': 0.29742765, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.43786982}
confusion matrix:
     0    1
0  618   38
1  437  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5813282, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.49813825, 'auroc': 0.65511405, 'binary_precision': 0.6329114, 'binary_recall': 0.23148148, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.33898303}
confusion matrix:
     0   1
0  187  29
1  166  50
early stop counter: 18
val acc:0.6283255219459534, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5486111044883728
after epoch: 24,now: 2024-07-20 17:11:50.708768,epoch time: 0:01:22.671959,used: 0:33:11.934631,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91982985, 'precision': 0.92217505, 'recall': 0.9201307, 'specificity': 0.9201307, 'f1': 0.9197523, 'auroc': 0.96929896, 'binary_precision': 0.95566505, 'binary_recall': 0.8818182, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.9172577}
confusion matrix:
      0     1
0  1453    63
1   182  1358
---- Validation: 
scalar performance:
{'acc': 0.62441313, 'precision': 0.70295155, 'recall': 0.6157728, 'specificity': 0.6157728, 'f1': 0.57494104, 'auroc': 0.7641411, 'binary_precision': 0.82272726, 'binary_recall': 0.2909968, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.42992878}
confusion matrix:
     0    1
0  617   39
1  441  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.59031355, 'recall': 0.5555555, 'specificity': 0.5555555, 'f1': 0.50824106, 'auroc': 0.66252995, 'binary_precision': 0.64634144, 'binary_recall': 0.24537037, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.3557047}
confusion matrix:
     0   1
0  187  29
1  163  53
new oracle model saved
early stop counter: 19
val acc:0.6244131326675415, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5555555820465088
after epoch: 25,now: 2024-07-20 17:13:13.159236,epoch time: 0:01:22.450468,used: 0:34:34.385099,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9060864, 'precision': 0.91317415, 'recall': 0.90660745, 'specificity': 0.90660745, 'f1': 0.90575576, 'auroc': 0.9624396, 'binary_precision': 0.9692884, 'binary_recall': 0.84025973, 'binary_specificity': 0.97295517, 'binary_f1_score': 0.9001739}
confusion matrix:
      0     1
0  1475    41
1   246  1294
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.7060523, 'recall': 0.6123907, 'specificity': 0.6123907, 'f1': 0.56822515, 'auroc': 0.7657095, 'binary_precision': 0.8317308, 'binary_recall': 0.27813506, 'binary_specificity': 0.94664633, 'binary_f1_score': 0.41686746}
confusion matrix:
     0    1
0  621   35
1  449  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.58941877, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.48409736, 'auroc': 0.6584362, 'binary_precision': 0.6515151, 'binary_recall': 0.19907407, 'binary_specificity': 0.8935185, 'binary_f1_score': 0.3049645}
confusion matrix:
     0   1
0  193  23
1  173  43
early stop counter: 20
val acc:0.621283233165741, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5555555820465088
after epoch: 26,now: 2024-07-20 17:14:35.441395,epoch time: 0:01:22.282159,used: 0:35:56.667258,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9201571, 'precision': 0.9220698, 'recall': 0.9204297, 'specificity': 0.9204297, 'f1': 0.92009676, 'auroc': 0.9696951, 'binary_precision': 0.952514, 'binary_recall': 0.8857143, 'binary_specificity': 0.9551451, 'binary_f1_score': 0.91790044}
confusion matrix:
      0     1
0  1448    68
1   176  1364
---- Validation: 
scalar performance:
{'acc': 0.63536775, 'precision': 0.71488965, 'recall': 0.62694347, 'specificity': 0.62694347, 'f1': 0.58978873, 'auroc': 0.7662561, 'binary_precision': 0.83913046, 'binary_recall': 0.31028938, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.45305166}
confusion matrix:
     0    1
0  619   37
1  429  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.5798495, 'recall': 0.55092597, 'specificity': 0.55092597, 'f1': 0.5062101, 'auroc': 0.6708033, 'binary_precision': 0.627907, 'binary_recall': 0.25, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.3576159}
confusion matrix:
     0   1
0  184  32
1  162  54
early stop counter: 21
val acc:0.635367751121521, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5555555820465088
after epoch: 27,now: 2024-07-20 17:15:58.662360,epoch time: 0:01:23.220965,used: 0:37:19.888223,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91721207, 'precision': 0.9213792, 'recall': 0.9176104, 'specificity': 0.9176104, 'f1': 0.91705495, 'auroc': 0.9634497, 'binary_precision': 0.9652929, 'binary_recall': 0.8668831, 'binary_specificity': 0.9683377, 'binary_f1_score': 0.9134451}
confusion matrix:
      0     1
0  1468    48
1   205  1335
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.7118349, 'recall': 0.6212748, 'specificity': 0.6212748, 'f1': 0.5813924, 'auroc': 0.769001, 'binary_precision': 0.8371041, 'binary_recall': 0.29742765, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.43890867}
confusion matrix:
     0    1
0  620   36
1  437  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.5978397, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.51336354, 'auroc': 0.67448986, 'binary_precision': 0.6585366, 'binary_recall': 0.25, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.36241612}
confusion matrix:
     0   1
0  188  28
1  162  54
new oracle model saved
early stop counter: 22
val acc:0.6298904418945312, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5601851940155029
after epoch: 28,now: 2024-07-20 17:17:20.606232,epoch time: 0:01:21.943872,used: 0:38:41.832095,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9234293, 'precision': 0.9278233, 'recall': 0.9238358, 'specificity': 0.9238358, 'f1': 0.9232774, 'auroc': 0.9682358, 'binary_precision': 0.9731884, 'binary_recall': 0.87207794, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.919863}
confusion matrix:
      0     1
0  1479    37
1   197  1343
---- Validation: 
scalar performance:
{'acc': 0.6197183, 'precision': 0.7062384, 'recall': 0.6107413, 'specificity': 0.6107413, 'f1': 0.5653487, 'auroc': 0.7696234, 'binary_precision': 0.8333333, 'binary_recall': 0.27331188, 'binary_specificity': 0.9481707, 'binary_f1_score': 0.41162226}
confusion matrix:
     0    1
0  622   34
1  452  170
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.5938722, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.5050483, 'auroc': 0.6778121, 'binary_precision': 0.65384614, 'binary_recall': 0.2361111, 'binary_specificity': 0.875, 'binary_f1_score': 0.34693876}
confusion matrix:
     0   1
0  189  27
1  165  51
early stop counter: 23
val acc:0.6197183132171631, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5601851940155029
after epoch: 29,now: 2024-07-20 17:18:43.451719,epoch time: 0:01:22.845487,used: 0:40:04.677582,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.90968585, 'precision': 0.9144062, 'recall': 0.910112, 'specificity': 0.910112, 'f1': 0.90948486, 'auroc': 0.96403855, 'binary_precision': 0.9606414, 'binary_recall': 0.85584414, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.90521973}
confusion matrix:
      0     1
0  1462    54
1   222  1318
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.70900285, 'recall': 0.62135816, 'specificity': 0.62135816, 'f1': 0.5823942, 'auroc': 0.7702533, 'binary_precision': 0.83111113, 'binary_recall': 0.3006431, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.44155845}
confusion matrix:
     0    1
0  618   38
1  435  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5648148, 'precision': 0.5982456, 'recall': 0.5648148, 'specificity': 0.5648148, 'f1': 0.5243517, 'auroc': 0.6877358, 'binary_precision': 0.65555555, 'binary_recall': 0.27314815, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.38562092}
confusion matrix:
     0   1
0  185  31
1  157  59
new oracle model saved
early stop counter: 24
val acc:0.6298904418945312, best validation acc: 0.6893583536148071, corresponding to test acc:                         0.4861111044883728 / 0.5648148059844971
after epoch: 30,now: 2024-07-20 17:20:06.176589,epoch time: 0:01:22.724870,used: 0:41:27.402452,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_16_38_38_seed_2_22504816
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:27.402452 at 2024-07-20 17:20:06.176589
persisted model performance metric: 

scalar performance:
{'acc': 0.4861111, 'precision': 0.48538962, 'recall': 0.4861111, 'specificity': 0.4861111, 'f1': 0.47968748, 'auroc': 0.47142917, 'binary_precision': 0.48214287, 'binary_recall': 0.375, 'binary_specificity': 0.5972222, 'binary_f1_score': 0.421875}
confusion matrix:
     0   1
0  129  87
1  135  81
oracle model performance metric: 

scalar performance:
{'acc': 0.5648148, 'precision': 0.5982456, 'recall': 0.5648148, 'specificity': 0.5648148, 'f1': 0.5243517, 'auroc': 0.6877358, 'binary_precision': 0.65555555, 'binary_recall': 0.27314815, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.38562092}
confusion matrix:
     0   1
0  185  31
1  157  59
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/5.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/5.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8524 MiB |  25070 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25000 MiB |  16526 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB | 100653 GiB | 100653 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  98181 GiB |  98181 GiB |
|       from small pool |   8180 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31318 K  |   31317 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31318 K  |   31317 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     369    |    1060    |     692    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     382    |   18316 K  |   18316 K  |
|       from large pool |      11    |     352    |   12008 K  |   12008 K  |
|       from small pool |      33    |     215    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25070 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  24576 KiB |     42 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 100653 GiB | 100653 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  98181 GiB |  98181 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31318 K  |   31318 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31318 K  |   31318 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |    1060    |    1038    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      12    |      21    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   18317 K  |   18317 K  |
|       from large pool |       3    |     352    |   12008 K  |   12008 K  |
|       from small pool |       0    |     215    |    6308 K  |    6308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 17:20:58 2024]
Finished job 0.
1 of 1 steps (100%) done
