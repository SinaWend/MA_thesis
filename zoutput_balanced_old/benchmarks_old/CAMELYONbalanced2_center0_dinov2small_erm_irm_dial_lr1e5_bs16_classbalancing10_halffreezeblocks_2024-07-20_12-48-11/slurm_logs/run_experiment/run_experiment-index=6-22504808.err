Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 12:58:40 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/6.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=6
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808

 Experiment start at: 2024-07-20 12:59:10.073349
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.81119794, 'precision': 0.8130641, 'recall': 0.8117146, 'specificity': 0.8117146, 'f1': 0.81106335, 'auroc': 0.8704825, 'binary_precision': 0.8408932, 'binary_recall': 0.77392423, 'binary_specificity': 0.84950495, 'binary_f1_score': 0.80602014}
confusion matrix:
      0     1
0  1287   228
1   352  1205
---- Validation: 
scalar performance:
{'acc': 0.59006214, 'precision': 0.6200097, 'recall': 0.58637905, 'specificity': 0.58637905, 'f1': 0.55737793, 'auroc': 0.7303759, 'binary_precision': 0.6765677, 'binary_recall': 0.32283464, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.4371002}
confusion matrix:
     0    1
0  555   98
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.59302324, 'precision': 0.62852705, 'recall': 0.5930233, 'specificity': 0.5930233, 'f1': 0.562833, 'auroc': 0.7399459, 'binary_precision': 0.6960784, 'binary_recall': 0.33023256, 'binary_specificity': 0.855814, 'binary_f1_score': 0.44794956}
confusion matrix:
     0   1
0  184  31
1  144  71
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:00:59.576836,epoch time: 0:01:49.503487,used: 0:01:49.503487,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.85058594, 'precision': 0.85642076, 'recall': 0.8514212, 'specificity': 0.8514212, 'f1': 0.85016406, 'auroc': 0.9070425, 'binary_precision': 0.9053954, 'binary_recall': 0.7872751, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.8422138}
confusion matrix:
      0     1
0  1388   128
1   331  1225
---- Validation: 
scalar performance:
{'acc': 0.5908385, 'precision': 0.63162863, 'recall': 0.5867758, 'specificity': 0.5867758, 'f1': 0.5506934, 'auroc': 0.7418215, 'binary_precision': 0.70149255, 'binary_recall': 0.296063, 'binary_specificity': 0.8774885, 'binary_f1_score': 0.41638982}
confusion matrix:
     0    1
0  573   80
1  447  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60232556, 'precision': 0.64975935, 'recall': 0.60232556, 'specificity': 0.60232556, 'f1': 0.5681286, 'auroc': 0.76755, 'binary_precision': 0.7340425, 'binary_recall': 0.32093024, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.44660196}
confusion matrix:
     0   1
0  190  25
1  146  69
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 13:02:46.320892,epoch time: 0:01:46.744056,used: 0:03:36.247543,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.86588544, 'precision': 0.8762507, 'recall': 0.8669734, 'specificity': 0.8669734, 'f1': 0.8651813, 'auroc': 0.9314616, 'binary_precision': 0.9420402, 'binary_recall': 0.783419, 'binary_specificity': 0.9505277, 'binary_f1_score': 0.8554386}
confusion matrix:
      0     1
0  1441    75
1   337  1219
---- Validation: 
scalar performance:
{'acc': 0.60714287, 'precision': 0.65052474, 'recall': 0.6032461, 'specificity': 0.6032461, 'f1': 0.5718074, 'auroc': 0.7565277, 'binary_precision': 0.72791517, 'binary_recall': 0.32440946, 'binary_specificity': 0.8820827, 'binary_f1_score': 0.44880173}
confusion matrix:
     0    1
0  576   77
1  429  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.6992169, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.6177912, 'auroc': 0.79030824, 'binary_precision': 0.8039216, 'binary_recall': 0.38139534, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.5173502}
confusion matrix:
     0   1
0  195  20
1  133  82
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 13:04:33.674785,epoch time: 0:01:47.353893,used: 0:05:23.601436,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8782552, 'precision': 0.8867302, 'recall': 0.8793785, 'specificity': 0.8793785, 'f1': 0.8777877, 'auroc': 0.9435074, 'binary_precision': 0.9478458, 'binary_recall': 0.80436176, 'binary_specificity': 0.95439523, 'binary_f1_score': 0.87022907}
confusion matrix:
      0     1
0  1444    69
1   305  1254
---- Validation: 
scalar performance:
{'acc': 0.64518636, 'precision': 0.6741848, 'recall': 0.6422194, 'specificity': 0.6422194, 'f1': 0.6269196, 'auroc': 0.7739639, 'binary_precision': 0.7418478, 'binary_recall': 0.42992127, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.54436684}
confusion matrix:
     0    1
0  558   95
1  362  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69069767, 'precision': 0.72803706, 'recall': 0.69069767, 'specificity': 0.69069767, 'f1': 0.6774958, 'auroc': 0.8087182, 'binary_precision': 0.8203125, 'binary_recall': 0.4883721, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.6122449}
confusion matrix:
     0    1
0  192   23
1  110  105
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 13:06:21.636329,epoch time: 0:01:47.961544,used: 0:07:11.562980,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.88639325, 'precision': 0.8987547, 'recall': 0.887671, 'specificity': 0.887671, 'f1': 0.8857245, 'auroc': 0.953956, 'binary_precision': 0.97263485, 'binary_recall': 0.7984596, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.8769827}
confusion matrix:
      0     1
0  1479    35
1   314  1244
---- Validation: 
scalar performance:
{'acc': 0.64363354, 'precision': 0.6883648, 'recall': 0.6401237, 'specificity': 0.6401237, 'f1': 0.61777675, 'auroc': 0.7869433, 'binary_precision': 0.7767296, 'binary_recall': 0.38897637, 'binary_specificity': 0.89127105, 'binary_f1_score': 0.51836306}
confusion matrix:
     0    1
0  582   71
1  388  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.7327615, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.66279143, 'auroc': 0.8251163, 'binary_precision': 0.84210527, 'binary_recall': 0.44651163, 'binary_specificity': 0.9162791, 'binary_f1_score': 0.58358663}
confusion matrix:
     0   1
0  197  18
1  119  96
early stop counter: 1
val acc:0.6436335444450378, best validation acc: 0.6451863646507263, corresponding to test acc:                         0.6906976699829102 / 0.6906976699829102
after epoch: 5,now: 2024-07-20 13:08:08.095343,epoch time: 0:01:46.459014,used: 0:08:58.021994,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.91307867, 'recall': 0.9074118, 'specificity': 0.9074118, 'f1': 0.9063182, 'auroc': 0.9645101, 'binary_precision': 0.9682657, 'binary_recall': 0.8431877, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.9014085}
confusion matrix:
      0     1
0  1473    43
1   244  1312
---- Validation: 
scalar performance:
{'acc': 0.68555903, 'precision': 0.7093221, 'recall': 0.6831209, 'specificity': 0.6831209, 'f1': 0.67453945, 'auroc': 0.8023417, 'binary_precision': 0.7764423, 'binary_recall': 0.5086614, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.6146527}
confusion matrix:
     0    1
0  560   93
1  312  323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7348837, 'precision': 0.7561879, 'recall': 0.73488367, 'specificity': 0.73488367, 'f1': 0.7292551, 'auroc': 0.84307194, 'binary_precision': 0.83006537, 'binary_recall': 0.59069765, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.6902174}
confusion matrix:
     0    1
0  189   26
1   88  127
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 13:09:55.645312,epoch time: 0:01:47.549969,used: 0:10:45.571963,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90690106, 'precision': 0.9125484, 'recall': 0.90768224, 'specificity': 0.90768224, 'f1': 0.9066844, 'auroc': 0.9689672, 'binary_precision': 0.9641813, 'binary_recall': 0.84768635, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.9021887}
confusion matrix:
      0     1
0  1467    49
1   237  1319
---- Validation: 
scalar performance:
{'acc': 0.70186335, 'precision': 0.72078586, 'recall': 0.69974315, 'specificity': 0.69974315, 'f1': 0.69387996, 'auroc': 0.8108982, 'binary_precision': 0.7820225, 'binary_recall': 0.5480315, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.6444444}
confusion matrix:
     0    1
0  556   97
1  287  348
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.7755201, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.7542641, 'auroc': 0.85343426, 'binary_precision': 0.8447205, 'binary_recall': 0.63255817, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.7234042}
confusion matrix:
     0    1
0  190   25
1   79  136
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 13:11:41.991417,epoch time: 0:01:46.346105,used: 0:12:31.918068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.9162476, 'recall': 0.9115722, 'specificity': 0.9115722, 'f1': 0.9106109, 'auroc': 0.96673703, 'binary_precision': 0.9672012, 'binary_recall': 0.8528278, 'binary_specificity': 0.97031665, 'binary_f1_score': 0.90642077}
confusion matrix:
      0     1
0  1471    45
1   229  1327
---- Validation: 
scalar performance:
{'acc': 0.7135093, 'precision': 0.7311699, 'recall': 0.7115108, 'specificity': 0.7115108, 'f1': 0.7066467, 'auroc': 0.8195826, 'binary_precision': 0.7916667, 'binary_recall': 0.5685039, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.66177815}
confusion matrix:
     0    1
0  558   95
1  274  361
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.7851459, 'recall': 0.772093, 'specificity': 0.772093, 'f1': 0.76945466, 'auroc': 0.8662845, 'binary_precision': 0.84615386, 'binary_recall': 0.66511625, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.7447917}
confusion matrix:
     0    1
0  189   26
1   72  143
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 13:13:29.026012,epoch time: 0:01:47.034595,used: 0:14:18.952663,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9215495, 'precision': 0.92664456, 'recall': 0.9223227, 'specificity': 0.9223227, 'f1': 0.9213977, 'auroc': 0.9760947, 'binary_precision': 0.9768116, 'binary_recall': 0.8657675, 'binary_specificity': 0.9788779, 'binary_f1_score': 0.9179434}
confusion matrix:
      0     1
0  1483    32
1   209  1348
---- Validation: 
scalar performance:
{'acc': 0.7181677, 'precision': 0.7329158, 'recall': 0.7163437, 'specificity': 0.7163437, 'f1': 0.7124899, 'auroc': 0.8232386, 'binary_precision': 0.7881356, 'binary_recall': 0.58582675, 'binary_specificity': 0.84686065, 'binary_f1_score': 0.67208666}
confusion matrix:
     0    1
0  553  100
1  263  372
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.7914846, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.77948713, 'auroc': 0.87257975, 'binary_precision': 0.8457143, 'binary_recall': 0.6883721, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.7589743}
confusion matrix:
     0    1
0  188   27
1   67  148
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 13:15:16.592400,epoch time: 0:01:47.566388,used: 0:16:06.519051,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.92089844, 'precision': 0.925154, 'recall': 0.92146885, 'specificity': 0.92146885, 'f1': 0.920763, 'auroc': 0.97579443, 'binary_precision': 0.97054595, 'binary_recall': 0.8699292, 'binary_specificity': 0.9730086, 'binary_f1_score': 0.91748726}
confusion matrix:
      0     1
0  1478    41
1   202  1351
---- Validation: 
scalar performance:
{'acc': 0.7336956, 'precision': 0.74683917, 'recall': 0.7320266, 'specificity': 0.7320266, 'f1': 0.7291422, 'auroc': 0.83520997, 'binary_precision': 0.8004115, 'binary_recall': 0.6125984, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.69402325}
confusion matrix:
     0    1
0  556   97
1  246  389
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7976744, 'precision': 0.8048564, 'recall': 0.7976744, 'specificity': 0.7976744, 'f1': 0.7964757, 'auroc': 0.88177395, 'binary_precision': 0.85164833, 'binary_recall': 0.7209302, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.78085643}
confusion matrix:
     0    1
0  188   27
1   60  155
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 13:17:03.018640,epoch time: 0:01:46.426240,used: 0:17:52.945291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.91829425, 'precision': 0.9255711, 'recall': 0.9191235, 'specificity': 0.9191235, 'f1': 0.9180404, 'auroc': 0.9747746, 'binary_precision': 0.98439825, 'binary_recall': 0.85209006, 'binary_specificity': 0.9861569, 'binary_f1_score': 0.9134782}
confusion matrix:
      0     1
0  1496    21
1   230  1325
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.73836404, 'recall': 0.70956695, 'specificity': 0.70956695, 'f1': 0.7022114, 'auroc': 0.8327284, 'binary_precision': 0.8142857, 'binary_recall': 0.5385827, 'binary_specificity': 0.8805513, 'binary_f1_score': 0.6483413}
confusion matrix:
     0    1
0  575   78
1  293  342
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7953488, 'precision': 0.8108422, 'recall': 0.7953489, 'specificity': 0.7953489, 'f1': 0.7927666, 'auroc': 0.88517034, 'binary_precision': 0.88023955, 'binary_recall': 0.68372095, 'binary_specificity': 0.90697676, 'binary_f1_score': 0.76963353}
confusion matrix:
     0    1
0  195   20
1   68  147
early stop counter: 1
val acc:0.7119565010070801, best validation acc: 0.7336956262588501, corresponding to test acc:                         0.7976744174957275 / 0.7976744174957275
after epoch: 11,now: 2024-07-20 13:18:49.615476,epoch time: 0:01:46.596836,used: 0:19:39.542127,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9277344, 'precision': 0.93249476, 'recall': 0.92844284, 'specificity': 0.92844284, 'f1': 0.92760473, 'auroc': 0.9740654, 'binary_precision': 0.981241, 'binary_recall': 0.874036, 'binary_specificity': 0.9828496, 'binary_f1_score': 0.9245411}
confusion matrix:
      0     1
0  1490    26
1   196  1360
---- Validation: 
scalar performance:
{'acc': 0.7763975, 'precision': 0.7769101, 'recall': 0.77605, 'specificity': 0.77605, 'f1': 0.77611196, 'auroc': 0.84762996, 'binary_precision': 0.785832, 'binary_recall': 0.7511811, 'binary_specificity': 0.8009188, 'binary_f1_score': 0.768116}
confusion matrix:
     0    1
0  523  130
1  158  477
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.81395346, 'precision': 0.81406224, 'recall': 0.8139535, 'specificity': 0.8139535, 'f1': 0.8139374, 'auroc': 0.8952515, 'binary_precision': 0.8199052, 'binary_recall': 0.80465114, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.81220657}
confusion matrix:
     0    1
0  177   38
1   42  173
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 13:20:36.178223,epoch time: 0:01:46.562747,used: 0:21:26.104874,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9277344, 'precision': 0.93324023, 'recall': 0.9284937, 'specificity': 0.9284937, 'f1': 0.92757964, 'auroc': 0.9799186, 'binary_precision': 0.98544395, 'binary_recall': 0.87017995, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.924232}
confusion matrix:
      0     1
0  1496    20
1   202  1354
---- Validation: 
scalar performance:
{'acc': 0.76086956, 'precision': 0.7687549, 'recall': 0.7596291, 'specificity': 0.7596291, 'f1': 0.7584843, 'auroc': 0.844666, 'binary_precision': 0.81142855, 'binary_recall': 0.67086613, 'binary_specificity': 0.848392, 'binary_f1_score': 0.7344827}
confusion matrix:
     0    1
0  554   99
1  209  426
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82093024, 'precision': 0.8234563, 'recall': 0.82093024, 'specificity': 0.82093024, 'f1': 0.82058, 'auroc': 0.89734983, 'binary_precision': 0.8520408, 'binary_recall': 0.7767442, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.8126521}
confusion matrix:
     0    1
0  186   29
1   48  167
new oracle model saved
early stop counter: 1
val acc:0.760869562625885, best validation acc: 0.7763975262641907, corresponding to test acc:                         0.8139534592628479 / 0.8209302425384521
after epoch: 13,now: 2024-07-20 13:22:22.378361,epoch time: 0:01:46.200138,used: 0:23:12.305012,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9329427, 'precision': 0.9366463, 'recall': 0.9335365, 'specificity': 0.9335365, 'f1': 0.93285346, 'auroc': 0.9809914, 'binary_precision': 0.9800712, 'binary_recall': 0.88553053, 'binary_specificity': 0.9815425, 'binary_f1_score': 0.9304054}
confusion matrix:
      0     1
0  1489    28
1   178  1377
---- Validation: 
scalar performance:
{'acc': 0.77329195, 'precision': 0.7790599, 'recall': 0.7722492, 'specificity': 0.7722492, 'f1': 0.77162623, 'auroc': 0.8480544, 'binary_precision': 0.8158379, 'binary_recall': 0.6976378, 'binary_specificity': 0.84686065, 'binary_f1_score': 0.7521223}
confusion matrix:
     0    1
0  553  100
1  192  443
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8255814, 'precision': 0.82717395, 'recall': 0.82558143, 'specificity': 0.82558143, 'f1': 0.8253689, 'auroc': 0.89981616, 'binary_precision': 0.85, 'binary_recall': 0.7906977, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.8192771}
confusion matrix:
     0    1
0  185   30
1   45  170
new oracle model saved
early stop counter: 2
val acc:0.7732919454574585, best validation acc: 0.7763975262641907, corresponding to test acc:                         0.8139534592628479 / 0.8255813717842102
after epoch: 14,now: 2024-07-20 13:24:08.787951,epoch time: 0:01:46.409590,used: 0:24:58.714602,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9345703, 'precision': 0.9401878, 'recall': 0.93537265, 'specificity': 0.93537265, 'f1': 0.93443215, 'auroc': 0.98215234, 'binary_precision': 0.9934498, 'binary_recall': 0.8766859, 'binary_specificity': 0.9940594, 'binary_f1_score': 0.93142265}
confusion matrix:
      0     1
0  1506     9
1   192  1365
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.7690642, 'recall': 0.75711495, 'specificity': 0.75711495, 'f1': 0.75544095, 'auroc': 0.8489009, 'binary_precision': 0.81889766, 'binary_recall': 0.6551181, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.7279091}
confusion matrix:
     0    1
0  561   92
1  219  416
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.841671, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8392837, 'auroc': 0.90399134, 'binary_precision': 0.86868685, 'binary_recall': 0.8, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.8329298}
confusion matrix:
     0    1
0  189   26
1   43  172
new oracle model saved
early stop counter: 3
val acc:0.7585403919219971, best validation acc: 0.7763975262641907, corresponding to test acc:                         0.8139534592628479 / 0.8395348787307739
after epoch: 15,now: 2024-07-20 13:25:55.156479,epoch time: 0:01:46.368528,used: 0:26:45.083130,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94628906, 'precision': 0.9482677, 'recall': 0.9467279, 'specificity': 0.9467279, 'f1': 0.9462588, 'auroc': 0.9857775, 'binary_precision': 0.98130196, 'binary_recall': 0.91125405, 'binary_specificity': 0.9822017, 'binary_f1_score': 0.94498175}
confusion matrix:
      0     1
0  1490    27
1   138  1417
---- Validation: 
scalar performance:
{'acc': 0.77717394, 'precision': 0.7798912, 'recall': 0.7764467, 'specificity': 0.7764467, 'f1': 0.77628917, 'auroc': 0.85505295, 'binary_precision': 0.8041958, 'binary_recall': 0.72440946, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.7622204}
confusion matrix:
     0    1
0  541  112
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8397186, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8395132, 'auroc': 0.91093564, 'binary_precision': 0.84761906, 'binary_recall': 0.82790697, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8376471}
confusion matrix:
     0    1
0  183   32
1   37  178
better model found
persisted
after epoch: 16,now: 2024-07-20 13:27:41.225769,epoch time: 0:01:46.069290,used: 0:28:31.152420,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9430339, 'precision': 0.9452002, 'recall': 0.94354403, 'specificity': 0.94354403, 'f1': 0.94299984, 'auroc': 0.9851004, 'binary_precision': 0.97986114, 'binary_recall': 0.9062299, 'binary_specificity': 0.9808581, 'binary_f1_score': 0.94160825}
confusion matrix:
      0     1
0  1486    29
1   146  1411
---- Validation: 
scalar performance:
{'acc': 0.7864907, 'precision': 0.7893259, 'recall': 0.7857653, 'specificity': 0.7857653, 'f1': 0.7856429, 'auroc': 0.86052024, 'binary_precision': 0.8146853, 'binary_recall': 0.7338583, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.7721624}
confusion matrix:
     0    1
0  547  106
1  169  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8372093, 'precision': 0.83747214, 'recall': 0.83720934, 'specificity': 0.83720934, 'f1': 0.83717763, 'auroc': 0.9109573, 'binary_precision': 0.84689, 'binary_recall': 0.82325584, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8349057}
confusion matrix:
     0    1
0  183   32
1   38  177
better model found
persisted
after epoch: 17,now: 2024-07-20 13:29:27.723838,epoch time: 0:01:46.498069,used: 0:30:17.650489,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9420573, 'precision': 0.94533217, 'recall': 0.94258344, 'specificity': 0.94258344, 'f1': 0.94199073, 'auroc': 0.9850863, 'binary_precision': 0.98656297, 'binary_recall': 0.8976834, 'binary_specificity': 0.9874835, 'binary_f1_score': 0.94002694}
confusion matrix:
      0     1
0  1499    19
1   159  1395
---- Validation: 
scalar performance:
{'acc': 0.77251554, 'precision': 0.7826215, 'recall': 0.771158, 'specificity': 0.771158, 'f1': 0.76983494, 'auroc': 0.8603851, 'binary_precision': 0.8326848, 'binary_recall': 0.67401576, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.7449957}
confusion matrix:
     0    1
0  567   86
1  207  428
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84427357, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.8415829, 'auroc': 0.9127096, 'binary_precision': 0.87309647, 'binary_recall': 0.8, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.8349515}
confusion matrix:
     0    1
0  190   25
1   43  172
new oracle model saved
early stop counter: 1
val acc:0.7725155353546143, best validation acc: 0.7864906787872314, corresponding to test acc:                         0.8372092843055725 / 0.8418604731559753
after epoch: 18,now: 2024-07-20 13:31:14.229424,epoch time: 0:01:46.505586,used: 0:32:04.156075,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.94636863, 'recall': 0.94456786, 'specificity': 0.94456786, 'f1': 0.9439743, 'auroc': 0.9879341, 'binary_precision': 0.98259056, 'binary_recall': 0.9056483, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.94255173}
confusion matrix:
      0     1
0  1489    25
1   147  1411
---- Validation: 
scalar performance:
{'acc': 0.78571427, 'precision': 0.790769, 'recall': 0.78476083, 'specificity': 0.78476083, 'f1': 0.7843619, 'auroc': 0.8637301, 'binary_precision': 0.82577133, 'binary_recall': 0.71653545, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.767285}
confusion matrix:
     0    1
0  557   96
1  180  455
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.8447902, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84411776, 'auroc': 0.91506755, 'binary_precision': 0.8592233, 'binary_recall': 0.82325584, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.8408551}
confusion matrix:
     0    1
0  186   29
1   38  177
new oracle model saved
early stop counter: 2
val acc:0.7857142686843872, best validation acc: 0.7864906787872314, corresponding to test acc:                         0.8372092843055725 / 0.8441860675811768
after epoch: 19,now: 2024-07-20 13:33:00.341731,epoch time: 0:01:46.112307,used: 0:33:50.268382,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.94173175, 'precision': 0.9445237, 'recall': 0.94227725, 'specificity': 0.94227725, 'f1': 0.9416806, 'auroc': 0.9874369, 'binary_precision': 0.9831579, 'binary_recall': 0.9003856, 'binary_specificity': 0.9841689, 'binary_f1_score': 0.939953}
confusion matrix:
      0     1
0  1492    24
1   155  1401
---- Validation: 
scalar performance:
{'acc': 0.7763975, 'precision': 0.7861478, 'recall': 0.7750733, 'specificity': 0.7750733, 'f1': 0.7738764, 'auroc': 0.86646247, 'binary_precision': 0.83558995, 'binary_recall': 0.68031496, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.75}
confusion matrix:
     0    1
0  568   85
1  203  432
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.84895754, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8462422, 'auroc': 0.9174689, 'binary_precision': 0.8781726, 'binary_recall': 0.80465114, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.8398058}
confusion matrix:
     0    1
0  191   24
1   42  173
new oracle model saved
early stop counter: 3
val acc:0.7763975262641907, best validation acc: 0.7864906787872314, corresponding to test acc:                         0.8372092843055725 / 0.8465116024017334
after epoch: 20,now: 2024-07-20 13:34:46.296765,epoch time: 0:01:45.955034,used: 0:35:36.223416,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94661456, 'precision': 0.9492936, 'recall': 0.94714814, 'specificity': 0.94714814, 'f1': 0.94657075, 'auroc': 0.98601127, 'binary_precision': 0.9873949, 'binary_recall': 0.90616965, 'binary_specificity': 0.98812664, 'binary_f1_score': 0.94504017}
confusion matrix:
      0     1
0  1498    18
1   146  1410
---- Validation: 
scalar performance:
{'acc': 0.7872671, 'precision': 0.7933875, 'recall': 0.7862271, 'specificity': 0.7862271, 'f1': 0.785704, 'auroc': 0.8649287, 'binary_precision': 0.83241254, 'binary_recall': 0.711811, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.7674024}
confusion matrix:
     0    1
0  562   91
1  183  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.8450894, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.844084, 'auroc': 0.91694975, 'binary_precision': 0.8627451, 'binary_recall': 0.81860465, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.84009546}
confusion matrix:
     0    1
0  187   28
1   39  176
better model found
persisted
after epoch: 21,now: 2024-07-20 13:36:32.172495,epoch time: 0:01:45.875730,used: 0:37:22.099146,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9508464, 'precision': 0.95266736, 'recall': 0.9512916, 'specificity': 0.9512916, 'f1': 0.950823, 'auroc': 0.9901738, 'binary_precision': 0.9848171, 'binary_recall': 0.9170951, 'binary_specificity': 0.9854881, 'binary_f1_score': 0.9497504}
confusion matrix:
      0     1
0  1494    22
1   129  1427
---- Validation: 
scalar performance:
{'acc': 0.79270184, 'precision': 0.79706633, 'recall': 0.7918258, 'specificity': 0.7918258, 'f1': 0.7915679, 'auroc': 0.86765385, 'binary_precision': 0.8297491, 'binary_recall': 0.72913384, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.77619445}
confusion matrix:
     0    1
0  558   95
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.8421269, 'recall': 0.8418605, 'specificity': 0.8418605, 'f1': 0.84182966, 'auroc': 0.91740406, 'binary_precision': 0.8516746, 'binary_recall': 0.82790697, 'binary_specificity': 0.855814, 'binary_f1_score': 0.83962256}
confusion matrix:
     0    1
0  184   31
1   37  178
better model found
persisted
after epoch: 22,now: 2024-07-20 13:38:18.593530,epoch time: 0:01:46.421035,used: 0:39:08.520181,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94401044, 'precision': 0.94712543, 'recall': 0.94461423, 'specificity': 0.94461423, 'f1': 0.94395566, 'auroc': 0.987254, 'binary_precision': 0.9880197, 'binary_recall': 0.9004496, 'binary_specificity': 0.9887789, 'binary_f1_score': 0.9422043}
confusion matrix:
      0     1
0  1498    17
1   155  1402
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.79432, 'recall': 0.7869928, 'specificity': 0.7869928, 'f1': 0.7864574, 'auroc': 0.8657317, 'binary_precision': 0.8339483, 'binary_recall': 0.711811, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.7680543}
confusion matrix:
     0    1
0  563   90
1  183  452
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.84042597, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8394298, 'auroc': 0.91664684, 'binary_precision': 0.85784316, 'binary_recall': 0.81395346, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.8353222}
confusion matrix:
     0    1
0  186   29
1   40  175
early stop counter: 1
val acc:0.7880434989929199, best validation acc: 0.7927018404006958, corresponding to test acc:                         0.8418604731559753 / 0.8465116024017334
after epoch: 23,now: 2024-07-20 13:40:04.787306,epoch time: 0:01:46.193776,used: 0:40:54.713957,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9501953, 'precision': 0.951607, 'recall': 0.9505702, 'specificity': 0.9505702, 'f1': 0.95017815, 'auroc': 0.9888909, 'binary_precision': 0.980137, 'binary_recall': 0.9202572, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.94925374}
confusion matrix:
      0     1
0  1488    29
1   124  1431
---- Validation: 
scalar performance:
{'acc': 0.79813665, 'precision': 0.8000146, 'recall': 0.7975546, 'specificity': 0.7975546, 'f1': 0.7975724, 'auroc': 0.87147146, 'binary_precision': 0.82051283, 'binary_recall': 0.7559055, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.78688526}
confusion matrix:
     0    1
0  548  105
1  155  480
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84418607, 'precision': 0.84419346, 'recall': 0.84418607, 'specificity': 0.84418607, 'f1': 0.84418523, 'auroc': 0.9219687, 'binary_precision': 0.8457944, 'binary_recall': 0.8418605, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.84382284}
confusion matrix:
     0    1
0  182   33
1   34  181
better model found
persisted
after epoch: 24,now: 2024-07-20 13:41:51.328637,epoch time: 0:01:46.541331,used: 0:42:41.255288,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.945638, 'precision': 0.94717133, 'recall': 0.94611824, 'specificity': 0.94611824, 'f1': 0.94562066, 'auroc': 0.9874888, 'binary_precision': 0.97736627, 'binary_recall': 0.9140475, 'binary_specificity': 0.97818905, 'binary_f1_score': 0.9446471}
confusion matrix:
      0     1
0  1480    33
1   134  1425
---- Validation: 
scalar performance:
{'acc': 0.8004658, 'precision': 0.8022884, 'recall': 0.7998951, 'specificity': 0.7998951, 'f1': 0.7999245, 'auroc': 0.8735551, 'binary_precision': 0.8225256, 'binary_recall': 0.75905514, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.78951687}
confusion matrix:
     0    1
0  549  104
1  153  482
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8418605, 'precision': 0.84189004, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8418571, 'auroc': 0.92343974, 'binary_precision': 0.83870965, 'binary_recall': 0.8465116, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8425926}
confusion matrix:
     0    1
0  180   35
1   33  182
better model found
persisted
after epoch: 25,now: 2024-07-20 13:43:37.964621,epoch time: 0:01:46.635984,used: 0:44:27.891272,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.94661456, 'precision': 0.9487128, 'recall': 0.9471682, 'specificity': 0.9471682, 'f1': 0.94658685, 'auroc': 0.98757994, 'binary_precision': 0.983368, 'binary_recall': 0.91019887, 'binary_specificity': 0.9841375, 'binary_f1_score': 0.9453698}
confusion matrix:
      0     1
0  1489    24
1   140  1419
---- Validation: 
scalar performance:
{'acc': 0.7950311, 'precision': 0.7990987, 'recall': 0.79418796, 'specificity': 0.79418796, 'f1': 0.7939799, 'auroc': 0.8729064, 'binary_precision': 0.8306595, 'binary_recall': 0.7338583, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.7792642}
confusion matrix:
     0    1
0  558   95
1  169  466
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8488372, 'precision': 0.84890515, 'recall': 0.84883726, 'specificity': 0.84883726, 'f1': 0.84882987, 'auroc': 0.9240887, 'binary_precision': 0.8537736, 'binary_recall': 0.8418605, 'binary_specificity': 0.855814, 'binary_f1_score': 0.84777516}
confusion matrix:
     0    1
0  184   31
1   34  181
new oracle model saved
early stop counter: 1
val acc:0.7950310707092285, best validation acc: 0.8004658222198486, corresponding to test acc:                         0.8418604731559753 / 0.8488371968269348
after epoch: 26,now: 2024-07-20 13:45:24.097636,epoch time: 0:01:46.133015,used: 0:46:14.024287,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9498698, 'precision': 0.95134676, 'recall': 0.95029664, 'specificity': 0.95029664, 'f1': 0.9498532, 'auroc': 0.98543406, 'binary_precision': 0.9808088, 'binary_recall': 0.91907513, 'binary_specificity': 0.98151815, 'binary_f1_score': 0.94893897}
confusion matrix:
      0     1
0  1487    28
1   126  1431
---- Validation: 
scalar performance:
{'acc': 0.79658383, 'precision': 0.8016189, 'recall': 0.7956542, 'specificity': 0.7956542, 'f1': 0.7953502, 'auroc': 0.8744957, 'binary_precision': 0.83725137, 'binary_recall': 0.72913384, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.77946126}
confusion matrix:
     0    1
0  563   90
1  172  463
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.855814, 'precision': 0.85630727, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.855764, 'auroc': 0.9208437, 'binary_precision': 0.8695652, 'binary_recall': 0.8372093, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8530805}
confusion matrix:
     0    1
0  188   27
1   35  180
new oracle model saved
early stop counter: 2
val acc:0.7965838313102722, best validation acc: 0.8004658222198486, corresponding to test acc:                         0.8418604731559753 / 0.8558139801025391
after epoch: 27,now: 2024-07-20 13:47:10.515541,epoch time: 0:01:46.417905,used: 0:48:00.442192,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9557292, 'precision': 0.95688045, 'recall': 0.9561305, 'specificity': 0.9561305, 'f1': 0.95572007, 'auroc': 0.9895363, 'binary_precision': 0.98367345, 'binary_recall': 0.928113, 'binary_specificity': 0.98414797, 'binary_f1_score': 0.9550859}
confusion matrix:
      0     1
0  1490    24
1   112  1446
---- Validation: 
scalar performance:
{'acc': 0.79425466, 'precision': 0.7996181, 'recall': 0.79329205, 'specificity': 0.79329205, 'f1': 0.79293036, 'auroc': 0.87144494, 'binary_precision': 0.8363636, 'binary_recall': 0.72440946, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.77637124}
confusion matrix:
     0    1
0  563   90
1  175  460
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8465116, 'precision': 0.84654164, 'recall': 0.8465116, 'specificity': 0.8465116, 'f1': 0.8465083, 'auroc': 0.9221201, 'binary_precision': 0.84976524, 'binary_recall': 0.8418605, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.8457944}
confusion matrix:
     0    1
0  183   32
1   34  181
early stop counter: 3
val acc:0.7942546606063843, best validation acc: 0.8004658222198486, corresponding to test acc:                         0.8418604731559753 / 0.8558139801025391
after epoch: 28,now: 2024-07-20 13:48:57.089625,epoch time: 0:01:46.574084,used: 0:49:47.016276,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.95529926, 'recall': 0.95387435, 'specificity': 0.95387435, 'f1': 0.9534271, 'auroc': 0.9901557, 'binary_precision': 0.98756903, 'binary_recall': 0.91961414, 'binary_specificity': 0.9881345, 'binary_f1_score': 0.95238096}
confusion matrix:
      0     1
0  1499    18
1   125  1430
---- Validation: 
scalar performance:
{'acc': 0.7880435, 'precision': 0.7964015, 'recall': 0.7868409, 'specificity': 0.7868409, 'f1': 0.7860282, 'auroc': 0.870379, 'binary_precision': 0.842803, 'binary_recall': 0.7007874, 'binary_specificity': 0.87289435, 'binary_f1_score': 0.7652623}
confusion matrix:
     0    1
0  570   83
1  190  445
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8534884, 'precision': 0.85441613, 'recall': 0.8534883, 'specificity': 0.8534883, 'f1': 0.8533925, 'auroc': 0.92270416, 'binary_precision': 0.872549, 'binary_recall': 0.82790697, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.84964204}
confusion matrix:
     0    1
0  189   26
1   37  178
early stop counter: 4
val acc:0.7880434989929199, best validation acc: 0.8004658222198486, corresponding to test acc:                         0.8418604731559753 / 0.8558139801025391
after epoch: 29,now: 2024-07-20 13:50:43.143831,epoch time: 0:01:46.054206,used: 0:51:33.070482,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95410156, 'precision': 0.9551495, 'recall': 0.9544288, 'specificity': 0.9544288, 'f1': 0.9540917, 'auroc': 0.9896263, 'binary_precision': 0.98029894, 'binary_recall': 0.9279743, 'binary_specificity': 0.9808833, 'binary_f1_score': 0.95341927}
confusion matrix:
      0     1
0  1488    29
1   112  1443
---- Validation: 
scalar performance:
{'acc': 0.79270184, 'precision': 0.7926698, 'recall': 0.79271567, 'specificity': 0.79271567, 'f1': 0.79268074, 'auroc': 0.8746669, 'binary_precision': 0.7875, 'binary_recall': 0.7937008, 'binary_specificity': 0.79173046, 'binary_f1_score': 0.79058826}
confusion matrix:
     0    1
0  517  136
1  131  504
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8395349, 'precision': 0.8398952, 'recall': 0.8395349, 'specificity': 0.8395349, 'f1': 0.8394923, 'auroc': 0.9257761, 'binary_precision': 0.8288288, 'binary_recall': 0.855814, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.84210527}
confusion matrix:
     0    1
0  177   38
1   31  184
early stop counter: 5
val acc:0.7927018404006958, best validation acc: 0.8004658222198486, corresponding to test acc:                         0.8418604731559753 / 0.8558139801025391
after epoch: 30,now: 2024-07-20 13:52:29.834463,epoch time: 0:01:46.690632,used: 0:53:19.761114,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_59_10_seed_0_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 30 with time: 0:53:19.761114 at 2024-07-20 13:52:29.834463
persisted model performance metric: 

scalar performance:
{'acc': 0.8418605, 'precision': 0.84189004, 'recall': 0.8418604, 'specificity': 0.8418604, 'f1': 0.8418571, 'auroc': 0.92343974, 'binary_precision': 0.83870965, 'binary_recall': 0.8465116, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.8425926}
confusion matrix:
     0    1
0  180   35
1   33  182
oracle model performance metric: 

scalar performance:
{'acc': 0.855814, 'precision': 0.85630727, 'recall': 0.855814, 'specificity': 0.855814, 'f1': 0.855764, 'auroc': 0.9208437, 'binary_precision': 0.8695652, 'binary_recall': 0.8372093, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.8530805}
confusion matrix:
     0    1
0  188   27
1   35  180
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/6.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   4046 MiB | 165413 GiB | 165413 GiB |
|       from large pool | 180662 KiB |   4027 MiB | 163514 GiB | 163514 GiB |
|       from small pool |  16396 KiB |     32 MiB |   1899 GiB |   1899 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   4046 MiB | 165413 GiB | 165413 GiB |
|       from large pool | 180662 KiB |   4027 MiB | 163514 GiB | 163514 GiB |
|       from small pool |  16396 KiB |     32 MiB |   1899 GiB |   1899 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   4045 MiB | 165402 GiB | 165402 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 163505 GiB | 163505 GiB |
|       from small pool |  16209 KiB |     32 MiB |   1897 GiB |   1897 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4434 MiB |   4434 MiB |   4434 MiB |      0 B   |
|       from large pool |   4396 MiB |   4396 MiB |   4396 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  52798 KiB | 392988 KiB |  86255 GiB |  86255 GiB |
|       from large pool |  50762 KiB | 392048 KiB |  84290 GiB |  84290 GiB |
|       from small pool |   2036 KiB |   7624 KiB |   1964 GiB |   1964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1159    |   22144 K  |   22144 K  |
|       from large pool |      79    |     423    |   14981 K  |   14981 K  |
|       from small pool |     709    |    1005    |    7163 K  |    7162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1159    |   22144 K  |   22144 K  |
|       from large pool |      79    |     423    |   14981 K  |   14981 K  |
|       from small pool |     709    |    1005    |    7163 K  |    7162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     201    |     201    |     201    |       0    |
|       from large pool |     182    |     182    |     182    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      34    |     218    |   15948 K  |   15948 K  |
|       from large pool |      10    |     183    |   11715 K  |   11715 K  |
|       from small pool |      24    |     208    |    4233 K  |    4233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 165413 GiB | 165413 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 163514 GiB | 163514 GiB |
|       from small pool |      0 KiB |     32 MiB |   1899 GiB |   1899 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 165413 GiB | 165413 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 163514 GiB | 163514 GiB |
|       from small pool |      0 KiB |     32 MiB |   1899 GiB |   1899 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 165402 GiB | 165402 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 163505 GiB | 163505 GiB |
|       from small pool |      0 KiB |     32 MiB |   1897 GiB |   1897 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   4434 MiB |   4434 MiB |   4190 MiB |
|       from large pool | 231424 KiB |   4396 MiB |   4396 MiB |   4170 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |  86255 GiB |  86255 GiB |
|       from large pool |  30464 KiB | 392048 KiB |  84291 GiB |  84290 GiB |
|       from small pool |      0 KiB |  11194 KiB |   1964 GiB |   1964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   22144 K  |   22144 K  |
|       from large pool |       2    |     423    |   14981 K  |   14981 K  |
|       from small pool |       0    |    1005    |    7163 K  |    7163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   22144 K  |   22144 K  |
|       from large pool |       2    |     423    |   14981 K  |   14981 K  |
|       from small pool |       0    |    1005    |    7163 K  |    7163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |     201    |     201    |     181    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   15948 K  |   15948 K  |
|       from large pool |       3    |     183    |   11715 K  |   11715 K  |
|       from small pool |       0    |     208    |    4233 K  |    4233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 165413 GiB | 165413 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 163514 GiB | 163514 GiB |
|       from small pool |      0 KiB |     32 MiB |   1899 GiB |   1899 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 165413 GiB | 165413 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 163514 GiB | 163514 GiB |
|       from small pool |      0 KiB |     32 MiB |   1899 GiB |   1899 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 165402 GiB | 165402 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 163505 GiB | 163505 GiB |
|       from small pool |      0 KiB |     32 MiB |   1897 GiB |   1897 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 249856 KiB |   4434 MiB |   4434 MiB |   4190 MiB |
|       from large pool | 231424 KiB |   4396 MiB |   4396 MiB |   4170 MiB |
|       from small pool |  18432 KiB |     38 MiB |     38 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 392988 KiB |  86255 GiB |  86255 GiB |
|       from large pool |  30464 KiB | 392048 KiB |  84291 GiB |  84290 GiB |
|       from small pool |      0 KiB |  11194 KiB |   1964 GiB |   1964 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1159    |   22144 K  |   22144 K  |
|       from large pool |       2    |     423    |   14981 K  |   14981 K  |
|       from small pool |       0    |    1005    |    7163 K  |    7163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1159    |   22144 K  |   22144 K  |
|       from large pool |       2    |     423    |   14981 K  |   14981 K  |
|       from small pool |       0    |    1005    |    7163 K  |    7163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      20    |     201    |     201    |     181    |
|       from large pool |      11    |     182    |     182    |     171    |
|       from small pool |       9    |      19    |      19    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   15948 K  |   15948 K  |
|       from large pool |       3    |     183    |   11715 K  |   11715 K  |
|       from small pool |       0    |     208    |    4233 K  |    4233 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808

 Experiment start at: 2024-07-20 13:53:28.687607
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.72265625, 'precision': 0.7235878, 'recall': 0.7221683, 'specificity': 0.7221683, 'f1': 0.72204554, 'auroc': 0.7885104, 'binary_precision': 0.7120482, 'binary_recall': 0.7596401, 'binary_specificity': 0.68469656, 'binary_f1_score': 0.73507464}
confusion matrix:
      0     1
0  1038   478
1   374  1182
---- Validation: 
scalar performance:
{'acc': 0.50507414, 'precision': 0.49786612, 'recall': 0.49902713, 'specificity': 0.49902713, 'f1': 0.42305166, 'auroc': 0.64464194, 'binary_precision': 0.48809522, 'binary_recall': 0.13015874, 'binary_specificity': 0.86789554, 'binary_f1_score': 0.20551379}
confusion matrix:
     0   1
0  565  86
1  548  82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.52444446, 'precision': 0.5552431, 'recall': 0.52444446, 'specificity': 0.52444446, 'f1': 0.44742823, 'auroc': 0.66569877, 'binary_precision': 0.5964912, 'binary_recall': 0.15111111, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.24113475}
confusion matrix:
     0   1
0  202  23
1  191  34
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:55:17.776011,epoch time: 0:01:49.088404,used: 0:01:49.088404,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.79264325, 'precision': 0.79783845, 'recall': 0.7935259, 'specificity': 0.7935259, 'f1': 0.7920433, 'auroc': 0.8668646, 'binary_precision': 0.84074074, 'binary_recall': 0.72896594, 'binary_specificity': 0.8580858, 'binary_f1_score': 0.7808737}
confusion matrix:
      0     1
0  1300   215
1   422  1135
---- Validation: 
scalar performance:
{'acc': 0.5261514, 'precision': 0.54596746, 'recall': 0.51999485, 'specificity': 0.51999485, 'f1': 0.44415706, 'auroc': 0.68244946, 'binary_precision': 0.572327, 'binary_recall': 0.14444445, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.23067173}
confusion matrix:
     0   1
0  583  68
1  539  91
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5177778, 'precision': 0.54664177, 'recall': 0.5177778, 'specificity': 0.5177778, 'f1': 0.42951787, 'auroc': 0.67976296, 'binary_precision': 0.5833333, 'binary_recall': 0.12444445, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.20512822}
confusion matrix:
     0   1
0  205  20
1  197  28
better model found
persisted
after epoch: 2,now: 2024-07-20 13:57:04.135174,epoch time: 0:01:46.359163,used: 0:03:35.447567,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.8541667, 'precision': 0.8601789, 'recall': 0.85488385, 'specificity': 0.85488385, 'f1': 0.8537187, 'auroc': 0.92134696, 'binary_precision': 0.90956265, 'binary_recall': 0.7900837, 'binary_specificity': 0.919684, 'binary_f1_score': 0.8456237}
confusion matrix:
      0     1
0  1397   122
1   326  1227
---- Validation: 
scalar performance:
{'acc': 0.5511319, 'precision': 0.602368, 'recall': 0.5450077, 'specificity': 0.5450077, 'f1': 0.47419837, 'auroc': 0.72774243, 'binary_precision': 0.6708075, 'binary_recall': 0.17142858, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.27307206}
confusion matrix:
     0    1
0  598   53
1  522  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5177778, 'precision': 0.55487806, 'recall': 0.5177778, 'specificity': 0.5177778, 'f1': 0.4196999, 'auroc': 0.72519505, 'binary_precision': 0.6, 'binary_recall': 0.10666667, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.18113208}
confusion matrix:
     0   1
0  209  16
1  201  24
better model found
persisted
after epoch: 3,now: 2024-07-20 13:58:50.844518,epoch time: 0:01:46.709344,used: 0:05:22.156911,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.8746745, 'precision': 0.8803017, 'recall': 0.8753545, 'specificity': 0.8753545, 'f1': 0.87433785, 'auroc': 0.9318726, 'binary_precision': 0.92941177, 'binary_recall': 0.8139086, 'binary_specificity': 0.93680054, 'binary_f1_score': 0.86783385}
confusion matrix:
      0     1
0  1423    96
1   289  1264
---- Validation: 
scalar performance:
{'acc': 0.5948478, 'precision': 0.65563035, 'recall': 0.5895289, 'specificity': 0.5895289, 'f1': 0.54393643, 'auroc': 0.7572379, 'binary_precision': 0.7488789, 'binary_recall': 0.26507938, 'binary_specificity': 0.9139785, 'binary_f1_score': 0.3915592}
confusion matrix:
     0    1
0  595   56
1  463  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56, 'precision': 0.62458473, 'recall': 0.56, 'specificity': 0.56, 'f1': 0.4944853, 'auroc': 0.75587165, 'binary_precision': 0.71428573, 'binary_recall': 0.2, 'binary_specificity': 0.92, 'binary_f1_score': 0.3125}
confusion matrix:
     0   1
0  207  18
1  180  45
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 14:00:37.329820,epoch time: 0:01:46.485302,used: 0:07:08.642213,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8909505, 'precision': 0.8940706, 'recall': 0.8915756, 'specificity': 0.8915756, 'f1': 0.8908278, 'auroc': 0.9472219, 'binary_precision': 0.9327195, 'binary_recall': 0.84585744, 'binary_specificity': 0.9372937, 'binary_f1_score': 0.8871674}
confusion matrix:
      0     1
0  1420    95
1   240  1317
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.6764503, 'recall': 0.61420894, 'specificity': 0.61420894, 'f1': 0.5799097, 'auroc': 0.775281, 'binary_precision': 0.77307695, 'binary_recall': 0.31904763, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.4516854}
confusion matrix:
     0    1
0  592   59
1  429  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5688889, 'precision': 0.6296035, 'recall': 0.5688889, 'specificity': 0.5688889, 'f1': 0.5117012, 'auroc': 0.7748346, 'binary_precision': 0.7183099, 'binary_recall': 0.22666667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.3445946}
confusion matrix:
     0   1
0  205  20
1  174  51
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-20 14:02:23.993701,epoch time: 0:01:46.663881,used: 0:08:55.306094,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8961589, 'precision': 0.90186435, 'recall': 0.89695096, 'specificity': 0.89695096, 'f1': 0.8959074, 'auroc': 0.95239043, 'binary_precision': 0.95311356, 'binary_recall': 0.8361183, 'binary_specificity': 0.95778364, 'binary_f1_score': 0.8907909}
confusion matrix:
      0     1
0  1452    64
1   255  1301
---- Validation: 
scalar performance:
{'acc': 0.61202186, 'precision': 0.6794405, 'recall': 0.6068356, 'specificity': 0.6068356, 'f1': 0.5657885, 'auroc': 0.7927096, 'binary_precision': 0.7854077, 'binary_recall': 0.2904762, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.424102}
confusion matrix:
     0    1
0  601   50
1  447  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6353383, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5133772, 'auroc': 0.79723454, 'binary_precision': 0.7285714, 'binary_recall': 0.22666667, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.34576273}
confusion matrix:
     0   1
0  206  19
1  174  51
new oracle model saved
early stop counter: 1
val acc:0.6120218634605408, best validation acc: 0.6190476417541504, corresponding to test acc:                         0.5688889026641846 / 0.5711110830307007
after epoch: 6,now: 2024-07-20 14:04:10.517617,epoch time: 0:01:46.523916,used: 0:10:41.830010,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.90559894, 'precision': 0.909726, 'recall': 0.9062369, 'specificity': 0.9062369, 'f1': 0.90544486, 'auroc': 0.9583032, 'binary_precision': 0.95405596, 'binary_recall': 0.85466236, 'binary_specificity': 0.9578115, 'binary_f1_score': 0.9016282}
confusion matrix:
      0     1
0  1453    64
1   226  1329
---- Validation: 
scalar performance:
{'acc': 0.62138957, 'precision': 0.6868965, 'recall': 0.61638504, 'specificity': 0.61638504, 'f1': 0.57957226, 'auroc': 0.80344284, 'binary_precision': 0.79352224, 'binary_recall': 0.31111112, 'binary_specificity': 0.921659, 'binary_f1_score': 0.44697833}
confusion matrix:
     0    1
0  600   51
1  434  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58, 'precision': 0.64555776, 'recall': 0.58, 'specificity': 0.58, 'f1': 0.5267086, 'auroc': 0.80950123, 'binary_precision': 0.7432432, 'binary_recall': 0.24444444, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.36789298}
confusion matrix:
     0   1
0  206  19
1  170  55
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-20 14:05:57.015279,epoch time: 0:01:46.497662,used: 0:12:28.327672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9121094, 'precision': 0.9167706, 'recall': 0.9127459, 'specificity': 0.9127459, 'f1': 0.9119419, 'auroc': 0.9623946, 'binary_precision': 0.96387285, 'binary_recall': 0.85842985, 'binary_specificity': 0.96706194, 'binary_f1_score': 0.9081008}
confusion matrix:
      0     1
0  1468    50
1   220  1334
---- Validation: 
scalar performance:
{'acc': 0.63544106, 'precision': 0.6990492, 'recall': 0.6306708, 'specificity': 0.6306708, 'f1': 0.5990342, 'auroc': 0.8147075, 'binary_precision': 0.80754715, 'binary_recall': 0.33968255, 'binary_specificity': 0.921659, 'binary_f1_score': 0.4782123}
confusion matrix:
     0    1
0  600   51
1  416  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5977778, 'precision': 0.6672297, 'recall': 0.5977778, 'specificity': 0.5977778, 'f1': 0.55117786, 'auroc': 0.82403946, 'binary_precision': 0.775, 'binary_recall': 0.27555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.40655738}
confusion matrix:
     0   1
0  207  18
1  163  62
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 14:07:43.580094,epoch time: 0:01:46.564815,used: 0:14:14.892487,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.91187835, 'recall': 0.91007423, 'specificity': 0.91007423, 'f1': 0.90944076, 'auroc': 0.9632336, 'binary_precision': 0.94692737, 'binary_recall': 0.8703466, 'binary_specificity': 0.94980186, 'binary_f1_score': 0.90702343}
confusion matrix:
      0     1
0  1438    76
1   202  1356
---- Validation: 
scalar performance:
{'acc': 0.68774396, 'precision': 0.732486, 'recall': 0.6840502, 'specificity': 0.6840502, 'f1': 0.6692384, 'auroc': 0.82084215, 'binary_precision': 0.8304598, 'binary_recall': 0.45873016, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.59100205}
confusion matrix:
     0    1
0  592   59
1  341  289
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6666667, 'precision': 0.7076923, 'recall': 0.6666667, 'specificity': 0.6666667, 'f1': 0.64935064, 'auroc': 0.8319012, 'binary_precision': 0.8, 'binary_recall': 0.44444445, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.57142854}
confusion matrix:
     0    1
0  200   25
1  125  100
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-20 14:09:30.245614,epoch time: 0:01:46.665520,used: 0:16:01.558007,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9238281, 'precision': 0.929163, 'recall': 0.9245783, 'specificity': 0.9245783, 'f1': 0.9236696, 'auroc': 0.9708694, 'binary_precision': 0.9803779, 'binary_recall': 0.8669666, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.920191}
confusion matrix:
      0     1
0  1489    27
1   207  1349
---- Validation: 
scalar performance:
{'acc': 0.6627635, 'precision': 0.72701097, 'recall': 0.6582949, 'specificity': 0.6582949, 'f1': 0.633319, 'auroc': 0.83234584, 'binary_precision': 0.84375, 'binary_recall': 0.3857143, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.52941173}
confusion matrix:
     0    1
0  606   45
1  387  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64666665, 'precision': 0.70634174, 'recall': 0.64666665, 'specificity': 0.64666665, 'f1': 0.61912924, 'auroc': 0.8463605, 'binary_precision': 0.8173077, 'binary_recall': 0.37777779, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5167173}
confusion matrix:
     0   1
0  206  19
1  140  85
early stop counter: 1
val acc:0.6627634763717651, best validation acc: 0.6877439618110657, corresponding to test acc:                         0.6666666865348816 / 0.6666666865348816
after epoch: 10,now: 2024-07-20 14:11:16.081550,epoch time: 0:01:45.835936,used: 0:17:47.393943,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9163411, 'precision': 0.9217398, 'recall': 0.91698307, 'specificity': 0.91698307, 'f1': 0.91614914, 'auroc': 0.9725727, 'binary_precision': 0.9723032, 'binary_recall': 0.8589826, 'binary_specificity': 0.9749835, 'binary_f1_score': 0.91213673}
confusion matrix:
      0     1
0  1481    38
1   219  1334
---- Validation: 
scalar performance:
{'acc': 0.67993754, 'precision': 0.73552084, 'recall': 0.67585766, 'specificity': 0.67585766, 'f1': 0.6567416, 'auroc': 0.8394387, 'binary_precision': 0.8459119, 'binary_recall': 0.42698413, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.56751055}
confusion matrix:
     0    1
0  602   49
1  361  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67777777, 'precision': 0.7297325, 'recall': 0.67777777, 'specificity': 0.67777777, 'f1': 0.6584681, 'auroc': 0.85422224, 'binary_precision': 0.83898306, 'binary_recall': 0.44, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.5772595}
confusion matrix:
     0   1
0  206  19
1  126  99
new oracle model saved
early stop counter: 2
val acc:0.6799375414848328, best validation acc: 0.6877439618110657, corresponding to test acc:                         0.6666666865348816 / 0.6777777671813965
after epoch: 11,now: 2024-07-20 14:13:02.191842,epoch time: 0:01:46.110292,used: 0:19:33.504235,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.921875, 'precision': 0.92654127, 'recall': 0.92247075, 'specificity': 0.92247075, 'f1': 0.9217261, 'auroc': 0.9733138, 'binary_precision': 0.97400725, 'binary_recall': 0.8686413, 'binary_specificity': 0.9763002, 'binary_f1_score': 0.91831183}
confusion matrix:
      0     1
0  1483    36
1   204  1349
---- Validation: 
scalar performance:
{'acc': 0.704918, 'precision': 0.7499213, 'recall': 0.7013569, 'specificity': 0.7013569, 'f1': 0.6886282, 'auroc': 0.8429595, 'binary_precision': 0.8519553, 'binary_recall': 0.48412699, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.61740893}
confusion matrix:
     0    1
0  598   53
1  325  305
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7177778, 'precision': 0.75606185, 'recall': 0.7177778, 'specificity': 0.7177778, 'f1': 0.7068193, 'auroc': 0.8594568, 'binary_precision': 0.85507244, 'binary_recall': 0.52444446, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.6501378}
confusion matrix:
     0    1
0  205   20
1  107  118
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 14:14:48.804006,epoch time: 0:01:46.612164,used: 0:21:20.116399,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9326172, 'precision': 0.93568623, 'recall': 0.9331306, 'specificity': 0.9331306, 'f1': 0.93254423, 'auroc': 0.9795971, 'binary_precision': 0.97529995, 'binary_recall': 0.88931787, 'binary_specificity': 0.9769434, 'binary_f1_score': 0.93032646}
confusion matrix:
      0     1
0  1483    35
1   172  1382
---- Validation: 
scalar performance:
{'acc': 0.72287273, 'precision': 0.7589773, 'recall': 0.71973884, 'specificity': 0.71973884, 'f1': 0.7109659, 'auroc': 0.8506839, 'binary_precision': 0.8516624, 'binary_recall': 0.5285714, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.65230167}
confusion matrix:
     0    1
0  593   58
1  297  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74, 'precision': 0.7649137, 'recall': 0.74, 'specificity': 0.74, 'f1': 0.7337399, 'auroc': 0.86980736, 'binary_precision': 0.84615386, 'binary_recall': 0.58666664, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.69291335}
confusion matrix:
     0    1
0  201   24
1   93  132
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 14:16:35.379065,epoch time: 0:01:46.575059,used: 0:23:06.691458,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.92610675, 'precision': 0.9302448, 'recall': 0.92673576, 'specificity': 0.92673576, 'f1': 0.9259919, 'auroc': 0.97446394, 'binary_precision': 0.9756447, 'binary_recall': 0.87588423, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9230769}
confusion matrix:
      0     1
0  1483    34
1   193  1362
---- Validation: 
scalar performance:
{'acc': 0.7275566, 'precision': 0.7667309, 'recall': 0.7243471, 'specificity': 0.7243471, 'f1': 0.7152798, 'auroc': 0.8553288, 'binary_precision': 0.86493504, 'binary_recall': 0.5285714, 'binary_specificity': 0.92012286, 'binary_f1_score': 0.65615755}
confusion matrix:
     0    1
0  599   52
1  297  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76222223, 'precision': 0.7877363, 'recall': 0.76222223, 'specificity': 0.76222223, 'f1': 0.7568317, 'auroc': 0.8769975, 'binary_precision': 0.87341774, 'binary_recall': 0.61333334, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.72062665}
confusion matrix:
     0    1
0  205   20
1   87  138
new oracle model saved
better model found
persisted
after epoch: 14,now: 2024-07-20 14:18:22.701449,epoch time: 0:01:47.322384,used: 0:24:54.013842,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9313151, 'precision': 0.9345012, 'recall': 0.93192995, 'specificity': 0.93192995, 'f1': 0.93124366, 'auroc': 0.97889525, 'binary_precision': 0.9752825, 'binary_recall': 0.8869621, 'binary_specificity': 0.9768977, 'binary_f1_score': 0.9290279}
confusion matrix:
      0     1
0  1480    35
1   176  1381
---- Validation: 
scalar performance:
{'acc': 0.7275566, 'precision': 0.7659764, 'recall': 0.72437274, 'specificity': 0.72437274, 'f1': 0.715472, 'auroc': 0.8589728, 'binary_precision': 0.8630491, 'binary_recall': 0.53015876, 'binary_specificity': 0.9185868, 'binary_f1_score': 0.6568339}
confusion matrix:
     0    1
0  598   53
1  296  334
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.77111113, 'precision': 0.79112935, 'recall': 0.77111113, 'specificity': 0.77111113, 'f1': 0.76710767, 'auroc': 0.88458276, 'binary_precision': 0.8674699, 'binary_recall': 0.64, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.73657286}
confusion matrix:
     0    1
0  203   22
1   81  144
new oracle model saved
early stop counter: 1
val acc:0.727556586265564, best validation acc: 0.727556586265564, corresponding to test acc:                         0.7622222304344177 / 0.7711111307144165
after epoch: 15,now: 2024-07-20 14:20:09.062057,epoch time: 0:01:46.360608,used: 0:26:40.374450,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.94108075, 'precision': 0.9427788, 'recall': 0.9415371, 'specificity': 0.9415371, 'f1': 0.9410559, 'auroc': 0.9800696, 'binary_precision': 0.9738292, 'binary_recall': 0.9081567, 'binary_specificity': 0.9749175, 'binary_f1_score': 0.9398471}
confusion matrix:
      0     1
0  1477    38
1   143  1414
---- Validation: 
scalar performance:
{'acc': 0.7478532, 'precision': 0.7733635, 'recall': 0.7452893, 'specificity': 0.7452893, 'f1': 0.7404744, 'auroc': 0.86112213, 'binary_precision': 0.85287356, 'binary_recall': 0.5888889, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.6967136}
confusion matrix:
     0    1
0  587   64
1  259  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8088889, 'precision': 0.8189699, 'recall': 0.8088889, 'specificity': 0.8088889, 'f1': 0.80736685, 'auroc': 0.89283943, 'binary_precision': 0.8756757, 'binary_recall': 0.72, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.79024386}
confusion matrix:
     0    1
0  202   23
1   63  162
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 14:21:55.472710,epoch time: 0:01:46.410653,used: 0:28:26.785103,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.9394531, 'precision': 0.9412371, 'recall': 0.93984926, 'specificity': 0.93984926, 'f1': 0.93942165, 'auroc': 0.9820638, 'binary_precision': 0.9723757, 'binary_recall': 0.9060489, 'binary_specificity': 0.97364956, 'binary_f1_score': 0.9380412}
confusion matrix:
      0     1
0  1478    40
1   146  1408
---- Validation: 
scalar performance:
{'acc': 0.74473065, 'precision': 0.7728615, 'recall': 0.7420379, 'specificity': 0.7420379, 'f1': 0.73653, 'auroc': 0.86467946, 'binary_precision': 0.8564706, 'binary_recall': 0.5777778, 'binary_specificity': 0.906298, 'binary_f1_score': 0.6900474}
confusion matrix:
     0    1
0  590   61
1  266  364
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.81726944, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7998491, 'auroc': 0.8934518, 'binary_precision': 0.8863636, 'binary_recall': 0.6933333, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.7780549}
confusion matrix:
     0    1
0  205   20
1   69  156
early stop counter: 1
val acc:0.7447306513786316, best validation acc: 0.7478532195091248, corresponding to test acc:                         0.8088889122009277 / 0.8088889122009277
after epoch: 17,now: 2024-07-20 14:23:42.010165,epoch time: 0:01:46.537455,used: 0:30:13.322558,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9348958, 'precision': 0.9391374, 'recall': 0.9355631, 'specificity': 0.9355631, 'f1': 0.93479633, 'auroc': 0.983009, 'binary_precision': 0.98567337, 'binary_recall': 0.88431877, 'binary_specificity': 0.9868074, 'binary_f1_score': 0.9322493}
confusion matrix:
      0     1
0  1496    20
1   180  1376
---- Validation: 
scalar performance:
{'acc': 0.7291179, 'precision': 0.7717366, 'recall': 0.7258065, 'specificity': 0.7258065, 'f1': 0.7161305, 'auroc': 0.8648014, 'binary_precision': 0.8753316, 'binary_recall': 0.52380955, 'binary_specificity': 0.9278034, 'binary_f1_score': 0.65541214}
confusion matrix:
     0    1
0  604   47
1  300  330
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7777778, 'precision': 0.8039292, 'recall': 0.7777778, 'specificity': 0.7777778, 'f1': 0.7728925, 'auroc': 0.8977976, 'binary_precision': 0.8930818, 'binary_recall': 0.6311111, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7395833}
confusion matrix:
     0    1
0  208   17
1   83  142
early stop counter: 2
val acc:0.7291178703308105, best validation acc: 0.7478532195091248, corresponding to test acc:                         0.8088889122009277 / 0.8088889122009277
after epoch: 18,now: 2024-07-20 14:25:28.110519,epoch time: 0:01:46.100354,used: 0:31:59.422912,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.93684894, 'precision': 0.93901145, 'recall': 0.9373863, 'specificity': 0.9373863, 'f1': 0.9368123, 'auroc': 0.9849793, 'binary_precision': 0.9736111, 'binary_recall': 0.89987165, 'binary_specificity': 0.9749009, 'binary_f1_score': 0.9352902}
confusion matrix:
      0     1
0  1476    38
1   156  1402
---- Validation: 
scalar performance:
{'acc': 0.7494145, 'precision': 0.77751756, 'recall': 0.74674857, 'specificity': 0.74674857, 'f1': 0.7415106, 'auroc': 0.86746883, 'binary_precision': 0.8618267, 'binary_recall': 0.584127, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.6963103}
confusion matrix:
     0    1
0  592   59
1  262  368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8111111, 'precision': 0.82179636, 'recall': 0.8111111, 'specificity': 0.8111111, 'f1': 0.80953, 'auroc': 0.90155053, 'binary_precision': 0.8804348, 'binary_recall': 0.72, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.7921761}
confusion matrix:
     0    1
0  203   22
1   63  162
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 14:27:14.352048,epoch time: 0:01:46.241529,used: 0:33:45.664441,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9319661, 'precision': 0.9362131, 'recall': 0.9326701, 'specificity': 0.9326701, 'f1': 0.9318639, 'auroc': 0.98310864, 'binary_precision': 0.982808, 'binary_recall': 0.8811818, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.9292245}
confusion matrix:
      0     1
0  1491    24
1   185  1372
---- Validation: 
scalar performance:
{'acc': 0.7236534, 'precision': 0.76967216, 'recall': 0.7201997, 'specificity': 0.7201997, 'f1': 0.7092624, 'auroc': 0.8676225, 'binary_precision': 0.8770492, 'binary_recall': 0.5095238, 'binary_specificity': 0.9308756, 'binary_f1_score': 0.6445783}
confusion matrix:
     0    1
0  606   45
1  309  321
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7911111, 'precision': 0.81673795, 'recall': 0.7911111, 'specificity': 0.7911111, 'f1': 0.7867987, 'auroc': 0.9023013, 'binary_precision': 0.9068323, 'binary_recall': 0.6488889, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.7564767}
confusion matrix:
     0    1
0  210   15
1   79  146
early stop counter: 1
val acc:0.7236533761024475, best validation acc: 0.7494145035743713, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 20,now: 2024-07-20 14:29:00.639019,epoch time: 0:01:46.286971,used: 0:35:31.951412,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.94140625, 'precision': 0.9440814, 'recall': 0.9419128, 'specificity': 0.9419128, 'f1': 0.94135594, 'auroc': 0.98510563, 'binary_precision': 0.98177993, 'binary_recall': 0.9009646, 'binary_specificity': 0.9828609, 'binary_f1_score': 0.9396378}
confusion matrix:
      0     1
0  1491    26
1   154  1401
---- Validation: 
scalar performance:
{'acc': 0.7314598, 'precision': 0.77098733, 'recall': 0.7282642, 'specificity': 0.7282642, 'f1': 0.7194538, 'auroc': 0.8678419, 'binary_precision': 0.8704663, 'binary_recall': 0.53333336, 'binary_specificity': 0.92319506, 'binary_f1_score': 0.66141737}
confusion matrix:
     0    1
0  601   50
1  294  336
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80222225, 'precision': 0.82453763, 'recall': 0.80222225, 'specificity': 0.80222225, 'f1': 0.7987629, 'auroc': 0.9055605, 'binary_precision': 0.9096386, 'binary_recall': 0.6711111, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.7723785}
confusion matrix:
     0    1
0  210   15
1   74  151
early stop counter: 2
val acc:0.7314597964286804, best validation acc: 0.7494145035743713, corresponding to test acc:                         0.8111110925674438 / 0.8111110925674438
after epoch: 21,now: 2024-07-20 14:30:46.935675,epoch time: 0:01:46.296656,used: 0:37:18.248068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9501953, 'precision': 0.950662, 'recall': 0.95042527, 'specificity': 0.95042527, 'f1': 0.9501929, 'auroc': 0.9866957, 'binary_precision': 0.96858287, 'binary_recall': 0.9318328, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.94985247}
confusion matrix:
      0     1
0  1470    47
1   106  1449
---- Validation: 
scalar performance:
{'acc': 0.75565964, 'precision': 0.77916646, 'recall': 0.7532258, 'specificity': 0.7532258, 'f1': 0.74917316, 'auroc': 0.87018263, 'binary_precision': 0.8561798, 'binary_recall': 0.6047619, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.7088372}
confusion matrix:
     0    1
0  587   64
1  249  381
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82666665, 'precision': 0.8325792, 'recall': 0.82666665, 'specificity': 0.82666665, 'f1': 0.82589287, 'auroc': 0.90664697, 'binary_precision': 0.8769231, 'binary_recall': 0.76, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.8142857}
confusion matrix:
     0    1
0  201   24
1   54  171
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 14:32:33.445876,epoch time: 0:01:46.510201,used: 0:39:04.758269,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.94628906, 'precision': 0.94830674, 'recall': 0.94668245, 'specificity': 0.94668245, 'f1': 0.9462553, 'auroc': 0.9883387, 'binary_precision': 0.98127604, 'binary_recall': 0.9111397, 'binary_specificity': 0.9822251, 'binary_f1_score': 0.9449082}
confusion matrix:
      0     1
0  1492    27
1   138  1415
---- Validation: 
scalar performance:
{'acc': 0.74004686, 'precision': 0.77845836, 'recall': 0.7369431, 'specificity': 0.7369431, 'f1': 0.72905624, 'auroc': 0.87182844, 'binary_precision': 0.8778626, 'binary_recall': 0.54761904, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.6744868}
confusion matrix:
     0    1
0  603   48
1  285  345
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.82, 'precision': 0.83460015, 'recall': 0.82, 'specificity': 0.82, 'f1': 0.8180148, 'auroc': 0.90826666, 'binary_precision': 0.9044944, 'binary_recall': 0.71555555, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.7990074}
confusion matrix:
     0    1
0  208   17
1   64  161
early stop counter: 1
val acc:0.7400468587875366, best validation acc: 0.7556596398353577, corresponding to test acc:                         0.8266666531562805 / 0.8266666531562805
after epoch: 23,now: 2024-07-20 14:34:19.665442,epoch time: 0:01:46.219566,used: 0:40:50.977835,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.95670575, 'precision': 0.9576163, 'recall': 0.95704925, 'specificity': 0.95704925, 'f1': 0.95669943, 'auroc': 0.99056697, 'binary_precision': 0.9817321, 'binary_recall': 0.93192035, 'binary_specificity': 0.9821782, 'binary_f1_score': 0.9561779}
confusion matrix:
      0     1
0  1488    27
1   106  1451
---- Validation: 
scalar performance:
{'acc': 0.7564403, 'precision': 0.78323877, 'recall': 0.75386584, 'specificity': 0.75386584, 'f1': 0.74924463, 'auroc': 0.8738254, 'binary_precision': 0.8663595, 'binary_recall': 0.5968254, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.70676696}
confusion matrix:
     0    1
0  593   58
1  254  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8377778, 'precision': 0.84615386, 'recall': 0.83777773, 'specificity': 0.83777773, 'f1': 0.83679044, 'auroc': 0.91174316, 'binary_precision': 0.9, 'binary_recall': 0.76, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.8240963}
confusion matrix:
     0    1
0  206   19
1   54  171
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 14:36:06.749178,epoch time: 0:01:47.083736,used: 0:42:38.061571,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.94628906, 'precision': 0.9477406, 'recall': 0.94669116, 'specificity': 0.94669116, 'f1': 0.9462706, 'auroc': 0.9875455, 'binary_precision': 0.9766964, 'binary_recall': 0.91580975, 'binary_specificity': 0.97757256, 'binary_f1_score': 0.94527364}
confusion matrix:
      0     1
0  1482    34
1   131  1425
---- Validation: 
scalar performance:
{'acc': 0.7533177, 'precision': 0.7869091, 'recall': 0.75046086, 'specificity': 0.75046086, 'f1': 0.7444211, 'auroc': 0.8755468, 'binary_precision': 0.88106793, 'binary_recall': 0.5761905, 'binary_specificity': 0.9247312, 'binary_f1_score': 0.696737}
confusion matrix:
     0    1
0  602   49
1  267  363
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.8528226, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8410282, 'auroc': 0.9127704, 'binary_precision': 0.9139785, 'binary_recall': 0.75555557, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.8272506}
confusion matrix:
     0    1
0  209   16
1   55  170
new oracle model saved
early stop counter: 1
val acc:0.7533177137374878, best validation acc: 0.756440281867981, corresponding to test acc:                         0.8377777934074402 / 0.8422222137451172
after epoch: 25,now: 2024-07-20 14:37:53.250279,epoch time: 0:01:46.501101,used: 0:44:24.562672,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9583333, 'precision': 0.95935977, 'recall': 0.95865715, 'specificity': 0.95865715, 'f1': 0.9583248, 'auroc': 0.9926522, 'binary_precision': 0.9843856, 'binary_recall': 0.93247586, 'binary_specificity': 0.9848385, 'binary_f1_score': 0.95772785}
confusion matrix:
      0     1
0  1494    23
1   105  1450
---- Validation: 
scalar performance:
{'acc': 0.7517564, 'precision': 0.7894949, 'recall': 0.74874556, 'specificity': 0.74874556, 'f1': 0.74184513, 'auroc': 0.8770536, 'binary_precision': 0.89, 'binary_recall': 0.5650794, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.6912621}
confusion matrix:
     0    1
0  607   44
1  274  356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8468989, 'recall': 0.8311111, 'specificity': 0.8311111, 'f1': 0.8291674, 'auroc': 0.91608894, 'binary_precision': 0.920904, 'binary_recall': 0.72444445, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.8109453}
confusion matrix:
     0    1
0  211   14
1   62  163
early stop counter: 2
val acc:0.7517564296722412, best validation acc: 0.756440281867981, corresponding to test acc:                         0.8377777934074402 / 0.8422222137451172
after epoch: 26,now: 2024-07-20 14:39:39.396605,epoch time: 0:01:46.146326,used: 0:46:10.708998,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.94889325, 'precision': 0.9507644, 'recall': 0.94936883, 'specificity': 0.94936883, 'f1': 0.9488689, 'auroc': 0.99033296, 'binary_precision': 0.98342544, 'binary_recall': 0.91457933, 'binary_specificity': 0.9841584, 'binary_f1_score': 0.9477537}
confusion matrix:
      0     1
0  1491    24
1   133  1424
---- Validation: 
scalar performance:
{'acc': 0.7564403, 'precision': 0.7897799, 'recall': 0.75360984, 'specificity': 0.75360984, 'f1': 0.7478079, 'auroc': 0.8780972, 'binary_precision': 0.884058, 'binary_recall': 0.5809524, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.70114946}
confusion matrix:
     0    1
0  603   48
1  264  366
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8422222, 'precision': 0.85648143, 'recall': 0.8422222, 'specificity': 0.8422222, 'f1': 0.8406285, 'auroc': 0.9208889, 'binary_precision': 0.92777777, 'binary_recall': 0.74222225, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.82469136}
confusion matrix:
     0    1
0  212   13
1   58  167
early stop counter: 3
val acc:0.756440281867981, best validation acc: 0.756440281867981, corresponding to test acc:                         0.8377777934074402 / 0.8422222137451172
after epoch: 27,now: 2024-07-20 14:41:25.391668,epoch time: 0:01:45.995063,used: 0:47:56.704061,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9485677, 'precision': 0.95038056, 'recall': 0.9490608, 'specificity': 0.9490608, 'f1': 0.9485454, 'auroc': 0.98983467, 'binary_precision': 0.98275864, 'binary_recall': 0.91463417, 'binary_specificity': 0.9834874, 'binary_f1_score': 0.94747347}
confusion matrix:
      0     1
0  1489    25
1   133  1425
---- Validation: 
scalar performance:
{'acc': 0.7626854, 'precision': 0.79411745, 'recall': 0.75995904, 'specificity': 0.75995904, 'f1': 0.75485104, 'auroc': 0.8806842, 'binary_precision': 0.8862559, 'binary_recall': 0.5936508, 'binary_specificity': 0.92626727, 'binary_f1_score': 0.7110266}
confusion matrix:
     0    1
0  603   48
1  256  374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.85333335, 'precision': 0.86370754, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85228, 'auroc': 0.92112595, 'binary_precision': 0.9251337, 'binary_recall': 0.7688889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83980584}
confusion matrix:
     0    1
0  211   14
1   52  173
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 14:43:12.445767,epoch time: 0:01:47.054099,used: 0:49:43.758160,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9534505, 'precision': 0.95518565, 'recall': 0.9539092, 'specificity': 0.9539092, 'f1': 0.9534309, 'auroc': 0.98993665, 'binary_precision': 0.9869146, 'binary_recall': 0.9203597, 'binary_specificity': 0.98745877, 'binary_f1_score': 0.9524759}
confusion matrix:
      0     1
0  1496    19
1   124  1433
---- Validation: 
scalar performance:
{'acc': 0.7408275, 'precision': 0.78456545, 'recall': 0.7375576, 'specificity': 0.7375576, 'f1': 0.7286848, 'auroc': 0.87742174, 'binary_precision': 0.8921053, 'binary_recall': 0.53809524, 'binary_specificity': 0.93701994, 'binary_f1_score': 0.6712871}
confusion matrix:
     0    1
0  610   41
1  291  339
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83555555, 'precision': 0.8544897, 'recall': 0.83555555, 'specificity': 0.83555555, 'f1': 0.83333004, 'auroc': 0.9197234, 'binary_precision': 0.9364162, 'binary_recall': 0.72, 'binary_specificity': 0.95111114, 'binary_f1_score': 0.81407034}
confusion matrix:
     0    1
0  214   11
1   63  162
early stop counter: 1
val acc:0.7408275008201599, best validation acc: 0.7626854181289673, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 29,now: 2024-07-20 14:44:58.849725,epoch time: 0:01:46.403958,used: 0:51:30.162118,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.95735675, 'precision': 0.95887196, 'recall': 0.957721, 'specificity': 0.957721, 'f1': 0.95733994, 'auroc': 0.99217075, 'binary_precision': 0.9883322, 'binary_recall': 0.9266409, 'binary_specificity': 0.98880106, 'binary_f1_score': 0.95649284}
confusion matrix:
      0     1
0  1501    17
1   114  1440
---- Validation: 
scalar performance:
{'acc': 0.7392662, 'precision': 0.78105843, 'recall': 0.73604715, 'specificity': 0.73604715, 'f1': 0.7274246, 'auroc': 0.8764148, 'binary_precision': 0.8854167, 'binary_recall': 0.53968257, 'binary_specificity': 0.9324117, 'binary_f1_score': 0.67061144}
confusion matrix:
     0    1
0  607   44
1  290  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.83111113, 'precision': 0.8442769, 'recall': 0.83111113, 'specificity': 0.83111113, 'f1': 0.8294809, 'auroc': 0.9209087, 'binary_precision': 0.9116022, 'binary_recall': 0.73333335, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.81280786}
confusion matrix:
     0    1
0  209   16
1   60  165
early stop counter: 2
val acc:0.7392662167549133, best validation acc: 0.7626854181289673, corresponding to test acc:                         0.8533333539962769 / 0.8533333539962769
after epoch: 30,now: 2024-07-20 14:46:45.343012,epoch time: 0:01:46.493287,used: 0:53:16.655405,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_53_28_seed_1_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:53:16.655405 at 2024-07-20 14:46:45.343012
persisted model performance metric: 

scalar performance:
{'acc': 0.85333335, 'precision': 0.86370754, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85228, 'auroc': 0.92112595, 'binary_precision': 0.9251337, 'binary_recall': 0.7688889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83980584}
confusion matrix:
     0    1
0  211   14
1   52  173
oracle model performance metric: 

scalar performance:
{'acc': 0.85333335, 'precision': 0.86370754, 'recall': 0.85333335, 'specificity': 0.85333335, 'f1': 0.85228, 'auroc': 0.92112595, 'binary_precision': 0.9251337, 'binary_recall': 0.7688889, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.83980584}
confusion matrix:
     0    1
0  211   14
1   52  173
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   4046 MiB | 330900 GiB | 330900 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 327092 GiB | 327092 GiB |
|       from small pool |  16402 KiB |     36 MiB |   3808 GiB |   3808 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   4046 MiB | 330900 GiB | 330900 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 327092 GiB | 327092 GiB |
|       from small pool |  16402 KiB |     36 MiB |   3808 GiB |   3808 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   4045 MiB | 330876 GiB | 330876 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 327072 GiB | 327072 GiB |
|       from small pool |  16210 KiB |     36 MiB |   3804 GiB |   3804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4424 MiB |   4434 MiB |   8614 MiB |   4190 MiB |
|       from large pool |   4382 MiB |   4396 MiB |   8552 MiB |   4170 MiB |
|       from small pool |     42 MiB |     42 MiB |     62 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  33763 KiB | 398560 KiB | 175080 GiB | 175080 GiB |
|       from large pool |  31733 KiB | 397444 KiB | 171141 GiB | 171141 GiB |
|       from small pool |   2030 KiB |  11194 KiB |   3939 GiB |   3939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1171    |   44330 K  |   44329 K  |
|       from large pool |      79    |     423    |   29967 K  |   29967 K  |
|       from small pool |     721    |    1017    |   14363 K  |   14362 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1171    |   44330 K  |   44329 K  |
|       from large pool |      79    |     423    |   29967 K  |   29967 K  |
|       from small pool |     721    |    1017    |   14363 K  |   14362 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     202    |     202    |     383    |     181    |
|       from large pool |     181    |     182    |     352    |     171    |
|       from small pool |      21    |      21    |      31    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     218    |   31692 K  |   31692 K  |
|       from large pool |      11    |     186    |   23142 K  |   23142 K  |
|       from small pool |      21    |     208    |    8550 K  |    8550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 330900 GiB | 330900 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 327092 GiB | 327092 GiB |
|       from small pool |      0 KiB |     36 MiB |   3808 GiB |   3808 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 330900 GiB | 330900 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 327092 GiB | 327092 GiB |
|       from small pool |      0 KiB |     36 MiB |   3808 GiB |   3808 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 330876 GiB | 330876 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 327072 GiB | 327072 GiB |
|       from small pool |      0 KiB |     36 MiB |   3804 GiB |   3804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   4434 MiB |   8614 MiB |   8390 MiB |
|       from large pool | 210944 KiB |   4396 MiB |   8552 MiB |   8346 MiB |
|       from small pool |  18432 KiB |     42 MiB |     62 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB | 175080 GiB | 175080 GiB |
|       from large pool |  30464 KiB | 397444 KiB | 171141 GiB | 171141 GiB |
|       from small pool |      0 KiB |  11194 KiB |   3939 GiB |   3939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   44330 K  |   44330 K  |
|       from large pool |       2    |     423    |   29967 K  |   29967 K  |
|       from small pool |       0    |    1017    |   14363 K  |   14363 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   44330 K  |   44330 K  |
|       from large pool |       2    |     423    |   29967 K  |   29967 K  |
|       from small pool |       0    |    1017    |   14363 K  |   14363 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |     202    |     383    |     364    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |       9    |      21    |      31    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   31693 K  |   31693 K  |
|       from large pool |       3    |     186    |   23142 K  |   23142 K  |
|       from small pool |       0    |     208    |    8550 K  |    8550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 330900 GiB | 330900 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 327092 GiB | 327092 GiB |
|       from small pool |      0 KiB |     36 MiB |   3808 GiB |   3808 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 330900 GiB | 330900 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 327092 GiB | 327092 GiB |
|       from small pool |      0 KiB |     36 MiB |   3808 GiB |   3808 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 330876 GiB | 330876 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 327072 GiB | 327072 GiB |
|       from small pool |      0 KiB |     36 MiB |   3804 GiB |   3804 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   4434 MiB |   8614 MiB |   8390 MiB |
|       from large pool | 210944 KiB |   4396 MiB |   8552 MiB |   8346 MiB |
|       from small pool |  18432 KiB |     42 MiB |     62 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB | 175080 GiB | 175080 GiB |
|       from large pool |  30464 KiB | 397444 KiB | 171141 GiB | 171141 GiB |
|       from small pool |      0 KiB |  11194 KiB |   3939 GiB |   3939 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   44330 K  |   44330 K  |
|       from large pool |       2    |     423    |   29967 K  |   29967 K  |
|       from small pool |       0    |    1017    |   14363 K  |   14363 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   44330 K  |   44330 K  |
|       from large pool |       2    |     423    |   29967 K  |   29967 K  |
|       from small pool |       0    |    1017    |   14363 K  |   14363 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |     202    |     383    |     364    |
|       from large pool |      10    |     182    |     352    |     342    |
|       from small pool |       9    |      21    |      31    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   31693 K  |   31693 K  |
|       from large pool |       3    |     186    |   23142 K  |   23142 K  |
|       from small pool |       0    |     208    |    8550 K  |    8550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808

 Experiment start at: 2024-07-20 14:47:42.559552
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.77159685, 'precision': 0.77159685, 'recall': 0.7716136, 'specificity': 0.7716136, 'f1': 0.77159333, 'auroc': 0.8458259, 'binary_precision': 0.77552354, 'binary_recall': 0.7694805, 'binary_specificity': 0.7737467, 'binary_f1_score': 0.7724902}
confusion matrix:
      0     1
0  1173   343
1   355  1185
---- Validation: 
scalar performance:
{'acc': 0.68701094, 'precision': 0.6907967, 'recall': 0.68474776, 'specificity': 0.68474776, 'f1': 0.68363595, 'auroc': 0.72592103, 'binary_precision': 0.71183205, 'binary_recall': 0.59967846, 'binary_specificity': 0.76981705, 'binary_f1_score': 0.65095985}
confusion matrix:
     0    1
0  505  151
1  249  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47685185, 'precision': 0.47645622, 'recall': 0.47685188, 'specificity': 0.47685188, 'f1': 0.47464484, 'auroc': 0.4537037, 'binary_precision': 0.47340426, 'binary_recall': 0.41203704, 'binary_specificity': 0.5416667, 'binary_f1_score': 0.44059405}
confusion matrix:
     0   1
0  117  99
1  127  89
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:49:30.464932,epoch time: 0:01:47.905380,used: 0:01:47.905380,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.8576571, 'precision': 0.8602269, 'recall': 0.8579901, 'specificity': 0.8579901, 'f1': 0.85747576, 'auroc': 0.92860055, 'binary_precision': 0.89267945, 'binary_recall': 0.8155844, 'binary_specificity': 0.90039575, 'binary_f1_score': 0.8523923}
confusion matrix:
      0     1
0  1365   151
1   284  1256
---- Validation: 
scalar performance:
{'acc': 0.6517997, 'precision': 0.68479896, 'recall': 0.6457827, 'specificity': 0.6457827, 'f1': 0.62988174, 'auroc': 0.72893786, 'binary_precision': 0.75652176, 'binary_recall': 0.41961414, 'binary_specificity': 0.8719512, 'binary_f1_score': 0.5398138}
confusion matrix:
     0    1
0  572   84
1  361  261
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.5220184, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.48200548, 'auroc': 0.5524906, 'binary_precision': 0.53333336, 'binary_recall': 0.25925925, 'binary_specificity': 0.7731481, 'binary_f1_score': 0.34890965}
confusion matrix:
     0   1
0  167  49
1  160  56
new oracle model saved
early stop counter: 1
val acc:0.6517996788024902, best validation acc: 0.6870109438896179, corresponding to test acc:                         0.47685185074806213 / 0.5162037014961243
after epoch: 2,now: 2024-07-20 14:51:15.930157,epoch time: 0:01:45.465225,used: 0:03:33.370605,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.89136124, 'precision': 0.89827996, 'recall': 0.89188397, 'specificity': 0.89188397, 'f1': 0.8909745, 'auroc': 0.94903046, 'binary_precision': 0.95277363, 'binary_recall': 0.82532465, 'binary_specificity': 0.9584433, 'binary_f1_score': 0.88448155}
confusion matrix:
      0     1
0  1453    63
1   269  1271
---- Validation: 
scalar performance:
{'acc': 0.6259781, 'precision': 0.6841671, 'recall': 0.6180888, 'specificity': 0.6180888, 'f1': 0.585359, 'auroc': 0.73143774, 'binary_precision': 0.78125, 'binary_recall': 0.3215434, 'binary_specificity': 0.91463417, 'binary_f1_score': 0.45558083}
confusion matrix:
     0    1
0  600   56
1  422  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.537037, 'precision': 0.55911326, 'recall': 0.537037, 'specificity': 0.537037, 'f1': 0.4893617, 'auroc': 0.6038023, 'binary_precision': 0.5952381, 'binary_recall': 0.23148148, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.33333334}
confusion matrix:
     0   1
0  182  34
1  166  50
new oracle model saved
early stop counter: 2
val acc:0.6259781122207642, best validation acc: 0.6870109438896179, corresponding to test acc:                         0.47685185074806213 / 0.5370370149612427
after epoch: 3,now: 2024-07-20 14:53:01.987014,epoch time: 0:01:46.056857,used: 0:05:19.427462,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.90445024, 'precision': 0.91074526, 'recall': 0.904943, 'specificity': 0.904943, 'f1': 0.9041537, 'auroc': 0.95849085, 'binary_precision': 0.96359587, 'binary_recall': 0.8422078, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.8988219}
confusion matrix:
      0     1
0  1467    49
1   243  1297
---- Validation: 
scalar performance:
{'acc': 0.6173709, 'precision': 0.69125044, 'recall': 0.6087047, 'specificity': 0.6087047, 'f1': 0.56670904, 'auroc': 0.7457038, 'binary_precision': 0.80365294, 'binary_recall': 0.2829582, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.41854936}
confusion matrix:
     0    1
0  613   43
1  446  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.5938722, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.5050483, 'auroc': 0.64212537, 'binary_precision': 0.65384614, 'binary_recall': 0.2361111, 'binary_specificity': 0.875, 'binary_f1_score': 0.34693876}
confusion matrix:
     0   1
0  189  27
1  165  51
new oracle model saved
early stop counter: 3
val acc:0.6173709034919739, best validation acc: 0.6870109438896179, corresponding to test acc:                         0.47685185074806213 / 0.5555555820465088
after epoch: 4,now: 2024-07-20 14:54:47.724418,epoch time: 0:01:45.737404,used: 0:07:05.164866,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.90183246, 'precision': 0.9053935, 'recall': 0.9022068, 'specificity': 0.9022068, 'f1': 0.9016706, 'auroc': 0.95743454, 'binary_precision': 0.9454023, 'binary_recall': 0.8545455, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.8976808}
confusion matrix:
      0     1
0  1440    76
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.63067293, 'precision': 0.69586986, 'recall': 0.6226203, 'specificity': 0.6226203, 'f1': 0.58875936, 'auroc': 0.75813174, 'binary_precision': 0.80241936, 'binary_recall': 0.31993568, 'binary_specificity': 0.9253049, 'binary_f1_score': 0.4574713}
confusion matrix:
     0    1
0  607   49
1  423  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5671296, 'precision': 0.6025977, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.5261797, 'auroc': 0.6746614, 'binary_precision': 0.66292137, 'binary_recall': 0.27314815, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3868853}
confusion matrix:
     0   1
0  186  30
1  157  59
new oracle model saved
early stop counter: 4
val acc:0.6306729316711426, best validation acc: 0.6870109438896179, corresponding to test acc:                         0.47685185074806213 / 0.5671296119689941
after epoch: 5,now: 2024-07-20 14:56:33.263639,epoch time: 0:01:45.539221,used: 0:08:50.704087,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.90870416, 'precision': 0.91554755, 'recall': 0.9092151, 'specificity': 0.9092151, 'f1': 0.90839684, 'auroc': 0.9626028, 'binary_precision': 0.9708738, 'binary_recall': 0.84415585, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.9030913}
confusion matrix:
      0     1
0  1477    39
1   240  1300
---- Validation: 
scalar performance:
{'acc': 0.6181534, 'precision': 0.70031, 'recall': 0.6092586, 'specificity': 0.6092586, 'f1': 0.5646568, 'auroc': 0.76381755, 'binary_precision': 0.82211536, 'binary_recall': 0.2749196, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.4120482}
confusion matrix:
     0    1
0  619   37
1  451  171
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5810185, 'precision': 0.625937, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.54000103, 'auroc': 0.70976937, 'binary_precision': 0.7011494, 'binary_recall': 0.2824074, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.40264028}
confusion matrix:
     0   1
0  190  26
1  155  61
new oracle model saved
early stop counter: 5
val acc:0.6181533932685852, best validation acc: 0.6870109438896179, corresponding to test acc:                         0.47685185074806213 / 0.5810185074806213
after epoch: 6,now: 2024-07-20 14:58:19.180887,epoch time: 0:01:45.917248,used: 0:10:36.621335,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_47_42_seed_2_22504808
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 0:10:36.621335 at 2024-07-20 14:58:19.180887
persisted model performance metric: 

scalar performance:
{'acc': 0.47685185, 'precision': 0.47645622, 'recall': 0.47685188, 'specificity': 0.47685188, 'f1': 0.47464484, 'auroc': 0.4537037, 'binary_precision': 0.47340426, 'binary_recall': 0.41203704, 'binary_specificity': 0.5416667, 'binary_f1_score': 0.44059405}
confusion matrix:
     0   1
0  117  99
1  127  89
oracle model performance metric: 

scalar performance:
{'acc': 0.5810185, 'precision': 0.625937, 'recall': 0.5810185, 'specificity': 0.5810185, 'f1': 0.54000103, 'auroc': 0.70976937, 'binary_precision': 0.7011494, 'binary_recall': 0.2824074, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.40264028}
confusion matrix:
     0   1
0  190  26
1  155  61
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/6.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/6.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   4046 MiB | 364544 GiB | 364544 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 360343 GiB | 360343 GiB |
|       from small pool |  16396 KiB |     36 MiB |   4201 GiB |   4200 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   4046 MiB | 364544 GiB | 364544 GiB |
|       from large pool | 179211 KiB |   4027 MiB | 360343 GiB | 360343 GiB |
|       from small pool |  16396 KiB |     36 MiB |   4201 GiB |   4200 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   4045 MiB | 364518 GiB | 364517 GiB |
|       from large pool | 178979 KiB |   4026 MiB | 360321 GiB | 360321 GiB |
|       from small pool |  16209 KiB |     36 MiB |   4196 GiB |   4196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4420 MiB |   4434 MiB |  12810 MiB |   8390 MiB |
|       from large pool |   4382 MiB |   4396 MiB |  12728 MiB |   8346 MiB |
|       from small pool |     38 MiB |     42 MiB |     82 MiB |     44 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  33769 KiB | 398560 KiB | 193208 GiB | 193208 GiB |
|       from large pool |  31733 KiB | 397444 KiB | 188862 GiB | 188862 GiB |
|       from small pool |   2036 KiB |  11194 KiB |   4345 GiB |   4345 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1171    |   48851 K  |   48850 K  |
|       from large pool |      79    |     423    |   33018 K  |   33017 K  |
|       from small pool |     709    |    1017    |   15833 K  |   15832 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1171    |   48851 K  |   48850 K  |
|       from large pool |      79    |     423    |   33018 K  |   33017 K  |
|       from small pool |     709    |    1017    |   15833 K  |   15832 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     200    |     202    |     564    |     364    |
|       from large pool |     181    |     182    |     523    |     342    |
|       from small pool |      19    |      21    |      41    |      22    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      32    |     218    |   34892 K  |   34892 K  |
|       from large pool |      11    |     186    |   25461 K  |   25461 K  |
|       from small pool |      21    |     208    |    9430 K  |    9430 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   4046 MiB | 364544 GiB | 364544 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 360343 GiB | 360343 GiB |
|       from small pool |      0 KiB |     36 MiB |   4201 GiB |   4201 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   4046 MiB | 364544 GiB | 364544 GiB |
|       from large pool |  16640 KiB |   4027 MiB | 360343 GiB | 360343 GiB |
|       from small pool |      0 KiB |     36 MiB |   4201 GiB |   4201 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   4045 MiB | 364518 GiB | 364518 GiB |
|       from large pool |  16640 KiB |   4026 MiB | 360321 GiB | 360321 GiB |
|       from small pool |      0 KiB |     36 MiB |   4196 GiB |   4196 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 229376 KiB |   4434 MiB |  12810 MiB |  12586 MiB |
|       from large pool | 210944 KiB |   4396 MiB |  12728 MiB |  12522 MiB |
|       from small pool |  18432 KiB |     42 MiB |     82 MiB |     64 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 398560 KiB | 193208 GiB | 193208 GiB |
|       from large pool |  30464 KiB | 397444 KiB | 188862 GiB | 188862 GiB |
|       from small pool |      0 KiB |  12296 KiB |   4345 GiB |   4345 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1171    |   48851 K  |   48851 K  |
|       from large pool |       2    |     423    |   33018 K  |   33018 K  |
|       from small pool |       0    |    1017    |   15833 K  |   15833 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1171    |   48851 K  |   48851 K  |
|       from large pool |       2    |     423    |   33018 K  |   33018 K  |
|       from small pool |       0    |    1017    |   15833 K  |   15833 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      19    |     202    |     564    |     545    |
|       from large pool |      10    |     182    |     523    |     513    |
|       from small pool |       9    |      21    |      41    |      32    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     218    |   34892 K  |   34892 K  |
|       from large pool |       3    |     186    |   25461 K  |   25461 K  |
|       from small pool |       0    |     208    |    9430 K  |    9430 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 14:58:55 2024]
Finished job 0.
1 of 1 steps (100%) done
