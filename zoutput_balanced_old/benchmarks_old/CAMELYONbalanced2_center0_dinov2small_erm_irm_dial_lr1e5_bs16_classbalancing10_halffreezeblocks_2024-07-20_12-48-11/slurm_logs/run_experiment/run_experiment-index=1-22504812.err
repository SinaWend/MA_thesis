Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 14:37:11 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812

 Experiment start at: 2024-07-20 14:37:54.761214
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5501302, 'precision': 0.54999614, 'recall': 0.54927313, 'specificity': 0.54927313, 'f1': 0.5480584, 'auroc': 0.5740006, 'binary_precision': 0.55110335, 'binary_recall': 0.6091142, 'binary_specificity': 0.48943198, 'binary_f1_score': 0.5786586}
confusion matrix:
     0    1
0  741  773
1  609  949
---- Validation: 
scalar performance:
{'acc': 0.6296584, 'precision': 0.6373874, 'recall': 0.62783885, 'specificity': 0.62783885, 'f1': 0.6223647, 'auroc': 0.7013782, 'binary_precision': 0.6666667, 'binary_recall': 0.4976378, 'binary_specificity': 0.75803983, 'binary_f1_score': 0.5698828}
confusion matrix:
     0    1
0  495  158
1  319  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.63585395, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.62238467, 'auroc': 0.6655489, 'binary_precision': 0.66871166, 'binary_recall': 0.5069767, 'binary_specificity': 0.74883723, 'binary_f1_score': 0.5767195}
confusion matrix:
     0    1
0  161   54
1  106  109
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:38:57.821017,epoch time: 0:01:03.059803,used: 0:01:03.059803,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.68098956, 'precision': 0.68567824, 'recall': 0.6799259, 'specificity': 0.6799259, 'f1': 0.6781211, 'auroc': 0.75938, 'binary_precision': 0.6591035, 'binary_recall': 0.7659164, 'binary_specificity': 0.5939354, 'binary_f1_score': 0.7085068}
confusion matrix:
     0     1
0  901   616
1  364  1191
---- Validation: 
scalar performance:
{'acc': 0.6226708, 'precision': 0.63758266, 'recall': 0.6202096, 'specificity': 0.6202096, 'f1': 0.6093316, 'auroc': 0.70923054, 'binary_precision': 0.67951804, 'binary_recall': 0.44409448, 'binary_specificity': 0.7963247, 'binary_f1_score': 0.5371428}
confusion matrix:
     0    1
0  520  133
1  353  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60930234, 'precision': 0.6258688, 'recall': 0.60930234, 'specificity': 0.60930234, 'f1': 0.5960093, 'auroc': 0.6859275, 'binary_precision': 0.67153287, 'binary_recall': 0.427907, 'binary_specificity': 0.7906977, 'binary_f1_score': 0.5227273}
confusion matrix:
     0   1
0  170  45
1  123  92
early stop counter: 1
val acc:0.6226708292961121, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 2,now: 2024-07-20 14:39:55.325411,epoch time: 0:00:57.504394,used: 0:02:00.564197,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7444661, 'precision': 0.7451415, 'recall': 0.7447878, 'specificity': 0.7447878, 'f1': 0.74442065, 'auroc': 0.79958, 'binary_precision': 0.7618725, 'binary_recall': 0.7212588, 'binary_specificity': 0.7683168, 'binary_f1_score': 0.7410096}
confusion matrix:
      0     1
0  1164   351
1   434  1123
---- Validation: 
scalar performance:
{'acc': 0.6009317, 'precision': 0.6277011, 'recall': 0.59755456, 'specificity': 0.59755456, 'f1': 0.5743271, 'auroc': 0.71595424, 'binary_precision': 0.68277943, 'binary_recall': 0.3559055, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.4679089}
confusion matrix:
     0    1
0  548  105
1  409  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60465115, 'precision': 0.6366178, 'recall': 0.60465115, 'specificity': 0.60465115, 'f1': 0.5800878, 'auroc': 0.707669, 'binary_precision': 0.7027027, 'binary_recall': 0.3627907, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.47852764}
confusion matrix:
     0   1
0  182  33
1  137  78
early stop counter: 2
val acc:0.600931704044342, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 3,now: 2024-07-20 14:40:53.081713,epoch time: 0:00:57.756302,used: 0:02:58.320499,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7913411, 'precision': 0.79155713, 'recall': 0.7915268, 'specificity': 0.7915268, 'f1': 0.7913406, 'auroc': 0.8564472, 'binary_precision': 0.8038436, 'binary_recall': 0.77856225, 'binary_specificity': 0.8044914, 'binary_f1_score': 0.79100096}
confusion matrix:
      0     1
0  1218   296
1   345  1213
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.6268116, 'recall': 0.5951273, 'specificity': 0.5951273, 'f1': 0.5702186, 'auroc': 0.7206593, 'binary_precision': 0.6832298, 'binary_recall': 0.3464567, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.45977014}
confusion matrix:
     0    1
0  551  102
1  415  220
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5976744, 'precision': 0.631464, 'recall': 0.5976744, 'specificity': 0.5976744, 'f1': 0.5700472, 'auroc': 0.7231585, 'binary_precision': 0.6981132, 'binary_recall': 0.34418604, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.46105918}
confusion matrix:
     0   1
0  183  32
1  141  74
early stop counter: 3
val acc:0.5986024737358093, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 4,now: 2024-07-20 14:41:50.965130,epoch time: 0:00:57.883417,used: 0:03:56.203916,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.83235675, 'precision': 0.83604264, 'recall': 0.83306885, 'specificity': 0.83306885, 'f1': 0.83207875, 'auroc': 0.886798, 'binary_precision': 0.8748202, 'binary_recall': 0.7809891, 'binary_specificity': 0.8851485, 'binary_f1_score': 0.82524604}
confusion matrix:
      0     1
0  1341   174
1   341  1216
---- Validation: 
scalar performance:
{'acc': 0.59006214, 'precision': 0.6232684, 'recall': 0.5862488, 'specificity': 0.5862488, 'f1': 0.5549028, 'auroc': 0.72731304, 'binary_precision': 0.6838488, 'binary_recall': 0.3133858, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.42980564}
confusion matrix:
     0    1
0  561   92
1  436  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60465115, 'precision': 0.64762425, 'recall': 0.60465115, 'specificity': 0.60465115, 'f1': 0.5736217, 'auroc': 0.73616004, 'binary_precision': 0.72727275, 'binary_recall': 0.33488372, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.45859873}
confusion matrix:
     0   1
0  188  27
1  143  72
early stop counter: 4
val acc:0.590062141418457, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 5,now: 2024-07-20 14:42:49.041040,epoch time: 0:00:58.075910,used: 0:04:54.279826,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8307292, 'precision': 0.8375281, 'recall': 0.8316946, 'specificity': 0.8316946, 'f1': 0.83013296, 'auroc': 0.88638127, 'binary_precision': 0.8889722, 'binary_recall': 0.761079, 'binary_specificity': 0.90231025, 'binary_f1_score': 0.8200692}
confusion matrix:
      0     1
0  1367   148
1   372  1185
---- Validation: 
scalar performance:
{'acc': 0.5869565, 'precision': 0.6210889, 'recall': 0.5830558, 'specificity': 0.5830558, 'f1': 0.5498054, 'auroc': 0.7324354, 'binary_precision': 0.6819788, 'binary_recall': 0.30393702, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.42047933}
confusion matrix:
     0    1
0  563   90
1  442  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60697675, 'precision': 0.6519855, 'recall': 0.60697675, 'specificity': 0.60697675, 'f1': 0.575553, 'auroc': 0.7468686, 'binary_precision': 0.7346939, 'binary_recall': 0.33488372, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.4600639}
confusion matrix:
     0   1
0  189  26
1  143  72
early stop counter: 5
val acc:0.5869565010070801, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 6,now: 2024-07-20 14:43:46.886651,epoch time: 0:00:57.845611,used: 0:05:52.125437,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8466797, 'precision': 0.8517642, 'recall': 0.84746337, 'specificity': 0.84746337, 'f1': 0.84630835, 'auroc': 0.9054935, 'binary_precision': 0.8974359, 'binary_recall': 0.7872751, 'binary_specificity': 0.9076517, 'binary_f1_score': 0.8387538}
confusion matrix:
      0     1
0  1376   140
1   331  1225
---- Validation: 
scalar performance:
{'acc': 0.58152175, 'precision': 0.61688495, 'recall': 0.5774789, 'specificity': 0.5774789, 'f1': 0.54092926, 'auroc': 0.73412114, 'binary_precision': 0.67777777, 'binary_recall': 0.28818896, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.4044199}
confusion matrix:
     0    1
0  566   87
1  452  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6139535, 'precision': 0.66307545, 'recall': 0.6139535, 'specificity': 0.6139535, 'f1': 0.5825145, 'auroc': 0.7538129, 'binary_precision': 0.7525773, 'binary_recall': 0.33953488, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.4679487}
confusion matrix:
     0   1
0  191  24
1  142  73
early stop counter: 6
val acc:0.58152174949646, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6279069781303406
after epoch: 7,now: 2024-07-20 14:44:44.801692,epoch time: 0:00:57.915041,used: 0:06:50.040478,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8486328, 'precision': 0.8563889, 'recall': 0.8495949, 'specificity': 0.8495949, 'f1': 0.848033, 'auroc': 0.9056325, 'binary_precision': 0.9123205, 'binary_recall': 0.77570695, 'binary_specificity': 0.92348284, 'binary_f1_score': 0.8384856}
confusion matrix:
      0     1
0  1400   116
1   349  1207
---- Validation: 
scalar performance:
{'acc': 0.5962733, 'precision': 0.6321473, 'recall': 0.5924612, 'specificity': 0.5924612, 'f1': 0.5616467, 'auroc': 0.7385489, 'binary_precision': 0.6975945, 'binary_recall': 0.31968504, 'binary_specificity': 0.86523736, 'binary_f1_score': 0.4384449}
confusion matrix:
     0    1
0  565   88
1  432  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.67512643, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.6087848, 'auroc': 0.7611033, 'binary_precision': 0.7614679, 'binary_recall': 0.3860465, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.5123457}
confusion matrix:
     0   1
0  189  26
1  132  83
new oracle model saved
early stop counter: 7
val acc:0.5962733030319214, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6325581669807434
after epoch: 8,now: 2024-07-20 14:45:42.779757,epoch time: 0:00:57.978065,used: 0:07:48.018543,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8483073, 'precision': 0.85714287, 'recall': 0.8493329, 'specificity': 0.8493329, 'f1': 0.8476087, 'auroc': 0.91171, 'binary_precision': 0.9166667, 'binary_recall': 0.77056557, 'binary_specificity': 0.9281003, 'binary_f1_score': 0.8372906}
confusion matrix:
      0     1
0  1407   109
1   357  1199
---- Validation: 
scalar performance:
{'acc': 0.60481364, 'precision': 0.63900745, 'recall': 0.60118777, 'specificity': 0.60118777, 'f1': 0.5742685, 'auroc': 0.7440909, 'binary_precision': 0.70454544, 'binary_recall': 0.3417323, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.4602333}
confusion matrix:
     0    1
0  562   91
1  418  217
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6418605, 'precision': 0.68306303, 'recall': 0.6418605, 'specificity': 0.6418605, 'f1': 0.62050706, 'auroc': 0.7680476, 'binary_precision': 0.7699115, 'binary_recall': 0.40465117, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.53048784}
confusion matrix:
     0   1
0  189  26
1  128  87
new oracle model saved
early stop counter: 8
val acc:0.6048136353492737, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6418604850769043
after epoch: 9,now: 2024-07-20 14:46:40.796264,epoch time: 0:00:58.016507,used: 0:08:46.035050,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.87565106, 'precision': 0.8841046, 'recall': 0.8767261, 'specificity': 0.8767261, 'f1': 0.87516344, 'auroc': 0.9265121, 'binary_precision': 0.94478065, 'binary_recall': 0.8016688, 'binary_specificity': 0.95178336, 'binary_f1_score': 0.8673611}
confusion matrix:
      0     1
0  1441    73
1   309  1249
---- Validation: 
scalar performance:
{'acc': 0.5916149, 'precision': 0.62913704, 'recall': 0.5876717, 'specificity': 0.5876717, 'f1': 0.55401075, 'auroc': 0.7455258, 'binary_precision': 0.6953405, 'binary_recall': 0.3055118, 'binary_specificity': 0.86983156, 'binary_f1_score': 0.42450765}
confusion matrix:
     0    1
0  568   85
1  441  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.644186, 'precision': 0.69165516, 'recall': 0.644186, 'specificity': 0.644186, 'f1': 0.62069976, 'auroc': 0.7746674, 'binary_precision': 0.787037, 'binary_recall': 0.39534885, 'binary_specificity': 0.89302325, 'binary_f1_score': 0.5263158}
confusion matrix:
     0   1
0  192  23
1  130  85
new oracle model saved
early stop counter: 9
val acc:0.5916149020195007, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6441860198974609
after epoch: 10,now: 2024-07-20 14:47:39.540055,epoch time: 0:00:58.743791,used: 0:09:44.778841,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.882487, 'precision': 0.8883947, 'recall': 0.8833022, 'specificity': 0.8833022, 'f1': 0.88217926, 'auroc': 0.9381244, 'binary_precision': 0.9396615, 'binary_recall': 0.8206941, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.8761578}
confusion matrix:
      0     1
0  1434    82
1   279  1277
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.6434324, 'recall': 0.605103, 'specificity': 0.605103, 'f1': 0.57901394, 'auroc': 0.74968827, 'binary_precision': 0.7106109, 'binary_recall': 0.3480315, 'binary_specificity': 0.8621746, 'binary_f1_score': 0.46723044}
confusion matrix:
     0    1
0  563   90
1  414  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511628, 'precision': 0.69506717, 'recall': 0.65116274, 'specificity': 0.65116274, 'f1': 0.63036406, 'auroc': 0.78275824, 'binary_precision': 0.7876106, 'binary_recall': 0.41395348, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.54268295}
confusion matrix:
     0   1
0  191  24
1  126  89
new oracle model saved
early stop counter: 10
val acc:0.6086956262588501, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6511628031730652
after epoch: 11,now: 2024-07-20 14:48:37.913712,epoch time: 0:00:58.373657,used: 0:10:43.152498,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.88216144, 'precision': 0.8889447, 'recall': 0.88298917, 'specificity': 0.88298917, 'f1': 0.8817909, 'auroc': 0.9391297, 'binary_precision': 0.94349444, 'binary_recall': 0.8160772, 'binary_specificity': 0.9499011, 'binary_f1_score': 0.87517244}
confusion matrix:
      0     1
0  1441    76
1   286  1269
---- Validation: 
scalar performance:
{'acc': 0.617236, 'precision': 0.65106165, 'recall': 0.61378616, 'specificity': 0.61378616, 'f1': 0.59051865, 'auroc': 0.7563203, 'binary_precision': 0.7191358, 'binary_recall': 0.36692914, 'binary_specificity': 0.8606432, 'binary_f1_score': 0.48592284}
confusion matrix:
     0    1
0  562   91
1  402  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66744184, 'precision': 0.70598257, 'recall': 0.66744184, 'specificity': 0.66744184, 'f1': 0.6511225, 'auroc': 0.79106545, 'binary_precision': 0.795082, 'binary_recall': 0.4511628, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.5756676}
confusion matrix:
     0   1
0  190  25
1  118  97
new oracle model saved
early stop counter: 11
val acc:0.6172360181808472, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6674418449401855
after epoch: 12,now: 2024-07-20 14:49:36.149441,epoch time: 0:00:58.235729,used: 0:11:41.388227,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8828125, 'precision': 0.89232665, 'recall': 0.88373494, 'specificity': 0.88373494, 'f1': 0.88226235, 'auroc': 0.93219626, 'binary_precision': 0.95642203, 'binary_recall': 0.8050193, 'binary_specificity': 0.96245056, 'binary_f1_score': 0.8742139}
confusion matrix:
      0     1
0  1461    57
1   303  1251
---- Validation: 
scalar performance:
{'acc': 0.6273292, 'precision': 0.65988106, 'recall': 0.62404406, 'specificity': 0.62404406, 'f1': 0.6037806, 'auroc': 0.7621348, 'binary_precision': 0.72861356, 'binary_recall': 0.38897637, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.50718683}
confusion matrix:
     0    1
0  561   92
1  388  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67674416, 'precision': 0.7132937, 'recall': 0.6767442, 'specificity': 0.6767442, 'f1': 0.6622764, 'auroc': 0.7982477, 'binary_precision': 0.8015873, 'binary_recall': 0.46976745, 'binary_specificity': 0.88372093, 'binary_f1_score': 0.5923754}
confusion matrix:
     0    1
0  190   25
1  114  101
new oracle model saved
early stop counter: 12
val acc:0.6273291707038879, best validation acc: 0.6296584010124207, corresponding to test acc:                         0.6279069781303406 / 0.6767441630363464
after epoch: 13,now: 2024-07-20 14:50:34.119528,epoch time: 0:00:57.970087,used: 0:12:39.358314,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88964844, 'precision': 0.89565253, 'recall': 0.8904649, 'specificity': 0.8904649, 'f1': 0.8893595, 'auroc': 0.94136405, 'binary_precision': 0.9477557, 'binary_recall': 0.8277635, 'binary_specificity': 0.95316625, 'binary_f1_score': 0.883705}
confusion matrix:
      0     1
0  1445    71
1   268  1288
---- Validation: 
scalar performance:
{'acc': 0.63975155, 'precision': 0.6688497, 'recall': 0.63672936, 'specificity': 0.63672936, 'f1': 0.62051356, 'auroc': 0.76543874, 'binary_precision': 0.7355372, 'binary_recall': 0.42047244, 'binary_specificity': 0.8529862, 'binary_f1_score': 0.5350701}
confusion matrix:
     0    1
0  557   96
1  368  267
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.67674416, 'precision': 0.7094872, 'recall': 0.6767442, 'specificity': 0.6767442, 'f1': 0.66359925, 'auroc': 0.80419683, 'binary_precision': 0.7923077, 'binary_recall': 0.47906977, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.59710145}
confusion matrix:
     0    1
0  188   27
1  112  103
better model found
persisted
after epoch: 14,now: 2024-07-20 14:51:32.178813,epoch time: 0:00:58.059285,used: 0:13:37.417599,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8880208, 'precision': 0.892915, 'recall': 0.8888372, 'specificity': 0.8888372, 'f1': 0.88780093, 'auroc': 0.95025337, 'binary_precision': 0.94049346, 'binary_recall': 0.8318357, 'binary_specificity': 0.9458388, 'binary_f1_score': 0.88283384}
confusion matrix:
      0     1
0  1432    82
1   262  1296
---- Validation: 
scalar performance:
{'acc': 0.64518636, 'precision': 0.6752831, 'recall': 0.64217603, 'specificity': 0.64217603, 'f1': 0.6263759, 'auroc': 0.7694951, 'binary_precision': 0.74450547, 'binary_recall': 0.42677164, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.5425426}
confusion matrix:
     0    1
0  560   93
1  364  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68139535, 'precision': 0.71500003, 'recall': 0.68139535, 'specificity': 0.68139535, 'f1': 0.66843957, 'auroc': 0.8107085, 'binary_precision': 0.8, 'binary_recall': 0.48372093, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.60289854}
confusion matrix:
     0    1
0  189   26
1  111  104
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 14:52:30.218258,epoch time: 0:00:58.039445,used: 0:14:35.457044,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9013672, 'precision': 0.90886605, 'recall': 0.9023589, 'specificity': 0.9023589, 'f1': 0.90105337, 'auroc': 0.95563364, 'binary_precision': 0.96793437, 'binary_recall': 0.8331194, 'binary_specificity': 0.9715984, 'binary_f1_score': 0.89548117}
confusion matrix:
      0     1
0  1471    43
1   260  1298
---- Validation: 
scalar performance:
{'acc': 0.6459627, 'precision': 0.6765215, 'recall': 0.6429417, 'specificity': 0.6429417, 'f1': 0.62705636, 'auroc': 0.77537954, 'binary_precision': 0.74655646, 'binary_recall': 0.42677164, 'binary_specificity': 0.8591118, 'binary_f1_score': 0.5430861}
confusion matrix:
     0    1
0  561   92
1  364  271
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68604654, 'precision': 0.7224752, 'recall': 0.6860465, 'specificity': 0.6860465, 'f1': 0.67264605, 'auroc': 0.8182585, 'binary_precision': 0.8125, 'binary_recall': 0.48372093, 'binary_specificity': 0.88837206, 'binary_f1_score': 0.606414}
confusion matrix:
     0    1
0  191   24
1  111  104
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 14:53:28.707063,epoch time: 0:00:58.488805,used: 0:15:33.945849,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.890625, 'precision': 0.8972105, 'recall': 0.8915215, 'specificity': 0.8915215, 'f1': 0.8903124, 'auroc': 0.948581, 'binary_precision': 0.9518875, 'binary_recall': 0.82594734, 'binary_specificity': 0.9570957, 'binary_f1_score': 0.88445663}
confusion matrix:
      0     1
0  1450    65
1   271  1286
---- Validation: 
scalar performance:
{'acc': 0.6614907, 'precision': 0.68823683, 'recall': 0.6587549, 'specificity': 0.6587549, 'f1': 0.6466454, 'auroc': 0.778136, 'binary_precision': 0.75578403, 'binary_recall': 0.46299213, 'binary_specificity': 0.85451764, 'binary_f1_score': 0.5742187}
confusion matrix:
     0    1
0  558   95
1  341  294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.69069767, 'precision': 0.7187562, 'recall': 0.69069767, 'specificity': 0.69069767, 'f1': 0.680451, 'auroc': 0.8229097, 'binary_precision': 0.79710144, 'binary_recall': 0.5116279, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.6232294}
confusion matrix:
     0    1
0  187   28
1  105  110
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 14:54:27.016860,epoch time: 0:00:58.309797,used: 0:16:32.255646,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.89746094, 'precision': 0.9037022, 'recall': 0.8982872, 'specificity': 0.8982872, 'f1': 0.89718544, 'auroc': 0.9586607, 'binary_precision': 0.95725864, 'binary_recall': 0.8348329, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.891864}
confusion matrix:
      0     1
0  1458    58
1   257  1299
---- Validation: 
scalar performance:
{'acc': 0.67391306, 'precision': 0.6991939, 'recall': 0.6713316, 'specificity': 0.6713316, 'f1': 0.6611469, 'auroc': 0.7841531, 'binary_precision': 0.7667494, 'binary_recall': 0.48661417, 'binary_specificity': 0.856049, 'binary_f1_score': 0.59537566}
confusion matrix:
     0    1
0  559   94
1  326  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7023256, 'precision': 0.7278819, 'recall': 0.7023256, 'specificity': 0.7023256, 'f1': 0.693739, 'auroc': 0.8281666, 'binary_precision': 0.8041958, 'binary_recall': 0.53488374, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.6424581}
confusion matrix:
     0    1
0  187   28
1  100  115
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 14:55:25.120162,epoch time: 0:00:58.103302,used: 0:17:30.358948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.89973956, 'precision': 0.90746456, 'recall': 0.9007001, 'specificity': 0.9007001, 'f1': 0.89940184, 'auroc': 0.9534215, 'binary_precision': 0.9670905, 'binary_recall': 0.83044314, 'binary_specificity': 0.9709571, 'binary_f1_score': 0.89357287}
confusion matrix:
      0     1
0  1471    44
1   264  1293
---- Validation: 
scalar performance:
{'acc': 0.67701864, 'precision': 0.70028085, 'recall': 0.6745463, 'specificity': 0.6745463, 'f1': 0.66540104, 'auroc': 0.78851575, 'binary_precision': 0.76513314, 'binary_recall': 0.4976378, 'binary_specificity': 0.8514548, 'binary_f1_score': 0.60305345}
confusion matrix:
     0    1
0  556   97
1  319  316
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7162791, 'precision': 0.73730683, 'recall': 0.7162791, 'specificity': 0.7162791, 'f1': 0.70985156, 'auroc': 0.83351004, 'binary_precision': 0.80794704, 'binary_recall': 0.5674419, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.6666667}
confusion matrix:
     0    1
0  186   29
1   93  122
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 14:56:23.296373,epoch time: 0:00:58.176211,used: 0:18:28.535159,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9095052, 'precision': 0.91625845, 'recall': 0.9103547, 'specificity': 0.9103547, 'f1': 0.90924656, 'auroc': 0.95983416, 'binary_precision': 0.9726331, 'binary_recall': 0.84511566, 'binary_specificity': 0.9755937, 'binary_f1_score': 0.90440166}
confusion matrix:
      0     1
0  1479    37
1   241  1315
---- Validation: 
scalar performance:
{'acc': 0.6801242, 'precision': 0.7005389, 'recall': 0.67780447, 'specificity': 0.67780447, 'f1': 0.669963, 'auroc': 0.79205847, 'binary_precision': 0.76112413, 'binary_recall': 0.511811, 'binary_specificity': 0.84379786, 'binary_f1_score': 0.61205274}
confusion matrix:
     0    1
0  551  102
1  310  325
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7255814, 'precision': 0.7432865, 'recall': 0.7255814, 'specificity': 0.7255814, 'f1': 0.7204962, 'auroc': 0.83775014, 'binary_precision': 0.8089172, 'binary_recall': 0.59069765, 'binary_specificity': 0.8604651, 'binary_f1_score': 0.6827957}
confusion matrix:
     0    1
0  185   30
1   88  127
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 14:57:21.903004,epoch time: 0:00:58.606631,used: 0:19:27.141790,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9091797, 'precision': 0.91370416, 'recall': 0.90988076, 'specificity': 0.90988076, 'f1': 0.90901923, 'auroc': 0.9626156, 'binary_precision': 0.96034604, 'binary_recall': 0.85604113, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.90519875}
confusion matrix:
      0     1
0  1461    55
1   224  1332
---- Validation: 
scalar performance:
{'acc': 0.6824534, 'precision': 0.700343, 'recall': 0.6802752, 'specificity': 0.6802752, 'f1': 0.673525, 'auroc': 0.79509294, 'binary_precision': 0.7568182, 'binary_recall': 0.5244095, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.6195349}
confusion matrix:
     0    1
0  546  107
1  302  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73023254, 'precision': 0.7445371, 'recall': 0.7302326, 'specificity': 0.7302326, 'f1': 0.72622895, 'auroc': 0.8423364, 'binary_precision': 0.80368096, 'binary_recall': 0.60930234, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.69312173}
confusion matrix:
     0    1
0  183   32
1   84  131
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 14:58:20.536059,epoch time: 0:00:58.633055,used: 0:20:25.774845,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.91308594, 'precision': 0.91975856, 'recall': 0.9140148, 'specificity': 0.9140148, 'f1': 0.91285247, 'auroc': 0.9673094, 'binary_precision': 0.97638375, 'binary_recall': 0.8491656, 'binary_specificity': 0.97886395, 'binary_f1_score': 0.90834194}
confusion matrix:
      0     1
0  1482    32
1   235  1323
---- Validation: 
scalar performance:
{'acc': 0.6886646, 'precision': 0.707247, 'recall': 0.68648756, 'specificity': 0.68648756, 'f1': 0.6799107, 'auroc': 0.79890513, 'binary_precision': 0.7659091, 'binary_recall': 0.5307087, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.6269767}
confusion matrix:
     0    1
0  550  103
1  298  337
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.73255813, 'precision': 0.74642396, 'recall': 0.73255813, 'specificity': 0.73255813, 'f1': 0.7287423, 'auroc': 0.84631693, 'binary_precision': 0.80487806, 'binary_recall': 0.6139535, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.69656986}
confusion matrix:
     0    1
0  183   32
1   83  132
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 14:59:18.876141,epoch time: 0:00:58.340082,used: 0:21:24.114927,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.91015625, 'precision': 0.9157865, 'recall': 0.91101456, 'specificity': 0.91101456, 'f1': 0.9099584, 'auroc': 0.9662088, 'binary_precision': 0.9678832, 'binary_recall': 0.85109115, 'binary_specificity': 0.9709379, 'binary_f1_score': 0.90573776}
confusion matrix:
      0     1
0  1470    44
1   232  1326
---- Validation: 
scalar performance:
{'acc': 0.6964286, 'precision': 0.7137178, 'recall': 0.69436157, 'specificity': 0.69436157, 'f1': 0.68869567, 'auroc': 0.80118656, 'binary_precision': 0.77111113, 'binary_recall': 0.5464567, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.6396314}
confusion matrix:
     0    1
0  550  103
1  288  347
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74186045, 'precision': 0.7539985, 'recall': 0.7418605, 'specificity': 0.7418605, 'f1': 0.7387392, 'auroc': 0.8492807, 'binary_precision': 0.8095238, 'binary_recall': 0.63255817, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.7101828}
confusion matrix:
     0    1
0  183   32
1   79  136
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:00:17.470535,epoch time: 0:00:58.594394,used: 0:22:22.709321,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9085286, 'precision': 0.91407615, 'recall': 0.9093819, 'specificity': 0.9093819, 'f1': 0.90832996, 'auroc': 0.9640387, 'binary_precision': 0.96571845, 'binary_recall': 0.84980744, 'binary_specificity': 0.9689564, 'binary_f1_score': 0.9040628}
confusion matrix:
      0     1
0  1467    47
1   234  1324
---- Validation: 
scalar performance:
{'acc': 0.71040374, 'precision': 0.7217213, 'recall': 0.70875186, 'specificity': 0.70875186, 'f1': 0.7055719, 'auroc': 0.8048595, 'binary_precision': 0.76844263, 'binary_recall': 0.5905512, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.667854}
confusion matrix:
     0    1
0  540  113
1  260  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76744187, 'precision': 0.77350056, 'recall': 0.76744187, 'specificity': 0.76744187, 'f1': 0.76614666, 'auroc': 0.85323966, 'binary_precision': 0.8142077, 'binary_recall': 0.69302326, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.74874365}
confusion matrix:
     0    1
0  181   34
1   66  149
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:01:16.265883,epoch time: 0:00:58.795348,used: 0:23:21.504669,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.9078776, 'precision': 0.9164742, 'recall': 0.9088328, 'specificity': 0.9088328, 'f1': 0.90752757, 'auroc': 0.96454227, 'binary_precision': 0.97965336, 'binary_recall': 0.83547556, 'binary_specificity': 0.98218995, 'binary_f1_score': 0.90183836}
confusion matrix:
      0     1
0  1489    27
1   256  1300
---- Validation: 
scalar performance:
{'acc': 0.7080745, 'precision': 0.7233907, 'recall': 0.7061726, 'specificity': 0.7061726, 'f1': 0.70171964, 'auroc': 0.8087735, 'binary_precision': 0.7784946, 'binary_recall': 0.57007873, 'binary_specificity': 0.84226644, 'binary_f1_score': 0.65818185}
confusion matrix:
     0    1
0  550  103
1  273  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76739496, 'recall': 0.7581395, 'specificity': 0.7581395, 'f1': 0.7560284, 'auroc': 0.85737157, 'binary_precision': 0.81714284, 'binary_recall': 0.66511625, 'binary_specificity': 0.8511628, 'binary_f1_score': 0.73333335}
confusion matrix:
     0    1
0  183   32
1   72  143
early stop counter: 1
val acc:0.7080745100975037, best validation acc: 0.7104037404060364, corresponding to test acc:                         0.7674418687820435 / 0.7674418687820435
after epoch: 25,now: 2024-07-20 15:02:14.984184,epoch time: 0:00:58.718301,used: 0:24:20.222970,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9160156, 'precision': 0.9219336, 'recall': 0.91676795, 'specificity': 0.91676795, 'f1': 0.9158095, 'auroc': 0.96990216, 'binary_precision': 0.9750916, 'binary_recall': 0.85594857, 'binary_specificity': 0.97758734, 'binary_f1_score': 0.9116438}
confusion matrix:
      0     1
0  1483    34
1   224  1331
---- Validation: 
scalar performance:
{'acc': 0.7158385, 'precision': 0.7276659, 'recall': 0.71417683, 'specificity': 0.71417683, 'f1': 0.7110387, 'auroc': 0.8126346, 'binary_precision': 0.7761807, 'binary_recall': 0.5952756, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.6737968}
confusion matrix:
     0    1
0  544  109
1  257  378
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.76976746, 'precision': 0.7762761, 'recall': 0.7697674, 'specificity': 0.7697674, 'f1': 0.7684034, 'auroc': 0.8619362, 'binary_precision': 0.8186813, 'binary_recall': 0.69302326, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7506297}
confusion matrix:
     0    1
0  182   33
1   66  149
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:03:13.887298,epoch time: 0:00:58.903114,used: 0:25:19.126084,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91796875, 'precision': 0.9224926, 'recall': 0.91870123, 'specificity': 0.91870123, 'f1': 0.91783047, 'auroc': 0.96931994, 'binary_precision': 0.96976244, 'binary_recall': 0.86512524, 'binary_specificity': 0.9722772, 'binary_f1_score': 0.91446024}
confusion matrix:
      0     1
0  1473    42
1   210  1347
---- Validation: 
scalar performance:
{'acc': 0.72981364, 'precision': 0.73609436, 'recall': 0.7286105, 'specificity': 0.7286105, 'f1': 0.727286, 'auroc': 0.8173398, 'binary_precision': 0.7712665, 'binary_recall': 0.6425197, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.70103097}
confusion matrix:
     0    1
0  532  121
1  227  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7790698, 'precision': 0.78289473, 'recall': 0.7790698, 'specificity': 0.7790698, 'f1': 0.77832043, 'auroc': 0.8669984, 'binary_precision': 0.81578946, 'binary_recall': 0.7209302, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.76543206}
confusion matrix:
     0    1
0  180   35
1   60  155
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 15:04:12.389450,epoch time: 0:00:58.502152,used: 0:26:17.628236,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.9158797, 'recall': 0.9133762, 'specificity': 0.9133762, 'f1': 0.9126679, 'auroc': 0.96867037, 'binary_precision': 0.95547706, 'binary_recall': 0.86833656, 'binary_specificity': 0.95841587, 'binary_f1_score': 0.909825}
confusion matrix:
      0     1
0  1452    63
1   205  1352
---- Validation: 
scalar performance:
{'acc': 0.7468944, 'precision': 0.75014895, 'recall': 0.7460419, 'specificity': 0.7460419, 'f1': 0.7455964, 'auroc': 0.8218905, 'binary_precision': 0.77540106, 'binary_recall': 0.68503934, 'binary_specificity': 0.8070444, 'binary_f1_score': 0.7274247}
confusion matrix:
     0    1
0  527  126
1  200  435
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.7948668, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7926992, 'auroc': 0.87175775, 'binary_precision': 0.8181818, 'binary_recall': 0.75348836, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.78450364}
confusion matrix:
     0    1
0  179   36
1   53  162
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 15:05:10.766273,epoch time: 0:00:58.376823,used: 0:27:16.005059,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.91276044, 'precision': 0.91945124, 'recall': 0.9135605, 'specificity': 0.9135605, 'f1': 0.9125111, 'auroc': 0.9669473, 'binary_precision': 0.9756098, 'binary_recall': 0.84887457, 'binary_specificity': 0.9782465, 'binary_f1_score': 0.9078405}
confusion matrix:
      0     1
0  1484    33
1   235  1320
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.7602801, 'recall': 0.757918, 'specificity': 0.757918, 'f1': 0.7578044, 'auroc': 0.8271117, 'binary_precision': 0.77835053, 'binary_recall': 0.7133858, 'binary_specificity': 0.80245024, 'binary_f1_score': 0.74445355}
confusion matrix:
     0    1
0  524  129
1  182  453
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80465114, 'precision': 0.80507356, 'recall': 0.80465114, 'specificity': 0.80465114, 'f1': 0.80458355, 'auroc': 0.87591136, 'binary_precision': 0.81642514, 'binary_recall': 0.7860465, 'binary_specificity': 0.82325584, 'binary_f1_score': 0.8009479}
confusion matrix:
     0    1
0  177   38
1   46  169
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-20 15:06:08.759285,epoch time: 0:00:57.993012,used: 0:28:13.998071,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9166667, 'precision': 0.92230266, 'recall': 0.917441, 'specificity': 0.917441, 'f1': 0.91647804, 'auroc': 0.9690287, 'binary_precision': 0.97445256, 'binary_recall': 0.85796916, 'binary_specificity': 0.9769129, 'binary_f1_score': 0.91250855}
confusion matrix:
      0     1
0  1481    35
1   221  1335
---- Validation: 
scalar performance:
{'acc': 0.76009315, 'precision': 0.76243424, 'recall': 0.7593843, 'specificity': 0.7593843, 'f1': 0.7591872, 'auroc': 0.8292508, 'binary_precision': 0.78397214, 'binary_recall': 0.70866144, 'binary_specificity': 0.8101072, 'binary_f1_score': 0.7444169}
confusion matrix:
     0    1
0  529  124
1  185  450
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.80930233, 'precision': 0.8097311, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8092363, 'auroc': 0.8781179, 'binary_precision': 0.82125604, 'binary_recall': 0.7906977, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8056872}
confusion matrix:
     0    1
0  178   37
1   45  170
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-20 15:07:06.753150,epoch time: 0:00:57.993865,used: 0:29:11.991936,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_37_54_seed_0_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:11.991936 at 2024-07-20 15:07:06.753150
persisted model performance metric: 

scalar performance:
{'acc': 0.80930233, 'precision': 0.8097311, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8092363, 'auroc': 0.8781179, 'binary_precision': 0.82125604, 'binary_recall': 0.7906977, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8056872}
confusion matrix:
     0    1
0  178   37
1   45  170
oracle model performance metric: 

scalar performance:
{'acc': 0.80930233, 'precision': 0.8097311, 'recall': 0.80930233, 'specificity': 0.80930233, 'f1': 0.8092363, 'auroc': 0.8781179, 'binary_precision': 0.82125604, 'binary_recall': 0.7906977, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.8056872}
confusion matrix:
     0    1
0  178   37
1   45  170
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60517 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60517 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |   8180 KiB |  11458 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10389 K  |   10388 K  |
|       from large pool |      79    |     762    |    5638 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4751 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10389 K  |   10388 K  |
|       from large pool |      79    |     762    |    5638 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4751 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |     380    |    6455 K  |    6455 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      33    |     216    |    2134 K  |    2134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60517 GiB |  60517 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60517 GiB |  60517 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  21434 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10389 K  |   10389 K  |
|       from large pool |       2    |     762    |    5638 K  |    5638 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10389 K  |   10389 K  |
|       from large pool |       2    |     762    |    5638 K  |    5638 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6455 K  |    6455 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     216    |    2134 K  |    2134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60517 GiB |  60517 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61332 GiB |  61332 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60517 GiB |  60517 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33708 GiB |  33708 GiB |
|       from small pool |      0 KiB |  21434 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10389 K  |   10389 K  |
|       from large pool |       2    |     762    |    5638 K  |    5638 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10389 K  |   10389 K  |
|       from large pool |       2    |     762    |    5638 K  |    5638 K  |
|       from small pool |       0    |    1005    |    4751 K  |    4751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6455 K  |    6455 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     216    |    2134 K  |    2134 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812

 Experiment start at: 2024-07-20 15:08:03.053049
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.5530599, 'precision': 0.5609367, 'recall': 0.5506598, 'specificity': 0.5506598, 'f1': 0.53218013, 'auroc': 0.53539, 'binary_precision': 0.5417628, 'binary_recall': 0.75546974, 'binary_specificity': 0.3458498, 'binary_f1_score': 0.63101315}
confusion matrix:
     0     1
0  525   993
1  380  1174
---- Validation: 
scalar performance:
{'acc': 0.49336457, 'precision': 0.48009086, 'recall': 0.48814645, 'specificity': 0.48814645, 'f1': 0.4329914, 'auroc': 0.6234658, 'binary_precision': 0.45922747, 'binary_recall': 0.16984127, 'binary_specificity': 0.8064516, 'binary_f1_score': 0.24797219}
confusion matrix:
     0    1
0  525  126
1  523  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.5881834, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5492971, 'auroc': 0.6701629, 'binary_precision': 0.6269841, 'binary_recall': 0.3511111, 'binary_specificity': 0.7911111, 'binary_f1_score': 0.45014247}
confusion matrix:
     0   1
0  178  47
1  146  79
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:09:05.608231,epoch time: 0:01:02.555182,used: 0:01:02.555182,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.5911458, 'precision': 0.5919829, 'recall': 0.5903262, 'specificity': 0.5903262, 'f1': 0.58892095, 'auroc': 0.617841, 'binary_precision': 0.5857717, 'binary_recall': 0.65659165, 'binary_specificity': 0.52406067, 'binary_f1_score': 0.61916316}
confusion matrix:
     0     1
0  795   722
1  534  1021
---- Validation: 
scalar performance:
{'acc': 0.47540984, 'precision': 0.42039877, 'recall': 0.46899644, 'specificity': 0.46899644, 'f1': 0.37613636, 'auroc': 0.6350498, 'binary_precision': 0.35, 'binary_recall': 0.07777778, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.12727274}
confusion matrix:
     0   1
0  560  91
1  581  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.5845865, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.4831209, 'auroc': 0.6811851, 'binary_precision': 0.64285713, 'binary_recall': 0.2, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.30508476}
confusion matrix:
     0   1
0  200  25
1  180  45
early stop counter: 1
val acc:0.4754098355770111, best validation acc: 0.4933645725250244, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 2,now: 2024-07-20 15:10:04.297285,epoch time: 0:00:58.689054,used: 0:02:01.244236,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6689453, 'precision': 0.6690009, 'recall': 0.66860294, 'specificity': 0.66860294, 'f1': 0.6685871, 'auroc': 0.7110987, 'binary_precision': 0.6679058, 'binary_recall': 0.6914689, 'binary_specificity': 0.64573693, 'binary_f1_score': 0.6794831}
confusion matrix:
     0     1
0  977   536
1  481  1078
---- Validation: 
scalar performance:
{'acc': 0.47775176, 'precision': 0.42489856, 'recall': 0.47130057, 'specificity': 0.47130057, 'f1': 0.3775343, 'auroc': 0.653227, 'binary_precision': 0.35766423, 'binary_recall': 0.07777778, 'binary_specificity': 0.86482334, 'binary_f1_score': 0.12777054}
confusion matrix:
     0   1
0  563  88
1  581  49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5748254, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.46541542, 'auroc': 0.6998519, 'binary_precision': 0.62903225, 'binary_recall': 0.17333333, 'binary_specificity': 0.8977778, 'binary_f1_score': 0.271777}
confusion matrix:
     0   1
0  202  23
1  186  39
early stop counter: 2
val acc:0.477751761674881, best validation acc: 0.4933645725250244, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 3,now: 2024-07-20 15:11:03.000357,epoch time: 0:00:58.703072,used: 0:02:59.947308,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.726888, 'precision': 0.72687674, 'recall': 0.7267933, 'specificity': 0.7267933, 'f1': 0.7268127, 'auroc': 0.7863419, 'binary_precision': 0.72738856, 'binary_recall': 0.7353509, 'binary_specificity': 0.7182357, 'binary_f1_score': 0.73134804}
confusion matrix:
      0     1
0  1091   428
1   411  1142
---- Validation: 
scalar performance:
{'acc': 0.48790008, 'precision': 0.4531279, 'recall': 0.48151562, 'specificity': 0.48151562, 'f1': 0.3918893, 'auroc': 0.66988516, 'binary_precision': 0.4084507, 'binary_recall': 0.092063494, 'binary_specificity': 0.87096775, 'binary_f1_score': 0.15025906}
confusion matrix:
     0   1
0  567  84
1  572  58
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53555554, 'precision': 0.5769231, 'recall': 0.53555554, 'specificity': 0.53555554, 'f1': 0.46341464, 'auroc': 0.7210074, 'binary_precision': 0.6333333, 'binary_recall': 0.16888888, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.26666665}
confusion matrix:
     0   1
0  203  22
1  187  38
early stop counter: 3
val acc:0.4879000782966614, best validation acc: 0.4933645725250244, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 4,now: 2024-07-20 15:12:01.170946,epoch time: 0:00:58.170589,used: 0:03:58.117897,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.75911456, 'precision': 0.75912076, 'recall': 0.758989, 'specificity': 0.758989, 'f1': 0.7590226, 'auroc': 0.8309489, 'binary_precision': 0.75888324, 'binary_recall': 0.76863754, 'binary_specificity': 0.74934036, 'binary_f1_score': 0.7637292}
confusion matrix:
      0     1
0  1136   380
1   360  1196
---- Validation: 
scalar performance:
{'acc': 0.4980484, 'precision': 0.48024672, 'recall': 0.4917819, 'specificity': 0.4917819, 'f1': 0.4078317, 'auroc': 0.68711627, 'binary_precision': 0.45695364, 'binary_recall': 0.10952381, 'binary_specificity': 0.87403995, 'binary_f1_score': 0.17669654}
confusion matrix:
     0   1
0  569  82
1  561  69
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54888886, 'precision': 0.60288495, 'recall': 0.5488889, 'specificity': 0.5488889, 'f1': 0.4807623, 'auroc': 0.7368494, 'binary_precision': 0.67741936, 'binary_recall': 0.18666667, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.29268292}
confusion matrix:
     0   1
0  205  20
1  183  42
better model found
persisted
after epoch: 5,now: 2024-07-20 15:12:59.835698,epoch time: 0:00:58.664752,used: 0:04:56.782649,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.78776044, 'precision': 0.7877323, 'recall': 0.78771186, 'specificity': 0.78771186, 'f1': 0.78772074, 'auroc': 0.8646601, 'binary_precision': 0.7896087, 'binary_recall': 0.79163986, 'binary_specificity': 0.7837838, 'binary_f1_score': 0.790623}
confusion matrix:
      0     1
0  1189   328
1   324  1231
---- Validation: 
scalar performance:
{'acc': 0.5120999, 'precision': 0.51403034, 'recall': 0.5058372, 'specificity': 0.5058372, 'f1': 0.42440873, 'auroc': 0.70313317, 'binary_precision': 0.51655626, 'binary_recall': 0.123809524, 'binary_specificity': 0.8878648, 'binary_f1_score': 0.19974391}
confusion matrix:
     0   1
0  578  73
1  552  78
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59007967, 'recall': 0.54222226, 'specificity': 0.54222226, 'f1': 0.4721077, 'auroc': 0.74583703, 'binary_precision': 0.6557377, 'binary_recall': 0.17777778, 'binary_specificity': 0.9066667, 'binary_f1_score': 0.27972028}
confusion matrix:
     0   1
0  204  21
1  185  40
better model found
persisted
after epoch: 6,now: 2024-07-20 15:13:59.494612,epoch time: 0:00:59.658914,used: 0:05:56.441563,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.81640625, 'precision': 0.8169122, 'recall': 0.8166746, 'specificity': 0.8166746, 'f1': 0.81639314, 'auroc': 0.8832866, 'binary_precision': 0.83344525, 'binary_recall': 0.7970456, 'binary_specificity': 0.83630365, 'binary_f1_score': 0.8148392}
confusion matrix:
      0     1
0  1267   248
1   316  1241
---- Validation: 
scalar performance:
{'acc': 0.5175644, 'precision': 0.5261095, 'recall': 0.51141834, 'specificity': 0.51141834, 'f1': 0.43448153, 'auroc': 0.71687514, 'binary_precision': 0.5375, 'binary_recall': 0.13650794, 'binary_specificity': 0.8863287, 'binary_f1_score': 0.21772152}
confusion matrix:
     0   1
0  577  74
1  544  86
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.62159127, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.49099362, 'auroc': 0.7589729, 'binary_precision': 0.7096774, 'binary_recall': 0.19555555, 'binary_specificity': 0.92, 'binary_f1_score': 0.30662018}
confusion matrix:
     0   1
0  207  18
1  181  44
better model found
persisted
after epoch: 7,now: 2024-07-20 15:14:59.189722,epoch time: 0:00:59.695110,used: 0:06:56.136673,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.82714844, 'precision': 0.8293028, 'recall': 0.8275921, 'specificity': 0.8275921, 'f1': 0.826983, 'auroc': 0.8956789, 'binary_precision': 0.85884833, 'binary_recall': 0.7875081, 'binary_specificity': 0.8676761, 'binary_f1_score': 0.82163256}
confusion matrix:
      0     1
0  1318   201
1   330  1223
---- Validation: 
scalar performance:
{'acc': 0.51288056, 'precision': 0.5167751, 'recall': 0.5064516, 'specificity': 0.5064516, 'f1': 0.41983697, 'auroc': 0.72702557, 'binary_precision': 0.5217391, 'binary_recall': 0.114285715, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.1875}
confusion matrix:
     0   1
0  585  66
1  558  72
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.6262626, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.47794914, 'auroc': 0.77052844, 'binary_precision': 0.7222222, 'binary_recall': 0.17333333, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.27956986}
confusion matrix:
     0   1
0  210  15
1  186  39
early stop counter: 1
val acc:0.5128805637359619, best validation acc: 0.5175644159317017, corresponding to test acc:                         0.5577777624130249 / 0.5711110830307007
after epoch: 8,now: 2024-07-20 15:15:58.165570,epoch time: 0:00:58.975848,used: 0:07:55.112521,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8343099, 'precision': 0.8376049, 'recall': 0.83488613, 'specificity': 0.83488613, 'f1': 0.83405244, 'auroc': 0.90256476, 'binary_precision': 0.87401575, 'binary_recall': 0.78571427, 'binary_specificity': 0.884058, 'binary_f1_score': 0.8275161}
confusion matrix:
      0     1
0  1342   176
1   333  1221
---- Validation: 
scalar performance:
{'acc': 0.5167838, 'precision': 0.5265211, 'recall': 0.5103943, 'specificity': 0.5103943, 'f1': 0.42576477, 'auroc': 0.7375198, 'binary_precision': 0.53900707, 'binary_recall': 0.12063492, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.19714655}
confusion matrix:
     0   1
0  586  65
1  554  76
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55777776, 'precision': 0.6367845, 'recall': 0.55777776, 'specificity': 0.55777776, 'f1': 0.48314375, 'auroc': 0.77957535, 'binary_precision': 0.7407407, 'binary_recall': 0.17777778, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.28673837}
confusion matrix:
     0   1
0  211  14
1  185  40
early stop counter: 2
val acc:0.5167837738990784, best validation acc: 0.5175644159317017, corresponding to test acc:                         0.5577777624130249 / 0.5711110830307007
after epoch: 9,now: 2024-07-20 15:16:56.567036,epoch time: 0:00:58.401466,used: 0:08:53.513987,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8610026, 'precision': 0.86442435, 'recall': 0.8615749, 'specificity': 0.8615749, 'f1': 0.8607937, 'auroc': 0.9245154, 'binary_precision': 0.9027877, 'binary_recall': 0.81274134, 'binary_specificity': 0.91040844, 'binary_f1_score': 0.85540134}
confusion matrix:
      0     1
0  1382   136
1   291  1263
---- Validation: 
scalar performance:
{'acc': 0.5191257, 'precision': 0.5313715, 'recall': 0.51282644, 'specificity': 0.51282644, 'f1': 0.4314674, 'auroc': 0.74475896, 'binary_precision': 0.5472973, 'binary_recall': 0.12857144, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.20822623}
confusion matrix:
     0   1
0  584  67
1  549  81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.648443, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.49745435, 'auroc': 0.78816795, 'binary_precision': 0.7586207, 'binary_recall': 0.19555555, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.31095406}
confusion matrix:
     0   1
0  211  14
1  181  44
better model found
persisted
after epoch: 10,now: 2024-07-20 15:17:55.239989,epoch time: 0:00:58.672953,used: 0:09:52.186940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.85286456, 'precision': 0.8585725, 'recall': 0.85364753, 'specificity': 0.85364753, 'f1': 0.8524543, 'auroc': 0.9193211, 'binary_precision': 0.9070111, 'binary_recall': 0.7903537, 'binary_specificity': 0.91694134, 'binary_f1_score': 0.8446736}
confusion matrix:
      0     1
0  1391   126
1   326  1229
---- Validation: 
scalar performance:
{'acc': 0.52380955, 'precision': 0.54239607, 'recall': 0.5175371, 'specificity': 0.5175371, 'f1': 0.43781835, 'auroc': 0.7525345, 'binary_precision': 0.56666666, 'binary_recall': 0.13492064, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.21794872}
confusion matrix:
     0   1
0  586  65
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.63046, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.4758679, 'auroc': 0.79423213, 'binary_precision': 0.7307692, 'binary_recall': 0.16888888, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.27436823}
confusion matrix:
     0   1
0  211  14
1  187  38
better model found
persisted
after epoch: 11,now: 2024-07-20 15:18:55.010237,epoch time: 0:00:59.770248,used: 0:10:51.957188,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.85872394, 'precision': 0.8600279, 'recall': 0.85914266, 'specificity': 0.85914266, 'f1': 0.8586736, 'auroc': 0.9203626, 'binary_precision': 0.8853809, 'binary_recall': 0.82851636, 'binary_specificity': 0.88976896, 'binary_f1_score': 0.8560053}
confusion matrix:
      0     1
0  1348   167
1   267  1290
---- Validation: 
scalar performance:
{'acc': 0.5425449, 'precision': 0.57165045, 'recall': 0.53684074, 'specificity': 0.53684074, 'f1': 0.47583294, 'auroc': 0.7592398, 'binary_precision': 0.61340207, 'binary_recall': 0.18888889, 'binary_specificity': 0.8847926, 'binary_f1_score': 0.28883496}
confusion matrix:
     0    1
0  576   75
1  511  119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.6472513, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.5167303, 'auroc': 0.80489874, 'binary_precision': 0.75, 'binary_recall': 0.22666667, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.34812286}
confusion matrix:
     0   1
0  208  17
1  174  51
new oracle model saved
better model found
persisted
after epoch: 12,now: 2024-07-20 15:19:54.839113,epoch time: 0:00:59.828876,used: 0:11:51.786064,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8782552, 'precision': 0.88103867, 'recall': 0.878765, 'specificity': 0.878765, 'f1': 0.8781209, 'auroc': 0.9358865, 'binary_precision': 0.9166667, 'binary_recall': 0.83526385, 'binary_specificity': 0.9222661, 'binary_f1_score': 0.87407416}
confusion matrix:
      0     1
0  1400   118
1   256  1298
---- Validation: 
scalar performance:
{'acc': 0.5409836, 'precision': 0.5739125, 'recall': 0.53504866, 'specificity': 0.53504866, 'f1': 0.46780977, 'auroc': 0.7644527, 'binary_precision': 0.6193182, 'binary_recall': 0.17301588, 'binary_specificity': 0.89708143, 'binary_f1_score': 0.27047145}
confusion matrix:
     0    1
0  584   67
1  521  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56666666, 'precision': 0.64029765, 'recall': 0.56666666, 'specificity': 0.56666666, 'f1': 0.5012249, 'auroc': 0.80956054, 'binary_precision': 0.7419355, 'binary_recall': 0.20444444, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.32055748}
confusion matrix:
     0   1
0  209  16
1  179  46
early stop counter: 1
val acc:0.5409836173057556, best validation acc: 0.5425449013710022, corresponding to test acc:                         0.5755555629730225 / 0.5755555629730225
after epoch: 13,now: 2024-07-20 15:20:53.616572,epoch time: 0:00:58.777459,used: 0:12:50.563523,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.87597656, 'precision': 0.8788059, 'recall': 0.8764622, 'specificity': 0.8764622, 'f1': 0.8758315, 'auroc': 0.93646395, 'binary_precision': 0.91442716, 'binary_recall': 0.8325821, 'binary_specificity': 0.9203423, 'binary_f1_score': 0.8715875}
confusion matrix:
      0     1
0  1398   121
1   260  1293
---- Validation: 
scalar performance:
{'acc': 0.5464481, 'precision': 0.5850605, 'recall': 0.5405274, 'specificity': 0.5405274, 'f1': 0.4744977, 'auroc': 0.7684612, 'binary_precision': 0.6384181, 'binary_recall': 0.17936508, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.28004956}
confusion matrix:
     0    1
0  587   64
1  517  113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.65092325, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51500684, 'auroc': 0.8140247, 'binary_precision': 0.75757575, 'binary_recall': 0.22222222, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.34364262}
confusion matrix:
     0   1
0  209  16
1  175  50
better model found
persisted
after epoch: 14,now: 2024-07-20 15:21:52.085188,epoch time: 0:00:58.468616,used: 0:13:49.032139,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.88671875, 'precision': 0.8922691, 'recall': 0.88746655, 'specificity': 0.88746655, 'f1': 0.88644075, 'auroc': 0.9428619, 'binary_precision': 0.94212455, 'binary_recall': 0.8270096, 'binary_specificity': 0.94792354, 'binary_f1_score': 0.88082194}
confusion matrix:
      0     1
0  1438    79
1   269  1286
---- Validation: 
scalar performance:
{'acc': 0.5480094, 'precision': 0.59077764, 'recall': 0.5420123, 'specificity': 0.5420123, 'f1': 0.47418153, 'auroc': 0.77374244, 'binary_precision': 0.64912283, 'binary_recall': 0.17619048, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.27715355}
confusion matrix:
     0    1
0  591   60
1  519  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5644444, 'precision': 0.63749003, 'recall': 0.5644445, 'specificity': 0.5644445, 'f1': 0.49773353, 'auroc': 0.8157234, 'binary_precision': 0.73770493, 'binary_recall': 0.2, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3146853}
confusion matrix:
     0   1
0  209  16
1  180  45
better model found
persisted
after epoch: 15,now: 2024-07-20 15:22:50.494225,epoch time: 0:00:58.409037,used: 0:14:47.441176,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8925781, 'precision': 0.89699996, 'recall': 0.8932806, 'specificity': 0.8932806, 'f1': 0.89238536, 'auroc': 0.9423137, 'binary_precision': 0.94227993, 'binary_recall': 0.8393316, 'binary_specificity': 0.94722956, 'binary_f1_score': 0.8878314}
confusion matrix:
      0     1
0  1436    80
1   250  1306
---- Validation: 
scalar performance:
{'acc': 0.5565964, 'precision': 0.605891, 'recall': 0.55069125, 'specificity': 0.55069125, 'f1': 0.48659927, 'auroc': 0.7763368, 'binary_precision': 0.6741573, 'binary_recall': 0.1904762, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.2970297}
confusion matrix:
     0    1
0  593   58
1  510  120
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.6420455, 'recall': 0.5711111, 'specificity': 0.5711111, 'f1': 0.5099284, 'auroc': 0.82101727, 'binary_precision': 0.74242425, 'binary_recall': 0.21777777, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.33676976}
confusion matrix:
     0   1
0  208  17
1  176  49
better model found
persisted
after epoch: 16,now: 2024-07-20 15:23:49.134290,epoch time: 0:00:58.640065,used: 0:15:46.081241,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8889974, 'precision': 0.89208513, 'recall': 0.8896508, 'specificity': 0.8896508, 'f1': 0.8888773, 'auroc': 0.94999814, 'binary_precision': 0.93064404, 'binary_recall': 0.8440308, 'binary_specificity': 0.9352708, 'binary_f1_score': 0.8852238}
confusion matrix:
      0     1
0  1416    98
1   243  1315
---- Validation: 
scalar performance:
{'acc': 0.5761124, 'precision': 0.62831426, 'recall': 0.5706349, 'specificity': 0.5706349, 'f1': 0.51941293, 'auroc': 0.7805403, 'binary_precision': 0.70616114, 'binary_recall': 0.23650794, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.35434008}
confusion matrix:
     0    1
0  589   62
1  481  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.6570767, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.53012717, 'auroc': 0.82315063, 'binary_precision': 0.7638889, 'binary_recall': 0.24444444, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.3703704}
confusion matrix:
     0   1
0  208  17
1  170  55
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 15:24:48.173549,epoch time: 0:00:59.039259,used: 0:16:45.120500,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.88932294, 'precision': 0.89425516, 'recall': 0.89010346, 'specificity': 0.89010346, 'f1': 0.8890991, 'auroc': 0.9459356, 'binary_precision': 0.9419027, 'binary_recall': 0.8330122, 'binary_specificity': 0.9471947, 'binary_f1_score': 0.88411725}
confusion matrix:
      0     1
0  1435    80
1   260  1297
---- Validation: 
scalar performance:
{'acc': 0.57533175, 'precision': 0.6264385, 'recall': 0.56986684, 'specificity': 0.56986684, 'f1': 0.5188201, 'auroc': 0.7843001, 'binary_precision': 0.7028302, 'binary_recall': 0.23650794, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.35391924}
confusion matrix:
     0    1
0  588   63
1  481  149
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.66623276, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.5432587, 'auroc': 0.8279901, 'binary_precision': 0.7763158, 'binary_recall': 0.26222223, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.39202663}
confusion matrix:
     0   1
0  208  17
1  166  59
new oracle model saved
early stop counter: 1
val acc:0.5753317475318909, best validation acc: 0.5761123895645142, corresponding to test acc:                         0.5844444632530212 / 0.5933333039283752
after epoch: 18,now: 2024-07-20 15:25:46.507438,epoch time: 0:00:58.333889,used: 0:17:43.454389,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.90266925, 'precision': 0.9077634, 'recall': 0.9033388, 'specificity': 0.9033388, 'f1': 0.9024579, 'auroc': 0.9545162, 'binary_precision': 0.9563636, 'binary_recall': 0.8462033, 'binary_specificity': 0.9604743, 'binary_f1_score': 0.89791733}
confusion matrix:
      0     1
0  1458    60
1   239  1315
---- Validation: 
scalar performance:
{'acc': 0.5690867, 'precision': 0.62428975, 'recall': 0.563364, 'specificity': 0.563364, 'f1': 0.5056129, 'auroc': 0.78650916, 'binary_precision': 0.703125, 'binary_recall': 0.21428572, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.32846716}
confusion matrix:
     0    1
0  594   57
1  495  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5888889, 'precision': 0.6691729, 'recall': 0.5888889, 'specificity': 0.5888889, 'f1': 0.5335481, 'auroc': 0.830479, 'binary_precision': 0.78571427, 'binary_recall': 0.24444444, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.37288135}
confusion matrix:
     0   1
0  210  15
1  170  55
early stop counter: 2
val acc:0.5690866708755493, best validation acc: 0.5761123895645142, corresponding to test acc:                         0.5844444632530212 / 0.5933333039283752
after epoch: 19,now: 2024-07-20 15:26:44.730040,epoch time: 0:00:58.222602,used: 0:18:41.676991,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.898112, 'precision': 0.90244424, 'recall': 0.8987689, 'specificity': 0.8987689, 'f1': 0.89793193, 'auroc': 0.9499681, 'binary_precision': 0.94740635, 'binary_recall': 0.84565914, 'binary_specificity': 0.9518787, 'binary_f1_score': 0.89364594}
confusion matrix:
      0     1
0  1444    73
1   240  1315
---- Validation: 
scalar performance:
{'acc': 0.58313817, 'precision': 0.6385759, 'recall': 0.5777266, 'specificity': 0.5777266, 'f1': 0.52880275, 'auroc': 0.78968376, 'binary_precision': 0.7222222, 'binary_recall': 0.24761905, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.36879432}
confusion matrix:
     0    1
0  591   60
1  474  156
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6, 'precision': 0.66937673, 'recall': 0.6, 'specificity': 0.6, 'f1': 0.5543672, 'auroc': 0.8337778, 'binary_precision': 0.7777778, 'binary_recall': 0.28, 'binary_specificity': 0.92, 'binary_f1_score': 0.41176474}
confusion matrix:
     0   1
0  207  18
1  162  63
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 15:27:44.018369,epoch time: 0:00:59.288329,used: 0:19:40.965320,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.9107417, 'recall': 0.9072507, 'specificity': 0.9072507, 'f1': 0.9064255, 'auroc': 0.9571316, 'binary_precision': 0.9554917, 'binary_recall': 0.8553985, 'binary_specificity': 0.9591029, 'binary_f1_score': 0.9026789}
confusion matrix:
      0     1
0  1454    62
1   225  1331
---- Validation: 
scalar performance:
{'acc': 0.5925059, 'precision': 0.6510466, 'recall': 0.5871992, 'specificity': 0.5871992, 'f1': 0.54156905, 'auroc': 0.79292417, 'binary_precision': 0.7410714, 'binary_recall': 0.26349208, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.3887588}
confusion matrix:
     0    1
0  593   58
1  464  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.61777776, 'precision': 0.69574213, 'recall': 0.61777776, 'specificity': 0.61777776, 'f1': 0.57550895, 'auroc': 0.8375704, 'binary_precision': 0.8192771, 'binary_recall': 0.30222222, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.44155845}
confusion matrix:
     0   1
0  210  15
1  157  68
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 15:28:42.615988,epoch time: 0:00:58.597619,used: 0:20:39.562939,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.8922526, 'precision': 0.8992065, 'recall': 0.89317167, 'specificity': 0.89317167, 'f1': 0.8919256, 'auroc': 0.9507723, 'binary_precision': 0.9554235, 'binary_recall': 0.82594734, 'binary_specificity': 0.96039605, 'binary_f1_score': 0.88598}
confusion matrix:
      0     1
0  1455    60
1   271  1286
---- Validation: 
scalar performance:
{'acc': 0.6088993, 'precision': 0.66394895, 'recall': 0.60396826, 'specificity': 0.60396826, 'f1': 0.56711215, 'auroc': 0.79595983, 'binary_precision': 0.7549407, 'binary_recall': 0.30317461, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.4326161}
confusion matrix:
     0    1
0  589   62
1  439  191
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7039627, 'recall': 0.64, 'specificity': 0.64, 'f1': 0.609375, 'auroc': 0.84185684, 'binary_precision': 0.8181818, 'binary_recall': 0.36, 'binary_specificity': 0.92, 'binary_f1_score': 0.5}
confusion matrix:
     0   1
0  207  18
1  144  81
new oracle model saved
better model found
persisted
after epoch: 22,now: 2024-07-20 15:29:41.522214,epoch time: 0:00:58.906226,used: 0:21:38.469165,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.9087513, 'recall': 0.9055616, 'specificity': 0.9055616, 'f1': 0.90480745, 'auroc': 0.9608993, 'binary_precision': 0.95139384, 'binary_recall': 0.85594857, 'binary_specificity': 0.9551747, 'binary_f1_score': 0.90115094}
confusion matrix:
      0     1
0  1449    68
1   224  1331
---- Validation: 
scalar performance:
{'acc': 0.61748636, 'precision': 0.6703305, 'recall': 0.61274964, 'specificity': 0.61274964, 'f1': 0.57993597, 'auroc': 0.7995123, 'binary_precision': 0.76119405, 'binary_recall': 0.32380953, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.454343}
confusion matrix:
     0    1
0  587   64
1  426  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511111, 'precision': 0.7125945, 'recall': 0.6511111, 'specificity': 0.6511111, 'f1': 0.62392, 'auroc': 0.84460247, 'binary_precision': 0.8269231, 'binary_recall': 0.38222224, 'binary_specificity': 0.92, 'binary_f1_score': 0.52279633}
confusion matrix:
     0   1
0  207  18
1  139  86
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 15:30:40.749831,epoch time: 0:00:59.227617,used: 0:22:37.696782,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9000651, 'precision': 0.90610564, 'recall': 0.90083516, 'specificity': 0.90083516, 'f1': 0.8998034, 'auroc': 0.9555503, 'binary_precision': 0.9588235, 'binary_recall': 0.8385852, 'binary_specificity': 0.96308506, 'binary_f1_score': 0.8946827}
confusion matrix:
      0     1
0  1461    56
1   251  1304
---- Validation: 
scalar performance:
{'acc': 0.618267, 'precision': 0.6738143, 'recall': 0.61346644, 'specificity': 0.61346644, 'f1': 0.5797089, 'auroc': 0.80072415, 'binary_precision': 0.76806086, 'binary_recall': 0.32063493, 'binary_specificity': 0.906298, 'binary_f1_score': 0.45240763}
confusion matrix:
     0    1
0  590   61
1  428  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6533333, 'precision': 0.71428573, 'recall': 0.6533333, 'specificity': 0.6533333, 'f1': 0.62679434, 'auroc': 0.8473877, 'binary_precision': 0.82857144, 'binary_recall': 0.38666666, 'binary_specificity': 0.92, 'binary_f1_score': 0.52727276}
confusion matrix:
     0   1
0  207  18
1  138  87
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 15:31:40.084978,epoch time: 0:00:59.335147,used: 0:23:37.031929,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.91220236, 'recall': 0.9058305, 'specificity': 0.9058305, 'f1': 0.904649, 'auroc': 0.9563916, 'binary_precision': 0.9702381, 'binary_recall': 0.83804625, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.89931035}
confusion matrix:
      0     1
0  1476    40
1   252  1304
---- Validation: 
scalar performance:
{'acc': 0.6167057, 'precision': 0.67235744, 'recall': 0.61187917, 'specificity': 0.61187917, 'f1': 0.5775489, 'auroc': 0.8031453, 'binary_precision': 0.7662835, 'binary_recall': 0.31746033, 'binary_specificity': 0.906298, 'binary_f1_score': 0.4489338}
confusion matrix:
     0    1
0  590   61
1  430  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65555555, 'precision': 0.721856, 'recall': 0.6555556, 'specificity': 0.6555556, 'f1': 0.62774396, 'auroc': 0.84855306, 'binary_precision': 0.84313726, 'binary_recall': 0.38222224, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.52599394}
confusion matrix:
     0   1
0  209  16
1  139  86
new oracle model saved
early stop counter: 1
val acc:0.6167057156562805, best validation acc: 0.6182669997215271, corresponding to test acc:                         0.653333306312561 / 0.6555555462837219
after epoch: 25,now: 2024-07-20 15:32:39.213627,epoch time: 0:00:59.128649,used: 0:24:36.160578,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.9112395, 'recall': 0.9072151, 'specificity': 0.9072151, 'f1': 0.9063948, 'auroc': 0.9612844, 'binary_precision': 0.9580622, 'binary_recall': 0.85263836, 'binary_specificity': 0.9617918, 'binary_f1_score': 0.9022813}
confusion matrix:
      0     1
0  1460    58
1   229  1325
---- Validation: 
scalar performance:
{'acc': 0.6245121, 'precision': 0.6786096, 'recall': 0.6198413, 'specificity': 0.6198413, 'f1': 0.5886987, 'auroc': 0.80621016, 'binary_precision': 0.7728938, 'binary_recall': 0.33492064, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.46733114}
confusion matrix:
     0    1
0  589   62
1  419  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66444445, 'precision': 0.72830737, 'recall': 0.66444445, 'specificity': 0.66444445, 'f1': 0.6392144, 'auroc': 0.8532939, 'binary_precision': 0.8490566, 'binary_recall': 0.4, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.5438067}
confusion matrix:
     0   1
0  209  16
1  135  90
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 15:33:38.938719,epoch time: 0:00:59.725092,used: 0:25:35.885670,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.9141506, 'recall': 0.91111517, 'specificity': 0.91111517, 'f1': 0.91036046, 'auroc': 0.9582962, 'binary_precision': 0.95652175, 'binary_recall': 0.8624679, 'binary_specificity': 0.9597625, 'binary_f1_score': 0.9070632}
confusion matrix:
      0     1
0  1455    61
1   214  1342
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.67268974, 'recall': 0.61431134, 'specificity': 0.61431134, 'f1': 0.58165044, 'auroc': 0.80738306, 'binary_precision': 0.76492536, 'binary_recall': 0.32539684, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.45657012}
confusion matrix:
     0    1
0  588   63
1  425  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66888887, 'precision': 0.7314815, 'recall': 0.6688889, 'specificity': 0.6688889, 'f1': 0.64488304, 'auroc': 0.8547951, 'binary_precision': 0.8518519, 'binary_recall': 0.40888888, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.5525526}
confusion matrix:
     0   1
0  209  16
1  133  92
new oracle model saved
early stop counter: 1
val acc:0.6190476417541504, best validation acc: 0.6245120763778687, corresponding to test acc:                         0.6644444465637207 / 0.6688888669013977
after epoch: 27,now: 2024-07-20 15:34:38.319067,epoch time: 0:00:59.380348,used: 0:26:35.266018,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.91536456, 'precision': 0.9190186, 'recall': 0.91599464, 'specificity': 0.91599464, 'f1': 0.915252, 'auroc': 0.9657035, 'binary_precision': 0.96153843, 'binary_recall': 0.86760926, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.9121622}
confusion matrix:
      0     1
0  1462    54
1   206  1350
---- Validation: 
scalar performance:
{'acc': 0.6206089, 'precision': 0.6741345, 'recall': 0.6158986, 'specificity': 0.6158986, 'f1': 0.58379054, 'auroc': 0.81003344, 'binary_precision': 0.76666665, 'binary_recall': 0.32857144, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.45999998}
confusion matrix:
     0    1
0  588   63
1  423  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6711111, 'precision': 0.736029, 'recall': 0.6711111, 'specificity': 0.6711111, 'f1': 0.64682674, 'auroc': 0.85704696, 'binary_precision': 0.8598131, 'binary_recall': 0.40888888, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.55421686}
confusion matrix:
     0   1
0  210  15
1  133  92
new oracle model saved
early stop counter: 2
val acc:0.620608925819397, best validation acc: 0.6245120763778687, corresponding to test acc:                         0.6644444465637207 / 0.6711111068725586
after epoch: 28,now: 2024-07-20 15:35:37.415773,epoch time: 0:00:59.096706,used: 0:27:34.362724,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9160156, 'precision': 0.9203706, 'recall': 0.9166298, 'specificity': 0.9166298, 'f1': 0.91586953, 'auroc': 0.9638457, 'binary_precision': 0.96618706, 'binary_recall': 0.86422133, 'binary_specificity': 0.9690382, 'binary_f1_score': 0.9123641}
confusion matrix:
      0     1
0  1471    47
1   211  1343
---- Validation: 
scalar performance:
{'acc': 0.6393443, 'precision': 0.68900675, 'recall': 0.6349975, 'specificity': 0.6349975, 'f1': 0.6097067, 'auroc': 0.8139468, 'binary_precision': 0.7818792, 'binary_recall': 0.36984128, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.5021551}
confusion matrix:
     0    1
0  586   65
1  397  233
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68222225, 'precision': 0.73810136, 'recall': 0.68222225, 'specificity': 0.68222225, 'f1': 0.6624156, 'auroc': 0.8606025, 'binary_precision': 0.8534483, 'binary_recall': 0.44, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5806452}
confusion matrix:
     0   1
0  208  17
1  126  99
new oracle model saved
better model found
persisted
after epoch: 29,now: 2024-07-20 15:36:36.041643,epoch time: 0:00:58.625870,used: 0:28:32.988594,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9065755, 'precision': 0.910136, 'recall': 0.90716934, 'specificity': 0.90716934, 'f1': 0.90644896, 'auroc': 0.96318674, 'binary_precision': 0.95156693, 'binary_recall': 0.859164, 'binary_specificity': 0.9551747, 'binary_f1_score': 0.90300775}
confusion matrix:
      0     1
0  1449    68
1   219  1336
---- Validation: 
scalar performance:
{'acc': 0.65261513, 'precision': 0.70096606, 'recall': 0.6484639, 'specificity': 0.6484639, 'f1': 0.6266204, 'auroc': 0.81665564, 'binary_precision': 0.79552716, 'binary_recall': 0.3952381, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.5281018}
confusion matrix:
     0    1
0  587   64
1  381  249
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7022222, 'precision': 0.7495673, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6873963, 'auroc': 0.86285436, 'binary_precision': 0.8582677, 'binary_recall': 0.48444444, 'binary_specificity': 0.92, 'binary_f1_score': 0.6193182}
confusion matrix:
     0    1
0  207   18
1  116  109
new oracle model saved
better model found
persisted
after epoch: 30,now: 2024-07-20 15:37:34.543226,epoch time: 0:00:58.501583,used: 0:29:31.490177,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_08_03_seed_1_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:29:31.490177 at 2024-07-20 15:37:34.543226
persisted model performance metric: 

scalar performance:
{'acc': 0.7022222, 'precision': 0.7495673, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6873963, 'auroc': 0.86285436, 'binary_precision': 0.8582677, 'binary_recall': 0.48444444, 'binary_specificity': 0.92, 'binary_f1_score': 0.6193182}
confusion matrix:
     0    1
0  207   18
1  116  109
oracle model performance metric: 

scalar performance:
{'acc': 0.7022222, 'precision': 0.7495673, 'recall': 0.7022222, 'specificity': 0.7022222, 'f1': 0.6873963, 'auroc': 0.86285436, 'binary_precision': 0.8582677, 'binary_recall': 0.48444444, 'binary_specificity': 0.92, 'binary_f1_score': 0.6193182}
confusion matrix:
     0    1
0  207   18
1  116  109
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8524 MiB |  16788 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     42 MiB |     42 MiB |     56 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65469 GiB |  65469 GiB |
|       from small pool |   8174 KiB |  21434 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20972 K  |   20972 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9573 K  |    9572 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20972 K  |   20972 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9573 K  |    9572 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     369    |     714    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      21    |      21    |      28    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |     380    |   12506 K  |   12506 K  |
|       from large pool |      11    |     351    |    8266 K  |    8266 K  |
|       from small pool |      34    |     216    |    4240 K  |    4240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65469 GiB |  65469 GiB |
|       from small pool |      0 KiB |  22313 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |   12506 K  |   12506 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     216    |    4240 K  |    4240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124076 GiB | 124076 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122424 GiB | 122424 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124061 GiB | 124061 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122412 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67126 GiB |  67126 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65469 GiB |  65469 GiB |
|       from small pool |      0 KiB |  22313 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20972 K  |   20972 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9573 K  |    9573 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |   12506 K  |   12506 K  |
|       from large pool |       3    |     351    |    8266 K  |    8266 K  |
|       from small pool |       0    |     216    |    4240 K  |    4240 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812

 Experiment start at: 2024-07-20 15:38:29.860897
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.58409685, 'precision': 0.603483, 'recall': 0.5857289, 'specificity': 0.5857289, 'f1': 0.56618327, 'auroc': 0.64229345, 'binary_precision': 0.65027934, 'binary_recall': 0.3779221, 'binary_specificity': 0.79353565, 'binary_f1_score': 0.47802874}
confusion matrix:
      0    1
0  1203  313
1   958  582
---- Validation: 
scalar performance:
{'acc': 0.64397496, 'precision': 0.65281534, 'recall': 0.6402439, 'specificity': 0.6402439, 'f1': 0.634945, 'auroc': 0.66944504, 'binary_precision': 0.6835165, 'binary_recall': 0.5, 'binary_specificity': 0.7804878, 'binary_f1_score': 0.5775302}
confusion matrix:
     0    1
0  512  144
1  311  311
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.36342594, 'precision': 0.33976665, 'recall': 0.36342594, 'specificity': 0.36342594, 'f1': 0.3390269, 'auroc': 0.30915636, 'binary_precision': 0.2781955, 'binary_recall': 0.1712963, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.21203437}
confusion matrix:
     0   1
0  120  96
1  179  37
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 15:39:29.364654,epoch time: 0:00:59.503757,used: 0:00:59.503757,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6626309, 'precision': 0.6638925, 'recall': 0.6629416, 'specificity': 0.6629416, 'f1': 0.66223216, 'auroc': 0.71777254, 'binary_precision': 0.68036854, 'binary_recall': 0.6233766, 'binary_specificity': 0.7025066, 'binary_f1_score': 0.6506269}
confusion matrix:
      0    1
0  1065  451
1   580  960
---- Validation: 
scalar performance:
{'acc': 0.6604069, 'precision': 0.660846, 'recall': 0.6590831, 'specificity': 0.6590831, 'f1': 0.6588621, 'auroc': 0.6904801, 'binary_precision': 0.6649123, 'binary_recall': 0.60932475, 'binary_specificity': 0.70884144, 'binary_f1_score': 0.63590604}
confusion matrix:
     0    1
0  465  191
1  243  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4074074, 'precision': 0.4060461, 'recall': 0.4074074, 'specificity': 0.4074074, 'f1': 0.40525308, 'auroc': 0.3411137, 'binary_precision': 0.39473686, 'binary_recall': 0.3472222, 'binary_specificity': 0.4675926, 'binary_f1_score': 0.3694581}
confusion matrix:
     0    1
0  101  115
1  141   75
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 15:40:26.665960,epoch time: 0:00:57.301306,used: 0:01:56.805063,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6894634, 'precision': 0.68949306, 'recall': 0.6894982, 'specificity': 0.6894982, 'f1': 0.689463, 'auroc': 0.7642789, 'binary_precision': 0.69453585, 'binary_recall': 0.6850649, 'binary_specificity': 0.6939314, 'binary_f1_score': 0.6897679}
confusion matrix:
      0     1
0  1052   464
1   485  1055
---- Validation: 
scalar performance:
{'acc': 0.6674491, 'precision': 0.6680081, 'recall': 0.6661095, 'specificity': 0.6661095, 'f1': 0.6659009, 'auroc': 0.7035159, 'binary_precision': 0.6731107, 'binary_recall': 0.6157556, 'binary_specificity': 0.7164634, 'binary_f1_score': 0.64315706}
confusion matrix:
     0    1
0  470  186
1  239  383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4560185, 'precision': 0.4559042, 'recall': 0.4560185, 'specificity': 0.4560185, 'f1': 0.45566562, 'auroc': 0.37502146, 'binary_precision': 0.45365855, 'binary_recall': 0.43055555, 'binary_specificity': 0.4814815, 'binary_f1_score': 0.44180524}
confusion matrix:
     0    1
0  104  112
1  123   93
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 15:41:24.052854,epoch time: 0:00:57.386894,used: 0:02:54.191957,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7431283, 'precision': 0.74311703, 'recall': 0.74309444, 'specificity': 0.74309444, 'f1': 0.74310184, 'auroc': 0.82296073, 'binary_precision': 0.7440207, 'binary_recall': 0.7474026, 'binary_specificity': 0.7387863, 'binary_f1_score': 0.7457078}
confusion matrix:
      0     1
0  1120   396
1   389  1151
---- Validation: 
scalar performance:
{'acc': 0.6830986, 'precision': 0.68601054, 'recall': 0.68102014, 'specificity': 0.68102014, 'f1': 0.68013567, 'auroc': 0.7141817, 'binary_precision': 0.7035647, 'binary_recall': 0.6028939, 'binary_specificity': 0.75914633, 'binary_f1_score': 0.64935064}
confusion matrix:
     0    1
0  498  158
1  247  375
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4675926, 'precision': 0.46695516, 'recall': 0.4675926, 'specificity': 0.4675926, 'f1': 0.46501258, 'auroc': 0.40871483, 'binary_precision': 0.4623656, 'binary_recall': 0.39814815, 'binary_specificity': 0.537037, 'binary_f1_score': 0.42786068}
confusion matrix:
     0    1
0  116  100
1  130   86
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 15:42:21.254811,epoch time: 0:00:57.201957,used: 0:03:51.393914,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7683246, 'precision': 0.7698419, 'recall': 0.76860845, 'specificity': 0.76860845, 'f1': 0.76811445, 'auroc': 0.8492811, 'binary_precision': 0.7921348, 'binary_recall': 0.73246753, 'binary_specificity': 0.80474937, 'binary_f1_score': 0.76113355}
confusion matrix:
      0     1
0  1220   296
1   412  1128
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.6855422, 'recall': 0.677263, 'specificity': 0.677263, 'f1': 0.67531514, 'auroc': 0.72157085, 'binary_precision': 0.71172965, 'binary_recall': 0.5755627, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.63644445}
confusion matrix:
     0    1
0  511  145
1  264  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4722222, 'precision': 0.47090256, 'recall': 0.4722222, 'specificity': 0.4722222, 'f1': 0.46616948, 'auroc': 0.44307268, 'binary_precision': 0.46470588, 'binary_recall': 0.36574075, 'binary_specificity': 0.5787037, 'binary_f1_score': 0.40932643}
confusion matrix:
     0   1
0  125  91
1  137  79
new oracle model saved
early stop counter: 1
val acc:0.6799687147140503, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46759259700775146 / 0.4722222089767456
after epoch: 5,now: 2024-07-20 15:43:18.347381,epoch time: 0:00:57.092570,used: 0:04:48.486484,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7967932, 'precision': 0.7975773, 'recall': 0.79698884, 'specificity': 0.79698884, 'f1': 0.79672253, 'auroc': 0.881078, 'binary_precision': 0.81494176, 'binary_recall': 0.7720779, 'binary_specificity': 0.8218997, 'binary_f1_score': 0.792931}
confusion matrix:
      0     1
0  1246   270
1   351  1189
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.68942463, 'recall': 0.6775253, 'specificity': 0.6775253, 'f1': 0.6744356, 'auroc': 0.7258744, 'binary_precision': 0.72384936, 'binary_recall': 0.5562701, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.62909096}
confusion matrix:
     0    1
0  524  132
1  276  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4722222, 'precision': 0.47006375, 'recall': 0.4722222, 'specificity': 0.4722222, 'f1': 0.4625341, 'auroc': 0.470036, 'binary_precision': 0.4620253, 'binary_recall': 0.33796296, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.3903743}
confusion matrix:
     0   1
0  131  85
1  143  73
early stop counter: 2
val acc:0.6807511448860168, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46759259700775146 / 0.4722222089767456
after epoch: 6,now: 2024-07-20 15:44:16.021148,epoch time: 0:00:57.673767,used: 0:05:46.160251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.838678, 'precision': 0.84048986, 'recall': 0.8389636, 'specificity': 0.8389636, 'f1': 0.83853483, 'auroc': 0.9075876, 'binary_precision': 0.8673684, 'binary_recall': 0.8025974, 'binary_specificity': 0.8753298, 'binary_f1_score': 0.8337268}
confusion matrix:
      0     1
0  1327   189
1   304  1236
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.69077766, 'recall': 0.67642975, 'specificity': 0.67642975, 'f1': 0.67249966, 'auroc': 0.73079807, 'binary_precision': 0.7300216, 'binary_recall': 0.54340833, 'binary_specificity': 0.8094512, 'binary_f1_score': 0.62304145}
confusion matrix:
     0    1
0  531  125
1  284  338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4837963, 'precision': 0.48228967, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.47257942, 'auroc': 0.4920482, 'binary_precision': 0.47712418, 'binary_recall': 0.33796296, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.39566395}
confusion matrix:
     0   1
0  136  80
1  143  73
new oracle model saved
early stop counter: 3
val acc:0.6799687147140503, best validation acc: 0.6830986142158508, corresponding to test acc:                         0.46759259700775146 / 0.48379629850387573
after epoch: 7,now: 2024-07-20 15:45:13.549097,epoch time: 0:00:57.527949,used: 0:06:43.688200,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8445681, 'precision': 0.84789276, 'recall': 0.8449517, 'specificity': 0.8449517, 'f1': 0.8442906, 'auroc': 0.9147222, 'binary_precision': 0.88392216, 'binary_recall': 0.7961039, 'binary_specificity': 0.8937995, 'binary_f1_score': 0.83771783}
confusion matrix:
      0     1
0  1355   161
1   314  1226
---- Validation: 
scalar performance:
{'acc': 0.68466353, 'precision': 0.7001026, 'recall': 0.68062794, 'specificity': 0.68062794, 'f1': 0.67530215, 'auroc': 0.735332, 'binary_precision': 0.74943054, 'binary_recall': 0.5289389, 'binary_specificity': 0.83231705, 'binary_f1_score': 0.62016964}
confusion matrix:
     0    1
0  546  110
1  293  329
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49305555, 'precision': 0.49210352, 'recall': 0.49305558, 'specificity': 0.49305558, 'f1': 0.477301, 'auroc': 0.51050246, 'binary_precision': 0.4893617, 'binary_recall': 0.31944445, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.3865546}
confusion matrix:
     0   1
0  144  72
1  147  69
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-20 15:46:10.781849,epoch time: 0:00:57.232752,used: 0:07:40.920952,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8530759, 'precision': 0.85694987, 'recall': 0.85348576, 'specificity': 0.85348576, 'f1': 0.85277134, 'auroc': 0.9228704, 'binary_precision': 0.89615107, 'binary_recall': 0.8012987, 'binary_specificity': 0.90567285, 'binary_f1_score': 0.8460748}
confusion matrix:
      0     1
0  1373   143
1   306  1234
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.70074964, 'recall': 0.67707926, 'specificity': 0.67707926, 'f1': 0.6701914, 'auroc': 0.7393783, 'binary_precision': 0.75656325, 'binary_recall': 0.5096463, 'binary_specificity': 0.8445122, 'binary_f1_score': 0.6090297}
confusion matrix:
     0    1
0  554  102
1  305  317
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.5080168, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.4898854, 'auroc': 0.530607, 'binary_precision': 0.5109489, 'binary_recall': 0.32407406, 'binary_specificity': 0.6898148, 'binary_f1_score': 0.39660054}
confusion matrix:
     0   1
0  149  67
1  146  70
new oracle model saved
early stop counter: 1
val acc:0.6815336346626282, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5069444179534912
after epoch: 9,now: 2024-07-20 15:47:08.235192,epoch time: 0:00:57.453343,used: 0:08:38.374295,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.86354715, 'precision': 0.8674238, 'recall': 0.86395246, 'specificity': 0.86395246, 'f1': 0.8632723, 'auroc': 0.9322727, 'binary_precision': 0.9071791, 'binary_recall': 0.81233764, 'binary_specificity': 0.9155673, 'binary_f1_score': 0.85714287}
confusion matrix:
      0     1
0  1388   128
1   289  1251
---- Validation: 
scalar performance:
{'acc': 0.6823161, 'precision': 0.70567536, 'recall': 0.6775081, 'specificity': 0.6775081, 'f1': 0.6692513, 'auroc': 0.74259865, 'binary_precision': 0.76865673, 'binary_recall': 0.49678457, 'binary_specificity': 0.8582317, 'binary_f1_score': 0.6035156}
confusion matrix:
     0    1
0  563   93
1  313  309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.5162276, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.49571982, 'auroc': 0.5472822, 'binary_precision': 0.52238804, 'binary_recall': 0.32407406, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.39999998}
confusion matrix:
     0   1
0  152  64
1  146  70
new oracle model saved
early stop counter: 2
val acc:0.6823161244392395, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5138888955116272
after epoch: 10,now: 2024-07-20 15:48:06.153422,epoch time: 0:00:57.918230,used: 0:09:36.292525,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.86845547, 'precision': 0.87306523, 'recall': 0.8688946, 'specificity': 0.8688946, 'f1': 0.86813784, 'auroc': 0.9365641, 'binary_precision': 0.9165447, 'binary_recall': 0.812987, 'binary_specificity': 0.9248021, 'binary_f1_score': 0.86166555}
confusion matrix:
      0     1
0  1402   114
1   288  1252
---- Validation: 
scalar performance:
{'acc': 0.67840374, 'precision': 0.7084961, 'recall': 0.67303056, 'specificity': 0.67303056, 'f1': 0.66206634, 'auroc': 0.74384606, 'binary_precision': 0.7813333, 'binary_recall': 0.47106108, 'binary_specificity': 0.875, 'binary_f1_score': 0.58776325}
confusion matrix:
     0    1
0  574   82
1  329  293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.519891, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.49269277, 'auroc': 0.56031376, 'binary_precision': 0.52845526, 'binary_recall': 0.30092594, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.38348082}
confusion matrix:
     0   1
0  158  58
1  151  65
new oracle model saved
early stop counter: 3
val acc:0.6784037351608276, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5162037014961243
after epoch: 11,now: 2024-07-20 15:49:05.631837,epoch time: 0:00:59.478415,used: 0:10:35.770940,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8792539, 'precision': 0.8819601, 'recall': 0.8795883, 'specificity': 0.8795883, 'f1': 0.8791001, 'auroc': 0.9452386, 'binary_precision': 0.91613364, 'binary_recall': 0.837013, 'binary_specificity': 0.9221636, 'binary_f1_score': 0.8747879}
confusion matrix:
      0     1
0  1398   118
1   251  1289
---- Validation: 
scalar performance:
{'acc': 0.6674491, 'precision': 0.7039609, 'recall': 0.6614849, 'specificity': 0.6614849, 'f1': 0.64680135, 'auroc': 0.7453803, 'binary_precision': 0.7838617, 'binary_recall': 0.43729904, 'binary_specificity': 0.8856707, 'binary_f1_score': 0.5614035}
confusion matrix:
     0    1
0  581   75
1  350  272
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.53295696, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.49686104, 'auroc': 0.57205933, 'binary_precision': 0.54867256, 'binary_recall': 0.28703704, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.3768997}
confusion matrix:
     0   1
0  165  51
1  154  62
new oracle model saved
early stop counter: 4
val acc:0.6674491167068481, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5254629850387573
after epoch: 12,now: 2024-07-20 15:50:03.742812,epoch time: 0:00:58.110975,used: 0:11:33.881915,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.87729055, 'precision': 0.88418275, 'recall': 0.87782013, 'specificity': 0.87782013, 'f1': 0.8768393, 'auroc': 0.93827784, 'binary_precision': 0.93764085, 'binary_recall': 0.81038964, 'binary_specificity': 0.94525063, 'binary_f1_score': 0.8693835}
confusion matrix:
      0     1
0  1433    83
1   292  1248
---- Validation: 
scalar performance:
{'acc': 0.6604069, 'precision': 0.70401716, 'recall': 0.65391684, 'specificity': 0.65391684, 'f1': 0.63551176, 'auroc': 0.7474266, 'binary_precision': 0.7919255, 'binary_recall': 0.40996784, 'binary_specificity': 0.89786583, 'binary_f1_score': 0.54025424}
confusion matrix:
     0    1
0  589   67
1  367  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.5299123, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.48148876, 'auroc': 0.5795396, 'binary_precision': 0.5463917, 'binary_recall': 0.24537037, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.33865812}
confusion matrix:
     0   1
0  172  44
1  163  53
early stop counter: 5
val acc:0.6604068875312805, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5254629850387573
after epoch: 13,now: 2024-07-20 15:51:01.127246,epoch time: 0:00:57.384434,used: 0:12:31.266349,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8900524, 'precision': 0.8937173, 'recall': 0.89043623, 'specificity': 0.89043623, 'f1': 0.8898592, 'auroc': 0.9448977, 'binary_precision': 0.9337176, 'binary_recall': 0.84155846, 'binary_specificity': 0.939314, 'binary_f1_score': 0.8852459}
confusion matrix:
      0     1
0  1424    92
1   244  1296
---- Validation: 
scalar performance:
{'acc': 0.657277, 'precision': 0.70639676, 'recall': 0.6504514, 'specificity': 0.6504514, 'f1': 0.62948775, 'auroc': 0.7493162, 'binary_precision': 0.8006536, 'binary_recall': 0.39389068, 'binary_specificity': 0.9070122, 'binary_f1_score': 0.5280172}
confusion matrix:
     0    1
0  595   61
1  377  245
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5277778, 'precision': 0.5395943, 'recall': 0.5277778, 'specificity': 0.5277778, 'f1': 0.4897047, 'auroc': 0.5841478, 'binary_precision': 0.56122446, 'binary_recall': 0.25462964, 'binary_specificity': 0.8009259, 'binary_f1_score': 0.3503185}
confusion matrix:
     0   1
0  173  43
1  161  55
new oracle model saved
early stop counter: 6
val acc:0.65727698802948, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 14,now: 2024-07-20 15:51:58.197473,epoch time: 0:00:57.070227,used: 0:13:28.336576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8903796, 'precision': 0.8938981, 'recall': 0.8907558, 'specificity': 0.8907558, 'f1': 0.8901959, 'auroc': 0.9525194, 'binary_precision': 0.93314165, 'binary_recall': 0.8428571, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.8857045}
confusion matrix:
      0     1
0  1423    93
1   242  1298
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.70864284, 'recall': 0.639543, 'specificity': 0.639543, 'f1': 0.6118821, 'auroc': 0.74906623, 'binary_precision': 0.8154982, 'binary_recall': 0.35530546, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.4949608}
confusion matrix:
     0    1
0  606   50
1  401  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5138889, 'precision': 0.52216744, 'recall': 0.5138889, 'specificity': 0.5138889, 'f1': 0.46382976, 'auroc': 0.5953146, 'binary_precision': 0.53571427, 'binary_recall': 0.20833333, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.29999998}
confusion matrix:
     0   1
0  177  39
1  171  45
early stop counter: 7
val acc:0.6471048593521118, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 15,now: 2024-07-20 15:52:55.007988,epoch time: 0:00:56.810515,used: 0:14:25.147091,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.888089, 'precision': 0.89351726, 'recall': 0.888555, 'specificity': 0.888555, 'f1': 0.8877814, 'auroc': 0.95008564, 'binary_precision': 0.9417404, 'binary_recall': 0.8292208, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.88190603}
confusion matrix:
      0     1
0  1437    79
1   263  1277
---- Validation: 
scalar performance:
{'acc': 0.6400626, 'precision': 0.7028085, 'recall': 0.63230824, 'specificity': 0.63230824, 'f1': 0.60225916, 'auroc': 0.74943626, 'binary_precision': 0.8091603, 'binary_recall': 0.34083602, 'binary_specificity': 0.9237805, 'binary_f1_score': 0.479638}
confusion matrix:
     0    1
0  606   50
1  410  212
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5092593, 'precision': 0.51505226, 'recall': 0.5092592, 'specificity': 0.5092592, 'f1': 0.45701614, 'auroc': 0.5982939, 'binary_precision': 0.5243902, 'binary_recall': 0.19907407, 'binary_specificity': 0.8194444, 'binary_f1_score': 0.2885906}
confusion matrix:
     0   1
0  177  39
1  173  43
early stop counter: 8
val acc:0.6400625705718994, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 16,now: 2024-07-20 15:53:52.827350,epoch time: 0:00:57.819362,used: 0:15:22.966453,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.8959424, 'precision': 0.9000761, 'recall': 0.89634717, 'specificity': 0.89634717, 'f1': 0.895736, 'auroc': 0.95580983, 'binary_precision': 0.9427536, 'binary_recall': 0.8448052, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.89109594}
confusion matrix:
      0     1
0  1437    79
1   239  1301
---- Validation: 
scalar performance:
{'acc': 0.63380283, 'precision': 0.69971985, 'recall': 0.62579405, 'specificity': 0.62579405, 'f1': 0.5926965, 'auroc': 0.75062495, 'binary_precision': 0.808, 'binary_recall': 0.32475883, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.4633027}
confusion matrix:
     0    1
0  608   48
1  420  202
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5069444, 'precision': 0.511853, 'recall': 0.5069444, 'specificity': 0.5069444, 'f1': 0.45000386, 'auroc': 0.608732, 'binary_precision': 0.5194805, 'binary_recall': 0.18518518, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.27303752}
confusion matrix:
     0   1
0  179  37
1  176  40
early stop counter: 9
val acc:0.6338028311729431, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 17,now: 2024-07-20 15:54:50.190621,epoch time: 0:00:57.363271,used: 0:16:20.329724,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.90183246, 'precision': 0.9048171, 'recall': 0.9021759, 'specificity': 0.9021759, 'f1': 0.90170044, 'auroc': 0.95863515, 'binary_precision': 0.94159544, 'binary_recall': 0.85844153, 'binary_specificity': 0.9459103, 'binary_f1_score': 0.8980978}
confusion matrix:
      0     1
0  1434    82
1   218  1322
---- Validation: 
scalar performance:
{'acc': 0.6236307, 'precision': 0.6919463, 'recall': 0.6153022, 'specificity': 0.6153022, 'f1': 0.57781607, 'auroc': 0.7506568, 'binary_precision': 0.8, 'binary_recall': 0.3022508, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.4387398}
confusion matrix:
     0    1
0  609   47
1  434  188
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.52949554, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.45477927, 'auroc': 0.62103486, 'binary_precision': 0.5492958, 'binary_recall': 0.18055555, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.271777}
confusion matrix:
     0   1
0  184  32
1  177  39
early stop counter: 10
val acc:0.623630702495575, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 18,now: 2024-07-20 15:55:48.074774,epoch time: 0:00:57.884153,used: 0:17:18.213877,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.90445024, 'precision': 0.9079319, 'recall': 0.9048196, 'specificity': 0.9048196, 'f1': 0.9042977, 'auroc': 0.95799434, 'binary_precision': 0.94763273, 'binary_recall': 0.8577922, 'binary_specificity': 0.95184696, 'binary_f1_score': 0.9004772}
confusion matrix:
      0     1
0  1443    73
1   219  1321
---- Validation: 
scalar performance:
{'acc': 0.6236307, 'precision': 0.6907611, 'recall': 0.6153439, 'specificity': 0.6153439, 'f1': 0.5783026, 'auroc': 0.75117147, 'binary_precision': 0.79746836, 'binary_recall': 0.30385852, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.44004655}
confusion matrix:
     0    1
0  608   48
1  433  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.5355588, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.46549672, 'auroc': 0.6269076, 'binary_precision': 0.5584416, 'binary_recall': 0.19907407, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.29351535}
confusion matrix:
     0   1
0  182  34
1  173  43
early stop counter: 11
val acc:0.623630702495575, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 19,now: 2024-07-20 15:56:45.305991,epoch time: 0:00:57.231217,used: 0:18:15.445094,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9034686, 'precision': 0.9075109, 'recall': 0.9038661, 'specificity': 0.9038661, 'f1': 0.9032854, 'auroc': 0.9579228, 'binary_precision': 0.95010847, 'binary_recall': 0.85324675, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.8990763}
confusion matrix:
      0     1
0  1447    69
1   226  1314
---- Validation: 
scalar performance:
{'acc': 0.62989044, 'precision': 0.6974951, 'recall': 0.62173307, 'specificity': 0.62173307, 'f1': 0.58673155, 'auroc': 0.75489914, 'binary_precision': 0.80658436, 'binary_recall': 0.31511253, 'binary_specificity': 0.92835367, 'binary_f1_score': 0.45317918}
confusion matrix:
     0    1
0  609   47
1  426  196
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.525463, 'precision': 0.5426005, 'recall': 0.525463, 'specificity': 0.525463, 'f1': 0.47240174, 'auroc': 0.63470936, 'binary_precision': 0.56962025, 'binary_recall': 0.20833333, 'binary_specificity': 0.8425926, 'binary_f1_score': 0.30508474}
confusion matrix:
     0   1
0  182  34
1  171  45
early stop counter: 12
val acc:0.6298904418945312, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5277777910232544
after epoch: 20,now: 2024-07-20 15:57:42.640703,epoch time: 0:00:57.334712,used: 0:19:12.779806,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9060864, 'precision': 0.9076983, 'recall': 0.9063402, 'specificity': 0.9063402, 'f1': 0.9060267, 'auroc': 0.95566857, 'binary_precision': 0.93537176, 'binary_recall': 0.874026, 'binary_specificity': 0.93865436, 'binary_f1_score': 0.9036589}
confusion matrix:
      0     1
0  1423    93
1   194  1346
---- Validation: 
scalar performance:
{'acc': 0.6314554, 'precision': 0.69769335, 'recall': 0.62338245, 'specificity': 0.62338245, 'f1': 0.5894019, 'auroc': 0.7560706, 'binary_precision': 0.805668, 'binary_recall': 0.31993568, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.45799765}
confusion matrix:
     0    1
0  608   48
1  423  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.5633825, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.4911179, 'auroc': 0.6407965, 'binary_precision': 0.60240966, 'binary_recall': 0.23148148, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.33444816}
confusion matrix:
     0   1
0  183  33
1  166  50
new oracle model saved
early stop counter: 13
val acc:0.6314554214477539, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5393518805503845
after epoch: 21,now: 2024-07-20 15:58:41.300944,epoch time: 0:00:58.660241,used: 0:20:11.440047,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90674084, 'precision': 0.9112574, 'recall': 0.9071591, 'specificity': 0.9071591, 'f1': 0.9065418, 'auroc': 0.9578942, 'binary_precision': 0.9563636, 'binary_recall': 0.8538961, 'binary_specificity': 0.96042216, 'binary_f1_score': 0.9022298}
confusion matrix:
      0     1
0  1456    60
1   225  1315
---- Validation: 
scalar performance:
{'acc': 0.63067293, 'precision': 0.69701266, 'recall': 0.6225786, 'specificity': 0.6225786, 'f1': 0.5883001, 'auroc': 0.7581415, 'binary_precision': 0.80487806, 'binary_recall': 0.31832796, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.45622116}
confusion matrix:
     0    1
0  608   48
1  424  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.56650245, 'recall': 0.5416666, 'specificity': 0.5416666, 'f1': 0.4944681, 'auroc': 0.6476766, 'binary_precision': 0.60714287, 'binary_recall': 0.2361111, 'binary_specificity': 0.8472222, 'binary_f1_score': 0.34}
confusion matrix:
     0   1
0  183  33
1  165  51
new oracle model saved
early stop counter: 14
val acc:0.6306729316711426, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5416666865348816
after epoch: 22,now: 2024-07-20 15:59:39.157188,epoch time: 0:00:57.856244,used: 0:21:09.296291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.91197646, 'precision': 0.9142022, 'recall': 0.91227174, 'specificity': 0.91227174, 'f1': 0.9118948, 'auroc': 0.96489525, 'binary_precision': 0.94659173, 'binary_recall': 0.87467533, 'binary_specificity': 0.9498681, 'binary_f1_score': 0.9092136}
confusion matrix:
      0     1
0  1440    76
1   193  1347
---- Validation: 
scalar performance:
{'acc': 0.6314554, 'precision': 0.69769335, 'recall': 0.62338245, 'specificity': 0.62338245, 'f1': 0.5894019, 'auroc': 0.7607173, 'binary_precision': 0.805668, 'binary_recall': 0.31993568, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.45799765}
confusion matrix:
     0    1
0  608   48
1  423  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.57389164, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49957442, 'auroc': 0.6529492, 'binary_precision': 0.61904764, 'binary_recall': 0.24074075, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.34666666}
confusion matrix:
     0   1
0  184  32
1  164  52
new oracle model saved
early stop counter: 15
val acc:0.6314554214477539, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5462962985038757
after epoch: 23,now: 2024-07-20 16:00:37.575616,epoch time: 0:00:58.418428,used: 0:22:07.714719,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90052354, 'precision': 0.90623856, 'recall': 0.90099543, 'specificity': 0.90099543, 'f1': 0.9002433, 'auroc': 0.9590093, 'binary_precision': 0.9564254, 'binary_recall': 0.84090906, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.8949551}
confusion matrix:
      0     1
0  1457    59
1   245  1295
---- Validation: 
scalar performance:
{'acc': 0.62754303, 'precision': 0.69426274, 'recall': 0.6193632, 'specificity': 0.6193632, 'f1': 0.5838751, 'auroc': 0.7612712, 'binary_precision': 0.8016529, 'binary_recall': 0.3118971, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.44907412}
confusion matrix:
     0    1
0  608   48
1  428  194
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.58128077, 'recall': 0.5509259, 'specificity': 0.5509259, 'f1': 0.5046809, 'auroc': 0.6581576, 'binary_precision': 0.63095236, 'binary_recall': 0.24537037, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.35333332}
confusion matrix:
     0   1
0  185  31
1  163  53
new oracle model saved
early stop counter: 16
val acc:0.627543032169342, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5509259104728699
after epoch: 24,now: 2024-07-20 16:01:36.087778,epoch time: 0:00:58.512162,used: 0:23:06.226881,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.8998691, 'precision': 0.90437233, 'recall': 0.90028954, 'specificity': 0.90028954, 'f1': 0.8996525, 'auroc': 0.96123844, 'binary_precision': 0.9490539, 'binary_recall': 0.84675324, 'binary_specificity': 0.95382583, 'binary_f1_score': 0.89498967}
confusion matrix:
      0     1
0  1446    70
1   236  1304
---- Validation: 
scalar performance:
{'acc': 0.6189358, 'precision': 0.6995496, 'recall': 0.6101041, 'specificity': 0.6101041, 'f1': 0.5663598, 'auroc': 0.76301616, 'binary_precision': 0.8199052, 'binary_recall': 0.27813506, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.41536614}
confusion matrix:
     0    1
0  618   38
1  449  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5555556, 'precision': 0.5978409, 'recall': 0.5555556, 'specificity': 0.5555556, 'f1': 0.50171816, 'auroc': 0.66743827, 'binary_precision': 0.6621622, 'binary_recall': 0.22685185, 'binary_specificity': 0.8842593, 'binary_f1_score': 0.33793107}
confusion matrix:
     0   1
0  191  25
1  167  49
new oracle model saved
early stop counter: 17
val acc:0.6189358234405518, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5555555820465088
after epoch: 25,now: 2024-07-20 16:02:33.968797,epoch time: 0:00:57.881019,used: 0:24:04.107900,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.9234293, 'precision': 0.92600596, 'recall': 0.92374325, 'specificity': 0.92374325, 'f1': 0.92334723, 'auroc': 0.96975076, 'binary_precision': 0.9611582, 'binary_recall': 0.88376623, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.920839}
confusion matrix:
      0     1
0  1461    55
1   179  1361
---- Validation: 
scalar performance:
{'acc': 0.6236307, 'precision': 0.700893, 'recall': 0.6150106, 'specificity': 0.6150106, 'f1': 0.57431245, 'auroc': 0.7657536, 'binary_precision': 0.81900454, 'binary_recall': 0.2909968, 'binary_specificity': 0.9390244, 'binary_f1_score': 0.42941877}
confusion matrix:
     0    1
0  616   40
1  441  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5625, 'precision': 0.6045649, 'recall': 0.5625, 'specificity': 0.5625, 'f1': 0.5135802, 'auroc': 0.67153203, 'binary_precision': 0.6708861, 'binary_recall': 0.24537037, 'binary_specificity': 0.8796296, 'binary_f1_score': 0.35932204}
confusion matrix:
     0   1
0  190  26
1  163  53
new oracle model saved
early stop counter: 18
val acc:0.623630702495575, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5625
after epoch: 26,now: 2024-07-20 16:03:32.993265,epoch time: 0:00:59.024468,used: 0:25:03.132368,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91492146, 'precision': 0.91712105, 'recall': 0.9152143, 'specificity': 0.9152143, 'f1': 0.9148443, 'auroc': 0.9693662, 'binary_precision': 0.9494382, 'binary_recall': 0.87792206, 'binary_specificity': 0.9525066, 'binary_f1_score': 0.9122807}
confusion matrix:
      0     1
0  1444    72
1   188  1352
---- Validation: 
scalar performance:
{'acc': 0.6314554, 'precision': 0.70498157, 'recall': 0.62313247, 'specificity': 0.62313247, 'f1': 0.5865933, 'auroc': 0.76876324, 'binary_precision': 0.8212766, 'binary_recall': 0.31028938, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.45040834}
confusion matrix:
     0    1
0  614   42
1  429  193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5578704, 'precision': 0.5932095, 'recall': 0.5578704, 'specificity': 0.5578704, 'f1': 0.51157546, 'auroc': 0.68001974, 'binary_precision': 0.6506024, 'binary_recall': 0.25, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.361204}
confusion matrix:
     0   1
0  187  29
1  162  54
early stop counter: 19
val acc:0.6314554214477539, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5625
after epoch: 27,now: 2024-07-20 16:04:31.300938,epoch time: 0:00:58.307673,used: 0:26:01.440041,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9060864, 'precision': 0.9092398, 'recall': 0.9064378, 'specificity': 0.9064378, 'f1': 0.90595317, 'auroc': 0.9621132, 'binary_precision': 0.94718057, 'binary_recall': 0.8616883, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.90241414}
confusion matrix:
      0     1
0  1442    74
1   213  1327
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.70137894, 'recall': 0.6249069, 'specificity': 0.6249069, 'f1': 0.5906875, 'auroc': 0.7712214, 'binary_precision': 0.8122449, 'binary_recall': 0.31993568, 'binary_specificity': 0.92987806, 'binary_f1_score': 0.4590542}
confusion matrix:
     0    1
0  610   46
1  423  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.6035806, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.53078574, 'auroc': 0.68584967, 'binary_precision': 0.6630435, 'binary_recall': 0.2824074, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.3961039}
confusion matrix:
     0   1
0  185  31
1  155  61
new oracle model saved
early stop counter: 20
val acc:0.6330203413963318, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5694444179534912
after epoch: 28,now: 2024-07-20 16:05:29.195482,epoch time: 0:00:57.894544,used: 0:26:59.334585,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.914267, 'precision': 0.91803133, 'recall': 0.9146472, 'specificity': 0.9146472, 'f1': 0.91412103, 'auroc': 0.9659643, 'binary_precision': 0.9597122, 'binary_recall': 0.86623377, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9105802}
confusion matrix:
      0     1
0  1460    56
1   206  1334
---- Validation: 
scalar performance:
{'acc': 0.62676054, 'precision': 0.7077819, 'recall': 0.618101, 'specificity': 0.618101, 'f1': 0.577342, 'auroc': 0.77182674, 'binary_precision': 0.8310502, 'binary_recall': 0.2926045, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.43281808}
confusion matrix:
     0    1
0  619   37
1  440  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5601852, 'precision': 0.5978397, 'recall': 0.5601852, 'specificity': 0.5601852, 'f1': 0.51336354, 'auroc': 0.6898148, 'binary_precision': 0.6585366, 'binary_recall': 0.25, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.36241612}
confusion matrix:
     0   1
0  188  28
1  162  54
early stop counter: 21
val acc:0.6267605423927307, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5694444179534912
after epoch: 29,now: 2024-07-20 16:06:27.063821,epoch time: 0:00:57.868339,used: 0:27:57.202924,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9132853, 'precision': 0.9174168, 'recall': 0.91368353, 'specificity': 0.91368353, 'f1': 0.91312075, 'auroc': 0.9680915, 'binary_precision': 0.9609544, 'binary_recall': 0.86298704, 'binary_specificity': 0.96437997, 'binary_f1_score': 0.9093397}
confusion matrix:
      0     1
0  1462    54
1   211  1329
---- Validation: 
scalar performance:
{'acc': 0.62910795, 'precision': 0.7111875, 'recall': 0.62047094, 'specificity': 0.62047094, 'f1': 0.5802543, 'auroc': 0.772388, 'binary_precision': 0.8363636, 'binary_recall': 0.29581994, 'binary_specificity': 0.94512194, 'binary_f1_score': 0.43705463}
confusion matrix:
     0    1
0  620   36
1  438  184
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5694444, 'precision': 0.60888565, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.5265725, 'auroc': 0.6935228, 'binary_precision': 0.6744186, 'binary_recall': 0.2685185, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.38410595}
confusion matrix:
     0   1
0  188  28
1  158  58
early stop counter: 22
val acc:0.6291079521179199, best validation acc: 0.6846635341644287, corresponding to test acc:                         0.4930555522441864 / 0.5694444179534912
after epoch: 30,now: 2024-07-20 16:07:24.554907,epoch time: 0:00:57.491086,used: 0:28:54.694010,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_15_38_29_seed_2_22504812
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:28:54.694010 at 2024-07-20 16:07:24.554907
persisted model performance metric: 

scalar performance:
{'acc': 0.49305555, 'precision': 0.49210352, 'recall': 0.49305558, 'specificity': 0.49305558, 'f1': 0.477301, 'auroc': 0.51050246, 'binary_precision': 0.4893617, 'binary_recall': 0.31944445, 'binary_specificity': 0.6666667, 'binary_f1_score': 0.3865546}
confusion matrix:
     0   1
0  144  72
1  147  69
oracle model performance metric: 

scalar performance:
{'acc': 0.5694444, 'precision': 0.6035806, 'recall': 0.5694444, 'specificity': 0.5694444, 'f1': 0.53078574, 'auroc': 0.68584967, 'binary_precision': 0.6630435, 'binary_recall': 0.2824074, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.3961039}
confusion matrix:
     0   1
0  185  31
1  155  61
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185300 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185300 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182816 GiB | 182816 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8510 MiB |   8524 MiB |  25068 MiB |  16558 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  24998 MiB |  16526 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB |  98950 GiB |  98950 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  96478 GiB |  96478 GiB |
|       from small pool |   8180 KiB |  22313 KiB |   2471 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31318 K  |   31317 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31318 K  |   31317 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     367    |     369    |    1059    |     692    |
|       from large pool |     348    |     349    |    1024    |     676    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     381    |   18412 K  |   18412 K  |
|       from large pool |      11    |     351    |   12107 K  |   12107 K  |
|       from small pool |      33    |     216    |    6304 K  |    6304 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185300 GiB | 185300 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185300 GiB | 185300 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182835 GiB | 182835 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182816 GiB | 182816 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25068 MiB |  24838 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  24998 MiB |  24792 MiB |
|       from small pool |  24576 KiB |     42 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  98950 GiB |  98950 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  96478 GiB |  96478 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2471 GiB |   2471 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31318 K  |   31318 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31318 K  |   31318 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14295 K  |   14295 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |    1059    |    1037    |
|       from large pool |      10    |     349    |    1024    |    1014    |
|       from small pool |      12    |      21    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     381    |   18412 K  |   18412 K  |
|       from large pool |       3    |     351    |   12107 K  |   12107 K  |
|       from small pool |       0    |     216    |    6305 K  |    6305 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 16:07:59 2024]
Finished job 0.
1 of 1 steps (100%) done
