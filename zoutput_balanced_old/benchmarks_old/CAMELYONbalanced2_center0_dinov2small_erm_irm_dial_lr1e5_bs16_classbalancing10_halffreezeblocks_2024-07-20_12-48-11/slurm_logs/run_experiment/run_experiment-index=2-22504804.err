Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Sat Jul 20 12:50:39 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/2.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=2
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804

 Experiment start at: 2024-07-20 12:53:25.872478
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.569767415523529
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54785156, 'precision': 0.5487145, 'recall': 0.5465541, 'specificity': 0.5465541, 'f1': 0.5421437, 'auroc': 0.5846168, 'binary_precision': 0.5446237, 'binary_recall': 0.65144694, 'binary_specificity': 0.44166118, 'binary_f1_score': 0.593265}
confusion matrix:
     0     1
0  670   847
1  542  1013
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.63586956, 'precision': 0.6392648, 'recall': 0.63461554, 'specificity': 0.63461554, 'f1': 0.63229454, 'auroc': 0.70405996, 'binary_precision': 0.65779465, 'binary_recall': 0.5448819, 'binary_specificity': 0.72434914, 'binary_f1_score': 0.5960379}
confusion matrix:
     0    1
0  473  180
1  289  346
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6368326, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.629666, 'auroc': 0.67173606, 'binary_precision': 0.66101694, 'binary_recall': 0.54418606, 'binary_specificity': 0.7209302, 'binary_f1_score': 0.5969387}
confusion matrix:
     0    1
0  155   60
1   98  117
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 12:55:07.038001,epoch time: 0:01:41.165523,used: 0:01:41.165523,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.68391925, 'precision': 0.68710756, 'recall': 0.6829797, 'specificity': 0.6829797, 'f1': 0.681829, 'auroc': 0.7491186, 'binary_precision': 0.66572237, 'binary_recall': 0.7551414, 'binary_specificity': 0.61081797, 'binary_f1_score': 0.7076182}
confusion matrix:
     0     1
0  926   590
1  381  1175
---- Validation: 
scalar performance:
{'acc': 0.6304348, 'precision': 0.642096, 'recall': 0.6282789, 'specificity': 0.6282789, 'f1': 0.62034225, 'auroc': 0.7119991, 'binary_precision': 0.67945826, 'binary_recall': 0.47401574, 'binary_specificity': 0.7825421, 'binary_f1_score': 0.5584416}
confusion matrix:
     0    1
0  511  142
1  334  301
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6302326, 'precision': 0.6433333, 'recall': 0.6302326, 'specificity': 0.6302326, 'f1': 0.6215857, 'auroc': 0.6923742, 'binary_precision': 0.68666667, 'binary_recall': 0.47906977, 'binary_specificity': 0.7813954, 'binary_f1_score': 0.56438357}
confusion matrix:
     0    1
0  168   47
1  112  103
early stop counter: 1
val acc:0.6304348111152649, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 2,now: 2024-07-20 12:56:25.536126,epoch time: 0:01:18.498125,used: 0:02:59.663648,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.74609375, 'precision': 0.7460549, 'recall': 0.7460761, 'specificity': 0.7460761, 'f1': 0.74606264, 'auroc': 0.8132118, 'binary_precision': 0.7503226, 'binary_recall': 0.7474293, 'binary_specificity': 0.74472296, 'binary_f1_score': 0.7488731}
confusion matrix:
      0     1
0  1129   387
1   393  1163
---- Validation: 
scalar performance:
{'acc': 0.6234472, 'precision': 0.64178216, 'recall': 0.62077993, 'specificity': 0.62077993, 'f1': 0.60783356, 'auroc': 0.7197888, 'binary_precision': 0.68939394, 'binary_recall': 0.42992127, 'binary_specificity': 0.8116386, 'binary_f1_score': 0.529583}
confusion matrix:
     0    1
0  530  123
1  362  273
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.63255817, 'precision': 0.6526494, 'recall': 0.6325581, 'specificity': 0.6325581, 'f1': 0.6200564, 'auroc': 0.7111087, 'binary_precision': 0.7080292, 'binary_recall': 0.4511628, 'binary_specificity': 0.81395346, 'binary_f1_score': 0.5511364}
confusion matrix:
     0   1
0  175  40
1  118  97
early stop counter: 2
val acc:0.6234471797943115, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 3,now: 2024-07-20 12:57:44.187312,epoch time: 0:01:18.651186,used: 0:04:18.314834,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7890625, 'precision': 0.78932893, 'recall': 0.78923965, 'specificity': 0.78923965, 'f1': 0.7890581, 'auroc': 0.8545377, 'binary_precision': 0.80172986, 'binary_recall': 0.7749196, 'binary_specificity': 0.80355966, 'binary_f1_score': 0.78809685}
confusion matrix:
      0     1
0  1219   298
1   350  1205
---- Validation: 
scalar performance:
{'acc': 0.6086956, 'precision': 0.6353758, 'recall': 0.6054286, 'specificity': 0.6054286, 'f1': 0.58430326, 'auroc': 0.7234616, 'binary_precision': 0.6920821, 'binary_recall': 0.37165356, 'binary_specificity': 0.83920366, 'binary_f1_score': 0.48360655}
confusion matrix:
     0    1
0  548  105
1  399  236
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6255814, 'precision': 0.6544869, 'recall': 0.6255814, 'specificity': 0.6255814, 'f1': 0.6072079, 'auroc': 0.7235046, 'binary_precision': 0.72131145, 'binary_recall': 0.40930232, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.5222551}
confusion matrix:
     0   1
0  181  34
1  127  88
early stop counter: 3
val acc:0.6086956262588501, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 4,now: 2024-07-20 12:59:05.191054,epoch time: 0:01:21.003742,used: 0:05:39.318576,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.8183594, 'precision': 0.82312524, 'recall': 0.8191801, 'specificity': 0.8191801, 'f1': 0.81792533, 'auroc': 0.8794097, 'binary_precision': 0.8659341, 'binary_recall': 0.75915223, 'binary_specificity': 0.8792079, 'binary_f1_score': 0.80903494}
confusion matrix:
      0     1
0  1332   183
1   375  1182
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.6246051, 'recall': 0.5886544, 'specificity': 0.5886544, 'f1': 0.5588808, 'auroc': 0.72964025, 'binary_precision': 0.68456376, 'binary_recall': 0.32125986, 'binary_specificity': 0.856049, 'binary_f1_score': 0.43729904}
confusion matrix:
     0    1
0  559   94
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60465115, 'precision': 0.643627, 'recall': 0.60465115, 'specificity': 0.60465115, 'f1': 0.57587785, 'auroc': 0.73724174, 'binary_precision': 0.7184466, 'binary_recall': 0.34418604, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.46540877}
confusion matrix:
     0   1
0  186  29
1  141  74
early stop counter: 4
val acc:0.592391312122345, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 5,now: 2024-07-20 13:00:25.585987,epoch time: 0:01:20.394933,used: 0:06:59.713509,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.83658856, 'precision': 0.84017336, 'recall': 0.837288, 'specificity': 0.837288, 'f1': 0.8363304, 'auroc': 0.8940469, 'binary_precision': 0.8786791, 'binary_recall': 0.78612715, 'binary_specificity': 0.88844883, 'binary_f1_score': 0.8298305}
confusion matrix:
      0     1
0  1346   169
1   333  1224
---- Validation: 
scalar performance:
{'acc': 0.5947205, 'precision': 0.6275959, 'recall': 0.59099495, 'specificity': 0.59099495, 'f1': 0.56160426, 'auroc': 0.7338076, 'binary_precision': 0.68896323, 'binary_recall': 0.32440946, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.4411135}
confusion matrix:
     0    1
0  560   93
1  429  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.6609054, 'recall': 0.62325585, 'specificity': 0.62325585, 'f1': 0.5998484, 'auroc': 0.74632776, 'binary_precision': 0.7387387, 'binary_recall': 0.38139534, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.50306743}
confusion matrix:
     0   1
0  186  29
1  133  82
early stop counter: 5
val acc:0.5947204828262329, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 6,now: 2024-07-20 13:01:44.377848,epoch time: 0:01:18.791861,used: 0:08:18.505370,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8421224, 'precision': 0.8459766, 'recall': 0.8428781, 'specificity': 0.8428781, 'f1': 0.8418606, 'auroc': 0.89803636, 'binary_precision': 0.8862491, 'binary_recall': 0.79011554, 'binary_specificity': 0.8956407, 'binary_f1_score': 0.83542585}
confusion matrix:
      0     1
0  1356   158
1   327  1231
---- Validation: 
scalar performance:
{'acc': 0.5923913, 'precision': 0.6246051, 'recall': 0.5886544, 'specificity': 0.5886544, 'f1': 0.5588808, 'auroc': 0.7379436, 'binary_precision': 0.68456376, 'binary_recall': 0.32125986, 'binary_specificity': 0.856049, 'binary_f1_score': 0.43729904}
confusion matrix:
     0    1
0  559   94
1  431  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6232558, 'precision': 0.6609054, 'recall': 0.62325585, 'specificity': 0.62325585, 'f1': 0.5998484, 'auroc': 0.75500274, 'binary_precision': 0.7387387, 'binary_recall': 0.38139534, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.50306743}
confusion matrix:
     0   1
0  186  29
1  133  82
early stop counter: 6
val acc:0.592391312122345, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 7,now: 2024-07-20 13:03:05.880486,epoch time: 0:01:21.502638,used: 0:09:40.008008,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.8564453, 'precision': 0.8640717, 'recall': 0.8573918, 'specificity': 0.8573918, 'f1': 0.85589993, 'auroc': 0.9118558, 'binary_precision': 0.9201206, 'binary_recall': 0.7847044, 'binary_specificity': 0.93007916, 'binary_f1_score': 0.8470344}
confusion matrix:
      0     1
0  1410   106
1   335  1221
---- Validation: 
scalar performance:
{'acc': 0.5954969, 'precision': 0.63258445, 'recall': 0.5916304, 'specificity': 0.5916304, 'f1': 0.5597535, 'auroc': 0.7428965, 'binary_precision': 0.6993007, 'binary_recall': 0.31496063, 'binary_specificity': 0.86830014, 'binary_f1_score': 0.43431053}
confusion matrix:
     0    1
0  567   86
1  435  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.627907, 'precision': 0.6689817, 'recall': 0.627907, 'specificity': 0.627907, 'f1': 0.6038327, 'auroc': 0.7624013, 'binary_precision': 0.7522936, 'binary_recall': 0.38139534, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.50617284}
confusion matrix:
     0   1
0  188  27
1  133  82
early stop counter: 7
val acc:0.5954968929290771, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6325581669807434
after epoch: 8,now: 2024-07-20 13:04:26.556055,epoch time: 0:01:20.675569,used: 0:11:00.683577,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.86002606, 'precision': 0.86648476, 'recall': 0.860808, 'specificity': 0.860808, 'f1': 0.8595755, 'auroc': 0.92238104, 'binary_precision': 0.9181548, 'binary_recall': 0.7940798, 'binary_specificity': 0.92753625, 'binary_f1_score': 0.8516218}
confusion matrix:
      0     1
0  1408   110
1   320  1234
---- Validation: 
scalar performance:
{'acc': 0.5986025, 'precision': 0.6351639, 'recall': 0.5948017, 'specificity': 0.5948017, 'f1': 0.5643818, 'auroc': 0.747349, 'binary_precision': 0.7020548, 'binary_recall': 0.32283464, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.44228694}
confusion matrix:
     0    1
0  566   87
1  430  205
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6348837, 'precision': 0.67117834, 'recall': 0.63488376, 'specificity': 0.63488376, 'f1': 0.61444664, 'auroc': 0.7713142, 'binary_precision': 0.75, 'binary_recall': 0.40465117, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.52567977}
confusion matrix:
     0   1
0  186  29
1  128  87
new oracle model saved
early stop counter: 8
val acc:0.5986024737358093, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6348837018013
after epoch: 9,now: 2024-07-20 13:05:45.776576,epoch time: 0:01:19.220521,used: 0:12:19.904098,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8639323, 'precision': 0.87203443, 'recall': 0.8649485, 'specificity': 0.8649485, 'f1': 0.8633987, 'auroc': 0.9219176, 'binary_precision': 0.93046105, 'binary_recall': 0.790623, 'binary_specificity': 0.93927395, 'binary_f1_score': 0.8548611}
confusion matrix:
      0     1
0  1423    92
1   326  1231
---- Validation: 
scalar performance:
{'acc': 0.60170805, 'precision': 0.63832283, 'recall': 0.5979513, 'specificity': 0.5979513, 'f1': 0.56856275, 'auroc': 0.75023574, 'binary_precision': 0.7060811, 'binary_recall': 0.32913387, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.44897962}
confusion matrix:
     0    1
0  566   87
1  426  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6418605, 'precision': 0.6810214, 'recall': 0.6418605, 'specificity': 0.6418605, 'f1': 0.62138367, 'auroc': 0.77700377, 'binary_precision': 0.76521736, 'binary_recall': 0.40930232, 'binary_specificity': 0.8744186, 'binary_f1_score': 0.53333336}
confusion matrix:
     0   1
0  188  27
1  127  88
new oracle model saved
early stop counter: 9
val acc:0.6017080545425415, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6418604850769043
after epoch: 10,now: 2024-07-20 13:07:08.024033,epoch time: 0:01:22.247457,used: 0:13:42.151555,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8655599, 'precision': 0.8714154, 'recall': 0.8665097, 'specificity': 0.8665097, 'f1': 0.86521673, 'auroc': 0.92823493, 'binary_precision': 0.921944, 'binary_recall': 0.8030789, 'binary_specificity': 0.9299405, 'binary_f1_score': 0.85841614}
confusion matrix:
      0     1
0  1407   106
1   307  1252
---- Validation: 
scalar performance:
{'acc': 0.6195652, 'precision': 0.6520976, 'recall': 0.6161918, 'specificity': 0.6161918, 'f1': 0.59420294, 'auroc': 0.75572467, 'binary_precision': 0.71903324, 'binary_recall': 0.37480316, 'binary_specificity': 0.8575804, 'binary_f1_score': 0.49275362}
confusion matrix:
     0    1
0  560   93
1  397  238
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.6946148, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6377586, 'auroc': 0.7843375, 'binary_precision': 0.7815126, 'binary_recall': 0.43255815, 'binary_specificity': 0.87906975, 'binary_f1_score': 0.5568862}
confusion matrix:
     0   1
0  189  26
1  122  93
new oracle model saved
early stop counter: 10
val acc:0.6195651888847351, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6558139324188232
after epoch: 11,now: 2024-07-20 13:08:30.101084,epoch time: 0:01:22.077051,used: 0:15:04.228606,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.88151044, 'precision': 0.8876475, 'recall': 0.8824687, 'specificity': 0.8824687, 'f1': 0.8812041, 'auroc': 0.9339646, 'binary_precision': 0.9403095, 'binary_recall': 0.8184734, 'binary_specificity': 0.946464, 'binary_f1_score': 0.87517154}
confusion matrix:
      0     1
0  1432    81
1   283  1276
---- Validation: 
scalar performance:
{'acc': 0.6281056, 'precision': 0.65726984, 'recall': 0.62496173, 'specificity': 0.62496173, 'f1': 0.60662174, 'auroc': 0.7591854, 'binary_precision': 0.72159094, 'binary_recall': 0.4, 'binary_specificity': 0.84992343, 'binary_f1_score': 0.514691}
confusion matrix:
     0    1
0  555   98
1  381  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6927575, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.645623, 'auroc': 0.79028666, 'binary_precision': 0.77165353, 'binary_recall': 0.45581394, 'binary_specificity': 0.8651163, 'binary_f1_score': 0.5730994}
confusion matrix:
     0   1
0  186  29
1  117  98
new oracle model saved
early stop counter: 11
val acc:0.6281055808067322, best validation acc: 0.635869562625885, corresponding to test acc:                         0.6325581669807434 / 0.6604651212692261
after epoch: 12,now: 2024-07-20 13:09:50.660329,epoch time: 0:01:20.559245,used: 0:16:24.787851,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8860677, 'precision': 0.89031875, 'recall': 0.8867606, 'specificity': 0.8867606, 'f1': 0.88586956, 'auroc': 0.9432056, 'binary_precision': 0.93443805, 'binary_recall': 0.83354753, 'binary_specificity': 0.9399736, 'binary_f1_score': 0.8811141}
confusion matrix:
      0     1
0  1425    91
1   259  1297
---- Validation: 
scalar performance:
{'acc': 0.63975155, 'precision': 0.66382873, 'recall': 0.6369464, 'specificity': 0.6369464, 'f1': 0.62319326, 'auroc': 0.76478755, 'binary_precision': 0.7232376, 'binary_recall': 0.43622047, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.5442043}
confusion matrix:
     0    1
0  547  106
1  358  277
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6604651, 'precision': 0.6893717, 'recall': 0.6604651, 'specificity': 0.6604651, 'f1': 0.646994, 'auroc': 0.79625744, 'binary_precision': 0.7633588, 'binary_recall': 0.4651163, 'binary_specificity': 0.855814, 'binary_f1_score': 0.57803464}
confusion matrix:
     0    1
0  184   31
1  115  100
better model found
persisted
after epoch: 13,now: 2024-07-20 13:11:14.633563,epoch time: 0:01:23.973234,used: 0:17:48.761085,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.8844401, 'precision': 0.89241517, 'recall': 0.88542897, 'specificity': 0.88542897, 'f1': 0.8840195, 'auroc': 0.94261754, 'binary_precision': 0.9518797, 'binary_recall': 0.8131021, 'binary_specificity': 0.9577558, 'binary_f1_score': 0.87703496}
confusion matrix:
      0     1
0  1451    64
1   291  1266
---- Validation: 
scalar performance:
{'acc': 0.6281056, 'precision': 0.6635889, 'recall': 0.62472296, 'specificity': 0.62472296, 'f1': 0.603148, 'auroc': 0.76839304, 'binary_precision': 0.73636365, 'binary_recall': 0.38267717, 'binary_specificity': 0.8667688, 'binary_f1_score': 0.5036269}
confusion matrix:
     0    1
0  566   87
1  392  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65581393, 'precision': 0.69073915, 'recall': 0.65581393, 'specificity': 0.65581393, 'f1': 0.6393026, 'auroc': 0.8024013, 'binary_precision': 0.7723577, 'binary_recall': 0.44186047, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.56213015}
confusion matrix:
     0   1
0  187  28
1  120  95
early stop counter: 1
val acc:0.6281055808067322, best validation acc: 0.6397515535354614, corresponding to test acc:                         0.6604651212692261 / 0.6604651212692261
after epoch: 14,now: 2024-07-20 13:12:35.877099,epoch time: 0:01:21.243536,used: 0:19:10.004621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8925781, 'precision': 0.898818, 'recall': 0.89340776, 'specificity': 0.89340776, 'f1': 0.89228594, 'auroc': 0.9459904, 'binary_precision': 0.9520649, 'binary_recall': 0.8296915, 'binary_specificity': 0.957124, 'binary_f1_score': 0.88667583}
confusion matrix:
      0     1
0  1451    65
1   265  1291
---- Validation: 
scalar performance:
{'acc': 0.64829195, 'precision': 0.6774392, 'recall': 0.64534736, 'specificity': 0.64534736, 'f1': 0.6304512, 'auroc': 0.77349365, 'binary_precision': 0.74594593, 'binary_recall': 0.43464568, 'binary_specificity': 0.856049, 'binary_f1_score': 0.54925376}
confusion matrix:
     0    1
0  559   94
1  359  276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.66511625, 'precision': 0.6983446, 'recall': 0.66511625, 'specificity': 0.66511625, 'f1': 0.6504775, 'auroc': 0.8095187, 'binary_precision': 0.77952754, 'binary_recall': 0.4604651, 'binary_specificity': 0.8697674, 'binary_f1_score': 0.57894737}
confusion matrix:
     0   1
0  187  28
1  116  99
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 13:13:55.630156,epoch time: 0:01:19.753057,used: 0:20:29.757678,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9007161, 'precision': 0.9065332, 'recall': 0.9014312, 'specificity': 0.9014312, 'f1': 0.90046275, 'auroc': 0.9544573, 'binary_precision': 0.9581805, 'binary_recall': 0.84041184, 'binary_specificity': 0.96245056, 'binary_f1_score': 0.8954405}
confusion matrix:
      0     1
0  1461    57
1   248  1306
---- Validation: 
scalar performance:
{'acc': 0.6630435, 'precision': 0.6842421, 'recall': 0.6605684, 'specificity': 0.6605684, 'f1': 0.65092325, 'auroc': 0.7780926, 'binary_precision': 0.7433414, 'binary_recall': 0.48346457, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.5858779}
confusion matrix:
     0    1
0  547  106
1  328  307
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6744186, 'precision': 0.6978576, 'recall': 0.67441857, 'specificity': 0.67441857, 'f1': 0.6644819, 'auroc': 0.8152082, 'binary_precision': 0.7659575, 'binary_recall': 0.5023256, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.60674155}
confusion matrix:
     0    1
0  182   33
1  107  108
new oracle model saved
better model found
persisted
after epoch: 16,now: 2024-07-20 13:15:16.313099,epoch time: 0:01:20.682943,used: 0:21:50.440621,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.88932294, 'precision': 0.89722395, 'recall': 0.8902081, 'specificity': 0.8902081, 'f1': 0.88891566, 'auroc': 0.9477179, 'binary_precision': 0.95642376, 'binary_recall': 0.81864953, 'binary_specificity': 0.96176666, 'binary_f1_score': 0.88218987}
confusion matrix:
      0     1
0  1459    58
1   282  1273
---- Validation: 
scalar performance:
{'acc': 0.67391306, 'precision': 0.6910475, 'recall': 0.6717223, 'specificity': 0.6717223, 'f1': 0.6646557, 'auroc': 0.78253245, 'binary_precision': 0.7448747, 'binary_recall': 0.51496065, 'binary_specificity': 0.82848394, 'binary_f1_score': 0.6089386}
confusion matrix:
     0    1
0  541  112
1  308  327
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68604654, 'precision': 0.7035214, 'recall': 0.6860465, 'specificity': 0.6860465, 'f1': 0.6791594, 'auroc': 0.8197944, 'binary_precision': 0.7631579, 'binary_recall': 0.53953487, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.63215256}
confusion matrix:
     0    1
0  179   36
1   99  116
new oracle model saved
better model found
persisted
after epoch: 17,now: 2024-07-20 13:16:37.296356,epoch time: 0:01:20.983257,used: 0:23:11.423878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.8925781, 'precision': 0.89919233, 'recall': 0.89347506, 'specificity': 0.89347506, 'f1': 0.89227104, 'auroc': 0.95463943, 'binary_precision': 0.95410806, 'binary_recall': 0.8278741, 'binary_specificity': 0.9590759, 'binary_f1_score': 0.8865199}
confusion matrix:
      0     1
0  1453    62
1   268  1289
---- Validation: 
scalar performance:
{'acc': 0.6863354, 'precision': 0.69880486, 'recall': 0.6844944, 'specificity': 0.6844944, 'f1': 0.6799449, 'auroc': 0.7888365, 'binary_precision': 0.7452229, 'binary_recall': 0.5527559, 'binary_specificity': 0.8162328, 'binary_f1_score': 0.63471967}
confusion matrix:
     0    1
0  533  120
1  284  351
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7139535, 'precision': 0.7267101, 'recall': 0.7139535, 'specificity': 0.7139535, 'f1': 0.70987225, 'auroc': 0.82593834, 'binary_precision': 0.7804878, 'binary_recall': 0.59534883, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.6754617}
confusion matrix:
     0    1
0  179   36
1   87  128
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 13:17:58.201634,epoch time: 0:01:20.905278,used: 0:24:32.329156,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9088542, 'precision': 0.9139562, 'recall': 0.90952075, 'specificity': 0.90952075, 'f1': 0.908659, 'auroc': 0.9632921, 'binary_precision': 0.96293604, 'binary_recall': 0.85263836, 'binary_specificity': 0.9664032, 'binary_f1_score': 0.9044369}
confusion matrix:
      0     1
0  1467    51
1   229  1325
---- Validation: 
scalar performance:
{'acc': 0.69409937, 'precision': 0.70581996, 'recall': 0.6923467, 'specificity': 0.6923467, 'f1': 0.6884129, 'auroc': 0.7942289, 'binary_precision': 0.75156575, 'binary_recall': 0.56692916, 'binary_specificity': 0.81776416, 'binary_f1_score': 0.64631957}
confusion matrix:
     0    1
0  534  119
1  275  360
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7232558, 'precision': 0.7344602, 'recall': 0.7232558, 'specificity': 0.7232558, 'f1': 0.71990955, 'auroc': 0.8318659, 'binary_precision': 0.78571427, 'binary_recall': 0.6139535, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.68929505}
confusion matrix:
     0    1
0  179   36
1   83  132
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 13:19:20.402334,epoch time: 0:01:22.200700,used: 0:25:54.529856,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9003906, 'precision': 0.90603125, 'recall': 0.9012562, 'specificity': 0.9012562, 'f1': 0.9001651, 'auroc': 0.9588268, 'binary_precision': 0.9576023, 'binary_recall': 0.84082156, 'binary_specificity': 0.9616909, 'binary_f1_score': 0.8954204}
confusion matrix:
      0     1
0  1456    58
1   248  1310
---- Validation: 
scalar performance:
{'acc': 0.71118015, 'precision': 0.71991706, 'recall': 0.70971286, 'specificity': 0.70971286, 'f1': 0.7073157, 'auroc': 0.7986953, 'binary_precision': 0.76039606, 'binary_recall': 0.6047244, 'binary_specificity': 0.8147014, 'binary_f1_score': 0.67368424}
confusion matrix:
     0    1
0  532  121
1  251  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.74651164, 'precision': 0.7540351, 'recall': 0.74651164, 'specificity': 0.74651164, 'f1': 0.74462086, 'auroc': 0.8358247, 'binary_precision': 0.7977528, 'binary_recall': 0.6604651, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.72264636}
confusion matrix:
     0    1
0  179   36
1   73  142
new oracle model saved
better model found
persisted
after epoch: 20,now: 2024-07-20 13:20:45.317555,epoch time: 0:01:24.915221,used: 0:27:19.445077,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8968099, 'precision': 0.9035039, 'recall': 0.8975779, 'specificity': 0.8975779, 'f1': 0.89649665, 'auroc': 0.95828944, 'binary_precision': 0.95848775, 'binary_recall': 0.83204633, 'binary_specificity': 0.9631094, 'binary_f1_score': 0.8908026}
confusion matrix:
      0     1
0  1462    56
1   261  1293
---- Validation: 
scalar performance:
{'acc': 0.7119565, 'precision': 0.72207963, 'recall': 0.71039176, 'specificity': 0.71039176, 'f1': 0.7076122, 'auroc': 0.80226207, 'binary_precision': 0.766129, 'binary_recall': 0.5984252, 'binary_specificity': 0.82235837, 'binary_f1_score': 0.67197174}
confusion matrix:
     0    1
0  537  116
1  255  380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75581396, 'precision': 0.7627778, 'recall': 0.75581396, 'specificity': 0.75581396, 'f1': 0.7541854, 'auroc': 0.8407788, 'binary_precision': 0.8055556, 'binary_recall': 0.6744186, 'binary_specificity': 0.8372093, 'binary_f1_score': 0.7341772}
confusion matrix:
     0    1
0  180   35
1   70  145
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 13:22:04.362799,epoch time: 0:01:19.045244,used: 0:28:38.490321,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90559894, 'precision': 0.91254586, 'recall': 0.90650713, 'specificity': 0.90650713, 'f1': 0.9053225, 'auroc': 0.9569774, 'binary_precision': 0.9696071, 'binary_recall': 0.84007704, 'binary_specificity': 0.9729373, 'binary_f1_score': 0.90020645}
confusion matrix:
      0     1
0  1474    41
1   249  1308
---- Validation: 
scalar performance:
{'acc': 0.71428573, 'precision': 0.7274245, 'recall': 0.71253693, 'specificity': 0.71253693, 'f1': 0.7089745, 'auroc': 0.8063643, 'binary_precision': 0.77870566, 'binary_recall': 0.58740157, 'binary_specificity': 0.8376723, 'binary_f1_score': 0.6696589}
confusion matrix:
     0    1
0  547  106
1  262  373
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75348836, 'precision': 0.7616623, 'recall': 0.75348836, 'specificity': 0.75348836, 'f1': 0.75154805, 'auroc': 0.84458625, 'binary_precision': 0.8079096, 'binary_recall': 0.66511625, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.72959185}
confusion matrix:
     0    1
0  181   34
1   72  143
better model found
persisted
after epoch: 22,now: 2024-07-20 13:23:24.195243,epoch time: 0:01:19.832444,used: 0:29:58.322765,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.9082031, 'precision': 0.91449493, 'recall': 0.90906733, 'specificity': 0.90906733, 'f1': 0.9079658, 'auroc': 0.96177256, 'binary_precision': 0.96909493, 'binary_recall': 0.84585744, 'binary_specificity': 0.9722772, 'binary_f1_score': 0.9032922}
confusion matrix:
      0     1
0  1473    42
1   240  1317
---- Validation: 
scalar performance:
{'acc': 0.72748446, 'precision': 0.73625934, 'recall': 0.7260747, 'specificity': 0.7260747, 'f1': 0.72408336, 'auroc': 0.81003964, 'binary_precision': 0.77843136, 'binary_recall': 0.6251969, 'binary_specificity': 0.8269525, 'binary_f1_score': 0.6934498}
confusion matrix:
     0    1
0  540  113
1  238  397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.75813955, 'precision': 0.76558566, 'recall': 0.75813955, 'specificity': 0.75813955, 'f1': 0.75643235, 'auroc': 0.84889126, 'binary_precision': 0.81005585, 'binary_recall': 0.6744186, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.73604065}
confusion matrix:
     0    1
0  181   34
1   70  145
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 13:24:44.484749,epoch time: 0:01:20.289506,used: 0:31:18.612271,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90625, 'precision': 0.9148611, 'recall': 0.90725625, 'specificity': 0.90725625, 'f1': 0.90589756, 'auroc': 0.9652666, 'binary_precision': 0.9781462, 'binary_recall': 0.83365446, 'binary_specificity': 0.9808581, 'binary_f1_score': 0.9001387}
confusion matrix:
      0     1
0  1486    29
1   259  1298
---- Validation: 
scalar performance:
{'acc': 0.72981364, 'precision': 0.7388446, 'recall': 0.72839344, 'specificity': 0.72839344, 'f1': 0.7263937, 'auroc': 0.81337976, 'binary_precision': 0.7819253, 'binary_recall': 0.6267716, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.6958042}
confusion matrix:
     0    1
0  542  111
1  237  398
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7651163, 'precision': 0.7723333, 'recall': 0.7651163, 'specificity': 0.7651163, 'f1': 0.7635497, 'auroc': 0.8516604, 'binary_precision': 0.81666666, 'binary_recall': 0.68372095, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.74430376}
confusion matrix:
     0    1
0  182   33
1   68  147
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 13:26:03.600680,epoch time: 0:01:19.115931,used: 0:32:37.728202,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91048175, 'precision': 0.9167662, 'recall': 0.91130173, 'specificity': 0.91130173, 'f1': 0.9102473, 'auroc': 0.9675997, 'binary_precision': 0.97130245, 'binary_recall': 0.84832907, 'binary_specificity': 0.9742744, 'binary_f1_score': 0.90566033}
confusion matrix:
      0     1
0  1477    39
1   236  1320
---- Validation: 
scalar performance:
{'acc': 0.73913044, 'precision': 0.74737275, 'recall': 0.7377989, 'specificity': 0.7377989, 'f1': 0.7361891, 'auroc': 0.81693697, 'binary_precision': 0.7891683, 'binary_recall': 0.6425197, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.7083333}
confusion matrix:
     0    1
0  544  109
1  227  408
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.772093, 'precision': 0.77825713, 'recall': 0.772093, 'specificity': 0.772093, 'f1': 0.7708238, 'auroc': 0.85507846, 'binary_precision': 0.8196721, 'binary_recall': 0.6976744, 'binary_specificity': 0.8465116, 'binary_f1_score': 0.7537688}
confusion matrix:
     0    1
0  182   33
1   65  150
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 13:27:25.214622,epoch time: 0:01:21.613942,used: 0:33:59.342144,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.91015625, 'precision': 0.9166409, 'recall': 0.91098887, 'specificity': 0.91098887, 'f1': 0.9099119, 'auroc': 0.96800876, 'binary_precision': 0.9719764, 'binary_recall': 0.8470437, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.90521985}
confusion matrix:
      0     1
0  1478    38
1   238  1318
---- Validation: 
scalar performance:
{'acc': 0.7476708, 'precision': 0.7541423, 'recall': 0.7465037, 'specificity': 0.7465037, 'f1': 0.74542403, 'auroc': 0.82057613, 'binary_precision': 0.7913534, 'binary_recall': 0.6629921, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.72150815}
confusion matrix:
     0    1
0  542  111
1  214  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7813954, 'precision': 0.78437287, 'recall': 0.7813953, 'specificity': 0.7813953, 'f1': 0.7808216, 'auroc': 0.857934, 'binary_precision': 0.8134715, 'binary_recall': 0.73023254, 'binary_specificity': 0.83255816, 'binary_f1_score': 0.76960784}
confusion matrix:
     0    1
0  179   36
1   58  157
new oracle model saved
better model found
persisted
after epoch: 26,now: 2024-07-20 13:28:49.915370,epoch time: 0:01:24.700748,used: 0:35:24.042892,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91471356, 'precision': 0.9208961, 'recall': 0.91565, 'specificity': 0.91565, 'f1': 0.9145098, 'auroc': 0.96524155, 'binary_precision': 0.9757887, 'binary_recall': 0.85311097, 'binary_specificity': 0.97818905, 'binary_f1_score': 0.9103354}
confusion matrix:
      0     1
0  1480    33
1   229  1330
---- Validation: 
scalar performance:
{'acc': 0.7523292, 'precision': 0.7586828, 'recall': 0.7511847, 'specificity': 0.7511847, 'f1': 0.7501968, 'auroc': 0.8241768, 'binary_precision': 0.79588014, 'binary_recall': 0.6692913, 'binary_specificity': 0.8330781, 'binary_f1_score': 0.7271172}
confusion matrix:
     0    1
0  544  109
1  210  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7860465, 'precision': 0.78965586, 'recall': 0.7860465, 'specificity': 0.7860465, 'f1': 0.785378, 'auroc': 0.86146027, 'binary_precision': 0.82198954, 'binary_recall': 0.73023254, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.77339906}
confusion matrix:
     0    1
0  181   34
1   58  157
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 13:30:09.079907,epoch time: 0:01:19.164537,used: 0:36:43.207429,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.92122394, 'precision': 0.9259858, 'recall': 0.92200994, 'specificity': 0.92200994, 'f1': 0.92108697, 'auroc': 0.97476315, 'binary_precision': 0.9747475, 'binary_recall': 0.8671374, 'binary_specificity': 0.97688246, 'binary_f1_score': 0.91779894}
confusion matrix:
      0     1
0  1479    35
1   207  1351
---- Validation: 
scalar performance:
{'acc': 0.75931674, 'precision': 0.76425946, 'recall': 0.7583147, 'specificity': 0.7583147, 'f1': 0.7576755, 'auroc': 0.8287926, 'binary_precision': 0.797075, 'binary_recall': 0.68661416, 'binary_specificity': 0.8300153, 'binary_f1_score': 0.73773265}
confusion matrix:
     0    1
0  542  111
1  199  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.865484, 'binary_precision': 0.81313133, 'binary_recall': 0.74883723, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.779661}
confusion matrix:
     0    1
0  178   37
1   54  161
new oracle model saved
better model found
persisted
after epoch: 28,now: 2024-07-20 13:31:29.789679,epoch time: 0:01:20.709772,used: 0:38:03.917201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9108073, 'precision': 0.91552067, 'recall': 0.9115213, 'specificity': 0.9115213, 'f1': 0.9106423, 'auroc': 0.967102, 'binary_precision': 0.96315026, 'binary_recall': 0.8566838, 'binary_specificity': 0.96635884, 'binary_f1_score': 0.9068027}
confusion matrix:
      0     1
0  1465    51
1   223  1333
---- Validation: 
scalar performance:
{'acc': 0.7585404, 'precision': 0.7645576, 'recall': 0.7574405, 'specificity': 0.7574405, 'f1': 0.7566, 'auroc': 0.83172035, 'binary_precision': 0.8011152, 'binary_recall': 0.67874014, 'binary_specificity': 0.8361409, 'binary_f1_score': 0.7348679}
confusion matrix:
     0    1
0  546  107
1  204  431
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.86803675, 'binary_precision': 0.81313133, 'binary_recall': 0.74883723, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.779661}
confusion matrix:
     0    1
0  178   37
1   54  161
early stop counter: 1
val acc:0.7585403919219971, best validation acc: 0.7593167424201965, corresponding to test acc:                         0.7883720993995667 / 0.7883720993995667
after epoch: 29,now: 2024-07-20 13:32:50.018314,epoch time: 0:01:20.228635,used: 0:39:24.145836,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.92578125, 'precision': 0.93017244, 'recall': 0.92646396, 'specificity': 0.92646396, 'f1': 0.92566013, 'auroc': 0.97163856, 'binary_precision': 0.9770115, 'binary_recall': 0.874036, 'binary_specificity': 0.97889185, 'binary_f1_score': 0.92265946}
confusion matrix:
      0     1
0  1484    32
1   196  1360
---- Validation: 
scalar performance:
{'acc': 0.75621116, 'precision': 0.76336145, 'recall': 0.7550132, 'specificity': 0.7550132, 'f1': 0.75393057, 'auroc': 0.8330901, 'binary_precision': 0.80340266, 'binary_recall': 0.6692913, 'binary_specificity': 0.8407351, 'binary_f1_score': 0.7302406}
confusion matrix:
     0    1
0  549  104
1  210  425
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7930232, 'precision': 0.79584575, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7925284, 'auroc': 0.87035155, 'binary_precision': 0.82474226, 'binary_recall': 0.74418604, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7823961}
confusion matrix:
     0    1
0  181   34
1   55  160
new oracle model saved
early stop counter: 2
val acc:0.7562111616134644, best validation acc: 0.7593167424201965, corresponding to test acc:                         0.7883720993995667 / 0.7930232286453247
after epoch: 30,now: 2024-07-20 13:34:09.965297,epoch time: 0:01:19.946983,used: 0:40:44.092819,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_12_53_25_seed_0_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:40:44.092819 at 2024-07-20 13:34:09.965297
persisted model performance metric: 

scalar performance:
{'acc': 0.7883721, 'precision': 0.79018635, 'recall': 0.7883721, 'specificity': 0.7883721, 'f1': 0.78804076, 'auroc': 0.865484, 'binary_precision': 0.81313133, 'binary_recall': 0.74883723, 'binary_specificity': 0.82790697, 'binary_f1_score': 0.779661}
confusion matrix:
     0    1
0  178   37
1   54  161
oracle model performance metric: 

scalar performance:
{'acc': 0.7930232, 'precision': 0.79584575, 'recall': 0.7930232, 'specificity': 0.7930232, 'f1': 0.7925284, 'auroc': 0.87035155, 'binary_precision': 0.82474226, 'binary_recall': 0.74418604, 'binary_specificity': 0.8418605, 'binary_f1_score': 0.7823961}
confusion matrix:
     0    1
0  181   34
1   55  160
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/2.csv
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 197058 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool | 180662 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |  16396 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool | 178979 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |  16209 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8524 MiB |   8524 MiB |   8524 MiB |      0 B   |
|       from large pool |   8486 MiB |   8486 MiB |   8486 MiB |      0 B   |
|       from small pool |     38 MiB |     38 MiB |     38 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  58942 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  50762 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |   8180 KiB |  10132 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1675    |   10387 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1675    |   10387 K  |   10387 K  |
|       from large pool |      79    |     762    |    5637 K  |    5637 K  |
|       from small pool |     709    |    1005    |    4750 K  |    4749 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     368    |     368    |       0    |
|       from large pool |     349    |     349    |     349    |       0    |
|       from small pool |      19    |      19    |      19    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      42    |     380    |    6462 K  |    6462 K  |
|       from large pool |      10    |     350    |    4321 K  |    4321 K  |
|       from small pool |      32    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6462 K  |    6462 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB |  61331 GiB |  61331 GiB |
|       from large pool |  16640 KiB |   7805 MiB |  60516 GiB |  60516 GiB |
|       from small pool |      0 KiB |     32 MiB |    815 GiB |    815 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB |  61327 GiB |  61327 GiB |
|       from large pool |  16640 KiB |   7804 MiB |  60513 GiB |  60513 GiB |
|       from small pool |      0 KiB |     32 MiB |    813 GiB |    813 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 256000 KiB |   8524 MiB |   8524 MiB |   8274 MiB |
|       from large pool | 231424 KiB |   8486 MiB |   8486 MiB |   8260 MiB |
|       from small pool |  24576 KiB |     38 MiB |     38 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  34525 GiB |  34525 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  33707 GiB |  33707 GiB |
|       from small pool |      0 KiB |  22319 KiB |    817 GiB |    817 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1675    |   10387 K  |   10387 K  |
|       from large pool |       2    |     762    |    5637 K  |    5637 K  |
|       from small pool |       0    |    1005    |    4750 K  |    4750 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     368    |     368    |     345    |
|       from large pool |      11    |     349    |     349    |     338    |
|       from small pool |      12    |      19    |      19    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     380    |    6462 K  |    6462 K  |
|       from large pool |       3    |     350    |    4321 K  |    4321 K  |
|       from small pool |       0    |     215    |    2141 K  |    2141 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804

 Experiment start at: 2024-07-20 13:35:30.507192
before training, model accuracy: 0.6177777647972107
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.54264325, 'precision': 0.5473575, 'recall': 0.5399448, 'specificity': 0.5399448, 'f1': 0.52263016, 'auroc': 0.5231585, 'binary_precision': 0.5354478, 'binary_recall': 0.73731536, 'binary_specificity': 0.34257427, 'binary_f1_score': 0.6203729}
confusion matrix:
     0     1
0  519   996
1  409  1148
---- Validation: 
scalar performance:
{'acc': 0.48790008, 'precision': 0.46900758, 'recall': 0.48248848, 'specificity': 0.48248848, 'f1': 0.42184234, 'auroc': 0.62085927, 'binary_precision': 0.44036698, 'binary_recall': 0.15238096, 'binary_specificity': 0.812596, 'binary_f1_score': 0.22641511}
confusion matrix:
     0    1
0  529  122
1  534   96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.5795455, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.53701526, 'auroc': 0.66885924, 'binary_precision': 0.6166667, 'binary_recall': 0.3288889, 'binary_specificity': 0.79555553, 'binary_f1_score': 0.4289855}
confusion matrix:
     0   1
0  179  46
1  151  74
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 13:36:57.360352,epoch time: 0:01:26.853160,used: 0:01:26.853160,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.59765625, 'precision': 0.5992276, 'recall': 0.59667647, 'specificity': 0.59667647, 'f1': 0.5946169, 'auroc': 0.5982984, 'binary_precision': 0.58945596, 'binary_recall': 0.67588425, 'binary_specificity': 0.5174687, 'binary_f1_score': 0.6297184}
confusion matrix:
     0     1
0  785   732
1  504  1051
---- Validation: 
scalar performance:
{'acc': 0.4730679, 'precision': 0.41263846, 'recall': 0.46661547, 'specificity': 0.46661547, 'f1': 0.37195164, 'auroc': 0.62832516, 'binary_precision': 0.33576643, 'binary_recall': 0.073015876, 'binary_specificity': 0.86021507, 'binary_f1_score': 0.11994786}
confusion matrix:
     0   1
0  560  91
1  584  46
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.54444444, 'precision': 0.5845865, 'recall': 0.54444444, 'specificity': 0.54444444, 'f1': 0.4831209, 'auroc': 0.6781827, 'binary_precision': 0.64285713, 'binary_recall': 0.2, 'binary_specificity': 0.8888889, 'binary_f1_score': 0.30508476}
confusion matrix:
     0   1
0  200  25
1  180  45
early stop counter: 1
val acc:0.47306790947914124, best validation acc: 0.4879000782966614, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 2,now: 2024-07-20 13:38:18.396422,epoch time: 0:01:21.036070,used: 0:02:47.889230,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.6608073, 'precision': 0.660857, 'recall': 0.6605035, 'specificity': 0.6605035, 'f1': 0.66047573, 'auroc': 0.7063266, 'binary_precision': 0.6598386, 'binary_recall': 0.68272316, 'binary_specificity': 0.63828385, 'binary_f1_score': 0.6710859}
confusion matrix:
     0     1
0  967   548
1  494  1063
---- Validation: 
scalar performance:
{'acc': 0.47775176, 'precision': 0.42385107, 'recall': 0.47127497, 'specificity': 0.47127497, 'f1': 0.37660152, 'auroc': 0.64475656, 'binary_precision': 0.35555556, 'binary_recall': 0.07619048, 'binary_specificity': 0.8663595, 'binary_f1_score': 0.1254902}
confusion matrix:
     0   1
0  564  87
1  582  48
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.53333336, 'precision': 0.56921375, 'recall': 0.5333333, 'specificity': 0.5333333, 'f1': 0.46384805, 'auroc': 0.69489384, 'binary_precision': 0.61904764, 'binary_recall': 0.17333333, 'binary_specificity': 0.8933333, 'binary_f1_score': 0.27083334}
confusion matrix:
     0   1
0  201  24
1  186  39
early stop counter: 2
val acc:0.477751761674881, best validation acc: 0.4879000782966614, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 3,now: 2024-07-20 13:39:39.626279,epoch time: 0:01:21.229857,used: 0:04:09.119087,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.7008464, 'precision': 0.7012361, 'recall': 0.7010704, 'specificity': 0.7010704, 'f1': 0.70081973, 'auroc': 0.7559171, 'binary_precision': 0.71370965, 'binary_recall': 0.6829582, 'binary_specificity': 0.7191826, 'binary_f1_score': 0.69799536}
confusion matrix:
      0     1
0  1091   426
1   493  1062
---- Validation: 
scalar performance:
{'acc': 0.48555815, 'precision': 0.44374657, 'recall': 0.47905785, 'specificity': 0.47905785, 'f1': 0.38499472, 'auroc': 0.66002727, 'binary_precision': 0.39097744, 'binary_recall': 0.082539685, 'binary_specificity': 0.875576, 'binary_f1_score': 0.13630407}
confusion matrix:
     0   1
0  570  81
1  578  52
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5288889, 'precision': 0.56528723, 'recall': 0.5288889, 'specificity': 0.5288889, 'f1': 0.45259243, 'auroc': 0.71160495, 'binary_precision': 0.61403507, 'binary_recall': 0.15555556, 'binary_specificity': 0.9022222, 'binary_f1_score': 0.24822696}
confusion matrix:
     0   1
0  203  22
1  190  35
early stop counter: 3
val acc:0.4855581521987915, best validation acc: 0.4879000782966614, corresponding to test acc:                         0.5622222423553467 / 0.5622222423553467
after epoch: 4,now: 2024-07-20 13:41:01.742293,epoch time: 0:01:22.116014,used: 0:05:31.235101,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.7548828, 'precision': 0.75489396, 'recall': 0.7549206, 'specificity': 0.7549206, 'f1': 0.7548784, 'auroc': 0.8268122, 'binary_precision': 0.76060015, 'binary_recall': 0.75128865, 'binary_specificity': 0.7585526, 'binary_f1_score': 0.75591576}
confusion matrix:
      0     1
0  1153   367
1   386  1166
---- Validation: 
scalar performance:
{'acc': 0.49492583, 'precision': 0.4703001, 'recall': 0.4885049, 'specificity': 0.4885049, 'f1': 0.39889994, 'auroc': 0.67711943, 'binary_precision': 0.4388489, 'binary_recall': 0.0968254, 'binary_specificity': 0.88018435, 'binary_f1_score': 0.15864758}
confusion matrix:
     0   1
0  573  78
1  569  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5311111, 'precision': 0.57610166, 'recall': 0.5311111, 'specificity': 0.5311111, 'f1': 0.44979167, 'auroc': 0.72541237, 'binary_precision': 0.63461536, 'binary_recall': 0.14666666, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.23826714}
confusion matrix:
     0   1
0  206  19
1  192  33
better model found
persisted
after epoch: 5,now: 2024-07-20 13:42:22.468264,epoch time: 0:01:20.725971,used: 0:06:51.961072,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.7864583, 'precision': 0.78646207, 'recall': 0.786497, 'specificity': 0.786497, 'f1': 0.78645253, 'auroc': 0.86159176, 'binary_precision': 0.7921824, 'binary_recall': 0.78300065, 'binary_specificity': 0.7899934, 'binary_f1_score': 0.78756475}
confusion matrix:
      0     1
0  1200   319
1   337  1216
---- Validation: 
scalar performance:
{'acc': 0.50741607, 'precision': 0.50264543, 'recall': 0.50104964, 'specificity': 0.50104964, 'f1': 0.41549444, 'auroc': 0.6941482, 'binary_precision': 0.4965035, 'binary_recall': 0.11269841, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.18369988}
confusion matrix:
     0   1
0  579  72
1  559  71
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5377778, 'precision': 0.58537567, 'recall': 0.5377778, 'specificity': 0.5377778, 'f1': 0.46292087, 'auroc': 0.736, 'binary_precision': 0.64912283, 'binary_recall': 0.16444445, 'binary_specificity': 0.9111111, 'binary_f1_score': 0.26241136}
confusion matrix:
     0   1
0  205  20
1  188  37
better model found
persisted
after epoch: 6,now: 2024-07-20 13:43:43.603410,epoch time: 0:01:21.135146,used: 0:08:13.096218,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.8046875, 'precision': 0.80520165, 'recall': 0.8049201, 'specificity': 0.8049201, 'f1': 0.8046663, 'auroc': 0.87864244, 'binary_precision': 0.820996, 'binary_recall': 0.7850708, 'binary_specificity': 0.82476944, 'binary_f1_score': 0.8026316}
confusion matrix:
      0     1
0  1252   266
1   334  1220
---- Validation: 
scalar performance:
{'acc': 0.51288056, 'precision': 0.5160928, 'recall': 0.50657964, 'specificity': 0.50657964, 'f1': 0.42408383, 'auroc': 0.70860946, 'binary_precision': 0.5202703, 'binary_recall': 0.12222222, 'binary_specificity': 0.89093703, 'binary_f1_score': 0.19794343}
confusion matrix:
     0   1
0  580  71
1  553  77
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5422222, 'precision': 0.59838897, 'recall': 0.54222226, 'specificity': 0.54222226, 'f1': 0.46601385, 'auroc': 0.7481679, 'binary_precision': 0.6727273, 'binary_recall': 0.16444445, 'binary_specificity': 0.92, 'binary_f1_score': 0.2642857}
confusion matrix:
     0   1
0  207  18
1  188  37
better model found
persisted
after epoch: 7,now: 2024-07-20 13:45:06.516070,epoch time: 0:01:22.912660,used: 0:09:36.008878,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.82714844, 'precision': 0.8279755, 'recall': 0.82745624, 'specificity': 0.82745624, 'f1': 0.82711136, 'auroc': 0.8974203, 'binary_precision': 0.84782606, 'binary_recall': 0.80257237, 'binary_specificity': 0.85234016, 'binary_f1_score': 0.82457876}
confusion matrix:
      0     1
0  1293   224
1   307  1248
---- Validation: 
scalar performance:
{'acc': 0.51444185, 'precision': 0.5208357, 'recall': 0.5080133, 'specificity': 0.5080133, 'f1': 0.42169642, 'auroc': 0.721776, 'binary_precision': 0.5289855, 'binary_recall': 0.11587302, 'binary_specificity': 0.90015364, 'binary_f1_score': 0.19010416}
confusion matrix:
     0   1
0  586  65
1  557  73
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.55333334, 'precision': 0.63046, 'recall': 0.55333334, 'specificity': 0.55333334, 'f1': 0.4758679, 'auroc': 0.7610074, 'binary_precision': 0.7307692, 'binary_recall': 0.16888888, 'binary_specificity': 0.93777776, 'binary_f1_score': 0.27436823}
confusion matrix:
     0   1
0  211  14
1  187  38
better model found
persisted
after epoch: 8,now: 2024-07-20 13:46:26.829756,epoch time: 0:01:20.313686,used: 0:10:56.322564,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8434245, 'precision': 0.845627, 'recall': 0.8439448, 'specificity': 0.8439448, 'f1': 0.84329295, 'auroc': 0.9105438, 'binary_precision': 0.87666434, 'binary_recall': 0.8039846, 'binary_specificity': 0.883905, 'binary_f1_score': 0.838753}
confusion matrix:
      0     1
0  1340   176
1   305  1251
---- Validation: 
scalar performance:
{'acc': 0.520687, 'precision': 0.53418165, 'recall': 0.5144649, 'specificity': 0.5144649, 'f1': 0.43575245, 'auroc': 0.73281646, 'binary_precision': 0.5519481, 'binary_recall': 0.13492064, 'binary_specificity': 0.89400923, 'binary_f1_score': 0.21683674}
confusion matrix:
     0   1
0  582  69
1  545  85
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.6346154, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.49422336, 'auroc': 0.7733531, 'binary_precision': 0.73333335, 'binary_recall': 0.19555555, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3087719}
confusion matrix:
     0   1
0  209  16
1  181  44
better model found
persisted
after epoch: 9,now: 2024-07-20 13:47:47.984411,epoch time: 0:01:21.154655,used: 0:12:17.477219,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.8564453, 'precision': 0.8577492, 'recall': 0.8568033, 'specificity': 0.8568033, 'f1': 0.856385, 'auroc': 0.9210639, 'binary_precision': 0.88247424, 'binary_recall': 0.82625484, 'binary_specificity': 0.88735175, 'binary_f1_score': 0.85343975}
confusion matrix:
      0     1
0  1347   171
1   270  1284
---- Validation: 
scalar performance:
{'acc': 0.5331772, 'precision': 0.5584593, 'recall': 0.52718896, 'specificity': 0.52718896, 'f1': 0.45729566, 'auroc': 0.74294734, 'binary_precision': 0.59302324, 'binary_recall': 0.16190477, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.2543641}
confusion matrix:
     0    1
0  581   70
1  528  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.64572537, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.5081521, 'auroc': 0.7840395, 'binary_precision': 0.75, 'binary_recall': 0.21333334, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3321799}
confusion matrix:
     0   1
0  209  16
1  177  48
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-20 13:49:13.391396,epoch time: 0:01:25.406985,used: 0:13:42.884204,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8561198, 'precision': 0.86140096, 'recall': 0.856871, 'specificity': 0.856871, 'f1': 0.85575736, 'auroc': 0.9205018, 'binary_precision': 0.90829057, 'binary_recall': 0.7961415, 'binary_specificity': 0.9176005, 'binary_f1_score': 0.8485265}
confusion matrix:
      0     1
0  1392   125
1   317  1238
---- Validation: 
scalar performance:
{'acc': 0.5331772, 'precision': 0.5618198, 'recall': 0.52703536, 'specificity': 0.52703536, 'f1': 0.4527831, 'auroc': 0.75249314, 'binary_precision': 0.6, 'binary_recall': 0.15238096, 'binary_specificity': 0.9016897, 'binary_f1_score': 0.24303798}
confusion matrix:
     0   1
0  587  64
1  534  96
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.56222224, 'precision': 0.64730644, 'recall': 0.56222224, 'specificity': 0.56222224, 'f1': 0.4883383, 'auroc': 0.7915654, 'binary_precision': 0.7592593, 'binary_recall': 0.18222222, 'binary_specificity': 0.94222224, 'binary_f1_score': 0.29390684}
confusion matrix:
     0   1
0  212  13
1  184  41
early stop counter: 1
val acc:0.5331771969795227, best validation acc: 0.5331771969795227, corresponding to test acc:                         0.5711110830307007 / 0.5711110830307007
after epoch: 11,now: 2024-07-20 13:50:33.685992,epoch time: 0:01:20.294596,used: 0:15:03.178800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8701172, 'precision': 0.872661, 'recall': 0.8707201, 'specificity': 0.8707201, 'f1': 0.8700031, 'auroc': 0.9312527, 'binary_precision': 0.90723825, 'binary_recall': 0.82862645, 'binary_specificity': 0.9128137, 'binary_f1_score': 0.86615235}
confusion matrix:
      0     1
0  1382   132
1   267  1291
---- Validation: 
scalar performance:
{'acc': 0.540203, 'precision': 0.57072073, 'recall': 0.5343318, 'specificity': 0.5343318, 'f1': 0.46867844, 'auroc': 0.7569941, 'binary_precision': 0.6132597, 'binary_recall': 0.17619048, 'binary_specificity': 0.8924731, 'binary_f1_score': 0.27373612}
confusion matrix:
     0    1
0  581   70
1  519  111
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5711111, 'precision': 0.64572537, 'recall': 0.57111114, 'specificity': 0.57111114, 'f1': 0.5081521, 'auroc': 0.798321, 'binary_precision': 0.75, 'binary_recall': 0.21333334, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.3321799}
confusion matrix:
     0   1
0  209  16
1  177  48
better model found
persisted
after epoch: 12,now: 2024-07-20 13:51:55.218948,epoch time: 0:01:21.532956,used: 0:16:24.711756,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.8717448, 'precision': 0.87443805, 'recall': 0.8723351, 'specificity': 0.8723351, 'f1': 0.87161946, 'auroc': 0.9309491, 'binary_precision': 0.90979564, 'binary_recall': 0.82915866, 'binary_specificity': 0.91551155, 'binary_f1_score': 0.8676076}
confusion matrix:
      0     1
0  1387   128
1   266  1291
---- Validation: 
scalar performance:
{'acc': 0.55191255, 'precision': 0.58780754, 'recall': 0.5462878, 'specificity': 0.5462878, 'f1': 0.48851246, 'auroc': 0.76285565, 'binary_precision': 0.64, 'binary_recall': 0.2031746, 'binary_specificity': 0.8894009, 'binary_f1_score': 0.30843374}
confusion matrix:
     0    1
0  579   72
1  502  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.64379704, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.51842, 'auroc': 0.80677533, 'binary_precision': 0.74285716, 'binary_recall': 0.23111111, 'binary_specificity': 0.92, 'binary_f1_score': 0.35254237}
confusion matrix:
     0   1
0  207  18
1  173  52
new oracle model saved
better model found
persisted
after epoch: 13,now: 2024-07-20 13:53:18.892165,epoch time: 0:01:23.673217,used: 0:17:48.384973,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.87630206, 'precision': 0.88050306, 'recall': 0.87692606, 'specificity': 0.87692606, 'f1': 0.8760733, 'auroc': 0.9347131, 'binary_precision': 0.9235209, 'binary_recall': 0.8236808, 'binary_specificity': 0.93017125, 'binary_f1_score': 0.87074834}
confusion matrix:
      0     1
0  1412   106
1   274  1280
---- Validation: 
scalar performance:
{'acc': 0.5550351, 'precision': 0.5951942, 'recall': 0.54936, 'specificity': 0.54936, 'f1': 0.49079317, 'auroc': 0.7686831, 'binary_precision': 0.6530612, 'binary_recall': 0.2031746, 'binary_specificity': 0.8955453, 'binary_f1_score': 0.30992737}
confusion matrix:
     0    1
0  583   68
1  502  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.57555556, 'precision': 0.6472513, 'recall': 0.57555556, 'specificity': 0.57555556, 'f1': 0.5167303, 'auroc': 0.81200993, 'binary_precision': 0.75, 'binary_recall': 0.22666667, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.34812286}
confusion matrix:
     0   1
0  208  17
1  174  51
better model found
persisted
after epoch: 14,now: 2024-07-20 13:54:40.390869,epoch time: 0:01:21.498704,used: 0:19:09.883677,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.87565106, 'precision': 0.87935656, 'recall': 0.8763716, 'specificity': 0.8763716, 'f1': 0.8754735, 'auroc': 0.9400974, 'binary_precision': 0.92060083, 'binary_recall': 0.82605904, 'binary_specificity': 0.92668426, 'binary_f1_score': 0.8707713}
confusion matrix:
      0     1
0  1403   111
1   271  1287
---- Validation: 
scalar performance:
{'acc': 0.5620609, 'precision': 0.6066542, 'recall': 0.5564516, 'specificity': 0.5564516, 'f1': 0.50040984, 'auroc': 0.7732353, 'binary_precision': 0.67164177, 'binary_recall': 0.21428572, 'binary_specificity': 0.8986175, 'binary_f1_score': 0.32490975}
confusion matrix:
     0    1
0  585   66
1  495  135
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.66071427, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.5285054, 'auroc': 0.81430125, 'binary_precision': 0.7714286, 'binary_recall': 0.24, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.36610168}
confusion matrix:
     0   1
0  209  16
1  171  54
new oracle model saved
better model found
persisted
after epoch: 15,now: 2024-07-20 13:56:02.144521,epoch time: 0:01:21.753652,used: 0:20:31.637329,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8932292, 'precision': 0.8971435, 'recall': 0.89385724, 'specificity': 0.89385724, 'f1': 0.89306056, 'auroc': 0.9450078, 'binary_precision': 0.93978494, 'binary_recall': 0.84308684, 'binary_specificity': 0.9446276, 'binary_f1_score': 0.8888136}
confusion matrix:
      0     1
0  1433    84
1   244  1311
---- Validation: 
scalar performance:
{'acc': 0.55971897, 'precision': 0.60677797, 'recall': 0.55396825, 'specificity': 0.55396825, 'f1': 0.49421468, 'auroc': 0.7766293, 'binary_precision': 0.67368424, 'binary_recall': 0.2031746, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.31219512}
confusion matrix:
     0    1
0  589   62
1  502  128
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.58444446, 'precision': 0.664575, 'recall': 0.58444446, 'specificity': 0.58444446, 'f1': 0.5268511, 'auroc': 0.8178766, 'binary_precision': 0.7794118, 'binary_recall': 0.23555556, 'binary_specificity': 0.93333334, 'binary_f1_score': 0.36177474}
confusion matrix:
     0   1
0  210  15
1  172  53
early stop counter: 1
val acc:0.5597189664840698, best validation acc: 0.5620608925819397, corresponding to test acc:                         0.5844444632530212 / 0.5844444632530212
after epoch: 16,now: 2024-07-20 13:57:25.120698,epoch time: 0:01:22.976177,used: 0:21:54.613506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.89192706, 'precision': 0.8982122, 'recall': 0.8926753, 'specificity': 0.8926753, 'f1': 0.89161825, 'auroc': 0.94490314, 'binary_precision': 0.95125556, 'binary_recall': 0.8288288, 'binary_specificity': 0.95652175, 'binary_f1_score': 0.8858322}
confusion matrix:
      0     1
0  1452    66
1   266  1288
---- Validation: 
scalar performance:
{'acc': 0.5636222, 'precision': 0.6122043, 'recall': 0.5579365, 'specificity': 0.5579365, 'f1': 0.5003025, 'auroc': 0.7785946, 'binary_precision': 0.6820513, 'binary_recall': 0.21111111, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.32242423}
confusion matrix:
     0    1
0  589   62
1  497  133
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5822222, 'precision': 0.654688, 'recall': 0.5822222, 'specificity': 0.5822222, 'f1': 0.5268033, 'auroc': 0.82194567, 'binary_precision': 0.7605634, 'binary_recall': 0.24, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.36486486}
confusion matrix:
     0   1
0  208  17
1  171  54
better model found
persisted
after epoch: 17,now: 2024-07-20 13:58:45.868105,epoch time: 0:01:20.747407,used: 0:23:15.360913,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9016927, 'precision': 0.9060661, 'recall': 0.90242213, 'specificity': 0.90242213, 'f1': 0.90152705, 'auroc': 0.94827664, 'binary_precision': 0.95176387, 'binary_recall': 0.8490687, 'binary_specificity': 0.95577556, 'binary_f1_score': 0.8974882}
confusion matrix:
      0     1
0  1448    67
1   235  1322
---- Validation: 
scalar performance:
{'acc': 0.57377046, 'precision': 0.6254257, 'recall': 0.568254, 'specificity': 0.568254, 'f1': 0.5158717, 'auroc': 0.78242505, 'binary_precision': 0.7019231, 'binary_recall': 0.23174603, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.3484487}
confusion matrix:
     0    1
0  589   62
1  484  146
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5933333, 'precision': 0.6628412, 'recall': 0.59333336, 'specificity': 0.59333336, 'f1': 0.54475343, 'auroc': 0.8256, 'binary_precision': 0.7692308, 'binary_recall': 0.26666668, 'binary_specificity': 0.92, 'binary_f1_score': 0.3960396}
confusion matrix:
     0   1
0  207  18
1  165  60
new oracle model saved
better model found
persisted
after epoch: 18,now: 2024-07-20 14:00:06.288007,epoch time: 0:01:20.419902,used: 0:24:35.780815,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.90494794, 'precision': 0.90862584, 'recall': 0.90558463, 'specificity': 0.90558463, 'f1': 0.90481687, 'auroc': 0.956213, 'binary_precision': 0.95078456, 'binary_recall': 0.8566838, 'binary_specificity': 0.9544855, 'binary_f1_score': 0.90128464}
confusion matrix:
      0     1
0  1447    69
1   223  1333
---- Validation: 
scalar performance:
{'acc': 0.58313817, 'precision': 0.63665926, 'recall': 0.5777778, 'specificity': 0.5777778, 'f1': 0.52992445, 'auroc': 0.78606784, 'binary_precision': 0.7181818, 'binary_recall': 0.25079367, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.37176475}
confusion matrix:
     0    1
0  589   62
1  472  158
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6066667, 'precision': 0.67564404, 'recall': 0.6066667, 'specificity': 0.6066667, 'f1': 0.56384605, 'auroc': 0.82953084, 'binary_precision': 0.78571427, 'binary_recall': 0.29333332, 'binary_specificity': 0.92, 'binary_f1_score': 0.42718446}
confusion matrix:
     0   1
0  207  18
1  159  66
new oracle model saved
better model found
persisted
after epoch: 19,now: 2024-07-20 14:01:28.254415,epoch time: 0:01:21.966408,used: 0:25:57.747223,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.9046224, 'precision': 0.9086034, 'recall': 0.9052159, 'specificity': 0.9052159, 'f1': 0.90446925, 'auroc': 0.95712835, 'binary_precision': 0.95197135, 'binary_recall': 0.85456884, 'binary_specificity': 0.955863, 'binary_f1_score': 0.9006443}
confusion matrix:
      0     1
0  1451    67
1   226  1328
---- Validation: 
scalar performance:
{'acc': 0.5909446, 'precision': 0.6444911, 'recall': 0.58573985, 'specificity': 0.58573985, 'f1': 0.541938, 'auroc': 0.78898644, 'binary_precision': 0.7284483, 'binary_recall': 0.26825398, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.3921114}
confusion matrix:
     0    1
0  588   63
1  461  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6066667, 'precision': 0.6725019, 'recall': 0.6066667, 'specificity': 0.6066667, 'f1': 0.5651794, 'auroc': 0.83403456, 'binary_precision': 0.7790698, 'binary_recall': 0.29777777, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.43086818}
confusion matrix:
     0   1
0  206  19
1  158  67
better model found
persisted
after epoch: 20,now: 2024-07-20 14:02:51.283150,epoch time: 0:01:23.028735,used: 0:27:20.775958,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.8902995, 'precision': 0.8949785, 'recall': 0.89102274, 'specificity': 0.89102274, 'f1': 0.89008725, 'auroc': 0.9497762, 'binary_precision': 0.9413468, 'binary_recall': 0.83547556, 'binary_specificity': 0.9465699, 'binary_f1_score': 0.88525707}
confusion matrix:
      0     1
0  1435    81
1   256  1300
---- Validation: 
scalar performance:
{'acc': 0.5964091, 'precision': 0.6503506, 'recall': 0.5912954, 'specificity': 0.5912954, 'f1': 0.5498441, 'auroc': 0.79231465, 'binary_precision': 0.7364017, 'binary_recall': 0.2793651, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.40506333}
confusion matrix:
     0    1
0  588   63
1  454  176
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.62, 'precision': 0.6875, 'recall': 0.62, 'specificity': 0.62, 'f1': 0.5824176, 'auroc': 0.8363457, 'binary_precision': 0.8, 'binary_recall': 0.32, 'binary_specificity': 0.92, 'binary_f1_score': 0.4571429}
confusion matrix:
     0   1
0  207  18
1  153  72
new oracle model saved
better model found
persisted
after epoch: 21,now: 2024-07-20 14:04:13.883755,epoch time: 0:01:22.600605,used: 0:28:43.376563,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.9046224, 'precision': 0.911265, 'recall': 0.9054253, 'specificity': 0.9054253, 'f1': 0.90434647, 'auroc': 0.9626124, 'binary_precision': 0.966716, 'binary_recall': 0.8405145, 'binary_specificity': 0.9703362, 'binary_f1_score': 0.89920884}
confusion matrix:
      0     1
0  1472    45
1   248  1307
---- Validation: 
scalar performance:
{'acc': 0.5870414, 'precision': 0.6440162, 'recall': 0.5816692, 'specificity': 0.5816692, 'f1': 0.5340495, 'auroc': 0.79571354, 'binary_precision': 0.7305936, 'binary_recall': 0.25396827, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.376914}
confusion matrix:
     0    1
0  592   59
1  470  160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.60444444, 'precision': 0.6804054, 'recall': 0.60444444, 'specificity': 0.60444444, 'f1': 0.557908, 'auroc': 0.8380247, 'binary_precision': 0.79746836, 'binary_recall': 0.28, 'binary_specificity': 0.9288889, 'binary_f1_score': 0.41447368}
confusion matrix:
     0   1
0  209  16
1  162  63
early stop counter: 1
val acc:0.5870413780212402, best validation acc: 0.5964090824127197, corresponding to test acc:                         0.6200000047683716 / 0.6200000047683716
after epoch: 22,now: 2024-07-20 14:05:38.212024,epoch time: 0:01:24.328269,used: 0:30:07.704832,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.8984375, 'precision': 0.9043641, 'recall': 0.8992427, 'specificity': 0.8992427, 'f1': 0.8981816, 'auroc': 0.9572847, 'binary_precision': 0.9566814, 'binary_recall': 0.8374036, 'binary_specificity': 0.9610818, 'binary_f1_score': 0.89307743}
confusion matrix:
      0     1
0  1457    59
1   253  1303
---- Validation: 
scalar performance:
{'acc': 0.60265416, 'precision': 0.6596533, 'recall': 0.59756786, 'specificity': 0.59756786, 'f1': 0.5573045, 'auroc': 0.79936606, 'binary_precision': 0.75103736, 'binary_recall': 0.2873016, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.41561428}
confusion matrix:
     0    1
0  591   60
1  449  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6311111, 'precision': 0.6999187, 'recall': 0.6311111, 'specificity': 0.6311111, 'f1': 0.596382, 'auroc': 0.8419161, 'binary_precision': 0.8172043, 'binary_recall': 0.33777776, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.47798738}
confusion matrix:
     0   1
0  208  17
1  149  76
new oracle model saved
better model found
persisted
after epoch: 23,now: 2024-07-20 14:07:00.363145,epoch time: 0:01:22.151121,used: 0:31:29.855953,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.9117839, 'precision': 0.9177718, 'recall': 0.9124613, 'specificity': 0.9124613, 'f1': 0.9115529, 'auroc': 0.9617008, 'binary_precision': 0.9706314, 'binary_recall': 0.85125566, 'binary_specificity': 0.9736669, 'binary_f1_score': 0.90703267}
confusion matrix:
      0     1
0  1479    40
1   231  1322
---- Validation: 
scalar performance:
{'acc': 0.607338, 'precision': 0.66630393, 'recall': 0.6022786, 'specificity': 0.6022786, 'f1': 0.5630083, 'auroc': 0.8017385, 'binary_precision': 0.7613169, 'binary_recall': 0.2936508, 'binary_specificity': 0.9109063, 'binary_f1_score': 0.42382592}
confusion matrix:
     0    1
0  593   58
1  445  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64, 'precision': 0.7069887, 'recall': 0.64, 'specificity': 0.64, 'f1': 0.6083088, 'auroc': 0.8447013, 'binary_precision': 0.82474226, 'binary_recall': 0.35555556, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.49689442}
confusion matrix:
     0   1
0  208  17
1  145  80
new oracle model saved
better model found
persisted
after epoch: 24,now: 2024-07-20 14:08:21.174535,epoch time: 0:01:20.811390,used: 0:32:50.667343,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.90266925, 'precision': 0.9083831, 'recall': 0.903377, 'specificity': 0.903377, 'f1': 0.9024272, 'auroc': 0.9548087, 'binary_precision': 0.95970696, 'binary_recall': 0.84298587, 'binary_specificity': 0.9637681, 'binary_f1_score': 0.89756763}
confusion matrix:
      0     1
0  1463    55
1   244  1310
---- Validation: 
scalar performance:
{'acc': 0.6159251, 'precision': 0.6706882, 'recall': 0.6111111, 'specificity': 0.6111111, 'f1': 0.5769099, 'auroc': 0.80453265, 'binary_precision': 0.7633588, 'binary_recall': 0.31746033, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.44843048}
confusion matrix:
     0    1
0  589   62
1  430  200
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511111, 'precision': 0.7155172, 'recall': 0.6511111, 'specificity': 0.6511111, 'f1': 0.6229406, 'auroc': 0.8481976, 'binary_precision': 0.8333333, 'binary_recall': 0.37777779, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5198777}
confusion matrix:
     0   1
0  208  17
1  140  85
new oracle model saved
better model found
persisted
after epoch: 25,now: 2024-07-20 14:09:43.666009,epoch time: 0:01:22.491474,used: 0:34:13.158817,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.90983075, 'precision': 0.9161064, 'recall': 0.91065055, 'specificity': 0.91065055, 'f1': 0.90959454, 'auroc': 0.96369874, 'binary_precision': 0.9705666, 'binary_recall': 0.84768635, 'binary_specificity': 0.97361475, 'binary_f1_score': 0.9049742}
confusion matrix:
      0     1
0  1476    40
1   237  1319
---- Validation: 
scalar performance:
{'acc': 0.61904764, 'precision': 0.67842793, 'recall': 0.6141577, 'specificity': 0.6141577, 'f1': 0.57902026, 'auroc': 0.8090776, 'binary_precision': 0.77734375, 'binary_recall': 0.31587303, 'binary_specificity': 0.9124424, 'binary_f1_score': 0.44920996}
confusion matrix:
     0    1
0  594   57
1  431  199
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6511111, 'precision': 0.7125945, 'recall': 0.6511111, 'specificity': 0.6511111, 'f1': 0.62392, 'auroc': 0.8522272, 'binary_precision': 0.8269231, 'binary_recall': 0.38222224, 'binary_specificity': 0.92, 'binary_f1_score': 0.52279633}
confusion matrix:
     0   1
0  207  18
1  139  86
better model found
persisted
after epoch: 26,now: 2024-07-20 14:11:06.104999,epoch time: 0:01:22.438990,used: 0:35:35.597807,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.9173177, 'precision': 0.9213278, 'recall': 0.91794133, 'specificity': 0.91794133, 'f1': 0.9171914, 'auroc': 0.96155894, 'binary_precision': 0.96564066, 'binary_recall': 0.8675241, 'binary_specificity': 0.9683586, 'binary_f1_score': 0.91395664}
confusion matrix:
      0     1
0  1469    48
1   206  1349
---- Validation: 
scalar performance:
{'acc': 0.64246684, 'precision': 0.694255, 'recall': 0.63809526, 'specificity': 0.63809526, 'f1': 0.6127242, 'auroc': 0.81411994, 'binary_precision': 0.7905405, 'binary_recall': 0.37142858, 'binary_specificity': 0.9047619, 'binary_f1_score': 0.5053996}
confusion matrix:
     0    1
0  589   62
1  396  234
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6888889, 'precision': 0.737749, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.672039, 'auroc': 0.8564148, 'binary_precision': 0.8455285, 'binary_recall': 0.46222222, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.59770113}
confusion matrix:
     0    1
0  206   19
1  121  104
new oracle model saved
better model found
persisted
after epoch: 27,now: 2024-07-20 14:12:30.166992,epoch time: 0:01:24.061993,used: 0:36:59.659800,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9166667, 'precision': 0.92233145, 'recall': 0.917403, 'specificity': 0.917403, 'f1': 0.9164728, 'auroc': 0.96910596, 'binary_precision': 0.9744339, 'binary_recall': 0.8578778, 'binary_specificity': 0.9769282, 'binary_f1_score': 0.9124487}
confusion matrix:
      0     1
0  1482    35
1   221  1334
---- Validation: 
scalar performance:
{'acc': 0.6346604, 'precision': 0.6903472, 'recall': 0.6300819, 'specificity': 0.6300819, 'f1': 0.60121065, 'auroc': 0.81502694, 'binary_precision': 0.7892857, 'binary_recall': 0.35079366, 'binary_specificity': 0.9093702, 'binary_f1_score': 0.4857143}
confusion matrix:
     0    1
0  592   59
1  409  221
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6622222, 'precision': 0.72095025, 'recall': 0.66222227, 'specificity': 0.66222227, 'f1': 0.6381795, 'auroc': 0.8586074, 'binary_precision': 0.8348624, 'binary_recall': 0.40444446, 'binary_specificity': 0.92, 'binary_f1_score': 0.5449102}
confusion matrix:
     0   1
0  207  18
1  134  91
early stop counter: 1
val acc:0.6346604228019714, best validation acc: 0.6424668431282043, corresponding to test acc:                         0.6888889074325562 / 0.6888889074325562
after epoch: 28,now: 2024-07-20 14:13:55.241040,epoch time: 0:01:25.074048,used: 0:38:24.733848,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9111328, 'precision': 0.91641724, 'recall': 0.9118481, 'specificity': 0.9118481, 'f1': 0.9109398, 'auroc': 0.96230036, 'binary_precision': 0.9665211, 'binary_recall': 0.8540193, 'binary_specificity': 0.969677, 'binary_f1_score': 0.9067941}
confusion matrix:
      0     1
0  1471    46
1   227  1328
---- Validation: 
scalar performance:
{'acc': 0.63700235, 'precision': 0.68872225, 'recall': 0.63256526, 'specificity': 0.63256526, 'f1': 0.60587513, 'auroc': 0.8165996, 'binary_precision': 0.78350514, 'binary_recall': 0.36190477, 'binary_specificity': 0.9032258, 'binary_f1_score': 0.495114}
confusion matrix:
     0    1
0  588   63
1  402  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6755555, 'precision': 0.73338413, 'recall': 0.6755556, 'specificity': 0.6755556, 'f1': 0.65413046, 'auroc': 0.8598124, 'binary_precision': 0.8495575, 'binary_recall': 0.42666668, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.56804734}
confusion matrix:
     0   1
0  208  17
1  129  96
early stop counter: 2
val acc:0.6370023488998413, best validation acc: 0.6424668431282043, corresponding to test acc:                         0.6888889074325562 / 0.6888889074325562
after epoch: 29,now: 2024-07-20 14:15:18.716706,epoch time: 0:01:23.475666,used: 0:39:48.209514,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9059245, 'precision': 0.912043, 'recall': 0.90669537, 'specificity': 0.90669537, 'f1': 0.9056781, 'auroc': 0.96030533, 'binary_precision': 0.96544117, 'binary_recall': 0.844373, 'binary_specificity': 0.9690178, 'binary_f1_score': 0.9008576}
confusion matrix:
      0     1
0  1470    47
1   242  1313
---- Validation: 
scalar performance:
{'acc': 0.6393443, 'precision': 0.6934164, 'recall': 0.63486946, 'specificity': 0.63486946, 'f1': 0.6078551, 'auroc': 0.819445, 'binary_precision': 0.7916667, 'binary_recall': 0.36190477, 'binary_specificity': 0.9078341, 'binary_f1_score': 0.49673206}
confusion matrix:
     0    1
0  591   60
1  402  228
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.68, 'precision': 0.7365347, 'recall': 0.68, 'specificity': 0.68, 'f1': 0.65966386, 'auroc': 0.8617877, 'binary_precision': 0.8521739, 'binary_recall': 0.43555555, 'binary_specificity': 0.92444444, 'binary_f1_score': 0.5764706}
confusion matrix:
     0   1
0  208  17
1  127  98
early stop counter: 3
val acc:0.6393442749977112, best validation acc: 0.6424668431282043, corresponding to test acc:                         0.6888889074325562 / 0.6888889074325562
after epoch: 30,now: 2024-07-20 14:16:39.700348,epoch time: 0:01:20.983642,used: 0:41:09.193156,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_13_35_30_seed_1_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:41:09.193156 at 2024-07-20 14:16:39.700348
persisted model performance metric: 

scalar performance:
{'acc': 0.6888889, 'precision': 0.737749, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.672039, 'auroc': 0.8564148, 'binary_precision': 0.8455285, 'binary_recall': 0.46222222, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.59770113}
confusion matrix:
     0    1
0  206   19
1  121  104
oracle model performance metric: 

scalar performance:
{'acc': 0.6888889, 'precision': 0.737749, 'recall': 0.6888889, 'specificity': 0.6888889, 'f1': 0.672039, 'auroc': 0.8564148, 'binary_precision': 0.8455285, 'binary_recall': 0.46222222, 'binary_specificity': 0.91555554, 'binary_f1_score': 0.59770113}
confusion matrix:
     0    1
0  206   19
1  121  104
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195613 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |  16402 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195189 KiB |   7827 MiB | 124060 GiB | 124060 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |  16210 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8514 MiB |   8524 MiB |  16788 MiB |   8274 MiB |
|       from large pool |   8472 MiB |   8486 MiB |  16732 MiB |   8260 MiB |
|       from small pool |     42 MiB |     42 MiB |     56 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39907 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |   8174 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     800    |    1679    |   20970 K  |   20969 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9571 K  |    9570 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     800    |    1679    |   20970 K  |   20969 K  |
|       from large pool |      79    |     762    |   11399 K  |   11399 K  |
|       from small pool |     721    |    1017    |    9571 K  |    9570 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     369    |     369    |     714    |     345    |
|       from large pool |     348    |     349    |     686    |     338    |
|       from small pool |      21    |      21    |      28    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |     382    |   12519 K  |   12519 K  |
|       from large pool |      11    |     351    |    8265 K  |    8265 K  |
|       from small pool |      34    |     215    |    4253 K  |    4253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124060 GiB | 124060 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   12519 K  |   12519 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4253 K  |    4253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 124075 GiB | 124075 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 122423 GiB | 122423 GiB |
|       from small pool |      0 KiB |     36 MiB |   1652 GiB |   1652 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 124060 GiB | 124060 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 122412 GiB | 122411 GiB |
|       from small pool |      0 KiB |     36 MiB |   1648 GiB |   1648 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  16788 MiB |  16558 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  16732 MiB |  16526 MiB |
|       from small pool |  24576 KiB |     42 MiB |     56 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB |  67125 GiB |  67125 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  65468 GiB |  65468 GiB |
|       from small pool |      0 KiB |  22319 KiB |   1657 GiB |   1657 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   20970 K  |   20970 K  |
|       from large pool |       2    |     762    |   11399 K  |   11399 K  |
|       from small pool |       0    |    1017    |    9571 K  |    9571 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |     714    |     692    |
|       from large pool |      10    |     349    |     686    |     676    |
|       from small pool |      12    |      21    |      28    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   12519 K  |   12519 K  |
|       from large pool |       3    |     351    |    8265 K  |    8265 K  |
|       from small pool |       0    |     215    |    4253 K  |    4253 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804

 Experiment start at: 2024-07-20 14:18:05.061595
before training, model accuracy: 0.41203704476356506
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.59620416, 'precision': 0.6141402, 'recall': 0.5977007, 'specificity': 0.5977007, 'f1': 0.58175576, 'auroc': 0.65920055, 'binary_precision': 0.6613924, 'binary_recall': 0.40714285, 'binary_specificity': 0.78825855, 'binary_f1_score': 0.50401926}
confusion matrix:
      0    1
0  1195  321
1   913  627
---- Validation: 
scalar performance:
{'acc': 0.64632237, 'precision': 0.6547385, 'recall': 0.6426971, 'specificity': 0.6426971, 'f1': 0.6378032, 'auroc': 0.6702268, 'binary_precision': 0.6847826, 'binary_recall': 0.50643086, 'binary_specificity': 0.7789634, 'binary_f1_score': 0.58225507}
confusion matrix:
     0    1
0  511  145
1  307  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.37037036, 'precision': 0.34976155, 'recall': 0.3703704, 'specificity': 0.3703704, 'f1': 0.34801137, 'auroc': 0.30979937, 'binary_precision': 0.29411766, 'binary_recall': 0.18518518, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.22727273}
confusion matrix:
     0   1
0  120  96
1  176  40
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-20 14:19:34.422833,epoch time: 0:01:29.361238,used: 0:01:29.361238,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.6639398, 'precision': 0.6645827, 'recall': 0.6641529, 'specificity': 0.6641529, 'f1': 0.6637782, 'auroc': 0.7184641, 'binary_precision': 0.67701864, 'binary_recall': 0.63701296, 'binary_specificity': 0.6912929, 'binary_f1_score': 0.6564068}
confusion matrix:
      0    1
0  1048  468
1   559  981
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.6591974, 'recall': 0.6575587, 'specificity': 0.6575587, 'f1': 0.65736175, 'auroc': 0.69036007, 'binary_precision': 0.6625874, 'binary_recall': 0.60932475, 'binary_specificity': 0.70579267, 'binary_f1_score': 0.6348409}
confusion matrix:
     0    1
0  463  193
1  243  379
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.3935185, 'precision': 0.39195302, 'recall': 0.3935185, 'specificity': 0.3935185, 'f1': 0.3913137, 'auroc': 0.34064215, 'binary_precision': 0.37894738, 'binary_recall': 0.33333334, 'binary_specificity': 0.4537037, 'binary_f1_score': 0.35467982}
confusion matrix:
     0    1
0   98  118
1  144   72
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-20 14:20:55.726433,epoch time: 0:01:21.303600,used: 0:02:50.664838,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.7094241, 'precision': 0.70941186, 'recall': 0.70942163, 'specificity': 0.70942163, 'f1': 0.709414, 'auroc': 0.7810215, 'binary_precision': 0.7125163, 'binary_recall': 0.7097403, 'binary_specificity': 0.7091029, 'binary_f1_score': 0.7111256}
confusion matrix:
      0     1
0  1075   441
1   447  1093
---- Validation: 
scalar performance:
{'acc': 0.6690141, 'precision': 0.669592, 'recall': 0.66767555, 'specificity': 0.66767555, 'f1': 0.6674731, 'auroc': 0.7046678, 'binary_precision': 0.67486817, 'binary_recall': 0.61736333, 'binary_specificity': 0.7179878, 'binary_f1_score': 0.6448362}
confusion matrix:
     0    1
0  471  185
1  238  384
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.46064815, 'precision': 0.46040285, 'recall': 0.46064815, 'specificity': 0.46064815, 'f1': 0.45981163, 'auroc': 0.37635028, 'binary_precision': 0.45728642, 'binary_recall': 0.4212963, 'binary_specificity': 0.5, 'binary_f1_score': 0.4385542}
confusion matrix:
     0    1
0  108  108
1  125   91
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-20 14:22:16.395239,epoch time: 0:01:20.668806,used: 0:04:11.333644,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.74051046, 'precision': 0.7404965, 'recall': 0.7404816, 'specificity': 0.7404816, 'f1': 0.7404871, 'auroc': 0.82182777, 'binary_precision': 0.74174756, 'binary_recall': 0.7441558, 'binary_specificity': 0.7368074, 'binary_f1_score': 0.7429498}
confusion matrix:
      0     1
0  1117   399
1   394  1146
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.6797439, 'recall': 0.6757264, 'specificity': 0.6757264, 'f1': 0.6750356, 'auroc': 0.71508855, 'binary_precision': 0.69372696, 'binary_recall': 0.6045016, 'binary_specificity': 0.7469512, 'binary_f1_score': 0.6460481}
confusion matrix:
     0    1
0  490  166
1  246  376
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4699074, 'precision': 0.46962026, 'recall': 0.4699074, 'specificity': 0.4699074, 'f1': 0.46865183, 'auroc': 0.40412807, 'binary_precision': 0.46666667, 'binary_recall': 0.4212963, 'binary_specificity': 0.5185185, 'binary_f1_score': 0.4428224}
confusion matrix:
     0    1
0  112  104
1  125   91
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-20 14:23:35.837601,epoch time: 0:01:19.442362,used: 0:05:30.776006,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.77290577, 'precision': 0.77444434, 'recall': 0.7731899, 'specificity': 0.7731899, 'f1': 0.7726998, 'auroc': 0.8532647, 'binary_precision': 0.79705054, 'binary_recall': 0.737013, 'binary_specificity': 0.80936676, 'binary_f1_score': 0.7658569}
confusion matrix:
      0     1
0  1227   289
1   405  1135
---- Validation: 
scalar performance:
{'acc': 0.68075114, 'precision': 0.68563116, 'recall': 0.6781919, 'specificity': 0.6781919, 'f1': 0.6765295, 'auroc': 0.7225659, 'binary_precision': 0.70980394, 'binary_recall': 0.5819936, 'binary_specificity': 0.7743902, 'binary_f1_score': 0.639576}
confusion matrix:
     0    1
0  508  148
1  260  362
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4699074, 'precision': 0.46899772, 'recall': 0.4699074, 'specificity': 0.4699074, 'f1': 0.46599013, 'auroc': 0.4369213, 'binary_precision': 0.46368715, 'binary_recall': 0.38425925, 'binary_specificity': 0.5555556, 'binary_f1_score': 0.42025316}
confusion matrix:
     0   1
0  120  96
1  133  83
better model found
persisted
after epoch: 5,now: 2024-07-20 14:24:54.571393,epoch time: 0:01:18.733792,used: 0:06:49.509798,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.8036649, 'precision': 0.805725, 'recall': 0.8039818, 'specificity': 0.8039818, 'f1': 0.80343723, 'auroc': 0.8829969, 'binary_precision': 0.8328612, 'binary_recall': 0.76363635, 'binary_specificity': 0.84432715, 'binary_f1_score': 0.796748}
confusion matrix:
      0     1
0  1280   236
1   364  1176
---- Validation: 
scalar performance:
{'acc': 0.685446, 'precision': 0.69361115, 'recall': 0.6823485, 'specificity': 0.6823485, 'f1': 0.6796433, 'auroc': 0.73049176, 'binary_precision': 0.72727275, 'binary_recall': 0.5659164, 'binary_specificity': 0.7987805, 'binary_f1_score': 0.636528}
confusion matrix:
     0    1
0  524  132
1  270  352
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4837963, 'precision': 0.48275822, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.47590783, 'auroc': 0.4667781, 'binary_precision': 0.4785276, 'binary_recall': 0.3611111, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.41160947}
confusion matrix:
     0   1
0  131  85
1  138  78
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-20 14:26:14.559540,epoch time: 0:01:19.988147,used: 0:08:09.497945,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.82002616, 'precision': 0.8222512, 'recall': 0.82034916, 'specificity': 0.82034916, 'f1': 0.81980944, 'auroc': 0.9006095, 'binary_precision': 0.85106385, 'binary_recall': 0.77922076, 'binary_specificity': 0.86147755, 'binary_f1_score': 0.81355935}
confusion matrix:
      0     1
0  1306   210
1   340  1200
---- Validation: 
scalar performance:
{'acc': 0.6799687, 'precision': 0.69239813, 'recall': 0.6762215, 'specificity': 0.6762215, 'f1': 0.671685, 'auroc': 0.7345748, 'binary_precision': 0.7350993, 'binary_recall': 0.53536975, 'binary_specificity': 0.81707317, 'binary_f1_score': 0.61953485}
confusion matrix:
     0    1
0  536  120
1  289  333
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.4652778, 'precision': 0.46107173, 'recall': 0.4652778, 'specificity': 0.4652778, 'f1': 0.45043314, 'auroc': 0.4912337, 'binary_precision': 0.44827586, 'binary_recall': 0.30092594, 'binary_specificity': 0.6296296, 'binary_f1_score': 0.36011085}
confusion matrix:
     0   1
0  136  80
1  151  65
early stop counter: 1
val acc:0.6799687147140503, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.48379629850387573
after epoch: 7,now: 2024-07-20 14:27:33.542508,epoch time: 0:01:18.982968,used: 0:09:28.480913,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.83900523, 'precision': 0.84413266, 'recall': 0.8394836, 'specificity': 0.8394836, 'f1': 0.83852875, 'auroc': 0.90898466, 'binary_precision': 0.8881481, 'binary_recall': 0.7785714, 'binary_specificity': 0.90039575, 'binary_f1_score': 0.8297578}
confusion matrix:
      0     1
0  1365   151
1   341  1199
---- Validation: 
scalar performance:
{'acc': 0.6760563, 'precision': 0.6951856, 'recall': 0.67153555, 'specificity': 0.67153555, 'f1': 0.6642144, 'auroc': 0.7365556, 'binary_precision': 0.75, 'binary_recall': 0.5016077, 'binary_specificity': 0.8414634, 'binary_f1_score': 0.6011561}
confusion matrix:
     0    1
0  552  104
1  310  312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47453704, 'precision': 0.4698714, 'recall': 0.47453704, 'specificity': 0.47453704, 'f1': 0.45337492, 'auroc': 0.5064515, 'binary_precision': 0.45801526, 'binary_recall': 0.2777778, 'binary_specificity': 0.6712963, 'binary_f1_score': 0.34582135}
confusion matrix:
     0   1
0  145  71
1  156  60
early stop counter: 2
val acc:0.6760563254356384, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.48379629850387573
after epoch: 8,now: 2024-07-20 14:28:53.398947,epoch time: 0:01:19.856439,used: 0:10:48.337352,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.8556937, 'precision': 0.8601054, 'recall': 0.8561294, 'specificity': 0.8561294, 'f1': 0.85534984, 'auroc': 0.91440046, 'binary_precision': 0.90197515, 'binary_recall': 0.80064934, 'binary_specificity': 0.9116095, 'binary_f1_score': 0.8482972}
confusion matrix:
      0     1
0  1382   134
1   307  1233
---- Validation: 
scalar performance:
{'acc': 0.6776213, 'precision': 0.7022532, 'recall': 0.6726433, 'specificity': 0.6726433, 'f1': 0.6634779, 'auroc': 0.7399003, 'binary_precision': 0.76649743, 'binary_recall': 0.48553056, 'binary_specificity': 0.8597561, 'binary_f1_score': 0.5944882}
confusion matrix:
     0    1
0  564   92
1  320  302
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.49305555, 'precision': 0.49139008, 'recall': 0.49305558, 'specificity': 0.49305558, 'f1': 0.46729428, 'auroc': 0.5227623, 'binary_precision': 0.4876033, 'binary_recall': 0.27314815, 'binary_specificity': 0.712963, 'binary_f1_score': 0.35014835}
confusion matrix:
     0   1
0  154  62
1  157  59
new oracle model saved
early stop counter: 3
val acc:0.6776213049888611, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.4930555522441864
after epoch: 9,now: 2024-07-20 14:30:14.243622,epoch time: 0:01:20.844675,used: 0:12:09.182027,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.858966, 'precision': 0.8612319, 'recall': 0.85927856, 'specificity': 0.85927856, 'f1': 0.85881174, 'auroc': 0.92876333, 'binary_precision': 0.89187276, 'binary_recall': 0.81948054, 'binary_specificity': 0.8990765, 'binary_f1_score': 0.8541455}
confusion matrix:
      0     1
0  1363   153
1   278  1262
---- Validation: 
scalar performance:
{'acc': 0.68153363, 'precision': 0.70402193, 'recall': 0.6767876, 'specificity': 0.6767876, 'f1': 0.6687565, 'auroc': 0.74588513, 'binary_precision': 0.7654321, 'binary_recall': 0.49839228, 'binary_specificity': 0.85518295, 'binary_f1_score': 0.6037001}
confusion matrix:
     0    1
0  561   95
1  312  310
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.5055018, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.48418772, 'auroc': 0.54151666, 'binary_precision': 0.50769234, 'binary_recall': 0.30555555, 'binary_specificity': 0.7037037, 'binary_f1_score': 0.38150287}
confusion matrix:
     0   1
0  152  64
1  150  66
new oracle model saved
early stop counter: 4
val acc:0.6815336346626282, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5046296119689941
after epoch: 10,now: 2024-07-20 14:31:34.163240,epoch time: 0:01:19.919618,used: 0:13:29.101645,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.8746728, 'precision': 0.8765077, 'recall': 0.8749503, 'specificity': 0.8749503, 'f1': 0.87457114, 'auroc': 0.93782127, 'binary_precision': 0.90482855, 'binary_recall': 0.8396104, 'binary_specificity': 0.91029024, 'binary_f1_score': 0.87100035}
confusion matrix:
      0     1
0  1380   136
1   247  1293
---- Validation: 
scalar performance:
{'acc': 0.6791862, 'precision': 0.70738184, 'recall': 0.6739594, 'specificity': 0.6739594, 'f1': 0.66372913, 'auroc': 0.7484927, 'binary_precision': 0.7774869, 'binary_recall': 0.47749197, 'binary_specificity': 0.87042683, 'binary_f1_score': 0.5916335}
confusion matrix:
     0    1
0  571   85
1  325  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5046296, 'precision': 0.5058297, 'recall': 0.5046296, 'specificity': 0.5046296, 'f1': 0.47775394, 'auroc': 0.5529835, 'binary_precision': 0.5084746, 'binary_recall': 0.2777778, 'binary_specificity': 0.7314815, 'binary_f1_score': 0.35928145}
confusion matrix:
     0   1
0  158  58
1  156  60
early stop counter: 5
val acc:0.679186224937439, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5046296119689941
after epoch: 11,now: 2024-07-20 14:32:54.114357,epoch time: 0:01:19.951117,used: 0:14:49.052762,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.8776178, 'precision': 0.8797927, 'recall': 0.87791866, 'specificity': 0.87791866, 'f1': 0.8774969, 'auroc': 0.94384015, 'binary_precision': 0.9105634, 'binary_recall': 0.8396104, 'binary_specificity': 0.9162269, 'binary_f1_score': 0.87364864}
confusion matrix:
      0     1
0  1389   127
1   247  1293
---- Validation: 
scalar performance:
{'acc': 0.670579, 'precision': 0.70791686, 'recall': 0.664617, 'specificity': 0.664617, 'f1': 0.6501255, 'auroc': 0.7484609, 'binary_precision': 0.78962535, 'binary_recall': 0.44051448, 'binary_specificity': 0.8887195, 'binary_f1_score': 0.56553143}
confusion matrix:
     0    1
0  583   73
1  348  274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5115741, 'precision': 0.51552844, 'recall': 0.5115741, 'specificity': 0.5115741, 'f1': 0.4783654, 'auroc': 0.5620928, 'binary_precision': 0.5233645, 'binary_recall': 0.25925925, 'binary_specificity': 0.7638889, 'binary_f1_score': 0.3467492}
confusion matrix:
     0   1
0  165  51
1  160  56
new oracle model saved
early stop counter: 6
val acc:0.6705790162086487, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5115740895271301
after epoch: 12,now: 2024-07-20 14:34:14.047609,epoch time: 0:01:19.933252,used: 0:16:08.986014,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.885144, 'precision': 0.89000094, 'recall': 0.8855866, 'specificity': 0.8855866, 'f1': 0.8848629, 'auroc': 0.94609666, 'binary_precision': 0.93553114, 'binary_recall': 0.8292208, 'binary_specificity': 0.9419525, 'binary_f1_score': 0.8791738}
confusion matrix:
      0     1
0  1428    88
1   263  1277
---- Validation: 
scalar performance:
{'acc': 0.65884197, 'precision': 0.7043245, 'recall': 0.6522258, 'specificity': 0.6522258, 'f1': 0.63285637, 'auroc': 0.7496495, 'binary_precision': 0.7943038, 'binary_recall': 0.40353698, 'binary_specificity': 0.9009146, 'binary_f1_score': 0.5351813}
confusion matrix:
     0    1
0  591   65
1  371  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5162037, 'precision': 0.5236139, 'recall': 0.5162037, 'specificity': 0.5162037, 'f1': 0.4750179, 'auroc': 0.5740955, 'binary_precision': 0.5368421, 'binary_recall': 0.2361111, 'binary_specificity': 0.7962963, 'binary_f1_score': 0.3279743}
confusion matrix:
     0   1
0  172  44
1  165  51
new oracle model saved
early stop counter: 7
val acc:0.6588419675827026, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5162037014961243
after epoch: 13,now: 2024-07-20 14:35:33.821012,epoch time: 0:01:19.773403,used: 0:17:28.759417,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.88645285, 'precision': 0.89120984, 'recall': 0.8868905, 'specificity': 0.8868905, 'f1': 0.8861823, 'auroc': 0.9480284, 'binary_precision': 0.93635696, 'binary_recall': 0.83116883, 'binary_specificity': 0.9426121, 'binary_f1_score': 0.88063294}
confusion matrix:
      0     1
0  1429    87
1   260  1280
---- Validation: 
scalar performance:
{'acc': 0.65258217, 'precision': 0.7016543, 'recall': 0.64566994, 'specificity': 0.64566994, 'f1': 0.6237109, 'auroc': 0.7498138, 'binary_precision': 0.794702, 'binary_recall': 0.3858521, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.5194805}
confusion matrix:
     0    1
0  594   62
1  382  240
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5208333, 'precision': 0.53132355, 'recall': 0.5208333, 'specificity': 0.5208333, 'f1': 0.47704956, 'auroc': 0.5804827, 'binary_precision': 0.5494506, 'binary_recall': 0.23148148, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.3257329}
confusion matrix:
     0   1
0  175  41
1  166  50
new oracle model saved
early stop counter: 8
val acc:0.6525821685791016, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5208333134651184
after epoch: 14,now: 2024-07-20 14:36:53.289503,epoch time: 0:01:19.468491,used: 0:18:48.227908,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.8841623, 'precision': 0.8875822, 'recall': 0.88453555, 'specificity': 0.88453555, 'f1': 0.8839713, 'auroc': 0.9450377, 'binary_precision': 0.9260057, 'binary_recall': 0.837013, 'binary_specificity': 0.93205804, 'binary_f1_score': 0.8792633}
confusion matrix:
      0     1
0  1413   103
1   251  1289
---- Validation: 
scalar performance:
{'acc': 0.6549296, 'precision': 0.7036022, 'recall': 0.64808154, 'specificity': 0.64808154, 'f1': 0.6267768, 'auroc': 0.7504828, 'binary_precision': 0.79672134, 'binary_recall': 0.39067525, 'binary_specificity': 0.9054878, 'binary_f1_score': 0.52427185}
confusion matrix:
     0    1
0  594   62
1  379  243
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.5438545, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.49008912, 'auroc': 0.58931327, 'binary_precision': 0.56842107, 'binary_recall': 0.25, 'binary_specificity': 0.8101852, 'binary_f1_score': 0.34726688}
confusion matrix:
     0   1
0  175  41
1  162  54
new oracle model saved
early stop counter: 9
val acc:0.6549295783042908, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5300925970077515
after epoch: 15,now: 2024-07-20 14:38:15.752325,epoch time: 0:01:22.462822,used: 0:20:10.690730,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.8959424, 'precision': 0.9000761, 'recall': 0.89634717, 'specificity': 0.89634717, 'f1': 0.895736, 'auroc': 0.95310783, 'binary_precision': 0.9427536, 'binary_recall': 0.8448052, 'binary_specificity': 0.9478892, 'binary_f1_score': 0.89109594}
confusion matrix:
      0     1
0  1437    79
1   239  1301
---- Validation: 
scalar performance:
{'acc': 0.64710486, 'precision': 0.70353943, 'recall': 0.6397513, 'specificity': 0.6397513, 'f1': 0.6138582, 'auroc': 0.7514239, 'binary_precision': 0.80427045, 'binary_recall': 0.36334404, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.5005537}
confusion matrix:
     0    1
0  601   55
1  396  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.5301045, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.46726114, 'auroc': 0.5931713, 'binary_precision': 0.5487805, 'binary_recall': 0.20833333, 'binary_specificity': 0.8287037, 'binary_f1_score': 0.30201343}
confusion matrix:
     0   1
0  179  37
1  171  45
early stop counter: 10
val acc:0.6471048593521118, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5300925970077515
after epoch: 16,now: 2024-07-20 14:39:36.451443,epoch time: 0:01:20.699118,used: 0:21:31.389848,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.89528793, 'precision': 0.8994155, 'recall': 0.8956927, 'specificity': 0.8956927, 'f1': 0.8950802, 'auroc': 0.9544705, 'binary_precision': 0.942029, 'binary_recall': 0.84415585, 'binary_specificity': 0.94722956, 'binary_f1_score': 0.890411}
confusion matrix:
      0     1
0  1436    80
1   240  1300
---- Validation: 
scalar performance:
{'acc': 0.63771516, 'precision': 0.6955891, 'recall': 0.630105, 'specificity': 0.630105, 'f1': 0.6011405, 'auroc': 0.75221, 'binary_precision': 0.795539, 'binary_recall': 0.34405145, 'binary_specificity': 0.91615856, 'binary_f1_score': 0.48035914}
confusion matrix:
     0    1
0  601   55
1  408  214
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5185185, 'precision': 0.53333336, 'recall': 0.5185185, 'specificity': 0.5185185, 'f1': 0.45833337, 'auroc': 0.60090876, 'binary_precision': 0.5555556, 'binary_recall': 0.18518518, 'binary_specificity': 0.8518519, 'binary_f1_score': 0.27777776}
confusion matrix:
     0   1
0  184  32
1  176  40
early stop counter: 11
val acc:0.6377151608467102, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5300925970077515
after epoch: 17,now: 2024-07-20 14:40:55.513800,epoch time: 0:01:19.062357,used: 0:22:50.452205,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 18
---- Training Domain: 
scalar performance:
{'acc': 0.9123037, 'precision': 0.9152645, 'recall': 0.9126426, 'specificity': 0.9126426, 'f1': 0.91218984, 'auroc': 0.96033907, 'binary_precision': 0.9523471, 'binary_recall': 0.8694805, 'binary_specificity': 0.95580477, 'binary_f1_score': 0.9090291}
confusion matrix:
      0     1
0  1449    67
1   201  1339
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.69252026, 'recall': 0.6252402, 'specificity': 0.6252402, 'f1': 0.5942608, 'auroc': 0.7539041, 'binary_precision': 0.79310346, 'binary_recall': 0.33279744, 'binary_specificity': 0.91768295, 'binary_f1_score': 0.46885622}
confusion matrix:
     0    1
0  602   54
1  415  207
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5300926, 'precision': 0.55243695, 'recall': 0.5300926, 'specificity': 0.5300926, 'f1': 0.47406486, 'auroc': 0.6128044, 'binary_precision': 0.58666664, 'binary_recall': 0.2037037, 'binary_specificity': 0.8564815, 'binary_f1_score': 0.30240548}
confusion matrix:
     0   1
0  185  31
1  172  44
early stop counter: 12
val acc:0.6330203413963318, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5300925970077515
after epoch: 18,now: 2024-07-20 14:42:17.715878,epoch time: 0:01:22.202078,used: 0:24:12.654283,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 19
---- Training Domain: 
scalar performance:
{'acc': 0.9064136, 'precision': 0.90952206, 'recall': 0.9067625, 'specificity': 0.9067625, 'f1': 0.9062832, 'auroc': 0.9581113, 'binary_precision': 0.94721824, 'binary_recall': 0.86233765, 'binary_specificity': 0.9511873, 'binary_f1_score': 0.9027872}
confusion matrix:
      0     1
0  1442    74
1   212  1328
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.6990469, 'recall': 0.6249902, 'specificity': 0.6249902, 'f1': 0.59160006, 'auroc': 0.75469816, 'binary_precision': 0.8072289, 'binary_recall': 0.3231511, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.46153846}
confusion matrix:
     0    1
0  608   48
1  421  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55707383, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.47576594, 'auroc': 0.6201775, 'binary_precision': 0.5945946, 'binary_recall': 0.2037037, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.3034483}
confusion matrix:
     0   1
0  186  30
1  172  44
new oracle model saved
early stop counter: 13
val acc:0.6330203413963318, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5324074029922485
after epoch: 19,now: 2024-07-20 14:43:39.800885,epoch time: 0:01:22.085007,used: 0:25:34.739290,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 20
---- Training Domain: 
scalar performance:
{'acc': 0.8923429, 'precision': 0.8972827, 'recall': 0.892786, 'specificity': 0.892786, 'f1': 0.8920795, 'auroc': 0.9529538, 'binary_precision': 0.94358975, 'binary_recall': 0.8363636, 'binary_specificity': 0.94920844, 'binary_f1_score': 0.886747}
confusion matrix:
      0     1
0  1439    77
1   252  1288
---- Validation: 
scalar performance:
{'acc': 0.63302034, 'precision': 0.6990469, 'recall': 0.6249902, 'specificity': 0.6249902, 'f1': 0.59160006, 'auroc': 0.7568279, 'binary_precision': 0.8072289, 'binary_recall': 0.3231511, 'binary_specificity': 0.9268293, 'binary_f1_score': 0.46153846}
confusion matrix:
     0    1
0  608   48
1  421  201
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5324074, 'precision': 0.55833334, 'recall': 0.5324074, 'specificity': 0.5324074, 'f1': 0.4739583, 'auroc': 0.6248071, 'binary_precision': 0.5972222, 'binary_recall': 0.19907407, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.2986111}
confusion matrix:
     0   1
0  187  29
1  173  43
early stop counter: 14
val acc:0.6330203413963318, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5324074029922485
after epoch: 20,now: 2024-07-20 14:45:00.446503,epoch time: 0:01:20.645618,used: 0:26:55.384908,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 21
---- Training Domain: 
scalar performance:
{'acc': 0.9123037, 'precision': 0.91648126, 'recall': 0.91270435, 'specificity': 0.91270435, 'f1': 0.91213477, 'auroc': 0.95983577, 'binary_precision': 0.96020263, 'binary_recall': 0.8616883, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.908282}
confusion matrix:
      0     1
0  1461    55
1   213  1327
---- Validation: 
scalar performance:
{'acc': 0.63223785, 'precision': 0.7043754, 'recall': 0.623978, 'specificity': 0.623978, 'f1': 0.5881828, 'auroc': 0.7596561, 'binary_precision': 0.8193277, 'binary_recall': 0.31350482, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.45348835}
confusion matrix:
     0    1
0  613   43
1  427  195
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.56857145, 'recall': 0.5393518, 'specificity': 0.5393518, 'f1': 0.48442814, 'auroc': 0.6352452, 'binary_precision': 0.61333334, 'binary_recall': 0.21296297, 'binary_specificity': 0.8657407, 'binary_f1_score': 0.3161512}
confusion matrix:
     0   1
0  187  29
1  170  46
new oracle model saved
early stop counter: 15
val acc:0.6322378516197205, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5393518805503845
after epoch: 21,now: 2024-07-20 14:46:20.614873,epoch time: 0:01:20.168370,used: 0:28:15.553278,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 22
---- Training Domain: 
scalar performance:
{'acc': 0.90674084, 'precision': 0.9134133, 'recall': 0.9072465, 'specificity': 0.9072465, 'f1': 0.906434, 'auroc': 0.9545382, 'binary_precision': 0.96793437, 'binary_recall': 0.8428571, 'binary_specificity': 0.9716359, 'binary_f1_score': 0.90107596}
confusion matrix:
      0     1
0  1473    43
1   242  1298
---- Validation: 
scalar performance:
{'acc': 0.6118936, 'precision': 0.69165576, 'recall': 0.60291106, 'specificity': 0.60291106, 'f1': 0.5564053, 'auroc': 0.75974923, 'binary_precision': 0.8088235, 'binary_recall': 0.2652733, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.39951575}
confusion matrix:
     0    1
0  617   39
1  457  165
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5906721, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.47660193, 'auroc': 0.6401106, 'binary_precision': 0.6557377, 'binary_recall': 0.18518518, 'binary_specificity': 0.9027778, 'binary_f1_score': 0.28880864}
confusion matrix:
     0   1
0  195  21
1  176  40
new oracle model saved
early stop counter: 16
val acc:0.6118935942649841, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 22,now: 2024-07-20 14:47:40.372815,epoch time: 0:01:19.757942,used: 0:29:35.311220,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 23
---- Training Domain: 
scalar performance:
{'acc': 0.90870416, 'precision': 0.9134728, 'recall': 0.9091329, 'specificity': 0.9091329, 'f1': 0.90849817, 'auroc': 0.96148825, 'binary_precision': 0.9598833, 'binary_recall': 0.8545455, 'binary_specificity': 0.9637203, 'binary_f1_score': 0.9041566}
confusion matrix:
      0     1
0  1461    55
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.6103286, 'precision': 0.6916419, 'recall': 0.6012617, 'specificity': 0.6012617, 'f1': 0.5534817, 'auroc': 0.7587689, 'binary_precision': 0.81, 'binary_recall': 0.26045015, 'binary_specificity': 0.94207317, 'binary_f1_score': 0.39416057}
confusion matrix:
     0    1
0  618   38
1  460  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5439815, 'precision': 0.5882695, 'recall': 0.5439815, 'specificity': 0.5439815, 'f1': 0.47857732, 'auroc': 0.64405435, 'binary_precision': 0.6507937, 'binary_recall': 0.18981482, 'binary_specificity': 0.8981481, 'binary_f1_score': 0.29390684}
confusion matrix:
     0   1
0  194  22
1  175  41
early stop counter: 17
val acc:0.6103286147117615, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 23,now: 2024-07-20 14:48:59.251673,epoch time: 0:01:18.878858,used: 0:30:54.190078,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 24
---- Training Domain: 
scalar performance:
{'acc': 0.90804976, 'precision': 0.9126947, 'recall': 0.90847325, 'specificity': 0.90847325, 'f1': 0.907848, 'auroc': 0.9586257, 'binary_precision': 0.95848507, 'binary_recall': 0.8545455, 'binary_specificity': 0.96240103, 'binary_f1_score': 0.9035359}
confusion matrix:
      0     1
0  1459    57
1   224  1316
---- Validation: 
scalar performance:
{'acc': 0.6205008, 'precision': 0.69282055, 'recall': 0.61196184, 'specificity': 0.61196184, 'f1': 0.5717996, 'auroc': 0.7611437, 'binary_precision': 0.80444443, 'binary_recall': 0.2909968, 'binary_specificity': 0.93292683, 'binary_f1_score': 0.42739078}
confusion matrix:
     0    1
0  612   44
1  441  181
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5393519, 'precision': 0.57005763, 'recall': 0.5393519, 'specificity': 0.5393519, 'f1': 0.48266584, 'auroc': 0.6485125, 'binary_precision': 0.6164383, 'binary_recall': 0.20833333, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.31141868}
confusion matrix:
     0   1
0  188  28
1  171  45
early stop counter: 18
val acc:0.6205008029937744, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 24,now: 2024-07-20 14:50:19.195142,epoch time: 0:01:19.943469,used: 0:32:14.133547,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 25
---- Training Domain: 
scalar performance:
{'acc': 0.91753924, 'precision': 0.920628, 'recall': 0.91788375, 'specificity': 0.91788375, 'f1': 0.9174284, 'auroc': 0.96518004, 'binary_precision': 0.95868945, 'binary_recall': 0.874026, 'binary_specificity': 0.96174145, 'binary_f1_score': 0.9144022}
confusion matrix:
      0     1
0  1458    58
1   194  1346
---- Validation: 
scalar performance:
{'acc': 0.6220657, 'precision': 0.69551754, 'recall': 0.6135279, 'specificity': 0.6135279, 'f1': 0.57356536, 'auroc': 0.76289845, 'binary_precision': 0.8088889, 'binary_recall': 0.2926045, 'binary_specificity': 0.9344512, 'binary_f1_score': 0.4297521}
confusion matrix:
     0    1
0  613   43
1  440  182
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5416667, 'precision': 0.57338065, 'recall': 0.5416667, 'specificity': 0.5416667, 'f1': 0.48614684, 'auroc': 0.65575707, 'binary_precision': 0.6216216, 'binary_recall': 0.21296297, 'binary_specificity': 0.8703704, 'binary_f1_score': 0.31724137}
confusion matrix:
     0   1
0  188  28
1  170  46
early stop counter: 19
val acc:0.6220657229423523, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5439814925193787
after epoch: 25,now: 2024-07-20 14:51:38.730478,epoch time: 0:01:19.535336,used: 0:33:33.668883,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 26
---- Training Domain: 
scalar performance:
{'acc': 0.92113876, 'precision': 0.9258011, 'recall': 0.9215579, 'specificity': 0.9215579, 'f1': 0.92097056, 'auroc': 0.96638405, 'binary_precision': 0.97236365, 'binary_recall': 0.8681818, 'binary_specificity': 0.97493404, 'binary_f1_score': 0.91732424}
confusion matrix:
      0     1
0  1478    38
1   203  1337
---- Validation: 
scalar performance:
{'acc': 0.6158059, 'precision': 0.6911309, 'recall': 0.6070553, 'specificity': 0.6070553, 'f1': 0.56387496, 'auroc': 0.763896, 'binary_precision': 0.80465114, 'binary_recall': 0.27813506, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.41338113}
confusion matrix:
     0    1
0  614   42
1  449  173
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5462963, 'precision': 0.581534, 'recall': 0.5462963, 'specificity': 0.5462963, 'f1': 0.49133727, 'auroc': 0.6595293, 'binary_precision': 0.6351351, 'binary_recall': 0.2175926, 'binary_specificity': 0.875, 'binary_f1_score': 0.32413793}
confusion matrix:
     0   1
0  189  27
1  169  47
new oracle model saved
early stop counter: 20
val acc:0.6158059239387512, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5462962985038757
after epoch: 26,now: 2024-07-20 14:52:57.561633,epoch time: 0:01:18.831155,used: 0:34:52.500038,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 27
---- Training Domain: 
scalar performance:
{'acc': 0.91590315, 'precision': 0.9203967, 'recall': 0.91631687, 'specificity': 0.91631687, 'f1': 0.9157288, 'auroc': 0.9652314, 'binary_precision': 0.9658678, 'binary_recall': 0.8636364, 'binary_specificity': 0.96899736, 'binary_f1_score': 0.91189575}
confusion matrix:
      0     1
0  1469    47
1   210  1330
---- Validation: 
scalar performance:
{'acc': 0.62128323, 'precision': 0.6961251, 'recall': 0.61268234, 'specificity': 0.61268234, 'f1': 0.571915, 'auroc': 0.7656336, 'binary_precision': 0.8108108, 'binary_recall': 0.28938907, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.4265403}
confusion matrix:
     0    1
0  614   42
1  442  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5486111, 'precision': 0.5797721, 'recall': 0.5486111, 'specificity': 0.5486111, 'f1': 0.4997595, 'auroc': 0.66655946, 'binary_precision': 0.6296296, 'binary_recall': 0.2361111, 'binary_specificity': 0.8611111, 'binary_f1_score': 0.34343433}
confusion matrix:
     0   1
0  186  30
1  165  51
new oracle model saved
early stop counter: 21
val acc:0.621283233165741, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5486111044883728
after epoch: 27,now: 2024-07-20 14:54:16.503359,epoch time: 0:01:18.941726,used: 0:36:11.441764,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 28
---- Training Domain: 
scalar performance:
{'acc': 0.9116492, 'precision': 0.9166286, 'recall': 0.91208583, 'specificity': 0.91208583, 'f1': 0.9114415, 'auroc': 0.96557117, 'binary_precision': 0.9641813, 'binary_recall': 0.85649353, 'binary_specificity': 0.9676781, 'binary_f1_score': 0.90715265}
confusion matrix:
      0     1
0  1467    49
1   221  1319
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.690403, 'recall': 0.6062515, 'specificity': 0.6062515, 'f1': 0.5627184, 'auroc': 0.7675917, 'binary_precision': 0.8037383, 'binary_recall': 0.27652735, 'binary_specificity': 0.9359756, 'binary_f1_score': 0.41148326}
confusion matrix:
     0    1
0  614   42
1  450  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5532407, 'precision': 0.5908725, 'recall': 0.5532407, 'specificity': 0.5532407, 'f1': 0.50164664, 'auroc': 0.6681242, 'binary_precision': 0.64935064, 'binary_recall': 0.23148148, 'binary_specificity': 0.875, 'binary_f1_score': 0.3412969}
confusion matrix:
     0   1
0  189  27
1  166  50
new oracle model saved
early stop counter: 22
val acc:0.6150234937667847, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5532407164573669
after epoch: 28,now: 2024-07-20 14:55:36.566151,epoch time: 0:01:20.062792,used: 0:37:31.504556,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 29
---- Training Domain: 
scalar performance:
{'acc': 0.9181937, 'precision': 0.922885, 'recall': 0.9186153, 'specificity': 0.9186153, 'f1': 0.9180167, 'auroc': 0.9707514, 'binary_precision': 0.9694323, 'binary_recall': 0.86493504, 'binary_specificity': 0.9722955, 'binary_f1_score': 0.9142073}
confusion matrix:
      0     1
0  1474    42
1   208  1332
---- Validation: 
scalar performance:
{'acc': 0.6126761, 'precision': 0.6923897, 'recall': 0.6037149, 'specificity': 0.6037149, 'f1': 0.55757916, 'auroc': 0.76882446, 'binary_precision': 0.8097561, 'binary_recall': 0.26688102, 'binary_specificity': 0.9405488, 'binary_f1_score': 0.401451}
confusion matrix:
     0    1
0  617   39
1  456  166
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5509259, 'precision': 0.58781785, 'recall': 0.5509259, 'specificity': 0.5509259, 'f1': 0.4982278, 'auroc': 0.6753472, 'binary_precision': 0.6447368, 'binary_recall': 0.22685185, 'binary_specificity': 0.875, 'binary_f1_score': 0.3356164}
confusion matrix:
     0   1
0  189  27
1  167  49
early stop counter: 23
val acc:0.6126760840415955, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5532407164573669
after epoch: 29,now: 2024-07-20 14:56:56.661415,epoch time: 0:01:20.095264,used: 0:38:51.599820,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 30
---- Training Domain: 
scalar performance:
{'acc': 0.9162304, 'precision': 0.9197017, 'recall': 0.9165953, 'specificity': 0.9165953, 'f1': 0.916101, 'auroc': 0.9659635, 'binary_precision': 0.95988536, 'binary_recall': 0.8701299, 'binary_specificity': 0.9630607, 'binary_f1_score': 0.9128066}
confusion matrix:
      0     1
0  1460    56
1   200  1340
---- Validation: 
scalar performance:
{'acc': 0.6150235, 'precision': 0.6974888, 'recall': 0.60604316, 'specificity': 0.60604316, 'f1': 0.55998266, 'auroc': 0.7682731, 'binary_precision': 0.8186275, 'binary_recall': 0.26848873, 'binary_specificity': 0.94359756, 'binary_f1_score': 0.40435836}
confusion matrix:
     0    1
0  619   37
1  455  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5671296, 'precision': 0.60812306, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.5218042, 'auroc': 0.6819701, 'binary_precision': 0.67469877, 'binary_recall': 0.25925925, 'binary_specificity': 0.875, 'binary_f1_score': 0.37458193}
confusion matrix:
     0   1
0  189  27
1  160  56
new oracle model saved
early stop counter: 24
val acc:0.6150234937667847, best validation acc: 0.68544602394104, corresponding to test acc:                         0.48379629850387573 / 0.5671296119689941
after epoch: 30,now: 2024-07-20 14:58:16.310174,epoch time: 0:01:19.648759,used: 0:40:11.248579,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_20_14_18_05_seed_2_22504804
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
Experiment finished at epoch: 30 with time: 0:40:11.248579 at 2024-07-20 14:58:16.310174
persisted model performance metric: 

scalar performance:
{'acc': 0.4837963, 'precision': 0.48275822, 'recall': 0.4837963, 'specificity': 0.4837963, 'f1': 0.47590783, 'auroc': 0.4667781, 'binary_precision': 0.4785276, 'binary_recall': 0.3611111, 'binary_specificity': 0.6064815, 'binary_f1_score': 0.41160947}
confusion matrix:
     0   1
0  131  85
1  138  78
oracle model performance metric: 

scalar performance:
{'acc': 0.5671296, 'precision': 0.60812306, 'recall': 0.5671296, 'specificity': 0.5671296, 'f1': 0.5218042, 'auroc': 0.6819701, 'binary_precision': 0.67469877, 'binary_recall': 0.25925925, 'binary_specificity': 0.875, 'binary_f1_score': 0.37458193}
confusion matrix:
     0   1
0  189  27
1  160  56
results aggregation path: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/rule_results/2.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYONbalanced_center0_dinov2small_erm_irm_dial_lr1e5_bs16_classbalancing10_halffreezeblocks_2024-07-20_12-48-11/confusion_matrix/2.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 195607 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool | 179211 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |  16396 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 195188 KiB |   7827 MiB | 185275 GiB | 185274 GiB |
|       from large pool | 178979 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |  16209 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8512 MiB |   8524 MiB |  25070 MiB |  16558 MiB |
|       from large pool |   8474 MiB |   8486 MiB |  25000 MiB |  16526 MiB |
|       from small pool |     38 MiB |     42 MiB |     70 MiB |     32 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  39913 KiB | 732464 KiB | 100652 GiB | 100652 GiB |
|       from large pool |  31733 KiB | 730714 KiB |  98180 GiB |  98180 GiB |
|       from small pool |   8180 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |     788    |    1679    |   31316 K  |   31315 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14293 K  |   14293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |     788    |    1679    |   31316 K  |   31315 K  |
|       from large pool |      79    |     762    |   17022 K  |   17022 K  |
|       from small pool |     709    |    1017    |   14293 K  |   14293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     368    |     369    |    1060    |     692    |
|       from large pool |     349    |     349    |    1025    |     676    |
|       from small pool |      19    |      21    |      35    |      16    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      44    |     382    |   18325 K  |   18325 K  |
|       from large pool |      11    |     352    |   12008 K  |   12008 K  |
|       from small pool |      33    |     215    |    6317 K  |    6317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   7828 MiB | 185299 GiB | 185299 GiB |
|       from large pool |  16640 KiB |   7805 MiB | 182834 GiB | 182834 GiB |
|       from small pool |      0 KiB |     36 MiB |   2464 GiB |   2464 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   7827 MiB | 185275 GiB | 185275 GiB |
|       from large pool |  16640 KiB |   7804 MiB | 182815 GiB | 182815 GiB |
|       from small pool |      0 KiB |     36 MiB |   2459 GiB |   2459 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 235520 KiB |   8524 MiB |  25070 MiB |  24840 MiB |
|       from large pool | 210944 KiB |   8486 MiB |  25000 MiB |  24794 MiB |
|       from small pool |  24576 KiB |     42 MiB |     70 MiB |     46 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  30464 KiB | 732464 KiB | 100652 GiB | 100652 GiB |
|       from large pool |  30464 KiB | 730714 KiB |  98180 GiB |  98180 GiB |
|       from small pool |      0 KiB |  22319 KiB |   2472 GiB |   2472 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    1679    |   31316 K  |   31316 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14293 K  |   14293 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    1679    |   31316 K  |   31316 K  |
|       from large pool |       2    |     762    |   17022 K  |   17022 K  |
|       from small pool |       0    |    1017    |   14293 K  |   14293 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     369    |    1060    |    1038    |
|       from large pool |      10    |     349    |    1025    |    1015    |
|       from small pool |      12    |      21    |      35    |      23    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |     382    |   18326 K  |   18326 K  |
|       from large pool |       3    |     352    |   12008 K  |   12008 K  |
|       from small pool |       0    |     215    |    6317 K  |    6317 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 20 14:59:07 2024]
Finished job 0.
1 of 1 steps (100%) done
