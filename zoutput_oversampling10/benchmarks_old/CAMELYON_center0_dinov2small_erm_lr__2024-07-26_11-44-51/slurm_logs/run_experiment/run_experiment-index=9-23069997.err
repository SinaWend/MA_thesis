Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 11:47:21 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/9.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=9
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997

 Experiment start at: 2024-07-26 11:57:16.540300
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9314675, 'precision': 0.9035349, 'recall': 0.9232508, 'specificity': 0.9232508, 'f1': 0.9126847, 'auroc': 0.96346116, 'binary_precision': 0.8405724, 'binary_recall': 0.90627337, 'binary_specificity': 0.9402283, 'binary_f1_score': 0.8721874}
confusion matrix:
       0      1
0  39782   2529
1   1379  13334
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.10030864, 'precision': 0.51789075, 'recall': 0.5334667, 'specificity': 0.5334667, 'f1': 0.09938747, 'auroc': 0.84826267, 'binary_precision': 0.036585364, 'binary_recall': 0.9984448, 'binary_specificity': 0.06848862, 'binary_f1_score': 0.07058436}
confusion matrix:
      0      1
0  1243  16906
1     1    642
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.056407798, 'precision': 0.5211645, 'recall': 0.5076705, 'specificity': 0.5076705, 'f1': 0.055719137, 'auroc': 0.80495656, 'binary_precision': 0.0423289, 'binary_recall': 1.0, 'binary_specificity': 0.015341003, 'binary_f1_score': 0.08121985}
confusion matrix:
    0     1
0  92  5905
1   0   261
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:19:23.268368,epoch time: 0:22:06.728068,used: 0:22:06.728068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9651901, 'precision': 0.97100174, 'recall': 0.9378626, 'specificity': 0.9378626, 'f1': 0.9529296, 'auroc': 0.9835819, 'binary_precision': 0.98182917, 'binary_recall': 0.8813974, 'binary_specificity': 0.9943277, 'binary_f1_score': 0.92890656}
confusion matrix:
       0      1
0  42071    240
1   1745  12968
---- Validation: 
scalar performance:
{'acc': 0.9422094, 'precision': 0.54015374, 'recall': 0.535799, 'specificity': 0.535799, 'f1': 0.5377884, 'auroc': 0.7524672, 'binary_precision': 0.11208406, 'binary_recall': 0.09953344, 'binary_specificity': 0.97206455, 'binary_f1_score': 0.10543657}
confusion matrix:
       0    1
0  17642  507
1    579   64
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95174176, 'precision': 0.47900918, 'recall': 0.4965816, 'specificity': 0.4965816, 'f1': 0.4876371, 'auroc': 0.67708504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9931632, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5956  41
1   261   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 12:40:57.813999,epoch time: 0:21:34.545631,used: 0:43:41.273699,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.96925855, 'precision': 0.97679687, 'recall': 0.943094, 'specificity': 0.943094, 'f1': 0.95841694, 'auroc': 0.98475885, 'binary_precision': 0.990832, 'binary_recall': 0.8890475, 'binary_specificity': 0.99714047, 'binary_f1_score': 0.9371842}
confusion matrix:
       0      1
0  42194    121
1   1632  13077
---- Validation: 
scalar performance:
{'acc': 0.9494998, 'precision': 0.62491167, 'recall': 0.6318301, 'specificity': 0.6318301, 'f1': 0.6282598, 'auroc': 0.8168108, 'binary_precision': 0.275, 'binary_recall': 0.29082426, 'binary_specificity': 0.97283596, 'binary_f1_score': 0.28269088}
confusion matrix:
       0    1
0  17656  493
1    456  187
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9340045, 'precision': 0.4786276, 'recall': 0.487327, 'specificity': 0.487327, 'f1': 0.48293814, 'auroc': 0.6668258, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.974654, 'binary_f1_score': 0.0}
confusion matrix:
      0    1
0  5845  152
1   261    0
better model found
persisted
after epoch: 3,now: 2024-07-26 13:02:13.705710,epoch time: 0:21:15.891711,used: 1:04:57.165410,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9777638, 'precision': 0.98304987, 'recall': 0.9589596, 'specificity': 0.9589596, 'f1': 0.9702288, 'auroc': 0.99350786, 'binary_precision': 0.9931753, 'binary_recall': 0.92011696, 'binary_specificity': 0.9978022, 'binary_f1_score': 0.95525134}
confusion matrix:
       0      1
0  42222     93
1   1175  13534
---- Validation: 
scalar performance:
{'acc': 0.95615155, 'precision': 0.6566019, 'recall': 0.63677394, 'specificity': 0.63677394, 'f1': 0.64591366, 'auroc': 0.8090521, 'binary_precision': 0.33810377, 'binary_recall': 0.29393467, 'binary_specificity': 0.9796132, 'binary_f1_score': 0.31447586}
confusion matrix:
       0    1
0  17779  370
1    454  189
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94519013, 'precision': 0.47886983, 'recall': 0.49316326, 'specificity': 0.49316326, 'f1': 0.48591146, 'auroc': 0.6589136, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9863265, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5915  82
1   261   0
better model found
persisted
after epoch: 4,now: 2024-07-26 13:23:03.156591,epoch time: 0:20:49.450881,used: 1:25:46.616291,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98325264, 'precision': 0.98508507, 'recall': 0.9710702, 'specificity': 0.9710702, 'f1': 0.97781324, 'auroc': 0.99549615, 'binary_precision': 0.9887042, 'binary_recall': 0.9458982, 'binary_specificity': 0.9962421, 'binary_f1_score': 0.96682763}
confusion matrix:
       0      1
0  42152    159
1    796  13917
---- Validation: 
scalar performance:
{'acc': 0.9344934, 'precision': 0.6046125, 'recall': 0.67356473, 'specificity': 0.67356473, 'f1': 0.62848324, 'auroc': 0.8417959, 'binary_precision': 0.23126143, 'binary_recall': 0.3934681, 'binary_specificity': 0.9536614, 'binary_f1_score': 0.29130688}
confusion matrix:
       0    1
0  17308  841
1    390  253
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9477469, 'precision': 0.48635134, 'recall': 0.4963296, 'specificity': 0.4963296, 'f1': 0.48962358, 'auroc': 0.6614195, 'binary_precision': 0.014705882, 'binary_recall': 0.0038314175, 'binary_specificity': 0.98882776, 'binary_f1_score': 0.0060790274}
confusion matrix:
      0   1
0  5930  67
1   260   1
early stop counter: 1
val acc:0.9344934225082397, best validation acc: 0.95615154504776, corresponding to test acc:                         0.9451901316642761 / 0.9517417550086975
after epoch: 5,now: 2024-07-26 13:43:50.145248,epoch time: 0:20:46.988657,used: 1:46:33.604948,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.98886436, 'precision': 0.9905414, 'recall': 0.98034275, 'specificity': 0.98034275, 'f1': 0.9853035, 'auroc': 0.99714977, 'binary_precision': 0.99389344, 'binary_recall': 0.9627414, 'binary_specificity': 0.99794406, 'binary_f1_score': 0.9780694}
confusion matrix:
       0      1
0  42229     87
1    548  14160
---- Validation: 
scalar performance:
{'acc': 0.9468391, 'precision': 0.62133235, 'recall': 0.64320356, 'specificity': 0.64320356, 'f1': 0.63118225, 'auroc': 0.8252729, 'binary_precision': 0.2670157, 'binary_recall': 0.31726283, 'binary_specificity': 0.9691443, 'binary_f1_score': 0.28997865}
confusion matrix:
       0    1
0  17589  560
1    439  204
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.92026204, 'precision': 0.48048148, 'recall': 0.4819891, 'specificity': 0.4819891, 'f1': 0.4812303, 'auroc': 0.6708456, 'binary_precision': 0.004166667, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9601467, 'binary_f1_score': 0.003992016}
confusion matrix:
      0    1
0  5758  239
1   260    1
early stop counter: 2
val acc:0.9468390941619873, best validation acc: 0.95615154504776, corresponding to test acc:                         0.9451901316642761 / 0.9517417550086975
after epoch: 6,now: 2024-07-26 14:04:38.727760,epoch time: 0:20:48.582512,used: 2:07:22.187460,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98374367, 'precision': 0.9860524, 'recall': 0.9714178, 'specificity': 0.9714178, 'f1': 0.97844785, 'auroc': 0.9945061, 'binary_precision': 0.99060297, 'binary_recall': 0.94595516, 'binary_specificity': 0.9968805, 'binary_f1_score': 0.9677644}
confusion matrix:
       0      1
0  42182    132
1    795  13915
---- Validation: 
scalar performance:
{'acc': 0.9574819, 'precision': 0.6736711, 'recall': 0.6629646, 'specificity': 0.6629646, 'f1': 0.6681228, 'auroc': 0.84486246, 'binary_precision': 0.3704319, 'binary_recall': 0.34681183, 'binary_specificity': 0.97911733, 'binary_f1_score': 0.35823295}
confusion matrix:
       0    1
0  17770  379
1    420  223
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9474273, 'precision': 0.4789176, 'recall': 0.4943305, 'specificity': 0.4943305, 'f1': 0.486502, 'auroc': 0.76588356, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.988661, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5929  68
1   261   0
better model found
persisted
after epoch: 7,now: 2024-07-26 14:33:22.243451,epoch time: 0:28:43.515691,used: 2:36:05.703151,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9935641, 'precision': 0.99425125, 'recall': 0.9889245, 'specificity': 0.9889245, 'f1': 0.9915502, 'auroc': 0.9988607, 'binary_precision': 0.9956468, 'binary_recall': 0.979338, 'binary_specificity': 0.998511, 'binary_f1_score': 0.987425}
confusion matrix:
       0      1
0  42248     63
1    304  14409
---- Validation: 
scalar performance:
{'acc': 0.96067476, 'precision': 0.69675434, 'recall': 0.6751183, 'specificity': 0.6751183, 'f1': 0.6852242, 'auroc': 0.9152881, 'binary_precision': 0.41578948, 'binary_recall': 0.36858475, 'binary_specificity': 0.9816519, 'binary_f1_score': 0.39076668}
confusion matrix:
       0    1
0  17816  333
1    406  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550975, 'precision': 0.47907984, 'recall': 0.4983325, 'specificity': 0.4983325, 'f1': 0.48851657, 'auroc': 0.7823059, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.996665, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5977  20
1   261   0
new oracle model saved
better model found
persisted
after epoch: 8,now: 2024-07-26 14:57:25.770551,epoch time: 0:24:03.527100,used: 3:00:09.230251,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9937044, 'precision': 0.9934705, 'recall': 0.99005973, 'specificity': 0.99005973, 'f1': 0.9917496, 'auroc': 0.9990909, 'binary_precision': 0.9929926, 'binary_recall': 0.98253006, 'binary_specificity': 0.9975894, 'binary_f1_score': 0.9877336}
confusion matrix:
       0      1
0  42211    102
1    257  14454
---- Validation: 
scalar performance:
{'acc': 0.93688804, 'precision': 0.60877556, 'recall': 0.6725543, 'specificity': 0.6725543, 'f1': 0.63176095, 'auroc': 0.8645588, 'binary_precision': 0.2396932, 'binary_recall': 0.3888025, 'binary_specificity': 0.95630616, 'binary_f1_score': 0.29655993}
confusion matrix:
       0    1
0  17356  793
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9534995, 'precision': 0.47904626, 'recall': 0.49749875, 'specificity': 0.49749875, 'f1': 0.48809817, 'auroc': 0.77819496, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9949975, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5967  30
1   261   0
early stop counter: 1
val acc:0.9368880391120911, best validation acc: 0.9606747627258301, corresponding to test acc:                         0.955097496509552 / 0.955097496509552
after epoch: 9,now: 2024-07-26 15:22:16.148823,epoch time: 0:24:50.378272,used: 3:24:59.608523,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9905829, 'precision': 0.99313986, 'recall': 0.9823038, 'specificity': 0.9823038, 'f1': 0.98756653, 'auroc': 0.99828804, 'binary_precision': 0.99824256, 'binary_recall': 0.96519846, 'binary_specificity': 0.99940914, 'binary_f1_score': 0.98144245}
confusion matrix:
       0      1
0  42287     25
1    512  14200
---- Validation: 
scalar performance:
{'acc': 0.9655172, 'precision': 0.7298627, 'recall': 0.5801182, 'specificity': 0.5801182, 'f1': 0.61530685, 'auroc': 0.8891231, 'binary_precision': 0.4885845, 'binary_recall': 0.16640747, 'binary_specificity': 0.99382883, 'binary_f1_score': 0.24825984}
confusion matrix:
       0    1
0  18037  112
1    536  107
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.8136704, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
new oracle model saved
better model found
persisted
after epoch: 10,now: 2024-07-26 15:43:40.462992,epoch time: 0:21:24.314169,used: 3:46:23.922692,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9880752, 'precision': 0.9915093, 'recall': 0.9774292, 'specificity': 0.9774292, 'f1': 0.9842068, 'auroc': 0.99839795, 'binary_precision': 0.9982961, 'binary_recall': 0.9554257, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.97639054}
confusion matrix:
       0      1
0  42283     24
1    656  14061
---- Validation: 
scalar performance:
{'acc': 0.96525115, 'precision': 0.7084686, 'recall': 0.53272694, 'specificity': 0.53272694, 'f1': 0.55051726, 'auroc': 0.91031456, 'binary_precision': 0.4489796, 'binary_recall': 0.06842924, 'binary_specificity': 0.99702466, 'binary_f1_score': 0.11875843}
confusion matrix:
       0   1
0  18095  54
1    599  44
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.76336044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
new oracle model saved
early stop counter: 1
val acc:0.9652511477470398, best validation acc: 0.9655172228813171, corresponding to test acc:                         0.9570150375366211 / 0.9576541781425476
after epoch: 11,now: 2024-07-26 16:04:26.571822,epoch time: 0:20:46.108830,used: 4:07:10.031522,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9934063, 'precision': 0.99462384, 'recall': 0.9881501, 'specificity': 0.9881501, 'f1': 0.9913316, 'auroc': 0.9989235, 'binary_precision': 0.99708676, 'binary_recall': 0.97729284, 'binary_specificity': 0.99900746, 'binary_f1_score': 0.98709065}
confusion matrix:
       0      1
0  42273     42
1    334  14375
---- Validation: 
scalar performance:
{'acc': 0.9645594, 'precision': 0.71951425, 'recall': 0.6156249, 'specificity': 0.6156249, 'f1': 0.64971507, 'auroc': 0.9019071, 'binary_precision': 0.46546546, 'binary_recall': 0.24105754, 'binary_specificity': 0.9901923, 'binary_f1_score': 0.31762296}
confusion matrix:
       0    1
0  17971  178
1    488  155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542985, 'precision': 0.47906306, 'recall': 0.49791563, 'specificity': 0.49791563, 'f1': 0.48830748, 'auroc': 0.77753675, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99583125, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5972  25
1   261   0
early stop counter: 2
val acc:0.9645593762397766, best validation acc: 0.9655172228813171, corresponding to test acc:                         0.9570150375366211 / 0.9576541781425476
after epoch: 12,now: 2024-07-26 16:25:27.916743,epoch time: 0:21:01.344921,used: 4:28:11.376443,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.99207354, 'precision': 0.9939417, 'recall': 0.98536897, 'specificity': 0.98536897, 'f1': 0.9895581, 'auroc': 0.99876684, 'binary_precision': 0.99769634, 'binary_recall': 0.9715179, 'binary_specificity': 0.9992201, 'binary_f1_score': 0.9844332}
confusion matrix:
       0      1
0  42280     33
1    419  14292
---- Validation: 
scalar performance:
{'acc': 0.963708, 'precision': 0.7099159, 'recall': 0.61968446, 'specificity': 0.61968446, 'f1': 0.6510365, 'auroc': 0.88740164, 'binary_precision': 0.44598338, 'binary_recall': 0.2503888, 'binary_specificity': 0.9889801, 'binary_f1_score': 0.32071713}
confusion matrix:
       0    1
0  17949  200
1    482  161
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9490253, 'precision': 0.4789516, 'recall': 0.49516425, 'specificity': 0.49516425, 'f1': 0.486923, 'auroc': 0.80246013, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9903285, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5939  58
1   261   0
early stop counter: 3
val acc:0.9637079834938049, best validation acc: 0.9655172228813171, corresponding to test acc:                         0.9570150375366211 / 0.9576541781425476
after epoch: 13,now: 2024-07-26 16:46:33.030490,epoch time: 0:21:05.113747,used: 4:49:16.490190,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9927399, 'precision': 0.9948509, 'recall': 0.9862153, 'specificity': 0.9862153, 'f1': 0.99043465, 'auroc': 0.99908245, 'binary_precision': 0.9990922, 'binary_recall': 0.9727378, 'binary_specificity': 0.9996928, 'binary_f1_score': 0.9857389}
confusion matrix:
       0      1
0  42302     13
1    401  14308
---- Validation: 
scalar performance:
{'acc': 0.9634951, 'precision': 0.71992403, 'recall': 0.69007945, 'specificity': 0.69007945, 'f1': 0.7037845, 'auroc': 0.9213303, 'binary_precision': 0.46112117, 'binary_recall': 0.39657855, 'binary_specificity': 0.98358035, 'binary_f1_score': 0.4264214}
confusion matrix:
       0    1
0  17851  298
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9503036, 'precision': 0.49764487, 'recall': 0.49949592, 'specificity': 0.49949592, 'f1': 0.49360433, 'auroc': 0.811203, 'binary_precision': 0.037037037, 'binary_recall': 0.007662835, 'binary_specificity': 0.991329, 'binary_f1_score': 0.012698412}
confusion matrix:
      0   1
0  5945  52
1   259   2
early stop counter: 4
val acc:0.9634950757026672, best validation acc: 0.9655172228813171, corresponding to test acc:                         0.9570150375366211 / 0.9576541781425476
after epoch: 14,now: 2024-07-26 17:08:23.993792,epoch time: 0:21:50.963302,used: 5:11:07.453492,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.99487936, 'precision': 0.9942062, 'recall': 0.9924042, 'specificity': 0.9924042, 'f1': 0.9933009, 'auroc': 0.9992262, 'binary_precision': 0.9928235, 'binary_recall': 0.98729014, 'binary_specificity': 0.99751836, 'binary_f1_score': 0.99004906}
confusion matrix:
       0      1
0  42206    105
1    187  14526
---- Validation: 
scalar performance:
{'acc': 0.95604515, 'precision': 0.6484854, 'recall': 0.6202176, 'specificity': 0.6202176, 'f1': 0.63262683, 'auroc': 0.8783022, 'binary_precision': 0.32301742, 'binary_recall': 0.25972006, 'binary_specificity': 0.9807152, 'binary_f1_score': 0.28793105}
confusion matrix:
       0    1
0  17799  350
1    476  167
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434324, 'precision': 0.4841695, 'recall': 0.49407846, 'specificity': 0.49407846, 'f1': 0.48825306, 'auroc': 0.7261977, 'binary_precision': 0.010526316, 'binary_recall': 0.0038314175, 'binary_specificity': 0.98432547, 'binary_f1_score': 0.0056179776}
confusion matrix:
      0   1
0  5903  94
1   260   1
early stop counter: 5
val acc:0.9560451507568359, best validation acc: 0.9655172228813171, corresponding to test acc:                         0.9570150375366211 / 0.9576541781425476
after epoch: 15,now: 2024-07-26 17:30:34.987091,epoch time: 0:22:10.993299,used: 5:33:18.446791,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_11_57_16_seed_0_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 15 with time: 5:33:18.446791 at 2024-07-26 17:30:34.987091
persisted model performance metric: 

scalar performance:
{'acc': 0.95701504, 'precision': 0.47912, 'recall': 0.499333, 'specificity': 0.499333, 'f1': 0.48901772, 'auroc': 0.8136704, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998666, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5989  8
1   261  0
oracle model performance metric: 

scalar performance:
{'acc': 0.9576542, 'precision': 0.47913337, 'recall': 0.4996665, 'specificity': 0.4996665, 'f1': 0.48918456, 'auroc': 0.76336044, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.999333, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5993  4
1   261  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/9.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452684 KiB |   6932 MiB | 547065 GiB | 547065 GiB |
|       from large pool | 411879 KiB |   6897 MiB | 545134 GiB | 545133 GiB |
|       from small pool |  40805 KiB |     56 MiB |   1931 GiB |   1931 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 452684 KiB |   6932 MiB | 547065 GiB | 547065 GiB |
|       from large pool | 411879 KiB |   6897 MiB | 545134 GiB | 545133 GiB |
|       from small pool |  40805 KiB |     56 MiB |   1931 GiB |   1931 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   6928 MiB | 547027 GiB | 547027 GiB |
|       from large pool | 407075 KiB |   6894 MiB | 545098 GiB | 545098 GiB |
|       from small pool |  40679 KiB |     56 MiB |   1929 GiB |   1929 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7286 MiB |   7286 MiB |   7286 MiB |      0 B   |
|       from large pool |   7222 MiB |   7222 MiB |   7222 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 602035 KiB |    845 MiB | 245938 GiB | 245938 GiB |
|       from large pool | 591641 KiB |    840 MiB | 243934 GiB | 243934 GiB |
|       from small pool |  10394 KiB |     13 MiB |   2004 GiB |   2004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1724    |    2767    |   27687 K  |   27686 K  |
|       from large pool |     187    |     311    |   13468 K  |   13468 K  |
|       from small pool |    1537    |    2579    |   14219 K  |   14217 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1724    |    2767    |   27687 K  |   27686 K  |
|       from large pool |     187    |     311    |   13468 K  |   13468 K  |
|       from small pool |    1537    |    2579    |   14219 K  |   14217 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     149    |     149    |     149    |       0    |
|       from large pool |     117    |     117    |     117    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      59    |     938    |   16178 K  |   16178 K  |
|       from large pool |      23    |     118    |   10348 K  |   10348 K  |
|       from small pool |      36    |     915    |    5829 K  |    5829 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 547065 GiB | 547065 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 545134 GiB | 545134 GiB |
|       from small pool |      0 KiB |     56 MiB |   1931 GiB |   1931 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 547065 GiB | 547065 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 545134 GiB | 545134 GiB |
|       from small pool |      0 KiB |     56 MiB |   1931 GiB |   1931 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 547027 GiB | 547027 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 545098 GiB | 545098 GiB |
|       from small pool |      0 KiB |     56 MiB |   1929 GiB |   1929 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1030 MiB |   7286 MiB |   7286 MiB |   6256 MiB |
|       from large pool |    980 MiB |   7222 MiB |   7222 MiB |   6242 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 245939 GiB | 245939 GiB |
|       from large pool |   3840 KiB |    840 MiB | 243934 GiB | 243934 GiB |
|       from small pool |      0 KiB |     21 MiB |   2004 GiB |   2004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   27687 K  |   27687 K  |
|       from large pool |       2    |     311    |   13468 K  |   13468 K  |
|       from small pool |       0    |    2579    |   14219 K  |   14219 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   27687 K  |   27687 K  |
|       from large pool |       2    |     311    |   13468 K  |   13468 K  |
|       from small pool |       0    |    2579    |   14219 K  |   14219 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     149    |     149    |      98    |
|       from large pool |      26    |     117    |     117    |      91    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     938    |   16179 K  |   16179 K  |
|       from large pool |       2    |     118    |   10348 K  |   10348 K  |
|       from small pool |       0    |     915    |    5830 K  |    5830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 547065 GiB | 547065 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 545134 GiB | 545134 GiB |
|       from small pool |      0 KiB |     56 MiB |   1931 GiB |   1931 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 547065 GiB | 547065 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 545134 GiB | 545134 GiB |
|       from small pool |      0 KiB |     56 MiB |   1931 GiB |   1931 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 547027 GiB | 547027 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 545098 GiB | 545098 GiB |
|       from small pool |      0 KiB |     56 MiB |   1929 GiB |   1929 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1030 MiB |   7286 MiB |   7286 MiB |   6256 MiB |
|       from large pool |    980 MiB |   7222 MiB |   7222 MiB |   6242 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 245939 GiB | 245939 GiB |
|       from large pool |   3840 KiB |    840 MiB | 243934 GiB | 243934 GiB |
|       from small pool |      0 KiB |     21 MiB |   2004 GiB |   2004 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   27687 K  |   27687 K  |
|       from large pool |       2    |     311    |   13468 K  |   13468 K  |
|       from small pool |       0    |    2579    |   14219 K  |   14219 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   27687 K  |   27687 K  |
|       from large pool |       2    |     311    |   13468 K  |   13468 K  |
|       from small pool |       0    |    2579    |   14219 K  |   14219 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     149    |     149    |      98    |
|       from large pool |      26    |     117    |     117    |      91    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     938    |   16179 K  |   16179 K  |
|       from large pool |       2    |     118    |   10348 K  |   10348 K  |
|       from small pool |       0    |     915    |    5830 K  |    5830 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997

 Experiment start at: 2024-07-26 17:39:06.410742
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9542511, 'precision': 0.9705045, 'recall': 0.91028225, 'specificity': 0.91028225, 'f1': 0.9356525, 'auroc': 0.9637859, 'binary_precision': 0.9983977, 'binary_recall': 0.8210125, 'binary_specificity': 0.999552, 'binary_f1_score': 0.90105796}
confusion matrix:
       0      1
0  42393     19
1   2581  11839
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9587513, 'precision': 0.48687428, 'recall': 0.49794778, 'specificity': 0.49794778, 'f1': 0.49076045, 'auroc': 0.7498847, 'binary_precision': 0.009803922, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9944097, 'binary_f1_score': 0.002580645}
confusion matrix:
       0    1
0  17966  101
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95246536, 'precision': 0.47893372, 'recall': 0.49705684, 'specificity': 0.49705684, 'f1': 0.48782703, 'auroc': 0.75188816, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9941137, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5911  35
1   260   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 18:00:57.107421,epoch time: 0:21:50.696679,used: 0:21:50.696679,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9696122, 'precision': 0.97613347, 'recall': 0.94364214, 'specificity': 0.94364214, 'f1': 0.9584971, 'auroc': 0.98100877, 'binary_precision': 0.98815477, 'binary_recall': 0.8909154, 'binary_specificity': 0.99636894, 'binary_f1_score': 0.93701905}
confusion matrix:
       0      1
0  42258    154
1   1573  12847
---- Validation: 
scalar performance:
{'acc': 0.94770545, 'precision': 0.65803516, 'recall': 0.716813, 'specificity': 0.716813, 'f1': 0.6819917, 'auroc': 0.827691, 'binary_precision': 0.3361793, 'binary_recall': 0.4680535, 'binary_specificity': 0.9655726, 'binary_f1_score': 0.39130434}
confusion matrix:
       0    1
0  17445  622
1    358  315
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91540444, 'precision': 0.5225304, 'recall': 0.5273688, 'specificity': 0.5273688, 'f1': 0.5244484, 'auroc': 0.70756686, 'binary_precision': 0.0846395, 'binary_recall': 0.103846155, 'binary_specificity': 0.9508914, 'binary_f1_score': 0.093264244}
confusion matrix:
      0    1
0  5654  292
1   233   27
early stop counter: 1
val acc:0.9477054476737976, best validation acc: 0.9587513208389282, corresponding to test acc:                         0.9524653553962708 / 0.9524653553962708
after epoch: 2,now: 2024-07-26 18:22:37.839256,epoch time: 0:21:40.731835,used: 0:43:31.428514,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9745918, 'precision': 0.96879613, 'recall': 0.96382, 'specificity': 0.96382, 'f1': 0.9662738, 'auroc': 0.98991114, 'binary_precision': 0.9572204, 'binary_recall': 0.9419516, 'binary_specificity': 0.9856883, 'binary_f1_score': 0.94952464}
confusion matrix:
       0      1
0  41806    607
1    837  13582
---- Validation: 
scalar performance:
{'acc': 0.9402881, 'precision': 0.62375045, 'recall': 0.67577237, 'specificity': 0.67577237, 'f1': 0.6442652, 'auroc': 0.8356693, 'binary_precision': 0.27057612, 'binary_recall': 0.3907875, 'binary_specificity': 0.9607572, 'binary_f1_score': 0.31975684}
confusion matrix:
       0    1
0  17358  709
1    410  263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9505317, 'precision': 0.47889268, 'recall': 0.49604777, 'specificity': 0.49604777, 'f1': 0.4873193, 'auroc': 0.6267607, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99209553, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5899  47
1   260   0
early stop counter: 2
val acc:0.9402881264686584, best validation acc: 0.9587513208389282, corresponding to test acc:                         0.9524653553962708 / 0.9524653553962708
after epoch: 3,now: 2024-07-26 18:44:42.531955,epoch time: 0:22:04.692699,used: 1:05:36.121213,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98166525, 'precision': 0.972685, 'recall': 0.97936136, 'specificity': 0.97936136, 'f1': 0.9759612, 'auroc': 0.9963963, 'binary_precision': 0.9540394, 'binary_recall': 0.9746844, 'binary_specificity': 0.9840383, 'binary_f1_score': 0.96425146}
confusion matrix:
       0      1
0  41737    677
1    365  14053
---- Validation: 
scalar performance:
{'acc': 0.92817503, 'precision': 0.61564654, 'recall': 0.72313523, 'specificity': 0.72313523, 'f1': 0.648181, 'auroc': 0.83169067, 'binary_precision': 0.25055596, 'binary_recall': 0.5022288, 'binary_specificity': 0.9440416, 'binary_f1_score': 0.33432245}
confusion matrix:
       0     1
0  17056  1011
1    335   338
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.91395426, 'precision': 0.50234544, 'recall': 0.5027051, 'specificity': 0.5027051, 'f1': 0.5023794, 'auroc': 0.68991375, 'binary_precision': 0.046357617, 'binary_recall': 0.053846154, 'binary_specificity': 0.9515641, 'binary_f1_score': 0.049822066}
confusion matrix:
      0    1
0  5658  288
1   246   14
early stop counter: 3
val acc:0.9281750321388245, best validation acc: 0.9587513208389282, corresponding to test acc:                         0.9524653553962708 / 0.9524653553962708
after epoch: 4,now: 2024-07-26 19:06:25.085320,epoch time: 0:21:42.553365,used: 1:27:18.674578,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.987595, 'precision': 0.98873556, 'recall': 0.97843826, 'specificity': 0.97843826, 'f1': 0.98344874, 'auroc': 0.9973705, 'binary_precision': 0.9909787, 'binary_recall': 0.95984745, 'binary_specificity': 0.9970291, 'binary_f1_score': 0.97516465}
confusion matrix:
       0      1
0  42286    126
1    579  13841
---- Validation: 
scalar performance:
{'acc': 0.9572572, 'precision': 0.62887114, 'recall': 0.55940115, 'specificity': 0.55940115, 'f1': 0.57909995, 'auroc': 0.8704206, 'binary_precision': 0.28947368, 'binary_recall': 0.1307578, 'binary_specificity': 0.9880445, 'binary_f1_score': 0.18014328}
confusion matrix:
       0    1
0  17851  216
1    585   88
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9542378, 'precision': 0.4789712, 'recall': 0.49798185, 'specificity': 0.49798185, 'f1': 0.4882916, 'auroc': 0.76487947, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5922  24
1   260   0
new oracle model saved
early stop counter: 4
val acc:0.9572572112083435, best validation acc: 0.9587513208389282, corresponding to test acc:                         0.9524653553962708 / 0.9542378187179565
after epoch: 5,now: 2024-07-26 19:27:38.431446,epoch time: 0:21:13.346126,used: 1:48:32.020704,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9905159, 'precision': 0.99269927, 'recall': 0.98227066, 'specificity': 0.98227066, 'f1': 0.98734474, 'auroc': 0.9976748, 'binary_precision': 0.9969923, 'binary_recall': 0.9655316, 'binary_specificity': 0.9990097, 'binary_f1_score': 0.9810097}
confusion matrix:
       0      1
0  42371     42
1    497  13922
---- Validation: 
scalar performance:
{'acc': 0.963127, 'precision': 0.7251065, 'recall': 0.6318263, 'specificity': 0.6318263, 'f1': 0.664877, 'auroc': 0.9013488, 'binary_precision': 0.47680414, 'binary_recall': 0.27488855, 'binary_specificity': 0.98876405, 'binary_f1_score': 0.3487276}
confusion matrix:
       0    1
0  17864  203
1    488  185
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95617145, 'precision': 0.47901195, 'recall': 0.49899092, 'specificity': 0.49899092, 'f1': 0.48879734, 'auroc': 0.7770151, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5934  12
1   260   0
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 19:48:06.325460,epoch time: 0:20:27.894014,used: 2:08:59.914718,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9921699, 'precision': 0.99273163, 'recall': 0.98655933, 'specificity': 0.98655933, 'f1': 0.9895961, 'auroc': 0.99835634, 'binary_precision': 0.9938503, 'binary_recall': 0.9751699, 'binary_specificity': 0.99794877, 'binary_f1_score': 0.9844215}
confusion matrix:
       0      1
0  42327     87
1    358  14060
---- Validation: 
scalar performance:
{'acc': 0.96136606, 'precision': 0.7125232, 'recall': 0.66095424, 'specificity': 0.66095424, 'f1': 0.6827276, 'auroc': 0.89851487, 'binary_precision': 0.44950494, 'binary_recall': 0.33729568, 'binary_specificity': 0.9846128, 'binary_f1_score': 0.38539898}
confusion matrix:
       0    1
0  17789  278
1    446  227
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95649374, 'precision': 0.47901872, 'recall': 0.4991591, 'specificity': 0.4991591, 'f1': 0.4888816, 'auroc': 0.8309549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  10
1   260   0
new oracle model saved
early stop counter: 1
val acc:0.9613660573959351, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.956171452999115 / 0.9564937353134155
after epoch: 7,now: 2024-07-26 20:12:49.722772,epoch time: 0:24:43.397312,used: 2:33:43.312030,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9893722, 'precision': 0.99238527, 'recall': 0.9796061, 'specificity': 0.9796061, 'f1': 0.9857855, 'auroc': 0.9980482, 'binary_precision': 0.9982689, 'binary_recall': 0.9597781, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.9786452}
confusion matrix:
       0      1
0  42388     24
1    580  13840
---- Validation: 
scalar performance:
{'acc': 0.96013874, 'precision': 0.48857638, 'recall': 0.49866733, 'specificity': 0.49866733, 'f1': 0.4911666, 'auroc': 0.8553246, 'binary_precision': 0.013157895, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9958488, 'binary_f1_score': 0.0026702269}
confusion matrix:
       0   1
0  17992  75
1    672   1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95601034, 'precision': 0.47900856, 'recall': 0.49890682, 'specificity': 0.49890682, 'f1': 0.48875523, 'auroc': 0.7071111, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5933  13
1   260   0
early stop counter: 2
val acc:0.960138738155365, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.956171452999115 / 0.9564937353134155
after epoch: 8,now: 2024-07-26 20:34:17.316784,epoch time: 0:21:27.594012,used: 2:55:10.906042,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99046314, 'precision': 0.9927856, 'recall': 0.982051, 'specificity': 0.982051, 'f1': 0.98726976, 'auroc': 0.9985765, 'binary_precision': 0.99734765, 'binary_recall': 0.96497434, 'binary_specificity': 0.9991276, 'binary_f1_score': 0.98089397}
confusion matrix:
       0      1
0  42377     37
1    505  13913
---- Validation: 
scalar performance:
{'acc': 0.9445037, 'precision': 0.6266915, 'recall': 0.6543548, 'specificity': 0.6543548, 'f1': 0.63888085, 'auroc': 0.8459308, 'binary_precision': 0.27811366, 'binary_recall': 0.34175333, 'binary_specificity': 0.9669563, 'binary_f1_score': 0.30666667}
confusion matrix:
       0    1
0  17470  597
1    443  230
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95520467, 'precision': 0.57943654, 'recall': 0.5095203, 'specificity': 0.5095203, 'f1': 0.50922287, 'auroc': 0.8286426, 'binary_precision': 0.2, 'binary_recall': 0.023076924, 'binary_specificity': 0.9959637, 'binary_f1_score': 0.04137931}
confusion matrix:
      0   1
0  5922  24
1   254   6
early stop counter: 3
val acc:0.9445037245750427, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.956171452999115 / 0.9564937353134155
after epoch: 9,now: 2024-07-26 20:59:58.387724,epoch time: 0:25:41.070940,used: 3:20:51.976982,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9952843, 'precision': 0.99561644, 'recall': 0.99192023, 'specificity': 0.99192023, 'f1': 0.9937507, 'auroc': 0.99919695, 'binary_precision': 0.9962828, 'binary_recall': 0.98509014, 'binary_specificity': 0.9987503, 'binary_f1_score': 0.9906549}
confusion matrix:
       0      1
0  42359     53
1    215  14205
---- Validation: 
scalar performance:
{'acc': 0.95592314, 'precision': 0.6612769, 'recall': 0.62308335, 'specificity': 0.62308335, 'f1': 0.63921416, 'auroc': 0.87425953, 'binary_precision': 0.3497053, 'binary_recall': 0.26448736, 'binary_specificity': 0.9816793, 'binary_f1_score': 0.30118442}
confusion matrix:
       0    1
0  17736  331
1    495  178
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95568806, 'precision': 0.4790018, 'recall': 0.49873865, 'specificity': 0.49873865, 'f1': 0.488671, 'auroc': 0.809227, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5931  15
1   260   0
early stop counter: 4
val acc:0.9559231400489807, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.956171452999115 / 0.9564937353134155
after epoch: 10,now: 2024-07-26 21:22:45.532394,epoch time: 0:22:47.144670,used: 3:43:39.121652,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9881757, 'precision': 0.98851323, 'recall': 0.98017395, 'specificity': 0.98017395, 'f1': 0.98425275, 'auroc': 0.99698734, 'binary_precision': 0.98918074, 'binary_recall': 0.96393144, 'binary_specificity': 0.9964164, 'binary_f1_score': 0.9763929}
confusion matrix:
       0      1
0  42263    152
1    520  13897
---- Validation: 
scalar performance:
{'acc': 0.9428495, 'precision': 0.57928264, 'recall': 0.5755328, 'specificity': 0.5755328, 'f1': 0.57734907, 'auroc': 0.8554034, 'binary_precision': 0.1890625, 'binary_recall': 0.17979197, 'binary_specificity': 0.9712736, 'binary_f1_score': 0.18431075}
confusion matrix:
       0    1
0  17548  519
1    552  121
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.478995, 'recall': 0.49857047, 'specificity': 0.49857047, 'f1': 0.48858672, 'auroc': 0.77399915, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5929  17
1   260   0
early stop counter: 5
val acc:0.9428495168685913, best validation acc: 0.9631270170211792, corresponding to test acc:                         0.956171452999115 / 0.9564937353134155
after epoch: 11,now: 2024-07-26 21:44:02.339108,epoch time: 0:21:16.806714,used: 4:04:55.928366,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_39_06_seed_1_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 4:04:55.928366 at 2024-07-26 21:44:02.339108
persisted model performance metric: 

scalar performance:
{'acc': 0.95617145, 'precision': 0.47901195, 'recall': 0.49899092, 'specificity': 0.49899092, 'f1': 0.48879734, 'auroc': 0.7770151, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99798185, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5934  12
1   260   0
oracle model performance metric: 

scalar performance:
{'acc': 0.95649374, 'precision': 0.47901872, 'recall': 0.4991591, 'specificity': 0.4991591, 'f1': 0.4888816, 'auroc': 0.8309549, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9983182, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5936  10
1   260   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/9.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/9.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 449893 KiB |   6932 MiB |    925 TiB |    925 TiB |
|       from large pool | 409091 KiB |   6897 MiB |    922 TiB |    922 TiB |
|       from small pool |  40802 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 449893 KiB |   6932 MiB |    925 TiB |    925 TiB |
|       from large pool | 409091 KiB |   6897 MiB |    922 TiB |    922 TiB |
|       from small pool |  40802 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   6928 MiB |    925 TiB |    925 TiB |
|       from large pool | 407075 KiB |   6894 MiB |    922 TiB |    922 TiB |
|       from small pool |  40676 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7268 MiB |   7286 MiB |  13524 MiB |   6256 MiB |
|       from large pool |   7204 MiB |   7222 MiB |  13446 MiB |   6242 MiB |
|       from small pool |     64 MiB |     64 MiB |     78 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 711322 KiB |    845 MiB | 431016 GiB | 431016 GiB |
|       from large pool | 700925 KiB |    840 MiB | 427548 GiB | 427548 GiB |
|       from small pool |  10397 KiB |     21 MiB |   3468 GiB |   3468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1718    |    2767    |   47959 K  |   47957 K  |
|       from large pool |     187    |     311    |   23327 K  |   23327 K  |
|       from small pool |    1531    |    2579    |   24631 K  |   24630 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1718    |    2767    |   47959 K  |   47957 K  |
|       from large pool |     187    |     311    |   23327 K  |   23327 K  |
|       from small pool |    1531    |    2579    |   24631 K  |   24630 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     146    |     149    |     244    |      98    |
|       from large pool |     114    |     117    |     205    |      91    |
|       from small pool |      32    |      32    |      39    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      68    |     943    |   27974 K  |   27974 K  |
|       from large pool |      31    |     118    |   17891 K  |   17891 K  |
|       from small pool |      37    |     915    |   10083 K  |   10083 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB |    925 TiB |    925 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB |    925 TiB |    925 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB |    925 TiB |    925 TiB |
|       from large pool |  16640 KiB |   6894 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  13524 MiB |  12390 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  13446 MiB |  12362 MiB |
|       from small pool |     50 MiB |     64 MiB |     78 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 431017 GiB | 431017 GiB |
|       from large pool |   3840 KiB |    840 MiB | 427549 GiB | 427549 GiB |
|       from small pool |      0 KiB |     26 MiB |   3468 GiB |   3468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   47959 K  |   47959 K  |
|       from large pool |       2    |     311    |   23327 K  |   23327 K  |
|       from small pool |       0    |    2579    |   24631 K  |   24631 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   47959 K  |   47959 K  |
|       from large pool |       2    |     311    |   23327 K  |   23327 K  |
|       from small pool |       0    |    2579    |   24631 K  |   24631 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     244    |     189    |
|       from large pool |      30    |     117    |     205    |     175    |
|       from small pool |      25    |      32    |      39    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     943    |   27974 K  |   27974 K  |
|       from large pool |       2    |     118    |   17891 K  |   17891 K  |
|       from small pool |       0    |     915    |   10083 K  |   10083 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB |    925 TiB |    925 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB |    925 TiB |    925 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB |    925 TiB |    925 TiB |
|       from large pool |  16640 KiB |   6894 MiB |    922 TiB |    922 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  13524 MiB |  12390 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  13446 MiB |  12362 MiB |
|       from small pool |     50 MiB |     64 MiB |     78 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 431017 GiB | 431017 GiB |
|       from large pool |   3840 KiB |    840 MiB | 427549 GiB | 427549 GiB |
|       from small pool |      0 KiB |     26 MiB |   3468 GiB |   3468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   47959 K  |   47959 K  |
|       from large pool |       2    |     311    |   23327 K  |   23327 K  |
|       from small pool |       0    |    2579    |   24631 K  |   24631 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   47959 K  |   47959 K  |
|       from large pool |       2    |     311    |   23327 K  |   23327 K  |
|       from small pool |       0    |    2579    |   24631 K  |   24631 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     244    |     189    |
|       from large pool |      30    |     117    |     205    |     175    |
|       from small pool |      25    |      32    |      39    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     943    |   27974 K  |   27974 K  |
|       from large pool |       2    |     118    |   17891 K  |   17891 K  |
|       from small pool |       0    |     915    |   10083 K  |   10083 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997

 Experiment start at: 2024-07-26 21:51:56.680554
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9609114, 'precision': 0.9703958, 'recall': 0.92918515, 'specificity': 0.92918515, 'f1': 0.94740963, 'auroc': 0.97049344, 'binary_precision': 0.9879518, 'binary_recall': 0.8621305, 'binary_specificity': 0.9962398, 'binary_f1_score': 0.92076266}
confusion matrix:
       0      1
0  42126    159
1   2085  13038
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.90635484, 'precision': 0.57124454, 'recall': 0.68983245, 'specificity': 0.68983245, 'f1': 0.59453446, 'auroc': 0.7959826, 'binary_precision': 0.1615925, 'binary_recall': 0.45847178, 'binary_specificity': 0.9211931, 'binary_f1_score': 0.23896104}
confusion matrix:
       0     1
0  16739  1432
1    326   276
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9145696, 'precision': 0.58455473, 'recall': 0.66013277, 'specificity': 0.66013277, 'f1': 0.60668284, 'auroc': 0.7924148, 'binary_precision': 0.19496855, 'binary_recall': 0.38429752, 'binary_specificity': 0.935968, 'binary_f1_score': 0.25869262}
confusion matrix:
      0    1
0  5613  384
1   149   93
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 22:13:49.305035,epoch time: 0:21:52.624481,used: 0:21:52.624481,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.97550863, 'precision': 0.97814584, 'recall': 0.9585067, 'specificity': 0.9585067, 'f1': 0.9677833, 'auroc': 0.9919559, 'binary_precision': 0.983358, 'binary_recall': 0.9225935, 'binary_specificity': 0.9944199, 'binary_f1_score': 0.9520071}
confusion matrix:
       0      1
0  42057    236
1   1170  13945
---- Validation: 
scalar performance:
{'acc': 0.9281415, 'precision': 0.59361356, 'recall': 0.690647, 'specificity': 0.690647, 'f1': 0.6213577, 'auroc': 0.8112995, 'binary_precision': 0.20659858, 'binary_recall': 0.43687707, 'binary_specificity': 0.94441694, 'binary_f1_score': 0.2805333}
confusion matrix:
       0     1
0  17161  1010
1    339   263
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.90463215, 'precision': 0.5214241, 'recall': 0.53599906, 'specificity': 0.53599906, 'f1': 0.5247488, 'auroc': 0.6923925, 'binary_precision': 0.07875895, 'binary_recall': 0.13636364, 'binary_specificity': 0.9356345, 'binary_f1_score': 0.09984871}
confusion matrix:
      0    1
0  5611  386
1   209   33
better model found
persisted
after epoch: 2,now: 2024-07-26 22:36:34.862105,epoch time: 0:22:45.557070,used: 0:44:38.181551,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98587304, 'precision': 0.98743415, 'recall': 0.976099, 'specificity': 0.976099, 'f1': 0.981588, 'auroc': 0.9961891, 'binary_precision': 0.9906087, 'binary_recall': 0.955438, 'binary_specificity': 0.99675995, 'binary_f1_score': 0.97270554}
confusion matrix:
       0      1
0  42146    137
1    674  14451
---- Validation: 
scalar performance:
{'acc': 0.962233, 'precision': 0.637239, 'recall': 0.5629057, 'specificity': 0.5629057, 'f1': 0.58426243, 'auroc': 0.8308017, 'binary_precision': 0.30258304, 'binary_recall': 0.13621262, 'binary_specificity': 0.9895988, 'binary_f1_score': 0.18785796}
confusion matrix:
       0    1
0  17982  189
1    520   82
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95656353, 'precision': 0.4805153, 'recall': 0.49758214, 'specificity': 0.49758214, 'f1': 0.48889983, 'auroc': 0.7542204, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9951643, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5968  29
1   242   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 22:56:45.314866,epoch time: 0:20:10.452761,used: 1:04:48.634312,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.989984, 'precision': 0.99104214, 'recall': 0.98310995, 'specificity': 0.98310995, 'f1': 0.9869891, 'auroc': 0.9966614, 'binary_precision': 0.99321806, 'binary_recall': 0.96858466, 'binary_specificity': 0.99763525, 'binary_f1_score': 0.98074675}
confusion matrix:
       0      1
0  42188    100
1    475  14645
---- Validation: 
scalar performance:
{'acc': 0.95418954, 'precision': 0.63400894, 'recall': 0.6374495, 'specificity': 0.6374495, 'f1': 0.63570374, 'auroc': 0.81378627, 'binary_precision': 0.29126215, 'binary_recall': 0.29900333, 'binary_specificity': 0.97589564, 'binary_f1_score': 0.29508197}
confusion matrix:
       0    1
0  17733  438
1    422  180
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9482289, 'precision': 0.48035076, 'recall': 0.49324661, 'specificity': 0.49324661, 'f1': 0.48671326, 'auroc': 0.76443404, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.98649323, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5916  81
1   242   0
early stop counter: 1
val acc:0.9541895389556885, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9565635323524475 / 0.9565635323524475
after epoch: 4,now: 2024-07-26 23:16:37.086542,epoch time: 0:19:51.771676,used: 1:24:40.405988,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98022926, 'precision': 0.98495543, 'recall': 0.9641855, 'specificity': 0.9641855, 'f1': 0.97397476, 'auroc': 0.9904889, 'binary_precision': 0.994274, 'binary_recall': 0.9302864, 'binary_specificity': 0.9980846, 'binary_f1_score': 0.9612165}
confusion matrix:
       0      1
0  42208     81
1   1054  14065
---- Validation: 
scalar performance:
{'acc': 0.9587706, 'precision': 0.664641, 'recall': 0.65828604, 'specificity': 0.65828604, 'f1': 0.6613921, 'auroc': 0.868155, 'binary_precision': 0.35121107, 'binary_recall': 0.3372093, 'binary_specificity': 0.9793627, 'binary_f1_score': 0.34406778}
confusion matrix:
       0    1
0  17796  375
1    399  203
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95207566, 'precision': 0.48042706, 'recall': 0.49524763, 'specificity': 0.49524763, 'f1': 0.48772478, 'auroc': 0.7881484, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99049526, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5940  57
1   242   0
early stop counter: 2
val acc:0.9587705731391907, best validation acc: 0.9622330069541931, corresponding to test acc:                         0.9565635323524475 / 0.9565635323524475
after epoch: 5,now: 2024-07-26 23:36:28.573013,epoch time: 0:19:51.486471,used: 1:44:31.892459,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99257946, 'precision': 0.9908499, 'recall': 0.99001485, 'specificity': 0.99001485, 'f1': 0.9904314, 'auroc': 0.99869376, 'binary_precision': 0.98720497, 'binary_recall': 0.98459405, 'binary_specificity': 0.99543566, 'binary_f1_score': 0.9858978}
confusion matrix:
       0      1
0  42091    193
1    233  14891
---- Validation: 
scalar performance:
{'acc': 0.96676075, 'precision': 0.721807, 'recall': 0.6270793, 'specificity': 0.6270793, 'f1': 0.66026616, 'auroc': 0.88602704, 'binary_precision': 0.46764705, 'binary_recall': 0.2641196, 'binary_specificity': 0.99003905, 'binary_f1_score': 0.3375796}
confusion matrix:
       0    1
0  17990  181
1    443  159
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9589678, 'precision': 0.48056224, 'recall': 0.49883276, 'specificity': 0.49883276, 'f1': 0.48952708, 'auroc': 0.815011, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9976655, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5983  14
1   242   0
new oracle model saved
better model found
persisted
after epoch: 6,now: 2024-07-26 23:56:26.129522,epoch time: 0:19:57.556509,used: 2:04:29.448968,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98723173, 'precision': 0.9893162, 'recall': 0.9777604, 'specificity': 0.9777604, 'f1': 0.98335373, 'auroc': 0.9970259, 'binary_precision': 0.9935515, 'binary_recall': 0.9577437, 'binary_specificity': 0.99777704, 'binary_f1_score': 0.9753191}
confusion matrix:
       0      1
0  42192     94
1    639  14483
---- Validation: 
scalar performance:
{'acc': 0.9615405, 'precision': 0.62952906, 'recall': 0.5617449, 'specificity': 0.5617449, 'f1': 0.5817822, 'auroc': 0.87938154, 'binary_precision': 0.28723404, 'binary_recall': 0.1345515, 'binary_specificity': 0.9889384, 'binary_f1_score': 0.18325792}
confusion matrix:
       0    1
0  17970  201
1    521   81
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95271677, 'precision': 0.4804397, 'recall': 0.49558112, 'specificity': 0.49558112, 'f1': 0.487893, 'auroc': 0.8298812, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99116224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5944  53
1   242   0
early stop counter: 1
val acc:0.9615405201911926, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9589678049087524 / 0.9589678049087524
after epoch: 7,now: 2024-07-27 00:16:30.180936,epoch time: 0:20:04.051414,used: 2:24:33.500382,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99278843, 'precision': 0.9941937, 'recall': 0.98722386, 'specificity': 0.98722386, 'f1': 0.9906421, 'auroc': 0.9989562, 'binary_precision': 0.9970932, 'binary_recall': 0.9754646, 'binary_specificity': 0.99898314, 'binary_f1_score': 0.98616034}
confusion matrix:
       0      1
0  42244     43
1    371  14750
---- Validation: 
scalar performance:
{'acc': 0.96447027, 'precision': 0.68252563, 'recall': 0.5921681, 'specificity': 0.5921681, 'f1': 0.6207549, 'auroc': 0.9016557, 'binary_precision': 0.39130434, 'binary_recall': 0.19435216, 'binary_specificity': 0.98998404, 'binary_f1_score': 0.25971144}
confusion matrix:
       0    1
0  17989  182
1    485  117
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9544799, 'precision': 0.4804744, 'recall': 0.49649826, 'specificity': 0.49649826, 'f1': 0.4883549, 'auroc': 0.81255746, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9929965, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5955  42
1   242   0
early stop counter: 2
val acc:0.9644702672958374, best validation acc: 0.9667607545852661, corresponding to test acc:                         0.9589678049087524 / 0.9589678049087524
after epoch: 8,now: 2024-07-27 00:36:24.244454,epoch time: 0:19:54.063518,used: 2:44:27.563900,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_51_56_seed_2_23069997
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
slurmstepd: error: *** JOB 23069997 ON supergpu03 CANCELLED AT 2024-07-27T00:53:59 ***
