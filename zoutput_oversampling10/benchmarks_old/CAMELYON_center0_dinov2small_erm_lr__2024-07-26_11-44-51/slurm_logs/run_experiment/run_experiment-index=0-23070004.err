Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 12:35:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/0.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=0
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004

 Experiment start at: 2024-07-26 12:40:22.667568
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.82419354, 'precision': 0.80187094, 'recall': 0.70359045, 'specificity': 0.70359045, 'f1': 0.7304503, 'auroc': 0.8680239, 'binary_precision': 0.7697709, 'binary_recall': 0.45443425, 'binary_specificity': 0.9527466, 'binary_f1_score': 0.57148963}
confusion matrix:
       0     1
0  40325  2000
1   8028  6687
---- Validation: 
scalar performance:
{'acc': 0.5406024, 'precision': 0.5186338, 'recall': 0.64065427, 'specificity': 0.64065427, 'f1': 0.39590895, 'auroc': 0.71911067, 'binary_precision': 0.05373101, 'binary_recall': 0.748056, 'binary_specificity': 0.53325254, 'binary_f1_score': 0.10026055}
confusion matrix:
      0     1
0  9678  8471
1   162   481
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.47091722, 'precision': 0.5193182, 'recall': 0.6195023, 'specificity': 0.6195023, 'f1': 0.3666643, 'auroc': 0.6863668, 'binary_precision': 0.058993638, 'binary_recall': 0.7816092, 'binary_specificity': 0.45739537, 'binary_f1_score': 0.10970691}
confusion matrix:
      0     1
0  2743  3254
1    57   204
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 13:06:29.616056,epoch time: 0:26:06.948488,used: 0:26:06.948488,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.90520686, 'precision': 0.90959555, 'recall': 0.8368778, 'specificity': 0.8368778, 'f1': 0.86489624, 'auroc': 0.91450703, 'binary_precision': 0.9168084, 'binary_recall': 0.69570535, 'binary_specificity': 0.9780503, 'binary_f1_score': 0.7910984}
confusion matrix:
       0      1
0  41395    929
1   4478  10238
---- Validation: 
scalar performance:
{'acc': 0.74233717, 'precision': 0.51072145, 'recall': 0.5605817, 'specificity': 0.5605817, 'f1': 0.46922088, 'auroc': 0.5652684, 'binary_precision': 0.050331976, 'binary_recall': 0.36547434, 'binary_specificity': 0.755689, 'binary_f1_score': 0.088478915}
confusion matrix:
       0     1
0  13715  4434
1    408   235
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6196868, 'precision': 0.5104366, 'recall': 0.5615317, 'specificity': 0.5615317, 'f1': 0.4287483, 'auroc': 0.5882373, 'binary_precision': 0.05464481, 'binary_recall': 0.49808428, 'binary_specificity': 0.62497914, 'binary_f1_score': 0.09848485}
confusion matrix:
      0     1
0  3748  2249
1   131   130
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 13:32:22.739341,epoch time: 0:25:53.123285,used: 0:52:00.071773,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9322055, 'precision': 0.9434259, 'recall': 0.87835634, 'specificity': 0.87835634, 'f1': 0.9048178, 'auroc': 0.92596173, 'binary_precision': 0.9624829, 'binary_recall': 0.7671084, 'binary_specificity': 0.98960423, 'binary_f1_score': 0.85376084}
confusion matrix:
       0      1
0  41885    440
1   3427  11288
---- Validation: 
scalar performance:
{'acc': 0.9537037, 'precision': 0.48706162, 'recall': 0.49524632, 'specificity': 0.49524632, 'f1': 0.49043873, 'auroc': 0.6119853, 'binary_precision': 0.008658009, 'binary_recall': 0.00311042, 'binary_specificity': 0.98738223, 'binary_f1_score': 0.0045766593}
confusion matrix:
       0    1
0  17920  229
1    641    2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9547779, 'precision': 0.47907314, 'recall': 0.49816576, 'specificity': 0.49816576, 'f1': 0.48843294, 'auroc': 0.63903725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5975  22
1   261   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 13:58:26.101397,epoch time: 0:26:03.362056,used: 1:18:03.433829,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.88318723, 'precision': 0.86603725, 'recall': 0.8169439, 'specificity': 0.8169439, 'f1': 0.8370006, 'auroc': 0.8900743, 'binary_precision': 0.8364959, 'binary_recall': 0.68010056, 'binary_specificity': 0.95378727, 'binary_f1_score': 0.75023425}
confusion matrix:
       0      1
0  40370   1956
1   4707  10007
---- Validation: 
scalar performance:
{'acc': 0.92092377, 'precision': 0.4857522, 'recall': 0.48127592, 'specificity': 0.48127592, 'f1': 0.48341563, 'auroc': 0.59217554, 'binary_precision': 0.007017544, 'binary_recall': 0.00933126, 'binary_specificity': 0.95322055, 'binary_f1_score': 0.008010682}
confusion matrix:
       0    1
0  17300  849
1    637    6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89597315, 'precision': 0.49913526, 'recall': 0.4986334, 'specificity': 0.4986334, 'f1': 0.4973051, 'auroc': 0.6352825, 'binary_precision': 0.04009434, 'binary_recall': 0.0651341, 'binary_specificity': 0.9321327, 'binary_f1_score': 0.049635034}
confusion matrix:
      0    1
0  5590  407
1   244   17
early stop counter: 1
val acc:0.9209237694740295, best validation acc: 0.9537037014961243, corresponding to test acc:                         0.9547778964042664 / 0.9547778964042664
after epoch: 4,now: 2024-07-26 14:33:21.841103,epoch time: 0:34:55.739706,used: 1:52:59.173535,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9200386, 'precision': 0.9230672, 'recall': 0.86392665, 'specificity': 0.86392665, 'f1': 0.88814247, 'auroc': 0.9163579, 'binary_precision': 0.9282523, 'binary_recall': 0.74796194, 'binary_specificity': 0.9798913, 'binary_f1_score': 0.8284113}
confusion matrix:
       0      1
0  41469    851
1   3710  11010
---- Validation: 
scalar performance:
{'acc': 0.8889421, 'precision': 0.5186412, 'recall': 0.5457245, 'specificity': 0.5457245, 'f1': 0.5196572, 'auroc': 0.6417409, 'binary_precision': 0.06818182, 'binary_recall': 0.17729394, 'binary_specificity': 0.91415507, 'binary_f1_score': 0.09848812}
confusion matrix:
       0     1
0  16591  1558
1    529   114
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8486737, 'precision': 0.5046469, 'recall': 0.5124334, 'specificity': 0.5124334, 'f1': 0.49594665, 'auroc': 0.6393708, 'binary_precision': 0.049868766, 'binary_recall': 0.14559387, 'binary_specificity': 0.879273, 'binary_f1_score': 0.074291304}
confusion matrix:
      0    1
0  5273  724
1   223   38
early stop counter: 2
val acc:0.8889421224594116, best validation acc: 0.9537037014961243, corresponding to test acc:                         0.9547778964042664 / 0.9547778964042664
after epoch: 5,now: 2024-07-26 15:05:23.833438,epoch time: 0:32:01.992335,used: 2:25:01.165870,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9262973, 'precision': 0.9471188, 'recall': 0.86179435, 'specificity': 0.86179435, 'f1': 0.89426875, 'auroc': 0.92728764, 'binary_precision': 0.9808783, 'binary_recall': 0.7285268, 'binary_specificity': 0.9950619, 'binary_f1_score': 0.8360758}
confusion matrix:
       0      1
0  42115    209
1   3995  10721
---- Validation: 
scalar performance:
{'acc': 0.95918477, 'precision': 0.482778, 'recall': 0.49658382, 'specificity': 0.49658382, 'f1': 0.4895836, 'auroc': 0.60836995, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99316764, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  18025  124
1    643    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95270056, 'precision': 0.5048178, 'recall': 0.50074655, 'specificity': 0.50074655, 'f1': 0.49455142, 'auroc': 0.6429671, 'binary_precision': 0.051282052, 'binary_recall': 0.007662835, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.013333333}
confusion matrix:
      0   1
0  5960  37
1   259   2
better model found
persisted
after epoch: 6,now: 2024-07-26 15:32:41.681277,epoch time: 0:27:17.847839,used: 2:52:19.013709,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.93963885, 'precision': 0.9440775, 'recall': 0.8962877, 'specificity': 0.8962877, 'f1': 0.9168634, 'auroc': 0.94674385, 'binary_precision': 0.95196474, 'binary_recall': 0.8067278, 'binary_specificity': 0.9858476, 'binary_f1_score': 0.8733493}
confusion matrix:
       0      1
0  41726    599
1   2844  11871
---- Validation: 
scalar performance:
{'acc': 0.7934759, 'precision': 0.526904, 'recall': 0.6320603, 'specificity': 0.6320603, 'f1': 0.5073784, 'auroc': 0.6704185, 'binary_precision': 0.07706374, 'binary_recall': 0.45878693, 'binary_specificity': 0.8053336, 'binary_f1_score': 0.13196154}
confusion matrix:
       0     1
0  14616  3533
1    348   295
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7957814, 'precision': 0.52771384, 'recall': 0.60943496, 'specificity': 0.60943496, 'f1': 0.513187, 'auroc': 0.683895, 'binary_precision': 0.08624899, 'binary_recall': 0.40613025, 'binary_specificity': 0.81273973, 'binary_f1_score': 0.14228189}
confusion matrix:
      0     1
0  4874  1123
1   155   106
early stop counter: 1
val acc:0.7934759259223938, best validation acc: 0.9591847658157349, corresponding to test acc:                         0.9527005553245544 / 0.9547778964042664
after epoch: 7,now: 2024-07-26 15:58:55.202438,epoch time: 0:26:13.521161,used: 3:18:32.534870,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.92911994, 'precision': 0.9516914, 'recall': 0.86548734, 'specificity': 0.86548734, 'f1': 0.8983264, 'auroc': 0.9477151, 'binary_precision': 0.9882902, 'binary_recall': 0.7339992, 'binary_specificity': 0.99697554, 'binary_f1_score': 0.84237206}
confusion matrix:
       0      1
0  42194    128
1   3915  10803
---- Validation: 
scalar performance:
{'acc': 0.8749468, 'precision': 0.5250622, 'recall': 0.5729815, 'specificity': 0.5729815, 'f1': 0.526271, 'auroc': 0.6502327, 'binary_precision': 0.07893439, 'binary_recall': 0.2488336, 'binary_specificity': 0.8971293, 'binary_f1_score': 0.119850196}
confusion matrix:
       0     1
0  16282  1867
1    483   160
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8478747, 'precision': 0.528566, 'recall': 0.58347756, 'specificity': 0.58347756, 'f1': 0.5279024, 'auroc': 0.7040678, 'binary_precision': 0.09112426, 'binary_recall': 0.29501915, 'binary_specificity': 0.87193596, 'binary_f1_score': 0.1392405}
confusion matrix:
      0    1
0  5229  768
1   184   77
early stop counter: 2
val acc:0.8749467730522156, best validation acc: 0.9591847658157349, corresponding to test acc:                         0.9527005553245544 / 0.9547778964042664
after epoch: 8,now: 2024-07-26 16:25:07.059277,epoch time: 0:26:11.856839,used: 3:44:44.391709,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95131487, 'precision': 0.9593181, 'recall': 0.9130106, 'specificity': 0.9130106, 'f1': 0.9331742, 'auroc': 0.9557937, 'binary_precision': 0.97365916, 'binary_recall': 0.8338656, 'binary_specificity': 0.99215555, 'binary_f1_score': 0.8983566}
confusion matrix:
       0      1
0  41991    332
1   2445  12272
---- Validation: 
scalar performance:
{'acc': 0.7654853, 'precision': 0.5236687, 'recall': 0.6280699, 'specificity': 0.6280699, 'f1': 0.4938154, 'auroc': 0.64046025, 'binary_precision': 0.070515744, 'binary_recall': 0.4805599, 'binary_specificity': 0.7755799, 'binary_f1_score': 0.12298508}
confusion matrix:
       0     1
0  14076  4073
1    334   309
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6973474, 'precision': 0.53278446, 'recall': 0.67717767, 'specificity': 0.67717767, 'f1': 0.48435524, 'auroc': 0.7220539, 'binary_precision': 0.08658228, 'binary_recall': 0.6551724, 'binary_specificity': 0.6991829, 'binary_f1_score': 0.1529517}
confusion matrix:
      0     1
0  4193  1804
1    90   171
early stop counter: 3
val acc:0.7654852867126465, best validation acc: 0.9591847658157349, corresponding to test acc:                         0.9527005553245544 / 0.9547778964042664
after epoch: 9,now: 2024-07-26 16:50:48.190929,epoch time: 0:25:41.131652,used: 4:10:25.523361,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95147264, 'precision': 0.96577114, 'recall': 0.908451, 'specificity': 0.908451, 'f1': 0.9326542, 'auroc': 0.95473295, 'binary_precision': 0.9907172, 'binary_recall': 0.81957185, 'binary_specificity': 0.9973302, 'binary_f1_score': 0.89705443}
confusion matrix:
       0      1
0  42212    113
1   2655  12060
---- Validation: 
scalar performance:
{'acc': 0.9100681, 'precision': 0.49439266, 'recall': 0.49065685, 'specificity': 0.49065685, 'f1': 0.49134967, 'auroc': 0.63262707, 'binary_precision': 0.023657871, 'binary_recall': 0.04043546, 'binary_specificity': 0.9408783, 'binary_f1_score': 0.029850747}
confusion matrix:
       0     1
0  17076  1073
1    617    26
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.899968, 'precision': 0.515493, 'recall': 0.5245381, 'specificity': 0.5245381, 'f1': 0.5172736, 'auroc': 0.7141796, 'binary_precision': 0.07058824, 'binary_recall': 0.11494253, 'binary_specificity': 0.9341337, 'binary_f1_score': 0.087463565}
confusion matrix:
      0    1
0  5602  395
1   231   30
early stop counter: 4
val acc:0.9100680947303772, best validation acc: 0.9591847658157349, corresponding to test acc:                         0.9527005553245544 / 0.9547778964042664
after epoch: 10,now: 2024-07-26 17:16:34.032367,epoch time: 0:25:45.841438,used: 4:36:11.364799,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.94037515, 'precision': 0.94732225, 'recall': 0.8954761, 'specificity': 0.8954761, 'f1': 0.9175432, 'auroc': 0.9410795, 'binary_precision': 0.9595451, 'binary_recall': 0.80271834, 'binary_specificity': 0.9882339, 'binary_f1_score': 0.87415355}
confusion matrix:
       0      1
0  41827    498
1   2903  11812
---- Validation: 
scalar performance:
{'acc': 0.9020328, 'precision': 0.48349053, 'recall': 0.46999565, 'specificity': 0.46999565, 'f1': 0.47640428, 'auroc': 0.49971938, 'binary_precision': 0.0033167496, 'binary_recall': 0.00622084, 'binary_specificity': 0.9337705, 'binary_f1_score': 0.004326663}
confusion matrix:
       0     1
0  16947  1202
1    639     4
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8668904, 'precision': 0.5102068, 'recall': 0.5237705, 'specificity': 0.5237705, 'f1': 0.5069204, 'auroc': 0.6309061, 'binary_precision': 0.06, 'binary_recall': 0.14942528, 'binary_specificity': 0.89811575, 'binary_f1_score': 0.08562019}
confusion matrix:
      0    1
0  5386  611
1   222   39
early stop counter: 5
val acc:0.9020327925682068, best validation acc: 0.9591847658157349, corresponding to test acc:                         0.9527005553245544 / 0.9547778964042664
after epoch: 11,now: 2024-07-26 17:42:55.095306,epoch time: 0:26:21.062939,used: 5:02:32.427738,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_22_seed_0_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 5:02:32.427738 at 2024-07-26 17:42:55.095306
persisted model performance metric: 

scalar performance:
{'acc': 0.95270056, 'precision': 0.5048178, 'recall': 0.50074655, 'specificity': 0.50074655, 'f1': 0.49455142, 'auroc': 0.6429671, 'binary_precision': 0.051282052, 'binary_recall': 0.007662835, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.013333333}
confusion matrix:
      0   1
0  5960  37
1   259   2
oracle model performance metric: 

scalar performance:
{'acc': 0.9547779, 'precision': 0.47907314, 'recall': 0.49816576, 'specificity': 0.49816576, 'f1': 0.48843294, 'auroc': 0.63903725, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9963315, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5975  22
1   261   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/0.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 457596 KiB |   2003 MiB | 429582 GiB | 429582 GiB |
|       from large pool | 415909 KiB |   1971 MiB | 424147 GiB | 424147 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5434 GiB |   5434 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 457596 KiB |   2003 MiB | 429582 GiB | 429582 GiB |
|       from large pool | 415909 KiB |   1971 MiB | 424147 GiB | 424147 GiB |
|       from small pool |  41687 KiB |     61 MiB |   5434 GiB |   5434 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB | 429344 GiB | 429343 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 423919 GiB | 423919 GiB |
|       from small pool |  40679 KiB |     60 MiB |   5424 GiB |   5424 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2272 MiB |   2272 MiB |   2272 MiB |      0 B   |
|       from large pool |   2202 MiB |   2202 MiB |   2202 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 296067 KiB | 361588 KiB | 334706 GiB | 334705 GiB |
|       from large pool | 286555 KiB | 357150 KiB | 329019 GiB | 329019 GiB |
|       from small pool |   9512 KiB |  14571 KiB |   5686 GiB |   5686 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8115    |   81332 K  |   81329 K  |
|       from large pool |     187    |     311    |   39621 K  |   39621 K  |
|       from small pool |    3301    |    7927    |   41711 K  |   41707 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8115    |   81332 K  |   81329 K  |
|       from large pool |     187    |     311    |   39621 K  |   39621 K  |
|       from small pool |    3301    |    7927    |   41711 K  |   41707 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      58    |    3606    |   42752 K  |   42752 K  |
|       from large pool |      26    |      89    |   26631 K  |   26631 K  |
|       from small pool |      32    |    3580    |   16120 K  |   16120 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 429582 GiB | 429582 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 424147 GiB | 424147 GiB |
|       from small pool |      0 KiB |     61 MiB |   5434 GiB |   5434 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 429582 GiB | 429582 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 424147 GiB | 424147 GiB |
|       from small pool |      0 KiB |     61 MiB |   5434 GiB |   5434 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 429344 GiB | 429344 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 423919 GiB | 423919 GiB |
|       from small pool |      0 KiB |     60 MiB |   5424 GiB |   5424 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 753664 KiB |   2272 MiB |   2272 MiB |   1536 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  51200 KiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB | 334706 GiB | 334706 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 329019 GiB | 329019 GiB |
|       from small pool |      0 KiB |  21494 KiB |   5686 GiB |   5686 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |   81332 K  |   81332 K  |
|       from large pool |       2    |     311    |   39621 K  |   39621 K  |
|       from small pool |       0    |    7927    |   41711 K  |   41711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |   81332 K  |   81332 K  |
|       from large pool |       2    |     311    |   39621 K  |   39621 K  |
|       from small pool |       0    |    7927    |   41711 K  |   41711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     127    |     127    |      71    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   42753 K  |   42753 K  |
|       from large pool |       3    |      89    |   26631 K  |   26631 K  |
|       from small pool |       0    |    3580    |   16122 K  |   16122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 429582 GiB | 429582 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 424147 GiB | 424147 GiB |
|       from small pool |      0 KiB |     61 MiB |   5434 GiB |   5434 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 429582 GiB | 429582 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 424147 GiB | 424147 GiB |
|       from small pool |      0 KiB |     61 MiB |   5434 GiB |   5434 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 429344 GiB | 429344 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 423919 GiB | 423919 GiB |
|       from small pool |      0 KiB |     60 MiB |   5424 GiB |   5424 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 753664 KiB |   2272 MiB |   2272 MiB |   1536 MiB |
|       from large pool | 702464 KiB |   2202 MiB |   2202 MiB |   1516 MiB |
|       from small pool |  51200 KiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB | 334706 GiB | 334706 GiB |
|       from large pool |  24320 KiB | 392029 KiB | 329019 GiB | 329019 GiB |
|       from small pool |      0 KiB |  21494 KiB |   5686 GiB |   5686 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |   81332 K  |   81332 K  |
|       from large pool |       2    |     311    |   39621 K  |   39621 K  |
|       from small pool |       0    |    7927    |   41711 K  |   41711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |   81332 K  |   81332 K  |
|       from large pool |       2    |     311    |   39621 K  |   39621 K  |
|       from small pool |       0    |    7927    |   41711 K  |   41711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      56    |     127    |     127    |      71    |
|       from large pool |      31    |      92    |      92    |      61    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   42753 K  |   42753 K  |
|       from large pool |       3    |      89    |   26631 K  |   26631 K  |
|       from small pool |       0    |    3580    |   16122 K  |   16122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004

 Experiment start at: 2024-07-26 17:49:50.739959
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9173177, 'precision': 0.93577874, 'recall': 0.84542185, 'specificity': 0.84542185, 'f1': 0.8790651, 'auroc': 0.9234177, 'binary_precision': 0.9649794, 'binary_recall': 0.6994729, 'binary_specificity': 0.9913708, 'binary_f1_score': 0.8110499}
confusion matrix:
       0      1
0  42048    366
1   4333  10085
---- Validation: 
scalar performance:
{'acc': 0.8805763, 'precision': 0.55283815, 'recall': 0.65267223, 'specificity': 0.65267223, 'f1': 0.5660955, 'auroc': 0.6806992, 'binary_precision': 0.12967345, 'binary_recall': 0.40713224, 'binary_specificity': 0.8982122, 'binary_f1_score': 0.19669779}
confusion matrix:
       0     1
0  16228  1839
1    399   274
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89606833, 'precision': 0.54018044, 'recall': 0.5742865, 'specificity': 0.5742865, 'f1': 0.5485355, 'auroc': 0.728011, 'binary_precision': 0.11576846, 'binary_recall': 0.22307692, 'binary_specificity': 0.92549616, 'binary_f1_score': 0.15243103}
confusion matrix:
      0    1
0  5503  443
1   202   58
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 18:15:56.984560,epoch time: 0:26:06.244601,used: 0:26:06.244601,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9247079, 'precision': 0.9404615, 'recall': 0.8600692, 'specificity': 0.8600692, 'f1': 0.8912071, 'auroc': 0.9332347, 'binary_precision': 0.9659864, 'binary_recall': 0.72886175, 'binary_specificity': 0.9912767, 'binary_f1_score': 0.8308361}
confusion matrix:
       0      1
0  42045    370
1   3909  10508
---- Validation: 
scalar performance:
{'acc': 0.68884736, 'precision': 0.520014, 'recall': 0.6247635, 'specificity': 0.6247635, 'f1': 0.46249786, 'auroc': 0.69283354, 'binary_precision': 0.063325435, 'binary_recall': 0.5557206, 'binary_specificity': 0.6938064, 'binary_f1_score': 0.113695085}
confusion matrix:
       0     1
0  12535  5532
1    299   374
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6430873, 'precision': 0.5276791, 'recall': 0.66110444, 'specificity': 0.66110444, 'f1': 0.4563819, 'auroc': 0.72585905, 'binary_precision': 0.07665656, 'binary_recall': 0.6807692, 'binary_specificity': 0.6414396, 'binary_f1_score': 0.1377968}
confusion matrix:
      0     1
0  3814  2132
1    83   177
early stop counter: 1
val acc:0.6888473629951477, best validation acc: 0.8805763125419617, corresponding to test acc:                         0.8960683345794678 / 0.8960683345794678
after epoch: 2,now: 2024-07-26 18:41:49.674180,epoch time: 0:25:52.689620,used: 0:51:58.934221,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9305849, 'precision': 0.92712367, 'recall': 0.88568616, 'specificity': 0.88568616, 'f1': 0.90382767, 'auroc': 0.9380712, 'binary_precision': 0.920968, 'binary_recall': 0.7945481, 'binary_specificity': 0.9768242, 'binary_f1_score': 0.85309994}
confusion matrix:
       0      1
0  41432    983
1   2962  11455
---- Validation: 
scalar performance:
{'acc': 0.5279082, 'precision': 0.51167697, 'recall': 0.5842124, 'specificity': 0.5842124, 'f1': 0.38535386, 'auroc': 0.6644701, 'binary_precision': 0.04799823, 'binary_recall': 0.6448737, 'binary_specificity': 0.5235512, 'binary_f1_score': 0.08934637}
confusion matrix:
      0     1
0  9459  8608
1   239   434
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.34788913, 'precision': 0.5183656, 'recall': 0.59900063, 'specificity': 0.59900063, 'f1': 0.29465017, 'auroc': 0.7004179, 'binary_precision': 0.053525113, 'binary_recall': 0.8730769, 'binary_specificity': 0.32492432, 'binary_f1_score': 0.100866474}
confusion matrix:
      0     1
0  1932  4014
1    33   227
early stop counter: 2
val acc:0.527908205986023, best validation acc: 0.8805763125419617, corresponding to test acc:                         0.8960683345794678 / 0.8960683345794678
after epoch: 3,now: 2024-07-26 19:07:40.193461,epoch time: 0:25:50.519281,used: 1:17:49.453502,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.923617, 'precision': 0.949159, 'recall': 0.85201, 'specificity': 0.85201, 'f1': 0.8877903, 'auroc': 0.9351655, 'binary_precision': 0.9892233, 'binary_recall': 0.7066371, 'binary_specificity': 0.9973829, 'binary_f1_score': 0.8243861}
confusion matrix:
       0      1
0  42302    111
1   4230  10189
---- Validation: 
scalar performance:
{'acc': 0.9513874, 'precision': 0.51184404, 'recall': 0.50485766, 'specificity': 0.50485766, 'f1': 0.50450027, 'auroc': 0.63652766, 'binary_precision': 0.05925926, 'binary_recall': 0.023774145, 'binary_specificity': 0.98594123, 'binary_f1_score': 0.03393425}
confusion matrix:
       0    1
0  17813  254
1    657   16
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9389301, 'precision': 0.5121679, 'recall': 0.5065442, 'specificity': 0.5065442, 'f1': 0.5068981, 'auroc': 0.67033553, 'binary_precision': 0.06569343, 'binary_recall': 0.034615386, 'binary_specificity': 0.97847295, 'binary_f1_score': 0.045340054}
confusion matrix:
      0    1
0  5818  128
1   251    9
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 19:33:35.399324,epoch time: 0:25:55.205863,used: 1:43:44.659365,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9377111, 'precision': 0.95551664, 'recall': 0.8810891, 'specificity': 0.8810891, 'f1': 0.91083443, 'auroc': 0.95118284, 'binary_precision': 0.98492956, 'binary_recall': 0.7661626, 'binary_specificity': 0.99601567, 'binary_f1_score': 0.86188054}
confusion matrix:
       0      1
0  42247    169
1   3371  11045
---- Validation: 
scalar performance:
{'acc': 0.7247599, 'precision': 0.5239619, 'recall': 0.63909703, 'specificity': 0.63909703, 'f1': 0.4807863, 'auroc': 0.71280193, 'binary_precision': 0.07048458, 'binary_recall': 0.5468053, 'binary_specificity': 0.73138875, 'binary_f1_score': 0.12487275}
confusion matrix:
       0     1
0  13214  4853
1    305   368
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8064776, 'precision': 0.54652286, 'recall': 0.6838463, 'specificity': 0.6838463, 'f1': 0.54120106, 'auroc': 0.73933285, 'binary_precision': 0.11654442, 'binary_recall': 0.55, 'binary_specificity': 0.8176926, 'binary_f1_score': 0.19233355}
confusion matrix:
      0     1
0  4862  1084
1   117   143
early stop counter: 1
val acc:0.7247598767280579, best validation acc: 0.9513874053955078, corresponding to test acc:                         0.938930094242096 / 0.938930094242096
after epoch: 5,now: 2024-07-26 19:59:12.959202,epoch time: 0:25:37.559878,used: 2:09:22.219243,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94950026, 'precision': 0.95863235, 'recall': 0.90754473, 'specificity': 0.90754473, 'f1': 0.92954105, 'auroc': 0.95343137, 'binary_precision': 0.9746013, 'binary_recall': 0.8223748, 'binary_specificity': 0.99271464, 'binary_f1_score': 0.8920403}
confusion matrix:
       0      1
0  42105    309
1   2561  11857
---- Validation: 
scalar performance:
{'acc': 0.7076841, 'precision': 0.5233637, 'recall': 0.6409701, 'specificity': 0.6409701, 'f1': 0.4736516, 'auroc': 0.7032075, 'binary_precision': 0.06874888, 'binary_recall': 0.5690936, 'binary_specificity': 0.71284664, 'binary_f1_score': 0.122677766}
confusion matrix:
       0     1
0  12879  5188
1    290   383
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.71011925, 'precision': 0.53745514, 'recall': 0.6979249, 'specificity': 0.6979249, 'f1': 0.4949024, 'auroc': 0.75942004, 'binary_precision': 0.0939314, 'binary_recall': 0.6846154, 'binary_specificity': 0.71123445, 'binary_f1_score': 0.16519721}
confusion matrix:
      0     1
0  4229  1717
1    82   178
early stop counter: 2
val acc:0.7076840996742249, best validation acc: 0.9513874053955078, corresponding to test acc:                         0.938930094242096 / 0.938930094242096
after epoch: 6,now: 2024-07-26 20:24:42.319205,epoch time: 0:25:29.360003,used: 2:34:51.579246,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9488844, 'precision': 0.9574717, 'recall': 0.90693223, 'specificity': 0.90693223, 'f1': 0.9287172, 'auroc': 0.9513594, 'binary_precision': 0.9725049, 'binary_recall': 0.821763, 'binary_specificity': 0.9921015, 'binary_f1_score': 0.8908018}
confusion matrix:
       0      1
0  42078    335
1   2570  11849
---- Validation: 
scalar performance:
{'acc': 0.7166489, 'precision': 0.52422523, 'recall': 0.6434736, 'specificity': 0.6434736, 'f1': 0.47807574, 'auroc': 0.68416244, 'binary_precision': 0.070409484, 'binary_recall': 0.56463593, 'binary_specificity': 0.7223114, 'binary_f1_score': 0.12520592}
confusion matrix:
       0     1
0  13050  5017
1    293   380
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6753142, 'precision': 0.5324619, 'recall': 0.68160045, 'specificity': 0.68160045, 'f1': 0.47507334, 'auroc': 0.72847676, 'binary_precision': 0.084713675, 'binary_recall': 0.68846154, 'binary_specificity': 0.6747393, 'binary_f1_score': 0.15086387}
confusion matrix:
      0     1
0  4012  1934
1    81   179
early stop counter: 3
val acc:0.7166488766670227, best validation acc: 0.9513874053955078, corresponding to test acc:                         0.938930094242096 / 0.938930094242096
after epoch: 7,now: 2024-07-26 20:49:55.991656,epoch time: 0:25:13.672451,used: 3:00:05.251697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.95335376, 'precision': 0.95674086, 'recall': 0.91887563, 'specificity': 0.91887563, 'f1': 0.93582654, 'auroc': 0.95488477, 'binary_precision': 0.9628697, 'binary_recall': 0.84887993, 'binary_specificity': 0.98887134, 'binary_f1_score': 0.90228885}
confusion matrix:
       0      1
0  41941    472
1   2179  12240
---- Validation: 
scalar performance:
{'acc': 0.6618997, 'precision': 0.52174294, 'recall': 0.6422595, 'specificity': 0.6422595, 'f1': 0.45375532, 'auroc': 0.7203098, 'binary_precision': 0.064317584, 'binary_recall': 0.62109953, 'binary_specificity': 0.6634195, 'binary_f1_score': 0.116564415}
confusion matrix:
       0     1
0  11986  6081
1    255   418
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.6326136, 'precision': 0.5324967, 'recall': 0.69241834, 'specificity': 0.69241834, 'f1': 0.45660526, 'auroc': 0.7573863, 'binary_precision': 0.08160729, 'binary_recall': 0.75769234, 'binary_specificity': 0.6271443, 'binary_f1_score': 0.1473448}
confusion matrix:
      0     1
0  3729  2217
1    63   197
early stop counter: 4
val acc:0.6618996858596802, best validation acc: 0.9513874053955078, corresponding to test acc:                         0.938930094242096 / 0.938930094242096
after epoch: 8,now: 2024-07-26 21:15:08.917433,epoch time: 0:25:12.925777,used: 3:25:18.177474,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.95273787, 'precision': 0.96297, 'recall': 0.9121802, 'specificity': 0.9121802, 'f1': 0.9341099, 'auroc': 0.95281553, 'binary_precision': 0.98089695, 'binary_recall': 0.82985365, 'binary_specificity': 0.99450666, 'binary_f1_score': 0.8990757}
confusion matrix:
       0      1
0  42182    233
1   2453  11964
---- Validation: 
scalar performance:
{'acc': 0.7509605, 'precision': 0.52653, 'recall': 0.6441021, 'specificity': 0.6441021, 'f1': 0.49349084, 'auroc': 0.68093586, 'binary_precision': 0.07564811, 'binary_recall': 0.5289747, 'binary_specificity': 0.75922954, 'binary_f1_score': 0.1323666}
confusion matrix:
       0     1
0  13717  4350
1    317   356
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7681276, 'precision': 0.5431102, 'recall': 0.6969346, 'specificity': 0.6969346, 'f1': 0.523873, 'auroc': 0.7470349, 'binary_precision': 0.10726183, 'binary_recall': 0.61923075, 'binary_specificity': 0.7746384, 'binary_f1_score': 0.18285066}
confusion matrix:
      0     1
0  4606  1340
1    99   161
early stop counter: 5
val acc:0.7509605288505554, best validation acc: 0.9513874053955078, corresponding to test acc:                         0.938930094242096 / 0.938930094242096
after epoch: 9,now: 2024-07-26 21:40:50.506610,epoch time: 0:25:41.589177,used: 3:50:59.766651,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_49_50_seed_1_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 9 with time: 3:50:59.766651 at 2024-07-26 21:40:50.506610
persisted model performance metric: 

scalar performance:
{'acc': 0.9389301, 'precision': 0.5121679, 'recall': 0.5065442, 'specificity': 0.5065442, 'f1': 0.5068981, 'auroc': 0.67033553, 'binary_precision': 0.06569343, 'binary_recall': 0.034615386, 'binary_specificity': 0.97847295, 'binary_f1_score': 0.045340054}
confusion matrix:
      0    1
0  5818  128
1   251    9
oracle model performance metric: 

scalar performance:
{'acc': 0.9389301, 'precision': 0.5121679, 'recall': 0.5065442, 'specificity': 0.5065442, 'f1': 0.5068981, 'auroc': 0.67033553, 'binary_precision': 0.06569343, 'binary_recall': 0.034615386, 'binary_specificity': 0.97847295, 'binary_f1_score': 0.045340054}
confusion matrix:
      0    1
0  5818  128
1   251    9
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/0.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/0.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 456850 KiB |   2004 MiB | 781120 GiB | 781120 GiB |
|       from large pool | 415174 KiB |   1971 MiB | 771247 GiB | 771246 GiB |
|       from small pool |  41675 KiB |     61 MiB |   9873 GiB |   9873 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 456850 KiB |   2004 MiB | 781120 GiB | 781120 GiB |
|       from large pool | 415174 KiB |   1971 MiB | 771247 GiB | 771246 GiB |
|       from small pool |  41675 KiB |     61 MiB |   9873 GiB |   9873 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB | 779826 GiB | 779826 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 769972 GiB | 769972 GiB |
|       from small pool |  40676 KiB |     60 MiB |   9854 GiB |   9854 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2260 MiB |   2272 MiB |   3796 MiB |   1536 MiB |
|       from large pool |   2196 MiB |   2202 MiB |   3712 MiB |   1516 MiB |
|       from small pool |     64 MiB |     70 MiB |     84 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 368494 KiB | 412779 KiB | 597210 GiB | 597209 GiB |
|       from large pool | 361017 KiB | 402413 KiB | 586893 GiB | 586893 GiB |
|       from small pool |   7476 KiB |  21494 KiB |  10316 GiB |  10316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8115    |  147737 K  |  147734 K  |
|       from large pool |     187    |     311    |   71967 K  |   71967 K  |
|       from small pool |    3277    |    7927    |   75769 K  |   75766 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8115    |  147737 K  |  147734 K  |
|       from large pool |     187    |     311    |   71967 K  |   71967 K  |
|       from small pool |    3277    |    7927    |   75769 K  |   75766 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     127    |     195    |      71    |
|       from large pool |      92    |      92    |     153    |      61    |
|       from small pool |      32    |      35    |      42    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      65    |    3606    |   77119 K  |   77119 K  |
|       from large pool |      34    |      89    |   47783 K  |   47783 K  |
|       from small pool |      31    |    3580    |   29335 K  |   29335 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 781120 GiB | 781120 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 771247 GiB | 771247 GiB |
|       from small pool |      0 KiB |     61 MiB |   9873 GiB |   9873 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 781120 GiB | 781120 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 771247 GiB | 771247 GiB |
|       from small pool |      0 KiB |     61 MiB |   9873 GiB |   9873 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 779826 GiB | 779826 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 769972 GiB | 769972 GiB |
|       from small pool |      0 KiB |     60 MiB |   9854 GiB |   9854 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2272 MiB |   3796 MiB |   2990 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB | 597210 GiB | 597210 GiB |
|       from large pool |  24320 KiB | 402413 KiB | 586893 GiB | 586893 GiB |
|       from small pool |      0 KiB |  22399 KiB |  10316 GiB |  10316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  147737 K  |  147737 K  |
|       from large pool |       2    |     311    |   71967 K  |   71967 K  |
|       from small pool |       0    |    7927    |   75769 K  |   75769 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  147737 K  |  147737 K  |
|       from large pool |       2    |     311    |   71967 K  |   71967 K  |
|       from small pool |       0    |    7927    |   75769 K  |   75769 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     195    |     137    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   77120 K  |   77120 K  |
|       from large pool |       3    |      89    |   47783 K  |   47783 K  |
|       from small pool |       0    |    3580    |   29337 K  |   29337 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2004 MiB | 781120 GiB | 781120 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 771247 GiB | 771247 GiB |
|       from small pool |      0 KiB |     61 MiB |   9873 GiB |   9873 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2004 MiB | 781120 GiB | 781120 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 771247 GiB | 771247 GiB |
|       from small pool |      0 KiB |     61 MiB |   9873 GiB |   9873 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 779826 GiB | 779826 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 769972 GiB | 769972 GiB |
|       from small pool |      0 KiB |     60 MiB |   9854 GiB |   9854 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    806 MiB |   2272 MiB |   3796 MiB |   2990 MiB |
|       from large pool |    758 MiB |   2202 MiB |   3712 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 412779 KiB | 597210 GiB | 597210 GiB |
|       from large pool |  24320 KiB | 402413 KiB | 586893 GiB | 586893 GiB |
|       from small pool |      0 KiB |  22399 KiB |  10316 GiB |  10316 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  147737 K  |  147737 K  |
|       from large pool |       2    |     311    |   71967 K  |   71967 K  |
|       from small pool |       0    |    7927    |   75769 K  |   75769 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  147737 K  |  147737 K  |
|       from large pool |       2    |     311    |   71967 K  |   71967 K  |
|       from small pool |       0    |    7927    |   75769 K  |   75769 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     195    |     137    |
|       from large pool |      34    |      92    |     153    |     119    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3606    |   77120 K  |   77120 K  |
|       from large pool |       3    |      89    |   47783 K  |   47783 K  |
|       from small pool |       0    |    3580    |   29337 K  |   29337 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004

 Experiment start at: 2024-07-26 21:47:22.351082
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91540736, 'precision': 0.92886263, 'recall': 0.8512193, 'specificity': 0.8512193, 'f1': 0.88086605, 'auroc': 0.91684616, 'binary_precision': 0.95115095, 'binary_recall': 0.71557933, 'binary_specificity': 0.9868592, 'binary_f1_score': 0.81671757}
confusion matrix:
       0      1
0  41755    556
1   4303  10826
---- Validation: 
scalar performance:
{'acc': 0.86864114, 'precision': 0.48396286, 'recall': 0.45352778, 'specificity': 0.45352778, 'f1': 0.46726108, 'auroc': 0.52185965, 'binary_precision': 0.0031982942, 'binary_recall': 0.009966778, 'binary_specificity': 0.89708877, 'binary_f1_score': 0.004842615}
confusion matrix:
       0     1
0  16301  1870
1    596     6
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86969066, 'precision': 0.49147338, 'recall': 0.48015124, 'specificity': 0.48015124, 'f1': 0.48171514, 'auroc': 0.5768482, 'binary_precision': 0.023372287, 'binary_recall': 0.05785124, 'binary_specificity': 0.9024512, 'binary_f1_score': 0.033293698}
confusion matrix:
      0    1
0  5412  585
1   228   14
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 22:13:35.049645,epoch time: 0:26:12.698563,used: 0:26:12.698563,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9406685, 'precision': 0.95355797, 'recall': 0.89361084, 'specificity': 0.89361084, 'f1': 0.9184092, 'auroc': 0.9508834, 'binary_precision': 0.97611505, 'binary_recall': 0.79417014, 'binary_specificity': 0.99305147, 'binary_f1_score': 0.87579274}
confusion matrix:
       0      1
0  42017    294
1   3114  12015
---- Validation: 
scalar performance:
{'acc': 0.7788846, 'precision': 0.52569187, 'recall': 0.6424559, 'specificity': 0.6424559, 'f1': 0.4996774, 'auroc': 0.6947044, 'binary_precision': 0.07210031, 'binary_recall': 0.49667773, 'binary_specificity': 0.788234, 'binary_f1_score': 0.12592125}
confusion matrix:
       0     1
0  14323  3848
1    303   299
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8761019, 'precision': 0.55433786, 'recall': 0.65003645, 'specificity': 0.65003645, 'f1': 0.5675528, 'auroc': 0.738482, 'binary_precision': 0.13480055, 'binary_recall': 0.40495867, 'binary_specificity': 0.89511424, 'binary_f1_score': 0.20227039}
confusion matrix:
      0    1
0  5368  629
1   144   98
new oracle model saved
early stop counter: 1
val acc:0.7788845896720886, best validation acc: 0.8686411380767822, corresponding to test acc:                         0.8696906566619873 / 0.8761019110679626
after epoch: 2,now: 2024-07-26 22:39:27.242411,epoch time: 0:25:52.192766,used: 0:52:04.891329,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9078168, 'precision': 0.94315755, 'recall': 0.8256322, 'specificity': 0.8256322, 'f1': 0.8647339, 'auroc': 0.94480586, 'binary_precision': 0.99706864, 'binary_recall': 0.65194976, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.7883947}
confusion matrix:
       0     1
0  42281    29
1   5266  9864
---- Validation: 
scalar performance:
{'acc': 0.963831, 'precision': 0.4839003, 'recall': 0.49788123, 'specificity': 0.49788123, 'f1': 0.49079123, 'auroc': 0.66215366, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99576247, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18094  77
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95752525, 'precision': 0.4805341, 'recall': 0.49808237, 'specificity': 0.49808237, 'f1': 0.4891509, 'auroc': 0.6971309, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5974  23
1   242   0
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 23:04:58.687343,epoch time: 0:25:31.444932,used: 1:17:36.336261,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.93387884, 'precision': 0.9550546, 'recall': 0.87681496, 'specificity': 0.87681496, 'f1': 0.9072925, 'auroc': 0.9370909, 'binary_precision': 0.990477, 'binary_recall': 0.75622976, 'binary_specificity': 0.9974002, 'binary_f1_score': 0.8576462}
confusion matrix:
       0      1
0  42201    110
1   3688  11441
---- Validation: 
scalar performance:
{'acc': 0.90390456, 'precision': 0.5273865, 'recall': 0.5624881, 'specificity': 0.5624881, 'f1': 0.5328706, 'auroc': 0.60696304, 'binary_precision': 0.08263889, 'binary_recall': 0.19767442, 'binary_specificity': 0.92730176, 'binary_f1_score': 0.116552405}
confusion matrix:
       0     1
0  16850  1321
1    483   119
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87049204, 'precision': 0.5195882, 'recall': 0.549964, 'specificity': 0.549964, 'f1': 0.519172, 'auroc': 0.6815177, 'binary_precision': 0.07379518, 'binary_recall': 0.20247933, 'binary_specificity': 0.8974487, 'binary_f1_score': 0.10816777}
confusion matrix:
      0    1
0  5382  615
1   193   49
early stop counter: 1
val acc:0.9039045572280884, best validation acc: 0.9638310074806213, corresponding to test acc:                         0.9575252532958984 / 0.9575252532958984
after epoch: 4,now: 2024-07-26 23:30:27.021779,epoch time: 0:25:28.334436,used: 1:43:04.670697,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.93997216, 'precision': 0.9618232, 'recall': 0.8863652, 'specificity': 0.8863652, 'f1': 0.9161855, 'auroc': 0.95377576, 'binary_precision': 0.99871916, 'binary_recall': 0.7730848, 'binary_specificity': 0.9996455, 'binary_f1_score': 0.871535}
confusion matrix:
       0      1
0  42296     15
1   3433  11696
---- Validation: 
scalar performance:
{'acc': 0.96638787, 'precision': 0.48394153, 'recall': 0.499202, 'specificity': 0.499202, 'f1': 0.49145332, 'auroc': 0.70732784, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.998404, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18142  29
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9586472, 'precision': 0.480556, 'recall': 0.498666, 'specificity': 0.498666, 'f1': 0.48944354, 'auroc': 0.71960586, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.997332, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5981  16
1   242   0
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-26 23:56:07.856234,epoch time: 0:25:40.834455,used: 2:08:45.505152,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.93281686, 'precision': 0.95691144, 'recall': 0.8732574, 'specificity': 0.8732574, 'f1': 0.9052943, 'auroc': 0.95206124, 'binary_precision': 0.9967387, 'binary_recall': 0.7473893, 'binary_specificity': 0.9991255, 'binary_f1_score': 0.8542399}
confusion matrix:
       0      1
0  42273     37
1   3822  11308
---- Validation: 
scalar performance:
{'acc': 0.95530814, 'precision': 0.52497894, 'recall': 0.5119487, 'specificity': 0.5119487, 'f1': 0.51454604, 'auroc': 0.6640003, 'binary_precision': 0.08127209, 'binary_recall': 0.03820598, 'binary_specificity': 0.9856915, 'binary_f1_score': 0.0519774}
confusion matrix:
       0    1
0  17911  260
1    579   23
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9463055, 'precision': 0.5176108, 'recall': 0.508108, 'specificity': 0.508108, 'f1': 0.50897986, 'auroc': 0.7020873, 'binary_precision': 0.07339449, 'binary_recall': 0.03305785, 'binary_specificity': 0.98315823, 'binary_f1_score': 0.04558404}
confusion matrix:
      0    1
0  5896  101
1   234    8
early stop counter: 1
val acc:0.9553081393241882, best validation acc: 0.9663878679275513, corresponding to test acc:                         0.9586471915245056 / 0.9586471915245056
after epoch: 6,now: 2024-07-27 00:21:42.005741,epoch time: 0:25:34.149507,used: 2:34:19.654659,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94987816, 'precision': 0.95737785, 'recall': 0.91283476, 'specificity': 0.91283476, 'f1': 0.9322348, 'auroc': 0.94998956, 'binary_precision': 0.9710814, 'binary_recall': 0.83455616, 'binary_specificity': 0.9911134, 'binary_f1_score': 0.89765733}
confusion matrix:
       0      1
0  41935    376
1   2503  12626
---- Validation: 
scalar performance:
{'acc': 0.87407446, 'precision': 0.5326247, 'recall': 0.6065045, 'specificity': 0.6065045, 'f1': 0.5362124, 'auroc': 0.64014935, 'binary_precision': 0.08985102, 'binary_recall': 0.320598, 'binary_specificity': 0.892411, 'binary_f1_score': 0.14036363}
confusion matrix:
       0     1
0  16216  1955
1    409   193
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8291393, 'precision': 0.5366577, 'recall': 0.6355213, 'specificity': 0.6355213, 'f1': 0.533411, 'auroc': 0.69321847, 'binary_precision': 0.1, 'binary_recall': 0.42561984, 'binary_specificity': 0.8454227, 'binary_f1_score': 0.16194968}
confusion matrix:
      0    1
0  5070  927
1   139  103
early stop counter: 2
val acc:0.8740744590759277, best validation acc: 0.9663878679275513, corresponding to test acc:                         0.9586471915245056 / 0.9586471915245056
after epoch: 7,now: 2024-07-27 00:47:18.249060,epoch time: 0:25:36.243319,used: 2:59:55.897978,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_21_47_22_seed_2_23070004
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 23070004 ON gpusrv51 CANCELLED AT 2024-07-27T00:53:05 ***
