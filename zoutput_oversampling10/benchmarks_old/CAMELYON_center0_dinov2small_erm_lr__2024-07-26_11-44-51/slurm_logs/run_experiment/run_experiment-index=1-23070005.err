Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 12:35:01 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/1.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=1
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005

 Experiment start at: 2024-07-26 12:40:21.340131
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9542076, 'precision': 0.96690595, 'recall': 0.9141729, 'specificity': 0.9141729, 'f1': 0.93676424, 'auroc': 0.9652484, 'binary_precision': 0.9893264, 'binary_recall': 0.83146447, 'binary_specificity': 0.99688125, 'binary_f1_score': 0.9035521}
confusion matrix:
       0      1
0  42193    132
1   2480  12235
---- Validation: 
scalar performance:
{'acc': 0.96030223, 'precision': 0.492193, 'recall': 0.49866247, 'specificity': 0.49866247, 'f1': 0.49254015, 'auroc': 0.79042256, 'binary_precision': 0.018691588, 'binary_recall': 0.00311042, 'binary_specificity': 0.99421453, 'binary_f1_score': 0.0053333333}
confusion matrix:
       0    1
0  18044  105
1    641    2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9546181, 'precision': 0.47906977, 'recall': 0.49808237, 'specificity': 0.49808237, 'f1': 0.48839113, 'auroc': 0.7105615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5974  23
1   261   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 13:00:08.751015,epoch time: 0:19:47.410884,used: 0:19:47.410884,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9649018, 'precision': 0.97266376, 'recall': 0.9357424, 'specificity': 0.9357424, 'f1': 0.9523539, 'auroc': 0.97996426, 'binary_precision': 0.98697615, 'binary_recall': 0.8755012, 'binary_specificity': 0.9959835, 'binary_f1_score': 0.92790264}
confusion matrix:
       0      1
0  42155    170
1   1832  12883
---- Validation: 
scalar performance:
{'acc': 0.94167733, 'precision': 0.59892464, 'recall': 0.62478006, 'specificity': 0.62478006, 'f1': 0.6100002, 'auroc': 0.79178905, 'binary_precision': 0.22344323, 'binary_recall': 0.28460342, 'binary_specificity': 0.96495676, 'binary_f1_score': 0.25034198}
confusion matrix:
       0    1
0  17513  636
1    460  183
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.949984, 'precision': 0.5541109, 'recall': 0.51582015, 'specificity': 0.51582015, 'f1': 0.51998794, 'auroc': 0.7382165, 'binary_precision': 0.14864865, 'binary_recall': 0.042145595, 'binary_specificity': 0.98949474, 'binary_f1_score': 0.065671645}
confusion matrix:
      0   1
0  5934  63
1   250  11
early stop counter: 1
val acc:0.9416773319244385, best validation acc: 0.9603022336959839, corresponding to test acc:                         0.9546180963516235 / 0.9546180963516235
after epoch: 2,now: 2024-07-26 13:19:24.725781,epoch time: 0:19:15.974766,used: 0:39:03.385650,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.95983523, 'precision': 0.9720123, 'recall': 0.9238832, 'specificity': 0.9238832, 'f1': 0.9448333, 'auroc': 0.983953, 'binary_precision': 0.9937997, 'binary_recall': 0.84960926, 'binary_specificity': 0.99815714, 'binary_f1_score': 0.9160652}
confusion matrix:
       0      1
0  42247     78
1   2213  12502
---- Validation: 
scalar performance:
{'acc': 0.95886546, 'precision': 0.55874187, 'recall': 0.51742005, 'specificity': 0.51742005, 'f1': 0.52326006, 'auroc': 0.8202257, 'binary_precision': 0.15053764, 'binary_recall': 0.04354588, 'binary_specificity': 0.99129426, 'binary_f1_score': 0.06755127}
confusion matrix:
       0    1
0  17991  158
1    615   28
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95238096, 'precision': 0.47902265, 'recall': 0.49691513, 'specificity': 0.49691513, 'f1': 0.4878049, 'auroc': 0.77951074, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99383026, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5960  37
1   261   0
early stop counter: 2
val acc:0.9588654637336731, best validation acc: 0.9603022336959839, corresponding to test acc:                         0.9546180963516235 / 0.9546180963516235
after epoch: 3,now: 2024-07-26 13:38:38.641370,epoch time: 0:19:13.915589,used: 0:58:17.301239,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9806627, 'precision': 0.9777288, 'recall': 0.97154564, 'specificity': 0.97154564, 'f1': 0.9745842, 'auroc': 0.99447834, 'binary_precision': 0.97179097, 'binary_recall': 0.95270777, 'binary_specificity': 0.9903835, 'binary_f1_score': 0.96215475}
confusion matrix:
       0      1
0  41916    407
1    696  14021
---- Validation: 
scalar performance:
{'acc': 0.9474244, 'precision': 0.6383072, 'recall': 0.6817595, 'specificity': 0.6817595, 'f1': 0.6565375, 'auroc': 0.8453304, 'binary_precision': 0.2982456, 'binary_recall': 0.39657855, 'binary_specificity': 0.96694034, 'binary_f1_score': 0.34045395}
confusion matrix:
       0    1
0  17549  600
1    388  255
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.935123, 'precision': 0.5405951, 'recall': 0.53005433, 'specificity': 0.53005433, 'f1': 0.53405803, 'auroc': 0.7873924, 'binary_precision': 0.12041885, 'binary_recall': 0.08812261, 'binary_specificity': 0.971986, 'binary_f1_score': 0.10176991}
confusion matrix:
      0    1
0  5829  168
1   238   23
early stop counter: 3
val acc:0.9474244117736816, best validation acc: 0.9603022336959839, corresponding to test acc:                         0.9546180963516235 / 0.9546180963516235
after epoch: 4,now: 2024-07-26 13:57:49.161836,epoch time: 0:19:10.520466,used: 1:17:27.821705,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9780856, 'precision': 0.96965444, 'recall': 0.9733768, 'specificity': 0.9733768, 'f1': 0.9714957, 'auroc': 0.9951874, 'binary_precision': 0.9520038, 'binary_recall': 0.9636475, 'binary_specificity': 0.98310614, 'binary_f1_score': 0.95779026}
confusion matrix:
       0      1
0  41608    715
1    535  14182
---- Validation: 
scalar performance:
{'acc': 0.95647085, 'precision': 0.6634663, 'recall': 0.64969015, 'specificity': 0.64969015, 'f1': 0.6562292, 'auroc': 0.87109065, 'binary_precision': 0.35093698, 'binary_recall': 0.32037324, 'binary_specificity': 0.9790071, 'binary_f1_score': 0.33495936}
confusion matrix:
       0    1
0  17768  381
1    437  206
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94151485, 'precision': 0.48353812, 'recall': 0.49307796, 'specificity': 0.49307796, 'f1': 0.48765323, 'auroc': 0.7869677, 'binary_precision': 0.009345794, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9823245, 'binary_f1_score': 0.0054347827}
confusion matrix:
      0    1
0  5891  106
1   260    1
early stop counter: 4
val acc:0.9564708471298218, best validation acc: 0.9603022336959839, corresponding to test acc:                         0.9546180963516235 / 0.9546180963516235
after epoch: 5,now: 2024-07-26 14:23:09.423228,epoch time: 0:25:20.261392,used: 1:42:48.083097,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9505786, 'precision': 0.965895, 'recall': 0.9062493, 'specificity': 0.9062493, 'f1': 0.9312558, 'auroc': 0.9706211, 'binary_precision': 0.9924675, 'binary_recall': 0.81464875, 'binary_specificity': 0.9978498, 'binary_f1_score': 0.89480954}
confusion matrix:
       0      1
0  42231     91
1   2728  11990
---- Validation: 
scalar performance:
{'acc': 0.9547148, 'precision': 0.48746726, 'recall': 0.49576977, 'specificity': 0.49576977, 'f1': 0.49075434, 'auroc': 0.79252803, 'binary_precision': 0.009433962, 'binary_recall': 0.00311042, 'binary_specificity': 0.9884291, 'binary_f1_score': 0.0046783625}
confusion matrix:
       0    1
0  17939  210
1    641    2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9487057, 'precision': 0.4789448, 'recall': 0.4949975, 'specificity': 0.4949975, 'f1': 0.48683888, 'auroc': 0.68797123, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.989995, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5937  60
1   261   0
early stop counter: 5
val acc:0.9547147750854492, best validation acc: 0.9603022336959839, corresponding to test acc:                         0.9546180963516235 / 0.9546180963516235
after epoch: 6,now: 2024-07-26 14:48:36.718387,epoch time: 0:25:27.295159,used: 2:08:15.378256,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_40_21_seed_0_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 6 with time: 2:08:15.378256 at 2024-07-26 14:48:36.718387
persisted model performance metric: 

scalar performance:
{'acc': 0.9546181, 'precision': 0.47906977, 'recall': 0.49808237, 'specificity': 0.49808237, 'f1': 0.48839113, 'auroc': 0.7105615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5974  23
1   261   0
oracle model performance metric: 

scalar performance:
{'acc': 0.9546181, 'precision': 0.47906977, 'recall': 0.49808237, 'specificity': 0.49808237, 'f1': 0.48839113, 'auroc': 0.7105615, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99616474, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5974  23
1   261   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/1.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 455924 KiB |   2003 MiB | 237259 GiB | 237258 GiB |
|       from large pool | 414237 KiB |   1971 MiB | 234268 GiB | 234267 GiB |
|       from small pool |  41687 KiB |     61 MiB |   2991 GiB |   2991 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 455924 KiB |   2003 MiB | 237259 GiB | 237258 GiB |
|       from large pool | 414237 KiB |   1971 MiB | 234268 GiB | 234267 GiB |
|       from small pool |  41687 KiB |     61 MiB |   2991 GiB |   2991 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   1998 MiB | 237167 GiB | 237166 GiB |
|       from large pool | 407075 KiB |   1966 MiB | 234181 GiB | 234181 GiB |
|       from small pool |  40679 KiB |     60 MiB |   2985 GiB |   2985 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2282 MiB |   2282 MiB |   2282 MiB |      0 B   |
|       from large pool |   2212 MiB |   2212 MiB |   2212 MiB |      0 B   |
|       from small pool |     70 MiB |     70 MiB |     70 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 332555 KiB | 366275 KiB | 187457 GiB | 187456 GiB |
|       from large pool | 323043 KiB | 360722 KiB | 184332 GiB | 184332 GiB |
|       from small pool |   9512 KiB |  14571 KiB |   3124 GiB |   3124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3488    |    8115    |   44650 K  |   44647 K  |
|       from large pool |     187    |     311    |   21736 K  |   21735 K  |
|       from small pool |    3301    |    7927    |   22914 K  |   22911 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3488    |    8115    |   44650 K  |   44647 K  |
|       from large pool |     187    |     311    |   21736 K  |   21735 K  |
|       from small pool |    3301    |    7927    |   22914 K  |   22911 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     127    |     127    |     127    |       0    |
|       from large pool |      92    |      92    |      92    |       0    |
|       from small pool |      35    |      35    |      35    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      63    |    3612    |   22556 K  |   22555 K  |
|       from large pool |      32    |      88    |   13731 K  |   13731 K  |
|       from small pool |      31    |    3580    |    8824 K  |    8824 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 237259 GiB | 237259 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 234268 GiB | 234268 GiB |
|       from small pool |      0 KiB |     61 MiB |   2991 GiB |   2991 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 237259 GiB | 237259 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 234268 GiB | 234268 GiB |
|       from small pool |      0 KiB |     61 MiB |   2991 GiB |   2991 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 237167 GiB | 237167 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 234181 GiB | 234181 GiB |
|       from small pool |      0 KiB |     60 MiB |   2985 GiB |   2985 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    770 MiB |   2282 MiB |   2282 MiB |   1512 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 428787 KiB | 187457 GiB | 187457 GiB |
|       from large pool |  24320 KiB | 408037 KiB | 184332 GiB | 184332 GiB |
|       from small pool |      0 KiB |  21494 KiB |   3124 GiB |   3124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |   44650 K  |   44650 K  |
|       from large pool |       2    |     311    |   21736 K  |   21736 K  |
|       from small pool |       0    |    7927    |   22914 K  |   22914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |   44650 K  |   44650 K  |
|       from large pool |       2    |     311    |   21736 K  |   21736 K  |
|       from small pool |       0    |    7927    |   22914 K  |   22914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   22557 K  |   22557 K  |
|       from large pool |       3    |      88    |   13731 K  |   13731 K  |
|       from small pool |       0    |    3580    |    8825 K  |    8825 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB | 237259 GiB | 237259 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 234268 GiB | 234268 GiB |
|       from small pool |      0 KiB |     61 MiB |   2991 GiB |   2991 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB | 237259 GiB | 237259 GiB |
|       from large pool |  16640 KiB |   1971 MiB | 234268 GiB | 234268 GiB |
|       from small pool |      0 KiB |     61 MiB |   2991 GiB |   2991 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB | 237167 GiB | 237167 GiB |
|       from large pool |  16640 KiB |   1966 MiB | 234181 GiB | 234181 GiB |
|       from small pool |      0 KiB |     60 MiB |   2985 GiB |   2985 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    770 MiB |   2282 MiB |   2282 MiB |   1512 MiB |
|       from large pool |    720 MiB |   2212 MiB |   2212 MiB |   1492 MiB |
|       from small pool |     50 MiB |     70 MiB |     70 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 428787 KiB | 187457 GiB | 187457 GiB |
|       from large pool |  24320 KiB | 408037 KiB | 184332 GiB | 184332 GiB |
|       from small pool |      0 KiB |  21494 KiB |   3124 GiB |   3124 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |   44650 K  |   44650 K  |
|       from large pool |       2    |     311    |   21736 K  |   21736 K  |
|       from small pool |       0    |    7927    |   22914 K  |   22914 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |   44650 K  |   44650 K  |
|       from large pool |       2    |     311    |   21736 K  |   21736 K  |
|       from small pool |       0    |    7927    |   22914 K  |   22914 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     127    |      69    |
|       from large pool |      33    |      92    |      92    |      59    |
|       from small pool |      25    |      35    |      35    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   22557 K  |   22557 K  |
|       from large pool |       3    |      88    |   13731 K  |   13731 K  |
|       from small pool |       0    |    3580    |    8825 K  |    8825 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005

 Experiment start at: 2024-07-26 14:56:02.270070
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9580518, 'precision': 0.9712469, 'recall': 0.9189161, 'specificity': 0.9189161, 'f1': 0.9414878, 'auroc': 0.96745896, 'binary_precision': 0.9943322, 'binary_recall': 0.83945906, 'binary_specificity': 0.9983731, 'binary_f1_score': 0.91035575}
confusion matrix:
       0      1
0  42343     69
1   2315  12105
---- Validation: 
scalar performance:
{'acc': 0.95715046, 'precision': 0.60952926, 'recall': 0.5436099, 'specificity': 0.5436099, 'f1': 0.5596018, 'auroc': 0.7618228, 'binary_precision': 0.2519084, 'binary_recall': 0.09806835, 'binary_specificity': 0.9891515, 'binary_f1_score': 0.14117646}
confusion matrix:
       0    1
0  17871  196
1    607   66
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.950854, 'precision': 0.47889954, 'recall': 0.49621594, 'specificity': 0.49621594, 'f1': 0.48740396, 'auroc': 0.77127993, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9924319, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5901  45
1   260   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 15:20:24.860024,epoch time: 0:24:22.589954,used: 0:24:22.589954,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.94971144, 'precision': 0.96789896, 'recall': 0.90126085, 'specificity': 0.90126085, 'f1': 0.92876077, 'auroc': 0.987, 'binary_precision': 0.99861985, 'binary_recall': 0.80289894, 'binary_specificity': 0.99962276, 'binary_f1_score': 0.89012766}
confusion matrix:
       0      1
0  42397     16
1   2842  11577
---- Validation: 
scalar performance:
{'acc': 0.9579509, 'precision': 0.6031699, 'recall': 0.53472656, 'specificity': 0.53472656, 'f1': 0.54851496, 'auroc': 0.847924, 'binary_precision': 0.239819, 'binary_recall': 0.078751855, 'binary_specificity': 0.99070126, 'binary_f1_score': 0.118568234}
confusion matrix:
       0    1
0  17899  168
1    620   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95230424, 'precision': 0.4789303, 'recall': 0.49697277, 'specificity': 0.49697277, 'f1': 0.48778474, 'auroc': 0.8293997, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99394554, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5910  36
1   260   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 15:39:45.859531,epoch time: 0:19:20.999507,used: 0:43:43.589461,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.93149984, 'precision': 0.8944086, 'recall': 0.9490942, 'specificity': 0.9490942, 'f1': 0.91579926, 'auroc': 0.9945586, 'binary_precision': 0.79443854, 'binary_recall': 0.98481065, 'binary_specificity': 0.91337764, 'binary_f1_score': 0.87944007}
confusion matrix:
       0      1
0  38740   3674
1    219  14199
---- Validation: 
scalar performance:
{'acc': 0.68986124, 'precision': 0.5438635, 'recall': 0.7833634, 'specificity': 0.7833634, 'f1': 0.48962823, 'auroc': 0.870602, 'binary_precision': 0.094011694, 'binary_recall': 0.88410103, 'binary_specificity': 0.6826258, 'binary_f1_score': 0.16995145}
confusion matrix:
       0     1
0  12333  5734
1     78   595
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.70963585, 'precision': 0.53964555, 'recall': 0.71054554, 'specificity': 0.71054554, 'f1': 0.49718663, 'auroc': 0.78016895, 'binary_precision': 0.09675732, 'binary_recall': 0.71153843, 'binary_specificity': 0.70955265, 'binary_f1_score': 0.17034991}
confusion matrix:
      0     1
0  4219  1727
1    75   185
early stop counter: 1
val acc:0.6898612380027771, best validation acc: 0.9579508900642395, corresponding to test acc:                         0.9523042440414429 / 0.9523042440414429
after epoch: 3,now: 2024-07-26 15:58:46.060519,epoch time: 0:19:00.200988,used: 1:02:43.790449,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.98511404, 'precision': 0.988176, 'recall': 0.9725194, 'specificity': 0.9725194, 'f1': 0.9800297, 'auroc': 0.9970628, 'binary_precision': 0.9941031, 'binary_recall': 0.9469487, 'binary_specificity': 0.99809015, 'binary_f1_score': 0.9699532}
confusion matrix:
       0      1
0  42331     81
1    765  13655
---- Validation: 
scalar performance:
{'acc': 0.95939165, 'precision': 0.62973785, 'recall': 0.5419112, 'specificity': 0.5419112, 'f1': 0.5596589, 'auroc': 0.87585634, 'binary_precision': 0.29245284, 'binary_recall': 0.09212481, 'binary_specificity': 0.99169755, 'binary_f1_score': 0.140113}
confusion matrix:
       0    1
0  17917  150
1    611   62
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.8449336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 16:17:45.581900,epoch time: 0:18:59.521381,used: 1:21:43.311830,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98708475, 'precision': 0.9857158, 'recall': 0.9800612, 'specificity': 0.9800612, 'f1': 0.98284626, 'auroc': 0.99635756, 'binary_precision': 0.9829862, 'binary_recall': 0.9658043, 'binary_specificity': 0.99431807, 'binary_f1_score': 0.97431946}
confusion matrix:
       0      1
0  42174    241
1    493  13924
---- Validation: 
scalar performance:
{'acc': 0.9032017, 'precision': 0.59437215, 'recall': 0.7523842, 'specificity': 0.7523842, 'f1': 0.6262145, 'auroc': 0.8758495, 'binary_precision': 0.20516796, 'binary_recall': 0.58989596, 'binary_specificity': 0.9148724, 'binary_f1_score': 0.30444786}
confusion matrix:
       0     1
0  16529  1538
1    276   397
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9456977, 'precision': 0.6154555, 'recall': 0.5744405, 'specificity': 0.5744405, 'f1': 0.5894725, 'auroc': 0.8583859, 'binary_precision': 0.26666668, 'binary_recall': 0.16923077, 'binary_specificity': 0.9796502, 'binary_f1_score': 0.20705882}
confusion matrix:
      0    1
0  5825  121
1   216   44
early stop counter: 1
val acc:0.903201699256897, best validation acc: 0.9593916535377502, corresponding to test acc:                         0.956977128982544 / 0.956977128982544
after epoch: 5,now: 2024-07-26 16:36:56.046571,epoch time: 0:19:10.464671,used: 1:40:53.776501,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99026954, 'precision': 0.9915042, 'recall': 0.9827683, 'specificity': 0.9827683, 'f1': 0.98703736, 'auroc': 0.9972875, 'binary_precision': 0.9939437, 'binary_recall': 0.96754056, 'binary_specificity': 0.997996, 'binary_f1_score': 0.9805644}
confusion matrix:
       0      1
0  42329     85
1    468  13950
---- Validation: 
scalar performance:
{'acc': 0.9527748, 'precision': 0.6647629, 'recall': 0.6758108, 'specificity': 0.6758108, 'f1': 0.6700782, 'auroc': 0.8808737, 'binary_precision': 0.35277778, 'binary_recall': 0.37741455, 'binary_specificity': 0.9742071, 'binary_f1_score': 0.36468056}
confusion matrix:
       0    1
0  17601  466
1    419  254
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9553658, 'precision': 0.478995, 'recall': 0.49857047, 'specificity': 0.49857047, 'f1': 0.48858672, 'auroc': 0.84762806, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99714094, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5929  17
1   260   0
early stop counter: 2
val acc:0.9527748227119446, best validation acc: 0.9593916535377502, corresponding to test acc:                         0.956977128982544 / 0.956977128982544
after epoch: 6,now: 2024-07-26 16:55:51.014209,epoch time: 0:18:54.967638,used: 1:59:48.744139,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.98502606, 'precision': 0.98972905, 'recall': 0.97087944, 'specificity': 0.97087944, 'f1': 0.9798467, 'auroc': 0.99751455, 'binary_precision': 0.9987502, 'binary_recall': 0.94215965, 'binary_specificity': 0.99959916, 'binary_f1_score': 0.96962994}
confusion matrix:
       0      1
0  42396     17
1    834  13585
---- Validation: 
scalar performance:
{'acc': 0.96093917, 'precision': 0.6873991, 'recall': 0.5877756, 'specificity': 0.5877756, 'f1': 0.61726326, 'auroc': 0.8709177, 'binary_precision': 0.40453073, 'binary_recall': 0.18573551, 'binary_specificity': 0.9898157, 'binary_f1_score': 0.2545825}
confusion matrix:
       0    1
0  17883  184
1    548  125
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94392526, 'precision': 0.4787512, 'recall': 0.49260005, 'specificity': 0.49260005, 'f1': 0.4855769, 'auroc': 0.8108671, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9852001, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5858  88
1   260   0
better model found
persisted
after epoch: 7,now: 2024-07-26 17:14:50.871231,epoch time: 0:18:59.857022,used: 2:18:48.601161,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.97263867, 'precision': 0.9552765, 'recall': 0.97523695, 'specificity': 0.97523695, 'f1': 0.96466213, 'auroc': 0.9967314, 'binary_precision': 0.9173371, 'binary_recall': 0.98051184, 'binary_specificity': 0.96996206, 'binary_f1_score': 0.947873}
confusion matrix:
       0      1
0  41139   1274
1    281  14138
---- Validation: 
scalar performance:
{'acc': 0.9503202, 'precision': 0.6769881, 'recall': 0.75822407, 'specificity': 0.75822407, 'f1': 0.70875704, 'auroc': 0.90804243, 'binary_precision': 0.371, 'binary_recall': 0.551263, 'binary_specificity': 0.96518517, 'binary_f1_score': 0.44351462}
confusion matrix:
       0    1
0  17438  629
1    302  371
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93764096, 'precision': 0.4786149, 'recall': 0.48932055, 'specificity': 0.48932055, 'f1': 0.4839085, 'auroc': 0.8001166, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9786411, 'binary_f1_score': 0.0}
confusion matrix:
      0    1
0  5819  127
1   260    0
early stop counter: 1
val acc:0.9503201842308044, best validation acc: 0.9609391689300537, corresponding to test acc:                         0.9439252614974976 / 0.956977128982544
after epoch: 8,now: 2024-07-26 17:34:21.501271,epoch time: 0:19:30.630040,used: 2:38:19.231201,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9934016, 'precision': 0.9947094, 'recall': 0.9878645, 'specificity': 0.9878645, 'f1': 0.99122655, 'auroc': 0.99872255, 'binary_precision': 0.9973084, 'binary_recall': 0.97662485, 'binary_specificity': 0.9991041, 'binary_f1_score': 0.98685825}
confusion matrix:
       0      1
0  42377     38
1    337  14080
---- Validation: 
scalar performance:
{'acc': 0.96350056, 'precision': 0.7298053, 'recall': 0.63559633, 'specificity': 0.63559633, 'f1': 0.6691799, 'auroc': 0.907258, 'binary_precision': 0.4859335, 'binary_recall': 0.28231797, 'binary_specificity': 0.98887473, 'binary_f1_score': 0.35714287}
confusion matrix:
       0    1
0  17866  201
1    483  190
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95327103, 'precision': 0.47895077, 'recall': 0.4974773, 'specificity': 0.4974773, 'f1': 0.4880383, 'auroc': 0.84618, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9949546, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5916  30
1   260   0
better model found
persisted
after epoch: 9,now: 2024-07-26 17:54:19.570614,epoch time: 0:19:58.069343,used: 2:58:17.300544,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99194115, 'precision': 0.994076, 'recall': 0.9846675, 'specificity': 0.9846675, 'f1': 0.98925793, 'auroc': 0.9988041, 'binary_precision': 0.99828684, 'binary_recall': 0.96990085, 'binary_specificity': 0.9994341, 'binary_f1_score': 0.98388916}
confusion matrix:
       0      1
0  42389     24
1    434  13985
---- Validation: 
scalar performance:
{'acc': 0.9604055, 'precision': 0.6848203, 'recall': 0.5953668, 'specificity': 0.5953668, 'f1': 0.62394845, 'auroc': 0.8759663, 'binary_precision': 0.398827, 'binary_recall': 0.20208023, 'binary_specificity': 0.98865336, 'binary_f1_score': 0.2682446}
confusion matrix:
       0    1
0  17862  205
1    537  136
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9535933, 'precision': 0.49569842, 'recall': 0.49948448, 'specificity': 0.49948448, 'f1': 0.49156904, 'auroc': 0.71106386, 'binary_precision': 0.033333335, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9951228, 'binary_f1_score': 0.006896552}
confusion matrix:
      0   1
0  5917  29
1   259   1
early stop counter: 1
val acc:0.9604055285453796, best validation acc: 0.9635005593299866, corresponding to test acc:                         0.9532710313796997 / 0.956977128982544
after epoch: 10,now: 2024-07-26 18:13:52.892894,epoch time: 0:19:33.322280,used: 3:17:50.622824,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99111414, 'precision': 0.993994, 'recall': 0.98260283, 'specificity': 0.98260283, 'f1': 0.9881319, 'auroc': 0.9990223, 'binary_precision': 0.9996409, 'binary_recall': 0.9653235, 'binary_specificity': 0.9998821, 'binary_f1_score': 0.9821825}
confusion matrix:
       0      1
0  42408      5
1    500  13919
---- Validation: 
scalar performance:
{'acc': 0.96387404, 'precision': 0.7238761, 'recall': 0.5363679, 'specificity': 0.5363679, 'f1': 0.5562454, 'auroc': 0.90103126, 'binary_precision': 0.4811321, 'binary_recall': 0.075780086, 'binary_specificity': 0.99695575, 'binary_f1_score': 0.1309371}
confusion matrix:
       0   1
0  18012  55
1    622  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.93651307, 'precision': 0.47859025, 'recall': 0.48873192, 'specificity': 0.48873192, 'f1': 0.48360792, 'auroc': 0.77307886, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.97746384, 'binary_f1_score': 0.0}
confusion matrix:
      0    1
0  5812  134
1   260    0
better model found
persisted
after epoch: 11,now: 2024-07-26 18:32:56.369906,epoch time: 0:19:03.477012,used: 3:36:54.099836,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.99250424, 'precision': 0.9946891, 'recall': 0.98554623, 'specificity': 0.98554623, 'f1': 0.9900103, 'auroc': 0.9985819, 'binary_precision': 0.9990014, 'binary_recall': 0.9714226, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.985019}
confusion matrix:
       0      1
0  42401     14
1    412  14005
---- Validation: 
scalar performance:
{'acc': 0.96734256, 'precision': 0.7963209, 'recall': 0.6139851, 'specificity': 0.6139851, 'f1': 0.66117525, 'auroc': 0.8823909, 'binary_precision': 0.6205534, 'binary_recall': 0.2332838, 'binary_specificity': 0.9946864, 'binary_f1_score': 0.33909285}
confusion matrix:
       0    1
0  17971   96
1    516  157
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9558492, 'precision': 0.5103291, 'recall': 0.50066173, 'specificity': 0.50066173, 'f1': 0.49233449, 'auroc': 0.7970046, 'binary_precision': 0.0625, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.007246377}
confusion matrix:
      0   1
0  5931  15
1   259   1
better model found
persisted
after epoch: 12,now: 2024-07-26 18:51:49.996917,epoch time: 0:18:53.627011,used: 3:55:47.726847,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9907798, 'precision': 0.99049157, 'recall': 0.9851025, 'specificity': 0.9851025, 'f1': 0.9877591, 'auroc': 0.9983454, 'binary_precision': 0.9899161, 'binary_recall': 0.97357655, 'binary_specificity': 0.9966284, 'binary_f1_score': 0.9816783}
confusion matrix:
       0      1
0  42270    143
1    381  14038
---- Validation: 
scalar performance:
{'acc': 0.95234793, 'precision': 0.66957194, 'recall': 0.6977627, 'specificity': 0.6977627, 'f1': 0.68240833, 'auroc': 0.8847003, 'binary_precision': 0.3607595, 'binary_recall': 0.42347696, 'binary_specificity': 0.97204846, 'binary_f1_score': 0.3896104}
confusion matrix:
       0    1
0  17562  505
1    388  285
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9479536, 'precision': 0.50080055, 'recall': 0.5002193, 'specificity': 0.5002193, 'f1': 0.49575266, 'auroc': 0.82189476, 'binary_precision': 0.04347826, 'binary_recall': 0.011538462, 'binary_specificity': 0.9889001, 'binary_f1_score': 0.018237082}
confusion matrix:
      0   1
0  5880  66
1   257   3
early stop counter: 1
val acc:0.9523479342460632, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.9558491706848145 / 0.956977128982544
after epoch: 13,now: 2024-07-26 19:11:34.740696,epoch time: 0:19:44.743779,used: 4:15:32.470626,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9952843, 'precision': 0.99451554, 'recall': 0.9930176, 'specificity': 0.9930176, 'f1': 0.9937637, 'auroc': 0.99942636, 'binary_precision': 0.9929622, 'binary_recall': 0.98841643, 'binary_specificity': 0.9976188, 'binary_f1_score': 0.99068415}
confusion matrix:
       0      1
0  42314    101
1    167  14250
---- Validation: 
scalar performance:
{'acc': 0.9567236, 'precision': 0.69242907, 'recall': 0.70861524, 'specificity': 0.70861524, 'f1': 0.7001474, 'auroc': 0.91169834, 'binary_precision': 0.4057377, 'binary_recall': 0.44130757, 'binary_specificity': 0.97592294, 'binary_f1_score': 0.4227758}
confusion matrix:
       0    1
0  17632  435
1    376  297
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95633256, 'precision': 0.54582995, 'recall': 0.50275296, 'specificity': 0.50275296, 'f1': 0.4961085, 'auroc': 0.8647963, 'binary_precision': 0.13333334, 'binary_recall': 0.0076923077, 'binary_specificity': 0.99781364, 'binary_f1_score': 0.014545455}
confusion matrix:
      0   1
0  5933  13
1   258   2
early stop counter: 2
val acc:0.9567235708236694, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.9558491706848145 / 0.956977128982544
after epoch: 14,now: 2024-07-26 19:30:58.774699,epoch time: 0:19:24.034003,used: 4:34:56.504629,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9947213, 'precision': 0.9957535, 'recall': 0.9903072, 'specificity': 0.9903072, 'f1': 0.99299216, 'auroc': 0.99907756, 'binary_precision': 0.9978141, 'binary_recall': 0.98134536, 'binary_specificity': 0.99926907, 'binary_f1_score': 0.9895112}
confusion matrix:
       0      1
0  42381     31
1    269  14151
---- Validation: 
scalar performance:
{'acc': 0.96013874, 'precision': 0.68958783, 'recall': 0.6138254, 'specificity': 0.6138254, 'f1': 0.64100206, 'auroc': 0.8773595, 'binary_precision': 0.40703517, 'binary_recall': 0.24071322, 'binary_specificity': 0.9869375, 'binary_f1_score': 0.302521}
confusion matrix:
       0    1
0  17831  236
1    511  162
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9429584, 'precision': 0.47873038, 'recall': 0.49209553, 'specificity': 0.49209553, 'f1': 0.48532096, 'auroc': 0.8158517, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.98419106, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5852  94
1   260   0
early stop counter: 3
val acc:0.960138738155365, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.9558491706848145 / 0.956977128982544
after epoch: 15,now: 2024-07-26 19:50:04.190890,epoch time: 0:19:05.416191,used: 4:54:01.920820,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9957066, 'precision': 0.9952346, 'recall': 0.9934161, 'specificity': 0.9934161, 'f1': 0.9943211, 'auroc': 0.9995028, 'binary_precision': 0.9942817, 'binary_recall': 0.9887656, 'binary_specificity': 0.9980666, 'binary_f1_score': 0.991516}
confusion matrix:
       0      1
0  42330     82
1    162  14258
---- Validation: 
scalar performance:
{'acc': 0.95442903, 'precision': 0.66886187, 'recall': 0.66450924, 'specificity': 0.66450924, 'f1': 0.6666526, 'auroc': 0.8856845, 'binary_precision': 0.36183205, 'binary_recall': 0.35215452, 'binary_specificity': 0.9768639, 'binary_f1_score': 0.35692772}
confusion matrix:
       0    1
0  17649  418
1    436  237
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94263613, 'precision': 0.48390034, 'recall': 0.49376634, 'specificity': 0.49376634, 'f1': 0.4880264, 'auroc': 0.7978358, 'binary_precision': 0.010204081, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9836865, 'binary_f1_score': 0.0055865925}
confusion matrix:
      0   1
0  5849  97
1   259   1
early stop counter: 4
val acc:0.954429030418396, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.9558491706848145 / 0.956977128982544
after epoch: 16,now: 2024-07-26 20:09:13.983348,epoch time: 0:19:09.792458,used: 5:13:11.713278,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 17
---- Training Domain: 
scalar performance:
{'acc': 0.99561864, 'precision': 0.99628216, 'recall': 0.9921433, 'specificity': 0.9921433, 'f1': 0.99419063, 'auroc': 0.9994005, 'binary_precision': 0.9976119, 'binary_recall': 0.9850881, 'binary_specificity': 0.9991984, 'binary_f1_score': 0.9913104}
confusion matrix:
       0      1
0  42380     34
1    215  14203
---- Validation: 
scalar performance:
{'acc': 0.9659552, 'precision': 0.7613159, 'recall': 0.64259154, 'specificity': 0.64259154, 'f1': 0.6827367, 'auroc': 0.9237069, 'binary_precision': 0.54847646, 'binary_recall': 0.29420504, 'binary_specificity': 0.990978, 'binary_f1_score': 0.3829787}
confusion matrix:
       0    1
0  17904  163
1    475  198
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9545601, 'precision': 0.59214646, 'recall': 0.5147009, 'specificity': 0.5147009, 'f1': 0.51835865, 'auroc': 0.8728565, 'binary_precision': 0.225, 'binary_recall': 0.034615386, 'binary_specificity': 0.9947864, 'binary_f1_score': 0.06}
confusion matrix:
      0   1
0  5915  31
1   251   9
early stop counter: 5
val acc:0.9659551978111267, best validation acc: 0.9673425555229187, corresponding to test acc:                         0.9558491706848145 / 0.956977128982544
after epoch: 17,now: 2024-07-26 20:28:02.883284,epoch time: 0:18:48.899936,used: 5:32:00.613214,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_14_56_02_seed_1_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 17 with time: 5:32:00.613214 at 2024-07-26 20:28:02.883284
persisted model performance metric: 

scalar performance:
{'acc': 0.9558492, 'precision': 0.5103291, 'recall': 0.50066173, 'specificity': 0.50066173, 'f1': 0.49233449, 'auroc': 0.7970046, 'binary_precision': 0.0625, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9974773, 'binary_f1_score': 0.007246377}
confusion matrix:
      0   1
0  5931  15
1   259   1
oracle model performance metric: 

scalar performance:
{'acc': 0.9569771, 'precision': 0.47902888, 'recall': 0.49941137, 'specificity': 0.49941137, 'f1': 0.4890078, 'auroc': 0.8449336, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99882275, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5939  7
1   260  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454154 KiB |   2003 MiB |    881 TiB |    881 TiB |
|       from large pool | 412478 KiB |   1971 MiB |    870 TiB |    870 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454154 KiB |   2003 MiB |    881 TiB |    881 TiB |
|       from large pool | 412478 KiB |   1971 MiB |    870 TiB |    870 TiB |
|       from small pool |  41675 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   1998 MiB |    880 TiB |    880 TiB |
|       from large pool | 407075 KiB |   1966 MiB |    869 TiB |    869 TiB |
|       from small pool |  40676 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |   2282 MiB |   3790 MiB |   1512 MiB |
|       from large pool |   2214 MiB |   2214 MiB |   3706 MiB |   1492 MiB |
|       from small pool |     64 MiB |     70 MiB |     84 MiB |     20 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 365046 KiB | 428787 KiB | 686584 GiB | 686584 GiB |
|       from large pool | 357569 KiB | 408037 KiB | 674771 GiB | 674771 GiB |
|       from small pool |   7476 KiB |  21494 KiB |  11812 GiB |  11812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    3464    |    8115    |  169525 K  |  169522 K  |
|       from large pool |     187    |     311    |   82593 K  |   82593 K  |
|       from small pool |    3277    |    7927    |   86931 K  |   86928 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3464    |    8115    |  169525 K  |  169522 K  |
|       from large pool |     187    |     311    |   82593 K  |   82593 K  |
|       from small pool |    3277    |    7927    |   86931 K  |   86928 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     127    |     194    |      69    |
|       from large pool |      93    |      93    |     152    |      59    |
|       from small pool |      32    |      35    |      42    |      10    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      71    |    3612    |   91057 K  |   91057 K  |
|       from large pool |      40    |      93    |   57420 K  |   57420 K  |
|       from small pool |      31    |    3580    |   33637 K  |   33637 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    881 TiB |    881 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    870 TiB |    870 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    881 TiB |    881 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    870 TiB |    870 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    880 TiB |    880 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    869 TiB |    869 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   2282 MiB |   3790 MiB |   2990 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 457405 KiB | 686584 GiB | 686584 GiB |
|       from large pool |  24320 KiB | 444488 KiB | 674771 GiB | 674771 GiB |
|       from small pool |      0 KiB |  22399 KiB |  11812 GiB |  11812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  169525 K  |  169525 K  |
|       from large pool |       2    |     311    |   82593 K  |   82593 K  |
|       from small pool |       0    |    7927    |   86931 K  |   86931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  169525 K  |  169525 K  |
|       from large pool |       2    |     311    |   82593 K  |   82593 K  |
|       from small pool |       0    |    7927    |   86931 K  |   86931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     194    |     136    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   91058 K  |   91058 K  |
|       from large pool |       3    |      93    |   57420 K  |   57420 K  |
|       from small pool |       0    |    3580    |   33638 K  |   33638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |    881 TiB |    881 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    870 TiB |    870 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |    881 TiB |    881 TiB |
|       from large pool |  16640 KiB |   1971 MiB |    870 TiB |    870 TiB |
|       from small pool |      0 KiB |     61 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |    880 TiB |    880 TiB |
|       from large pool |  16640 KiB |   1966 MiB |    869 TiB |    869 TiB |
|       from small pool |      0 KiB |     60 MiB |     11 TiB |     11 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    800 MiB |   2282 MiB |   3790 MiB |   2990 MiB |
|       from large pool |    752 MiB |   2214 MiB |   3706 MiB |   2954 MiB |
|       from small pool |     48 MiB |     70 MiB |     84 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 457405 KiB | 686584 GiB | 686584 GiB |
|       from large pool |  24320 KiB | 444488 KiB | 674771 GiB | 674771 GiB |
|       from small pool |      0 KiB |  22399 KiB |  11812 GiB |  11812 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8115    |  169525 K  |  169525 K  |
|       from large pool |       2    |     311    |   82593 K  |   82593 K  |
|       from small pool |       0    |    7927    |   86931 K  |   86931 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8115    |  169525 K  |  169525 K  |
|       from large pool |       2    |     311    |   82593 K  |   82593 K  |
|       from small pool |       0    |    7927    |   86931 K  |   86931 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      58    |     127    |     194    |     136    |
|       from large pool |      34    |      93    |     152    |     118    |
|       from small pool |      24    |      35    |      42    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3612    |   91058 K  |   91058 K  |
|       from large pool |       3    |      93    |   57420 K  |   57420 K  |
|       from small pool |       0    |    3580    |   33638 K  |   33638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005

 Experiment start at: 2024-07-26 20:34:04.107555
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.957312, 'precision': 0.95712495, 'recall': 0.9317027, 'specificity': 0.9317027, 'f1': 0.9434561, 'auroc': 0.97076607, 'binary_precision': 0.95676297, 'binary_recall': 0.87758607, 'binary_specificity': 0.9858193, 'binary_f1_score': 0.9154658}
confusion matrix:
       0      1
0  41711    600
1   1852  13277
---- Validation: 
scalar performance:
{'acc': 0.95280457, 'precision': 0.55107874, 'recall': 0.53314084, 'specificity': 0.53314084, 'f1': 0.5395017, 'auroc': 0.8253498, 'binary_precision': 0.13212435, 'binary_recall': 0.08471761, 'binary_specificity': 0.98156404, 'binary_f1_score': 0.10323886}
confusion matrix:
       0    1
0  17836  335
1    551   51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95832664, 'precision': 0.48054975, 'recall': 0.49849924, 'specificity': 0.49849924, 'f1': 0.48935997, 'auroc': 0.85027504, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5979  18
1   242   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 20:53:42.294048,epoch time: 0:19:38.186493,used: 0:19:38.186493,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9832173, 'precision': 0.98367465, 'recall': 0.97291934, 'specificity': 0.97291934, 'f1': 0.9781345, 'auroc': 0.9944938, 'binary_precision': 0.9846059, 'binary_recall': 0.9511566, 'binary_specificity': 0.99468213, 'binary_f1_score': 0.9675923}
confusion matrix:
       0      1
0  42085    225
1    739  14391
---- Validation: 
scalar performance:
{'acc': 0.9500879, 'precision': 0.60340905, 'recall': 0.60722405, 'specificity': 0.60722405, 'f1': 0.6052748, 'auroc': 0.85632277, 'binary_precision': 0.232, 'binary_recall': 0.24086379, 'binary_specificity': 0.9735843, 'binary_f1_score': 0.23634881}
confusion matrix:
       0    1
0  17691  480
1    457  145
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94967145, 'precision': 0.48037943, 'recall': 0.493997, 'specificity': 0.493997, 'f1': 0.48709306, 'auroc': 0.8253479, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.987994, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5925  72
1   242   0
early stop counter: 1
val acc:0.9500879049301147, best validation acc: 0.9528045654296875, corresponding to test acc:                         0.9583266377449036 / 0.9583266377449036
after epoch: 2,now: 2024-07-26 21:12:51.369962,epoch time: 0:19:09.075914,used: 0:38:47.262407,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.98060584, 'precision': 0.98449373, 'recall': 0.96554005, 'specificity': 0.96554005, 'f1': 0.9745189, 'auroc': 0.9946008, 'binary_precision': 0.9922034, 'binary_recall': 0.9337035, 'binary_specificity': 0.99737656, 'binary_f1_score': 0.962065}
confusion matrix:
       0      1
0  42200    111
1   1003  14126
---- Validation: 
scalar performance:
{'acc': 0.9572791, 'precision': 0.5683926, 'recall': 0.53464913, 'specificity': 0.53464913, 'f1': 0.5444892, 'auroc': 0.8774098, 'binary_precision': 0.16666667, 'binary_recall': 0.08305648, 'binary_specificity': 0.9862418, 'binary_f1_score': 0.11086474}
confusion matrix:
       0    1
0  17921  250
1    552   50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.48053098, 'recall': 0.497999, 'specificity': 0.497999, 'f1': 0.48910907, 'auroc': 0.8465121, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.995998, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5973  24
1   242   0
better model found
persisted
after epoch: 3,now: 2024-07-26 21:32:13.077855,epoch time: 0:19:21.707893,used: 0:58:08.970300,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9867862, 'precision': 0.9872205, 'recall': 0.9786313, 'specificity': 0.9786313, 'f1': 0.98282295, 'auroc': 0.997089, 'binary_precision': 0.98811144, 'binary_recall': 0.96139866, 'binary_specificity': 0.995864, 'binary_f1_score': 0.974572}
confusion matrix:
       0      1
0  42136    175
1    584  14545
---- Validation: 
scalar performance:
{'acc': 0.95376337, 'precision': 0.6536642, 'recall': 0.6942458, 'specificity': 0.6942458, 'f1': 0.67121476, 'auroc': 0.8846084, 'binary_precision': 0.3268229, 'binary_recall': 0.41694352, 'binary_specificity': 0.9715481, 'binary_f1_score': 0.36642334}
confusion matrix:
       0    1
0  17654  517
1    351  251
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95640326, 'precision': 0.5100725, 'recall': 0.50146425, 'specificity': 0.50146425, 'f1': 0.4961007, 'auroc': 0.84580564, 'binary_precision': 0.05882353, 'binary_recall': 0.008264462, 'binary_specificity': 0.994664, 'binary_f1_score': 0.014492753}
confusion matrix:
      0   1
0  5965  32
1   240   2
early stop counter: 1
val acc:0.9537633657455444, best validation acc: 0.9572790861129761, corresponding to test acc:                         0.9573649764060974 / 0.9583266377449036
after epoch: 4,now: 2024-07-26 21:51:25.972486,epoch time: 0:19:12.894631,used: 1:17:21.864931,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.98962396, 'precision': 0.9892813, 'recall': 0.98391306, 'specificity': 0.98391306, 'f1': 0.986557, 'auroc': 0.997737, 'binary_precision': 0.98857063, 'binary_recall': 0.971844, 'binary_specificity': 0.99598205, 'binary_f1_score': 0.980136}
confusion matrix:
       0      1
0  42140    170
1    426  14704
---- Validation: 
scalar performance:
{'acc': 0.94129866, 'precision': 0.62323534, 'recall': 0.71189845, 'specificity': 0.71189845, 'f1': 0.6535143, 'auroc': 0.8708722, 'binary_precision': 0.2645951, 'binary_recall': 0.4667774, 'binary_specificity': 0.95701945, 'binary_f1_score': 0.3377404}
confusion matrix:
       0    1
0  17390  781
1    321  281
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95383877, 'precision': 0.4909529, 'recall': 0.4981475, 'specificity': 0.4981475, 'f1': 0.49163336, 'auroc': 0.83304065, 'binary_precision': 0.020833334, 'binary_recall': 0.004132231, 'binary_specificity': 0.99216276, 'binary_f1_score': 0.0068965517}
confusion matrix:
      0   1
0  5950  47
1   241   1
early stop counter: 2
val acc:0.9412986636161804, best validation acc: 0.9572790861129761, corresponding to test acc:                         0.9573649764060974 / 0.9583266377449036
after epoch: 5,now: 2024-07-26 22:10:45.779475,epoch time: 0:19:19.806989,used: 1:36:41.671920,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9874652, 'precision': 0.9900625, 'recall': 0.9776498, 'specificity': 0.9776498, 'f1': 0.9836439, 'auroc': 0.9981127, 'binary_precision': 0.99532515, 'binary_recall': 0.9569068, 'binary_specificity': 0.9983928, 'binary_f1_score': 0.975738}
confusion matrix:
       0      1
0  42242     68
1    652  14478
---- Validation: 
scalar performance:
{'acc': 0.9525382, 'precision': 0.657707, 'recall': 0.7233257, 'specificity': 0.7233257, 'f1': 0.6839711, 'auroc': 0.88629234, 'binary_precision': 0.33294797, 'binary_recall': 0.47840533, 'binary_specificity': 0.9682461, 'binary_f1_score': 0.39263803}
confusion matrix:
       0    1
0  17594  577
1    314  288
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9570444, 'precision': 0.48052472, 'recall': 0.49783224, 'specificity': 0.49783224, 'f1': 0.48902538, 'auroc': 0.8493539, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5971  26
1   242   0
early stop counter: 3
val acc:0.9525381922721863, best validation acc: 0.9572790861129761, corresponding to test acc:                         0.9573649764060974 / 0.9583266377449036
after epoch: 6,now: 2024-07-26 22:30:19.637447,epoch time: 0:19:33.857972,used: 1:56:15.529892,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.99206126, 'precision': 0.9941286, 'recall': 0.9854392, 'specificity': 0.9854392, 'f1': 0.9896804, 'auroc': 0.9983182, 'binary_precision': 0.9983697, 'binary_recall': 0.97144556, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.9847236}
confusion matrix:
       0      1
0  42287     24
1    432  14697
---- Validation: 
scalar performance:
{'acc': 0.9679859, 'precision': 0.7377961, 'recall': 0.58354455, 'specificity': 0.58354455, 'f1': 0.620374, 'auroc': 0.8883853, 'binary_precision': 0.5024155, 'binary_recall': 0.17275748, 'binary_specificity': 0.9943316, 'binary_f1_score': 0.25710756}
confusion matrix:
       0    1
0  18068  103
1    498  104
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9591281, 'precision': 0.48056537, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48956886, 'auroc': 0.7978853, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   242   0
new oracle model saved
better model found
persisted
after epoch: 7,now: 2024-07-26 22:49:38.545986,epoch time: 0:19:18.908539,used: 2:15:34.438431,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9928099, 'precision': 0.99370396, 'recall': 0.987752, 'specificity': 0.987752, 'f1': 0.99067926, 'auroc': 0.9984984, 'binary_precision': 0.995555, 'binary_recall': 0.9770639, 'binary_specificity': 0.99844015, 'binary_f1_score': 0.9862228}
confusion matrix:
       0      1
0  42245     66
1    347  14782
---- Validation: 
scalar performance:
{'acc': 0.9627657, 'precision': 0.69256556, 'recall': 0.66677415, 'specificity': 0.66677415, 'f1': 0.67862976, 'auroc': 0.8938502, 'binary_precision': 0.40655106, 'binary_recall': 0.35049835, 'binary_specificity': 0.9830499, 'binary_f1_score': 0.3764496}
confusion matrix:
       0    1
0  17863  308
1    391  211
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9570444, 'precision': 0.48052472, 'recall': 0.49783224, 'specificity': 0.49783224, 'f1': 0.48902538, 'auroc': 0.80824363, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9956645, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5971  26
1   242   0
early stop counter: 1
val acc:0.9627656936645508, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9591280817985535 / 0.9591280817985535
after epoch: 8,now: 2024-07-26 23:08:48.536435,epoch time: 0:19:09.990449,used: 2:34:44.428880,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.99195683, 'precision': 0.9941708, 'recall': 0.9851357, 'specificity': 0.9851357, 'f1': 0.9895414, 'auroc': 0.99890447, 'binary_precision': 0.998708, 'binary_recall': 0.9707204, 'binary_specificity': 0.99955094, 'binary_f1_score': 0.98451537}
confusion matrix:
       0      1
0  42291     19
1    443  14687
---- Validation: 
scalar performance:
{'acc': 0.9646833, 'precision': 0.57381356, 'recall': 0.5119733, 'specificity': 0.5119733, 'f1': 0.5153941, 'auroc': 0.86292875, 'binary_precision': 0.17894737, 'binary_recall': 0.028239202, 'binary_specificity': 0.99570745, 'binary_f1_score': 0.048780486}
confusion matrix:
       0   1
0  18093  78
1    585  17
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.957365, 'precision': 0.48053098, 'recall': 0.497999, 'specificity': 0.497999, 'f1': 0.48910907, 'auroc': 0.75293535, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.995998, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5973  24
1   242   0
early stop counter: 2
val acc:0.9646832942962646, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9591280817985535 / 0.9591280817985535
after epoch: 9,now: 2024-07-26 23:28:00.384894,epoch time: 0:19:11.848459,used: 2:53:56.277339,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.9942723, 'precision': 0.9956113, 'recall': 0.989637, 'specificity': 0.989637, 'f1': 0.9925753, 'auroc': 0.9989213, 'binary_precision': 0.9983837, 'binary_recall': 0.97984135, 'binary_specificity': 0.99943274, 'binary_f1_score': 0.98902565}
confusion matrix:
       0      1
0  42286     24
1    305  14825
---- Validation: 
scalar performance:
{'acc': 0.96665424, 'precision': 0.71343946, 'recall': 0.59249324, 'specificity': 0.59249324, 'f1': 0.6266668, 'auroc': 0.87343186, 'binary_precision': 0.453125, 'binary_recall': 0.19269103, 'binary_specificity': 0.99229544, 'binary_f1_score': 0.27039626}
confusion matrix:
       0    1
0  18031  140
1    486  116
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.7942423, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
new oracle model saved
early stop counter: 3
val acc:0.9666542410850525, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9591280817985535 / 0.9607309103012085
after epoch: 10,now: 2024-07-26 23:47:25.869218,epoch time: 0:19:25.484324,used: 3:13:21.761663,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9943941, 'precision': 0.9929415, 'recall': 0.99260634, 'specificity': 0.99260634, 'f1': 0.9927738, 'auroc': 0.99921775, 'binary_precision': 0.9898756, 'binary_recall': 0.98882866, 'binary_specificity': 0.996384, 'binary_f1_score': 0.9893519}
confusion matrix:
       0      1
0  42159    153
1    169  14959
---- Validation: 
scalar performance:
{'acc': 0.92856765, 'precision': 0.62185276, 'recall': 0.7912482, 'specificity': 0.7912482, 'f1': 0.664353, 'auroc': 0.89367366, 'binary_precision': 0.2561056, 'binary_recall': 0.64451826, 'binary_specificity': 0.9379781, 'binary_f1_score': 0.36655644}
confusion matrix:
       0     1
0  17044  1127
1    214   388
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9379708, 'precision': 0.54811496, 'recall': 0.53946185, 'specificity': 0.53946185, 'f1': 0.54315275, 'auroc': 0.8116827, 'binary_precision': 0.13197969, 'binary_recall': 0.10743801, 'binary_specificity': 0.97148573, 'binary_f1_score': 0.11845102}
confusion matrix:
      0    1
0  5826  171
1   216   26
early stop counter: 4
val acc:0.92856764793396, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9591280817985535 / 0.9607309103012085
after epoch: 11,now: 2024-07-27 00:06:43.262073,epoch time: 0:19:17.392855,used: 3:32:39.154518,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.993071, 'precision': 0.99518365, 'recall': 0.9869951, 'specificity': 0.9869951, 'f1': 0.9909977, 'auroc': 0.99903375, 'binary_precision': 0.99952525, 'binary_recall': 0.9741556, 'binary_specificity': 0.99983454, 'binary_f1_score': 0.9866774}
confusion matrix:
       0      1
0  42304      7
1    391  14738
---- Validation: 
scalar performance:
{'acc': 0.9665477, 'precision': 0.530894, 'recall': 0.5016937, 'specificity': 0.5016937, 'f1': 0.49622515, 'auroc': 0.87821746, 'binary_precision': 0.09375, 'binary_recall': 0.004983389, 'binary_specificity': 0.998404, 'binary_f1_score': 0.009463723}
confusion matrix:
       0   1
0  18142  29
1    599   3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9604103, 'precision': 0.4805903, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.4899027, 'auroc': 0.809065, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   242  0
early stop counter: 5
val acc:0.9665477275848389, best validation acc: 0.9679859280586243, corresponding to test acc:                         0.9591280817985535 / 0.9607309103012085
after epoch: 12,now: 2024-07-27 00:26:00.482357,epoch time: 0:19:17.220284,used: 3:51:56.374802,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_20_34_04_seed_2_23070005
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 12 with time: 3:51:56.374802 at 2024-07-27 00:26:00.482357
persisted model performance metric: 

scalar performance:
{'acc': 0.9591281, 'precision': 0.48056537, 'recall': 0.49891612, 'specificity': 0.49891612, 'f1': 0.48956886, 'auroc': 0.7978853, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99783224, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5984  13
1   242   0
oracle model performance metric: 

scalar performance:
{'acc': 0.9607309, 'precision': 0.48059654, 'recall': 0.49974987, 'specificity': 0.49974987, 'f1': 0.4899861, 'auroc': 0.7942423, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99949974, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5994  3
1   242  0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/1.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/1.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 454456 KiB |   2003 MiB |   1344 TiB |   1344 TiB |
|       from large pool | 412775 KiB |   1971 MiB |   1328 TiB |   1328 TiB |
|       from small pool |  41681 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 454456 KiB |   2003 MiB |   1344 TiB |   1344 TiB |
|       from large pool | 412775 KiB |   1971 MiB |   1328 TiB |   1328 TiB |
|       from small pool |  41681 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447753 KiB |   1998 MiB |   1343 TiB |   1343 TiB |
|       from large pool | 407075 KiB |   1966 MiB |   1326 TiB |   1326 TiB |
|       from small pool |  40678 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2278 MiB |   2282 MiB |   5268 MiB |   2990 MiB |
|       from large pool |   2214 MiB |   2214 MiB |   5168 MiB |   2954 MiB |
|       from small pool |     64 MiB |     70 MiB |    100 MiB |     36 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 325831 KiB | 457405 KiB |   1016 TiB |   1016 TiB |
|       from large pool | 318361 KiB | 444488 KiB |    998 TiB |    998 TiB |
|       from small pool |   7470 KiB |  22399 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |    3476    |    8165    |  258701 K  |  258698 K  |
|       from large pool |     187    |     311    |  126055 K  |  126054 K  |
|       from small pool |    3289    |    7977    |  132646 K  |  132643 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    3476    |    8165    |  258701 K  |  258698 K  |
|       from large pool |     187    |     311    |  126055 K  |  126054 K  |
|       from small pool |    3289    |    7977    |  132646 K  |  132643 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     127    |     261    |     136    |
|       from large pool |      93    |      93    |     211    |     118    |
|       from small pool |      32    |      35    |      50    |      18    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |    3640    |  138531 K  |  138531 K  |
|       from large pool |      35    |      93    |   87252 K  |   87252 K  |
|       from small pool |      31    |    3605    |   51278 K  |   51278 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   2003 MiB |   1344 TiB |   1344 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1328 TiB |   1328 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   2003 MiB |   1344 TiB |   1344 TiB |
|       from large pool |  16640 KiB |   1971 MiB |   1328 TiB |   1328 TiB |
|       from small pool |      0 KiB |     61 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   1998 MiB |   1343 TiB |   1343 TiB |
|       from large pool |  16640 KiB |   1966 MiB |   1326 TiB |   1326 TiB |
|       from small pool |      0 KiB |     60 MiB |     16 TiB |     16 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 780288 KiB |   2282 MiB |   5268 MiB |   4506 MiB |
|       from large pool | 731136 KiB |   2214 MiB |   5168 MiB |   4454 MiB |
|       from small pool |  49152 KiB |     70 MiB |    100 MiB |     52 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24320 KiB | 457405 KiB |   1016 TiB |   1016 TiB |
|       from large pool |  24320 KiB | 444488 KiB |    998 TiB |    998 TiB |
|       from small pool |      0 KiB |  22399 KiB |     17 TiB |     17 TiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    8165    |  258701 K  |  258701 K  |
|       from large pool |       2    |     311    |  126055 K  |  126055 K  |
|       from small pool |       0    |    7977    |  132646 K  |  132646 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    8165    |  258701 K  |  258701 K  |
|       from large pool |       2    |     311    |  126055 K  |  126055 K  |
|       from small pool |       0    |    7977    |  132646 K  |  132646 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      57    |     127    |     261    |     204    |
|       from large pool |      33    |      93    |     211    |     178    |
|       from small pool |      24    |      35    |      50    |      26    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |    3640    |  138532 K  |  138532 K  |
|       from large pool |       3    |      93    |   87252 K  |   87252 K  |
|       from small pool |       0    |    3605    |   51279 K  |   51279 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

[Sat Jul 27 00:27:02 2024]
Finished job 0.
1 of 1 steps (100%) done
