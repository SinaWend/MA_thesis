Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 12:22:32 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/10.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=10
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003

 Experiment start at: 2024-07-26 12:29:40.362238
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9791316, 'precision': 0.9863231, 'recall': 0.95955133, 'specificity': 0.95955133, 'f1': 0.97198987, 'auroc': 0.9986743, 'binary_precision': 1.0, 'binary_recall': 0.91910267, 'binary_specificity': 1.0, 'binary_f1_score': 0.9578463}
confusion matrix:
       0      1
0  42314      0
1   1190  13520
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9656769, 'precision': 0.6079146, 'recall': 0.500695, 'specificity': 0.500695, 'f1': 0.49281454, 'auroc': 0.9409862, 'binary_precision': 0.25, 'binary_recall': 0.00155521, 'binary_specificity': 0.9998347, 'binary_f1_score': 0.0030911902}
confusion matrix:
       0  1
0  18146  3
1    642  1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9581336, 'precision': 0.47914335, 'recall': 0.4999166, 'specificity': 0.4999166, 'f1': 0.48930964, 'auroc': 0.9336046, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5996  1
1   261  0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:53:14.938915,epoch time: 0:23:34.576677,used: 0:23:34.576677,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9957386, 'precision': 0.99687046, 'recall': 0.9920058, 'specificity': 0.9920058, 'f1': 0.99440694, 'auroc': 0.9995198, 'binary_precision': 0.99917185, 'binary_recall': 0.9842953, 'binary_specificity': 0.9997164, 'binary_f1_score': 0.9916778}
confusion matrix:
       0      1
0  42303     12
1    231  14478
---- Validation: 
scalar performance:
{'acc': 0.96737975, 'precision': 0.75523263, 'recall': 0.6883403, 'specificity': 0.6883403, 'f1': 0.71621424, 'auroc': 0.94656336, 'binary_precision': 0.5319149, 'binary_recall': 0.3888025, 'binary_specificity': 0.98787814, 'binary_f1_score': 0.4492363}
confusion matrix:
       0    1
0  17929  220
1    393  250
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9683605, 'precision': 0.84301853, 'recall': 0.69948, 'specificity': 0.69948, 'f1': 0.7503588, 'auroc': 0.9405262, 'binary_precision': 0.7114094, 'binary_recall': 0.40613025, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.51707315}
confusion matrix:
      0    1
0  5954   43
1   155  106
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 13:16:45.083006,epoch time: 0:23:30.144091,used: 0:47:04.720768,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9947741, 'precision': 0.99477684, 'recall': 0.991557, 'specificity': 0.991557, 'f1': 0.99315315, 'auroc': 0.9993781, 'binary_precision': 0.9947824, 'binary_recall': 0.98491025, 'binary_specificity': 0.9982038, 'binary_f1_score': 0.9898217}
confusion matrix:
       0      1
0  42236     76
1    222  14490
---- Validation: 
scalar performance:
{'acc': 0.955513, 'precision': 0.68439066, 'recall': 0.7407011, 'specificity': 0.7407011, 'f1': 0.7082576, 'auroc': 0.9251815, 'binary_precision': 0.38633686, 'binary_recall': 0.5101089, 'binary_specificity': 0.9712932, 'binary_f1_score': 0.43967828}
confusion matrix:
       0    1
0  17628  521
1    315  328
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9480665, 'precision': 0.66428316, 'recall': 0.64308304, 'specificity': 0.64308304, 'f1': 0.65281546, 'auroc': 0.9218046, 'binary_precision': 0.35840708, 'binary_recall': 0.31034482, 'binary_specificity': 0.97582126, 'binary_f1_score': 0.33264887}
confusion matrix:
      0    1
0  5852  145
1   180   81
early stop counter: 1
val acc:0.9555130004882812, best validation acc: 0.9673797488212585, corresponding to test acc:                         0.9683604836463928 / 0.9683604836463928
after epoch: 3,now: 2024-07-26 13:39:40.728169,epoch time: 0:22:55.645163,used: 1:10:00.365931,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9923716, 'precision': 0.99488837, 'recall': 0.9852383, 'specificity': 0.9852383, 'f1': 0.9899405, 'auroc': 0.99960756, 'binary_precision': 0.99992996, 'binary_recall': 0.9705003, 'binary_specificity': 0.99997634, 'binary_f1_score': 0.98499537}
confusion matrix:
       0      1
0  42311      1
1    434  14278
---- Validation: 
scalar performance:
{'acc': 0.968178, 'precision': 0.9022362, 'recall': 0.5432428, 'specificity': 0.5432428, 'f1': 0.57076454, 'auroc': 0.9440417, 'binary_precision': 0.8358209, 'binary_recall': 0.08709176, 'binary_specificity': 0.9993939, 'binary_f1_score': 0.15774648}
confusion matrix:
       0   1
0  18138  11
1    587  56
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.7292199, 'recall': 0.5018323, 'specificity': 0.5018323, 'f1': 0.49315178, 'auroc': 0.9319505, 'binary_precision': 0.5, 'binary_recall': 0.0038314175, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.007604562}
confusion matrix:
      0  1
0  5996  1
1   260  1
better model found
persisted
after epoch: 4,now: 2024-07-26 14:02:38.561956,epoch time: 0:22:57.833787,used: 1:32:58.199718,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99647516, 'precision': 0.996979, 'recall': 0.99381137, 'specificity': 0.99381137, 'f1': 0.99538195, 'auroc': 0.99960274, 'binary_precision': 0.9980093, 'binary_recall': 0.9883081, 'binary_specificity': 0.9993146, 'binary_f1_score': 0.993135}
confusion matrix:
       0      1
0  42284     29
1    172  14539
---- Validation: 
scalar performance:
{'acc': 0.97195613, 'precision': 0.7905002, 'recall': 0.7717155, 'specificity': 0.7717155, 'f1': 0.7807621, 'auroc': 0.9598113, 'binary_precision': 0.5966667, 'binary_recall': 0.55676514, 'binary_specificity': 0.9866659, 'binary_f1_score': 0.5760257}
confusion matrix:
       0    1
0  17907  242
1    285  358
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95190156, 'precision': 0.67430216, 'recall': 0.61393434, 'specificity': 0.61393434, 'f1': 0.63673276, 'auroc': 0.9170383, 'binary_precision': 0.3809524, 'binary_recall': 0.24521072, 'binary_specificity': 0.98265797, 'binary_f1_score': 0.2983683}
confusion matrix:
      0    1
0  5893  104
1   197   64
better model found
persisted
after epoch: 5,now: 2024-07-26 14:33:22.155850,epoch time: 0:30:43.593894,used: 2:03:41.793612,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.9963875, 'precision': 0.99750924, 'recall': 0.99306405, 'specificity': 0.99306405, 'f1': 0.9952606, 'auroc': 0.99975026, 'binary_precision': 0.99979323, 'binary_recall': 0.9861989, 'binary_specificity': 0.99992913, 'binary_f1_score': 0.99294955}
confusion matrix:
       0      1
0  42312      3
1    203  14506
---- Validation: 
scalar performance:
{'acc': 0.9729672, 'precision': 0.9119934, 'recall': 0.6267283, 'specificity': 0.6267283, 'f1': 0.6892603, 'auroc': 0.9642608, 'binary_precision': 0.8497409, 'binary_recall': 0.25505444, 'binary_specificity': 0.9984021, 'binary_f1_score': 0.3923445}
confusion matrix:
       0    1
0  18120   29
1    479  164
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.95772696, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
better model found
persisted
after epoch: 6,now: 2024-07-26 14:57:38.421088,epoch time: 0:24:16.265238,used: 2:27:58.058850,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9973345, 'precision': 0.99744606, 'recall': 0.9955871, 'specificity': 0.9955871, 'f1': 0.99651206, 'auroc': 0.999845, 'binary_precision': 0.99767524, 'binary_recall': 0.9919777, 'binary_specificity': 0.9991965, 'binary_f1_score': 0.99481833}
confusion matrix:
       0      1
0  42281     34
1    118  14591
---- Validation: 
scalar performance:
{'acc': 0.9667944, 'precision': 0.7488302, 'recall': 0.7555423, 'specificity': 0.7555423, 'f1': 0.75213647, 'auroc': 0.9535799, 'binary_precision': 0.51437217, 'binary_recall': 0.5287714, 'binary_specificity': 0.9823131, 'binary_f1_score': 0.52147245}
confusion matrix:
       0    1
0  17828  321
1    303  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.96340686, 'precision': 0.85060346, 'recall': 0.59428465, 'specificity': 0.59428465, 'f1': 0.64258045, 'auroc': 0.9486025, 'binary_precision': 0.7352941, 'binary_recall': 0.19157088, 'binary_specificity': 0.9969985, 'binary_f1_score': 0.30395135}
confusion matrix:
      0   1
0  5979  18
1   211  50
early stop counter: 1
val acc:0.9667943716049194, best validation acc: 0.9729672074317932, corresponding to test acc:                         0.9586129784584045 / 0.9683604836463928
after epoch: 7,now: 2024-07-26 15:22:57.514744,epoch time: 0:25:19.093656,used: 2:53:17.152506,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.99393237, 'precision': 0.9953199, 'recall': 0.9888431, 'specificity': 0.9888431, 'f1': 0.99202603, 'auroc': 0.99870086, 'binary_precision': 0.99812824, 'binary_recall': 0.9783244, 'binary_specificity': 0.9993618, 'binary_f1_score': 0.9881272}
confusion matrix:
       0      1
0  42280     27
1    319  14398
---- Validation: 
scalar performance:
{'acc': 0.97051936, 'precision': 0.82657635, 'recall': 0.6292113, 'specificity': 0.6292113, 'f1': 0.68191254, 'auroc': 0.94534856, 'binary_precision': 0.6787149, 'binary_recall': 0.2628305, 'binary_specificity': 0.99559206, 'binary_f1_score': 0.3789238}
confusion matrix:
       0    1
0  18069   80
1    474  169
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9602109, 'precision': 0.83073217, 'recall': 0.5394795, 'specificity': 0.5394795, 'f1': 0.5619809, 'auroc': 0.9081241, 'binary_precision': 0.7, 'binary_recall': 0.08045977, 'binary_specificity': 0.9984993, 'binary_f1_score': 0.1443299}
confusion matrix:
      0   1
0  5988   9
1   240  21
early stop counter: 2
val acc:0.9705193638801575, best validation acc: 0.9729672074317932, corresponding to test acc:                         0.9586129784584045 / 0.9683604836463928
after epoch: 8,now: 2024-07-26 15:45:47.487838,epoch time: 0:22:49.973094,used: 3:16:07.125600,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9974046, 'precision': 0.998212, 'recall': 0.9950144, 'specificity': 0.9950144, 'f1': 0.99659973, 'auroc': 0.99983454, 'binary_precision': 0.99986273, 'binary_recall': 0.9900761, 'binary_specificity': 0.99995273, 'binary_f1_score': 0.99494535}
confusion matrix:
       0      1
0  42310      2
1    146  14566
---- Validation: 
scalar performance:
{'acc': 0.96977437, 'precision': 0.8831186, 'recall': 0.5778218, 'specificity': 0.5778218, 'f1': 0.62345433, 'auroc': 0.967158, 'binary_precision': 0.79527557, 'binary_recall': 0.15707621, 'binary_specificity': 0.9985674, 'binary_f1_score': 0.26233765}
confusion matrix:
       0    1
0  18123   26
1    542  101
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.47913003, 'recall': 0.49958313, 'specificity': 0.49958313, 'f1': 0.48914286, 'auroc': 0.9498726, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5992  5
1   261  0
early stop counter: 3
val acc:0.9697743654251099, best validation acc: 0.9729672074317932, corresponding to test acc:                         0.9586129784584045 / 0.9683604836463928
after epoch: 9,now: 2024-07-26 16:22:20.326468,epoch time: 0:36:32.838630,used: 3:52:39.964230,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99829894, 'precision': 0.99876654, 'recall': 0.9967921, 'specificity': 0.9967921, 'f1': 0.9977741, 'auroc': 0.9998841, 'binary_precision': 0.9997265, 'binary_recall': 0.9936786, 'binary_specificity': 0.99990547, 'binary_f1_score': 0.9966934}
confusion matrix:
       0      1
0  42308      4
1     93  14619
---- Validation: 
scalar performance:
{'acc': 0.9675926, 'precision': 0.83103275, 'recall': 0.54669005, 'specificity': 0.54669005, 'f1': 0.57518476, 'auroc': 0.9664112, 'binary_precision': 0.6931818, 'binary_recall': 0.09486781, 'binary_specificity': 0.9985123, 'binary_f1_score': 0.16689467}
confusion matrix:
       0   1
0  18122  27
1    582  61
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574944, 'precision': 0.6157137, 'recall': 0.5050801, 'specificity': 0.5050801, 'f1': 0.5001669, 'auroc': 0.94515204, 'binary_precision': 0.27272728, 'binary_recall': 0.011494253, 'binary_specificity': 0.998666, 'binary_f1_score': 0.022058824}
confusion matrix:
      0  1
0  5989  8
1   258  3
early stop counter: 4
val acc:0.9675925970077515, best validation acc: 0.9729672074317932, corresponding to test acc:                         0.9586129784584045 / 0.9683604836463928
after epoch: 10,now: 2024-07-26 16:51:00.957546,epoch time: 0:28:40.631078,used: 4:21:20.595308,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9942305, 'precision': 0.9915204, 'recall': 0.9934528, 'specificity': 0.9934528, 'f1': 0.9924816, 'auroc': 0.99976003, 'binary_precision': 0.9858832, 'binary_recall': 0.9918456, 'binary_specificity': 0.99506, 'binary_f1_score': 0.98885536}
confusion matrix:
       0      1
0  42099    209
1    120  14596
---- Validation: 
scalar performance:
{'acc': 0.96062154, 'precision': 0.6835268, 'recall': 0.63008744, 'specificity': 0.63008744, 'f1': 0.6516518, 'auroc': 0.9359262, 'binary_precision': 0.3924612, 'binary_recall': 0.27527216, 'binary_specificity': 0.98490274, 'binary_f1_score': 0.3235832}
confusion matrix:
       0    1
0  17875  274
1    466  177
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9582934, 'precision': 0.74173975, 'recall': 0.7986704, 'specificity': 0.7986704, 'f1': 0.7667434, 'auroc': 0.9202015, 'binary_precision': 0.5, 'binary_recall': 0.6245211, 'binary_specificity': 0.97281975, 'binary_f1_score': 0.5553663}
confusion matrix:
      0    1
0  5834  163
1    98  163
early stop counter: 5
val acc:0.9606215357780457, best validation acc: 0.9729672074317932, corresponding to test acc:                         0.9586129784584045 / 0.9683604836463928
after epoch: 11,now: 2024-07-26 17:19:15.293774,epoch time: 0:28:14.336228,used: 4:49:34.931536,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_29_40_seed_0_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 4:49:34.931536 at 2024-07-26 17:19:15.293774
persisted model performance metric: 

scalar performance:
{'acc': 0.958613, 'precision': 0.9792999, 'recall': 0.50383145, 'specificity': 0.50383145, 'f1': 0.4970357, 'auroc': 0.95772696, 'binary_precision': 1.0, 'binary_recall': 0.007662835, 'binary_specificity': 1.0, 'binary_f1_score': 0.015209124}
confusion matrix:
      0  1
0  5997  0
1   259  2
oracle model performance metric: 

scalar performance:
{'acc': 0.9683605, 'precision': 0.84301853, 'recall': 0.69948, 'specificity': 0.69948, 'f1': 0.7503588, 'auroc': 0.9405262, 'binary_precision': 0.7114094, 'binary_recall': 0.40613025, 'binary_specificity': 0.99282974, 'binary_f1_score': 0.51707315}
confusion matrix:
      0    1
0  5954   43
1   155  106
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/10.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452684 KiB |   6932 MiB | 401925 GiB | 401924 GiB |
|       from large pool | 411879 KiB |   6897 MiB | 400504 GiB | 400504 GiB |
|       from small pool |  40805 KiB |     56 MiB |   1420 GiB |   1420 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 452684 KiB |   6932 MiB | 401925 GiB | 401924 GiB |
|       from large pool | 411879 KiB |   6897 MiB | 400504 GiB | 400504 GiB |
|       from small pool |  40805 KiB |     56 MiB |   1420 GiB |   1420 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   6928 MiB | 401897 GiB | 401897 GiB |
|       from large pool | 407075 KiB |   6894 MiB | 400478 GiB | 400478 GiB |
|       from small pool |  40679 KiB |     56 MiB |   1418 GiB |   1418 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7286 MiB |   7286 MiB |   7286 MiB |      0 B   |
|       from large pool |   7222 MiB |   7222 MiB |   7222 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 602035 KiB |    845 MiB | 180436 GiB | 180435 GiB |
|       from large pool | 591641 KiB |    840 MiB | 178962 GiB | 178961 GiB |
|       from small pool |  10394 KiB |     13 MiB |   1473 GiB |   1473 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1724    |    2767    |   20346 K  |   20344 K  |
|       from large pool |     187    |     311    |    9894 K  |    9894 K  |
|       from small pool |    1537    |    2579    |   10451 K  |   10449 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1724    |    2767    |   20346 K  |   20344 K  |
|       from large pool |     187    |     311    |    9894 K  |    9894 K  |
|       from small pool |    1537    |    2579    |   10451 K  |   10449 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     149    |     149    |     149    |       0    |
|       from large pool |     117    |     117    |     117    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      59    |     939    |   11865 K  |   11865 K  |
|       from large pool |      23    |     118    |    7607 K  |    7607 K  |
|       from small pool |      36    |     916    |    4258 K  |    4258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 401925 GiB | 401925 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 400504 GiB | 400504 GiB |
|       from small pool |      0 KiB |     56 MiB |   1420 GiB |   1420 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 401925 GiB | 401925 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 400504 GiB | 400504 GiB |
|       from small pool |      0 KiB |     56 MiB |   1420 GiB |   1420 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 401897 GiB | 401897 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 400478 GiB | 400478 GiB |
|       from small pool |      0 KiB |     56 MiB |   1418 GiB |   1418 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1030 MiB |   7286 MiB |   7286 MiB |   6256 MiB |
|       from large pool |    980 MiB |   7222 MiB |   7222 MiB |   6242 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 180436 GiB | 180436 GiB |
|       from large pool |   3840 KiB |    840 MiB | 178962 GiB | 178962 GiB |
|       from small pool |      0 KiB |     21 MiB |   1473 GiB |   1473 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   20346 K  |   20346 K  |
|       from large pool |       2    |     311    |    9894 K  |    9894 K  |
|       from small pool |       0    |    2579    |   10451 K  |   10451 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   20346 K  |   20346 K  |
|       from large pool |       2    |     311    |    9894 K  |    9894 K  |
|       from small pool |       0    |    2579    |   10451 K  |   10451 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     149    |     149    |      98    |
|       from large pool |      26    |     117    |     117    |      91    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     939    |   11866 K  |   11866 K  |
|       from large pool |       2    |     118    |    7607 K  |    7607 K  |
|       from small pool |       0    |     916    |    4258 K  |    4258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB | 401925 GiB | 401925 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 400504 GiB | 400504 GiB |
|       from small pool |      0 KiB |     56 MiB |   1420 GiB |   1420 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB | 401925 GiB | 401925 GiB |
|       from large pool |  16640 KiB |   6897 MiB | 400504 GiB | 400504 GiB |
|       from small pool |      0 KiB |     56 MiB |   1420 GiB |   1420 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB | 401897 GiB | 401897 GiB |
|       from large pool |  16640 KiB |   6894 MiB | 400478 GiB | 400478 GiB |
|       from small pool |      0 KiB |     56 MiB |   1418 GiB |   1418 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1030 MiB |   7286 MiB |   7286 MiB |   6256 MiB |
|       from large pool |    980 MiB |   7222 MiB |   7222 MiB |   6242 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 180436 GiB | 180436 GiB |
|       from large pool |   3840 KiB |    840 MiB | 178962 GiB | 178962 GiB |
|       from small pool |      0 KiB |     21 MiB |   1473 GiB |   1473 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   20346 K  |   20346 K  |
|       from large pool |       2    |     311    |    9894 K  |    9894 K  |
|       from small pool |       0    |    2579    |   10451 K  |   10451 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   20346 K  |   20346 K  |
|       from large pool |       2    |     311    |    9894 K  |    9894 K  |
|       from small pool |       0    |    2579    |   10451 K  |   10451 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      51    |     149    |     149    |      98    |
|       from large pool |      26    |     117    |     117    |      91    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     939    |   11866 K  |   11866 K  |
|       from large pool |       2    |     118    |    7607 K  |    7607 K  |
|       from small pool |       0    |     916    |    4258 K  |    4258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003

 Experiment start at: 2024-07-26 17:30:13.701330
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.99248666, 'precision': 0.9941729, 'recall': 0.98599327, 'specificity': 0.98599327, 'f1': 0.9899969, 'auroc': 0.99910915, 'binary_precision': 0.99751085, 'binary_recall': 0.97281176, 'binary_specificity': 0.9991748, 'binary_f1_score': 0.98500645}
confusion matrix:
       0      1
0  42379     35
1    392  14026
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.96766275, 'precision': 0.7729858, 'recall': 0.7035596, 'specificity': 0.7035596, 'f1': 0.73268086, 'auroc': 0.9193389, 'binary_precision': 0.56740445, 'binary_recall': 0.4190193, 'binary_specificity': 0.9880999, 'binary_f1_score': 0.4820513}
confusion matrix:
       0    1
0  17852  215
1    391  282
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95343214, 'precision': 0.64575475, 'recall': 0.549053, 'specificity': 0.549053, 'f1': 0.5691846, 'auroc': 0.88736904, 'binary_precision': 0.32941177, 'binary_recall': 0.10769231, 'binary_specificity': 0.9904137, 'binary_f1_score': 0.16231886}
confusion matrix:
      0   1
0  5889  57
1   232  28
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 17:56:30.739142,epoch time: 0:26:17.037812,used: 0:26:17.037812,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9900584, 'precision': 0.99174535, 'recall': 0.98198706, 'specificity': 0.98198706, 'f1': 0.98674303, 'auroc': 0.9987959, 'binary_precision': 0.9950686, 'binary_recall': 0.96560097, 'binary_specificity': 0.99837315, 'binary_f1_score': 0.9801134}
confusion matrix:
       0      1
0  42344     69
1    496  13923
---- Validation: 
scalar performance:
{'acc': 0.96691567, 'precision': 0.82238984, 'recall': 0.574424, 'specificity': 0.574424, 'f1': 0.6153294, 'auroc': 0.92996305, 'binary_precision': 0.6754967, 'binary_recall': 0.15156017, 'binary_specificity': 0.99728787, 'binary_f1_score': 0.24757281}
confusion matrix:
       0    1
0  18018   49
1    571  102
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9584273, 'precision': 0.8542809, 'recall': 0.50568515, 'specificity': 0.50568515, 'f1': 0.5007446, 'auroc': 0.9354055, 'binary_precision': 0.75, 'binary_recall': 0.011538462, 'binary_specificity': 0.9998318, 'binary_f1_score': 0.022727273}
confusion matrix:
      0  1
0  5945  1
1   257  3
new oracle model saved
early stop counter: 1
val acc:0.9669156670570374, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9534321427345276 / 0.9584273099899292
after epoch: 2,now: 2024-07-26 18:25:03.951164,epoch time: 0:28:33.212022,used: 0:54:50.249834,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9922051, 'precision': 0.9944918, 'recall': 0.9849577, 'specificity': 0.9849577, 'f1': 0.98960805, 'auroc': 0.99892676, 'binary_precision': 0.9990002, 'binary_recall': 0.97024554, 'binary_specificity': 0.9996699, 'binary_f1_score': 0.98441297}
confusion matrix:
       0      1
0  42400     14
1    429  13989
---- Validation: 
scalar performance:
{'acc': 0.9642476, 'precision': 0.7410233, 'recall': 0.53584635, 'specificity': 0.53584635, 'f1': 0.5558095, 'auroc': 0.9221026, 'binary_precision': 0.5154639, 'binary_recall': 0.0742942, 'binary_specificity': 0.99739856, 'binary_f1_score': 0.12987012}
confusion matrix:
       0   1
0  18020  47
1    623  50
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95762163, 'precision': 0.5791163, 'recall': 0.50158674, 'specificity': 0.50158674, 'f1': 0.49294788, 'auroc': 0.91301113, 'binary_precision': 0.2, 'binary_recall': 0.0038461538, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.00754717}
confusion matrix:
      0  1
0  5942  4
1   259  1
early stop counter: 2
val acc:0.9642475843429565, best validation acc: 0.9676627516746521, corresponding to test acc:                         0.9534321427345276 / 0.9584273099899292
after epoch: 3,now: 2024-07-26 18:53:46.672247,epoch time: 0:28:42.721083,used: 1:23:32.970917,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9959002, 'precision': 0.99584585, 'recall': 0.9933162, 'specificity': 0.9933162, 'f1': 0.99457276, 'auroc': 0.99957925, 'binary_precision': 0.99573636, 'binary_recall': 0.9880705, 'binary_specificity': 0.9985618, 'binary_f1_score': 0.9918886}
confusion matrix:
       0      1
0  42353     61
1    172  14246
---- Validation: 
scalar performance:
{'acc': 0.96958375, 'precision': 0.84161186, 'recall': 0.627307, 'specificity': 0.627307, 'f1': 0.6817475, 'auroc': 0.95067835, 'binary_precision': 0.71020406, 'binary_recall': 0.25854382, 'binary_specificity': 0.9960702, 'binary_f1_score': 0.37908497}
confusion matrix:
       0    1
0  17996   71
1    499  174
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9587496, 'precision': 0.8129911, 'recall': 0.51504827, 'specificity': 0.51504827, 'f1': 0.51886815, 'auroc': 0.92983127, 'binary_precision': 0.6666667, 'binary_recall': 0.03076923, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.05882353}
confusion matrix:
      0  1
0  5942  4
1   252  8
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 19:23:20.456753,epoch time: 0:29:33.784506,used: 1:53:06.755423,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.99537235, 'precision': 0.9956058, 'recall': 0.99216133, 'specificity': 0.99216133, 'f1': 0.99386823, 'auroc': 0.9996532, 'binary_precision': 0.99607486, 'binary_recall': 0.98564297, 'binary_specificity': 0.9986797, 'binary_f1_score': 0.99083143}
confusion matrix:
       0      1
0  42358     56
1    207  14211
---- Validation: 
scalar performance:
{'acc': 0.96723586, 'precision': 0.7722719, 'recall': 0.67830384, 'specificity': 0.67830384, 'f1': 0.7144836, 'auroc': 0.9493003, 'binary_precision': 0.5678161, 'binary_recall': 0.36701337, 'binary_specificity': 0.9895943, 'binary_f1_score': 0.44584835}
confusion matrix:
       0    1
0  17879  188
1    426  247
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95391554, 'precision': 0.6875697, 'recall': 0.6044749, 'specificity': 0.6044749, 'f1': 0.63237184, 'auroc': 0.91144854, 'binary_precision': 0.4084507, 'binary_recall': 0.22307692, 'binary_specificity': 0.98587286, 'binary_f1_score': 0.2885572}
confusion matrix:
      0   1
0  5862  84
1   202  58
early stop counter: 1
val acc:0.9672358632087708, best validation acc: 0.9695837497711182, corresponding to test acc:                         0.9587495923042297 / 0.9587495923042297
after epoch: 5,now: 2024-07-26 19:52:21.739258,epoch time: 0:29:01.282505,used: 2:22:08.037928,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.99646324, 'precision': 0.9973365, 'recall': 0.9933276, 'specificity': 0.9933276, 'f1': 0.99531144, 'auroc': 0.9997983, 'binary_precision': 0.99908733, 'binary_recall': 0.98696166, 'binary_specificity': 0.9996935, 'binary_f1_score': 0.9929875}
confusion matrix:
       0      1
0  42400     13
1    188  14231
---- Validation: 
scalar performance:
{'acc': 0.9702775, 'precision': 0.86366117, 'recall': 0.62623626, 'specificity': 0.62623626, 'f1': 0.6832853, 'auroc': 0.9584179, 'binary_precision': 0.75438595, 'binary_recall': 0.25557205, 'binary_specificity': 0.99690044, 'binary_f1_score': 0.381798}
confusion matrix:
       0    1
0  18011   56
1    501  172
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9572994, 'precision': 0.47903565, 'recall': 0.49957955, 'specificity': 0.49957955, 'f1': 0.489092, 'auroc': 0.94049263, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5941  5
1   260  0
better model found
persisted
after epoch: 6,now: 2024-07-26 20:21:02.437196,epoch time: 0:28:40.697938,used: 2:50:48.735866,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.9970263, 'precision': 0.997248, 'recall': 0.9948946, 'specificity': 0.9948946, 'f1': 0.99606425, 'auroc': 0.999833, 'binary_precision': 0.99769473, 'binary_recall': 0.9905673, 'binary_specificity': 0.999222, 'binary_f1_score': 0.9941183}
confusion matrix:
       0      1
0  42381     33
1    136  14282
---- Validation: 
scalar performance:
{'acc': 0.96792954, 'precision': 0.7894103, 'recall': 0.6514834, 'specificity': 0.6514834, 'f1': 0.6968613, 'auroc': 0.94029593, 'binary_precision': 0.6040462, 'binary_recall': 0.31054977, 'binary_specificity': 0.9924171, 'binary_f1_score': 0.41020608}
confusion matrix:
       0    1
0  17930  137
1    464  209
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95665485, 'precision': 0.47902212, 'recall': 0.4992432, 'specificity': 0.4992432, 'f1': 0.48892367, 'auroc': 0.9269362, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9984864, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5937  9
1   260  0
early stop counter: 1
val acc:0.9679295420646667, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.9572994112968445 / 0.9587495923042297
after epoch: 7,now: 2024-07-26 20:49:47.919687,epoch time: 0:28:45.482491,used: 3:19:34.218357,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9975366, 'precision': 0.9973613, 'recall': 0.9961297, 'specificity': 0.9961297, 'f1': 0.99674356, 'auroc': 0.9999341, 'binary_precision': 0.99700683, 'binary_recall': 0.99327326, 'binary_specificity': 0.9989861, 'binary_f1_score': 0.9951365}
confusion matrix:
       0      1
0  42369     43
1     97  14323
---- Validation: 
scalar performance:
{'acc': 0.9654749, 'precision': 0.7547085, 'recall': 0.6416272, 'specificity': 0.6416272, 'f1': 0.68036324, 'auroc': 0.95808667, 'binary_precision': 0.53532606, 'binary_recall': 0.29271916, 'binary_specificity': 0.99053526, 'binary_f1_score': 0.3784822}
confusion matrix:
       0    1
0  17896  171
1    476  197
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.959233, 'precision': 0.83290565, 'recall': 0.5226565, 'specificity': 0.5226565, 'f1': 0.5328969, 'auroc': 0.94477916, 'binary_precision': 0.7058824, 'binary_recall': 0.046153847, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0866426}
confusion matrix:
      0   1
0  5941   5
1   248  12
new oracle model saved
early stop counter: 2
val acc:0.9654749035835266, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.9572994112968445 / 0.9592329859733582
after epoch: 8,now: 2024-07-26 21:18:40.696808,epoch time: 0:28:52.777121,used: 3:48:26.995478,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9946333, 'precision': 0.99195695, 'recall': 0.99390984, 'specificity': 0.99390984, 'f1': 0.9929284, 'auroc': 0.9994074, 'binary_precision': 0.9864893, 'binary_recall': 0.99244106, 'binary_specificity': 0.9953787, 'binary_f1_score': 0.9894562}
confusion matrix:
       0      1
0  42216    196
1    109  14311
---- Validation: 
scalar performance:
{'acc': 0.96360725, 'precision': 0.74285954, 'recall': 0.8566693, 'specificity': 0.8566693, 'f1': 0.7874987, 'auroc': 0.9542778, 'binary_precision': 0.4955313, 'binary_recall': 0.74145615, 'binary_specificity': 0.97188246, 'binary_f1_score': 0.5940476}
confusion matrix:
       0    1
0  17559  508
1    174  499
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9650338, 'precision': 0.77874315, 'recall': 0.8144046, 'specificity': 0.8144046, 'f1': 0.7953538, 'auroc': 0.92934984, 'binary_precision': 0.57288134, 'binary_recall': 0.65, 'binary_specificity': 0.9788093, 'binary_f1_score': 0.609009}
confusion matrix:
      0    1
0  5820  126
1    91  169
new oracle model saved
early stop counter: 3
val acc:0.9636072516441345, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.9572994112968445 / 0.9650338292121887
after epoch: 9,now: 2024-07-26 21:47:27.832562,epoch time: 0:28:47.135754,used: 4:17:14.131232,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.99572426, 'precision': 0.99705696, 'recall': 0.9916657, 'specificity': 0.9916657, 'f1': 0.9943241, 'auroc': 0.99980533, 'binary_precision': 0.999718, 'binary_recall': 0.9834258, 'binary_specificity': 0.9999057, 'binary_f1_score': 0.99150497}
confusion matrix:
       0      1
0  42408      4
1    239  14181
---- Validation: 
scalar performance:
{'acc': 0.9688901, 'precision': 0.7999934, 'recall': 0.6641411, 'specificity': 0.6641411, 'f1': 0.7103591, 'auroc': 0.9548553, 'binary_precision': 0.6243094, 'binary_recall': 0.3358098, 'binary_specificity': 0.99247247, 'binary_f1_score': 0.43671495}
confusion matrix:
       0    1
0  17931  136
1    447  226
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9574605, 'precision': 0.479039, 'recall': 0.49966365, 'specificity': 0.49966365, 'f1': 0.489134, 'auroc': 0.93621486, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9993273, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5942  4
1   260  0
early stop counter: 4
val acc:0.9688900709152222, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.9572994112968445 / 0.9650338292121887
after epoch: 10,now: 2024-07-26 22:16:19.268948,epoch time: 0:28:51.436386,used: 4:46:05.567618,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.99695593, 'precision': 0.9955658, 'recall': 0.99640405, 'specificity': 0.99640405, 'f1': 0.995984, 'auroc': 0.99980915, 'binary_precision': 0.9927361, 'binary_recall': 0.99528366, 'binary_specificity': 0.9975244, 'binary_f1_score': 0.9940083}
confusion matrix:
       0      1
0  42309    105
1     68  14350
---- Validation: 
scalar performance:
{'acc': 0.9689968, 'precision': 0.76965314, 'recall': 0.88449883, 'specificity': 0.88449883, 'f1': 0.8157251, 'auroc': 0.96784407, 'binary_precision': 0.5471311, 'binary_recall': 0.7934621, 'binary_specificity': 0.9755355, 'binary_f1_score': 0.6476652}
confusion matrix:
       0    1
0  17625  442
1    139  534
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.98018044, 'precision': 0.89954454, 'recall': 0.83886003, 'specificity': 0.83886003, 'f1': 0.86645377, 'auroc': 0.9631082, 'binary_precision': 0.8127854, 'binary_recall': 0.6846154, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.743215}
confusion matrix:
      0    1
0  5905   41
1    82  178
new oracle model saved
early stop counter: 5
val acc:0.9689968228340149, best validation acc: 0.9702774882316589, corresponding to test acc:                         0.9572994112968445 / 0.9801804423332214
after epoch: 11,now: 2024-07-26 22:43:49.955726,epoch time: 0:27:30.686778,used: 5:13:36.254396,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_17_30_13_seed_1_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 11 with time: 5:13:36.254396 at 2024-07-26 22:43:49.955726
persisted model performance metric: 

scalar performance:
{'acc': 0.9572994, 'precision': 0.47903565, 'recall': 0.49957955, 'specificity': 0.49957955, 'f1': 0.489092, 'auroc': 0.94049263, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9991591, 'binary_f1_score': 0.0}
confusion matrix:
      0  1
0  5941  5
1   260  0
oracle model performance metric: 

scalar performance:
{'acc': 0.98018044, 'precision': 0.89954454, 'recall': 0.83886003, 'specificity': 0.83886003, 'f1': 0.86645377, 'auroc': 0.9631082, 'binary_precision': 0.8127854, 'binary_recall': 0.6846154, 'binary_specificity': 0.99310464, 'binary_f1_score': 0.743215}
confusion matrix:
      0    1
0  5905   41
1    82  178
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/10.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/10.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 449893 KiB |   6932 MiB |    783 TiB |    783 TiB |
|       from large pool | 409091 KiB |   6897 MiB |    780 TiB |    780 TiB |
|       from small pool |  40802 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 449893 KiB |   6932 MiB |    783 TiB |    783 TiB |
|       from large pool | 409091 KiB |   6897 MiB |    780 TiB |    780 TiB |
|       from small pool |  40802 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   6928 MiB |    783 TiB |    783 TiB |
|       from large pool | 407075 KiB |   6894 MiB |    780 TiB |    780 TiB |
|       from small pool |  40676 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7268 MiB |   7286 MiB |  13524 MiB |   6256 MiB |
|       from large pool |   7204 MiB |   7222 MiB |  13446 MiB |   6242 MiB |
|       from small pool |     64 MiB |     64 MiB |     78 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 711322 KiB |    845 MiB | 365514 GiB | 365513 GiB |
|       from large pool | 700925 KiB |    840 MiB | 362576 GiB | 362576 GiB |
|       from small pool |  10397 KiB |     21 MiB |   2937 GiB |   2937 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1718    |    2767    |   40619 K  |   40617 K  |
|       from large pool |     187    |     311    |   19754 K  |   19754 K  |
|       from small pool |    1531    |    2579    |   20864 K  |   20863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1718    |    2767    |   40619 K  |   40617 K  |
|       from large pool |     187    |     311    |   19754 K  |   19754 K  |
|       from small pool |    1531    |    2579    |   20864 K  |   20863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     146    |     149    |     244    |      98    |
|       from large pool |     114    |     117    |     205    |      91    |
|       from small pool |      32    |      32    |      39    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      69    |     943    |   23641 K  |   23641 K  |
|       from large pool |      31    |     118    |   15149 K  |   15149 K  |
|       from small pool |      38    |     916    |    8492 K  |    8492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB |    783 TiB |    783 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB |    783 TiB |    783 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB |    783 TiB |    783 TiB |
|       from large pool |  16640 KiB |   6894 MiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  13524 MiB |  12390 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  13446 MiB |  12362 MiB |
|       from small pool |     50 MiB |     64 MiB |     78 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 365514 GiB | 365514 GiB |
|       from large pool |   3840 KiB |    840 MiB | 362577 GiB | 362577 GiB |
|       from small pool |      0 KiB |     26 MiB |   2937 GiB |   2937 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   40619 K  |   40619 K  |
|       from large pool |       2    |     311    |   19754 K  |   19754 K  |
|       from small pool |       0    |    2579    |   20864 K  |   20864 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   40619 K  |   40619 K  |
|       from large pool |       2    |     311    |   19754 K  |   19754 K  |
|       from small pool |       0    |    2579    |   20864 K  |   20864 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     244    |     189    |
|       from large pool |      30    |     117    |     205    |     175    |
|       from small pool |      25    |      32    |      39    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     943    |   23642 K  |   23642 K  |
|       from large pool |       2    |     118    |   15149 K  |   15149 K  |
|       from small pool |       0    |     916    |    8492 K  |    8492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6932 MiB |    783 TiB |    783 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6932 MiB |    783 TiB |    783 TiB |
|       from large pool |  16640 KiB |   6897 MiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6928 MiB |    783 TiB |    783 TiB |
|       from large pool |  16640 KiB |   6894 MiB |    780 TiB |    780 TiB |
|       from small pool |      0 KiB |     56 MiB |      2 TiB |      2 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1134 MiB |   7286 MiB |  13524 MiB |  12390 MiB |
|       from large pool |   1084 MiB |   7222 MiB |  13446 MiB |  12362 MiB |
|       from small pool |     50 MiB |     64 MiB |     78 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 365514 GiB | 365514 GiB |
|       from large pool |   3840 KiB |    840 MiB | 362577 GiB | 362577 GiB |
|       from small pool |      0 KiB |     26 MiB |   2937 GiB |   2937 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   40619 K  |   40619 K  |
|       from large pool |       2    |     311    |   19754 K  |   19754 K  |
|       from small pool |       0    |    2579    |   20864 K  |   20864 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   40619 K  |   40619 K  |
|       from large pool |       2    |     311    |   19754 K  |   19754 K  |
|       from small pool |       0    |    2579    |   20864 K  |   20864 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     149    |     244    |     189    |
|       from large pool |      30    |     117    |     205    |     175    |
|       from small pool |      25    |      32    |      39    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     943    |   23642 K  |   23642 K  |
|       from large pool |       2    |     118    |   15149 K  |   15149 K  |
|       from small pool |       0    |     916    |    8492 K  |    8492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_52_03_seed_2_23070003

 Experiment start at: 2024-07-26 22:52:04.026638
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9931717, 'precision': 0.9944079, 'recall': 0.98799455, 'specificity': 0.98799455, 'f1': 0.99114466, 'auroc': 0.99923813, 'binary_precision': 0.99696356, 'binary_recall': 0.9770533, 'binary_specificity': 0.9989358, 'binary_f1_score': 0.98690796}
confusion matrix:
       0      1
0  42241     45
1    347  14775
---- Validation: 
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/modules/conv.py:456: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at /opt/conda/conda-bld/pytorch_1712608935911/work/aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return F.conv2d(input, weight, bias, self.stride,
scalar performance:
{'acc': 0.9696373, 'precision': 0.8495555, 'recall': 0.54183596, 'specificity': 0.54183596, 'f1': 0.5681638, 'auroc': 0.9313503, 'binary_precision': 0.7285714, 'binary_recall': 0.08471761, 'binary_specificity': 0.99895436, 'binary_f1_score': 0.15178572}
confusion matrix:
       0   1
0  18152  19
1    551  51
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.961372, 'precision': 0.81409025, 'recall': 0.5040488, 'specificity': 0.5040488, 'f1': 0.49831286, 'auroc': 0.9207681, 'binary_precision': 0.6666667, 'binary_recall': 0.008264462, 'binary_specificity': 0.9998332, 'binary_f1_score': 0.01632653}
confusion matrix:
      0  1
0  5996  1
1   240  2
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 23:15:09.760918,epoch time: 0:23:05.734280,used: 0:23:05.734280,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_52_03_seed_2_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.99460006, 'precision': 0.9957877, 'recall': 0.99030226, 'specificity': 0.99030226, 'f1': 0.9930037, 'auroc': 0.9995221, 'binary_precision': 0.9982508, 'binary_recall': 0.9812194, 'binary_specificity': 0.9993851, 'binary_f1_score': 0.9896618}
confusion matrix:
       0      1
0  42260     26
1    284  14838
---- Validation: 
scalar performance:
{'acc': 0.97176796, 'precision': 0.7795317, 'recall': 0.71800125, 'specificity': 0.71800125, 'f1': 0.74460804, 'auroc': 0.93290913, 'binary_precision': 0.5772532, 'binary_recall': 0.44684386, 'binary_specificity': 0.9891586, 'binary_f1_score': 0.5037453}
confusion matrix:
       0    1
0  17974  197
1    333  269
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9608912, 'precision': 0.6683217, 'recall': 0.5057815, 'specificity': 0.5057815, 'f1': 0.5020229, 'auroc': 0.93088865, 'binary_precision': 0.375, 'binary_recall': 0.012396694, 'binary_specificity': 0.99916625, 'binary_f1_score': 0.024}
confusion matrix:
      0  1
0  5992  5
1   239  3
better model found
persisted
after epoch: 2,now: 2024-07-26 23:37:45.810997,epoch time: 0:22:36.050079,used: 0:45:41.784359,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_52_03_seed_2_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.99134266, 'precision': 0.9866184, 'recall': 0.9912337, 'specificity': 0.9912337, 'f1': 0.98889565, 'auroc': 0.9995308, 'binary_precision': 0.9764698, 'binary_recall': 0.9910035, 'binary_specificity': 0.9914639, 'binary_f1_score': 0.98368305}
confusion matrix:
       0      1
0  41930    361
1    136  14981
---- Validation: 
scalar performance:
{'acc': 0.9626059, 'precision': 0.7196172, 'recall': 0.8473774, 'specificity': 0.8473774, 'f1': 0.7672436, 'auroc': 0.9505751, 'binary_precision': 0.44855967, 'binary_recall': 0.72425246, 'binary_specificity': 0.97050244, 'binary_f1_score': 0.5540025}
confusion matrix:
       0    1
0  17635  536
1    166  436
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9716301, 'precision': 0.9418975, 'recall': 0.6481767, 'specificity': 0.6481767, 'f1': 0.7170193, 'auroc': 0.94245195, 'binary_precision': 0.9113924, 'binary_recall': 0.29752067, 'binary_specificity': 0.99883276, 'binary_f1_score': 0.44859812}
confusion matrix:
      0   1
0  5990   7
1   170  72
new oracle model saved
early stop counter: 1
val acc:0.962605893611908, best validation acc: 0.9717679619789124, corresponding to test acc:                         0.9608911871910095 / 0.9716300964355469
after epoch: 3,now: 2024-07-27 00:00:26.957190,epoch time: 0:22:41.146193,used: 1:08:22.930552,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_52_03_seed_2_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9960633, 'precision': 0.9943682, 'recall': 0.99550045, 'specificity': 0.99550045, 'f1': 0.99493253, 'auroc': 0.9997468, 'binary_precision': 0.9907725, 'binary_recall': 0.9943114, 'binary_specificity': 0.9966895, 'binary_f1_score': 0.9925388}
confusion matrix:
       0      1
0  42150    140
1     86  15032
---- Validation: 
scalar performance:
{'acc': 0.95546794, 'precision': 0.6905181, 'recall': 0.83164454, 'specificity': 0.83164454, 'f1': 0.73924005, 'auroc': 0.9437077, 'binary_precision': 0.39126393, 'binary_recall': 0.6993356, 'binary_specificity': 0.96395355, 'binary_f1_score': 0.50178784}
confusion matrix:
       0    1
0  17516  655
1    181  421
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9344446, 'precision': 0.6160062, 'recall': 0.6625403, 'specificity': 0.6625403, 'f1': 0.6344205, 'auroc': 0.89185643, 'binary_precision': 0.25797102, 'binary_recall': 0.3677686, 'binary_specificity': 0.957312, 'binary_f1_score': 0.3032368}
confusion matrix:
      0    1
0  5741  256
1   153   89
early stop counter: 2
val acc:0.955467939376831, best validation acc: 0.9717679619789124, corresponding to test acc:                         0.9608911871910095 / 0.9716300964355469
after epoch: 4,now: 2024-07-27 00:23:08.797249,epoch time: 0:22:41.840059,used: 1:31:04.770611,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_52_03_seed_2_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9974568, 'precision': 0.9970387, 'recall': 0.9964047, 'specificity': 0.9964047, 'f1': 0.99672115, 'auroc': 0.99980104, 'binary_precision': 0.99615717, 'binary_recall': 0.99418104, 'binary_specificity': 0.9986284, 'binary_f1_score': 0.9951681}
confusion matrix:
       0      1
0  42227     58
1     88  15035
---- Validation: 
scalar performance:
{'acc': 0.9695307, 'precision': 0.75431013, 'recall': 0.77386194, 'specificity': 0.77386194, 'f1': 0.76368535, 'auroc': 0.9499354, 'binary_precision': 0.52307695, 'binary_recall': 0.56478405, 'binary_specificity': 0.98293984, 'binary_f1_score': 0.54313093}
confusion matrix:
       0    1
0  17861  310
1    262  340
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9693861, 'precision': 0.8931171, 'recall': 0.635113, 'specificity': 0.635113, 'f1': 0.69647753, 'auroc': 0.9358088, 'binary_precision': 0.8148148, 'binary_recall': 0.27272728, 'binary_specificity': 0.99749875, 'binary_f1_score': 0.40866876}
confusion matrix:
      0   1
0  5982  15
1   176  66
early stop counter: 3
val acc:0.9695307016372681, best validation acc: 0.9717679619789124, corresponding to test acc:                         0.9608911871910095 / 0.9716300964355469
after epoch: 5,now: 2024-07-27 00:45:51.659061,epoch time: 0:22:42.861812,used: 1:53:47.632423,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_52_03_seed_2_23070003
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 23070003 ON gpusrv12 CANCELLED AT 2024-07-27T00:54:10 ***
