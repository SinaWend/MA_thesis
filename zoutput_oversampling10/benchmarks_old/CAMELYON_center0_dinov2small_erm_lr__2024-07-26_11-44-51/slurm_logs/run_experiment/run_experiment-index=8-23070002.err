Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 2
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, nvidia_gpu=1
Select jobs to execute...

[Fri Jul 26 12:07:59 2024]
rule run_experiment:
    input: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/hyperparameters.csv
    output: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/8.csv
    jobid: 0
    reason: Forced execution
    wildcards: index=8
    resources: mem_mb=100000, mem_mib=95368, disk_mb=1000, disk_mib=954, tmpdir=/tmp, partition=gpu_p, qos=gpu_normal, nvidia_gpu=1

Failed to import backpack: cannot import name '_grad_input_padding' from 'torch.nn.grad' (/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/grad.py)
before experiment loop: 
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Active memory         |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Requested memory      |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| GPU reserved memory   |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |      0 B   |      0 B   |      0 B   |      0 B   |
|       from large pool |      0 B   |      0 B   |      0 B   |      0 B   |
|       from small pool |      0 B   |      0 B   |      0 B   |      0 B   |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/swiglu_ffn.py:51: UserWarning: xFormers is not available (SwiGLU)
  warnings.warn("xFormers is not available (SwiGLU)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/attention.py:33: UserWarning: xFormers is not available (Attention)
  warnings.warn("xFormers is not available (Attention)")
/home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main/dinov2/layers/block.py:40: UserWarning: xFormers is not available (Block)
  warnings.warn("xFormers is not available (Block)")
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'888c1ef2'
model name: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002

 Experiment start at: 2024-07-26 12:14:29.556346
before training, model accuracy: 0.7297859191894531
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.92448795, 'precision': 0.9261154, 'recall': 0.8727819, 'specificity': 0.8727819, 'f1': 0.89511204, 'auroc': 0.92775846, 'binary_precision': 0.9289482, 'binary_recall': 0.7659372, 'binary_specificity': 0.97962654, 'binary_f1_score': 0.83960366}
confusion matrix:
       0      1
0  41448    862
1   3444  11270
---- Validation: 
scalar performance:
{'acc': 0.44119838, 'precision': 0.50798726, 'recall': 0.55918914, 'specificity': 0.55918914, 'f1': 0.33834887, 'auroc': 0.6445979, 'binary_precision': 0.041061454, 'binary_recall': 0.6858476, 'binary_specificity': 0.43253073, 'binary_f1_score': 0.07748397}
confusion matrix:
      0      1
0  7850  10299
1   202    441
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.19175455, 'precision': 0.5172822, 'recall': 0.5563011, 'specificity': 0.5563011, 'f1': 0.18145435, 'auroc': 0.6750118, 'binary_precision': 0.047025494, 'binary_recall': 0.954023, 'binary_specificity': 0.15857929, 'binary_f1_score': 0.08963283}
confusion matrix:
     0     1
0  951  5046
1   12   249
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 12:38:00.430232,epoch time: 0:23:30.873886,used: 0:23:30.873886,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9321514, 'precision': 0.932778, 'recall': 0.8868202, 'specificity': 0.8868202, 'f1': 0.9066206, 'auroc': 0.94069767, 'binary_precision': 0.93389356, 'binary_recall': 0.79316205, 'binary_specificity': 0.98047835, 'binary_f1_score': 0.857794}
confusion matrix:
       0      1
0  41486    826
1   3043  11669
---- Validation: 
scalar performance:
{'acc': 0.42954448, 'precision': 0.5071238, 'recall': 0.5524057, 'specificity': 0.5524057, 'f1': 0.33165023, 'auroc': 0.6379733, 'binary_precision': 0.04015698, 'binary_recall': 0.6842924, 'binary_specificity': 0.42051902, 'binary_f1_score': 0.07586207}
confusion matrix:
      0      1
0  7632  10517
1   203    440
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.17497604, 'precision': 0.5147667, 'recall': 0.54388213, 'specificity': 0.54388213, 'f1': 0.1672959, 'auroc': 0.6758151, 'binary_precision': 0.045774646, 'binary_recall': 0.9463602, 'binary_specificity': 0.14140403, 'binary_f1_score': 0.08732544}
confusion matrix:
     0     1
0  848  5149
1   14   247
early stop counter: 1
val acc:0.42954447865486145, best validation acc: 0.4411983788013458, corresponding to test acc:                         0.191754549741745 / 0.191754549741745
after epoch: 2,now: 2024-07-26 13:01:11.455747,epoch time: 0:23:11.025515,used: 0:46:41.899401,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9317305, 'precision': 0.92503214, 'recall': 0.8930583, 'specificity': 0.8930583, 'f1': 0.9074472, 'auroc': 0.9378003, 'binary_precision': 0.91263545, 'binary_recall': 0.8131756, 'binary_specificity': 0.97294104, 'binary_f1_score': 0.8600396}
confusion matrix:
       0      1
0  41170   1145
1   2748  11961
---- Validation: 
scalar performance:
{'acc': 0.72871435, 'precision': 0.5237987, 'recall': 0.6435356, 'specificity': 0.6435356, 'f1': 0.48090482, 'auroc': 0.6908463, 'binary_precision': 0.06873185, 'binary_recall': 0.5520995, 'binary_specificity': 0.73497164, 'binary_f1_score': 0.122245185}
confusion matrix:
       0     1
0  13339  4810
1    288   355
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.64397573, 'precision': 0.5335082, 'recall': 0.69697106, 'specificity': 0.69697106, 'f1': 0.46253997, 'auroc': 0.7219951, 'binary_precision': 0.08343922, 'binary_recall': 0.7547893, 'binary_specificity': 0.6391529, 'binary_f1_score': 0.15026698}
confusion matrix:
      0     1
0  3833  2164
1    64   197
new oracle model saved
better model found
persisted
after epoch: 3,now: 2024-07-26 13:24:12.271551,epoch time: 0:23:00.815804,used: 1:09:42.715205,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92622405, 'precision': 0.9529437, 'recall': 0.8580568, 'specificity': 0.8580568, 'f1': 0.8931769, 'auroc': 0.9488397, 'binary_precision': 0.9954708, 'binary_recall': 0.71724796, 'binary_specificity': 0.99886566, 'binary_f1_score': 0.8337614}
confusion matrix:
       0      1
0  42267     48
1   4159  10550
---- Validation: 
scalar performance:
{'acc': 0.9253406, 'precision': 0.5403133, 'recall': 0.56006813, 'specificity': 0.56006813, 'f1': 0.54720277, 'auroc': 0.6892481, 'binary_precision': 0.11065574, 'binary_recall': 0.16796267, 'binary_specificity': 0.95217365, 'binary_f1_score': 0.1334157}
confusion matrix:
       0    1
0  17281  868
1    535  108
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9132311, 'precision': 0.54213524, 'recall': 0.5589433, 'specificity': 0.5589433, 'f1': 0.5482423, 'auroc': 0.73216426, 'binary_precision': 0.12096774, 'binary_recall': 0.1724138, 'binary_specificity': 0.9454727, 'binary_f1_score': 0.14218009}
confusion matrix:
      0    1
0  5670  327
1   216   45
new oracle model saved
better model found
persisted
after epoch: 4,now: 2024-07-26 13:47:19.892104,epoch time: 0:23:07.620553,used: 1:32:50.335758,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.9484603, 'precision': 0.962703, 'recall': 0.9035172, 'specificity': 0.9035172, 'f1': 0.92832327, 'auroc': 0.9587664, 'binary_precision': 0.9874193, 'binary_recall': 0.81062716, 'binary_specificity': 0.9964072, 'binary_f1_score': 0.89033175}
confusion matrix:
       0      1
0  42155    152
1   2787  11930
---- Validation: 
scalar performance:
{'acc': 0.8733504, 'precision': 0.5454178, 'recall': 0.64491034, 'specificity': 0.64491034, 'f1': 0.5545006, 'auroc': 0.6857922, 'binary_precision': 0.11417148, 'binary_recall': 0.39968896, 'binary_specificity': 0.8901317, 'binary_f1_score': 0.17760885}
confusion matrix:
       0     1
0  16155  1994
1    386   257
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8581016, 'precision': 0.55409193, 'recall': 0.66027457, 'specificity': 0.66027457, 'f1': 0.56461036, 'auroc': 0.7398865, 'binary_precision': 0.13504075, 'binary_recall': 0.44444445, 'binary_specificity': 0.8761047, 'binary_f1_score': 0.20714287}
confusion matrix:
      0    1
0  5254  743
1   145  116
early stop counter: 1
val acc:0.8733503818511963, best validation acc: 0.9253405928611755, corresponding to test acc:                         0.9132310748100281 / 0.9132310748100281
after epoch: 5,now: 2024-07-26 14:10:16.580850,epoch time: 0:22:56.688746,used: 1:55:47.024504,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.95340556, 'precision': 0.95480734, 'recall': 0.9221176, 'specificity': 0.9221176, 'f1': 0.93693334, 'auroc': 0.9618934, 'binary_precision': 0.9574129, 'binary_recall': 0.8574925, 'binary_specificity': 0.9867426, 'binary_f1_score': 0.9047021}
confusion matrix:
       0      1
0  41755    561
1   2096  12612
---- Validation: 
scalar performance:
{'acc': 0.58402514, 'precision': 0.517663, 'recall': 0.6308825, 'specificity': 0.6308825, 'f1': 0.41510102, 'auroc': 0.69954073, 'binary_precision': 0.054409936, 'binary_recall': 0.68118197, 'binary_specificity': 0.580583, 'binary_f1_score': 0.10077073}
confusion matrix:
       0     1
0  10537  7612
1    205   438
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.38590604, 'precision': 0.51948816, 'recall': 0.61179346, 'specificity': 0.61179346, 'f1': 0.31858528, 'auroc': 0.726905, 'binary_precision': 0.055583127, 'binary_recall': 0.85823756, 'binary_specificity': 0.36534935, 'binary_f1_score': 0.10440457}
confusion matrix:
      0     1
0  2191  3806
1    37   224
early stop counter: 2
val acc:0.5840251445770264, best validation acc: 0.9253405928611755, corresponding to test acc:                         0.9132310748100281 / 0.9132310748100281
after epoch: 6,now: 2024-07-26 14:42:40.691414,epoch time: 0:32:24.110564,used: 2:28:11.135068,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.94832003, 'precision': 0.96407306, 'recall': 0.9021583, 'specificity': 0.9021583, 'f1': 0.9279115, 'auroc': 0.96572936, 'binary_precision': 0.99123025, 'binary_recall': 0.8067981, 'binary_specificity': 0.99751854, 'binary_f1_score': 0.88955516}
confusion matrix:
       0      1
0  42209    105
1   2842  11868
---- Validation: 
scalar performance:
{'acc': 0.9094828, 'precision': 0.5426484, 'recall': 0.58711094, 'specificity': 0.58711094, 'f1': 0.55316746, 'auroc': 0.6883166, 'binary_precision': 0.11330409, 'binary_recall': 0.24105754, 'binary_specificity': 0.93316436, 'binary_f1_score': 0.15415215}
confusion matrix:
       0     1
0  16936  1213
1    488   155
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8590604, 'precision': 0.54051185, 'recall': 0.61313415, 'specificity': 0.61313415, 'f1': 0.5462439, 'auroc': 0.72705257, 'binary_precision': 0.11235955, 'binary_recall': 0.3448276, 'binary_specificity': 0.8814407, 'binary_f1_score': 0.16949153}
confusion matrix:
      0    1
0  5286  711
1   171   90
early stop counter: 3
val acc:0.9094827771186829, best validation acc: 0.9253405928611755, corresponding to test acc:                         0.9132310748100281 / 0.9132310748100281
after epoch: 7,now: 2024-07-26 15:10:22.036123,epoch time: 0:27:41.344709,used: 2:55:52.479777,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9422173, 'precision': 0.9414505, 'recall': 0.90528077, 'specificity': 0.90528077, 'f1': 0.9214264, 'auroc': 0.9498689, 'binary_precision': 0.94004315, 'binary_recall': 0.82895005, 'binary_specificity': 0.9816115, 'binary_f1_score': 0.8810083}
confusion matrix:
       0      1
0  41531    778
1   2517  12198
---- Validation: 
scalar performance:
{'acc': 0.9316198, 'precision': 0.51907885, 'recall': 0.522066, 'specificity': 0.522066, 'f1': 0.52035, 'auroc': 0.6430266, 'binary_precision': 0.07085562, 'binary_recall': 0.08242613, 'binary_specificity': 0.96170586, 'binary_f1_score': 0.07620417}
confusion matrix:
       0    1
0  17454  695
1    590   53
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.89629275, 'precision': 0.5093495, 'recall': 0.51529115, 'specificity': 0.51529115, 'f1': 0.5096248, 'auroc': 0.67350054, 'binary_precision': 0.05909091, 'binary_recall': 0.099616855, 'binary_specificity': 0.9309655, 'binary_f1_score': 0.07417974}
confusion matrix:
      0    1
0  5583  414
1   235   26
better model found
persisted
after epoch: 8,now: 2024-07-26 15:33:46.249630,epoch time: 0:23:24.213507,used: 3:19:16.693284,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9433923, 'precision': 0.96204585, 'recall': 0.8919345, 'specificity': 0.8919345, 'f1': 0.9203224, 'auroc': 0.96081454, 'binary_precision': 0.99355173, 'binary_recall': 0.78564143, 'binary_specificity': 0.9982276, 'binary_f1_score': 0.87744874}
confusion matrix:
       0      1
0  42240     75
1   3153  11556
---- Validation: 
scalar performance:
{'acc': 0.95530015, 'precision': 0.5101605, 'recall': 0.50357336, 'specificity': 0.50357336, 'f1': 0.502451, 'auroc': 0.72163755, 'binary_precision': 0.054298643, 'binary_recall': 0.01866252, 'binary_specificity': 0.9884842, 'binary_f1_score': 0.027777778}
confusion matrix:
       0    1
0  17940  209
1    631   12
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9483861, 'precision': 0.478938, 'recall': 0.49483076, 'specificity': 0.49483076, 'f1': 0.4867547, 'auroc': 0.729741, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  62
1   261   0
new oracle model saved
better model found
persisted
after epoch: 9,now: 2024-07-26 15:56:53.079631,epoch time: 0:23:06.830001,used: 3:42:23.523285,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.95887697, 'precision': 0.96517104, 'recall': 0.9270028, 'specificity': 0.9270028, 'f1': 0.9440722, 'auroc': 0.9702821, 'binary_precision': 0.9767191, 'binary_recall': 0.86114323, 'binary_specificity': 0.9928624, 'binary_f1_score': 0.91529715}
confusion matrix:
       0      1
0  42009    302
1   2043  12670
---- Validation: 
scalar performance:
{'acc': 0.8778204, 'precision': 0.5534952, 'recall': 0.66897607, 'specificity': 0.66897607, 'f1': 0.5666527, 'auroc': 0.7442492, 'binary_precision': 0.12853932, 'binary_recall': 0.44479004, 'binary_specificity': 0.89316213, 'binary_f1_score': 0.19944212}
confusion matrix:
       0     1
0  16210  1939
1    357   286
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8344519, 'precision': 0.5315097, 'recall': 0.6021267, 'specificity': 0.6021267, 'f1': 0.52886385, 'auroc': 0.6932901, 'binary_precision': 0.09508882, 'binary_recall': 0.348659, 'binary_specificity': 0.85559446, 'binary_f1_score': 0.14942528}
confusion matrix:
      0    1
0  5131  866
1   170   91
early stop counter: 1
val acc:0.8778203725814819, best validation acc: 0.9553001523017883, corresponding to test acc:                         0.9483860731124878 / 0.9483860731124878
after epoch: 10,now: 2024-07-26 16:19:50.599839,epoch time: 0:22:57.520208,used: 4:05:21.043493,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 11
---- Training Domain: 
scalar performance:
{'acc': 0.9356587, 'precision': 0.9561944, 'recall': 0.87779117, 'specificity': 0.87779117, 'f1': 0.9085649, 'auroc': 0.9650396, 'binary_precision': 0.9901491, 'binary_recall': 0.7582059, 'binary_specificity': 0.99737644, 'binary_f1_score': 0.8587923}
confusion matrix:
       0      1
0  42198    111
1   3558  11157
---- Validation: 
scalar performance:
{'acc': 0.9574819, 'precision': 0.55294466, 'recall': 0.5182039, 'specificity': 0.5182039, 'f1': 0.5240462, 'auroc': 0.72934186, 'binary_precision': 0.1388889, 'binary_recall': 0.0466563, 'binary_specificity': 0.9897515, 'binary_f1_score': 0.069848664}
confusion matrix:
       0    1
0  17963  186
1    613   30
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94646853, 'precision': 0.4918658, 'recall': 0.4974949, 'specificity': 0.4974949, 'f1': 0.49214426, 'auroc': 0.69328725, 'binary_precision': 0.025641026, 'binary_recall': 0.007662835, 'binary_specificity': 0.987327, 'binary_f1_score': 0.01179941}
confusion matrix:
      0   1
0  5921  76
1   259   2
better model found
persisted
after epoch: 11,now: 2024-07-26 16:42:46.452561,epoch time: 0:22:55.852722,used: 4:28:16.896215,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 12
---- Training Domain: 
scalar performance:
{'acc': 0.9553171, 'precision': 0.957268, 'recall': 0.9248477, 'specificity': 0.9248477, 'f1': 0.93956304, 'auroc': 0.96194637, 'binary_precision': 0.9609002, 'binary_recall': 0.86189085, 'binary_specificity': 0.9878046, 'binary_f1_score': 0.90870655}
confusion matrix:
       0      1
0  41795    516
1   2032  12681
---- Validation: 
scalar performance:
{'acc': 0.8535015, 'precision': 0.54117656, 'recall': 0.6518855, 'specificity': 0.6518855, 'f1': 0.5443504, 'auroc': 0.68310595, 'binary_precision': 0.10486891, 'binary_recall': 0.43545878, 'binary_specificity': 0.8683123, 'binary_f1_score': 0.16903108}
confusion matrix:
       0     1
0  15759  2390
1    363   280
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7158837, 'precision': 0.53279114, 'recall': 0.6703582, 'specificity': 0.6703582, 'f1': 0.4917036, 'auroc': 0.7089324, 'binary_precision': 0.087995656, 'binary_recall': 0.62068963, 'binary_specificity': 0.7200267, 'binary_f1_score': 0.15413891}
confusion matrix:
      0     1
0  4318  1679
1    99   162
early stop counter: 1
val acc:0.8535014986991882, best validation acc: 0.9574819207191467, corresponding to test acc:                         0.9464685320854187 / 0.9483860731124878
after epoch: 12,now: 2024-07-26 17:05:40.019001,epoch time: 0:22:53.566440,used: 4:51:10.462655,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 13
---- Training Domain: 
scalar performance:
{'acc': 0.9521956, 'precision': 0.9672264, 'recall': 0.90913415, 'specificity': 0.90913415, 'f1': 0.9336225, 'auroc': 0.96814466, 'binary_precision': 0.993414, 'binary_recall': 0.820159, 'binary_specificity': 0.9981092, 'binary_f1_score': 0.8985108}
confusion matrix:
       0      1
0  42231     80
1   2646  12067
---- Validation: 
scalar performance:
{'acc': 0.93811196, 'precision': 0.5528259, 'recall': 0.5584295, 'specificity': 0.5584295, 'f1': 0.55542964, 'auroc': 0.70467234, 'binary_precision': 0.13585435, 'binary_recall': 0.15085536, 'binary_specificity': 0.96600366, 'binary_f1_score': 0.14296241}
confusion matrix:
       0    1
0  17532  617
1    546   97
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.8950144, 'precision': 0.5200113, 'recall': 0.53477985, 'specificity': 0.53477985, 'f1': 0.5227412, 'auroc': 0.6888962, 'binary_precision': 0.0787234, 'binary_recall': 0.14176245, 'binary_specificity': 0.92779726, 'binary_f1_score': 0.10123119}
confusion matrix:
      0    1
0  5564  433
1   224   37
early stop counter: 2
val acc:0.9381119608879089, best validation acc: 0.9574819207191467, corresponding to test acc:                         0.9464685320854187 / 0.9483860731124878
after epoch: 13,now: 2024-07-26 17:28:18.277609,epoch time: 0:22:38.258608,used: 5:13:48.721263,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 14
---- Training Domain: 
scalar performance:
{'acc': 0.9476712, 'precision': 0.9482866, 'recall': 0.91322285, 'specificity': 0.91322285, 'f1': 0.92896616, 'auroc': 0.96360713, 'binary_precision': 0.9494214, 'binary_recall': 0.8420445, 'binary_specificity': 0.9844012, 'binary_f1_score': 0.89251494}
confusion matrix:
       0      1
0  41651    660
1   2324  12389
---- Validation: 
scalar performance:
{'acc': 0.83461046, 'precision': 0.5370622, 'recall': 0.6526062, 'specificity': 0.6526062, 'f1': 0.53368855, 'auroc': 0.6798177, 'binary_precision': 0.096298724, 'binary_recall': 0.45723173, 'binary_specificity': 0.8479806, 'binary_f1_score': 0.15909092}
confusion matrix:
       0     1
0  15390  2759
1    349   294
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7024608, 'precision': 0.5286908, 'recall': 0.6523607, 'specificity': 0.6523607, 'f1': 0.4817359, 'auroc': 0.69621205, 'binary_precision': 0.081547305, 'binary_recall': 0.59770113, 'binary_specificity': 0.70702016, 'binary_f1_score': 0.14351425}
confusion matrix:
      0     1
0  4240  1757
1   105   156
early stop counter: 3
val acc:0.8346104621887207, best validation acc: 0.9574819207191467, corresponding to test acc:                         0.9464685320854187 / 0.9483860731124878
after epoch: 14,now: 2024-07-26 17:52:26.743521,epoch time: 0:24:08.465912,used: 5:37:57.187175,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 15
---- Training Domain: 
scalar performance:
{'acc': 0.9584736, 'precision': 0.9617054, 'recall': 0.92897415, 'specificity': 0.92897415, 'f1': 0.94383526, 'auroc': 0.97580004, 'binary_precision': 0.96772236, 'binary_recall': 0.86801684, 'binary_specificity': 0.98993146, 'binary_f1_score': 0.91516197}
confusion matrix:
       0      1
0  41884    426
1   1942  12772
---- Validation: 
scalar performance:
{'acc': 0.838708, 'precision': 0.5381969, 'recall': 0.65397745, 'specificity': 0.65397745, 'f1': 0.5363895, 'auroc': 0.7126832, 'binary_precision': 0.09852051, 'binary_recall': 0.45567653, 'binary_specificity': 0.85227835, 'binary_f1_score': 0.16201273}
confusion matrix:
       0     1
0  15468  2681
1    350   293
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.65931606, 'precision': 0.5253409, 'recall': 0.64450806, 'specificity': 0.64450806, 'f1': 0.46066025, 'auroc': 0.67562133, 'binary_precision': 0.07457935, 'binary_recall': 0.62835246, 'binary_specificity': 0.66066366, 'binary_f1_score': 0.13333333}
confusion matrix:
      0     1
0  3962  2035
1    97   164
early stop counter: 4
val acc:0.8387079834938049, best validation acc: 0.9574819207191467, corresponding to test acc:                         0.9464685320854187 / 0.9483860731124878
after epoch: 15,now: 2024-07-26 18:15:21.351103,epoch time: 0:22:54.607582,used: 6:00:51.794757,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 16
---- Training Domain: 
scalar performance:
{'acc': 0.9525638, 'precision': 0.9580548, 'recall': 0.9171575, 'specificity': 0.9171575, 'f1': 0.9352536, 'auroc': 0.95868635, 'binary_precision': 0.9680362, 'binary_recall': 0.84400487, 'binary_specificity': 0.9903101, 'binary_f1_score': 0.90177566}
confusion matrix:
       0      1
0  41902    410
1   2295  12417
---- Validation: 
scalar performance:
{'acc': 0.9225202, 'precision': 0.5102837, 'recall': 0.51435477, 'specificity': 0.51435477, 'f1': 0.51132613, 'auroc': 0.66902876, 'binary_precision': 0.05378705, 'binary_recall': 0.07620529, 'binary_specificity': 0.9525043, 'binary_f1_score': 0.06306307}
confusion matrix:
       0    1
0  17287  862
1    594   49
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.86545223, 'precision': 0.5134718, 'recall': 0.5321818, 'specificity': 0.5321818, 'f1': 0.5109749, 'auroc': 0.6721535, 'binary_precision': 0.06576981, 'binary_recall': 0.16858238, 'binary_specificity': 0.8957812, 'binary_f1_score': 0.09462366}
confusion matrix:
      0    1
0  5372  625
1   217   44
early stop counter: 5
val acc:0.9225202202796936, best validation acc: 0.9574819207191467, corresponding to test acc:                         0.9464685320854187 / 0.9483860731124878
after epoch: 16,now: 2024-07-26 18:38:15.355460,epoch time: 0:22:54.004357,used: 6:23:45.799114,model: dset_te_center0_erm_b888c1ef2_not_commited_2024md_07md_26_12_14_29_seed_0_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 16 with time: 6:23:45.799114 at 2024-07-26 18:38:15.355460
persisted model performance metric: 

scalar performance:
{'acc': 0.94646853, 'precision': 0.4918658, 'recall': 0.4974949, 'specificity': 0.4974949, 'f1': 0.49214426, 'auroc': 0.69328725, 'binary_precision': 0.025641026, 'binary_recall': 0.007662835, 'binary_specificity': 0.987327, 'binary_f1_score': 0.01179941}
confusion matrix:
      0   1
0  5921  76
1   259   2
oracle model performance metric: 

scalar performance:
{'acc': 0.9483861, 'precision': 0.478938, 'recall': 0.49483076, 'specificity': 0.49483076, 'f1': 0.4867547, 'auroc': 0.729741, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9896615, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5935  62
1   261   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/8.csv
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452933 KiB |   6925 MiB | 567422 GiB | 567422 GiB |
|       from large pool | 412128 KiB |   6891 MiB | 565363 GiB | 565363 GiB |
|       from small pool |  40805 KiB |     56 MiB |   2059 GiB |   2059 GiB |
|---------------------------------------------------------------------------|
| Active memory         | 452933 KiB |   6925 MiB | 567422 GiB | 567422 GiB |
|       from large pool | 412128 KiB |   6891 MiB | 565363 GiB | 565363 GiB |
|       from small pool |  40805 KiB |     56 MiB |   2059 GiB |   2059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447754 KiB |   6922 MiB | 567375 GiB | 567374 GiB |
|       from large pool | 407075 KiB |   6888 MiB | 565319 GiB | 565318 GiB |
|       from small pool |  40679 KiB |     56 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7296 MiB |   7296 MiB |   7296 MiB |      0 B   |
|       from large pool |   7232 MiB |   7232 MiB |   7232 MiB |      0 B   |
|       from small pool |     64 MiB |     64 MiB |     64 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 638650 KiB |    845 MiB | 304139 GiB | 304138 GiB |
|       from large pool | 628256 KiB |    840 MiB | 302002 GiB | 302002 GiB |
|       from small pool |  10394 KiB |     13 MiB |   2136 GiB |   2136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1724    |    2767    |   29521 K  |   29520 K  |
|       from large pool |     187    |     311    |   14375 K  |   14375 K  |
|       from small pool |    1537    |    2579    |   15146 K  |   15144 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1724    |    2767    |   29521 K  |   29520 K  |
|       from large pool |     187    |     311    |   14375 K  |   14375 K  |
|       from small pool |    1537    |    2579    |   15146 K  |   15144 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     150    |     150    |     150    |       0    |
|       from large pool |     118    |     118    |     118    |       0    |
|       from small pool |      32    |      32    |      32    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      62    |     941    |   16970 K  |   16970 K  |
|       from large pool |      25    |     120    |   10727 K  |   10727 K  |
|       from small pool |      37    |     916    |    6243 K  |    6243 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6925 MiB | 567422 GiB | 567422 GiB |
|       from large pool |  16640 KiB |   6891 MiB | 565363 GiB | 565363 GiB |
|       from small pool |      0 KiB |     56 MiB |   2059 GiB |   2059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6925 MiB | 567422 GiB | 567422 GiB |
|       from large pool |  16640 KiB |   6891 MiB | 565363 GiB | 565363 GiB |
|       from small pool |      0 KiB |     56 MiB |   2059 GiB |   2059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6922 MiB | 567375 GiB | 567375 GiB |
|       from large pool |  16640 KiB |   6888 MiB | 565319 GiB | 565318 GiB |
|       from small pool |      0 KiB |     56 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1066 MiB |   7296 MiB |   7296 MiB |   6230 MiB |
|       from large pool |   1016 MiB |   7232 MiB |   7232 MiB |   6216 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 304139 GiB | 304139 GiB |
|       from large pool |   3840 KiB |    840 MiB | 302002 GiB | 302002 GiB |
|       from small pool |      0 KiB |     21 MiB |   2136 GiB |   2136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   29521 K  |   29521 K  |
|       from large pool |       2    |     311    |   14375 K  |   14375 K  |
|       from small pool |       0    |    2579    |   15146 K  |   15146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   29521 K  |   29521 K  |
|       from large pool |       2    |     311    |   14375 K  |   14375 K  |
|       from small pool |       0    |    2579    |   15146 K  |   15146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |     150    |     150    |      98    |
|       from large pool |      27    |     118    |     118    |      91    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     941    |   16971 K  |   16971 K  |
|       from large pool |       2    |     120    |   10727 K  |   10727 K  |
|       from small pool |       0    |     916    |    6244 K  |    6244 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6925 MiB | 567422 GiB | 567422 GiB |
|       from large pool |  16640 KiB |   6891 MiB | 565363 GiB | 565363 GiB |
|       from small pool |      0 KiB |     56 MiB |   2059 GiB |   2059 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6925 MiB | 567422 GiB | 567422 GiB |
|       from large pool |  16640 KiB |   6891 MiB | 565363 GiB | 565363 GiB |
|       from small pool |      0 KiB |     56 MiB |   2059 GiB |   2059 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6922 MiB | 567375 GiB | 567375 GiB |
|       from large pool |  16640 KiB |   6888 MiB | 565319 GiB | 565318 GiB |
|       from small pool |      0 KiB |     56 MiB |   2056 GiB |   2056 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1066 MiB |   7296 MiB |   7296 MiB |   6230 MiB |
|       from large pool |   1016 MiB |   7232 MiB |   7232 MiB |   6216 MiB |
|       from small pool |     50 MiB |     64 MiB |     64 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 304139 GiB | 304139 GiB |
|       from large pool |   3840 KiB |    840 MiB | 302002 GiB | 302002 GiB |
|       from small pool |      0 KiB |     21 MiB |   2136 GiB |   2136 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   29521 K  |   29521 K  |
|       from large pool |       2    |     311    |   14375 K  |   14375 K  |
|       from small pool |       0    |    2579    |   15146 K  |   15146 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   29521 K  |   29521 K  |
|       from large pool |       2    |     311    |   14375 K  |   14375 K  |
|       from small pool |       0    |    2579    |   15146 K  |   15146 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      52    |     150    |     150    |      98    |
|       from large pool |      27    |     118    |     118    |      91    |
|       from small pool |      25    |      32    |      32    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     941    |   16971 K  |   16971 K  |
|       from large pool |       2    |     120    |   10727 K  |   10727 K  |
|       from small pool |       0    |     916    |    6244 K  |    6244 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002

 Experiment start at: 2024-07-26 18:45:02.278347
before training, model accuracy: 0.6474379897117615
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.9280687, 'precision': 0.9470581, 'recall': 0.8637585, 'specificity': 0.8637585, 'f1': 0.89587796, 'auroc': 0.9350027, 'binary_precision': 0.97771204, 'binary_recall': 0.73319924, 'binary_specificity': 0.99431777, 'binary_f1_score': 0.83798355}
confusion matrix:
       0      1
0  42172    241
1   3847  10572
---- Validation: 
scalar performance:
{'acc': 0.94845253, 'precision': 0.4834786, 'recall': 0.49260655, 'specificity': 0.49260655, 'f1': 0.48780456, 'auroc': 0.71570987, 'binary_precision': 0.0033898305, 'binary_recall': 0.0014858841, 'binary_specificity': 0.9837272, 'binary_f1_score': 0.0020661156}
confusion matrix:
       0    1
0  17773  294
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9500483, 'precision': 0.4788824, 'recall': 0.4957955, 'specificity': 0.4957955, 'f1': 0.4871922, 'auroc': 0.6924765, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.991591, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5896  50
1   260   0
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 19:08:02.591497,epoch time: 0:23:00.313150,used: 0:23:00.313150,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9473536, 'precision': 0.9612455, 'recall': 0.90030587, 'specificity': 0.90030587, 'f1': 0.92580056, 'auroc': 0.95037943, 'binary_precision': 0.98497707, 'binary_recall': 0.804785, 'binary_specificity': 0.99582666, 'binary_f1_score': 0.8858103}
confusion matrix:
       0      1
0  42235    177
1   2815  11605
---- Validation: 
scalar performance:
{'acc': 0.9542156, 'precision': 0.48456353, 'recall': 0.49559543, 'specificity': 0.49559543, 'f1': 0.4894479, 'auroc': 0.6823001, 'binary_precision': 0.0053475937, 'binary_recall': 0.0014858841, 'binary_specificity': 0.98970497, 'binary_f1_score': 0.0023255814}
confusion matrix:
       0    1
0  17881  186
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95278764, 'precision': 0.47894055, 'recall': 0.49722502, 'specificity': 0.49722502, 'f1': 0.48791155, 'auroc': 0.5895581, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99445003, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5913  33
1   260   0
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 19:30:47.609259,epoch time: 0:22:45.017762,used: 0:45:45.330912,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9308136, 'precision': 0.944859, 'recall': 0.8718544, 'specificity': 0.8718544, 'f1': 0.90094435, 'auroc': 0.9432082, 'binary_precision': 0.96804714, 'binary_recall': 0.7521498, 'binary_specificity': 0.99155897, 'binary_f1_score': 0.84655017}
confusion matrix:
       0      1
0  42054    358
1   3574  10846
---- Validation: 
scalar performance:
{'acc': 0.9532017, 'precision': 0.48184612, 'recall': 0.49435434, 'specificity': 0.49435434, 'f1': 0.4880201, 'auroc': 0.683228, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9887087, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  17863  204
1    673    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9550435, 'precision': 0.4789882, 'recall': 0.4984023, 'specificity': 0.4984023, 'f1': 0.4885024, 'auroc': 0.6490001, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5927  19
1   260   0
new oracle model saved
early stop counter: 1
val acc:0.9532017111778259, best validation acc: 0.9542155861854553, corresponding to test acc:                         0.9527876377105713 / 0.9550434947013855
after epoch: 3,now: 2024-07-26 19:53:12.639305,epoch time: 0:22:25.030046,used: 1:08:10.360958,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.92718893, 'precision': 0.93139803, 'recall': 0.87297183, 'specificity': 0.87297183, 'f1': 0.89719903, 'auroc': 0.92456055, 'binary_precision': 0.9385613, 'binary_recall': 0.7629188, 'binary_specificity': 0.9830249, 'binary_f1_score': 0.84167427}
confusion matrix:
       0      1
0  41695    720
1   3418  10999
---- Validation: 
scalar performance:
{'acc': 0.95410883, 'precision': 0.48186278, 'recall': 0.49482483, 'specificity': 0.49482483, 'f1': 0.4882578, 'auroc': 0.50646585, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.98964965, 'binary_f1_score': 0.0}
confusion matrix:
       0    1
0  17880  187
1    673    0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.954399, 'precision': 0.4789746, 'recall': 0.49806592, 'specificity': 0.49806592, 'f1': 0.48833373, 'auroc': 0.50274396, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.99613184, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5923  23
1   260   0
early stop counter: 2
val acc:0.9541088342666626, best validation acc: 0.9542155861854553, corresponding to test acc:                         0.9527876377105713 / 0.9550434947013855
after epoch: 4,now: 2024-07-26 20:15:29.198013,epoch time: 0:22:16.558708,used: 1:30:26.919666,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.91374576, 'precision': 0.9448638, 'recall': 0.83178985, 'specificity': 0.83178985, 'f1': 0.87090147, 'auroc': 0.93510795, 'binary_precision': 0.99203885, 'binary_recall': 0.66539526, 'binary_specificity': 0.9981845, 'binary_f1_score': 0.79652995}
confusion matrix:
       0     1
0  42335    77
1   4825  9595
---- Validation: 
scalar performance:
{'acc': 0.9582711, 'precision': 0.4864681, 'recall': 0.49769872, 'specificity': 0.49769872, 'f1': 0.4906204, 'auroc': 0.707674, 'binary_precision': 0.009009009, 'binary_recall': 0.0014858841, 'binary_specificity': 0.99391156, 'binary_f1_score': 0.0025510204}
confusion matrix:
       0    1
0  17957  110
1    672    1
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.95262647, 'precision': 0.47893715, 'recall': 0.49714094, 'specificity': 0.49714094, 'f1': 0.4878693, 'auroc': 0.7327174, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5912  34
1   260   0
better model found
persisted
after epoch: 5,now: 2024-07-26 20:37:39.262270,epoch time: 0:22:10.064257,used: 1:52:36.983923,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94068485, 'precision': 0.9570521, 'recall': 0.88718724, 'specificity': 0.88718724, 'f1': 0.9155452, 'auroc': 0.9476155, 'binary_precision': 0.9843928, 'binary_recall': 0.7785714, 'binary_specificity': 0.99580306, 'binary_f1_score': 0.86946756}
confusion matrix:
       0      1
0  42234    178
1   3193  11227
---- Validation: 
scalar performance:
{'acc': 0.88110995, 'precision': 0.5420578, 'recall': 0.6157551, 'specificity': 0.6157551, 'f1': 0.55107975, 'auroc': 0.7058277, 'binary_precision': 0.11105553, 'binary_recall': 0.32986626, 'binary_specificity': 0.9016439, 'binary_f1_score': 0.16616768}
confusion matrix:
       0     1
0  16290  1777
1    451   222
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9020303, 'precision': 0.55830956, 'recall': 0.60682166, 'specificity': 0.60682166, 'f1': 0.5718026, 'auroc': 0.735173, 'binary_precision': 0.14919356, 'binary_recall': 0.2846154, 'binary_specificity': 0.9290279, 'binary_f1_score': 0.19576721}
confusion matrix:
      0    1
0  5524  422
1   186   74
early stop counter: 1
val acc:0.8811099529266357, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9526264667510986 / 0.9550434947013855
after epoch: 6,now: 2024-07-26 20:59:50.861781,epoch time: 0:22:11.599511,used: 2:14:48.583434,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 7
---- Training Domain: 
scalar performance:
{'acc': 0.7664168, 'precision': 0.69779503, 'recall': 0.7148632, 'specificity': 0.7148632, 'f1': 0.7048345, 'auroc': 0.82971585, 'binary_precision': 0.53479606, 'binary_recall': 0.61019415, 'binary_specificity': 0.8195322, 'binary_f1_score': 0.57001257}
confusion matrix:
       0     1
0  34758  7654
1   5621  8799
---- Validation: 
scalar performance:
{'acc': 0.06755603, 'precision': 0.5159623, 'recall': 0.51426536, 'specificity': 0.51426536, 'f1': 0.067541495, 'auroc': 0.7204323, 'binary_precision': 0.036932915, 'binary_recall': 0.99554235, 'binary_specificity': 0.03298832, 'binary_f1_score': 0.07122356}
confusion matrix:
     0      1
0  596  17471
1    3    670
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.05285208, 'precision': 0.52117956, 'recall': 0.5057181, 'specificity': 0.5057181, 'f1': 0.05194465, 'auroc': 0.72116745, 'binary_precision': 0.042359076, 'binary_recall': 1.0, 'binary_specificity': 0.011436259, 'binary_f1_score': 0.081275396}
confusion matrix:
    0     1
0  68  5878
1   0   260
early stop counter: 2
val acc:0.06755603104829788, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9526264667510986 / 0.9550434947013855
after epoch: 7,now: 2024-07-26 21:22:04.997487,epoch time: 0:22:14.135706,used: 2:37:02.719140,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 8
---- Training Domain: 
scalar performance:
{'acc': 0.9442568, 'precision': 0.9571233, 'recall': 0.89578223, 'specificity': 0.89578223, 'f1': 0.92135596, 'auroc': 0.95193577, 'binary_precision': 0.97905314, 'binary_recall': 0.7973648, 'binary_specificity': 0.99419975, 'binary_f1_score': 0.8789176}
confusion matrix:
       0      1
0  42166    246
1   2922  11498
---- Validation: 
scalar performance:
{'acc': 0.9183565, 'precision': 0.5347339, 'recall': 0.55424684, 'specificity': 0.55424684, 'f1': 0.54094756, 'auroc': 0.66770613, 'binary_precision': 0.101395346, 'binary_recall': 0.16196136, 'binary_specificity': 0.94653237, 'binary_f1_score': 0.12471395}
confusion matrix:
       0    1
0  17101  966
1    564  109
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9226555, 'precision': 0.5531173, 'recall': 0.5624156, 'specificity': 0.5624156, 'f1': 0.5572014, 'auroc': 0.734584, 'binary_precision': 0.14285715, 'binary_recall': 0.16923077, 'binary_specificity': 0.9556004, 'binary_f1_score': 0.1549296}
confusion matrix:
      0    1
0  5682  264
1   216   44
early stop counter: 3
val acc:0.9183564782142639, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9526264667510986 / 0.9550434947013855
after epoch: 8,now: 2024-07-26 21:44:32.022873,epoch time: 0:22:27.025386,used: 2:59:29.744526,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 9
---- Training Domain: 
scalar performance:
{'acc': 0.9396291, 'precision': 0.9572007, 'recall': 0.8845576, 'specificity': 0.8845576, 'f1': 0.91378707, 'auroc': 0.94655484, 'binary_precision': 0.98636806, 'binary_recall': 0.7727462, 'binary_specificity': 0.99636894, 'binary_f1_score': 0.86658627}
confusion matrix:
       0      1
0  42258    154
1   3277  11143
---- Validation: 
scalar performance:
{'acc': 0.94364995, 'precision': 0.49432874, 'recall': 0.49655324, 'specificity': 0.49655324, 'f1': 0.49478978, 'auroc': 0.6571995, 'binary_precision': 0.024813896, 'binary_recall': 0.014858841, 'binary_specificity': 0.97824764, 'binary_f1_score': 0.018587362}
confusion matrix:
       0    1
0  17674  393
1    663   10
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9434418, 'precision': 0.5207005, 'recall': 0.5088987, 'specificity': 0.5088987, 'f1': 0.5098174, 'auroc': 0.6890062, 'binary_precision': 0.08256881, 'binary_recall': 0.034615386, 'binary_specificity': 0.98318195, 'binary_f1_score': 0.04878049}
confusion matrix:
      0    1
0  5846  100
1   251    9
early stop counter: 4
val acc:0.94364994764328, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9526264667510986 / 0.9550434947013855
after epoch: 9,now: 2024-07-26 22:06:50.641706,epoch time: 0:22:18.618833,used: 3:21:48.363359,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 10
---- Training Domain: 
scalar performance:
{'acc': 0.94408077, 'precision': 0.96222734, 'recall': 0.89174366, 'specificity': 0.89174366, 'f1': 0.92039144, 'auroc': 0.9452021, 'binary_precision': 0.992551, 'binary_recall': 0.78549135, 'binary_specificity': 0.9979959, 'binary_f1_score': 0.8769648}
confusion matrix:
       0      1
0  42328     85
1   3093  11326
---- Validation: 
scalar performance:
{'acc': 0.9562967, 'precision': 0.49184602, 'recall': 0.4981053, 'specificity': 0.4981053, 'f1': 0.4924646, 'auroc': 0.698866, 'binary_precision': 0.019736841, 'binary_recall': 0.004457652, 'binary_specificity': 0.9917529, 'binary_f1_score': 0.007272727}
confusion matrix:
       0    1
0  17918  149
1    670    3
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9510152, 'precision': 0.47890297, 'recall': 0.49630004, 'specificity': 0.49630004, 'f1': 0.4874463, 'auroc': 0.7286741, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9926001, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5902  44
1   260   0
early stop counter: 5
val acc:0.9562966823577881, best validation acc: 0.9582710862159729, corresponding to test acc:                         0.9526264667510986 / 0.9550434947013855
after epoch: 10,now: 2024-07-26 22:29:25.144344,epoch time: 0:22:34.502638,used: 3:44:22.865997,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_18_45_02_seed_1_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
early stop trigger
Experiment finished at epoch: 10 with time: 3:44:22.865997 at 2024-07-26 22:29:25.144344
persisted model performance metric: 

scalar performance:
{'acc': 0.95262647, 'precision': 0.47893715, 'recall': 0.49714094, 'specificity': 0.49714094, 'f1': 0.4878693, 'auroc': 0.7327174, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9942819, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5912  34
1   260   0
oracle model performance metric: 

scalar performance:
{'acc': 0.9550435, 'precision': 0.4789882, 'recall': 0.4984023, 'specificity': 0.4984023, 'f1': 0.4885024, 'auroc': 0.6490001, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9968046, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5927  19
1   260   0
results aggregation path: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/rule_results/8.csv
confusion matrix saved in file: zoutput/benchmarks/CAMELYON_center0_dinov2small_erm_lr__2024-07-26_11-44-51/confusion_matrix/8.csv.txt
before torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      | 452855 KiB |   6925 MiB |    900 TiB |    900 TiB |
|       from large pool | 412053 KiB |   6891 MiB |    897 TiB |    897 TiB |
|       from small pool |  40802 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         | 452855 KiB |   6925 MiB |    900 TiB |    900 TiB |
|       from large pool | 412053 KiB |   6891 MiB |    897 TiB |    897 TiB |
|       from small pool |  40802 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      | 447751 KiB |   6922 MiB |    900 TiB |    900 TiB |
|       from large pool | 407075 KiB |   6888 MiB |    896 TiB |    896 TiB |
|       from small pool |  40676 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   7288 MiB |   7296 MiB |  13518 MiB |   6230 MiB |
|       from large pool |   7224 MiB |   7232 MiB |  13440 MiB |   6216 MiB |
|       from small pool |     64 MiB |     64 MiB |     78 MiB |     14 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 734984 KiB |    845 MiB | 486595 GiB | 486594 GiB |
|       from large pool | 724587 KiB |    840 MiB | 483126 GiB | 483125 GiB |
|       from small pool |  10397 KiB |     21 MiB |   3468 GiB |   3468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |    1718    |    2767    |   47965 K  |   47963 K  |
|       from large pool |     187    |     311    |   23353 K  |   23353 K  |
|       from small pool |    1531    |    2579    |   24611 K  |   24609 K  |
|---------------------------------------------------------------------------|
| Active allocs         |    1718    |    2767    |   47965 K  |   47963 K  |
|       from large pool |     187    |     311    |   23353 K  |   23353 K  |
|       from small pool |    1531    |    2579    |   24611 K  |   24609 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     147    |     150    |     245    |      98    |
|       from large pool |     115    |     118    |     206    |      91    |
|       from small pool |      32    |      32    |      39    |       7    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      66    |     941    |   27868 K  |   27868 K  |
|       from large pool |      27    |     120    |   17758 K  |   17757 K  |
|       from small pool |      39    |     916    |   10110 K  |   10110 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

after torch memory clean up
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6925 MiB |    900 TiB |    900 TiB |
|       from large pool |  16640 KiB |   6891 MiB |    897 TiB |    897 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6925 MiB |    900 TiB |    900 TiB |
|       from large pool |  16640 KiB |   6891 MiB |    897 TiB |    897 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6922 MiB |    900 TiB |    900 TiB |
|       from large pool |  16640 KiB |   6888 MiB |    896 TiB |    896 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1160 MiB |   7296 MiB |  13518 MiB |  12358 MiB |
|       from large pool |   1110 MiB |   7232 MiB |  13440 MiB |  12330 MiB |
|       from small pool |     50 MiB |     64 MiB |     78 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 486595 GiB | 486595 GiB |
|       from large pool |   3840 KiB |    840 MiB | 483126 GiB | 483126 GiB |
|       from small pool |      0 KiB |     26 MiB |   3468 GiB |   3468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   47965 K  |   47965 K  |
|       from large pool |       2    |     311    |   23353 K  |   23353 K  |
|       from small pool |       0    |    2579    |   24611 K  |   24611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   47965 K  |   47965 K  |
|       from large pool |       2    |     311    |   23353 K  |   23353 K  |
|       from small pool |       0    |    2579    |   24611 K  |   24611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     150    |     245    |     190    |
|       from large pool |      30    |     118    |     206    |     176    |
|       from small pool |      25    |      32    |      39    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     941    |   27869 K  |   27869 K  |
|       from large pool |       2    |     120    |   17758 K  |   17758 K  |
|       from small pool |       0    |     916    |   10111 K  |   10111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

before experiment starts
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  16640 KiB |   6925 MiB |    900 TiB |    900 TiB |
|       from large pool |  16640 KiB |   6891 MiB |    897 TiB |    897 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Active memory         |  16640 KiB |   6925 MiB |    900 TiB |    900 TiB |
|       from large pool |  16640 KiB |   6891 MiB |    897 TiB |    897 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| Requested memory      |  16640 KiB |   6922 MiB |    900 TiB |    900 TiB |
|       from large pool |  16640 KiB |   6888 MiB |    896 TiB |    896 TiB |
|       from small pool |      0 KiB |     56 MiB |      3 TiB |      3 TiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1160 MiB |   7296 MiB |  13518 MiB |  12358 MiB |
|       from large pool |   1110 MiB |   7232 MiB |  13440 MiB |  12330 MiB |
|       from small pool |     50 MiB |     64 MiB |     78 MiB |     28 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |   3840 KiB |    845 MiB | 486595 GiB | 486595 GiB |
|       from large pool |   3840 KiB |    840 MiB | 483126 GiB | 483126 GiB |
|       from small pool |      0 KiB |     26 MiB |   3468 GiB |   3468 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       2    |    2767    |   47965 K  |   47965 K  |
|       from large pool |       2    |     311    |   23353 K  |   23353 K  |
|       from small pool |       0    |    2579    |   24611 K  |   24611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |       2    |    2767    |   47965 K  |   47965 K  |
|       from large pool |       2    |     311    |   23353 K  |   23353 K  |
|       from small pool |       0    |    2579    |   24611 K  |   24611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     150    |     245    |     190    |
|       from large pool |      30    |     118    |     206    |     176    |
|       from small pool |      25    |      32    |      39    |      14    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |     941    |   27869 K  |   27869 K  |
|       from large pool |       2    |     120    |   17758 K  |   17758 K  |
|       from small pool |       0    |     916    |   10111 K  |   10111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


overriding args.task None to dset


using device: cuda:0

Using cache found in /home/aih/sina.wendrich/.cache/torch/hub/facebookresearch_dinov2_main
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
/home/aih/sina.wendrich/miniconda3/envs/domainlab_py310/lib/python3.10/site-packages/torchmetrics/utilities/prints.py:36: UserWarning: Metric `AUROC` will save all targets and predictions in buffer. For large datasets this may lead to large memory footprint.
  warnings.warn(*args, **kwargs)



!!!: not committed yet
/ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab/domainlab/utils/get_git_tag.py:16: UserWarning: !!!: not committed yet
  warnings.warn("!!!: not committed yet")



b'8efecac6'
model name: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002

 Experiment start at: 2024-07-26 22:36:01.425520
before training, model accuracy: 0.754768431186676
epoch: 1
---- Training Domain: 
scalar performance:
{'acc': 0.91428024, 'precision': 0.93250895, 'recall': 0.84615874, 'specificity': 0.84615874, 'f1': 0.878181, 'auroc': 0.92292476, 'binary_precision': 0.96212393, 'binary_recall': 0.70220226, 'binary_specificity': 0.99011517, 'binary_f1_score': 0.8118668}
confusion matrix:
       0      1
0  41869    418
1   4503  10618
---- Validation: 
scalar performance:
{'acc': 0.7186385, 'precision': 0.5186463, 'recall': 0.62177444, 'specificity': 0.62177444, 'f1': 0.46935734, 'auroc': 0.6495732, 'binary_precision': 0.05882353, 'binary_recall': 0.5182724, 'binary_specificity': 0.7252765, 'binary_f1_score': 0.10565527}
confusion matrix:
       0     1
0  13179  4992
1    290   312
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.5746113, 'precision': 0.5226378, 'recall': 0.6498445, 'specificity': 0.6498445, 'f1': 0.41871634, 'auroc': 0.67722154, 'binary_precision': 0.06399132, 'binary_recall': 0.73140496, 'binary_specificity': 0.56828415, 'binary_f1_score': 0.117686175}
confusion matrix:
      0     1
0  3408  2589
1    65   177
new oracle model saved
better model found
persisted
after epoch: 1,now: 2024-07-26 22:58:59.869040,epoch time: 0:22:58.443520,used: 0:22:58.443520,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 2
---- Training Domain: 
scalar performance:
{'acc': 0.9334936, 'precision': 0.95563054, 'recall': 0.87554604, 'specificity': 0.87554604, 'f1': 0.9065636, 'auroc': 0.9426836, 'binary_precision': 0.9925028, 'binary_recall': 0.7531256, 'binary_specificity': 0.99796647, 'binary_f1_score': 0.8564014}
confusion matrix:
       0      1
0  42205     86
1   3732  11385
---- Validation: 
scalar performance:
{'acc': 0.9490758, 'precision': 0.4865022, 'recall': 0.4918653, 'specificity': 0.4918653, 'f1': 0.48901826, 'auroc': 0.6841398, 'binary_precision': 0.005586592, 'binary_recall': 0.003322259, 'binary_specificity': 0.9804084, 'binary_f1_score': 0.0041666664}
confusion matrix:
       0    1
0  17815  356
1    600    2
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.94566435, 'precision': 0.4854251, 'recall': 0.49389535, 'specificity': 0.49389535, 'f1': 0.488967, 'auroc': 0.6752708, 'binary_precision': 0.01010101, 'binary_recall': 0.004132231, 'binary_specificity': 0.9836585, 'binary_f1_score': 0.0058651026}
confusion matrix:
      0   1
0  5899  98
1   241   1
new oracle model saved
better model found
persisted
after epoch: 2,now: 2024-07-26 23:21:27.201580,epoch time: 0:22:27.332540,used: 0:45:25.776060,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 3
---- Training Domain: 
scalar performance:
{'acc': 0.9368903, 'precision': 0.95502794, 'recall': 0.88375473, 'specificity': 0.88375473, 'f1': 0.9121776, 'auroc': 0.9551259, 'binary_precision': 0.98588693, 'binary_recall': 0.7714588, 'binary_specificity': 0.9960507, 'binary_f1_score': 0.8655909}
confusion matrix:
       0      1
0  42119    167
1   3456  11666
---- Validation: 
scalar performance:
{'acc': 0.8307676, 'precision': 0.5413248, 'recall': 0.689333, 'specificity': 0.689333, 'f1': 0.5375987, 'auroc': 0.75840807, 'binary_precision': 0.10052746, 'binary_recall': 0.538206, 'binary_specificity': 0.84046006, 'binary_f1_score': 0.16941176}
confusion matrix:
       0     1
0  15272  2899
1    278   324
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.84100014, 'precision': 0.5554725, 'recall': 0.703156, 'specificity': 0.703156, 'f1': 0.5621345, 'auroc': 0.75860035, 'binary_precision': 0.13163064, 'binary_recall': 0.553719, 'binary_specificity': 0.85259295, 'binary_f1_score': 0.2126984}
confusion matrix:
      0    1
0  5113  884
1   108  134
early stop counter: 1
val acc:0.8307675719261169, best validation acc: 0.9490758180618286, corresponding to test acc:                         0.9456643462181091 / 0.9456643462181091
after epoch: 3,now: 2024-07-26 23:44:02.952712,epoch time: 0:22:35.751132,used: 1:08:01.527192,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 4
---- Training Domain: 
scalar performance:
{'acc': 0.9489096, 'precision': 0.954339, 'recall': 0.91296244, 'specificity': 0.91296244, 'f1': 0.9311427, 'auroc': 0.95346594, 'binary_precision': 0.96434283, 'binary_recall': 0.83699244, 'binary_specificity': 0.9889325, 'binary_f1_score': 0.8961659}
confusion matrix:
       0      1
0  41818    468
1   2465  12657
---- Validation: 
scalar performance:
{'acc': 0.91189474, 'precision': 0.5302343, 'recall': 0.56179726, 'specificity': 0.56179726, 'f1': 0.536919, 'auroc': 0.72035265, 'binary_precision': 0.08841941, 'binary_recall': 0.18770765, 'binary_specificity': 0.93588686, 'binary_f1_score': 0.12021278}
confusion matrix:
       0     1
0  17006  1165
1    489   113
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.87930757, 'precision': 0.512664, 'recall': 0.528774, 'specificity': 0.528774, 'f1': 0.5113271, 'auroc': 0.72417617, 'binary_precision': 0.06174957, 'binary_recall': 0.14876033, 'binary_specificity': 0.9087877, 'binary_f1_score': 0.08727273}
confusion matrix:
      0    1
0  5450  547
1   206   36
early stop counter: 2
val acc:0.9118947386741638, best validation acc: 0.9490758180618286, corresponding to test acc:                         0.9456643462181091 / 0.9456643462181091
after epoch: 4,now: 2024-07-27 00:06:35.916882,epoch time: 0:22:32.964170,used: 1:30:34.491362,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 5
---- Training Domain: 
scalar performance:
{'acc': 0.92497563, 'precision': 0.9534449, 'recall': 0.8577733, 'specificity': 0.8577733, 'f1': 0.8927891, 'auroc': 0.9564179, 'binary_precision': 0.9991691, 'binary_recall': 0.7157595, 'binary_specificity': 0.99978715, 'binary_f1_score': 0.8340461}
confusion matrix:
       0      1
0  42278      9
1   4298  10823
---- Validation: 
scalar performance:
{'acc': 0.9642039, 'precision': 0.48390633, 'recall': 0.49807385, 'specificity': 0.49807385, 'f1': 0.49088785, 'auroc': 0.7188878, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9961477, 'binary_f1_score': 0.0}
confusion matrix:
       0   1
0  18101  70
1    602   0
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.9578458, 'precision': 0.48054036, 'recall': 0.4982491, 'specificity': 0.4982491, 'f1': 0.48923457, 'auroc': 0.74504364, 'binary_precision': 0.0, 'binary_recall': 0.0, 'binary_specificity': 0.9964982, 'binary_f1_score': 0.0}
confusion matrix:
      0   1
0  5976  21
1   242   0
new oracle model saved
better model found
persisted
after epoch: 5,now: 2024-07-27 00:29:11.319545,epoch time: 0:22:35.402663,used: 1:53:09.894025,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
epoch: 6
---- Training Domain: 
scalar performance:
{'acc': 0.94584376, 'precision': 0.9510999, 'recall': 0.9080832, 'specificity': 0.9080832, 'f1': 0.9268606, 'auroc': 0.95444715, 'binary_precision': 0.9607302, 'binary_recall': 0.8282748, 'binary_specificity': 0.9878917, 'binary_f1_score': 0.889599}
confusion matrix:
       0      1
0  41773    512
1   2597  12526
---- Validation: 
scalar performance:
{'acc': 0.78186756, 'precision': 0.5294865, 'recall': 0.66327, 'specificity': 0.66327, 'f1': 0.50571483, 'auroc': 0.7097813, 'binary_precision': 0.07803817, 'binary_recall': 0.53654486, 'binary_specificity': 0.7899951, 'binary_f1_score': 0.13625817}
confusion matrix:
       0     1
0  14355  3816
1    279   323
---- Test Domain (oracle): 
scalar performance:
{'acc': 0.7353743, 'precision': 0.5402431, 'recall': 0.71760774, 'specificity': 0.71760774, 'f1': 0.5062658, 'auroc': 0.7555858, 'binary_precision': 0.096737266, 'binary_recall': 0.6983471, 'binary_specificity': 0.73686844, 'binary_f1_score': 0.16993465}
confusion matrix:
      0     1
0  4419  1578
1    73   169
early stop counter: 1
val acc:0.7818675637245178, best validation acc: 0.9642038941383362, corresponding to test acc:                         0.9578458070755005 / 0.9578458070755005
after epoch: 6,now: 2024-07-27 00:51:45.651108,epoch time: 0:22:34.331563,used: 2:15:44.225588,model: dset_te_center0_erm_b8efecac6_not_commited_2024md_07md_26_22_36_01_seed_2_23070002
working direcotry: /ictstr01/home/aih/sina.wendrich/MA_thesis/DomainLab
slurmstepd: error: *** JOB 23070002 ON gpusrv29 CANCELLED AT 2024-07-27T00:53:48 ***
